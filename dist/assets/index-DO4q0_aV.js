function Joe(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var m0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var FS={exports:{}},fy={};var a7;function Zoe(){if(a7)return fy;a7=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var l in i)l!=="key"&&(a[l]=i[l])}else a=i;return i=a.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:a}}return fy.Fragment=e,fy.jsx=r,fy.jsxs=r,fy}var o7;function ele(){return o7||(o7=1,FS.exports=Zoe()),FS.exports}var s=ele(),US={exports:{}},Zr={};var l7;function tle(){if(l7)return Zr;l7=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function g(q){return q===null||typeof q!="object"?null:(q=m&&q[m]||q["@@iterator"],typeof q=="function"?q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function j(q,U,W){this.props=q,this.context=U,this.refs=w,this.updater=W||b}j.prototype.isReactComponent={},j.prototype.setState=function(q,U){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,U,"setState")},j.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function _(){}_.prototype=j.prototype;function E(q,U,W){this.props=q,this.context=U,this.refs=w,this.updater=W||b}var I=E.prototype=new _;I.constructor=E,v(I,j.prototype),I.isPureReactComponent=!0;var O=Array.isArray;function B(){}var S={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function M(q,U,W){var Z=W.ref;return{$$typeof:t,type:q,key:U,ref:Z!==void 0?Z:null,props:W}}function $(q,U){return M(q.type,U,q.props)}function k(q){return typeof q=="object"&&q!==null&&q.$$typeof===t}function L(q){var U={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(W){return U[W]})}var R=/\/+/g;function V(q,U){return typeof q=="object"&&q!==null&&q.key!=null?L(""+q.key):U.toString(36)}function Y(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(B,B):(q.status="pending",q.then(function(U){q.status==="pending"&&(q.status="fulfilled",q.value=U)},function(U){q.status==="pending"&&(q.status="rejected",q.reason=U)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function X(q,U,W,Z,de){var be=typeof q;(be==="undefined"||be==="boolean")&&(q=null);var oe=!1;if(q===null)oe=!0;else switch(be){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(q.$$typeof){case t:case e:oe=!0;break;case h:return oe=q._init,X(oe(q._payload),U,W,Z,de)}}if(oe)return de=de(q),oe=Z===""?"."+V(q,0):Z,O(de)?(W="",oe!=null&&(W=oe.replace(R,"$&/")+"/"),X(de,U,W,"",function(le){return le})):de!=null&&(k(de)&&(de=$(de,W+(de.key==null||q&&q.key===de.key?"":(""+de.key).replace(R,"$&/")+"/")+oe)),U.push(de)),1;oe=0;var ne=Z===""?".":Z+":";if(O(q))for(var H=0;H<q.length;H++)Z=q[H],be=ne+V(Z,H),oe+=X(Z,U,W,be,de);else if(H=g(q),typeof H=="function")for(q=H.call(q),H=0;!(Z=q.next()).done;)Z=Z.value,be=ne+V(Z,H++),oe+=X(Z,U,W,be,de);else if(be==="object"){if(typeof q.then=="function")return X(Y(q),U,W,Z,de);throw U=String(q),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return oe}function J(q,U,W){if(q==null)return q;var Z=[],de=0;return X(q,Z,"","",function(be){return U.call(W,be,de++)}),Z}function re(q){if(q._status===-1){var U=q._result;U=U(),U.then(function(W){(q._status===0||q._status===-1)&&(q._status=1,q._result=W)},function(W){(q._status===0||q._status===-1)&&(q._status=2,q._result=W)}),q._status===-1&&(q._status=0,q._result=U)}if(q._status===1)return q._result.default;throw q._result}var se=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},ee={map:J,forEach:function(q,U,W){J(q,function(){U.apply(this,arguments)},W)},count:function(q){var U=0;return J(q,function(){U++}),U},toArray:function(q){return J(q,function(U){return U})||[]},only:function(q){if(!k(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Zr.Activity=p,Zr.Children=ee,Zr.Component=j,Zr.Fragment=r,Zr.Profiler=i,Zr.PureComponent=E,Zr.StrictMode=n,Zr.Suspense=c,Zr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Zr.__COMPILER_RUNTIME={__proto__:null,c:function(q){return S.H.useMemoCache(q)}},Zr.cache=function(q){return function(){return q.apply(null,arguments)}},Zr.cacheSignal=function(){return null},Zr.cloneElement=function(q,U,W){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var Z=v({},q.props),de=q.key;if(U!=null)for(be in U.key!==void 0&&(de=""+U.key),U)!T.call(U,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&U.ref===void 0||(Z[be]=U[be]);var be=arguments.length-2;if(be===1)Z.children=W;else if(1<be){for(var oe=Array(be),ne=0;ne<be;ne++)oe[ne]=arguments[ne+2];Z.children=oe}return M(q.type,de,Z)},Zr.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:a,_context:q},q},Zr.createElement=function(q,U,W){var Z,de={},be=null;if(U!=null)for(Z in U.key!==void 0&&(be=""+U.key),U)T.call(U,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(de[Z]=U[Z]);var oe=arguments.length-2;if(oe===1)de.children=W;else if(1<oe){for(var ne=Array(oe),H=0;H<oe;H++)ne[H]=arguments[H+2];de.children=ne}if(q&&q.defaultProps)for(Z in oe=q.defaultProps,oe)de[Z]===void 0&&(de[Z]=oe[Z]);return M(q,be,de)},Zr.createRef=function(){return{current:null}},Zr.forwardRef=function(q){return{$$typeof:l,render:q}},Zr.isValidElement=k,Zr.lazy=function(q){return{$$typeof:h,_payload:{_status:-1,_result:q},_init:re}},Zr.memo=function(q,U){return{$$typeof:u,type:q,compare:U===void 0?null:U}},Zr.startTransition=function(q){var U=S.T,W={};S.T=W;try{var Z=q(),de=S.S;de!==null&&de(W,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(B,se)}catch(be){se(be)}finally{U!==null&&W.types!==null&&(U.types=W.types),S.T=U}},Zr.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},Zr.use=function(q){return S.H.use(q)},Zr.useActionState=function(q,U,W){return S.H.useActionState(q,U,W)},Zr.useCallback=function(q,U){return S.H.useCallback(q,U)},Zr.useContext=function(q){return S.H.useContext(q)},Zr.useDebugValue=function(){},Zr.useDeferredValue=function(q,U){return S.H.useDeferredValue(q,U)},Zr.useEffect=function(q,U){return S.H.useEffect(q,U)},Zr.useEffectEvent=function(q){return S.H.useEffectEvent(q)},Zr.useId=function(){return S.H.useId()},Zr.useImperativeHandle=function(q,U,W){return S.H.useImperativeHandle(q,U,W)},Zr.useInsertionEffect=function(q,U){return S.H.useInsertionEffect(q,U)},Zr.useLayoutEffect=function(q,U){return S.H.useLayoutEffect(q,U)},Zr.useMemo=function(q,U){return S.H.useMemo(q,U)},Zr.useOptimistic=function(q,U){return S.H.useOptimistic(q,U)},Zr.useReducer=function(q,U,W){return S.H.useReducer(q,U,W)},Zr.useRef=function(q){return S.H.useRef(q)},Zr.useState=function(q){return S.H.useState(q)},Zr.useSyncExternalStore=function(q,U,W){return S.H.useSyncExternalStore(q,U,W)},Zr.useTransition=function(){return S.H.useTransition()},Zr.version="19.2.3",Zr}var c7;function of(){return c7||(c7=1,US.exports=tle()),US.exports}var y=of();const Pe=bl(y),C6=Joe({__proto__:null,default:Pe},[y]);var zS={exports:{}},py={},qS={exports:{}},VS={};var u7;function rle(){return u7||(u7=1,(function(t){function e(X,J){var re=X.length;X.push(J);e:for(;0<re;){var se=re-1>>>1,ee=X[se];if(0<i(ee,J))X[se]=J,X[re]=ee,re=se;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var J=X[0],re=X.pop();if(re!==J){X[0]=re;e:for(var se=0,ee=X.length,q=ee>>>1;se<q;){var U=2*(se+1)-1,W=X[U],Z=U+1,de=X[Z];if(0>i(W,re))Z<ee&&0>i(de,W)?(X[se]=de,X[Z]=re,se=Z):(X[se]=W,X[U]=re,se=U);else if(Z<ee&&0>i(de,re))X[se]=de,X[Z]=re,se=Z;else break e}}return J}function i(X,J){var re=X.sortIndex-J.sortIndex;return re!==0?re:X.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,p=null,m=3,g=!1,b=!1,v=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function I(X){for(var J=r(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=X)n(u),J.sortIndex=J.expirationTime,e(c,J);else break;J=r(u)}}function O(X){if(v=!1,I(X),!b)if(r(c)!==null)b=!0,B||(B=!0,L());else{var J=r(u);J!==null&&Y(O,J.startTime-X)}}var B=!1,S=-1,T=5,M=-1;function $(){return w?!0:!(t.unstable_now()-M<T)}function k(){if(w=!1,B){var X=t.unstable_now();M=X;var J=!0;try{e:{b=!1,v&&(v=!1,_(S),S=-1),g=!0;var re=m;try{t:{for(I(X),p=r(c);p!==null&&!(p.expirationTime>X&&$());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var ee=se(p.expirationTime<=X);if(X=t.unstable_now(),typeof ee=="function"){p.callback=ee,I(X),J=!0;break t}p===r(c)&&n(c),I(X)}else n(c);p=r(c)}if(p!==null)J=!0;else{var q=r(u);q!==null&&Y(O,q.startTime-X),J=!1}}break e}finally{p=null,m=re,g=!1}J=void 0}}finally{J?L():B=!1}}}var L;if(typeof E=="function")L=function(){E(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,V=R.port2;R.port1.onmessage=k,L=function(){V.postMessage(null)}}else L=function(){j(k,0)};function Y(X,J){S=j(function(){X(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var re=m;m=J;try{return X()}finally{m=re}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(X,J){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var re=m;m=X;try{return J()}finally{m=re}},t.unstable_scheduleCallback=function(X,J,re){var se=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?se+re:se):re=se,X){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=re+ee,X={id:h++,callback:J,priorityLevel:X,startTime:re,expirationTime:ee,sortIndex:-1},re>se?(X.sortIndex=re,e(u,X),r(c)===null&&X===r(u)&&(v?(_(S),S=-1):v=!0,Y(O,re-se))):(X.sortIndex=ee,e(c,X),b||g||(b=!0,B||(B=!0,L()))),X},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(X){var J=m;return function(){var re=m;m=J;try{return X.apply(this,arguments)}finally{m=re}}}})(VS)),VS}var d7;function nle(){return d7||(d7=1,qS.exports=rle()),qS.exports}var HS={exports:{}},qo={};var h7;function sle(){if(h7)return qo;h7=1;var t=of();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(c,u,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:c,containerInfo:u,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return qo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,qo.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(c,u,null,h)},qo.flushSync=function(c){var u=o.T,h=n.p;try{if(o.T=null,n.p=2,c)return c()}finally{o.T=u,n.p=h,n.d.f()}},qo.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(c,u))},qo.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},qo.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,p=l(h,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,g=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?n.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:g,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},qo.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=l(u.as,u.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(c)},qo.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,p=l(h,u.crossOrigin);n.d.L(c,h,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},qo.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=l(u.as,u.crossOrigin);n.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(c)},qo.requestFormReset=function(c){n.d.r(c)},qo.unstable_batchedUpdates=function(c,u){return c(u)},qo.useFormState=function(c,u,h){return o.H.useFormState(c,u,h)},qo.useFormStatus=function(){return o.H.useHostTransitionStatus()},qo.version="19.2.3",qo}var f7;function GW(){if(f7)return HS.exports;f7=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),HS.exports=sle(),HS.exports}var p7;function ile(){if(p7)return py;p7=1;var t=nle(),e=of(),r=GW();function n(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)f+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var f=d,x=d;if(d.alternate)for(;f.return;)f=f.return;else{d=f;do f=d,(f.flags&4098)!==0&&(x=f.return),d=f.return;while(d)}return f.tag===3?x:null}function o(d){if(d.tag===13){var f=d.memoizedState;if(f===null&&(d=d.alternate,d!==null&&(f=d.memoizedState)),f!==null)return f.dehydrated}return null}function l(d){if(d.tag===31){var f=d.memoizedState;if(f===null&&(d=d.alternate,d!==null&&(f=d.memoizedState)),f!==null)return f.dehydrated}return null}function c(d){if(a(d)!==d)throw Error(n(188))}function u(d){var f=d.alternate;if(!f){if(f=a(d),f===null)throw Error(n(188));return f!==d?null:d}for(var x=d,N=f;;){var P=x.return;if(P===null)break;var F=P.alternate;if(F===null){if(N=P.return,N!==null){x=N;continue}break}if(P.child===F.child){for(F=P.child;F;){if(F===x)return c(P),d;if(F===N)return c(P),f;F=F.sibling}throw Error(n(188))}if(x.return!==N.return)x=P,N=F;else{for(var ie=!1,ge=P.child;ge;){if(ge===x){ie=!0,x=P,N=F;break}if(ge===N){ie=!0,N=P,x=F;break}ge=ge.sibling}if(!ie){for(ge=F.child;ge;){if(ge===x){ie=!0,x=F,N=P;break}if(ge===N){ie=!0,N=F,x=P;break}ge=ge.sibling}if(!ie)throw Error(n(189))}}if(x.alternate!==N)throw Error(n(190))}if(x.tag!==3)throw Error(n(188));return x.stateNode.current===x?d:f}function h(d){var f=d.tag;if(f===5||f===26||f===27||f===6)return d;for(d=d.child;d!==null;){if(f=h(d),f!==null)return f;d=d.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),E=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function L(d){return d===null||typeof d!="object"?null:(d=k&&d[k]||d["@@iterator"],typeof d=="function"?d:null)}var R=Symbol.for("react.client.reference");function V(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===R?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case j:return"Profiler";case w:return"StrictMode";case O:return"Suspense";case B:return"SuspenseList";case M:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case b:return"Portal";case E:return d.displayName||"Context";case _:return(d._context.displayName||"Context")+".Consumer";case I:var f=d.render;return d=d.displayName,d||(d=f.displayName||f.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case S:return f=d.displayName||null,f!==null?f:V(d.type)||"Memo";case T:f=d._payload,d=d._init;try{return V(d(f))}catch{}}return null}var Y=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},se=[],ee=-1;function q(d){return{current:d}}function U(d){0>ee||(d.current=se[ee],se[ee]=null,ee--)}function W(d,f){ee++,se[ee]=d.current,d.current=f}var Z=q(null),de=q(null),be=q(null),oe=q(null);function ne(d,f){switch(W(be,f),W(de,d),W(Z,null),f.nodeType){case 9:case 11:d=(d=f.documentElement)&&(d=d.namespaceURI)?AM(d):0;break;default:if(d=f.tagName,f=f.namespaceURI)f=AM(f),d=TM(f,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}U(Z),W(Z,d)}function H(){U(Z),U(de),U(be)}function le(d){d.memoizedState!==null&&W(oe,d);var f=Z.current,x=TM(f,d.type);f!==x&&(W(de,d),W(Z,x))}function ye(d){de.current===d&&(U(Z),U(de)),oe.current===d&&(U(oe),cy._currentValue=re)}var me,ke;function Ie(d){if(me===void 0)try{throw Error()}catch(x){var f=x.stack.trim().match(/\n( *(at )?)/);me=f&&f[1]||"",ke=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+me+d+ke}var ce=!1;function Be(d,f){if(!d||ce)return"";ce=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var N={DetermineComponentFrameRoot:function(){try{if(f){var Ct=function(){throw Error()};if(Object.defineProperty(Ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ct,[])}catch(ht){var lt=ht}Reflect.construct(d,[],Ct)}else{try{Ct.call()}catch(ht){lt=ht}d.call(Ct.prototype)}}else{try{throw Error()}catch(ht){lt=ht}(Ct=d())&&typeof Ct.catch=="function"&&Ct.catch(function(){})}}catch(ht){if(ht&&lt&&typeof ht.stack=="string")return[ht.stack,lt.stack]}return[null,null]}};N.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(N.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(N.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var F=N.DetermineComponentFrameRoot(),ie=F[0],ge=F[1];if(ie&&ge){var Le=ie.split(`
`),tt=ge.split(`
`);for(P=N=0;N<Le.length&&!Le[N].includes("DetermineComponentFrameRoot");)N++;for(;P<tt.length&&!tt[P].includes("DetermineComponentFrameRoot");)P++;if(N===Le.length||P===tt.length)for(N=Le.length-1,P=tt.length-1;1<=N&&0<=P&&Le[N]!==tt[P];)P--;for(;1<=N&&0<=P;N--,P--)if(Le[N]!==tt[P]){if(N!==1||P!==1)do if(N--,P--,0>P||Le[N]!==tt[P]){var yt=`
`+Le[N].replace(" at new "," at ");return d.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",d.displayName)),yt}while(1<=N&&0<=P);break}}}finally{ce=!1,Error.prepareStackTrace=x}return(x=d?d.displayName||d.name:"")?Ie(x):""}function ct(d,f){switch(d.tag){case 26:case 27:case 5:return Ie(d.type);case 16:return Ie("Lazy");case 13:return d.child!==f&&f!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Be(d.type,!1);case 11:return Be(d.type.render,!1);case 1:return Be(d.type,!0);case 31:return Ie("Activity");default:return""}}function Ve(d){try{var f="",x=null;do f+=ct(d,x),x=d,d=d.return;while(d);return f}catch(N){return`
Error generating stack: `+N.message+`
`+N.stack}}var Ne=Object.prototype.hasOwnProperty,Ye=t.unstable_scheduleCallback,St=t.unstable_cancelCallback,Vt=t.unstable_shouldYield,Lt=t.unstable_requestPaint,at=t.unstable_now,gt=t.unstable_getCurrentPriorityLevel,vt=t.unstable_ImmediatePriority,ft=t.unstable_UserBlockingPriority,ot=t.unstable_NormalPriority,ut=t.unstable_LowPriority,At=t.unstable_IdlePriority,Fe=t.log,Ut=t.unstable_setDisableYieldValue,jt=null,qe=null;function rt(d){if(typeof Fe=="function"&&Ut(d),qe&&typeof qe.setStrictMode=="function")try{qe.setStrictMode(jt,d)}catch{}}var Ot=Math.clz32?Math.clz32:Kt,pt=Math.log,Jt=Math.LN2;function Kt(d){return d>>>=0,d===0?32:31-(pt(d)/Jt|0)|0}var rr=256,Br=262144,zt=4194304;function Wt(d){var f=d&42;if(f!==0)return f;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function qt(d,f,x){var N=d.pendingLanes;if(N===0)return 0;var P=0,F=d.suspendedLanes,ie=d.pingedLanes;d=d.warmLanes;var ge=N&134217727;return ge!==0?(N=ge&~F,N!==0?P=Wt(N):(ie&=ge,ie!==0?P=Wt(ie):x||(x=ge&~d,x!==0&&(P=Wt(x))))):(ge=N&~F,ge!==0?P=Wt(ge):ie!==0?P=Wt(ie):x||(x=N&~d,x!==0&&(P=Wt(x)))),P===0?0:f!==0&&f!==P&&(f&F)===0&&(F=P&-P,x=f&-f,F>=x||F===32&&(x&4194048)!==0)?f:P}function ur(d,f){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&f)===0}function Re(d,f){switch(d){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(){var d=zt;return zt<<=1,(zt&62914560)===0&&(zt=4194304),d}function Pt(d){for(var f=[],x=0;31>x;x++)f.push(d);return f}function It(d,f){d.pendingLanes|=f,f!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function Zt(d,f,x,N,P,F){var ie=d.pendingLanes;d.pendingLanes=x,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=x,d.entangledLanes&=x,d.errorRecoveryDisabledLanes&=x,d.shellSuspendCounter=0;var ge=d.entanglements,Le=d.expirationTimes,tt=d.hiddenUpdates;for(x=ie&~x;0<x;){var yt=31-Ot(x),Ct=1<<yt;ge[yt]=0,Le[yt]=-1;var lt=tt[yt];if(lt!==null)for(tt[yt]=null,yt=0;yt<lt.length;yt++){var ht=lt[yt];ht!==null&&(ht.lane&=-536870913)}x&=~Ct}N!==0&&Ae(d,N,0),F!==0&&P===0&&d.tag!==0&&(d.suspendedLanes|=F&~(ie&~f))}function Ae(d,f,x){d.pendingLanes|=f,d.suspendedLanes&=~f;var N=31-Ot(f);d.entangledLanes|=f,d.entanglements[N]=d.entanglements[N]|1073741824|x&261930}function et(d,f){var x=d.entangledLanes|=f;for(d=d.entanglements;x;){var N=31-Ot(x),P=1<<N;P&f|d[N]&f&&(d[N]|=f),x&=~P}}function Rt(d,f){var x=f&-f;return x=(x&42)!==0?1:$t(x),(x&(d.suspendedLanes|f))!==0?0:x}function $t(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Qt(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function Ee(){var d=J.p;return d!==0?d:(d=window.event,d===void 0?32:ZM(d.type))}function Me(d,f){var x=J.p;try{return J.p=d,f()}finally{J.p=x}}var Je=Math.random().toString(36).slice(2),Ft="__reactFiber$"+Je,tr="__reactProps$"+Je,Rr="__reactContainer$"+Je,Kr="__reactEvents$"+Je,$s="__reactListeners$"+Je,Ki="__reactHandles$"+Je,Ws="__reactResources$"+Je,Ts="__reactMarker$"+Je;function wa(d){delete d[Ft],delete d[tr],delete d[Kr],delete d[$s],delete d[Ki]}function Hn(d){var f=d[Ft];if(f)return f;for(var x=d.parentNode;x;){if(f=x[Rr]||x[Ft]){if(x=f.alternate,f.child!==null||x!==null&&x.child!==null)for(d=DM(d);d!==null;){if(x=d[Ft])return x;d=DM(d)}return f}d=x,x=d.parentNode}return null}function wi(d){if(d=d[Ft]||d[Rr]){var f=d.tag;if(f===5||f===6||f===13||f===31||f===26||f===27||f===3)return d}return null}function Yi(d){var f=d.tag;if(f===5||f===26||f===27||f===6)return d.stateNode;throw Error(n(33))}function aa(d){var f=d[Ws];return f||(f=d[Ws]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function os(d){d[Ts]=!0}var kl=new Set,Gs={};function Xi(d,f){Li(d,f),Li(d+"Capture",f)}function Li(d,f){for(Gs[d]=f,d=0;d<f.length;d++)kl.add(f[d])}var Pi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bo={},_l={};function tc(d){return Ne.call(_l,d)?!0:Ne.call(Bo,d)?!1:Pi.test(d)?_l[d]=!0:(Bo[d]=!0,!1)}function Qi(d,f,x){if(tc(f))if(x===null)d.removeAttribute(f);else{switch(typeof x){case"undefined":case"function":case"symbol":d.removeAttribute(f);return;case"boolean":var N=f.toLowerCase().slice(0,5);if(N!=="data-"&&N!=="aria-"){d.removeAttribute(f);return}}d.setAttribute(f,""+x)}}function oi(d,f,x){if(x===null)d.removeAttribute(f);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(f);return}d.setAttribute(f,""+x)}}function xs(d,f,x,N){if(N===null)d.removeAttribute(x);else{switch(typeof N){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(x);return}d.setAttributeNS(f,x,""+N)}}function Yr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Na(d){var f=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function li(d,f,x){var N=Object.getOwnPropertyDescriptor(d.constructor.prototype,f);if(!d.hasOwnProperty(f)&&typeof N<"u"&&typeof N.get=="function"&&typeof N.set=="function"){var P=N.get,F=N.set;return Object.defineProperty(d,f,{configurable:!0,get:function(){return P.call(this)},set:function(ie){x=""+ie,F.call(this,ie)}}),Object.defineProperty(d,f,{enumerable:N.enumerable}),{getValue:function(){return x},setValue:function(ie){x=""+ie},stopTracking:function(){d._valueTracker=null,delete d[f]}}}}function an(d){if(!d._valueTracker){var f=Na(d)?"checked":"value";d._valueTracker=li(d,f,""+d[f])}}function ho(d){if(!d)return!1;var f=d._valueTracker;if(!f)return!0;var x=f.getValue(),N="";return d&&(N=Na(d)?d.checked?"true":"false":d.value),d=N,d!==x?(f.setValue(d),!0):!1}function Is(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var Zn=/[\n"\\]/g;function bs(d){return d.replace(Zn,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function tl(d,f,x,N,P,F,ie,ge){d.name="",ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?d.type=ie:d.removeAttribute("type"),f!=null?ie==="number"?(f===0&&d.value===""||d.value!=f)&&(d.value=""+Yr(f)):d.value!==""+Yr(f)&&(d.value=""+Yr(f)):ie!=="submit"&&ie!=="reset"||d.removeAttribute("value"),f!=null?rc(d,ie,Yr(f)):x!=null?rc(d,ie,Yr(x)):N!=null&&d.removeAttribute("value"),P==null&&F!=null&&(d.defaultChecked=!!F),P!=null&&(d.checked=P&&typeof P!="function"&&typeof P!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?d.name=""+Yr(ge):d.removeAttribute("name")}function Sl(d,f,x,N,P,F,ie,ge){if(F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(d.type=F),f!=null||x!=null){if(!(F!=="submit"&&F!=="reset"||f!=null)){an(d);return}x=x!=null?""+Yr(x):"",f=f!=null?""+Yr(f):x,ge||f===d.value||(d.value=f),d.defaultValue=f}N=N??P,N=typeof N!="function"&&typeof N!="symbol"&&!!N,d.checked=ge?d.checked:!!N,d.defaultChecked=!!N,ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&(d.name=ie),an(d)}function rc(d,f,x){f==="number"&&Is(d.ownerDocument)===d||d.defaultValue===""+x||(d.defaultValue=""+x)}function Ni(d,f,x,N){if(d=d.options,f){f={};for(var P=0;P<x.length;P++)f["$"+x[P]]=!0;for(x=0;x<d.length;x++)P=f.hasOwnProperty("$"+d[x].value),d[x].selected!==P&&(d[x].selected=P),P&&N&&(d[x].defaultSelected=!0)}else{for(x=""+Yr(x),f=null,P=0;P<d.length;P++){if(d[P].value===x){d[P].selected=!0,N&&(d[P].defaultSelected=!0);return}f!==null||d[P].disabled||(f=d[P])}f!==null&&(f.selected=!0)}}function fo(d,f,x){if(f!=null&&(f=""+Yr(f),f!==d.value&&(d.value=f),x==null)){d.defaultValue!==f&&(d.defaultValue=f);return}d.defaultValue=x!=null?""+Yr(x):""}function Ks(d,f,x,N){if(f==null){if(N!=null){if(x!=null)throw Error(n(92));if(Y(N)){if(1<N.length)throw Error(n(93));N=N[0]}x=N}x==null&&(x=""),f=x}x=Yr(f),d.defaultValue=x,N=d.textContent,N===x&&N!==""&&N!==null&&(d.value=N),an(d)}function es(d,f){if(f){var x=d.firstChild;if(x&&x===d.lastChild&&x.nodeType===3){x.nodeValue=f;return}}d.textContent=f}var Oi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nc(d,f,x){var N=f.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?N?d.setProperty(f,""):f==="float"?d.cssFloat="":d[f]="":N?d.setProperty(f,x):typeof x!="number"||x===0||Oi.has(f)?f==="float"?d.cssFloat=x:d[f]=(""+x).trim():d[f]=x+"px"}function oa(d,f,x){if(f!=null&&typeof f!="object")throw Error(n(62));if(d=d.style,x!=null){for(var N in x)!x.hasOwnProperty(N)||f!=null&&f.hasOwnProperty(N)||(N.indexOf("--")===0?d.setProperty(N,""):N==="float"?d.cssFloat="":d[N]="");for(var P in f)N=f[P],f.hasOwnProperty(P)&&x[P]!==N&&nc(d,P,N)}else for(var F in f)f.hasOwnProperty(F)&&nc(d,F,f[F])}function Cl(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var El=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),po=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ri(d){return po.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function la(){}var ls=null;function ji(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var mo=null,mr=null;function go(d){var f=wi(d);if(f&&(d=f.stateNode)){var x=d[tr]||null;e:switch(d=f.stateNode,f.type){case"input":if(tl(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),f=x.name,x.type==="radio"&&f!=null){for(x=d;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+bs(""+f)+'"][type="radio"]'),f=0;f<x.length;f++){var N=x[f];if(N!==d&&N.form===d.form){var P=N[tr]||null;if(!P)throw Error(n(90));tl(N,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(f=0;f<x.length;f++)N=x[f],N.form===d.form&&ho(N)}break e;case"textarea":fo(d,x.value,x.defaultValue);break e;case"select":f=x.value,f!=null&&Ni(d,!!x.multiple,f,!1)}}}var xo=!1;function $o(d,f,x){if(xo)return d(f,x);xo=!0;try{var N=d(f);return N}finally{if(xo=!1,(mo!==null||mr!==null)&&(ew(),mo&&(f=mo,d=mr,mr=mo=null,go(f),d)))for(f=0;f<d.length;f++)go(d[f])}}function Fs(d,f){var x=d.stateNode;if(x===null)return null;var N=x[tr]||null;if(N===null)return null;x=N[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(d=d.type,N=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!N;break e;default:d=!1}if(d)return null;if(x&&typeof x!="function")throw Error(n(231,f,typeof x));return x}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fo=!1;if(ys)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){Fo=!0}}),window.addEventListener("test",rn,rn),window.removeEventListener("test",rn,rn)}catch{Fo=!1}var Mi=null,bo=null,ja=null;function sc(){if(ja)return ja;var d,f=bo,x=f.length,N,P="value"in Mi?Mi.value:Mi.textContent,F=P.length;for(d=0;d<x&&f[d]===P[d];d++);var ie=x-d;for(N=1;N<=ie&&f[x-N]===P[F-N];N++);return ja=P.slice(d,1<N?1-N:void 0)}function Q(d){var f=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&f===13&&(d=13)):d=f,d===10&&(d=13),32<=d||d===13?d:0}function xe(){return!0}function Te(){return!1}function dt(d){function f(x,N,P,F,ie){this._reactName=x,this._targetInst=P,this.type=N,this.nativeEvent=F,this.target=ie,this.currentTarget=null;for(var ge in d)d.hasOwnProperty(ge)&&(x=d[ge],this[ge]=x?x(F):F[ge]);return this.isDefaultPrevented=(F.defaultPrevented!=null?F.defaultPrevented:F.returnValue===!1)?xe:Te,this.isPropagationStopped=Te,this}return p(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=xe)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=xe)},persist:function(){},isPersistent:xe}),f}var _r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},er=dt(_r),Hr=p({},_r,{view:0,detail:0}),Xr=dt(Hr),Cn,Qr,Un,Us=p({},Hr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ir,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Un&&(Un&&d.type==="mousemove"?(Cn=d.screenX-Un.screenX,Qr=d.screenY-Un.screenY):Qr=Cn=0,Un=d),Cn)},movementY:function(d){return"movementY"in d?d.movementY:Qr}}),ss=dt(Us),Rn=p({},Us,{dataTransfer:0}),Wn=dt(Rn),Wa=p({},Hr,{relatedTarget:0}),Ys=dt(Wa),Ga=p({},_r,{animationName:0,elapsedTime:0,pseudoElement:0}),z=dt(Ga),ue=p({},_r,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),_e=dt(ue),Oe=p({},_r,{data:0}),ze=dt(Oe),bt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},or={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hr(d){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(d):(d=or[d])?!!f[d]:!1}function Ir(){return hr}var Sr=p({},Hr,{key:function(d){if(d.key){var f=bt[d.key]||d.key;if(f!=="Unidentified")return f}return d.type==="keypress"?(d=Q(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Tt[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ir,charCode:function(d){return d.type==="keypress"?Q(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Q(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),pn=dt(Sr),vs=p({},Us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),is=dt(vs),A=p({},Hr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ir}),K=dt(A),ae=p({},_r,{propertyName:0,elapsedTime:0,pseudoElement:0}),we=dt(ae),We=p({},Us,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),nt=dt(We),Ht=p({},_r,{newState:0,oldState:0}),Vr=dt(Ht),ws=[9,13,27,32],un=ys&&"CompositionEvent"in window,Gn=null;ys&&"documentMode"in document&&(Gn=document.documentMode);var ca=ys&&"TextEvent"in window&&!Gn,ka=ys&&(!un||Gn&&8<Gn&&11>=Gn),cs=" ",_a=!1;function rl(d,f){switch(d){case"keyup":return ws.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ac(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Tc=!1;function yo(d,f){switch(d){case"compositionend":return Ac(f);case"keypress":return f.which!==32?null:(_a=!0,cs);case"textInput":return d=f.data,d===cs&&_a?null:d;default:return null}}function cu(d,f){if(Tc)return d==="compositionend"||!un&&rl(d,f)?(d=sc(),ja=bo=Mi=null,Tc=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return ka&&f.locale!=="ko"?null:f.data;default:return null}}var Nf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X0(d){var f=d&&d.nodeName&&d.nodeName.toLowerCase();return f==="input"?!!Nf[d.type]:f==="textarea"}function nl(d,f,x,N){mo?mr?mr.push(N):mr=[N]:mo=N,f=ow(f,"onChange"),0<f.length&&(x=new er("onChange","change",null,x,N),d.push({event:x,listeners:f}))}var ic=null,uu=null;function Q0(d){jM(d,0)}function ac(d){var f=Yi(d);if(ho(f))return d}function nd(d,f){if(d==="change")return f}var Uo=!1;if(ys){var vo;if(ys){var Ic="oninput"in document;if(!Ic){var Lc=document.createElement("div");Lc.setAttribute("oninput","return;"),Ic=typeof Lc.oninput=="function"}vo=Ic}else vo=!1;Uo=vo&&(!document.documentMode||9<document.documentMode)}function du(){ic&&(ic.detachEvent("onpropertychange",jf),uu=ic=null)}function jf(d){if(d.propertyName==="value"&&ac(uu)){var f=[];nl(f,uu,d,ji(d)),$o(Q0,f)}}function kf(d,f,x){d==="focusin"?(du(),ic=f,uu=x,ic.attachEvent("onpropertychange",jf)):d==="focusout"&&du()}function ki(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ac(uu)}function Xm(d,f){if(d==="click")return ac(f)}function Pc(d,f){if(d==="input"||d==="change")return ac(f)}function Oc(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var Sa=typeof Object.is=="function"?Object.is:Oc;function hu(d,f){if(Sa(d,f))return!0;if(typeof d!="object"||d===null||typeof f!="object"||f===null)return!1;var x=Object.keys(d),N=Object.keys(f);if(x.length!==N.length)return!1;for(N=0;N<x.length;N++){var P=x[N];if(!Ne.call(f,P)||!Sa(d[P],f[P]))return!1}return!0}function _f(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Sf(d,f){var x=_f(d);d=0;for(var N;x;){if(x.nodeType===3){if(N=d+x.textContent.length,d<=f&&N>=f)return{node:x,offset:f-d};d=N}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=_f(x)}}function fu(d,f){return d&&f?d===f?!0:d&&d.nodeType===3?!1:f&&f.nodeType===3?fu(d,f.parentNode):"contains"in d?d.contains(f):d.compareDocumentPosition?!!(d.compareDocumentPosition(f)&16):!1:!1}function pu(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var f=Is(d.document);f instanceof d.HTMLIFrameElement;){try{var x=typeof f.contentWindow.location.href=="string"}catch{x=!1}if(x)d=f.contentWindow;else break;f=Is(d.document)}return f}function Rc(d){var f=d&&d.nodeName&&d.nodeName.toLowerCase();return f&&(f==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||f==="textarea"||d.contentEditable==="true")}var th=ys&&"documentMode"in document&&11>=document.documentMode,sl=null,mu=null,Ka=null,Al=!1;function zn(d,f,x){var N=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;Al||sl==null||sl!==Is(N)||(N=sl,"selectionStart"in N&&Rc(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),Ka&&hu(Ka,N)||(Ka=N,N=ow(mu,"onSelect"),0<N.length&&(f=new er("onSelect","select",null,f,x),d.push({event:f,listeners:N}),f.target=sl)))}function En(d,f){var x={};return x[d.toLowerCase()]=f.toLowerCase(),x["Webkit"+d]="webkit"+f,x["Moz"+d]="moz"+f,x}var Ns={animationend:En("Animation","AnimationEnd"),animationiteration:En("Animation","AnimationIteration"),animationstart:En("Animation","AnimationStart"),transitionrun:En("Transition","TransitionRun"),transitionstart:En("Transition","TransitionStart"),transitioncancel:En("Transition","TransitionCancel"),transitionend:En("Transition","TransitionEnd")},_i={},Mc={};ys&&(Mc=document.createElement("div").style,"AnimationEvent"in window||(delete Ns.animationend.animation,delete Ns.animationiteration.animation,delete Ns.animationstart.animation),"TransitionEvent"in window||delete Ns.transitionend.transition);function oc(d){if(_i[d])return _i[d];if(!Ns[d])return d;var f=Ns[d],x;for(x in f)if(f.hasOwnProperty(x)&&x in Mc)return _i[d]=f[x];return d}var rh=oc("animationend"),J0=oc("animationiteration"),Lb=oc("animationstart"),T2=oc("transitionrun"),I2=oc("transitionstart"),L2=oc("transitioncancel"),Pb=oc("transitionend"),Ob=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function Tl(d,f){Ob.set(d,f),Xi(f,[d])}var Z0=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},il=[],sh=0,Qm=0;function ep(){for(var d=sh,f=Qm=sh=0;f<d;){var x=il[f];il[f++]=null;var N=il[f];il[f++]=null;var P=il[f];il[f++]=null;var F=il[f];if(il[f++]=null,N!==null&&P!==null){var ie=N.pending;ie===null?P.next=P:(P.next=ie.next,ie.next=P),N.pending=P}F!==0&&rp(x,P,F)}}function tp(d,f,x,N){il[sh++]=d,il[sh++]=f,il[sh++]=x,il[sh++]=N,Qm|=N,d.lanes|=N,d=d.alternate,d!==null&&(d.lanes|=N)}function Jm(d,f,x,N){return tp(d,f,x,N),Ya(d)}function gu(d,f){return tp(d,null,null,f),Ya(d)}function rp(d,f,x){d.lanes|=x;var N=d.alternate;N!==null&&(N.lanes|=x);for(var P=!1,F=d.return;F!==null;)F.childLanes|=x,N=F.alternate,N!==null&&(N.childLanes|=x),F.tag===22&&(d=F.stateNode,d===null||d._visibility&1||(P=!0)),d=F,F=F.return;return d.tag===3?(F=d.stateNode,P&&f!==null&&(P=31-Ot(x),d=F.hiddenUpdates,N=d[P],N===null?d[P]=[f]:N.push(f),f.lane=x|536870912),F):null}function Ya(d){if(50<ry)throw ry=0,uS=null,Error(n(185));for(var f=d.return;f!==null;)d=f,f=d.return;return d.tag===3?d.stateNode:null}var Ca={};function Zm(d,f,x,N){this.tag=d,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xa(d,f,x,N){return new Zm(d,f,x,N)}function eg(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Il(d,f){var x=d.alternate;return x===null?(x=Xa(d.tag,f,d.key,d.mode),x.elementType=d.elementType,x.type=d.type,x.stateNode=d.stateNode,x.alternate=d,d.alternate=x):(x.pendingProps=f,x.type=d.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=d.flags&65011712,x.childLanes=d.childLanes,x.lanes=d.lanes,x.child=d.child,x.memoizedProps=d.memoizedProps,x.memoizedState=d.memoizedState,x.updateQueue=d.updateQueue,f=d.dependencies,x.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},x.sibling=d.sibling,x.index=d.index,x.ref=d.ref,x.refCleanup=d.refCleanup,x}function np(d,f){d.flags&=65011714;var x=d.alternate;return x===null?(d.childLanes=0,d.lanes=f,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=x.childLanes,d.lanes=x.lanes,d.child=x.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=x.memoizedProps,d.memoizedState=x.memoizedState,d.updateQueue=x.updateQueue,d.type=x.type,f=x.dependencies,d.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),d}function Cf(d,f,x,N,P,F){var ie=0;if(N=d,typeof d=="function")eg(d)&&(ie=1);else if(typeof d=="string")ie=Foe(d,x,Z.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case M:return d=Xa(31,x,f,P),d.elementType=M,d.lanes=F,d;case v:return sd(x.children,P,F,f);case w:ie=8,P|=24;break;case j:return d=Xa(12,x,f,P|2),d.elementType=j,d.lanes=F,d;case O:return d=Xa(13,x,f,P),d.elementType=O,d.lanes=F,d;case B:return d=Xa(19,x,f,P),d.elementType=B,d.lanes=F,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case E:ie=10;break e;case _:ie=9;break e;case I:ie=11;break e;case S:ie=14;break e;case T:ie=16,N=null;break e}ie=29,x=Error(n(130,d===null?"null":typeof d,"")),N=null}return f=Xa(ie,x,f,P),f.elementType=d,f.type=N,f.lanes=F,f}function sd(d,f,x,N){return d=Xa(7,d,N,f),d.lanes=x,d}function sp(d,f,x){return d=Xa(6,d,null,f),d.lanes=x,d}function tg(d){var f=Xa(18,null,null,0);return f.stateNode=d,f}function Ef(d,f,x){return f=Xa(4,d.children!==null?d.children:[],d.key,f),f.lanes=x,f.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},f}var rg=new WeakMap;function Ll(d,f){if(typeof d=="object"&&d!==null){var x=rg.get(d);return x!==void 0?x:(f={value:d,source:f,stack:Ve(f)},rg.set(d,f),f)}return{value:d,source:f,stack:Ve(f)}}var Af=[],ih=0,ng=null,ip=0,Pl=[],Ol=0,id=null,Rl=1,Ml="";function al(d,f){Af[ih++]=ip,Af[ih++]=ng,ng=d,ip=f}function P2(d,f,x){Pl[Ol++]=Rl,Pl[Ol++]=Ml,Pl[Ol++]=id,id=d;var N=Rl;d=Ml;var P=32-Ot(N)-1;N&=~(1<<P),x+=1;var F=32-Ot(f)+P;if(30<F){var ie=P-P%5;F=(N&(1<<ie)-1).toString(32),N>>=ie,P-=ie,Rl=1<<32-Ot(f)+P|x<<P|N,Ml=F+d}else Rl=1<<F|x<<P|N,Ml=d}function Rb(d){d.return!==null&&(al(d,1),P2(d,1,0))}function sg(d){for(;d===ng;)ng=Af[--ih],Af[ih]=null,ip=Af[--ih],Af[ih]=null;for(;d===id;)id=Pl[--Ol],Pl[Ol]=null,Ml=Pl[--Ol],Pl[Ol]=null,Rl=Pl[--Ol],Pl[Ol]=null}function O2(d,f){Pl[Ol++]=Rl,Pl[Ol++]=Ml,Pl[Ol++]=id,Rl=f.id,Ml=f.overflow,id=d}var Ea=null,Ls=null,bn=!1,wo=null,ci=!1,lc=Error(n(519));function ad(d){var f=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Tf(Ll(f,d)),lc}function Mb(d){var f=d.stateNode,x=d.type,N=d.memoizedProps;switch(f[Ft]=d,f[tr]=N,x){case"dialog":vn("cancel",f),vn("close",f);break;case"iframe":case"object":case"embed":vn("load",f);break;case"video":case"audio":for(x=0;x<sy.length;x++)vn(sy[x],f);break;case"source":vn("error",f);break;case"img":case"image":case"link":vn("error",f),vn("load",f);break;case"details":vn("toggle",f);break;case"input":vn("invalid",f),Sl(f,N.value,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name,!0);break;case"select":vn("invalid",f);break;case"textarea":vn("invalid",f),Ks(f,N.value,N.defaultValue,N.children)}x=N.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||f.textContent===""+x||N.suppressHydrationWarning===!0||CM(f.textContent,x)?(N.popover!=null&&(vn("beforetoggle",f),vn("toggle",f)),N.onScroll!=null&&vn("scroll",f),N.onScrollEnd!=null&&vn("scrollend",f),N.onClick!=null&&(f.onclick=la),f=!0):f=!1,f||ad(d,!0)}function xu(d){for(Ea=d.return;Ea;)switch(Ea.tag){case 5:case 31:case 13:ci=!1;return;case 27:case 3:ci=!0;return;default:Ea=Ea.return}}function Aa(d){if(d!==Ea)return!1;if(!bn)return xu(d),bn=!0,!1;var f=d.tag,x;if((x=f!==3&&f!==27)&&((x=f===5)&&(x=d.type,x=!(x!=="form"&&x!=="button")||_S(d.type,d.memoizedProps)),x=!x),x&&Ls&&ad(d),xu(d),f===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));Ls=MM(d)}else if(f===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));Ls=MM(d)}else f===27?(f=Ls,Vf(d.type)?(d=TS,TS=null,Ls=d):Ls=f):Ls=Ea?Fc(d.stateNode.nextSibling):null;return!0}function ah(){Ls=Ea=null,bn=!1}function Db(){var d=wo;return d!==null&&(zl===null?zl=d:zl.push.apply(zl,d),wo=null),d}function Tf(d){wo===null?wo=[d]:wo.push(d)}var ig=q(null),od=null,Dc=null;function ld(d,f,x){W(ig,f._currentValue),f._currentValue=x}function Dl(d){d._currentValue=ig.current,U(ig)}function If(d,f,x){for(;d!==null;){var N=d.alternate;if((d.childLanes&f)!==f?(d.childLanes|=f,N!==null&&(N.childLanes|=f)):N!==null&&(N.childLanes&f)!==f&&(N.childLanes|=f),d===x)break;d=d.return}}function oh(d,f,x,N){var P=d.child;for(P!==null&&(P.return=d);P!==null;){var F=P.dependencies;if(F!==null){var ie=P.child;F=F.firstContext;e:for(;F!==null;){var ge=F;F=P;for(var Le=0;Le<f.length;Le++)if(ge.context===f[Le]){F.lanes|=x,ge=F.alternate,ge!==null&&(ge.lanes|=x),If(F.return,x,d),N||(ie=null);break e}F=ge.next}}else if(P.tag===18){if(ie=P.return,ie===null)throw Error(n(341));ie.lanes|=x,F=ie.alternate,F!==null&&(F.lanes|=x),If(ie,x,d),ie=null}else ie=P.child;if(ie!==null)ie.return=P;else for(ie=P;ie!==null;){if(ie===d){ie=null;break}if(P=ie.sibling,P!==null){P.return=ie.return,ie=P;break}ie=ie.return}P=ie}}function cd(d,f,x,N){d=null;for(var P=f,F=!1;P!==null;){if(!F){if((P.flags&524288)!==0)F=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var ie=P.alternate;if(ie===null)throw Error(n(387));if(ie=ie.memoizedProps,ie!==null){var ge=P.type;Sa(P.pendingProps.value,ie.value)||(d!==null?d.push(ge):d=[ge])}}else if(P===oe.current){if(ie=P.alternate,ie===null)throw Error(n(387));ie.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(d!==null?d.push(cy):d=[cy])}P=P.return}d!==null&&oh(f,d,x,N),f.flags|=262144}function ag(d){for(d=d.firstContext;d!==null;){if(!Sa(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function ud(d){od=d,Dc=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Ta(d){return R2(od,d)}function og(d,f){return od===null&&ud(d),R2(d,f)}function R2(d,f){var x=f._currentValue;if(f={context:f,memoizedValue:x,next:null},Dc===null){if(d===null)throw Error(n(308));Dc=f,d.dependencies={lanes:0,firstContext:f},d.flags|=524288}else Dc=Dc.next=f;return x}var A_=typeof AbortController<"u"?AbortController:function(){var d=[],f=this.signal={aborted:!1,addEventListener:function(x,N){d.push(N)}};this.abort=function(){f.aborted=!0,d.forEach(function(x){return x()})}},T_=t.unstable_scheduleCallback,I_=t.unstable_NormalPriority,Si={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lf(){return{controller:new A_,data:new Map,refCount:0}}function ap(d){d.refCount--,d.refCount===0&&T_(I_,function(){d.controller.abort()})}var op=null,lg=0,C=0,D=null;function G(d,f){if(op===null){var x=op=[];lg=0,C=gS(),D={status:"pending",value:void 0,then:function(N){x.push(N)}}}return lg++,f.then(te,te),f}function te(){if(--lg===0&&op!==null){D!==null&&(D.status="fulfilled");var d=op;op=null,C=0,D=null;for(var f=0;f<d.length;f++)(0,d[f])()}}function he(d,f){var x=[],N={status:"pending",value:null,reason:null,then:function(P){x.push(P)}};return d.then(function(){N.status="fulfilled",N.value=f;for(var P=0;P<x.length;P++)(0,x[P])(f)},function(P){for(N.status="rejected",N.reason=P,P=0;P<x.length;P++)(0,x[P])(void 0)}),N}var fe=X.S;X.S=function(d,f){QR=at(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&G(d,f),fe!==null&&fe(d,f)};var pe=q(null);function ve(){var d=pe.current;return d!==null?d:Os.pooledCache}function je(d,f){f===null?W(pe,pe.current):W(pe,f.pool)}function Ce(){var d=ve();return d===null?null:{parent:Si._currentValue,pool:d}}var De=Error(n(460)),Qe=Error(n(474)),Se=Error(n(542)),Ue={then:function(){}};function Ke(d){return d=d.status,d==="fulfilled"||d==="rejected"}function xt(d,f,x){switch(x=d[x],x===void 0?d.push(f):x!==f&&(f.then(la,la),f=x),f.status){case"fulfilled":return f.value;case"rejected":throw d=f.reason,Bt(d),d;default:if(typeof f.status=="string")f.then(la,la);else{if(d=Os,d!==null&&100<d.shellSuspendCounter)throw Error(n(482));d=f,d.status="pending",d.then(function(N){if(f.status==="pending"){var P=f;P.status="fulfilled",P.value=N}},function(N){if(f.status==="pending"){var P=f;P.status="rejected",P.reason=N}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw d=f.reason,Bt(d),d}throw mt=f,De}}function Xe(d){try{var f=d._init;return f(d._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(mt=x,De):x}}var mt=null;function wt(){if(mt===null)throw Error(n(459));var d=mt;return mt=null,d}function Bt(d){if(d===De||d===Se)throw Error(n(483))}var Et=null,fr=0;function sr(d){var f=fr;return fr+=1,Et===null&&(Et=[]),xt(Et,d,f)}function Wr(d,f){f=f.props.ref,d.ref=f!==void 0?f:null}function lr(d,f){throw f.$$typeof===m?Error(n(525)):(d=Object.prototype.toString.call(f),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":d)))}function mn(d){function f(He,$e){if(d){var Ze=He.deletions;Ze===null?(He.deletions=[$e],He.flags|=16):Ze.push($e)}}function x(He,$e){if(!d)return null;for(;$e!==null;)f(He,$e),$e=$e.sibling;return null}function N(He){for(var $e=new Map;He!==null;)He.key!==null?$e.set(He.key,He):$e.set(He.index,He),He=He.sibling;return $e}function P(He,$e){return He=Il(He,$e),He.index=0,He.sibling=null,He}function F(He,$e,Ze){return He.index=Ze,d?(Ze=He.alternate,Ze!==null?(Ze=Ze.index,Ze<$e?(He.flags|=67108866,$e):Ze):(He.flags|=67108866,$e)):(He.flags|=1048576,$e)}function ie(He){return d&&He.alternate===null&&(He.flags|=67108866),He}function ge(He,$e,Ze,kt){return $e===null||$e.tag!==6?($e=sp(Ze,He.mode,kt),$e.return=He,$e):($e=P($e,Ze),$e.return=He,$e)}function Le(He,$e,Ze,kt){var Pr=Ze.type;return Pr===v?yt(He,$e,Ze.props.children,kt,Ze.key):$e!==null&&($e.elementType===Pr||typeof Pr=="object"&&Pr!==null&&Pr.$$typeof===T&&Xe(Pr)===$e.type)?($e=P($e,Ze.props),Wr($e,Ze),$e.return=He,$e):($e=Cf(Ze.type,Ze.key,Ze.props,null,He.mode,kt),Wr($e,Ze),$e.return=He,$e)}function tt(He,$e,Ze,kt){return $e===null||$e.tag!==4||$e.stateNode.containerInfo!==Ze.containerInfo||$e.stateNode.implementation!==Ze.implementation?($e=Ef(Ze,He.mode,kt),$e.return=He,$e):($e=P($e,Ze.children||[]),$e.return=He,$e)}function yt(He,$e,Ze,kt,Pr){return $e===null||$e.tag!==7?($e=sd(Ze,He.mode,kt,Pr),$e.return=He,$e):($e=P($e,Ze),$e.return=He,$e)}function Ct(He,$e,Ze){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return $e=sp(""+$e,He.mode,Ze),$e.return=He,$e;if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case g:return Ze=Cf($e.type,$e.key,$e.props,null,He.mode,Ze),Wr(Ze,$e),Ze.return=He,Ze;case b:return $e=Ef($e,He.mode,Ze),$e.return=He,$e;case T:return $e=Xe($e),Ct(He,$e,Ze)}if(Y($e)||L($e))return $e=sd($e,He.mode,Ze,null),$e.return=He,$e;if(typeof $e.then=="function")return Ct(He,sr($e),Ze);if($e.$$typeof===E)return Ct(He,og(He,$e),Ze);lr(He,$e)}return null}function lt(He,$e,Ze,kt){var Pr=$e!==null?$e.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Pr!==null?null:ge(He,$e,""+Ze,kt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:return Ze.key===Pr?Le(He,$e,Ze,kt):null;case b:return Ze.key===Pr?tt(He,$e,Ze,kt):null;case T:return Ze=Xe(Ze),lt(He,$e,Ze,kt)}if(Y(Ze)||L(Ze))return Pr!==null?null:yt(He,$e,Ze,kt,null);if(typeof Ze.then=="function")return lt(He,$e,sr(Ze),kt);if(Ze.$$typeof===E)return lt(He,$e,og(He,Ze),kt);lr(He,Ze)}return null}function ht(He,$e,Ze,kt,Pr){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return He=He.get(Ze)||null,ge($e,He,""+kt,Pr);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case g:return He=He.get(kt.key===null?Ze:kt.key)||null,Le($e,He,kt,Pr);case b:return He=He.get(kt.key===null?Ze:kt.key)||null,tt($e,He,kt,Pr);case T:return kt=Xe(kt),ht(He,$e,Ze,kt,Pr)}if(Y(kt)||L(kt))return He=He.get(Ze)||null,yt($e,He,kt,Pr,null);if(typeof kt.then=="function")return ht(He,$e,Ze,sr(kt),Pr);if(kt.$$typeof===E)return ht(He,$e,Ze,og($e,kt),Pr);lr($e,kt)}return null}function dr(He,$e,Ze,kt){for(var Pr=null,Kn=null,xr=$e,on=$e=0,_n=null;xr!==null&&on<Ze.length;on++){xr.index>on?(_n=xr,xr=null):_n=xr.sibling;var Yn=lt(He,xr,Ze[on],kt);if(Yn===null){xr===null&&(xr=_n);break}d&&xr&&Yn.alternate===null&&f(He,xr),$e=F(Yn,$e,on),Kn===null?Pr=Yn:Kn.sibling=Yn,Kn=Yn,xr=_n}if(on===Ze.length)return x(He,xr),bn&&al(He,on),Pr;if(xr===null){for(;on<Ze.length;on++)xr=Ct(He,Ze[on],kt),xr!==null&&($e=F(xr,$e,on),Kn===null?Pr=xr:Kn.sibling=xr,Kn=xr);return bn&&al(He,on),Pr}for(xr=N(xr);on<Ze.length;on++)_n=ht(xr,He,on,Ze[on],kt),_n!==null&&(d&&_n.alternate!==null&&xr.delete(_n.key===null?on:_n.key),$e=F(_n,$e,on),Kn===null?Pr=_n:Kn.sibling=_n,Kn=_n);return d&&xr.forEach(function(Yf){return f(He,Yf)}),bn&&al(He,on),Pr}function $r(He,$e,Ze,kt){if(Ze==null)throw Error(n(151));for(var Pr=null,Kn=null,xr=$e,on=$e=0,_n=null,Yn=Ze.next();xr!==null&&!Yn.done;on++,Yn=Ze.next()){xr.index>on?(_n=xr,xr=null):_n=xr.sibling;var Yf=lt(He,xr,Yn.value,kt);if(Yf===null){xr===null&&(xr=_n);break}d&&xr&&Yf.alternate===null&&f(He,xr),$e=F(Yf,$e,on),Kn===null?Pr=Yf:Kn.sibling=Yf,Kn=Yf,xr=_n}if(Yn.done)return x(He,xr),bn&&al(He,on),Pr;if(xr===null){for(;!Yn.done;on++,Yn=Ze.next())Yn=Ct(He,Yn.value,kt),Yn!==null&&($e=F(Yn,$e,on),Kn===null?Pr=Yn:Kn.sibling=Yn,Kn=Yn);return bn&&al(He,on),Pr}for(xr=N(xr);!Yn.done;on++,Yn=Ze.next())Yn=ht(xr,He,on,Yn.value,kt),Yn!==null&&(d&&Yn.alternate!==null&&xr.delete(Yn.key===null?on:Yn.key),$e=F(Yn,$e,on),Kn===null?Pr=Yn:Kn.sibling=Yn,Kn=Yn);return d&&xr.forEach(function(Qoe){return f(He,Qoe)}),bn&&al(He,on),Pr}function Ss(He,$e,Ze,kt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===v&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:e:{for(var Pr=Ze.key;$e!==null;){if($e.key===Pr){if(Pr=Ze.type,Pr===v){if($e.tag===7){x(He,$e.sibling),kt=P($e,Ze.props.children),kt.return=He,He=kt;break e}}else if($e.elementType===Pr||typeof Pr=="object"&&Pr!==null&&Pr.$$typeof===T&&Xe(Pr)===$e.type){x(He,$e.sibling),kt=P($e,Ze.props),Wr(kt,Ze),kt.return=He,He=kt;break e}x(He,$e);break}else f(He,$e);$e=$e.sibling}Ze.type===v?(kt=sd(Ze.props.children,He.mode,kt,Ze.key),kt.return=He,He=kt):(kt=Cf(Ze.type,Ze.key,Ze.props,null,He.mode,kt),Wr(kt,Ze),kt.return=He,He=kt)}return ie(He);case b:e:{for(Pr=Ze.key;$e!==null;){if($e.key===Pr)if($e.tag===4&&$e.stateNode.containerInfo===Ze.containerInfo&&$e.stateNode.implementation===Ze.implementation){x(He,$e.sibling),kt=P($e,Ze.children||[]),kt.return=He,He=kt;break e}else{x(He,$e);break}else f(He,$e);$e=$e.sibling}kt=Ef(Ze,He.mode,kt),kt.return=He,He=kt}return ie(He);case T:return Ze=Xe(Ze),Ss(He,$e,Ze,kt)}if(Y(Ze))return dr(He,$e,Ze,kt);if(L(Ze)){if(Pr=L(Ze),typeof Pr!="function")throw Error(n(150));return Ze=Pr.call(Ze),$r(He,$e,Ze,kt)}if(typeof Ze.then=="function")return Ss(He,$e,sr(Ze),kt);if(Ze.$$typeof===E)return Ss(He,$e,og(He,Ze),kt);lr(He,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,$e!==null&&$e.tag===6?(x(He,$e.sibling),kt=P($e,Ze),kt.return=He,He=kt):(x(He,$e),kt=sp(Ze,He.mode,kt),kt.return=He,He=kt),ie(He)):x(He,$e)}return function(He,$e,Ze,kt){try{fr=0;var Pr=Ss(He,$e,Ze,kt);return Et=null,Pr}catch(xr){if(xr===De||xr===Se)throw xr;var Kn=Xa(29,xr,null,He.mode);return Kn.lanes=kt,Kn.return=He,Kn}}}var Ps=mn(!0),Jr=mn(!1),ir=!1;function Yt(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xs(d,f){d=d.updateQueue,f.updateQueue===d&&(f.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Dr(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function nn(d,f,x){var N=d.updateQueue;if(N===null)return null;if(N=N.shared,(ns&2)!==0){var P=N.pending;return P===null?f.next=f:(f.next=P.next,P.next=f),N.pending=f,f=Ya(d),rp(d,null,x),f}return tp(d,N,f,x),Ya(d)}function ts(d,f,x){if(f=f.updateQueue,f!==null&&(f=f.shared,(x&4194048)!==0)){var N=f.lanes;N&=d.pendingLanes,x|=N,f.lanes=x,et(d,x)}}function Ji(d,f){var x=d.updateQueue,N=d.alternate;if(N!==null&&(N=N.updateQueue,x===N)){var P=null,F=null;if(x=x.firstBaseUpdate,x!==null){do{var ie={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};F===null?P=F=ie:F=F.next=ie,x=x.next}while(x!==null);F===null?P=F=f:F=F.next=f}else P=F=f;x={baseState:N.baseState,firstBaseUpdate:P,lastBaseUpdate:F,shared:N.shared,callbacks:N.callbacks},d.updateQueue=x;return}d=x.lastBaseUpdate,d===null?x.firstBaseUpdate=f:d.next=f,x.lastBaseUpdate=f}var Ia=!1;function js(){if(Ia){var d=D;if(d!==null)throw d}}function Di(d,f,x,N){Ia=!1;var P=d.updateQueue;ir=!1;var F=P.firstBaseUpdate,ie=P.lastBaseUpdate,ge=P.shared.pending;if(ge!==null){P.shared.pending=null;var Le=ge,tt=Le.next;Le.next=null,ie===null?F=tt:ie.next=tt,ie=Le;var yt=d.alternate;yt!==null&&(yt=yt.updateQueue,ge=yt.lastBaseUpdate,ge!==ie&&(ge===null?yt.firstBaseUpdate=tt:ge.next=tt,yt.lastBaseUpdate=Le))}if(F!==null){var Ct=P.baseState;ie=0,yt=tt=Le=null,ge=F;do{var lt=ge.lane&-536870913,ht=lt!==ge.lane;if(ht?(kn&lt)===lt:(N&lt)===lt){lt!==0&&lt===C&&(Ia=!0),yt!==null&&(yt=yt.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var dr=d,$r=ge;lt=f;var Ss=x;switch($r.tag){case 1:if(dr=$r.payload,typeof dr=="function"){Ct=dr.call(Ss,Ct,lt);break e}Ct=dr;break e;case 3:dr.flags=dr.flags&-65537|128;case 0:if(dr=$r.payload,lt=typeof dr=="function"?dr.call(Ss,Ct,lt):dr,lt==null)break e;Ct=p({},Ct,lt);break e;case 2:ir=!0}}lt=ge.callback,lt!==null&&(d.flags|=64,ht&&(d.flags|=8192),ht=P.callbacks,ht===null?P.callbacks=[lt]:ht.push(lt))}else ht={lane:lt,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},yt===null?(tt=yt=ht,Le=Ct):yt=yt.next=ht,ie|=lt;if(ge=ge.next,ge===null){if(ge=P.shared.pending,ge===null)break;ht=ge,ge=ht.next,ht.next=null,P.lastBaseUpdate=ht,P.shared.pending=null}}while(!0);yt===null&&(Le=Ct),P.baseState=Le,P.firstBaseUpdate=tt,P.lastBaseUpdate=yt,F===null&&(P.shared.lanes=0),$f|=ie,d.lanes=ie,d.memoizedState=Ct}}function Qa(d,f){if(typeof d!="function")throw Error(n(191,d));d.call(f)}function Bi(d,f){var x=d.callbacks;if(x!==null)for(d.callbacks=null,d=0;d<x.length;d++)Qa(x[d],f)}var dn=q(null),Mn=q(0);function Qs(d,f){d=xh,W(Mn,d),W(dn,f),xh=d|f.baseLanes}function qn(){W(Mn,xh),W(dn,dn.current)}function Zi(){xh=Mn.current,U(dn),U(Mn)}var Js=q(null),Dn=null;function Ci(d){var f=d.alternate;W(An,An.current&1),W(Js,d),Dn===null&&(f===null||dn.current!==null||f.memoizedState!==null)&&(Dn=d)}function rs(d){W(An,An.current),W(Js,d),Dn===null&&(Dn=d)}function $i(d){d.tag===22?(W(An,An.current),W(Js,d),Dn===null&&(Dn=d)):Fi()}function Fi(){W(An,An.current),W(Js,Js.current)}function us(d){U(Js),Dn===d&&(Dn=null),U(An)}var An=q(0);function Ja(d){for(var f=d;f!==null;){if(f.tag===13){var x=f.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||ES(x)||AS(x)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===d)break;for(;f.sibling===null;){if(f.return===null||f.return===d)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var ui=0,Ar=null,Lr=null,Bn=null,zo=!1,Bl=!1,No=!1,Ui=0,dd=0,hd=null,cg=0;function ks(){throw Error(n(321))}function Bb(d,f){if(f===null)return!1;for(var x=0;x<f.length&&x<d.length;x++)if(!Sa(d[x],f[x]))return!1;return!0}function $b(d,f,x,N,P,F){return ui=F,Ar=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,X.H=d===null||d.memoizedState===null?lR:$_,No=!1,F=x(N,P),No=!1,Bl&&(F=bu(f,x,N,P)),ug(d),F}function ug(d){X.H=Gb;var f=Lr!==null&&Lr.next!==null;if(ui=0,Bn=Lr=Ar=null,zo=!1,dd=0,hd=null,f)throw Error(n(300));d===null||da||(d=d.dependencies,d!==null&&ag(d)&&(da=!0))}function bu(d,f,x,N){Ar=d;var P=0;do{if(Bl&&(hd=null),dd=0,Bl=!1,25<=P)throw Error(n(301));if(P+=1,Bn=Lr=null,d.updateQueue!=null){var F=d.updateQueue;F.lastEffect=null,F.events=null,F.stores=null,F.memoCache!=null&&(F.memoCache.index=0)}X.H=cR,F=f(x,N)}while(Bl);return F}function L_(){var d=X.H,f=d.useState()[0];return f=typeof f.then=="function"?fd(f):f,d=d.useState()[0],(Lr!==null?Lr.memoizedState:null)!==d&&(Ar.flags|=1024),f}function Fb(){var d=Ui!==0;return Ui=0,d}function Ub(d,f,x){f.updateQueue=d.updateQueue,f.flags&=-2053,d.lanes&=~x}function dg(d){if(zo){for(d=d.memoizedState;d!==null;){var f=d.queue;f!==null&&(f.pending=null),d=d.next}zo=!1}ui=0,Bn=Lr=Ar=null,Bl=!1,dd=Ui=0,hd=null}function ua(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?Ar.memoizedState=Bn=d:Bn=Bn.next=d,Bn}function di(){if(Lr===null){var d=Ar.alternate;d=d!==null?d.memoizedState:null}else d=Lr.next;var f=Bn===null?Ar.memoizedState:Bn.next;if(f!==null)Bn=f,Lr=d;else{if(d===null)throw Ar.alternate===null?Error(n(467)):Error(n(310));Lr=d,d={memoizedState:Lr.memoizedState,baseState:Lr.baseState,baseQueue:Lr.baseQueue,queue:Lr.queue,next:null},Bn===null?Ar.memoizedState=Bn=d:Bn=Bn.next=d}return Bn}function lp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fd(d){var f=dd;return dd+=1,hd===null&&(hd=[]),d=xt(hd,d,f),f=Ar,(Bn===null?f.memoizedState:Bn.next)===null&&(f=f.alternate,X.H=f===null||f.memoizedState===null?lR:$_),d}function Pf(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return fd(d);if(d.$$typeof===E)return Ta(d)}throw Error(n(438,String(d)))}function lh(d){var f=null,x=Ar.updateQueue;if(x!==null&&(f=x.memoCache),f==null){var N=Ar.alternate;N!==null&&(N=N.updateQueue,N!==null&&(N=N.memoCache,N!=null&&(f={data:N.data.map(function(P){return P.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),x===null&&(x=lp(),Ar.updateQueue=x),x.memoCache=f,x=f.data[f.index],x===void 0)for(x=f.data[f.index]=Array(d),N=0;N<d;N++)x[N]=$;return f.index++,x}function Bc(d,f){return typeof f=="function"?f(d):f}function hg(d){var f=di();return Of(f,Lr,d)}function Of(d,f,x){var N=d.queue;if(N===null)throw Error(n(311));N.lastRenderedReducer=x;var P=d.baseQueue,F=N.pending;if(F!==null){if(P!==null){var ie=P.next;P.next=F.next,F.next=ie}f.baseQueue=P=F,N.pending=null}if(F=d.baseState,P===null)d.memoizedState=F;else{f=P.next;var ge=ie=null,Le=null,tt=f,yt=!1;do{var Ct=tt.lane&-536870913;if(Ct!==tt.lane?(kn&Ct)===Ct:(ui&Ct)===Ct){var lt=tt.revertLane;if(lt===0)Le!==null&&(Le=Le.next={lane:0,revertLane:0,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),Ct===C&&(yt=!0);else if((ui&lt)===lt){tt=tt.next,lt===C&&(yt=!0);continue}else Ct={lane:0,revertLane:tt.revertLane,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Le===null?(ge=Le=Ct,ie=F):Le=Le.next=Ct,Ar.lanes|=lt,$f|=lt;Ct=tt.action,No&&x(F,Ct),F=tt.hasEagerState?tt.eagerState:x(F,Ct)}else lt={lane:Ct,revertLane:tt.revertLane,gesture:tt.gesture,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Le===null?(ge=Le=lt,ie=F):Le=Le.next=lt,Ar.lanes|=Ct,$f|=Ct;tt=tt.next}while(tt!==null&&tt!==f);if(Le===null?ie=F:Le.next=ge,!Sa(F,d.memoizedState)&&(da=!0,yt&&(x=D,x!==null)))throw x;d.memoizedState=F,d.baseState=ie,d.baseQueue=Le,N.lastRenderedState=F}return P===null&&(N.lanes=0),[d.memoizedState,N.dispatch]}function fg(d){var f=di(),x=f.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=d;var N=x.dispatch,P=x.pending,F=f.memoizedState;if(P!==null){x.pending=null;var ie=P=P.next;do F=d(F,ie.action),ie=ie.next;while(ie!==P);Sa(F,f.memoizedState)||(da=!0),f.memoizedState=F,f.baseQueue===null&&(f.baseState=F),x.lastRenderedState=F}return[F,N]}function pg(d,f,x){var N=Ar,P=di(),F=bn;if(F){if(x===void 0)throw Error(n(407));x=x()}else x=f();var ie=!Sa((Lr||P).memoizedState,x);if(ie&&(P.memoizedState=x,da=!0),P=P.queue,P_(qb.bind(null,N,P,d),[d]),P.getSnapshot!==f||ie||Bn!==null&&Bn.memoizedState.tag&1){if(N.flags|=2048,uh(9,{destroy:void 0},zb.bind(null,N,P,x,f),null),Os===null)throw Error(n(349));F||(ui&127)!==0||yu(N,f,x)}return x}function yu(d,f,x){d.flags|=16384,d={getSnapshot:f,value:x},f=Ar.updateQueue,f===null?(f=lp(),Ar.updateQueue=f,f.stores=[d]):(x=f.stores,x===null?f.stores=[d]:x.push(d))}function zb(d,f,x,N){f.value=x,f.getSnapshot=N,M2(f)&&Vb(d)}function qb(d,f,x){return x(function(){M2(f)&&Vb(d)})}function M2(d){var f=d.getSnapshot;d=d.value;try{var x=f();return!Sa(d,x)}catch{return!0}}function Vb(d){var f=gu(d,2);f!==null&&ql(f,d,2)}function pd(d){var f=ua();if(typeof d=="function"){var x=d;if(d=x(),No){rt(!0);try{x()}finally{rt(!1)}}}return f.memoizedState=f.baseState=d,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:d},f}function D2(d,f,x,N){return d.baseState=x,Of(d,Lr,typeof N=="function"?N:Bc)}function B2(d,f,x,N,P){if(z2(d))throw Error(n(485));if(d=f.action,d!==null){var F={payload:P,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ie){F.listeners.push(ie)}};X.T!==null?x(!0):F.isTransition=!1,N(F),x=f.pending,x===null?(F.next=f.pending=F,$2(f,F)):(F.next=x.next,f.pending=x.next=F)}}function $2(d,f){var x=f.action,N=f.payload,P=d.state;if(f.isTransition){var F=X.T,ie={};X.T=ie;try{var ge=x(P,N),Le=X.S;Le!==null&&Le(ie,ge),Hb(d,f,ge)}catch(tt){ch(d,f,tt)}finally{F!==null&&ie.types!==null&&(F.types=ie.types),X.T=F}}else try{F=x(P,N),Hb(d,f,F)}catch(tt){ch(d,f,tt)}}function Hb(d,f,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(N){F2(d,f,N)},function(N){return ch(d,f,N)}):F2(d,f,x)}function F2(d,f,x){f.status="fulfilled",f.value=x,mg(f),d.state=x,f=d.pending,f!==null&&(x=f.next,x===f?d.pending=null:(x=x.next,f.next=x,$2(d,x)))}function ch(d,f,x){var N=d.pending;if(d.pending=null,N!==null){N=N.next;do f.status="rejected",f.reason=x,mg(f),f=f.next;while(f!==N)}d.action=null}function mg(d){d=d.listeners;for(var f=0;f<d.length;f++)(0,d[f])()}function cp(d,f){return f}function $c(d,f){if(bn){var x=Os.formState;if(x!==null){e:{var N=Ar;if(bn){if(Ls){t:{for(var P=Ls,F=ci;P.nodeType!==8;){if(!F){P=null;break t}if(P=Fc(P.nextSibling),P===null){P=null;break t}}F=P.data,P=F==="F!"||F==="F"?P:null}if(P){Ls=Fc(P.nextSibling),N=P.data==="F!";break e}}ad(N)}N=!1}N&&(f=x[0])}}return x=ua(),x.memoizedState=x.baseState=f,N={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cp,lastRenderedState:f},x.queue=N,x=iR.bind(null,Ar,N),N.dispatch=x,N=pd(!1),F=B_.bind(null,Ar,!1,N.queue),N=ua(),P={state:f,dispatch:null,action:d,pending:null},N.queue=P,x=B2.bind(null,Ar,P,F,x),P.dispatch=x,N.memoizedState=d,[f,x,!1]}function vu(d){var f=di();return wu(f,Lr,d)}function wu(d,f,x){if(f=Of(d,f,cp)[0],d=hg(Bc)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var N=fd(f)}catch(ie){throw ie===De?Se:ie}else N=f;f=di();var P=f.queue,F=P.dispatch;return x!==f.memoizedState&&(Ar.flags|=2048,uh(9,{destroy:void 0},gg.bind(null,P,x),null)),[N,F,d]}function gg(d,f){d.action=f}function xg(d){var f=di(),x=Lr;if(x!==null)return wu(f,x,d);di(),f=f.memoizedState,x=di();var N=x.queue.dispatch;return x.memoizedState=d,[f,N,!1]}function uh(d,f,x,N){return d={tag:d,create:x,deps:N,inst:f,next:null},f=Ar.updateQueue,f===null&&(f=lp(),Ar.updateQueue=f),x=f.lastEffect,x===null?f.lastEffect=d.next=d:(N=x.next,x.next=d,d.next=N,f.lastEffect=d),d}function U2(){return di().memoizedState}function Rf(d,f,x,N){var P=ua();Ar.flags|=d,P.memoizedState=uh(1|f,{destroy:void 0},x,N===void 0?null:N)}function Mf(d,f,x,N){var P=di();N=N===void 0?null:N;var F=P.memoizedState.inst;Lr!==null&&N!==null&&Bb(N,Lr.memoizedState.deps)?P.memoizedState=uh(f,F,x,N):(Ar.flags|=d,P.memoizedState=uh(1|f,F,x,N))}function HO(d,f){Rf(8390656,8,d,f)}function P_(d,f){Mf(2048,8,d,f)}function Hae(d){Ar.flags|=4;var f=Ar.updateQueue;if(f===null)f=lp(),Ar.updateQueue=f,f.events=[d];else{var x=f.events;x===null?f.events=[d]:x.push(d)}}function WO(d){var f=di().memoizedState;return Hae({ref:f,nextImpl:d}),function(){if((ns&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}function GO(d,f){return Mf(4,2,d,f)}function KO(d,f){return Mf(4,4,d,f)}function YO(d,f){if(typeof f=="function"){d=d();var x=f(d);return function(){typeof x=="function"?x():f(null)}}if(f!=null)return d=d(),f.current=d,function(){f.current=null}}function XO(d,f,x){x=x!=null?x.concat([d]):null,Mf(4,4,YO.bind(null,f,d),x)}function O_(){}function QO(d,f){var x=di();f=f===void 0?null:f;var N=x.memoizedState;return f!==null&&Bb(f,N[1])?N[0]:(x.memoizedState=[d,f],d)}function JO(d,f){var x=di();f=f===void 0?null:f;var N=x.memoizedState;if(f!==null&&Bb(f,N[1]))return N[0];if(N=d(),No){rt(!0);try{d()}finally{rt(!1)}}return x.memoizedState=[N,f],N}function R_(d,f,x){return x===void 0||(ui&1073741824)!==0&&(kn&261930)===0?d.memoizedState=f:(d.memoizedState=x,d=ZR(),Ar.lanes|=d,$f|=d,x)}function ZO(d,f,x,N){return Sa(x,f)?x:dn.current!==null?(d=R_(d,x,N),Sa(d,f)||(da=!0),d):(ui&42)===0||(ui&1073741824)!==0&&(kn&261930)===0?(da=!0,d.memoizedState=x):(d=ZR(),Ar.lanes|=d,$f|=d,f)}function eR(d,f,x,N,P){var F=J.p;J.p=F!==0&&8>F?F:8;var ie=X.T,ge={};X.T=ge,B_(d,!1,f,x);try{var Le=P(),tt=X.S;if(tt!==null&&tt(ge,Le),Le!==null&&typeof Le=="object"&&typeof Le.then=="function"){var yt=he(Le,N);Wb(d,f,yt,dc(d))}else Wb(d,f,N,dc(d))}catch(Ct){Wb(d,f,{then:function(){},status:"rejected",reason:Ct},dc())}finally{J.p=F,ie!==null&&ge.types!==null&&(ie.types=ge.types),X.T=ie}}function Wae(){}function M_(d,f,x,N){if(d.tag!==5)throw Error(n(476));var P=tR(d).queue;eR(d,P,f,re,x===null?Wae:function(){return rR(d),x(N)})}function tR(d){var f=d.memoizedState;if(f!==null)return f;f={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:re},next:null};var x={};return f.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:x},next:null},d.memoizedState=f,d=d.alternate,d!==null&&(d.memoizedState=f),f}function rR(d){var f=tR(d);f.next===null&&(f=d.alternate.memoizedState),Wb(d,f.next.queue,{},dc())}function D_(){return Ta(cy)}function nR(){return di().memoizedState}function sR(){return di().memoizedState}function Gae(d){for(var f=d.return;f!==null;){switch(f.tag){case 24:case 3:var x=dc();d=Dr(x);var N=nn(f,d,x);N!==null&&(ql(N,f,x),ts(N,f,x)),f={cache:Lf()},d.payload=f;return}f=f.return}}function Kae(d,f,x){var N=dc();x={lane:N,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},z2(d)?aR(f,x):(x=Jm(d,f,x,N),x!==null&&(ql(x,d,N),oR(x,f,N)))}function iR(d,f,x){var N=dc();Wb(d,f,x,N)}function Wb(d,f,x,N){var P={lane:N,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(z2(d))aR(f,P);else{var F=d.alternate;if(d.lanes===0&&(F===null||F.lanes===0)&&(F=f.lastRenderedReducer,F!==null))try{var ie=f.lastRenderedState,ge=F(ie,x);if(P.hasEagerState=!0,P.eagerState=ge,Sa(ge,ie))return tp(d,f,P,0),Os===null&&ep(),!1}catch{}if(x=Jm(d,f,P,N),x!==null)return ql(x,d,N),oR(x,f,N),!0}return!1}function B_(d,f,x,N){if(N={lane:2,revertLane:gS(),gesture:null,action:N,hasEagerState:!1,eagerState:null,next:null},z2(d)){if(f)throw Error(n(479))}else f=Jm(d,x,N,2),f!==null&&ql(f,d,2)}function z2(d){var f=d.alternate;return d===Ar||f!==null&&f===Ar}function aR(d,f){Bl=zo=!0;var x=d.pending;x===null?f.next=f:(f.next=x.next,x.next=f),d.pending=f}function oR(d,f,x){if((x&4194048)!==0){var N=f.lanes;N&=d.pendingLanes,x|=N,f.lanes=x,et(d,x)}}var Gb={readContext:Ta,use:Pf,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useLayoutEffect:ks,useInsertionEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useSyncExternalStore:ks,useId:ks,useHostTransitionStatus:ks,useFormState:ks,useActionState:ks,useOptimistic:ks,useMemoCache:ks,useCacheRefresh:ks};Gb.useEffectEvent=ks;var lR={readContext:Ta,use:Pf,useCallback:function(d,f){return ua().memoizedState=[d,f===void 0?null:f],d},useContext:Ta,useEffect:HO,useImperativeHandle:function(d,f,x){x=x!=null?x.concat([d]):null,Rf(4194308,4,YO.bind(null,f,d),x)},useLayoutEffect:function(d,f){return Rf(4194308,4,d,f)},useInsertionEffect:function(d,f){Rf(4,2,d,f)},useMemo:function(d,f){var x=ua();f=f===void 0?null:f;var N=d();if(No){rt(!0);try{d()}finally{rt(!1)}}return x.memoizedState=[N,f],N},useReducer:function(d,f,x){var N=ua();if(x!==void 0){var P=x(f);if(No){rt(!0);try{x(f)}finally{rt(!1)}}}else P=f;return N.memoizedState=N.baseState=P,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:P},N.queue=d,d=d.dispatch=Kae.bind(null,Ar,d),[N.memoizedState,d]},useRef:function(d){var f=ua();return d={current:d},f.memoizedState=d},useState:function(d){d=pd(d);var f=d.queue,x=iR.bind(null,Ar,f);return f.dispatch=x,[d.memoizedState,x]},useDebugValue:O_,useDeferredValue:function(d,f){var x=ua();return R_(x,d,f)},useTransition:function(){var d=pd(!1);return d=eR.bind(null,Ar,d.queue,!0,!1),ua().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,f,x){var N=Ar,P=ua();if(bn){if(x===void 0)throw Error(n(407));x=x()}else{if(x=f(),Os===null)throw Error(n(349));(kn&127)!==0||yu(N,f,x)}P.memoizedState=x;var F={value:x,getSnapshot:f};return P.queue=F,HO(qb.bind(null,N,F,d),[d]),N.flags|=2048,uh(9,{destroy:void 0},zb.bind(null,N,F,x,f),null),x},useId:function(){var d=ua(),f=Os.identifierPrefix;if(bn){var x=Ml,N=Rl;x=(N&~(1<<32-Ot(N)-1)).toString(32)+x,f="_"+f+"R_"+x,x=Ui++,0<x&&(f+="H"+x.toString(32)),f+="_"}else x=cg++,f="_"+f+"r_"+x.toString(32)+"_";return d.memoizedState=f},useHostTransitionStatus:D_,useFormState:$c,useActionState:$c,useOptimistic:function(d){var f=ua();f.memoizedState=f.baseState=d;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=x,f=B_.bind(null,Ar,!0,x),x.dispatch=f,[d,f]},useMemoCache:lh,useCacheRefresh:function(){return ua().memoizedState=Gae.bind(null,Ar)},useEffectEvent:function(d){var f=ua(),x={impl:d};return f.memoizedState=x,function(){if((ns&2)!==0)throw Error(n(440));return x.impl.apply(void 0,arguments)}}},$_={readContext:Ta,use:Pf,useCallback:QO,useContext:Ta,useEffect:P_,useImperativeHandle:XO,useInsertionEffect:GO,useLayoutEffect:KO,useMemo:JO,useReducer:hg,useRef:U2,useState:function(){return hg(Bc)},useDebugValue:O_,useDeferredValue:function(d,f){var x=di();return ZO(x,Lr.memoizedState,d,f)},useTransition:function(){var d=hg(Bc)[0],f=di().memoizedState;return[typeof d=="boolean"?d:fd(d),f]},useSyncExternalStore:pg,useId:nR,useHostTransitionStatus:D_,useFormState:vu,useActionState:vu,useOptimistic:function(d,f){var x=di();return D2(x,Lr,d,f)},useMemoCache:lh,useCacheRefresh:sR};$_.useEffectEvent=WO;var cR={readContext:Ta,use:Pf,useCallback:QO,useContext:Ta,useEffect:P_,useImperativeHandle:XO,useInsertionEffect:GO,useLayoutEffect:KO,useMemo:JO,useReducer:fg,useRef:U2,useState:function(){return fg(Bc)},useDebugValue:O_,useDeferredValue:function(d,f){var x=di();return Lr===null?R_(x,d,f):ZO(x,Lr.memoizedState,d,f)},useTransition:function(){var d=fg(Bc)[0],f=di().memoizedState;return[typeof d=="boolean"?d:fd(d),f]},useSyncExternalStore:pg,useId:nR,useHostTransitionStatus:D_,useFormState:xg,useActionState:xg,useOptimistic:function(d,f){var x=di();return Lr!==null?D2(x,Lr,d,f):(x.baseState=d,[d,x.queue.dispatch])},useMemoCache:lh,useCacheRefresh:sR};cR.useEffectEvent=WO;function F_(d,f,x,N){f=d.memoizedState,x=x(N,f),x=x==null?f:p({},f,x),d.memoizedState=x,d.lanes===0&&(d.updateQueue.baseState=x)}var U_={enqueueSetState:function(d,f,x){d=d._reactInternals;var N=dc(),P=Dr(N);P.payload=f,x!=null&&(P.callback=x),f=nn(d,P,N),f!==null&&(ql(f,d,N),ts(f,d,N))},enqueueReplaceState:function(d,f,x){d=d._reactInternals;var N=dc(),P=Dr(N);P.tag=1,P.payload=f,x!=null&&(P.callback=x),f=nn(d,P,N),f!==null&&(ql(f,d,N),ts(f,d,N))},enqueueForceUpdate:function(d,f){d=d._reactInternals;var x=dc(),N=Dr(x);N.tag=2,f!=null&&(N.callback=f),f=nn(d,N,x),f!==null&&(ql(f,d,x),ts(f,d,x))}};function uR(d,f,x,N,P,F,ie){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(N,F,ie):f.prototype&&f.prototype.isPureReactComponent?!hu(x,N)||!hu(P,F):!0}function dR(d,f,x,N){d=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(x,N),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(x,N),f.state!==d&&U_.enqueueReplaceState(f,f.state,null)}function up(d,f){var x=f;if("ref"in f){x={};for(var N in f)N!=="ref"&&(x[N]=f[N])}if(d=d.defaultProps){x===f&&(x=p({},x));for(var P in d)x[P]===void 0&&(x[P]=d[P])}return x}function hR(d){Z0(d)}function fR(d){console.error(d)}function pR(d){Z0(d)}function q2(d,f){try{var x=d.onUncaughtError;x(f.value,{componentStack:f.stack})}catch(N){setTimeout(function(){throw N})}}function mR(d,f,x){try{var N=d.onCaughtError;N(x.value,{componentStack:x.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function z_(d,f,x){return x=Dr(x),x.tag=3,x.payload={element:null},x.callback=function(){q2(d,f)},x}function gR(d){return d=Dr(d),d.tag=3,d}function xR(d,f,x,N){var P=x.type.getDerivedStateFromError;if(typeof P=="function"){var F=N.value;d.payload=function(){return P(F)},d.callback=function(){mR(f,x,N)}}var ie=x.stateNode;ie!==null&&typeof ie.componentDidCatch=="function"&&(d.callback=function(){mR(f,x,N),typeof P!="function"&&(Ff===null?Ff=new Set([this]):Ff.add(this));var ge=N.stack;this.componentDidCatch(N.value,{componentStack:ge!==null?ge:""})})}function Yae(d,f,x,N,P){if(x.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){if(f=x.alternate,f!==null&&cd(f,x,P,!0),x=Js.current,x!==null){switch(x.tag){case 31:case 13:return Dn===null?tw():x.alternate===null&&zi===0&&(zi=3),x.flags&=-257,x.flags|=65536,x.lanes=P,N===Ue?x.flags|=16384:(f=x.updateQueue,f===null?x.updateQueue=new Set([N]):f.add(N),fS(d,N,P)),!1;case 22:return x.flags|=65536,N===Ue?x.flags|=16384:(f=x.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([N])},x.updateQueue=f):(x=f.retryQueue,x===null?f.retryQueue=new Set([N]):x.add(N)),fS(d,N,P)),!1}throw Error(n(435,x.tag))}return fS(d,N,P),tw(),!1}if(bn)return f=Js.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=P,N!==lc&&(d=Error(n(422),{cause:N}),Tf(Ll(d,x)))):(N!==lc&&(f=Error(n(423),{cause:N}),Tf(Ll(f,x))),d=d.current.alternate,d.flags|=65536,P&=-P,d.lanes|=P,N=Ll(N,x),P=z_(d.stateNode,N,P),Ji(d,P),zi!==4&&(zi=2)),!1;var F=Error(n(520),{cause:N});if(F=Ll(F,x),ty===null?ty=[F]:ty.push(F),zi!==4&&(zi=2),f===null)return!0;N=Ll(N,x),x=f;do{switch(x.tag){case 3:return x.flags|=65536,d=P&-P,x.lanes|=d,d=z_(x.stateNode,N,d),Ji(x,d),!1;case 1:if(f=x.type,F=x.stateNode,(x.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Ff===null||!Ff.has(F))))return x.flags|=65536,P&=-P,x.lanes|=P,P=gR(P),xR(P,d,x,N),Ji(x,P),!1}x=x.return}while(x!==null);return!1}var q_=Error(n(461)),da=!1;function jo(d,f,x,N){f.child=d===null?Jr(f,null,x,N):Ps(f,d.child,x,N)}function bR(d,f,x,N,P){x=x.render;var F=f.ref;if("ref"in N){var ie={};for(var ge in N)ge!=="ref"&&(ie[ge]=N[ge])}else ie=N;return ud(f),N=$b(d,f,x,ie,F,P),ge=Fb(),d!==null&&!da?(Ub(d,f,P),dh(d,f,P)):(bn&&ge&&Rb(f),f.flags|=1,jo(d,f,N,P),f.child)}function yR(d,f,x,N,P){if(d===null){var F=x.type;return typeof F=="function"&&!eg(F)&&F.defaultProps===void 0&&x.compare===null?(f.tag=15,f.type=F,vR(d,f,F,N,P)):(d=Cf(x.type,null,N,f,f.mode,P),d.ref=f.ref,d.return=f,f.child=d)}if(F=d.child,!Q_(d,P)){var ie=F.memoizedProps;if(x=x.compare,x=x!==null?x:hu,x(ie,N)&&d.ref===f.ref)return dh(d,f,P)}return f.flags|=1,d=Il(F,N),d.ref=f.ref,d.return=f,f.child=d}function vR(d,f,x,N,P){if(d!==null){var F=d.memoizedProps;if(hu(F,N)&&d.ref===f.ref)if(da=!1,f.pendingProps=N=F,Q_(d,P))(d.flags&131072)!==0&&(da=!0);else return f.lanes=d.lanes,dh(d,f,P)}return V_(d,f,x,N,P)}function wR(d,f,x,N){var P=N.children,F=d!==null?d.memoizedState:null;if(d===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),N.mode==="hidden"){if((f.flags&128)!==0){if(F=F!==null?F.baseLanes|x:x,d!==null){for(N=f.child=d.child,P=0;N!==null;)P=P|N.lanes|N.childLanes,N=N.sibling;N=P&~F}else N=0,f.child=null;return NR(d,f,F,x,N)}if((x&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},d!==null&&je(f,F!==null?F.cachePool:null),F!==null?Qs(f,F):qn(),$i(f);else return N=f.lanes=536870912,NR(d,f,F!==null?F.baseLanes|x:x,x,N)}else F!==null?(je(f,F.cachePool),Qs(f,F),Fi(),f.memoizedState=null):(d!==null&&je(f,null),qn(),Fi());return jo(d,f,P,x),f.child}function Kb(d,f){return d!==null&&d.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function NR(d,f,x,N,P){var F=ve();return F=F===null?null:{parent:Si._currentValue,pool:F},f.memoizedState={baseLanes:x,cachePool:F},d!==null&&je(f,null),qn(),$i(f),d!==null&&cd(d,f,N,!0),f.childLanes=P,null}function V2(d,f){return f=W2({mode:f.mode,children:f.children},d.mode),f.ref=d.ref,d.child=f,f.return=d,f}function jR(d,f,x){return Ps(f,d.child,null,x),d=V2(f,f.pendingProps),d.flags|=2,us(f),f.memoizedState=null,d}function Xae(d,f,x){var N=f.pendingProps,P=(f.flags&128)!==0;if(f.flags&=-129,d===null){if(bn){if(N.mode==="hidden")return d=V2(f,N),f.lanes=536870912,Kb(null,d);if(rs(f),(d=Ls)?(d=RM(d,ci),d=d!==null&&d.data==="&"?d:null,d!==null&&(f.memoizedState={dehydrated:d,treeContext:id!==null?{id:Rl,overflow:Ml}:null,retryLane:536870912,hydrationErrors:null},x=tg(d),x.return=f,f.child=x,Ea=f,Ls=null)):d=null,d===null)throw ad(f);return f.lanes=536870912,null}return V2(f,N)}var F=d.memoizedState;if(F!==null){var ie=F.dehydrated;if(rs(f),P)if(f.flags&256)f.flags&=-257,f=jR(d,f,x);else if(f.memoizedState!==null)f.child=d.child,f.flags|=128,f=null;else throw Error(n(558));else if(da||cd(d,f,x,!1),P=(x&d.childLanes)!==0,da||P){if(N=Os,N!==null&&(ie=Rt(N,x),ie!==0&&ie!==F.retryLane))throw F.retryLane=ie,gu(d,ie),ql(N,d,ie),q_;tw(),f=jR(d,f,x)}else d=F.treeContext,Ls=Fc(ie.nextSibling),Ea=f,bn=!0,wo=null,ci=!1,d!==null&&O2(f,d),f=V2(f,N),f.flags|=4096;return f}return d=Il(d.child,{mode:N.mode,children:N.children}),d.ref=f.ref,f.child=d,d.return=f,d}function H2(d,f){var x=f.ref;if(x===null)d!==null&&d.ref!==null&&(f.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(n(284));(d===null||d.ref!==x)&&(f.flags|=4194816)}}function V_(d,f,x,N,P){return ud(f),x=$b(d,f,x,N,void 0,P),N=Fb(),d!==null&&!da?(Ub(d,f,P),dh(d,f,P)):(bn&&N&&Rb(f),f.flags|=1,jo(d,f,x,P),f.child)}function kR(d,f,x,N,P,F){return ud(f),f.updateQueue=null,x=bu(f,N,x,P),ug(d),N=Fb(),d!==null&&!da?(Ub(d,f,F),dh(d,f,F)):(bn&&N&&Rb(f),f.flags|=1,jo(d,f,x,F),f.child)}function _R(d,f,x,N,P){if(ud(f),f.stateNode===null){var F=Ca,ie=x.contextType;typeof ie=="object"&&ie!==null&&(F=Ta(ie)),F=new x(N,F),f.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,F.updater=U_,f.stateNode=F,F._reactInternals=f,F=f.stateNode,F.props=N,F.state=f.memoizedState,F.refs={},Yt(f),ie=x.contextType,F.context=typeof ie=="object"&&ie!==null?Ta(ie):Ca,F.state=f.memoizedState,ie=x.getDerivedStateFromProps,typeof ie=="function"&&(F_(f,x,ie,N),F.state=f.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(ie=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),ie!==F.state&&U_.enqueueReplaceState(F,F.state,null),Di(f,N,F,P),js(),F.state=f.memoizedState),typeof F.componentDidMount=="function"&&(f.flags|=4194308),N=!0}else if(d===null){F=f.stateNode;var ge=f.memoizedProps,Le=up(x,ge);F.props=Le;var tt=F.context,yt=x.contextType;ie=Ca,typeof yt=="object"&&yt!==null&&(ie=Ta(yt));var Ct=x.getDerivedStateFromProps;yt=typeof Ct=="function"||typeof F.getSnapshotBeforeUpdate=="function",ge=f.pendingProps!==ge,yt||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(ge||tt!==ie)&&dR(f,F,N,ie),ir=!1;var lt=f.memoizedState;F.state=lt,Di(f,N,F,P),js(),tt=f.memoizedState,ge||lt!==tt||ir?(typeof Ct=="function"&&(F_(f,x,Ct,N),tt=f.memoizedState),(Le=ir||uR(f,x,Le,N,lt,tt,ie))?(yt||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(f.flags|=4194308)):(typeof F.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=N,f.memoizedState=tt),F.props=N,F.state=tt,F.context=ie,N=Le):(typeof F.componentDidMount=="function"&&(f.flags|=4194308),N=!1)}else{F=f.stateNode,Xs(d,f),ie=f.memoizedProps,yt=up(x,ie),F.props=yt,Ct=f.pendingProps,lt=F.context,tt=x.contextType,Le=Ca,typeof tt=="object"&&tt!==null&&(Le=Ta(tt)),ge=x.getDerivedStateFromProps,(tt=typeof ge=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(ie!==Ct||lt!==Le)&&dR(f,F,N,Le),ir=!1,lt=f.memoizedState,F.state=lt,Di(f,N,F,P),js();var ht=f.memoizedState;ie!==Ct||lt!==ht||ir||d!==null&&d.dependencies!==null&&ag(d.dependencies)?(typeof ge=="function"&&(F_(f,x,ge,N),ht=f.memoizedState),(yt=ir||uR(f,x,yt,N,lt,ht,Le)||d!==null&&d.dependencies!==null&&ag(d.dependencies))?(tt||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(N,ht,Le),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(N,ht,Le)),typeof F.componentDidUpdate=="function"&&(f.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof F.componentDidUpdate!="function"||ie===d.memoizedProps&&lt===d.memoizedState||(f.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||ie===d.memoizedProps&&lt===d.memoizedState||(f.flags|=1024),f.memoizedProps=N,f.memoizedState=ht),F.props=N,F.state=ht,F.context=Le,N=yt):(typeof F.componentDidUpdate!="function"||ie===d.memoizedProps&&lt===d.memoizedState||(f.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||ie===d.memoizedProps&&lt===d.memoizedState||(f.flags|=1024),N=!1)}return F=N,H2(d,f),N=(f.flags&128)!==0,F||N?(F=f.stateNode,x=N&&typeof x.getDerivedStateFromError!="function"?null:F.render(),f.flags|=1,d!==null&&N?(f.child=Ps(f,d.child,null,P),f.child=Ps(f,null,x,P)):jo(d,f,x,P),f.memoizedState=F.state,d=f.child):d=dh(d,f,P),d}function SR(d,f,x,N){return ah(),f.flags|=256,jo(d,f,x,N),f.child}var H_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function W_(d){return{baseLanes:d,cachePool:Ce()}}function G_(d,f,x){return d=d!==null?d.childLanes&~x:0,f&&(d|=uc),d}function CR(d,f,x){var N=f.pendingProps,P=!1,F=(f.flags&128)!==0,ie;if((ie=F)||(ie=d!==null&&d.memoizedState===null?!1:(An.current&2)!==0),ie&&(P=!0,f.flags&=-129),ie=(f.flags&32)!==0,f.flags&=-33,d===null){if(bn){if(P?Ci(f):Fi(),(d=Ls)?(d=RM(d,ci),d=d!==null&&d.data!=="&"?d:null,d!==null&&(f.memoizedState={dehydrated:d,treeContext:id!==null?{id:Rl,overflow:Ml}:null,retryLane:536870912,hydrationErrors:null},x=tg(d),x.return=f,f.child=x,Ea=f,Ls=null)):d=null,d===null)throw ad(f);return AS(d)?f.lanes=32:f.lanes=536870912,null}var ge=N.children;return N=N.fallback,P?(Fi(),P=f.mode,ge=W2({mode:"hidden",children:ge},P),N=sd(N,P,x,null),ge.return=f,N.return=f,ge.sibling=N,f.child=ge,N=f.child,N.memoizedState=W_(x),N.childLanes=G_(d,ie,x),f.memoizedState=H_,Kb(null,N)):(Ci(f),K_(f,ge))}var Le=d.memoizedState;if(Le!==null&&(ge=Le.dehydrated,ge!==null)){if(F)f.flags&256?(Ci(f),f.flags&=-257,f=Y_(d,f,x)):f.memoizedState!==null?(Fi(),f.child=d.child,f.flags|=128,f=null):(Fi(),ge=N.fallback,P=f.mode,N=W2({mode:"visible",children:N.children},P),ge=sd(ge,P,x,null),ge.flags|=2,N.return=f,ge.return=f,N.sibling=ge,f.child=N,Ps(f,d.child,null,x),N=f.child,N.memoizedState=W_(x),N.childLanes=G_(d,ie,x),f.memoizedState=H_,f=Kb(null,N));else if(Ci(f),AS(ge)){if(ie=ge.nextSibling&&ge.nextSibling.dataset,ie)var tt=ie.dgst;ie=tt,N=Error(n(419)),N.stack="",N.digest=ie,Tf({value:N,source:null,stack:null}),f=Y_(d,f,x)}else if(da||cd(d,f,x,!1),ie=(x&d.childLanes)!==0,da||ie){if(ie=Os,ie!==null&&(N=Rt(ie,x),N!==0&&N!==Le.retryLane))throw Le.retryLane=N,gu(d,N),ql(ie,d,N),q_;ES(ge)||tw(),f=Y_(d,f,x)}else ES(ge)?(f.flags|=192,f.child=d.child,f=null):(d=Le.treeContext,Ls=Fc(ge.nextSibling),Ea=f,bn=!0,wo=null,ci=!1,d!==null&&O2(f,d),f=K_(f,N.children),f.flags|=4096);return f}return P?(Fi(),ge=N.fallback,P=f.mode,Le=d.child,tt=Le.sibling,N=Il(Le,{mode:"hidden",children:N.children}),N.subtreeFlags=Le.subtreeFlags&65011712,tt!==null?ge=Il(tt,ge):(ge=sd(ge,P,x,null),ge.flags|=2),ge.return=f,N.return=f,N.sibling=ge,f.child=N,Kb(null,N),N=f.child,ge=d.child.memoizedState,ge===null?ge=W_(x):(P=ge.cachePool,P!==null?(Le=Si._currentValue,P=P.parent!==Le?{parent:Le,pool:Le}:P):P=Ce(),ge={baseLanes:ge.baseLanes|x,cachePool:P}),N.memoizedState=ge,N.childLanes=G_(d,ie,x),f.memoizedState=H_,Kb(d.child,N)):(Ci(f),x=d.child,d=x.sibling,x=Il(x,{mode:"visible",children:N.children}),x.return=f,x.sibling=null,d!==null&&(ie=f.deletions,ie===null?(f.deletions=[d],f.flags|=16):ie.push(d)),f.child=x,f.memoizedState=null,x)}function K_(d,f){return f=W2({mode:"visible",children:f},d.mode),f.return=d,d.child=f}function W2(d,f){return d=Xa(22,d,null,f),d.lanes=0,d}function Y_(d,f,x){return Ps(f,d.child,null,x),d=K_(f,f.pendingProps.children),d.flags|=2,f.memoizedState=null,d}function ER(d,f,x){d.lanes|=f;var N=d.alternate;N!==null&&(N.lanes|=f),If(d.return,f,x)}function X_(d,f,x,N,P,F){var ie=d.memoizedState;ie===null?d.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:N,tail:x,tailMode:P,treeForkCount:F}:(ie.isBackwards=f,ie.rendering=null,ie.renderingStartTime=0,ie.last=N,ie.tail=x,ie.tailMode=P,ie.treeForkCount=F)}function AR(d,f,x){var N=f.pendingProps,P=N.revealOrder,F=N.tail;N=N.children;var ie=An.current,ge=(ie&2)!==0;if(ge?(ie=ie&1|2,f.flags|=128):ie&=1,W(An,ie),jo(d,f,N,x),N=bn?ip:0,!ge&&d!==null&&(d.flags&128)!==0)e:for(d=f.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&ER(d,x,f);else if(d.tag===19)ER(d,x,f);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break e;for(;d.sibling===null;){if(d.return===null||d.return===f)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(P){case"forwards":for(x=f.child,P=null;x!==null;)d=x.alternate,d!==null&&Ja(d)===null&&(P=x),x=x.sibling;x=P,x===null?(P=f.child,f.child=null):(P=x.sibling,x.sibling=null),X_(f,!1,P,x,F,N);break;case"backwards":case"unstable_legacy-backwards":for(x=null,P=f.child,f.child=null;P!==null;){if(d=P.alternate,d!==null&&Ja(d)===null){f.child=P;break}d=P.sibling,P.sibling=x,x=P,P=d}X_(f,!0,x,null,F,N);break;case"together":X_(f,!1,null,null,void 0,N);break;default:f.memoizedState=null}return f.child}function dh(d,f,x){if(d!==null&&(f.dependencies=d.dependencies),$f|=f.lanes,(x&f.childLanes)===0)if(d!==null){if(cd(d,f,x,!1),(x&f.childLanes)===0)return null}else return null;if(d!==null&&f.child!==d.child)throw Error(n(153));if(f.child!==null){for(d=f.child,x=Il(d,d.pendingProps),f.child=x,x.return=f;d.sibling!==null;)d=d.sibling,x=x.sibling=Il(d,d.pendingProps),x.return=f;x.sibling=null}return f.child}function Q_(d,f){return(d.lanes&f)!==0?!0:(d=d.dependencies,!!(d!==null&&ag(d)))}function Qae(d,f,x){switch(f.tag){case 3:ne(f,f.stateNode.containerInfo),ld(f,Si,d.memoizedState.cache),ah();break;case 27:case 5:le(f);break;case 4:ne(f,f.stateNode.containerInfo);break;case 10:ld(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,rs(f),null;break;case 13:var N=f.memoizedState;if(N!==null)return N.dehydrated!==null?(Ci(f),f.flags|=128,null):(x&f.child.childLanes)!==0?CR(d,f,x):(Ci(f),d=dh(d,f,x),d!==null?d.sibling:null);Ci(f);break;case 19:var P=(d.flags&128)!==0;if(N=(x&f.childLanes)!==0,N||(cd(d,f,x,!1),N=(x&f.childLanes)!==0),P){if(N)return AR(d,f,x);f.flags|=128}if(P=f.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),W(An,An.current),N)break;return null;case 22:return f.lanes=0,wR(d,f,x,f.pendingProps);case 24:ld(f,Si,d.memoizedState.cache)}return dh(d,f,x)}function TR(d,f,x){if(d!==null)if(d.memoizedProps!==f.pendingProps)da=!0;else{if(!Q_(d,x)&&(f.flags&128)===0)return da=!1,Qae(d,f,x);da=(d.flags&131072)!==0}else da=!1,bn&&(f.flags&1048576)!==0&&P2(f,ip,f.index);switch(f.lanes=0,f.tag){case 16:e:{var N=f.pendingProps;if(d=Xe(f.elementType),f.type=d,typeof d=="function")eg(d)?(N=up(d,N),f.tag=1,f=_R(null,f,d,N,x)):(f.tag=0,f=V_(null,f,d,N,x));else{if(d!=null){var P=d.$$typeof;if(P===I){f.tag=11,f=bR(null,f,d,N,x);break e}else if(P===S){f.tag=14,f=yR(null,f,d,N,x);break e}}throw f=V(d)||d,Error(n(306,f,""))}}return f;case 0:return V_(d,f,f.type,f.pendingProps,x);case 1:return N=f.type,P=up(N,f.pendingProps),_R(d,f,N,P,x);case 3:e:{if(ne(f,f.stateNode.containerInfo),d===null)throw Error(n(387));N=f.pendingProps;var F=f.memoizedState;P=F.element,Xs(d,f),Di(f,N,null,x);var ie=f.memoizedState;if(N=ie.cache,ld(f,Si,N),N!==F.cache&&oh(f,[Si],x,!0),js(),N=ie.element,F.isDehydrated)if(F={element:N,isDehydrated:!1,cache:ie.cache},f.updateQueue.baseState=F,f.memoizedState=F,f.flags&256){f=SR(d,f,N,x);break e}else if(N!==P){P=Ll(Error(n(424)),f),Tf(P),f=SR(d,f,N,x);break e}else for(d=f.stateNode.containerInfo,d.nodeType===9?d=d.body:d=d.nodeName==="HTML"?d.ownerDocument.body:d,Ls=Fc(d.firstChild),Ea=f,bn=!0,wo=null,ci=!0,x=Jr(f,null,N,x),f.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(ah(),N===P){f=dh(d,f,x);break e}jo(d,f,N,x)}f=f.child}return f;case 26:return H2(d,f),d===null?(x=UM(f.type,null,f.pendingProps,null))?f.memoizedState=x:bn||(x=f.type,d=f.pendingProps,N=lw(be.current).createElement(x),N[Ft]=f,N[tr]=d,ko(N,x,d),os(N),f.stateNode=N):f.memoizedState=UM(f.type,d.memoizedProps,f.pendingProps,d.memoizedState),null;case 27:return le(f),d===null&&bn&&(N=f.stateNode=BM(f.type,f.pendingProps,be.current),Ea=f,ci=!0,P=Ls,Vf(f.type)?(TS=P,Ls=Fc(N.firstChild)):Ls=P),jo(d,f,f.pendingProps.children,x),H2(d,f),d===null&&(f.flags|=4194304),f.child;case 5:return d===null&&bn&&((P=N=Ls)&&(N=Coe(N,f.type,f.pendingProps,ci),N!==null?(f.stateNode=N,Ea=f,Ls=Fc(N.firstChild),ci=!1,P=!0):P=!1),P||ad(f)),le(f),P=f.type,F=f.pendingProps,ie=d!==null?d.memoizedProps:null,N=F.children,_S(P,F)?N=null:ie!==null&&_S(P,ie)&&(f.flags|=32),f.memoizedState!==null&&(P=$b(d,f,L_,null,null,x),cy._currentValue=P),H2(d,f),jo(d,f,N,x),f.child;case 6:return d===null&&bn&&((d=x=Ls)&&(x=Eoe(x,f.pendingProps,ci),x!==null?(f.stateNode=x,Ea=f,Ls=null,d=!0):d=!1),d||ad(f)),null;case 13:return CR(d,f,x);case 4:return ne(f,f.stateNode.containerInfo),N=f.pendingProps,d===null?f.child=Ps(f,null,N,x):jo(d,f,N,x),f.child;case 11:return bR(d,f,f.type,f.pendingProps,x);case 7:return jo(d,f,f.pendingProps,x),f.child;case 8:return jo(d,f,f.pendingProps.children,x),f.child;case 12:return jo(d,f,f.pendingProps.children,x),f.child;case 10:return N=f.pendingProps,ld(f,f.type,N.value),jo(d,f,N.children,x),f.child;case 9:return P=f.type._context,N=f.pendingProps.children,ud(f),P=Ta(P),N=N(P),f.flags|=1,jo(d,f,N,x),f.child;case 14:return yR(d,f,f.type,f.pendingProps,x);case 15:return vR(d,f,f.type,f.pendingProps,x);case 19:return AR(d,f,x);case 31:return Xae(d,f,x);case 22:return wR(d,f,x,f.pendingProps);case 24:return ud(f),N=Ta(Si),d===null?(P=ve(),P===null&&(P=Os,F=Lf(),P.pooledCache=F,F.refCount++,F!==null&&(P.pooledCacheLanes|=x),P=F),f.memoizedState={parent:N,cache:P},Yt(f),ld(f,Si,P)):((d.lanes&x)!==0&&(Xs(d,f),Di(f,null,null,x),js()),P=d.memoizedState,F=f.memoizedState,P.parent!==N?(P={parent:N,cache:N},f.memoizedState=P,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=P),ld(f,Si,N)):(N=F.cache,ld(f,Si,N),N!==P.cache&&oh(f,[Si],x,!0))),jo(d,f,f.pendingProps.children,x),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}function hh(d){d.flags|=4}function J_(d,f,x,N,P){if((f=(d.mode&32)!==0)&&(f=!1),f){if(d.flags|=16777216,(P&335544128)===P)if(d.stateNode.complete)d.flags|=8192;else if(nM())d.flags|=8192;else throw mt=Ue,Qe}else d.flags&=-16777217}function IR(d,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!WM(f))if(nM())d.flags|=8192;else throw mt=Ue,Qe}function G2(d,f){f!==null&&(d.flags|=4),d.flags&16384&&(f=d.tag!==22?Nt():536870912,d.lanes|=f,wg|=f)}function Yb(d,f){if(!bn)switch(d.tailMode){case"hidden":f=d.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?d.tail=null:x.sibling=null;break;case"collapsed":x=d.tail;for(var N=null;x!==null;)x.alternate!==null&&(N=x),x=x.sibling;N===null?f||d.tail===null?d.tail=null:d.tail.sibling=null:N.sibling=null}}function Zs(d){var f=d.alternate!==null&&d.alternate.child===d.child,x=0,N=0;if(f)for(var P=d.child;P!==null;)x|=P.lanes|P.childLanes,N|=P.subtreeFlags&65011712,N|=P.flags&65011712,P.return=d,P=P.sibling;else for(P=d.child;P!==null;)x|=P.lanes|P.childLanes,N|=P.subtreeFlags,N|=P.flags,P.return=d,P=P.sibling;return d.subtreeFlags|=N,d.childLanes=x,f}function Jae(d,f,x){var N=f.pendingProps;switch(sg(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(f),null;case 1:return Zs(f),null;case 3:return x=f.stateNode,N=null,d!==null&&(N=d.memoizedState.cache),f.memoizedState.cache!==N&&(f.flags|=2048),Dl(Si),H(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(d===null||d.child===null)&&(Aa(f)?hh(f):d===null||d.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Db())),Zs(f),null;case 26:var P=f.type,F=f.memoizedState;return d===null?(hh(f),F!==null?(Zs(f),IR(f,F)):(Zs(f),J_(f,P,null,N,x))):F?F!==d.memoizedState?(hh(f),Zs(f),IR(f,F)):(Zs(f),f.flags&=-16777217):(d=d.memoizedProps,d!==N&&hh(f),Zs(f),J_(f,P,d,N,x)),null;case 27:if(ye(f),x=be.current,P=f.type,d!==null&&f.stateNode!=null)d.memoizedProps!==N&&hh(f);else{if(!N){if(f.stateNode===null)throw Error(n(166));return Zs(f),null}d=Z.current,Aa(f)?Mb(f):(d=BM(P,N,x),f.stateNode=d,hh(f))}return Zs(f),null;case 5:if(ye(f),P=f.type,d!==null&&f.stateNode!=null)d.memoizedProps!==N&&hh(f);else{if(!N){if(f.stateNode===null)throw Error(n(166));return Zs(f),null}if(F=Z.current,Aa(f))Mb(f);else{var ie=lw(be.current);switch(F){case 1:F=ie.createElementNS("http://www.w3.org/2000/svg",P);break;case 2:F=ie.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;default:switch(P){case"svg":F=ie.createElementNS("http://www.w3.org/2000/svg",P);break;case"math":F=ie.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;case"script":F=ie.createElement("div"),F.innerHTML="<script><\/script>",F=F.removeChild(F.firstChild);break;case"select":F=typeof N.is=="string"?ie.createElement("select",{is:N.is}):ie.createElement("select"),N.multiple?F.multiple=!0:N.size&&(F.size=N.size);break;default:F=typeof N.is=="string"?ie.createElement(P,{is:N.is}):ie.createElement(P)}}F[Ft]=f,F[tr]=N;e:for(ie=f.child;ie!==null;){if(ie.tag===5||ie.tag===6)F.appendChild(ie.stateNode);else if(ie.tag!==4&&ie.tag!==27&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===f)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===f)break e;ie=ie.return}ie.sibling.return=ie.return,ie=ie.sibling}f.stateNode=F;e:switch(ko(F,P,N),P){case"button":case"input":case"select":case"textarea":N=!!N.autoFocus;break e;case"img":N=!0;break e;default:N=!1}N&&hh(f)}}return Zs(f),J_(f,f.type,d===null?null:d.memoizedProps,f.pendingProps,x),null;case 6:if(d&&f.stateNode!=null)d.memoizedProps!==N&&hh(f);else{if(typeof N!="string"&&f.stateNode===null)throw Error(n(166));if(d=be.current,Aa(f)){if(d=f.stateNode,x=f.memoizedProps,N=null,P=Ea,P!==null)switch(P.tag){case 27:case 5:N=P.memoizedProps}d[Ft]=f,d=!!(d.nodeValue===x||N!==null&&N.suppressHydrationWarning===!0||CM(d.nodeValue,x)),d||ad(f,!0)}else d=lw(d).createTextNode(N),d[Ft]=f,f.stateNode=d}return Zs(f),null;case 31:if(x=f.memoizedState,d===null||d.memoizedState!==null){if(N=Aa(f),x!==null){if(d===null){if(!N)throw Error(n(318));if(d=f.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(557));d[Ft]=f}else ah(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Zs(f),d=!1}else x=Db(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=x),d=!0;if(!d)return f.flags&256?(us(f),f):(us(f),null);if((f.flags&128)!==0)throw Error(n(558))}return Zs(f),null;case 13:if(N=f.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(P=Aa(f),N!==null&&N.dehydrated!==null){if(d===null){if(!P)throw Error(n(318));if(P=f.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(n(317));P[Ft]=f}else ah(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Zs(f),P=!1}else P=Db(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=P),P=!0;if(!P)return f.flags&256?(us(f),f):(us(f),null)}return us(f),(f.flags&128)!==0?(f.lanes=x,f):(x=N!==null,d=d!==null&&d.memoizedState!==null,x&&(N=f.child,P=null,N.alternate!==null&&N.alternate.memoizedState!==null&&N.alternate.memoizedState.cachePool!==null&&(P=N.alternate.memoizedState.cachePool.pool),F=null,N.memoizedState!==null&&N.memoizedState.cachePool!==null&&(F=N.memoizedState.cachePool.pool),F!==P&&(N.flags|=2048)),x!==d&&x&&(f.child.flags|=8192),G2(f,f.updateQueue),Zs(f),null);case 4:return H(),d===null&&vS(f.stateNode.containerInfo),Zs(f),null;case 10:return Dl(f.type),Zs(f),null;case 19:if(U(An),N=f.memoizedState,N===null)return Zs(f),null;if(P=(f.flags&128)!==0,F=N.rendering,F===null)if(P)Yb(N,!1);else{if(zi!==0||d!==null&&(d.flags&128)!==0)for(d=f.child;d!==null;){if(F=Ja(d),F!==null){for(f.flags|=128,Yb(N,!1),d=F.updateQueue,f.updateQueue=d,G2(f,d),f.subtreeFlags=0,d=x,x=f.child;x!==null;)np(x,d),x=x.sibling;return W(An,An.current&1|2),bn&&al(f,N.treeForkCount),f.child}d=d.sibling}N.tail!==null&&at()>J2&&(f.flags|=128,P=!0,Yb(N,!1),f.lanes=4194304)}else{if(!P)if(d=Ja(F),d!==null){if(f.flags|=128,P=!0,d=d.updateQueue,f.updateQueue=d,G2(f,d),Yb(N,!0),N.tail===null&&N.tailMode==="hidden"&&!F.alternate&&!bn)return Zs(f),null}else 2*at()-N.renderingStartTime>J2&&x!==536870912&&(f.flags|=128,P=!0,Yb(N,!1),f.lanes=4194304);N.isBackwards?(F.sibling=f.child,f.child=F):(d=N.last,d!==null?d.sibling=F:f.child=F,N.last=F)}return N.tail!==null?(d=N.tail,N.rendering=d,N.tail=d.sibling,N.renderingStartTime=at(),d.sibling=null,x=An.current,W(An,P?x&1|2:x&1),bn&&al(f,N.treeForkCount),d):(Zs(f),null);case 22:case 23:return us(f),Zi(),N=f.memoizedState!==null,d!==null?d.memoizedState!==null!==N&&(f.flags|=8192):N&&(f.flags|=8192),N?(x&536870912)!==0&&(f.flags&128)===0&&(Zs(f),f.subtreeFlags&6&&(f.flags|=8192)):Zs(f),x=f.updateQueue,x!==null&&G2(f,x.retryQueue),x=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),N=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(N=f.memoizedState.cachePool.pool),N!==x&&(f.flags|=2048),d!==null&&U(pe),null;case 24:return x=null,d!==null&&(x=d.memoizedState.cache),f.memoizedState.cache!==x&&(f.flags|=2048),Dl(Si),Zs(f),null;case 25:return null;case 30:return null}throw Error(n(156,f.tag))}function Zae(d,f){switch(sg(f),f.tag){case 1:return d=f.flags,d&65536?(f.flags=d&-65537|128,f):null;case 3:return Dl(Si),H(),d=f.flags,(d&65536)!==0&&(d&128)===0?(f.flags=d&-65537|128,f):null;case 26:case 27:case 5:return ye(f),null;case 31:if(f.memoizedState!==null){if(us(f),f.alternate===null)throw Error(n(340));ah()}return d=f.flags,d&65536?(f.flags=d&-65537|128,f):null;case 13:if(us(f),d=f.memoizedState,d!==null&&d.dehydrated!==null){if(f.alternate===null)throw Error(n(340));ah()}return d=f.flags,d&65536?(f.flags=d&-65537|128,f):null;case 19:return U(An),null;case 4:return H(),null;case 10:return Dl(f.type),null;case 22:case 23:return us(f),Zi(),d!==null&&U(pe),d=f.flags,d&65536?(f.flags=d&-65537|128,f):null;case 24:return Dl(Si),null;case 25:return null;default:return null}}function LR(d,f){switch(sg(f),f.tag){case 3:Dl(Si),H();break;case 26:case 27:case 5:ye(f);break;case 4:H();break;case 31:f.memoizedState!==null&&us(f);break;case 13:us(f);break;case 19:U(An);break;case 10:Dl(f.type);break;case 22:case 23:us(f),Zi(),d!==null&&U(pe);break;case 24:Dl(Si)}}function Xb(d,f){try{var x=f.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var P=N.next;x=P;do{if((x.tag&d)===d){N=void 0;var F=x.create,ie=x.inst;N=F(),ie.destroy=N}x=x.next}while(x!==P)}}catch(ge){hs(f,f.return,ge)}}function Df(d,f,x){try{var N=f.updateQueue,P=N!==null?N.lastEffect:null;if(P!==null){var F=P.next;N=F;do{if((N.tag&d)===d){var ie=N.inst,ge=ie.destroy;if(ge!==void 0){ie.destroy=void 0,P=f;var Le=x,tt=ge;try{tt()}catch(yt){hs(P,Le,yt)}}}N=N.next}while(N!==F)}}catch(yt){hs(f,f.return,yt)}}function PR(d){var f=d.updateQueue;if(f!==null){var x=d.stateNode;try{Bi(f,x)}catch(N){hs(d,d.return,N)}}}function OR(d,f,x){x.props=up(d.type,d.memoizedProps),x.state=d.memoizedState;try{x.componentWillUnmount()}catch(N){hs(d,f,N)}}function Qb(d,f){try{var x=d.ref;if(x!==null){switch(d.tag){case 26:case 27:case 5:var N=d.stateNode;break;case 30:N=d.stateNode;break;default:N=d.stateNode}typeof x=="function"?d.refCleanup=x(N):x.current=N}}catch(P){hs(d,f,P)}}function md(d,f){var x=d.ref,N=d.refCleanup;if(x!==null)if(typeof N=="function")try{N()}catch(P){hs(d,f,P)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(P){hs(d,f,P)}else x.current=null}function RR(d){var f=d.type,x=d.memoizedProps,N=d.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":x.autoFocus&&N.focus();break e;case"img":x.src?N.src=x.src:x.srcSet&&(N.srcset=x.srcSet)}}catch(P){hs(d,d.return,P)}}function Z_(d,f,x){try{var N=d.stateNode;woe(N,d.type,x,f),N[tr]=f}catch(P){hs(d,d.return,P)}}function MR(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Vf(d.type)||d.tag===4}function eS(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||MR(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Vf(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function tS(d,f,x){var N=d.tag;if(N===5||N===6)d=d.stateNode,f?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(d,f):(f=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,f.appendChild(d),x=x._reactRootContainer,x!=null||f.onclick!==null||(f.onclick=la));else if(N!==4&&(N===27&&Vf(d.type)&&(x=d.stateNode,f=null),d=d.child,d!==null))for(tS(d,f,x),d=d.sibling;d!==null;)tS(d,f,x),d=d.sibling}function K2(d,f,x){var N=d.tag;if(N===5||N===6)d=d.stateNode,f?x.insertBefore(d,f):x.appendChild(d);else if(N!==4&&(N===27&&Vf(d.type)&&(x=d.stateNode),d=d.child,d!==null))for(K2(d,f,x),d=d.sibling;d!==null;)K2(d,f,x),d=d.sibling}function DR(d){var f=d.stateNode,x=d.memoizedProps;try{for(var N=d.type,P=f.attributes;P.length;)f.removeAttributeNode(P[0]);ko(f,N,x),f[Ft]=d,f[tr]=x}catch(F){hs(d,d.return,F)}}var fh=!1,ha=!1,rS=!1,BR=typeof WeakSet=="function"?WeakSet:Set,Za=null;function eoe(d,f){if(d=d.containerInfo,jS=mw,d=pu(d),Rc(d)){if("selectionStart"in d)var x={start:d.selectionStart,end:d.selectionEnd};else e:{x=(x=d.ownerDocument)&&x.defaultView||window;var N=x.getSelection&&x.getSelection();if(N&&N.rangeCount!==0){x=N.anchorNode;var P=N.anchorOffset,F=N.focusNode;N=N.focusOffset;try{x.nodeType,F.nodeType}catch{x=null;break e}var ie=0,ge=-1,Le=-1,tt=0,yt=0,Ct=d,lt=null;t:for(;;){for(var ht;Ct!==x||P!==0&&Ct.nodeType!==3||(ge=ie+P),Ct!==F||N!==0&&Ct.nodeType!==3||(Le=ie+N),Ct.nodeType===3&&(ie+=Ct.nodeValue.length),(ht=Ct.firstChild)!==null;)lt=Ct,Ct=ht;for(;;){if(Ct===d)break t;if(lt===x&&++tt===P&&(ge=ie),lt===F&&++yt===N&&(Le=ie),(ht=Ct.nextSibling)!==null)break;Ct=lt,lt=Ct.parentNode}Ct=ht}x=ge===-1||Le===-1?null:{start:ge,end:Le}}else x=null}x=x||{start:0,end:0}}else x=null;for(kS={focusedElem:d,selectionRange:x},mw=!1,Za=f;Za!==null;)if(f=Za,d=f.child,(f.subtreeFlags&1028)!==0&&d!==null)d.return=f,Za=d;else for(;Za!==null;){switch(f=Za,F=f.alternate,d=f.flags,f.tag){case 0:if((d&4)!==0&&(d=f.updateQueue,d=d!==null?d.events:null,d!==null))for(x=0;x<d.length;x++)P=d[x],P.ref.impl=P.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&F!==null){d=void 0,x=f,P=F.memoizedProps,F=F.memoizedState,N=x.stateNode;try{var dr=up(x.type,P);d=N.getSnapshotBeforeUpdate(dr,F),N.__reactInternalSnapshotBeforeUpdate=d}catch($r){hs(x,x.return,$r)}}break;case 3:if((d&1024)!==0){if(d=f.stateNode.containerInfo,x=d.nodeType,x===9)CS(d);else if(x===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":CS(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(n(163))}if(d=f.sibling,d!==null){d.return=f.return,Za=d;break}Za=f.return}}function $R(d,f,x){var N=x.flags;switch(x.tag){case 0:case 11:case 15:mh(d,x),N&4&&Xb(5,x);break;case 1:if(mh(d,x),N&4)if(d=x.stateNode,f===null)try{d.componentDidMount()}catch(ie){hs(x,x.return,ie)}else{var P=up(x.type,f.memoizedProps);f=f.memoizedState;try{d.componentDidUpdate(P,f,d.__reactInternalSnapshotBeforeUpdate)}catch(ie){hs(x,x.return,ie)}}N&64&&PR(x),N&512&&Qb(x,x.return);break;case 3:if(mh(d,x),N&64&&(d=x.updateQueue,d!==null)){if(f=null,x.child!==null)switch(x.child.tag){case 27:case 5:f=x.child.stateNode;break;case 1:f=x.child.stateNode}try{Bi(d,f)}catch(ie){hs(x,x.return,ie)}}break;case 27:f===null&&N&4&&DR(x);case 26:case 5:mh(d,x),f===null&&N&4&&RR(x),N&512&&Qb(x,x.return);break;case 12:mh(d,x);break;case 31:mh(d,x),N&4&&zR(d,x);break;case 13:mh(d,x),N&4&&qR(d,x),N&64&&(d=x.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(x=coe.bind(null,x),Aoe(d,x))));break;case 22:if(N=x.memoizedState!==null||fh,!N){f=f!==null&&f.memoizedState!==null||ha,P=fh;var F=ha;fh=N,(ha=f)&&!F?gh(d,x,(x.subtreeFlags&8772)!==0):mh(d,x),fh=P,ha=F}break;case 30:break;default:mh(d,x)}}function FR(d){var f=d.alternate;f!==null&&(d.alternate=null,FR(f)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(f=d.stateNode,f!==null&&wa(f)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var hi=null,$l=!1;function ph(d,f,x){for(x=x.child;x!==null;)UR(d,f,x),x=x.sibling}function UR(d,f,x){if(qe&&typeof qe.onCommitFiberUnmount=="function")try{qe.onCommitFiberUnmount(jt,x)}catch{}switch(x.tag){case 26:ha||md(x,f),ph(d,f,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:ha||md(x,f);var N=hi,P=$l;Vf(x.type)&&(hi=x.stateNode,$l=!1),ph(d,f,x),ay(x.stateNode),hi=N,$l=P;break;case 5:ha||md(x,f);case 6:if(N=hi,P=$l,hi=null,ph(d,f,x),hi=N,$l=P,hi!==null)if($l)try{(hi.nodeType===9?hi.body:hi.nodeName==="HTML"?hi.ownerDocument.body:hi).removeChild(x.stateNode)}catch(F){hs(x,f,F)}else try{hi.removeChild(x.stateNode)}catch(F){hs(x,f,F)}break;case 18:hi!==null&&($l?(d=hi,PM(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,x.stateNode),Ag(d)):PM(hi,x.stateNode));break;case 4:N=hi,P=$l,hi=x.stateNode.containerInfo,$l=!0,ph(d,f,x),hi=N,$l=P;break;case 0:case 11:case 14:case 15:Df(2,x,f),ha||Df(4,x,f),ph(d,f,x);break;case 1:ha||(md(x,f),N=x.stateNode,typeof N.componentWillUnmount=="function"&&OR(x,f,N)),ph(d,f,x);break;case 21:ph(d,f,x);break;case 22:ha=(N=ha)||x.memoizedState!==null,ph(d,f,x),ha=N;break;default:ph(d,f,x)}}function zR(d,f){if(f.memoizedState===null&&(d=f.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{Ag(d)}catch(x){hs(f,f.return,x)}}}function qR(d,f){if(f.memoizedState===null&&(d=f.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Ag(d)}catch(x){hs(f,f.return,x)}}function toe(d){switch(d.tag){case 31:case 13:case 19:var f=d.stateNode;return f===null&&(f=d.stateNode=new BR),f;case 22:return d=d.stateNode,f=d._retryCache,f===null&&(f=d._retryCache=new BR),f;default:throw Error(n(435,d.tag))}}function Y2(d,f){var x=toe(d);f.forEach(function(N){if(!x.has(N)){x.add(N);var P=uoe.bind(null,d,N);N.then(P,P)}})}function Fl(d,f){var x=f.deletions;if(x!==null)for(var N=0;N<x.length;N++){var P=x[N],F=d,ie=f,ge=ie;e:for(;ge!==null;){switch(ge.tag){case 27:if(Vf(ge.type)){hi=ge.stateNode,$l=!1;break e}break;case 5:hi=ge.stateNode,$l=!1;break e;case 3:case 4:hi=ge.stateNode.containerInfo,$l=!0;break e}ge=ge.return}if(hi===null)throw Error(n(160));UR(F,ie,P),hi=null,$l=!1,F=P.alternate,F!==null&&(F.return=null),P.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)VR(f,d),f=f.sibling}var Nu=null;function VR(d,f){var x=d.alternate,N=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Fl(f,d),Ul(d),N&4&&(Df(3,d,d.return),Xb(3,d),Df(5,d,d.return));break;case 1:Fl(f,d),Ul(d),N&512&&(ha||x===null||md(x,x.return)),N&64&&fh&&(d=d.updateQueue,d!==null&&(N=d.callbacks,N!==null&&(x=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=x===null?N:x.concat(N))));break;case 26:var P=Nu;if(Fl(f,d),Ul(d),N&512&&(ha||x===null||md(x,x.return)),N&4){var F=x!==null?x.memoizedState:null;if(N=d.memoizedState,x===null)if(N===null)if(d.stateNode===null){e:{N=d.type,x=d.memoizedProps,P=P.ownerDocument||P;t:switch(N){case"title":F=P.getElementsByTagName("title")[0],(!F||F[Ts]||F[Ft]||F.namespaceURI==="http://www.w3.org/2000/svg"||F.hasAttribute("itemprop"))&&(F=P.createElement(N),P.head.insertBefore(F,P.querySelector("head > title"))),ko(F,N,x),F[Ft]=d,os(F),N=F;break e;case"link":var ie=VM("link","href",P).get(N+(x.href||""));if(ie){for(var ge=0;ge<ie.length;ge++)if(F=ie[ge],F.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&F.getAttribute("rel")===(x.rel==null?null:x.rel)&&F.getAttribute("title")===(x.title==null?null:x.title)&&F.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){ie.splice(ge,1);break t}}F=P.createElement(N),ko(F,N,x),P.head.appendChild(F);break;case"meta":if(ie=VM("meta","content",P).get(N+(x.content||""))){for(ge=0;ge<ie.length;ge++)if(F=ie[ge],F.getAttribute("content")===(x.content==null?null:""+x.content)&&F.getAttribute("name")===(x.name==null?null:x.name)&&F.getAttribute("property")===(x.property==null?null:x.property)&&F.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&F.getAttribute("charset")===(x.charSet==null?null:x.charSet)){ie.splice(ge,1);break t}}F=P.createElement(N),ko(F,N,x),P.head.appendChild(F);break;default:throw Error(n(468,N))}F[Ft]=d,os(F),N=F}d.stateNode=N}else HM(P,d.type,d.stateNode);else d.stateNode=qM(P,N,d.memoizedProps);else F!==N?(F===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):F.count--,N===null?HM(P,d.type,d.stateNode):qM(P,N,d.memoizedProps)):N===null&&d.stateNode!==null&&Z_(d,d.memoizedProps,x.memoizedProps)}break;case 27:Fl(f,d),Ul(d),N&512&&(ha||x===null||md(x,x.return)),x!==null&&N&4&&Z_(d,d.memoizedProps,x.memoizedProps);break;case 5:if(Fl(f,d),Ul(d),N&512&&(ha||x===null||md(x,x.return)),d.flags&32){P=d.stateNode;try{es(P,"")}catch(dr){hs(d,d.return,dr)}}N&4&&d.stateNode!=null&&(P=d.memoizedProps,Z_(d,P,x!==null?x.memoizedProps:P)),N&1024&&(rS=!0);break;case 6:if(Fl(f,d),Ul(d),N&4){if(d.stateNode===null)throw Error(n(162));N=d.memoizedProps,x=d.stateNode;try{x.nodeValue=N}catch(dr){hs(d,d.return,dr)}}break;case 3:if(dw=null,P=Nu,Nu=cw(f.containerInfo),Fl(f,d),Nu=P,Ul(d),N&4&&x!==null&&x.memoizedState.isDehydrated)try{Ag(f.containerInfo)}catch(dr){hs(d,d.return,dr)}rS&&(rS=!1,HR(d));break;case 4:N=Nu,Nu=cw(d.stateNode.containerInfo),Fl(f,d),Ul(d),Nu=N;break;case 12:Fl(f,d),Ul(d);break;case 31:Fl(f,d),Ul(d),N&4&&(N=d.updateQueue,N!==null&&(d.updateQueue=null,Y2(d,N)));break;case 13:Fl(f,d),Ul(d),d.child.flags&8192&&d.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(Q2=at()),N&4&&(N=d.updateQueue,N!==null&&(d.updateQueue=null,Y2(d,N)));break;case 22:P=d.memoizedState!==null;var Le=x!==null&&x.memoizedState!==null,tt=fh,yt=ha;if(fh=tt||P,ha=yt||Le,Fl(f,d),ha=yt,fh=tt,Ul(d),N&8192)e:for(f=d.stateNode,f._visibility=P?f._visibility&-2:f._visibility|1,P&&(x===null||Le||fh||ha||dp(d)),x=null,f=d;;){if(f.tag===5||f.tag===26){if(x===null){Le=x=f;try{if(F=Le.stateNode,P)ie=F.style,typeof ie.setProperty=="function"?ie.setProperty("display","none","important"):ie.display="none";else{ge=Le.stateNode;var Ct=Le.memoizedProps.style,lt=Ct!=null&&Ct.hasOwnProperty("display")?Ct.display:null;ge.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch(dr){hs(Le,Le.return,dr)}}}else if(f.tag===6){if(x===null){Le=f;try{Le.stateNode.nodeValue=P?"":Le.memoizedProps}catch(dr){hs(Le,Le.return,dr)}}}else if(f.tag===18){if(x===null){Le=f;try{var ht=Le.stateNode;P?OM(ht,!0):OM(Le.stateNode,!1)}catch(dr){hs(Le,Le.return,dr)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===d)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===d)break e;for(;f.sibling===null;){if(f.return===null||f.return===d)break e;x===f&&(x=null),f=f.return}x===f&&(x=null),f.sibling.return=f.return,f=f.sibling}N&4&&(N=d.updateQueue,N!==null&&(x=N.retryQueue,x!==null&&(N.retryQueue=null,Y2(d,x))));break;case 19:Fl(f,d),Ul(d),N&4&&(N=d.updateQueue,N!==null&&(d.updateQueue=null,Y2(d,N)));break;case 30:break;case 21:break;default:Fl(f,d),Ul(d)}}function Ul(d){var f=d.flags;if(f&2){try{for(var x,N=d.return;N!==null;){if(MR(N)){x=N;break}N=N.return}if(x==null)throw Error(n(160));switch(x.tag){case 27:var P=x.stateNode,F=eS(d);K2(d,F,P);break;case 5:var ie=x.stateNode;x.flags&32&&(es(ie,""),x.flags&=-33);var ge=eS(d);K2(d,ge,ie);break;case 3:case 4:var Le=x.stateNode.containerInfo,tt=eS(d);tS(d,tt,Le);break;default:throw Error(n(161))}}catch(yt){hs(d,d.return,yt)}d.flags&=-3}f&4096&&(d.flags&=-4097)}function HR(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var f=d;HR(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),d=d.sibling}}function mh(d,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)$R(d,f.alternate,f),f=f.sibling}function dp(d){for(d=d.child;d!==null;){var f=d;switch(f.tag){case 0:case 11:case 14:case 15:Df(4,f,f.return),dp(f);break;case 1:md(f,f.return);var x=f.stateNode;typeof x.componentWillUnmount=="function"&&OR(f,f.return,x),dp(f);break;case 27:ay(f.stateNode);case 26:case 5:md(f,f.return),dp(f);break;case 22:f.memoizedState===null&&dp(f);break;case 30:dp(f);break;default:dp(f)}d=d.sibling}}function gh(d,f,x){for(x=x&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var N=f.alternate,P=d,F=f,ie=F.flags;switch(F.tag){case 0:case 11:case 15:gh(P,F,x),Xb(4,F);break;case 1:if(gh(P,F,x),N=F,P=N.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(tt){hs(N,N.return,tt)}if(N=F,P=N.updateQueue,P!==null){var ge=N.stateNode;try{var Le=P.shared.hiddenCallbacks;if(Le!==null)for(P.shared.hiddenCallbacks=null,P=0;P<Le.length;P++)Qa(Le[P],ge)}catch(tt){hs(N,N.return,tt)}}x&&ie&64&&PR(F),Qb(F,F.return);break;case 27:DR(F);case 26:case 5:gh(P,F,x),x&&N===null&&ie&4&&RR(F),Qb(F,F.return);break;case 12:gh(P,F,x);break;case 31:gh(P,F,x),x&&ie&4&&zR(P,F);break;case 13:gh(P,F,x),x&&ie&4&&qR(P,F);break;case 22:F.memoizedState===null&&gh(P,F,x),Qb(F,F.return);break;case 30:break;default:gh(P,F,x)}f=f.sibling}}function nS(d,f){var x=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),d=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(d=f.memoizedState.cachePool.pool),d!==x&&(d!=null&&d.refCount++,x!=null&&ap(x))}function sS(d,f){d=null,f.alternate!==null&&(d=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==d&&(f.refCount++,d!=null&&ap(d))}function ju(d,f,x,N){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)WR(d,f,x,N),f=f.sibling}function WR(d,f,x,N){var P=f.flags;switch(f.tag){case 0:case 11:case 15:ju(d,f,x,N),P&2048&&Xb(9,f);break;case 1:ju(d,f,x,N);break;case 3:ju(d,f,x,N),P&2048&&(d=null,f.alternate!==null&&(d=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==d&&(f.refCount++,d!=null&&ap(d)));break;case 12:if(P&2048){ju(d,f,x,N),d=f.stateNode;try{var F=f.memoizedProps,ie=F.id,ge=F.onPostCommit;typeof ge=="function"&&ge(ie,f.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Le){hs(f,f.return,Le)}}else ju(d,f,x,N);break;case 31:ju(d,f,x,N);break;case 13:ju(d,f,x,N);break;case 23:break;case 22:F=f.stateNode,ie=f.alternate,f.memoizedState!==null?F._visibility&2?ju(d,f,x,N):Jb(d,f):F._visibility&2?ju(d,f,x,N):(F._visibility|=2,bg(d,f,x,N,(f.subtreeFlags&10256)!==0||!1)),P&2048&&nS(ie,f);break;case 24:ju(d,f,x,N),P&2048&&sS(f.alternate,f);break;default:ju(d,f,x,N)}}function bg(d,f,x,N,P){for(P=P&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var F=d,ie=f,ge=x,Le=N,tt=ie.flags;switch(ie.tag){case 0:case 11:case 15:bg(F,ie,ge,Le,P),Xb(8,ie);break;case 23:break;case 22:var yt=ie.stateNode;ie.memoizedState!==null?yt._visibility&2?bg(F,ie,ge,Le,P):Jb(F,ie):(yt._visibility|=2,bg(F,ie,ge,Le,P)),P&&tt&2048&&nS(ie.alternate,ie);break;case 24:bg(F,ie,ge,Le,P),P&&tt&2048&&sS(ie.alternate,ie);break;default:bg(F,ie,ge,Le,P)}f=f.sibling}}function Jb(d,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var x=d,N=f,P=N.flags;switch(N.tag){case 22:Jb(x,N),P&2048&&nS(N.alternate,N);break;case 24:Jb(x,N),P&2048&&sS(N.alternate,N);break;default:Jb(x,N)}f=f.sibling}}var Zb=8192;function yg(d,f,x){if(d.subtreeFlags&Zb)for(d=d.child;d!==null;)GR(d,f,x),d=d.sibling}function GR(d,f,x){switch(d.tag){case 26:yg(d,f,x),d.flags&Zb&&d.memoizedState!==null&&Uoe(x,Nu,d.memoizedState,d.memoizedProps);break;case 5:yg(d,f,x);break;case 3:case 4:var N=Nu;Nu=cw(d.stateNode.containerInfo),yg(d,f,x),Nu=N;break;case 22:d.memoizedState===null&&(N=d.alternate,N!==null&&N.memoizedState!==null?(N=Zb,Zb=16777216,yg(d,f,x),Zb=N):yg(d,f,x));break;default:yg(d,f,x)}}function KR(d){var f=d.alternate;if(f!==null&&(d=f.child,d!==null)){f.child=null;do f=d.sibling,d.sibling=null,d=f;while(d!==null)}}function ey(d){var f=d.deletions;if((d.flags&16)!==0){if(f!==null)for(var x=0;x<f.length;x++){var N=f[x];Za=N,XR(N,d)}KR(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)YR(d),d=d.sibling}function YR(d){switch(d.tag){case 0:case 11:case 15:ey(d),d.flags&2048&&Df(9,d,d.return);break;case 3:ey(d);break;case 12:ey(d);break;case 22:var f=d.stateNode;d.memoizedState!==null&&f._visibility&2&&(d.return===null||d.return.tag!==13)?(f._visibility&=-3,X2(d)):ey(d);break;default:ey(d)}}function X2(d){var f=d.deletions;if((d.flags&16)!==0){if(f!==null)for(var x=0;x<f.length;x++){var N=f[x];Za=N,XR(N,d)}KR(d)}for(d=d.child;d!==null;){switch(f=d,f.tag){case 0:case 11:case 15:Df(8,f,f.return),X2(f);break;case 22:x=f.stateNode,x._visibility&2&&(x._visibility&=-3,X2(f));break;default:X2(f)}d=d.sibling}}function XR(d,f){for(;Za!==null;){var x=Za;switch(x.tag){case 0:case 11:case 15:Df(8,x,f);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var N=x.memoizedState.cachePool.pool;N!=null&&N.refCount++}break;case 24:ap(x.memoizedState.cache)}if(N=x.child,N!==null)N.return=x,Za=N;else e:for(x=d;Za!==null;){N=Za;var P=N.sibling,F=N.return;if(FR(N),N===x){Za=null;break e}if(P!==null){P.return=F,Za=P;break e}Za=F}}}var roe={getCacheForType:function(d){var f=Ta(Si),x=f.data.get(d);return x===void 0&&(x=d(),f.data.set(d,x)),x},cacheSignal:function(){return Ta(Si).controller.signal}},noe=typeof WeakMap=="function"?WeakMap:Map,ns=0,Os=null,yn=null,kn=0,ds=0,cc=null,Bf=!1,vg=!1,iS=!1,xh=0,zi=0,$f=0,hp=0,aS=0,uc=0,wg=0,ty=null,zl=null,oS=!1,Q2=0,QR=0,J2=1/0,Z2=null,Ff=null,La=0,Uf=null,Ng=null,bh=0,lS=0,cS=null,JR=null,ry=0,uS=null;function dc(){return(ns&2)!==0&&kn!==0?kn&-kn:X.T!==null?gS():Ee()}function ZR(){if(uc===0)if((kn&536870912)===0||bn){var d=Br;Br<<=1,(Br&3932160)===0&&(Br=262144),uc=d}else uc=536870912;return d=Js.current,d!==null&&(d.flags|=32),uc}function ql(d,f,x){(d===Os&&(ds===2||ds===9)||d.cancelPendingCommit!==null)&&(jg(d,0),zf(d,kn,uc,!1)),It(d,x),((ns&2)===0||d!==Os)&&(d===Os&&((ns&2)===0&&(hp|=x),zi===4&&zf(d,kn,uc,!1)),gd(d))}function eM(d,f,x){if((ns&6)!==0)throw Error(n(327));var N=!x&&(f&127)===0&&(f&d.expiredLanes)===0||ur(d,f),P=N?aoe(d,f):hS(d,f,!0),F=N;do{if(P===0){vg&&!N&&zf(d,f,0,!1);break}else{if(x=d.current.alternate,F&&!soe(x)){P=hS(d,f,!1),F=!1;continue}if(P===2){if(F=f,d.errorRecoveryDisabledLanes&F)var ie=0;else ie=d.pendingLanes&-536870913,ie=ie!==0?ie:ie&536870912?536870912:0;if(ie!==0){f=ie;e:{var ge=d;P=ty;var Le=ge.current.memoizedState.isDehydrated;if(Le&&(jg(ge,ie).flags|=256),ie=hS(ge,ie,!1),ie!==2){if(iS&&!Le){ge.errorRecoveryDisabledLanes|=F,hp|=F,P=4;break e}F=zl,zl=P,F!==null&&(zl===null?zl=F:zl.push.apply(zl,F))}P=ie}if(F=!1,P!==2)continue}}if(P===1){jg(d,0),zf(d,f,0,!0);break}e:{switch(N=d,F=P,F){case 0:case 1:throw Error(n(345));case 4:if((f&4194048)!==f)break;case 6:zf(N,f,uc,!Bf);break e;case 2:zl=null;break;case 3:case 5:break;default:throw Error(n(329))}if((f&62914560)===f&&(P=Q2+300-at(),10<P)){if(zf(N,f,uc,!Bf),qt(N,0,!0)!==0)break e;bh=f,N.timeoutHandle=IM(tM.bind(null,N,x,zl,Z2,oS,f,uc,hp,wg,Bf,F,"Throttled",-0,0),P);break e}tM(N,x,zl,Z2,oS,f,uc,hp,wg,Bf,F,null,-0,0)}}break}while(!0);gd(d)}function tM(d,f,x,N,P,F,ie,ge,Le,tt,yt,Ct,lt,ht){if(d.timeoutHandle=-1,Ct=f.subtreeFlags,Ct&8192||(Ct&16785408)===16785408){Ct={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:la},GR(f,F,Ct);var dr=(F&62914560)===F?Q2-at():(F&4194048)===F?QR-at():0;if(dr=zoe(Ct,dr),dr!==null){bh=F,d.cancelPendingCommit=dr(cM.bind(null,d,f,F,x,N,P,ie,ge,Le,yt,Ct,null,lt,ht)),zf(d,F,ie,!tt);return}}cM(d,f,F,x,N,P,ie,ge,Le)}function soe(d){for(var f=d;;){var x=f.tag;if((x===0||x===11||x===15)&&f.flags&16384&&(x=f.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var N=0;N<x.length;N++){var P=x[N],F=P.getSnapshot;P=P.value;try{if(!Sa(F(),P))return!1}catch{return!1}}if(x=f.child,f.subtreeFlags&16384&&x!==null)x.return=f,f=x;else{if(f===d)break;for(;f.sibling===null;){if(f.return===null||f.return===d)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function zf(d,f,x,N){f&=~aS,f&=~hp,d.suspendedLanes|=f,d.pingedLanes&=~f,N&&(d.warmLanes|=f),N=d.expirationTimes;for(var P=f;0<P;){var F=31-Ot(P),ie=1<<F;N[F]=-1,P&=~ie}x!==0&&Ae(d,x,f)}function ew(){return(ns&6)===0?(ny(0),!1):!0}function dS(){if(yn!==null){if(ds===0)var d=yn.return;else d=yn,Dc=od=null,dg(d),Et=null,fr=0,d=yn;for(;d!==null;)LR(d.alternate,d),d=d.return;yn=null}}function jg(d,f){var x=d.timeoutHandle;x!==-1&&(d.timeoutHandle=-1,koe(x)),x=d.cancelPendingCommit,x!==null&&(d.cancelPendingCommit=null,x()),bh=0,dS(),Os=d,yn=x=Il(d.current,null),kn=f,ds=0,cc=null,Bf=!1,vg=ur(d,f),iS=!1,wg=uc=aS=hp=$f=zi=0,zl=ty=null,oS=!1,(f&8)!==0&&(f|=f&32);var N=d.entangledLanes;if(N!==0)for(d=d.entanglements,N&=f;0<N;){var P=31-Ot(N),F=1<<P;f|=d[P],N&=~F}return xh=f,ep(),x}function rM(d,f){Ar=null,X.H=Gb,f===De||f===Se?(f=wt(),ds=3):f===Qe?(f=wt(),ds=4):ds=f===q_?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,cc=f,yn===null&&(zi=1,q2(d,Ll(f,d.current)))}function nM(){var d=Js.current;return d===null?!0:(kn&4194048)===kn?Dn===null:(kn&62914560)===kn||(kn&536870912)!==0?d===Dn:!1}function sM(){var d=X.H;return X.H=Gb,d===null?Gb:d}function iM(){var d=X.A;return X.A=roe,d}function tw(){zi=4,Bf||(kn&4194048)!==kn&&Js.current!==null||(vg=!0),($f&134217727)===0&&(hp&134217727)===0||Os===null||zf(Os,kn,uc,!1)}function hS(d,f,x){var N=ns;ns|=2;var P=sM(),F=iM();(Os!==d||kn!==f)&&(Z2=null,jg(d,f)),f=!1;var ie=zi;e:do try{if(ds!==0&&yn!==null){var ge=yn,Le=cc;switch(ds){case 8:dS(),ie=6;break e;case 3:case 2:case 9:case 6:Js.current===null&&(f=!0);var tt=ds;if(ds=0,cc=null,kg(d,ge,Le,tt),x&&vg){ie=0;break e}break;default:tt=ds,ds=0,cc=null,kg(d,ge,Le,tt)}}ioe(),ie=zi;break}catch(yt){rM(d,yt)}while(!0);return f&&d.shellSuspendCounter++,Dc=od=null,ns=N,X.H=P,X.A=F,yn===null&&(Os=null,kn=0,ep()),ie}function ioe(){for(;yn!==null;)aM(yn)}function aoe(d,f){var x=ns;ns|=2;var N=sM(),P=iM();Os!==d||kn!==f?(Z2=null,J2=at()+500,jg(d,f)):vg=ur(d,f);e:do try{if(ds!==0&&yn!==null){f=yn;var F=cc;t:switch(ds){case 1:ds=0,cc=null,kg(d,f,F,1);break;case 2:case 9:if(Ke(F)){ds=0,cc=null,oM(f);break}f=function(){ds!==2&&ds!==9||Os!==d||(ds=7),gd(d)},F.then(f,f);break e;case 3:ds=7;break e;case 4:ds=5;break e;case 7:Ke(F)?(ds=0,cc=null,oM(f)):(ds=0,cc=null,kg(d,f,F,7));break;case 5:var ie=null;switch(yn.tag){case 26:ie=yn.memoizedState;case 5:case 27:var ge=yn;if(ie?WM(ie):ge.stateNode.complete){ds=0,cc=null;var Le=ge.sibling;if(Le!==null)yn=Le;else{var tt=ge.return;tt!==null?(yn=tt,rw(tt)):yn=null}break t}}ds=0,cc=null,kg(d,f,F,5);break;case 6:ds=0,cc=null,kg(d,f,F,6);break;case 8:dS(),zi=6;break e;default:throw Error(n(462))}}ooe();break}catch(yt){rM(d,yt)}while(!0);return Dc=od=null,X.H=N,X.A=P,ns=x,yn!==null?0:(Os=null,kn=0,ep(),zi)}function ooe(){for(;yn!==null&&!Vt();)aM(yn)}function aM(d){var f=TR(d.alternate,d,xh);d.memoizedProps=d.pendingProps,f===null?rw(d):yn=f}function oM(d){var f=d,x=f.alternate;switch(f.tag){case 15:case 0:f=kR(x,f,f.pendingProps,f.type,void 0,kn);break;case 11:f=kR(x,f,f.pendingProps,f.type.render,f.ref,kn);break;case 5:dg(f);default:LR(x,f),f=yn=np(f,xh),f=TR(x,f,xh)}d.memoizedProps=d.pendingProps,f===null?rw(d):yn=f}function kg(d,f,x,N){Dc=od=null,dg(f),Et=null,fr=0;var P=f.return;try{if(Yae(d,P,f,x,kn)){zi=1,q2(d,Ll(x,d.current)),yn=null;return}}catch(F){if(P!==null)throw yn=P,F;zi=1,q2(d,Ll(x,d.current)),yn=null;return}f.flags&32768?(bn||N===1?d=!0:vg||(kn&536870912)!==0?d=!1:(Bf=d=!0,(N===2||N===9||N===3||N===6)&&(N=Js.current,N!==null&&N.tag===13&&(N.flags|=16384))),lM(f,d)):rw(f)}function rw(d){var f=d;do{if((f.flags&32768)!==0){lM(f,Bf);return}d=f.return;var x=Jae(f.alternate,f,xh);if(x!==null){yn=x;return}if(f=f.sibling,f!==null){yn=f;return}yn=f=d}while(f!==null);zi===0&&(zi=5)}function lM(d,f){do{var x=Zae(d.alternate,d);if(x!==null){x.flags&=32767,yn=x;return}if(x=d.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!f&&(d=d.sibling,d!==null)){yn=d;return}yn=d=x}while(d!==null);zi=6,yn=null}function cM(d,f,x,N,P,F,ie,ge,Le){d.cancelPendingCommit=null;do nw();while(La!==0);if((ns&6)!==0)throw Error(n(327));if(f!==null){if(f===d.current)throw Error(n(177));if(F=f.lanes|f.childLanes,F|=Qm,Zt(d,x,F,ie,ge,Le),d===Os&&(yn=Os=null,kn=0),Ng=f,Uf=d,bh=x,lS=F,cS=P,JR=N,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,doe(ot,function(){return pM(),null})):(d.callbackNode=null,d.callbackPriority=0),N=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||N){N=X.T,X.T=null,P=J.p,J.p=2,ie=ns,ns|=4;try{eoe(d,f,x)}finally{ns=ie,J.p=P,X.T=N}}La=1,uM(),dM(),hM()}}function uM(){if(La===1){La=0;var d=Uf,f=Ng,x=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||x){x=X.T,X.T=null;var N=J.p;J.p=2;var P=ns;ns|=4;try{VR(f,d);var F=kS,ie=pu(d.containerInfo),ge=F.focusedElem,Le=F.selectionRange;if(ie!==ge&&ge&&ge.ownerDocument&&fu(ge.ownerDocument.documentElement,ge)){if(Le!==null&&Rc(ge)){var tt=Le.start,yt=Le.end;if(yt===void 0&&(yt=tt),"selectionStart"in ge)ge.selectionStart=tt,ge.selectionEnd=Math.min(yt,ge.value.length);else{var Ct=ge.ownerDocument||document,lt=Ct&&Ct.defaultView||window;if(lt.getSelection){var ht=lt.getSelection(),dr=ge.textContent.length,$r=Math.min(Le.start,dr),Ss=Le.end===void 0?$r:Math.min(Le.end,dr);!ht.extend&&$r>Ss&&(ie=Ss,Ss=$r,$r=ie);var He=Sf(ge,$r),$e=Sf(ge,Ss);if(He&&$e&&(ht.rangeCount!==1||ht.anchorNode!==He.node||ht.anchorOffset!==He.offset||ht.focusNode!==$e.node||ht.focusOffset!==$e.offset)){var Ze=Ct.createRange();Ze.setStart(He.node,He.offset),ht.removeAllRanges(),$r>Ss?(ht.addRange(Ze),ht.extend($e.node,$e.offset)):(Ze.setEnd($e.node,$e.offset),ht.addRange(Ze))}}}}for(Ct=[],ht=ge;ht=ht.parentNode;)ht.nodeType===1&&Ct.push({element:ht,left:ht.scrollLeft,top:ht.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<Ct.length;ge++){var kt=Ct[ge];kt.element.scrollLeft=kt.left,kt.element.scrollTop=kt.top}}mw=!!jS,kS=jS=null}finally{ns=P,J.p=N,X.T=x}}d.current=f,La=2}}function dM(){if(La===2){La=0;var d=Uf,f=Ng,x=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||x){x=X.T,X.T=null;var N=J.p;J.p=2;var P=ns;ns|=4;try{$R(d,f.alternate,f)}finally{ns=P,J.p=N,X.T=x}}La=3}}function hM(){if(La===4||La===3){La=0,Lt();var d=Uf,f=Ng,x=bh,N=JR;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?La=5:(La=0,Ng=Uf=null,fM(d,d.pendingLanes));var P=d.pendingLanes;if(P===0&&(Ff=null),Qt(x),f=f.stateNode,qe&&typeof qe.onCommitFiberRoot=="function")try{qe.onCommitFiberRoot(jt,f,void 0,(f.current.flags&128)===128)}catch{}if(N!==null){f=X.T,P=J.p,J.p=2,X.T=null;try{for(var F=d.onRecoverableError,ie=0;ie<N.length;ie++){var ge=N[ie];F(ge.value,{componentStack:ge.stack})}}finally{X.T=f,J.p=P}}(bh&3)!==0&&nw(),gd(d),P=d.pendingLanes,(x&261930)!==0&&(P&42)!==0?d===uS?ry++:(ry=0,uS=d):ry=0,ny(0)}}function fM(d,f){(d.pooledCacheLanes&=f)===0&&(f=d.pooledCache,f!=null&&(d.pooledCache=null,ap(f)))}function nw(){return uM(),dM(),hM(),pM()}function pM(){if(La!==5)return!1;var d=Uf,f=lS;lS=0;var x=Qt(bh),N=X.T,P=J.p;try{J.p=32>x?32:x,X.T=null,x=cS,cS=null;var F=Uf,ie=bh;if(La=0,Ng=Uf=null,bh=0,(ns&6)!==0)throw Error(n(331));var ge=ns;if(ns|=4,YR(F.current),WR(F,F.current,ie,x),ns=ge,ny(0,!1),qe&&typeof qe.onPostCommitFiberRoot=="function")try{qe.onPostCommitFiberRoot(jt,F)}catch{}return!0}finally{J.p=P,X.T=N,fM(d,f)}}function mM(d,f,x){f=Ll(x,f),f=z_(d.stateNode,f,2),d=nn(d,f,2),d!==null&&(It(d,2),gd(d))}function hs(d,f,x){if(d.tag===3)mM(d,d,x);else for(;f!==null;){if(f.tag===3){mM(f,d,x);break}else if(f.tag===1){var N=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(Ff===null||!Ff.has(N))){d=Ll(x,d),x=gR(2),N=nn(f,x,2),N!==null&&(xR(x,N,f,d),It(N,2),gd(N));break}}f=f.return}}function fS(d,f,x){var N=d.pingCache;if(N===null){N=d.pingCache=new noe;var P=new Set;N.set(f,P)}else P=N.get(f),P===void 0&&(P=new Set,N.set(f,P));P.has(x)||(iS=!0,P.add(x),d=loe.bind(null,d,f,x),f.then(d,d))}function loe(d,f,x){var N=d.pingCache;N!==null&&N.delete(f),d.pingedLanes|=d.suspendedLanes&x,d.warmLanes&=~x,Os===d&&(kn&x)===x&&(zi===4||zi===3&&(kn&62914560)===kn&&300>at()-Q2?(ns&2)===0&&jg(d,0):aS|=x,wg===kn&&(wg=0)),gd(d)}function gM(d,f){f===0&&(f=Nt()),d=gu(d,f),d!==null&&(It(d,f),gd(d))}function coe(d){var f=d.memoizedState,x=0;f!==null&&(x=f.retryLane),gM(d,x)}function uoe(d,f){var x=0;switch(d.tag){case 31:case 13:var N=d.stateNode,P=d.memoizedState;P!==null&&(x=P.retryLane);break;case 19:N=d.stateNode;break;case 22:N=d.stateNode._retryCache;break;default:throw Error(n(314))}N!==null&&N.delete(f),gM(d,x)}function doe(d,f){return Ye(d,f)}var sw=null,_g=null,pS=!1,iw=!1,mS=!1,qf=0;function gd(d){d!==_g&&d.next===null&&(_g===null?sw=_g=d:_g=_g.next=d),iw=!0,pS||(pS=!0,foe())}function ny(d,f){if(!mS&&iw){mS=!0;do for(var x=!1,N=sw;N!==null;){if(d!==0){var P=N.pendingLanes;if(P===0)var F=0;else{var ie=N.suspendedLanes,ge=N.pingedLanes;F=(1<<31-Ot(42|d)+1)-1,F&=P&~(ie&~ge),F=F&201326741?F&201326741|1:F?F|2:0}F!==0&&(x=!0,vM(N,F))}else F=kn,F=qt(N,N===Os?F:0,N.cancelPendingCommit!==null||N.timeoutHandle!==-1),(F&3)===0||ur(N,F)||(x=!0,vM(N,F));N=N.next}while(x);mS=!1}}function hoe(){xM()}function xM(){iw=pS=!1;var d=0;qf!==0&&joe()&&(d=qf);for(var f=at(),x=null,N=sw;N!==null;){var P=N.next,F=bM(N,f);F===0?(N.next=null,x===null?sw=P:x.next=P,P===null&&(_g=x)):(x=N,(d!==0||(F&3)!==0)&&(iw=!0)),N=P}La!==0&&La!==5||ny(d),qf!==0&&(qf=0)}function bM(d,f){for(var x=d.suspendedLanes,N=d.pingedLanes,P=d.expirationTimes,F=d.pendingLanes&-62914561;0<F;){var ie=31-Ot(F),ge=1<<ie,Le=P[ie];Le===-1?((ge&x)===0||(ge&N)!==0)&&(P[ie]=Re(ge,f)):Le<=f&&(d.expiredLanes|=ge),F&=~ge}if(f=Os,x=kn,x=qt(d,d===f?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),N=d.callbackNode,x===0||d===f&&(ds===2||ds===9)||d.cancelPendingCommit!==null)return N!==null&&N!==null&&St(N),d.callbackNode=null,d.callbackPriority=0;if((x&3)===0||ur(d,x)){if(f=x&-x,f===d.callbackPriority)return f;switch(N!==null&&St(N),Qt(x)){case 2:case 8:x=ft;break;case 32:x=ot;break;case 268435456:x=At;break;default:x=ot}return N=yM.bind(null,d),x=Ye(x,N),d.callbackPriority=f,d.callbackNode=x,f}return N!==null&&N!==null&&St(N),d.callbackPriority=2,d.callbackNode=null,2}function yM(d,f){if(La!==0&&La!==5)return d.callbackNode=null,d.callbackPriority=0,null;var x=d.callbackNode;if(nw()&&d.callbackNode!==x)return null;var N=kn;return N=qt(d,d===Os?N:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),N===0?null:(eM(d,N,f),bM(d,at()),d.callbackNode!=null&&d.callbackNode===x?yM.bind(null,d):null)}function vM(d,f){if(nw())return null;eM(d,f,!0)}function foe(){_oe(function(){(ns&6)!==0?Ye(vt,hoe):xM()})}function gS(){if(qf===0){var d=C;d===0&&(d=rr,rr<<=1,(rr&261888)===0&&(rr=256)),qf=d}return qf}function wM(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:Ri(""+d)}function NM(d,f){var x=f.ownerDocument.createElement("input");return x.name=f.name,x.value=f.value,d.id&&x.setAttribute("form",d.id),f.parentNode.insertBefore(x,f),d=new FormData(d),x.parentNode.removeChild(x),d}function poe(d,f,x,N,P){if(f==="submit"&&x&&x.stateNode===P){var F=wM((P[tr]||null).action),ie=N.submitter;ie&&(f=(f=ie[tr]||null)?wM(f.formAction):ie.getAttribute("formAction"),f!==null&&(F=f,ie=null));var ge=new er("action","action",null,N,P);d.push({event:ge,listeners:[{instance:null,listener:function(){if(N.defaultPrevented){if(qf!==0){var Le=ie?NM(P,ie):new FormData(P);M_(x,{pending:!0,data:Le,method:P.method,action:F},null,Le)}}else typeof F=="function"&&(ge.preventDefault(),Le=ie?NM(P,ie):new FormData(P),M_(x,{pending:!0,data:Le,method:P.method,action:F},F,Le))},currentTarget:P}]})}}for(var xS=0;xS<nh.length;xS++){var bS=nh[xS],moe=bS.toLowerCase(),goe=bS[0].toUpperCase()+bS.slice(1);Tl(moe,"on"+goe)}Tl(rh,"onAnimationEnd"),Tl(J0,"onAnimationIteration"),Tl(Lb,"onAnimationStart"),Tl("dblclick","onDoubleClick"),Tl("focusin","onFocus"),Tl("focusout","onBlur"),Tl(T2,"onTransitionRun"),Tl(I2,"onTransitionStart"),Tl(L2,"onTransitionCancel"),Tl(Pb,"onTransitionEnd"),Li("onMouseEnter",["mouseout","mouseover"]),Li("onMouseLeave",["mouseout","mouseover"]),Li("onPointerEnter",["pointerout","pointerover"]),Li("onPointerLeave",["pointerout","pointerover"]),Xi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xoe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sy));function jM(d,f){f=(f&4)!==0;for(var x=0;x<d.length;x++){var N=d[x],P=N.event;N=N.listeners;e:{var F=void 0;if(f)for(var ie=N.length-1;0<=ie;ie--){var ge=N[ie],Le=ge.instance,tt=ge.currentTarget;if(ge=ge.listener,Le!==F&&P.isPropagationStopped())break e;F=ge,P.currentTarget=tt;try{F(P)}catch(yt){Z0(yt)}P.currentTarget=null,F=Le}else for(ie=0;ie<N.length;ie++){if(ge=N[ie],Le=ge.instance,tt=ge.currentTarget,ge=ge.listener,Le!==F&&P.isPropagationStopped())break e;F=ge,P.currentTarget=tt;try{F(P)}catch(yt){Z0(yt)}P.currentTarget=null,F=Le}}}}function vn(d,f){var x=f[Kr];x===void 0&&(x=f[Kr]=new Set);var N=d+"__bubble";x.has(N)||(kM(f,d,2,!1),x.add(N))}function yS(d,f,x){var N=0;f&&(N|=4),kM(x,d,N,f)}var aw="_reactListening"+Math.random().toString(36).slice(2);function vS(d){if(!d[aw]){d[aw]=!0,kl.forEach(function(x){x!=="selectionchange"&&(xoe.has(x)||yS(x,!1,d),yS(x,!0,d))});var f=d.nodeType===9?d:d.ownerDocument;f===null||f[aw]||(f[aw]=!0,yS("selectionchange",!1,f))}}function kM(d,f,x,N){switch(ZM(f)){case 2:var P=Hoe;break;case 8:P=Woe;break;default:P=RS}x=P.bind(null,f,x,d),P=void 0,!Fo||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(P=!0),N?P!==void 0?d.addEventListener(f,x,{capture:!0,passive:P}):d.addEventListener(f,x,!0):P!==void 0?d.addEventListener(f,x,{passive:P}):d.addEventListener(f,x,!1)}function wS(d,f,x,N,P){var F=N;if((f&1)===0&&(f&2)===0&&N!==null)e:for(;;){if(N===null)return;var ie=N.tag;if(ie===3||ie===4){var ge=N.stateNode.containerInfo;if(ge===P)break;if(ie===4)for(ie=N.return;ie!==null;){var Le=ie.tag;if((Le===3||Le===4)&&ie.stateNode.containerInfo===P)return;ie=ie.return}for(;ge!==null;){if(ie=Hn(ge),ie===null)return;if(Le=ie.tag,Le===5||Le===6||Le===26||Le===27){N=F=ie;continue e}ge=ge.parentNode}}N=N.return}$o(function(){var tt=F,yt=ji(x),Ct=[];e:{var lt=Ob.get(d);if(lt!==void 0){var ht=er,dr=d;switch(d){case"keypress":if(Q(x)===0)break e;case"keydown":case"keyup":ht=pn;break;case"focusin":dr="focus",ht=Ys;break;case"focusout":dr="blur",ht=Ys;break;case"beforeblur":case"afterblur":ht=Ys;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ht=ss;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ht=Wn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ht=K;break;case rh:case J0:case Lb:ht=z;break;case Pb:ht=we;break;case"scroll":case"scrollend":ht=Xr;break;case"wheel":ht=nt;break;case"copy":case"cut":case"paste":ht=_e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ht=is;break;case"toggle":case"beforetoggle":ht=Vr}var $r=(f&4)!==0,Ss=!$r&&(d==="scroll"||d==="scrollend"),He=$r?lt!==null?lt+"Capture":null:lt;$r=[];for(var $e=tt,Ze;$e!==null;){var kt=$e;if(Ze=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||Ze===null||He===null||(kt=Fs($e,He),kt!=null&&$r.push(iy($e,kt,Ze))),Ss)break;$e=$e.return}0<$r.length&&(lt=new ht(lt,dr,null,x,yt),Ct.push({event:lt,listeners:$r}))}}if((f&7)===0){e:{if(lt=d==="mouseover"||d==="pointerover",ht=d==="mouseout"||d==="pointerout",lt&&x!==ls&&(dr=x.relatedTarget||x.fromElement)&&(Hn(dr)||dr[Rr]))break e;if((ht||lt)&&(lt=yt.window===yt?yt:(lt=yt.ownerDocument)?lt.defaultView||lt.parentWindow:window,ht?(dr=x.relatedTarget||x.toElement,ht=tt,dr=dr?Hn(dr):null,dr!==null&&(Ss=a(dr),$r=dr.tag,dr!==Ss||$r!==5&&$r!==27&&$r!==6)&&(dr=null)):(ht=null,dr=tt),ht!==dr)){if($r=ss,kt="onMouseLeave",He="onMouseEnter",$e="mouse",(d==="pointerout"||d==="pointerover")&&($r=is,kt="onPointerLeave",He="onPointerEnter",$e="pointer"),Ss=ht==null?lt:Yi(ht),Ze=dr==null?lt:Yi(dr),lt=new $r(kt,$e+"leave",ht,x,yt),lt.target=Ss,lt.relatedTarget=Ze,kt=null,Hn(yt)===tt&&($r=new $r(He,$e+"enter",dr,x,yt),$r.target=Ze,$r.relatedTarget=Ss,kt=$r),Ss=kt,ht&&dr)t:{for($r=boe,He=ht,$e=dr,Ze=0,kt=He;kt;kt=$r(kt))Ze++;kt=0;for(var Pr=$e;Pr;Pr=$r(Pr))kt++;for(;0<Ze-kt;)He=$r(He),Ze--;for(;0<kt-Ze;)$e=$r($e),kt--;for(;Ze--;){if(He===$e||$e!==null&&He===$e.alternate){$r=He;break t}He=$r(He),$e=$r($e)}$r=null}else $r=null;ht!==null&&_M(Ct,lt,ht,$r,!1),dr!==null&&Ss!==null&&_M(Ct,Ss,dr,$r,!0)}}e:{if(lt=tt?Yi(tt):window,ht=lt.nodeName&&lt.nodeName.toLowerCase(),ht==="select"||ht==="input"&&lt.type==="file")var Kn=nd;else if(X0(lt))if(Uo)Kn=Pc;else{Kn=ki;var xr=kf}else ht=lt.nodeName,!ht||ht.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?tt&&Cl(tt.elementType)&&(Kn=nd):Kn=Xm;if(Kn&&(Kn=Kn(d,tt))){nl(Ct,Kn,x,yt);break e}xr&&xr(d,lt,tt),d==="focusout"&&tt&&lt.type==="number"&&tt.memoizedProps.value!=null&&rc(lt,"number",lt.value)}switch(xr=tt?Yi(tt):window,d){case"focusin":(X0(xr)||xr.contentEditable==="true")&&(sl=xr,mu=tt,Ka=null);break;case"focusout":Ka=mu=sl=null;break;case"mousedown":Al=!0;break;case"contextmenu":case"mouseup":case"dragend":Al=!1,zn(Ct,x,yt);break;case"selectionchange":if(th)break;case"keydown":case"keyup":zn(Ct,x,yt)}var on;if(un)e:{switch(d){case"compositionstart":var _n="onCompositionStart";break e;case"compositionend":_n="onCompositionEnd";break e;case"compositionupdate":_n="onCompositionUpdate";break e}_n=void 0}else Tc?rl(d,x)&&(_n="onCompositionEnd"):d==="keydown"&&x.keyCode===229&&(_n="onCompositionStart");_n&&(ka&&x.locale!=="ko"&&(Tc||_n!=="onCompositionStart"?_n==="onCompositionEnd"&&Tc&&(on=sc()):(Mi=yt,bo="value"in Mi?Mi.value:Mi.textContent,Tc=!0)),xr=ow(tt,_n),0<xr.length&&(_n=new ze(_n,d,null,x,yt),Ct.push({event:_n,listeners:xr}),on?_n.data=on:(on=Ac(x),on!==null&&(_n.data=on)))),(on=ca?yo(d,x):cu(d,x))&&(_n=ow(tt,"onBeforeInput"),0<_n.length&&(xr=new ze("onBeforeInput","beforeinput",null,x,yt),Ct.push({event:xr,listeners:_n}),xr.data=on)),poe(Ct,d,tt,x,yt)}jM(Ct,f)})}function iy(d,f,x){return{instance:d,listener:f,currentTarget:x}}function ow(d,f){for(var x=f+"Capture",N=[];d!==null;){var P=d,F=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||F===null||(P=Fs(d,x),P!=null&&N.unshift(iy(d,P,F)),P=Fs(d,f),P!=null&&N.push(iy(d,P,F))),d.tag===3)return N;d=d.return}return[]}function boe(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function _M(d,f,x,N,P){for(var F=f._reactName,ie=[];x!==null&&x!==N;){var ge=x,Le=ge.alternate,tt=ge.stateNode;if(ge=ge.tag,Le!==null&&Le===N)break;ge!==5&&ge!==26&&ge!==27||tt===null||(Le=tt,P?(tt=Fs(x,F),tt!=null&&ie.unshift(iy(x,tt,Le))):P||(tt=Fs(x,F),tt!=null&&ie.push(iy(x,tt,Le)))),x=x.return}ie.length!==0&&d.push({event:f,listeners:ie})}var yoe=/\r\n?/g,voe=/\u0000|\uFFFD/g;function SM(d){return(typeof d=="string"?d:""+d).replace(yoe,`
`).replace(voe,"")}function CM(d,f){return f=SM(f),SM(d)===f}function _s(d,f,x,N,P,F){switch(x){case"children":typeof N=="string"?f==="body"||f==="textarea"&&N===""||es(d,N):(typeof N=="number"||typeof N=="bigint")&&f!=="body"&&es(d,""+N);break;case"className":oi(d,"class",N);break;case"tabIndex":oi(d,"tabindex",N);break;case"dir":case"role":case"viewBox":case"width":case"height":oi(d,x,N);break;case"style":oa(d,N,F);break;case"data":if(f!=="object"){oi(d,"data",N);break}case"src":case"href":if(N===""&&(f!=="a"||x!=="href")){d.removeAttribute(x);break}if(N==null||typeof N=="function"||typeof N=="symbol"||typeof N=="boolean"){d.removeAttribute(x);break}N=Ri(""+N),d.setAttribute(x,N);break;case"action":case"formAction":if(typeof N=="function"){d.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof F=="function"&&(x==="formAction"?(f!=="input"&&_s(d,f,"name",P.name,P,null),_s(d,f,"formEncType",P.formEncType,P,null),_s(d,f,"formMethod",P.formMethod,P,null),_s(d,f,"formTarget",P.formTarget,P,null)):(_s(d,f,"encType",P.encType,P,null),_s(d,f,"method",P.method,P,null),_s(d,f,"target",P.target,P,null)));if(N==null||typeof N=="symbol"||typeof N=="boolean"){d.removeAttribute(x);break}N=Ri(""+N),d.setAttribute(x,N);break;case"onClick":N!=null&&(d.onclick=la);break;case"onScroll":N!=null&&vn("scroll",d);break;case"onScrollEnd":N!=null&&vn("scrollend",d);break;case"dangerouslySetInnerHTML":if(N!=null){if(typeof N!="object"||!("__html"in N))throw Error(n(61));if(x=N.__html,x!=null){if(P.children!=null)throw Error(n(60));d.innerHTML=x}}break;case"multiple":d.multiple=N&&typeof N!="function"&&typeof N!="symbol";break;case"muted":d.muted=N&&typeof N!="function"&&typeof N!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(N==null||typeof N=="function"||typeof N=="boolean"||typeof N=="symbol"){d.removeAttribute("xlink:href");break}x=Ri(""+N),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":N!=null&&typeof N!="function"&&typeof N!="symbol"?d.setAttribute(x,""+N):d.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":N&&typeof N!="function"&&typeof N!="symbol"?d.setAttribute(x,""):d.removeAttribute(x);break;case"capture":case"download":N===!0?d.setAttribute(x,""):N!==!1&&N!=null&&typeof N!="function"&&typeof N!="symbol"?d.setAttribute(x,N):d.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":N!=null&&typeof N!="function"&&typeof N!="symbol"&&!isNaN(N)&&1<=N?d.setAttribute(x,N):d.removeAttribute(x);break;case"rowSpan":case"start":N==null||typeof N=="function"||typeof N=="symbol"||isNaN(N)?d.removeAttribute(x):d.setAttribute(x,N);break;case"popover":vn("beforetoggle",d),vn("toggle",d),Qi(d,"popover",N);break;case"xlinkActuate":xs(d,"http://www.w3.org/1999/xlink","xlink:actuate",N);break;case"xlinkArcrole":xs(d,"http://www.w3.org/1999/xlink","xlink:arcrole",N);break;case"xlinkRole":xs(d,"http://www.w3.org/1999/xlink","xlink:role",N);break;case"xlinkShow":xs(d,"http://www.w3.org/1999/xlink","xlink:show",N);break;case"xlinkTitle":xs(d,"http://www.w3.org/1999/xlink","xlink:title",N);break;case"xlinkType":xs(d,"http://www.w3.org/1999/xlink","xlink:type",N);break;case"xmlBase":xs(d,"http://www.w3.org/XML/1998/namespace","xml:base",N);break;case"xmlLang":xs(d,"http://www.w3.org/XML/1998/namespace","xml:lang",N);break;case"xmlSpace":xs(d,"http://www.w3.org/XML/1998/namespace","xml:space",N);break;case"is":Qi(d,"is",N);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=El.get(x)||x,Qi(d,x,N))}}function NS(d,f,x,N,P,F){switch(x){case"style":oa(d,N,F);break;case"dangerouslySetInnerHTML":if(N!=null){if(typeof N!="object"||!("__html"in N))throw Error(n(61));if(x=N.__html,x!=null){if(P.children!=null)throw Error(n(60));d.innerHTML=x}}break;case"children":typeof N=="string"?es(d,N):(typeof N=="number"||typeof N=="bigint")&&es(d,""+N);break;case"onScroll":N!=null&&vn("scroll",d);break;case"onScrollEnd":N!=null&&vn("scrollend",d);break;case"onClick":N!=null&&(d.onclick=la);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gs.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(P=x.endsWith("Capture"),f=x.slice(2,P?x.length-7:void 0),F=d[tr]||null,F=F!=null?F[x]:null,typeof F=="function"&&d.removeEventListener(f,F,P),typeof N=="function")){typeof F!="function"&&F!==null&&(x in d?d[x]=null:d.hasAttribute(x)&&d.removeAttribute(x)),d.addEventListener(f,N,P);break e}x in d?d[x]=N:N===!0?d.setAttribute(x,""):Qi(d,x,N)}}}function ko(d,f,x){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vn("error",d),vn("load",d);var N=!1,P=!1,F;for(F in x)if(x.hasOwnProperty(F)){var ie=x[F];if(ie!=null)switch(F){case"src":N=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:_s(d,f,F,ie,x,null)}}P&&_s(d,f,"srcSet",x.srcSet,x,null),N&&_s(d,f,"src",x.src,x,null);return;case"input":vn("invalid",d);var ge=F=ie=P=null,Le=null,tt=null;for(N in x)if(x.hasOwnProperty(N)){var yt=x[N];if(yt!=null)switch(N){case"name":P=yt;break;case"type":ie=yt;break;case"checked":Le=yt;break;case"defaultChecked":tt=yt;break;case"value":F=yt;break;case"defaultValue":ge=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(n(137,f));break;default:_s(d,f,N,yt,x,null)}}Sl(d,F,ge,Le,tt,ie,P,!1);return;case"select":vn("invalid",d),N=ie=F=null;for(P in x)if(x.hasOwnProperty(P)&&(ge=x[P],ge!=null))switch(P){case"value":F=ge;break;case"defaultValue":ie=ge;break;case"multiple":N=ge;default:_s(d,f,P,ge,x,null)}f=F,x=ie,d.multiple=!!N,f!=null?Ni(d,!!N,f,!1):x!=null&&Ni(d,!!N,x,!0);return;case"textarea":vn("invalid",d),F=P=N=null;for(ie in x)if(x.hasOwnProperty(ie)&&(ge=x[ie],ge!=null))switch(ie){case"value":N=ge;break;case"defaultValue":P=ge;break;case"children":F=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(n(91));break;default:_s(d,f,ie,ge,x,null)}Ks(d,N,P,F);return;case"option":for(Le in x)x.hasOwnProperty(Le)&&(N=x[Le],N!=null)&&(Le==="selected"?d.selected=N&&typeof N!="function"&&typeof N!="symbol":_s(d,f,Le,N,x,null));return;case"dialog":vn("beforetoggle",d),vn("toggle",d),vn("cancel",d),vn("close",d);break;case"iframe":case"object":vn("load",d);break;case"video":case"audio":for(N=0;N<sy.length;N++)vn(sy[N],d);break;case"image":vn("error",d),vn("load",d);break;case"details":vn("toggle",d);break;case"embed":case"source":case"link":vn("error",d),vn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(tt in x)if(x.hasOwnProperty(tt)&&(N=x[tt],N!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:_s(d,f,tt,N,x,null)}return;default:if(Cl(f)){for(yt in x)x.hasOwnProperty(yt)&&(N=x[yt],N!==void 0&&NS(d,f,yt,N,x,void 0));return}}for(ge in x)x.hasOwnProperty(ge)&&(N=x[ge],N!=null&&_s(d,f,ge,N,x,null))}function woe(d,f,x,N){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,F=null,ie=null,ge=null,Le=null,tt=null,yt=null;for(ht in x){var Ct=x[ht];if(x.hasOwnProperty(ht)&&Ct!=null)switch(ht){case"checked":break;case"value":break;case"defaultValue":Le=Ct;default:N.hasOwnProperty(ht)||_s(d,f,ht,null,N,Ct)}}for(var lt in N){var ht=N[lt];if(Ct=x[lt],N.hasOwnProperty(lt)&&(ht!=null||Ct!=null))switch(lt){case"type":F=ht;break;case"name":P=ht;break;case"checked":tt=ht;break;case"defaultChecked":yt=ht;break;case"value":ie=ht;break;case"defaultValue":ge=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(n(137,f));break;default:ht!==Ct&&_s(d,f,lt,ht,N,Ct)}}tl(d,ie,ge,Le,tt,yt,F,P);return;case"select":ht=ie=ge=lt=null;for(F in x)if(Le=x[F],x.hasOwnProperty(F)&&Le!=null)switch(F){case"value":break;case"multiple":ht=Le;default:N.hasOwnProperty(F)||_s(d,f,F,null,N,Le)}for(P in N)if(F=N[P],Le=x[P],N.hasOwnProperty(P)&&(F!=null||Le!=null))switch(P){case"value":lt=F;break;case"defaultValue":ge=F;break;case"multiple":ie=F;default:F!==Le&&_s(d,f,P,F,N,Le)}f=ge,x=ie,N=ht,lt!=null?Ni(d,!!x,lt,!1):!!N!=!!x&&(f!=null?Ni(d,!!x,f,!0):Ni(d,!!x,x?[]:"",!1));return;case"textarea":ht=lt=null;for(ge in x)if(P=x[ge],x.hasOwnProperty(ge)&&P!=null&&!N.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:_s(d,f,ge,null,N,P)}for(ie in N)if(P=N[ie],F=x[ie],N.hasOwnProperty(ie)&&(P!=null||F!=null))switch(ie){case"value":lt=P;break;case"defaultValue":ht=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(91));break;default:P!==F&&_s(d,f,ie,P,N,F)}fo(d,lt,ht);return;case"option":for(var dr in x)lt=x[dr],x.hasOwnProperty(dr)&&lt!=null&&!N.hasOwnProperty(dr)&&(dr==="selected"?d.selected=!1:_s(d,f,dr,null,N,lt));for(Le in N)lt=N[Le],ht=x[Le],N.hasOwnProperty(Le)&&lt!==ht&&(lt!=null||ht!=null)&&(Le==="selected"?d.selected=lt&&typeof lt!="function"&&typeof lt!="symbol":_s(d,f,Le,lt,N,ht));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $r in x)lt=x[$r],x.hasOwnProperty($r)&&lt!=null&&!N.hasOwnProperty($r)&&_s(d,f,$r,null,N,lt);for(tt in N)if(lt=N[tt],ht=x[tt],N.hasOwnProperty(tt)&&lt!==ht&&(lt!=null||ht!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(n(137,f));break;default:_s(d,f,tt,lt,N,ht)}return;default:if(Cl(f)){for(var Ss in x)lt=x[Ss],x.hasOwnProperty(Ss)&&lt!==void 0&&!N.hasOwnProperty(Ss)&&NS(d,f,Ss,void 0,N,lt);for(yt in N)lt=N[yt],ht=x[yt],!N.hasOwnProperty(yt)||lt===ht||lt===void 0&&ht===void 0||NS(d,f,yt,lt,N,ht);return}}for(var He in x)lt=x[He],x.hasOwnProperty(He)&&lt!=null&&!N.hasOwnProperty(He)&&_s(d,f,He,null,N,lt);for(Ct in N)lt=N[Ct],ht=x[Ct],!N.hasOwnProperty(Ct)||lt===ht||lt==null&&ht==null||_s(d,f,Ct,lt,N,ht)}function EM(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Noe(){if(typeof performance.getEntriesByType=="function"){for(var d=0,f=0,x=performance.getEntriesByType("resource"),N=0;N<x.length;N++){var P=x[N],F=P.transferSize,ie=P.initiatorType,ge=P.duration;if(F&&ge&&EM(ie)){for(ie=0,ge=P.responseEnd,N+=1;N<x.length;N++){var Le=x[N],tt=Le.startTime;if(tt>ge)break;var yt=Le.transferSize,Ct=Le.initiatorType;yt&&EM(Ct)&&(Le=Le.responseEnd,ie+=yt*(Le<ge?1:(ge-tt)/(Le-tt)))}if(--N,f+=8*(F+ie)/(P.duration/1e3),d++,10<d)break}}if(0<d)return f/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var jS=null,kS=null;function lw(d){return d.nodeType===9?d:d.ownerDocument}function AM(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function TM(d,f){if(d===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&f==="foreignObject"?0:d}function _S(d,f){return d==="textarea"||d==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var SS=null;function joe(){var d=window.event;return d&&d.type==="popstate"?d===SS?!1:(SS=d,!0):(SS=null,!1)}var IM=typeof setTimeout=="function"?setTimeout:void 0,koe=typeof clearTimeout=="function"?clearTimeout:void 0,LM=typeof Promise=="function"?Promise:void 0,_oe=typeof queueMicrotask=="function"?queueMicrotask:typeof LM<"u"?function(d){return LM.resolve(null).then(d).catch(Soe)}:IM;function Soe(d){setTimeout(function(){throw d})}function Vf(d){return d==="head"}function PM(d,f){var x=f,N=0;do{var P=x.nextSibling;if(d.removeChild(x),P&&P.nodeType===8)if(x=P.data,x==="/$"||x==="/&"){if(N===0){d.removeChild(P),Ag(f);return}N--}else if(x==="$"||x==="$?"||x==="$~"||x==="$!"||x==="&")N++;else if(x==="html")ay(d.ownerDocument.documentElement);else if(x==="head"){x=d.ownerDocument.head,ay(x);for(var F=x.firstChild;F;){var ie=F.nextSibling,ge=F.nodeName;F[Ts]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&F.rel.toLowerCase()==="stylesheet"||x.removeChild(F),F=ie}}else x==="body"&&ay(d.ownerDocument.body);x=P}while(x);Ag(f)}function OM(d,f){var x=d;d=0;do{var N=x.nextSibling;if(x.nodeType===1?f?(x._stashedDisplay=x.style.display,x.style.display="none"):(x.style.display=x._stashedDisplay||"",x.getAttribute("style")===""&&x.removeAttribute("style")):x.nodeType===3&&(f?(x._stashedText=x.nodeValue,x.nodeValue=""):x.nodeValue=x._stashedText||""),N&&N.nodeType===8)if(x=N.data,x==="/$"){if(d===0)break;d--}else x!=="$"&&x!=="$?"&&x!=="$~"&&x!=="$!"||d++;x=N}while(x)}function CS(d){var f=d.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var x=f;switch(f=f.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":CS(x),wa(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}d.removeChild(x)}}function Coe(d,f,x,N){for(;d.nodeType===1;){var P=x;if(d.nodeName.toLowerCase()!==f.toLowerCase()){if(!N&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(N){if(!d[Ts])switch(f){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(F=d.getAttribute("rel"),F==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(F!==P.rel||d.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||d.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||d.getAttribute("title")!==(P.title==null?null:P.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(F=d.getAttribute("src"),(F!==(P.src==null?null:P.src)||d.getAttribute("type")!==(P.type==null?null:P.type)||d.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&F&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(f==="input"&&d.type==="hidden"){var F=P.name==null?null:""+P.name;if(P.type==="hidden"&&d.getAttribute("name")===F)return d}else return d;if(d=Fc(d.nextSibling),d===null)break}return null}function Eoe(d,f,x){if(f==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!x||(d=Fc(d.nextSibling),d===null))return null;return d}function RM(d,f){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!f||(d=Fc(d.nextSibling),d===null))return null;return d}function ES(d){return d.data==="$?"||d.data==="$~"}function AS(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function Aoe(d,f){var x=d.ownerDocument;if(d.data==="$~")d._reactRetry=f;else if(d.data!=="$?"||x.readyState!=="loading")f();else{var N=function(){f(),x.removeEventListener("DOMContentLoaded",N)};x.addEventListener("DOMContentLoaded",N),d._reactRetry=N}}function Fc(d){for(;d!=null;d=d.nextSibling){var f=d.nodeType;if(f===1||f===3)break;if(f===8){if(f=d.data,f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"||f==="F!"||f==="F")break;if(f==="/$"||f==="/&")return null}}return d}var TS=null;function MM(d){d=d.nextSibling;for(var f=0;d;){if(d.nodeType===8){var x=d.data;if(x==="/$"||x==="/&"){if(f===0)return Fc(d.nextSibling);f--}else x!=="$"&&x!=="$!"&&x!=="$?"&&x!=="$~"&&x!=="&"||f++}d=d.nextSibling}return null}function DM(d){d=d.previousSibling;for(var f=0;d;){if(d.nodeType===8){var x=d.data;if(x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"){if(f===0)return d;f--}else x!=="/$"&&x!=="/&"||f++}d=d.previousSibling}return null}function BM(d,f,x){switch(f=lw(x),d){case"html":if(d=f.documentElement,!d)throw Error(n(452));return d;case"head":if(d=f.head,!d)throw Error(n(453));return d;case"body":if(d=f.body,!d)throw Error(n(454));return d;default:throw Error(n(451))}}function ay(d){for(var f=d.attributes;f.length;)d.removeAttributeNode(f[0]);wa(d)}var Uc=new Map,$M=new Set;function cw(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var yh=J.d;J.d={f:Toe,r:Ioe,D:Loe,C:Poe,L:Ooe,m:Roe,X:Doe,S:Moe,M:Boe};function Toe(){var d=yh.f(),f=ew();return d||f}function Ioe(d){var f=wi(d);f!==null&&f.tag===5&&f.type==="form"?rR(f):yh.r(d)}var Sg=typeof document>"u"?null:document;function FM(d,f,x){var N=Sg;if(N&&typeof f=="string"&&f){var P=bs(f);P='link[rel="'+d+'"][href="'+P+'"]',typeof x=="string"&&(P+='[crossorigin="'+x+'"]'),$M.has(P)||($M.add(P),d={rel:d,crossOrigin:x,href:f},N.querySelector(P)===null&&(f=N.createElement("link"),ko(f,"link",d),os(f),N.head.appendChild(f)))}}function Loe(d){yh.D(d),FM("dns-prefetch",d,null)}function Poe(d,f){yh.C(d,f),FM("preconnect",d,f)}function Ooe(d,f,x){yh.L(d,f,x);var N=Sg;if(N&&d&&f){var P='link[rel="preload"][as="'+bs(f)+'"]';f==="image"&&x&&x.imageSrcSet?(P+='[imagesrcset="'+bs(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(P+='[imagesizes="'+bs(x.imageSizes)+'"]')):P+='[href="'+bs(d)+'"]';var F=P;switch(f){case"style":F=Cg(d);break;case"script":F=Eg(d)}Uc.has(F)||(d=p({rel:"preload",href:f==="image"&&x&&x.imageSrcSet?void 0:d,as:f},x),Uc.set(F,d),N.querySelector(P)!==null||f==="style"&&N.querySelector(oy(F))||f==="script"&&N.querySelector(ly(F))||(f=N.createElement("link"),ko(f,"link",d),os(f),N.head.appendChild(f)))}}function Roe(d,f){yh.m(d,f);var x=Sg;if(x&&d){var N=f&&typeof f.as=="string"?f.as:"script",P='link[rel="modulepreload"][as="'+bs(N)+'"][href="'+bs(d)+'"]',F=P;switch(N){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":F=Eg(d)}if(!Uc.has(F)&&(d=p({rel:"modulepreload",href:d},f),Uc.set(F,d),x.querySelector(P)===null)){switch(N){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(ly(F)))return}N=x.createElement("link"),ko(N,"link",d),os(N),x.head.appendChild(N)}}}function Moe(d,f,x){yh.S(d,f,x);var N=Sg;if(N&&d){var P=aa(N).hoistableStyles,F=Cg(d);f=f||"default";var ie=P.get(F);if(!ie){var ge={loading:0,preload:null};if(ie=N.querySelector(oy(F)))ge.loading=5;else{d=p({rel:"stylesheet",href:d,"data-precedence":f},x),(x=Uc.get(F))&&IS(d,x);var Le=ie=N.createElement("link");os(Le),ko(Le,"link",d),Le._p=new Promise(function(tt,yt){Le.onload=tt,Le.onerror=yt}),Le.addEventListener("load",function(){ge.loading|=1}),Le.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,uw(ie,f,N)}ie={type:"stylesheet",instance:ie,count:1,state:ge},P.set(F,ie)}}}function Doe(d,f){yh.X(d,f);var x=Sg;if(x&&d){var N=aa(x).hoistableScripts,P=Eg(d),F=N.get(P);F||(F=x.querySelector(ly(P)),F||(d=p({src:d,async:!0},f),(f=Uc.get(P))&&LS(d,f),F=x.createElement("script"),os(F),ko(F,"link",d),x.head.appendChild(F)),F={type:"script",instance:F,count:1,state:null},N.set(P,F))}}function Boe(d,f){yh.M(d,f);var x=Sg;if(x&&d){var N=aa(x).hoistableScripts,P=Eg(d),F=N.get(P);F||(F=x.querySelector(ly(P)),F||(d=p({src:d,async:!0,type:"module"},f),(f=Uc.get(P))&&LS(d,f),F=x.createElement("script"),os(F),ko(F,"link",d),x.head.appendChild(F)),F={type:"script",instance:F,count:1,state:null},N.set(P,F))}}function UM(d,f,x,N){var P=(P=be.current)?cw(P):null;if(!P)throw Error(n(446));switch(d){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(f=Cg(x.href),x=aa(P).hoistableStyles,N=x.get(f),N||(N={type:"style",instance:null,count:0,state:null},x.set(f,N)),N):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){d=Cg(x.href);var F=aa(P).hoistableStyles,ie=F.get(d);if(ie||(P=P.ownerDocument||P,ie={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},F.set(d,ie),(F=P.querySelector(oy(d)))&&!F._p&&(ie.instance=F,ie.state.loading=5),Uc.has(d)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},Uc.set(d,x),F||$oe(P,d,x,ie.state))),f&&N===null)throw Error(n(528,""));return ie}if(f&&N!==null)throw Error(n(529,""));return null;case"script":return f=x.async,x=x.src,typeof x=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Eg(x),x=aa(P).hoistableScripts,N=x.get(f),N||(N={type:"script",instance:null,count:0,state:null},x.set(f,N)),N):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,d))}}function Cg(d){return'href="'+bs(d)+'"'}function oy(d){return'link[rel="stylesheet"]['+d+"]"}function zM(d){return p({},d,{"data-precedence":d.precedence,precedence:null})}function $oe(d,f,x,N){d.querySelector('link[rel="preload"][as="style"]['+f+"]")?N.loading=1:(f=d.createElement("link"),N.preload=f,f.addEventListener("load",function(){return N.loading|=1}),f.addEventListener("error",function(){return N.loading|=2}),ko(f,"link",x),os(f),d.head.appendChild(f))}function Eg(d){return'[src="'+bs(d)+'"]'}function ly(d){return"script[async]"+d}function qM(d,f,x){if(f.count++,f.instance===null)switch(f.type){case"style":var N=d.querySelector('style[data-href~="'+bs(x.href)+'"]');if(N)return f.instance=N,os(N),N;var P=p({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return N=(d.ownerDocument||d).createElement("style"),os(N),ko(N,"style",P),uw(N,x.precedence,d),f.instance=N;case"stylesheet":P=Cg(x.href);var F=d.querySelector(oy(P));if(F)return f.state.loading|=4,f.instance=F,os(F),F;N=zM(x),(P=Uc.get(P))&&IS(N,P),F=(d.ownerDocument||d).createElement("link"),os(F);var ie=F;return ie._p=new Promise(function(ge,Le){ie.onload=ge,ie.onerror=Le}),ko(F,"link",N),f.state.loading|=4,uw(F,x.precedence,d),f.instance=F;case"script":return F=Eg(x.src),(P=d.querySelector(ly(F)))?(f.instance=P,os(P),P):(N=x,(P=Uc.get(F))&&(N=p({},x),LS(N,P)),d=d.ownerDocument||d,P=d.createElement("script"),os(P),ko(P,"link",N),d.head.appendChild(P),f.instance=P);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(N=f.instance,f.state.loading|=4,uw(N,x.precedence,d));return f.instance}function uw(d,f,x){for(var N=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=N.length?N[N.length-1]:null,F=P,ie=0;ie<N.length;ie++){var ge=N[ie];if(ge.dataset.precedence===f)F=ge;else if(F!==P)break}F?F.parentNode.insertBefore(d,F.nextSibling):(f=x.nodeType===9?x.head:x,f.insertBefore(d,f.firstChild))}function IS(d,f){d.crossOrigin==null&&(d.crossOrigin=f.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=f.referrerPolicy),d.title==null&&(d.title=f.title)}function LS(d,f){d.crossOrigin==null&&(d.crossOrigin=f.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=f.referrerPolicy),d.integrity==null&&(d.integrity=f.integrity)}var dw=null;function VM(d,f,x){if(dw===null){var N=new Map,P=dw=new Map;P.set(x,N)}else P=dw,N=P.get(x),N||(N=new Map,P.set(x,N));if(N.has(d))return N;for(N.set(d,null),x=x.getElementsByTagName(d),P=0;P<x.length;P++){var F=x[P];if(!(F[Ts]||F[Ft]||d==="link"&&F.getAttribute("rel")==="stylesheet")&&F.namespaceURI!=="http://www.w3.org/2000/svg"){var ie=F.getAttribute(f)||"";ie=d+ie;var ge=N.get(ie);ge?ge.push(F):N.set(ie,[F])}}return N}function HM(d,f,x){d=d.ownerDocument||d,d.head.insertBefore(x,f==="title"?d.querySelector("head > title"):null)}function Foe(d,f,x){if(x===1||f.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;return f.rel==="stylesheet"?(d=f.disabled,typeof f.precedence=="string"&&d==null):!0;case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function WM(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function Uoe(d,f,x,N){if(x.type==="stylesheet"&&(typeof N.media!="string"||matchMedia(N.media).matches!==!1)&&(x.state.loading&4)===0){if(x.instance===null){var P=Cg(N.href),F=f.querySelector(oy(P));if(F){f=F._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(d.count++,d=hw.bind(d),f.then(d,d)),x.state.loading|=4,x.instance=F,os(F);return}F=f.ownerDocument||f,N=zM(N),(P=Uc.get(P))&&IS(N,P),F=F.createElement("link"),os(F);var ie=F;ie._p=new Promise(function(ge,Le){ie.onload=ge,ie.onerror=Le}),ko(F,"link",N),x.instance=F}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(x,f),(f=x.state.preload)&&(x.state.loading&3)===0&&(d.count++,x=hw.bind(d),f.addEventListener("load",x),f.addEventListener("error",x))}}var PS=0;function zoe(d,f){return d.stylesheets&&d.count===0&&pw(d,d.stylesheets),0<d.count||0<d.imgCount?function(x){var N=setTimeout(function(){if(d.stylesheets&&pw(d,d.stylesheets),d.unsuspend){var F=d.unsuspend;d.unsuspend=null,F()}},6e4+f);0<d.imgBytes&&PS===0&&(PS=62500*Noe());var P=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&pw(d,d.stylesheets),d.unsuspend)){var F=d.unsuspend;d.unsuspend=null,F()}},(d.imgBytes>PS?50:800)+f);return d.unsuspend=x,function(){d.unsuspend=null,clearTimeout(N),clearTimeout(P)}}:null}function hw(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)pw(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var fw=null;function pw(d,f){d.stylesheets=null,d.unsuspend!==null&&(d.count++,fw=new Map,f.forEach(qoe,d),fw=null,hw.call(d))}function qoe(d,f){if(!(f.state.loading&4)){var x=fw.get(d);if(x)var N=x.get(null);else{x=new Map,fw.set(d,x);for(var P=d.querySelectorAll("link[data-precedence],style[data-precedence]"),F=0;F<P.length;F++){var ie=P[F];(ie.nodeName==="LINK"||ie.getAttribute("media")!=="not all")&&(x.set(ie.dataset.precedence,ie),N=ie)}N&&x.set(null,N)}P=f.instance,ie=P.getAttribute("data-precedence"),F=x.get(ie)||N,F===N&&x.set(null,P),x.set(ie,P),this.count++,N=hw.bind(this),P.addEventListener("load",N),P.addEventListener("error",N),F?F.parentNode.insertBefore(P,F.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(P,d.firstChild)),f.state.loading|=4}}var cy={$$typeof:E,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function Voe(d,f,x,N,P,F,ie,ge,Le){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pt(0),this.hiddenUpdates=Pt(null),this.identifierPrefix=N,this.onUncaughtError=P,this.onCaughtError=F,this.onRecoverableError=ie,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Le,this.incompleteTransitions=new Map}function GM(d,f,x,N,P,F,ie,ge,Le,tt,yt,Ct){return d=new Voe(d,f,x,ie,Le,tt,yt,Ct,ge),f=1,F===!0&&(f|=24),F=Xa(3,null,null,f),d.current=F,F.stateNode=d,f=Lf(),f.refCount++,d.pooledCache=f,f.refCount++,F.memoizedState={element:N,isDehydrated:x,cache:f},Yt(F),d}function KM(d){return d?(d=Ca,d):Ca}function YM(d,f,x,N,P,F){P=KM(P),N.context===null?N.context=P:N.pendingContext=P,N=Dr(f),N.payload={element:x},F=F===void 0?null:F,F!==null&&(N.callback=F),x=nn(d,N,f),x!==null&&(ql(x,d,f),ts(x,d,f))}function XM(d,f){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var x=d.retryLane;d.retryLane=x!==0&&x<f?x:f}}function OS(d,f){XM(d,f),(d=d.alternate)&&XM(d,f)}function QM(d){if(d.tag===13||d.tag===31){var f=gu(d,67108864);f!==null&&ql(f,d,67108864),OS(d,67108864)}}function JM(d){if(d.tag===13||d.tag===31){var f=dc();f=$t(f);var x=gu(d,f);x!==null&&ql(x,d,f),OS(d,f)}}var mw=!0;function Hoe(d,f,x,N){var P=X.T;X.T=null;var F=J.p;try{J.p=2,RS(d,f,x,N)}finally{J.p=F,X.T=P}}function Woe(d,f,x,N){var P=X.T;X.T=null;var F=J.p;try{J.p=8,RS(d,f,x,N)}finally{J.p=F,X.T=P}}function RS(d,f,x,N){if(mw){var P=MS(N);if(P===null)wS(d,f,N,gw,x),e7(d,N);else if(Koe(P,d,f,x,N))N.stopPropagation();else if(e7(d,N),f&4&&-1<Goe.indexOf(d)){for(;P!==null;){var F=wi(P);if(F!==null)switch(F.tag){case 3:if(F=F.stateNode,F.current.memoizedState.isDehydrated){var ie=Wt(F.pendingLanes);if(ie!==0){var ge=F;for(ge.pendingLanes|=2,ge.entangledLanes|=2;ie;){var Le=1<<31-Ot(ie);ge.entanglements[1]|=Le,ie&=~Le}gd(F),(ns&6)===0&&(J2=at()+500,ny(0))}}break;case 31:case 13:ge=gu(F,2),ge!==null&&ql(ge,F,2),ew(),OS(F,2)}if(F=MS(N),F===null&&wS(d,f,N,gw,x),F===P)break;P=F}P!==null&&N.stopPropagation()}else wS(d,f,N,null,x)}}function MS(d){return d=ji(d),DS(d)}var gw=null;function DS(d){if(gw=null,d=Hn(d),d!==null){var f=a(d);if(f===null)d=null;else{var x=f.tag;if(x===13){if(d=o(f),d!==null)return d;d=null}else if(x===31){if(d=l(f),d!==null)return d;d=null}else if(x===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;d=null}else f!==d&&(d=null)}}return gw=d,null}function ZM(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gt()){case vt:return 2;case ft:return 8;case ot:case ut:return 32;case At:return 268435456;default:return 32}default:return 32}}var BS=!1,Hf=null,Wf=null,Gf=null,uy=new Map,dy=new Map,Kf=[],Goe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function e7(d,f){switch(d){case"focusin":case"focusout":Hf=null;break;case"dragenter":case"dragleave":Wf=null;break;case"mouseover":case"mouseout":Gf=null;break;case"pointerover":case"pointerout":uy.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":dy.delete(f.pointerId)}}function hy(d,f,x,N,P,F){return d===null||d.nativeEvent!==F?(d={blockedOn:f,domEventName:x,eventSystemFlags:N,nativeEvent:F,targetContainers:[P]},f!==null&&(f=wi(f),f!==null&&QM(f)),d):(d.eventSystemFlags|=N,f=d.targetContainers,P!==null&&f.indexOf(P)===-1&&f.push(P),d)}function Koe(d,f,x,N,P){switch(f){case"focusin":return Hf=hy(Hf,d,f,x,N,P),!0;case"dragenter":return Wf=hy(Wf,d,f,x,N,P),!0;case"mouseover":return Gf=hy(Gf,d,f,x,N,P),!0;case"pointerover":var F=P.pointerId;return uy.set(F,hy(uy.get(F)||null,d,f,x,N,P)),!0;case"gotpointercapture":return F=P.pointerId,dy.set(F,hy(dy.get(F)||null,d,f,x,N,P)),!0}return!1}function t7(d){var f=Hn(d.target);if(f!==null){var x=a(f);if(x!==null){if(f=x.tag,f===13){if(f=o(x),f!==null){d.blockedOn=f,Me(d.priority,function(){JM(x)});return}}else if(f===31){if(f=l(x),f!==null){d.blockedOn=f,Me(d.priority,function(){JM(x)});return}}else if(f===3&&x.stateNode.current.memoizedState.isDehydrated){d.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}d.blockedOn=null}function xw(d){if(d.blockedOn!==null)return!1;for(var f=d.targetContainers;0<f.length;){var x=MS(d.nativeEvent);if(x===null){x=d.nativeEvent;var N=new x.constructor(x.type,x);ls=N,x.target.dispatchEvent(N),ls=null}else return f=wi(x),f!==null&&QM(f),d.blockedOn=x,!1;f.shift()}return!0}function r7(d,f,x){xw(d)&&x.delete(f)}function Yoe(){BS=!1,Hf!==null&&xw(Hf)&&(Hf=null),Wf!==null&&xw(Wf)&&(Wf=null),Gf!==null&&xw(Gf)&&(Gf=null),uy.forEach(r7),dy.forEach(r7)}function bw(d,f){d.blockedOn===f&&(d.blockedOn=null,BS||(BS=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Yoe)))}var yw=null;function n7(d){yw!==d&&(yw=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yw===d&&(yw=null);for(var f=0;f<d.length;f+=3){var x=d[f],N=d[f+1],P=d[f+2];if(typeof N!="function"){if(DS(N||x)===null)continue;break}var F=wi(x);F!==null&&(d.splice(f,3),f-=3,M_(F,{pending:!0,data:P,method:x.method,action:N},N,P))}}))}function Ag(d){function f(Le){return bw(Le,d)}Hf!==null&&bw(Hf,d),Wf!==null&&bw(Wf,d),Gf!==null&&bw(Gf,d),uy.forEach(f),dy.forEach(f);for(var x=0;x<Kf.length;x++){var N=Kf[x];N.blockedOn===d&&(N.blockedOn=null)}for(;0<Kf.length&&(x=Kf[0],x.blockedOn===null);)t7(x),x.blockedOn===null&&Kf.shift();if(x=(d.ownerDocument||d).$$reactFormReplay,x!=null)for(N=0;N<x.length;N+=3){var P=x[N],F=x[N+1],ie=P[tr]||null;if(typeof F=="function")ie||n7(x);else if(ie){var ge=null;if(F&&F.hasAttribute("formAction")){if(P=F,ie=F[tr]||null)ge=ie.formAction;else if(DS(P)!==null)continue}else ge=ie.action;typeof ge=="function"?x[N+1]=ge:(x.splice(N,3),N-=3),n7(x)}}}function s7(){function d(F){F.canIntercept&&F.info==="react-transition"&&F.intercept({handler:function(){return new Promise(function(ie){return P=ie})},focusReset:"manual",scroll:"manual"})}function f(){P!==null&&(P(),P=null),N||setTimeout(x,20)}function x(){if(!N&&!navigation.transition){var F=navigation.currentEntry;F&&F.url!=null&&navigation.navigate(F.url,{state:F.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var N=!1,P=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",f),navigation.addEventListener("navigateerror",f),setTimeout(x,100),function(){N=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",f),navigation.removeEventListener("navigateerror",f),P!==null&&(P(),P=null)}}}function $S(d){this._internalRoot=d}vw.prototype.render=$S.prototype.render=function(d){var f=this._internalRoot;if(f===null)throw Error(n(409));var x=f.current,N=dc();YM(x,N,d,f,null,null)},vw.prototype.unmount=$S.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var f=d.containerInfo;YM(d.current,2,null,d,null,null),ew(),f[Rr]=null}};function vw(d){this._internalRoot=d}vw.prototype.unstable_scheduleHydration=function(d){if(d){var f=Ee();d={blockedOn:null,target:d,priority:f};for(var x=0;x<Kf.length&&f!==0&&f<Kf[x].priority;x++);Kf.splice(x,0,d),x===0&&t7(d)}};var i7=e.version;if(i7!=="19.2.3")throw Error(n(527,i7,"19.2.3"));J.findDOMNode=function(d){var f=d._reactInternals;if(f===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=u(f),d=d!==null?h(d):null,d=d===null?null:d.stateNode,d};var Xoe={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ww=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ww.isDisabled&&ww.supportsFiber)try{jt=ww.inject(Xoe),qe=ww}catch{}}return py.createRoot=function(d,f){if(!i(d))throw Error(n(299));var x=!1,N="",P=hR,F=fR,ie=pR;return f!=null&&(f.unstable_strictMode===!0&&(x=!0),f.identifierPrefix!==void 0&&(N=f.identifierPrefix),f.onUncaughtError!==void 0&&(P=f.onUncaughtError),f.onCaughtError!==void 0&&(F=f.onCaughtError),f.onRecoverableError!==void 0&&(ie=f.onRecoverableError)),f=GM(d,1,!1,null,null,x,N,null,P,F,ie,s7),d[Rr]=f.current,vS(d),new $S(f)},py.hydrateRoot=function(d,f,x){if(!i(d))throw Error(n(299));var N=!1,P="",F=hR,ie=fR,ge=pR,Le=null;return x!=null&&(x.unstable_strictMode===!0&&(N=!0),x.identifierPrefix!==void 0&&(P=x.identifierPrefix),x.onUncaughtError!==void 0&&(F=x.onUncaughtError),x.onCaughtError!==void 0&&(ie=x.onCaughtError),x.onRecoverableError!==void 0&&(ge=x.onRecoverableError),x.formState!==void 0&&(Le=x.formState)),f=GM(d,1,!0,f,x??null,N,P,Le,F,ie,ge,s7),f.context=KM(null),x=f.current,N=dc(),N=$t(N),P=Dr(N),P.callback=null,nn(x,P,N),x=N,f.current.lanes=x,It(f,x),gd(f),d[Rr]=f.current,vS(d),new vw(f)},py.version="19.2.3",py}var m7;function ale(){if(m7)return zS.exports;m7=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),zS.exports=ile(),zS.exports}var ole=ale();const lle=bl(ole);var g7="popstate";function cle(t={}){function e(n,i){let{pathname:a,search:o,hash:l}=n.location;return E6("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Tv(i)}return dle(e,r,null,t)}function yi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function jc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ule(){return Math.random().toString(36).substring(2,10)}function x7(t,e){return{usr:t.state,key:t.key,idx:e}}function E6(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ob(e):e,state:r,key:e&&e.key||n||ule()}}function Tv({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ob(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function dle(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,l="POP",c=null,u=h();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function h(){return(o.state||{idx:null}).idx}function p(){l="POP";let w=h(),j=w==null?null:w-u;u=w,c&&c({action:l,location:v.location,delta:j})}function m(w,j){l="PUSH";let _=E6(v.location,w,j);u=h()+1;let E=x7(_,u),I=v.createHref(_);try{o.pushState(E,"",I)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(I)}a&&c&&c({action:l,location:v.location,delta:1})}function g(w,j){l="REPLACE";let _=E6(v.location,w,j);u=h();let E=x7(_,u),I=v.createHref(_);o.replaceState(E,"",I),a&&c&&c({action:l,location:v.location,delta:0})}function b(w){return hle(w)}let v={get action(){return l},get location(){return t(i,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(g7,p),c=w,()=>{i.removeEventListener(g7,p),c=null}},createHref(w){return e(i,w)},createURL:b,encodeLocation(w){let j=b(w);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:m,replace:g,go(w){return o.go(w)}};return v}function hle(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),yi(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Tv(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function KW(t,e,r="/"){return fle(t,e,r,!1)}function fle(t,e,r,n){let i=typeof e=="string"?ob(e):e,a=Wh(i.pathname||"/",r);if(a==null)return null;let o=YW(t);ple(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=_le(a);l=jle(o[c],u,n)}return l}function YW(t,e=[],r=[],n="",i=!1){let a=(o,l,c=i,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&c)return;yi(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let p=$h([n,h.relativePath]),m=r.concat(h);o.children&&o.children.length>0&&(yi(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),YW(o.children,e,m,p,c)),!(o.path==null&&!o.index)&&e.push({path:p,score:wle(p,o.index),routesMeta:m})};return t.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))a(o,l);else for(let c of XW(o.path))a(o,l,!0,c)}),e}function XW(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=XW(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function ple(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Nle(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var mle=/^:[\w-]+$/,gle=3,xle=2,ble=1,yle=10,vle=-2,b7=t=>t==="*";function wle(t,e){let r=t.split("/"),n=r.length;return r.some(b7)&&(n+=vle),e&&(n+=xle),r.filter(i=>!b7(i)).reduce((i,a)=>i+(mle.test(a)?gle:a===""?ble:yle),n)}function Nle(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function jle(t,e,r=!1){let{routesMeta:n}=t,i={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=jN({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),m=c.route;if(!p&&u&&r&&!n[n.length-1].route.index&&(p=jN({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:$h([a,p.pathname]),pathnameBase:Ale($h([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=$h([a,p.pathnameBase]))}return o}function jN(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=kle(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,{paramName:h,isOptional:p},m)=>{if(h==="*"){let b=l[m]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const g=l[m];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function kle(t,e=!1,r=!0){jc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function _le(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return jc(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Wh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var QW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sle=t=>QW.test(t);function Cle(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ob(t):t,a;if(r)if(Sle(r))a=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),jc(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?a=y7(r.substring(1),"/"):a=y7(r,e)}else a=e;return{pathname:a,search:Tle(n),hash:Ile(i)}}function y7(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function WS(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ele(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function L8(t){let e=Ele(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function P8(t,e,r,n=!1){let i;typeof t=="string"?i=ob(t):(i={...t},yi(!i.pathname||!i.pathname.includes("?"),WS("?","pathname","search",i)),yi(!i.pathname||!i.pathname.includes("#"),WS("#","pathname","hash",i)),yi(!i.search||!i.search.includes("#"),WS("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=r;else{let p=e.length-1;if(!n&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}l=p>=0?e[p]:"/"}let c=Cle(i,l),u=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}var $h=t=>t.join("/").replace(/\/\/+/g,"/"),Ale=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Tle=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Ile=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,Lle=class{constructor(t,e,r,n=!1){this.status=t,this.statusText=e||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function Ple(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Ole(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var JW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ZW(t,e){let r=t;if(typeof r!="string"||!QW.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,i=!1;if(JW)try{let a=new URL(window.location.href),o=r.startsWith("//")?new URL(a.protocol+r):new URL(r),l=Wh(o.pathname,e);o.origin===a.origin&&l!=null?r=l+o.search+o.hash:i=!0}catch{jc(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:i,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var eG=["POST","PUT","PATCH","DELETE"];new Set(eG);var Rle=["GET",...eG];new Set(Rle);var lb=y.createContext(null);lb.displayName="DataRouter";var b4=y.createContext(null);b4.displayName="DataRouterState";var Mle=y.createContext(!1),tG=y.createContext({isTransitioning:!1});tG.displayName="ViewTransition";var Dle=y.createContext(new Map);Dle.displayName="Fetchers";var Ble=y.createContext(null);Ble.displayName="Await";var Sc=y.createContext(null);Sc.displayName="Navigation";var A1=y.createContext(null);A1.displayName="Location";var Xu=y.createContext({outlet:null,matches:[],isDataRoute:!1});Xu.displayName="Route";var O8=y.createContext(null);O8.displayName="RouteError";var rG="REACT_ROUTER_ERROR",$le="REDIRECT",Fle="ROUTE_ERROR_RESPONSE";function Ule(t){if(t.startsWith(`${rG}:${$le}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function zle(t){if(t.startsWith(`${rG}:${Fle}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Lle(e.status,e.statusText,e.data)}catch{}}function qle(t,{relative:e}={}){yi(cb(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=y.useContext(Sc),{hash:i,pathname:a,search:o}=T1(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:$h([r,a])),n.createHref({pathname:l,search:o,hash:i})}function cb(){return y.useContext(A1)!=null}function Mo(){return yi(cb(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(A1).location}var nG="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sG(t){y.useContext(Sc).static||y.useLayoutEffect(t)}function xn(){let{isDataRoute:t}=y.useContext(Xu);return t?rce():Vle()}function Vle(){yi(cb(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(lb),{basename:e,navigator:r}=y.useContext(Sc),{matches:n}=y.useContext(Xu),{pathname:i}=Mo(),a=JSON.stringify(L8(n)),o=y.useRef(!1);return sG(()=>{o.current=!0}),y.useCallback((c,u={})=>{if(jc(o.current,nG),!o.current)return;if(typeof c=="number"){r.go(c);return}let h=P8(c,JSON.parse(a),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:$h([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,a,i,t])}y.createContext(null);function yl(){let{matches:t}=y.useContext(Xu),e=t[t.length-1];return e?e.params:{}}function T1(t,{relative:e}={}){let{matches:r}=y.useContext(Xu),{pathname:n}=Mo(),i=JSON.stringify(L8(r));return y.useMemo(()=>P8(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function Hle(t,e){return iG(t,e)}function iG(t,e,r,n,i){yi(cb(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=y.useContext(Sc),{matches:o}=y.useContext(Xu),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let _=p&&p.path||"";oG(u,!p||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let m=Mo(),g;if(e){let _=typeof e=="string"?ob(e):e;yi(h==="/"||_.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${_.pathname}" was given in the \`location\` prop.`),g=_}else g=m;let b=g.pathname||"/",v=b;if(h!=="/"){let _=h.replace(/^\//,"").split("/");v="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=KW(t,{pathname:v});jc(p||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),jc(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=Xle(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:$h([h,a.encodeLocation?a.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?h:$h([h,a.encodeLocation?a.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),o,r,n,i);return e&&j?y.createElement(A1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},j):j}function Wle(){let t=tce(),e=Ple(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:a},"ErrorBoundary")," or"," ",y.createElement("code",{style:a},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),r?y.createElement("pre",{style:i},r):null,o)}var Gle=y.createElement(Wle,null),aG=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const r=zle(t.digest);r&&(t=r)}let e=t!==void 0?y.createElement(Xu.Provider,{value:this.props.routeContext},y.createElement(O8.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?y.createElement(Kle,{error:t},e):e}};aG.contextType=Mle;var GS=new WeakMap;function Kle({children:t,error:e}){let{basename:r}=y.useContext(Sc);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=Ule(e.digest);if(n){let i=GS.get(e);if(i)throw i;let a=ZW(n.location,r);if(JW&&!GS.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw GS.set(e,o),o}return y.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function Yle({routeContext:t,match:e,children:r}){let n=y.useContext(lb);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(Xu.Provider,{value:t},r)}function Xle(t,e=[],r=null,n=null,i=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);yi(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,c=-1;if(r)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=h),p.route.id){let{loaderData:m,errors:g}=r,b=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!g||g[p.route.id]===void 0);if(p.route.lazy||b){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let u=r&&n?(h,p)=>{n(h,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:Ole(r.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let g,b=!1,v=null,w=null;r&&(g=o&&p.route.id?o[p.route.id]:void 0,v=p.route.errorElement||Gle,l&&(c<0&&m===0?(oG("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):c===m&&(b=!0,w=p.route.hydrateFallbackElement||null)));let j=e.concat(a.slice(0,m+1)),_=()=>{let E;return g?E=v:b?E=w:p.route.Component?E=y.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=h,y.createElement(Yle,{match:p,routeContext:{outlet:h,matches:j,isDataRoute:r!=null},children:E})};return r&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?y.createElement(aG,{location:r.location,revalidation:r.revalidation,component:v,error:g,children:_(),routeContext:{outlet:null,matches:j,isDataRoute:!0},onError:u}):_()},null)}function R8(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qle(t){let e=y.useContext(lb);return yi(e,R8(t)),e}function Jle(t){let e=y.useContext(b4);return yi(e,R8(t)),e}function Zle(t){let e=y.useContext(Xu);return yi(e,R8(t)),e}function M8(t){let e=Zle(t),r=e.matches[e.matches.length-1];return yi(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function ece(){return M8("useRouteId")}function tce(){let t=y.useContext(O8),e=Jle("useRouteError"),r=M8("useRouteError");return t!==void 0?t:e.errors?.[r]}function rce(){let{router:t}=Qle("useNavigate"),e=M8("useNavigate"),r=y.useRef(!1);return sG(()=>{r.current=!0}),y.useCallback(async(i,a={})=>{jc(r.current,nG),r.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var v7={};function oG(t,e,r){!e&&!v7[t]&&(v7[t]=!0,jc(!1,r))}y.memo(nce);function nce({routes:t,future:e,state:r,onError:n}){return iG(t,void 0,r,n,e)}function sce({to:t,replace:e,state:r,relative:n}){yi(cb(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=y.useContext(Sc);jc(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=y.useContext(Xu),{pathname:o}=Mo(),l=xn(),c=P8(t,L8(a),o,n==="path"),u=JSON.stringify(c);return y.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function wn(t){yi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ice({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){yi(!cb(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=y.useMemo(()=>({basename:l,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[l,i,a,o]);typeof r=="string"&&(r=ob(r));let{pathname:u="/",search:h="",hash:p="",state:m=null,key:g="default"}=r,b=y.useMemo(()=>{let v=Wh(u,l);return v==null?null:{location:{pathname:v,search:h,hash:p,state:m,key:g},navigationType:n}},[l,u,h,p,m,g,n]);return jc(b!=null,`<Router basename="${l}"> is not able to match the URL "${u}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:y.createElement(Sc.Provider,{value:c},y.createElement(A1.Provider,{children:e,value:b}))}function ace({children:t,location:e}){return Hle(A6(t),e)}function A6(t,e=[]){let r=[];return y.Children.forEach(t,(n,i)=>{if(!y.isValidElement(n))return;let a=[...e,i];if(n.type===y.Fragment){r.push.apply(r,A6(n.props.children,a));return}yi(n.type===wn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yi(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=A6(n.props.children,a)),r.push(o)}),r}var R5="get",M5="application/x-www-form-urlencoded";function y4(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function oce(t){return y4(t)&&t.tagName.toLowerCase()==="button"}function lce(t){return y4(t)&&t.tagName.toLowerCase()==="form"}function cce(t){return y4(t)&&t.tagName.toLowerCase()==="input"}function uce(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function dce(t,e){return t.button===0&&(!e||e==="_self")&&!uce(t)}function T6(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function hce(t,e){let r=T6(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(a=>{r.append(i,a)})}),r}var Nw=null;function fce(){if(Nw===null)try{new FormData(document.createElement("form"),0),Nw=!1}catch{Nw=!0}return Nw}var pce=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function KS(t){return t!=null&&!pce.has(t)?(jc(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${M5}"`),null):t}function mce(t,e){let r,n,i,a,o;if(lce(t)){let l=t.getAttribute("action");n=l?Wh(l,e):null,r=t.getAttribute("method")||R5,i=KS(t.getAttribute("enctype"))||M5,a=new FormData(t)}else if(oce(t)||cce(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?Wh(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||R5,i=KS(t.getAttribute("formenctype"))||KS(l.getAttribute("enctype"))||M5,a=new FormData(l,t),!fce()){let{name:u,type:h,value:p}=t;if(h==="image"){let m=u?`${u}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else u&&a.append(u,p)}}else{if(y4(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=R5,n=null,i=M5,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function D8(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gce(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Wh(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function xce(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function bce(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function yce(t,e,r){let n=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await xce(a,r);return o.links?o.links():[]}return[]}));return jce(n.flat(1).filter(bce).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function w7(t,e,r,n,i,a){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>r[u].pathname!==c.pathname||r[u].route.path?.endsWith("*")&&r[u].params["*"]!==c.params["*"];return a==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?e.filter((c,u)=>{let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function vce(t,e,{includeHydrateFallback:r}={}){return wce(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function wce(t){return[...new Set(t)]}function Nce(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function jce(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let a=JSON.stringify(Nce(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}function lG(){let t=y.useContext(lb);return D8(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function kce(){let t=y.useContext(b4);return D8(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var B8=y.createContext(void 0);B8.displayName="FrameworkContext";function cG(){let t=y.useContext(B8);return D8(t,"You must render this element inside a <HydratedRouter> element"),t}function _ce(t,e){let r=y.useContext(B8),[n,i]=y.useState(!1),[a,o]=y.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:p}=e,m=y.useRef(null);y.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let v=j=>{j.forEach(_=>{o(_.isIntersecting)})},w=new IntersectionObserver(v,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[t]),y.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let g=()=>{i(!0)},b=()=>{i(!1),o(!1)};return r?t!=="intent"?[a,m,{}]:[a,m,{onFocus:my(l,g),onBlur:my(c,b),onMouseEnter:my(u,g),onMouseLeave:my(h,b),onTouchStart:my(p,g)}]:[!1,m,{}]}function my(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function Sce({page:t,...e}){let{router:r}=lG(),n=y.useMemo(()=>KW(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?y.createElement(Ece,{page:t,matches:n,...e}):null}function Cce(t){let{manifest:e,routeModules:r}=cG(),[n,i]=y.useState([]);return y.useEffect(()=>{let a=!1;return yce(t,e,r).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,r]),n}function Ece({page:t,matches:e,...r}){let n=Mo(),{manifest:i,routeModules:a}=cG(),{basename:o}=lG(),{loaderData:l,matches:c}=kce(),u=y.useMemo(()=>w7(t,e,c,i,n,"data"),[t,e,c,i,n]),h=y.useMemo(()=>w7(t,e,c,i,n,"assets"),[t,e,c,i,n]),p=y.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let b=new Set,v=!1;if(e.forEach(j=>{let _=i.routes[j.route.id];!_||!_.hasLoader||(!u.some(E=>E.route.id===j.route.id)&&j.route.id in l&&a[j.route.id]?.shouldRevalidate||_.hasClientLoader?v=!0:b.add(j.route.id))}),b.size===0)return[];let w=gce(t,o,"data");return v&&b.size>0&&w.searchParams.set("_routes",e.filter(j=>b.has(j.route.id)).map(j=>j.route.id).join(",")),[w.pathname+w.search]},[o,l,n,i,u,e,t,a]),m=y.useMemo(()=>vce(h,i),[h,i]),g=Cce(h);return y.createElement(y.Fragment,null,p.map(b=>y.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),m.map(b=>y.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),g.map(({key:b,link:v})=>y.createElement("link",{key:b,nonce:r.nonce,...v})))}function Ace(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var Tce=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Tce&&(window.__reactRouterVersion="7.11.0")}catch{}function Ice({basename:t,children:e,unstable_useTransitions:r,window:n}){let i=y.useRef();i.current==null&&(i.current=cle({window:n,v5Compat:!0}));let a=i.current,[o,l]=y.useState({action:a.action,location:a.location}),c=y.useCallback(u=>{r===!1?l(u):y.startTransition(()=>l(u))},[r]);return y.useLayoutEffect(()=>a.listen(c),[a,c]),y.createElement(ice,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:r})}var uG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Er=y.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...g},b){let{basename:v,unstable_useTransitions:w}=y.useContext(Sc),j=typeof u=="string"&&uG.test(u),_=ZW(u,v);u=_.to;let E=qle(u,{relative:i}),[I,O,B]=_ce(n,g),S=Rce(u,{replace:o,state:l,target:c,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:w});function T($){e&&e($),$.defaultPrevented||S($)}let M=y.createElement("a",{...g,...B,href:_.absoluteURL||E,onClick:_.isExternal||a?e:T,ref:Ace(b,O),target:c,"data-discover":!j&&r==="render"?"true":void 0});return I&&!j?y.createElement(y.Fragment,null,M,y.createElement(Sce,{page:E})):M});Er.displayName="Link";var Lce=y.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:o,viewTransition:l,children:c,...u},h){let p=T1(o,{relative:u.relative}),m=Mo(),g=y.useContext(b4),{navigator:b,basename:v}=y.useContext(Sc),w=g!=null&&Fce(p)&&l===!0,j=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,_=m.pathname,E=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(_=_.toLowerCase(),E=E?E.toLowerCase():null,j=j.toLowerCase()),E&&v&&(E=Wh(E,v)||E);const I=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let O=_===j||!i&&_.startsWith(j)&&_.charAt(I)==="/",B=E!=null&&(E===j||!i&&E.startsWith(j)&&E.charAt(j.length)==="/"),S={isActive:O,isPending:B,isTransitioning:w},T=O?e:void 0,M;typeof n=="function"?M=n(S):M=[n,O?"active":null,B?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let $=typeof a=="function"?a(S):a;return y.createElement(Er,{...u,"aria-current":T,className:M,ref:h,style:$,to:o,viewTransition:l},typeof c=="function"?c(S):c)});Lce.displayName="NavLink";var Pce=y.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:a,method:o=R5,action:l,onSubmit:c,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...g},b)=>{let{unstable_useTransitions:v}=y.useContext(Sc),w=Bce(),j=$ce(l,{relative:u}),_=o.toLowerCase()==="get"?"get":"post",E=typeof l=="string"&&uG.test(l),I=O=>{if(c&&c(O),O.defaultPrevented)return;O.preventDefault();let B=O.nativeEvent.submitter,S=B?.getAttribute("formmethod")||o,T=()=>w(B||O.currentTarget,{fetcherKey:e,method:S,navigate:r,replace:i,state:a,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});v&&r!==!1?y.startTransition(()=>T()):T()};return y.createElement("form",{ref:b,method:_,action:j,onSubmit:n?c:I,...g,"data-discover":!E&&t==="render"?"true":void 0})});Pce.displayName="Form";function Oce(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dG(t){let e=y.useContext(lb);return yi(e,Oce(t)),e}function Rce(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=xn(),h=Mo(),p=T1(t,{relative:a});return y.useCallback(m=>{if(dce(m,e)){m.preventDefault();let g=r!==void 0?r:Tv(h)===Tv(p),b=()=>u(t,{replace:g,state:n,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l});c?y.startTransition(()=>b()):b()}},[h,u,p,r,n,e,t,i,a,o,l,c])}function v4(t){jc(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=y.useRef(T6(t)),r=y.useRef(!1),n=Mo(),i=y.useMemo(()=>hce(n.search,r.current?null:e.current),[n.search]),a=xn(),o=y.useCallback((l,c)=>{const u=T6(typeof l=="function"?l(new URLSearchParams(i)):l);r.current=!0,a("?"+u,c)},[a,i]);return[i,o]}var Mce=0,Dce=()=>`__${String(++Mce)}__`;function Bce(){let{router:t}=dG("useSubmit"),{basename:e}=y.useContext(Sc),r=ece(),n=t.fetch,i=t.navigate;return y.useCallback(async(a,o={})=>{let{action:l,method:c,encType:u,formData:h,body:p}=mce(a,e);if(o.navigate===!1){let m=o.fetcherKey||Dce();await n(m,r,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await i(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,i,e,r])}function $ce(t,{relative:e}={}){let{basename:r}=y.useContext(Sc),n=y.useContext(Xu);yi(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...T1(t||".",{relative:e})},o=Mo();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(h=>h==="")){l.delete("index"),c.filter(p=>p).forEach(p=>l.append("index",p));let h=l.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:$h([r,a.pathname])),Tv(a)}function Fce(t,{relative:e}={}){let r=y.useContext(tG);yi(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=dG("useViewTransitionState"),i=T1(t,{relative:e});if(!r.isTransitioning)return!1;let a=Wh(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Wh(r.nextLocation.pathname,n)||r.nextLocation.pathname;return jN(i.pathname,o)!=null||jN(i.pathname,a)!=null}var Vn=GW();const w4=bl(Vn);function Uce(){const{pathname:t}=Mo();return y.useEffect(()=>{window.scrollTo(0,0)},[t]),null}class zce{constructor(){this.timeline=[],this.pointer=-1,this.limit=50,this.listeners=new Set}init(e){this.timeline=[{state:this._clone(e),action:"Initial State",timestamp:Date.now()}],this.pointer=0,this._notify()}push(e,r,n=null,i=null){this.pointer<this.timeline.length-1&&(this.timeline=this.timeline.slice(0,this.pointer+1)),this.timeline.push({state:this._clone(r),action:e,timestamp:Date.now(),undoFn:n,redoFn:i}),this.timeline.length>this.limit?this.timeline.shift():this.pointer++,this._notify()}async undo(){if(!this.canUndo())return null;const e=this.timeline[this.pointer];if(e.undoFn)try{await e.undoFn()}catch(n){console.error("Undo callback failed",n)}this.pointer--;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}async redo(){if(!this.canRedo())return null;this.pointer++;const e=this.timeline[this.pointer];if(e.redoFn)try{await e.redoFn()}catch(r){console.error("Redo callback failed",r)}return this._notify(),this._clone(e.state)}canUndo(){return this.pointer>0}canRedo(){return this.pointer<this.timeline.length-1}getLog(){return[...this.timeline].reverse()}getCurrentAction(){return this.timeline[this.pointer]?.action||"Unknown"}_clone(e){try{return JSON.parse(JSON.stringify(e))}catch(r){return console.error("[HistoryService] Clone failed",r),e}}async jumpTo(e){if(e<0||e>=this.timeline.length)return null;if(e<this.pointer)for(let n=this.pointer;n>e;n--){const i=this.timeline[n];if(i.undoFn)try{await i.undoFn()}catch(a){console.error(`Undo failed at step ${n}`,a)}}else if(e>this.pointer)for(let n=this.pointer+1;n<=e;n++){const i=this.timeline[n];if(i.redoFn)try{await i.redoFn()}catch(a){console.error(`Redo failed at step ${n}`,a)}}this.pointer=e;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}_notify(){this.listeners.forEach(e=>e({canUndo:this.canUndo(),canRedo:this.canRedo(),history:this.getLog(),pointer:this.pointer,activeState:this.timeline[this.pointer]?.state}))}}const Ap=new zce,N7=({isOpen:t,onClose:e})=>{const[r,n]=y.useState({history:[],pointer:-1});if(y.useEffect(()=>t?(n({history:Ap.getLog(),pointer:Ap.pointer}),Ap.subscribe(c=>{n({history:c.history,pointer:c.pointer})})):void 0,[t]),!t)return null;const{history:i,pointer:a}=r,o=async l=>{const c=i.length-1-l;c!==a&&window.confirm(`Revert to state after "${i[l].action}"?`)&&(await Ap.jumpTo(c),e())};return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative flex flex-col max-h-[80vh]",children:[s.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-black/20 rounded-t-2xl",children:[s.jsxs("h2",{className:"text-lg font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-cyan-400",children:"Time Machine"}),s.jsx("span",{className:"text-[10px] bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-white/10",children:"Session History"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"overflow-y-auto p-4 custom-scrollbar space-y-2 flex-grow",children:i.length===0?s.jsx("div",{className:"text-center text-gray-500 py-10",children:"No actions recorded this session."}):i.map((l,c)=>{const u=i.length-1-c,h=u<a,p=u===a,m=u>a;return s.jsxs("div",{onClick:()=>o(c),className:`
                                        relative pl-4 pr-3 py-3 rounded-xl border transition-all cursor-pointer group flex items-start gap-3
                                        ${p?"bg-cyan-900/20 border-cyan-500/50 ring-1 ring-cyan-500/20":""}
                                        ${h?"bg-gray-800/50 border-white/5 opacity-70 hover:opacity-100 hover:bg-gray-800":""}
                                        ${m?"bg-gray-900/30 border-white/5 opacity-40 hover:opacity-100 grayscale hover:grayscale-0":""}
                                    `,children:[c!==i.length-1&&s.jsx("div",{className:"absolute left-[27px] top-10 bottom-[-10px] w-px bg-white/10 group-hover:bg-white/20"}),s.jsx("div",{className:`
                                        w-6 h-6 rounded-full flex items-center justify-center shrink-0 z-10 transition-colors
                                        ${p?"bg-cyan-500 text-black shadow-[0_0_10px_rgba(6,182,212,0.5)]":"bg-gray-800 border border-white/10 text-gray-500 group-hover:border-cyan-500/50 group-hover:text-cyan-400"}
                                    `,children:p?s.jsx("div",{className:"w-2 h-2 bg-black rounded-full animate-pulse"}):c===0?s.jsx("span",{className:"text-[10px] font-bold",children:"Latest"}):s.jsx("span",{className:"text-[9px]",children:c})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:`text-sm font-bold ${p?"text-cyan-400":"text-gray-300 group-hover:text-white"}`,children:l.action}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-mono text-gray-500",children:new Date(l.timestamp).toLocaleTimeString()}),p&&s.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-cyan-600 bg-cyan-900/30 px-1.5 py-0.5 rounded",children:"Active State"})]})]}),!p&&s.jsx("div",{className:"self-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("div",{className:"px-2 py-1 bg-white/10 rounded text-[9px] font-bold uppercase tracking-wider text-white",children:"Restore"})})]},l.timestamp)})})]})})},qce=()=>{};var j7={};const hG=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Vce=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],l=t[r++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},fG={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=a>>2,p=(a&3)<<4|l>>4;let m=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(m=64)),n.push(r[h],r[p],r[m],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(hG(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Vce(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||l==null||u==null||p==null)throw new Hce;const m=a<<2|l>>4;if(n.push(m),u!==64){const g=l<<4&240|u>>2;if(n.push(g),p!==64){const b=u<<6&192|p;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Hce extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Wce=function(t){const e=hG(t);return fG.encodeByteArray(e,!0)},kN=function(t){return Wce(t).replace(/\./g,"")},pG=function(t){try{return fG.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function mG(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Gce=()=>mG().__FIREBASE_DEFAULTS__,Kce=()=>{if(typeof process>"u"||typeof j7>"u")return;const t=j7.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Yce=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pG(t[1]);return e&&JSON.parse(e)},N4=()=>{try{return qce()||Gce()||Kce()||Yce()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gG=t=>N4()?.emulatorHosts?.[t],xG=t=>{const e=gG(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},bG=()=>N4()?.config,yG=t=>N4()?.[`_${t}`];class Xce{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Am(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $8(t){return(await fetch(t,{credentials:"include"})).ok}function vG(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kN(JSON.stringify(r)),kN(JSON.stringify(o)),""].join(".")}const iv={};function Qce(){const t={prod:[],emulator:[]};for(const e of Object.keys(iv))iv[e]?t.emulator.push(e):t.prod.push(e);return t}function Jce(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let k7=!1;function F8(t,e){if(typeof window>"u"||typeof document>"u"||!Am(window.location.host)||iv[t]===e||iv[t]||k7)return;iv[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=Qce().prod.length>0;function o(){const m=document.getElementById(n);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,g){m.setAttribute("width","24"),m.setAttribute("id",g),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{k7=!0,o()},m}function h(m,g){m.setAttribute("id",g),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=Jce(n),g=r("text"),b=document.getElementById(g)||document.createElement("span"),v=r("learnmore"),w=document.getElementById(v)||document.createElement("a"),j=r("preprendIcon"),_=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;l(E),h(w,v);const I=u();c(_,j),E.append(_,b,w,I),document.body.appendChild(E)}a?(b.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function $a(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zce(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($a())}function wG(){const t=N4()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eue(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tue(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function rue(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nue(){const t=$a();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function NG(){return!wG()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jG(){return!wG()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function kG(){try{return typeof indexedDB=="object"}catch{return!1}}function sue(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}const iue="FirebaseError";class Gd extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=iue,Object.setPrototypeOf(this,Gd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I1.prototype.create)}}class I1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?aue(a,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Gd(i,l,n)}}function aue(t,e){return t.replace(oue,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const oue=/\{\$([^}]+)}/g;function lue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xp(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(_7(a)&&_7(o)){if(!Xp(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function _7(t){return t!==null&&typeof t=="object"}function L1(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Hy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Wy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function cue(t,e){const r=new uue(t,e);return r.subscribe.bind(r)}class uue{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");due(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=YS),i.error===void 0&&(i.error=YS),i.complete===void 0&&(i.complete=YS);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function due(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function YS(){}function Qu(t){return t&&t._delegate?t._delegate:t}class T0{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const pp="[DEFAULT]";let hue=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Xce;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pue(e))try{this.getOrInitializeService({instanceIdentifier:pp})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=pp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=pp){return this.instances.has(e)}getOptions(e=pp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:fue(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=pp){return this.component?this.component.multipleInstances?e:pp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function fue(t){return t===pp?void 0:t}function pue(t){return t.instantiationMode==="EAGER"}class mue{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new hue(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Sn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Sn||(Sn={}));const gue={debug:Sn.DEBUG,verbose:Sn.VERBOSE,info:Sn.INFO,warn:Sn.WARN,error:Sn.ERROR,silent:Sn.SILENT},xue=Sn.INFO,bue={[Sn.DEBUG]:"log",[Sn.VERBOSE]:"log",[Sn.INFO]:"info",[Sn.WARN]:"warn",[Sn.ERROR]:"error"},yue=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=bue[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class U8{constructor(e){this.name=e,this._logLevel=xue,this._logHandler=yue,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Sn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gue[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Sn.DEBUG,...e),this._logHandler(this,Sn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Sn.VERBOSE,...e),this._logHandler(this,Sn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Sn.INFO,...e),this._logHandler(this,Sn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Sn.WARN,...e),this._logHandler(this,Sn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Sn.ERROR,...e),this._logHandler(this,Sn.ERROR,...e)}}const vue=(t,e)=>e.some(r=>t instanceof r);let S7,C7;function wue(){return S7||(S7=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Nue(){return C7||(C7=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _G=new WeakMap,I6=new WeakMap,SG=new WeakMap,XS=new WeakMap,z8=new WeakMap;function jue(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(w0(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&_G.set(r,t)}).catch(()=>{}),z8.set(e,t),e}function kue(t){if(I6.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});I6.set(t,e)}let L6={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return I6.get(t);if(e==="objectStoreNames")return t.objectStoreNames||SG.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return w0(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _ue(t){L6=t(L6)}function Sue(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(QS(this),e,...r);return SG.set(n,e.sort?e.sort():[e]),w0(n)}:Nue().includes(t)?function(...e){return t.apply(QS(this),e),w0(_G.get(this))}:function(...e){return w0(t.apply(QS(this),e))}}function Cue(t){return typeof t=="function"?Sue(t):(t instanceof IDBTransaction&&kue(t),vue(t,wue())?new Proxy(t,L6):t)}function w0(t){if(t instanceof IDBRequest)return jue(t);if(XS.has(t))return XS.get(t);const e=Cue(t);return e!==t&&(XS.set(t,e),z8.set(e,t)),e}const QS=t=>z8.get(t);function Eue(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),l=w0(o);return n&&o.addEventListener("upgradeneeded",c=>{n(w0(o.result),c.oldVersion,c.newVersion,w0(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Aue=["get","getKey","getAll","getAllKeys","count"],Tue=["put","add","delete","clear"],JS=new Map;function E7(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(JS.get(e))return JS.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Tue.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Aue.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),i&&c.done]))[0]};return JS.set(e,a),a}_ue(t=>({...t,get:(e,r,n)=>E7(e,r)||t.get(e,r,n),has:(e,r)=>!!E7(e,r)||t.has(e,r)}));class Iue{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Lue(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Lue(t){return t.getComponent()?.type==="VERSION"}const P6="@firebase/app",A7="0.14.6";const Gh=new U8("@firebase/app"),Pue="@firebase/app-compat",Oue="@firebase/analytics-compat",Rue="@firebase/analytics",Mue="@firebase/app-check-compat",Due="@firebase/app-check",Bue="@firebase/auth",$ue="@firebase/auth-compat",Fue="@firebase/database",Uue="@firebase/data-connect",zue="@firebase/database-compat",que="@firebase/functions",Vue="@firebase/functions-compat",Hue="@firebase/installations",Wue="@firebase/installations-compat",Gue="@firebase/messaging",Kue="@firebase/messaging-compat",Yue="@firebase/performance",Xue="@firebase/performance-compat",Que="@firebase/remote-config",Jue="@firebase/remote-config-compat",Zue="@firebase/storage",ede="@firebase/storage-compat",tde="@firebase/firestore",rde="@firebase/ai",nde="@firebase/firestore-compat",sde="firebase",ide="12.6.0";const O6="[DEFAULT]",ade={[P6]:"fire-core",[Pue]:"fire-core-compat",[Rue]:"fire-analytics",[Oue]:"fire-analytics-compat",[Due]:"fire-app-check",[Mue]:"fire-app-check-compat",[Bue]:"fire-auth",[$ue]:"fire-auth-compat",[Fue]:"fire-rtdb",[Uue]:"fire-data-connect",[zue]:"fire-rtdb-compat",[que]:"fire-fn",[Vue]:"fire-fn-compat",[Hue]:"fire-iid",[Wue]:"fire-iid-compat",[Gue]:"fire-fcm",[Kue]:"fire-fcm-compat",[Yue]:"fire-perf",[Xue]:"fire-perf-compat",[Que]:"fire-rc",[Jue]:"fire-rc-compat",[Zue]:"fire-gcs",[ede]:"fire-gcs-compat",[tde]:"fire-fst",[nde]:"fire-fst-compat",[rde]:"fire-vertex","fire-js":"fire-js",[sde]:"fire-js-all"};const _N=new Map,ode=new Map,R6=new Map;function T7(t,e){try{t.container.addComponent(e)}catch(r){Gh.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Qp(t){const e=t.name;if(R6.has(e))return Gh.debug(`There were multiple attempts to register component ${e}.`),!1;R6.set(e,t);for(const r of _N.values())T7(r,t);for(const r of ode.values())T7(r,t);return!0}function j4(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Gl(t){return t==null?!1:t.settings!==void 0}const lde={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},N0=new I1("app","Firebase",lde);class cde{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new T0("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw N0.create("app-deleted",{appName:this._name})}}const Tm=ide;function CG(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:O6,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw N0.create("bad-app-name",{appName:String(i)});if(r||(r=bG()),!r)throw N0.create("no-options");const a=_N.get(i);if(a){if(Xp(r,a.options)&&Xp(n,a.config))return a;throw N0.create("duplicate-app",{appName:i})}const o=new mue(i);for(const c of R6.values())o.addComponent(c);const l=new cde(r,n,o);return _N.set(i,l),l}function q8(t=O6){const e=_N.get(t);if(!e&&t===O6&&bG())return CG();if(!e)throw N0.create("no-app",{appName:t});return e}function Id(t,e,r){let n=ade[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${n}" with version "${e}":`];i&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gh.warn(o.join(" "));return}Qp(new T0(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const ude="firebase-heartbeat-database",dde=1,Iv="firebase-heartbeat-store";let ZS=null;function EG(){return ZS||(ZS=Eue(ude,dde,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Iv)}catch(r){console.warn(r)}}}}).catch(t=>{throw N0.create("idb-open",{originalErrorMessage:t.message})})),ZS}async function hde(t){try{const r=(await EG()).transaction(Iv),n=await r.objectStore(Iv).get(AG(t));return await r.done,n}catch(e){if(e instanceof Gd)Gh.warn(e.message);else{const r=N0.create("idb-get",{originalErrorMessage:e?.message});Gh.warn(r.message)}}}async function I7(t,e){try{const n=(await EG()).transaction(Iv,"readwrite");await n.objectStore(Iv).put(e,AG(t)),await n.done}catch(r){if(r instanceof Gd)Gh.warn(r.message);else{const n=N0.create("idb-set",{originalErrorMessage:r?.message});Gh.warn(n.message)}}}function AG(t){return`${t.name}!${t.options.appId}`}const fde=1024,pde=30;class mde{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new xde(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=L7();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>pde){const i=bde(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gh.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=L7(),{heartbeatsToSend:r,unsentEntries:n}=gde(this._heartbeatsCache.heartbeats),i=kN(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Gh.warn(e),""}}}function L7(){return new Date().toISOString().substring(0,10)}function gde(t,e=fde){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),P7(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),P7(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class xde{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kG()?sue().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await hde(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return I7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return I7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function P7(t){return kN(JSON.stringify({version:2,heartbeats:t})).length}function bde(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function yde(t){Qp(new T0("platform-logger",e=>new Iue(e),"PRIVATE")),Qp(new T0("heartbeat",e=>new mde(e),"PRIVATE")),Id(P6,A7,t),Id(P6,A7,"esm2020"),Id("fire-js","")}yde("");function TG(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const vde=TG,IG=new I1("auth","Firebase",TG());const SN=new U8("@firebase/auth");function wde(t,...e){SN.logLevel<=Sn.WARN&&SN.warn(`Auth (${Tm}): ${t}`,...e)}function D5(t,...e){SN.logLevel<=Sn.ERROR&&SN.error(`Auth (${Tm}): ${t}`,...e)}function ru(t,...e){throw H8(t,...e)}function Bu(t,...e){return H8(t,...e)}function V8(t,e,r){const n={...vde(),[e]:r};return new I1("auth","Firebase",n).create(e,{appName:t.name})}function Fh(t){return V8(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Nde(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ru(t,"argument-error"),V8(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function H8(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return IG.create(t,...e)}function zr(t,e,...r){if(!t)throw H8(e,...r)}function Lh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw D5(e),new Error(e)}function Kh(t,e){t||Lh(e)}function M6(){return typeof self<"u"&&self.location?.href||""}function jde(){return O7()==="http:"||O7()==="https:"}function O7(){return typeof self<"u"&&self.location?.protocol||null}function kde(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jde()||tue()||"connection"in navigator)?navigator.onLine:!0}function _de(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class P1{constructor(e,r){this.shortDelay=e,this.longDelay=r,Kh(r>e,"Short delay should be less than long delay!"),this.isMobile=Zce()||rue()}get(){return kde()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function W8(t,e){Kh(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class LG{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Sde={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Cde=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ede=new P1(3e4,6e4);function lf(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function cf(t,e,r,n,i={}){return PG(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=L1({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...a};return eue()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Am(t.emulatorConfig.host)&&(u.credentials="include"),LG.fetch()(await OG(t,t.config.apiHost,r,l),u)})}async function PG(t,e,r){t._canInitEmulator=!1;const n={...Sde,...e};try{const i=new Tde(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw jw(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw jw(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw jw(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw jw(t,"user-disabled",o);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw V8(t,h,u);ru(t,h)}}catch(i){if(i instanceof Gd)throw i;ru(t,"network-request-failed",{message:String(i)})}}async function O1(t,e,r,n,i={}){const a=await cf(t,e,r,n,i);return"mfaPendingCredential"in a&&ru(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function OG(t,e,r,n){const i=`${e}${r}?${n}`,a=t,o=a.config.emulator?W8(t.config,i):`${t.config.apiScheme}://${i}`;return Cde.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function Ade(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Tde{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Bu(this.auth,"network-request-failed")),Ede.get())})}}function jw(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Bu(t,e,n);return i.customData._tokenResponse=r,i}function R7(t){return t!==void 0&&t.enterprise!==void 0}class Ide{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Ade(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Lde(t,e){return cf(t,"GET","/v2/recaptchaConfig",lf(t,e))}async function Pde(t,e){return cf(t,"POST","/v1/accounts:delete",e)}async function CN(t,e){return cf(t,"POST","/v1/accounts:lookup",e)}function av(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ode(t,e=!1){const r=Qu(t),n=await r.getIdToken(e),i=G8(n);zr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:n,authTime:av(e3(i.auth_time)),issuedAtTime:av(e3(i.iat)),expirationTime:av(e3(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function e3(t){return Number(t)*1e3}function G8(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return D5("JWT malformed, contained fewer than 3 sections"),null;try{const i=pG(r);return i?JSON.parse(i):(D5("Failed to decode base64 JWT payload"),null)}catch(i){return D5("Caught error parsing JWT payload as JSON",i?.toString()),null}}function M7(t){const e=G8(t);return zr(e,"internal-error"),zr(typeof e.exp<"u","internal-error"),zr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Lv(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Gd&&Rde(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Rde({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Mde{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class D6{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=av(this.lastLoginAt),this.creationTime=av(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function EN(t){const e=t.auth,r=await t.getIdToken(),n=await Lv(t,CN(e,{idToken:r}));zr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?RG(i.providerUserInfo):[],o=Bde(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!o?.length,u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new D6(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Dde(t){const e=Qu(t);await EN(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Bde(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function RG(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function $de(t,e){const r=await PG(t,{},async()=>{const n=L1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await OG(t,i,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Am(t.emulatorConfig.host)&&(c.credentials="include"),LG.fetch()(o,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Fde(t,e){return cf(t,"POST","/v2/accounts:revokeToken",lf(t,e))}class dx{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zr(e.idToken,"internal-error"),zr(typeof e.idToken<"u","internal-error"),zr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):M7(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){zr(e.length!==0,"internal-error");const r=M7(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(zr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await $de(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new dx;return n&&(zr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(zr(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(zr(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dx,this.toJSON())}_performRefresh(){return Lh("not implemented")}}function Xf(t,e){zr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ou{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Mde(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new D6(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Lv(this,this.stsTokenManager.getToken(this.auth,e));return zr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Ode(this,e)}reload(){return Dde(this)}_assign(e){this!==e&&(zr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ou({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){zr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await EN(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gl(this.auth.app))return Promise.reject(Fh(this.auth));const e=await this.getIdToken();return await Lv(this,Pde(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,o=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:g,providerData:b,stsTokenManager:v}=r;zr(p&&v,e,"internal-error");const w=dx.fromJSON(this.name,v);zr(typeof p=="string",e,"internal-error"),Xf(n,e.name),Xf(i,e.name),zr(typeof m=="boolean",e,"internal-error"),zr(typeof g=="boolean",e,"internal-error"),Xf(a,e.name),Xf(o,e.name),Xf(l,e.name),Xf(c,e.name),Xf(u,e.name),Xf(h,e.name);const j=new Ou({uid:p,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:g,photoURL:o,phoneNumber:a,tenantId:l,stsTokenManager:w,createdAt:u,lastLoginAt:h});return b&&Array.isArray(b)&&(j.providerData=b.map(_=>({..._}))),c&&(j._redirectEventId=c),j}static async _fromIdTokenResponse(e,r,n=!1){const i=new dx;i.updateFromServerResponse(r);const a=new Ou({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await EN(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];zr(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?RG(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,l=new dx;l.updateFromIdToken(n);const c=new Ou({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new D6(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,u),c}}const D7=new Map;function Ph(t){Kh(t instanceof Function,"Expected a class definition");let e=D7.get(t);return e?(Kh(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,D7.set(t,e),e)}class MG{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}MG.type="NONE";const B7=MG;function B5(t,e,r){return`firebase:${t}:${e}:${r}`}class hx{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=B5(this.userKey,i.apiKey,a),this.fullPersistenceKey=B5("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await CN(this.auth,{idToken:e}).catch(()=>{});return r?Ou._fromGetAccountInfoResponse(this.auth,r,e):null}return Ou._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new hx(Ph(B7),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=i[0]||Ph(B7);const o=B5(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const h=await u._get(o);if(h){let p;if(typeof h=="string"){const m=await CN(e,{idToken:h}).catch(()=>{});if(!m)break;p=await Ou._fromGetAccountInfoResponse(e,m,h)}else p=Ou._fromJSON(e,h);u!==a&&(l=p),a=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new hx(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(o)}catch{}})),new hx(a,e,n))}}function $7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FG(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DG(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zG(e))return"Blackberry";if(qG(e))return"Webos";if(BG(e))return"Safari";if((e.includes("chrome/")||$G(e))&&!e.includes("edge/"))return"Chrome";if(UG(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function DG(t=$a()){return/firefox\//i.test(t)}function BG(t=$a()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $G(t=$a()){return/crios\//i.test(t)}function FG(t=$a()){return/iemobile/i.test(t)}function UG(t=$a()){return/android/i.test(t)}function zG(t=$a()){return/blackberry/i.test(t)}function qG(t=$a()){return/webos/i.test(t)}function K8(t=$a()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ude(t=$a()){return K8(t)&&!!window.navigator?.standalone}function zde(){return nue()&&document.documentMode===10}function VG(t=$a()){return K8(t)||UG(t)||qG(t)||zG(t)||/windows phone/i.test(t)||FG(t)}function HG(t,e=[]){let r;switch(t){case"Browser":r=$7($a());break;case"Worker":r=`${$7($a())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Tm}/${n}`}class qde{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function Vde(t,e={}){return cf(t,"GET","/v2/passwordPolicy",lf(t,e))}const Hde=6;class Wde{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Hde,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Gde{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new F7(this),this.idTokenSubscription=new F7(this),this.beforeStateQueue=new qde(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=IG,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ph(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await hx.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await CN(this,{idToken:e}),n=await Ou._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Gl(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return zr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await EN(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_de()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gl(this.app))return Promise.reject(Fh(this));const r=e?Qu(e):null;return r&&zr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&zr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gl(this.app)?Promise.reject(Fh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gl(this.app)?Promise.reject(Fh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ph(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Vde(this),r=new Wde(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new I1("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Fde(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ph(e)||this._popupRedirectResolver;zr(r,this,"argument-error"),this.redirectPersistenceManager=await hx.create(this,[Ph(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(zr(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HG(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Gl(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&wde(`Error while retrieving App Check token: ${e.error}`),e?.token}}function uf(t){return Qu(t)}class F7{constructor(e){this.auth=e,this.observer=null,this.addObserver=cue(r=>this.observer=r)}get next(){return zr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let k4={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Kde(t){k4=t}function WG(t){return k4.loadJS(t)}function Yde(){return k4.recaptchaEnterpriseScript}function Xde(){return k4.gapiScript}function Qde(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Jde{constructor(){this.enterprise=new Zde}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class Zde{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const ehe="recaptcha-enterprise",GG="NO_RECAPTCHA";class the{constructor(e){this.type=ehe,this.auth=uf(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{Lde(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Ide(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(a,o,l){const c=window.grecaptcha;R7(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{o(u)}).catch(()=>{o(GG)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Jde().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&R7(window.grecaptcha))i(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Yde();c.length!==0&&(c+=l),WG(c).then(()=>{i(l,a,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function U7(t,e,r,n=!1,i=!1){const a=new the(t);let o;if(i)o=GG;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const l={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function AN(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await U7(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await U7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}function rhe(t,e){const r=j4(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Xp(a,e??{}))return i;ru(i,"already-initialized")}return r.initialize({options:e})}function nhe(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ph);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function she(t,e,r){const n=uf(t);zr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=KG(e),{host:o,port:l}=ihe(e),c=l===null?"":`:${l}`,u={url:`${a}//${o}${c}/`},h=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){zr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),zr(Xp(u,n.config.emulator)&&Xp(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,Am(o)?($8(`${a}//${o}${c}`),F8("Auth",!0)):ahe()}function KG(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ihe(t){const e=KG(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:z7(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:z7(o)}}}function z7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ahe(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Y8{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Lh("not implemented")}_getIdTokenResponse(e){return Lh("not implemented")}_linkToIdToken(e,r){return Lh("not implemented")}_getReauthenticationResolver(e){return Lh("not implemented")}}async function ohe(t,e){return cf(t,"POST","/v1/accounts:signUp",e)}async function lhe(t,e){return O1(t,"POST","/v1/accounts:signInWithPassword",lf(t,e))}async function YG(t,e){return cf(t,"POST","/v1/accounts:sendOobCode",lf(t,e))}async function che(t,e){return YG(t,e)}async function uhe(t,e){return YG(t,e)}async function dhe(t,e){return O1(t,"POST","/v1/accounts:signInWithEmailLink",lf(t,e))}async function hhe(t,e){return O1(t,"POST","/v1/accounts:signInWithEmailLink",lf(t,e))}class Pv extends Y8{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Pv(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Pv(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return AN(e,r,"signInWithPassword",lhe);case"emailLink":return dhe(e,{email:this._email,oobCode:this._password});default:ru(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return AN(e,n,"signUpPassword",ohe);case"emailLink":return hhe(e,{idToken:r,email:this._email,oobCode:this._password});default:ru(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function fx(t,e){return O1(t,"POST","/v1/accounts:signInWithIdp",lf(t,e))}const fhe="http://localhost";class Jp extends Y8{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Jp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ru("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const o=new Jp(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return fx(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,fx(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,fx(e,r)}buildRequest(){const e={requestUri:fhe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=L1(r)}return e}}function phe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mhe(t){const e=Hy(Wy(t)).link,r=e?Hy(Wy(e)).deep_link_id:null,n=Hy(Wy(t)).deep_link_id;return(n?Hy(Wy(n)).link:null)||n||r||e||t}class X8{constructor(e){const r=Hy(Wy(e)),n=r.apiKey??null,i=r.oobCode??null,a=phe(r.mode??null);zr(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=mhe(e);try{return new X8(r)}catch{return null}}}class ub{constructor(){this.providerId=ub.PROVIDER_ID}static credential(e,r){return Pv._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=X8.parseLink(r);return zr(n,"argument-error"),Pv._fromEmailAndCode(e,n.code,n.tenantId)}}ub.PROVIDER_ID="password";ub.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ub.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Q8{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class R1 extends Q8{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class l0 extends R1{constructor(){super("facebook.com")}static credential(e){return Jp._fromParams({providerId:l0.PROVIDER_ID,signInMethod:l0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return l0.credentialFromTaggedObject(e)}static credentialFromError(e){return l0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return l0.credential(e.oauthAccessToken)}catch{return null}}}l0.FACEBOOK_SIGN_IN_METHOD="facebook.com";l0.PROVIDER_ID="facebook.com";class Sh extends R1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Jp._fromParams({providerId:Sh.PROVIDER_ID,signInMethod:Sh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Sh.credentialFromTaggedObject(e)}static credentialFromError(e){return Sh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Sh.credential(r,n)}catch{return null}}}Sh.GOOGLE_SIGN_IN_METHOD="google.com";Sh.PROVIDER_ID="google.com";class c0 extends R1{constructor(){super("github.com")}static credential(e){return Jp._fromParams({providerId:c0.PROVIDER_ID,signInMethod:c0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return c0.credentialFromTaggedObject(e)}static credentialFromError(e){return c0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return c0.credential(e.oauthAccessToken)}catch{return null}}}c0.GITHUB_SIGN_IN_METHOD="github.com";c0.PROVIDER_ID="github.com";class u0 extends R1{constructor(){super("twitter.com")}static credential(e,r){return Jp._fromParams({providerId:u0.PROVIDER_ID,signInMethod:u0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return u0.credentialFromTaggedObject(e)}static credentialFromError(e){return u0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return u0.credential(r,n)}catch{return null}}}u0.TWITTER_SIGN_IN_METHOD="twitter.com";u0.PROVIDER_ID="twitter.com";async function ghe(t,e){return O1(t,"POST","/v1/accounts:signUp",lf(t,e))}class Zp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Ou._fromIdTokenResponse(e,n,i),o=q7(n);return new Zp({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=q7(n);return new Zp({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function q7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class TN extends Gd{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,TN.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new TN(e,r,n,i)}}function XG(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?TN._fromErrorAndOperation(t,a,e,n):a})}async function xhe(t,e,r=!1){const n=await Lv(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Zp._forOperation(t,"link",n)}async function bhe(t,e,r=!1){const{auth:n}=t;if(Gl(n.app))return Promise.reject(Fh(n));const i="reauthenticate";try{const a=await Lv(t,XG(n,i,e,t),r);zr(a.idToken,n,"internal-error");const o=G8(a.idToken);zr(o,n,"internal-error");const{sub:l}=o;return zr(t.uid===l,n,"user-mismatch"),Zp._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ru(n,"user-mismatch"),a}}async function QG(t,e,r=!1){if(Gl(t.app))return Promise.reject(Fh(t));const n="signIn",i=await XG(t,n,e),a=await Zp._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function yhe(t,e){return QG(uf(t),e)}async function JG(t){const e=uf(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function vhe(t,e,r){const n=uf(t);await AN(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",uhe)}async function whe(t,e,r){if(Gl(t.app))return Promise.reject(Fh(t));const n=uf(t),o=await AN(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ghe).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&JG(t),c}),l=await Zp._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function Nhe(t,e,r){return Gl(t.app)?Promise.reject(Fh(t)):yhe(Qu(t),ub.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&JG(t),n})}async function jhe(t,e){const r=Qu(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await che(r.auth,i);a!==t.email&&await t.reload()}function khe(t,e,r,n){return Qu(t).onIdTokenChanged(e,r,n)}function _he(t,e,r){return Qu(t).beforeAuthStateChanged(e,r)}function She(t,e,r,n){return Qu(t).onAuthStateChanged(e,r,n)}function Che(t){return Qu(t).signOut()}const IN="__sak";class ZG{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(IN,"1"),this.storage.removeItem(IN),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Ehe=1e3,Ahe=10;class eK extends ZG{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=VG(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);zde()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Ahe):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Ehe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}eK.type="LOCAL";const The=eK;class tK extends ZG{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}tK.type="SESSION";const rK=tK;function Ihe(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class _4{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new _4(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(o).map(async u=>u(r.origin,a)),c=await Ihe(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_4.receivers=[];function J8(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class Lhe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const u=J8("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(m.data.response);break;default:clearTimeout(h),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ld(){return window}function Phe(t){Ld().location.href=t}function nK(){return typeof Ld().WorkerGlobalScope<"u"&&typeof Ld().importScripts=="function"}async function Ohe(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Rhe(){return navigator?.serviceWorker?.controller||null}function Mhe(){return nK()?self:null}const sK="firebaseLocalStorageDb",Dhe=1,LN="firebaseLocalStorage",iK="fbase_key";class M1{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function S4(t,e){return t.transaction([LN],e?"readwrite":"readonly").objectStore(LN)}function Bhe(){const t=indexedDB.deleteDatabase(sK);return new M1(t).toPromise()}function B6(){const t=indexedDB.open(sK,Dhe);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(LN,{keyPath:iK})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(LN)?e(n):(n.close(),await Bhe(),e(await B6()))})})}async function V7(t,e,r){const n=S4(t,!0).put({[iK]:e,value:r});return new M1(n).toPromise()}async function $he(t,e){const r=S4(t,!1).get(e),n=await new M1(r).toPromise();return n===void 0?null:n.value}function H7(t,e){const r=S4(t,!0).delete(e);return new M1(r).toPromise()}const Fhe=800,Uhe=3;class aK{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await B6(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Uhe)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nK()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_4._getInstance(Mhe()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Ohe(),!this.activeServiceWorker)return;this.sender=new Lhe(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Rhe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await B6();return await V7(e,IN,"1"),await H7(e,IN),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>V7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>$he(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>H7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=S4(i,!1).getAll();return new M1(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Fhe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aK.type="LOCAL";const zhe=aK;new P1(3e4,6e4);function oK(t,e){return e?Ph(e):(zr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Z8 extends Y8{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fx(e,this._buildIdpRequest())}_linkToIdToken(e,r){return fx(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return fx(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function qhe(t){return QG(t.auth,new Z8(t),t.bypassAuthState)}function Vhe(t){const{auth:e,user:r}=t;return zr(r,e,"internal-error"),bhe(r,new Z8(t),t.bypassAuthState)}async function Hhe(t){const{auth:e,user:r}=t;return zr(r,e,"internal-error"),xhe(r,new Z8(t),t.bypassAuthState)}class lK{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qhe;case"linkViaPopup":case"linkViaRedirect":return Hhe;case"reauthViaPopup":case"reauthViaRedirect":return Vhe;default:ru(this.auth,"internal-error")}}resolve(e){Kh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Kh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Whe=new P1(2e3,1e4);async function Ghe(t,e,r){if(Gl(t.app))return Promise.reject(Bu(t,"operation-not-supported-in-this-environment"));const n=uf(t);Nde(t,e,Q8);const i=oK(n,r);return new Tp(n,"signInViaPopup",e,i).executeNotNull()}class Tp extends lK{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Tp.currentPopupAction&&Tp.currentPopupAction.cancel(),Tp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zr(e,this.auth,"internal-error"),e}async onExecution(){Kh(this.filter.length===1,"Popup operations only handle one event");const e=J8();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Bu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Bu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Tp.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Whe.get())};e()}}Tp.currentPopupAction=null;const Khe="pendingRedirect",$5=new Map;class Yhe extends lK{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=$5.get(this.auth._key());if(!e){try{const n=await Xhe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}$5.set(this.auth._key(),e)}return this.bypassAuthState||$5.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Xhe(t,e){const r=Zhe(e),n=Jhe(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function Qhe(t,e){$5.set(t._key(),e)}function Jhe(t){return Ph(t._redirectPersistence)}function Zhe(t){return B5(Khe,t.config.apiKey,t.name)}async function efe(t,e,r=!1){if(Gl(t.app))return Promise.reject(Fh(t));const n=uf(t),i=oK(n,e),o=await new Yhe(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const tfe=600*1e3;class rfe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nfe(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!cK(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Bu(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tfe&&this.cachedEventUids.clear(),this.cachedEventUids.has(W7(e))}saveEventToCache(e){this.cachedEventUids.add(W7(e)),this.lastProcessedEventTime=Date.now()}}function W7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cK({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function nfe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cK(t);default:return!1}}async function sfe(t,e={}){return cf(t,"GET","/v1/projects",e)}const ife=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,afe=/^https?/;async function ofe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sfe(t);for(const r of e)try{if(lfe(r))return}catch{}ru(t,"unauthorized-domain")}function lfe(t){const e=M6(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!afe.test(r))return!1;if(ife.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const cfe=new P1(3e4,6e4);function G7(){const t=Ld().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function ufe(t){return new Promise((e,r)=>{function n(){G7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{G7(),r(Bu(t,"network-request-failed"))},timeout:cfe.get()})}if(Ld().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ld().gapi?.load)n();else{const i=Qde("iframefcb");return Ld()[i]=()=>{gapi.load?n():r(Bu(t,"network-request-failed"))},WG(`${Xde()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw F5=null,e})}let F5=null;function dfe(t){return F5=F5||ufe(t),F5}const hfe=new P1(5e3,15e3),ffe="__/auth/iframe",pfe="emulator/auth/iframe",mfe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gfe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xfe(t){const e=t.config;zr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?W8(e,pfe):`https://${t.config.authDomain}/${ffe}`,n={apiKey:e.apiKey,appName:t.name,v:Tm},i=gfe.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${L1(n).slice(1)}`}async function bfe(t){const e=await dfe(t),r=Ld().gapi;return zr(r,t,"internal-error"),e.open({where:document.body,url:xfe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mfe,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=Bu(t,"network-request-failed"),l=Ld().setTimeout(()=>{a(o)},hfe.get());function c(){Ld().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{a(o)})}))}const yfe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vfe=500,wfe=600,Nfe="_blank",jfe="http://localhost";class K7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kfe(t,e,r,n=vfe,i=wfe){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...yfe,width:n.toString(),height:i.toString(),top:a,left:o},u=$a().toLowerCase();r&&(l=$G(u)?Nfe:r),DG(u)&&(e=e||jfe,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[g,b])=>`${m}${g}=${b},`,"");if(Ude(u)&&l!=="_self")return _fe(e||"",l),new K7(null);const p=window.open(e||"",l,h);zr(p,t,"popup-blocked");try{p.focus()}catch{}return new K7(p)}function _fe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const Sfe="__/auth/handler",Cfe="emulator/auth/handler",Efe=encodeURIComponent("fac");async function Y7(t,e,r,n,i,a){zr(t.config.authDomain,t,"auth-domain-config-required"),zr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Tm,eventId:i};if(e instanceof Q8){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",lue(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof R1){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${Efe}=${encodeURIComponent(c)}`:"";return`${Afe(t)}?${L1(l).slice(1)}${u}`}function Afe({config:t}){return t.emulator?W8(t,Cfe):`https://${t.authDomain}/${Sfe}`}const t3="webStorageSupport";class Tfe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rK,this._completeRedirectFn=efe,this._overrideRedirectResult=Qhe}async _openPopup(e,r,n,i){Kh(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await Y7(e,r,n,M6(),i);return kfe(e,a,J8())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await Y7(e,r,n,M6(),i);return Phe(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Kh(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await bfe(e),n=new rfe(e);return r.register("authEvent",i=>(zr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(t3,{type:t3},i=>{const a=i?.[0]?.[t3];a!==void 0&&r(!!a),ru(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=ofe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return VG()||BG()||K8()}}const Ife=Tfe;var X7="@firebase/auth",Q7="1.12.0";class Lfe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){zr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Pfe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ofe(t){Qp(new T0("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;zr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HG(t)},u=new Gde(n,i,a,c);return nhe(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Qp(new T0("auth-internal",e=>{const r=uf(e.getProvider("auth").getImmediate());return(n=>new Lfe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Id(X7,Q7,Pfe(t)),Id(X7,Q7,"esm2020")}const Rfe=300,Mfe=yG("authIdTokenMaxAge")||Rfe;let J7=null;const Dfe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Mfe)return;const i=r?.token;J7!==i&&(J7=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Bfe(t=q8()){const e=j4(t,"auth");if(e.isInitialized())return e.getImmediate();const r=rhe(t,{popupRedirectResolver:Ife,persistence:[zhe,The,rK]}),n=yG("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Dfe(a.toString());_he(r,o,()=>o(r.currentUser)),khe(r,l=>o(l))}}const i=gG("auth");return i&&she(r,`http://${i}`),r}function $fe(){return document.getElementsByTagName("head")?.[0]??document}Kde({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Bu("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",$fe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ofe("Browser");var Ffe="firebase",Ufe="12.7.0";Id(Ffe,Ufe,"app");var Z7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var eI;(function(){var t;function e(S,T){function M(){}M.prototype=T.prototype,S.F=T.prototype,S.prototype=new M,S.prototype.constructor=S,S.D=function($,k,L){for(var R=Array(arguments.length-2),V=2;V<arguments.length;V++)R[V-2]=arguments[V];return T.prototype[k].apply($,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,T,M){M||(M=0);const $=Array(16);if(typeof T=="string")for(var k=0;k<16;++k)$[k]=T.charCodeAt(M++)|T.charCodeAt(M++)<<8|T.charCodeAt(M++)<<16|T.charCodeAt(M++)<<24;else for(k=0;k<16;++k)$[k]=T[M++]|T[M++]<<8|T[M++]<<16|T[M++]<<24;T=S.g[0],M=S.g[1],k=S.g[2];let L=S.g[3],R;R=T+(L^M&(k^L))+$[0]+3614090360&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(k^T&(M^k))+$[1]+3905402710&4294967295,L=T+(R<<12&4294967295|R>>>20),R=k+(M^L&(T^M))+$[2]+606105819&4294967295,k=L+(R<<17&4294967295|R>>>15),R=M+(T^k&(L^T))+$[3]+3250441966&4294967295,M=k+(R<<22&4294967295|R>>>10),R=T+(L^M&(k^L))+$[4]+4118548399&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(k^T&(M^k))+$[5]+1200080426&4294967295,L=T+(R<<12&4294967295|R>>>20),R=k+(M^L&(T^M))+$[6]+2821735955&4294967295,k=L+(R<<17&4294967295|R>>>15),R=M+(T^k&(L^T))+$[7]+4249261313&4294967295,M=k+(R<<22&4294967295|R>>>10),R=T+(L^M&(k^L))+$[8]+1770035416&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(k^T&(M^k))+$[9]+2336552879&4294967295,L=T+(R<<12&4294967295|R>>>20),R=k+(M^L&(T^M))+$[10]+4294925233&4294967295,k=L+(R<<17&4294967295|R>>>15),R=M+(T^k&(L^T))+$[11]+2304563134&4294967295,M=k+(R<<22&4294967295|R>>>10),R=T+(L^M&(k^L))+$[12]+1804603682&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(k^T&(M^k))+$[13]+4254626195&4294967295,L=T+(R<<12&4294967295|R>>>20),R=k+(M^L&(T^M))+$[14]+2792965006&4294967295,k=L+(R<<17&4294967295|R>>>15),R=M+(T^k&(L^T))+$[15]+1236535329&4294967295,M=k+(R<<22&4294967295|R>>>10),R=T+(k^L&(M^k))+$[1]+4129170786&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^k&(T^M))+$[6]+3225465664&4294967295,L=T+(R<<9&4294967295|R>>>23),R=k+(T^M&(L^T))+$[11]+643717713&4294967295,k=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(k^L))+$[0]+3921069994&4294967295,M=k+(R<<20&4294967295|R>>>12),R=T+(k^L&(M^k))+$[5]+3593408605&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^k&(T^M))+$[10]+38016083&4294967295,L=T+(R<<9&4294967295|R>>>23),R=k+(T^M&(L^T))+$[15]+3634488961&4294967295,k=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(k^L))+$[4]+3889429448&4294967295,M=k+(R<<20&4294967295|R>>>12),R=T+(k^L&(M^k))+$[9]+568446438&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^k&(T^M))+$[14]+3275163606&4294967295,L=T+(R<<9&4294967295|R>>>23),R=k+(T^M&(L^T))+$[3]+4107603335&4294967295,k=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(k^L))+$[8]+1163531501&4294967295,M=k+(R<<20&4294967295|R>>>12),R=T+(k^L&(M^k))+$[13]+2850285829&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^k&(T^M))+$[2]+4243563512&4294967295,L=T+(R<<9&4294967295|R>>>23),R=k+(T^M&(L^T))+$[7]+1735328473&4294967295,k=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(k^L))+$[12]+2368359562&4294967295,M=k+(R<<20&4294967295|R>>>12),R=T+(M^k^L)+$[5]+4294588738&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^k)+$[8]+2272392833&4294967295,L=T+(R<<11&4294967295|R>>>21),R=k+(L^T^M)+$[11]+1839030562&4294967295,k=L+(R<<16&4294967295|R>>>16),R=M+(k^L^T)+$[14]+4259657740&4294967295,M=k+(R<<23&4294967295|R>>>9),R=T+(M^k^L)+$[1]+2763975236&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^k)+$[4]+1272893353&4294967295,L=T+(R<<11&4294967295|R>>>21),R=k+(L^T^M)+$[7]+4139469664&4294967295,k=L+(R<<16&4294967295|R>>>16),R=M+(k^L^T)+$[10]+3200236656&4294967295,M=k+(R<<23&4294967295|R>>>9),R=T+(M^k^L)+$[13]+681279174&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^k)+$[0]+3936430074&4294967295,L=T+(R<<11&4294967295|R>>>21),R=k+(L^T^M)+$[3]+3572445317&4294967295,k=L+(R<<16&4294967295|R>>>16),R=M+(k^L^T)+$[6]+76029189&4294967295,M=k+(R<<23&4294967295|R>>>9),R=T+(M^k^L)+$[9]+3654602809&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^k)+$[12]+3873151461&4294967295,L=T+(R<<11&4294967295|R>>>21),R=k+(L^T^M)+$[15]+530742520&4294967295,k=L+(R<<16&4294967295|R>>>16),R=M+(k^L^T)+$[2]+3299628645&4294967295,M=k+(R<<23&4294967295|R>>>9),R=T+(k^(M|~L))+$[0]+4096336452&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~k))+$[7]+1126891415&4294967295,L=T+(R<<10&4294967295|R>>>22),R=k+(T^(L|~M))+$[14]+2878612391&4294967295,k=L+(R<<15&4294967295|R>>>17),R=M+(L^(k|~T))+$[5]+4237533241&4294967295,M=k+(R<<21&4294967295|R>>>11),R=T+(k^(M|~L))+$[12]+1700485571&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~k))+$[3]+2399980690&4294967295,L=T+(R<<10&4294967295|R>>>22),R=k+(T^(L|~M))+$[10]+4293915773&4294967295,k=L+(R<<15&4294967295|R>>>17),R=M+(L^(k|~T))+$[1]+2240044497&4294967295,M=k+(R<<21&4294967295|R>>>11),R=T+(k^(M|~L))+$[8]+1873313359&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~k))+$[15]+4264355552&4294967295,L=T+(R<<10&4294967295|R>>>22),R=k+(T^(L|~M))+$[6]+2734768916&4294967295,k=L+(R<<15&4294967295|R>>>17),R=M+(L^(k|~T))+$[13]+1309151649&4294967295,M=k+(R<<21&4294967295|R>>>11),R=T+(k^(M|~L))+$[4]+4149444226&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~k))+$[11]+3174756917&4294967295,L=T+(R<<10&4294967295|R>>>22),R=k+(T^(L|~M))+$[2]+718787259&4294967295,k=L+(R<<15&4294967295|R>>>17),R=M+(L^(k|~T))+$[9]+3951481745&4294967295,S.g[0]=S.g[0]+T&4294967295,S.g[1]=S.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,S.g[2]=S.g[2]+k&4294967295,S.g[3]=S.g[3]+L&4294967295}n.prototype.v=function(S,T){T===void 0&&(T=S.length);const M=T-this.blockSize,$=this.C;let k=this.h,L=0;for(;L<T;){if(k==0)for(;L<=M;)i(this,S,L),L+=this.blockSize;if(typeof S=="string"){for(;L<T;)if($[k++]=S.charCodeAt(L++),k==this.blockSize){i(this,$),k=0;break}}else for(;L<T;)if($[k++]=S[L++],k==this.blockSize){i(this,$),k=0;break}}this.h=k,this.o+=T},n.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var T=1;T<S.length-8;++T)S[T]=0;T=this.o*8;for(var M=S.length-8;M<S.length;++M)S[M]=T&255,T/=256;for(this.v(S),S=Array(16),T=0,M=0;M<4;++M)for(let $=0;$<32;$+=8)S[T++]=this.g[M]>>>$&255;return S};function a(S,T){var M=l;return Object.prototype.hasOwnProperty.call(M,S)?M[S]:M[S]=T(S)}function o(S,T){this.h=T;const M=[];let $=!0;for(let k=S.length-1;k>=0;k--){const L=S[k]|0;$&&L==T||(M[k]=L,$=!1)}this.g=M}var l={};function c(S){return-128<=S&&S<128?a(S,function(T){return new o([T|0],T<0?-1:0)}):new o([S|0],S<0?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return p;if(S<0)return w(u(-S));const T=[];let M=1;for(let $=0;S>=M;$++)T[$]=S/M|0,M*=4294967296;return new o(T,0)}function h(S,T){if(S.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(S.charAt(0)=="-")return w(h(S.substring(1),T));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=u(Math.pow(T,8));let $=p;for(let L=0;L<S.length;L+=8){var k=Math.min(8,S.length-L);const R=parseInt(S.substring(L,L+k),T);k<8?(k=u(Math.pow(T,k)),$=$.j(k).add(u(R))):($=$.j(M),$=$.add(u(R)))}return $}var p=c(0),m=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(v(this))return-w(this).m();let S=0,T=1;for(let M=0;M<this.g.length;M++){const $=this.i(M);S+=($>=0?$:4294967296+$)*T,T*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(b(this))return"0";if(v(this))return"-"+w(this).toString(S);const T=u(Math.pow(S,6));var M=this;let $="";for(;;){const k=I(M,T).g;M=j(M,k.j(T));let L=((M.g.length>0?M.g[0]:M.h)>>>0).toString(S);if(M=k,b(M))return L+$;for(;L.length<6;)L="0"+L;$=L+$}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function b(S){if(S.h!=0)return!1;for(let T=0;T<S.g.length;T++)if(S.g[T]!=0)return!1;return!0}function v(S){return S.h==-1}t.l=function(S){return S=j(this,S),v(S)?-1:b(S)?0:1};function w(S){const T=S.g.length,M=[];for(let $=0;$<T;$++)M[$]=~S.g[$];return new o(M,~S.h).add(m)}t.abs=function(){return v(this)?w(this):this},t.add=function(S){const T=Math.max(this.g.length,S.g.length),M=[];let $=0;for(let k=0;k<=T;k++){let L=$+(this.i(k)&65535)+(S.i(k)&65535),R=(L>>>16)+(this.i(k)>>>16)+(S.i(k)>>>16);$=R>>>16,L&=65535,R&=65535,M[k]=R<<16|L}return new o(M,M[M.length-1]&-2147483648?-1:0)};function j(S,T){return S.add(w(T))}t.j=function(S){if(b(this)||b(S))return p;if(v(this))return v(S)?w(this).j(w(S)):w(w(this).j(S));if(v(S))return w(this.j(w(S)));if(this.l(g)<0&&S.l(g)<0)return u(this.m()*S.m());const T=this.g.length+S.g.length,M=[];for(var $=0;$<2*T;$++)M[$]=0;for($=0;$<this.g.length;$++)for(let k=0;k<S.g.length;k++){const L=this.i($)>>>16,R=this.i($)&65535,V=S.i(k)>>>16,Y=S.i(k)&65535;M[2*$+2*k]+=R*Y,_(M,2*$+2*k),M[2*$+2*k+1]+=L*Y,_(M,2*$+2*k+1),M[2*$+2*k+1]+=R*V,_(M,2*$+2*k+1),M[2*$+2*k+2]+=L*V,_(M,2*$+2*k+2)}for(S=0;S<T;S++)M[S]=M[2*S+1]<<16|M[2*S];for(S=T;S<2*T;S++)M[S]=0;return new o(M,0)};function _(S,T){for(;(S[T]&65535)!=S[T];)S[T+1]+=S[T]>>>16,S[T]&=65535,T++}function E(S,T){this.g=S,this.h=T}function I(S,T){if(b(T))throw Error("division by zero");if(b(S))return new E(p,p);if(v(S))return T=I(w(S),T),new E(w(T.g),w(T.h));if(v(T))return T=I(S,w(T)),new E(w(T.g),T.h);if(S.g.length>30){if(v(S)||v(T))throw Error("slowDivide_ only works with positive integers.");for(var M=m,$=T;$.l(S)<=0;)M=O(M),$=O($);var k=B(M,1),L=B($,1);for($=B($,2),M=B(M,2);!b($);){var R=L.add($);R.l(S)<=0&&(k=k.add(M),L=R),$=B($,1),M=B(M,1)}return T=j(S,k.j(T)),new E(k,T)}for(k=p;S.l(T)>=0;){for(M=Math.max(1,Math.floor(S.m()/T.m())),$=Math.ceil(Math.log(M)/Math.LN2),$=$<=48?1:Math.pow(2,$-48),L=u(M),R=L.j(T);v(R)||R.l(S)>0;)M-=$,L=u(M),R=L.j(T);b(L)&&(L=m),k=k.add(L),S=j(S,R)}return new E(k,S)}t.B=function(S){return I(this,S).h},t.and=function(S){const T=Math.max(this.g.length,S.g.length),M=[];for(let $=0;$<T;$++)M[$]=this.i($)&S.i($);return new o(M,this.h&S.h)},t.or=function(S){const T=Math.max(this.g.length,S.g.length),M=[];for(let $=0;$<T;$++)M[$]=this.i($)|S.i($);return new o(M,this.h|S.h)},t.xor=function(S){const T=Math.max(this.g.length,S.g.length),M=[];for(let $=0;$<T;$++)M[$]=this.i($)^S.i($);return new o(M,this.h^S.h)};function O(S){const T=S.g.length+1,M=[];for(let $=0;$<T;$++)M[$]=S.i($)<<1|S.i($-1)>>>31;return new o(M,S.h)}function B(S,T){const M=T>>5;T%=32;const $=S.g.length-M,k=[];for(let L=0;L<$;L++)k[L]=T>0?S.i(L+M)>>>T|S.i(L+M+1)<<32-T:S.i(L+M);return new o(k,S.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,eI=o}).apply(typeof Z7<"u"?Z7:typeof self<"u"?self:typeof window<"u"?window:{});var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var uK,Gy,dK,U5,$6,hK,fK,pK;(function(){var t,e=Object.defineProperty;function r(A){A=[typeof globalThis=="object"&&globalThis,A,typeof window=="object"&&window,typeof self=="object"&&self,typeof kw=="object"&&kw];for(var K=0;K<A.length;++K){var ae=A[K];if(ae&&ae.Math==Math)return ae}throw Error("Cannot find global object")}var n=r(this);function i(A,K){if(K)e:{var ae=n;A=A.split(".");for(var we=0;we<A.length-1;we++){var We=A[we];if(!(We in ae))break e;ae=ae[We]}A=A[A.length-1],we=ae[A],K=K(we),K!=we&&K!=null&&e(ae,A,{configurable:!0,writable:!0,value:K})}}i("Symbol.dispose",function(A){return A||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(A){return A||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(A){return A||function(K){var ae=[],we;for(we in K)Object.prototype.hasOwnProperty.call(K,we)&&ae.push([we,K[we]]);return ae}});var a=a||{},o=this||self;function l(A){var K=typeof A;return K=="object"&&A!=null||K=="function"}function c(A,K,ae){return A.call.apply(A.bind,arguments)}function u(A,K,ae){return u=c,u.apply(null,arguments)}function h(A,K){var ae=Array.prototype.slice.call(arguments,1);return function(){var we=ae.slice();return we.push.apply(we,arguments),A.apply(this,we)}}function p(A,K){function ae(){}ae.prototype=K.prototype,A.Z=K.prototype,A.prototype=new ae,A.prototype.constructor=A,A.Ob=function(we,We,nt){for(var Ht=Array(arguments.length-2),Vr=2;Vr<arguments.length;Vr++)Ht[Vr-2]=arguments[Vr];return K.prototype[We].apply(we,Ht)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?A=>A&&AsyncContext.Snapshot.wrap(A):A=>A;function g(A){const K=A.length;if(K>0){const ae=Array(K);for(let we=0;we<K;we++)ae[we]=A[we];return ae}return[]}function b(A,K){for(let we=1;we<arguments.length;we++){const We=arguments[we];var ae=typeof We;if(ae=ae!="object"?ae:We?Array.isArray(We)?"array":ae:"null",ae=="array"||ae=="object"&&typeof We.length=="number"){ae=A.length||0;const nt=We.length||0;A.length=ae+nt;for(let Ht=0;Ht<nt;Ht++)A[ae+Ht]=We[Ht]}else A.push(We)}}class v{constructor(K,ae){this.i=K,this.j=ae,this.h=0,this.g=null}get(){let K;return this.h>0?(this.h--,K=this.g,this.g=K.next,K.next=null):K=this.i(),K}}function w(A){o.setTimeout(()=>{throw A},0)}function j(){var A=S;let K=null;return A.g&&(K=A.g,A.g=A.g.next,A.g||(A.h=null),K.next=null),K}class _{constructor(){this.h=this.g=null}add(K,ae){const we=E.get();we.set(K,ae),this.h?this.h.next=we:this.g=we,this.h=we}}var E=new v(()=>new I,A=>A.reset());class I{constructor(){this.next=this.g=this.h=null}set(K,ae){this.h=K,this.g=ae,this.next=null}reset(){this.next=this.g=this.h=null}}let O,B=!1,S=new _,T=()=>{const A=Promise.resolve(void 0);O=()=>{A.then(M)}};function M(){for(var A;A=j();){try{A.h.call(A.g)}catch(ae){w(ae)}var K=E;K.j(A),K.h<100&&(K.h++,A.next=K.g,K.g=A)}B=!1}function $(){this.u=this.u,this.C=this.C}$.prototype.u=!1,$.prototype.dispose=function(){this.u||(this.u=!0,this.N())},$.prototype[Symbol.dispose]=function(){this.dispose()},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(A,K){this.type=A,this.g=this.target=K,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var A=!1,K=Object.defineProperty({},"passive",{get:function(){A=!0}});try{const ae=()=>{};o.addEventListener("test",ae,K),o.removeEventListener("test",ae,K)}catch{}return A})();function R(A){return/^[\s\xa0]*$/.test(A)}function V(A,K){k.call(this,A?A.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,A&&this.init(A,K)}p(V,k),V.prototype.init=function(A,K){const ae=this.type=A.type,we=A.changedTouches&&A.changedTouches.length?A.changedTouches[0]:null;this.target=A.target||A.srcElement,this.g=K,K=A.relatedTarget,K||(ae=="mouseover"?K=A.fromElement:ae=="mouseout"&&(K=A.toElement)),this.relatedTarget=K,we?(this.clientX=we.clientX!==void 0?we.clientX:we.pageX,this.clientY=we.clientY!==void 0?we.clientY:we.pageY,this.screenX=we.screenX||0,this.screenY=we.screenY||0):(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0),this.button=A.button,this.key=A.key||"",this.ctrlKey=A.ctrlKey,this.altKey=A.altKey,this.shiftKey=A.shiftKey,this.metaKey=A.metaKey,this.pointerId=A.pointerId||0,this.pointerType=A.pointerType,this.state=A.state,this.i=A,A.defaultPrevented&&V.Z.h.call(this)},V.prototype.h=function(){V.Z.h.call(this);const A=this.i;A.preventDefault?A.preventDefault():A.returnValue=!1};var Y="closure_listenable_"+(Math.random()*1e6|0),X=0;function J(A,K,ae,we,We){this.listener=A,this.proxy=null,this.src=K,this.type=ae,this.capture=!!we,this.ha=We,this.key=++X,this.da=this.fa=!1}function re(A){A.da=!0,A.listener=null,A.proxy=null,A.src=null,A.ha=null}function se(A,K,ae){for(const we in A)K.call(ae,A[we],we,A)}function ee(A,K){for(const ae in A)K.call(void 0,A[ae],ae,A)}function q(A){const K={};for(const ae in A)K[ae]=A[ae];return K}const U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(A,K){let ae,we;for(let We=1;We<arguments.length;We++){we=arguments[We];for(ae in we)A[ae]=we[ae];for(let nt=0;nt<U.length;nt++)ae=U[nt],Object.prototype.hasOwnProperty.call(we,ae)&&(A[ae]=we[ae])}}function Z(A){this.src=A,this.g={},this.h=0}Z.prototype.add=function(A,K,ae,we,We){const nt=A.toString();A=this.g[nt],A||(A=this.g[nt]=[],this.h++);const Ht=be(A,K,we,We);return Ht>-1?(K=A[Ht],ae||(K.fa=!1)):(K=new J(K,this.src,nt,!!we,We),K.fa=ae,A.push(K)),K};function de(A,K){const ae=K.type;if(ae in A.g){var we=A.g[ae],We=Array.prototype.indexOf.call(we,K,void 0),nt;(nt=We>=0)&&Array.prototype.splice.call(we,We,1),nt&&(re(K),A.g[ae].length==0&&(delete A.g[ae],A.h--))}}function be(A,K,ae,we){for(let We=0;We<A.length;++We){const nt=A[We];if(!nt.da&&nt.listener==K&&nt.capture==!!ae&&nt.ha==we)return We}return-1}var oe="closure_lm_"+(Math.random()*1e6|0),ne={};function H(A,K,ae,we,We){if(Array.isArray(K)){for(let nt=0;nt<K.length;nt++)H(A,K[nt],ae,we,We);return null}return ae=Ve(ae),A&&A[Y]?A.J(K,ae,l(we)?!!we.capture:!1,We):le(A,K,ae,!1,we,We)}function le(A,K,ae,we,We,nt){if(!K)throw Error("Invalid event type");const Ht=l(We)?!!We.capture:!!We;let Vr=Be(A);if(Vr||(A[oe]=Vr=new Z(A)),ae=Vr.add(K,ae,we,Ht,nt),ae.proxy)return ae;if(we=ye(),ae.proxy=we,we.src=A,we.listener=ae,A.addEventListener)L||(We=Ht),We===void 0&&(We=!1),A.addEventListener(K.toString(),we,We);else if(A.attachEvent)A.attachEvent(Ie(K.toString()),we);else if(A.addListener&&A.removeListener)A.addListener(we);else throw Error("addEventListener and attachEvent are unavailable.");return ae}function ye(){function A(ae){return K.call(A.src,A.listener,ae)}const K=ce;return A}function me(A,K,ae,we,We){if(Array.isArray(K))for(var nt=0;nt<K.length;nt++)me(A,K[nt],ae,we,We);else we=l(we)?!!we.capture:!!we,ae=Ve(ae),A&&A[Y]?(A=A.i,nt=String(K).toString(),nt in A.g&&(K=A.g[nt],ae=be(K,ae,we,We),ae>-1&&(re(K[ae]),Array.prototype.splice.call(K,ae,1),K.length==0&&(delete A.g[nt],A.h--)))):A&&(A=Be(A))&&(K=A.g[K.toString()],A=-1,K&&(A=be(K,ae,we,We)),(ae=A>-1?K[A]:null)&&ke(ae))}function ke(A){if(typeof A!="number"&&A&&!A.da){var K=A.src;if(K&&K[Y])de(K.i,A);else{var ae=A.type,we=A.proxy;K.removeEventListener?K.removeEventListener(ae,we,A.capture):K.detachEvent?K.detachEvent(Ie(ae),we):K.addListener&&K.removeListener&&K.removeListener(we),(ae=Be(K))?(de(ae,A),ae.h==0&&(ae.src=null,K[oe]=null)):re(A)}}}function Ie(A){return A in ne?ne[A]:ne[A]="on"+A}function ce(A,K){if(A.da)A=!0;else{K=new V(K,this);const ae=A.listener,we=A.ha||A.src;A.fa&&ke(A),A=ae.call(we,K)}return A}function Be(A){return A=A[oe],A instanceof Z?A:null}var ct="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ve(A){return typeof A=="function"?A:(A[ct]||(A[ct]=function(K){return A.handleEvent(K)}),A[ct])}function Ne(){$.call(this),this.i=new Z(this),this.M=this,this.G=null}p(Ne,$),Ne.prototype[Y]=!0,Ne.prototype.removeEventListener=function(A,K,ae,we){me(this,A,K,ae,we)};function Ye(A,K){var ae,we=A.G;if(we)for(ae=[];we;we=we.G)ae.push(we);if(A=A.M,we=K.type||K,typeof K=="string")K=new k(K,A);else if(K instanceof k)K.target=K.target||A;else{var We=K;K=new k(we,A),W(K,We)}We=!0;let nt,Ht;if(ae)for(Ht=ae.length-1;Ht>=0;Ht--)nt=K.g=ae[Ht],We=St(nt,we,!0,K)&&We;if(nt=K.g=A,We=St(nt,we,!0,K)&&We,We=St(nt,we,!1,K)&&We,ae)for(Ht=0;Ht<ae.length;Ht++)nt=K.g=ae[Ht],We=St(nt,we,!1,K)&&We}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var A=this.i;for(const K in A.g){const ae=A.g[K];for(let we=0;we<ae.length;we++)re(ae[we]);delete A.g[K],A.h--}}this.G=null},Ne.prototype.J=function(A,K,ae,we){return this.i.add(String(A),K,!1,ae,we)},Ne.prototype.K=function(A,K,ae,we){return this.i.add(String(A),K,!0,ae,we)};function St(A,K,ae,we){if(K=A.i.g[String(K)],!K)return!0;K=K.concat();let We=!0;for(let nt=0;nt<K.length;++nt){const Ht=K[nt];if(Ht&&!Ht.da&&Ht.capture==ae){const Vr=Ht.listener,ws=Ht.ha||Ht.src;Ht.fa&&de(A.i,Ht),We=Vr.call(ws,we)!==!1&&We}}return We&&!we.defaultPrevented}function Vt(A,K){if(typeof A!="function")if(A&&typeof A.handleEvent=="function")A=u(A.handleEvent,A);else throw Error("Invalid listener argument");return Number(K)>2147483647?-1:o.setTimeout(A,K||0)}function Lt(A){A.g=Vt(()=>{A.g=null,A.i&&(A.i=!1,Lt(A))},A.l);const K=A.h;A.h=null,A.m.apply(null,K)}class at extends ${constructor(K,ae){super(),this.m=K,this.l=ae,this.h=null,this.i=!1,this.g=null}j(K){this.h=arguments,this.g?this.i=!0:Lt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gt(A){$.call(this),this.h=A,this.g={}}p(gt,$);var vt=[];function ft(A){se(A.g,function(K,ae){this.g.hasOwnProperty(ae)&&ke(K)},A),A.g={}}gt.prototype.N=function(){gt.Z.N.call(this),ft(this)},gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ot=o.JSON.stringify,ut=o.JSON.parse,At=class{stringify(A){return o.JSON.stringify(A,void 0)}parse(A){return o.JSON.parse(A,void 0)}};function Fe(){}function Ut(){}var jt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qe(){k.call(this,"d")}p(qe,k);function rt(){k.call(this,"c")}p(rt,k);var Ot={},pt=null;function Jt(){return pt=pt||new Ne}Ot.Ia="serverreachability";function Kt(A){k.call(this,Ot.Ia,A)}p(Kt,k);function rr(A){const K=Jt();Ye(K,new Kt(K))}Ot.STAT_EVENT="statevent";function Br(A,K){k.call(this,Ot.STAT_EVENT,A),this.stat=K}p(Br,k);function zt(A){const K=Jt();Ye(K,new Br(K,A))}Ot.Ja="timingevent";function Wt(A,K){k.call(this,Ot.Ja,A),this.size=K}p(Wt,k);function qt(A,K){if(typeof A!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){A()},K)}function ur(){this.g=!0}ur.prototype.ua=function(){this.g=!1};function Re(A,K,ae,we,We,nt){A.info(function(){if(A.g)if(nt){var Ht="",Vr=nt.split("&");for(let un=0;un<Vr.length;un++){var ws=Vr[un].split("=");if(ws.length>1){const Gn=ws[0];ws=ws[1];const ca=Gn.split("_");Ht=ca.length>=2&&ca[1]=="type"?Ht+(Gn+"="+ws+"&"):Ht+(Gn+"=redacted&")}}}else Ht=null;else Ht=nt;return"XMLHTTP REQ ("+we+") [attempt "+We+"]: "+K+`
`+ae+`
`+Ht})}function Nt(A,K,ae,we,We,nt,Ht){A.info(function(){return"XMLHTTP RESP ("+we+") [ attempt "+We+"]: "+K+`
`+ae+`
`+nt+" "+Ht})}function Pt(A,K,ae,we){A.info(function(){return"XMLHTTP TEXT ("+K+"): "+Zt(A,ae)+(we?" "+we:"")})}function It(A,K){A.info(function(){return"TIMEOUT: "+K})}ur.prototype.info=function(){};function Zt(A,K){if(!A.g)return K;if(!K)return null;try{const nt=JSON.parse(K);if(nt){for(A=0;A<nt.length;A++)if(Array.isArray(nt[A])){var ae=nt[A];if(!(ae.length<2)){var we=ae[1];if(Array.isArray(we)&&!(we.length<1)){var We=we[0];if(We!="noop"&&We!="stop"&&We!="close")for(let Ht=1;Ht<we.length;Ht++)we[Ht]=""}}}}return ot(nt)}catch{return K}}var Ae={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},et={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rt;function $t(){}p($t,Fe),$t.prototype.g=function(){return new XMLHttpRequest},Rt=new $t;function Qt(A){return encodeURIComponent(String(A))}function Ee(A){var K=1;A=A.split(":");const ae=[];for(;K>0&&A.length;)ae.push(A.shift()),K--;return A.length&&ae.push(A.join(":")),ae}function Me(A,K,ae,we){this.j=A,this.i=K,this.l=ae,this.S=we||1,this.V=new gt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Je}function Je(){this.i=null,this.g="",this.h=!1}var Ft={},tr={};function Rr(A,K,ae){A.M=1,A.A=ho(xs(K)),A.u=ae,A.R=!0,Kr(A,null)}function Kr(A,K){A.F=Date.now(),Ts(A),A.B=xs(A.A);var ae=A.B,we=A.S;Array.isArray(we)||(we=[String(we)]),Cl(ae.i,"t",we),A.C=0,ae=A.j.L,A.h=new Je,A.g=or(A.j,ae?K:null,!A.u),A.P>0&&(A.O=new at(u(A.Y,A,A.g),A.P)),K=A.V,ae=A.g,we=A.ba;var We="readystatechange";Array.isArray(We)||(We&&(vt[0]=We.toString()),We=vt);for(let nt=0;nt<We.length;nt++){const Ht=H(ae,We[nt],we||K.handleEvent,!1,K.h||K);if(!Ht)break;K.g[Ht.key]=Ht}K=A.J?q(A.J):{},A.u?(A.v||(A.v="POST"),K["Content-Type"]="application/x-www-form-urlencoded",A.g.ea(A.B,A.v,A.u,K)):(A.v="GET",A.g.ea(A.B,A.v,null,K)),rr(),Re(A.i,A.v,A.B,A.l,A.S,A.u)}Me.prototype.ba=function(A){A=A.target;const K=this.O;K&&Te(A)==3?K.j():this.Y(A)},Me.prototype.Y=function(A){try{if(A==this.g)e:{const Vr=Te(this.g),ws=this.g.ya(),un=this.g.ca();if(!(Vr<3)&&(Vr!=3||this.g&&(this.h.h||this.g.la()||dt(this.g)))){this.K||Vr!=4||ws==7||(ws==8||un<=0?rr(3):rr(2)),Hn(this);var K=this.g.ca();this.X=K;var ae=$s(this);if(this.o=K==200,Nt(this.i,this.v,this.B,this.l,this.S,Vr,K),this.o){if(this.U&&!this.L){t:{if(this.g){var we,We=this.g;if((we=We.g?We.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(we)){var nt=we;break t}}nt=null}if(A=nt)Pt(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,aa(this,A);else{this.o=!1,this.m=3,zt(12),Yi(this),wi(this);break e}}if(this.R){A=!0;let Gn;for(;!this.K&&this.C<ae.length;)if(Gn=Ws(this,ae),Gn==tr){Vr==4&&(this.m=4,zt(14),A=!1),Pt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Ft){this.m=4,zt(15),Pt(this.i,this.l,ae,"[Invalid Chunk]"),A=!1;break}else Pt(this.i,this.l,Gn,null),aa(this,Gn);if(Ki(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vr!=4||ae.length!=0||this.h.h||(this.m=1,zt(16),A=!1),this.o=this.o&&A,!A)Pt(this.i,this.l,ae,"[Invalid Chunked Response]"),Yi(this),wi(this);else if(ae.length>0&&!this.W){this.W=!0;var Ht=this.j;Ht.g==this&&Ht.aa&&!Ht.P&&(Ht.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Ga(Ht),Ht.P=!0,zt(11))}}else Pt(this.i,this.l,ae,null),aa(this,ae);Vr==4&&Yi(this),this.o&&!this.K&&(Vr==4?_e(this.j,this):(this.o=!1,Ts(this)))}else _r(this.g),K==400&&ae.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),Yi(this),wi(this)}}}catch{}};function $s(A){if(!Ki(A))return A.g.la();const K=dt(A.g);if(K==="")return"";let ae="";const we=K.length,We=Te(A.g)==4;if(!A.h.i){if(typeof TextDecoder>"u")return Yi(A),wi(A),"";A.h.i=new o.TextDecoder}for(let nt=0;nt<we;nt++)A.h.h=!0,ae+=A.h.i.decode(K[nt],{stream:!(We&&nt==we-1)});return K.length=0,A.h.g+=ae,A.C=0,A.h.g}function Ki(A){return A.g?A.v=="GET"&&A.M!=2&&A.j.Aa:!1}function Ws(A,K){var ae=A.C,we=K.indexOf(`
`,ae);return we==-1?tr:(ae=Number(K.substring(ae,we)),isNaN(ae)?Ft:(we+=1,we+ae>K.length?tr:(K=K.slice(we,we+ae),A.C=we+ae,K)))}Me.prototype.cancel=function(){this.K=!0,Yi(this)};function Ts(A){A.T=Date.now()+A.H,wa(A,A.H)}function wa(A,K){if(A.D!=null)throw Error("WatchDog timer not null");A.D=qt(u(A.aa,A),K)}function Hn(A){A.D&&(o.clearTimeout(A.D),A.D=null)}Me.prototype.aa=function(){this.D=null;const A=Date.now();A-this.T>=0?(It(this.i,this.B),this.M!=2&&(rr(),zt(17)),Yi(this),this.m=2,wi(this)):wa(this,this.T-A)};function wi(A){A.j.I==0||A.K||_e(A.j,A)}function Yi(A){Hn(A);var K=A.O;K&&typeof K.dispose=="function"&&K.dispose(),A.O=null,ft(A.V),A.g&&(K=A.g,A.g=null,K.abort(),K.dispose())}function aa(A,K){try{var ae=A.j;if(ae.I!=0&&(ae.g==A||Li(ae.h,A))){if(!A.L&&Li(ae.h,A)&&ae.I==3){try{var we=ae.Ba.g.parse(K)}catch{we=null}if(Array.isArray(we)&&we.length==3){var We=we;if(We[0]==0){e:if(!ae.v){if(ae.g)if(ae.g.F+3e3<A.F)ue(ae),Cn(ae);else break e;Ys(ae),zt(18)}}else ae.xa=We[1],0<ae.xa-ae.K&&We[2]<37500&&ae.F&&ae.A==0&&!ae.C&&(ae.C=qt(u(ae.Va,ae),6e3));Xi(ae.h)<=1&&ae.ta&&(ae.ta=void 0)}else ze(ae,11)}else if((A.L||ae.g==A)&&ue(ae),!R(K))for(We=ae.Ba.g.parse(K),K=0;K<We.length;K++){let un=We[K];const Gn=un[0];if(!(Gn<=ae.K))if(ae.K=Gn,un=un[1],ae.I==2)if(un[0]=="c"){ae.M=un[1],ae.ba=un[2];const ca=un[3];ca!=null&&(ae.ka=ca,ae.j.info("VER="+ae.ka));const ka=un[4];ka!=null&&(ae.za=ka,ae.j.info("SVER="+ae.za));const cs=un[5];cs!=null&&typeof cs=="number"&&cs>0&&(we=1.5*cs,ae.O=we,ae.j.info("backChannelRequestTimeoutMs_="+we)),we=ae;const _a=A.g;if(_a){const rl=_a.g?_a.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rl){var nt=we.h;nt.g||rl.indexOf("spdy")==-1&&rl.indexOf("quic")==-1&&rl.indexOf("h2")==-1||(nt.j=nt.l,nt.g=new Set,nt.h&&(Pi(nt,nt.h),nt.h=null))}if(we.G){const Ac=_a.g?_a.g.getResponseHeader("X-HTTP-Session-Id"):null;Ac&&(we.wa=Ac,an(we.J,we.G,Ac))}}ae.I=3,ae.l&&ae.l.ra(),ae.aa&&(ae.T=Date.now()-A.F,ae.j.info("Handshake RTT: "+ae.T+"ms")),we=ae;var Ht=A;if(we.na=Tt(we,we.L?we.ba:null,we.W),Ht.L){Bo(we.h,Ht);var Vr=Ht,ws=we.O;ws&&(Vr.H=ws),Vr.D&&(Hn(Vr),Ts(Vr)),we.g=Ht}else Wa(we);ae.i.length>0&&Un(ae)}else un[0]!="stop"&&un[0]!="close"||ze(ae,7);else ae.I==3&&(un[0]=="stop"||un[0]=="close"?un[0]=="stop"?ze(ae,7):Xr(ae):un[0]!="noop"&&ae.l&&ae.l.qa(un),ae.A=0)}}rr(4)}catch{}}var os=class{constructor(A,K){this.g=A,this.map=K}};function kl(A){this.l=A||10,o.PerformanceNavigationTiming?(A=o.performance.getEntriesByType("navigation"),A=A.length>0&&(A[0].nextHopProtocol=="hq"||A[0].nextHopProtocol=="h2")):A=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=A?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gs(A){return A.h?!0:A.g?A.g.size>=A.j:!1}function Xi(A){return A.h?1:A.g?A.g.size:0}function Li(A,K){return A.h?A.h==K:A.g?A.g.has(K):!1}function Pi(A,K){A.g?A.g.add(K):A.h=K}function Bo(A,K){A.h&&A.h==K?A.h=null:A.g&&A.g.has(K)&&A.g.delete(K)}kl.prototype.cancel=function(){if(this.i=_l(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const A of this.g.values())A.cancel();this.g.clear()}};function _l(A){if(A.h!=null)return A.i.concat(A.h.G);if(A.g!=null&&A.g.size!==0){let K=A.i;for(const ae of A.g.values())K=K.concat(ae.G);return K}return g(A.i)}var tc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qi(A,K){if(A){A=A.split("&");for(let ae=0;ae<A.length;ae++){const we=A[ae].indexOf("=");let We,nt=null;we>=0?(We=A[ae].substring(0,we),nt=A[ae].substring(we+1)):We=A[ae],K(We,nt?decodeURIComponent(nt.replace(/\+/g," ")):"")}}}function oi(A){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let K;A instanceof oi?(this.l=A.l,Yr(this,A.j),this.o=A.o,this.g=A.g,Na(this,A.u),this.h=A.h,li(this,El(A.i)),this.m=A.m):A&&(K=String(A).match(tc))?(this.l=!1,Yr(this,K[1]||"",!0),this.o=Is(K[2]||""),this.g=Is(K[3]||"",!0),Na(this,K[4]),this.h=Is(K[5]||"",!0),li(this,K[6]||"",!0),this.m=Is(K[7]||"")):(this.l=!1,this.i=new Ks(null,this.l))}oi.prototype.toString=function(){const A=[];var K=this.j;K&&A.push(Zn(K,tl,!0),":");var ae=this.g;return(ae||K=="file")&&(A.push("//"),(K=this.o)&&A.push(Zn(K,tl,!0),"@"),A.push(Qt(ae).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ae=this.u,ae!=null&&A.push(":",String(ae))),(ae=this.h)&&(this.g&&ae.charAt(0)!="/"&&A.push("/"),A.push(Zn(ae,ae.charAt(0)=="/"?rc:Sl,!0))),(ae=this.i.toString())&&A.push("?",ae),(ae=this.m)&&A.push("#",Zn(ae,fo)),A.join("")},oi.prototype.resolve=function(A){const K=xs(this);let ae=!!A.j;ae?Yr(K,A.j):ae=!!A.o,ae?K.o=A.o:ae=!!A.g,ae?K.g=A.g:ae=A.u!=null;var we=A.h;if(ae)Na(K,A.u);else if(ae=!!A.h){if(we.charAt(0)!="/")if(this.g&&!this.h)we="/"+we;else{var We=K.h.lastIndexOf("/");We!=-1&&(we=K.h.slice(0,We+1)+we)}if(We=we,We==".."||We==".")we="";else if(We.indexOf("./")!=-1||We.indexOf("/.")!=-1){we=We.lastIndexOf("/",0)==0,We=We.split("/");const nt=[];for(let Ht=0;Ht<We.length;){const Vr=We[Ht++];Vr=="."?we&&Ht==We.length&&nt.push(""):Vr==".."?((nt.length>1||nt.length==1&&nt[0]!="")&&nt.pop(),we&&Ht==We.length&&nt.push("")):(nt.push(Vr),we=!0)}we=nt.join("/")}else we=We}return ae?K.h=we:ae=A.i.toString()!=="",ae?li(K,El(A.i)):ae=!!A.m,ae&&(K.m=A.m),K};function xs(A){return new oi(A)}function Yr(A,K,ae){A.j=ae?Is(K,!0):K,A.j&&(A.j=A.j.replace(/:$/,""))}function Na(A,K){if(K){if(K=Number(K),isNaN(K)||K<0)throw Error("Bad port number "+K);A.u=K}else A.u=null}function li(A,K,ae){K instanceof Ks?(A.i=K,Ri(A.i,A.l)):(ae||(K=Zn(K,Ni)),A.i=new Ks(K,A.l))}function an(A,K,ae){A.i.set(K,ae)}function ho(A){return an(A,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),A}function Is(A,K){return A?K?decodeURI(A.replace(/%25/g,"%2525")):decodeURIComponent(A):""}function Zn(A,K,ae){return typeof A=="string"?(A=encodeURI(A).replace(K,bs),ae&&(A=A.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A):null}function bs(A){return A=A.charCodeAt(0),"%"+(A>>4&15).toString(16)+(A&15).toString(16)}var tl=/[#\/\?@]/g,Sl=/[#\?:]/g,rc=/[#\?]/g,Ni=/[#\?@]/g,fo=/#/g;function Ks(A,K){this.h=this.g=null,this.i=A||null,this.j=!!K}function es(A){A.g||(A.g=new Map,A.h=0,A.i&&Qi(A.i,function(K,ae){A.add(decodeURIComponent(K.replace(/\+/g," ")),ae)}))}t=Ks.prototype,t.add=function(A,K){es(this),this.i=null,A=po(this,A);let ae=this.g.get(A);return ae||this.g.set(A,ae=[]),ae.push(K),this.h+=1,this};function Oi(A,K){es(A),K=po(A,K),A.g.has(K)&&(A.i=null,A.h-=A.g.get(K).length,A.g.delete(K))}function nc(A,K){return es(A),K=po(A,K),A.g.has(K)}t.forEach=function(A,K){es(this),this.g.forEach(function(ae,we){ae.forEach(function(We){A.call(K,We,we,this)},this)},this)};function oa(A,K){es(A);let ae=[];if(typeof K=="string")nc(A,K)&&(ae=ae.concat(A.g.get(po(A,K))));else for(A=Array.from(A.g.values()),K=0;K<A.length;K++)ae=ae.concat(A[K]);return ae}t.set=function(A,K){return es(this),this.i=null,A=po(this,A),nc(this,A)&&(this.h-=this.g.get(A).length),this.g.set(A,[K]),this.h+=1,this},t.get=function(A,K){return A?(A=oa(this,A),A.length>0?String(A[0]):K):K};function Cl(A,K,ae){Oi(A,K),ae.length>0&&(A.i=null,A.g.set(po(A,K),g(ae)),A.h+=ae.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const A=[],K=Array.from(this.g.keys());for(let we=0;we<K.length;we++){var ae=K[we];const We=Qt(ae);ae=oa(this,ae);for(let nt=0;nt<ae.length;nt++){let Ht=We;ae[nt]!==""&&(Ht+="="+Qt(ae[nt])),A.push(Ht)}}return this.i=A.join("&")};function El(A){const K=new Ks;return K.i=A.i,A.g&&(K.g=new Map(A.g),K.h=A.h),K}function po(A,K){return K=String(K),A.j&&(K=K.toLowerCase()),K}function Ri(A,K){K&&!A.j&&(es(A),A.i=null,A.g.forEach(function(ae,we){const We=we.toLowerCase();we!=We&&(Oi(this,we),Cl(this,We,ae))},A)),A.j=K}function la(A,K){const ae=new ur;if(o.Image){const we=new Image;we.onload=h(ji,ae,"TestLoadImage: loaded",!0,K,we),we.onerror=h(ji,ae,"TestLoadImage: error",!1,K,we),we.onabort=h(ji,ae,"TestLoadImage: abort",!1,K,we),we.ontimeout=h(ji,ae,"TestLoadImage: timeout",!1,K,we),o.setTimeout(function(){we.ontimeout&&we.ontimeout()},1e4),we.src=A}else K(!1)}function ls(A,K){const ae=new ur,we=new AbortController,We=setTimeout(()=>{we.abort(),ji(ae,"TestPingServer: timeout",!1,K)},1e4);fetch(A,{signal:we.signal}).then(nt=>{clearTimeout(We),nt.ok?ji(ae,"TestPingServer: ok",!0,K):ji(ae,"TestPingServer: server error",!1,K)}).catch(()=>{clearTimeout(We),ji(ae,"TestPingServer: error",!1,K)})}function ji(A,K,ae,we,We){try{We&&(We.onload=null,We.onerror=null,We.onabort=null,We.ontimeout=null),we(ae)}catch{}}function mo(){this.g=new At}function mr(A){this.i=A.Sb||null,this.h=A.ab||!1}p(mr,Fe),mr.prototype.g=function(){return new go(this.i,this.h)};function go(A,K){Ne.call(this),this.H=A,this.o=K,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(go,Ne),t=go.prototype,t.open=function(A,K){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=A,this.D=K,this.readyState=1,Fs(this)},t.send=function(A){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const K={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};A&&(K.body=A),(this.H||o).fetch(new Request(this.D,K)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$o(this)),this.readyState=0},t.Pa=function(A){if(this.g&&(this.l=A,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=A.headers,this.readyState=2,Fs(this)),this.g&&(this.readyState=3,Fs(this),this.g)))if(this.responseType==="arraybuffer")A.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in A){if(this.j=A.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xo(this)}else A.text().then(this.Oa.bind(this),this.ga.bind(this))};function xo(A){A.j.read().then(A.Ma.bind(A)).catch(A.ga.bind(A))}t.Ma=function(A){if(this.g){if(this.o&&A.value)this.response.push(A.value);else if(!this.o){var K=A.value?A.value:new Uint8Array(0);(K=this.B.decode(K,{stream:!A.done}))&&(this.response=this.responseText+=K)}A.done?$o(this):Fs(this),this.readyState==3&&xo(this)}},t.Oa=function(A){this.g&&(this.response=this.responseText=A,$o(this))},t.Na=function(A){this.g&&(this.response=A,$o(this))},t.ga=function(){this.g&&$o(this)};function $o(A){A.readyState=4,A.l=null,A.j=null,A.B=null,Fs(A)}t.setRequestHeader=function(A,K){this.A.append(A,K)},t.getResponseHeader=function(A){return this.h&&this.h.get(A.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const A=[],K=this.h.entries();for(var ae=K.next();!ae.done;)ae=ae.value,A.push(ae[0]+": "+ae[1]),ae=K.next();return A.join(`\r
`)};function Fs(A){A.onreadystatechange&&A.onreadystatechange.call(A)}Object.defineProperty(go.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(A){this.m=A?"include":"same-origin"}});function ys(A){let K="";return se(A,function(ae,we){K+=we,K+=":",K+=ae,K+=`\r
`}),K}function Fo(A,K,ae){e:{for(we in ae){var we=!1;break e}we=!0}we||(ae=ys(ae),typeof A=="string"?ae!=null&&Qt(ae):an(A,K,ae))}function rn(A){Ne.call(this),this.headers=new Map,this.L=A||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(rn,Ne);var Mi=/^https?$/i,bo=["POST","PUT"];t=rn.prototype,t.Fa=function(A){this.H=A},t.ea=function(A,K,ae,we){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+A);K=K?K.toUpperCase():"GET",this.D=A,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rt.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(K,String(A),!0),this.B=!1}catch(nt){ja(this,nt);return}if(A=ae||"",ae=new Map(this.headers),we)if(Object.getPrototypeOf(we)===Object.prototype)for(var We in we)ae.set(We,we[We]);else if(typeof we.keys=="function"&&typeof we.get=="function")for(const nt of we.keys())ae.set(nt,we.get(nt));else throw Error("Unknown input type for opt_headers: "+String(we));we=Array.from(ae.keys()).find(nt=>nt.toLowerCase()=="content-type"),We=o.FormData&&A instanceof o.FormData,!(Array.prototype.indexOf.call(bo,K,void 0)>=0)||we||We||ae.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[nt,Ht]of ae)this.g.setRequestHeader(nt,Ht);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(A),this.v=!1}catch(nt){ja(this,nt)}};function ja(A,K){A.h=!1,A.g&&(A.j=!0,A.g.abort(),A.j=!1),A.l=K,A.o=5,sc(A),xe(A)}function sc(A){A.A||(A.A=!0,Ye(A,"complete"),Ye(A,"error"))}t.abort=function(A){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=A||7,Ye(this,"complete"),Ye(this,"abort"),xe(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xe(this,!0)),rn.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Q(this):this.Xa())},t.Xa=function(){Q(this)};function Q(A){if(A.h&&typeof a<"u"){if(A.v&&Te(A)==4)setTimeout(A.Ca.bind(A),0);else if(Ye(A,"readystatechange"),Te(A)==4){A.h=!1;try{const nt=A.ca();e:switch(nt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var K=!0;break e;default:K=!1}var ae;if(!(ae=K)){var we;if(we=nt===0){let Ht=String(A.D).match(tc)[1]||null;!Ht&&o.self&&o.self.location&&(Ht=o.self.location.protocol.slice(0,-1)),we=!Mi.test(Ht?Ht.toLowerCase():"")}ae=we}if(ae)Ye(A,"complete"),Ye(A,"success");else{A.o=6;try{var We=Te(A)>2?A.g.statusText:""}catch{We=""}A.l=We+" ["+A.ca()+"]",sc(A)}}finally{xe(A)}}}}function xe(A,K){if(A.g){A.m&&(clearTimeout(A.m),A.m=null);const ae=A.g;A.g=null,K||Ye(A,"ready");try{ae.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Te(A){return A.g?A.g.readyState:0}t.ca=function(){try{return Te(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(A){if(this.g){var K=this.g.responseText;return A&&K.indexOf(A)==0&&(K=K.substring(A.length)),ut(K)}};function dt(A){try{if(!A.g)return null;if("response"in A.g)return A.g.response;switch(A.F){case"":case"text":return A.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in A.g)return A.g.mozResponseArrayBuffer}return null}catch{return null}}function _r(A){const K={};A=(A.g&&Te(A)>=2&&A.g.getAllResponseHeaders()||"").split(`\r
`);for(let we=0;we<A.length;we++){if(R(A[we]))continue;var ae=Ee(A[we]);const We=ae[0];if(ae=ae[1],typeof ae!="string")continue;ae=ae.trim();const nt=K[We]||[];K[We]=nt,nt.push(ae)}ee(K,function(we){return we.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function er(A,K,ae){return ae&&ae.internalChannelParams&&ae.internalChannelParams[A]||K}function Hr(A){this.za=0,this.i=[],this.j=new ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=er("failFast",!1,A),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=er("baseRetryDelayMs",5e3,A),this.Za=er("retryDelaySeedMs",1e4,A),this.Ta=er("forwardChannelMaxRetries",2,A),this.va=er("forwardChannelRequestTimeoutMs",2e4,A),this.ma=A&&A.xmlHttpFactory||void 0,this.Ua=A&&A.Rb||void 0,this.Aa=A&&A.useFetchStreams||!1,this.O=void 0,this.L=A&&A.supportsCrossDomainXhr||!1,this.M="",this.h=new kl(A&&A.concurrentRequestLimit),this.Ba=new mo,this.S=A&&A.fastHandshake||!1,this.R=A&&A.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=A&&A.Pb||!1,A&&A.ua&&this.j.ua(),A&&A.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&A&&A.detectBufferingProxy||!1,this.ia=void 0,A&&A.longPollingTimeout&&A.longPollingTimeout>0&&(this.ia=A.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Hr.prototype,t.ka=8,t.I=1,t.connect=function(A,K,ae,we){zt(0),this.W=A,this.H=K||{},ae&&we!==void 0&&(this.H.OSID=ae,this.H.OAID=we),this.F=this.X,this.J=Tt(this,null,this.W),Un(this)};function Xr(A){if(Qr(A),A.I==3){var K=A.V++,ae=xs(A.J);if(an(ae,"SID",A.M),an(ae,"RID",K),an(ae,"TYPE","terminate"),Rn(A,ae),K=new Me(A,A.j,K),K.M=2,K.A=ho(xs(ae)),ae=!1,o.navigator&&o.navigator.sendBeacon)try{ae=o.navigator.sendBeacon(K.A.toString(),"")}catch{}!ae&&o.Image&&(new Image().src=K.A,ae=!0),ae||(K.g=or(K.j,null),K.g.ea(K.A)),K.F=Date.now(),Ts(K)}bt(A)}function Cn(A){A.g&&(Ga(A),A.g.cancel(),A.g=null)}function Qr(A){Cn(A),A.v&&(o.clearTimeout(A.v),A.v=null),ue(A),A.h.cancel(),A.m&&(typeof A.m=="number"&&o.clearTimeout(A.m),A.m=null)}function Un(A){if(!Gs(A.h)&&!A.m){A.m=!0;var K=A.Ea;O||T(),B||(O(),B=!0),S.add(K,A),A.D=0}}function Us(A,K){return Xi(A.h)>=A.h.j-(A.m?1:0)?!1:A.m?(A.i=K.G.concat(A.i),!0):A.I==1||A.I==2||A.D>=(A.Sa?0:A.Ta)?!1:(A.m=qt(u(A.Ea,A,K),Oe(A,A.D)),A.D++,!0)}t.Ea=function(A){if(this.m)if(this.m=null,this.I==1){if(!A){this.V=Math.floor(Math.random()*1e5),A=this.V++;const We=new Me(this,this.j,A);let nt=this.o;if(this.U&&(nt?(nt=q(nt),W(nt,this.U)):nt=this.U),this.u!==null||this.R||(We.J=nt,nt=null),this.S)e:{for(var K=0,ae=0;ae<this.i.length;ae++){t:{var we=this.i[ae];if("__data__"in we.map&&(we=we.map.__data__,typeof we=="string")){we=we.length;break t}we=void 0}if(we===void 0)break;if(K+=we,K>4096){K=ae;break e}if(K===4096||ae===this.i.length-1){K=ae+1;break e}}K=1e3}else K=1e3;K=Wn(this,We,K),ae=xs(this.J),an(ae,"RID",A),an(ae,"CVER",22),this.G&&an(ae,"X-HTTP-Session-Id",this.G),Rn(this,ae),nt&&(this.R?K="headers="+Qt(ys(nt))+"&"+K:this.u&&Fo(ae,this.u,nt)),Pi(this.h,We),this.Ra&&an(ae,"TYPE","init"),this.S?(an(ae,"$req",K),an(ae,"SID","null"),We.U=!0,Rr(We,ae,null)):Rr(We,ae,K),this.I=2}}else this.I==3&&(A?ss(this,A):this.i.length==0||Gs(this.h)||ss(this))};function ss(A,K){var ae;K?ae=K.l:ae=A.V++;const we=xs(A.J);an(we,"SID",A.M),an(we,"RID",ae),an(we,"AID",A.K),Rn(A,we),A.u&&A.o&&Fo(we,A.u,A.o),ae=new Me(A,A.j,ae,A.D+1),A.u===null&&(ae.J=A.o),K&&(A.i=K.G.concat(A.i)),K=Wn(A,ae,1e3),ae.H=Math.round(A.va*.5)+Math.round(A.va*.5*Math.random()),Pi(A.h,ae),Rr(ae,we,K)}function Rn(A,K){A.H&&se(A.H,function(ae,we){an(K,we,ae)}),A.l&&se({},function(ae,we){an(K,we,ae)})}function Wn(A,K,ae){ae=Math.min(A.i.length,ae);const we=A.l?u(A.l.Ka,A.l,A):null;e:{var We=A.i;let Vr=-1;for(;;){const ws=["count="+ae];Vr==-1?ae>0?(Vr=We[0].g,ws.push("ofs="+Vr)):Vr=0:ws.push("ofs="+Vr);let un=!0;for(let Gn=0;Gn<ae;Gn++){var nt=We[Gn].g;const ca=We[Gn].map;if(nt-=Vr,nt<0)Vr=Math.max(0,We[Gn].g-100),un=!1;else try{nt="req"+nt+"_"||"";try{var Ht=ca instanceof Map?ca:Object.entries(ca);for(const[ka,cs]of Ht){let _a=cs;l(cs)&&(_a=ot(cs)),ws.push(nt+ka+"="+encodeURIComponent(_a))}}catch(ka){throw ws.push(nt+"type="+encodeURIComponent("_badmap")),ka}}catch{we&&we(ca)}}if(un){Ht=ws.join("&");break e}}Ht=void 0}return A=A.i.splice(0,ae),K.G=A,Ht}function Wa(A){if(!A.g&&!A.v){A.Y=1;var K=A.Da;O||T(),B||(O(),B=!0),S.add(K,A),A.A=0}}function Ys(A){return A.g||A.v||A.A>=3?!1:(A.Y++,A.v=qt(u(A.Da,A),Oe(A,A.A)),A.A++,!0)}t.Da=function(){if(this.v=null,z(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var A=4*this.T;this.j.info("BP detection timer enabled: "+A),this.B=qt(u(this.Wa,this),A)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),Cn(this),z(this))};function Ga(A){A.B!=null&&(o.clearTimeout(A.B),A.B=null)}function z(A){A.g=new Me(A,A.j,"rpc",A.Y),A.u===null&&(A.g.J=A.o),A.g.P=0;var K=xs(A.na);an(K,"RID","rpc"),an(K,"SID",A.M),an(K,"AID",A.K),an(K,"CI",A.F?"0":"1"),!A.F&&A.ia&&an(K,"TO",A.ia),an(K,"TYPE","xmlhttp"),Rn(A,K),A.u&&A.o&&Fo(K,A.u,A.o),A.O&&(A.g.H=A.O);var ae=A.g;A=A.ba,ae.M=1,ae.A=ho(xs(K)),ae.u=null,ae.R=!0,Kr(ae,A)}t.Va=function(){this.C!=null&&(this.C=null,Cn(this),Ys(this),zt(19))};function ue(A){A.C!=null&&(o.clearTimeout(A.C),A.C=null)}function _e(A,K){var ae=null;if(A.g==K){ue(A),Ga(A),A.g=null;var we=2}else if(Li(A.h,K))ae=K.G,Bo(A.h,K),we=1;else return;if(A.I!=0){if(K.o)if(we==1){ae=K.u?K.u.length:0,K=Date.now()-K.F;var We=A.D;we=Jt(),Ye(we,new Wt(we,ae)),Un(A)}else Wa(A);else if(We=K.m,We==3||We==0&&K.X>0||!(we==1&&Us(A,K)||we==2&&Ys(A)))switch(ae&&ae.length>0&&(K=A.h,K.i=K.i.concat(ae)),We){case 1:ze(A,5);break;case 4:ze(A,10);break;case 3:ze(A,6);break;default:ze(A,2)}}}function Oe(A,K){let ae=A.Qa+Math.floor(Math.random()*A.Za);return A.isActive()||(ae*=2),ae*K}function ze(A,K){if(A.j.info("Error code "+K),K==2){var ae=u(A.bb,A),we=A.Ua;const We=!we;we=new oi(we||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Yr(we,"https"),ho(we),We?la(we.toString(),ae):ls(we.toString(),ae)}else zt(2);A.I=0,A.l&&A.l.pa(K),bt(A),Qr(A)}t.bb=function(A){A?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function bt(A){if(A.I=0,A.ja=[],A.l){const K=_l(A.h);(K.length!=0||A.i.length!=0)&&(b(A.ja,K),b(A.ja,A.i),A.h.i.length=0,g(A.i),A.i.length=0),A.l.oa()}}function Tt(A,K,ae){var we=ae instanceof oi?xs(ae):new oi(ae);if(we.g!="")K&&(we.g=K+"."+we.g),Na(we,we.u);else{var We=o.location;we=We.protocol,K=K?K+"."+We.hostname:We.hostname,We=+We.port;const nt=new oi(null);we&&Yr(nt,we),K&&(nt.g=K),We&&Na(nt,We),ae&&(nt.h=ae),we=nt}return ae=A.G,K=A.wa,ae&&K&&an(we,ae,K),an(we,"VER",A.ka),Rn(A,we),we}function or(A,K,ae){if(K&&!A.L)throw Error("Can't create secondary domain capable XhrIo object.");return K=A.Aa&&!A.ma?new rn(new mr({ab:ae})):new rn(A.ma),K.Fa(A.L),K}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function hr(){}t=hr.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ir(){}Ir.prototype.g=function(A,K){return new Sr(A,K)};function Sr(A,K){Ne.call(this),this.g=new Hr(K),this.l=A,this.h=K&&K.messageUrlParams||null,A=K&&K.messageHeaders||null,K&&K.clientProtocolHeaderRequired&&(A?A["X-Client-Protocol"]="webchannel":A={"X-Client-Protocol":"webchannel"}),this.g.o=A,A=K&&K.initMessageHeaders||null,K&&K.messageContentType&&(A?A["X-WebChannel-Content-Type"]=K.messageContentType:A={"X-WebChannel-Content-Type":K.messageContentType}),K&&K.sa&&(A?A["X-WebChannel-Client-Profile"]=K.sa:A={"X-WebChannel-Client-Profile":K.sa}),this.g.U=A,(A=K&&K.Qb)&&!R(A)&&(this.g.u=A),this.A=K&&K.supportsCrossDomainXhr||!1,this.v=K&&K.sendRawJson||!1,(K=K&&K.httpSessionIdParam)&&!R(K)&&(this.g.G=K,A=this.h,A!==null&&K in A&&(A=this.h,K in A&&delete A[K])),this.j=new is(this)}p(Sr,Ne),Sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sr.prototype.close=function(){Xr(this.g)},Sr.prototype.o=function(A){var K=this.g;if(typeof A=="string"){var ae={};ae.__data__=A,A=ae}else this.v&&(ae={},ae.__data__=ot(A),A=ae);K.i.push(new os(K.Ya++,A)),K.I==3&&Un(K)},Sr.prototype.N=function(){this.g.l=null,delete this.j,Xr(this.g),delete this.g,Sr.Z.N.call(this)};function pn(A){qe.call(this),A.__headers__&&(this.headers=A.__headers__,this.statusCode=A.__status__,delete A.__headers__,delete A.__status__);var K=A.__sm__;if(K){e:{for(const ae in K){A=ae;break e}A=void 0}(this.i=A)&&(A=this.i,K=K!==null&&A in K?K[A]:void 0),this.data=K}else this.data=A}p(pn,qe);function vs(){rt.call(this),this.status=1}p(vs,rt);function is(A){this.g=A}p(is,hr),is.prototype.ra=function(){Ye(this.g,"a")},is.prototype.qa=function(A){Ye(this.g,new pn(A))},is.prototype.pa=function(A){Ye(this.g,new vs)},is.prototype.oa=function(){Ye(this.g,"b")},Ir.prototype.createWebChannel=Ir.prototype.g,Sr.prototype.send=Sr.prototype.o,Sr.prototype.open=Sr.prototype.m,Sr.prototype.close=Sr.prototype.close,pK=function(){return new Ir},fK=function(){return Jt()},hK=Ot,$6={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,U5=Ae,et.COMPLETE="complete",dK=et,Ut.EventType=jt,jt.OPEN="a",jt.CLOSE="b",jt.ERROR="c",jt.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,Gy=Ut,rn.prototype.listenOnce=rn.prototype.K,rn.prototype.getLastError=rn.prototype.Ha,rn.prototype.getLastErrorCode=rn.prototype.ya,rn.prototype.getStatus=rn.prototype.ca,rn.prototype.getResponseJson=rn.prototype.La,rn.prototype.getResponseText=rn.prototype.la,rn.prototype.send=rn.prototype.ea,rn.prototype.setWithCredentials=rn.prototype.Fa,uK=rn}).apply(typeof kw<"u"?kw:typeof self<"u"?self:typeof window<"u"?window:{});const eD="@firebase/firestore",tD="4.9.3";let Eo=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Eo.UNAUTHENTICATED=new Eo(null),Eo.GOOGLE_CREDENTIALS=new Eo("google-credentials-uid"),Eo.FIRST_PARTY=new Eo("first-party-uid"),Eo.MOCK_USER=new Eo("mock-user");let db="12.7.0";const em=new U8("@firebase/firestore");function Wg(){return em.logLevel}function Xt(t,...e){if(em.logLevel<=Sn.DEBUG){const r=e.map(tI);em.debug(`Firestore (${db}): ${t}`,...r)}}function mc(t,...e){if(em.logLevel<=Sn.ERROR){const r=e.map(tI);em.error(`Firestore (${db}): ${t}`,...r)}}function C4(t,...e){if(em.logLevel<=Sn.WARN){const r=e.map(tI);em.warn(`Firestore (${db}): ${t}`,...r)}}function tI(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function Mr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,mK(t,n,r)}function mK(t,e,r){let n=`FIRESTORE (${db}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw mc(n),new Error(n)}function qr(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||mK(e,i,n)}function ii(t,e){return t}const Mt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Nr extends Gd{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class $p{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class gK{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zfe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Eo.UNAUTHENTICATED)))}shutdown(){}}class qfe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class Vfe{constructor(e){this.t=e,this.currentUser=Eo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){qr(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new $p;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new $p,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const c=a;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},l=c=>{Xt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Xt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new $p)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Xt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(qr(typeof n.accessToken=="string",31837,{l:n}),new gK(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qr(e===null||typeof e=="string",2055,{h:e}),new Eo(e)}}class Hfe{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Eo.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Wfe{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Hfe(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Eo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class rD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Gfe{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gl(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){qr(this.o===void 0,3512);const n=a=>{a.error!=null&&Xt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Xt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const i=a=>{Xt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Xt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new rD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(qr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new rD(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Kfe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class xK{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Kfe(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function gn(t,e){return t<e?-1:t>e?1:0}function F6(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return r3(i)===r3(a)?gn(i,a):r3(i)?1:-1}return gn(t.length,e.length)}const Yfe=55296,Xfe=57343;function r3(t){const e=t.charCodeAt(0);return e>=Yfe&&e<=Xfe}function Lx(t,e,r){return t.length===e.length&&t.every(((n,i)=>r(n,e[i])))}function bK(t){return t+"\0"}const nD="__name__";class Nd{constructor(e,r,n){r===void 0?r=0:r>e.length&&Mr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Mr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Nd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Nd?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=Nd.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return gn(e.length,r.length)}static compareSegments(e,r){const n=Nd.isNumericId(e),i=Nd.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Nd.extractNumericId(e).compare(Nd.extractNumericId(r)):F6(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return eI.fromString(e.substring(4,e.length-2))}}class xi extends Nd{construct(e,r,n){return new xi(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Nr(Mt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((i=>i.length>0)))}return new xi(r)}static emptyPath(){return new xi([])}}const Qfe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sa extends Nd{construct(e,r,n){return new sa(e,r,n)}static isValidIdentifier(e){return Qfe.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sa.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nD}static keyField(){return new sa([nD])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Nr(Mt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Nr(Mt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Nr(Mt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(a(),i++)}if(a(),o)throw new Nr(Mt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sa(r)}static emptyPath(){return new sa([])}}class yr{constructor(e){this.path=e}static fromPath(e){return new yr(xi.fromString(e))}static fromName(e){return new yr(xi.fromString(e).popFirst(5))}static empty(){return new yr(xi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return xi.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new yr(new xi(e.slice()))}}function Jfe(t,e,r,n){if(e===!0&&n===!0)throw new Nr(Mt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Zfe(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function e0e(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Mr(12329,{type:typeof t})}function yK(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Nr(Mt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=e0e(t);throw new Nr(Mt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function xa(t,e){const r={typeString:t};return e&&(r.value=e),r}function D1(t,e){if(!Zfe(t))throw new Nr(Mt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(i&&typeof o!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Nr(Mt.INVALID_ARGUMENT,r);return!0}const sD=-62135596800,iD=1e6;class Ai{static now(){return Ai.fromMillis(Date.now())}static fromDate(e){return Ai.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*iD);return new Ai(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Nr(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Nr(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<sD)throw new Nr(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Nr(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iD}_compareTo(e){return this.seconds===e.seconds?gn(this.nanoseconds,e.nanoseconds):gn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ai._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(D1(e,Ai._jsonSchema))return new Ai(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ai._jsonSchemaVersion="firestore/timestamp/1.0",Ai._jsonSchema={type:xa("string",Ai._jsonSchemaVersion),seconds:xa("number"),nanoseconds:xa("number")};class Fn{static fromTimestamp(e){return new Fn(e)}static min(){return new Fn(new Ai(0,0))}static max(){return new Fn(new Ai(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ov=-1;class PN{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}}function U6(t){return t.fields.find((e=>e.kind===2))}function mp(t){return t.fields.filter((e=>e.kind!==2))}PN.UNKNOWN_ID=-1;class z5{constructor(e,r){this.fieldPath=e,this.kind=r}}class Rv{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Rv(0,kc.min())}}function t0e(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Fn.fromTimestamp(n===1e9?new Ai(r+1,0):new Ai(r,n));return new kc(i,yr.empty(),e)}function vK(t){return new kc(t.readTime,t.key,Ov)}class kc{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new kc(Fn.min(),yr.empty(),Ov)}static max(){return new kc(Fn.max(),yr.empty(),Ov)}}function rI(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=yr.comparator(t.documentKey,e.documentKey),r!==0?r:gn(t.largestBatchId,e.largestBatchId))}const wK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NK{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function E4(t){if(t.code!==Mt.FAILED_PRECONDITION||t.message!==wK)throw t;Xt("LocalStore","Unexpectedly lost primary lease")}class st{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Mr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new st(((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof st?r:st.resolve(r)}catch(r){return st.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):st.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):st.reject(r)}static resolve(e){return new st(((r,n)=>{r(e)}))}static reject(e){return new st(((r,n)=>{n(e)}))}static waitFor(e){return new st(((r,n)=>{let i=0,a=0,o=!1;e.forEach((l=>{++i,l.next((()=>{++a,o&&a===i&&r()}),(c=>n(c)))})),o=!0,a===i&&r()}))}static or(e){let r=st.resolve(!1);for(const n of e)r=r.next((i=>i?st.resolve(i):n()));return r}static forEach(e,r){const n=[];return e.forEach(((i,a)=>{n.push(r.call(this,i,a))})),this.waitFor(n)}static mapArray(e,r){return new st(((n,i)=>{const a=e.length,o=new Array(a);let l=0;for(let c=0;c<a;c++){const u=c;r(e[u]).next((h=>{o[u]=h,++l,l===a&&n(o)}),(h=>i(h)))}}))}static doWhile(e,r){return new st(((n,i)=>{const a=()=>{e()===!0?r().next((()=>{a()}),i):n()};a()}))}}const fc="SimpleDb";class A4{static open(e,r,n,i){try{return new A4(r,e.transaction(i,n))}catch(a){throw new ov(r,a)}}constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.S=new $p,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{r.error?this.S.reject(new ov(e,r.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=nI(n.target.error);this.S.reject(new ov(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Xt(fc,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new n0e(r)}}class j0{static delete(e){return Xt(fc,"Removing database:",e),jp(mG().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!kG())return!1;if(j0.F())return!0;const e=$a(),r=j0.M(e),n=0<r&&r<10,i=jK(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,r){return e.store(r)}static M(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,r,n){this.name=e,this.version=r,this.N=n,this.B=null,j0.M($a())===12.2&&mc("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Xt(fc,"Opening database:",this.name),this.db=await new Promise(((r,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;r(o)},i.onblocked=()=>{n(new ov(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?n(new Nr(Mt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Nr(Mt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new ov(e,o))},i.onupgradeneeded=a=>{Xt(fc,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Xt(fc,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=r=>this.q(r)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,i){const a=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=A4.open(this.db,e,a?"readonly":"readwrite",n),c=i(l).next((u=>(l.C(),u))).catch((u=>(l.abort(u),st.reject(u)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Xt(fc,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function jK(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class r0e{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return jp(this.U.delete())}}class ov extends Nr{constructor(e,r){super(Mt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Im(t){return t.name==="IndexedDbTransactionError"}class n0e{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Xt(fc,"PUT",this.store.name,e,r),n=this.store.put(r,e)):(Xt(fc,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),jp(n)}add(e){return Xt(fc,"ADD",this.store.name,e,e),jp(this.store.add(e))}get(e){return jp(this.store.get(e)).next((r=>(r===void 0&&(r=null),Xt(fc,"GET",this.store.name,e,r),r)))}delete(e){return Xt(fc,"DELETE",this.store.name,e),jp(this.store.delete(e))}count(){return Xt(fc,"COUNT",this.store.name),jp(this.store.count())}J(e,r){const n=this.options(e,r),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(n.range);return new st(((o,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{o(c.target.result)}}))}{const a=this.cursor(n),o=[];return this.H(a,((l,c)=>{o.push(c)})).next((()=>o))}}Y(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new st(((i,a)=>{n.onerror=o=>{a(o.target.error)},n.onsuccess=o=>{i(o.target.result)}}))}Z(e,r){Xt(fc,"DELETE ALL",this.store.name);const n=this.options(e,r);n.X=!1;const i=this.cursor(n);return this.H(i,((a,o,l)=>l.delete()))}ee(e,r){let n;r?n=e:(n={},r=e);const i=this.cursor(n);return this.H(i,r)}te(e){const r=this.cursor({});return new st(((n,i)=>{r.onerror=a=>{const o=nI(a.target.error);i(o)},r.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():n()})):n()}}))}H(e,r){const n=[];return new st(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const c=new r0e(l),u=r(l.primaryKey,l.value,c);if(u instanceof st){const h=u.catch((p=>(c.done(),st.reject(p))));n.push(h)}c.isDone?i():c.G===null?l.continue():l.continue(c.G)}})).next((()=>st.waitFor(n)))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function jp(t){return new st(((e,r)=>{t.onsuccess=n=>{const i=n.target.result;e(i)},t.onerror=n=>{const i=nI(n.target.error);r(i)}}))}let aD=!1;function nI(t){const e=j0.M($a());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Nr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return aD||(aD=!0,setTimeout((()=>{throw n}),0)),n}}return t}const lv="IndexBackfiller";class s0e{constructor(e,r){this.asyncQueue=e,this.ne=r,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Xt(lv,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const r=await this.ne.ie();Xt(lv,`Documents written: ${r}`)}catch(r){Im(r)?Xt(lv,"Ignoring IndexedDB error during index backfill: ",r):await E4(r)}await this.re(6e4)}))}}class i0e{constructor(e,r){this.localStore=e,this.persistence=r}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(r=>this.se(r,e)))}se(e,r){const n=new Set;let i=r,a=!0;return st.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!n.has(o))return Xt(lv,`Processing collection: ${o}`),this.oe(e,o,i).next((l=>{i-=l,n.add(o)}));a=!1})))).next((()=>r-i))}oe(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next((i=>this.localStore.localDocuments.getNextDocuments(e,r,i,n).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((l=>(Xt(lv,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l)))).next((()=>o.size))}))))}_e(e,r){let n=e;return r.changes.forEach(((i,a)=>{const o=vK(a);rI(o,n)>0&&(n=o)})),new kc(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}class Ru{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ru.ce=-1;const Fp=-1;function T4(t){return t==null}function ON(t){return t===0&&1/t==-1/0}const RN="";function fl(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=oD(e)),e=a0e(t.get(r),e);return oD(e)}function a0e(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case RN:r+="";break;default:r+=a}}return r}function oD(t){return t+RN+""}function kd(t){const e=t.length;if(qr(e>=2,64408,{path:t}),e===2)return qr(t.charAt(0)===RN&&t.charAt(1)==="",56145,{path:t}),xi.emptyPath();const r=e-2,n=[];let i="";for(let a=0;a<e;){const o=t.indexOf(RN,a);switch((o<0||o>r)&&Mr(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(a,o);let c;i.length===0?c=l:(i+=l,c=i,i=""),n.push(c);break;case"":i+=t.substring(a,o),i+="\0";break;case"":i+=t.substring(a,o+1);break;default:Mr(61167,{path:t})}a=o+2}return new xi(n)}const gp="remoteDocuments",B1="owner",Tg="owner",Mv="mutationQueues",o0e="userId",Su="mutations",lD="batchId",Ip="userMutationsIndex",cD=["userId","batchId"];function q5(t,e){return[t,fl(e)]}function kK(t,e,r){return[t,fl(e),r]}const l0e={},Px="documentMutations",MN="remoteDocumentsV14",c0e=["prefixPath","collectionGroup","readTime","documentId"],V5="documentKeyIndex",u0e=["prefixPath","collectionGroup","documentId"],_K="collectionGroupIndex",d0e=["collectionGroup","readTime","prefixPath","documentId"],Dv="remoteDocumentGlobal",z6="remoteDocumentGlobalKey",Ox="targets",SK="queryTargetsIndex",h0e=["canonicalId","targetId"],Rx="targetDocuments",f0e=["targetId","path"],sI="documentTargetsIndex",p0e=["path","targetId"],DN="targetGlobalKey",Up="targetGlobal",Bv="collectionParents",m0e=["collectionId","parent"],Mx="clientMetadata",g0e="clientId",I4="bundles",x0e="bundleId",L4="namedQueries",b0e="name",iI="indexConfiguration",y0e="indexId",q6="collectionGroupIndex",v0e="collectionGroup",cv="indexState",w0e=["indexId","uid"],CK="sequenceNumberIndex",N0e=["uid","sequenceNumber"],uv="indexEntries",j0e=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],EK="documentKeyIndex",k0e=["indexId","uid","orderedDocumentKey"],P4="documentOverlays",_0e=["userId","collectionPath","documentId"],V6="collectionPathOverlayIndex",S0e=["userId","collectionPath","largestBatchId"],AK="collectionGroupOverlayIndex",C0e=["userId","collectionGroup","largestBatchId"],aI="globals",E0e="name",TK=[Mv,Su,Px,gp,Ox,B1,Up,Rx,Mx,Dv,Bv,I4,L4],A0e=[...TK,P4],IK=[Mv,Su,Px,MN,Ox,B1,Up,Rx,Mx,Dv,Bv,I4,L4,P4],LK=IK,oI=[...LK,iI,cv,uv],T0e=oI,PK=[...oI,aI],I0e=PK;class H6 extends NK{constructor(e,r){super(),this.le=e,this.currentSequenceNumber=r}}function Fa(t,e){const r=ii(t);return j0.O(r.le,e)}function uD(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function lI(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function L0e(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Yl{constructor(e,r){this.comparator=e,this.root=r||Ao.EMPTY}insert(e,r){return new Yl(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ao.BLACK,null,null))}remove(e){return new Yl(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ao.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _w(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _w(this.root,e,this.comparator,!1)}getReverseIterator(){return new _w(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _w(this.root,e,this.comparator,!0)}}class _w{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ao{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Ao.RED,this.left=i??Ao.EMPTY,this.right=a??Ao.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Ao(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ao.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Ao.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ao.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ao.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Mr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Mr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Mr(27949);return e+(this.isRed()?0:1)}}Ao.EMPTY=null,Ao.RED=!0,Ao.BLACK=!1;Ao.EMPTY=new class{constructor(){this.size=0}get key(){throw Mr(57766)}get value(){throw Mr(16141)}get color(){throw Mr(16727)}get left(){throw Mr(29726)}get right(){throw Mr(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Ao(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bs{constructor(e){this.comparator=e,this.data=new Yl(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new dD(this.data.getIterator())}getIteratorFrom(e){return new dD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Bs)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Bs(this.comparator);return r.data=e,r}}class dD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ig(t){return t.hasNext()?t.getNext():void 0}class Oh{constructor(e){this.fields=e,e.sort(sa.comparator)}static empty(){return new Oh([])}unionWith(e){let r=new Bs(sa.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Oh(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Lx(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class P0e extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xl{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new P0e("Invalid base64 string: "+a):a}})(e);return new Xl(r)}static fromUint8Array(e){const r=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Xl(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return gn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xl.EMPTY_BYTE_STRING=new Xl("");const O0e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function I0(t){if(qr(!!t,39018),typeof t=="string"){let e=0;const r=O0e.exec(t);if(qr(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ma(t.seconds),nanos:ma(t.nanos)}}function ma(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Dx(t){return typeof t=="string"?Xl.fromBase64String(t):Xl.fromUint8Array(t)}const OK="server_timestamp",RK="__type__",MK="__previous_value__",DK="__local_write_time__";function cI(t){return(t?.mapValue?.fields||{})[RK]?.stringValue===OK}function BK(t){const e=t.mapValue.fields[MK];return cI(e)?BK(e):e}function BN(t){const e=I0(t.mapValue.fields[DK].timestampValue);return new Ai(e.seconds,e.nanos)}class R0e{constructor(e,r,n,i,a,o,l,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const $N="(default)";class Bx{constructor(e,r){this.projectId=e,this.database=r||$N}static empty(){return new Bx("","")}get isDefaultDatabase(){return this.database===$N}isEqual(e){return e instanceof Bx&&e.projectId===this.projectId&&e.database===this.database}}const $K="__type__",FK="__max__",g0={mapValue:{fields:{__type__:{stringValue:FK}}}},UK="__vector__",FN="value",H5={nullValue:"NULL_VALUE"};function $x(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cI(t)?4:zK(t)?9007199254740991:O4(t)?10:11:Mr(28295,{value:t})}function Dd(t,e){if(t===e)return!0;const r=$x(t);if(r!==$x(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return BN(t).isEqual(BN(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=I0(i.timestampValue),l=I0(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,a){return Dx(i.bytesValue).isEqual(Dx(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,a){return ma(i.geoPointValue.latitude)===ma(a.geoPointValue.latitude)&&ma(i.geoPointValue.longitude)===ma(a.geoPointValue.longitude)})(t,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return ma(i.integerValue)===ma(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=ma(i.doubleValue),l=ma(a.doubleValue);return o===l?ON(o)===ON(l):isNaN(o)&&isNaN(l)}return!1})(t,e);case 9:return Lx(t.arrayValue.values||[],e.arrayValue.values||[],Dd);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},l=a.mapValue.fields||{};if(uD(o)!==uD(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Dd(o[c],l[c])))return!1;return!0})(t,e);default:return Mr(52216,{left:t})}}function $v(t,e){return(t.values||[]).find((r=>Dd(r,e)))!==void 0}function L0(t,e){if(t===e)return 0;const r=$x(t),n=$x(e);if(r!==n)return gn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return gn(t.booleanValue,e.booleanValue);case 2:return(function(a,o){const l=ma(a.integerValue||a.doubleValue),c=ma(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(t,e);case 3:return hD(t.timestampValue,e.timestampValue);case 4:return hD(BN(t),BN(e));case 5:return F6(t.stringValue,e.stringValue);case 6:return(function(a,o){const l=Dx(a),c=Dx(o);return l.compareTo(c)})(t.bytesValue,e.bytesValue);case 7:return(function(a,o){const l=a.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=gn(l[u],c[u]);if(h!==0)return h}return gn(l.length,c.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,o){const l=gn(ma(a.latitude),ma(o.latitude));return l!==0?l:gn(ma(a.longitude),ma(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return fD(t.arrayValue,e.arrayValue);case 10:return(function(a,o){const l=a.fields||{},c=o.fields||{},u=l[FN]?.arrayValue,h=c[FN]?.arrayValue,p=gn(u?.values?.length||0,h?.values?.length||0);return p!==0?p:fD(u,h)})(t.mapValue,e.mapValue);case 11:return(function(a,o){if(a===g0.mapValue&&o===g0.mapValue)return 0;if(a===g0.mapValue)return 1;if(o===g0.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=F6(c[p],h[p]);if(m!==0)return m;const g=L0(l[c[p]],u[h[p]]);if(g!==0)return g}return gn(c.length,h.length)})(t.mapValue,e.mapValue);default:throw Mr(23264,{he:r})}}function hD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return gn(t,e);const r=I0(t),n=I0(e),i=gn(r.seconds,n.seconds);return i!==0?i:gn(r.nanos,n.nanos)}function fD(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=L0(r[i],n[i]);if(a)return a}return gn(r.length,n.length)}function Fx(t){return W6(t)}function W6(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=I0(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Dx(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return yr.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=W6(a);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const o of n)a?a=!1:i+=",",i+=`${o}:${W6(r.fields[o])}`;return i+"}"})(t.mapValue):Mr(61005,{value:t})}function uI(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function G6(t){return!!t&&"integerValue"in t}function Fv(t){return!!t&&"arrayValue"in t}function pD(t){return!!t&&"nullValue"in t}function mD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function n3(t){return!!t&&"mapValue"in t}function O4(t){return(t?.mapValue?.fields||{})[$K]?.stringValue===UK}function dv(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return lI(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=dv(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=dv(t.arrayValue.values[r]);return e}return{...t}}function zK(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===FK}const qK={mapValue:{fields:{[$K]:{stringValue:UK},[FN]:{arrayValue:{}}}}};function M0e(t){return"nullValue"in t?H5:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?uI(Bx.empty(),yr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?O4(t)?qK:{mapValue:{}}:Mr(35942,{value:t})}function D0e(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?uI(Bx.empty(),yr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?qK:"mapValue"in t?O4(t)?{mapValue:{}}:g0:Mr(61959,{value:t})}function gD(t,e){const r=L0(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function xD(t,e){const r=L0(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Au{constructor(e){this.value=e}static empty(){return new Au({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!n3(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=dv(r)}setAll(e){let r=sa.emptyPath(),n={},i=[];e.forEach(((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}o?n[l.lastSegment()]=dv(o):i.push(l.lastSegment())}));const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());n3(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Dd(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];n3(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){lI(r,((i,a)=>e[i]=a));for(const i of n)delete e[i]}clone(){return new Au(dv(this.value))}}class To{constructor(e,r,n,i,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new To(e,0,Fn.min(),Fn.min(),Fn.min(),Au.empty(),0)}static newFoundDocument(e,r,n,i){return new To(e,1,r,Fn.min(),n,i,0)}static newNoDocument(e,r){return new To(e,2,r,Fn.min(),Fn.min(),Au.empty(),0)}static newUnknownDocument(e,r){return new To(e,3,r,Fn.min(),Fn.min(),Au.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Fn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Au.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Au.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof To&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new To(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ux{constructor(e,r){this.position=e,this.inclusive=r}}function bD(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?n=yr.comparator(yr.fromName(o.referenceValue),r.key):n=L0(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function yD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Dd(t.position[r],e.position[r]))return!1;return!0}class UN{constructor(e,r="asc"){this.field=e,this.dir=r}}function B0e(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class VK{}class On extends VK{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new $0e(e,r,n):r==="array-contains"?new z0e(e,n):r==="in"?new XK(e,n):r==="not-in"?new q0e(e,n):r==="array-contains-any"?new V0e(e,n):new On(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new F0e(e,n):new U0e(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(L0(r,this.value)):r!==null&&$x(this.value)===$x(r)&&this.matchesComparison(L0(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Mr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends VK{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Es(e,r)}matches(e){return zx(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zx(t){return t.op==="and"}function K6(t){return t.op==="or"}function dI(t){return HK(t)&&zx(t)}function HK(t){for(const e of t.filters)if(e instanceof Es)return!1;return!0}function Y6(t){if(t instanceof On)return t.field.canonicalString()+t.op.toString()+Fx(t.value);if(dI(t))return t.filters.map((e=>Y6(e))).join(",");{const e=t.filters.map((r=>Y6(r))).join(",");return`${t.op}(${e})`}}function WK(t,e){return t instanceof On?(function(n,i){return i instanceof On&&n.op===i.op&&n.field.isEqual(i.field)&&Dd(n.value,i.value)})(t,e):t instanceof Es?(function(n,i){return i instanceof Es&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((a,o,l)=>a&&WK(o,i.filters[l])),!0):!1})(t,e):void Mr(19439)}function GK(t,e){const r=t.filters.concat(e);return Es.create(r,t.op)}function KK(t){return t instanceof On?(function(r){return`${r.field.canonicalString()} ${r.op} ${Fx(r.value)}`})(t):t instanceof Es?(function(r){return r.op.toString()+" {"+r.getFilters().map(KK).join(" ,")+"}"})(t):"Filter"}class $0e extends On{constructor(e,r,n){super(e,r,n),this.key=yr.fromName(n.referenceValue)}matches(e){const r=yr.comparator(e.key,this.key);return this.matchesComparison(r)}}class F0e extends On{constructor(e,r){super(e,"in",r),this.keys=YK("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class U0e extends On{constructor(e,r){super(e,"not-in",r),this.keys=YK("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function YK(t,e){return(e.arrayValue?.values||[]).map((r=>yr.fromName(r.referenceValue)))}class z0e extends On{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Fv(r)&&$v(r.arrayValue,this.value)}}class XK extends On{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&$v(this.value.arrayValue,r)}}class q0e extends On{constructor(e,r){super(e,"not-in",r)}matches(e){if($v(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!$v(this.value.arrayValue,r)}}class V0e extends On{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Fv(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>$v(this.value.arrayValue,n)))}}class H0e{constructor(e,r=null,n=[],i=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=o,this.endAt=l,this.Te=null}}function X6(t,e=null,r=[],n=[],i=null,a=null,o=null){return new H0e(t,e,r,n,i,a,o)}function tm(t){const e=ii(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Y6(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),T4(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Fx(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Fx(n))).join(",")),e.Te=r}return e.Te}function $1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!B0e(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!WK(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yD(t.startAt,e.startAt)&&yD(t.endAt,e.endAt)}function W0e(t){return yr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function zN(t,e){return t.filters.filter((r=>r instanceof On&&r.field.isEqual(e)))}function vD(t,e,r){let n=H5,i=!0;for(const a of zN(t,e)){let o=H5,l=!0;switch(a.op){case"<":case"<=":o=M0e(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,l=!1;break;case"!=":case"not-in":o=H5}gD({value:n,inclusive:i},{value:o,inclusive:l})<0&&(n=o,i=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];gD({value:n,inclusive:i},{value:o,inclusive:r.inclusive})<0&&(n=o,i=r.inclusive);break}}return{value:n,inclusive:i}}function wD(t,e,r){let n=g0,i=!0;for(const a of zN(t,e)){let o=g0,l=!0;switch(a.op){case">=":case">":o=D0e(a.value),l=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,l=!1;break;case"!=":case"not-in":o=g0}xD({value:n,inclusive:i},{value:o,inclusive:l})>0&&(n=o,i=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];xD({value:n,inclusive:i},{value:o,inclusive:r.inclusive})>0&&(n=o,i=r.inclusive);break}}return{value:n,inclusive:i}}class R4{constructor(e,r=null,n=[],i=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function G0e(t,e,r,n,i,a,o,l){return new R4(t,e,r,n,i,a,o,l)}function QK(t){return new R4(t)}function ND(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function K0e(t){return t.collectionGroup!==null}function hv(t){const e=ii(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Bs(sa.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(l=l.add(u.field))}))})),l})(e).forEach((a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new UN(a,n))})),r.has(sa.keyField().canonicalString())||e.Ie.push(new UN(sa.keyField(),n))}return e.Ie}function Uh(t){const e=ii(t);return e.Ee||(e.Ee=Y0e(e,hv(t))),e.Ee}function Y0e(t,e){if(t.limitType==="F")return X6(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new UN(i.field,a)}));const r=t.endAt?new Ux(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ux(t.startAt.position,t.startAt.inclusive):null;return X6(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Q6(t,e,r){return new R4(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function JK(t,e){return $1(Uh(t),Uh(e))&&t.limitType===e.limitType}function ZK(t){return`${tm(Uh(t))}|lt:${t.limitType}`}function gy(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((i=>KK(i))).join(", ")}]`),T4(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((i=>Fx(i))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((i=>Fx(i))).join(",")),`Target(${n})`})(Uh(t))}; limitType=${t.limitType})`}function M4(t,e){return e.isFoundDocument()&&(function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):yr.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(t,e)&&(function(n,i){for(const a of hv(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0})(t,e)&&(function(n,i){return!(n.startAt&&!(function(o,l,c){const u=bD(o,l,c);return o.inclusive?u<=0:u<0})(n.startAt,hv(n),i)||n.endAt&&!(function(o,l,c){const u=bD(o,l,c);return o.inclusive?u>=0:u>0})(n.endAt,hv(n),i))})(t,e)}function X0e(t){return(e,r)=>{let n=!1;for(const i of hv(t)){const a=Q0e(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function Q0e(t,e,r){const n=t.field.isKeyField()?yr.comparator(e.key,r.key):(function(a,o,l){const c=o.data.field(a),u=l.data.field(a);return c!==null&&u!==null?L0(c,u):Mr(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Mr(19790,{direction:t.dir})}}class F0{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lI(this.inner,((r,n)=>{for(const[i,a]of n)e(i,a)}))}isEmpty(){return L0e(this.inner)}size(){return this.innerSize}}const J0e=new Yl(yr.comparator);function Lp(){return J0e}const eY=new Yl(yr.comparator);function Sw(...t){let e=eY;for(const r of t)e=e.insert(r.key,r);return e}function Z0e(t){let e=eY;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function _d(){return fv()}function tY(){return fv()}function fv(){return new F0((t=>t.toString()),((t,e)=>t.isEqual(e)))}const epe=new Yl(yr.comparator),tpe=new Bs(yr.comparator);function Io(...t){let e=tpe;for(const r of t)e=e.add(r);return e}const rpe=new Bs(gn);function npe(){return rpe}function spe(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ON(e)?"-0":e}}function ipe(t){return{integerValue:""+t}}class D4{constructor(){this._=void 0}}function ape(t,e,r){return t instanceof Uv?(function(i,a){const o={fields:{[RK]:{stringValue:OK},[DK]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&cI(a)&&(a=BK(a)),a&&(o.fields[MK]=a),{mapValue:o}})(r,e):t instanceof qx?rY(t,e):t instanceof Vx?nY(t,e):(function(i,a){const o=lpe(i,a),l=jD(o)+jD(i.Ae);return G6(o)&&G6(i.Ae)?ipe(l):spe(i.serializer,l)})(t,e)}function ope(t,e,r){return t instanceof qx?rY(t,e):t instanceof Vx?nY(t,e):r}function lpe(t,e){return t instanceof zv?(function(n){return G6(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(e)?e:{integerValue:0}:null}class Uv extends D4{}class qx extends D4{constructor(e){super(),this.elements=e}}function rY(t,e){const r=sY(e);for(const n of t.elements)r.some((i=>Dd(i,n)))||r.push(n);return{arrayValue:{values:r}}}class Vx extends D4{constructor(e){super(),this.elements=e}}function nY(t,e){let r=sY(e);for(const n of t.elements)r=r.filter((i=>!Dd(i,n)));return{arrayValue:{values:r}}}class zv extends D4{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function jD(t){return ma(t.integerValue||t.doubleValue)}function sY(t){return Fv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class cpe{constructor(e,r){this.field=e,this.transform=r}}function upe(t,e){return t.field.isEqual(e.field)&&(function(n,i){return n instanceof qx&&i instanceof qx||n instanceof Vx&&i instanceof Vx?Lx(n.elements,i.elements,Dd):n instanceof zv&&i instanceof zv?Dd(n.Ae,i.Ae):n instanceof Uv&&i instanceof Uv})(t.transform,e.transform)}class dpe{constructor(e,r){this.version=e,this.transformResults=r}}class Mu{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Mu}static exists(e){return new Mu(void 0,e)}static updateTime(e){return new Mu(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function W5(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}let B4=class{};function iY(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new hI(t.key,Mu.none()):new F1(t.key,t.data,Mu.none());{const r=t.data,n=Au.empty();let i=new Bs(sa.comparator);for(let a of e.fields)if(!i.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),i=i.add(a)}return new hb(t.key,n,new Oh(i.toArray()),Mu.none())}}function hpe(t,e,r){t instanceof F1?(function(i,a,o){const l=i.value.clone(),c=_D(i.fieldTransforms,a,o.transformResults);l.setAll(c),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,r):t instanceof hb?(function(i,a,o){if(!W5(i.precondition,a))return void a.convertToUnknownDocument(o.version);const l=_D(i.fieldTransforms,a,o.transformResults),c=a.data;c.setAll(aY(i)),c.setAll(l),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,r):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function pv(t,e,r,n){return t instanceof F1?(function(a,o,l,c){if(!W5(a.precondition,o))return l;const u=a.value.clone(),h=SD(a.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(t,e,r,n):t instanceof hb?(function(a,o,l,c){if(!W5(a.precondition,o))return l;const u=SD(a.fieldTransforms,c,o),h=o.data;return h.setAll(aY(a)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(t,e,r,n):(function(a,o,l){return W5(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(t,e,r)}function kD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Lx(n,i,((a,o)=>upe(a,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class F1 extends B4{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class hb extends B4{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function aY(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function _D(t,e,r){const n=new Map;qr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],o=a.transform,l=e.data.field(a.field);n.set(a.field,ope(o,l,r[i]))}return n}function SD(t,e,r){const n=new Map;for(const i of t){const a=i.transform,o=r.data.field(i.field);n.set(i.field,ape(a,o,e))}return n}class hI extends B4{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oY extends B4{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fI{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&hpe(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=pv(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=pv(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=tY();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(i.key)?null:l;const c=iY(o,l);c!==null&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Fn.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Io())}isEqual(e){return this.batchId===e.batchId&&Lx(this.mutations,e.mutations,((r,n)=>kD(r,n)))&&Lx(this.baseMutations,e.baseMutations,((r,n)=>kD(r,n)))}}class pI{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){qr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return epe})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,n[o].version);return new pI(e,r,n,i)}}class mI{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var fa,$n;function fpe(t){switch(t){case Mt.OK:return Mr(64938);case Mt.CANCELLED:case Mt.UNKNOWN:case Mt.DEADLINE_EXCEEDED:case Mt.RESOURCE_EXHAUSTED:case Mt.INTERNAL:case Mt.UNAVAILABLE:case Mt.UNAUTHENTICATED:return!1;case Mt.INVALID_ARGUMENT:case Mt.NOT_FOUND:case Mt.ALREADY_EXISTS:case Mt.PERMISSION_DENIED:case Mt.FAILED_PRECONDITION:case Mt.ABORTED:case Mt.OUT_OF_RANGE:case Mt.UNIMPLEMENTED:case Mt.DATA_LOSS:return!0;default:return Mr(15467,{code:t})}}function ppe(t){if(t===void 0)return mc("GRPC error has no .code"),Mt.UNKNOWN;switch(t){case fa.OK:return Mt.OK;case fa.CANCELLED:return Mt.CANCELLED;case fa.UNKNOWN:return Mt.UNKNOWN;case fa.DEADLINE_EXCEEDED:return Mt.DEADLINE_EXCEEDED;case fa.RESOURCE_EXHAUSTED:return Mt.RESOURCE_EXHAUSTED;case fa.INTERNAL:return Mt.INTERNAL;case fa.UNAVAILABLE:return Mt.UNAVAILABLE;case fa.UNAUTHENTICATED:return Mt.UNAUTHENTICATED;case fa.INVALID_ARGUMENT:return Mt.INVALID_ARGUMENT;case fa.NOT_FOUND:return Mt.NOT_FOUND;case fa.ALREADY_EXISTS:return Mt.ALREADY_EXISTS;case fa.PERMISSION_DENIED:return Mt.PERMISSION_DENIED;case fa.FAILED_PRECONDITION:return Mt.FAILED_PRECONDITION;case fa.ABORTED:return Mt.ABORTED;case fa.OUT_OF_RANGE:return Mt.OUT_OF_RANGE;case fa.UNIMPLEMENTED:return Mt.UNIMPLEMENTED;case fa.DATA_LOSS:return Mt.DATA_LOSS;default:return Mr(39323,{code:t})}}($n=fa||(fa={}))[$n.OK=0]="OK",$n[$n.CANCELLED=1]="CANCELLED",$n[$n.UNKNOWN=2]="UNKNOWN",$n[$n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$n[$n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$n[$n.NOT_FOUND=5]="NOT_FOUND",$n[$n.ALREADY_EXISTS=6]="ALREADY_EXISTS",$n[$n.PERMISSION_DENIED=7]="PERMISSION_DENIED",$n[$n.UNAUTHENTICATED=16]="UNAUTHENTICATED",$n[$n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$n[$n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$n[$n.ABORTED=10]="ABORTED",$n[$n.OUT_OF_RANGE=11]="OUT_OF_RANGE",$n[$n.UNIMPLEMENTED=12]="UNIMPLEMENTED",$n[$n.INTERNAL=13]="INTERNAL",$n[$n.UNAVAILABLE=14]="UNAVAILABLE",$n[$n.DATA_LOSS=15]="DATA_LOSS";new eI([4294967295,4294967295],0);const mpe={asc:"ASCENDING",desc:"DESCENDING"},gpe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xpe={and:"AND",or:"OR"};class bpe{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ype(t,e){return t.useProto3Json||T4(e)?e:{value:e}}function J6(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vpe(t,e){return J6(t,e.toTimestamp())}function $u(t){return qr(!!t,49232),Fn.fromTimestamp((function(r){const n=I0(r);return new Ai(n.seconds,n.nanos)})(t))}function lY(t,e){return Z6(t,e).canonicalString()}function Z6(t,e){const r=(function(i){return new xi(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?r:r.child(e)}function cY(t){const e=xi.fromString(t);return qr(Tpe(e),10190,{key:e.toString()}),e}function qN(t,e){return lY(t.databaseId,e.path)}function G5(t,e){const r=cY(e);if(r.get(1)!==t.databaseId.projectId)throw new Nr(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Nr(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new yr(hY(r))}function uY(t,e){return lY(t.databaseId,e)}function dY(t){const e=cY(t);return e.length===4?xi.emptyPath():hY(e)}function wpe(t){return new xi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hY(t){return qr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function CD(t,e,r){return{name:qN(t,e),fields:r.value.mapValue.fields}}function Npe(t,e,r){const n=G5(t,e.name),i=$u(e.updateTime),a=e.createTime?$u(e.createTime):Fn.min(),o=new Au({mapValue:{fields:e.fields}}),l=To.newFoundDocument(n,i,a,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function VN(t,e){let r;if(e instanceof F1)r={update:CD(t,e.key,e.value)};else if(e instanceof hI)r={delete:qN(t,e.key)};else if(e instanceof hb)r={update:CD(t,e.key,e.data),updateMask:Ape(e.fieldMask)};else{if(!(e instanceof oY))return Mr(16599,{Vt:e.type});r={verify:qN(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(a,o){const l=o.transform;if(l instanceof Uv)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof qx)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Vx)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof zv)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Mr(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:vpe(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Mr(27497)})(t,e.precondition)),r}function eA(t,e){const r=e.currentDocument?(function(a){return a.updateTime!==void 0?Mu.updateTime($u(a.updateTime)):a.exists!==void 0?Mu.exists(a.exists):Mu.none()})(e.currentDocument):Mu.none(),n=e.updateTransforms?e.updateTransforms.map((i=>(function(o,l){let c=null;if("setToServerValue"in l)qr(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Uv;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new qx(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new Vx(h)}else"increment"in l?c=new zv(o,l.increment):Mr(16584,{proto:l});const u=sa.fromServerFormat(l.fieldPath);return new cpe(u,c)})(t,i))):[];if(e.update){e.update.name;const i=G5(t,e.update.name),a=new Au({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const u=c.fieldPaths||[];return new Oh(u.map((h=>sa.fromServerFormat(h))))})(e.updateMask);return new hb(i,a,o,r,n)}return new F1(i,a,r,n)}if(e.delete){const i=G5(t,e.delete);return new hI(i,r)}if(e.verify){const i=G5(t,e.verify);return new oY(i,r)}return Mr(1463,{proto:e})}function jpe(t,e){return t&&t.length>0?(qr(e!==void 0,14353),t.map((r=>(function(i,a){let o=i.updateTime?$u(i.updateTime):$u(a);return o.isEqual(Fn.min())&&(o=$u(a)),new dpe(o,i.transformResults||[])})(r,e)))):[]}function kpe(t,e){return{documents:[uY(t,e.path)]}}function _pe(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=uY(t,i);const a=(function(u){if(u.length!==0)return mY(Es.create(u,"and"))})(e.filters);a&&(r.structuredQuery.where=a);const o=(function(u){if(u.length!==0)return u.map((h=>(function(m){return{field:Gg(m.field),direction:Spe(m.dir)}})(h)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=ype(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:r,parent:i}}function fY(t){let e=dY(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){qr(n===1,65062);const h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];r.where&&(a=(function(p){const m=pY(p);return m instanceof Es&&dI(m)?m.getFilters():[m]})(r.where));let o=[];r.orderBy&&(o=(function(p){return p.map((m=>(function(b){return new UN(Kg(b.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(b.direction))})(m)))})(r.orderBy));let l=null;r.limit&&(l=(function(p){let m;return m=typeof p=="object"?p.value:p,T4(m)?null:m})(r.limit));let c=null;r.startAt&&(c=(function(p){const m=!!p.before,g=p.values||[];return new Ux(g,m)})(r.startAt));let u=null;return r.endAt&&(u=(function(p){const m=!p.before,g=p.values||[];return new Ux(g,m)})(r.endAt)),G0e(e,i,o,a,l,"F",c,u)}function pY(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Kg(r.unaryFilter.field);return On.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Kg(r.unaryFilter.field);return On.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Kg(r.unaryFilter.field);return On.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Kg(r.unaryFilter.field);return On.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Mr(61313);default:return Mr(60726)}})(t):t.fieldFilter!==void 0?(function(r){return On.create(Kg(r.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Mr(58110);default:return Mr(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Es.create(r.compositeFilter.filters.map((n=>pY(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Mr(1026)}})(r.compositeFilter.op))})(t):Mr(30097,{filter:t})}function Spe(t){return mpe[t]}function Cpe(t){return gpe[t]}function Epe(t){return xpe[t]}function Gg(t){return{fieldPath:t.canonicalString()}}function Kg(t){return sa.fromServerFormat(t.fieldPath)}function mY(t){return t instanceof On?(function(r){if(r.op==="=="){if(mD(r.value))return{unaryFilter:{field:Gg(r.field),op:"IS_NAN"}};if(pD(r.value))return{unaryFilter:{field:Gg(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(mD(r.value))return{unaryFilter:{field:Gg(r.field),op:"IS_NOT_NAN"}};if(pD(r.value))return{unaryFilter:{field:Gg(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gg(r.field),op:Cpe(r.op),value:r.value}}})(t):t instanceof Es?(function(r){const n=r.getFilters().map((i=>mY(i)));return n.length===1?n[0]:{compositeFilter:{op:Epe(r.op),filters:n}}})(t):Mr(54877,{filter:t})}function Ape(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function Tpe(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class sx{constructor(e,r,n,i,a=Fn.min(),o=Fn.min(),l=Xl.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new sx(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new sx(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class gY{constructor(e){this.yt=e}}function Ipe(t,e){let r;if(e.document)r=Npe(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=yr.fromSegments(e.noDocument.path),i=nm(e.noDocument.readTime);r=To.newNoDocument(n,i),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return Mr(56709);{const n=yr.fromSegments(e.unknownDocument.path),i=nm(e.unknownDocument.version);r=To.newUnknownDocument(n,i)}}return e.readTime&&r.setReadTime((function(i){const a=new Ai(i[0],i[1]);return Fn.fromTimestamp(a)})(e.readTime)),r}function ED(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:HN(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(a,o){return{name:qN(a,o.key),fields:o.data.value.mapValue.fields,updateTime:J6(a,o.version.toTimestamp()),createTime:J6(a,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:rm(e.version)};else{if(!e.isUnknownDocument())return Mr(57904,{document:e});n.unknownDocument={path:r.path.toArray(),version:rm(e.version)}}return n}function HN(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function rm(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function nm(t){const e=new Ai(t.seconds,t.nanoseconds);return Fn.fromTimestamp(e)}function kp(t,e){const r=(e.baseMutations||[]).map((a=>eA(t.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map((a=>eA(t.yt,a))),i=Ai.fromMillis(e.localWriteTimeMs);return new fI(e.batchId,i,r,n)}function Ky(t){const e=nm(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?nm(t.lastLimboFreeSnapshotVersion):Fn.min();let n;return n=(function(a){return a.documents!==void 0})(t.query)?(function(a){const o=a.documents.length;return qr(o===1,1966,{count:o}),Uh(QK(dY(a.documents[0])))})(t.query):(function(a){return Uh(fY(a))})(t.query),new sx(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Xl.fromBase64String(t.resumeToken))}function xY(t,e){const r=rm(e.snapshotVersion),n=rm(e.lastLimboFreeSnapshotVersion);let i;i=W0e(e.target)?kpe(t.yt,e.target):_pe(t.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:tm(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function bY(t){const e=fY({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Q6(e,e.limit,"L"):e}function s3(t,e){return new mI(e.largestBatchId,eA(t.yt,e.overlayMutation))}function AD(t,e){const r=e.path.lastSegment();return[t,fl(e.path.popLast()),r]}function TD(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:rm(n.readTime),documentKey:fl(n.documentKey.path),largestBatchId:n.largestBatchId}}class Lpe{getBundleMetadata(e,r){return ID(e).get(r).next((n=>{if(n)return(function(a){return{id:a.bundleId,createTime:nm(a.createTime),version:a.version}})(n)}))}saveBundleMetadata(e,r){return ID(e).put((function(i){return{bundleId:i.id,createTime:rm($u(i.createTime)),version:i.version}})(r))}getNamedQuery(e,r){return LD(e).get(r).next((n=>{if(n)return(function(a){return{name:a.name,query:bY(a.bundledQuery),readTime:nm(a.readTime)}})(n)}))}saveNamedQuery(e,r){return LD(e).put((function(i){return{name:i.name,readTime:rm($u(i.readTime)),bundledQuery:i.bundledQuery}})(r))}}function ID(t){return Fa(t,I4)}function LD(t){return Fa(t,L4)}class $4{constructor(e,r){this.serializer=e,this.userId=r}static wt(e,r){const n=r.uid||"";return new $4(e,n)}getOverlay(e,r){return xy(e).get(AD(this.userId,r)).next((n=>n?s3(this.serializer,n):null))}getOverlays(e,r){const n=_d();return st.forEach(r,(i=>this.getOverlay(e,i).next((a=>{a!==null&&n.set(i,a)})))).next((()=>n))}saveOverlays(e,r,n){const i=[];return n.forEach(((a,o)=>{const l=new mI(r,o);i.push(this.St(e,l))})),st.waitFor(i)}removeOverlaysForBatchId(e,r,n){const i=new Set;r.forEach((o=>i.add(fl(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);a.push(xy(e).Z(V6,l))})),st.waitFor(a)}getOverlaysForCollection(e,r,n){const i=_d(),a=fl(r),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return xy(e).J(V6,o).next((l=>{for(const c of l){const u=s3(this.serializer,c);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,r,n,i){const a=_d();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return xy(e).ee({index:AK,range:l},((c,u,h)=>{const p=s3(this.serializer,u);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,r){return xy(e).put((function(i,a,o){const[l,c,u]=AD(a,o.mutation.key);return{userId:a,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:VN(i.yt,o.mutation)}})(this.serializer,this.userId,r))}}function xy(t){return Fa(t,P4)}class Ppe{bt(e){return Fa(e,aI)}getSessionToken(e){return this.bt(e).get("sessionToken").next((r=>{const n=r?.value;return n?Xl.fromUint8Array(n):Xl.EMPTY_BYTE_STRING}))}setSessionToken(e,r){return this.bt(e).put({name:"sessionToken",value:r.toUint8Array()})}}class _p{constructor(){}Dt(e,r){this.Ct(e,r),r.vt()}Ct(e,r){if("nullValue"in e)this.Ft(r,5);else if("booleanValue"in e)this.Ft(r,10),r.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(r,15),r.Mt(ma(e.integerValue));else if("doubleValue"in e){const n=ma(e.doubleValue);isNaN(n)?this.Ft(r,13):(this.Ft(r,15),ON(n)?r.Mt(0):r.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(r,20),typeof n=="string"&&(n=I0(n)),r.xt(`${n.seconds||""}`),r.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,r),this.Nt(r);else if("bytesValue"in e)this.Ft(r,30),r.Bt(Dx(e.bytesValue)),this.Nt(r);else if("referenceValue"in e)this.Lt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(r,45),r.Mt(n.latitude||0),r.Mt(n.longitude||0)}else"mapValue"in e?zK(e)?this.Ft(r,Number.MAX_SAFE_INTEGER):O4(e)?this.kt(e.mapValue,r):(this.qt(e.mapValue,r),this.Nt(r)):"arrayValue"in e?(this.Qt(e.arrayValue,r),this.Nt(r)):Mr(19022,{$t:e})}Ot(e,r){this.Ft(r,25),this.Ut(e,r)}Ut(e,r){r.xt(e)}qt(e,r){const n=e.fields||{};this.Ft(r,55);for(const i of Object.keys(n))this.Ot(i,r),this.Ct(n[i],r)}kt(e,r){const n=e.fields||{};this.Ft(r,53);const i=FN,a=n[i].arrayValue?.values?.length||0;this.Ft(r,15),r.Mt(ma(a)),this.Ot(i,r),this.Ct(n[i],r)}Qt(e,r){const n=e.values||[];this.Ft(r,50);for(const i of n)this.Ct(i,r)}Lt(e,r){this.Ft(r,37),yr.fromName(e).path.forEach((n=>{this.Ft(r,60),this.Ut(n,r)}))}Ft(e,r){e.Mt(r)}Nt(e){e.Mt(2)}}_p.Kt=new _p;const Lg=255;function Ope(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function PD(t){const e=64-(function(n){let i=0;for(let a=0;a<8;++a){const o=Ope(255&n[a]);if(i+=o,o!==8)break}return i})(t);return Math.ceil(e/8)}class Rpe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Gt(n.value),n=r.next();this.zt()}jt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Jt(n.value),n=r.next();this.Ht()}Yt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=r.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=r.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const r=this.en(e),n=PD(r);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=r.length-n;i<r.length;++i)this.buffer[this.position++]=255&r[i]}nn(e){const r=this.en(e),n=PD(r);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=r.length-n;i<r.length;++i)this.buffer[this.position++]=~(255&r[i])}rn(){this.sn(Lg),this.sn(255)}_n(){this.an(Lg),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const r=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),n=!!(128&r[0]);r[0]^=n?255:128;for(let i=1;i<r.length;++i)r[i]^=n?255:0;return r}Gt(e){const r=255&e;r===0?(this.sn(0),this.sn(255)):r===Lg?(this.sn(Lg),this.sn(0)):this.sn(r)}Jt(e){const r=255&e;r===0?(this.an(0),this.an(255)):r===Lg?(this.an(Lg),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class Mpe{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Dpe{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class by{constructor(){this.cn=new Rpe,this.ln=new Mpe(this.cn),this.hn=new Dpe(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Sp{constructor(e,r,n,i){this.Tn=e,this.In=r,this.En=n,this.dn=i}An(){const e=this.dn.length,r=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.dn,0),r!==e?n.set([0],this.dn.length):++n[n.length-1],new Sp(this.Tn,this.In,this.En,n)}Rn(e,r,n){return{indexId:this.Tn,uid:e,arrayValue:K5(this.En),directionalValue:K5(this.dn),orderedDocumentKey:K5(r),documentKey:n.path.toArray()}}Vn(e,r,n){const i=this.Rn(e,r,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Qf(t,e){let r=t.Tn-e.Tn;return r!==0?r:(r=OD(t.En,e.En),r!==0?r:(r=OD(t.dn,e.dn),r!==0?r:yr.comparator(t.In,e.In)))}function OD(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}function K5(t){return jG()?(function(r){let n="";for(let i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n})(t):t}function RD(t){return typeof t!="string"?t:(function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n})(t)}class MD{constructor(e){this.mn=new Bs(((r,n)=>sa.comparator(r.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const r of e.filters){const n=r;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(qr(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const r=U6(e);if(r!==void 0&&!this.wn(r))return!1;const n=mp(e);let i=new Set,a=0,o=0;for(;a<n.length&&this.wn(n[a]);++a)i=i.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const c=n[a];if(!this.Sn(l,c)||!this.bn(this.fn[o++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Bs(sa.comparator);const r=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new z5(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new z5(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new z5(n.field,n.dir==="asc"?0:1)));return new PN(PN.UNKNOWN_ID,this.collectionId,r,Rv.empty())}wn(e){for(const r of this.gn)if(this.Sn(r,e))return!0;return!1}Sn(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}bn(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}function yY(t){if(qr(t instanceof On||t instanceof Es,20012),t instanceof On){if(t instanceof XK){const r=t.value.arrayValue?.values?.map((n=>On.create(t.field,"==",n)))||[];return Es.create(r,"or")}return t}const e=t.filters.map((r=>yY(r)));return Es.create(e,t.op)}function Bpe(t){if(t.getFilters().length===0)return[];const e=nA(yY(t));return qr(vY(e),7391),tA(e)||rA(e)?[e]:e.getFilters()}function tA(t){return t instanceof On}function rA(t){return t instanceof Es&&dI(t)}function vY(t){return tA(t)||rA(t)||(function(r){if(r instanceof Es&&K6(r)){for(const n of r.getFilters())if(!tA(n)&&!rA(n))return!1;return!0}return!1})(t)}function nA(t){if(qr(t instanceof On||t instanceof Es,34018),t instanceof On)return t;if(t.filters.length===1)return nA(t.filters[0]);const e=t.filters.map((n=>nA(n)));let r=Es.create(e,t.op);return r=WN(r),vY(r)?r:(qr(r instanceof Es,64498),qr(zx(r),40251),qr(r.filters.length>1,57927),r.filters.reduce(((n,i)=>gI(n,i))))}function gI(t,e){let r;return qr(t instanceof On||t instanceof Es,38388),qr(e instanceof On||e instanceof Es,25473),r=t instanceof On?e instanceof On?(function(i,a){return Es.create([i,a],"and")})(t,e):DD(t,e):e instanceof On?DD(e,t):(function(i,a){if(qr(i.filters.length>0&&a.filters.length>0,48005),zx(i)&&zx(a))return GK(i,a.getFilters());const o=K6(i)?i:a,l=K6(i)?a:i,c=o.filters.map((u=>gI(u,l)));return Es.create(c,"or")})(t,e),WN(r)}function DD(t,e){if(zx(e))return GK(e,t.getFilters());{const r=e.filters.map((n=>gI(t,n)));return Es.create(r,"or")}}function WN(t){if(qr(t instanceof On||t instanceof Es,11850),t instanceof On)return t;const e=t.getFilters();if(e.length===1)return WN(e[0]);if(HK(t))return t;const r=e.map((i=>WN(i))),n=[];return r.forEach((i=>{i instanceof On?n.push(i):i instanceof Es&&(i.op===t.op?n.push(...i.filters):n.push(i))})),n.length===1?n[0]:Es.create(n,t.op)}class $pe{constructor(){this.Cn=new xI}addToCollectionParentIndex(e,r){return this.Cn.add(r),st.resolve()}getCollectionParents(e,r){return st.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return st.resolve()}deleteFieldIndex(e,r){return st.resolve()}deleteAllFieldIndexes(e){return st.resolve()}createTargetIndexes(e,r){return st.resolve()}getDocumentsMatchingTarget(e,r){return st.resolve(null)}getIndexType(e,r){return st.resolve(0)}getFieldIndexes(e,r){return st.resolve([])}getNextCollectionGroupToUpdate(e){return st.resolve(null)}getMinOffset(e,r){return st.resolve(kc.min())}getMinOffsetFromCollectionGroup(e,r){return st.resolve(kc.min())}updateCollectionGroup(e,r,n){return st.resolve()}updateIndexEntries(e,r){return st.resolve()}}class xI{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Bs(xi.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Bs(xi.comparator)).toArray()}}const BD="IndexedDbIndexManager",Cw=new Uint8Array(0);class Fpe{constructor(e,r){this.databaseId=r,this.vn=new xI,this.Fn=new F0((n=>tm(n)),((n,i)=>$1(n,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.vn.has(r)){const n=r.lastSegment(),i=r.popLast();e.addOnCommittedListener((()=>{this.vn.add(r)}));const a={collectionId:n,parent:fl(i)};return $D(e).put(a)}return st.resolve()}getCollectionParents(e,r){const n=[],i=IDBKeyRange.bound([r,""],[bK(r),""],!1,!0);return $D(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==r)break;n.push(kd(o.parent))}return n}))}addFieldIndex(e,r){const n=yy(e),i=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(r);delete i.indexId;const a=n.add(i);if(r.indexState){const o=Og(e);return a.next((l=>{o.put(TD(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))}))}return a.next()}deleteFieldIndex(e,r){const n=yy(e),i=Og(e),a=Pg(e);return n.delete(r.indexId).next((()=>i.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const r=yy(e),n=Pg(e),i=Og(e);return r.Z().next((()=>n.Z())).next((()=>i.Z()))}createTargetIndexes(e,r){return st.forEach(this.Mn(r),(n=>this.getIndexType(e,n).next((i=>{if(i===0||i===1){const a=new MD(n).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,r){const n=Pg(e);let i=!0;const a=new Map;return st.forEach(this.Mn(r),(o=>this.xn(e,o).next((l=>{i&&(i=!!l),a.set(o,l)})))).next((()=>{if(i){let o=Io();const l=[];return st.forEach(a,((c,u)=>{Xt(BD,`Using index ${(function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map((I=>`${I.fieldPath}:${I.kind}`)).join(",")}`})(c)} to execute ${tm(r)}`);const h=(function(E,I){const O=U6(I);if(O===void 0)return null;for(const B of zN(E,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(u,c),p=(function(E,I){const O=new Map;for(const B of mp(I))for(const S of zN(E,B.fieldPath))switch(S.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),S.value),Array.from(O.values())}return null})(u,c),m=(function(E,I){const O=[];let B=!0;for(const S of mp(I)){const T=S.kind===0?vD(E,S.fieldPath,E.startAt):wD(E,S.fieldPath,E.startAt);O.push(T.value),B&&(B=T.inclusive)}return new Ux(O,B)})(u,c),g=(function(E,I){const O=[];let B=!0;for(const S of mp(I)){const T=S.kind===0?wD(E,S.fieldPath,E.endAt):vD(E,S.fieldPath,E.endAt);O.push(T.value),B&&(B=T.inclusive)}return new Ux(O,B)})(u,c),b=this.On(c,u,m),v=this.On(c,u,g),w=this.Nn(c,u,p),j=this.Bn(c.indexId,h,b,m.inclusive,v,g.inclusive,w);return st.forEach(j,(_=>n.Y(_,r.limit).next((E=>{E.forEach((I=>{const O=yr.fromSegments(I.documentKey);o.has(O)||(o=o.add(O),l.push(O))}))}))))})).next((()=>l))}return st.resolve(null)}))}Mn(e){let r=this.Fn.get(e);return r||(e.filters.length===0?r=[e]:r=Bpe(Es.create(e.filters,"and")).map((n=>X6(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,r),r)}Bn(e,r,n,i,a,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),u=c/(r!=null?r.length:1),h=[];for(let p=0;p<c;++p){const m=r?this.Ln(r[p/u]):Cw,g=this.kn(e,m,n[p%u],i),b=this.qn(e,m,a[p%u],o),v=l.map((w=>this.kn(e,m,w,!0)));h.push(...this.createRange(g,b,v))}return h}kn(e,r,n,i){const a=new Sp(e,yr.empty(),r,n);return i?a:a.An()}qn(e,r,n,i){const a=new Sp(e,yr.empty(),r,n);return i?a.An():a}xn(e,r){const n=new MD(r),i=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const l of a)n.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,r){let n=2;const i=this.Mn(r);return st.forEach(i,(a=>this.xn(e,a).next((o=>{o?n!==0&&o.fields.length<(function(c){let u=new Bs(sa.comparator),h=!1;for(const p of c.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const p of c.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(h?1:0)})(a)&&(n=1):n=0})))).next((()=>(function(o){return o.limit!==null})(r)&&i.length>1&&n===2?1:n))}Qn(e,r){const n=new by;for(const i of mp(e)){const a=r.data.field(i.fieldPath);if(a==null)return null;const o=n.Pn(i.kind);_p.Kt.Dt(a,o)}return n.un()}Ln(e){const r=new by;return _p.Kt.Dt(e,r.Pn(0)),r.un()}$n(e,r){const n=new by;return _p.Kt.Dt(uI(this.databaseId,r),n.Pn((function(a){const o=mp(a);return o.length===0?0:o[o.length-1].kind})(e))),n.un()}Nn(e,r,n){if(n===null)return[];let i=[];i.push(new by);let a=0;for(const o of mp(e)){const l=n[a++];for(const c of i)if(this.Un(r,o.fieldPath)&&Fv(l))i=this.Kn(i,o,l);else{const u=c.Pn(o.kind);_p.Kt.Dt(l,u)}}return this.Wn(i)}On(e,r,n){return this.Nn(e,r,n.position)}Wn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].un();return r}Kn(e,r,n){const i=[...e],a=[];for(const o of n.arrayValue.values||[])for(const l of i){const c=new by;c.seed(l.un()),_p.Kt.Dt(o,c.Pn(r.kind)),a.push(c)}return a}Un(e,r){return!!e.filters.find((n=>n instanceof On&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,r){const n=yy(e),i=Og(e);return(r?n.J(q6,IDBKeyRange.bound(r,r)):n.J()).next((a=>{const o=[];return st.forEach(a,(l=>i.get([l.indexId,this.uid]).next((c=>{o.push((function(h,p){const m=p?new Rv(p.sequenceNumber,new kc(nm(p.readTime),new yr(kd(p.documentKey)),p.largestBatchId)):Rv.empty(),g=h.fields.map((([b,v])=>new z5(sa.fromServerFormat(b),v)));return new PN(h.indexId,h.collectionGroup,g,m)})(l,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((r=>r.length===0?null:(r.sort(((n,i)=>{const a=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:gn(n.collectionGroup,i.collectionGroup)})),r[0].collectionGroup)))}updateCollectionGroup(e,r,n){const i=yy(e),a=Og(e);return this.Gn(e).next((o=>i.J(q6,IDBKeyRange.bound(r,r)).next((l=>st.forEach(l,(c=>a.put(TD(c.indexId,this.uid,o,n))))))))}updateIndexEntries(e,r){const n=new Map;return st.forEach(r,((i,a)=>{const o=n.get(i.collectionGroup);return(o?st.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((l=>(n.set(i.collectionGroup,l),st.forEach(l,(c=>this.zn(e,i,c).next((u=>{const h=this.jn(a,c);return u.isEqual(h)?st.resolve():this.Jn(e,a,c,u,h)})))))))}))}Hn(e,r,n,i){return Pg(e).put(i.Rn(this.uid,this.$n(n,r.key),r.key))}Yn(e,r,n,i){return Pg(e).delete(i.Vn(this.uid,this.$n(n,r.key),r.key))}zn(e,r,n){const i=Pg(e);let a=new Bs(Qf);return i.ee({index:EK,range:IDBKeyRange.only([n.indexId,this.uid,K5(this.$n(n,r))])},((o,l)=>{a=a.add(new Sp(n.indexId,r,RD(l.arrayValue),RD(l.directionalValue)))})).next((()=>a))}jn(e,r){let n=new Bs(Qf);const i=this.Qn(r,e);if(i==null)return n;const a=U6(r);if(a!=null){const o=e.data.field(a.fieldPath);if(Fv(o))for(const l of o.arrayValue.values||[])n=n.add(new Sp(r.indexId,e.key,this.Ln(l),i))}else n=n.add(new Sp(r.indexId,e.key,Cw,i));return n}Jn(e,r,n,i,a){Xt(BD,"Updating index entries for document '%s'",r.key);const o=[];return(function(c,u,h,p,m){const g=c.getIterator(),b=u.getIterator();let v=Ig(g),w=Ig(b);for(;v||w;){let j=!1,_=!1;if(v&&w){const E=h(v,w);E<0?_=!0:E>0&&(j=!0)}else v!=null?_=!0:j=!0;j?(p(w),w=Ig(b)):_?(m(v),v=Ig(g)):(v=Ig(g),w=Ig(b))}})(i,a,Qf,(l=>{o.push(this.Hn(e,r,n,l))}),(l=>{o.push(this.Yn(e,r,n,l))})),st.waitFor(o)}Gn(e){let r=1;return Og(e).ee({index:CK,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,i,a)=>{a.done(),r=i.sequenceNumber+1})).next((()=>r))}createRange(e,r,n){n=n.sort(((o,l)=>Qf(o,l))).filter(((o,l,c)=>!l||Qf(o,c[l-1])!==0));const i=[];i.push(e);for(const o of n){const l=Qf(o,e),c=Qf(o,r);if(l===0)i[0]=e.An();else if(l>0&&c<0)i.push(o),i.push(o.An());else if(c>0)break}i.push(r);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const l=i[o].Vn(this.uid,Cw,yr.empty()),c=i[o+1].Vn(this.uid,Cw,yr.empty());a.push(IDBKeyRange.bound(l,c))}return a}Zn(e,r){return Qf(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(FD)}getMinOffset(e,r){return st.mapArray(this.Mn(r),(n=>this.xn(e,n).next((i=>i||Mr(44426))))).next(FD)}}function $D(t){return Fa(t,Bv)}function Pg(t){return Fa(t,uv)}function yy(t){return Fa(t,iI)}function Og(t){return Fa(t,cv)}function FD(t){qr(t.length!==0,28825);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const i=t[n].indexState.offset;rI(i,e)<0&&(e=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new kc(e.readTime,e.documentKey,r)}const UD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wY=41943040;class Wl{static withCacheSize(e){return new Wl(e,Wl.DEFAULT_COLLECTION_PERCENTILE,Wl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}function NY(t,e,r){const n=t.store(Su),i=t.store(Px),a=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.ee({range:o},((h,p,m)=>(l++,m.delete())));a.push(c.next((()=>{qr(l===1,47070,{batchId:r.batchId})})));const u=[];for(const h of r.mutations){const p=kK(e,h.key.path,r.batchId);a.push(i.delete(p)),u.push(h.key)}return st.waitFor(a).next((()=>u))}function GN(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr(14731);e=t.noDocument}return JSON.stringify(e).length}Wl.DEFAULT_COLLECTION_PERCENTILE=10,Wl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wl.DEFAULT=new Wl(wY,Wl.DEFAULT_COLLECTION_PERCENTILE,Wl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wl.DISABLED=new Wl(-1,0,0);class F4{constructor(e,r,n,i){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=i,this.Xn={}}static wt(e,r,n,i){qr(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new F4(a,r,n,i)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Jf(e).ee({index:Ip,range:n},((i,a,o)=>{r=!1,o.done()})).next((()=>r))}addMutationBatch(e,r,n,i){const a=Yg(e),o=Jf(e);return o.add({}).next((l=>{qr(typeof l=="number",49019);const c=new fI(l,r,n,i),u=(function(g,b,v){const w=v.baseMutations.map((_=>VN(g.yt,_))),j=v.mutations.map((_=>VN(g.yt,_)));return{userId:b,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:j}})(this.serializer,this.userId,c),h=[];let p=new Bs(((m,g)=>gn(m.canonicalString(),g.canonicalString())));for(const m of i){const g=kK(this.userId,m.key.path,l);p=p.add(m.key.path.popLast()),h.push(o.put(u)),h.push(a.put(g,l0e))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[l]=c.keys()})),st.waitFor(h).next((()=>c))}))}lookupMutationBatch(e,r){return Jf(e).get(r).next((n=>n?(qr(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:r}),kp(this.serializer,n)):null))}er(e,r){return this.Xn[r]?st.resolve(this.Xn[r]):this.lookupMutationBatch(e,r).next((n=>{if(n){const i=n.keys();return this.Xn[r]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return Jf(e).ee({index:Ip,range:i},((o,l,c)=>{l.userId===this.userId&&(qr(l.batchId>=n,47524,{tr:n}),a=kp(this.serializer,l)),c.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Fp;return Jf(e).ee({index:Ip,range:r,reverse:!0},((i,a,o)=>{n=a.batchId,o.done()})).next((()=>n))}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,Fp],[this.userId,Number.POSITIVE_INFINITY]);return Jf(e).J(Ip,r).next((n=>n.map((i=>kp(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=q5(this.userId,r.path),i=IDBKeyRange.lowerBound(n),a=[];return Yg(e).ee({range:i},((o,l,c)=>{const[u,h,p]=o,m=kd(h);if(u===this.userId&&r.path.isEqual(m))return Jf(e).get(p).next((g=>{if(!g)throw Mr(61480,{nr:o,batchId:p});qr(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:p}),a.push(kp(this.serializer,g))}));c.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Bs(gn);const i=[];return r.forEach((a=>{const o=q5(this.userId,a.path),l=IDBKeyRange.lowerBound(o),c=Yg(e).ee({range:l},((u,h,p)=>{const[m,g,b]=u,v=kd(g);m===this.userId&&a.path.isEqual(v)?n=n.add(b):p.done()}));i.push(c)})),st.waitFor(i).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1,a=q5(this.userId,n),o=IDBKeyRange.lowerBound(a);let l=new Bs(gn);return Yg(e).ee({range:o},((c,u,h)=>{const[p,m,g]=c,b=kd(m);p===this.userId&&n.isPrefixOf(b)?b.length===i&&(l=l.add(g)):h.done()})).next((()=>this.rr(e,l)))}rr(e,r){const n=[],i=[];return r.forEach((a=>{i.push(Jf(e).get(a).next((o=>{if(o===null)throw Mr(35274,{batchId:a});qr(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),n.push(kp(this.serializer,o))})))})),st.waitFor(i).next((()=>n))}removeMutationBatch(e,r){return NY(e.le,this.userId,r).next((n=>(e.addOnCommittedListener((()=>{this.ir(r.batchId)})),st.forEach(n,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((r=>{if(!r)return st.resolve();const n=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Yg(e).ee({range:n},((a,o,l)=>{if(a[0]===this.userId){const c=kd(a[1]);i.push(c)}else l.done()})).next((()=>{qr(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,r){return jY(e,this.userId,r)}_r(e){return kY(e).get(this.userId).next((r=>r||{userId:this.userId,lastAcknowledgedBatchId:Fp,lastStreamToken:""}))}}function jY(t,e,r){const n=q5(e,r.path),i=n[1],a=IDBKeyRange.lowerBound(n);let o=!1;return Yg(t).ee({range:a,X:!0},((l,c,u)=>{const[h,p,m]=l;h===e&&p===i&&(o=!0),u.done()})).next((()=>o))}function Jf(t){return Fa(t,Su)}function Yg(t){return Fa(t,Px)}function kY(t){return Fa(t,Mv)}class sm{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new sm(0)}static cr(){return new sm(-1)}}class Upe{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.lr(e).next((r=>{const n=new sm(r.highestTargetId);return r.highestTargetId=n.next(),this.hr(e,r).next((()=>r.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((r=>Fn.fromTimestamp(new Ai(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((r=>r.highestListenSequenceNumber))}setTargetsMetadata(e,r,n){return this.lr(e).next((i=>(i.highestListenSequenceNumber=r,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),r>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=r),this.hr(e,i))))}addTargetData(e,r){return this.Pr(e,r).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(r,n),this.hr(e,n))))))}updateTargetData(e,r){return this.Pr(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next((()=>Rg(e).delete(r.targetId))).next((()=>this.lr(e))).next((n=>(qr(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,r,n){let i=0;const a=[];return Rg(e).ee(((o,l)=>{const c=Ky(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(i++,a.push(this.removeTargetData(e,c)))})).next((()=>st.waitFor(a))).next((()=>i))}forEachTarget(e,r){return Rg(e).ee(((n,i)=>{const a=Ky(i);r(a)}))}lr(e){return zD(e).get(DN).next((r=>(qr(r!==null,2888),r)))}hr(e,r){return zD(e).put(DN,r)}Pr(e,r){return Rg(e).put(xY(this.serializer,r))}Tr(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((r=>r.targetCount))}getTargetData(e,r){const n=tm(r),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return Rg(e).ee({range:i,index:SK},((o,l,c)=>{const u=Ky(l);$1(r,u.target)&&(a=u,c.done())})).next((()=>a))}addMatchingKeys(e,r,n){const i=[],a=d0(e);return r.forEach((o=>{const l=fl(o.path);i.push(a.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,o))})),st.waitFor(i)}removeMatchingKeys(e,r,n){const i=d0(e);return st.forEach(r,(a=>{const o=fl(a.path);return st.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,a)])}))}removeMatchingKeysForTargetId(e,r){const n=d0(e),i=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),i=d0(e);let a=Io();return i.ee({range:n,X:!0},((o,l,c)=>{const u=kd(o[1]),h=new yr(u);a=a.add(h)})).next((()=>a))}containsKey(e,r){const n=fl(r.path),i=IDBKeyRange.bound([n],[bK(n)],!1,!0);let a=0;return d0(e).ee({index:sI,X:!0,range:i},(([o,l],c,u)=>{o!==0&&(a++,u.done())})).next((()=>a>0))}At(e,r){return Rg(e).get(r).next((n=>n?Ky(n):null))}}function Rg(t){return Fa(t,Ox)}function zD(t){return Fa(t,Up)}function d0(t){return Fa(t,Rx)}const qD="LruGarbageCollector",zpe=1048576;function VD([t,e],[r,n]){const i=gn(t,r);return i===0?gn(e,n):i}class qpe{constructor(e){this.Ir=e,this.buffer=new Bs(VD),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();VD(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class Vpe{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Xt(qD,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Im(r)?Xt(qD,"Ignoring IndexedDB error during garbage collection: ",r):await E4(r)}await this.Vr(3e5)}))}}class Hpe{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return st.resolve(Ru.ce);const n=new qpe(r);return this.mr.forEachTarget(e,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Xt("LruGarbageCollector","Garbage collection skipped; disabled"),st.resolve(UD)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Xt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),UD):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Xt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(n=p,l=Date.now(),this.removeTargets(e,n,r)))).next((p=>(a=p,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((p=>(u=Date.now(),Wg()<=Sn.DEBUG&&Xt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${p} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),st.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function Wpe(t,e){return new Hpe(t,e)}class Gpe{constructor(e,r){this.db=e,this.garbageCollector=Wpe(this,r)}gr(e){const r=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>r.next((i=>n+i))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}pr(e,r){return this.Sr(e,((n,i)=>r(i)))}addReference(e,r,n){return Ew(e,n)}removeReference(e,r,n){return Ew(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return Ew(e,r)}br(e,r){return(function(i,a){let o=!1;return kY(i).te((l=>jY(i,l,a).next((c=>(c&&(o=!0),st.resolve(!c)))))).next((()=>o))})(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,l)=>{if(l<=r){const c=this.br(e,o).next((u=>{if(!u)return a++,n.getEntry(e,o).next((()=>(n.removeEntry(o,Fn.min()),d0(e).delete((function(p){return[0,fl(p.path)]})(o)))))}));i.push(c)}})).next((()=>st.waitFor(i))).next((()=>n.apply(e))).next((()=>a))}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return Ew(e,r)}Sr(e,r){const n=d0(e);let i,a=Ru.ce;return n.ee({index:sI},(([o,l],{path:c,sequenceNumber:u})=>{o===0?(a!==Ru.ce&&r(new yr(kd(i)),a),a=u,i=c):a=Ru.ce})).next((()=>{a!==Ru.ce&&r(new yr(kd(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ew(t,e){return d0(t).put((function(n,i){return{targetId:0,path:fl(n.path),sequenceNumber:i}})(e,t.currentSequenceNumber))}class _Y{constructor(){this.changes=new F0((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,To.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?st.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Kpe{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return fp(e).put(n)}removeEntry(e,r,n){return fp(e).delete((function(a,o){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],HN(o),l[l.length-1]]})(r,n))}updateMetadata(e,r){return this.getMetadata(e).next((n=>(n.byteSize+=r,this.Dr(e,n))))}getEntry(e,r){let n=To.newInvalidDocument(r);return fp(e).ee({index:V5,range:IDBKeyRange.only(vy(r))},((i,a)=>{n=this.Cr(r,a)})).next((()=>n))}vr(e,r){let n={size:0,document:To.newInvalidDocument(r)};return fp(e).ee({index:V5,range:IDBKeyRange.only(vy(r))},((i,a)=>{n={document:this.Cr(r,a),size:GN(a)}})).next((()=>n))}getEntries(e,r){let n=Lp();return this.Fr(e,r,((i,a)=>{const o=this.Cr(i,a);n=n.insert(i,o)})).next((()=>n))}Mr(e,r){let n=Lp(),i=new Yl(yr.comparator);return this.Fr(e,r,((a,o)=>{const l=this.Cr(a,o);n=n.insert(a,l),i=i.insert(a,GN(o))})).next((()=>({documents:n,Or:i})))}Fr(e,r,n){if(r.isEmpty())return st.resolve();let i=new Bs(GD);r.forEach((c=>i=i.add(c)));const a=IDBKeyRange.bound(vy(i.first()),vy(i.last())),o=i.getIterator();let l=o.getNext();return fp(e).ee({index:V5,range:a},((c,u,h)=>{const p=yr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&GD(l,p)<0;)n(l,null),l=o.getNext();l&&l.isEqual(p)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?h.j(vy(l)):h.done()})).next((()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,r,n,i,a){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),HN(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fp(e).J(IDBKeyRange.bound(l,c,!0)).next((u=>{a?.incrementDocumentReadCount(u.length);let h=Lp();for(const p of u){const m=this.Cr(yr.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(M4(r,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,r,n,i){let a=Lp();const o=WD(r,n),l=WD(r,kc.max());return fp(e).ee({index:_K,range:IDBKeyRange.bound(o,l,!0)},((c,u,h)=>{const p=this.Cr(yr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new Ype(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((r=>r.byteSize))}getMetadata(e){return HD(e).get(z6).next((r=>(qr(!!r,20021),r)))}Dr(e,r){return HD(e).put(z6,r)}Cr(e,r){if(r){const n=Ipe(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Fn.min())))return n}return To.newInvalidDocument(e)}}function SY(t){return new Kpe(t)}class Ype extends _Y{constructor(e,r){super(),this.Nr=e,this.trackRemovals=r,this.Br=new F0((n=>n.toString()),((n,i)=>n.isEqual(i)))}applyChanges(e){const r=[];let n=0,i=new Bs(((a,o)=>gn(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const l=this.Br.get(a);if(r.push(this.Nr.removeEntry(e,a,l.readTime)),o.isValidDocument()){const c=ED(this.Nr.serializer,o);i=i.add(a.path.popLast());const u=GN(c);n+=u-l.size,r.push(this.Nr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=ED(this.Nr.serializer,o.convertToNoDocument(Fn.min()));r.push(this.Nr.addEntry(e,a,c))}})),i.forEach((a=>{r.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),r.push(this.Nr.updateMetadata(e,n)),st.waitFor(r)}getFromCache(e,r){return this.Nr.vr(e,r).next((n=>(this.Br.set(r,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,r){return this.Nr.Mr(e,r).next((({documents:n,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:n.get(a).readTime})})),n)))}}function HD(t){return Fa(t,Dv)}function fp(t){return Fa(t,MN)}function vy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function WD(t,e){const r=e.documentKey.path.toArray();return[t,HN(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function GD(t,e){const r=t.path.toArray(),n=e.path.toArray();let i=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(i=gn(r[a],n[a]),i)return i;return i=gn(r.length,n.length),i||(i=gn(r[r.length-2],n[n.length-2]),i||gn(r[r.length-1],n[n.length-1]))}class Xpe{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class CY{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,r)))).next((i=>(n!==null&&pv(n.mutation,i,Oh.empty(),Ai.now()),i)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Io()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Io()){const i=_d();return this.populateOverlays(e,i,r).next((()=>this.computeViews(e,r,i,n).next((a=>{let o=Sw();return a.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=_d();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Io())))}populateOverlays(e,r,n){const i=[];return n.forEach((a=>{r.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,l)=>{r.set(o,l)}))}))}computeViews(e,r,n,i){let a=Lp();const o=fv(),l=(function(){return fv()})();return r.forEach(((c,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof hb)?a=a.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),pv(h.mutation,u,h.mutation.getFieldMask(),Ai.now())):o.set(u.key,Oh.empty())})),this.recalculateAndSaveOverlays(e,a).next((c=>(c.forEach(((u,h)=>o.set(u,h))),r.forEach(((u,h)=>l.set(u,new Xpe(h,o.get(u)??null)))),l)))}recalculateAndSaveOverlays(e,r){const n=fv();let i=new Yl(((o,l)=>o-l)),a=Io();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const l of o)l.keys().forEach((c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||Oh.empty();h=l.applyToLocalView(u,h),n.set(c,h);const p=(i.get(l.batchId)||Io()).add(c);i=i.insert(l.batchId,p)}))})).next((()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,p=tY();h.forEach((m=>{if(!a.has(m)){const g=iY(r.get(m),n.get(m));g!==null&&p.set(m,g),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return st.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,i){return(function(o){return yr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):K0e(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):st.resolve(_d());let l=Ov,c=a;return o.next((u=>st.forEach(u,((h,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),a.get(h)?st.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{c=c.insert(h,m)}))))).next((()=>this.populateOverlays(e,u,a))).next((()=>this.computeViews(e,c,u,Io()))).next((h=>({batchId:l,changes:Z0e(h)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new yr(r)).next((n=>{let i=Sw();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let o=Sw();return this.indexManager.getCollectionParents(e,a).next((l=>st.forEach(l,(c=>{const u=(function(p,m){return new R4(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i)))).next((o=>{a.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,To.newInvalidDocument(h)))}));let l=Sw();return o.forEach(((c,u)=>{const h=a.get(c);h!==void 0&&pv(h.mutation,u,Oh.empty(),Ai.now()),M4(r,u)&&(l=l.insert(c,u))})),l}))}}class Qpe{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return st.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(i){return{id:i.id,version:i.version,createTime:$u(i.createTime)}})(r)),st.resolve()}getNamedQuery(e,r){return st.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(i){return{name:i.name,query:bY(i.bundledQuery),readTime:$u(i.readTime)}})(r)),st.resolve()}}class Jpe{constructor(){this.overlays=new Yl(yr.comparator),this.qr=new Map}getOverlay(e,r){return st.resolve(this.overlays.get(r))}getOverlays(e,r){const n=_d();return st.forEach(r,(i=>this.getOverlay(e,i).next((a=>{a!==null&&n.set(i,a)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((i,a)=>{this.St(e,r,a)})),st.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(n)),st.resolve()}getOverlaysForCollection(e,r,n){const i=_d(),a=r.length+1,o=new yr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===a&&c.largestBatchId>n&&i.set(c.getKey(),c)}return st.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Yl(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=a.get(u.largestBatchId);h===null&&(h=_d(),a=a.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=_d(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>l.set(u,h))),!(l.size()>=i)););return st.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new mI(r,n));let a=this.qr.get(r);a===void 0&&(a=Io(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}class Zpe{constructor(){this.sessionToken=Xl.EMPTY_BYTE_STRING}getSessionToken(e){return st.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,st.resolve()}}class bI{constructor(){this.Qr=new Bs(ro.$r),this.Ur=new Bs(ro.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new ro(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new ro(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new yr(new xi([])),n=new ro(r,e),i=new ro(r,e+1),a=[];return this.Ur.forEachInRange([n,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new yr(new xi([])),n=new ro(r,e),i=new ro(r,e+1);let a=Io();return this.Ur.forEachInRange([n,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const r=new ro(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ro{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return yr.comparator(e.key,r.key)||gn(e.Yr,r.Yr)}static Kr(e,r){return gn(e.Yr,r.Yr)||yr.comparator(e.key,r.key)}}class eme{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Bs(ro.$r)}checkEmpty(e){return st.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fI(a,r,n,i);this.mutationQueue.push(o);for(const l of i)this.Zr=this.Zr.add(new ro(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return st.resolve(o)}lookupMutationBatch(e,r){return st.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return st.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return st.resolve(this.mutationQueue.length===0?Fp:this.tr-1)}getAllMutationBatches(e){return st.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ro(r,0),i=new ro(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],(o=>{const l=this.Xr(o.Yr);a.push(l)})),st.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Bs(gn);return r.forEach((i=>{const a=new ro(i,0),o=new ro(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(l=>{n=n.add(l.Yr)}))})),st.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;yr.isDocumentKey(a)||(a=a.child(""));const o=new ro(new yr(a),0);let l=new Bs(gn);return this.Zr.forEachWhile((c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.Yr)),!0)}),o),st.resolve(this.ti(l))}ti(e){const r=[];return e.forEach((n=>{const i=this.Xr(n);i!==null&&r.push(i)})),r}removeMutationBatch(e,r){qr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return st.forEach(r.mutations,(i=>{const a=new ro(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new ro(r,0),i=this.Zr.firstAfterOrEqual(n);return st.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,st.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class tme{constructor(e){this.ri=e,this.docs=(function(){return new Yl(yr.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return st.resolve(n?n.document.mutableCopy():To.newInvalidDocument(r))}getEntries(e,r){let n=Lp();return r.forEach((i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():To.newInvalidDocument(i))})),st.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Lp();const o=r.path,l=new yr(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||rI(vK(h),n)<=0||(i.has(h.key)||M4(r,h))&&(a=a.insert(h.key,h.mutableCopy()))}return st.resolve(a)}getAllFromCollectionGroup(e,r,n,i){Mr(9500)}ii(e,r){return st.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new rme(this)}getSize(e){return st.resolve(this.size)}}class rme extends _Y{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)})),st.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class nme{constructor(e){this.persistence=e,this.si=new F0((r=>tm(r)),$1),this.lastRemoteSnapshotVersion=Fn.min(),this.highestTargetId=0,this.oi=0,this._i=new bI,this.targetCount=0,this.ai=sm.ur()}forEachTarget(e,r){return this.si.forEach(((n,i)=>r(i))),st.resolve()}getLastRemoteSnapshotVersion(e){return st.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return st.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),st.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),st.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new sm(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,st.resolve()}updateTargetData(e,r){return this.Pr(r),st.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,st.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)})),st.waitFor(a).next((()=>i))}getTargetCount(e){return st.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return st.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),st.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),st.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),st.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return st.resolve(n)}containsKey(e,r){return st.resolve(this._i.containsKey(r))}}class EY{constructor(e,r){this.ui={},this.overlays={},this.ci=new Ru(0),this.li=!1,this.li=!0,this.hi=new Zpe,this.referenceDelegate=e(this),this.Pi=new nme(this),this.indexManager=new $pe,this.remoteDocumentCache=(function(i){return new tme(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new gY(r),this.Ii=new Qpe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Jpe,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new eme(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Xt("MemoryPersistence","Starting transaction:",e);const i=new sme(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,r){return st.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class sme extends NK{constructor(e){super(),this.currentSequenceNumber=e}}class U4{constructor(e){this.persistence=e,this.Ri=new bI,this.Vi=null}static mi(e){return new U4(e)}get fi(){if(this.Vi)return this.Vi;throw Mr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),st.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),st.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),st.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return st.forEach(this.fi,(n=>{const i=yr.fromPath(n);return this.gi(e,i).next((a=>{a||r.removeEntry(i,Fn.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return st.or([()=>st.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class ime{constructor(e){this.serializer=e}k(e,r,n,i){const a=new A4("createOrUpgrade",r);n<1&&i>=1&&((function(c){c.createObjectStore(B1)})(e),(function(c){c.createObjectStore(Mv,{keyPath:o0e}),c.createObjectStore(Su,{keyPath:lD,autoIncrement:!0}).createIndex(Ip,cD,{unique:!0}),c.createObjectStore(Px)})(e),KD(e),(function(c){c.createObjectStore(gp)})(e));let o=st.resolve();return n<3&&i>=3&&(n!==0&&((function(c){c.deleteObjectStore(Rx),c.deleteObjectStore(Ox),c.deleteObjectStore(Up)})(e),KD(e)),o=o.next((()=>(function(c){const u=c.store(Up),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Fn.min().toTimestamp(),targetCount:0};return u.put(DN,h)})(a)))),n<4&&i>=4&&(n!==0&&(o=o.next((()=>(function(c,u){return u.store(Su).J().next((p=>{c.deleteObjectStore(Su),c.createObjectStore(Su,{keyPath:lD,autoIncrement:!0}).createIndex(Ip,cD,{unique:!0});const m=u.store(Su),g=p.map((b=>m.put(b)));return st.waitFor(g)}))})(e,a)))),o=o.next((()=>{(function(c){c.createObjectStore(Mx,{keyPath:g0e})})(e)}))),n<5&&i>=5&&(o=o.next((()=>this.yi(a)))),n<6&&i>=6&&(o=o.next((()=>((function(c){c.createObjectStore(Dv)})(e),this.wi(a))))),n<7&&i>=7&&(o=o.next((()=>this.Si(a)))),n<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),n<9&&i>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&i>=10&&(o=o.next((()=>this.Di(a)))),n<11&&i>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(I4,{keyPath:x0e})})(e),(function(c){c.createObjectStore(L4,{keyPath:b0e})})(e)}))),n<12&&i>=12&&(o=o.next((()=>{(function(c){const u=c.createObjectStore(P4,{keyPath:_0e});u.createIndex(V6,S0e,{unique:!1}),u.createIndex(AK,C0e,{unique:!1})})(e)}))),n<13&&i>=13&&(o=o.next((()=>(function(c){const u=c.createObjectStore(MN,{keyPath:c0e});u.createIndex(V5,u0e),u.createIndex(_K,d0e)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(gp)))),n<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),n<15&&i>=15&&(o=o.next((()=>(function(c){c.createObjectStore(iI,{keyPath:y0e,autoIncrement:!0}).createIndex(q6,v0e,{unique:!1}),c.createObjectStore(cv,{keyPath:w0e}).createIndex(CK,N0e,{unique:!1}),c.createObjectStore(uv,{keyPath:j0e}).createIndex(EK,k0e,{unique:!1})})(e)))),n<16&&i>=16&&(o=o.next((()=>{r.objectStore(cv).clear()})).next((()=>{r.objectStore(uv).clear()}))),n<17&&i>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(aI,{keyPath:E0e})})(e)}))),n<18&&i>=18&&jG()&&(o=o.next((()=>{r.objectStore(cv).clear()})).next((()=>{r.objectStore(uv).clear()}))),o}wi(e){let r=0;return e.store(gp).ee(((n,i)=>{r+=GN(i)})).next((()=>{const n={byteSize:r};return e.store(Dv).put(z6,n)}))}yi(e){const r=e.store(Mv),n=e.store(Su);return r.J().next((i=>st.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,Fp],[a.userId,a.lastAcknowledgedBatchId]);return n.J(Ip,o).next((l=>st.forEach(l,(c=>{qr(c.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=kp(this.serializer,c);return NY(e,a.userId,u).next((()=>{}))}))))}))))}Si(e){const r=e.store(Rx),n=e.store(gp);return e.store(Up).get(DN).next((i=>{const a=[];return n.ee(((o,l)=>{const c=new xi(o),u=(function(p){return[0,fl(p)]})(c);a.push(r.get(u).next((h=>h?st.resolve():(p=>r.put({targetId:0,path:fl(p),sequenceNumber:i.highestListenSequenceNumber}))(c))))})).next((()=>st.waitFor(a)))}))}bi(e,r){e.createObjectStore(Bv,{keyPath:m0e});const n=r.store(Bv),i=new xI,a=o=>{if(i.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:fl(c)})}};return r.store(gp).ee({X:!0},((o,l)=>{const c=new xi(o);return a(c.popLast())})).next((()=>r.store(Px).ee({X:!0},(([o,l,c],u)=>{const h=kd(l);return a(h.popLast())}))))}Di(e){const r=e.store(Ox);return r.ee(((n,i)=>{const a=Ky(i),o=xY(this.serializer,a);return r.put(o)}))}Ci(e,r){const n=r.store(gp),i=[];return n.ee(((a,o)=>{const l=r.store(MN),c=(function(p){return p.document?new yr(xi.fromString(p.document.name).popFirst(5)):p.noDocument?yr.fromSegments(p.noDocument.path):p.unknownDocument?yr.fromSegments(p.unknownDocument.path):Mr(36783)})(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(u))})).next((()=>st.waitFor(i)))}Fi(e,r){const n=r.store(Su),i=SY(this.serializer),a=new EY(U4.mi,this.serializer.yt);return n.J().next((o=>{const l=new Map;return o.forEach((c=>{let u=l.get(c.userId)??Io();kp(this.serializer,c).keys().forEach((h=>u=u.add(h))),l.set(c.userId,u)})),st.forEach(l,((c,u)=>{const h=new Eo(u),p=$4.wt(this.serializer,h),m=a.getIndexManager(h),g=F4.wt(h,this.serializer,m,a.referenceDelegate);return new CY(i,g,p,m).recalculateAndSaveOverlaysForDocumentKeys(new H6(r,Ru.ce),c).next()}))}))}}function KD(t){t.createObjectStore(Rx,{keyPath:f0e}).createIndex(sI,p0e,{unique:!0}),t.createObjectStore(Ox,{keyPath:"targetId"}).createIndex(SK,h0e,{unique:!0}),t.createObjectStore(Up)}const Zf="IndexedDbPersistence",i3=18e5,a3=5e3,o3="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ame="main";class yI{constructor(e,r,n,i,a,o,l,c,u,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.Mi=a,this.window=o,this.document=l,this.xi=u,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!yI.v())throw new Nr(Mt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gpe(this,i),this.$i=r+ame,this.serializer=new gY(c),this.Ui=new j0(this.$i,this.Ni,new ime(this.serializer)),this.hi=new Ppe,this.Pi=new Upe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=SY(this.serializer),this.Ii=new Lpe,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&mc(Zf,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Nr(Mt.FAILED_PRECONDITION,o3);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ru(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async r=>{r.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Aw(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((r=>{r||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((r=>this.isPrimary&&!r?this.Zi(e).next((()=>!1)):!!r&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Im(e))return Xt(Zf,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Xt(Zf,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return wy(e).get(Tg).next((r=>st.resolve(this.es(r))))}ts(e){return Aw(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,i3)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(r=>{const n=Fa(r,Mx);return n.J().next((i=>{const a=this.ss(i,i3),o=i.filter((l=>a.indexOf(l)===-1));return st.forEach(o,(l=>n.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const r of e)this.Ki.removeItem(this._s(r.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?st.resolve(!0):wy(e).get(Tg).next((r=>{if(r!==null&&this.rs(r.leaseTimestampMs,a3)&&!this.us(r.ownerId)){if(this.es(r)&&this.networkEnabled)return!0;if(!this.es(r)){if(!r.allowTabSynchronization)throw new Nr(Mt.FAILED_PRECONDITION,o3);return!1}}return!(!this.networkEnabled||!this.inForeground)||Aw(e).J().next((n=>this.ss(n,a3).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(a||o&&l)return!0}return!1}))===void 0))})).next((r=>(this.isPrimary!==r&&Xt(Zf,`Client ${r?"is":"is not"} eligible for a primary lease.`),r)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[B1,Mx],(e=>{const r=new H6(e,Ru.ce);return this.Zi(r).next((()=>this.ts(r)))})),this.Ui.close(),this.Ps()}ss(e,r){return e.filter((n=>this.rs(n.updateTimeMs,r)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Aw(e).J().next((r=>this.ss(r,i3).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,r){return F4.wt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Fpe(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return $4.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,r,n){Xt(Zf,"Starting transaction:",e);const i=r==="readonly"?"readonly":"readwrite",a=(function(c){return c===18?I0e:c===17?PK:c===16?T0e:c===15?oI:c===14?LK:c===13?IK:c===12?A0e:c===11?TK:void Mr(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(l=>(o=new H6(l,this.ci?this.ci.next():Ru.ce),r==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw mc(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Nr(Mt.FAILED_PRECONDITION,wK);return n(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>n(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return wy(e).get(Tg).next((r=>{if(r!==null&&this.rs(r.leaseTimestampMs,a3)&&!this.us(r.ownerId)&&!this.es(r)&&!(this.Oi||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Nr(Mt.FAILED_PRECONDITION,o3)}))}Xi(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wy(e).put(Tg,r)}static v(){return j0.v()}Zi(e){const r=wy(e);return r.get(Tg).next((n=>this.es(n)?(Xt(Zf,"Releasing primary lease."),r.delete(Tg)):st.resolve()))}rs(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(mc(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;NG()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const r=this.Ki?.getItem(this._s(e))!==null;return Xt(Zf,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mc(Zf,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){mc("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function wy(t){return Fa(t,B1)}function Aw(t){return Fa(t,Mx)}function ome(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}class vI{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Io(),i=Io();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new vI(e,r.fromCache,n,i)}}class lme{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class AY{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return NG()?8:jK($a())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,r,i,n).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new lme;return this.Ss(e,r,o).next((l=>{if(a.result=l,this.Vs)return this.bs(e,r,o,l.size)}))})).next((()=>a.result))}bs(e,r,n,i){return n.documentReadCount<this.fs?(Wg()<=Sn.DEBUG&&Xt("QueryEngine","SDK will not create cache indexes for query:",gy(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),st.resolve()):(Wg()<=Sn.DEBUG&&Xt("QueryEngine","Query:",gy(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Wg()<=Sn.DEBUG&&Xt("QueryEngine","The SDK decides to create cache indexes for query:",gy(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Uh(r))):st.resolve())}ys(e,r){if(ND(r))return st.resolve(null);let n=Uh(r);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(r.limit!==null&&i===1&&(r=Q6(r,null,"F"),n=Uh(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((a=>{const o=Io(...a);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,n).next((c=>{const u=this.Ds(r,l);return this.Cs(r,u,o,c.readTime)?this.ys(e,Q6(r,null,"F")):this.vs(e,u,r,c)}))))})))))}ws(e,r,n,i){return ND(r)||i.isEqual(Fn.min())?st.resolve(null):this.ps.getDocuments(e,n).next((a=>{const o=this.Ds(r,a);return this.Cs(r,o,n,i)?st.resolve(null):(Wg()<=Sn.DEBUG&&Xt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gy(r)),this.vs(e,o,r,t0e(i,Ov)).next((l=>l)))}))}Ds(e,r){let n=new Bs(X0e(e));return r.forEach(((i,a)=>{M4(e,a)&&(n=n.add(a))})),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return Wg()<=Sn.DEBUG&&Xt("QueryEngine","Using full collection scan to execute query:",gy(r)),this.ps.getDocumentsMatchingQuery(e,r,kc.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next((a=>(r.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const cme="LocalStore";class ume{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Yl(gn),this.xs=new F0((a=>tm(a)),$1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CY(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function TY(t,e,r,n){return new ume(t,e,r,n)}async function dme(t,e){const r=ii(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next((a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((a=>{const o=[],l=[];let c=Io();for(const u of i){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of a){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next((u=>({Ls:u,removedBatchIds:o,addedBatchIds:l})))}))}))}function hme(t,e){const r=ii(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,c,u,h){const p=u.batch,m=p.keys();let g=st.resolve();return m.forEach((b=>{g=g.next((()=>h.getEntry(c,b))).next((v=>{const w=u.docVersions.get(b);qr(w!==null,48541),v.version.compareTo(w)<0&&(p.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),h.addEntry(v)))}))})),g.next((()=>l.mutationQueue.removeMutationBatch(c,p)))})(r,n,e,a).next((()=>a.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(l){let c=Io();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c})(e)))).next((()=>r.localDocuments.getDocuments(n,i)))}))}function fme(t){const e=ii(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function pme(t,e){const r=ii(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Fp),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}class YD{constructor(){this.activeTargetIds=npe()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class IY{constructor(){this.Mo=new YD,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new YD,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mme{Oo(e){}shutdown(){}}const XD="ConnectivityMonitor";class QD{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Xt(XD,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Xt(XD,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Tw=null;function sA(){return Tw===null?Tw=(function(){return 268435456+Math.round(2147483648*Math.random())})():Tw++,"0x"+Tw.toString(16)}const l3="RestConnection",gme={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xme{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===$N?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const o=sA(),l=this.zo(e,r.toUriEncodedString());Xt(l3,`Sending RPC '${e}' ${o}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,a);const{host:u}=new URL(l),h=Am(u);return this.Jo(e,l,c,n,h).then((p=>(Xt(l3,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw C4(l3,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",n),p}))}Ho(e,r,n,i,a,o){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+db})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((i,a)=>e[a]=i)),n&&n.headers.forEach(((i,a)=>e[a]=i))}zo(e,r){const n=gme[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class bme{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Vo="WebChannelConnection";class yme extends xme{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const o=sA();return new Promise(((l,c)=>{const u=new uK;u.setWithCredentials(!0),u.listenOnce(dK.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case U5.NO_ERROR:const p=u.getResponseJson();Xt(Vo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case U5.TIMEOUT:Xt(Vo,`RPC '${e}' ${o} timed out`),c(new Nr(Mt.DEADLINE_EXCEEDED,"Request time out"));break;case U5.HTTP_ERROR:const m=u.getStatus();if(Xt(Vo,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const b=g?.error;if(b&&b.status&&b.message){const v=(function(j){const _=j.toLowerCase().replace(/_/g,"-");return Object.values(Mt).indexOf(_)>=0?_:Mt.UNKNOWN})(b.status);c(new Nr(v,b.message))}else c(new Nr(Mt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Nr(Mt.UNAVAILABLE,"Connection failed."));break;default:Mr(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Xt(Vo,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Xt(Vo,`RPC '${e}' ${o} sending request:`,i),u.send(r,"POST",h,n,15)}))}T_(e,r,n){const i=sA(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=pK(),l=fK(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=a.join("");Xt(Vo,`Creating RPC '${e}' stream ${i}: ${h}`,c);const p=o.createWebChannel(h,c);this.I_(p);let m=!1,g=!1;const b=new bme({Yo:w=>{g?Xt(Vo,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(m||(Xt(Vo,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Xt(Vo,`RPC '${e}' stream ${i} sending:`,w),p.send(w))},Zo:()=>p.close()}),v=(w,j,_)=>{w.listen(j,(E=>{try{_(E)}catch(I){setTimeout((()=>{throw I}),0)}}))};return v(p,Gy.EventType.OPEN,(()=>{g||(Xt(Vo,`RPC '${e}' stream ${i} transport opened.`),b.o_())})),v(p,Gy.EventType.CLOSE,(()=>{g||(g=!0,Xt(Vo,`RPC '${e}' stream ${i} transport closed`),b.a_(),this.E_(p))})),v(p,Gy.EventType.ERROR,(w=>{g||(g=!0,C4(Vo,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),b.a_(new Nr(Mt.UNAVAILABLE,"The operation could not be completed")))})),v(p,Gy.EventType.MESSAGE,(w=>{if(!g){const j=w.data[0];qr(!!j,16349);const _=j,E=_?.error||_[0]?.error;if(E){Xt(Vo,`RPC '${e}' stream ${i} received error:`,E);const I=E.status;let O=(function(T){const M=fa[T];if(M!==void 0)return ppe(M)})(I),B=E.message;O===void 0&&(O=Mt.INTERNAL,B="Unknown error status: "+I+" with message "+E.message),g=!0,b.a_(new Nr(O,B)),p.close()}else Xt(Vo,`RPC '${e}' stream ${i} received:`,j),b.u_(j)}})),v(l,hK.STAT_EVENT,(w=>{w.stat===$6.PROXY?Xt(Vo,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===$6.NOPROXY&&Xt(Vo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{b.__()}),0),b}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function vme(){return typeof window<"u"?window:null}function Y5(){return typeof document<"u"?document:null}function LY(t){return new bpe(t,!0)}class PY{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Xt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const JD="PersistentStream";class wme{constructor(e,r,n,i,a,o,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new PY(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Mt.RESOURCE_EXHAUSTED?(mc(r.toString()),mc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Mt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===r&&this.G_(n,i)}),(n=>{e((()=>{const i=new Nr(Mt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Xt(JD,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Xt(JD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Nme extends wme{constructor(e,r,n,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return qr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=jpe(e.writeResults,e.commitTime),n=$u(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=wpe(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>VN(this.serializer,n)))};this.q_(r)}}class jme{}class kme extends jme{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Nr(Mt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,Z6(r,n),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Nr(Mt.UNKNOWN,a.toString())}))}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,Z6(r,n),i,o,l,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Nr(Mt.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _me{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mc(r),this.aa=!1):Xt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const z4="RemoteStore";class Sme{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{V4(this)&&(Xt(z4,"Restarting streams for network reachability change."),await(async function(c){const u=ii(c);u.Ea.add(4),await q4(u),u.Ra.set("Unknown"),u.Ea.delete(4),await wI(u)})(this))}))})),this.Ra=new _me(n,i)}}async function wI(t){if(V4(t))for(const e of t.da)await e(!0)}async function q4(t){for(const e of t.da)await e(!1)}function V4(t){return ii(t).Ea.size===0}async function OY(t,e,r){if(!Im(e))throw e;t.Ea.add(1),await q4(t),t.Ra.set("Offline"),r||(r=()=>fme(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Xt(z4,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await wI(t)}))}function RY(t,e){return e().catch((r=>OY(t,r,e)))}async function H4(t){const e=ii(t),r=P0(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fp;for(;Cme(e);)try{const i=await pme(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,Eme(e,i)}catch(i){await OY(e,i)}MY(e)&&DY(e)}function Cme(t){return V4(t)&&t.Ta.length<10}function Eme(t,e){t.Ta.push(e);const r=P0(t);r.O_()&&r.X_&&r.ea(e.mutations)}function MY(t){return V4(t)&&!P0(t).x_()&&t.Ta.length>0}function DY(t){P0(t).start()}async function Ame(t){P0(t).ra()}async function Tme(t){const e=P0(t);for(const r of t.Ta)e.ea(r.mutations)}async function Ime(t,e,r){const n=t.Ta.shift(),i=pI.from(n,e,r);await RY(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await H4(t)}async function Lme(t,e){e&&P0(t).X_&&await(async function(n,i){if((function(o){return fpe(o)&&o!==Mt.ABORTED})(i.code)){const a=n.Ta.shift();P0(n).B_(),await RY(n,(()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i))),await H4(n)}})(t,e),MY(t)&&DY(t)}async function Pme(t,e){const r=ii(t);e?(r.Ea.delete(2),await wI(r)):e||(r.Ea.add(2),await q4(r),r.Ra.set("Unknown"))}function P0(t){return t.fa||(t.fa=(function(r,n,i){const a=ii(r);return a.sa(),new Nme(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ame.bind(null,t),r_:Lme.bind(null,t),ta:Tme.bind(null,t),na:Ime.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await H4(t)):(await t.fa.stop(),t.Ta.length>0&&(Xt(z4,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class NI{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new $p,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,l=new NI(e,r,o,i,a);return l.start(n),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Nr(Mt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ome(t,e){if(mc("AsyncQueue",`${e}: ${t}`),Im(t))return new Nr(Mt.UNAVAILABLE,`${e}: ${t}`);throw t}class Rme{constructor(){this.queries=ZD(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ii(r),a=i.queries;i.queries=ZD(),a.forEach(((o,l)=>{for(const c of l.Sa)c.onError(n)}))})(this,new Nr(Mt.ABORTED,"Firestore shutting down"))}}function ZD(){return new F0((t=>ZK(t)),JK)}function Mme(t){t.Ca.forEach((e=>{e.next()}))}var e9,t9;(t9=e9||(e9={})).Ma="default",t9.Cache="cache";const Dme="SyncEngine";class Bme{constructor(e,r,n,i,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new F0((l=>ZK(l)),JK),this.Iu=new Map,this.Eu=new Set,this.du=new Yl(yr.comparator),this.Au=new Map,this.Ru=new bI,this.Vu={},this.mu=new Map,this.fu=sm.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function r9(t,e,r){const n=ii(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach(((a,o)=>{const l=o.view.va(e);l.snapshot&&i.push(l.snapshot)})),(function(o,l){const c=ii(o);c.onlineState=l;let u=!1;c.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(l)&&(u=!0)})),u&&Mme(c)})(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $me(t,e){const r=ii(t),n=e.batch.batchId;try{const i=await hme(r.localStore,e);$Y(r,n,null),BY(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await jI(r,i)}catch(i){await E4(i)}}async function Fme(t,e,r){const n=ii(t);try{const i=await(function(o,l){const c=ii(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next((p=>(qr(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(u,p)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(n.localStore,e);$Y(n,e,r),BY(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await jI(n,i)}catch(i){await E4(i)}}function BY(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function $Y(t,e,r){const n=ii(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}async function jI(t,e,r){const n=ii(t),i=[],a=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((l,c)=>{o.push(n.pu(c,e,r).then((u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){i.push(u);const h=vI.As(c.targetId,u);a.push(h)}})))})),await Promise.all(o),n.Pu.H_(i),await(async function(c,u){const h=ii(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>st.forEach(u,(m=>st.forEach(m.Es,(g=>h.persistence.referenceDelegate.addReference(p,m.targetId,g))).next((()=>st.forEach(m.ds,(g=>h.persistence.referenceDelegate.removeReference(p,m.targetId,g)))))))))}catch(p){if(!Im(p))throw p;Xt(cme,"Failed to update sequence numbers: "+p)}for(const p of u){const m=p.targetId;if(!p.fromCache){const g=h.Ms.get(m),b=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(b);h.Ms=h.Ms.insert(m,v)}}})(n.localStore,a))}async function Ume(t,e){const r=ii(t);if(!r.currentUser.isEqual(e)){Xt(Dme,"User change. New user:",e.toKey());const n=await dme(r.localStore,e);r.currentUser=e,(function(a,o){a.mu.forEach((l=>{l.forEach((c=>{c.reject(new Nr(Mt.CANCELLED,o))}))})),a.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await jI(r,n.Ls)}}function zme(t){const e=ii(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$me.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fme.bind(null,e),e}class iA{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=LY(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return TY(this.persistence,new AY,e.initialUser,this.serializer)}Cu(e){return new EY(U4.mi,this.serializer)}Du(e){return new IY}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}iA.provider={build:()=>new iA};class qme extends iA{constructor(e,r,n){super(),this.xu=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await zme(this.xu.syncEngine),await H4(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return TY(this.persistence,new AY,e.initialUser,this.serializer)}Fu(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new Vpe(n,e.asyncQueue,r)}Mu(e,r){const n=new i0e(r,this.persistence);return new s0e(e.asyncQueue,n)}Cu(e){const r=ome(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Wl.withCacheSize(this.cacheSizeBytes):Wl.DEFAULT;return new yI(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,vme(),Y5(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new IY}}class aA{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>r9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ume.bind(null,this.syncEngine),await Pme(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Rme})()}createDatastore(e){const r=LY(e.databaseInfo.databaseId),n=(function(a){return new yme(a)})(e.databaseInfo);return(function(a,o,l,c){return new kme(a,o,l,c)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,i,a,o,l){return new Sme(n,i,a,o,l)})(this.localStore,this.datastore,e.asyncQueue,(r=>r9(this.syncEngine,r,0)),(function(){return QD.v()?new QD:new mme})())}createSyncEngine(e,r){return(function(i,a,o,l,c,u,h){const p=new Bme(i,a,o,l,c,u);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=ii(r);Xt(z4,"RemoteStore shutting down."),n.Ea.add(5),await q4(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}aA.provider={build:()=>new aA};const n9="FirestoreClient";class Vme{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Eo.UNAUTHENTICATED,this.clientId=xK.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async o=>{Xt(n9,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Xt(n9,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $p;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Ome(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function FY(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const s9=new Map;const UY="firestore.googleapis.com",i9=!0;class a9{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Nr(Mt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UY,this.ssl=i9}else this.host=e.host,this.ssl=e.ssl??i9;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=wY;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zpe)throw new Nr(Mt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Jfe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FY(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Nr(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Nr(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Nr(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zY{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new a9({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Nr(Mt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Nr(Mt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new a9(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new zfe;switch(n.type){case"firstParty":return new Wfe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Nr(Mt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=s9.get(r);n&&(Xt("ComponentProvider","Removing Datastore"),s9.delete(r),n.terminate())})(this),Promise.resolve()}}function Hme(t,e,r,n={}){t=yK(t,zY);const i=Am(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&($8(`https://${l}`),F8("Firestore",!0)),a.host!==UY&&a.host!==l&&C4("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:l,ssl:i,emulatorOptions:n};if(!Xp(c,o)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=Eo.MOCK_USER;else{u=vG(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Nr(Mt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Eo(p)}t._authCredentials=new qfe(new gK(u,h))}}let Wme=class qY{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new qY(this.firestore,e,this._query)}};class Sd{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kI(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sd(this.firestore,e,this._key)}toJSON(){return{type:Sd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(D1(r,Sd._jsonSchema))return new Sd(e,n||null,new yr(xi.fromString(r.referencePath)))}}Sd._jsonSchemaVersion="firestore/documentReference/1.0",Sd._jsonSchema={type:xa("string",Sd._jsonSchemaVersion),referencePath:xa("string")};class kI extends Wme{constructor(e,r,n){super(e,r,QK(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sd(this.firestore,null,new yr(e))}withConverter(e){return new kI(this.firestore,e,this._path)}}const o9="AsyncQueue";class l9{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new PY(this,"async_queue_retry"),this._c=()=>{const n=Y5();n&&Xt(o9,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Y5();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Y5();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new $p;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Im(e))throw e;Xt(o9,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,mc("INTERNAL UNHANDLED ERROR: ",c9(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=NI.createAndSchedule(this,e,r,n,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Mr(47125,{Pc:c9(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function c9(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class VY extends zY{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new l9,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l9(e),this._firestoreClient=void 0,await e}}}function Gme(t,e){const r=typeof t=="object"?t:q8(),n=typeof t=="string"?t:$N,i=j4(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=xG("firestore");a&&Hme(i,...a)}return i}function Kme(t){const e=t._freezeSettings(),r=(function(i,a,o,l){return new R0e(i,a,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,FY(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Vme(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(t._componentsProvider))}function Yme(t,e){C4("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Xme(t,aA.provider,{build:n=>new qme(n,r.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Xme(t,e,r){if((t=yK(t,VY))._firestoreClient||t._terminated)throw new Nr(Mt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Nr(Mt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},Kme(t)}class Ch{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ch(Xl.fromBase64String(e))}catch(r){throw new Nr(Mt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ch(Xl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ch._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(D1(e,Ch._jsonSchema))return Ch.fromBase64String(e.bytes)}}Ch._jsonSchemaVersion="firestore/bytes/1.0",Ch._jsonSchema={type:xa("string",Ch._jsonSchemaVersion),bytes:xa("string")};class HY{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Nr(Mt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sa(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zp{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Nr(Mt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Nr(Mt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return gn(this._lat,e._lat)||gn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zp._jsonSchemaVersion}}static fromJSON(e){if(D1(e,zp._jsonSchema))return new zp(e.latitude,e.longitude)}}zp._jsonSchemaVersion="firestore/geoPoint/1.0",zp._jsonSchema={type:xa("string",zp._jsonSchemaVersion),latitude:xa("number"),longitude:xa("number")};class qp{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:qp._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(D1(e,qp._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new qp(e.vectorValues);throw new Nr(Mt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qp._jsonSchemaVersion="firestore/vectorValue/1.0",qp._jsonSchema={type:xa("string",qp._jsonSchemaVersion),vectorValues:xa("object")};const Qme=new RegExp("[~\\*/\\[\\]]");function Jme(t,e,r){if(e.search(Qme)>=0)throw u9(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new HY(...e.split("."))._internalPath}catch{throw u9(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function u9(t,e,r,n,i){let a=`Function ${e}() called with invalid data`;a+=". ";let o="";return new Nr(Mt.INVALID_ARGUMENT,a+t+o)}class WY{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Sd(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Zme(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(GY("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Zme extends WY{data(){return super.data()}}function GY(t,e){return typeof e=="string"?Jme(t,e):e instanceof HY?e._internalPath:e._delegate._internalPath}class Iw{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class px extends WY{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new X5(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(GY("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Nr(Mt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=px._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}px._jsonSchemaVersion="firestore/documentSnapshot/1.0",px._jsonSchema={type:xa("string",px._jsonSchemaVersion),bundleSource:xa("string","DocumentSnapshot"),bundleName:xa("string"),bundle:xa("string")};class X5 extends px{data(e={}){return super.data(e)}}class mv{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Iw(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new X5(this._firestore,this._userDataWriter,n.key,n,new Iw(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Nr(Mt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((l=>{const c=new X5(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Iw(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>a||l.type!==3)).map((l=>{const c=new X5(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Iw(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:ege(l.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Nr(Mt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mv._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xK.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ege(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr(61501,{type:t})}}mv._jsonSchemaVersion="firestore/querySnapshot/1.0",mv._jsonSchema={type:xa("string",mv._jsonSchemaVersion),bundleSource:xa("string","QuerySnapshot"),bundleName:xa("string"),bundle:xa("string")};(function(e,r=!0){(function(i){db=i})(Tm),Qp(new T0("firestore",((n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new VY(new Vfe(n.getProvider("auth-internal")),new Gfe(o,n.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Nr(Mt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bx(u.options.projectId,h)})(o,i),o);return a={useFetchStreams:r,...a},l._setSettings(a),l}),"PUBLIC").setMultipleInstances(!0)),Id(eD,tD,e),Id(eD,tD,"esm2020")})();const KY="firebasestorage.googleapis.com",tge="storageBucket",rge=120*1e3,nge=600*1e3;class Kd extends Gd{constructor(e,r,n=0){super(c3(e),`Firebase Storage: ${r} (${c3(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Kd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return c3(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Bd;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Bd||(Bd={}));function c3(t){return"storage/"+t}function sge(){const t="An unknown error occurred, please check the error payload for server response.";return new Kd(Bd.UNKNOWN,t)}function ige(){return new Kd(Bd.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function age(){return new Kd(Bd.CANCELED,"User canceled the upload/download.")}function oge(t){return new Kd(Bd.INVALID_URL,"Invalid URL '"+t+"'.")}function lge(t){return new Kd(Bd.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function d9(t){return new Kd(Bd.INVALID_ARGUMENT,t)}function YY(){return new Kd(Bd.APP_DELETED,"The Firebase app was deleted.")}function cge(t){return new Kd(Bd.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Du{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Du.makeFromUrl(e,r)}catch{return new Du(e,"")}if(n.path==="")return n;throw lge(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const h="v[A-Za-z0-9_]+",p=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",g=new RegExp(`^https?://${p}/${h}/b/${i}/o${m}`,"i"),b={bucket:1,path:3},v=r===KY?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",j=new RegExp(`^https?://${v}/${i}/${w}`,"i"),E=[{regex:l,indices:c,postModify:a},{regex:g,indices:b,postModify:u},{regex:j,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<E.length;I++){const O=E[I],B=O.regex.exec(e);if(B){const S=B[O.indices.bucket];let T=B[O.indices.path];T||(T=""),n=new Du(S,T),O.postModify(n);break}}if(n==null)throw oge(e);return n}}class uge{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function dge(t,e,r){let n=1,i=null,a=null,o=!1,l=0;function c(){return l===2}let u=!1;function h(...w){u||(u=!0,e.apply(null,w))}function p(w){i=setTimeout(()=>{i=null,t(g,c())},w)}function m(){a&&clearTimeout(a)}function g(w,...j){if(u){m();return}if(w){m(),h.call(null,w,...j);return}if(c()||o){m(),h.call(null,w,...j);return}n<64&&(n*=2);let E;l===1?(l=2,E=0):E=(n+Math.random())*1e3,p(E)}let b=!1;function v(w){b||(b=!0,m(),!u&&(i!==null?(w||(l=2),clearTimeout(i),p(0)):w||(l=1)))}return p(0),a=setTimeout(()=>{o=!0,v(!0)},r),v}function hge(t){t(!1)}function fge(t){return t!==void 0}function h9(t,e,r,n){if(n<e)throw d9(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw d9(`Invalid value for '${t}'. Expected ${r} or less.`)}function pge(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var KN;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(KN||(KN={}));function mge(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}class gge{constructor(e,r,n,i,a,o,l,c,u,h,p,m=!0,g=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,v)=>{this.resolve_=b,this.reject_=v,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Lw(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const l=a.getErrorCode()===KN.NO_ERROR,c=a.getStatus();if(!l||mge(c,this.additionalRetryCodes_)&&this.retry){const h=a.getErrorCode()===KN.ABORT;n(!1,new Lw(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new Lw(u,a))})},r=(n,i)=>{const a=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());fge(c)?a(c):a()}catch(c){o(c)}else if(l!==null){const c=sge();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(i.canceled){const c=this.appDelete_?YY():age();o(c)}else{const c=ige();o(c)}};this.canceled_?r(!1,new Lw(!1,null,!0)):this.backoffId_=dge(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&hge(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Lw{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function xge(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function bge(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function yge(t,e){e&&(t["X-Firebase-GMPID"]=e)}function vge(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function wge(t,e,r,n,i,a,o=!0,l=!1){const c=pge(t.urlParams),u=t.url+c,h=Object.assign({},t.headers);return yge(h,e),xge(h,r),bge(h,a),vge(h,n),new gge(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,l)}function Nge(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function jge(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class YN{constructor(e,r){this._service=e,r instanceof Du?this._location=r:this._location=Du.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new YN(e,r)}get root(){const e=new Du(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return jge(this._location.path)}get storage(){return this._service}get parent(){const e=Nge(this._location.path);if(e===null)return null;const r=new Du(this._location.bucket,e);return new YN(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw cge(e)}}function f9(t,e){const r=e?.[tge];return r==null?null:Du.makeFromBucketSpec(r,t)}function kge(t,e,r,n={}){t.host=`${e}:${r}`;const i=Am(e);i&&($8(`https://${t.host}/b`),F8("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:vG(a,t.app.options.projectId))}class _ge{constructor(e,r,n,i,a,o=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=o,this._bucket=null,this._host=KY,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rge,this._maxUploadRetryTime=nge,this._requests=new Set,i!=null?this._bucket=Du.makeFromBucketSpec(i,this._host):this._bucket=f9(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Du.makeFromBucketSpec(this._url,e):this._bucket=f9(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){h9("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){h9("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Gl(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new YN(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new uge(YY());{const o=wge(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const p9="@firebase/storage",m9="0.14.0";const XY="storage";function Sge(t=q8(),e){t=Qu(t);const n=j4(t,XY).getImmediate({identifier:e}),i=xG("storage");return i&&Cge(n,...i),n}function Cge(t,e,r,n={}){kge(t,e,r,n)}function Ege(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new _ge(r,n,i,e,Tm)}function Age(){Qp(new T0(XY,Ege,"PUBLIC").setMultipleInstances(!0)),Id(p9,m9,""),Id(p9,m9,"esm2020")}Age();const Tge={apiKey:"AIzaSyAdqbFNjrB6y-8BrMEYYCT5ywiCgZVtMaE",authDomain:"mtglibrary-70b46.firebaseapp.com",projectId:"mtglibrary-70b46",storageBucket:"mtglibrary-70b46.firebasestorage.app",messagingSenderId:"602862103839",appId:"1:602862103839:web:23c64b7486c058c903d42a",measurementId:"G-EWELJJQ631"},_I=CG(Tge),wd=Bfe(_I),Ige=Gme(_I);Yme(Ige).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):t.code=="unimplemented"&&console.warn("Firestore persistence not supported in this browser")});Sge(_I);var fb=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Lge={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Pge=class{#e=Lge;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Rh=new Pge;function Oge(t){setTimeout(t,0)}var im=typeof window>"u"||"Deno"in globalThis;function Pa(){}function Rge(t,e){return typeof t=="function"?t(e):t}function oA(t){return typeof t=="number"&&t>=0&&t!==1/0}function QY(t,e){return Math.max(t+(e||0)-Date.now(),0)}function k0(t,e){return typeof t=="function"?t(e):t}function Gc(t,e){return typeof t=="function"?t(e):t}function g9(t,e){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:o,stale:l}=t;if(o){if(n){if(e.queryHash!==SI(o,e.options))return!1}else if(!qv(e.queryKey,o))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||i&&i!==e.state.fetchStatus||a&&!a(e))}function x9(t,e){const{exact:r,status:n,predicate:i,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(r){if(am(e.options.mutationKey)!==am(a))return!1}else if(!qv(e.options.mutationKey,a))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function SI(t,e){return(e?.queryKeyHashFn||am)(t)}function am(t){return JSON.stringify(t,(e,r)=>lA(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function qv(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>qv(t[r],e[r])):!1}var Mge=Object.prototype.hasOwnProperty;function JY(t,e,r=0){if(t===e)return t;if(r>500)return e;const n=b9(t)&&b9(e);if(!n&&!(lA(t)&&lA(e)))return e;const a=(n?t:Object.keys(t)).length,o=n?e:Object.keys(e),l=o.length,c=n?new Array(l):{};let u=0;for(let h=0;h<l;h++){const p=n?h:o[h],m=t[p],g=e[p];if(m===g){c[p]=m,(n?h<a:Mge.call(t,p))&&u++;continue}if(m===null||g===null||typeof m!="object"||typeof g!="object"){c[p]=g;continue}const b=JY(m,g,r+1);c[p]=b,b===m&&u++}return a===l&&u===a?t:c}function XN(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function b9(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function lA(t){if(!y9(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!y9(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function y9(t){return Object.prototype.toString.call(t)==="[object Object]"}function Dge(t){return new Promise(e=>{Rh.setTimeout(e,t)})}function cA(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?JY(t,e):e}function Bge(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function $ge(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var CI=Symbol();function ZY(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===CI?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function EI(t,e){return typeof t=="function"?t(...e):!!t}function Fge(t,e,r){let n=!1,i;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(i??=e(),n||(n=!0,i.aborted?r():i.addEventListener("abort",r,{once:!0})),i)}),t}var Uge=class extends fb{#e;#t;#r;constructor(){super(),this.#r=t=>{if(!im&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},AI=new Uge;function uA(){let t,e;const r=new Promise((i,a)=>{t=i,e=a});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),t(i)},r.reject=i=>{n({status:"rejected",reason:i}),e(i)},r}function zge(t){let e;if(t.then(r=>(e=r,r),Pa)?.catch(Pa),e!==void 0)return{data:e}}function eX(t){return t}function qge(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function Vge(t,e,r){const n=()=>{const i=t.promise?.then(e).catch(a=>r(a)?Promise.reject(new Error("redacted")):Promise.reject(a));return i?.catch(Pa),i};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:n()},...t.meta&&{meta:t.meta}}}function Hge(t){return t.state.isPaused}function Wge(t){return t.state.status==="success"}function Gge(t){return!0}function Kge(t,e={}){const r=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??Hge,n=t.getMutationCache().getAll().flatMap(c=>r(c)?[qge(c)]:[]),i=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??Wge,a=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??Gge,o=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??eX,l=t.getQueryCache().getAll().flatMap(c=>i(c)?[Vge(c,o,a)]:[]);return{mutations:n,queries:l}}function Yge(t,e,r){if(typeof e!="object"||e===null)return;const n=t.getMutationCache(),i=t.getQueryCache(),a=r?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??eX,o=e.mutations||[],l=e.queries||[];o.forEach(({state:c,...u})=>{n.build(t,{...t.getDefaultOptions().hydrate?.mutations,...r?.defaultOptions?.mutations,...u},c)}),l.forEach(({queryKey:c,state:u,queryHash:h,meta:p,promise:m,dehydratedAt:g})=>{const b=m?zge(m):void 0,v=u.data===void 0?b?.data:u.data,w=v===void 0?v:a(v);let j=i.get(h);const _=j?.state.status==="pending",E=j?.state.fetchStatus==="fetching";if(j){const I=b&&g!==void 0&&g>j.state.dataUpdatedAt;if(u.dataUpdatedAt>j.state.dataUpdatedAt||I){const{fetchStatus:O,...B}=u;j.setState({...B,data:w})}}else j=i.build(t,{...t.getDefaultOptions().hydrate?.queries,...r?.defaultOptions?.queries,queryKey:c,queryHash:h,meta:p},{...u,data:w,fetchStatus:"idle",status:w!==void 0?"success":u.status});m&&!_&&!E&&(g===void 0||g>j.state.dataUpdatedAt)&&j.fetch(void 0,{initialPromise:Promise.resolve(m).then(a)}).catch(Pa)})}var Xge=Oge;function Qge(){let t=[],e=0,r=l=>{l()},n=l=>{l()},i=Xge;const a=l=>{e?t.push(l):i(()=>{r(l)})},o=()=>{const l=t;t=[],l.length&&i(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||o()}return c},batchCalls:l=>(...c)=>{a(()=>{l(...c)})},schedule:a,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var Ba=Qge(),Jge=class extends fb{#e=!0;#t;#r;constructor(){super(),this.#r=t=>{if(!im&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},QN=new Jge;function Zge(t){return Math.min(1e3*2**t,3e4)}function tX(t){return(t??"online")==="online"?QN.isOnline():!0}var dA=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function rX(t){let e=!1,r=0,n;const i=uA(),a=()=>i.status!=="pending",o=v=>{if(!a()){const w=new dA(v);m(w),t.onCancel?.(w)}},l=()=>{e=!0},c=()=>{e=!1},u=()=>AI.isFocused()&&(t.networkMode==="always"||QN.isOnline())&&t.canRun(),h=()=>tX(t.networkMode)&&t.canRun(),p=v=>{a()||(n?.(),i.resolve(v))},m=v=>{a()||(n?.(),i.reject(v))},g=()=>new Promise(v=>{n=w=>{(a()||u())&&v(w)},t.onPause?.()}).then(()=>{n=void 0,a()||t.onContinue?.()}),b=()=>{if(a())return;let v;const w=r===0?t.initialPromise:void 0;try{v=w??t.fn()}catch(j){v=Promise.reject(j)}Promise.resolve(v).then(p).catch(j=>{if(a())return;const _=t.retry??(im?0:3),E=t.retryDelay??Zge,I=typeof E=="function"?E(r,j):E,O=_===!0||typeof _=="number"&&r<_||typeof _=="function"&&_(r,j);if(e||!O){m(j);return}r++,t.onFail?.(r,j),Dge(I).then(()=>u()?void 0:g()).then(()=>{e?m(j):b()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n?.(),i),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?b():g().then(b),i)}}var nX=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),oA(this.gcTime)&&(this.#e=Rh.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(im?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Rh.clearTimeout(this.#e),this.#e=void 0)}},exe=class extends nX{#e;#t;#r;#s;#n;#a;#o;constructor(t){super(),this.#o=!1,this.#a=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#s=t.client,this.#r=this.#s.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=w9(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(t){if(this.options={...this.#a,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=w9(this.options);e.data!==void 0&&(this.setState(v9(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(t,e){const r=cA(this.state.data,t,this.options);return this.#i({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#i({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#n?.promise;return this.#n?.cancel(t),e?e.then(Pa).catch(Pa):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>Gc(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===CI||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>k0(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!QY(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#n&&(this.#o?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(c=>c.options.queryFn);l&&this.setOptions(l.options)}const r=new AbortController,n=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#o=!0,r.signal)})},i=()=>{const l=ZY(this.options,e),u=(()=>{const h={client:this.#s,queryKey:this.queryKey,meta:this.meta};return n(h),h})();return this.#o=!1,this.options.persister?this.options.persister(l,u,this):l(u)},o=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:i};return n(l),l})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=rX({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof dA&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(l,c)=>{this.#i({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#n.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#r.config.onSuccess?.(l,this),this.#r.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof dA){if(l.silent)return this.#n.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#i({type:"error",error:l}),this.#r.config.onError?.(l,this),this.#r.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#i(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...sX(r.data,this.options),fetchMeta:t.meta??null};case"success":const n={...r,...v9(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?n:void 0,n;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),Ba.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:t})})}};function sX(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:tX(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function v9(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function w9(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var txe=class extends fb{constructor(t,e){super(),this.options=e,this.#e=t,this.#i=null,this.#o=uA(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#r=void 0;#s=void 0;#n;#a;#o;#i;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),N9(this.#t,this.options)?this.#d():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return hA(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return hA(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Gc(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#N(),this.#t.setOptions(this.options),e._defaulted&&!XN(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const n=this.hasListeners();n&&j9(this.#t,r,this.options,e)&&this.#d(),this.updateResult(),n&&(this.#t!==r||Gc(this.options.enabled,this.#t)!==Gc(e.enabled,this.#t)||k0(this.options.staleTime,this.#t)!==k0(e.staleTime,this.#t))&&this.#g();const i=this.#x();n&&(this.#t!==r||Gc(this.options.enabled,this.#t)!==Gc(e.enabled,this.#t)||i!==this.#l)&&this.#b(i)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(e,t);return nxe(this,r)&&(this.#s=r,this.#a=this.options,this.#n=this.#t.state),r}getCurrentResult(){return this.#s}trackResult(t,e){return new Proxy(t,{get:(r,n)=>(this.trackProp(n),e?.(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,n))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#d(t){this.#N();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Pa)),e}#g(){this.#v();const t=k0(this.options.staleTime,this.#t);if(im||this.#s.isStale||!oA(t))return;const r=QY(this.#s.dataUpdatedAt,t)+1;this.#c=Rh.setTimeout(()=>{this.#s.isStale||this.updateResult()},r)}#x(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#b(t){this.#w(),this.#l=t,!(im||Gc(this.options.enabled,this.#t)===!1||!oA(this.#l)||this.#l===0)&&(this.#u=Rh.setInterval(()=>{(this.options.refetchIntervalInBackground||AI.isFocused())&&this.#d()},this.#l))}#y(){this.#g(),this.#b(this.#x())}#v(){this.#c&&(Rh.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(Rh.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const r=this.#t,n=this.options,i=this.#s,a=this.#n,o=this.#a,c=t!==r?t.state:this.#r,{state:u}=t;let h={...u},p=!1,m;if(e._optimisticResults){const T=this.hasListeners(),M=!T&&N9(t,e),$=T&&j9(t,r,e,n);(M||$)&&(h={...h,...sX(u.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:b,status:v}=h;m=h.data;let w=!1;if(e.placeholderData!==void 0&&m===void 0&&v==="pending"){let T;i?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(T=i.data,w=!0):T=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,T!==void 0&&(v="success",m=cA(i?.data,T,e),p=!0)}if(e.select&&m!==void 0&&!w)if(i&&m===a?.data&&e.select===this.#m)m=this.#h;else try{this.#m=e.select,m=e.select(m),m=cA(i?.data,m,e),this.#h=m,this.#i=null}catch(T){this.#i=T}this.#i&&(g=this.#i,m=this.#h,b=Date.now(),v="error");const j=h.fetchStatus==="fetching",_=v==="pending",E=v==="error",I=_&&j,O=m!==void 0,S={status:v,fetchStatus:h.fetchStatus,isPending:_,isSuccess:v==="success",isError:E,isInitialLoading:I,isLoading:I,data:m,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:b,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:j,isRefetching:j&&!_,isLoadingError:E&&!O,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:E&&O,isStale:TI(t,e),refetch:this.refetch,promise:this.#o,isEnabled:Gc(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=S.data!==void 0,M=S.status==="error"&&!T,$=R=>{M?R.reject(S.error):T&&R.resolve(S.data)},k=()=>{const R=this.#o=S.promise=uA();$(R)},L=this.#o;switch(L.status){case"pending":t.queryHash===r.queryHash&&$(L);break;case"fulfilled":(M||S.data!==L.value)&&k();break;case"rejected":(!M||S.error!==L.reason)&&k();break}}return S}updateResult(){const t=this.#s,e=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#a=this.options,this.#n.data!==void 0&&(this.#f=this.#t),XN(e,t))return;this.#s=e;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,i=typeof n=="function"?n():n;if(i==="all"||!i&&!this.#p.size)return!0;const a=new Set(i??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#s).some(o=>{const l=o;return this.#s[l]!==t[l]&&a.has(l)})};this.#j({listeners:r()})}#N(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#r=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#j(t){Ba.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function rxe(t,e){return Gc(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function N9(t,e){return rxe(t,e)||t.state.data!==void 0&&hA(t,e,e.refetchOnMount)}function hA(t,e,r){if(Gc(e.enabled,t)!==!1&&k0(e.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&TI(t,e)}return!1}function j9(t,e,r,n){return(t!==e||Gc(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&TI(t,r)}function TI(t,e){return Gc(e.enabled,t)!==!1&&t.isStaleByTime(k0(e.staleTime,t))}function nxe(t,e){return!XN(t.getCurrentResult(),e)}function k9(t){return{onFetch:(e,r)=>{const n=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,a=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let h=!1;const p=b=>{Fge(b,()=>e.signal,()=>h=!0)},m=ZY(e.options,e.fetchOptions),g=async(b,v,w)=>{if(h)return Promise.reject();if(v==null&&b.pages.length)return Promise.resolve(b);const _=(()=>{const B={client:e.client,queryKey:e.queryKey,pageParam:v,direction:w?"backward":"forward",meta:e.options.meta};return p(B),B})(),E=await m(_),{maxPages:I}=e.options,O=w?$ge:Bge;return{pages:O(b.pages,E,I),pageParams:O(b.pageParams,v,I)}};if(i&&a.length){const b=i==="backward",v=b?sxe:_9,w={pages:a,pageParams:o},j=v(n,w);l=await g(w,j,b)}else{const b=t??a.length;do{const v=c===0?o[0]??n.initialPageParam:_9(n,l);if(c>0&&v==null)break;l=await g(l,v),c++}while(c<b)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=u}}}function _9(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function sxe(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var ixe=class extends nX{#e;#t;#r;#s;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#r=t.mutationCache,this.#t=[],this.state=t.state||iX(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#n({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=rX({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(a,o)=>{this.#n({type:"failed",failureCount:a,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const n=this.state.status==="pending",i=!this.#s.canStart();try{if(n)e();else{this.#n({type:"pending",variables:t,isPaused:i}),await this.#r.config.onMutate?.(t,this,r);const o=await this.options.onMutate?.(t,r);o!==this.state.context&&this.#n({type:"pending",context:o,variables:t,isPaused:i})}const a=await this.#s.start();return await this.#r.config.onSuccess?.(a,t,this.state.context,this,r),await this.options.onSuccess?.(a,t,this.state.context,r),await this.#r.config.onSettled?.(a,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(a,null,t,this.state.context,r),this.#n({type:"success",data:a}),a}catch(a){try{await this.#r.config.onError?.(a,t,this.state.context,this,r)}catch(o){Promise.reject(o)}try{await this.options.onError?.(a,t,this.state.context,r)}catch(o){Promise.reject(o)}try{await this.#r.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,r)}catch(o){Promise.reject(o)}try{await this.options.onSettled?.(void 0,a,t,this.state.context,r)}catch(o){Promise.reject(o)}throw this.#n({type:"error",error:a}),a}finally{this.#r.runNext(this)}}#n(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Ba.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(t)}),this.#r.notify({mutation:this,type:"updated",action:t})})}};function iX(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var axe=class extends fb{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(t,e,r){const n=new ixe({client:t,mutationCache:this,mutationId:++this.#r,options:t.defaultMutationOptions(e),state:r});return this.add(n),n}add(t){this.#e.add(t);const e=Pw(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Pw(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const n=r.indexOf(t);n!==-1&&r.splice(n,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Pw(t);if(typeof e=="string"){const n=this.#t.get(e)?.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){const e=Pw(t);return typeof e=="string"?this.#t.get(e)?.find(n=>n!==t&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ba.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>x9(e,r))}findAll(t={}){return this.getAll().filter(e=>x9(t,e))}notify(t){Ba.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Ba.batch(()=>Promise.all(t.map(e=>e.continue().catch(Pa))))}};function Pw(t){return t.options.scope?.id}var oxe=class extends fb{#e;#t=void 0;#r;#s;constructor(e,r){super(),this.#e=e,this.setOptions(r),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#e.defaultMutationOptions(e),XN(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),r?.mutationKey&&this.options.mutationKey&&am(r.mutationKey)!==am(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#a()}mutate(e,r){return this.#s=r,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#n(){const e=this.#r?.state??iX();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Ba.batch(()=>{if(this.#s&&this.hasListeners()){const r=this.#t.variables,n=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#s.onSuccess?.(e.data,r,n,i)}catch(a){Promise.reject(a)}try{this.#s.onSettled?.(e.data,null,r,n,i)}catch(a){Promise.reject(a)}}else if(e?.type==="error"){try{this.#s.onError?.(e.error,r,n,i)}catch(a){Promise.reject(a)}try{this.#s.onSettled?.(void 0,e.error,r,n,i)}catch(a){Promise.reject(a)}}}this.listeners.forEach(r=>{r(this.#t)})})}},lxe=class extends fb{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const n=e.queryKey,i=e.queryHash??SI(n,e);let a=this.get(i);return a||(a=new exe({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(n)}),this.add(a)),a}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ba.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>g9(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>g9(t,r)):e}notify(t){Ba.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Ba.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ba.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},cxe=class{#e;#t;#r;#s;#n;#a;#o;#i;constructor(t={}){this.#e=t.queryCache||new lxe,this.#t=t.mutationCache||new axe,this.#r=t.defaultOptions||{},this.#s=new Map,this.#n=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=AI.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=QN.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(k0(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),a=this.#e.get(n.queryHash)?.state.data,o=Rge(e,a);if(o!==void 0)return this.#e.build(this,n).setData(o,{...r,manual:!0})}setQueriesData(t,e,r){return Ba.batch(()=>this.#e.findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Ba.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return Ba.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=Ba.batch(()=>this.#e.findAll(t).map(i=>i.cancel(r)));return Promise.all(n).then(Pa).catch(Pa)}invalidateQueries(t,e={}){return Ba.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=Ba.batch(()=>this.#e.findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(Pa)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(Pa)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(k0(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Pa).catch(Pa)}fetchInfiniteQuery(t){return t.behavior=k9(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Pa).catch(Pa)}ensureInfiniteQueryData(t){return t.behavior=k9(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return QN.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(t){this.#r=t}setQueryDefaults(t,e){this.#s.set(am(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#s.values()],r={};return e.forEach(n=>{qv(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){this.#n.set(am(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#n.values()],r={};return e.forEach(n=>{qv(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#r.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=SI(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===CI&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#r.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},aX=y.createContext(void 0),Lm=t=>{const e=y.useContext(aX);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},uxe=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(aX.Provider,{value:t,children:e})),oX=y.createContext(!1),dxe=()=>y.useContext(oX),hxe=oX.Provider;function fxe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var pxe=y.createContext(fxe()),mxe=()=>y.useContext(pxe),gxe=(t,e,r)=>{const n=r?.state.error&&typeof t.throwOnError=="function"?EI(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||n)&&(e.isReset()||(t.retryOnMount=!1))},xxe=t=>{y.useEffect(()=>{t.clearReset()},[t])},bxe=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||EI(r,[t.error,n])),yxe=t=>{if(t.suspense){const r=i=>i==="static"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...i)=>r(n(...i)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},vxe=(t,e)=>t.isLoading&&t.isFetching&&!e,wxe=(t,e)=>t?.suspense&&e.isPending,S9=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function Nxe(t,e,r){const n=dxe(),i=mxe(),a=Lm(),o=a.defaultQueryOptions(t);a.getDefaultOptions().queries?._experimental_beforeQuery?.(o);const l=a.getQueryCache().get(o.queryHash);o._optimisticResults=n?"isRestoring":"optimistic",yxe(o),gxe(o,i,l),xxe(i);const c=!a.getQueryCache().get(o.queryHash),[u]=y.useState(()=>new e(a,o)),h=u.getOptimisticResult(o),p=!n&&t.subscribed!==!1;if(y.useSyncExternalStore(y.useCallback(m=>{const g=p?u.subscribe(Ba.batchCalls(m)):Pa;return u.updateResult(),g},[u,p]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),y.useEffect(()=>{u.setOptions(o)},[o,u]),wxe(o,h))throw S9(o,u,i);if(bxe({result:h,errorResetBoundary:i,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw h.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(o,h),o.experimental_prefetchInRender&&!im&&vxe(h,n)&&(c?S9(o,u,i):l?.promise)?.catch(Pa).finally(()=>{u.updateResult()}),o.notifyOnChangeProps?h:u.trackResult(h)}function U1(t,e){return Nxe(t,txe)}function fA(t,e){const r=Lm(),[n]=y.useState(()=>new oxe(r,t));y.useEffect(()=>{n.setOptions(t)},[n,t]);const i=y.useSyncExternalStore(y.useCallback(o=>n.subscribe(Ba.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=y.useCallback((o,l)=>{n.mutate(o,l).catch(Pa)},[n]);if(i.error&&EI(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}const jxe="";async function kxe(){const t={"Content-Type":"application/json"};if(wd.currentUser){const r=await wd.currentUser.getIdToken();t.Authorization=`Bearer ${r}`}else console.warn("[API] No currentUser found, sending request without auth.");const e=localStorage.getItem("mtg_forge_ref");return e&&(t["X-Referral-Code"]=e),t}let pA=null;const C9=t=>{pA=t};async function en(t,e,r=null,n={}){let i=`${jxe}${e}`;if(!navigator.onLine)throw new Error("Network Error: Device is offline");const a=new URL(i,window.location.origin);Object.keys(n).forEach(u=>{n[u]!==null&&n[u]!==void 0&&a.searchParams.append(u,n[u])});const o={method:t,headers:await kxe()};r&&(o.body=JSON.stringify(r));const l=await fetch(a,o);if(!l.ok){let u=l.statusText,h=null,p=null;try{p=await l.json(),p.error&&(u=p.error),p.code&&(h=p.code)}catch{}l.status===403&&h==="LIMIT_REACHED"&&pA&&pA(`Subscription Limit Reached: ${u}`,"error",5e3);const m=new Error(`API Error (${l.status}): ${u}`);throw m.response={status:l.status,data:p},m.code=h,m}if(l.status===204)return null;const c=await l.text();if(!c)return{};try{if(c.trim().toLowerCase().startsWith("<!doctype html")||c.trim().toLowerCase().startsWith("<html"))throw new Error("Received HTML response from API (likely 404 or SPA fallback)");return JSON.parse(c)}catch(u){throw console.warn(`[API] Failed to parse response from ${e}:`,u.message),new Error("Invalid JSON response from API")}}const Ge={get:(t,e)=>en("GET",t,null,e),post:(t,e)=>en("POST",t,e),put:(t,e)=>en("PUT",t,e),delete:(t,e)=>en("DELETE",t,e),batchAddToCollection:(t,e="merge")=>en("POST","/api/collection/batch",{cards:t,mode:e}),batchDeleteCollection:t=>en("DELETE","/api/collection/batch",{ids:t}),batchAddCardsToDeck:(t,e)=>en("POST",`/api/decks/${t}/cards/batch`,{cards:e}),getBugs:()=>en("GET","/bugs").then(t=>t.content),updateUser:(t,e)=>en("PUT",`/api/users/${t}`,e),getBinders:()=>en("GET","/api/binders"),getBinderCards:t=>en("GET",`/api/binders/${t}/cards`),createBinder:t=>en("POST","/api/binders",t),updateBinder:(t,e)=>en("PUT",`/api/binders/${t}`,e),deleteBinder:t=>en("DELETE",`/api/binders/${t}`),getEpics:()=>en("GET","/api/epics"),createEpic:t=>en("POST","/api/epics",t),updateEpic:(t,e)=>en("PUT",`/api/epics/${t}`,e),reorderEpics:t=>en("PUT","/api/epics/reorder/batch",{order:t}),deleteEpic:t=>en("DELETE",`/api/epics/${t}`),getTickets:t=>en("GET","/api/tickets",null,t),getTicketReport:t=>en("GET","/api/tickets/report",null,t),createTicket:t=>en("POST","/api/tickets",t),updateTicket:(t,e)=>en("PUT",`/api/tickets/${t}`,e),deleteTicket:t=>en("DELETE",`/api/tickets/${t}`),voteTicket:t=>en("POST",`/api/tickets/${t}/vote`),getAssignees:()=>en("GET","/api/tickets/meta/assignees"),getTicketNotes:t=>en("GET",`/api/tickets/${t}/notes`),addTicketNote:(t,e)=>en("POST",`/api/tickets/${t}/notes`,{note:e}),updateUserPermissions:(t,e,r,n={})=>en("PUT",`/api/users/${t}/permissions`,{permissions:e,isAdmin:r,...n}),getUsers:()=>en("GET","/api/users"),getReleases:()=>en("GET","/api/releases"),publishRelease:t=>en("POST","/api/releases",t),checkPreconOwnership:t=>en("POST",`/api/precons/${t}/check-ownership`),createPreconDeck:(t,e={})=>en("POST",`/api/precons/${t}/create`,e),getActiveAudit:()=>en("GET","/api/audit/active"),startAudit:t=>en("POST","/api/audit/start",t),getAuditItems:(t,e)=>en("GET",`/api/audit/${t}/items`,null,e),updateAuditItem:(t,e,r,n=null)=>{const i={quantity:r};return n!==null&&(i.reviewed=n),en("PUT",`/api/audit/${t}/item/${e}`,i)},swapFoilAuditItem:(t,e)=>en("POST",`/api/audit/${t}/item/${e}/swap-foil`),addAuditItem:(t,e)=>en("POST",`/api/audit/${t}/items/add`,e),cancelAudit:t=>en("POST",`/api/audit/${t}/cancel`),finalizeAudit:t=>en("POST",`/api/audit/${t}/finalize`),reviewAuditSection:(t,e)=>en("POST",`/api/audit/${t}/section/review`,e),batchUpdateAuditItems:(t,e)=>en("POST",`/api/audit/${t}/items/batch-update`,{updates:e})},lX=y.createContext(),Or=()=>y.useContext(lX),_xe=({children:t})=>{const[e,r]=y.useState(null),[n,i]=y.useState(!0),a=Lm(),{data:o=null,refetch:l,isLoading:c}=U1({queryKey:["userProfile",e?.uid],queryFn:async()=>e?(console.log("[AuthContext] Fetching user profile..."),await Ge.get("/api/users/me")):null,enabled:!!e,staleTime:1e3*60*5}),u=async(I,O,B={})=>{const S=await whe(wd,I,O);if(Object.keys(B).length>0)try{await l();const T=await Ge.get("/api/users/me");T?.id&&(await Ge.updateUser(T.id,B),a.invalidateQueries(["userProfile",S.user.uid]))}catch(T){console.error("Failed to save profile data during signup",T)}return S},h=(I,O)=>Nhe(wd,I,O),p=()=>{const I=new Sh;return Ghe(wd,I)},m=async()=>(a.setQueryData(["userProfile",e?.uid],null),a.removeQueries(["userProfile"]),Che(wd)),g=I=>vhe(wd,I),b=()=>{if(!wd.currentUser)throw new Error("No user logged in");return jhe(wd.currentUser)},v=fA({mutationFn:async({id:I,data:O})=>await Ge.updateUser(I,O),onSuccess:I=>{a.invalidateQueries(["userProfile",e?.uid])}}),w=async I=>{if(!o?.id)throw new Error("User profile not ready");await v.mutateAsync({id:o.id,data:I})},j=async I=>{if(!o?.id)return;const O={...o.settings||{},...I};a.setQueryData(["userProfile",e?.uid],B=>B&&{...B,settings:O});try{await v.mutateAsync({id:o.id,data:{settings:O}})}catch(B){console.error("Failed to update settings:",B),a.invalidateQueries(["userProfile",e?.uid])}},_=async I=>{if(!e)throw new Error("No user logged in");if(!I.type.startsWith("image/"))throw new Error("File must be an image.");if(I.size>10*1024*1024)throw new Error("File size must be under 10MB.");const O=new FileReader,S=await new Promise((T,M)=>{O.onload=()=>T(O.result),O.onerror=M,O.readAsDataURL(I)});if(!o?.id)throw new Error("User profile not ready");return await v.mutateAsync({id:o.id,data:{photo_url:S}}),S};y.useEffect(()=>She(wd,O=>{r(O),i(!1)}),[]);const E={currentUser:e,user:e,userProfile:o,loading:n||!!e&&c,refreshUserProfile:l,updateSettings:j,signup:u,login:h,loginWithGoogle:p,logout:m,resetPassword:g,sendVerification:b,updateProfileFields:w,uploadProfilePicture:_};return s.jsx(lX.Provider,{value:E,children:!n&&(!e||!c)&&t})};function Sxe(){const[t,e]=y.useState([]),[r,n]=y.useState(!1),[i,a]=y.useState(null),o=y.useCallback(async(c,u={})=>{const{set:h,cn:p,...m}=u,g=(c||"").trim();if(!(h||p||Object.keys(m).length>0)&&(!g||g.length<2)){e([]);return}n(!0),a(null);try{const v=await Ge.post("/api/cards/search",{query:g,set:h,cn:p,...m});e(v.data||[])}catch(v){console.error(v),a(v.message),e([])}finally{n(!1)}},[]),l=y.useCallback(async c=>{if(!c||c.trim().length<2)return[];try{return(await Ge.get("/api/cards/autocomplete",{q:c})).data||[]}catch(u){return console.error("[useScryfall] Autocomplete error:",u),[]}},[]);return{results:t,loading:r,error:i,searchCards:o,getSuggestions:l,setResults:e}}const cX=y.createContext();function jn(){return y.useContext(cX)}function Cxe({children:t}){const[e,r]=y.useState([]),n=y.useCallback((a,o="info",l=3e3,c=null)=>{const u=Date.now();r(h=>[...h,{id:u,message:a,type:o,action:c}]),l>0&&setTimeout(()=>{r(h=>h.filter(p=>p.id!==u))},l)},[]),i=y.useCallback(a=>{r(o=>o.filter(l=>l.id!==a))},[]);return s.jsxs(cX.Provider,{value:{addToast:n},children:[t,Vn.createPortal(s.jsx("div",{className:"fixed bottom-4 right-4 z-[99999] flex flex-col gap-2 pointer-events-none",children:e.map(a=>s.jsxs("div",{className:`
                                px-4 py-3 rounded-lg shadow-lg text-sm font-medium transition-all transform animate-fade-in-up pointer-events-auto cursor-pointer
                                ${a.type==="success"?"bg-green-600 text-white":""}
                                ${a.type==="error"?"bg-red-600 text-white":""}
                                ${a.type==="info"?"bg-gray-800 text-white border border-gray-700":""}
                                ${a.type==="warning"?"bg-yellow-500 text-black":""}
                            `,onClick:()=>i(a.id),children:[a.message,a.action&&s.jsx("button",{onClick:o=>{o.stopPropagation(),a.action.onClick?.(),i(a.id)},className:"ml-3 px-2 py-0.5 bg-white/20 hover:bg-white/30 rounded text-xs font-bold uppercase tracking-wider transition-colors border border-white/10",children:a.action.label||"Action"})]},a.id))}),document.body)]})}function vl(t={}){const{wishlist:e,userId:r}=t,{currentUser:n}=Or(),i=Lm(),a=["collection",{wishlist:e,userId:r||n?.uid}],{data:o=[],isLoading:l,error:c,refetch:u}=U1({queryKey:a,queryFn:async()=>{if(!n)return[];const b=new URLSearchParams;return e!==void 0&&b.append("wishlist",e),r&&b.append("userId",r),(await Ge.get(`/api/collection?${b.toString()}`)).map(w=>({...w.data,...w,deckId:w.deck_id,quantity:w.count,firestoreId:w.firestore_id,id:w.id,scryfall_id:w.scryfall_id}))},enabled:!!n,staleTime:1e3*60*5}),h=fA({mutationFn:async b=>{await Ge.delete(`/api/collection/${b}`)},onSuccess:()=>{i.invalidateQueries({queryKey:a})}}),p=fA({mutationFn:async({id:b,data:v})=>{await Ge.put(`/api/collection/${b}`,v)},onSuccess:()=>{i.invalidateQueries({queryKey:a})}});return{cards:o,loading:l,error:c,refresh:u,removeCard:async b=>{try{await h.mutateAsync(b)}catch(v){throw console.error("Error removing card:",v),v}},updateCard:async(b,v)=>{try{await p.mutateAsync({id:b,data:v})}catch(w){throw console.error("Error updating card:",w),w}},setCards:b=>i.setQueryData(a,b)}}function Exe(t,e){const[r,n]=y.useState(t);return y.useEffect(()=>{const i=setTimeout(()=>{n(t)},e);return()=>{clearTimeout(i)}},[t,e]),r}const so={async addCardToCollection(t,e,r=1,n,i=!1,a=null){return Ge.post("/api/collection",{scryfall_id:e.id,name:e.name,set_code:e.set||e.set_code,collector_number:e.collector_number,finish:n||e.finish||"nonfoil",count:r,data:e,deck_id:null,is_wishlist:i,targetUserId:a})},async updateCard(t,e){return Ge.put(`/api/collection/${t}`,e)},async removeCard(t){return Ge.delete(`/api/collection/${t}`)},async importBatch(t,e,r="merge",n=null){return Ge.post("/api/collection/batch",{cards:e,mode:r,decks:n})},async batchRemoveCards(t){return Ge.delete("/api/collection/batch/delete",{cardIds:t})}},ia={fetchRelationships:async()=>Ge.get("/api/community/relationships"),sendRequest:async(t,e="pod")=>{const r=typeof t=="string"?{targetEmail:t,type:e}:{...t,type:e};return Ge.post("/api/community/relationships/request",r)},respondToRequest:async(t,e)=>Ge.put(`/api/community/relationships/${t}`,{status:e}),deleteRelationship:async t=>Ge.delete(`/api/community/relationships/${t}`),fetchPermissions:async(t=null)=>Ge.get(`/api/community/permissions${t?`?deckId=${t}`:""}`),fetchIncomingPermissions:async()=>Ge.get("/api/community/permissions?direction=incoming"),grantPermission:async(t,e,r=null)=>Ge.post("/api/community/permissions",{granteeId:t,permissionLevel:e,deckId:r}),revokePermission:async t=>Ge.delete(`/api/community/permissions/${t}`),updateDeckPublicStatus:async(t,e,r)=>Ge.put(`/api/decks/${t}`,{isPublic:e,shareSlug:r})},uX=y.createContext();function z1(){return y.useContext(uX)}function Axe({children:t}){const[e,r]=y.useState(null),[n,i]=y.useState(!1),a=y.useCallback(l=>{r(l),i(!0)},[]),o=y.useCallback(()=>{i(!1),setTimeout(()=>r(null),300)},[]);return s.jsx(uX.Provider,{value:{selectedCard:e,isOpen:n,openCardModal:a,closeCardModal:o},children:t})}const dX=({card:t,normalCount:e=0,foilCount:r=0,wishlistCount:n=0,onUpdateCount:i,onUpdateWishlistCount:a,ownerName:o,currentUser:l,showOwnerTag:c=!1})=>{const{openCardModal:u}=z1(),[h,p]=y.useState(!1),m=o||t.owner_username||(l&&(t.owner_id===l.id||t.user_id===l.id)?l.username||"ME":null),g=(B,S=0)=>{if(!B)return"https://placehold.co/250x350?text=No+Image";const T=B.data||B;return T.card_faces&&T.card_faces.length>1?T.card_faces[S]?.image_uris?.normal||B.image_uri||"https://placehold.co/250x350?text=No+Image":T.image_uris?.normal||B.image_uri||"https://placehold.co/250x350?text=No+Image"},b=t.data?.card_faces||t.card_faces,v=b?.length>1&&!!b[1].image_uris,w=g(t,0),j=v?g(t,1):null,_=B=>{B.stopPropagation(),u(t)},E=(B,S,T)=>{B.stopPropagation(),i&&i(t,S,T)},I=e+r>0,O=!I&&n>0;return t.finish==="foil"?t.prices?.usd_foil||t.prices?.usd:t.prices?.usd||t.prices?.usd_foil,s.jsxs("div",{className:`group relative flex bg-gray-900/60 backdrop-blur-md rounded-xl overflow-hidden shadow-2xl border transition-all duration-300 hover:shadow-[0_0_30px_rgba(79,70,229,0.15)] aspect-[3.2/3.5] perspective-1000 ${I?"border-indigo-500/30":"border-white/5 grayscale-[0.8] opacity-70 hover:grayscale-0 hover:opacity-100"}`,children:[s.jsxs("div",{className:"relative aspect-[2.5/3.5] h-full cursor-pointer overflow-hidden bg-gray-950 shrink-0",onClick:_,children:[s.jsxs("div",{className:`relative w-full h-full transition-all duration-700 transform-style-3d ${h?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 backface-hidden",children:[s.jsx("img",{src:w,alt:t.name,className:"w-full h-full object-cover",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-t from-indigo-500/20 to-transparent transition-opacity duration-500"})]}),v&&s.jsx("div",{className:"absolute inset-0 backface-hidden rotate-y-180",children:s.jsx("img",{src:j||w,alt:`${t.name} Back`,className:"w-full h-full object-cover"})})]}),v&&s.jsx("button",{onClick:B=>{B.stopPropagation(),p(!h)},className:"absolute top-2 left-2 p-2 bg-black/60 hover:bg-indigo-600 text-white rounded-full backdrop-blur-md transition-all z-30 shadow-lg border border-white/10",title:"Flip Card",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),O&&s.jsx("div",{className:`absolute top-2 ${v?"left-12":"left-2"} z-20 bg-orange-500 text-white p-1 rounded-md shadow-lg animate-pulse`,children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),c&&m&&I&&s.jsxs("div",{className:`absolute ${v||O?"top-16":"top-12"} left-2 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-30 backdrop-blur-md uppercase tracking-wider`,children:[" ",m]}),s.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:s.jsxs("div",{className:"bg-black/70 backdrop-blur-md px-2 py-1 rounded-lg border border-white/10 flex items-center justify-around text-[10px] font-mono",children:[s.jsxs("span",{className:"text-gray-400",children:["$",(parseFloat(t.prices?.usd)||0).toFixed(2)]}),s.jsx("div",{className:"h-2 w-[1px] bg-white/20"}),s.jsxs("span",{className:"text-yellow-400",children:["$",(parseFloat(t.prices?.usd_foil)||0).toFixed(2)," "]})]})})]}),s.jsxs("div",{className:"flex-1 bg-black/40 flex flex-col justify-between py-1 border-l border-white/5 relative",children:[s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-white/5 transition-colors group/sec",children:[s.jsx("button",{onClick:B=>E(B,"normal",1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-white tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:e}),s.jsx("span",{className:"text-[8px] font-black uppercase text-gray-600 tracking-[0.2em] -mt-1",children:"Normal"})]}),s.jsx("button",{onClick:B=>E(B,"normal",-1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 disabled:opacity-0",disabled:e<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-indigo-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:B=>E(B,"foil",1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-indigo-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:r}),s.jsx("span",{className:"text-[8px] font-black uppercase text-indigo-600 tracking-[0.2em] -mt-1",children:"Foil"})]}),s.jsx("button",{onClick:B=>E(B,"foil",-1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:r<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-orange-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:B=>{B.stopPropagation(),a&&a(t,1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-orange-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:n}),s.jsx("span",{className:"text-[8px] font-black uppercase text-orange-600 tracking-[0.2em] -mt-1",children:"Wish"})]}),s.jsx("button",{onClick:B=>{B.stopPropagation(),a&&a(t,-1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:n<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]})]})]})};function Txe({title:t,titleId:e,...r},n){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?y.createElement("title",{id:e},t):null,y.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const Ixe=y.forwardRef(Txe);function Lxe({title:t,titleId:e,...r},n){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?y.createElement("title",{id:e},t):null,y.createElement("path",{fillRule:"evenodd",d:"M3.792 2.938A49.069 49.069 0 0 1 12 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 0 1 1.541 1.836v1.044a3 3 0 0 1-.879 2.121l-6.182 6.182a1.5 1.5 0 0 0-.439 1.061v2.927a3 3 0 0 1-1.658 2.684l-1.757.878A.75.75 0 0 1 9.75 21v-5.818a1.5 1.5 0 0 0-.44-1.06L3.13 7.938a3 3 0 0 1-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836Z",clipRule:"evenodd"}))}const hX=y.forwardRef(Lxe),Pxe=({value:t,onChange:e})=>{const[r,n]=y.useState(!1),i=y.useRef(null),a=[{label:"=",value:"="},{label:"",value:">="},{label:"",value:"<="}];y.useEffect(()=>{const l=c=>{i.current&&!i.current.contains(c.target)&&n(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const o=a.find(l=>l.value===t)||a[0];return s.jsxs("div",{className:"relative",ref:i,children:[s.jsxs("button",{type:"button",onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-3 bg-gray-900/50 hover:bg-gray-800 text-indigo-400 font-bold rounded-l-xl border-r border-white/10 transition-colors min-w-[50px] justify-center",children:[o.label,s.jsx("svg",{className:`w-3 h-3 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&s.jsx("div",{className:"absolute top-full left-0 mt-1 w-20 bg-gray-900 border border-white/10 rounded-lg shadow-2xl z-[70] overflow-hidden backdrop-blur-xl",children:a.map(l=>s.jsx("button",{type:"button",onClick:()=>{e(l.value),n(!1)},className:`w-full px-4 py-2 text-left text-sm font-bold transition-colors ${t===l.value?"bg-indigo-600 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:l.label},l.value))})]})},II=({isOpen:t,onClose:e,onAddCard:r,onOpenForgeLens:n})=>{const[i,a]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(""),[h,p]=y.useState(""),[m,g]=y.useState(null),[b,v]=y.useState([]),[w,j]=y.useState(!1),[_,E]=y.useState([]),[I,O]=y.useState(!1),[B,S]=y.useState([]),[T,M]=y.useState("or"),[$,k]=y.useState(!1),[L,R]=y.useState(!1),[V,Y]=y.useState([]),[X,J]=y.useState(""),[re,se]=y.useState(""),[ee,q]=y.useState({operator:"=",value:""}),[U,W]=y.useState({operator:"=",value:""}),[Z,de]=y.useState({operator:"=",value:""}),[be,oe]=y.useState(""),[ne,H]=y.useState(""),{results:le,loading:ye,error:me,searchCards:ke,getSuggestions:Ie}=Sxe(),{currentUser:ce}=Or(),{addToast:Be}=jn(),{cards:ct,refresh:Ve}=vl({userId:m||void 0}),Ne=y.useRef(null),Ye=y.useRef(null),St=Exe(i,300);y.useEffect(()=>{St.length>=2&&o?Vt(St):St.length<2&&E([])},[St]);const Vt=async Fe=>{const Ut=await Ie(Fe);E(Ut),O(Ut.length>0)};y.useEffect(()=>{t&&(async()=>{try{const jt=(await ia.fetchIncomingPermissions()).filter(qe=>["editor","admin","contributor"].includes(qe.permission_level)&&!qe.target_deck_id);v(jt)}catch(Ut){console.error("Failed to load writable collections",Ut)}})()},[t]);const Lt=y.useMemo(()=>{const Fe=new Map;return ct&&ct.forEach(Ut=>{const jt=Ut.scryfall_id||Ut.id;Fe.has(jt)||Fe.set(jt,[]),Fe.get(jt).push(Ut)}),Fe},[ct]);y.useEffect(()=>{t&&Ne.current&&Ne.current.focus()},[t]);const at=Fe=>{Fe&&Fe.preventDefault(),O(!1);const Ut={set:c,cn:h,colors:B.length>0?B:void 0,colorLogic:T,colorIdentity:$,colorExcluded:L,rarity:V.length>0?V:void 0,type:X,text:re,flavor:be,artist:ne,mv:ee.value!==""?{operator:ee.operator,value:Number(ee.value)}:void 0,power:U.value!==""?{operator:U.operator,value:Number(U.value)}:void 0,toughness:Z.value!==""?{operator:Z.operator,value:Number(Z.value)}:void 0};ke(i,Ut)},gt=()=>{a(""),u(""),p(""),S([]),R(!1),Y([]),J(""),se(""),q({operator:"=",value:""}),W({operator:"=",value:""}),de({operator:"=",value:""}),oe(""),H("")},vt=Fe=>{S(Ut=>Ut.includes(Fe)?Ut.filter(jt=>jt!==Fe):[...Ut,Fe])},ft=Fe=>{Y(Ut=>Ut.includes(Fe)?Ut.filter(jt=>jt!==Fe):[...Ut,Fe])},ot=async(Fe,Ut,jt)=>{if(!ce)return Be("Please log in","error");try{const qe=Fe.id,rt=Lt.get(qe)||[],Ot=Ut==="foil"?"foil":"nonfoil",pt=rt.find(Jt=>Jt.finish===Ot&&!Jt.deck_id&&!Jt.is_wishlist);if(jt>0)if(pt)await so.updateCard(pt.id,{count:pt.count+1}),Be(`Added ${Ot} ${Fe.name}`,"success");else{const Jt=await so.addCardToCollection(ce.uid,Fe,1,Ot,!1,m);if(Be(`Added new ${Ot} ${Fe.name}`,"success"),r&&Jt&&Jt.id){const Kt={...Fe,firestoreId:Jt.id,id:Fe.id,finish:Ot,count:1,is_wishlist:!1};r(Kt)}}else pt&&(pt.count>1?(await so.updateCard(pt.id,{count:pt.count-1}),Be(`Removed ${Ot} ${Fe.name}`,"info")):(await so.removeCard(pt.id),Be(`Removed last ${Ot} ${Fe.name}`,"info")));Ve()}catch(qe){console.error("Update failed",qe),Be("Failed to update collection","error")}},ut=async(Fe,Ut)=>{if(!ce)return Be("Please log in","error");try{const jt=Fe.id,rt=(Lt.get(jt)||[]).find(Ot=>Ot.is_wishlist&&!Ot.deck_id);Ut>0?rt?(await so.updateCard(rt.id,{count:rt.count+1}),Be(`Increased ${Fe.name} in wishlist`,"success")):(await so.addCardToCollection(ce.uid,Fe,1,"nonfoil",!0,m),Be(`Added ${Fe.name} to wishlist`,"success")):rt&&(rt.count>1?(await so.updateCard(rt.id,{count:rt.count-1}),Be(`Decreased ${Fe.name} in wishlist`,"info")):(await so.removeCard(rt.id),Be(`Removed ${Fe.name} from wishlist`,"info"))),Ve()}catch(jt){console.error("Wishlist update failed",jt),Be("Failed to update wishlist","error")}};if(!t)return null;const At={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"},C:{bg:"bg-gray-400",text:"text-gray-900",border:"border-gray-500",symbol:"https://svgs.scryfall.io/card-symbols/C.svg"}};return Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in group",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-white/5",children:[s.jsxs("div",{className:"px-6 py-5 border-b border-white/5 flex justify-between items-center bg-white/5 flex-shrink-0",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Card Library"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-500/10 text-indigo-300 uppercase tracking-wider border border-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]",children:"Database"})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[b.length>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-black/20 rounded-lg p-1 border border-white/5",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-2",children:"Target:"}),s.jsxs("select",{value:m||"",onChange:Fe=>g(Fe.target.value||null),className:"bg-transparent text-xs text-white focus:outline-none font-bold cursor-pointer hover:text-indigo-300 transition-colors",children:[s.jsx("option",{value:"",className:"bg-gray-900",children:"My Collection"}),b.map(Fe=>s.jsxs("option",{value:Fe.owner_id,className:"bg-gray-900",children:[Fe.owner_username,"'s Collection (",Fe.permission_level,")"]},Fe.owner_id))]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),n&&s.jsxs("div",{className:"relative overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 via-purple-600/20 to-indigo-600/20 opacity-50 blur-xl group-hover:opacity-75 transition-opacity"}),s.jsxs("div",{className:"relative px-6 py-2 border-b border-white/5 flex items-center justify-between bg-white/5 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center text-indigo-300 shadow-[0_0_15px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:"Have the physical card?"}),s.jsx("span",{className:"hidden sm:inline-block h-1 w-1 rounded-full bg-gray-600"}),s.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider hidden sm:block",children:"Scan instantly with Forge Lens AI"})]})]}),s.jsxs("button",{onClick:n,className:"px-5 py-1.5 bg-indigo-500/20 hover:bg-indigo-500/30 hover:text-white text-indigo-300 border border-indigo-500/30 rounded-lg font-bold text-[10px] uppercase tracking-wider transition-all shadow-[0_0_20px_rgba(99,102,241,0.1)] hover:shadow-[0_0_20px_rgba(99,102,241,0.3)] flex items-center gap-2",children:[s.jsx("span",{children:"Launch Scanner"}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar bg-black/20",children:[s.jsx("div",{className:"p-6 space-y-4 relative z-[60]",children:s.jsxs("form",{onSubmit:at,className:"relative flex flex-col gap-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1 group",children:[s.jsx("input",{id:"card-search-input",ref:Ne,type:"text",placeholder:"Search cards...",className:"w-full bg-white/5 text-white border border-white/10 rounded-xl py-4 px-6 pl-14 pr-12 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all placeholder-gray-500 backdrop-blur-sm",value:i,onChange:Fe=>{a(Fe.target.value),l(!0),O(!0)},onFocus:()=>i.length>=2&&O(!0)}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>{a(""),E([]),Ne.current?.focus()},className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-1 rounded-full hover:bg-white/10 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),I&&_.length>0&&s.jsx("div",{ref:Ye,className:"absolute top-full left-0 right-0 mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 max-h-60 overflow-y-auto custom-scrollbar",children:_.map((Fe,Ut)=>s.jsx("button",{type:"button",onClick:()=>{a(Fe),l(!1),O(!1),ke(Fe,{set:c,cn:h})},className:"w-full text-left px-6 py-3 hover:bg-white/5 text-gray-400 hover:text-white transition-colors border-b border-white/5 last:border-0",children:Fe},Ut))})]}),s.jsxs("button",{id:"card-search-advanced-toggle",type:"button",onClick:()=>j(!w),className:`px-6 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${w?"bg-indigo-600 text-white border-indigo-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(hX,{className:"w-5 h-5"}),"Advanced Search"]}),s.jsx("button",{type:"submit",disabled:ye,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl text-lg font-bold transition-all disabled:opacity-50 min-w-[120px] shadow-lg shadow-indigo-500/20 active:scale-95 border border-indigo-500/50",children:ye?"Searching...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${w?"max-h-[800px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 space-y-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Advanced Configuration"}),s.jsx("button",{onClick:gt,className:"text-orange-500 hover:text-orange-400 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Reset Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Colors"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex gap-2",children:Object.entries(At).map(([Fe,Ut])=>s.jsx("button",{type:"button",onClick:()=>vt(Fe),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${B.includes(Fe)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:B.includes(Fe)?"transparent":""},children:s.jsx("img",{src:Ut.symbol,alt:Fe,className:`w-full h-full ${B.includes(Fe)?"drop-shadow-md":"grayscale"}`})},Fe))}),s.jsx("div",{className:"flex items-center gap-2 text-sm bg-gray-900 border border-white/10 rounded-lg p-1",children:["or","and"].map(Fe=>s.jsx("button",{type:"button",onClick:()=>M(Fe),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${T===Fe?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:Fe},Fe))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Rarity"}),s.jsx("div",{className:"flex gap-3",children:["common","uncommon","rare","mythic"].map(Fe=>s.jsx("button",{type:"button",onClick:()=>ft(Fe),className:`px-3 py-1.5 rounded-lg border text-xs font-bold uppercase transition-all ${V.includes(Fe)?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-gray-900 border-white/10 text-gray-500 hover:text-gray-300"}`,children:Fe.charAt(0)},Fe))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Type"}),s.jsx("input",{type:"text",placeholder:"Creature, Artifact...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:X,onChange:Fe=>J(Fe.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Text"}),s.jsx("input",{type:"text",placeholder:"Rules text...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:re,onChange:Fe=>se(Fe.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Mana Value"}),s.jsxs("div",{className:"flex items-center bg-gray-900 border border-white/10 rounded-xl overflow-hidden",children:[s.jsx(Pxe,{value:ee.operator,onChange:Fe=>q({...ee,operator:Fe})}),s.jsx("input",{type:"number",className:"w-full bg-transparent p-2 text-sm outline-none",value:ee.value,onChange:Fe=>q({...ee,value:Fe.target.value})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Set"}),s.jsx("input",{type:"text",placeholder:"ABC",maxLength:5,className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none uppercase",value:c,onChange:Fe=>u(Fe.target.value)})]}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"CN"}),s.jsx("input",{type:"text",placeholder:"#",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:h,onChange:Fe=>p(Fe.target.value)})]})]})]})]})})]})}),s.jsxs("div",{id:"card-search-results",className:"p-6",children:[me&&s.jsx("div",{className:"flex items-center justify-center p-8 text-red-400 bg-red-500/10 rounded-2xl border border-red-500/20",children:s.jsx("p",{className:"font-bold",children:me})}),!ye&&le.length===0&&(i||w)&&!me&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("p",{className:"text-lg font-bold",children:"No matches found"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:le.map((Fe,Ut)=>{const jt=Lt.get(Fe.id)||[],qe=jt.filter(pt=>pt.finish==="nonfoil"&&!pt.deck_id&&!pt.is_wishlist).reduce((pt,Jt)=>pt+(Jt.count||1),0),rt=jt.filter(pt=>pt.finish==="foil"&&!pt.deck_id&&!pt.is_wishlist).reduce((pt,Jt)=>pt+(Jt.count||1),0),Ot=jt.filter(pt=>pt.is_wishlist&&!pt.deck_id).reduce((pt,Jt)=>pt+(Jt.count||1),0);return s.jsx(dX,{card:Fe,normalCount:qe,foilCount:rt,wishlistCount:Ot,onUpdateCount:ot,onUpdateWishlistCount:ut},Fe.id||Ut)})})]})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]}),document.body)},Oxe="gemini-2.5-flash-preview-09-2025",ul={generateDeckSuggestions:async(t,e)=>{const{deckName:r,commander:n,playerProfile:i,strategyGuide:a,helperPersona:o,targetRole:l,candidates:c,currentContext:u,neededCount:h,experienceLevel:p="Advanced"}=e,m=`https://generativelanguage.googleapis.com/v1beta/models/${Oxe}:generateContent?key=${t||""}`,g=o?.name||"The Oracle",b=o?.type||"AI",v=o?.personality||"Professional and helpful",w=`You are ${g}, a ${b}. 
        Your personality is: ${v}.

        VOICE GUIDELINES:
        - When writing the 'reason' for a card, strictly adhere to your personality.
        - Address the user as an equal (or however your personality dictates).
        - If you are snarky or high-minded, use that tone to explain why a card is mathematically or strategically superior to the "garbage" others play.

        YOUR CORE MISSION:
        - You specialize in "Psychographic Profiling"matching a deck's mechanical soul to a player's specific psychological needs.
        - Analyze the PLAYER PROFILE: ${i}
        - Analyze the STRATEGY GUIDE: ${a}
        - Select EXACTLY ${h} cards from the CANDIDATE LIST for the role of '${l}'.
        
        CRITICAL SELECTION CRITERIA:
        - SYNERGY OVER STAPLES: Prefer cards that enable the specific loops in the Strategy Guide.
        - PLAYER SATISFACTION: Align card mechanics with the player's desire for "inescapable defeat" or "meticulous engineering."`,E={contents:[{parts:[{text:`
            DECK: ${r}
            COMMANDER: ${n}
            
            [PLAYER PSYCHOGRAPHIC PROFILE]
            ${i}
            
            [GUIDING STRATEGY & ASSUMED ABILITIES]
            ${a}
            
            [CURRENT DECK CONTEXT]
            ${u?.length>0?u.join(", "):"No cards added yet."}
            
            [CATEGORY TO FILL]
            I need exactly ${h} cards for the '${l}' slot.
            
            [CANDIDATE POOL]
            ${c.map(S=>`ID: ${S.firestoreId} | Name: ${S.name} | Type: ${S.type_line}`).join(`
`)}
            
            OUTPUT REQUIREMENTS:
            Return a JSON object with 'suggestions'. 
            In the 'reason' field, speak as ${g} (${v}). Explain why the card is a perfect choice for the user's style, perhaps mocking the inadequacy of alternative cards.
        `}]}],systemInstruction:{parts:[{text:w}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},rating:{type:"NUMBER"},reason:{type:"STRING",description:"Justification written in the voice of the custom helper persona."}},required:["firestoreId","rating","reason"]}}}}}};let I=0;const O=5,B=[1e3,2e3,4e3,8e3,16e3];for(;I<O;)try{const S=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!S.ok){const $=await S.json();throw new Error($.error?.message||`HTTP error! status: ${S.status}`)}const M=(await S.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(!M)throw new Error("The Oracle returned an empty vision.");return JSON.parse(M)}catch(S){if(I++,I===O)throw new Error(`The Oracle (${g}) is currently silent. Details: ${S.message}`);await new Promise(T=>setTimeout(T,B[I-1]))}},async sendMessage(t,e,r,n="",i=null){if(!t)throw new Error("API Key is missing. Please add it in Settings.");const a=i?.name||"MTG Forge",o=i?.personality?`Personality: ${i.personality}`:"Personality: Knowledgeable, friendly, and concise.",c=[{role:"user",parts:[{text:`
You are ${a}, an elite Magic: The Gathering AI assistant.
Your goal is to provide accurate, strategic, and engaging advice to players.

**Persona & Style:**
- ${o}
- Use emojis to add flair (e.g., , , , , , , ).
- Format responses using **Tailwind CSS** classes within HTML tags for a premium look.
- Do NOT use Markdown. Output raw HTML that can be injected directly into a <div>.

**Formatting Rules:**
- Use <p class="mb-2 text-gray-300"> for paragraphs.
- Use <strong class="text-indigo-400"> for key terms or card names.
- Use <ul class="list-disc pl-5 mb-2 space-y-1 text-gray-300"> for lists.
- Use <div class="bg-gray-700/50 p-3 rounded-lg border-l-4 border-indigo-500 mb-2"> for important notes or rules citations.
- Use <code class="bg-gray-900 px-1 py-0.5 rounded text-indigo-300 font-mono text-sm"> for mana costs (e.g., {1}{U}{B}) or keywords.

**Content Guidance:**
- If asked about rules, cite the Comprehensive Rules if possible.
- If asked about deck building, consider mana curve, synergy, and format staples.
- If asked about lore, be descriptive and immersive.

**Current Context & Documentation:**
You are currently helping the user on a specific page. 
Here is the relevant documentation for the user's current view. USE THIS to answer their questions:
---
${n}
---
If the user's question is about the current page, prioritize the information above.
`.trim()}]},...e.map(p=>({role:p.role==="user"?"user":"model",parts:[{text:p.content}]})),{role:"user",parts:[{text:r}]}],u=["gemini-2.5-flash","gemini-2.0-flash","gemini-flash-latest","gemini-2.5-flash-lite","gemini-2.0-flash-lite","gemini-flash-lite-latest","gemini-exp-1206","gemini-pro-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-pro","gemini-1.5-pro-latest"];let h=null;for(const p of u)try{const m=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${p}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:c})});if(!m.ok){const v=await m.json();if(m.status===404||m.status===429){console.warn(`Model ${p} failed (${m.status}). Trying next...`),h=v;continue}throw new Error(v.error?.message||`Gemini API Error: ${m.statusText}`)}return(await m.json()).candidates?.[0]?.content?.parts?.[0]?.text||"I couldn't generate a response."}catch(m){console.warn(`Error with model ${p}:`,m),h=m}throw console.error("All Gemini models failed. Last error:",h),h||new Error("Failed to connect to any Gemini model.")},async spruceUpText(t,e,r="General"){const n=`
            You are an expert project manager and communications specialist.
            Please rewrite the following ${r} description to be more professional, clear, and structured.
            
            - Use **HTML** formatting (<b>, <ul>, <li>, <p>, <br>).
            - Keep it concise but detailed enough.
            - Correct any grammar or spelling mistakes.
            - If it's a bug report, ensure steps are clear.
            - If it's a feature request (Epic), ensure the value/goal is clear.
            - Do NOT wrap the output in markdown code blocks or quotes. Just return the raw HTML string.
            
            Original Text:
            "${e}"
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Spruce Up Error:",i),new Error("Failed to spruce up text.")}},async getDeckStrategy(t,e,r=null,n=[],i=null){if(!t)throw new Error("API Key is missing.");const a=i?.name||"The Oracle",o=i?.personality?`Adopt the persona of ${a}: ${i.personality}`:"Act as a Magic: The Gathering expert.",l=n&&n.length>0,c=l?`Existing Deck List Analysis:
${n.map(p=>`- ${p.countInDeck||1}x ${p.name} (${p.type_line||"Unknown"})`).join(`
`)}

Total Lands: ${n.reduce((p,m)=>m.type_line?.toLowerCase().includes("land")?p+(m.countInDeck||1):p,0)}`:"This is a NEW deck build.";let u="";r&&(u=`
                User Playstyle Profile:
                - Archetypes: ${r.archetypes?.join(", ")||"N/A"}
                - Summary: ${r.summary||"N/A"}
                - Aggression: ${r.scores?.aggression||0}
                - Combo Affinity: ${r.scores?.comboAffinity||0}
                - Interaction: ${r.scores?.interaction||0}
                Tailor the deck's theme and card suggestions to align with this playstyle.
            `);const h=`
            ${o} I have chosen "${e}" as my Commander.
            
            ${c}
            
            ${l?"Analyze the PROVIDED deck list. Identify the specific game plan, key synergies between these cards, and how to pilot THIS build.":"Suggest a competitive yet fun deck strategy tailored to the following playstyle."}
            
            ${u}

            **Deck Composition Goals:**
            - Lands: 35-38
            - Mana Ramp: 10-12
            - Card Draw: 10
            - Targeted Removal: 8-10
            - Board Wipes: 2-4
            - Synergy / Strategy: 25-30

            **Mana Curve Goal (Bell Curve):**
            - 1-2 Mana: High volume for setup.
            - 3-4 Mana: Moderate volume for utility/threats.
            - 5+ Mana: Low volume for finishers.

            **Formatting Instructions:**
            - Use **HTML** for the 'strategy' field.
            - The 'theme' field should be a **short, punchy title** (e.g., "Elemental Mastery", "Shadow Infiltration").
            - The 'strategy' field should start with a **Theme Summary**: 2-3 sentences providing high-level context, styled with a distinct, prominent look.
            - Focus on a structured breakdown:
              1. **Welcome/Theme Summary**: A few sentences on why this commander and theme work.
              2. **Commander Context**: What are the assumed or key abilities that drive the build?
              3. **Early Game (Turns 1-3)**: Focus on setup, ramp, and disruption. Use a  emoji.
              4. **Mid Game (Turns 4-6)**: Focus on value engines and commander deployment. Use a  emoji.
              5. **Late Game (Turns 7+)**: Focus on finishers and storming off. Use a  emoji.
              6. **Key Synergies & Combos**: Highlight 3-4 specific card combinations. Use a  emoji.
            - Use **Tailwind CSS** classes (e.g., <span class="text-indigo-400 font-bold">Key Card</span>) to highlight important terms.
            - Use headers for each phase (e.g., <h4 class="text-indigo-400 font-black uppercase mb-2"> Early Game</h4>).
            5. **CRITICAL: Deck Composition Numbers**:
                - You MUST calculate specific counts for this specific commander strategies.
                - Do NOT use generic numbers (like 10/10/10). Tailor them! (e.g., A spellslinger deck might want 25 Instants and only 5 Creatures).
                - The 'functional' categories MUST sum to exactly **99** cards (assuming 1 commander).
                - The 'types' categories MUST sum to exactly **99** cards.
                - Ensure 'Lands' concept matches in both sections (e.g. if Functional Lands is 36, Type Lands should be 36).

            You MUST respond with VALID JSON strictly matching this format:
            {
                "layout": {
                    "functional": {
                        "Lands": 36, 
                        "Mana Ramp": 10,
                        "Card Draw": 10,
                        "Targeted Removal": 10,
                        "Board Wipes": 3,
                        "Synergy / Strategy": 30
                    },
                    "types": {
                        "Creatures": 30,
                        "Instants": 10,
                        "Sorceries": 10,
                        "Artifacts": 10,
                        "Enchantments": 5,
                        "Planeswalkers": 0,
                        "Lands": 34
                    }
                },
                "suggestedName": "...",
                "theme": "...",
                "strategy": "<div>...Structured HTML Content...</div>"
            }
            CRITICAL: 
            1. 'layout' is the MOST IMPORTANT field. It MUST be populated.
            2. 'functional' counts must sum to exactly 99.
            3. 'types' counts must sum to exactly 99. 
            4. Do NOT refer to yourself as "The Oracle" unless your name is explicitly "The Oracle". Use ONLY your assigned name: ${a}.
            Do NOT use markdown code blocks. Return only the JSON string.
        `;try{console.log("[GeminiService] sending prompt to Gemini...");const p=await this.sendMessage(t,[],h);console.log("[GeminiService] raw response length:",p?.length);const m=p.replace(/```json/g,"").replace(/```/g,"").trim(),g=JSON.parse(m);return console.log("[GeminiService] parsed strategy:",g),g}catch(p){throw console.error("AI Strategy Error:",p),new Error("Failed to generate strategy. Please try again.")}},async generatePlaystyleQuestion(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert survey designer for Magic: The Gathering (MTG) players. Your goal is to create the most informative question to understand a user's playstyle based on their previous answers. Questions should be clear and concise, with 3-5 distinct multiple-choice answers. Avoid repeating questions. Focus on different aspects of MTG playstyles, such as deck preferences, game strategies, social interaction styles, and risk tolerance.";let n;e.length===0?n="Generate the very first question for an MTG playstyle questionnaire. This question should gauge the player's overall experience with the game, as this will help tailor subsequent questions.":e.length===1?n="Generate the second question for an MTG playstyle questionnaire. This question should build on the player's overall experience and delve into their specific preferences.":e.length===2?n="Generate the third question for an MTG playstyle questionnaire. This question should explore the player's fantasy or thematic preferences in deck building.":n=`Based on the user's previous answers, generate the next single best question to further refine their playstyle profile. Do not repeat questions.

Previous Answers:
${e.map(o=>`- ${o.question}: ${o.answer}`).join(`
`)}`;const i=`${r}

${n}

Respond with VALID JSON ONLY:
{ "question": "...", "choices": ["...", "..."] }`;try{const o=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(o)}catch(a){throw console.error("Gemini Question Error:",a),a}},async synthesizePlaystyle(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert MTG coach and psychographic analyst. Your task is to analyze a player's answers and synthesize a detailed playstyle profile. The summary should be a concise paragraph. Scores must be 0-100.",n=`Analyze the following questionnaire answers and generate a detailed playstyle profile in JSON format.

${e.map(a=>`- ${a.question} -> ${a.answer}`).join(`
`)}`,i=`${r}

${n}

Respond with VALID JSON ONLY matching this schema:
        {
            "summary": "...",
            "tags": ["tag1", "tag2"],
            "scores": { "aggression": 50, "consistency": 50, "interaction": 50, "variance": 50, "comboAffinity": 50 },
            "archetypes": ["archetype1", "archetype2"]
        }`;try{const o=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(o)}catch(a){throw console.error("Gemini Synthesis Error:",a),new Error("Failed to synthesize profile.")}},async refinePlaystyleChat(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Oracle",a=n?.personality?`Personality: ${n.personality}`:"Personality: Wise, insightful, slightly magical.",o=e.length===0,l=`
            You are ${i}, an expert MTG coach conducting a "Deep Dive" interview to build a player's psychographic profile.
            ${a}

            Current Profile Summary: ${r?.summary||"New Profile"}
            Current Tags: ${r?.tags?.join(", ")||"None"}

            Instructions:
            ${o?`1. Introduce yourself as ${i}.
                   2. Explain that you want to understand their playstyle to help build better decks.
                   3. Ask the FIRST open-ended question to start the profile (e.g. "What draws you to magic?").`:`1. Analyze the user's latest input.
                   2. Formulate a conversational response (warm, insightful, matching your persona).
                   3. Ask ONE follow-up question to dig deeper into a missing or vague area.
                   4. Simultaneously, UPDATE the JSON profile based on the new information (merging with known info).`}
        `,c=e.slice(-6),u=[{role:"user",parts:[{text:l}]},...c.map(g=>({role:g.role==="user"?"user":"model",parts:[{text:g.content}]}))],h=`
            ${o?"Generate the initial greeting and first question.":"Based on the conversation, respond to the user and update the profile."}
            RETURN JSON ONLY.
        `;u.push({role:"user",parts:[{text:h}]});const p=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let m=[];for(const g of p){try{const b=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${g}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:u,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedProfile:{type:"OBJECT",properties:{summary:{type:"STRING"},tags:{type:"ARRAY",items:{type:"STRING"}},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},consistency:{type:"NUMBER"},interaction:{type:"NUMBER"},comboAffinity:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}},required:["summary","tags","scores","archetypes"]}},required:["aiResponse","updatedProfile"]}}})});if(b.ok){const w=(await b.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(w)return JSON.parse(w)}else{const v=await b.json();if(m.push(`${g} (Schema): ${b.status} ${v.error?.message||""}`),b.status===404||b.status===429)continue}}catch(b){m.push(`${g} (Schema Error): ${b.message}`)}try{const b=JSON.parse(JSON.stringify(u));b[b.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedProfile: object }`;const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${g}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:b})});if(v.ok){const j=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(j){const _=j.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(_)}}else{const w=await v.json();m.push(`${g} (Raw): ${v.status} ${w.error?.message||""}`)}}catch(b){m.push(`${g} (Raw Error): ${b.message}`)}}throw console.error("Gemini Chat Refine Exhausted:",m),new Error(`Oracle Exhausted: ${m[0]||"Unknown error"}`)},async forgeHelperChat(t,e,r){if(!t)throw new Error("API Key is missing.");const n=`
            You are an expert fantasy writer and character designer allowing a user to "Forge" their own AI companion for Magic: The Gathering.
            Your goal is to interview the user to define their Helper's Persona.
            
            Current Draft:
            - Name: ${r?.name||"Unknown"}
            - Type: ${r?.type||"Unknown"} (e.g., Spirit, Goblin, Construct, Wizard)
            - Personality: ${r?.personality||"Unknown"} (e.g., Snarky, Wise, Aggressive)

            Instructions:
            1. Analyze the user's input.
            2. If they provided new info (name, type, personality), UPDATE the JSON draft locally.
            3. Respond in a neutral, helpful "System" tone (like a character creation menu guide).
            4. Ask for the missing fields one by one.
            5. If all fields are present, ask for confirmation.
        `,i=e.slice(-6),a=[{role:"user",parts:[{text:n}]},...i.map(u=>({role:u.role==="user"?"user":"model",parts:[{text:u.content}]}))];a.push({role:"user",parts:[{text:`
            Based on the conversation, respond to the user and update the helper draft.
            RETURN JSON ONLY.
        `}]});const l=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let c=[];for(const u of l){try{const h=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${u}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:a,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedDraft:{type:"OBJECT",properties:{name:{type:"STRING"},type:{type:"STRING"},personality:{type:"STRING"}},required:["name","type","personality"]}},required:["aiResponse","updatedDraft"]}}})});if(h.ok){const m=(await h.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(m)return JSON.parse(m)}else{const p=await h.json();if(c.push(`${u}: ${h.status}`),h.status===404||h.status===429)continue}}catch(h){c.push(`${u}: ${h.message}`)}try{const h=JSON.parse(JSON.stringify(a));h[h.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedDraft: object }`;const p=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${u}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h})});if(p.ok){const g=(await p.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(g){const b=g.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(b)}}}catch{}}throw new Error(`Forge Exhausted: ${c.join(" | ")}`)},async generateDeckSuggestions(t,e,r=null){if(!t)throw new Error("API Key is missing.");const{playstyle:n,targetRole:i,deckRequirements:a}=e,o=r?.name||"Expert MTG Deck Builder",l=r?.personality?`Adopt the persona of ${o}: ${r.personality}`:"";let c="";n&&(c=`
                User Playstyle: ${n.archetypes?.join(", ")||"N/A"}. 
                Summary: ${n.summary||"N/A"}.
            `);const u=`
            You are ${o}. ${l}
            Analyze the provided candidates to build a well-balanced deck.
            ${c}
            
            **Mana Curve Priorities (Bell Curve):**
            Focus on CMC 1-2 for high volume, 3-4 for moderate, 5+ for finishers.

            **Multi-Role Fulfillment:**
            You will be given a list of "Requirements" (Target Counts per Role).
            Select the best cards from the candidates to fill these specific roles.
            Ensure you meet the target counts for each role as best as possible.
            Assign a specific "role" string to each suggestion matching the Requirement key.
        `,h=["gemini-2.0-flash","gemini-flash-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro","gemini-1.5-pro-latest"],p={role:"system",parts:[{text:u}]},m=[{role:"user",parts:[{text:`Task: ${e.instructions}

Requirements: ${JSON.stringify(a||{})}

Candidates: ${JSON.stringify(e.candidates)}

IMPORTANT: You MUST respond with a VALID JSON object containing a "suggestions" array. Each suggestion needs "rating" (1-10), "reason", and "role".`}]}];let g=[];for(const b of h){try{const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:p,contents:m,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},name:{type:"STRING"},count:{type:"NUMBER"},rating:{type:"NUMBER"},reason:{type:"STRING"},role:{type:"STRING"},isBasicLand:{type:"BOOLEAN"}},required:["rating","reason","role"]}}},required:["suggestions"]}}})});if(v.ok){const j=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(j)return JSON.parse(j)}else{const w=await v.json();if(g.push(`${b} (Schema): ${v.status} ${w.error?.message||""}`),v.status===404||v.status===429)continue}}catch(v){g.push(`${b} (Schema Error): ${v.message}`)}try{const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:p,contents:[{role:"user",parts:[{text:`${m[0].parts[0].text}

You MUST respond with VALID RAW JSON format ONLY. Do not use markdown blocks.`}]}]})});if(v.ok){const j=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(j){const _=j.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(_)}}else{const w=await v.json();g.push(`${b} (Raw): ${v.status} ${w.error?.message||""}`)}}catch(v){g.push(`${b} (Raw Error): ${v.message}`)}}throw console.error("[Gemini] All models failed. Summary:",g),new Error(`Oracle Exhausted: ${g.join(" | ")}`)},async analyzeDeck(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Deck Doctor",a=n?.personality?`Adopt the persona of ${i}: ${n.personality}`:"Personality: Clinical, precise, but encouraging.",o=e.map(p=>`- ${p.countInDeck||1}x ${p.name} (${p.type_line})`).join(`
`)+`

Total Lands: ${e.reduce((p,m)=>m.type_line?.toLowerCase().includes("land")?p+(m.countInDeck||1):p,0)}`,l=`
            You are ${i}, an expert Magic: The Gathering deck consultant.
            ${a}
            Your goal is to Grade a deck on a scale of 0-100 and identify critical flaws.
        `,c=`
            Analyze this Commander deck for "${r}":
            
            ${o}

            **Rubric:**
            - **Synergy**: Do cards support the commander?
            - **Speed**: Is there enough ramp? Is the curve too high?
            - **Interaction**: Is there enough removal/protection?
            - **Consistency**: Is there enough card draw/tutors?

            **Task:**
            1. Calculate a Score (0-100).
            2. Rate Synergy, Speed, Interaction (0-100).
            3. List 3-5 critical "Issues" (strings).
            4. Propose up to 5 specific "Changes". For each change:
                - "remove": Exact card name to cut.
                - "add": Exact card name to add.
                - "reason": Why?

            **Response Format (VALID JSON ONLY):**
            {
                "score": 85,
                "metrics": { "synergy": 80, "speed": 70, "interaction": 60 },
                "issues": ["Not enough lands (32)", "Lack of board wipes"],
                "changes": [
                    { "remove": "Bad Card", "add": "Good Card", "reason": "Strict upgrade for mana cost." }
                ]
            }
        `,u=[{role:"user",parts:[{text:l}]},{role:"user",parts:[{text:c}]}],h=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash"];for(const p of h)try{const m=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${p}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:u,generationConfig:{responseMimeType:"application/json"}})});if(m.ok){const b=(await m.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(b)return JSON.parse(b)}}catch(m){console.warn(`Deck Doctor (${p}) failed:`,m)}throw new Error("Deck Doctor failed to diagnose.")},async generateReleaseNotes(t,e){if(!t)throw new Error("API Key is missing.");if(!e||e.length===0)throw new Error("No tickets provided for release notes.");const n=`
            You are a professional software release manager and technical writer for "MTG-Forge". 
            Generate a Development Update in HTML using Tailwind CSS. 
            Strictly follow the structure and styling below.

            **TICKETS DATA:**
            ${e.map(i=>{const a=i.type==="bug"&&i.created_by_username?` [Submitted by: ${i.created_by_username}]`:"";return`- [${i.type.toUpperCase()}] [Status: ${i.status}] ${i.title}${i.epic_title?` (Project: ${i.epic_title})`:""}${a}: ${i.description?.replace(/<[^>]*>?/gm,"").substring(0,200)}...`}).join(`
`)}

            **STRICT LAYOUT RULES:**
            1. **Title**: A large, bold title like "MTG-Forge Development Update! ".
            2. **Intro**: A warm greeting for "Planeswalkers" with a globe emoji .
            3. **Sections**: Group items into:
               - " New Features" (Completed features)
               - " Bug Fixes" (Completed bugs)
               - " In Progress" (Everything else)
            4. **Section Cards**: Each section should have ONE large card containing its list of items.
               - Card Style: <div class="bg-gray-800/40 border-l-4 p-4 rounded-lg mb-6 ...">
               - Border Colors: green-500 for Features, red-500 for Bugs, gray-500 for In Progress.
            5. **Feature/Bug items**: Use <strong> for titles. For bugs, include a subtle "@username" shoutout for the report.
            6. **Highlights**: Use <span class="text-indigo-400 font-bold"> for important keywords or project names.
            7. **Sign-off**: A final warm closing message to Planeswalkers, ending with "see you in the next patch! ".

            **TECHNICAL CONSTRAINTS:**
            - Use only Tailwind CSS classes.
            - Do NOT use markdown code blocks (\`\`\`html).
            - Output ONLY the clean HTML string.
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Release Notes Error:",i),new Error("Failed to generate release notes.")}},gradeDeck:async(t,e)=>{const{deckName:r,commander:n,cards:i,playerProfile:a,strategyGuide:o,helperPersona:l}=e;l?.name;const p={contents:[{parts:[{text:`
            Analyze this deck: "${r}"
            Commander: ${n}
            
            [DECK LIST]
            ${i.map(b=>`${b.countInDeck||1}x ${b.name} (${b.type_line})`).join(`
`)}
            
            Return JSON only.
        `}]}],systemInstruction:{parts:[{text:`You are a Magic: The Gathering usage analytics engine and professional deck consultant.
        Your task is to classify a Commander deck into the "Commander Brackets" (1-5), calculate a precise "Power Level" (1.0 - 10.0), and provide deep surgical analysis.
        
        DEFINITIONS:
        - **Bracket 1 (Exhibition)**: Ultra-casual. No Mass Land Denial (MLD), no extra turns, no 2-card infinite combos, few tutors. "Few game changers."
        - **Bracket 2 (Core)**: Average current preconstructed deck. No MLD, no chaining extra turns, no 2-card infinite combos, few tutors.
        - **Bracket 3 (Upgraded)**: Beyond the strength of an average precon. Late game 2-card infinite combos allowed, up to 3 "game changers".
        - **Bracket 4 (Optimized)**: High power commander. No restrictions (other than the banned list). Highly efficient.
        - **Bracket 5 (cEDH)**: Maximum power, very competitive and metagame focused mindset. No restrictions.

        METRICS:
        - **Efficiency** (0-10): Speed of mana curve and ramp.
        - **Interaction** (0-10): Count and efficiency of removal/protection.
        - **Win_Turn** (Attempted Win Turn): Average turn the deck threatens a win.
        
        DIAGNOSTICS:
        - Provide a "Critique" (The overall state of the deck).
        - Provide "Mechanical Improvements" (General strategic advice).
        - Provide "Recommended Swaps" (Specific card-for-card replacements from the meta).
        
        OUTPUT: Return a JSON object with the calculated metrics and diagnostics.`}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{powerLevel:{type:"NUMBER",description:"Precise Power Level float (1.0 to 10.0). e.g. 6.13"},commanderBracket:{type:"INTEGER",description:"Bracket ID: 1, 2, 3, 4, or 5"},metrics:{type:"OBJECT",properties:{efficiency:{type:"NUMBER",description:"0-10 score"},interaction:{type:"NUMBER",description:"0-10 score"},winTurn:{type:"NUMBER",description:"Estimated average win turn"}}},bracketJustification:{type:"STRING",description:"Short explanation of why it falls in this bracket."},critique:{type:"STRING",description:"Deep analysis of the deck's current state."},mechanicalImprovements:{type:"ARRAY",items:{type:"STRING"},description:"List of general strategic improvements."},recommendedSwaps:{type:"ARRAY",items:{type:"OBJECT",properties:{remove:{type:"STRING",description:"Card to remove"},add:{type:"STRING",description:"Card to add"},reason:{type:"STRING",description:"Why this swap is better"}},required:["remove","add","reason"]}},pros:{type:"ARRAY",items:{type:"STRING"}},cons:{type:"ARRAY",items:{type:"STRING"}}},required:["powerLevel","commanderBracket","metrics","bracketJustification","critique","mechanicalImprovements","recommendedSwaps"]}}};let m=0,g="gemini-3-flash-preview";for(;m<4;)try{const b=`https://generativelanguage.googleapis.com/v1beta/models/${g}:generateContent?key=${t||""}`,v=await fetch(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(v.status===429){if(console.warn(`Deck Doctor: Rate Limited (429) on ${g}. Switching to backup...`),g==="gemini-3-flash-preview")g="gemini-2.0-flash-exp";else if(g==="gemini-2.0-flash-exp")g="gemini-1.5-flash";else throw new Error("All models exhausted");await new Promise(_=>setTimeout(_,1e3));continue}if(!v.ok)throw new Error(`API Error: ${v.status}`);const j=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(j)return JSON.parse(j);throw new Error("Empty response from AI")}catch(b){console.warn(`Deck Grade Attempt ${m+1} failed:`,b),m++,await new Promise(v=>setTimeout(v,1e3*m))}throw new Error("Failed to Grade Deck. The Oracle is currently overwhelmed.")}},Ow=10,fX=({isOpen:t,onClose:e,onComplete:r})=>{const{userProfile:n}=Or(),[i,a]=y.useState("selection"),[o,l]=y.useState("intro"),[c,u]=y.useState([]),[h,p]=y.useState([]),[m,g]=y.useState(null),[b,v]=y.useState(null),[w,j]=y.useState([]),[_,E]=y.useState(null),[I,O]=y.useState(""),B=y.useRef(null),[S,T]=y.useState(!1),[M,$]=y.useState(null),k=n?.settings?.helper?.name||"The Oracle";y.useEffect(()=>{t&&L()},[t]),y.useEffect(()=>{B.current?.scrollIntoView({behavior:"smooth"})},[w]);const L=()=>{a("selection"),l("intro"),p([]),j([]),E(null),$(null),v(null),O("")},R=()=>{a("quick"),l("loading"),V([])},V=async q=>{l("loading"),T(!0),$(null),v(null);try{const U=n?.settings?.geminiApiKey;if(!U)throw new Error("Gemini API Key is missing.");const W=await ul.generatePlaystyleQuestion(U,q);g(W),l("question")}catch(U){console.error("Quick Wizard Error:",U),$(U.message||"Failed to summon the oracle."),a("error")}finally{T(!1)}},Y=async q=>{v(q),await new Promise(Z=>setTimeout(Z,600));const U={question:m.question,answer:q},W=[...h,U];p(W),W.length>=Ow?X(W):V(W)},X=async q=>{a("synthesis");try{const U=n?.settings?.geminiApiKey,W=await ul.synthesizePlaystyle(U,q);r&&await r(W),e()}catch{$("Failed to synthesize your profile."),a("error")}},J=async()=>{a("advanced"),l("chat"),T(!0),E({summary:"Pending analysis...",tags:[],scores:{}});try{const q=n?.settings?.geminiApiKey;if(!q)throw new Error("API Key missing.");const U=await ul.refinePlaystyleChat(q,[],_,n.settings.helper);j([{role:"model",content:U.aiResponse}])}catch(q){console.error("Intro Error:",q),j([{role:"model",content:`Greetings. I am ${k}. Let us begin our analysis.`}])}finally{T(!1)}},re=async()=>{if(!I.trim())return;const q={role:"user",content:I},U=[...w,q];j(U),O(""),T(!0);try{const W=n?.settings?.geminiApiKey;if(!W)throw new Error("API Key missing.");const Z=await ul.refinePlaystyleChat(W,U,_,n.settings.helper);E(Z.updatedProfile),j(de=>[...de,{role:"model",content:Z.aiResponse}])}catch(W){console.error("Chat Error:",W),j(Z=>[...Z,{role:"model",content:"My connection to the leyline flickered. Please repeat that."}])}finally{T(!1)}},se=async()=>{a("synthesis"),_&&r&&await r(_),e()},ee=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),re())};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl h-[85vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-20 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i==="selection"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 space-y-12 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"How shall we determine your magical signature?"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl",children:[s.jsxs("button",{onClick:R,className:"group relative bg-gray-800/50 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13 2L3 14h9v8l10-12h-9l9-8z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Quick Setup"}),s.jsxs("p",{className:"text-gray-400 group-hover:text-gray-300",children:["Answer ",Ow," rapid-fire questions to generate a baseline profile. Best for getting started quickly."]}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-indigo-400 uppercase tracking-wider",children:["Start Assessment ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]}),s.jsxs("button",{onClick:J,className:"group relative bg-gray-800/50 hover:bg-purple-900/20 border border-gray-700 hover:border-purple-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-purple-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-purple-300 transition-colors",children:"Deep Dive"}),s.jsx("p",{className:"text-gray-400 group-hover:text-gray-300",children:"Have a conversation with the Oracle. Iterate on your preferences in real-time for a highly tailored profile."}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-purple-400 uppercase tracking-wider",children:["Enter The Sanctum ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]})]}),s.jsx("div",{className:"text-gray-500 text-sm",children:"You can always retake this assessment later from your profile settings."})]}),i==="quick"&&s.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-900",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-gray-900/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 mr-3"}),"Quick Assessment"]}),s.jsxs("div",{className:"text-sm font-mono text-indigo-400",children:["Q",h.length+1," / ",Ow]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-8 flex flex-col items-center justify-center",children:o==="loading"?s.jsxs("div",{className:"flex flex-col items-center space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"Consulting the archives..."})]}):m&&s.jsxs("div",{className:"max-w-2xl w-full space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:{width:`${h.length/Ow*100}%`}})}),s.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-relaxed text-center",children:m.question}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:m.choices.map((q,U)=>{const W=b===q;return s.jsxs("button",{onClick:()=>Y(q),disabled:b!==null,className:`
                                                            group flex items-center p-4 rounded-xl border transition-all duration-200 text-left
                                                            ${W?"bg-indigo-600/20 border-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-gray-800 border-gray-700 hover:bg-gray-750 hover:border-gray-600"}
                                                            ${b&&!W?"opacity-50":""}
                                                        `,children:[s.jsx("span",{className:`
                                                            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 transition-colors
                                                            ${W?"bg-indigo-500 text-white":"bg-gray-700 text-gray-400 group-hover:bg-gray-600"}
                                                        `,children:String.fromCharCode(65+U)}),s.jsx("span",{className:`text-lg transition-colors ${W?"text-white":"text-gray-300 group-hover:text-white"}`,dangerouslySetInnerHTML:{__html:q}})]},U)})})]})})]}),i==="advanced"&&s.jsxs("div",{className:"flex-1 flex h-full",children:[s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 border-r border-gray-800 w-2/3",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center px-6 bg-gray-900/80 backdrop-blur-sm z-10",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold",children:k}),s.jsx("p",{className:"text-xs text-purple-400",children:"Deep Dive Analysis"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[w.map((q,U)=>s.jsx("div",{className:`flex ${q.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`
                                            max-w-[80%] rounded-2xl p-4 text-sm leading-relaxed
                                            ${q.role==="user"?"bg-purple-600 text-white rounded-br-none":"bg-gray-800 text-gray-200 border border-gray-700 rounded-bl-none"}
                                        `,children:q.content})},U)),S&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 border border-gray-700 rounded-bl-none flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-100"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-200"})]})}),s.jsx("div",{ref:B})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:I,onChange:q=>O(q.target.value),onKeyDown:ee,placeholder:"Describe your playstyle...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500",disabled:S}),s.jsx("button",{onClick:re,disabled:S||!I.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 rounded-xl font-bold transition-colors",children:"Send"})]})})]}),s.jsxs("div",{className:"w-1/3 bg-gray-950 p-6 overflow-y-auto border-l border-gray-800 hidden md:block",children:[s.jsxs("h3",{className:"text-white font-bold mb-6 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Live Profile Summary"]}),_?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Analysis"}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:_.summary||"Gathering data..."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Dominant Traits"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:_.tags?.length>0?_.tags.map((q,U)=>s.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:q},U)):s.jsx("span",{className:"text-gray-600 text-xs italic",children:"Pending..."})})]}),_.scores&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Psychographics"}),Object.entries(_.scores).map(([q,U])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1 capitalize",children:[s.jsx("span",{children:q.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{children:[U,"%"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-indigo-500",style:{width:`${U}%`}})})]},q))]}),s.jsxs("div",{className:"pt-6 border-t border-gray-800",children:[s.jsx("button",{onClick:se,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold shadow-lg hover:shadow-green-500/20 transition-all",children:"Finalize Profile"}),s.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Click whenever you feel the profile is accurate."})]})]}):s.jsxs("div",{className:"text-center py-10 text-gray-600",children:[s.jsx("div",{className:"animate-pulse mb-2 text-4xl",children:""}),s.jsx("p",{className:"text-sm",children:"The Oracle is listening..."})]})]})]}),i==="synthesis"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6 bg-gray-900 p-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-10 w-10 bg-green-500/20 rounded-full animate-pulse"})})]}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Finalizing your Grimoire..."}),s.jsx("p",{className:"text-gray-400",children:"Saving your magical identity to the archives."})]}),i==="error"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4 bg-gray-900 text-center p-8",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Something went wrong"}),s.jsx("p",{className:"text-red-300 max-w-md mx-auto",children:M}),s.jsx("button",{onClick:L,className:"mt-6 bg-gray-800 hover:bg-gray-700 text-white py-3 px-8 rounded-lg transition-colors border border-gray-600",children:"Try Again"})]})]})}):null},Rxe=({isOpen:t,onClose:e,profile:r,onRetake:n,userImage:i})=>{if(!t)return null;if(!r)return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-md bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-8 text-center space-y-6",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Playstyle Found"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"You haven't taken the assessment yet. Discover your magical identity and get better recommendations!"})]}),s.jsx("button",{onClick:n,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-0.5",children:"Start Assessment"})]})});const{summary:a,tags:o,scores:l,archetypes:c}=r;return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[s.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-800/50 p-8 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-6 ring-4 ring-gray-800 overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Playstyle"}),s.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:o&&o.map((u,h)=>s.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:u},h))}),s.jsx("button",{onClick:n,className:"mt-auto w-full py-3 px-4 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg text-sm font-bold transition-all border border-gray-600 hover:border-gray-500",children:"Retake Assessment"})]}),s.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Analysis Summary"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed text-lg font-serif italic border-l-4 border-indigo-500 pl-4 bg-gray-800/30 py-4 pr-4 rounded-r",children:['"',a,'"']})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),s.jsx("div",{className:"space-y-4",children:l&&Object.entries(l).map(([u,h])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-400 capitalize",children:u.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{className:"text-white font-mono",children:[h,"/100"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${Mxe(h)}`,style:{width:`${h}%`}})})]},u))})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Recommended Archetypes"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:c&&c.map((u,h)=>s.jsxs("div",{className:"bg-gray-800/80 p-4 rounded-lg border border-gray-700 flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),s.jsx("span",{className:"text-gray-200 font-medium",children:u})]},h))})]})]})]})]})]})})};function Mxe(t){return t>75?"bg-green-500":t>50?"bg-blue-500":t>25?"bg-yellow-500":"bg-red-500"}const Dxe=[{id:"alpha_tester",label:"Alpha Tester",icon:"",description:"Restoring balance to the multiverse."},{id:"bug_hunter",label:"Bug Hunter",icon:"",description:"Tracking down pests in the code."},{id:"architect",label:"Architect",icon:"",description:"Building the foundation of the future."},{id:"spark_ignited",label:"Spark Ignited",icon:"",description:"First to walk the planes."},{id:"data_scryer",label:"Data Scryer",icon:"",description:"Analyzing the meta streams."},{id:"stress_tester",label:"Stress Tester",icon:"",description:"Breaking things so we can fix them."},{id:"feedback_loop",label:"Feedback Loop",icon:"",description:"Iterating towards perfection."},{id:"void_gazer",label:"Void Gazer",icon:"",description:"Staring into the console logs."}],Bxe=({isOpen:t,onClose:e,currentBadgeId:r,onSelect:n,isMaster:i})=>t?s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto w-full h-full flex items-center justify-center md:pl-[250px]",children:[s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-2xl mx-4 overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-500",children:""})," Customize Your Badge"]}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a badge to display next to your profile."})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto custom-scrollbar",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Dxe.filter(a=>a.id!=="architect"||i).map(a=>s.jsxs("button",{onClick:()=>n(a),className:`flex items-center gap-4 p-4 rounded-xl border text-left transition-all ${r===a.id?"bg-indigo-900/30 border-indigo-500 ring-1 ring-indigo-500/50":"bg-gray-800/30 border-gray-700 hover:bg-gray-800 hover:border-gray-600"}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-2xl shadow-inner border border-gray-700",children:a.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:`font-bold ${r===a.id?"text-indigo-300":"text-white"}`,children:a.label}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]})]},a.id))})}),s.jsx("div",{className:"p-4 bg-gray-800/50 border-t border-gray-800 text-center text-xs text-gray-500",children:"Thank you for being an early supporter of MTG-Forge."})]})]}):null,nr={FREE:"free",TIER_1:"tier_1",TIER_2:"tier_2",TIER_3:"tier_3",TIER_4:"tier_4",TIER_5:"tier_5"},Vs={[nr.FREE]:{name:"Initiate",prices:{monthly:null,biannual:null,yearly:null},description:"The journey begins. Track up to 3 decks and 300 cards.",limits:{collection:300,wishlist:105,decks:3,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[nr.TIER_1]:{name:"Apprentice",prices:{monthly:"price_1SnxT7RZLrZbIKATICyA3jfB",biannual:"price_1SnxUeRZLrZbIKATlErTgHtz",yearly:"price_1SnxUuRZLrZbIKATm6nmPnUr"},description:"Perfect for new potential. Store up to 10 decks and 1,000 cards.",limits:{collection:1e3,wishlist:300,decks:10,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[nr.TIER_2]:{name:"Magician",prices:{monthly:"price_1SnvK5DBKqoK8H1Rj7uSTSfw",biannual:"price_1SnvVSDBKqoK8H1RFAqc0iIH",yearly:"price_1SnvVfDBKqoK8H1RryOTO2p8"},description:"Unlock the power of organization. 25 decks, 2,000 cards, and advanced tools.",limits:{collection:2e3,wishlist:1e3,decks:25,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!0,pods:!1}},[nr.TIER_3]:{name:"Wizard",prices:{monthly:"price_1SnvKxDBKqoK8H1RXvh1VsT3",biannual:"price_1SnvUkDBKqoK8H1RgX9mlcxs",yearly:"price_1SnvUwDBKqoK8H1RAUVYJtmM"},description:"Master your craft. 55 decks, 5,000 cards, Pods, and the AI Deck Doctor.",limits:{collection:5e3,wishlist:2500,decks:55,pods:3},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[nr.TIER_4]:{name:"Archmage",prices:{monthly:"price_1SnvMxDBKqoK8H1RVcOon0kC",biannual:"price_1SnvUSDBKqoK8H1RRAXjFJ1h",yearly:"price_1SnvUSDBKqoK8H1RBMhvTUZA"},description:"Command a vast library. 100 decks, 10,000 cards, and advanced management.",limits:{collection:1e4,wishlist:5e3,decks:100,pods:5},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[nr.TIER_5]:{name:"Planeswalker",prices:{monthly:"price_1SnvSmDBKqoK8H1RCezHNZSu",biannual:"price_1SnvTcDBKqoK8H1RAmz1kB1d",yearly:"price_1SnvTcDBKqoK8H1Rn1rFWAws"},description:"Rule the multiverse. Unlimited access to all features and storage.",limits:{collection:1/0,wishlist:1/0,decks:1/0,pods:1/0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}}};function Ln(t){return Vs[t]||Vs[nr.FREE]}const $xe=typeof document<"u"?Pe.useLayoutEffect:()=>{},U0=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},Pp=t=>t&&"window"in t&&t.window===t?t:U0(t).defaultView||window;function Fxe(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function Uxe(t){return Fxe(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let zxe=!1;function LI(){return zxe}function pX(t,e){if(!LI())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:Uxe(r)?r=r.host:r=r.parentNode}return!1}const mA=(t=document)=>{var e;if(!LI())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function mX(t){return LI()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function gX(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=gX(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function gs(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=gX(t))&&(n&&(n+=" "),n+=e);return n}function qxe(t){if(Vxe())t.focus({preventScroll:!0});else{let e=Hxe(t);t.focus(),Wxe(e)}}let Rw=null;function Vxe(){if(Rw==null){Rw=!1;try{document.createElement("div").focus({get preventScroll(){return Rw=!0,!0}})}catch{}}return Rw}function Hxe(t){let e=t.parentNode,r=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),r}function Wxe(t){for(let{element:e,scrollTop:r,scrollLeft:n}of t)e.scrollTop=r,e.scrollLeft=n}function W4(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let r=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(r)&&r.some(n=>t.test(n.brand))||t.test(window.navigator.userAgent)}function xX(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function pb(t){let e=null;return()=>(e==null&&(e=t()),e)}const JN=pb(function(){return xX(/^Mac/i)}),Gxe=pb(function(){return xX(/^iPad/i)||JN()&&navigator.maxTouchPoints>1}),Kxe=pb(function(){return W4(/AppleWebKit/i)&&!Yxe()}),Yxe=pb(function(){return W4(/Chrome/i)}),Xxe=pb(function(){return W4(/Android/i)}),Qxe=pb(function(){return W4(/Firefox/i)});function Vv(t,e,r=!0){var n,i;let{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}=e;Qxe()&&(!((i=window.event)===null||i===void 0||(n=i.type)===null||n===void 0)&&n.startsWith("key"))&&t.target==="_blank"&&(JN()?a=!0:o=!0);let u=Kxe()&&JN()&&!Gxe()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c,detail:1,bubbles:!0,cancelable:!0});Vv.isOpening=r,qxe(t),t.dispatchEvent(u),Vv.isOpening=!1}Vv.isOpening=!1;function bX(){let t=y.useRef(new Map),e=y.useCallback((i,a,o,l)=>{let c=l?.once?(...u)=>{t.current.delete(o),o(...u)}:o;t.current.set(o,{type:a,eventTarget:i,fn:c,options:l}),i.addEventListener(a,c,l)},[]),r=y.useCallback((i,a,o,l)=>{var c;let u=((c=t.current.get(o))===null||c===void 0?void 0:c.fn)||o;i.removeEventListener(a,u,l),t.current.delete(o)},[]),n=y.useCallback(()=>{t.current.forEach((i,a)=>{r(i.eventTarget,i.type,a,i.options)})},[r]);return y.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function Jxe(t){return t.pointerType===""&&t.isTrusted?!0:Xxe()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function yX(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function Zxe(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function vX(t){let e=y.useRef({isFocused:!1,observer:null});return $xe(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]),y.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=r.target,i=a=>{if(e.current.isFocused=!1,n.disabled){let o=yX(a);t?.(o)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let o=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let ebe=!1,q1=null,gA=new Set,gv=new Map,om=!1,xA=!1;const tbe={Tab:!0,Escape:!0};function PI(t,e){for(let r of gA)r(t,e)}function rbe(t){return!(t.metaKey||!JN()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function ZN(t){om=!0,!Vv.isOpening&&rbe(t)&&(q1="keyboard",PI("keyboard",t))}function mx(t){q1="pointer","pointerType"in t&&t.pointerType,(t.type==="mousedown"||t.type==="pointerdown")&&(om=!0,PI("pointer",t))}function wX(t){!Vv.isOpening&&Jxe(t)&&(om=!0,q1="virtual")}function NX(t){t.target===window||t.target===document||ebe||!t.isTrusted||(!om&&!xA&&(q1="virtual",PI("virtual",t)),om=!1,xA=!1)}function jX(){om=!1,xA=!0}function bA(t){if(typeof window>"u"||typeof document>"u"||gv.get(Pp(t)))return;const e=Pp(t),r=U0(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){om=!0,n.apply(this,arguments)},r.addEventListener("keydown",ZN,!0),r.addEventListener("keyup",ZN,!0),r.addEventListener("click",wX,!0),e.addEventListener("focus",NX,!0),e.addEventListener("blur",jX,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",mx,!0),r.addEventListener("pointermove",mx,!0),r.addEventListener("pointerup",mx,!0)),e.addEventListener("beforeunload",()=>{kX(t)},{once:!0}),gv.set(e,{focus:n})}const kX=(t,e)=>{const r=Pp(t),n=U0(t);e&&n.removeEventListener("DOMContentLoaded",e),gv.has(r)&&(r.HTMLElement.prototype.focus=gv.get(r).focus,n.removeEventListener("keydown",ZN,!0),n.removeEventListener("keyup",ZN,!0),n.removeEventListener("click",wX,!0),r.removeEventListener("focus",NX,!0),r.removeEventListener("blur",jX,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",mx,!0),n.removeEventListener("pointermove",mx,!0),n.removeEventListener("pointerup",mx,!0)),gv.delete(r))};function nbe(t){const e=U0(t);let r;return e.readyState!=="loading"?bA(t):(r=()=>{bA(t)},e.addEventListener("DOMContentLoaded",r)),()=>kX(t,r)}typeof document<"u"&&nbe();function _X(){return q1!=="pointer"}const sbe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ibe(t,e,r){let n=U0(r?.target);const i=typeof window<"u"?Pp(r?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?Pp(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Pp(r?.target).HTMLElement:HTMLElement,l=typeof window<"u"?Pp(r?.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof i&&!sbe.has(n.activeElement.type)||n.activeElement instanceof a||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof l&&!tbe[r.key])}function abe(t,e,r){bA(),y.useEffect(()=>{let n=(i,a)=>{ibe(!!r?.isTextInput,i,a)&&t(_X())};return gA.add(n),()=>{gA.delete(n)}},e)}function obe(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:i}=t;const a=y.useCallback(c=>{if(c.target===c.currentTarget)return n&&n(c),i&&i(!1),!0},[n,i]),o=vX(a),l=y.useCallback(c=>{const u=U0(c.target),h=u?mA(u):mA();c.target===c.currentTarget&&h===mX(c.nativeEvent)&&(r&&r(c),i&&i(!0),o(c))},[i,r,o]);return{focusProps:{onFocus:!e&&(r||i||n)?l:void 0,onBlur:!e&&(n||i)?a:void 0}}}function lbe(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:i}=t,a=y.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:l}=bX(),c=y.useCallback(p=>{p.currentTarget.contains(p.target)&&a.current.isFocusWithin&&!p.currentTarget.contains(p.relatedTarget)&&(a.current.isFocusWithin=!1,l(),r&&r(p),i&&i(!1))},[r,i,a,l]),u=vX(c),h=y.useCallback(p=>{if(!p.currentTarget.contains(p.target))return;const m=U0(p.target),g=mA(m);if(!a.current.isFocusWithin&&g===mX(p.nativeEvent)){n&&n(p),i&&i(!0),a.current.isFocusWithin=!0,u(p);let b=p.currentTarget;o(m,"focus",v=>{if(a.current.isFocusWithin&&!pX(b,v.target)){let w=new m.defaultView.FocusEvent("blur",{relatedTarget:v.target});Zxe(w,b);let j=yX(w);c(j)}},{capture:!0})}},[n,i,u,o,c]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:h,onBlur:c}}}let yA=!1,Mw=0;function cbe(){yA=!0,setTimeout(()=>{yA=!1},50)}function E9(t){t.pointerType==="touch"&&cbe()}function ube(){if(!(typeof document>"u"))return Mw===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",E9),Mw++,()=>{Mw--,!(Mw>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",E9)}}function SX(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:i}=t,[a,o]=y.useState(!1),l=y.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;y.useEffect(ube,[]);let{addGlobalListener:c,removeAllGlobalListeners:u}=bX(),{hoverProps:h,triggerHoverEnd:p}=y.useMemo(()=>{let m=(v,w)=>{if(l.pointerType=w,i||w==="touch"||l.isHovered||!v.currentTarget.contains(v.target))return;l.isHovered=!0;let j=v.currentTarget;l.target=j,c(U0(v.target),"pointerover",_=>{l.isHovered&&l.target&&!pX(l.target,_.target)&&g(_,_.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:j,pointerType:w}),r&&r(!0),o(!0)},g=(v,w)=>{let j=l.target;l.pointerType="",l.target=null,!(w==="touch"||!l.isHovered||!j)&&(l.isHovered=!1,u(),n&&n({type:"hoverend",target:j,pointerType:w}),r&&r(!1),o(!1))},b={};return typeof PointerEvent<"u"&&(b.onPointerEnter=v=>{yA&&v.pointerType==="mouse"||m(v,v.pointerType)},b.onPointerLeave=v=>{!i&&v.currentTarget.contains(v.target)&&g(v,v.pointerType)}),{hoverProps:b,triggerHoverEnd:g}},[e,r,n,i,l,c,u]);return y.useEffect(()=>{i&&p({currentTarget:l.target},l.pointerType)},[i]),{hoverProps:h,isHovered:a}}function CX(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=y.useRef({isFocused:!1,isFocusVisible:e||_X()}),[a,o]=y.useState(!1),[l,c]=y.useState(()=>i.current.isFocused&&i.current.isFocusVisible),u=y.useCallback(()=>c(i.current.isFocused&&i.current.isFocusVisible),[]),h=y.useCallback(g=>{i.current.isFocused=g,o(g),u()},[u]);abe(g=>{i.current.isFocusVisible=g,u()},[],{isTextInput:r});let{focusProps:p}=obe({isDisabled:n,onFocusChange:h}),{focusWithinProps:m}=lbe({isDisabled:!n,onFocusWithinChange:h});return{isFocused:a,isFocusVisible:l,focusProps:n?m:p}}var dbe=Object.defineProperty,hbe=(t,e,r)=>e in t?dbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,u3=(t,e,r)=>(hbe(t,typeof e!="symbol"?e+"":e,r),r);let fbe=class{constructor(){u3(this,"current",this.detect()),u3(this,"handoffState","pending"),u3(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Pd=new fbe;function Pm(t){var e;return Pd.isServer?null:t==null?document:(e=t?.ownerDocument)!=null?e:document}function vA(t){var e,r;return Pd.isServer?null:t==null?document:(r=(e=t?.getRootNode)==null?void 0:e.call(t))!=null?r:document}function EX(t){var e,r;return(r=(e=vA(t))==null?void 0:e.activeElement)!=null?r:null}function pbe(t){return EX(t)===t}function G4(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function df(){let t=[],e={addEventListener(r,n,i,a){return r.addEventListener(n,i,a),e.add(()=>r.removeEventListener(n,i,a))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return G4(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,i){let a=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:i}),this.add(()=>{Object.assign(r.style,{[n]:a})})},group(r){let n=df();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let i of t.splice(n,1))i()}},dispose(){for(let r of t.splice(0))r()}};return e}function Om(){let[t]=y.useState(df);return y.useEffect(()=>()=>t.dispose(),[t]),t}let pl=(t,e)=>{Pd.isServer?y.useEffect(t,e):y.useLayoutEffect(t,e)};function Rm(t){let e=y.useRef(t);return pl(()=>{e.current=t},[t]),e}let sn=function(t){let e=Rm(t);return Pe.useCallback((...r)=>e.current(...r),[e])};function mbe(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function gbe(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function AX({disabled:t=!1}={}){let e=y.useRef(null),[r,n]=y.useState(!1),i=Om(),a=sn(()=>{e.current=null,n(!1),i.dispose()}),o=sn(l=>{if(i.dispose(),e.current===null){e.current=l.currentTarget,n(!0);{let c=Pm(l.currentTarget);i.addEventListener(c,"pointerup",a,!1),i.addEventListener(c,"pointermove",u=>{if(e.current){let h=mbe(u);n(gbe(h,e.current.getBoundingClientRect()))}},!1),i.addEventListener(c,"pointercancel",a,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:o,onPointerUp:a,onClick:a}}}function Yd(t){return y.useMemo(()=>t,Object.values(t))}let xbe=y.createContext(void 0);function OI(){return y.useContext(xbe)}function wA(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function nu(t,e,...r){if(t in e){let i=e[t];return typeof i=="function"?i(...r):i}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,nu),n}var Hx=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Hx||{}),x0=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(x0||{});function co(){let t=ybe();return y.useCallback(e=>bbe({mergeRefs:t,...e}),[t])}function bbe({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:i,visible:a=!0,name:o,mergeRefs:l}){l=l??vbe;let c=TX(e,t);if(a)return Dw(c,r,n,o,l);let u=i??0;if(u&2){let{static:h=!1,...p}=c;if(h)return Dw(p,r,n,o,l)}if(u&1){let{unmount:h=!0,...p}=c;return nu(h?0:1,{0(){return null},1(){return Dw({...p,hidden:!0,style:{display:"none"}},r,n,o,l)}})}return Dw(c,r,n,o,l)}function Dw(t,e={},r,n,i){let{as:a=r,children:o,refName:l="ref",...c}=d3(t,["unmount","static"]),u=t.ref!==void 0?{[l]:t.ref}:{},h=typeof o=="function"?o(e):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(e)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let p={};if(e){let m=!1,g=[];for(let[b,v]of Object.entries(e))typeof v=="boolean"&&(m=!0),v===!0&&g.push(b.replace(/([A-Z])/g,w=>`-${w.toLowerCase()}`));if(m){p["data-headlessui-state"]=g.join(" ");for(let b of g)p[`data-${b}`]=""}}if(gx(a)&&(Object.keys(s0(c)).length>0||Object.keys(s0(p)).length>0))if(!y.isValidElement(h)||Array.isArray(h)&&h.length>1||Nbe(h)){if(Object.keys(s0(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(s0(c)).concat(Object.keys(s0(p))).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`))}else{let m=h.props,g=m?.className,b=typeof g=="function"?(...j)=>wA(g(...j),c.className):wA(g,c.className),v=b?{className:b}:{},w=TX(h.props,s0(d3(c,["ref"])));for(let j in p)j in w&&delete p[j];return y.cloneElement(h,Object.assign({},w,p,u,{ref:i(wbe(h),u.ref)},v))}return y.createElement(a,Object.assign({},d3(c,["ref"]),!gx(a)&&u,!gx(a)&&p),h)}function ybe(){let t=y.useRef([]),e=y.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function vbe(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function TX(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[i=>{var a;return(a=i?.preventDefault)==null?void 0:a.call(i)}]);for(let n in r)Object.assign(e,{[n](i,...a){let o=r[n];for(let l of o){if((i instanceof Event||i?.nativeEvent instanceof Event)&&i.defaultPrevented)return;l(i,...a)}}});return e}function NA(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];for(let n in r)Object.assign(e,{[n](...i){let a=r[n];for(let o of a)o?.(...i)}});return e}function Ua(t){var e;return Object.assign(y.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function s0(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function d3(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function wbe(t){return Pe.version.split(".")[0]>="19"?t.props.ref:t.ref}function gx(t){return t===y.Fragment||t===Symbol.for("react.fragment")}function Nbe(t){return gx(t.type)}function jbe(t,e,r){let[n,i]=y.useState(r),a=t!==void 0,o=y.useRef(a),l=y.useRef(!1),c=y.useRef(!1);return a&&!o.current&&!l.current?(l.current=!0,o.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&o.current&&!c.current&&(c.current=!0,o.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?t:n,sn(u=>(a||Vn.flushSync(()=>i(u)),e?.(u)))]}function kbe(t){let[e]=y.useState(t);return e}function IX(t={},e=null,r=[]){for(let[n,i]of Object.entries(t))PX(r,LX(e,n),i);return r}function LX(t,e){return t?t+"["+e+"]":e}function PX(t,e,r){if(Array.isArray(r))for(let[n,i]of r.entries())PX(t,LX(e,n.toString()),i);else r instanceof Date?t.push([e,r.toISOString()]):typeof r=="boolean"?t.push([e,r?"1":"0"]):typeof r=="string"?t.push([e,r]):typeof r=="number"?t.push([e,`${r}`]):r==null?t.push([e,""]):Sbe(r)&&!y.isValidElement(r)&&IX(r,e,t)}function _be(t){var e,r;let n=(e=t?.form)!=null?e:t.closest("form");if(n){for(let i of n.elements)if(i!==t&&(i.tagName==="INPUT"&&i.type==="submit"||i.tagName==="BUTTON"&&i.type==="submit"||i.nodeName==="INPUT"&&i.type==="image")){i.click();return}(r=n.requestSubmit)==null||r.call(n)}}function Sbe(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}let Cbe="span";var Wx=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(Wx||{});function Ebe(t,e){var r;let{features:n=1,...i}=t,a={ref:e,"aria-hidden":(n&2)===2?!0:(r=i["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return co()({ourProps:a,theirProps:i,slot:{},defaultTag:Cbe,name:"Hidden"})}let Hv=Ua(Ebe),Abe=y.createContext(null);function Tbe({children:t}){let e=y.useContext(Abe);if(!e)return Pe.createElement(Pe.Fragment,null,t);let{target:r}=e;return r?Vn.createPortal(Pe.createElement(Pe.Fragment,null,t),r):null}function Ibe({data:t,form:e,disabled:r,onReset:n,overrides:i}){let[a,o]=y.useState(null),l=Om();return y.useEffect(()=>{if(n&&a)return l.addEventListener(a,"reset",n)},[a,e,n]),Pe.createElement(Tbe,null,Pe.createElement(Lbe,{setForm:o,formId:e}),IX(t).map(([c,u])=>Pe.createElement(Hv,{features:Wx.Hidden,...s0({key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:e,disabled:r,name:c,value:u,...i})})))}function Lbe({setForm:t,formId:e}){return y.useEffect(()=>{if(e){let r=document.getElementById(e);r&&t(r)}},[t,e]),e?null:Pe.createElement(Hv,{features:Wx.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:r=>{if(!r)return;let n=r.closest("form");n&&t(n)}})}let Pbe=y.createContext(void 0);function OX(){return y.useContext(Pbe)}function Obe(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function zh(t){return Obe(t)&&"tagName"in t}function $d(t){return zh(t)&&"accessKey"in t}function Cd(t){return zh(t)&&"tabIndex"in t}function Rbe(t){return zh(t)&&"style"in t}function Mbe(t){return $d(t)&&t.nodeName==="IFRAME"}function RX(t){return $d(t)&&t.nodeName==="INPUT"}function jA(t){return $d(t)&&t.nodeName==="LABEL"}function Dbe(t){return $d(t)&&t.nodeName==="FIELDSET"}function MX(t){return $d(t)&&t.nodeName==="LEGEND"}function Bbe(t){return zh(t)?t.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function DX(t){let e=t.parentElement,r=null;for(;e&&!Dbe(e);)MX(e)&&(r=e),e=e.parentElement;let n=e?.getAttribute("disabled")==="";return n&&$be(r)?!1:n}function $be(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(MX(e))return!1;e=e.previousElementSibling}return!0}let BX=Symbol();function $X(t,e=!0){return Object.assign(t,{[BX]:e})}function wl(...t){let e=y.useRef(t);y.useEffect(()=>{e.current=t},[t]);let r=sn(n=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(n):i.current=n)});return t.every(n=>n==null||n?.[BX])?void 0:r}let K4=y.createContext(null);K4.displayName="DescriptionContext";function FX(){let t=y.useContext(K4);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,FX),e}return t}function Fbe(){var t,e;return(e=(t=y.useContext(K4))==null?void 0:t.value)!=null?e:void 0}function UX(){let[t,e]=y.useState([]);return[t.length>0?t.join(" "):void 0,y.useMemo(()=>function(r){let n=sn(a=>(e(o=>[...o,a]),()=>e(o=>{let l=o.slice(),c=l.indexOf(a);return c!==-1&&l.splice(c,1),l}))),i=y.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props,value:r.value}),[n,r.slot,r.name,r.props,r.value]);return Pe.createElement(K4.Provider,{value:i},r.children)},[e])]}let Ube="p";function zbe(t,e){let r=y.useId(),n=OI(),{id:i=`headlessui-description-${r}`,...a}=t,o=FX(),l=wl(e);pl(()=>o.register(i),[i,o.register]);let c=Yd({...o.slot,disabled:n||!1}),u={ref:l,...o.props,id:i};return co()({ourProps:u,theirProps:a,slot:c,defaultTag:Ube,name:o.name||"Description"})}let qbe=Ua(zbe),zX=Object.assign(qbe,{});var Eh=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Eh||{});let Y4=y.createContext(null);Y4.displayName="LabelContext";function qX(){let t=y.useContext(Y4);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,qX),e}return t}function VX(t){var e,r,n;let i=(r=(e=y.useContext(Y4))==null?void 0:e.value)!=null?r:void 0;return((n=void 0)!=null?n:0)>0?[i,...t].filter(Boolean).join(" "):i}function Vbe({inherit:t=!1}={}){let e=VX(),[r,n]=y.useState([]),i=t?[e,...r].filter(Boolean):r;return[i.length>0?i.join(" "):void 0,y.useMemo(()=>function(a){let o=sn(c=>(n(u=>[...u,c]),()=>n(u=>{let h=u.slice(),p=h.indexOf(c);return p!==-1&&h.splice(p,1),h}))),l=y.useMemo(()=>({register:o,slot:a.slot,name:a.name,props:a.props,value:a.value}),[o,a.slot,a.name,a.props,a.value]);return Pe.createElement(Y4.Provider,{value:l},a.children)},[n])]}let Hbe="label";function Wbe(t,e){var r;let n=y.useId(),i=qX(),a=OX(),o=OI(),{id:l=`headlessui-label-${n}`,htmlFor:c=a??((r=i.props)==null?void 0:r.htmlFor),passive:u=!1,...h}=t,p=wl(e);pl(()=>i.register(l),[l,i.register]);let m=sn(v=>{let w=v.currentTarget;if(!(v.target!==v.currentTarget&&Bbe(v.target))&&(jA(w)&&v.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(v),jA(w))){let j=document.getElementById(w.htmlFor);if(j){let _=j.getAttribute("disabled");if(_==="true"||_==="")return;let E=j.getAttribute("aria-disabled");if(E==="true"||E==="")return;(RX(j)&&(j.type==="file"||j.type==="radio"||j.type==="checkbox")||j.role==="radio"||j.role==="checkbox"||j.role==="switch")&&j.click(),j.focus({preventScroll:!0})}}}),g=Yd({...i.slot,disabled:o||!1}),b={ref:p,...i.props,id:l,htmlFor:c,onClick:m};return u&&("onClick"in b&&(delete b.htmlFor,delete b.onClick),"onClick"in h&&delete h.onClick),co()({ourProps:b,theirProps:h,slot:g,defaultTag:c?Hbe:"div",name:i.name||"Label"})}let Gbe=Ua(Wbe),Kbe=Object.assign(Gbe,{}),Ybe=y.createContext(()=>{});function HX({value:t,children:e}){return Pe.createElement(Ybe.Provider,{value:t},e)}let WX=class extends Map{constructor(e){super(),this.factory=e}get(e){let r=super.get(e);return r===void 0&&(r=this.factory(e),this.set(e,r)),r}};var Xbe=Object.defineProperty,Qbe=(t,e,r)=>e in t?Xbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jbe=(t,e,r)=>(Qbe(t,e+"",r),r),GX=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},zc=(t,e,r)=>(GX(t,e,"read from private field"),r?r.call(t):e.get(t)),h3=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},A9=(t,e,r,n)=>(GX(t,e,"write to private field"),e.set(t,r),r),yd,Yy,Xy;let Zbe=class{constructor(e){h3(this,yd,{}),h3(this,Yy,new WX(()=>new Set)),h3(this,Xy,new Set),Jbe(this,"disposables",df()),A9(this,yd,e),Pd.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return zc(this,yd)}subscribe(e,r){if(Pd.isServer)return()=>{};let n={selector:e,callback:r,current:e(zc(this,yd))};return zc(this,Xy).add(n),this.disposables.add(()=>{zc(this,Xy).delete(n)})}on(e,r){return Pd.isServer?()=>{}:(zc(this,Yy).get(e).add(r),this.disposables.add(()=>{zc(this,Yy).get(e).delete(r)}))}send(e){let r=this.reduce(zc(this,yd),e);if(r!==zc(this,yd)){A9(this,yd,r);for(let n of zc(this,Xy)){let i=n.selector(zc(this,yd));KX(n.current,i)||(n.current=i,n.callback(i))}for(let n of zc(this,Yy).get(e.type))n(zc(this,yd),e)}}};yd=new WeakMap,Yy=new WeakMap,Xy=new WeakMap;function KX(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:f3(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:f3(t.entries(),e.entries()):T9(t)&&T9(e)?f3(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function f3(t,e){do{let r=t.next(),n=e.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}while(!0)}function T9(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var eye=Object.defineProperty,tye=(t,e,r)=>e in t?eye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,I9=(t,e,r)=>(tye(t,typeof e!="symbol"?e+"":e,r),r),rye=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(rye||{});let nye={0(t,e){let r=e.id,n=t.stack,i=t.stack.indexOf(r);if(i!==-1){let a=t.stack.slice();return a.splice(i,1),a.push(r),n=a,{...t,stack:n}}return{...t,stack:[...t.stack,r]}},1(t,e){let r=e.id,n=t.stack.indexOf(r);if(n===-1)return t;let i=t.stack.slice();return i.splice(n,1),{...t,stack:i}}},sye=class YX extends Zbe{constructor(){super(...arguments),I9(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),I9(this,"selectors",{isTop:(e,r)=>e.stack[e.stack.length-1]===r,inStack:(e,r)=>e.stack.includes(r)})}static new(){return new YX({stack:[]})}reduce(e,r){return nu(r.type,nye,e,r)}};const XX=new WX(()=>sye.new());var p3={exports:{}},m3={};var L9;function iye(){if(L9)return m3;L9=1;var t=of();function e(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,o=t.useMemo,l=t.useDebugValue;return m3.useSyncExternalStoreWithSelector=function(c,u,h,p,m){var g=i(null);if(g.current===null){var b={hasValue:!1,value:null};g.current=b}else b=g.current;g=o(function(){function w(O){if(!j){if(j=!0,_=O,O=p(O),m!==void 0&&b.hasValue){var B=b.value;if(m(B,O))return E=B}return E=O}if(B=E,r(_,O))return B;var S=p(O);return m!==void 0&&m(B,S)?(_=O,B):(_=O,E=S)}var j=!1,_,E,I=h===void 0?null:h;return[function(){return w(u())},I===null?void 0:function(){return w(I())}]},[u,h,p,m]);var v=n(c,g[0],g[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},m3}var P9;function aye(){return P9||(P9=1,p3.exports=iye()),p3.exports}var oye=aye();function QX(t,e,r=KX){return oye.useSyncExternalStoreWithSelector(sn(n=>t.subscribe(lye,n)),sn(()=>t.state),sn(()=>t.state),sn(e),r)}function lye(t){return t}function V1(t,e){let r=y.useId(),n=XX.get(e),[i,a]=QX(n,y.useCallback(o=>[n.selectors.isTop(o,r),n.selectors.inStack(o,r)],[n,r]));return pl(()=>{if(t)return n.actions.push(r),()=>n.actions.pop(r)},[n,t,r]),t?a?i:!0:!1}let kA=new Map,xv=new Map;function O9(t){var e;let r=(e=xv.get(t))!=null?e:0;return xv.set(t,r+1),r!==0?()=>R9(t):(kA.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>R9(t))}function R9(t){var e;let r=(e=xv.get(t))!=null?e:1;if(r===1?xv.delete(t):xv.set(t,r-1),r!==1)return;let n=kA.get(t);n&&(n["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",n["aria-hidden"]),t.inert=n.inert,kA.delete(t))}function cye(t,{allowed:e,disallowed:r}={}){let n=V1(t,"inert-others");pl(()=>{var i,a;if(!n)return;let o=df();for(let c of(i=r?.())!=null?i:[])c&&o.add(O9(c));let l=(a=e?.())!=null?a:[];for(let c of l){if(!c)continue;let u=Pm(c);if(!u)continue;let h=c.parentElement;for(;h&&h!==u.body;){for(let p of h.children)l.some(m=>p.contains(m))||o.add(O9(p));h=h.parentElement}}return o.dispose},[n,e,r])}function uye(t,e,r){let n=Rm(i=>{let a=i.getBoundingClientRect();a.x===0&&a.y===0&&a.width===0&&a.height===0&&r()});y.useEffect(()=>{if(!t)return;let i=e===null?null:$d(e)?e:e.current;if(!i)return;let a=df();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>n.current(i));o.observe(i),a.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>n.current(i));o.observe(i),a.add(()=>o.disconnect())}return()=>a.dispose()},[e,n,t])}let ej=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),dye=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var Ah=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(Ah||{}),_A=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(_A||{}),hye=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(hye||{});function fye(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(ej)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function pye(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(dye)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var JX=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(JX||{});function mye(t,e=0){var r;return t===((r=Pm(t))==null?void 0:r.body)?!1:nu(e,{0(){return t.matches(ej)},1(){let n=t;for(;n!==null;){if(n.matches(ej))return!0;n=n.parentElement}return!1}})}var gye=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(gye||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function qh(t){t?.focus({preventScroll:!0})}let xye=["textarea","input"].join(",");function bye(t){var e,r;return(r=(e=t?.matches)==null?void 0:e.call(t,xye))!=null?r:!1}function yye(t,e=r=>r){return t.slice().sort((r,n)=>{let i=e(r),a=e(n);if(i===null||a===null)return 0;let o=i.compareDocumentPosition(a);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function bv(t,e,{sorted:r=!0,relativeTo:n=null,skipElements:i=[]}={}){let a=Array.isArray(t)?t.length>0?vA(t[0]):document:vA(t),o=Array.isArray(t)?r?yye(t):t:e&64?pye(t):fye(t);i.length>0&&o.length>1&&(o=o.filter(g=>!i.some(b=>b!=null&&"current"in b?b?.current===g:b===g))),n=n??a?.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(n))-1;if(e&4)return Math.max(0,o.indexOf(n))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},h=0,p=o.length,m;do{if(h>=p||h+p<=0)return 0;let g=c+h;if(e&16)g=(g+p)%p;else{if(g<0)return 3;if(g>=p)return 1}m=o[g],m?.focus(u),h+=l}while(m!==EX(m));return e&6&&bye(m)&&m.select(),2}function ZX(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function vye(){return/Android/gi.test(window.navigator.userAgent)}function M9(){return ZX()||vye()}function Bw(t,e,r,n){let i=Rm(r);y.useEffect(()=>{if(!t)return;function a(o){i.current(o)}return document.addEventListener(e,a,n),()=>document.removeEventListener(e,a,n)},[t,e,n])}function eQ(t,e,r,n){let i=Rm(r);y.useEffect(()=>{if(!t)return;function a(o){i.current(o)}return window.addEventListener(e,a,n),()=>window.removeEventListener(e,a,n)},[t,e,n])}const D9=30;function wye(t,e,r){let n=Rm(r),i=y.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let h=(function p(m){return typeof m=="function"?p(m()):Array.isArray(m)||m instanceof Set?m:[m]})(e);for(let p of h)if(p!==null&&(p.contains(u)||l.composed&&l.composedPath().includes(p)))return;return!mye(u,JX.Loose)&&u.tabIndex!==-1&&l.preventDefault(),n.current(l,u)},[n,e]),a=y.useRef(null);Bw(t,"pointerdown",l=>{var c,u;M9()||(a.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),Bw(t,"pointerup",l=>{if(M9()||!a.current)return;let c=a.current;return a.current=null,i(l,()=>c)},!0);let o=y.useRef({x:0,y:0});Bw(t,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),Bw(t,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=D9||Math.abs(c.y-o.current.y)>=D9))return i(l,()=>Cd(l.target)?l.target:null)},!0),eQ(t,"blur",l=>i(l,()=>Mbe(window.document.activeElement)?window.document.activeElement:null),!0)}function RI(...t){return y.useMemo(()=>Pm(...t),[...t])}function tQ(t,e,r,n){let i=Rm(r);y.useEffect(()=>{t=t??window;function a(o){i.current(o)}return t.addEventListener(e,a,n),()=>t.removeEventListener(e,a,n)},[t,e,n])}function rQ(t,e){return y.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||e?.tagName==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function Nye(t){return y.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function jye(t,e){let r=t(),n=new Set;return{getSnapshot(){return r},subscribe(i){return n.add(i),()=>n.delete(i)},dispatch(i,...a){let o=e[i].call(r,...a);o&&(r=o,n.forEach(l=>l()))}}}function kye(){let t;return{before({doc:e}){var r;let n=e.documentElement,i=(r=e.defaultView)!=null?r:window;t=Math.max(0,i.innerWidth-n.clientWidth)},after({doc:e,d:r}){let n=e.documentElement,i=Math.max(0,n.clientWidth-n.offsetWidth),a=Math.max(0,t-i);r.style(n,"paddingRight",`${a}px`)}}}function _ye(){return ZX()?{before({doc:t,d:e,meta:r}){function n(i){for(let a of r().containers)for(let o of a())if(o.contains(i))return!0;return!1}e.microTask(()=>{var i;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let l=df();l.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let a=(i=window.scrollY)!=null?i:window.pageYOffset,o=null;e.addEventListener(t,"click",l=>{if(Cd(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),h=t.querySelector(u);Cd(h)&&!n(h)&&(o=h)}catch{}},!0),e.group(l=>{e.addEventListener(t,"touchstart",c=>{if(l.dispose(),Cd(c.target)&&Rbe(c.target))if(n(c.target)){let u=c.target;for(;u.parentElement&&n(u.parentElement);)u=u.parentElement;l.style(u,"overscrollBehavior","contain")}else l.style(c.target,"touchAction","none")})}),e.addEventListener(t,"touchmove",l=>{if(Cd(l.target)){if(RX(l.target))return;if(n(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;a!==c&&window.scrollTo(0,a),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function Sye(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function B9(t){let e={};for(let r of t)Object.assign(e,r(e));return e}let Op=jye(()=>new Map,{PUSH(t,e){var r;let n=(r=this.get(t))!=null?r:{doc:t,count:0,d:df(),meta:new Set,computedMeta:{}};return n.count++,n.meta.add(e),n.computedMeta=B9(n.meta),this.set(t,n),this},POP(t,e){let r=this.get(t);return r&&(r.count--,r.meta.delete(e),r.computedMeta=B9(r.meta)),this},SCROLL_PREVENT(t){let e={doc:t.doc,d:t.d,meta(){return t.computedMeta}},r=[_ye(),kye(),Sye()];r.forEach(({before:n})=>n?.(e)),r.forEach(({after:n})=>n?.(e))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});Op.subscribe(()=>{let t=Op.getSnapshot(),e=new Map;for(let[r]of t)e.set(r,r.documentElement.style.overflow);for(let r of t.values()){let n=e.get(r.doc)==="hidden",i=r.count!==0;(i&&!n||!i&&n)&&Op.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Op.dispatch("TEARDOWN",r)}});function Cye(t,e,r=()=>({containers:[]})){let n=Nye(Op),i=e?n.get(e):void 0,a=i?i.count>0:!1;return pl(()=>{if(!(!e||!t))return Op.dispatch("PUSH",e,r),()=>Op.dispatch("POP",e,r)},[t,e]),a}function Eye(t,e,r=()=>[document.body]){let n=V1(t,"scroll-lock");Cye(n,e,i=>{var a;return{containers:[...(a=i.containers)!=null?a:[],r]}})}function Aye(t=0){let[e,r]=y.useState(t),n=y.useCallback(c=>r(c),[]),i=y.useCallback(c=>r(u=>u|c),[]),a=y.useCallback(c=>(e&c)===c,[e]),o=y.useCallback(c=>r(u=>u&~c),[]),l=y.useCallback(c=>r(u=>u^c),[]);return{flags:e,setFlag:n,addFlag:i,hasFlag:a,removeFlag:o,toggleFlag:l}}var Tye={},$9,F9;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&(($9=process==null?void 0:Tye)==null?void 0:$9.NODE_ENV)==="test"&&typeof((F9=Element?.prototype)==null?void 0:F9.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Iye=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(Iye||{});function nQ(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function sQ(t,e,r,n){let[i,a]=y.useState(r),{hasFlag:o,addFlag:l,removeFlag:c}=Aye(t&&i?3:0),u=y.useRef(!1),h=y.useRef(!1),p=Om();return pl(()=>{var m;if(t){if(r&&a(!0),!e){r&&l(3);return}return(m=n?.start)==null||m.call(n,r),Lye(e,{inFlight:u,prepare(){h.current?h.current=!1:h.current=u.current,u.current=!0,!h.current&&(r?(l(3),c(4)):(l(4),c(2)))},run(){h.current?r?(c(3),l(4)):(c(4),l(3)):r?c(1):l(1)},done(){var g;h.current&&Rye(e)||(u.current=!1,c(7),r||a(!1),(g=n?.end)==null||g.call(n,r))}})}},[t,r,e,p]),t?[i,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function Lye(t,{prepare:e,run:r,done:n,inFlight:i}){let a=df();return Oye(t,{prepare:e,inFlight:i}),a.nextFrame(()=>{r(),a.requestAnimationFrame(()=>{a.add(Pye(t,n))})}),a.dispose}function Pye(t,e){var r,n;let i=df();if(!t)return i.dispose;let a=!1;i.add(()=>{a=!0});let o=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(l=>l instanceof CSSTransition))!=null?n:[];return o.length===0?(e(),i.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{a||e()}),i.dispose)}function Oye(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function Rye(t){var e,r;return((r=(e=t.getAnimations)==null?void 0:e.call(t))!=null?r:[]).some(n=>n instanceof CSSTransition&&n.playState!=="finished")}function MI(t,e){let r=y.useRef([]),n=sn(t);y.useEffect(()=>{let i=[...r.current];for(let[a,o]of e.entries())if(r.current[a]!==o){let l=n(e,i);return r.current=e,l}},[n,...e])}let X4=y.createContext(null);X4.displayName="OpenClosedContext";var dl=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(dl||{});function H1(){return y.useContext(X4)}function iQ({value:t,children:e}){return Pe.createElement(X4.Provider,{value:t},e)}function aQ({children:t}){return Pe.createElement(X4.Provider,{value:null},t)}function Mye(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let h0=[];Mye(()=>{function t(e){if(!Cd(e.target)||e.target===document.body||h0[0]===e.target)return;let r=e.target;r=r.closest(ej),h0.unshift(r??e.target),h0=h0.filter(n=>n!=null&&n.isConnected),h0.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function oQ(t){let e=sn(t),r=y.useRef(!1);y.useEffect(()=>(r.current=!1,()=>{r.current=!0,G4(()=>{r.current&&e()})}),[e])}let lQ=y.createContext(!1);function Dye(){return y.useContext(lQ)}function U9(t){return Pe.createElement(lQ.Provider,{value:t.force},t.children)}function Bye(t){let e=Dye(),r=y.useContext(uQ),[n,i]=y.useState(()=>{var a;if(!e&&r!==null)return(a=r.current)!=null?a:null;if(Pd.isServer)return null;let o=t?.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)});return y.useEffect(()=>{n!==null&&(t!=null&&t.body.contains(n)||t==null||t.body.appendChild(n))},[n,t]),y.useEffect(()=>{e||r!==null&&i(r.current)},[r,i,e]),n}let cQ=y.Fragment,$ye=Ua(function(t,e){let{ownerDocument:r=null,...n}=t,i=y.useRef(null),a=wl($X(m=>{i.current=m}),e),o=RI(i.current),l=r??o,c=Bye(l),u=y.useContext(SA),h=Om(),p=co();return oQ(()=>{var m;c&&c.childNodes.length<=0&&((m=c.parentElement)==null||m.removeChild(c))}),c?Vn.createPortal(Pe.createElement("div",{"data-headlessui-portal":"",ref:m=>{h.dispose(),u&&m&&h.add(u.register(m))}},p({ourProps:{ref:a},theirProps:n,slot:{},defaultTag:cQ,name:"Portal"})),c):null});function Fye(t,e){let r=wl(e),{enabled:n=!0,ownerDocument:i,...a}=t,o=co();return n?Pe.createElement($ye,{...a,ownerDocument:i,ref:r}):o({ourProps:{ref:r},theirProps:a,slot:{},defaultTag:cQ,name:"Portal"})}let Uye=y.Fragment,uQ=y.createContext(null);function zye(t,e){let{target:r,...n}=t,i={ref:wl(e)},a=co();return Pe.createElement(uQ.Provider,{value:r},a({ourProps:i,theirProps:n,defaultTag:Uye,name:"Popover.Group"}))}let SA=y.createContext(null);function qye(){let t=y.useContext(SA),e=y.useRef([]),r=sn(a=>(e.current.push(a),t&&t.register(a),()=>n(a))),n=sn(a=>{let o=e.current.indexOf(a);o!==-1&&e.current.splice(o,1),t&&t.unregister(a)}),i=y.useMemo(()=>({register:r,unregister:n,portals:e}),[r,n,e]);return[e,y.useMemo(()=>function({children:a}){return Pe.createElement(SA.Provider,{value:i},a)},[i])]}let Vye=Ua(Fye),dQ=Ua(zye),Hye=Object.assign(Vye,{Group:dQ});function Wye(t,e=typeof document<"u"?document.defaultView:null,r){let n=V1(t,"escape");tQ(e,"keydown",i=>{n&&(i.defaultPrevented||i.key===Eh.Escape&&r(i))})}function Gye(){var t;let[e]=y.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[r,n]=y.useState((t=e?.matches)!=null?t:!1);return pl(()=>{if(!e)return;function i(a){n(a.matches)}return e.addEventListener("change",i),()=>e.removeEventListener("change",i)},[e]),r}function Kye({defaultContainers:t=[],portals:e,mainTreeNode:r}={}){let n=sn(()=>{var i,a;let o=Pm(r),l=[];for(let c of t)c!==null&&(zh(c)?l.push(c):"current"in c&&zh(c.current)&&l.push(c.current));if(e!=null&&e.current)for(let c of e.current)l.push(c);for(let c of(i=o?.querySelectorAll("html > *, body > *"))!=null?i:[])c!==document.body&&c!==document.head&&zh(c)&&c.id!=="headlessui-portal-root"&&(r&&(c.contains(r)||c.contains((a=r?.getRootNode())==null?void 0:a.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:n,contains:sn(i=>n().some(a=>a.contains(i)))}}let hQ=y.createContext(null);function z9({children:t,node:e}){let[r,n]=y.useState(null),i=fQ(e??r);return Pe.createElement(hQ.Provider,{value:i},t,i===null&&Pe.createElement(Hv,{features:Wx.Hidden,ref:a=>{var o,l;if(a){for(let c of(l=(o=Pm(a))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&zh(c)&&c!=null&&c.contains(a)){n(c);break}}}}))}function fQ(t=null){var e;return(e=y.useContext(hQ))!=null?e:t}function Yye(){let t=typeof document>"u";return"useSyncExternalStore"in C6?(e=>e.useSyncExternalStore)(C6)(()=>()=>{},()=>!1,()=>!t):!1}function Q4(){let t=Yye(),[e,r]=y.useState(Pd.isHandoffComplete);return e&&Pd.isHandoffComplete===!1&&r(!1),y.useEffect(()=>{e!==!0&&r(!0)},[e]),y.useEffect(()=>Pd.handoff(),[]),t?!1:e}function DI(){let t=y.useRef(!1);return pl(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var Qy=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Qy||{});function Xye(){let t=y.useRef(0);return eQ(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function pQ(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let r of t.current)zh(r.current)&&e.add(r.current);return e}let Qye="div";var Cp=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(Cp||{});function Jye(t,e){let r=y.useRef(null),n=wl(r,e),{initialFocus:i,initialFocusFallback:a,containers:o,features:l=15,...c}=t;Q4()||(l=0);let u=RI(r.current);rve(l,{ownerDocument:u});let h=nve(l,{ownerDocument:u,container:r,initialFocus:i,initialFocusFallback:a});sve(l,{ownerDocument:u,container:r,containers:o,previousActiveElement:h});let p=Xye(),m=sn(_=>{if(!$d(r.current))return;let E=r.current;(I=>I())(()=>{nu(p.current,{[Qy.Forwards]:()=>{bv(E,Ah.First,{skipElements:[_.relatedTarget,a]})},[Qy.Backwards]:()=>{bv(E,Ah.Last,{skipElements:[_.relatedTarget,a]})}})})}),g=V1(!!(l&2),"focus-trap#tab-lock"),b=Om(),v=y.useRef(!1),w={ref:n,onKeyDown(_){_.key=="Tab"&&(v.current=!0,b.requestAnimationFrame(()=>{v.current=!1}))},onBlur(_){if(!(l&4))return;let E=pQ(o);$d(r.current)&&E.add(r.current);let I=_.relatedTarget;Cd(I)&&I.dataset.headlessuiFocusGuard!=="true"&&(mQ(E,I)||(v.current?bv(r.current,nu(p.current,{[Qy.Forwards]:()=>Ah.Next,[Qy.Backwards]:()=>Ah.Previous})|Ah.WrapAround,{relativeTo:_.target}):Cd(_.target)&&qh(_.target)))}},j=co();return Pe.createElement(Pe.Fragment,null,g&&Pe.createElement(Hv,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:Wx.Focusable}),j({ourProps:w,theirProps:c,defaultTag:Qye,name:"FocusTrap"}),g&&Pe.createElement(Hv,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:Wx.Focusable}))}let Zye=Ua(Jye),eve=Object.assign(Zye,{features:Cp});function tve(t=!0){let e=y.useRef(h0.slice());return MI(([r],[n])=>{n===!0&&r===!1&&G4(()=>{e.current.splice(0)}),n===!1&&r===!0&&(e.current=h0.slice())},[t,h0,e]),sn(()=>{var r;return(r=e.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function rve(t,{ownerDocument:e}){let r=!!(t&8),n=tve(r);MI(()=>{r||pbe(e?.body)&&qh(n())},[r]),oQ(()=>{r&&qh(n())})}function nve(t,{ownerDocument:e,container:r,initialFocus:n,initialFocusFallback:i}){let a=y.useRef(null),o=V1(!!(t&1),"focus-trap#initial-focus"),l=DI();return MI(()=>{if(t===0)return;if(!o){i!=null&&i.current&&qh(i.current);return}let c=r.current;c&&G4(()=>{if(!l.current)return;let u=e?.activeElement;if(n!=null&&n.current){if(n?.current===u){a.current=u;return}}else if(c.contains(u)){a.current=u;return}if(n!=null&&n.current)qh(n.current);else{if(t&16){if(bv(c,Ah.First|Ah.AutoFocus)!==_A.Error)return}else if(bv(c,Ah.First)!==_A.Error)return;if(i!=null&&i.current&&(qh(i.current),e?.activeElement===i.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}a.current=e?.activeElement})},[i,o,t]),a}function sve(t,{ownerDocument:e,container:r,containers:n,previousActiveElement:i}){let a=DI(),o=!!(t&4);tQ(e?.defaultView,"focus",l=>{if(!o||!a.current)return;let c=pQ(n);$d(r.current)&&c.add(r.current);let u=i.current;if(!u)return;let h=l.target;$d(h)?mQ(c,h)?(i.current=h,qh(h)):(l.preventDefault(),l.stopPropagation(),qh(u)):qh(i.current)},!0)}function mQ(t,e){for(let r of t)if(r.contains(e))return!0;return!1}function gQ(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!gx((e=t.as)!=null?e:bQ)||Pe.Children.count(t.children)===1}let J4=y.createContext(null);J4.displayName="TransitionContext";var ive=(t=>(t.Visible="visible",t.Hidden="hidden",t))(ive||{});function ave(){let t=y.useContext(J4);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function ove(){let t=y.useContext(Z4);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let Z4=y.createContext(null);Z4.displayName="NestingContext";function ek(t){return"children"in t?ek(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function xQ(t,e){let r=Rm(t),n=y.useRef([]),i=DI(),a=Om(),o=sn((g,b=x0.Hidden)=>{let v=n.current.findIndex(({el:w})=>w===g);v!==-1&&(nu(b,{[x0.Unmount](){n.current.splice(v,1)},[x0.Hidden](){n.current[v].state="hidden"}}),a.microTask(()=>{var w;!ek(n)&&i.current&&((w=r.current)==null||w.call(r))}))}),l=sn(g=>{let b=n.current.find(({el:v})=>v===g);return b?b.state!=="visible"&&(b.state="visible"):n.current.push({el:g,state:"visible"}),()=>o(g,x0.Unmount)}),c=y.useRef([]),u=y.useRef(Promise.resolve()),h=y.useRef({enter:[],leave:[]}),p=sn((g,b,v)=>{c.current.splice(0),e&&(e.chains.current[b]=e.chains.current[b].filter(([w])=>w!==g)),e?.chains.current[b].push([g,new Promise(w=>{c.current.push(w)})]),e?.chains.current[b].push([g,new Promise(w=>{Promise.all(h.current[b].map(([j,_])=>_)).then(()=>w())})]),b==="enter"?u.current=u.current.then(()=>e?.wait.current).then(()=>v(b)):v(b)}),m=sn((g,b,v)=>{Promise.all(h.current[b].splice(0).map(([w,j])=>j)).then(()=>{var w;(w=c.current.shift())==null||w()}).then(()=>v(b))});return y.useMemo(()=>({children:n,register:l,unregister:o,onStart:p,onStop:m,wait:u,chains:h}),[l,o,n,p,m,h,u])}let bQ=y.Fragment,yQ=Hx.RenderStrategy;function lve(t,e){var r,n;let{transition:i=!0,beforeEnter:a,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:h,enterTo:p,entered:m,leave:g,leaveFrom:b,leaveTo:v,...w}=t,[j,_]=y.useState(null),E=y.useRef(null),I=gQ(t),O=wl(...I?[E,e,_]:e===null?[]:[e]),B=(r=w.unmount)==null||r?x0.Unmount:x0.Hidden,{show:S,appear:T,initial:M}=ave(),[$,k]=y.useState(S?"visible":"hidden"),L=ove(),{register:R,unregister:V}=L;pl(()=>R(E),[R,E]),pl(()=>{if(B===x0.Hidden&&E.current){if(S&&$!=="visible"){k("visible");return}return nu($,{hidden:()=>V(E),visible:()=>R(E)})}},[$,E,R,V,S,B]);let Y=Q4();pl(()=>{if(I&&Y&&$==="visible"&&E.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[E,$,Y,I]);let X=M&&!T,J=T&&S&&M,re=y.useRef(!1),se=xQ(()=>{re.current||(k("hidden"),V(E))},L),ee=sn(oe=>{re.current=!0;let ne=oe?"enter":"leave";se.onStart(E,ne,H=>{H==="enter"?a?.():H==="leave"&&l?.()})}),q=sn(oe=>{let ne=oe?"enter":"leave";re.current=!1,se.onStop(E,ne,H=>{H==="enter"?o?.():H==="leave"&&c?.()}),ne==="leave"&&!ek(se)&&(k("hidden"),V(E))});y.useEffect(()=>{I&&i||(ee(S),q(S))},[S,I,i]);let U=!(!i||!I||!Y||X),[,W]=sQ(U,j,S,{start:ee,end:q}),Z=s0({ref:O,className:((n=wA(w.className,J&&u,J&&h,W.enter&&u,W.enter&&W.closed&&h,W.enter&&!W.closed&&p,W.leave&&g,W.leave&&!W.closed&&b,W.leave&&W.closed&&v,!W.transition&&S&&m))==null?void 0:n.trim())||void 0,...nQ(W)}),de=0;$==="visible"&&(de|=dl.Open),$==="hidden"&&(de|=dl.Closed),S&&$==="hidden"&&(de|=dl.Opening),!S&&$==="visible"&&(de|=dl.Closing);let be=co();return Pe.createElement(Z4.Provider,{value:se},Pe.createElement(iQ,{value:de},be({ourProps:Z,theirProps:w,defaultTag:bQ,features:yQ,visible:$==="visible",name:"Transition.Child"})))}function cve(t,e){let{show:r,appear:n=!1,unmount:i=!0,...a}=t,o=y.useRef(null),l=gQ(t),c=wl(...l?[o,e]:e===null?[]:[e]);Q4();let u=H1();if(r===void 0&&u!==null&&(r=(u&dl.Open)===dl.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,p]=y.useState(r?"visible":"hidden"),m=xQ(()=>{r||p("hidden")}),[g,b]=y.useState(!0),v=y.useRef([r]);pl(()=>{g!==!1&&v.current[v.current.length-1]!==r&&(v.current.push(r),b(!1))},[v,r]);let w=y.useMemo(()=>({show:r,appear:n,initial:g}),[r,n,g]);pl(()=>{r?p("visible"):!ek(m)&&o.current!==null&&p("hidden")},[r,m]);let j={unmount:i},_=sn(()=>{var O;g&&b(!1),(O=t.beforeEnter)==null||O.call(t)}),E=sn(()=>{var O;g&&b(!1),(O=t.beforeLeave)==null||O.call(t)}),I=co();return Pe.createElement(Z4.Provider,{value:m},Pe.createElement(J4.Provider,{value:w},I({ourProps:{...j,as:y.Fragment,children:Pe.createElement(vQ,{ref:c,...j,...a,beforeEnter:_,beforeLeave:E})},theirProps:{},defaultTag:y.Fragment,features:yQ,visible:h==="visible",name:"Transition"})))}function uve(t,e){let r=y.useContext(J4)!==null,n=H1()!==null;return Pe.createElement(Pe.Fragment,null,!r&&n?Pe.createElement(CA,{ref:e,...t}):Pe.createElement(vQ,{ref:e,...t}))}let CA=Ua(cve),vQ=Ua(lve),BI=Ua(uve),Vh=Object.assign(CA,{Child:BI,Root:CA});var dve=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(dve||{}),hve=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(hve||{});let fve={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},$I=y.createContext(null);$I.displayName="DialogContext";function tk(t){let e=y.useContext($I);if(e===null){let r=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,tk),r}return e}function pve(t,e){return nu(e.type,fve,t,e)}let q9=Ua(function(t,e){let r=y.useId(),{id:n=`headlessui-dialog-${r}`,open:i,onClose:a,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:h=!1,...p}=t,m=y.useRef(!1);l=(function(){return l==="dialog"||l==="alertdialog"?l:(m.current||(m.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let g=H1();i===void 0&&g!==null&&(i=(g&dl.Open)===dl.Open);let b=y.useRef(null),v=wl(b,e),w=RI(b.current),j=i?0:1,[_,E]=y.useReducer(pve,{titleId:null,descriptionId:null,panelRef:y.createRef()}),I=sn(()=>a(!1)),O=sn(W=>E({type:0,id:W})),B=Q4()?j===0:!1,[S,T]=qye(),M={get current(){var W;return(W=_.panelRef.current)!=null?W:b.current}},$=fQ(),{resolveContainers:k}=Kye({mainTreeNode:$,portals:S,defaultContainers:[M]}),L=g!==null?(g&dl.Closing)===dl.Closing:!1;cye(u||L?!1:B,{allowed:sn(()=>{var W,Z;return[(Z=(W=b.current)==null?void 0:W.closest("[data-headlessui-portal]"))!=null?Z:null]}),disallowed:sn(()=>{var W;return[(W=$?.closest("body > *:not(#headlessui-portal-root)"))!=null?W:null]})});let R=XX.get(null);pl(()=>{if(B)return R.actions.push(n),()=>R.actions.pop(n)},[R,n,B]);let V=QX(R,y.useCallback(W=>R.selectors.isTop(W,n),[R,n]));wye(V,k,W=>{W.preventDefault(),I()}),Wye(V,w?.defaultView,W=>{W.preventDefault(),W.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),I()}),Eye(u||L?!1:B,w,k),uye(B,b,I);let[Y,X]=UX(),J=y.useMemo(()=>[{dialogState:j,close:I,setTitleId:O,unmount:h},_],[j,I,O,h,_]),re=Yd({open:j===0}),se={ref:v,id:n,role:l,tabIndex:-1,"aria-modal":u?void 0:j===0?!0:void 0,"aria-labelledby":_.titleId,"aria-describedby":Y,unmount:h},ee=!Gye(),q=Cp.None;B&&!u&&(q|=Cp.RestoreFocus,q|=Cp.TabLock,c&&(q|=Cp.AutoFocus),ee&&(q|=Cp.InitialFocus));let U=co();return Pe.createElement(aQ,null,Pe.createElement(U9,{force:!0},Pe.createElement(Hye,null,Pe.createElement($I.Provider,{value:J},Pe.createElement(dQ,{target:b},Pe.createElement(U9,{force:!1},Pe.createElement(X,{slot:re},Pe.createElement(T,null,Pe.createElement(eve,{initialFocus:o,initialFocusFallback:b,containers:k,features:q},Pe.createElement(HX,{value:I},U({ourProps:se,theirProps:p,slot:re,defaultTag:mve,features:gve,visible:j===0,name:"Dialog"})))))))))))}),mve="div",gve=Hx.RenderStrategy|Hx.Static;function xve(t,e){let{transition:r=!1,open:n,...i}=t,a=H1(),o=t.hasOwnProperty("open")||a!==null,l=t.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!a&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(n!==void 0||r)&&!i.static?Pe.createElement(z9,null,Pe.createElement(Vh,{show:n,transition:r,unmount:i.unmount},Pe.createElement(q9,{ref:e,...i}))):Pe.createElement(z9,null,Pe.createElement(q9,{ref:e,open:n,...i}))}let bve="div";function yve(t,e){let r=y.useId(),{id:n=`headlessui-dialog-panel-${r}`,transition:i=!1,...a}=t,[{dialogState:o,unmount:l},c]=tk("Dialog.Panel"),u=wl(e,c.panelRef),h=Yd({open:o===0}),p=sn(w=>{w.stopPropagation()}),m={ref:u,id:n,onClick:p},g=i?BI:y.Fragment,b=i?{unmount:l}:{},v=co();return Pe.createElement(g,{...b},v({ourProps:m,theirProps:a,slot:h,defaultTag:bve,name:"Dialog.Panel"}))}let vve="div";function wve(t,e){let{transition:r=!1,...n}=t,[{dialogState:i,unmount:a}]=tk("Dialog.Backdrop"),o=Yd({open:i===0}),l={ref:e,"aria-hidden":!0},c=r?BI:y.Fragment,u=r?{unmount:a}:{},h=co();return Pe.createElement(c,{...u},h({ourProps:l,theirProps:n,slot:o,defaultTag:vve,name:"Dialog.Backdrop"}))}let Nve="h2";function jve(t,e){let r=y.useId(),{id:n=`headlessui-dialog-title-${r}`,...i}=t,[{dialogState:a,setTitleId:o}]=tk("Dialog.Title"),l=wl(e);y.useEffect(()=>(o(n),()=>o(null)),[n,o]);let c=Yd({open:a===0}),u={ref:l,id:n};return co()({ourProps:u,theirProps:i,slot:c,defaultTag:Nve,name:"Dialog.Title"})}let kve=Ua(xve),_ve=Ua(yve);Ua(wve);let Sve=Ua(jve),_0=Object.assign(kve,{Panel:_ve,Title:Sve,Description:zX});var V9;let Cve=(V9=Pe.startTransition)!=null?V9:function(t){t()};var Eve=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Eve||{}),Ave=(t=>(t[t.ToggleDisclosure=0]="ToggleDisclosure",t[t.CloseDisclosure=1]="CloseDisclosure",t[t.SetButtonId=2]="SetButtonId",t[t.SetPanelId=3]="SetPanelId",t[t.SetButtonElement=4]="SetButtonElement",t[t.SetPanelElement=5]="SetPanelElement",t))(Ave||{});let Tve={0:t=>({...t,disclosureState:nu(t.disclosureState,{0:1,1:0})}),1:t=>t.disclosureState===1?t:{...t,disclosureState:1},2(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},3(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}},4(t,e){return t.buttonElement===e.element?t:{...t,buttonElement:e.element}},5(t,e){return t.panelElement===e.element?t:{...t,panelElement:e.element}}},FI=y.createContext(null);FI.displayName="DisclosureContext";function UI(t){let e=y.useContext(FI);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,UI),r}return e}let zI=y.createContext(null);zI.displayName="DisclosureAPIContext";function wQ(t){let e=y.useContext(zI);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,wQ),r}return e}let qI=y.createContext(null);qI.displayName="DisclosurePanelContext";function Ive(){return y.useContext(qI)}function Lve(t,e){return nu(e.type,Tve,t,e)}let Pve=y.Fragment;function Ove(t,e){let{defaultOpen:r=!1,...n}=t,i=y.useRef(null),a=wl(e,$X(v=>{i.current=v},t.as===void 0||gx(t.as))),o=y.useReducer(Lve,{disclosureState:r?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:l,buttonId:c},u]=o,h=sn(v=>{u({type:1});let w=Pm(i.current);if(!w||!c)return;let j=v?Cd(v)?v:"current"in v&&Cd(v.current)?v.current:w.getElementById(c):w.getElementById(c);j?.focus()}),p=y.useMemo(()=>({close:h}),[h]),m=Yd({open:l===0,close:h}),g={ref:a},b=co();return Pe.createElement(FI.Provider,{value:o},Pe.createElement(zI.Provider,{value:p},Pe.createElement(HX,{value:h},Pe.createElement(iQ,{value:nu(l,{0:dl.Open,1:dl.Closed})},b({ourProps:g,theirProps:n,slot:m,defaultTag:Pve,name:"Disclosure"})))))}let Rve="button";function Mve(t,e){let r=y.useId(),{id:n=`headlessui-disclosure-button-${r}`,disabled:i=!1,autoFocus:a=!1,...o}=t,[l,c]=UI("Disclosure.Button"),u=Ive(),h=u===null?!1:u===l.panelId,p=y.useRef(null),m=wl(p,e,sn(M=>{if(!h)return c({type:4,element:M})}));y.useEffect(()=>{if(!h)return c({type:2,buttonId:n}),()=>{c({type:2,buttonId:null})}},[n,c,h]);let g=sn(M=>{var $;if(h){if(l.disclosureState===1)return;switch(M.key){case Eh.Space:case Eh.Enter:M.preventDefault(),M.stopPropagation(),c({type:0}),($=l.buttonElement)==null||$.focus();break}}else switch(M.key){case Eh.Space:case Eh.Enter:M.preventDefault(),M.stopPropagation(),c({type:0});break}}),b=sn(M=>{M.key===Eh.Space&&M.preventDefault()}),v=sn(M=>{var $;DX(M.currentTarget)||i||(h?(c({type:0}),($=l.buttonElement)==null||$.focus()):c({type:0}))}),{isFocusVisible:w,focusProps:j}=CX({autoFocus:a}),{isHovered:_,hoverProps:E}=SX({isDisabled:i}),{pressed:I,pressProps:O}=AX({disabled:i}),B=Yd({open:l.disclosureState===0,hover:_,active:I,disabled:i,focus:w,autofocus:a}),S=rQ(t,l.buttonElement),T=NA(h?{ref:m,type:S,disabled:i||void 0,autoFocus:a,onKeyDown:g,onClick:v}:{ref:m,id:n,type:S,"aria-expanded":l.disclosureState===0,"aria-controls":l.panelElement?l.panelId:void 0,disabled:i||void 0,autoFocus:a,onKeyDown:g,onKeyUp:b,onClick:v},j,E,O);return co()({ourProps:T,theirProps:o,slot:B,defaultTag:Rve,name:"Disclosure.Button"})}let Dve="div",Bve=Hx.RenderStrategy|Hx.Static;function $ve(t,e){let r=y.useId(),{id:n=`headlessui-disclosure-panel-${r}`,transition:i=!1,...a}=t,[o,l]=UI("Disclosure.Panel"),{close:c}=wQ("Disclosure.Panel"),[u,h]=y.useState(null),p=wl(e,sn(_=>{Cve(()=>l({type:5,element:_}))}),h);y.useEffect(()=>(l({type:3,panelId:n}),()=>{l({type:3,panelId:null})}),[n,l]);let m=H1(),[g,b]=sQ(i,u,m!==null?(m&dl.Open)===dl.Open:o.disclosureState===0),v=Yd({open:o.disclosureState===0,close:c}),w={ref:p,id:n,...nQ(b)},j=co();return Pe.createElement(aQ,null,Pe.createElement(qI.Provider,{value:o.panelId},j({ourProps:w,theirProps:a,slot:v,defaultTag:Dve,features:Bve,visible:g,name:"Disclosure.Panel"})))}let Fve=Ua(Ove),Uve=Ua(Mve),zve=Ua($ve),xx=Object.assign(Fve,{Button:Uve,Panel:zve}),VI=y.createContext(null);VI.displayName="GroupContext";let qve=y.Fragment;function Vve(t){var e;let[r,n]=y.useState(null),[i,a]=Vbe(),[o,l]=UX(),c=y.useMemo(()=>({switch:r,setSwitch:n}),[r,n]),u={},h=t,p=co();return Pe.createElement(l,{name:"Switch.Description",value:o},Pe.createElement(a,{name:"Switch.Label",value:i,props:{htmlFor:(e=c.switch)==null?void 0:e.id,onClick(m){r&&(jA(m.currentTarget)&&m.preventDefault(),r.click(),r.focus({preventScroll:!0}))}}},Pe.createElement(VI.Provider,{value:c},p({ourProps:u,theirProps:h,slot:{},defaultTag:qve,name:"Switch.Group"}))))}let Hve="button";function Wve(t,e){var r;let n=y.useId(),i=OX(),a=OI(),{id:o=i||`headlessui-switch-${n}`,disabled:l=a||!1,checked:c,defaultChecked:u,onChange:h,name:p,value:m,form:g,autoFocus:b=!1,...v}=t,w=y.useContext(VI),[j,_]=y.useState(null),E=y.useRef(null),I=wl(E,e,w===null?null:w.setSwitch,_),O=kbe(u),[B,S]=jbe(c,h,O??!1),T=Om(),[M,$]=y.useState(!1),k=sn(()=>{$(!0),S?.(!B),T.nextFrame(()=>{$(!1)})}),L=sn(oe=>{if(DX(oe.currentTarget))return oe.preventDefault();oe.preventDefault(),k()}),R=sn(oe=>{oe.key===Eh.Space?(oe.preventDefault(),k()):oe.key===Eh.Enter&&_be(oe.currentTarget)}),V=sn(oe=>oe.preventDefault()),Y=VX(),X=Fbe(),{isFocusVisible:J,focusProps:re}=CX({autoFocus:b}),{isHovered:se,hoverProps:ee}=SX({isDisabled:l}),{pressed:q,pressProps:U}=AX({disabled:l}),W=Yd({checked:B,disabled:l,hover:se,focus:J,active:q,autofocus:b,changing:M}),Z=NA({id:o,ref:I,role:"switch",type:rQ(t,j),tabIndex:t.tabIndex===-1?0:(r=t.tabIndex)!=null?r:0,"aria-checked":B,"aria-labelledby":Y,"aria-describedby":X,disabled:l||void 0,autoFocus:b,onClick:L,onKeyUp:R,onKeyPress:V},re,ee,U),de=y.useCallback(()=>{if(O!==void 0)return S?.(O)},[S,O]),be=co();return Pe.createElement(Pe.Fragment,null,p!=null&&Pe.createElement(Ibe,{disabled:l,data:{[p]:m||"on"},overrides:{type:"checkbox",checked:B},form:g,onReset:de}),be({ourProps:Z,theirProps:v,slot:W,defaultTag:Hve,name:"Switch"}))}let Gve=Ua(Wve),Kve=Vve,Yve=Kbe,Xve=zX,Qve=Object.assign(Gve,{Group:Kve,Label:Yve,Description:Xve});const ix={"/dashboard":{title:"Dashboard Guide",subtitle:"Your command center in MTG Forge.",icon:"",color:"indigo",sections:[{type:"text",title:"Overview",content:"The Dashboard provides a high-level view of your collection, recent activity, and quick actions. It's fully customizable to fit your workflow."},{type:"grid",title:"Key Widgets",items:[{title:"Quick Actions",desc:"Shortcuts to create decks or scan cards.",icon:""},{title:"Stats",desc:"Summary of collection size and value.",icon:""},{title:"Recent Decks",desc:"Quick access to your latest brews.",icon:""},{title:"Identity",desc:"Color distribution of your cards.",icon:""}]},{type:"text",title:"Customization",content:"Click the **Customize** toggle to enter Edit Mode. You can drag to rearrange, use handles to resize, and add new widgets from the sidebar. You can also save and share your custom layouts."}],tips:[{icon:"",title:"Troubleshooting",text:"If widgets feel stuck, try refreshing the page. Most layout issues are resolved by a quick reload."}],footer:{text:"Start Customizing"}},"/collection":{title:"Collection Manager",subtitle:"Manage your entire card inventory.",icon:"",color:"blue",sections:[{type:"grid",title:"View Modes",items:[{title:"Grid",desc:"Visual display of card art.",icon:""},{title:"Table",desc:"Data list for easy sorting.",icon:""},{title:"Folders",desc:"Organize by Color, Set, or Binder.",icon:""}]},{type:"text",title:"Features",content:"Use the search bar for names, or click **Filters** to drill down by Color, Rarity, Type, and Set. You can sort by Price, CMC, and Date Added."},{type:"text",title:"Bulk Actions",content:"Enter **Select** mode to perform actions on multiple cards at once: Delete, Move to Binder, Add to Deck, or Export to a list."}],tips:[{icon:"",title:"Forge Lens",text:"Click the camera icon to scan physical cards directly into your collection using your webcam."},{icon:"",title:"Live Prices",text:"Sync Prices updates your entire collection value based on the latest Scryfall market data."}],footer:{text:"Manage Collection"}},"/decks":{title:"Decks & Binders",subtitle:"Your library of strategies and trades.",icon:"",color:"purple",sections:[{type:"grid",title:"Organization",items:[{title:"Decks",desc:"Your constructed strategies.",icon:""},{title:"Binders",desc:"Trade stock and collections.",icon:""},{title:"Folders",desc:"Group by format or theme.",icon:""}]},{type:"text",title:"Creation",content:"Start a fresh deck from scratch, or **Import** a decklist from Arena, Moxfield, or TappedOut by pasting the text list."}],tips:[{icon:"",title:"Mockup Mode",text:"Decks marked as 'Mockup' don't count towards your collection statsperfect for brewing with cards you don't own yet."}],footer:{text:"Browse Decks"}},"/decks/new":{title:"Deck Architect",subtitle:"Craft your perfect 99.",icon:"",color:"emerald",sections:[{type:"text",title:"Workflow",content:`1. **Choose Commander**: Pick your leader to define identity.
2. **Select Strategy**: Pick a theme (e.g., Aristocrats, Voltron).
3. **Build**: Use the AI Companion for suggestions based on your theme.`},{type:"grid",title:"AI Tools",items:[{title:"Suggestions",desc:"Cards categorized by role.",icon:""},{title:"Synergy",desc:"Hidden gems from your binder.",icon:""},{title:"Deck Doctor",desc:"Fix curve or synergy issues.",icon:""}]}],tips:[{icon:"",title:"Solitaire",text:"Use the Solitaire tool to test your draws and opening hands before taking the deck to the table."}],footer:{text:"Start Brewing"}},"/binders":{title:"Binder Management",subtitle:"Organize your collection like a pro.",icon:"",color:"indigo",sections:[{type:"grid",title:"Two Ways to Build",items:[{title:"Manual",desc:"Drag and drop specific cards.",icon:""},{title:"Smart",desc:"Set rules for automatic updates.",icon:""}]},{type:"text",title:"AI Smart Creator",content:"Just describe what you want: 'All my red goblins over $5' or 'Cards to trade that I have duplicates of'. The AI handles the logic."}],tips:[{icon:"",title:"Custom Style",text:"Change colors and pick from hundreds of icons to make your binders easily identifiable."}],footer:{text:"Open Binders"}},"/social":{title:"Pods & Sharing",subtitle:"Connect with your playgroup.",icon:"",color:"rose",sections:[{type:"text",title:"What is a Pod?",content:"A Pod represents your list of Trusted Connections. Linking accounts allows you to share digital resources and track group stats."},{type:"grid",title:"Permissions",items:[{title:"Viewer",desc:"Can see decks and collection.",icon:""},{title:"Editor",desc:"Can help brew and add cards.",icon:""}]},{type:"text",title:"Shared Collections",content:"In the Deck Builder, you can view cards from your friends' collections to brew Team Decks or borrow cards."}],tips:[{icon:"",title:"Safety First",text:"Only add people you actually trust to your Pod. You can revoke access at any time."}],footer:{text:"Connect with Friends"}},"/sets":{title:"Sets Explorer",subtitle:"Browse any MTG expansion.",icon:"",color:"blue",sections:[{type:"text",title:"Global Search",content:"Find sets by name (e.g., 'Throne of Eldraine') or code (e.g., 'ELD'). Filter by Main Sets, Commander, Secret Lair, and more."},{type:"text",title:"Analytics",content:"Click a set to view its full card list, total value, and your completion percentage for that specific set."}],tips:[{icon:"",title:"Tracking",text:"Completion stats help you identify missing cards if you're aiming to complete a full set collection."}],footer:{text:"Explore Sets"}},"/wishlist":{title:"Wishlist Guide",subtitle:"Track cards you need to acquire.",icon:"",color:"pink",sections:[{type:"text",title:"Management",content:"Add cards from anywhere via the global search. You can filter by price or type to prioritize your next purchases."},{type:"text",title:"Budgeting",content:"Use the total value indicator to estimate the cost of your current wishlist."}],tips:[{icon:"",title:"Theorycraft",text:"Enable Theorycraft Mode in the Deck Builder to include cards from your wishlist in your deck lists."}],footer:{text:"View Wishlist"}},"/audit":{title:"Collection Audit",subtitle:"Verify your physical inventory.",icon:"",color:"emerald",sections:[{type:"text",title:"Verification Flow",content:`1. **Start Audit**: Choose a scope (Collection, Binder, or Box).
2. **Review**: Mark cards as **Found** or **Missing**.
3. **Sync**: Automatically update your digital records to match.`},{type:"grid",title:"Quick Actions",items:[{title:"Match",desc:"Confirms physical count.",icon:""},{title:"Mismatch",desc:"Flags discrepancy for fix.",icon:""}]}],tips:[{icon:"",title:"Mobile Use",text:"The Audit Wizard is optimized for phones. perfect for carrying to your bulk boxes for scanning!"}],footer:{text:"Start Audit"}},"forge-lens":{title:"Forge Lens AI",subtitle:"AI-powered card recognition.",icon:"",color:"indigo",sections:[{type:"text",title:"How to Use",content:`1. **Open Scanner**: Click the camera icon.
2. **Position**: Hold device steady over card in good light.
3. **Scan**: AI detects name and set automatically.`},{type:"image",title:"Perfect Alignment",src:"/images/forge-lens-tip.png",caption:"The AI looks specifically for the set code (e.g. MH2) and collector number in the bottom left for 100% accuracy."},{type:"grid",title:"Best Results",items:[{title:"Lighting",desc:"Bright, even light.",icon:""},{title:"Background",desc:"Dark & contrasting.",icon:""},{title:"Sleeves",desc:"Clear sleeves are best.",icon:""}]}],tips:[{icon:"",title:"Speed",text:"Once you see the pop up showing you added the correct card, you can just keep scanning!"}],footer:{text:"Launch Forge Lens"}},"/precons":{title:"Precon Discovery",subtitle:"Explore and upgrade ready-to-play decks.",icon:"",color:"rose",sections:[{type:"text",title:"Browse & Search",content:"Discover every Preconstructed deck released by Wizards of the Coast. Filter by **Set**, **Type** (Commander, Challenger, etc.), or use the search for specific names."},{type:"grid",title:"Features",items:[{title:"Decklists",desc:"View full original lists.",icon:""},{title:"Price Check",desc:"Real-time value analysis.",icon:""},{title:"Clone & Edit",desc:"Upgrade your own copy.",icon:""}]}],tips:[{icon:"",title:"Upgrading",text:"Click 'Add to Collection' or 'Add to Wishlist' on any precon to start making your own upgrades with AI assistance."}],footer:{text:"Browse Precons"}},"/strategy":{title:"Strategy AI",subtitle:"Deep meta analysis and brewing tips.",icon:"",color:"violet",sections:[{type:"text",title:"Meta View",content:"Scan the current meta across multiple formats. The AI analyzes thousands of top-performing decks to identify trends, key staples, and power shifts."},{type:"grid",title:"Tools",items:[{title:"Deck Analysis",desc:"Scan your brews for weaknesses.",icon:""},{title:"Archetope",desc:"Explore winning archetypes.",icon:""},{title:"Price Alerts",desc:"Watch for meta spikes.",icon:""}]}],tips:[{icon:"",title:"Personalized",text:"The Strategy AI learns your playstyle. The more decks you build, the better it gets at suggesting cards that fit your 'vibe'."}],footer:{text:"Explore Meta"}},"/play":{title:"Live Sessions",subtitle:"Play Magic with friends in real-time.",icon:"",color:"emerald",sections:[{type:"text",title:"Lobby & PINs",content:"The Lobby is where you create or join live game sessions. Every session has a unique **6-digit PIN**. Share this with your friends for them to join your table instantly."},{type:"grid",title:"Battlefield Tools",items:[{title:"Life Tracker",desc:"Real-time sync for life totals.",icon:""},{title:"Counters",desc:"Track Poison, Energy, and more.",icon:""},{title:"Command Damage",desc:"Built-in commander tracking.",icon:""},{title:"Pass Turn",desc:"Easily signal turn changes.",icon:""}]}],tips:[{icon:"",title:"Oops Window",text:"Made a mistake? You have a 5-second window to **Undo** any life or counter change before it's finalized in the log."},{icon:"",title:"Game Notes",text:"Click the message icon to add notes like 'Board Wipe' or 'Cast Commander' to the shared session log."}],footer:{text:"Enter Lobby"}},"/armory":{title:"The Armory",subtitle:"Trade and manage your physical stock.",icon:"",color:"amber",sections:[{type:"text",title:"Trade Dashboard",content:"The Armory is your hub for physical trades. Track what you're offering and what you're looking for, and find matches within your Pod."},{type:"grid",title:"Tracking",items:[{title:"Haves",desc:"Cards you're willing to trade.",icon:""},{title:"Wants",desc:"Cards you're looking for.",icon:""},{title:"Matches",desc:"Automatic trade suggestions.",icon:""}]}],tips:[{icon:"",title:"Trust",text:"Physical trades are managed between players. Forge helps find matches, but you handle the shipping and handoffs!"}],footer:{text:"Open Armory"}},"/tournaments":{title:"Tournaments",subtitle:"Compete for glory and prizes.",icon:"",color:"rose",sections:[{type:"text",title:"Organized Play",content:"Join community-run tournaments or host your own. The system handles pairings, standings, and decklist verification automatically."},{type:"grid",title:"Structure",items:[{title:"Swiss",desc:"Fair pairings for all rounds.",icon:""},{title:"Cut to Top 8",desc:"Elimination finals.",icon:""},{title:"Prizes",desc:"Claim your rewards.",icon:""}]}],tips:[{icon:"",title:"Schedule",text:"Check the tournament calendar regularly for upcoming Qualifiers and Open events. **COMING SOON**"}],footer:{text:"Browse Events"}}},H9=t=>ix[t]?ix[t]:t.startsWith("/decks/")&&!t.endsWith("/new")?{title:"Deck Details",subtitle:"Manage a specific strategy.",icon:"",color:"indigo",sections:[{type:"text",title:"Command Center",content:"Manage card lists, view stats, and optimize strategy. Flip cards per view, or enter **Selection** mode for bulk removals."},{type:"grid",title:"Analyzer",items:[{title:"Power Level",desc:"Estimated deck strength.",icon:""},{title:"Mana Curve",desc:"Cost distribution.",icon:""},{title:"Identity",desc:"Color and theme analysis.",icon:""}]}],tips:[{icon:"",title:"Settings",text:"You can change deck visibility, format, and cover art from the Settings tab within the deck view."}],footer:{text:"Back to Decks"}}:t.startsWith("/audit")?ix["/audit"]:t.startsWith("/binders")?ix["/binders"]:t.startsWith("/sets/")?{title:"Set Analytics",subtitle:"Deep dive into an expansion.",icon:"",color:"blue",sections:[{type:"grid",title:"View Items",items:[{title:"Full List",desc:"Every card in the set.",icon:""},{title:"Value",desc:"Current market analytics.",icon:""},{title:"Completion",desc:"Your collection progress.",icon:""}]}],tips:[{icon:"",title:"Draft Sim",text:"Simulate booster drafts for this set to practice your limited skills (available for major sets)."}],footer:{text:"Browse Sets"}}:{title:"General Help",subtitle:"How can we help you today?",icon:"",color:"indigo",sections:[{type:"text",title:"Welcome",content:"I am here to help you navigate MTG Forge. You can explore guides for collection management, deck building, and more."}],tips:[{icon:"",title:"AI Assistant",text:"If you can't find what you need, use the AI Helper to ask specific questions about the app."}],footer:{text:"Close Help"}},Jve=({isOpen:t,onClose:e,onStartTour:r,onOpenChat:n})=>{const i=xn(),a=Mo(),[o,l]=Pe.useState("home"),[c,u]=Pe.useState(null);return Pe.useEffect(()=>{t&&(l("home"),u(null))},[t]),a.pathname.startsWith("/decks/"),a.pathname,s.jsx(Vh,{appear:!0,show:t,as:y.Fragment,children:s.jsxs(_0,{as:"div",className:"relative z-[100]",onClose:e,children:[s.jsx(Vh.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),s.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:s.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:s.jsx(Vh.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:s.jsxs(_0.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded-3xl bg-gray-900 border border-indigo-500/30 p-0 text-left align-middle shadow-2xl transition-all h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50 backdrop-blur-xl",children:[s.jsx(_0.Title,{as:"h3",className:"text-2xl font-black leading-6 text-white flex items-center gap-3",children:o==="guide"?s.jsxs("button",{onClick:()=>l("home"),className:"p-2 -ml-2 rounded-lg hover:bg-white/5 text-gray-400 hover:text-white transition-colors flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-3xl",children:""}),"Help Center"]})}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6",children:o==="home"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-8",children:s.jsx("p",{className:"text-base text-gray-400",children:"Stuck? Here are a few ways to get moving again."})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>{e(),r()},className:"group relative p-8 rounded-3xl bg-gray-800/50 border border-gray-700 hover:border-indigo-500 hover:bg-indigo-500/5 transition-all text-left",children:[s.jsx("div",{className:"absolute top-6 right-6 p-3 bg-indigo-500/10 rounded-xl text-indigo-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})}),s.jsx("h4",{className:"text-xl font-black text-white mb-2",children:"Take a Tour"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Walk through the features of the current page with interactive highlights."})]}),s.jsxs("button",{onClick:()=>{e(),n()},className:"group relative p-8 rounded-3xl bg-gray-800/50 border border-gray-700 hover:border-purple-500 hover:bg-purple-500/5 transition-all text-left",children:[s.jsx("div",{className:"absolute top-6 right-6 p-3 bg-purple-500/10 rounded-xl text-purple-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsx("h4",{className:"text-xl font-black text-white mb-2",children:"Ask AI Helper"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Chat with the intelligent assistant. It knows exactly what you're looking at."})]})]}),s.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-800",children:[s.jsx("h5",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Quick Guides"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{id:"/dashboard",label:" Dashboard"},{id:"/collection",label:" Collection"},{id:"/decks",label:" Decks"},{id:"/binders",label:" Binders"},{id:"/social",label:" Social"},{id:"/sets",label:" Sets Explorer"},{id:"/wishlist",label:" Wishlist"},{id:"/audit",label:" Audit"},{id:"forge-lens",label:" Forge Lens"},{id:"/precons",label:" Precons"},{id:"/strategy",label:" Strategy"},{id:"/play",label:" Play"},{id:"/armory",label:" Armory"},{id:"/tournaments",label:" Tourneys"},{id:"/settings",label:" Settings"}].map(h=>s.jsx("button",{onClick:()=>{u(h.id),l("guide")},className:"p-4 bg-gray-800/30 border border-white/5 rounded-2xl text-xs font-bold text-gray-300 hover:text-white hover:bg-gray-700/50 hover:border-indigo-500/30 transition-all text-left flex items-center gap-2",children:h.label},h.id))})]}),s.jsx("div",{className:"h-4"})]}):s.jsx("div",{className:"animate-fade-in",children:(()=>{const h=c?ix[c]||(c.startsWith("/")?ix[c]:null):null;return h?s.jsxs("div",{className:"space-y-8 pb-10",children:[s.jsxs("div",{className:"flex items-center gap-6 mb-10",children:[s.jsx("div",{className:`p-6 bg-${h.color}-500/20 rounded-3xl text-4xl`,children:h.icon}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white leading-tight mb-1",children:h.title}),s.jsx("p",{className:"text-base text-gray-400",children:h.subtitle})]})]}),h.sections?.map((p,m)=>s.jsxs("section",{className:"space-y-3",children:[s.jsxs("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("span",{className:`w-1.5 h-4 bg-${h.color}-500 rounded-full`}),p.title]}),p.type==="text"&&s.jsx("div",{className:"text-base text-gray-300 leading-relaxed bg-white/5 p-6 rounded-3xl border border-white/5",children:p.content.split(`
`).map((g,b)=>s.jsx("p",{className:b>0?"mt-3":"",children:g.split(/(\*\*.*?\*\*)/).map((v,w)=>v.startsWith("**")&&v.endsWith("**")?s.jsx("strong",{className:"text-white font-black",children:v.slice(2,-2)},w):v)},b))}),p.type==="grid"&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.items.map((g,b)=>s.jsxs("div",{className:"bg-gray-800/40 p-6 rounded-3xl border border-white/5 hover:border-white/10 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[s.jsx("span",{className:"text-2xl",children:g.icon}),s.jsx("h4",{className:"font-black text-white text-base",children:g.title})]}),s.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:g.desc})]},b))}),p.type==="image"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"rounded-2xl overflow-hidden border border-white/10 bg-black/40",children:s.jsx("img",{src:p.src,alt:p.title,className:"w-full h-auto object-cover"})}),p.caption&&s.jsx("p",{className:"text-xs text-center text-gray-500 italic px-2",children:p.caption})]})]},m)),h.tips&&s.jsxs("div",{className:`bg-gradient-to-br from-${h.color}-900/40 to-gray-950 p-6 rounded-3xl border border-${h.color}-500/20`,children:[s.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest mb-4 flex items-center gap-2",children:[s.jsx("span",{children:""})," Pro Tips"]}),s.jsx("div",{className:"space-y-4",children:h.tips.map((p,m)=>s.jsxs("div",{className:"flex gap-6",children:[s.jsx("div",{className:"text-3xl shrink-0 mt-1",children:p.icon}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-black text-base mb-1",children:p.title}),s.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:p.text})]})]},m))})]}),h.footer&&s.jsx("div",{className:"pt-4 flex justify-end",children:s.jsx("button",{onClick:()=>{c.startsWith("/")?(e(),i(c)):e()},className:`px-8 py-3 bg-${h.color}-600 hover:bg-${h.color}-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-${h.color}-900/20 active:scale-95`,children:h.footer.text})})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[s.jsx("span",{className:"text-4xl mb-4",children:""}),s.jsx("p",{className:"font-bold",children:"Guide content not found."})]})})()})})]})})})})]})})};var Q5={exports:{}},Zve=Q5.exports,W9;function e1e(){return W9||(W9=1,(function(t,e){(function(n,i){t.exports=i(of())})(Zve,function(r){return(function(n){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return n[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=n,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(h){return o[h]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(n,i,a){a.r(i);var o=a("react"),l=(function(){var m=function(g,b){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var j in w)w.hasOwnProperty(j)&&(v[j]=w[j])},m(g,b)};return function(g,b){m(g,b);function v(){this.constructor=g}g.prototype=b===null?Object.create(b):(v.prototype=b.prototype,new v)}})(),c=function(){return c=Object.assign||function(m){for(var g,b=1,v=arguments.length;b<v;b++){g=arguments[b];for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&(m[w]=g[w])}return m},c.apply(this,arguments)},u=function(m,g){var b={};for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&g.indexOf(v)<0&&(b[v]=m[v]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,v=Object.getOwnPropertySymbols(m);w<v.length;w++)g.indexOf(v[w])<0&&Object.prototype.propertyIsEnumerable.call(m,v[w])&&(b[v[w]]=m[v[w]]);return b};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(g){var b=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return b?new Promise(function(v,w){b.call(navigator,g,v,w)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function h(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var p=(function(m){l(g,m);function g(b){var v=m.call(this,b)||this;return v.canvas=null,v.ctx=null,v.requestUserMediaId=0,v.unmounted=!1,v.state={hasUserMedia:!1},v}return g.prototype.componentDidMount=function(){var b=this,v=b.state,w=b.props;if(this.unmounted=!1,!h()){w.onUserMediaError("getUserMedia not supported");return}v.hasUserMedia||this.requestUserMedia(),w.children&&typeof w.children!="function"&&console.warn("children must be a function")},g.prototype.componentDidUpdate=function(b){var v=this.props;if(!h()){v.onUserMediaError("getUserMedia not supported");return}var w=JSON.stringify(b.audioConstraints)!==JSON.stringify(v.audioConstraints),j=JSON.stringify(b.videoConstraints)!==JSON.stringify(v.videoConstraints),_=b.minScreenshotWidth!==v.minScreenshotWidth,E=b.minScreenshotHeight!==v.minScreenshotHeight;(j||_||E)&&(this.canvas=null,this.ctx=null),(w||j)&&(this.stopAndCleanup(),this.requestUserMedia())},g.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},g.stopMediaStream=function(b){b&&(b.getVideoTracks&&b.getAudioTracks?(b.getVideoTracks().map(function(v){b.removeTrack(v),v.stop()}),b.getAudioTracks().map(function(v){b.removeTrack(v),v.stop()})):b.stop())},g.prototype.stopAndCleanup=function(){var b=this.state;b.hasUserMedia&&(g.stopMediaStream(this.stream),b.src&&window.URL.revokeObjectURL(b.src))},g.prototype.getScreenshot=function(b){var v=this,w=v.state,j=v.props;if(!w.hasUserMedia)return null;var _=this.getCanvas(b);return _&&_.toDataURL(j.screenshotFormat,j.screenshotQuality)},g.prototype.getCanvas=function(b){var v=this,w=v.state,j=v.props;if(!this.video||!w.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var _=this.video.videoWidth,E=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var I=_/E;_=j.minScreenshotWidth||this.video.clientWidth,E=_/I,j.minScreenshotHeight&&E<j.minScreenshotHeight&&(E=j.minScreenshotHeight,_=E*I)}this.canvas=document.createElement("canvas"),this.canvas.width=b?.width||_,this.canvas.height=b?.height||E,this.ctx=this.canvas.getContext("2d")}var O=this,B=O.ctx,S=O.canvas;return B&&S&&(S.width=b?.width||S.width,S.height=b?.height||S.height,j.mirrored&&(B.translate(S.width,0),B.scale(-1,1)),B.imageSmoothingEnabled=j.imageSmoothing,B.drawImage(this.video,0,0,b?.width||S.width,b?.height||S.height),j.mirrored&&(B.scale(-1,1),B.translate(-S.width,0))),S},g.prototype.requestUserMedia=function(){var b=this,v=this.props,w=function(E,I){var O={video:typeof I<"u"?I:!0};v.audio&&(O.audio=typeof E<"u"?E:!0),b.requestUserMediaId++;var B=b.requestUserMediaId;navigator.mediaDevices.getUserMedia(O).then(function(S){b.unmounted||B!==b.requestUserMediaId?g.stopMediaStream(S):b.handleUserMedia(null,S)}).catch(function(S){b.handleUserMedia(S)})};if("mediaDevices"in navigator)w(v.audioConstraints,v.videoConstraints);else{var j=function(E){return{optional:[{sourceId:E}]}},_=function(E){var I=E.deviceId;return typeof I=="string"?I:Array.isArray(I)&&I.length>0?I[0]:typeof I=="object"&&I.ideal?I.ideal:null};MediaStreamTrack.getSources(function(E){var I=null,O=null;E.forEach(function(T){T.kind==="audio"?I=T.id:T.kind==="video"&&(O=T.id)});var B=_(v.audioConstraints);B&&(I=B);var S=_(v.videoConstraints);S&&(O=S),w(j(I),j(O))})}},g.prototype.handleUserMedia=function(b,v){var w=this.props;if(b||!v){this.setState({hasUserMedia:!1}),w.onUserMediaError(b);return}this.stream=v;try{this.video&&(this.video.srcObject=v),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(v)})}w.onUserMedia(v)},g.prototype.render=function(){var b=this,v=this,w=v.state,j=v.props,_=j.audio;j.forceScreenshotSourceSize;var E=j.disablePictureInPicture;j.onUserMedia,j.onUserMediaError,j.screenshotFormat,j.screenshotQuality,j.minScreenshotWidth,j.minScreenshotHeight,j.audioConstraints,j.videoConstraints,j.imageSmoothing;var I=j.mirrored,O=j.style,B=O===void 0?{}:O,S=j.children,T=u(j,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),M=I?c(c({},B),{transform:(B.transform||"")+" scaleX(-1)"}):B,$={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",c({autoPlay:!0,disablePictureInPicture:E,src:w.src,muted:!_,playsInline:!0,ref:function(k){b.video=k},style:M},T)),S&&S($))},g.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},g})(o.Component);i.default=p}),react:(function(n,i){n.exports=r})}).default})})(Q5)),Q5.exports}var t1e=e1e();const NQ=bl(t1e);var g3={exports:{}},G9;function r1e(){return G9||(G9=1,(function(t){var e=(function(r){var n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(se,ee,q){se[ee]=q.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function p(se,ee,q){return Object.defineProperty(se,ee,{value:q,enumerable:!0,configurable:!0,writable:!0}),se[ee]}try{p({},"")}catch{p=function(ee,q,U){return ee[q]=U}}function m(se,ee,q,U){var W=ee&&ee.prototype instanceof E?ee:E,Z=Object.create(W.prototype),de=new X(U||[]);return a(Z,"_invoke",{value:L(se,q,de)}),Z}r.wrap=m;function g(se,ee,q){try{return{type:"normal",arg:se.call(ee,q)}}catch(U){return{type:"throw",arg:U}}}var b="suspendedStart",v="suspendedYield",w="executing",j="completed",_={};function E(){}function I(){}function O(){}var B={};p(B,c,function(){return this});var S=Object.getPrototypeOf,T=S&&S(S(J([])));T&&T!==n&&i.call(T,c)&&(B=T);var M=O.prototype=E.prototype=Object.create(B);I.prototype=O,a(M,"constructor",{value:O,configurable:!0}),a(O,"constructor",{value:I,configurable:!0}),I.displayName=p(O,h,"GeneratorFunction");function $(se){["next","throw","return"].forEach(function(ee){p(se,ee,function(q){return this._invoke(ee,q)})})}r.isGeneratorFunction=function(se){var ee=typeof se=="function"&&se.constructor;return ee?ee===I||(ee.displayName||ee.name)==="GeneratorFunction":!1},r.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,O):(se.__proto__=O,p(se,h,"GeneratorFunction")),se.prototype=Object.create(M),se},r.awrap=function(se){return{__await:se}};function k(se,ee){function q(Z,de,be,oe){var ne=g(se[Z],se,de);if(ne.type==="throw")oe(ne.arg);else{var H=ne.arg,le=H.value;return le&&typeof le=="object"&&i.call(le,"__await")?ee.resolve(le.__await).then(function(ye){q("next",ye,be,oe)},function(ye){q("throw",ye,be,oe)}):ee.resolve(le).then(function(ye){H.value=ye,be(H)},function(ye){return q("throw",ye,be,oe)})}}var U;function W(Z,de){function be(){return new ee(function(oe,ne){q(Z,de,oe,ne)})}return U=U?U.then(be,be):be()}a(this,"_invoke",{value:W})}$(k.prototype),p(k.prototype,u,function(){return this}),r.AsyncIterator=k,r.async=function(se,ee,q,U,W){W===void 0&&(W=Promise);var Z=new k(m(se,ee,q,U),W);return r.isGeneratorFunction(ee)?Z:Z.next().then(function(de){return de.done?de.value:Z.next()})};function L(se,ee,q){var U=b;return function(Z,de){if(U===w)throw new Error("Generator is already running");if(U===j){if(Z==="throw")throw de;return re()}for(q.method=Z,q.arg=de;;){var be=q.delegate;if(be){var oe=R(be,q);if(oe){if(oe===_)continue;return oe}}if(q.method==="next")q.sent=q._sent=q.arg;else if(q.method==="throw"){if(U===b)throw U=j,q.arg;q.dispatchException(q.arg)}else q.method==="return"&&q.abrupt("return",q.arg);U=w;var ne=g(se,ee,q);if(ne.type==="normal"){if(U=q.done?j:v,ne.arg===_)continue;return{value:ne.arg,done:q.done}}else ne.type==="throw"&&(U=j,q.method="throw",q.arg=ne.arg)}}}function R(se,ee){var q=ee.method,U=se.iterator[q];if(U===o)return ee.delegate=null,q==="throw"&&se.iterator.return&&(ee.method="return",ee.arg=o,R(se,ee),ee.method==="throw")||q!=="return"&&(ee.method="throw",ee.arg=new TypeError("The iterator does not provide a '"+q+"' method")),_;var W=g(U,se.iterator,ee.arg);if(W.type==="throw")return ee.method="throw",ee.arg=W.arg,ee.delegate=null,_;var Z=W.arg;if(!Z)return ee.method="throw",ee.arg=new TypeError("iterator result is not an object"),ee.delegate=null,_;if(Z.done)ee[se.resultName]=Z.value,ee.next=se.nextLoc,ee.method!=="return"&&(ee.method="next",ee.arg=o);else return Z;return ee.delegate=null,_}$(M),p(M,h,"Generator"),p(M,c,function(){return this}),p(M,"toString",function(){return"[object Generator]"});function V(se){var ee={tryLoc:se[0]};1 in se&&(ee.catchLoc=se[1]),2 in se&&(ee.finallyLoc=se[2],ee.afterLoc=se[3]),this.tryEntries.push(ee)}function Y(se){var ee=se.completion||{};ee.type="normal",delete ee.arg,se.completion=ee}function X(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(V,this),this.reset(!0)}r.keys=function(se){var ee=Object(se),q=[];for(var U in ee)q.push(U);return q.reverse(),function W(){for(;q.length;){var Z=q.pop();if(Z in ee)return W.value=Z,W.done=!1,W}return W.done=!0,W}};function J(se){if(se){var ee=se[c];if(ee)return ee.call(se);if(typeof se.next=="function")return se;if(!isNaN(se.length)){var q=-1,U=function W(){for(;++q<se.length;)if(i.call(se,q))return W.value=se[q],W.done=!1,W;return W.value=o,W.done=!0,W};return U.next=U}}return{next:re}}r.values=J;function re(){return{value:o,done:!0}}return X.prototype={constructor:X,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Y),!se)for(var ee in this)ee.charAt(0)==="t"&&i.call(this,ee)&&!isNaN(+ee.slice(1))&&(this[ee]=o)},stop:function(){this.done=!0;var se=this.tryEntries[0],ee=se.completion;if(ee.type==="throw")throw ee.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var ee=this;function q(oe,ne){return Z.type="throw",Z.arg=se,ee.next=oe,ne&&(ee.method="next",ee.arg=o),!!ne}for(var U=this.tryEntries.length-1;U>=0;--U){var W=this.tryEntries[U],Z=W.completion;if(W.tryLoc==="root")return q("end");if(W.tryLoc<=this.prev){var de=i.call(W,"catchLoc"),be=i.call(W,"finallyLoc");if(de&&be){if(this.prev<W.catchLoc)return q(W.catchLoc,!0);if(this.prev<W.finallyLoc)return q(W.finallyLoc)}else if(de){if(this.prev<W.catchLoc)return q(W.catchLoc,!0)}else if(be){if(this.prev<W.finallyLoc)return q(W.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(se,ee){for(var q=this.tryEntries.length-1;q>=0;--q){var U=this.tryEntries[q];if(U.tryLoc<=this.prev&&i.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var W=U;break}}W&&(se==="break"||se==="continue")&&W.tryLoc<=ee&&ee<=W.finallyLoc&&(W=null);var Z=W?W.completion:{};return Z.type=se,Z.arg=ee,W?(this.method="next",this.next=W.finallyLoc,_):this.complete(Z)},complete:function(se,ee){if(se.type==="throw")throw se.arg;return se.type==="break"||se.type==="continue"?this.next=se.arg:se.type==="return"?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):se.type==="normal"&&ee&&(this.next=ee),_},finish:function(se){for(var ee=this.tryEntries.length-1;ee>=0;--ee){var q=this.tryEntries[ee];if(q.finallyLoc===se)return this.complete(q.completion,q.afterLoc),Y(q),_}},catch:function(se){for(var ee=this.tryEntries.length-1;ee>=0;--ee){var q=this.tryEntries[ee];if(q.tryLoc===se){var U=q.completion;if(U.type==="throw"){var W=U.arg;Y(q)}return W}}throw new Error("illegal catch attempt")},delegateYield:function(se,ee,q){return this.delegate={iterator:J(se),resultName:ee,nextLoc:q},this.method==="next"&&(this.arg=o),_}},r})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(g3)),g3.exports}var x3,K9;function HI(){return K9||(K9=1,x3=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),x3}var b3,Y9;function jQ(){if(Y9)return b3;Y9=1;const t=HI();let e=0;return b3=({id:r,action:n,payload:i={}})=>{let a=r;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:n,payload:i}},b3}var Ny={},X9;function WI(){if(X9)return Ny;X9=1;let t=!1;return Ny.logging=t,Ny.setLogging=e=>{t=e},Ny.log=(...e)=>t?console.log.apply(this,e):null,Ny}var y3,Q9;function n1e(){if(Q9)return y3;Q9=1;const t=jQ(),{log:e}=WI(),r=HI();let n=0;return y3=()=>{const i=r("Scheduler",n),a={},o={};let l=[];n+=1;const c=()=>l.length,u=()=>Object.keys(a).length,h=()=>{if(l.length!==0){const v=Object.keys(a);for(let w=0;w<v.length;w+=1)if(typeof o[v[w]]>"u"){l[0](a[v[w]]);break}}},p=(v,w)=>new Promise((j,_)=>{const E=t({action:v,payload:w});l.push(async I=>{l.shift(),o[I.id]=E;try{j(await I[v].apply(this,[...w,E.id]))}catch(O){_(O)}finally{delete o[I.id],h()}}),e(`[${i}]: Add ${E.id} to JobQueue`),e(`[${i}]: JobQueue length=${l.length}`),h()});return{addWorker:v=>(a[v.id]=v,e(`[${i}]: Add ${v.id}`),e(`[${i}]: Number of workers=${u()}`),h(),v.id),addJob:async(v,...w)=>{if(u()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(v,w)},terminate:async()=>{Object.keys(a).forEach(async v=>{await a[v].terminate()}),l=[]},getQueueLen:c,getNumWorkers:u}},y3}function s1e(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var v3,J9;function i1e(){return J9||(J9=1,v3=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof s1e=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),v3}var w3,Z9;function a1e(){if(Z9)return w3;Z9=1;const e=i1e()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return w3=r=>{const n={...r};return["corePath","workerPath","langPath"].forEach(i=>{r[i]&&(n[i]=e(n[i]))}),n},w3}var N3,eB;function kQ(){return eB||(eB=1,N3={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),N3}const o1e="7.0.0",l1e={version:o1e};var j3,tB;function c1e(){return tB||(tB=1,j3={workerBlobURL:!0,logger:()=>{}}),j3}var k3,rB;function u1e(){if(rB)return k3;rB=1;const t=l1e.version;return k3={...c1e(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},k3}var _3,nB;function d1e(){return nB||(nB=1,_3=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const n=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(t);return r}),_3}var S3,sB;function h1e(){return sB||(sB=1,S3=t=>{t.terminate()}),S3}var C3,iB;function f1e(){return iB||(iB=1,C3=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}),C3}var E3,aB;function p1e(){return aB||(aB=1,E3=async(t,e)=>{t.postMessage(e)}),E3}var A3,oB;function m1e(){if(oB)return A3;oB=1;const t=r=>new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},a.readAsArrayBuffer(r)}),e=async r=>{let n=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?n=atob(r.split(",")[1]).split("").map(i=>i.charCodeAt(0)):n=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(n=await e(r.src)),r.tagName==="VIDEO"&&(n=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(i=>{r.toBlob(async a=>{n=await t(a),i()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const i=await r.convertToBlob();n=await t(i)}else(r instanceof File||r instanceof Blob)&&(n=await t(r));return new Uint8Array(n)};return A3=e,A3}var T3,lB;function g1e(){if(lB)return T3;lB=1;const t=u1e(),e=d1e(),r=h1e(),n=f1e(),i=p1e(),a=m1e();return T3={defaultOptions:t,spawnWorker:e,terminateWorker:r,onMessage:n,send:i,loadImage:a},T3}var I3,cB;function _Q(){if(cB)return I3;cB=1;const t=a1e(),e=jQ(),{log:r}=WI(),n=HI(),i=kQ(),{defaultOptions:a,spawnWorker:o,terminateWorker:l,onMessage:c,loadImage:u,send:h}=g1e();let p=0;return I3=async(m="eng",g=i.LSTM_ONLY,b={},v={})=>{const w=n("Worker",p),{logger:j,errorHandler:_,...E}=t({...a,...b}),I={},O=typeof m=="string"?m.split("+"):m;let B=g,S=v;const T=[i.DEFAULT,i.LSTM_ONLY].includes(g)&&!E.legacyCore;let M,$;const k=new Promise((H,le)=>{$=H,M=le}),L=H=>{M(H.message)};let R=o(E);R.onerror=L,p+=1;const V=({id:H,action:le,payload:ye})=>new Promise((me,ke)=>{r(`[${w}]: Start ${H}, action=${le}`);const Ie=`${le}-${H}`;I[Ie]={resolve:me,reject:ke},h(R,{workerId:w,jobId:H,action:le,payload:ye})}),Y=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),X=H=>V(e({id:H,action:"load",payload:{options:{lstmOnly:T,corePath:E.corePath,logging:E.logging}}})),J=(H,le,ye)=>V(e({id:ye,action:"FS",payload:{method:"writeFile",args:[H,le]}})),re=(H,le)=>V(e({id:le,action:"FS",payload:{method:"readFile",args:[H,{encoding:"utf8"}]}})),se=(H,le)=>V(e({id:le,action:"FS",payload:{method:"unlink",args:[H]}})),ee=(H,le,ye)=>V(e({id:ye,action:"FS",payload:{method:H,args:le}})),q=(H,le)=>V(e({id:le,action:"loadLanguage",payload:{langs:H,options:{langPath:E.langPath,dataPath:E.dataPath,cachePath:E.cachePath,cacheMethod:E.cacheMethod,gzip:E.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(B)&&!E.legacyLang}}})),U=(H,le,ye,me)=>V(e({id:me,action:"initialize",payload:{langs:H,oem:le,config:ye}})),W=(H="eng",le,ye,me)=>{if(T&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(le))throw Error("Legacy model requested but code missing.");const ke=le||B;B=ke;const Ie=ye||S;S=Ie;const Be=(typeof H=="string"?H.split("+"):H).filter(ct=>!O.includes(ct));return O.push(...Be),Be.length>0?q(Be,me).then(()=>U(H,ke,Ie,me)):U(H,ke,Ie,me)},Z=(H={},le)=>V(e({id:le,action:"setParameters",payload:{params:H}})),de=async(H,le={},ye={text:!0},me)=>V(e({id:me,action:"recognize",payload:{image:await u(H),options:le,output:ye}})),be=async(H,le)=>{if(T)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return V(e({id:le,action:"detect",payload:{image:await u(H)}}))},oe=async()=>(R!==null&&(l(R),R=null),Promise.resolve());c(R,({workerId:H,jobId:le,status:ye,action:me,data:ke})=>{const Ie=`${me}-${le}`;if(ye==="resolve")r(`[${H}]: Complete ${le}`),I[Ie].resolve({jobId:le,data:ke}),delete I[Ie];else if(ye==="reject")if(I[Ie].reject(ke),delete I[Ie],me==="load"&&M(ke),_)_(ke);else throw Error(ke);else ye==="progress"&&j({...ke,userJobId:le})});const ne={id:w,worker:R,load:Y,writeText:J,readText:re,removeFile:se,FS:ee,reinitialize:W,setParameters:Z,recognize:de,detect:be,terminate:oe};return X().then(()=>q(m)).then(()=>U(m,g,v)).then(()=>$(ne)).catch(()=>{}),k},I3}var L3,uB;function x1e(){if(uB)return L3;uB=1;const t=_Q();return L3={recognize:async(n,i,a)=>{const o=await t(i,1,a);return o.recognize(n).finally(async()=>{await o.terminate()})},detect:async(n,i)=>{const a=await t("osd",0,i);return a.detect(n).finally(async()=>{await a.terminate()})}},L3}var P3,dB;function b1e(){return dB||(dB=1,P3={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),P3}var O3,hB;function y1e(){return hB||(hB=1,O3={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),O3}var R3,fB;function v1e(){if(fB)return R3;fB=1,r1e();const t=n1e(),e=_Q(),r=x1e(),n=b1e(),i=kQ(),a=y1e(),{setLogging:o}=WI();return R3={languages:n,OEM:i,PSM:a,createScheduler:t,createWorker:e,setLogging:o,...r},R3}var SQ=v1e();const w1e=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),N1e=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),pB=t=>{const e=N1e(t);return e.charAt(0).toUpperCase()+e.slice(1)},CQ=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),j1e=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var k1e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const _1e=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...l},c)=>y.createElement("svg",{ref:c,...k1e,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:CQ("lucide",i),...!a&&!j1e(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,h])=>y.createElement(u,h)),...Array.isArray(a)?a:[a]]));const vr=(t,e)=>{const r=y.forwardRef(({className:n,...i},a)=>y.createElement(_1e,{ref:a,iconNode:e,className:CQ(`lucide-${w1e(pB(t))}`,`lucide-${t}`,n),...i}));return r.displayName=pB(t),r};const S1e=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],EA=vr("activity",S1e);const C1e=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],EQ=vr("arrow-left",C1e);const E1e=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],A1e=vr("arrow-right",E1e);const T1e=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],I1e=vr("book-open",T1e);const L1e=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],P1e=vr("box",L1e);const O1e=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],mB=vr("brain",O1e);const R1e=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],AQ=vr("calendar",R1e);const M1e=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],AA=vr("camera",M1e);const D1e=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],B1e=vr("chart-column",D1e);const $1e=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],F1e=vr("chart-no-axes-column",$1e);const U1e=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Od=vr("check",U1e);const z1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],J5=vr("circle-alert",z1e);const q1e=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],V1e=vr("circle-play",q1e);const H1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],W1e=vr("circle-question-mark",H1e);const G1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],K1e=vr("circle-x",G1e);const Y1e=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],TQ=vr("clock",Y1e);const X1e=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],Q1e=vr("cog",X1e);const J1e=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Z1e=vr("credit-card",J1e);const e2e=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],bx=vr("crown",e2e);const t2e=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],r2e=vr("delete",t2e);const n2e=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],IQ=vr("dollar-sign",n2e);const s2e=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],i2e=vr("flag",s2e);const a2e=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],o2e=vr("grid-3x3",a2e);const l2e=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],c2e=vr("heart",l2e);const u2e=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],d2e=vr("layers",u2e);const h2e=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],f2e=vr("list",h2e);const p2e=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],m2e=vr("lock",p2e);const g2e=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],x2e=vr("map",g2e);const b2e=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],gB=vr("medal",b2e);const y2e=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],v2e=vr("message-square",y2e);const w2e=[["path",{d:"M5 12h14",key:"1ays0h"}]],N2e=vr("minus",w2e);const j2e=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],k2e=vr("mountain",j2e);const _2e=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],TA=vr("play",_2e);const S2e=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],C2e=vr("plus",S2e);const E2e=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],tj=vr("refresh-cw",E2e);const A2e=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],T2e=vr("save",A2e);const I2e=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],L2e=vr("scroll",I2e);const P2e=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],LQ=vr("search",P2e);const O2e=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],PQ=vr("share-2",O2e);const R2e=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],lm=vr("shield",R2e);const M2e=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],D2e=vr("skip-forward",M2e);const B2e=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],rj=vr("skull",B2e);const $2e=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],IA=vr("smartphone",$2e);const F2e=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],LA=vr("sparkles",F2e);const U2e=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],z2e=vr("square-plus",U2e);const q2e=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],V2e=vr("star",q2e);const H2e=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],Wv=vr("swords",H2e);const W2e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],G2e=vr("target",W2e);const K2e=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],OQ=vr("trash-2",K2e);const Y2e=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],X2e=vr("trash",Y2e);const Q2e=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],GI=vr("trending-up",Q2e);const J2e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Z2e=vr("triangle-alert",J2e);const ewe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Ro=vr("trophy",ewe);const twe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],rwe=vr("upload",twe);const nwe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],PA=vr("user-plus",nwe);const swe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],OA=vr("user",swe);const iwe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],cm=vr("users",iwe);const awe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],owe=vr("wifi-off",awe);const lwe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],cwe=vr("wifi",lwe);const uwe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fd=vr("x",uwe);const dwe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],um=vr("zap",dwe),Ud=Object.create(null);Ud.open="0";Ud.close="1";Ud.ping="2";Ud.pong="3";Ud.message="4";Ud.upgrade="5";Ud.noop="6";const Z5=Object.create(null);Object.keys(Ud).forEach(t=>{Z5[Ud[t]]=t});const RA={type:"error",data:"parser error"},RQ=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",MQ=typeof ArrayBuffer=="function",DQ=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,KI=({type:t,data:e},r,n)=>RQ&&e instanceof Blob?r?n(e):xB(e,n):MQ&&(e instanceof ArrayBuffer||DQ(e))?r?n(e):xB(new Blob([e]),n):n(Ud[t]+(e||"")),xB=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function bB(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let M3;function hwe(t,e){if(RQ&&t.data instanceof Blob)return t.data.arrayBuffer().then(bB).then(e);if(MQ&&(t.data instanceof ArrayBuffer||DQ(t.data)))return e(bB(t.data));KI(t,!1,r=>{M3||(M3=new TextEncoder),e(M3.encode(r))})}const yB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Jy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<yB.length;t++)Jy[yB.charCodeAt(t)]=t;const fwe=t=>{let e=t.length*.75,r=t.length,n,i=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const u=new ArrayBuffer(e),h=new Uint8Array(u);for(n=0;n<r;n+=4)a=Jy[t.charCodeAt(n)],o=Jy[t.charCodeAt(n+1)],l=Jy[t.charCodeAt(n+2)],c=Jy[t.charCodeAt(n+3)],h[i++]=a<<2|o>>4,h[i++]=(o&15)<<4|l>>2,h[i++]=(l&3)<<6|c&63;return u},pwe=typeof ArrayBuffer=="function",YI=(t,e)=>{if(typeof t!="string")return{type:"message",data:BQ(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:mwe(t.substring(1),e)}:Z5[r]?t.length>1?{type:Z5[r],data:t.substring(1)}:{type:Z5[r]}:RA},mwe=(t,e)=>{if(pwe){const r=fwe(t);return BQ(r,e)}else return{base64:!0,data:t}},BQ=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,$Q="",gwe=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach((a,o)=>{KI(a,!1,l=>{n[o]=l,++i===r&&e(n.join($Q))})})},xwe=(t,e)=>{const r=t.split($Q),n=[];for(let i=0;i<r.length;i++){const a=YI(r[i],e);if(n.push(a),a.type==="error")break}return n};function bwe(){return new TransformStream({transform(t,e){hwe(t,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}let D3;function $w(t){return t.reduce((e,r)=>e+r.length,0)}function Fw(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function ywe(t,e){D3||(D3=new TextDecoder);const r=[];let n=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(n===0){if($w(r)<1)break;const c=Fw(r,1);a=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if($w(r)<2)break;const c=Fw(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if($w(r)<8)break;const c=Fw(r,8),u=new DataView(c.buffer,c.byteOffset,c.length),h=u.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(RA);break}i=h*Math.pow(2,32)+u.getUint32(4),n=3}else{if($w(r)<i)break;const c=Fw(r,i);l.enqueue(YI(a?c:D3.decode(c),e)),n=0}if(i===0||i>t){l.enqueue(RA);break}}}})}const FQ=4;function ba(t){if(t)return vwe(t)}function vwe(t){for(var e in ba.prototype)t[e]=ba.prototype[e];return t}ba.prototype.on=ba.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};ba.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};ba.prototype.off=ba.prototype.removeListener=ba.prototype.removeAllListeners=ba.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};ba.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};ba.prototype.emitReserved=ba.prototype.emit;ba.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};ba.prototype.hasListeners=function(t){return!!this.listeners(t).length};const rk=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),Yc=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),wwe="arraybuffer";function UQ(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const Nwe=Yc.setTimeout,jwe=Yc.clearTimeout;function nk(t,e){e.useNativeTimers?(t.setTimeoutFn=Nwe.bind(Yc),t.clearTimeoutFn=jwe.bind(Yc)):(t.setTimeoutFn=Yc.setTimeout.bind(Yc),t.clearTimeoutFn=Yc.clearTimeout.bind(Yc))}const kwe=1.33;function _we(t){return typeof t=="string"?Swe(t):Math.ceil((t.byteLength||t.size)*kwe)}function Swe(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function zQ(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Cwe(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function Ewe(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class Awe extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class XI extends ba{constructor(e){super(),this.writable=!1,nk(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new Awe(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=YI(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=Cwe(e);return r.length?"?"+r:""}}class Twe extends XI{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};xwe(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,gwe(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=zQ()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let qQ=!1;try{qQ=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Iwe=qQ;function Lwe(){}class Pwe extends Twe{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let yx=class eN extends ba{constructor(e,r,n){super(),this.createRequest=e,nk(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=UQ(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=eN.requestsCount++,eN.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Lwe,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete eN.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};yx.requestsCount=0;yx.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",vB);else if(typeof addEventListener=="function"){const t="onpagehide"in Yc?"pagehide":"unload";addEventListener(t,vB,!1)}}function vB(){for(let t in yx.requests)yx.requests.hasOwnProperty(t)&&yx.requests[t].abort()}const Owe=(function(){const t=VQ({xdomain:!1});return t&&t.responseType!==null})();class Rwe extends Pwe{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=Owe&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new yx(VQ,this.uri(),e)}}function VQ(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Iwe))return new XMLHttpRequest}catch{}if(!e)try{return new Yc[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const HQ=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Mwe extends XI{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=HQ?{}:UQ(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;KI(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}i&&rk(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=zQ()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const B3=Yc.WebSocket||Yc.MozWebSocket;class Dwe extends Mwe{createSocket(e,r,n){return HQ?new B3(e,r,n):r?new B3(e,r):new B3(e)}doWrite(e,r){this.ws.send(r)}}class Bwe extends XI{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=ywe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=bwe();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const a=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;this._writer.write(n).then(()=>{i&&rk(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const $we={websocket:Dwe,webtransport:Bwe,polling:Rwe},Fwe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Uwe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function MA(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=Fwe.exec(t||""),a={},o=14;for(;o--;)a[Uwe[o]]=i[o]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=zwe(a,a.path),a.queryKey=qwe(a,a.query),a}function zwe(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function qwe(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(r[i]=a)}),r}const DA=typeof addEventListener=="function"&&typeof removeEventListener=="function",tN=[];DA&&addEventListener("offline",()=>{tN.forEach(t=>t())},!1);class S0 extends ba{constructor(e,r){if(super(),this.binaryType=wwe,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=MA(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=MA(r.host).host);nk(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ewe(this.opts.query)),DA&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},tN.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=FQ,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&S0.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",S0.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=_we(i)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,rk(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(S0.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),DA&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=tN.indexOf(this._offlineEventListener);n!==-1&&tN.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}S0.protocol=FQ;class Vwe extends S0{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;S0.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;S0.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=r.name,this.emitReserved("upgradeError",m)}}))};function a(){n||(n=!0,h(),r.close(),r=null)}const o=p=>{const m=new Error("probe error: "+p);m.transport=r.name,a(),this.emitReserved("upgradeError",m)};function l(){o("transport closed")}function c(){o("socket closed")}function u(p){r&&p.name!==r.name&&a()}const h=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};r.once("open",i),r.once("error",o),r.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let Hwe=class extends Vwe{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>$we[i]).filter(i=>!!i)),super(e,n)}};function Wwe(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=MA(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const Gwe=typeof ArrayBuffer=="function",Kwe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,WQ=Object.prototype.toString,Ywe=typeof Blob=="function"||typeof Blob<"u"&&WQ.call(Blob)==="[object BlobConstructor]",Xwe=typeof File=="function"||typeof File<"u"&&WQ.call(File)==="[object FileConstructor]";function QI(t){return Gwe&&(t instanceof ArrayBuffer||Kwe(t))||Ywe&&t instanceof Blob||Xwe&&t instanceof File}function rN(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(rN(t[r]))return!0;return!1}if(QI(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return rN(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&rN(t[r]))return!0;return!1}function Qwe(t){const e=[],r=t.data,n=t;return n.data=BA(r,e),n.attachments=e.length,{packet:n,buffers:e}}function BA(t,e){if(!t)return t;if(QI(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=BA(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=BA(t[n],e));return r}return t}function Jwe(t,e){return t.data=$A(t.data,e),delete t.attachments,t}function $A(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=$A(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=$A(t[r],e));return t}const GQ=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Zwe=5;var hn;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(hn||(hn={}));class e5e{constructor(e){this.replacer=e}encode(e){return(e.type===hn.EVENT||e.type===hn.ACK)&&rN(e)?this.encodeAsBinary({type:e.type===hn.EVENT?hn.BINARY_EVENT:hn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===hn.BINARY_EVENT||e.type===hn.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=Qwe(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}class JI extends ba{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===hn.BINARY_EVENT;n||r.type===hn.BINARY_ACK?(r.type=n?hn.EVENT:hn.ACK,this.reconstructor=new t5e(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(QI(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(hn[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===hn.BINARY_EVENT||n.type===hn.BINARY_ACK){const a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const o=e.substring(a,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";const i=e.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){const a=this.tryParse(e.substr(r));if(JI.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case hn.CONNECT:return nj(r);case hn.DISCONNECT:return r===void 0;case hn.CONNECT_ERROR:return typeof r=="string"||nj(r);case hn.EVENT:case hn.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&GQ.indexOf(r[0])===-1);case hn.ACK:case hn.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class t5e{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=Jwe(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function r5e(t){return typeof t=="string"}const n5e=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function s5e(t){return t===void 0||n5e(t)}function nj(t){return Object.prototype.toString.call(t)==="[object Object]"}function i5e(t,e){switch(t){case hn.CONNECT:return e===void 0||nj(e);case hn.DISCONNECT:return e===void 0;case hn.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&GQ.indexOf(e[0])===-1);case hn.ACK:return Array.isArray(e);case hn.CONNECT_ERROR:return typeof e=="string"||nj(e);default:return!1}}function a5e(t){return r5e(t.nsp)&&s5e(t.id)&&i5e(t.type,t.data)}const o5e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:JI,Encoder:e5e,get PacketType(){return hn},isPacketValid:a5e,protocol:Zwe},Symbol.toStringTag,{value:"Module"}));function Cu(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const l5e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class KQ extends ba{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Cu(e,"open",this.onopen.bind(this)),Cu(e,"packet",this.onpacket.bind(this)),Cu(e,"error",this.onerror.bind(this)),Cu(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,i,a;if(l5e.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:hn.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),o.id=h}const l=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...r){return new Promise((n,i)=>{const a=(o,l)=>o?i(o):n(l);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>(this._queue[0],i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:hn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case hn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case hn.EVENT:case hn.BINARY_EVENT:this.onevent(e);break;case hn.ACK:case hn.BINARY_ACK:this.onack(e);break;case hn.DISCONNECT:this.ondisconnect();break;case hn.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:hn.ACK,id:e,data:i}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:hn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function mb(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}mb.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};mb.prototype.reset=function(){this.attempts=0};mb.prototype.setMin=function(t){this.ms=t};mb.prototype.setMax=function(t){this.max=t};mb.prototype.setJitter=function(t){this.jitter=t};class FA extends ba{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,nk(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new mb({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const i=r.parser||o5e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Hwe(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=Cu(r,"open",function(){n.onopen(),e&&e()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Cu(r,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Cu(e,"ping",this.onping.bind(this)),Cu(e,"data",this.ondata.bind(this)),Cu(e,"error",this.onerror.bind(this)),Cu(e,"close",this.onclose.bind(this)),Cu(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){rk(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new KQ(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const jy={};function Vp(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=Wwe(t,e.path||"/socket.io"),n=r.source,i=r.id,a=r.path,o=jy[i]&&a in jy[i].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return l?c=new FA(n,e):(jy[i]||(jy[i]=new FA(n,e)),c=jy[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(Vp,{Manager:FA,Socket:KQ,io:Vp,connect:Vp});var Mg={},$3={exports:{}},F3,wB;function c5e(){if(wB)return F3;wB=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return F3=t,F3}var U3,NB;function u5e(){if(NB)return U3;NB=1;var t=c5e();function e(){}function r(){}return r.resetWarningCache=e,U3=function(){function n(o,l,c,u,h,p){if(p!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},U3}var jB;function ZI(){return jB||(jB=1,$3.exports=u5e()()),$3.exports}var z3,kB;function YQ(){return kB||(kB=1,z3={L:1,M:0,Q:3,H:2}),z3}var q3,_B;function XQ(){return _B||(_B=1,q3={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),q3}var V3,SB;function d5e(){if(SB)return V3;SB=1;var t=XQ();function e(r){this.mode=t.MODE_8BIT_BYTE,this.data=r}return e.prototype={getLength:function(r){return this.data.length},write:function(r){for(var n=0;n<this.data.length;n++)r.put(this.data.charCodeAt(n),8)}},V3=e,V3}var H3,CB;function h5e(){if(CB)return H3;CB=1;var t=YQ();function e(r,n){this.totalCount=r,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(r,n){var i=e.getRsBlockTable(r,n);if(i==null)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+n);for(var a=i.length/3,o=new Array,l=0;l<a;l++)for(var c=i[l*3+0],u=i[l*3+1],h=i[l*3+2],p=0;p<c;p++)o.push(new e(u,h));return o},e.getRsBlockTable=function(r,n){switch(n){case t.L:return e.RS_BLOCK_TABLE[(r-1)*4+0];case t.M:return e.RS_BLOCK_TABLE[(r-1)*4+1];case t.Q:return e.RS_BLOCK_TABLE[(r-1)*4+2];case t.H:return e.RS_BLOCK_TABLE[(r-1)*4+3];default:return}},H3=e,H3}var W3,EB;function f5e(){if(EB)return W3;EB=1;function t(){this.buffer=new Array,this.length=0}return t.prototype={get:function(e){var r=Math.floor(e/8);return(this.buffer[r]>>>7-e%8&1)==1},put:function(e,r){for(var n=0;n<r;n++)this.putBit((e>>>r-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),e&&(this.buffer[r]|=128>>>this.length%8),this.length++}},W3=t,W3}var G3,AB;function QQ(){if(AB)return G3;AB=1;for(var t={glog:function(r){if(r<1)throw new Error("glog("+r+")");return t.LOG_TABLE[r]},gexp:function(r){for(;r<0;)r+=255;for(;r>=256;)r-=255;return t.EXP_TABLE[r]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;e<255;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e;return G3=t,G3}var K3,TB;function JQ(){if(TB)return K3;TB=1;var t=QQ();function e(r,n){if(r.length==null)throw new Error(r.length+"/"+n);for(var i=0;i<r.length&&r[i]==0;)i++;this.num=new Array(r.length-i+n);for(var a=0;a<r.length-i;a++)this.num[a]=r[a+i]}return e.prototype={get:function(r){return this.num[r]},getLength:function(){return this.num.length},multiply:function(r){for(var n=new Array(this.getLength()+r.getLength()-1),i=0;i<this.getLength();i++)for(var a=0;a<r.getLength();a++)n[i+a]^=t.gexp(t.glog(this.get(i))+t.glog(r.get(a)));return new e(n,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var n=t.glog(this.get(0))-t.glog(r.get(0)),i=new Array(this.getLength()),a=0;a<this.getLength();a++)i[a]=this.get(a);for(var a=0;a<r.getLength();a++)i[a]^=t.gexp(t.glog(r.get(a))+n);return new e(i,0).mod(r)}},K3=e,K3}var Y3,IB;function p5e(){if(IB)return Y3;IB=1;var t=XQ(),e=JQ(),r=QQ(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var o=a<<10;i.getBCHDigit(o)-i.getBCHDigit(i.G15)>=0;)o^=i.G15<<i.getBCHDigit(o)-i.getBCHDigit(i.G15);return(a<<10|o)^i.G15_MASK},getBCHTypeNumber:function(a){for(var o=a<<12;i.getBCHDigit(o)-i.getBCHDigit(i.G18)>=0;)o^=i.G18<<i.getBCHDigit(o)-i.getBCHDigit(i.G18);return a<<12|o},getBCHDigit:function(a){for(var o=0;a!=0;)o++,a>>>=1;return o},getPatternPosition:function(a){return i.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,o,l){switch(a){case n.PATTERN000:return(o+l)%2==0;case n.PATTERN001:return o%2==0;case n.PATTERN010:return l%3==0;case n.PATTERN011:return(o+l)%3==0;case n.PATTERN100:return(Math.floor(o/2)+Math.floor(l/3))%2==0;case n.PATTERN101:return o*l%2+o*l%3==0;case n.PATTERN110:return(o*l%2+o*l%3)%2==0;case n.PATTERN111:return(o*l%3+(o+l)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var o=new e([1],0),l=0;l<a;l++)o=o.multiply(new e([1,r.gexp(l)],0));return o},getLengthInBits:function(a,o){if(1<=o&&o<10)switch(a){case t.MODE_NUMBER:return 10;case t.MODE_ALPHA_NUM:return 9;case t.MODE_8BIT_BYTE:return 8;case t.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(o<27)switch(a){case t.MODE_NUMBER:return 12;case t.MODE_ALPHA_NUM:return 11;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else if(o<41)switch(a){case t.MODE_NUMBER:return 14;case t.MODE_ALPHA_NUM:return 13;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}else throw new Error("type:"+o)},getLostPoint:function(a){for(var o=a.getModuleCount(),l=0,c=0;c<o;c++)for(var u=0;u<o;u++){for(var h=0,p=a.isDark(c,u),m=-1;m<=1;m++)if(!(c+m<0||o<=c+m))for(var g=-1;g<=1;g++)u+g<0||o<=u+g||m==0&&g==0||p==a.isDark(c+m,u+g)&&h++;h>5&&(l+=3+h-5)}for(var c=0;c<o-1;c++)for(var u=0;u<o-1;u++){var b=0;a.isDark(c,u)&&b++,a.isDark(c+1,u)&&b++,a.isDark(c,u+1)&&b++,a.isDark(c+1,u+1)&&b++,(b==0||b==4)&&(l+=3)}for(var c=0;c<o;c++)for(var u=0;u<o-6;u++)a.isDark(c,u)&&!a.isDark(c,u+1)&&a.isDark(c,u+2)&&a.isDark(c,u+3)&&a.isDark(c,u+4)&&!a.isDark(c,u+5)&&a.isDark(c,u+6)&&(l+=40);for(var u=0;u<o;u++)for(var c=0;c<o-6;c++)a.isDark(c,u)&&!a.isDark(c+1,u)&&a.isDark(c+2,u)&&a.isDark(c+3,u)&&a.isDark(c+4,u)&&!a.isDark(c+5,u)&&a.isDark(c+6,u)&&(l+=40);for(var v=0,u=0;u<o;u++)for(var c=0;c<o;c++)a.isDark(c,u)&&v++;var w=Math.abs(100*v/o/o-50)/5;return l+=w*10,l}};return Y3=i,Y3}var X3,LB;function m5e(){if(LB)return X3;LB=1;var t=d5e(),e=h5e(),r=f5e(),n=p5e(),i=JQ();function a(l,c){this.typeNumber=l,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var o=a.prototype;return o.addData=function(l){var c=new t(l);this.dataList.push(c),this.dataCache=null},o.isDark=function(l,c){if(l<0||this.moduleCount<=l||c<0||this.moduleCount<=c)throw new Error(l+","+c);return this.modules[l][c]},o.getModuleCount=function(){return this.moduleCount},o.make=function(){if(this.typeNumber<1){var l=1;for(l=1;l<40;l++){for(var c=e.getRSBlocks(l,this.errorCorrectLevel),u=new r,h=0,p=0;p<c.length;p++)h+=c[p].dataCount;for(var p=0;p<this.dataList.length;p++){var m=this.dataList[p];u.put(m.mode,4),u.put(m.getLength(),n.getLengthInBits(m.mode,l)),m.write(u)}if(u.getLengthInBits()<=h*8)break}this.typeNumber=l}this.makeImpl(!1,this.getBestMaskPattern())},o.makeImpl=function(l,c){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var u=0;u<this.moduleCount;u++){this.modules[u]=new Array(this.moduleCount);for(var h=0;h<this.moduleCount;h++)this.modules[u][h]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(l,c),this.typeNumber>=7&&this.setupTypeNumber(l),this.dataCache==null&&(this.dataCache=a.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},o.setupPositionProbePattern=function(l,c){for(var u=-1;u<=7;u++)if(!(l+u<=-1||this.moduleCount<=l+u))for(var h=-1;h<=7;h++)c+h<=-1||this.moduleCount<=c+h||(0<=u&&u<=6&&(h==0||h==6)||0<=h&&h<=6&&(u==0||u==6)||2<=u&&u<=4&&2<=h&&h<=4?this.modules[l+u][c+h]=!0:this.modules[l+u][c+h]=!1)},o.getBestMaskPattern=function(){for(var l=0,c=0,u=0;u<8;u++){this.makeImpl(!0,u);var h=n.getLostPoint(this);(u==0||l>h)&&(l=h,c=u)}return c},o.createMovieClip=function(l,c,u){var h=l.createEmptyMovieClip(c,u),p=1;this.make();for(var m=0;m<this.modules.length;m++)for(var g=m*p,b=0;b<this.modules[m].length;b++){var v=b*p,w=this.modules[m][b];w&&(h.beginFill(0,100),h.moveTo(v,g),h.lineTo(v+p,g),h.lineTo(v+p,g+p),h.lineTo(v,g+p),h.endFill())}return h},o.setupTimingPattern=function(){for(var l=8;l<this.moduleCount-8;l++)this.modules[l][6]==null&&(this.modules[l][6]=l%2==0);for(var c=8;c<this.moduleCount-8;c++)this.modules[6][c]==null&&(this.modules[6][c]=c%2==0)},o.setupPositionAdjustPattern=function(){for(var l=n.getPatternPosition(this.typeNumber),c=0;c<l.length;c++)for(var u=0;u<l.length;u++){var h=l[c],p=l[u];if(this.modules[h][p]==null)for(var m=-2;m<=2;m++)for(var g=-2;g<=2;g++)m==-2||m==2||g==-2||g==2||m==0&&g==0?this.modules[h+m][p+g]=!0:this.modules[h+m][p+g]=!1}},o.setupTypeNumber=function(l){for(var c=n.getBCHTypeNumber(this.typeNumber),u=0;u<18;u++){var h=!l&&(c>>u&1)==1;this.modules[Math.floor(u/3)][u%3+this.moduleCount-8-3]=h}for(var u=0;u<18;u++){var h=!l&&(c>>u&1)==1;this.modules[u%3+this.moduleCount-8-3][Math.floor(u/3)]=h}},o.setupTypeInfo=function(l,c){for(var u=this.errorCorrectLevel<<3|c,h=n.getBCHTypeInfo(u),p=0;p<15;p++){var m=!l&&(h>>p&1)==1;p<6?this.modules[p][8]=m:p<8?this.modules[p+1][8]=m:this.modules[this.moduleCount-15+p][8]=m}for(var p=0;p<15;p++){var m=!l&&(h>>p&1)==1;p<8?this.modules[8][this.moduleCount-p-1]=m:p<9?this.modules[8][15-p-1+1]=m:this.modules[8][15-p-1]=m}this.modules[this.moduleCount-8][8]=!l},o.mapData=function(l,c){for(var u=-1,h=this.moduleCount-1,p=7,m=0,g=this.moduleCount-1;g>0;g-=2)for(g==6&&g--;;){for(var b=0;b<2;b++)if(this.modules[h][g-b]==null){var v=!1;m<l.length&&(v=(l[m]>>>p&1)==1);var w=n.getMask(c,h,g-b);w&&(v=!v),this.modules[h][g-b]=v,p--,p==-1&&(m++,p=7)}if(h+=u,h<0||this.moduleCount<=h){h-=u,u=-u;break}}},a.PAD0=236,a.PAD1=17,a.createData=function(l,c,u){for(var h=e.getRSBlocks(l,c),p=new r,m=0;m<u.length;m++){var g=u[m];p.put(g.mode,4),p.put(g.getLength(),n.getLengthInBits(g.mode,l)),g.write(p)}for(var b=0,m=0;m<h.length;m++)b+=h[m].dataCount;if(p.getLengthInBits()>b*8)throw new Error("code length overflow. ("+p.getLengthInBits()+">"+b*8+")");for(p.getLengthInBits()+4<=b*8&&p.put(0,4);p.getLengthInBits()%8!=0;)p.putBit(!1);for(;!(p.getLengthInBits()>=b*8||(p.put(a.PAD0,8),p.getLengthInBits()>=b*8));)p.put(a.PAD1,8);return a.createBytes(p,h)},a.createBytes=function(l,c){for(var u=0,h=0,p=0,m=new Array(c.length),g=new Array(c.length),b=0;b<c.length;b++){var v=c[b].dataCount,w=c[b].totalCount-v;h=Math.max(h,v),p=Math.max(p,w),m[b]=new Array(v);for(var j=0;j<m[b].length;j++)m[b][j]=255&l.buffer[j+u];u+=v;var _=n.getErrorCorrectPolynomial(w),E=new i(m[b],_.getLength()-1),I=E.mod(_);g[b]=new Array(_.getLength()-1);for(var j=0;j<g[b].length;j++){var O=j+I.getLength()-g[b].length;g[b][j]=O>=0?I.get(O):0}}for(var B=0,j=0;j<c.length;j++)B+=c[j].totalCount;for(var S=new Array(B),T=0,j=0;j<h;j++)for(var b=0;b<c.length;b++)j<m[b].length&&(S[T++]=m[b][j]);for(var j=0;j<p;j++)for(var b=0;b<c.length;b++)j<g[b].length&&(S[T++]=g[b][j]);return S},X3=a,X3}var Uw={},PB;function g5e(){if(PB)return Uw;PB=1,Object.defineProperty(Uw,"__esModule",{value:!0});var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var p=arguments[h];for(var m in p)Object.prototype.hasOwnProperty.call(p,m)&&(u[m]=p[m])}return u},e=ZI(),r=a(e),n=of(),i=a(n);function a(u){return u&&u.__esModule?u:{default:u}}function o(u,h){var p={};for(var m in u)h.indexOf(m)>=0||Object.prototype.hasOwnProperty.call(u,m)&&(p[m]=u[m]);return p}var l={bgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,bgD:r.default.string.isRequired,fgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,fgD:r.default.string.isRequired,size:r.default.number.isRequired,title:r.default.string,viewBoxSize:r.default.number.isRequired,xmlns:r.default.string},c=(0,n.forwardRef)(function(u,h){var p=u.bgColor,m=u.bgD,g=u.fgD,b=u.fgColor,v=u.size,w=u.title,j=u.viewBoxSize,_=u.xmlns,E=_===void 0?"http://www.w3.org/2000/svg":_,I=o(u,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",t({},I,{height:v,ref:h,viewBox:"0 0 "+j+" "+j,width:v,xmlns:E}),w?i.default.createElement("title",null,w):null,i.default.createElement("path",{d:m,fill:p}),i.default.createElement("path",{d:g,fill:b}))});return c.displayName="QRCodeSvg",c.propTypes=l,Uw.default=c,Uw}var OB;function x5e(){if(OB)return Mg;OB=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.QRCode=void 0;var t=Object.assign||function(v){for(var w=1;w<arguments.length;w++){var j=arguments[w];for(var _ in j)Object.prototype.hasOwnProperty.call(j,_)&&(v[_]=j[_])}return v},e=ZI(),r=p(e),n=YQ(),i=p(n),a=m5e(),o=p(a),l=of(),c=p(l),u=g5e(),h=p(u);function p(v){return v&&v.__esModule?v:{default:v}}function m(v,w){var j={};for(var _ in v)w.indexOf(_)>=0||Object.prototype.hasOwnProperty.call(v,_)&&(j[_]=v[_]);return j}var g={bgColor:r.default.oneOfType([r.default.object,r.default.string]),fgColor:r.default.oneOfType([r.default.object,r.default.string]),level:r.default.string,size:r.default.number,value:r.default.string.isRequired},b=(0,l.forwardRef)(function(v,w){var j=v.bgColor,_=j===void 0?"#FFFFFF":j,E=v.fgColor,I=E===void 0?"#000000":E,O=v.level,B=O===void 0?"L":O,S=v.size,T=S===void 0?256:S,M=v.value,$=m(v,["bgColor","fgColor","level","size","value"]),k=new o.default(-1,i.default[B]);k.addData(M),k.make();var L=k.modules;return c.default.createElement(h.default,t({},$,{bgColor:_,bgD:L.map(function(R,V){return R.map(function(Y,X){return Y?"":"M "+X+" "+V+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:I,fgD:L.map(function(R,V){return R.map(function(Y,X){return Y?"M "+X+" "+V+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:w,size:T,viewBoxSize:L.length}))});return Mg.QRCode=b,b.displayName="QRCode",b.propTypes=g,Mg.default=b,Mg}var b5e=x5e();const ZQ=bl(b5e),y5e=()=>{const[t,e]=y.useState([]);return y.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{i(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"absolute top-24 left-4 right-4 h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border border-green-500/20 rounded-xl backdrop-blur-md",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5 break-all",children:r},n))})},sk=({isOpen:t,onClose:e,onFinish:r,mode:n="collection"})=>{const{addToast:i}=jn(),{userProfile:a}=Or(),o=Ln(a?.subscription_tier),[l,c]=y.useState("scanning"),[u,h]=y.useState(window.innerWidth>768),p=y.useRef(null),m=y.useRef(null),g=y.useRef(null),[b,v]=y.useState(null),[w,j]=y.useState(!1),[_,E]=y.useState(!1),[I,O]=y.useState([]),[B,S]=y.useState(null),[T,M]=y.useState(!1),[$]=y.useState(()=>Math.random().toString(36).substr(2,9)),[k,L]=y.useState(!1),[R,V]=y.useState(!1),[Y,X]=y.useState({name:null,footer:null});y.useEffect(()=>{let oe=null;return t&&(async()=>{try{if(!T){console.log("[OCR] Initializing Tesseract Worker...");const H=await SQ.createWorker("eng",1,{logger:le=>console.log(le),workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),oe=H,v(H),E(!0)}}catch(H){console.error("OCR Worker Init Failed",H||"Unknown Error"),i("Failed to initialize OCR engine. Check console.","error")}})(),()=>{oe&&oe.terminate()}},[t,T]),y.useEffect(()=>{if(!t)return;const oe=Vp();return oe.emit("join-pairing",$),oe.on("remote-card",ne=>{console.log("Card received from remote:",ne.name),O(H=>[...H,ne]),S({success:!0,name:ne.name}),L(!0),setTimeout(()=>S(null),2e3)}),()=>oe.disconnect()},[t,$]),y.useEffect(()=>{const oe=()=>h(window.innerWidth>768);return window.addEventListener("resize",oe),()=>window.removeEventListener("resize",oe)},[]);const J=async oe=>{if(!(!_||w)){console.log("[ForgeLens] Processing new image source..."),j(!0);try{if(!oe){console.warn("[ForgeLens] No image source provided.");return}const ne=new Image;ne.src=oe,await new Promise(le=>ne.onload=le),console.log(`[ForgeLens] Image loaded: ${ne.width}x${ne.height}`);const H=await q(ne);console.log("[ForgeLens] Region extraction complete:",H),await U(H)}catch(ne){console.error("[ForgeLens] Processing error",ne),S({error:"Processing failed. Invalid image format?"})}finally{j(!1),setTimeout(()=>S(null),3e3)}}},re=async()=>{if(!p.current)return;const oe=p.current.getScreenshot();await J(oe)},se=async oe=>{const ne=oe.target.files?.[0];if(!ne)return;const H=new FileReader;H.onload=async le=>{const ye=le.target.result;await J(ye),oe.target.value=""},H.readAsDataURL(ne)},ee=y.useCallback((oe,ne,H)=>{const le={id:Math.random().toString(36).substr(2,9),scryfall_id:oe.scryfall_id||oe.uuid,name:oe.name,set_name:oe.set_name||oe.setcode,set_code:oe.set||oe.setcode,collector_number:oe.collector_number||oe.number,image:oe.image_uri||oe.image_uris?.small||oe.card_faces?.[0]?.image_uris?.small,finish:"nonfoil",quantity:1,data:oe,variants:ne,raw_ocr:H,is_wishlist:!1};O(ye=>o.features.batchScan?[...ye,le]:[le]),S({success:!0,name:oe.name})},[o.features.batchScan]),q=async oe=>{const ne=m.current,H=ne.getContext("2d",{willReadFrequently:!0}),le=async(Lt,at,gt,vt)=>{let ft=250/vt;ft=Math.max(.1,Math.min(ft,4));let ot=Math.floor(gt*ft),ut=Math.floor(vt*ft);ot>4e3&&(ft=4e3/gt,ot=4e3,ut=Math.floor(vt*ft)),console.log(`[ForgeLens] OCR Crop: ${ot}x${ut} (Src: ${Math.floor(gt)}x${Math.floor(vt)}, Scale: ${ft.toFixed(2)})`),ne.width=ot,ne.height=ut,H.imageSmoothingEnabled=!0,H.imageSmoothingQuality="high",H.drawImage(oe,Lt,at,gt,vt,0,0,ot,ut);const At=H.getImageData(0,0,ne.width,ne.height),Fe=At.data;for(let rt=0;rt<Fe.length;rt+=4){const Ot=(Fe[rt]+Fe[rt+1]+Fe[rt+2])/3;Fe[rt]=Fe[rt+1]=Fe[rt+2]=Ot}H.putImageData(At,0,0);const{data:{text:Ut}}=await b.recognize(ne),jt=Ut.split(`
`).map(rt=>rt.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(rt=>rt.length>=1),qe=ne.toDataURL("image/png");return{lines:jt,preview:qe}},ye=oe.width,me=oe.height,ke=Math.min(ye,me),Ie=(ye-ke)/2,ce=(me-ke)/2;console.log(`[ForgeLens] Precision Mode: ${ye}x${me}, Crop: ${ke}x${ke} @ (${Ie}, ${ce})`);const Be=await le(Ie+ke*.1,ce+ke*.35,ke*.8,ke*.3);X({footer:Be.preview});let ct="",Ve="";const Ne=Be.lines.join(" ").toUpperCase();console.log(`[ForgeLens] Raw Scan: "${Ne}"`);const St=(Ne.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(Lt=>!/^(19|20)\d{2}$/.test(Lt));St.length>0&&(Ve=St[0]);const Vt=Ne.match(/\b[A-Z0-9]{3,4}\b/g);if(Vt){const Lt=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],at=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],gt=Vt.find(vt=>!at.includes(vt)&&!Lt.includes(vt)&&!/^\d+$/.test(vt));gt&&(ct=gt)}return{name:"",set:ct,cn:Ve,raw_footer:Ne}},U=async({name:oe,set:ne,cn:H,raw_footer:le})=>{if(console.log(`[ForgeLens] Resolving: Name="${oe}", Set="${ne}", CN="${H}" (Footer: "${le}")`),ne&&H){console.log(`[ForgeLens] Attempting Set/CN match: ${ne} #${H}`);try{const ye=await Ge.post("/api/cards/search",{set:ne,cn:H});if(ye.data&&ye.data.length>0){const me=ye.data[0];console.log(`[ForgeLens] Match found by Set/CN: ${me.name}`);const ke=ye.data.length>1?ye.data:[me];ee(me,ke,{name:oe,set:ne,cn:H});return}else{S({error:`Not Found: ${ne} #${H}`,raw:le});return}}catch(ye){console.warn("[ForgeLens] Set/CN search failed",ye)}}if(!oe||oe.length<3){S({error:"Try scanning Set Code & Number again.",raw:le});return}console.log(`[ForgeLens] Attempting Name search: "${oe}"`);try{const me=(await Ge.post("/api/cards/search",{query:oe})).data||[];if(me.length>0){const ke=me[0],Ie=me.length>1?me:[ke];ee(ke,Ie,{name:oe,set:ne,cn:H});return}else{console.log(`[ForgeLens] No direct match for "${oe}". Trying fuzzy fallback...`);const ke=oe.split(/\s+/).filter(ce=>ce.length>3);let Ie=null;if(ke.length>0&&ke[0].length<oe.length?Ie=ke[0]:oe.length>8&&(Ie=oe.substring(0,8)),Ie){console.log(`[ForgeLens] Fuzzy fallback attempt with: "${Ie}"`);const ce=await Ge.post("/api/cards/search",{query:Ie});if(ce.data?.length>0){const Be=ce.data[0];console.log(`[ForgeLens] Fuzzy match found: "${Be.name}"`);const ct=oe.toLowerCase().includes(Be.name.toLowerCase()),Ve=Be.name.toLowerCase().includes(Ie.toLowerCase());if(ct||Ve){console.log(`[ForgeLens] Fallback match accepted: "${Be.name}"`);const Ne=ce.data.length>1?ce.data:[Be];ee(Be,Ne,{name:oe,set:ne,cn:H});return}}}S({error:`Not found: ${oe}`})}}catch(ye){console.error("[ForgeLens] Resolution failed",ye),S({error:"Search failed"})}},W=oe=>{O(ne=>ne.filter(H=>H.id!==oe))},Z=(oe,ne)=>{O(H=>H.map(le=>le.id===oe?{...le,...ne}:le))},de=(oe,ne)=>{O(H=>H.map(le=>{if(le.id===oe){const ye=le.variants.find(me=>me.id===ne);if(ye)return{...le,scryfall_id:ye.id,set_name:ye.set_name,set_code:ye.set,collector_number:ye.collector_number,image:ye.image_uris?.small||ye.card_faces?.[0]?.image_uris?.small,data:ye}}return le}))},be=()=>{r&&r(I),e()};return t?Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/95 backdrop-blur-md p-0 md:p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full h-full md:max-w-5xl md:max-h-[85vh] md:rounded-3xl shadow-2xl flex flex-col border border-white/10 overflow-hidden relative",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-[1010] p-2 bg-black/50 text-white rounded-full hover:bg-red-500/50 transition-all",children:s.jsx(Fd,{className:"w-6 h-6"})}),s.jsxs("div",{className:"px-4 py-4 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsxs("div",{className:"flex items-center gap-6 w-full md:w-auto",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm shrink-0",children:s.jsx(AA,{className:"w-8 h-8 text-indigo-400"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-black text-white tracking-tight italic uppercase",children:"Forge Lens"}),s.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest leading-none",children:"AI Card Scanner"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c("scanning"),className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${l==="scanning"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:"Scan"}),s.jsxs("button",{onClick:()=>{o.features.batchScan||I.length<=1?c("review"):i("Batch Review is a Magician+ feature. Upgrade to review all at once!","info")},className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all relative ${l==="review"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[!o.features.batchScan&&s.jsx(m2e,{className:"w-3 h-3 text-orange-400"}),"Review"]}),I.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center animate-bounce",children:I.length})]})]}),s.jsxs("button",{onClick:()=>M(!T),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${T?"bg-indigo-600/20 text-indigo-400 border border-indigo-500/30":"bg-gray-800 text-gray-400"}`,title:"Remote Camera",children:[s.jsx(IA,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:T?"Remote Lens Active":"Use Remote Camera"})]}),s.jsxs("button",{onClick:()=>V(!R),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${R?"bg-orange-600/20 text-orange-400 border border-orange-500/30":"bg-gray-800 text-gray-400"}`,title:"Debug Regions",children:[s.jsx(J5,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Debug Regions"})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[l==="scanning"&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 relative",children:[u&&s.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-20 w-fit",children:s.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-500 px-4 py-2 rounded-2xl flex items-center gap-2 text-xs shadow-xl backdrop-blur-md animate-pulse",children:[s.jsx(J5,{className:"w-4 h-4"}),s.jsx("span",{children:"Desktop detected. For best focus, use the mobile app."})]})}),s.jsxs("div",{className:"relative w-full max-w-sm aspect-[3/4] rounded-3xl overflow-hidden border-2 border-dashed border-white/20 shadow-2xl bg-black group transition-all",children:[s.jsx(NQ,{ref:p,audio:!1,screenshotFormat:"image/webp",videoConstraints:{width:1280,height:720,facingMode:"environment"},className:"w-full h-full object-cover grayscale brightness-110 contrast-125"}),s.jsx("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-center",children:s.jsxs("div",{className:"w-[85%] h-[90%] border-2 border-white/10 rounded-2xl relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 text-center",children:_?w?s.jsx("div",{className:"bg-indigo-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg animate-pulse uppercase font-black",children:"Analyzing Image..."}):B?.success?s.jsxs("div",{className:"bg-green-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black flex items-center gap-2",children:[s.jsx(Od,{className:"w-3 h-3"})," Found: ",B.name]}):B?.error?s.jsx("div",{className:"bg-red-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black",children:B.error}):s.jsx("p",{className:"text-white/60 text-[10px] px-3 py-1 bg-black/40 rounded-full backdrop-blur-sm",children:"Align Set Code & Number"}):s.jsxs("div",{className:"bg-black/80 text-white text-[10px] px-3 py-1 rounded-full border border-white/10 flex items-center gap-2",children:[s.jsx(tj,{className:"w-3 h-3 animate-spin"})," Wake up AI engine..."]})})]})})]}),s.jsxs("div",{className:"mt-8 flex items-center gap-6",children:[T?s.jsxs("div",{className:"flex flex-col items-center gap-6 animate-fade-in",children:[s.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-2xl",children:s.jsx(ZQ,{value:`${window.location.origin}/remote/${$}`,size:180,level:"H"})}),s.jsxs("div",{className:"text-center max-w-xs",children:[s.jsx("h3",{className:"text-white font-bold mb-1",children:"Scan this QR on your phone"}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest leading-relaxed",children:"Your phone will act as a remote scanner and push cards directly to this desk."})]}),k&&s.jsxs("div",{className:"flex items-center gap-2 bg-green-500/10 text-green-400 px-4 py-2 rounded-full text-[10px] font-black uppercase border border-green-500/30 animate-bounce",children:[s.jsx(IA,{className:"w-4 h-4"}),"Phone Linked!"]})]}):s.jsxs("button",{onClick:re,disabled:w||!_,className:"w-20 h-20 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-800 disabled:text-gray-600 text-white rounded-full flex items-center justify-center shadow-2xl shadow-indigo-500/30 transition-all active:scale-90 relative group ring-4 ring-white/5",children:[w?s.jsx(tj,{className:"w-8 h-8 animate-spin"}):s.jsx(AA,{className:"w-8 h-8"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-500 group-hover:text-indigo-400 transition-colors",children:"Capture Card"})]}),R&&Y.footer&&s.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-black/40 rounded-2xl border border-orange-500/20 max-w-[200px]",children:[s.jsxs("div",{className:"text-[10px] font-black uppercase text-orange-400 tracking-widest flex items-center gap-2",children:[s.jsx(J5,{className:"w-3 h-3"}),"ROI Crops"]}),s.jsx("div",{className:"flex flex-col gap-2",children:s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:Y.footer,className:"h-8 w-full object-contain bg-white rounded border border-white/10",alt:"Footer"}),s.jsx("div",{className:"absolute top-0 right-0 bg-black/60 text-white text-[8px] px-1 rounded-bl",children:"Footer"})]})}),B?.error&&s.jsx("div",{className:"mt-2 pt-2 border-t border-white/10",children:s.jsxs("p",{className:"text-[8px] text-gray-400 font-mono break-all leading-tight",children:["RAW: ",B.raw||"---"]})})]}),!T&&s.jsxs("button",{onClick:()=>g.current?.click(),disabled:w||!_,className:"w-14 h-14 bg-gray-800 hover:bg-gray-700 disabled:text-gray-600 text-gray-400 rounded-2xl flex items-center justify-center border border-white/5 transition-all active:scale-90 relative group",title:"Upload Image",children:[s.jsx(rwe,{className:"w-6 h-6"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-600 group-hover:text-indigo-400 transition-colors",children:"Upload File"})]})]}),s.jsx("input",{type:"file",ref:g,onChange:se,accept:"image/*",className:"hidden"}),R&&s.jsx(y5e,{})]}),l==="review"&&s.jsx("div",{className:"h-full flex flex-col bg-gray-950/50",children:I.length===0?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-3xl flex items-center justify-center text-gray-600 mb-4",children:s.jsx(d2e,{className:"w-10 h-10"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Cards Scanned"}),s.jsx("p",{className:"text-gray-500 text-sm max-w-xs",children:"Return to the scan view and aim your camera at a card to get started."}),s.jsx("button",{onClick:()=>c("scanning"),className:"mt-6 px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold",children:"Go Back to Scan"})]}):s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0 md:p-6",children:s.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[s.jsx("thead",{className:"hidden md:table-header-group",children:s.jsxs("tr",{className:"text-[10px] uppercase font-bold tracking-[0.2em] text-gray-500",children:[s.jsx("th",{className:"px-6 py-2",children:"Card Detail"}),s.jsx("th",{className:"px-6 py-2",children:"Set / #"}),s.jsx("th",{className:"px-6 py-2",children:"Finish"}),s.jsx("th",{className:"px-6 py-2",children:"Qty"}),s.jsx("th",{className:"px-6 py-2 text-right",children:"Action"})]})}),s.jsx("tbody",{className:"space-y-4",children:I.map(oe=>s.jsxs("tr",{className:"bg-gray-900 border border-white/5 md:border-none rounded-2xl md:rounded-none group hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"px-4 py-3 md:px-6 md:py-4 flex items-center gap-4",children:[s.jsx("img",{src:oe.image,className:"w-12 h-16 object-cover rounded shadow-lg",alt:oe.name}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:oe.name}),s.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5",children:oe.set_name})]})]}),s.jsx("td",{className:"hidden md:table-cell px-6 py-4",children:s.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[s.jsxs("select",{value:oe.scryfall_id,onChange:ne=>de(oe.id,ne.target.value),className:"bg-gray-800 border border-white/10 rounded-lg px-2 py-1 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 truncate",children:[oe.variants?.map(ne=>s.jsxs("option",{value:ne.id,children:[ne.set.toUpperCase()," #",ne.collector_number," (",ne.set_name,")"]},ne.id)),!oe.variants?.length&&s.jsxs("option",{value:oe.scryfall_id,children:[oe.set_code.toUpperCase()," #",oe.collector_number]})]}),s.jsx("span",{className:"text-[9px] text-gray-600 mt-1 uppercase tracking-tighter",children:"Tap to change version"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsx("button",{onClick:()=>Z(oe.id,{finish:oe.finish==="foil"?"nonfoil":"foil"}),className:`text-[10px] px-2 py-1 rounded border transition-all ${oe.finish==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 font-bold shadow-[0_0_10px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500"}`,children:oe.finish==="foil"?" FOIL":"NON-FOIL"})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>Z(oe.id,{quantity:Math.max(1,oe.quantity-1)}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"-"}),s.jsx("span",{className:"text-sm font-bold text-white w-4 text-center",children:oe.quantity}),s.jsx("button",{onClick:()=>Z(oe.id,{quantity:oe.quantity+1}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"+"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>Z(oe.id,{is_wishlist:!oe.is_wishlist}),className:`p-1.5 rounded-lg transition-all ${oe.is_wishlist?"bg-red-500/10 text-red-500":"bg-gray-800/50 text-gray-500 hover:text-red-400"}`,title:oe.is_wishlist?"Remove from Wishlist":"Add to Wishlist",children:s.jsx(c2e,{className:`w-4 h-4 ${oe.is_wishlist?"fill-current":""}`})}),s.jsx("button",{onClick:()=>W(oe.id),className:"p-1.5 text-gray-600 hover:text-red-500 transition-colors",children:s.jsx(OQ,{className:"w-4 h-4"})})]})})]},oe.id))})]})})})]}),s.jsxs("div",{className:"p-6 border-t border-white/5 bg-gray-900/80 flex justify-between items-center",children:[s.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em]",children:[I.length," Cards in Batch"]}),s.jsxs("div",{className:"flex gap-2",children:[I.length>0&&l==="scanning"&&s.jsx("button",{onClick:()=>c("review"),className:"px-6 py-2 text-gray-400 hover:text-white font-bold text-xs",children:"Review All"}),s.jsxs("button",{onClick:be,disabled:I.length===0,className:`px-10 py-3 rounded-2xl font-black text-sm transition-all shadow-xl active:scale-95 flex items-center gap-2 ${I.length>0?"bg-indigo-600 text-white shadow-indigo-900/40":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:[s.jsx(Od,{className:"w-4 h-4"})," ",n==="audit"?"Apply to Audit":"Add to Collection"]})]})]}),s.jsx("canvas",{ref:m,style:{display:"none"}})]})}),document.body):null},v5e=(t,e,r=[])=>{if(t.key.toLowerCase()!==e.toLowerCase())return!1;const n=r.includes("ctrl")||r.includes("meta"),i=r.includes("shift"),a=r.includes("alt");return!((t.ctrlKey||t.metaKey)!==n||t.shiftKey!==i||t.altKey!==a)};function eJ(t=[],e={}){const{enabled:r=!0,target:n}=e,i=y.useCallback(a=>{if(r)for(const o of t){const{key:l,modifiers:c=[],action:u,preventDefault:h=!0}=o;if(v5e(a,l,c)){h&&a.preventDefault(),u(a);return}}},[t,r]);y.useEffect(()=>{const a=n?.current||window;return a.addEventListener("keydown",i),()=>a.removeEventListener("keydown",i)},[i,n])}const w5e=()=>{const t=Mo(),{currentUser:e,userProfile:r,logout:n,updateSettings:i,refreshUserProfile:a,uploadProfilePicture:o}=Or(),{addToast:l}=jn(),c=t.pathname==="/",[u,h]=y.useState(!1),[p,m]=y.useState(!1),[g,b]=y.useState(!1),[v,w]=y.useState(!1),[j,_]=y.useState(!1),[E,I]=y.useState(!1),[O,B]=y.useState(!1),[S,T]=y.useState(!1),[M,$]=y.useState(!1),[k,L]=y.useState(!1),R=Pe.useRef(null);eJ([{key:"k",modifiers:["ctrl"],action:()=>h(!0)},{key:"/",modifiers:["ctrl"],action:()=>I(!0)}]),Pe.useEffect(()=>{const W=Z=>{O&&!Z.target.closest("#user-menu-button")&&!Z.target.closest("#user-menu-dropdown")&&B(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[O]);const V=async W=>{console.log("Saving new playstyle:",W),await i({playstyle:W}),await a(),w(!0)},Y=async W=>{const Z=W.target.files[0];if(Z){console.log("[Navbar] Starting file upload:",Z.name,Z.size,Z.type);try{T(!0),console.log("[Navbar] Calling uploadProfilePicture...");const de=await o(Z);console.log("[Navbar] Upload successful! Photo URL:",de),alert("Profile picture updated successfully!")}catch(de){console.error("[Navbar] Upload failed:",de),alert(`Upload failed: ${de.message}`)}finally{console.log("[Navbar] Upload complete, resetting state"),T(!1),B(!1)}}},X=()=>{R.current?.click()},J=e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",re=J?"FORGE MASTER":e?.email||"";let se=null;const ee=r?.subscription_tier;if(ee&&ee!=="free"){const W=Vs[ee];W&&(se={icon:"",label:W.name,color:"text-blue-400 border-blue-500/30 bg-blue-500/10"},ee===nr.TIER_1&&(se={icon:"",label:"Apprentice",color:"text-blue-400 border-blue-500/30 bg-blue-500/10"}),ee===nr.TIER_2&&(se={icon:"",label:"Magician",color:"text-purple-400 border-purple-500/30 bg-purple-500/10"}),ee===nr.TIER_3&&(se={icon:"",label:"Wizard",color:"text-yellow-400 border-yellow-500/30 bg-yellow-500/10"}),ee===nr.TIER_4&&(se={icon:"",label:"Archmage",color:"text-orange-400 border-orange-500/30 bg-orange-500/10"}),ee===nr.TIER_5&&(se={icon:"",label:"Planeswalker",color:"text-red-400 border-red-500/30 bg-red-500/10"}))}const q=J?{icon:"",label:"Architect",color:"text-amber-500 bg-amber-500/20 border-amber-500/50"}:se||r?.settings?.badge||{icon:"",label:"Alpha Tester",color:"text-gray-400 bg-gray-800 border-gray-700"},U=async()=>{try{await n(),window.location.href="/"}catch(W){console.error("Logout failed",W)}};return s.jsxs(s.Fragment,{children:[s.jsx("nav",{className:"bg-gray-950/30 backdrop-blur-2xl border-b border-white/5 sticky top-0 z-50",children:s.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsx("div",{className:"flex-shrink-0 flex items-center gap-3",children:s.jsxs(Er,{to:"/",className:"flex items-center gap-3 transform hover:scale-105 transition-transform",children:[s.jsx("img",{src:"/logo.png",alt:"MTG Forge Logo",className:"h-10 w-auto"}),s.jsxs("div",{className:"flex flex-col gap-1 sm:hidden",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none",children:"ALPHA"}),ee&&ee!=="free"&&(()=>{const W=Vs[ee];let Z="text-gray-400 border-gray-600 bg-gray-800";return ee===nr.TIER_1&&(Z="text-blue-400 border-blue-500/30 bg-blue-500/10"),ee===nr.TIER_2&&(Z="text-purple-400 border-purple-500/30 bg-purple-500/10"),ee===nr.TIER_3&&(Z="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),ee===nr.TIER_4&&(Z="text-orange-400 border-orange-500/30 bg-orange-500/10"),ee===nr.TIER_5&&(Z="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase w-fit ${Z}`,children:W?.name||"MEMBER"})})()]}),s.jsxs("div",{className:"hidden sm:flex flex-col justify-center",children:[s.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent leading-none pb-1",children:"MTG-Forge"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none",children:"ALPHA"}),ee&&ee!=="free"&&(()=>{const W=Vs[ee];let Z="text-gray-400 border-gray-600 bg-gray-800";return ee===nr.TIER_1&&(Z="text-blue-400 border-blue-500/30 bg-blue-500/10"),ee===nr.TIER_2&&(Z="text-purple-400 border-purple-500/30 bg-purple-500/10"),ee===nr.TIER_3&&(Z="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),ee===nr.TIER_4&&(Z="text-orange-400 border-orange-500/30 bg-orange-500/10"),ee===nr.TIER_5&&(Z="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase ${Z}`,children:W?.name||"MEMBER"})})()]})]})]})}),s.jsx("div",{className:"hidden lg:ml-6 lg:flex lg:items-baseline lg:space-x-1",children:e?s.jsxs(s.Fragment,{children:[s.jsx(Er,{to:"/dashboard",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Dashboard"}),s.jsx(Er,{to:"/collection",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Collection"}),s.jsx(Er,{to:"/wishlist",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Wishlist"}),s.jsx(Er,{to:"/decks",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Decks"}),s.jsx(Er,{to:"/binders",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Binders"}),s.jsx(Er,{to:"/social",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Social"}),s.jsx(Er,{to:"/precons",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Precons"}),s.jsx(Er,{to:"/sets",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Sets"})]}):s.jsx(s.Fragment,{children:c?s.jsxs(s.Fragment,{children:[s.jsx("a",{href:"#features",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Features"}),s.jsx(Er,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})]}):s.jsx(s.Fragment,{children:s.jsx(Er,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})})})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>h(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20 flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"hidden xl:inline",children:"Add Card"})]}),s.jsx("button",{onClick:()=>I(!0),className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 hover:border-indigo-500 hover:text-white text-gray-400 flex items-center justify-center transition-all shadow-lg",title:"Help Center",children:s.jsx("span",{className:"font-bold text-lg",children:"?"})})]}),e?s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>_(!0),className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all group relative ${q.color||"bg-gray-800 border-gray-700 hover:bg-gray-700"}`,title:q.label||"Change Badge",children:[s.jsx("span",{className:"text-base",children:q.icon}),J&&s.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),s.jsx("span",{className:`text-sm font-medium hidden xl:inline-block ${J?"text-amber-400 font-bold tracking-wider":"text-gray-300 max-w-[150px] truncate"}`,children:re}),s.jsx("button",{id:"user-menu-button",onClick:()=>B(!O),className:"text-gray-400 hover:text-white transition-colors focus:outline-none",children:e.photoURL&&!k?s.jsx("img",{src:e.photoURL,alt:"Profile",className:"h-8 w-8 rounded-full object-cover ring-2 ring-transparent hover:ring-indigo-500 transition-all border border-gray-600",onError:()=>L(!0)}):s.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 border border-indigo-500/50 flex items-center justify-center ring-2 ring-transparent hover:ring-indigo-500 transition-all",children:s.jsx("span",{className:"text-xs font-bold text-indigo-300",children:e.email?e.email[0].toUpperCase():"U"})})})]}),O&&s.jsxs("div",{id:"user-menu-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 border border-gray-700 ring-1 ring-black ring-opacity-5 animate-fade-in-up",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[s.jsx("p",{className:"text-sm text-white font-bold",children:"Account"}),s.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.email})]}),s.jsx("button",{onClick:X,disabled:S,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:S?"Uploading...":"Upload Photo"}),s.jsx("input",{type:"file",ref:R,onChange:Y,className:"hidden",accept:"image/*"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{B(!1),w(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Playstyle Profile"}),s.jsx(Er,{to:"/settings",onClick:()=>B(!1),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Settings"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsxs("button",{onClick:()=>{B(!1),$(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-cyan-400",children:""})," History"]}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{B(!1),U()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300",children:"Sign Out"})]})]}):s.jsx(Er,{to:"/login",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Sign In"})]})]})})})}),s.jsx(II,{isOpen:u,onClose:()=>h(!1),onOpenForgeLens:()=>{h(!1),m(!0)}}),s.jsx(sk,{isOpen:p,onClose:()=>m(!1),onFinish:async(W,Z={})=>{if(!W||W.length===0)return;const de=Z.targetDeckId?`deck:${Z.targetDeckId}`:"collection",be=W.map(oe=>({scryfall_id:oe.scryfall_id,name:oe.name,set_code:oe.set_code,collector_number:oe.collector_number,finish:oe.finish,quantity:oe.quantity,is_foil:oe.finish==="foil"}));try{console.log("[Navbar] Adding batch via Forge Lens:",be,de),await Ge.batchAddToCollection(be,de),l(`Successfully added ${W.length} cards via Forge Lens!`,"success"),m(!1)}catch(oe){console.error("Batch add failed",oe),l(`Failed to add cards: ${oe.message}`,"error")}}}),s.jsx(fX,{isOpen:g,onClose:()=>b(!1),onComplete:V}),s.jsx(Rxe,{isOpen:v,onClose:()=>w(!1),profile:r?.settings?.playstyle,userImage:e?.photoURL,onRetake:()=>{w(!1),b(!0)}}),s.jsx(Bxe,{isOpen:j,onClose:()=>_(!1),currentBadgeId:r?.settings?.badge?.id||"alpha_tester",isMaster:e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",onSelect:async W=>{await i({badge:W}),await a(),_(!1)}}),s.jsx(N7,{isOpen:M,onClose:()=>$(!1)}),!c&&s.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-gray-900 border-t border-gray-800 z-50 pb-safe",children:s.jsxs("div",{className:"flex justify-around items-center h-16",children:[s.jsxs(Er,{to:"/dashboard",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/dashboard"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Home"})]}),s.jsxs(Er,{to:"/collection",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/collection"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Collection"})]}),s.jsxs(Er,{to:"/wishlist",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/wishlist"?"text-orange-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Wishlist"})]}),s.jsxs(Er,{to:"/decks",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/decks")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Decks"})]}),s.jsxs(Er,{to:"/social",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/social"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Social"})]}),s.jsxs(Er,{to:"/precons",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/precons")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Precons"})]}),s.jsxs(Er,{to:"/sets",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/sets")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Sets"})]}),s.jsxs(Er,{to:"/settings",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/settings"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Settings"})]})]})}),s.jsx(N7,{isOpen:M,onClose:()=>$(!1)}),s.jsx(Jve,{isOpen:E,onClose:()=>I(!1),onStartTour:()=>window.dispatchEvent(new Event("start-tour")),onOpenChat:()=>{window.dispatchEvent(new Event("open-chat-widget"))}})]})},eL=({isOpen:t,onClose:e})=>t?Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Binder Management Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Organize your collection like a pro."})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Two Ways to Build"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsxs("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:[" Manual Binder ",s.jsx("span",{className:"text-[9px] bg-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Magician Tier"})]}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Classic storage. You drag and drop exactly which cards go inside. Great for mirroring your physical binders."})]}),s.jsxs("div",{className:"bg-indigo-900/10 p-4 rounded-2xl border border-indigo-500/20",children:[s.jsxs("h4",{className:"text-indigo-300 font-bold mb-1 flex items-center gap-2",children:[" Smart Binder ",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Free & Up"})]}),s.jsx("p",{className:"text-xs text-indigo-200/60 leading-relaxed",children:'Live automation. You set rules (like "Price > $10"), and the binder automatically grabs matching cards from your collection.'})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"AI Smart Creator"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:"Don't want to build rules manually? Just describe what you want in plain English!"}),s.jsxs("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30 mb-4",children:[s.jsx("p",{className:"font-mono text-xs text-gray-400 mb-2",children:"Try prompts like:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-indigo-300 font-medium",children:[s.jsx("li",{children:'"All my red goblins over $5"'}),s.jsx("li",{children:'"Cards to trade that I have duplicates of"'}),s.jsx("li",{children:'"High value commanders not in any decks"'})]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"The AI detects price, color, type, quantity, rarity, and even whether a card is currently used in a deck."})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Advanced Logic (In Deck, Quantity)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"In Deck Status"}),s.jsxs("p",{className:"text-xs text-gray-400",children:['Filter cards based on usage. Create a "Trade Binder" by excluding cards that are currently ',s.jsx("span",{className:"text-white font-mono",children:"In Deck = True"}),"."]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"Quantity Control"}),s.jsxs("p",{className:"text-xs text-gray-400",children:["Filter by how many copies you own. Great for finding ",s.jsx("span",{className:"text-white font-mono",children:"Count > 4"})," (Duplicates)."]})]})]})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Custom Style"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use any Hex Code color and pick from hundreds of icons (including MTG Mana Symbols) to make your binder pop."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Live Updates"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Smart Binders are alive. When you add a new card to your collection that matches the rules, it instantly appears in the binder."})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it!"})})]})]}),document.body):null,tJ=({isOpen:t,onClose:e})=>t?Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-purple-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-500/20 rounded-xl text-purple-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["For Pods & Permissions.",s.jsx("span",{className:"text-[9px] bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded uppercase tracking-wider border border-purple-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{className:"text-white",children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsxs("div",{className:"bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/20 flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("p",{className:"text-xs text-indigo-300 font-bold",children:"Pro Tip: Only add people you actually know and trust to your Pod."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-blue-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-blue-400 tracking-wider mb-2 block",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Private Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Download/Clone Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Edit Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-purple-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-purple-400 tracking-wider mb-2 block",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Editor"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Everything in Viewer"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-white font-bold",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add/Remove Cards ",s.jsx("span",{className:"font-normal text-gray-400 ml-1",children:"from Decks"})]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-green-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add Cards to Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-white ring-2 ring-indigo-500",children:"You"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P2"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P3"})]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-widest",children:"Collaborative Deck Building"})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it, thanks!"})})]})]}),document.body):null;var N5e=Object.defineProperty,sj=Object.getOwnPropertySymbols,rJ=Object.prototype.hasOwnProperty,nJ=Object.prototype.propertyIsEnumerable,RB=(t,e,r)=>e in t?N5e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,UA=(t,e)=>{for(var r in e||(e={}))rJ.call(e,r)&&RB(t,r,e[r]);if(sj)for(var r of sj(e))nJ.call(e,r)&&RB(t,r,e[r]);return t},zA=(t,e)=>{var r={};for(var n in t)rJ.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&sj)for(var n of sj(t))e.indexOf(n)<0&&nJ.call(t,n)&&(r[n]=t[n]);return r};var dm;(t=>{const e=class Nn{constructor(c,u,h,p){if(this.version=c,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],c<Nn.MIN_VERSION||c>Nn.MAX_VERSION)throw new RangeError("Version value out of range");if(p<-1||p>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let m=[];for(let b=0;b<this.size;b++)m.push(!1);for(let b=0;b<this.size;b++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(h);if(this.drawCodewords(g),p==-1){let b=1e9;for(let v=0;v<8;v++){this.applyMask(v),this.drawFormatBits(v);const w=this.getPenaltyScore();w<b&&(p=v,b=w),this.applyMask(v)}}i(0<=p&&p<=7),this.mask=p,this.applyMask(p),this.drawFormatBits(p),this.isFunction=[]}static encodeText(c,u){const h=t.QrSegment.makeSegments(c);return Nn.encodeSegments(h,u)}static encodeBinary(c,u){const h=t.QrSegment.makeBytes(c);return Nn.encodeSegments([h],u)}static encodeSegments(c,u,h=1,p=40,m=-1,g=!0){if(!(Nn.MIN_VERSION<=h&&h<=p&&p<=Nn.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let b,v;for(b=h;;b++){const E=Nn.getNumDataCodewords(b,u)*8,I=o.getTotalBits(c,b);if(I<=E){v=I;break}if(b>=p)throw new RangeError("Data too long")}for(const E of[Nn.Ecc.MEDIUM,Nn.Ecc.QUARTILE,Nn.Ecc.HIGH])g&&v<=Nn.getNumDataCodewords(b,E)*8&&(u=E);let w=[];for(const E of c){r(E.mode.modeBits,4,w),r(E.numChars,E.mode.numCharCountBits(b),w);for(const I of E.getData())w.push(I)}i(w.length==v);const j=Nn.getNumDataCodewords(b,u)*8;i(w.length<=j),r(0,Math.min(4,j-w.length),w),r(0,(8-w.length%8)%8,w),i(w.length%8==0);for(let E=236;w.length<j;E^=253)r(E,8,w);let _=[];for(;_.length*8<w.length;)_.push(0);return w.forEach((E,I)=>_[I>>>3]|=E<<7-(I&7)),new Nn(b,u,_,m)}getModule(c,u){return 0<=c&&c<this.size&&0<=u&&u<this.size&&this.modules[u][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),u=c.length;for(let h=0;h<u;h++)for(let p=0;p<u;p++)h==0&&p==0||h==0&&p==u-1||h==u-1&&p==0||this.drawAlignmentPattern(c[h],c[p]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const u=this.errorCorrectionLevel.formatBits<<3|c;let h=u;for(let m=0;m<10;m++)h=h<<1^(h>>>9)*1335;const p=(u<<10|h)^21522;i(p>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,n(p,m));this.setFunctionModule(8,7,n(p,6)),this.setFunctionModule(8,8,n(p,7)),this.setFunctionModule(7,8,n(p,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,n(p,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,n(p,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,n(p,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let h=0;h<12;h++)c=c<<1^(c>>>11)*7973;const u=this.version<<12|c;i(u>>>18==0);for(let h=0;h<18;h++){const p=n(u,h),m=this.size-11+h%3,g=Math.floor(h/3);this.setFunctionModule(m,g,p),this.setFunctionModule(g,m,p)}}drawFinderPattern(c,u){for(let h=-4;h<=4;h++)for(let p=-4;p<=4;p++){const m=Math.max(Math.abs(p),Math.abs(h)),g=c+p,b=u+h;0<=g&&g<this.size&&0<=b&&b<this.size&&this.setFunctionModule(g,b,m!=2&&m!=4)}}drawAlignmentPattern(c,u){for(let h=-2;h<=2;h++)for(let p=-2;p<=2;p++)this.setFunctionModule(c+p,u+h,Math.max(Math.abs(p),Math.abs(h))!=1)}setFunctionModule(c,u,h){this.modules[u][c]=h,this.isFunction[u][c]=!0}addEccAndInterleave(c){const u=this.version,h=this.errorCorrectionLevel;if(c.length!=Nn.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const p=Nn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],m=Nn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],g=Math.floor(Nn.getNumRawDataModules(u)/8),b=p-g%p,v=Math.floor(g/p);let w=[];const j=Nn.reedSolomonComputeDivisor(m);for(let E=0,I=0;E<p;E++){let O=c.slice(I,I+v-m+(E<b?0:1));I+=O.length;const B=Nn.reedSolomonComputeRemainder(O,j);E<b&&O.push(0),w.push(O.concat(B))}let _=[];for(let E=0;E<w[0].length;E++)w.forEach((I,O)=>{(E!=v-m||O>=b)&&_.push(I[E])});return i(_.length==g),_}drawCodewords(c){if(c.length!=Math.floor(Nn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let p=0;p<this.size;p++)for(let m=0;m<2;m++){const g=h-m,v=(h+1&2)==0?this.size-1-p:p;!this.isFunction[v][g]&&u<c.length*8&&(this.modules[v][g]=n(c[u>>>3],7-(u&7)),u++)}}i(u==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let p;switch(c){case 0:p=(h+u)%2==0;break;case 1:p=u%2==0;break;case 2:p=h%3==0;break;case 3:p=(h+u)%3==0;break;case 4:p=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:p=h*u%2+h*u%3==0;break;case 6:p=(h*u%2+h*u%3)%2==0;break;case 7:p=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&p&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let c=0;for(let m=0;m<this.size;m++){let g=!1,b=0,v=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[m][w]==g?(b++,b==5?c+=Nn.PENALTY_N1:b>5&&c++):(this.finderPenaltyAddHistory(b,v),g||(c+=this.finderPenaltyCountPatterns(v)*Nn.PENALTY_N3),g=this.modules[m][w],b=1);c+=this.finderPenaltyTerminateAndCount(g,b,v)*Nn.PENALTY_N3}for(let m=0;m<this.size;m++){let g=!1,b=0,v=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[w][m]==g?(b++,b==5?c+=Nn.PENALTY_N1:b>5&&c++):(this.finderPenaltyAddHistory(b,v),g||(c+=this.finderPenaltyCountPatterns(v)*Nn.PENALTY_N3),g=this.modules[w][m],b=1);c+=this.finderPenaltyTerminateAndCount(g,b,v)*Nn.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let g=0;g<this.size-1;g++){const b=this.modules[m][g];b==this.modules[m][g+1]&&b==this.modules[m+1][g]&&b==this.modules[m+1][g+1]&&(c+=Nn.PENALTY_N2)}let u=0;for(const m of this.modules)u=m.reduce((g,b)=>g+(b?1:0),u);const h=this.size*this.size,p=Math.ceil(Math.abs(u*20-h*10)/h)-1;return i(0<=p&&p<=9),c+=p*Nn.PENALTY_N4,i(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let h=[6];for(let p=this.size-7;h.length<c;p-=u)h.splice(1,0,p);return h}}static getNumRawDataModules(c){if(c<Nn.MIN_VERSION||c>Nn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*c+128)*c+64;if(c>=2){const h=Math.floor(c/7)+2;u-=(25*h-10)*h-55,c>=7&&(u-=36)}return i(208<=u&&u<=29648),u}static getNumDataCodewords(c,u){return Math.floor(Nn.getNumRawDataModules(c)/8)-Nn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c]*Nn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let u=[];for(let p=0;p<c-1;p++)u.push(0);u.push(1);let h=1;for(let p=0;p<c;p++){for(let m=0;m<u.length;m++)u[m]=Nn.reedSolomonMultiply(u[m],h),m+1<u.length&&(u[m]^=u[m+1]);h=Nn.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(c,u){let h=u.map(p=>0);for(const p of c){const m=p^h.shift();h.push(0),u.forEach((g,b)=>h[b]^=Nn.reedSolomonMultiply(g,m))}return h}static reedSolomonMultiply(c,u){if(c>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let p=7;p>=0;p--)h=h<<1^(h>>>7)*285,h^=(u>>>p&1)*c;return i(h>>>8==0),h}finderPenaltyCountPatterns(c){const u=c[1];i(u<=this.size*3);const h=u>0&&c[2]==u&&c[3]==u*3&&c[4]==u&&c[5]==u;return(h&&c[0]>=u*4&&c[6]>=u?1:0)+(h&&c[6]>=u*4&&c[0]>=u?1:0)}finderPenaltyTerminateAndCount(c,u,h){return c&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(c,u){u[0]==0&&(c+=this.size),u.pop(),u.unshift(c)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(l,c,u){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let h=c-1;h>=0;h--)u.push(l>>>h&1)}function n(l,c){return(l>>>c&1)!=0}function i(l){if(!l)throw new Error("Assertion error")}const a=class qi{constructor(c,u,h){if(this.mode=c,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(c){let u=[];for(const h of c)r(h,8,u);return new qi(qi.Mode.BYTE,c.length,u)}static makeNumeric(c){if(!qi.isNumeric(c))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<c.length;){const p=Math.min(c.length-h,3);r(parseInt(c.substring(h,h+p),10),p*3+1,u),h+=p}return new qi(qi.Mode.NUMERIC,c.length,u)}static makeAlphanumeric(c){if(!qi.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=c.length;h+=2){let p=qi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h))*45;p+=qi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h+1)),r(p,11,u)}return h<c.length&&r(qi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h)),6,u),new qi(qi.Mode.ALPHANUMERIC,c.length,u)}static makeSegments(c){return c==""?[]:qi.isNumeric(c)?[qi.makeNumeric(c)]:qi.isAlphanumeric(c)?[qi.makeAlphanumeric(c)]:[qi.makeBytes(qi.toUtf8ByteArray(c))]}static makeEci(c){let u=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,u);else if(c<16384)r(2,2,u),r(c,14,u);else if(c<1e6)r(6,3,u),r(c,21,u);else throw new RangeError("ECI assignment value out of range");return new qi(qi.Mode.ECI,0,u)}static isNumeric(c){return qi.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return qi.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,u){let h=0;for(const p of c){const m=p.mode.numCharCountBits(u);if(p.numChars>=1<<m)return 1/0;h+=4+m+p.bitData.length}return h}static toUtf8ByteArray(c){c=encodeURI(c);let u=[];for(let h=0;h<c.length;h++)c.charAt(h)!="%"?u.push(c.charCodeAt(h)):(u.push(parseInt(c.substring(h+1,h+3),16)),h+=2);return u}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=a;t.QrSegment=a})(dm||(dm={}));(t=>{(e=>{const r=class{constructor(i,a){this.ordinal=i,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(dm||(dm={}));(t=>{(e=>{const r=class{constructor(i,a){this.modeBits=i,this.numBitsCharCount=a}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(dm||(dm={}));var ax=dm;var j5e={L:ax.QrCode.Ecc.LOW,M:ax.QrCode.Ecc.MEDIUM,Q:ax.QrCode.Ecc.QUARTILE,H:ax.QrCode.Ecc.HIGH},sJ=128,iJ="L",aJ="#FFFFFF",oJ="#000000",lJ=!1,cJ=1,k5e=4,_5e=0,S5e=.1;function uJ(t,e=0){const r=[];return t.forEach(function(n,i){let a=null;n.forEach(function(o,l){if(!o&&a!==null){r.push(`M${a+e} ${i+e}h${l-a}v1H${a+e}z`),a=null;return}if(l===n.length-1){if(!o)return;a===null?r.push(`M${l+e},${i+e} h1v1H${l+e}z`):r.push(`M${a+e},${i+e} h${l+1-a}v1H${a+e}z`);return}o&&a===null&&(a=l)})}),r.join("")}function dJ(t,e){return t.slice().map((r,n)=>n<e.y||n>=e.y+e.h?r:r.map((i,a)=>a<e.x||a>=e.x+e.w?i:!1))}function C5e(t,e,r,n){if(n==null)return null;const i=t.length+r*2,a=Math.floor(e*S5e),o=i/e,l=(n.width||a)*o,c=(n.height||a)*o,u=n.x==null?t.length/2-l/2:n.x*o,h=n.y==null?t.length/2-c/2:n.y*o,p=n.opacity==null?1:n.opacity;let m=null;if(n.excavate){let b=Math.floor(u),v=Math.floor(h),w=Math.ceil(l+u-b),j=Math.ceil(c+h-v);m={x:b,y:v,w,h:j}}const g=n.crossOrigin;return{x:u,y:h,h:c,w:l,excavation:m,opacity:p,crossOrigin:g}}function E5e(t,e){return e!=null?Math.max(Math.floor(e),0):t?k5e:_5e}function hJ({value:t,level:e,minVersion:r,includeMargin:n,marginSize:i,imageSettings:a,size:o,boostLevel:l}){let c=Pe.useMemo(()=>{const b=(Array.isArray(t)?t:[t]).reduce((v,w)=>(v.push(...ax.QrSegment.makeSegments(w)),v),[]);return ax.QrCode.encodeSegments(b,j5e[e],r,void 0,void 0,l)},[t,e,r,l]);const{cells:u,margin:h,numCells:p,calculatedImageSettings:m}=Pe.useMemo(()=>{let g=c.getModules();const b=E5e(n,i),v=g.length+b*2,w=C5e(g,o,b,a);return{cells:g,margin:b,numCells:v,calculatedImageSettings:w}},[c,o,a,n,i]);return{qrcode:c,margin:h,cells:u,numCells:p,calculatedImageSettings:m}}var A5e=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),T5e=Pe.forwardRef(function(e,r){const n=e,{value:i,size:a=sJ,level:o=iJ,bgColor:l=aJ,fgColor:c=oJ,includeMargin:u=lJ,minVersion:h=cJ,boostLevel:p,marginSize:m,imageSettings:g}=n,v=zA(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:w}=v,j=zA(v,["style"]),_=g?.src,E=Pe.useRef(null),I=Pe.useRef(null),O=Pe.useCallback(V=>{E.current=V,typeof r=="function"?r(V):r&&(r.current=V)},[r]),[B,S]=Pe.useState(!1),{margin:T,cells:M,numCells:$,calculatedImageSettings:k}=hJ({value:i,level:o,minVersion:h,boostLevel:p,includeMargin:u,marginSize:m,imageSettings:g,size:a});Pe.useEffect(()=>{if(E.current!=null){const V=E.current,Y=V.getContext("2d");if(!Y)return;let X=M;const J=I.current,re=k!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;re&&k.excavation!=null&&(X=dJ(M,k.excavation));const se=window.devicePixelRatio||1;V.height=V.width=a*se;const ee=a/$*se;Y.scale(ee,ee),Y.fillStyle=l,Y.fillRect(0,0,$,$),Y.fillStyle=c,A5e?Y.fill(new Path2D(uJ(X,T))):M.forEach(function(q,U){q.forEach(function(W,Z){W&&Y.fillRect(Z+T,U+T,1,1)})}),k&&(Y.globalAlpha=k.opacity),re&&Y.drawImage(J,k.x+T,k.y+T,k.w,k.h)}}),Pe.useEffect(()=>{S(!1)},[_]);const L=UA({height:a,width:a},w);let R=null;return _!=null&&(R=Pe.createElement("img",{src:_,key:_,style:{display:"none"},onLoad:()=>{S(!0)},ref:I,crossOrigin:k?.crossOrigin})),Pe.createElement(Pe.Fragment,null,Pe.createElement("canvas",UA({style:L,height:a,width:a,ref:O,role:"img"},j)),R)});T5e.displayName="QRCodeCanvas";var ik=Pe.forwardRef(function(e,r){const n=e,{value:i,size:a=sJ,level:o=iJ,bgColor:l=aJ,fgColor:c=oJ,includeMargin:u=lJ,minVersion:h=cJ,boostLevel:p,title:m,marginSize:g,imageSettings:b}=n,v=zA(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:w,cells:j,numCells:_,calculatedImageSettings:E}=hJ({value:i,level:o,minVersion:h,boostLevel:p,includeMargin:u,marginSize:g,imageSettings:b,size:a});let I=j,O=null;b!=null&&E!=null&&(E.excavation!=null&&(I=dJ(j,E.excavation)),O=Pe.createElement("image",{href:b.src,height:E.h,width:E.w,x:E.x+w,y:E.y+w,preserveAspectRatio:"none",opacity:E.opacity,crossOrigin:E.crossOrigin}));const B=uJ(I,w);return Pe.createElement("svg",UA({height:a,width:a,viewBox:`0 0 ${_} ${_}`,ref:r,role:"img"},v),!!m&&Pe.createElement("title",null,m),Pe.createElement("path",{fill:l,d:`M0,0 h${_}v${_}H0z`,shapeRendering:"crispEdges"}),Pe.createElement("path",{fill:c,d:B,shapeRendering:"crispEdges"}),O)});ik.displayName="QRCodeSVG";const I5e=({isOpen:t,onClose:e})=>{if(!t)return null;const r="https://mtg-forge.com/share/heir-to-the-hysteria-x26l";return Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-10 w-full max-w-md bg-gray-900 border border-white/10 rounded-3xl overflow-hidden shadow-2xl animate-fade-in-up",children:[s.jsxs("div",{className:"p-6 pb-2 text-center",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Scan to view deck list instantly"})]}),s.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[s.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:s.jsx(ik,{value:r,size:200,level:"H",includeMargin:!1})}),s.jsxs("div",{className:"w-full text-center space-y-3",children:[s.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-xl p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 text-left",children:"Share Link"}),s.jsx("p",{className:"text-xs text-indigo-300 font-mono truncate text-left select-all",children:r})]}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(r),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Copy",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Anyone with this link can view the full deck list and statistics."})]})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/50 flex justify-center",children:s.jsx("button",{onClick:()=>window.open(r,"_blank"),className:"text-indigo-400 hover:text-white text-sm font-bold transition-colors",children:"Open Link in New Tab "})})]})]}),document.body)},tL=({isOpen:t,onClose:e})=>t?Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Audit & Verification Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["Audit The Forge to verify your collection.",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider border border-green-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Neutral Starting State"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:'Every card starts in a "pending" state. We assume your collection matches your records until you verify it.'}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:" Pending"}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Gray border. The input is locked. You must choose to Match or flag a Mismatch to continue."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"2"}),"Quick Verification"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-green-900/10 p-4 rounded-2xl border border-green-500/20",children:[s.jsx("h4",{className:"text-green-300 font-bold mb-1 flex items-center gap-2",children:" Match (Check)"}),s.jsx("p",{className:"text-xs text-green-200/60 leading-relaxed",children:"Instantly marks the card as reviewed and verified. Confirms you have exactly the expected amount."})]}),s.jsxs("div",{className:"bg-red-900/10 p-4 rounded-2xl border border-red-500/20",children:[s.jsx("h4",{className:"text-red-300 font-bold mb-1 flex items-center gap-2",children:" Mismatch (X)"}),s.jsx("p",{className:"text-xs text-red-200/60 leading-relaxed",children:"Flags a discrepancy. Sets count to 0 and unlocks the input so you can type the correct physical count."})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"3"}),"Finalizing Your Audit"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`Once you've touched every card in a section (Deck or Set), mark it as "Finished".`}),s.jsx("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30",children:s.jsx("p",{className:"text-xs text-indigo-300 font-medium",children:"When the entire audit is complete, use the **Finalize Audit** button in the Hub. This will sync all your Mismatches to your actual collection database, ensuring your digital records match your physical boxes."})})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Discrepancy Report"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use the report table in the Audit Hub to see exactly what changed before you finalize."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Mobile Friendly"}),s.jsx("p",{className:"text-xs text-gray-300",children:"The Audit Wizard is optimized for phone use. Carry your phone to your bulk boxes for easy scanning!"})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Start Auditing"})})]})]}),document.body):null,L5e=()=>{const[t,e]=y.useState(null);return s.jsxs("section",{id:"features",className:"py-32 bg-transparent relative",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-24 animate-fade-in-up",children:[s.jsx("span",{className:"text-indigo-400 font-bold tracking-widest uppercase text-sm mb-2 block",children:"The Forge Advantage"}),s.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white mb-6 leading-tight",children:["Actionable Intelligence.",s.jsx("br",{}),"Professional Results."]}),s.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto text-xl italic",children:'"Stop tracking cards. Start forging strategy."'})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-orange-500/20 rounded-3xl flex items-center justify-center mb-4 text-orange-400 ring-1 ring-orange-500/20",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"AI Deck Doctor",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The AI Deck Doctor"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["Precision meets playability. Our surgical analysis engine provides a precise ",s.jsx("span",{className:"text-white",children:"1-5 Bracket Rating"}),', a granular 10-point power score, and card-for-card "Surgical Swaps" to optimize your curve.']}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-orange-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Brackets"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"1-5 Scale"})]}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-green-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Precision"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"0.01 PL Step"})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(249,115,22,0.3)] border border-orange-500/20 group animate-fade-in-right bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Calculated Power"}),s.jsx("div",{className:"text-5xl font-black text-white italic",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-orange-500/20 rounded-lg border border-orange-500/30 text-orange-400 font-black uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 via-amber-400 to-orange-600 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center mb-4 text-indigo-400 ring-1 ring-indigo-500/20 shadow-[0_0_30px_rgba(79,70,229,0.2)]",children:s.jsx("img",{src:"/icons/the_neural_architect.png",alt:"Neural Architect",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The Neural Architect"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["The first true ",s.jsx("span",{className:"text-white",children:"Zero-to-Hero"})," deck builder. Select your Commander, and watch as the Architect synthesizes a full 100-card list while prioritizing the cards you already own."]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"A"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Commander-Centric Synthesis"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"From your commander selection to a complete 100-card list in seconds."})]})]}),s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"C"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Collection-Aware"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Builds using cards you own first, minimizing proxy needs."})]})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(79,70,229,0.3)] border border-indigo-500/20 group animate-fade-in-left bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-2",children:"Neural Blueprint Generation"}),[{t:"Commander",v:"Selected: Niv-Mizzet, Parun"},{t:"Budget",v:"$50 (Utilizing Collection)"},{t:"Power",v:"Target Bracket 3"}].map((r,n)=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-black/40 rounded-xl border border-white/5",children:[s.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:r.t}),s.jsx("span",{className:"text-xs font-black text-indigo-400",children:r.v})]},n)),s.jsxs("div",{className:"mt-6 pt-6 border-t border-white/10",children:[s.jsxs("div",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Blueprint Complete: 100/100 Cards"]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(8)].map((r,n)=>s.jsx("div",{className:"h-1 bg-indigo-500/40 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-400 w-full animate-shimmer"})},n))})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-3xl flex items-center justify-center mb-4 text-blue-400 ring-1 ring-blue-500/20",children:s.jsx("img",{src:"/icons/ai_strategy_analyst.png",alt:"AI Strategy Analyst",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"AI Strategy Analyst"}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Don't just build listsforge legends. Our Gemini-powered AI acts as a dedicated coach, analyzing synergies and suggesting win conditions tailored to your unique playstyle."}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-blue-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Advisor Analysis"}),s.jsx("div",{className:"text-white text-lg font-bold italic",children:'"Your win rate against Aggro pods increases by 14% with these adjustments."'})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(59,130,246,0.3)] border border-blue-500/20 group animate-fade-in-right",children:s.jsx("img",{src:"/images/features/ai-strategy-modal.png",alt:"AI Strategy Modal",className:"w-full h-auto opacity-80 hover:opacity-100 transition-opacity duration-700"})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-3xl flex items-center justify-center mb-4 text-purple-400 ring-1 ring-purple-500/20",children:s.jsx("img",{src:"/icons/social_pods.png",alt:"Social Pods",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:'Rule Your "Pod"'}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Magic is a social game. Link accounts with your playgroup to browse friends' collections, manage shared trades, and coordinate group power levels instantly."}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("button",{onClick:()=>e("pods"),className:"px-8 py-3 rounded-xl bg-purple-500/10 border border-purple-500/30 text-purple-400 font-bold hover:bg-purple-500/20 transition-all",children:"Explore Pods"}),s.jsx("button",{onClick:()=>e("qr"),className:"px-8 py-3 rounded-xl bg-white/5 border border-white/10 text-white font-bold hover:bg-white/10 transition-all",children:"Quick Share"})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(168,85,247,0.3)] border border-purple-500/20 group animate-fade-in-left bg-gray-950 p-12",children:s.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full h-full",children:[s.jsxs("div",{className:"bg-indigo-900/30 rounded-2xl border border-indigo-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-indigo-300 uppercase tracking-widest",children:"Smart Binder"})]}),s.jsxs("div",{className:"bg-purple-900/30 rounded-2xl border border-purple-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-75",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-purple-300 uppercase tracking-widest",children:"Pod Trade"})]}),s.jsxs("div",{className:"bg-blue-900/30 rounded-2xl border border-blue-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-100",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-blue-300 uppercase tracking-widest",children:"QR Share"})]}),s.jsxs("div",{className:"bg-green-900/30 rounded-2xl border border-green-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-150",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-green-300 uppercase tracking-widest",children:"Audits"})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-4 group cursor-pointer transition-transform hover:scale-110 duration-500",children:s.jsx("img",{src:"/icons/the_professional_foundation.png",alt:"The Professional Foundation",className:"w-20 h-20 object-contain transition-all duration-500 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-3xl font-black text-white leading-tight uppercase tracking-tight",children:"The Professional Foundation"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Underneath the AI intelligence is a robust engine for cataloging your digital life. Fast scanning, accurate pricing, and comprehensive management for any format."})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800/20 group",children:s.jsx("img",{src:"/images/features/collection-dashboard.jpg",alt:"Collection Dashboard",className:"w-full h-full object-cover opacity-40 group-hover:opacity-80 transition-opacity duration-700"})})]})]}),s.jsx(eL,{isOpen:t==="smart",onClose:()=>e(null)}),s.jsx(tJ,{isOpen:t==="pods",onClose:()=>e(null)}),s.jsx(I5e,{isOpen:t==="qr",onClose:()=>e(null)}),s.jsx(tL,{isOpen:t==="audit",onClose:()=>e(null)})]})},P5e=()=>s.jsxs("div",{className:"flex flex-col min-h-screen relative",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center hidden md:block",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-cover bg-center md:hidden",style:{backgroundImage:"url(/MTG-Forge_Logo_Background_mobile.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-gray-950/80 to-black z-10"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[100vw] h-[100vh] bg-indigo-600/10 blur-[150px] rounded-full z-0 opacity-40"}),s.jsx("div",{className:"absolute top-1/4 left-1/4 w-[600px] h-[600px] bg-orange-500/5 blur-[120px] rounded-full z-0 opacity-20"})]}),s.jsx("div",{className:"bg-gradient-to-r from-orange-600 via-red-600 to-orange-600 text-white text-center py-2 px-4 shadow-lg z-50 relative animate-pulse-slow",children:s.jsxs("p",{className:"font-bold text-sm tracking-wide flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-lg",children:""}),"ALPHA TEST - Feature Complete but Experimental",s.jsx("span",{className:"text-lg",children:""})]})}),s.jsx("div",{className:"relative z-10 bg-transparent min-h-[80vh] flex flex-col items-center",children:s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-32 md:py-48 flex flex-col items-center text-center",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-8 animate-fade-in",children:[s.jsxs("span",{className:"relative flex h-2 w-2",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-indigo-500"})]}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-widest leading-none",children:"The Future of MTG Strategy"})]}),s.jsxs("h1",{className:"text-5xl md:text-8xl font-black tracking-tight text-white mb-8 leading-tight",children:["The Forge: Where Decks",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-500 to-orange-600 filter drop-shadow-[0_0_15px_rgba(251,191,36,0.3)]",children:"Become Legends"})]}),s.jsxs("p",{className:"max-w-2xl text-xl md:text-2xl text-gray-400 mx-auto font-medium leading-relaxed mb-12",children:["Brew Smarter. Play Harder. Your ",s.jsx("span",{className:"text-white",children:"AI-Powered Strategic Edge"}),". Join the next generation of Magic: The Gathering intelligence."]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center w-full max-w-lg",children:[s.jsxs(Er,{to:"/dashboard",className:"group relative px-10 py-5 rounded-2xl bg-indigo-600 text-white font-black text-xl transition-all shadow-[0_20px_40px_-15px_rgba(79,70,229,0.5)] hover:shadow-[0_25px_50px_-12px_rgba(79,70,229,0.6)] transform hover:-translate-y-1 hover:scale-[1.02] flex items-center justify-center gap-3",children:[s.jsx("span",{children:"Enter The Forge"}),s.jsx("svg",{className:"w-6 h-6 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]}),s.jsx(Er,{to:"/strategy",className:"px-10 py-5 rounded-2xl bg-white/5 backdrop-blur-xl hover:bg-white/10 text-white font-bold text-lg border border-white/10 transition-all hover:border-white/20 flex items-center justify-center",children:"Explore AI Strategic Edge"})]}),s.jsxs("div",{className:"mt-24 grid grid-cols-2 md:grid-cols-4 gap-8 w-full max-w-4xl border-t border-white/5 pt-12",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"99.8%"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Analysis Accuracy"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"Real-Time"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Pricing & Sync"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"5"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Bracket Tiers"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"AI"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Driven Meta"})]})]})]})}),s.jsx("div",{className:"relative z-10",children:s.jsx(L5e,{})}),s.jsx("footer",{className:"bg-black py-12 border-t border-gray-900 mt-auto",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:s.jsx("p",{className:"text-gray-500",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."})})})]});function O5e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return y.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const ak=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function gb(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function rL(t){return"nodeType"in t}function Nl(t){var e,r;return t?gb(t)?t:rL(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function nL(t){const{Document:e}=Nl(t);return t instanceof e}function W1(t){return gb(t)?!1:t instanceof Nl(t).HTMLElement}function fJ(t){return t instanceof Nl(t).SVGElement}function xb(t){return t?gb(t)?t.document:rL(t)?nL(t)?t:W1(t)||fJ(t)?t.ownerDocument:document:document:document}const Vu=ak?y.useLayoutEffect:y.useEffect;function ok(t){const e=y.useRef(t);return Vu(()=>{e.current=t}),y.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function R5e(){const t=y.useRef(null),e=y.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=y.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function Gv(t,e){e===void 0&&(e=[t]);const r=y.useRef(t);return Vu(()=>{r.current!==t&&(r.current=t)},e),r}function G1(t,e){const r=y.useRef();return y.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function ij(t){const e=ok(t),r=y.useRef(null),n=y.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function aj(t){const e=y.useRef();return y.useEffect(()=>{e.current=t},[t]),e.current}let Q3={};function K1(t,e){return y.useMemo(()=>{if(e)return e;const r=Q3[t]==null?0:Q3[t]+1;return Q3[t]=r,t+"-"+r},[t,e])}function pJ(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,o)=>{const l=Object.entries(o);for(const[c,u]of l){const h=a[c];h!=null&&(a[c]=h+t*u)}return a},{...e})}}const vx=pJ(1),Kv=pJ(-1);function M5e(t){return"clientX"in t&&"clientY"in t}function lk(t){if(!t)return!1;const{KeyboardEvent:e}=Nl(t.target);return e&&t instanceof e}function D5e(t){if(!t)return!1;const{TouchEvent:e}=Nl(t.target);return e&&t instanceof e}function oj(t){if(D5e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return M5e(t)?{x:t.clientX,y:t.clientY}:null}const Yh=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[Yh.Translate.toString(t),Yh.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),MB="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function B5e(t){return t.matches(MB)?t:t.querySelector(MB)}const $5e={display:"none"};function F5e(t){let{id:e,value:r}=t;return Pe.createElement("div",{id:e,style:$5e},r)}function U5e(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Pe.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function z5e(){const[t,e]=y.useState("");return{announce:y.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const mJ=y.createContext(null);function q5e(t){const e=y.useContext(mJ);y.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function V5e(){const[t]=y.useState(()=>new Set),e=y.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[y.useCallback(n=>{let{type:i,event:a}=n;t.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,a)})},[t]),e]}const H5e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},W5e={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function G5e(t){let{announcements:e=W5e,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=H5e}=t;const{announce:a,announcement:o}=z5e(),l=K1("DndLiveRegion"),[c,u]=y.useState(!1);if(y.useEffect(()=>{u(!0)},[]),q5e(y.useMemo(()=>({onDragStart(p){let{active:m}=p;a(e.onDragStart({active:m}))},onDragMove(p){let{active:m,over:g}=p;e.onDragMove&&a(e.onDragMove({active:m,over:g}))},onDragOver(p){let{active:m,over:g}=p;a(e.onDragOver({active:m,over:g}))},onDragEnd(p){let{active:m,over:g}=p;a(e.onDragEnd({active:m,over:g}))},onDragCancel(p){let{active:m,over:g}=p;a(e.onDragCancel({active:m,over:g}))}}),[a,e])),!c)return null;const h=Pe.createElement(Pe.Fragment,null,Pe.createElement(F5e,{id:n,value:i.draggable}),Pe.createElement(U5e,{id:l,announcement:o}));return r?Vn.createPortal(h,r):h}var Da;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Da||(Da={}));function lj(){}function Gx(t,e){return y.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function sL(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return y.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const Hu=Object.freeze({x:0,y:0});function gJ(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function K5e(t,e){const r=oj(t);if(!r)return"0 0";const n={x:(r.x-e.left)/e.width*100,y:(r.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function xJ(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function Y5e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function DB(t){let{left:e,top:r,height:n,width:i}=t;return[{x:e,y:r},{x:e+i,y:r},{x:e,y:r+n},{x:e+i,y:r+n}]}function bJ(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function BB(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const X5e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=BB(e,e.left,e.top),a=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=gJ(BB(c),i);a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(xJ)},yJ=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=DB(e),a=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=DB(c),h=i.reduce((m,g,b)=>m+gJ(u[b],g),0),p=Number((h/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:p}})}}return a.sort(xJ)};function Q5e(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),o=i-n,l=a-r;if(n<i&&r<a){const c=e.width*e.height,u=t.width*t.height,h=o*l,p=h/(c+u-h);return Number(p.toFixed(4))}return 0}const J5e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:o}=a,l=r.get(o);if(l){const c=Q5e(l,e);c>0&&i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(Y5e)};function Z5e(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function vJ(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Hu}function eNe(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...r})}}const tNe=eNe(1);function wJ(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function rNe(t,e,r){const n=wJ(e);if(!n)return t;const{scaleX:i,scaleY:a,x:o,y:l}=n,c=t.left-o-(1-i)*parseFloat(r),u=t.top-l-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),h=i?t.width/i:t.width,p=a?t.height/a:t.height;return{width:h,height:p,top:u,right:c+h,bottom:u+p,left:c}}const nNe={ignoreTransform:!1};function bb(t,e){e===void 0&&(e=nNe);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:h}=Nl(t).getComputedStyle(t);u&&(r=rNe(r,u,h))}const{top:n,left:i,width:a,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:a,height:o,bottom:l,right:c}}function $B(t){return bb(t,{ignoreTransform:!0})}function sNe(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function iNe(t,e){return e===void 0&&(e=Nl(t).getComputedStyle(t)),e.position==="fixed"}function aNe(t,e){e===void 0&&(e=Nl(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function ck(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(nL(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!W1(i)||fJ(i)||r.includes(i))return r;const a=Nl(t).getComputedStyle(i);return i!==t&&aNe(i,a)&&r.push(i),iNe(i,a)?r:n(i.parentNode)}return t?n(t):r}function NJ(t){const[e]=ck(t,1);return e??null}function J3(t){return!ak||!t?null:gb(t)?t:rL(t)?nL(t)||t===xb(t).scrollingElement?window:W1(t)?t:null:null}function jJ(t){return gb(t)?t.scrollX:t.scrollLeft}function kJ(t){return gb(t)?t.scrollY:t.scrollTop}function qA(t){return{x:jJ(t),y:kJ(t)}}var io;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(io||(io={}));function _J(t){return!ak||!t?!1:t===document.scrollingElement}function SJ(t){const e={x:0,y:0},r=_J(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,o=t.scrollTop>=n.y,l=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:o,isRight:l,maxScroll:n,minScroll:e}}const oNe={x:.2,y:.2};function lNe(t,e,r,n,i){let{top:a,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=oNe);const{isTop:u,isBottom:h,isLeft:p,isRight:m}=SJ(t),g={x:0,y:0},b={x:0,y:0},v={height:e.height*i.y,width:e.width*i.x};return!u&&a<=e.top+v.height?(g.y=io.Backward,b.y=n*Math.abs((e.top+v.height-a)/v.height)):!h&&c>=e.bottom-v.height&&(g.y=io.Forward,b.y=n*Math.abs((e.bottom-v.height-c)/v.height)),!m&&l>=e.right-v.width?(g.x=io.Forward,b.x=n*Math.abs((e.right-v.width-l)/v.width)):!p&&o<=e.left+v.width&&(g.x=io.Backward,b.x=n*Math.abs((e.left+v.width-o)/v.width)),{direction:g,speed:b}}function cNe(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function CJ(t){return t.reduce((e,r)=>vx(e,qA(r)),Hu)}function uNe(t){return t.reduce((e,r)=>e+jJ(r),0)}function dNe(t){return t.reduce((e,r)=>e+kJ(r),0)}function EJ(t,e){if(e===void 0&&(e=bb),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);NJ(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const hNe=[["x",["left","right"],uNe],["y",["top","bottom"],dNe]];class iL{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=ck(r),i=CJ(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,o,l]of hNe)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),h=i[a]-u;return this.rect[c]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class yv{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function fNe(t){const{EventTarget:e}=Nl(t);return t instanceof e?t:xb(t)}function Z3(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var Kc;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Kc||(Kc={}));function FB(t){t.preventDefault()}function pNe(t){t.stopPropagation()}var In;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(In||(In={}));const AJ={start:[In.Space,In.Enter],cancel:[In.Esc],end:[In.Space,In.Enter,In.Tab]},mNe=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case In.Right:return{...r,x:r.x+25};case In.Left:return{...r,x:r.x-25};case In.Down:return{...r,y:r.y+25};case In.Up:return{...r,y:r.y-25}}};class uk{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new yv(xb(r)),this.windowListeners=new yv(Nl(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Kc.Resize,this.handleCancel),this.windowListeners.add(Kc.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Kc.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&EJ(n),r(Hu)}handleKeyDown(e){if(lk(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=AJ,coordinateGetter:o=mNe,scrollBehavior:l="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=n.current,h=u?{x:u.left,y:u.top}:Hu;this.referenceCoordinates||(this.referenceCoordinates=h);const p=o(e,{active:r,context:n.current,currentCoordinates:h});if(p){const m=Kv(p,h),g={x:0,y:0},{scrollableAncestors:b}=n.current;for(const v of b){const w=e.code,{isTop:j,isRight:_,isLeft:E,isBottom:I,maxScroll:O,minScroll:B}=SJ(v),S=cNe(v),T={x:Math.min(w===In.Right?S.right-S.width/2:S.right,Math.max(w===In.Right?S.left:S.left+S.width/2,p.x)),y:Math.min(w===In.Down?S.bottom-S.height/2:S.bottom,Math.max(w===In.Down?S.top:S.top+S.height/2,p.y))},M=w===In.Right&&!_||w===In.Left&&!E,$=w===In.Down&&!I||w===In.Up&&!j;if(M&&T.x!==p.x){const k=v.scrollLeft+m.x,L=w===In.Right&&k<=O.x||w===In.Left&&k>=B.x;if(L&&!m.y){v.scrollTo({left:k,behavior:l});return}L?g.x=v.scrollLeft-k:g.x=w===In.Right?v.scrollLeft-O.x:v.scrollLeft-B.x,g.x&&v.scrollBy({left:-g.x,behavior:l});break}else if($&&T.y!==p.y){const k=v.scrollTop+m.y,L=w===In.Down&&k<=O.y||w===In.Up&&k>=B.y;if(L&&!m.x){v.scrollTo({top:k,behavior:l});return}L?g.y=v.scrollTop-k:g.y=w===In.Down?v.scrollTop-O.y:v.scrollTop-B.y,g.y&&v.scrollBy({top:-g.y,behavior:l});break}}this.handleMove(e,vx(Kv(p,this.referenceCoordinates),g))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}uk.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=AJ,onActivation:i}=e,{active:a}=r;const{code:o}=t.nativeEvent;if(n.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function UB(t){return!!(t&&"distance"in t)}function zB(t){return!!(t&&"delay"in t)}class aL{constructor(e,r,n){var i;n===void 0&&(n=fNe(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:o}=a;this.props=e,this.events=r,this.document=xb(o),this.documentListeners=new yv(this.document),this.listeners=new yv(n),this.windowListeners=new yv(Nl(o)),this.initialCoordinates=(i=oj(a))!=null?i:Hu,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Kc.Resize,this.handleCancel),this.windowListeners.add(Kc.DragStart,FB),this.windowListeners.add(Kc.VisibilityChange,this.handleCancel),this.windowListeners.add(Kc.ContextMenu,FB),this.documentListeners.add(Kc.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(zB(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(UB(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Kc.Click,pNe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Kc.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!i)return;const c=(r=oj(e))!=null?r:Hu,u=Kv(i,c);if(!n&&l){if(UB(l)){if(l.tolerance!=null&&Z3(u,l.tolerance))return this.handleCancel();if(Z3(u,l.distance))return this.handleStart()}if(zB(l)&&Z3(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===In.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const gNe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class dk extends aL{constructor(e){const{event:r}=e,n=xb(r.target);super(e,gNe,n)}}dk.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const xNe={move:{name:"mousemove"},end:{name:"mouseup"}};var VA;(function(t){t[t.RightClick=2]="RightClick"})(VA||(VA={}));class TJ extends aL{constructor(e){super(e,xNe,xb(e.event.target))}}TJ.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===VA.RightClick?!1:(n?.({event:r}),!0)}}];const eC={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class IJ extends aL{constructor(e){super(e,eC)}static setup(){return window.addEventListener(eC.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(eC.move.name,e)};function e(){}}}IJ.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var vv;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(vv||(vv={}));var cj;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(cj||(cj={}));function bNe(t){let{acceleration:e,activator:r=vv.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:o=5,order:l=cj.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:h,delta:p,threshold:m}=t;const g=vNe({delta:p,disabled:!a}),[b,v]=R5e(),w=y.useRef({x:0,y:0}),j=y.useRef({x:0,y:0}),_=y.useMemo(()=>{switch(r){case vv.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case vv.DraggableRect:return i}},[r,i,c]),E=y.useRef(null),I=y.useCallback(()=>{const B=E.current;if(!B)return;const S=w.current.x*j.current.x,T=w.current.y*j.current.y;B.scrollBy(S,T)},[]),O=y.useMemo(()=>l===cj.TreeOrder?[...u].reverse():u,[l,u]);y.useEffect(()=>{if(!a||!u.length||!_){v();return}for(const B of O){if(n?.(B)===!1)continue;const S=u.indexOf(B),T=h[S];if(!T)continue;const{direction:M,speed:$}=lNe(B,T,_,e,m);for(const k of["x","y"])g[k][M[k]]||($[k]=0,M[k]=0);if($.x>0||$.y>0){v(),E.current=B,b(I,o),w.current=$,j.current=M;return}}w.current={x:0,y:0},j.current={x:0,y:0},v()},[e,I,n,v,a,o,JSON.stringify(_),JSON.stringify(g),b,u,O,h,JSON.stringify(m)])}const yNe={x:{[io.Backward]:!1,[io.Forward]:!1},y:{[io.Backward]:!1,[io.Forward]:!1}};function vNe(t){let{delta:e,disabled:r}=t;const n=aj(e);return G1(i=>{if(r||!n||!i)return yNe;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[io.Backward]:i.x[io.Backward]||a.x===-1,[io.Forward]:i.x[io.Forward]||a.x===1},y:{[io.Backward]:i.y[io.Backward]||a.y===-1,[io.Forward]:i.y[io.Forward]||a.y===1}}},[r,e,n])}function wNe(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return G1(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function NNe(t,e){return y.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,n)}));return[...r,...a]},[]),[t,e])}var Yv;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Yv||(Yv={}));var HA;(function(t){t.Optimized="optimized"})(HA||(HA={}));const qB=new Map;function jNe(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,o]=y.useState(null),{frequency:l,measure:c,strategy:u}=i,h=y.useRef(t),p=w(),m=Gv(p),g=y.useCallback(function(j){j===void 0&&(j=[]),!m.current&&o(_=>_===null?j:_.concat(j.filter(E=>!_.includes(E))))},[m]),b=y.useRef(null),v=G1(j=>{if(p&&!r)return qB;if(!j||j===qB||h.current!==t||a!=null){const _=new Map;for(let E of t){if(!E)continue;if(a&&a.length>0&&!a.includes(E.id)&&E.rect.current){_.set(E.id,E.rect.current);continue}const I=E.node.current,O=I?new iL(c(I),I):null;E.rect.current=O,O&&_.set(E.id,O)}return _}return j},[t,a,r,p,c]);return y.useEffect(()=>{h.current=t},[t]),y.useEffect(()=>{p||g()},[r,p]),y.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),y.useEffect(()=>{p||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{g(),b.current=null},l))},[l,p,g,...n]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:a!=null};function w(){switch(u){case Yv.Always:return!1;case Yv.BeforeDragging:return r;default:return!r}}}function oL(t,e){return G1(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function kNe(t,e){return oL(t,e)}function _Ne(t){let{callback:e,disabled:r}=t;const n=ok(e),i=y.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return y.useEffect(()=>()=>i?.disconnect(),[i]),i}function hk(t){let{callback:e,disabled:r}=t;const n=ok(e),i=y.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return y.useEffect(()=>()=>i?.disconnect(),[i]),i}function SNe(t){return new iL(bb(t),t)}function VB(t,e,r){e===void 0&&(e=SNe);const[n,i]=y.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=c??r)!=null?u:null}const h=e(t);return JSON.stringify(c)===JSON.stringify(h)?c:h})}const o=_Ne({callback(c){if(t)for(const u of c){const{type:h,target:p}=u;if(h==="childList"&&p instanceof HTMLElement&&p.contains(t)){a();break}}}}),l=hk({callback:a});return Vu(()=>{a(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),n}function CNe(t){const e=oL(t);return vJ(t,e)}const HB=[];function ENe(t){const e=y.useRef(t),r=G1(n=>t?n&&n!==HB&&t&&e.current&&t.parentNode===e.current.parentNode?n:ck(t):HB,[t]);return y.useEffect(()=>{e.current=t},[t]),r}function ANe(t){const[e,r]=y.useState(null),n=y.useRef(t),i=y.useCallback(a=>{const o=J3(a.target);o&&r(l=>l?(l.set(o,qA(o)),new Map(l)):null)},[]);return y.useEffect(()=>{const a=n.current;if(t!==a){o(a);const l=t.map(c=>{const u=J3(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,qA(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(c=>{const u=J3(c);u?.removeEventListener("scroll",i)})}},[i,t]),y.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,o)=>vx(a,o),Hu):CJ(t):Hu,[t,e])}function WB(t,e){e===void 0&&(e=[]);const r=y.useRef(null);return y.useEffect(()=>{r.current=null},e),y.useEffect(()=>{const n=t!==Hu;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?Kv(t,r.current):Hu}function TNe(t){y.useEffect(()=>{if(!ak)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function INe(t,e){return y.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=o=>{a(o,e)},r},{}),[t,e])}function LJ(t){return y.useMemo(()=>t?sNe(t):null,[t])}const GB=[];function LNe(t,e){e===void 0&&(e=bb);const[r]=t,n=LJ(r?Nl(r):null),[i,a]=y.useState(GB);function o(){a(()=>t.length?t.map(c=>_J(c)?n:new iL(e(c),c)):GB)}const l=hk({callback:o});return Vu(()=>{l?.disconnect(),o(),t.forEach(c=>l?.observe(c))},[t]),i}function PJ(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return W1(e)?e:t}function PNe(t){let{measure:e}=t;const[r,n]=y.useState(null),i=y.useCallback(u=>{for(const{target:h}of u)if(W1(h)){n(p=>{const m=e(h);return p?{...p,width:m.width,height:m.height}:m});break}},[e]),a=hk({callback:i}),o=y.useCallback(u=>{const h=PJ(u);a?.disconnect(),h&&a?.observe(h),n(h?e(h):null)},[e,a]),[l,c]=ij(o);return y.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const ONe=[{sensor:dk,options:{}},{sensor:uk,options:{}}],RNe={current:{}},nN={draggable:{measure:$B},droppable:{measure:$B,strategy:Yv.WhileDragging,frequency:HA.Optimized},dragOverlay:{measure:bb}};class wv extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const MNe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new wv,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:lj},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:nN,measureDroppableContainers:lj,windowRect:null,measuringScheduled:!1},OJ={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:lj,draggableNodes:new Map,over:null,measureDroppableContainers:lj},Y1=y.createContext(OJ),RJ=y.createContext(MNe);function DNe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new wv}}}function BNe(t,e){switch(e.type){case Da.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Da.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Da.DragEnd:case Da.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Da.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new wv(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Da.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const o=new wv(t.droppable.containers);return o.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Da.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new wv(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function $Ne(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=y.useContext(Y1),a=aj(n),o=aj(r?.id);return y.useEffect(()=>{if(!e&&!n&&a&&o!=null){if(!lk(a)||document.activeElement===a.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[c.current,u.current]){if(!h)continue;const p=B5e(h);if(p){p.focus();break}}})}},[n,e,i,o,a]),null}function MJ(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function FNe(t){return y.useMemo(()=>({draggable:{...nN.draggable,...t?.draggable},droppable:{...nN.droppable,...t?.droppable},dragOverlay:{...nN.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function UNe(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=y.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Vu(()=>{if(!o&&!l||!e){a.current=!1;return}if(a.current||!n)return;const u=e?.node.current;if(!u||u.isConnected===!1)return;const h=r(u),p=vJ(h,n);if(o||(p.x=0),l||(p.y=0),a.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const m=NJ(u);m&&m.scrollBy({top:p.y,left:p.x})}},[e,o,l,n,r])}const fk=y.createContext({...Hu,scaleX:1,scaleY:1});var i0;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(i0||(i0={}));const lL=y.memo(function(e){var r,n,i,a;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:h=ONe,collisionDetection:p=J5e,measuring:m,modifiers:g,...b}=e;const v=y.useReducer(BNe,void 0,DNe),[w,j]=v,[_,E]=V5e(),[I,O]=y.useState(i0.Uninitialized),B=I===i0.Initialized,{draggable:{active:S,nodes:T,translate:M},droppable:{containers:$}}=w,k=S!=null?T.get(S):null,L=y.useRef({initial:null,translated:null}),R=y.useMemo(()=>{var zt;return S!=null?{id:S,data:(zt=k?.data)!=null?zt:RNe,rect:L}:null},[S,k]),V=y.useRef(null),[Y,X]=y.useState(null),[J,re]=y.useState(null),se=Gv(b,Object.values(b)),ee=K1("DndDescribedBy",o),q=y.useMemo(()=>$.getEnabled(),[$]),U=FNe(m),{droppableRects:W,measureDroppableContainers:Z,measuringScheduled:de}=jNe(q,{dragging:B,dependencies:[M.x,M.y],config:U.droppable}),be=wNe(T,S),oe=y.useMemo(()=>J?oj(J):null,[J]),ne=Br(),H=kNe(be,U.draggable.measure);UNe({activeNode:S!=null?T.get(S):null,config:ne.layoutShiftCompensation,initialRect:H,measure:U.draggable.measure});const le=VB(be,U.draggable.measure,H),ye=VB(be?be.parentElement:null),me=y.useRef({activatorEvent:null,active:null,activeNode:be,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:$,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ke=$.getNodeFor((r=me.current.over)==null?void 0:r.id),Ie=PNe({measure:U.dragOverlay.measure}),ce=(n=Ie.nodeRef.current)!=null?n:be,Be=B?(i=Ie.rect)!=null?i:le:null,ct=!!(Ie.nodeRef.current&&Ie.rect),Ve=CNe(ct?null:le),Ne=LJ(ce?Nl(ce):null),Ye=ENe(B?ke??be:null),St=LNe(Ye),Vt=MJ(g,{transform:{x:M.x-Ve.x,y:M.y-Ve.y,scaleX:1,scaleY:1},activatorEvent:J,active:R,activeNodeRect:le,containerNodeRect:ye,draggingNodeRect:Be,over:me.current.over,overlayNodeRect:Ie.rect,scrollableAncestors:Ye,scrollableAncestorRects:St,windowRect:Ne}),Lt=oe?vx(oe,M):null,at=ANe(Ye),gt=WB(at),vt=WB(at,[le]),ft=vx(Vt,gt),ot=Be?tNe(Be,Vt):null,ut=R&&ot?p({active:R,collisionRect:ot,droppableRects:W,droppableContainers:q,pointerCoordinates:Lt}):null,At=bJ(ut,"id"),[Fe,Ut]=y.useState(null),jt=ct?Vt:vx(Vt,vt),qe=Z5e(jt,(a=Fe?.rect)!=null?a:null,le),rt=y.useRef(null),Ot=y.useCallback((zt,Wt)=>{let{sensor:qt,options:ur}=Wt;if(V.current==null)return;const Re=T.get(V.current);if(!Re)return;const Nt=zt.nativeEvent,Pt=new qt({active:V.current,activeNode:Re,event:Nt,options:ur,context:me,onAbort(Zt){if(!T.get(Zt))return;const{onDragAbort:et}=se.current,Rt={id:Zt};et?.(Rt),_({type:"onDragAbort",event:Rt})},onPending(Zt,Ae,et,Rt){if(!T.get(Zt))return;const{onDragPending:Qt}=se.current,Ee={id:Zt,constraint:Ae,initialCoordinates:et,offset:Rt};Qt?.(Ee),_({type:"onDragPending",event:Ee})},onStart(Zt){const Ae=V.current;if(Ae==null)return;const et=T.get(Ae);if(!et)return;const{onDragStart:Rt}=se.current,$t={activatorEvent:Nt,active:{id:Ae,data:et.data,rect:L}};Vn.unstable_batchedUpdates(()=>{Rt?.($t),O(i0.Initializing),j({type:Da.DragStart,initialCoordinates:Zt,active:Ae}),_({type:"onDragStart",event:$t}),X(rt.current),re(Nt)})},onMove(Zt){j({type:Da.DragMove,coordinates:Zt})},onEnd:It(Da.DragEnd),onCancel:It(Da.DragCancel)});rt.current=Pt;function It(Zt){return async function(){const{active:et,collisions:Rt,over:$t,scrollAdjustedTranslate:Qt}=me.current;let Ee=null;if(et&&Qt){const{cancelDrop:Me}=se.current;Ee={activatorEvent:Nt,active:et,collisions:Rt,delta:Qt,over:$t},Zt===Da.DragEnd&&typeof Me=="function"&&await Promise.resolve(Me(Ee))&&(Zt=Da.DragCancel)}V.current=null,Vn.unstable_batchedUpdates(()=>{j({type:Zt}),O(i0.Uninitialized),Ut(null),X(null),re(null),rt.current=null;const Me=Zt===Da.DragEnd?"onDragEnd":"onDragCancel";if(Ee){const Je=se.current[Me];Je?.(Ee),_({type:Me,event:Ee})}})}}},[T]),pt=y.useCallback((zt,Wt)=>(qt,ur)=>{const Re=qt.nativeEvent,Nt=T.get(ur);if(V.current!==null||!Nt||Re.dndKit||Re.defaultPrevented)return;const Pt={active:Nt};zt(qt,Wt.options,Pt)===!0&&(Re.dndKit={capturedBy:Wt.sensor},V.current=ur,Ot(qt,Wt))},[T,Ot]),Jt=NNe(h,pt);TNe(h),Vu(()=>{le&&I===i0.Initializing&&O(i0.Initialized)},[le,I]),y.useEffect(()=>{const{onDragMove:zt}=se.current,{active:Wt,activatorEvent:qt,collisions:ur,over:Re}=me.current;if(!Wt||!qt)return;const Nt={active:Wt,activatorEvent:qt,collisions:ur,delta:{x:ft.x,y:ft.y},over:Re};Vn.unstable_batchedUpdates(()=>{zt?.(Nt),_({type:"onDragMove",event:Nt})})},[ft.x,ft.y]),y.useEffect(()=>{const{active:zt,activatorEvent:Wt,collisions:qt,droppableContainers:ur,scrollAdjustedTranslate:Re}=me.current;if(!zt||V.current==null||!Wt||!Re)return;const{onDragOver:Nt}=se.current,Pt=ur.get(At),It=Pt&&Pt.rect.current?{id:Pt.id,rect:Pt.rect.current,data:Pt.data,disabled:Pt.disabled}:null,Zt={active:zt,activatorEvent:Wt,collisions:qt,delta:{x:Re.x,y:Re.y},over:It};Vn.unstable_batchedUpdates(()=>{Ut(It),Nt?.(Zt),_({type:"onDragOver",event:Zt})})},[At]),Vu(()=>{me.current={activatorEvent:J,active:R,activeNode:be,collisionRect:ot,collisions:ut,droppableRects:W,draggableNodes:T,draggingNode:ce,draggingNodeRect:Be,droppableContainers:$,over:Fe,scrollableAncestors:Ye,scrollAdjustedTranslate:ft},L.current={initial:Be,translated:ot}},[R,be,ut,ot,T,ce,Be,W,$,Fe,Ye,ft]),bNe({...ne,delta:M,draggingRect:ot,pointerCoordinates:Lt,scrollableAncestors:Ye,scrollableAncestorRects:St});const Kt=y.useMemo(()=>({active:R,activeNode:be,activeNodeRect:le,activatorEvent:J,collisions:ut,containerNodeRect:ye,dragOverlay:Ie,draggableNodes:T,droppableContainers:$,droppableRects:W,over:Fe,measureDroppableContainers:Z,scrollableAncestors:Ye,scrollableAncestorRects:St,measuringConfiguration:U,measuringScheduled:de,windowRect:Ne}),[R,be,le,J,ut,ye,Ie,T,$,W,Fe,Z,Ye,St,U,de,Ne]),rr=y.useMemo(()=>({activatorEvent:J,activators:Jt,active:R,activeNodeRect:le,ariaDescribedById:{draggable:ee},dispatch:j,draggableNodes:T,over:Fe,measureDroppableContainers:Z}),[J,Jt,R,le,j,ee,T,Fe,Z]);return Pe.createElement(mJ.Provider,{value:E},Pe.createElement(Y1.Provider,{value:rr},Pe.createElement(RJ.Provider,{value:Kt},Pe.createElement(fk.Provider,{value:qe},u)),Pe.createElement($Ne,{disabled:l?.restoreFocus===!1})),Pe.createElement(G5e,{...l,hiddenTextDescribedById:ee}));function Br(){const zt=Y?.autoScrollEnabled===!1,Wt=typeof c=="object"?c.enabled===!1:c===!1,qt=B&&!zt&&!Wt;return typeof c=="object"?{...c,enabled:qt}:{enabled:qt}}}),zNe=y.createContext(null),KB="button",qNe="Draggable";function DJ(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=K1(qNe),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:h,draggableNodes:p,over:m}=y.useContext(Y1),{role:g=KB,roleDescription:b="draggable",tabIndex:v=0}=i??{},w=c?.id===e,j=y.useContext(w?fk:zNe),[_,E]=ij(),[I,O]=ij(),B=INe(o,e),S=Gv(r);Vu(()=>(p.set(e,{id:e,key:a,node:_,activatorNode:I,data:S}),()=>{const M=p.get(e);M&&M.key===a&&p.delete(e)}),[p,e]);const T=y.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":n,"aria-pressed":w&&g===KB?!0:void 0,"aria-roledescription":b,"aria-describedby":h.draggable}),[n,g,v,w,b,h.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:T,isDragging:w,listeners:n?void 0:B,node:_,over:m,setNodeRef:E,setActivatorNodeRef:O,transform:j}}function BJ(){return y.useContext(RJ)}const VNe="Droppable",HNe={timeout:25};function $J(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=K1(VNe),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=y.useContext(Y1),h=y.useRef({disabled:r}),p=y.useRef(!1),m=y.useRef(null),g=y.useRef(null),{disabled:b,updateMeasurementsFor:v,timeout:w}={...HNe,...i},j=Gv(v??n),_=y.useCallback(()=>{if(!p.current){p.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(j.current)?j.current:[j.current]),g.current=null},w)},[w]),E=hk({callback:_,disabled:b||!o}),I=y.useCallback((T,M)=>{E&&(M&&(E.unobserve(M),p.current=!1),T&&E.observe(T))},[E]),[O,B]=ij(I),S=Gv(e);return y.useEffect(()=>{!E||!O.current||(E.disconnect(),p.current=!1,E.observe(O.current))},[O,E]),y.useEffect(()=>(l({type:Da.RegisterDroppable,element:{id:n,key:a,disabled:r,node:O,rect:m,data:S}}),()=>l({type:Da.UnregisterDroppable,key:a,id:n})),[n]),y.useEffect(()=>{r!==h.current.disabled&&(l({type:Da.SetDroppableDisabled,id:n,key:a,disabled:r}),h.current.disabled=r)},[n,a,r,l]),{active:o,rect:m,isOver:c?.id===n,node:O,over:c,setNodeRef:B}}function WNe(t){let{animation:e,children:r}=t;const[n,i]=y.useState(null),[a,o]=y.useState(null),l=aj(r);return!r&&!n&&l&&i(l),Vu(()=>{if(!a)return;const c=n?.key,u=n?.props.id;if(c==null||u==null){i(null);return}Promise.resolve(e(u,a)).then(()=>{i(null)})},[e,n,a]),Pe.createElement(Pe.Fragment,null,r,n?y.cloneElement(n,{ref:o}):null)}const GNe={x:0,y:0,scaleX:1,scaleY:1};function KNe(t){let{children:e}=t;return Pe.createElement(Y1.Provider,{value:OJ},Pe.createElement(fk.Provider,{value:GNe},e))}const YNe={position:"fixed",touchAction:"none"},XNe=t=>lk(t)?"transform 250ms ease":void 0,QNe=y.forwardRef((t,e)=>{let{as:r,activatorEvent:n,adjustScale:i,children:a,className:o,rect:l,style:c,transform:u,transition:h=XNe}=t;if(!l)return null;const p=i?u:{...u,scaleX:1,scaleY:1},m={...YNe,width:l.width,height:l.height,top:l.top,left:l.left,transform:Yh.Transform.toString(p),transformOrigin:i&&n?K5e(n,l):void 0,transition:typeof h=="function"?h(n):h,...c};return Pe.createElement(r,{className:o,style:m,ref:e},a)}),FJ=t=>e=>{let{active:r,dragOverlay:n}=e;const i={},{styles:a,className:o}=t;if(a!=null&&a.active)for(const[l,c]of Object.entries(a.active))c!==void 0&&(i[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(a!=null&&a.dragOverlay)for(const[l,c]of Object.entries(a.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return o!=null&&o.active&&r.node.classList.add(o.active),o!=null&&o.dragOverlay&&n.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(i))r.node.style.setProperty(c,u);o!=null&&o.active&&r.node.classList.remove(o.active)}},JNe=t=>{let{transform:{initial:e,final:r}}=t;return[{transform:Yh.Transform.toString(e)},{transform:Yh.Transform.toString(r)}]},ZNe={duration:250,easing:"ease",keyframes:JNe,sideEffects:FJ({styles:{active:{opacity:"0"}}})};function eje(t){let{config:e,draggableNodes:r,droppableContainers:n,measuringConfiguration:i}=t;return ok((a,o)=>{if(e===null)return;const l=r.get(a);if(!l)return;const c=l.node.current;if(!c)return;const u=PJ(o);if(!u)return;const{transform:h}=Nl(o).getComputedStyle(o),p=wJ(h);if(!p)return;const m=typeof e=="function"?e:tje(e);return EJ(c,i.draggable.measure),m({active:{id:a,data:l.data,node:c,rect:i.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:o,rect:i.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:i,transform:p})})}function tje(t){const{duration:e,easing:r,sideEffects:n,keyframes:i}={...ZNe,...t};return a=>{let{active:o,dragOverlay:l,transform:c,...u}=a;if(!e)return;const h={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},p={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},m={x:c.x-h.x,y:c.y-h.y,...p},g=i({...u,active:o,dragOverlay:l,transform:{initial:c,final:m}}),[b]=g,v=g[g.length-1];if(JSON.stringify(b)===JSON.stringify(v))return;const w=n?.({active:o,dragOverlay:l,...u}),j=l.node.animate(g,{duration:e,easing:r,fill:"forwards"});return new Promise(_=>{j.onfinish=()=>{w?.(),_()}})}}let YB=0;function rje(t){return y.useMemo(()=>{if(t!=null)return YB++,YB},[t])}const cL=Pe.memo(t=>{let{adjustScale:e=!1,children:r,dropAnimation:n,style:i,transition:a,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=t;const{activatorEvent:h,active:p,activeNodeRect:m,containerNodeRect:g,draggableNodes:b,droppableContainers:v,dragOverlay:w,over:j,measuringConfiguration:_,scrollableAncestors:E,scrollableAncestorRects:I,windowRect:O}=BJ(),B=y.useContext(fk),S=rje(p?.id),T=MJ(o,{activatorEvent:h,active:p,activeNodeRect:m,containerNodeRect:g,draggingNodeRect:w.rect,over:j,overlayNodeRect:w.rect,scrollableAncestors:E,scrollableAncestorRects:I,transform:B,windowRect:O}),M=oL(m),$=eje({config:n,draggableNodes:b,droppableContainers:v,measuringConfiguration:_}),k=M?w.setRef:void 0;return Pe.createElement(KNe,null,Pe.createElement(WNe,{animation:$},p&&S?Pe.createElement(QNe,{key:S,id:p.id,ref:k,as:l,activatorEvent:h,adjustScale:e,className:c,transition:a,rect:M,style:{zIndex:u,...i},transform:T},r):null))});function pk(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function nje(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function zw(t){return t!==null&&t>=0}function sje(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ije(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const mk=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=pk(e,n,r),o=e[i],l=a[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},UJ="Sortable",zJ=Pe.createContext({activeIndex:-1,containerId:UJ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:mk,disabled:{draggable:!1,droppable:!1}});function qJ(t){let{children:e,id:r,items:n,strategy:i=mk,disabled:a=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:h}=BJ(),p=K1(UJ,r),m=l.rect!==null,g=y.useMemo(()=>n.map(B=>typeof B=="object"&&"id"in B?B.id:B),[n]),b=o!=null,v=o?g.indexOf(o.id):-1,w=u?g.indexOf(u.id):-1,j=y.useRef(g),_=!sje(g,j.current),E=w!==-1&&v===-1||_,I=ije(a);Vu(()=>{_&&b&&h(g)},[_,g,b,h]),y.useEffect(()=>{j.current=g},[g]);const O=y.useMemo(()=>({activeIndex:v,containerId:p,disabled:I,disableTransforms:E,items:g,overIndex:w,useDragOverlay:m,sortedRects:nje(g,c),strategy:i}),[v,p,I.draggable,I.droppable,E,g,w,c,m,i]);return Pe.createElement(zJ.Provider,{value:O},e)}const aje=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return pk(r,n,i).indexOf(e)},oje=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=t;return!u||!n||l!==a&&i===o?!1:r?!0:o!==i&&e===c},lje={duration:200,easing:"ease"},VJ="transform",cje=Yh.Transition.toString({property:VJ,duration:0,easing:"linear"}),uje={roleDescription:"sortable"};function dje(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,o]=y.useState(null),l=y.useRef(r);return Vu(()=>{if(!e&&r!==l.current&&n.current){const c=i.current;if(c){const u=bb(n.current,{ignoreTransform:!0}),h={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(h.x||h.y)&&o(h)}}r!==l.current&&(l.current=r)},[e,r,n,i]),y.useEffect(()=>{a&&o(null)},[a]),a}function HJ(t){let{animateLayoutChanges:e=oje,attributes:r,disabled:n,data:i,getNewIndex:a=aje,id:o,strategy:l,resizeObserverConfig:c,transition:u=lje}=t;const{items:h,containerId:p,activeIndex:m,disabled:g,disableTransforms:b,sortedRects:v,overIndex:w,useDragOverlay:j,strategy:_}=y.useContext(zJ),E=hje(n,g),I=h.indexOf(o),O=y.useMemo(()=>({sortable:{containerId:p,index:I,items:h},...i}),[p,i,I,h]),B=y.useMemo(()=>h.slice(h.indexOf(o)),[h,o]),{rect:S,node:T,isOver:M,setNodeRef:$}=$J({id:o,data:O,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:B,...c}}),{active:k,activatorEvent:L,activeNodeRect:R,attributes:V,setNodeRef:Y,listeners:X,isDragging:J,over:re,setActivatorNodeRef:se,transform:ee}=DJ({id:o,data:O,attributes:{...uje,...r},disabled:E.draggable}),q=O5e($,Y),U=!!k,W=U&&!b&&zw(m)&&zw(w),Z=!j&&J,de=Z&&W?ee:null,oe=W?de??(l??_)({rects:v,activeNodeRect:R,activeIndex:m,overIndex:w,index:I}):null,ne=zw(m)&&zw(w)?a({id:o,items:h,activeIndex:m,overIndex:w}):I,H=k?.id,le=y.useRef({activeId:H,items:h,newIndex:ne,containerId:p}),ye=h!==le.current.items,me=e({active:k,containerId:p,isDragging:J,isSorting:U,id:o,index:I,items:h,newIndex:le.current.newIndex,previousItems:le.current.items,previousContainerId:le.current.containerId,transition:u,wasDragging:le.current.activeId!=null}),ke=dje({disabled:!me,index:I,node:T,rect:S});return y.useEffect(()=>{U&&le.current.newIndex!==ne&&(le.current.newIndex=ne),p!==le.current.containerId&&(le.current.containerId=p),h!==le.current.items&&(le.current.items=h)},[U,ne,p,h]),y.useEffect(()=>{if(H===le.current.activeId)return;if(H!=null&&le.current.activeId==null){le.current.activeId=H;return}const ce=setTimeout(()=>{le.current.activeId=H},50);return()=>clearTimeout(ce)},[H]),{active:k,activeIndex:m,attributes:V,data:O,rect:S,index:I,newIndex:ne,items:h,isOver:M,isSorting:U,isDragging:J,listeners:X,node:T,overIndex:w,over:re,setNodeRef:q,setActivatorNodeRef:se,setDroppableNodeRef:$,setDraggableNodeRef:Y,transform:ke??oe,transition:Ie()};function Ie(){if(ke||ye&&le.current.newIndex===I)return cje;if(!(Z&&!lk(L)||!u)&&(U||me))return Yh.Transition.toString({...u,property:VJ})}}function hje(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}function uj(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const fje=[In.Down,In.Right,In.Up,In.Left],WJ=(t,e)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:a,over:o,scrollableAncestors:l}}=e;if(fje.includes(t.code)){if(t.preventDefault(),!r||!n)return;const c=[];a.getEnabled().forEach(p=>{if(!p||p!=null&&p.disabled)return;const m=i.get(p.id);if(m)switch(t.code){case In.Down:n.top<m.top&&c.push(p);break;case In.Up:n.top>m.top&&c.push(p);break;case In.Left:n.left>m.left&&c.push(p);break;case In.Right:n.left<m.left&&c.push(p);break}});const u=yJ({collisionRect:n,droppableRects:i,droppableContainers:c});let h=bJ(u,"id");if(h===o?.id&&u.length>1&&(h=u[1].id),h!=null){const p=a.get(r.id),m=a.get(h),g=m?i.get(m.id):null,b=m?.node.current;if(b&&g&&p&&m){const w=ck(b).some((B,S)=>l[S]!==B),j=GJ(p,m),_=pje(p,m),E=w||!j?{x:0,y:0}:{x:_?n.width-g.width:0,y:_?n.height-g.height:0},I={x:g.left,y:g.top};return E.x&&E.y?I:Kv(I,E)}}}};function GJ(t,e){return!uj(t)||!uj(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function pje(t,e){return!uj(t)||!uj(e)||!GJ(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}function z0(t=null){const{currentUser:e}=Or();Lm();const r=["decks",{userId:t||e?.uid}],{data:n=[],isLoading:i,error:a,refetch:o}=U1({queryKey:r,queryFn:async()=>e?await Ge.get("/api/decks",t?{userId:t}:{}):[],enabled:!!e,staleTime:1e3*60*5});return{decks:n,loading:i,error:a,refresh:o}}const mje=[{badge:"White",colors:["W"],flavor:"Order, protection, and the light of law."},{badge:"Blue",colors:["U"],flavor:"Knowledge, manipulation, and the perfection of mind."},{badge:"Black",colors:["B"],flavor:"Power, ambition, and death at any cost."},{badge:"Red",colors:["R"],flavor:"Freedom, emotion, and the fire of impulse."},{badge:"Green",colors:["G"],flavor:"Nature, instinct, and the strength of the wild."},{badge:"Colorless",colors:["C"],flavor:"The void between, pure and unyielding."},{badge:"Azorius",colors:["W","U"],flavor:"The law is the shield of the just."},{badge:"Dimir",colors:["U","B"],flavor:"Knowledge is power, and we know everything."},{badge:"Rakdos",colors:["B","R"],flavor:"Entertainment is a serious business."},{badge:"Gruul",colors:["R","G"],flavor:"Not Gruul? Then die!"},{badge:"Selesnya",colors:["G","W"],flavor:"Together, we are the world's soul."},{badge:"Orzhov",colors:["W","B"],flavor:"Wealth is power, and spirit is currency."},{badge:"Izzet",colors:["U","R"],flavor:"Genius and madness are two sides of the same coin."},{badge:"Golgari",colors:["B","G"],flavor:"Life and death are a continuous circle."},{badge:"Boros",colors:["R","W"],flavor:"Strike fast, strike hard, strike true."},{badge:"Simic",colors:["G","U"],flavor:"Nature, perfected by design."},{badge:"Esper",colors:["W","U","B"],flavor:"Perfection through etherium and discipline."},{badge:"Grixis",colors:["U","B","R"],flavor:"Life is short, death is forever."},{badge:"Jund",colors:["B","R","G"],flavor:"Only the strongest survive the feeding frenzy."},{badge:"Naya",colors:["R","G","W"],flavor:"Where giant beasts roam and the wild reigns."},{badge:"Bant",colors:["G","W","U"],flavor:"Honor, valor, and the righteousness of caste."},{badge:"Abzan",colors:["W","B","G"],flavor:"Family is the only fortress that matters."},{badge:"Jeskai",colors:["U","R","W"],flavor:"Cunning strategies and swift strikes."},{badge:"Sultai",colors:["B","G","U"],flavor:"Ruthlessness is a virtue in the opulent dark."},{badge:"Mardu",colors:["R","W","B"],flavor:"Speed of the horse, edge of the blade."},{badge:"Temur",colors:["G","U","R"],flavor:"Savagery concealed by ice and snow."},{badge:"Glint-Eye",colors:["U","B","R","G"],flavor:"Chaos without order."},{badge:"Dune-Brood",colors:["W","B","R","G"],flavor:"Growth through conflict."},{badge:"Ink-Treader",colors:["W","U","R","G"],flavor:"Motion without purpose."},{badge:"Witch-Maw",colors:["W","U","B","G"],flavor:"Life without death."},{badge:"Yore-Tiller",colors:["W","U","B","R"],flavor:"Artifice without nature."},{badge:"WUBRG",colors:["W","U","B","R","G"],flavor:"All five colors in perfect harmony."}],gje=(t,e)=>{if(!e||e.length===0)return{bg:"bg-gray-500",color:"text-gray-400"};if(e.length===1)switch(e[0]){case"W":return{bg:"bg-yellow-400",color:"text-yellow-200"};case"U":return{bg:"bg-blue-500",color:"text-blue-400"};case"B":return{bg:"bg-gray-800",color:"text-gray-400"};case"R":return{bg:"bg-red-500",color:"text-red-400"};case"G":return{bg:"bg-green-500",color:"text-green-400"};case"C":return{bg:"bg-gray-400",color:"text-gray-300"}}return e.length===2?{bg:"bg-amber-600",color:"text-amber-400"}:{bg:"bg-indigo-500",color:"text-indigo-400"}},dj=t=>{const e=t||[],r=e.length,i=mje.find(o=>o.badge==="Colorless"&&(r===0||r===1&&e[0]==="C")?!0:o.colors.length!==r?!1:o.colors.every(l=>e.includes(l)))||{badge:"Commander",colors:e,flavor:"A unique combination of powers."},a=gje(i.badge,i.colors);return{...i,pips:i.colors,bg:a.bg,color:a.color}},uL=({title:t,value:e,icon:r,color:n,to:i,children:a,size:o})=>{const l=o==="xs",c=s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-2xl ${l?"px-4 py-2":"p-4 md:p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative h-full flex flex-col justify-center`,children:[a,s.jsxs("div",{className:`relative z-20 ${l?"flex items-center justify-between w-full":""}`,children:[!l&&s.jsx("div",{className:"flex justify-between items-start mb-2 md:mb-4",children:s.jsx("div",{className:`p-2 rounded-xl bg-gray-950 text-${n}-400 group-hover:scale-110 transition-transform shadow-inner`,children:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})})}),s.jsxs("div",{className:l?"flex items-center gap-2":"flex flex-col",children:[l&&s.jsx("div",{className:`text-[9px] font-black px-2 py-0.5 rounded-full bg-${n}-500/10 text-${n}-400/80 uppercase tracking-tighter whitespace-nowrap border border-${n}-500/20`,children:t}),s.jsx("div",{className:`${l?"text-base":"text-3xl"} font-black text-white tracking-tight`,children:e})]}),l&&!a&&s.jsx("div",{className:`text-${n}-400 opacity-50`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})}),!l&&s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:t})]})]});return i&&!a?s.jsx(Er,{to:i,className:"block h-full transition-transform active:scale-[0.98]",children:c}):c},xje=({data:t,size:e})=>{const{stats:r,collection:n}=t;if(!r)return null;const i=e==="medium",a=e==="large"||e==="xlarge";return s.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:s.jsxs(uL,{to:a?null:"/collection",title:"Total Cards",value:r.totalCards,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue",size:e,children:[i&&s.jsxs("div",{className:"absolute top-4 right-4 text-right",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Distinct"}),s.jsx("div",{className:"text-xl font-bold text-indigo-400",children:n?.length||0})]}),e==="large"&&n&&s.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Recently Added"}),s.jsx("div",{className:"space-y-1.5",children:n.slice(-5).reverse().map((o,l)=>s.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[s.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),o.image_uris?.art_crop&&s.jsx("img",{src:o.image_uris.art_crop,alt:o.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},l))})]}),e==="xlarge"&&s.jsxs("div",{className:"absolute inset-y-0 right-0 w-[70%] flex items-center justify-around border-l border-white/5 bg-gray-950/20 px-8",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-indigo-400",children:n?.length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Distinct"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-yellow-400",children:n?.filter(o=>o.val_foil).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Foils"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-green-400",children:n?.filter(o=>o.val_signed).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Signed"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-gray-400",children:n?.filter(o=>o.val_alt_art).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Alt Art"})]})]})]})})},bje=({data:t,size:e})=>{const{stats:r}=t;return r?s.jsx(uL,{to:"/decks",title:"Unique Decks",value:r.uniqueDecks,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"purple",size:e}):null},yje=({card:t})=>{const[e,r]=y.useState(!1),n=t.card_faces?.length>1,i=y.useMemo(()=>n?e&&t.card_faces[1].image_uris?t.card_faces[1].image_uris.normal||t.card_faces[1].image_uris.art_crop:t.card_faces[0].image_uris?.normal||t.card_faces[0].image_uris?.art_crop||t.image_uris?.normal:t.image_uris?.normal||t.image_uris?.art_crop,[t,e,n]),a=(()=>{const l=(t.finish==="foil"||t.is_foil||t.val_foil)&&t.prices?.usd_foil||t.prices?.usd;return l?parseFloat(l).toFixed(2):"0.00"})();return s.jsxs("div",{className:"group/card flex flex-col cursor-pointer",onClick:()=>n&&r(!e),children:[s.jsxs("div",{className:"aspect-[2.5/3.5] rounded-lg overflow-hidden border border-white/10 mb-2 relative bg-gray-900 shadow-lg group-hover/card:shadow-indigo-500/20 transition-all",children:[i?s.jsx("img",{src:i,alt:t.name,className:"w-full h-full object-cover group-hover/card:scale-110 transition-transform duration-500"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600 bg-gray-800",children:s.jsx("span",{className:"text-[10px]",children:"No Image"})}),n&&s.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50 backdrop-blur-sm border border-white/10 text-white/70",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-gray-950/90 py-1 px-2 text-center border-t border-white/10 backdrop-blur-sm",children:s.jsxs("span",{className:"text-xs font-mono font-bold text-green-400 block",children:["$",a]})})]}),s.jsx("div",{className:"text-[10px] font-bold text-gray-400 line-clamp-1 text-center group-hover/card:text-white transition-colors",children:t.name})]})},vje=({data:t,actions:e,size:r})=>{const{stats:n,syncLoading:i,collection:a}=t,{handleSyncPrices:o}=e;if(!n)return null;const l=r==="xs",c=r==="medium",u=p=>{const g=(p.finish==="foil"||p.is_foil||p.val_foil)&&p.prices?.usd_foil||p.prices?.usd;return parseFloat(g||0)},h=a?[...a].sort((p,m)=>u(m)-u(p))[0]:null;return s.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:s.jsxs(uL,{title:"Collection Value",value:n.value,icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"green",size:r,children:[!l&&s.jsx("button",{onClick:p=>{p.preventDefault(),o()},disabled:i,className:`absolute bottom-4 right-4 p-2 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all ${i?"animate-spin":""} z-20`,title:"Update Prices from Scryfall",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c&&h&&s.jsxs("div",{className:"absolute top-4 right-4 text-right max-w-[100px]",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1 truncate",children:"Top Value"}),s.jsx("div",{className:"text-xs font-bold text-green-400 truncate",children:h.name})]}),r==="large"&&a&&s.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5 z-10",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Top Value Cards"}),s.jsx("div",{className:"space-y-1.5",children:a.filter(p=>u(p)>0).sort((p,m)=>u(m)-u(p)).slice(0,5).map((p,m)=>s.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-300 group-hover/card:text-white truncate flex-grow min-w-0",children:p.name}),s.jsxs("span",{className:"text-[10px] text-green-400 font-mono",children:["$",u(p).toFixed(2)]})]}),p.image_uris?.art_crop&&s.jsx("img",{src:p.image_uris.art_crop,alt:p.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},m))})]}),r==="xlarge"&&a&&s.jsxs("div",{className:"absolute inset-y-0 right-0 w-[75%] border-l border-white/5 bg-gray-950/20 px-6 py-4 flex flex-col",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4 flex-shrink-0",children:"Highest Collection Assets"}),s.jsx("div",{className:"grid grid-cols-4 gap-4 overflow-y-auto pr-2 custom-scrollbar",children:a.filter(p=>u(p)>0).sort((p,m)=>u(m)-u(p)).slice(0,12).map((p,m)=>s.jsx(yje,{card:p},m))})]})]})})},wje=({deck:t,navigate:e})=>{const[r,n]=y.useState(!1),[i,a]=y.useState(!1),o=(h,p)=>h?p&&h.card_faces?.length>1&&h.card_faces[1].image_uris?.art_crop?h.card_faces[1].image_uris.art_crop:h.image_uris?.art_crop?h.image_uris.art_crop:h.card_faces?.[0]?.image_uris?.art_crop?h.card_faces[0].image_uris.art_crop:null:null,l=h=>h?.card_faces?.length>1,c=o(t.commander,r),u=o(t.commander_partner,i);return s.jsxs("div",{onClick:()=>e(`/decks/${t.id}`),className:"group relative rounded-xl overflow-hidden cursor-pointer shadow-lg hover:shadow-indigo-500/30 transition-all hover:-translate-y-1 border border-white/5 bg-gray-900 h-full min-h-[140px]",children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950",children:t.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50 group/main",children:[s.jsx("img",{src:c||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander)&&s.jsx("button",{onClick:h=>{h.stopPropagation(),n(!r)},className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),s.jsxs("div",{className:"w-1/2 h-full relative group/partner",children:[s.jsx("img",{src:u||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander_partner)&&s.jsx("button",{onClick:h=>{h.stopPropagation(),a(!i)},className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}):s.jsxs("div",{className:"w-full h-full relative",children:[s.jsx("img",{src:c||"https://placehold.co/400x600?text=?",alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander)&&s.jsx("button",{onClick:h=>{h.stopPropagation(),n(!r)},className:"absolute top-2 right-2 p-1.5 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/20 to-transparent opacity-90 pointer-events-none"}),s.jsxs("div",{className:"absolute inset-0 p-3 flex flex-col justify-end pointer-events-none",children:[s.jsx("h3",{className:"text-sm font-bold text-white leading-tight mb-0.5 group-hover:text-indigo-400 transition-colors line-clamp-1",children:t.name}),s.jsx("div",{className:"flex gap-0.5",children:(()=>{const h=t?.commander?.color_identity||[],p=t?.commander_partner?.color_identity||[],m=[...new Set([...h,...p])];return m.length===0&&m.push("C"),m.map(g=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${g}.svg`,alt:g,className:"w-2.5 h-2.5"},g))})()})]})]})},Nje=({data:t,size:e})=>{const{decks:r,decksLoading:n}=t,i=xn(),a=e==="xs",o=e==="small",l=e==="medium",c=e==="large",u=e==="xlarge",h=y.useMemo(()=>a||o?1:l?2:c?3:6,[a,o,l,c]),p=y.useMemo(()=>r?[...r].reverse().slice(0,h):[],[r,h]),m=y.useMemo(()=>a||o?"grid-cols-1":l?"grid-cols-2":c?"grid-cols-3":"grid-cols-2 lg:grid-cols-4 xl:grid-cols-6",[a,o,l,c]);if(a){const g=p[0];return s.jsxs("div",{onClick:()=>g&&i(`/decks/${g.id}`),className:"bg-gray-950/40 border border-white/5 rounded-3xl h-full flex items-center px-4 justify-between cursor-pointer hover:bg-white/5 transition-all group overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Recent Deck"}),s.jsx("span",{className:"text-gray-700",children:""}),s.jsx("span",{className:"text-xs font-bold text-white truncate max-w-[120px]",children:g?.name||"No decks"})]}),s.jsx("div",{className:"p-1.5 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}return s.jsxs("div",{className:`bg-gray-950/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md shadow-xl h-full flex flex-col`,children:[s.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-3 shrink-0",children:[s.jsx("span",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("span",{className:o?"hidden":"inline",children:"Recent Decks"}),o&&s.jsx("span",{children:"Recent"})]}),s.jsx("div",{className:"flex-grow overflow-hidden relative",children:n?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 text-xs",children:"Loading..."}):p.length>0?s.jsxs("div",{className:`grid ${m} gap-3 md:gap-4 h-full`,children:[p.map(g=>s.jsx(wje,{deck:g,navigate:i},g.id)),u&&s.jsxs("div",{onClick:()=>i("/decks/new"),className:"border-2 border-dashed border-indigo-500/20 rounded-xl flex flex-col items-center justify-center text-center p-4 hover:border-indigo-500/40 hover:bg-indigo-500/5 transition-all group cursor-pointer",children:[s.jsx("div",{className:"p-3 rounded-full bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform mb-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-sm font-bold text-indigo-300",children:"New Deck"})]})]}):s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 bg-gray-900/30 rounded-2xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:"No decks."}),s.jsx(Er,{to:"/decks/new",className:"text-indigo-400 text-xs font-bold hover:text-indigo-300 mt-1",children:"Create "})]})})]})},jje=({data:t,size:e})=>{const{stats:r,decks:n}=t;if(!r||!r.topColor)return null;const i=e==="xs",a=e==="medium",o=e==="large",l=e==="xlarge",c=o||l,u=l?(n||[]).filter(h=>{const p=h?.commander?.color_identity||[],m=h?.commander_partner?.color_identity||[],g=[...new Set([...p,...m])].sort().join(""),b=r.topColor.pips?.sort().join("")||"C";return g===b}).slice(0,3):[];return s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${i?"p-3":"p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative overflow-hidden h-full flex flex-col justify-center`,children:[s.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 opacity-10 rounded-bl-full ${r.topColor.bg} z-0`}),s.jsxs("div",{className:`flex relative z-10 h-full ${c?"flex-row items-center gap-8":"flex-col justify-between"}`,children:[i?s.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 uppercase tracking-tighter whitespace-nowrap border border-white/10",children:"Top Identity"}),s.jsx("div",{className:`text-sm font-black tracking-tight ${r.topColor.color||"text-white"}`,children:r.topColor.name})]}),s.jsx("div",{className:"flex -space-x-2",children:r.topColor.pips?.map((h,p)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${h}.svg`,alt:h,className:"w-6 h-6 rounded-full shadow-lg transform group-hover:scale-110 transition-transform"},p))})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex flex-col",children:s.jsx("div",{className:"flex gap-1.5 mb-3",children:r.topColor.pips?.map((h,p)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${h}.svg`,alt:h,className:"w-7 h-7 shadow-lg transform group-hover:scale-110 transition-transform"},p))})}),s.jsxs("div",{className:`flex-grow ${c?"":"mt-4"}`,children:[s.jsx("div",{className:`text-2xl font-black tracking-tighter mb-1 ${r.topColor.color||"text-white"}`,children:r.topColor.name}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Top Color Identity"}),(a||c)&&s.jsxs("div",{className:"text-xs text-gray-400 italic mt-3 opacity-80 leading-relaxed border-l-2 border-white/5 pl-3 py-1",children:['"',r.topColor.flavor,'"']})]})]}),l&&s.jsxs("div",{className:"flex-grow flex gap-8 items-center border-l border-white/5 pl-8 h-full",children:[s.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1 text-center",children:"Top Commanders"}),s.jsx("div",{className:"space-y-2",children:(u.length>0?u:n.slice(0,3)).map(h=>s.jsxs("div",{className:"flex items-center gap-2 group/cmd p-1 rounded-lg hover:bg-white/5 transition-colors",children:[h.commander?.image_uris?.art_crop&&s.jsx("img",{src:h.commander.image_uris.art_crop,className:"w-8 h-6 object-cover rounded border border-white/10",alt:""}),s.jsx("span",{className:"text-[11px] text-gray-300 group-hover/cmd:text-indigo-400 truncate",children:h.commander?.name||h.name})]},h.id))})]}),s.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-4 border border-white/5 flex items-center gap-4 group/asset relative overflow-hidden",children:[s.jsxs("div",{className:"flex-grow",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-1",children:"Signature Asset"}),s.jsx("div",{className:"text-sm font-black text-white group-hover/asset:text-indigo-300 transition-colors line-clamp-1",children:"Ragavan, Nimble Pilferer"}),s.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[s.jsx("span",{className:"text-xs text-green-400 font-mono",children:"$64.20"}),s.jsx("span",{className:"text-[9px] text-gray-500 uppercase font-black",children:"Market Value"})]})]}),s.jsxs("div",{className:"w-16 h-12 rounded-lg overflow-hidden border border-white/10 relative",children:[s.jsx("img",{src:"https://cards.scryfall.io/art_crop/front/a/1/a134a6df-d264-44b2-a42e-9dcc914a1a38.jpg",className:"w-full h-full object-cover group-hover/asset:scale-110 transition-transform duration-500",alt:""}),s.jsx("div",{className:"absolute inset-0 bg-indigo-500/10 mix-blend-overlay"})]}),s.jsx("div",{className:"absolute bottom-0 right-0 p-2 opacity-20 text-[20px] font-black italic",children:"64%"})]})]})]})]})},kje=({size:t})=>{const{userProfile:e}=Or(),r=e?.settings?.organization?.mode,n=t==="xs",i=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge",u=(h=>{switch(h){case"deckbuilder":return{label:"Deckbuilder",icon:"",desc:"Sorted by Color & Type",color:"indigo"};case"collector":return{label:"Collector",icon:"",desc:"Sorted by Set & Number",color:"blue"};case"hybrid":return{label:"Hybrid",icon:"",desc:"Binders + Bulk Boxes",color:"amber"};case"custom":return{label:"Custom",icon:"",desc:"Advanced Hierarchy",color:"emerald"};default:return{label:"Reference",icon:"",desc:"Default Organization",color:"gray"}}})(r);return n?s.jsxs(Er,{to:"/settings/display",className:"bg-gray-900/60 border border-white/5 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-all group",children:[s.jsx("span",{className:"text-xl group-hover:scale-125 transition-transform",children:u.icon}),s.jsx("span",{className:"text-[10px] font-black text-gray-500 mt-1 uppercase tracking-tighter",children:"Org"})]}):s.jsxs("div",{className:"bg-gray-900/60 border border-white/5 rounded-3xl backdrop-blur-md overflow-hidden h-full flex flex-col relative group transition-all hover:border-white/10",children:[s.jsxs("div",{className:`flex items-center gap-4 ${l?"p-8 pb-4":"p-6"}`,children:[s.jsx("div",{className:`aspect-square ${i?"w-10 h-10 text-xl":"w-14 h-14 text-3xl"} flex items-center justify-center bg-gray-950 rounded-2xl shadow-inner border border-white/5 group-hover:scale-110 transition-transform`,children:u.icon}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h3",{className:"font-black text-white uppercase tracking-wider text-sm flex items-center gap-2",children:["Organization",s.jsx("span",{className:`w-1.5 h-1.5 rounded-full bg-${u.color}-500 animate-pulse`})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:`text-xl font-black text-${u.color}-400`,children:u.label}),!i&&s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tight",children:u.desc})]})]})]}),s.jsx("div",{className:"flex-grow px-6 pb-6 overflow-hidden",children:l?s.jsxs("div",{className:"flex gap-4 h-full",children:[s.jsx("div",{className:"flex-grow grid grid-cols-4 gap-3",children:[{name:"Main Binder",type:"Binder",fill:85,color:"indigo"},{name:"Bulk Box A",type:"Box",fill:40,color:"blue"},{name:"Trade Folder",type:"Binder",fill:12,color:"emerald"},{name:"Rares Box",type:"Box",fill:95,color:"amber"}].map((h,p)=>s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-2xl p-3 flex flex-col justify-between hover:bg-gray-800 transition-colors cursor-pointer group/loc",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase",children:h.type}),s.jsxs("span",{className:`text-[9px] font-bold text-${h.color}-400 px-1.5 py-0.5 bg-${h.color}-500/10 rounded-full border border-${h.color}-500/20`,children:[h.fill,"% Full"]})]}),s.jsx("div",{className:"mt-2 text-xs font-bold text-gray-300 group-hover/loc:text-white truncate",children:h.name}),s.jsx("div",{className:"mt-2 w-full bg-white/5 rounded-full h-1 overflow-hidden",children:s.jsx("div",{className:`h-full bg-${h.color}-500 transition-all duration-1000`,style:{width:`${h.fill}%`}})})]},p))}),s.jsxs("div",{className:"flex flex-col gap-2 min-w-[140px]",children:[s.jsx(Er,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl border border-dashed border-white/10 text-[10px] font-bold text-gray-500 hover:border-white/20 hover:text-white transition-all p-2 text-center",children:"Manage Storage"}),s.jsx(Er,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl bg-white/5 text-[10px] font-bold text-gray-400 hover:bg-white/10 transition-all p-2 text-center",children:"Change Mode"})]})]}):o?s.jsxs("div",{className:"flex items-center gap-6 h-full",children:[s.jsxs("div",{className:"flex-grow space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black text-gray-500 uppercase",children:[s.jsx("span",{children:"Storage Capacity"}),s.jsx("span",{className:"text-white",children:"65% Global Fill"})]}),s.jsx("div",{className:"w-full bg-gray-950 rounded-full h-3 p-0.5 border border-white/5",children:s.jsx("div",{className:`h-full bg-gradient-to-r from-${u.color}-600 to-${u.color}-400 rounded-full shadow-[0_0_10px_rgba(var(--color-primary),0.3)] transition-all duration-1000`,style:{width:"65%"}})}),s.jsxs("p",{className:"text-[10px] text-gray-500 italic",children:['"Items are currently sorted using the ',u.label,' logic. 12 binders detected."']})]}),s.jsxs(Er,{to:"/settings/display",className:"flex-shrink-0 w-1/4 h-20 bg-white/5 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-white/10 transition-all",children:[s.jsx("div",{className:"text-xs font-black text-white",children:"Advanced"}),s.jsx("div",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Settings "})]})]}):a||i?s.jsxs("div",{className:"flex flex-col justify-end h-full",children:[s.jsx("div",{className:"h-1.5 w-full bg-gray-950 rounded-full overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full bg-${u.color}-500 transition-all duration-1000`,style:{width:"65%"}})}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"65% Full"}),s.jsx(Er,{to:"/settings/display",className:"text-[10px] text-white font-bold underline-offset-4 hover:underline",children:"Settings"})]})]}):null}),s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-${u.color}-500/0 to-${u.color}-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500`})]})},XB=({title:t,icon:e,color:r,onClick:n,compact:i})=>s.jsxs("button",{onClick:n,className:`group relative overflow-hidden rounded-2xl ${i?"p-2":"p-4 md:p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 h-full w-full`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors h-full",children:[s.jsx("div",{className:`${i?"p-1.5":"p-3"} bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20`,children:e}),s.jsx("span",{className:`font-bold ${i?"text-[10px]":"text-sm"} tracking-wide text-center leading-tight`,children:t})]})]}),_je=({data:t,size:e})=>{const{userProfile:r,stats:n}=t,i=xn(),{addToast:a}=jn(),o=e==="xs",l=e==="small",c=e==="medium",u=e==="xlarge",h=()=>{const m=Vs[r?.subscription_tier||"free"].limits.decks,g=n?.uniqueDecks||0;if(m!==1/0&&g>=m){a(`Deck limit reached (${g}/${m}). Upgrade to create more!`,"error");return}i("/decks/new")},p=[{title:"New Deck",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"from-indigo-600 to-purple-600",onClick:h},{title:"Add Cards",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-blue-600 to-cyan-600",onClick:()=>i("/collection")},{title:"Browse Sets",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-green-600 to-emerald-600",onClick:()=>i("/sets")},{title:"Wishlist",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"from-pink-600 to-rose-600",onClick:()=>i("/collection?wishlist=true")}];return o?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-2",children:[s.jsx("button",{onClick:h,className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg shadow-indigo-500/40 flex items-center justify-center transform active:scale-95 transition-all",title:"New Deck",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-[10px] font-black tracking-widest uppercase mt-2 text-indigo-400",children:"New Deck"})]}):u?s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md shadow-xl h-full flex flex-col",children:[s.jsx("div",{className:"flex gap-4 mb-8",children:p.map((m,g)=>s.jsx("div",{className:"flex-1",children:s.jsx(XB,{...m,compact:!1})},g))}),s.jsxs("div",{className:"flex-grow border-t border-white/5 pt-6 overflow-hidden",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Recent Activity"}),s.jsx("div",{className:"space-y-4",children:[{text:"Deck 'Necrons' updated",time:"2h ago",icon:""},{text:"5 cards added to collection",time:"1d ago",icon:""},{text:"New wishlist item: 'Black Lotus'",time:"3d ago",icon:""}].map((m,g)=>s.jsxs("div",{className:"flex items-center justify-between text-xs bg-gray-900/50 p-3 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:m.icon}),s.jsx("span",{className:"text-gray-300",children:m.text})]}),s.jsx("span",{className:"text-gray-500 font-mono",children:m.time})]},g))})]})]}):s.jsxs("div",{className:`grid gap-2 md:gap-3 h-full ${l?"grid-cols-2":"grid-cols-2 md:grid-cols-4 items-center"}`,children:[p.map((m,g)=>s.jsx("div",{className:"min-w-0 h-full",children:s.jsx(XB,{...m,title:l?m.title.split(" ")[0]:m.title,compact:l})},g)),!l&&!c&&s.jsx("div",{className:"md:col-span-4 h-auto mt-2",children:s.jsx(kje,{})})]})},Sje=({size:t,data:e})=>{const{userProfile:r,stats:n}=e||{},i=t==="xs",a=t==="small",o=t==="large"||t==="xlarge",l=Vs[r?.subscription_tier||"free"],c={decks:n?.uniqueDecks||0,collection:n?.collectionCount||0,wishlist:n?.wishlistCount||0},u=(g,b)=>{if(b===1/0)return"bg-indigo-500";const v=g/b*100;return v>=90?"bg-red-500":v>=75?"bg-yellow-500":"bg-green-500"},h=(g,b)=>{if(b===1/0)return"100%";const v=g/b*100;return`${Math.min(v,100)}%`},p=l.limits.decks!==1/0&&c.decks/l.limits.decks>=.9||l.limits.collection!==1/0&&c.collection/l.limits.collection>=.9||l.limits.wishlist!==1/0&&c.wishlist/l.limits.wishlist>=.9;if(i)return s.jsxs(Er,{to:"/settings/membership",className:`bg-gray-900/60 border ${p?"border-red-500/40":"border-indigo-500/20"} rounded-3xl h-full flex flex-col items-center justify-center group hover:bg-gray-800 transition-all`,children:[s.jsx("span",{className:`text-xl font-black ${p?"text-red-400":"text-indigo-400"} group-hover:scale-110 transition-transform`,children:l.name[0]}),s.jsx("div",{className:"mt-1 flex gap-0.5",children:[1,2,3].map(g=>s.jsx("div",{className:`w-1 h-1 rounded-full ${p?"bg-red-500/50":"bg-indigo-500/50"}`},g))})]});const m=(g,b,v)=>{const w=u(b,v),j=h(b,v);return s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest",children:g}),s.jsxs("span",{className:"text-[9px] font-mono text-gray-400",children:[b,"/",v===1/0?"":v]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden border border-white/5 shadow-inner",children:s.jsx("div",{className:`h-full ${w} transition-all duration-1000`,style:{width:j}})})]})};return s.jsxs("div",{className:`bg-gray-900 border ${p?"border-red-500/20":"border-indigo-500/20"} rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 ${p?"bg-red-500/10 text-red-400":"bg-indigo-500/10 text-indigo-400"} rounded-xl flex items-center justify-center text-xl shadow-inner border border-white/5`,children:p?"":l.name==="Wizard"?"":""}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-black text-[10px] text-gray-500 uppercase tracking-widest",children:["Plan: ",s.jsx("span",{className:"text-white",children:l.name})]}),s.jsx("p",{className:`text-[10px] ${p?"text-red-400":"text-indigo-400"} font-black uppercase tracking-widest`,children:p?"Limit Alert":"Active"})]})]}),!a&&s.jsx(Er,{to:"/settings/membership",className:"text-[10px] font-black text-indigo-400 hover:text-white uppercase tracking-widest underline underline-offset-4 decoration-indigo-500/30",children:"Manage"})]}),s.jsxs("div",{className:`flex-grow ${o?"grid grid-cols-3 gap-6":"space-y-4"}`,children:[m("Decks",c.decks,l.limits.decks),m("Collection",c.collection,l.limits.collection),m("Wishlist",c.wishlist,l.limits.wishlist)]}),o&&s.jsxs("div",{className:"mt-6 pt-4 border-t border-white/5 flex justify-between items-center text-[10px]",children:[s.jsxs("div",{className:"text-gray-500 font-bold uppercase tracking-widest",children:["Pricing tier: ",l.name]}),s.jsx(Er,{to:"/pricing",className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-xl text-white font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:"Upgrade"})]}),a&&s.jsx(Er,{to:"/settings/membership",className:"mt-4 w-full py-2 bg-gray-800 text-center text-[10px] font-black uppercase tracking-widest text-gray-400 rounded-xl",children:"Details "})]})},Cje=({size:t})=>{const e=xn(),{addToast:r}=jn(),[n,i]=y.useState([]),[a,o]=y.useState(0),[l,c]=y.useState(!0),u=t==="xs",h=t==="small",p=t==="medium",m=t==="large",g=t==="xlarge";y.useEffect(()=>{(async()=>{try{const w=await ia.fetchRelationships(),j=w.filter(E=>E.status==="accepted");i(j);const _=w.filter(E=>E.status==="pending"&&E.direction==="incoming");o(_.length)}catch(w){console.error("Widget fetch failed",w)}finally{c(!1)}})()},[]);const b=v=>{v&&(v.preventDefault(),v.stopPropagation()),e("/settings/community")};return u?s.jsxs("div",{onClick:b,className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer hover:bg-indigo-500/20 transition-all group overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Pod Members"}),s.jsx("span",{className:"text-gray-700",children:""}),s.jsx("span",{className:"text-sm font-black text-white",children:n.length})]}),s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),a>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-indigo-500 rounded-full border border-gray-950 animate-pulse"})]})]}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${h?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/20 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-gray-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:["My Pod",a>0&&s.jsxs("span",{className:"bg-indigo-600 text-white text-[9px] font-black px-1.5 py-0.5 rounded-full animate-pulse tracking-normal",children:[a," New"]})]}),s.jsxs("div",{className:"mt-1 flex items-baseline gap-1",children:[s.jsx("span",{className:"text-3xl font-black text-white",children:n.length}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Members"})]})]}),s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),s.jsx("div",{className:"flex-grow space-y-3 relative z-10 overflow-hidden",children:l?s.jsx("div",{className:"space-y-2",children:s.jsx("div",{className:"h-10 bg-gray-800 rounded-xl animate-pulse"})}):g?s.jsxs("div",{className:"flex gap-8 h-full",children:[s.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-4",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Post to Pod"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"What's brewing?",className:"w-full bg-gray-950/80 border border-white/5 rounded-2xl p-4 pr-12 text-sm text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner"}),s.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-indigo-600 rounded-xl text-white hover:bg-indigo-500 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[n.slice(0,5).map((v,w)=>s.jsxs("div",{className:"flex flex-col items-center gap-2 group/u cursor-pointer",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"w-12 h-12 rounded-2xl bg-indigo-900 border border-indigo-500/30 flex items-center justify-center text-lg font-black text-indigo-200 uppercase group-hover/u:scale-110 group-hover/u:border-indigo-400 transition-all shadow-lg overflow-hidden",children:[v.friend.username?.[0],s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-indigo-950/50 to-transparent opacity-0 group-hover/u:opacity-100 transition-opacity"})]}),s.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-950"})]}),s.jsx("span",{className:"text-[10px] font-bold text-gray-400 group-hover/u:text-white transition-colors",children:v.friend.username})]},v.id)),s.jsx("div",{onClick:b,className:"w-12 h-12 rounded-2xl border-2 border-dashed border-white/10 flex items-center justify-center text-gray-600 hover:text-white hover:border-white/20 transition-all cursor-pointer",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}):m?s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Pod Activity"}),[{user:"Tristin",act:"updated Ghave Deck",time:"1h"},{user:"Sarah",act:"added 3 Rare cards",time:"4h"},{user:"Mike",act:"ranked #1 in Draft",time:"12h"}].map((v,w)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-950/50 rounded-xl border border-white/5 text-[11px] group/item hover:bg-gray-800 transition-colors",children:[s.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center font-bold text-indigo-300 text-[10px] uppercase shadow-sm",children:v.user[0]}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("span",{className:"font-bold text-gray-200",children:v.user})," ",s.jsx("span",{className:"text-gray-400",children:v.act})]}),s.jsx("span",{className:"text-gray-600 font-mono text-[9px]",children:v.time})]},w))]}):s.jsxs("div",{className:"space-y-2",children:[n.slice(0,p?3:2).map(v=>s.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[s.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center text-[10px] font-bold text-indigo-200 uppercase",children:v.friend.username?.[0]}),s.jsx("div",{className:"text-xs font-bold text-gray-300 truncate",children:v.friend.username})]},v.id)),n.length===0&&s.jsx("p",{className:"text-[10px] text-gray-600 italic text-center py-4",children:"No members in your pod yet."})]})}),!g&&s.jsx("button",{onClick:b,className:`w-full ${h?"py-2 text-[10px]":"py-3 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all mt-4`,children:"Manage Pod"})]})},Dg=["Just buy a new booster box? Add the cards through the set page, after organizing the cards by collector number. You can go top down, or bottom up on the list and make your life MUCH easier.","You can bulk import your collection via CSV! Check the Collection page for the template.","Right-click any card in your collection to instantly find it on TCGPlayer.","Use the 'Wishlist' filter in your collection to track cards you plan to buy.","You can separate your 'Foils' from regular printings by toggling the foil icon when adding cards.","Filter your collection by 'Rarity: Mythic' to see your big hits quickly.","The 'Price' filter helps you find those hidden gems in your bulk box.","Did you know? You can manually edit the market price of a card if you have a specific variant not tracked correctly.","Smart Binders update automatically. If you add a new Goblin to your collection, it instantly goes into your 'Goblin Tribe' binder.","You can use RegEx in Smart Binders! Example: Name matches `^Dark` finds cards starting with 'Dark'.","Want a binder for high-value cards? Set a rule for 'Price > 5.00'.","Create a 'Trade Binder' by excluding cards that are currently in a deck: `In Deck = False`.","You can combine rules! `Color Identity = R` AND `Type = Dragon` makes a perfect dragon binder.","Smart Binders can track duplicates. Set `Quantity > 4` to find cards you can trade away.","Customize your binder icons with emojis to make them stand out in the list.","Use the 'Pro Color' toggles in the Smart Creator to quickly select color identities.","When building a deck, use the 'Synergy' tab to see cards that work well with your Commander.","The Mana Curve chart updates in real-time as you add cards to your deck.","You can clone any of your existing decks to try out a new strategy without losing the original.","Use the 'Playtest' feature to draw sample hands and see if your land count is right.","Toggle 'Group by Type' in the deck view to see your creature/spell balance.","The AI Strategy tool can suggest a land base for you based on your color pips.","Add 'Tags' to cards in your deck (like 'Ramp', 'Removal') to see a custom breakdown.","You can set a card as your 'Commander' directly from the search results.","Check the 'Sideboard' tab to keep track of cards you're considering but haven't cut yet.","Invite friends to your 'Pod' to see their trade binders in real-time.","You can set your Pod permissions to 'Viewer' (read-only) or 'Editor' (trust them to modify decks).","Share your deck with a QR code! It's perfect for showing off your build at the LGS.","Link your account with a partner to build 'Team Decks' using a shared card pool.","Mark cards as 'Not for Trade' in your collection, and they won't show up for your Pod friends.","Collaborate on a deck list by giving a friend 'Editor' access in your Pod.","Keep your database healthy! Run the 'Cleanup' script periodically if you notice duplicate entries.","You can change your theme preference in the Settings menu (Dark/Light mode).","Report bugs directly from the dashboard using the 'System Status' widget.","The dollar value of your collection is an estimate based on TCGPlayer Market Price.","Use standard Scryfall syntax in the search bar. `t:creature cmc>5` works!","Hover over the KPI cards on the dashboard to see more detailed tooltips.","Click the 'Update Prices' button on the dashboard to fetch the latest market data.","You can view your deck's stats (CMC, Type distribution) on the mobile view too!","The app works offline for browsing, but you need internet to sync prices or images.","Double-click a card image to view the high-res version.","Use keyboard shortcuts! 'Ctrl/Cmd + F' usually brings up the card search."],Eje=({size:t})=>{const[e,r]=y.useState(0),[n,i]=y.useState(!1),a=t==="xs",o=t==="small",l=t==="large"||t==="xlarge";y.useEffect(()=>{const u=Math.floor(Math.random()*Dg.length);r(u)},[]);const c=u=>{n||(i(!0),setTimeout(()=>i(!1),300),r(h=>u==="next"?(h+1)%Dg.length:(h-1+Dg.length)%Dg.length))};return a?s.jsx("div",{onClick:()=>c("next"),className:"bg-yellow-500/10 border border-yellow-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-yellow-500/20 transition-all group",children:s.jsx("svg",{className:"w-6 h-6 text-yellow-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}):s.jsxs("div",{className:`bg-gray-900/50 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[s.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("svg",{className:"w-20 h-20 transform rotate-12",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"})})}),s.jsxs("h2",{className:"font-black text-white mb-2 flex items-center gap-2 relative z-10 text-[10px] uppercase tracking-widest",children:[s.jsx("span",{className:"p-1.5 bg-yellow-500/10 rounded-lg text-yellow-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),"Pro Tip"]}),s.jsxs("div",{className:"relative z-10 flex-grow flex flex-col justify-between",children:[s.jsx("p",{className:`text-gray-300 leading-relaxed transition-opacity duration-300 ${n?"opacity-0":"opacity-100"} ${l?"text-sm":"text-[11px]"}`,children:Dg[e]}),s.jsxs("div",{className:"flex items-center justify-between mt-4 border-t border-white/5 pt-3",children:[s.jsxs("span",{className:"text-[9px] text-gray-500 font-mono font-bold uppercase tracking-widest",children:["Tip ",e+1," of ",Dg.length]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c("prev"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>c("next"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]})]})},KJ=6048e5,Aje=864e5,qw=43200,QB=1440,JB=Symbol.for("constructDateFrom");function Xh(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&JB in t?t[JB](e):t instanceof Date?new t.constructor(e):new Date(e)}function oo(t,e){return Xh(e||t,t)}let Tje={};function X1(){return Tje}function Xv(t,e){const r=X1(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=oo(t,e?.in),a=i.getDay(),o=(a<n?7:0)+a-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function hj(t,e){return Xv(t,{...e,weekStartsOn:1})}function YJ(t,e){const r=oo(t,e?.in),n=r.getFullYear(),i=Xh(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=hj(i),o=Xh(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=hj(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function fj(t){const e=oo(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function gk(t,...e){const r=Xh.bind(null,t||e.find(n=>typeof n=="object"));return e.map(r)}function ZB(t,e){const r=oo(t,e?.in);return r.setHours(0,0,0,0),r}function Ije(t,e,r){const[n,i]=gk(r?.in,t,e),a=ZB(n),o=ZB(i),l=+a-fj(a),c=+o-fj(o);return Math.round((l-c)/Aje)}function Lje(t,e){const r=YJ(t,e),n=Xh(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),hj(n)}function sN(t,e){const r=+oo(t)-+oo(e);return r<0?-1:r>0?1:r}function Pje(t){return Xh(t,Date.now())}function Oje(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Rje(t){return!(!Oje(t)&&typeof t!="number"||isNaN(+oo(t)))}function Mje(t,e,r){const[n,i]=gk(r?.in,t,e),a=n.getFullYear()-i.getFullYear(),o=n.getMonth()-i.getMonth();return a*12+o}function Dje(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function Bje(t,e){return+oo(t)-+oo(e)}function $je(t,e){const r=oo(t,e?.in);return r.setHours(23,59,59,999),r}function Fje(t,e){const r=oo(t,e?.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Uje(t,e){const r=oo(t,e?.in);return+$je(r,e)==+Fje(r,e)}function zje(t,e,r){const[n,i,a]=gk(r?.in,t,t,e),o=sN(i,a),l=Math.abs(Mje(i,a));if(l<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-o*l);let c=sN(i,a)===-o;Uje(n)&&l===1&&sN(n,a)===1&&(c=!1);const u=o*(l-+c);return u===0?0:u}function qje(t,e,r){const n=Bje(t,e)/1e3;return Dje(r?.roundingMethod)(n)}function Vje(t,e){const r=oo(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Hje={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Wje=(t,e,r)=>{let n;const i=Hje[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function tC(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Gje={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Kje={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Yje={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Xje={date:tC({formats:Gje,defaultWidth:"full"}),time:tC({formats:Kje,defaultWidth:"full"}),dateTime:tC({formats:Yje,defaultWidth:"full"})},Qje={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Jje=(t,e,r,n)=>Qje[t];function ky(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r?.width?String(r.width):o;i=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r?.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return i[a]}}const Zje={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},e4e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},t4e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},r4e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},n4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},s4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},i4e=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},a4e={ordinalNumber:i4e,era:ky({values:Zje,defaultWidth:"wide"}),quarter:ky({values:e4e,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ky({values:t4e,defaultWidth:"wide"}),day:ky({values:r4e,defaultWidth:"wide"}),dayPeriod:ky({values:n4e,defaultWidth:"wide",formattingValues:s4e,defaultFormattingWidth:"wide"})};function _y(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?l4e(l,p=>p.test(o)):o4e(l,p=>p.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const h=e.slice(o.length);return{value:u,rest:h}}}function o4e(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function l4e(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function c4e(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(i.length);return{value:o,rest:l}}}const u4e=/^(\d+)(th|st|nd|rd)?/i,d4e=/\d+/i,h4e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},f4e={any:[/^b/i,/^(a|c)/i]},p4e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},m4e={any:[/1/i,/2/i,/3/i,/4/i]},g4e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},x4e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},b4e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},y4e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},v4e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},w4e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},N4e={ordinalNumber:c4e({matchPattern:u4e,parsePattern:d4e,valueCallback:t=>parseInt(t,10)}),era:_y({matchPatterns:h4e,defaultMatchWidth:"wide",parsePatterns:f4e,defaultParseWidth:"any"}),quarter:_y({matchPatterns:p4e,defaultMatchWidth:"wide",parsePatterns:m4e,defaultParseWidth:"any",valueCallback:t=>t+1}),month:_y({matchPatterns:g4e,defaultMatchWidth:"wide",parsePatterns:x4e,defaultParseWidth:"any"}),day:_y({matchPatterns:b4e,defaultMatchWidth:"wide",parsePatterns:y4e,defaultParseWidth:"any"}),dayPeriod:_y({matchPatterns:v4e,defaultMatchWidth:"any",parsePatterns:w4e,defaultParseWidth:"any"})},XJ={code:"en-US",formatDistance:Wje,formatLong:Xje,formatRelative:Jje,localize:a4e,match:N4e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function j4e(t,e){const r=oo(t,e?.in);return Ije(r,Vje(r))+1}function k4e(t,e){const r=oo(t,e?.in),n=+hj(r)-+Lje(r);return Math.round(n/KJ)+1}function QJ(t,e){const r=oo(t,e?.in),n=r.getFullYear(),i=X1(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=Xh(e?.in||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Xv(o,e),c=Xh(e?.in||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=Xv(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function _4e(t,e){const r=X1(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=QJ(t,e),a=Xh(e?.in||t,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),Xv(a,e)}function S4e(t,e){const r=oo(t,e?.in),n=+Xv(r,e)-+_4e(r,e);return Math.round(n/KJ)+1}function fs(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const e0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return fs(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):fs(r+1,2)},d(t,e){return fs(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(t,e){return fs(t.getHours()%12||12,e.length)},H(t,e){return fs(t.getHours(),e.length)},m(t,e){return fs(t.getMinutes(),e.length)},s(t,e){return fs(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return fs(i,e.length)}},Bg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},e$={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return e0.y(t,e)},Y:function(t,e,r,n){const i=QJ(t,n),a=i>0?i:1-i;if(e==="YY"){const o=a%100;return fs(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):fs(a,e.length)},R:function(t,e){const r=YJ(t);return fs(r,e.length)},u:function(t,e){const r=t.getFullYear();return fs(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return fs(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return fs(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return e0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return fs(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=S4e(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):fs(i,e.length)},I:function(t,e,r){const n=k4e(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):fs(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):e0.d(t,e)},D:function(t,e,r){const n=j4e(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):fs(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return fs(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return fs(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return fs(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=Bg.noon:n===0?i=Bg.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=Bg.evening:n>=12?i=Bg.afternoon:n>=4?i=Bg.morning:i=Bg.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return e0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):e0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):fs(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):fs(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):e0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):e0.s(t,e)},S:function(t,e){return e0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return r$(n);case"XXXX":case"XX":return xp(n);default:return xp(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return r$(n);case"xxxx":case"xx":return xp(n);default:return xp(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+t$(n,":");default:return"GMT"+xp(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+t$(n,":");default:return"GMT"+xp(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return fs(n,e.length)},T:function(t,e,r){return fs(+t,e.length)}};function t$(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+e+fs(a,2)}function r$(t,e){return t%60===0?(t>0?"-":"+")+fs(Math.abs(t)/60,2):xp(t,e)}function xp(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=fs(Math.trunc(n/60),2),a=fs(n%60,2);return r+i+e+a}const n$=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},JJ=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},C4e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return n$(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",n$(n,e)).replace("{{time}}",JJ(i,e))},E4e={p:JJ,P:C4e},A4e=/^D+$/,T4e=/^Y+$/,I4e=["D","DD","YY","YYYY"];function L4e(t){return A4e.test(t)}function P4e(t){return T4e.test(t)}function O4e(t,e,r){const n=R4e(t,e,r);if(console.warn(n),I4e.includes(t))throw new RangeError(n)}function R4e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const M4e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,D4e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,B4e=/^'([^]*?)'?$/,$4e=/''/g,F4e=/[a-zA-Z]/;function Gi(t,e,r){const n=X1(),i=n.locale??XJ,a=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,l=oo(t,r?.in);if(!Rje(l))throw new RangeError("Invalid time value");let c=e.match(D4e).map(h=>{const p=h[0];if(p==="p"||p==="P"){const m=E4e[p];return m(h,i.formatLong)}return h}).join("").match(M4e).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const p=h[0];if(p==="'")return{isToken:!1,value:U4e(h)};if(e$[p])return{isToken:!0,value:h};if(p.match(F4e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:h}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:i};return c.map(h=>{if(!h.isToken)return h.value;const p=h.value;(P4e(p)||L4e(p))&&O4e(p,e,String(t));const m=e$[p[0]];return m(l,p,i.localize,u)}).join("")}function U4e(t){const e=t.match(B4e);return e?e[1].replace($4e,"'"):t}function z4e(t,e,r){const n=X1(),i=r?.locale??n.locale??XJ,a=2520,o=sN(t,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:o}),[c,u]=gk(r?.in,...o>0?[e,t]:[t,e]),h=qje(u,c),p=(fj(u)-fj(c))/1e3,m=Math.round((h-p)/60);let g;if(m<2)return r?.includeSeconds?h<5?i.formatDistance("lessThanXSeconds",5,l):h<10?i.formatDistance("lessThanXSeconds",10,l):h<20?i.formatDistance("lessThanXSeconds",20,l):h<40?i.formatDistance("halfAMinute",0,l):h<60?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",1,l):m===0?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",m,l);if(m<45)return i.formatDistance("xMinutes",m,l);if(m<90)return i.formatDistance("aboutXHours",1,l);if(m<QB){const b=Math.round(m/60);return i.formatDistance("aboutXHours",b,l)}else{if(m<a)return i.formatDistance("xDays",1,l);if(m<qw){const b=Math.round(m/QB);return i.formatDistance("xDays",b,l)}else if(m<qw*2)return g=Math.round(m/qw),i.formatDistance("aboutXMonths",g,l)}if(g=zje(u,c),g<12){const b=Math.round(m/qw);return i.formatDistance("xMonths",b,l)}else{const b=g%12,v=Math.trunc(g/12);return b<3?i.formatDistance("aboutXYears",v,l):b<9?i.formatDistance("overXYears",v,l):i.formatDistance("almostXYears",v+1,l)}}function q4e(t,e){return z4e(t,Pje(t),e)}const V4e=({isOpen:t,onClose:e,release:r})=>{const[n,i]=y.useState(!1);return y.useEffect(()=>(i(!0),()=>i(!1)),[]),!t||!r||!n?null:Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",onClick:e,children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl w-full max-w-2xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] animate-slide-up",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-start bg-gray-950/50",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-1",children:r.version}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("span",{className:"text-xs text-gray-400 font-mono uppercase",children:["Released ",Gi(new Date(r.released_at),"MMMM d, yyyy")]})})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar bg-gray-900/50",children:[s.jsxs("div",{className:"flex gap-4 mb-6",children:[r.stats?.features>0&&s.jsx("div",{className:"px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:[r.stats.features," New Features"]})}),r.stats?.bugs>0&&s.jsx("div",{className:"px-3 py-1 bg-red-500/10 border border-red-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-red-400 uppercase tracking-wider",children:[r.stats.bugs," Bug Fixes"]})})]}),s.jsx("div",{className:"prose prose-invert prose-lg max-w-none prose-headings:text-indigo-300 prose-a:text-indigo-400 prose-strong:text-white",dangerouslySetInnerHTML:{__html:r.notes}})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/30 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Close"})})]})}),document.body)},H4e=({size:t})=>{const[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(null),l=t==="xs",c=t==="small",u=t==="large",h=t==="xlarge",p=u||h;return y.useEffect(()=>{(async()=>{try{const g=await Ge.getReleases();r(g||[])}catch(g){console.error("Failed to load releases",g)}finally{i(!1)}})()},[]),l?s.jsx("div",{onClick:()=>o(e[0]),className:"bg-green-900/10 border border-green-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-green-500/20 transition-all group",children:s.jsxs("div",{className:"relative",children:[s.jsx("svg",{className:"w-6 h-6 text-green-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-gray-950 animate-pulse"})]})}):s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md flex flex-col h-full overflow-hidden relative group`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[s.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[s.jsx("span",{className:"p-1.5 bg-green-500/10 rounded-lg text-green-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),"Release Log"]}),p&&e[0]&&s.jsxs("span",{className:"text-[10px] font-mono text-green-400 font-bold px-2 py-0.5 bg-green-500/10 rounded-full border border-green-500/20",children:["Current: ",e[0].version]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar relative z-10",children:n?s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Loading updates..."}):h&&e[0]?s.jsxs("div",{className:"flex gap-8 h-full",children:[s.jsxs("div",{className:"min-w-[180px] flex flex-col justify-center",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Newest Version"}),s.jsx("div",{className:"text-2xl lg:text-3xl font-black text-white mb-2 break-all leading-tight",children:e[0].version}),s.jsx("div",{className:"text-[10px] text-gray-400 font-mono mb-4",children:Gi(new Date(e[0].released_at),"MMMM yyyy")}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[s.jsx("div",{className:"w-8 h-1 bg-emerald-500 rounded-full group-hover:w-10 transition-all"}),s.jsxs("span",{className:"text-[10px] font-black text-emerald-400 uppercase",children:[e[0].stats?.features||0," Features"]})]}),s.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[s.jsx("div",{className:"w-6 h-1 bg-red-500 rounded-full group-hover:w-8 transition-all"}),s.jsxs("span",{className:"text-[10px] font-black text-red-400 uppercase",children:[e[0].stats?.bugs||0," Bugfixes"]})]})]})]}),s.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-6 border border-white/5 relative group/notes overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-3 bg-indigo-500"})," Highlights"]}),s.jsx("div",{className:"space-y-3 overflow-hidden text-xs text-gray-400 line-clamp-4",dangerouslySetInnerHTML:{__html:e[0].notes}}),s.jsxs("button",{onClick:()=>o(e[0]),className:"mt-auto pt-4 text-[10px] font-black text-indigo-400 uppercase tracking-wider hover:text-white transition-colors flex items-center gap-1 group/btn",children:["Open Changelog ",s.jsx("svg",{className:"w-3 h-3 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),s.jsxs("div",{className:"min-w-[150px] border-l border-white/5 pl-8 flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4",children:"Past Updates"}),s.jsx("div",{className:"space-y-4",children:e.slice(1,4).map(m=>s.jsxs("div",{onClick:()=>o(m),className:"cursor-pointer group/hist",children:[s.jsx("div",{className:"text-xs font-black text-gray-300 group-hover/hist:text-white transition-colors",children:m.version}),s.jsx("div",{className:"text-[9px] text-gray-600 font-mono mt-0.5",children:Gi(new Date(m.released_at),"MMM d, yyyy")})]},m.id))})]})]}):u&&e[0]?s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-4 border border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[s.jsxs("h3",{className:"text-sm font-black text-white",children:[e[0].version," Patch Notes"]}),s.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:Gi(new Date(e[0].released_at),"MMMM yyyy")})]}),s.jsx("div",{className:"space-y-2 opacity-80 overflow-hidden max-h-[100px] text-xs",dangerouslySetInnerHTML:{__html:e[0].notes}}),s.jsx("button",{onClick:()=>o(e[0]),className:"mt-4 text-[10px] font-black text-green-400 uppercase tracking-widest hover:text-white transition-colors",children:"Read Full Notes "})]})}):s.jsx("div",{className:"space-y-2 h-full",children:e.length===0?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-50 pb-4",children:[s.jsx("svg",{className:"w-8 h-8 text-gray-600 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("div",{className:"text-[10px] font-black uppercase text-gray-500 tracking-widest",children:"No Updates Found"})]}):e.slice(0,c?1:2).map(m=>s.jsxs("div",{onClick:()=>o(m),className:"bg-gray-950/30 border border-white/5 rounded-xl p-3 flex items-center justify-between group cursor-pointer hover:bg-white/5 transition-all",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-black text-white text-sm",children:m.version}),s.jsx("div",{className:"text-[9px] text-gray-500 font-mono uppercase mt-0.5",children:Gi(new Date(m.released_at),"MMM d")})]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-green-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},m.id))})}),s.jsx(V4e,{isOpen:!!a,onClose:()=>o(null),release:a}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/0 to-green-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},W4e=({size:t})=>{const e=xn(),[r,n]=y.useState({online:0,pending:0,total:0}),i=t==="xs",a=t==="small",o=t==="large"||t==="xlarge";return y.useEffect(()=>{(async()=>{try{const c=await Ge.get("/api/friends"),u=c.pending_received?.length||0,h=c.friends?.length||0;n({online:0,pending:u,total:h})}catch(c){console.error(c)}})()},[]),i?s.jsxs("div",{onClick:()=>e("/social"),className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[s.jsxs("div",{className:"relative",children:[s.jsx(cm,{size:18,className:"text-indigo-400 group-hover:scale-110 transition-transform"}),r.pending>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border border-gray-950 animate-bounce"})]}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-1",children:r.total})]}):s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-sm hover:border-gray-700 transition-colors flex flex-col h-full overflow-hidden`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400",children:s.jsx(cm,{size:a?16:20})}),s.jsx("span",{className:`font-black tracking-tight text-white uppercase ${a?"text-[10px]":"text-xs"}`,children:"Community"})]}),r.pending>0&&s.jsxs("div",{className:"flex items-center justify-center px-2 py-0.5 bg-red-500/20 text-red-400 rounded-full border border-red-500/30 text-[9px] font-black animate-pulse",children:[s.jsx(PA,{size:10,className:"mr-1"}),r.pending," NEW"]})]}),s.jsx("div",{className:"flex-grow",children:o?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-4xl font-black text-white",children:r.total}),s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Total Connections"})]}),s.jsxs("div",{className:"pt-4 border-t border-white/5",children:[s.jsx("h4",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-3",children:"Recent Pings"}),s.jsx("div",{className:"space-y-2",children:["GhaveMaster sent a trade","CommanderSarah shared a deck"].map((l,c)=>s.jsxs("div",{className:"text-[10px] text-gray-300 flex items-center gap-2 bg-gray-950/40 p-2 rounded-lg border border-white/5",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-indigo-500"}),l]},c))})]})]}):s.jsxs("div",{children:[s.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:r.total}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:"Friends Connected"})]})}),s.jsx("button",{onClick:()=>e("/social"),className:`mt-4 w-full ${a?"py-1.5 text-[10px]":"py-2.5 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all`,children:"View Hub"})]})},G4e=({isOpen:t,onClose:e,onConfirm:r,type:n,targetId:i,loading:a,activeSession:o})=>t?Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900/90 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 pointer-events-none"}),s.jsxs("div",{className:"p-8 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center text-2xl border border-indigo-500/30 text-indigo-400",children:""}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Start ",n.charAt(0).toUpperCase()+n.slice(1)," Audit"]}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Verify your physical ownership"})]})]}),s.jsxs("div",{className:"space-y-4 mb-8",children:[o?s.jsxs("div",{className:"border border-red-500/30 bg-red-900/20 p-4 rounded-xl",children:[s.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Previous Audit In Progress"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["You have an active ",s.jsx("strong",{children:o.type})," audit. Starting this new audit will ",s.jsx("strong",{children:"cancel and delete"})," the existing session."]})]}):s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:"How it works:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"1."}),s.jsx("span",{children:"We'll create a snapshot of your current digital list."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"2."}),s.jsx("span",{children:"You'll verify each card physically."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"3."}),s.jsx("span",{children:"Finalize to reconcile any differences."})]})]})]}),!o&&s.jsxs("div",{className:"flex items-center gap-3 text-sm text-blue-400 bg-blue-500/10 p-3 rounded-lg border border-blue-500/20",children:[s.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:"Only one active audit allowed. This will be your active session."})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white font-medium transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:a,className:`px-6 py-2 font-bold rounded-xl shadow-lg transition-all transform hover:scale-105 active:scale-95 flex items-center gap-2 disabled:opacity-50 ${o?"bg-red-600 hover:bg-red-500 text-white shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20"}`,children:[a?"Starting...":o?"Overwrite & Start":"Begin Audit",!a&&s.jsx("span",{className:"opacity-70",children:""})]})]})]})]})}),document.body):null;function xk({type:t,targetId:e,label:r="Start Audit",className:n=""}){const[i,a]=y.useState(!1),[o,l]=y.useState(!1),c=xn(),[u,h]=y.useState(null),p=async()=>{a(!0);try{u&&await Ge.cancelAudit(u.id);const g=await Ge.startAudit({type:t,targetId:e});c(`/audit/${g.id}`)}catch(g){console.error(g),alert("Failed to start audit: "+g.message)}finally{a(!1),l(!1),h(null)}},m=async()=>{a(!0);try{const g=await Ge.getActiveAudit();if(g){const b=g.type===t,v=!e||String(g.target_id)===String(e);if(b&&v){c(`/audit/${g.id}`);return}h(g),l(!0);return}h(null),l(!0)}catch(g){console.error(g),l(!0)}finally{a(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:m,className:`flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors shadow-lg shadow-indigo-500/20 disabled:opacity-50 ${n}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),r]}),s.jsx(G4e,{isOpen:o,onClose:()=>l(!1),onConfirm:p,type:t,loading:i,activeSession:u})]})}function K4e({size:t}){const[e,r]=y.useState(null),[n,i]=y.useState(null),[a,o]=y.useState(!0),[l,c]=y.useState(!1),u=xn(),{userProfile:h}=Or(),p=t==="xs",m=t==="small",g=t==="large",b=t==="xlarge",v=g||b;y.useEffect(()=>{(async()=>{try{const M=await Ge.getActiveAudit();if(r(M),M){const $=await Ge.get(`/api/audit/${M.id}/stats`);i($)}}catch(M){console.error("Failed to check audit status",M)}finally{o(!1)}})()},[]);const{features:w}=Ln(h?.subscription_tier);if(!w.collectionAudit)return p?s.jsx("div",{onClick:()=>u("/settings/membership"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center opacity-75 cursor-pointer hover:opacity-100 border border-gray-800",children:s.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}):s.jsxs("div",{className:"bg-gray-900/50 rounded-3xl p-4 border border-gray-800 transition-all group relative overflow-hidden flex flex-col h-full opacity-75 hover:opacity-100",children:[s.jsx("div",{className:"flex justify-between items-start mb-1 relative z-10",children:s.jsx("h3",{className:"text-gray-400 text-xs font-medium uppercase tracking-widest",children:"Audit"})}),s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[s.jsx("p",{className:"text-[10px] text-gray-500 mb-2",children:"Unlock Wizard tier to audit your collection."}),s.jsx("button",{onClick:()=>u("/settings/membership"),className:"text-[9px] font-bold uppercase tracking-widest text-indigo-400 border border-indigo-500/30 px-3 py-1.5 rounded-lg hover:bg-indigo-500/20",children:"Upgrade"})]})]});if(a)return null;if(!e)return p?s.jsx("div",{onClick:()=>u("/audit"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center cursor-pointer border border-gray-800 group transition-all",children:s.jsx("svg",{className:"w-6 h-6 text-gray-600 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 002-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${m?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/10 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[s.jsx("h3",{className:"text-gray-400 text-xs font-medium tracking-widest uppercase",children:"Collection Audit"}),s.jsx("div",{className:"text-gray-600 group-hover:text-indigo-400 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),s.jsx("div",{className:"mt-auto relative z-10 flex flex-col gap-2",children:s.jsx(xk,{type:"collection",label:"Start Audit",className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-xs transition-all active:scale-95 shadow-lg shadow-indigo-900/20 border-none"})})]});const j=Math.ceil((new Date(e.expires_at)-new Date)/(1e3*60*60*24)),_=n?.total_cards||0,E=n?.total_reviewed||0,I=n?.mismatches?.length||0,O=E-I,B=_-E,S=_>0?Math.round(E/_*100):0;return p?s.jsxs("div",{onClick:()=>u("/audit"),className:"bg-indigo-900/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer border border-indigo-500/30 group transition-all hover:bg-indigo-900/30 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-indigo-500/10 text-indigo-400/80 uppercase tracking-tighter whitespace-nowrap border border-indigo-500/20",children:"Audit Progress"}),s.jsxs("span",{className:"text-sm font-black text-white",children:[S,"%"]})]}),s.jsxs("div",{className:"relative w-8 h-8 flex items-center justify-center",children:[s.jsx("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:s.jsx("circle",{cx:"50%",cy:"50%",r:"30%",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${S*.63} 100`,strokeLinecap:"round",className:"text-indigo-500"})}),s.jsx("svg",{className:"w-3 h-3 text-indigo-400/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})]})]}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${m?"p-4":"p-6"} border border-indigo-500/20 hover:border-indigo-500/40 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none"}),s.jsxs("div",{className:`flex relative z-10 h-full ${b?"flex-row items-center gap-12":"flex-col"}`,children:[s.jsxs("div",{className:b?"min-w-[140px]":"mb-4",children:[s.jsxs("h3",{className:"text-indigo-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2 mb-1",children:["Live Audit",s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"})]}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsxs("span",{className:`${b?"text-5xl":"text-3xl"} font-black text-white`,children:[S,"%"]}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Complete"})]}),v&&s.jsxs("div",{className:"mt-2 text-[10px] text-gray-400 font-bold uppercase tracking-tighter",children:[j," days remaining"]})]}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:"w-full bg-gray-800 rounded-full h-1.5 overflow-hidden mb-3",children:s.jsx("div",{className:"bg-indigo-500 h-full transition-all duration-1000",style:{width:`${S}%`}})}),b?s.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-1",children:"Matches"}),s.jsx("span",{className:"text-xl font-black text-white",children:O}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Confirmed valid"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-1",children:"Mismatches"}),s.jsx("span",{className:"text-xl font-black text-white",children:I}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Action required"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Pending"}),s.jsx("span",{className:"text-xl font-black text-white",children:B}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase text-nowrap",children:"Cards remaining"})]})]}):s.jsxs("div",{className:`flex justify-between text-[10px] font-bold uppercase tracking-widest ${m?"hidden":"flex"}`,children:[s.jsxs("span",{className:"text-green-500",children:[O," Match"]}),s.jsxs("span",{className:"text-red-500",children:[I," Diff"]}),s.jsxs("span",{className:"text-gray-500",children:[B," Left"]})]})]}),s.jsxs("div",{className:`${b?"min-w-[200px] border-l border-white/5 pl-8 h-full flex flex-col justify-center":"mt-4"}`,children:[g&&n?.mismatches?.length>0&&s.jsxs("div",{className:"mb-4 space-y-1.5",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Critical Delta Items"}),n.mismatches.slice(0,2).map((T,M)=>s.jsxs("div",{className:"text-[11px] text-gray-400 truncate flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-1 rounded-full bg-red-500"}),T.card_name]},M))]}),s.jsx("button",{onClick:()=>u("/audit"),className:"w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-[10px] transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:b?"Open Full Report":"Resume Audit "}),b&&s.jsx("button",{onClick:()=>c(!0),className:"mt-2 w-full py-2 text-[9px] font-bold text-gray-500 uppercase tracking-widest hover:text-white transition-colors",children:"How to Audit?"})]})]})]})}const Y4e=({size:t})=>{const[e,r]=y.useState({history:[],pointer:-1});y.useEffect(()=>(r({history:Ap.getLog(),pointer:Ap.pointer}),Ap.subscribe(u=>{r({history:u.history,pointer:u.pointer})})),[]);const{history:n}=e,i=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge";return n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:[s.jsx("svg",{className:"w-8 h-8 mb-2 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("div",{className:"text-xs font-bold uppercase tracking-wider",children:"No Recent Activity"})]}):s.jsxs("div",{className:"h-full flex flex-col bg-gray-900/40 backdrop-blur-md rounded-3xl overflow-hidden border border-white/5",children:[s.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-center bg-black/20",children:[s.jsxs("h3",{className:"text-xs font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"}),"Session History"]}),s.jsxs("span",{className:"text-[10px] text-gray-600 font-mono",children:[n.length," Actions"]})]}),s.jsx("div",{className:`flex-grow overflow-y-auto custom-scrollbar ${i?"p-2":"p-4"}`,children:s.jsx("div",{className:"space-y-2",children:n.map((c,u)=>{const h=n.length-1-u===e.pointer;return s.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-xl transition-all border ${h?"bg-cyan-500/10 border-cyan-500/30":"bg-black/20 border-white/5 hover:bg-white/5"}`,children:[s.jsx("div",{className:`mt-0.5 p-1.5 rounded-lg ${h?"bg-cyan-500/20 text-cyan-400":"bg-gray-800 text-gray-500"}`,children:h?s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}):s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:`text-xs font-bold ${h?"text-cyan-100":"text-gray-300"}`,children:c.action}),s.jsx("div",{className:"text-[10px] text-gray-500 font-mono mt-0.5",children:new Date(c.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]},c.timestamp)})})}),(a||o||l)&&s.jsx("div",{className:"p-3 bg-black/20 border-t border-white/5 text-[10px] text-gray-500 text-center font-mono",children:"Press Ctrl+Z to Undo  Ctrl+Y to Redo"})]})},ZJ={findMatches:async t=>{try{const r=(await Ge.get(`/api/collection?userId=${t}&wishlist=true`)).map(o=>({id:o.scryfall_id,name:o.name,set:o.set_code,wishlistId:o.id}));if(r.length===0)return[];const i=(await ia.fetchRelationships()).filter(o=>o.status==="accepted").map(o=>o.friend);if(i.length===0)return[];const a=[];return await Promise.all(i.map(async o=>{try{(await Ge.get(`/api/collection?userId=${o.id}&public=true`)).forEach(c=>{r.find(h=>h.id===c.scryfall_id)&&a.push({cardName:c.name,cardId:c.scryfall_id,set:c.set_code,finish:c.finish,friendName:o.username,friendId:o.id,quantity:c.count,image:c.image_uri||c.data?.image_uris?.normal})})}catch(l){console.warn(`Failed to fetch collection for ${o.username}`,l)}})),a}catch(e){throw console.error("TradeService findMatches failed:",e),e}},findReverseMatches:async t=>[]},X4e=({size:t="medium"})=>{const{currentUser:e,userProfile:r}=Or(),[n,i]=y.useState(0),[a,o]=y.useState(!0),[l,c]=y.useState(!1);return y.useEffect(()=>{if(!e||!r?.id||l)return;let u=!0;return(async()=>{try{const p=await ZJ.findMatches(r.id);u&&i(p?.length||0)}catch(p){!navigator.onLine||p.message?.includes("HTML")||p.message?.includes("403")||console.warn("Widget trade check failed",p),u&&c(!0)}finally{u&&o(!1)}})(),()=>{u=!1}},[e,r?.id,l]),a?s.jsx("div",{className:"h-full w-full bg-gray-800 rounded-2xl animate-pulse flex items-center justify-center",children:s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700"})}):s.jsx(Er,{to:"/armory",className:"block h-full w-full group",children:s.jsxs("div",{className:"h-full w-full bg-gradient-to-br from-indigo-900/50 to-gray-900 border border-indigo-500/30 hover:border-indigo-400 rounded-2xl p-4 flex flex-col justify-between relative overflow-hidden transition-all hover:shadow-[0_0_20px_rgba(99,102,241,0.3)]",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-600/10 rounded-full blur-3xl -mr-10 -mt-10 transition-all group-hover:bg-indigo-600/20"}),s.jsx("div",{className:"flex justify-between items-start z-10",children:s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:text-white group-hover:bg-indigo-500 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})})}),s.jsxs("div",{className:"z-10",children:[s.jsx("div",{className:"text-3xl font-bold text-white mb-1 group-hover:scale-105 transition-transform origin-left",children:n>0?n:"No"}),s.jsx("div",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:n===1?"Trade Match":"Trade Matches"}),n>0&&s.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"Cards available in your Pod"})]})]})})},Q4e={new_deck:{title:"New Deck",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),gradient:"from-indigo-600 to-purple-600",action:({navigate:t,addToast:e,userProfile:r,stats:n})=>{const i=Vs[r?.subscription_tier||"free"].limits.decks,a=n?.uniqueDecks||0;if(i!==1/0&&a>=i){e(`Deck limit reached (${a}/${i}).`,"error");return}t("/decks/new")}},add_cards:{title:"Add Cards",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-blue-600 to-cyan-600",action:({navigate:t})=>t("/collection")},browse_sets:{title:"Browse Sets",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-green-600 to-emerald-600",action:({navigate:t})=>t("/sets")},wishlist:{title:"Wishlist",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),gradient:"from-pink-600 to-rose-600",action:({navigate:t})=>t("/collection?wishlist=true")},tournaments:{title:"Tournaments",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),gradient:"from-yellow-600 to-orange-600",action:({navigate:t})=>t("/tournaments")}},Sy=({actionType:t,data:e,size:r})=>{const n=xn(),{addToast:i}=jn(),{userProfile:a,stats:o,decks:l}=e||{},c=r==="xs",u=r==="small",h=r==="large"||r==="xlarge",p=Q4e[t];if(!p)return null;const m=()=>{p.action&&p.action({navigate:n,addToast:i,userProfile:a,stats:o})};return c?s.jsxs("button",{onClick:m,className:"group relative overflow-hidden rounded-3xl w-full h-full flex items-center justify-between px-4 transition-all active:scale-95 border border-white/5 bg-gray-900/40",title:p.title,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${p.gradient} opacity-0 group-hover:opacity-20 transition-opacity`}),s.jsx("div",{className:"flex items-center gap-2 relative z-10",children:s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 group-hover:text-white uppercase tracking-tighter whitespace-nowrap border border-white/10",children:p.title})}),s.jsx("div",{className:"p-1.5 rounded-lg bg-gray-950/50 text-white group-hover:scale-110 transition-transform relative z-10",children:Pe.cloneElement(p.icon,{className:"w-4 h-4"})})]}):s.jsxs("button",{onClick:m,className:`group relative overflow-hidden rounded-3xl ${u?"p-4":"p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 w-full h-full flex flex-col justify-center items-center bg-gray-900/40`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${p.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors",children:[s.jsx("div",{className:`${u?"p-2":"p-4"} bg-gray-950/50 rounded-2xl backdrop-blur-sm group-hover:scale-110 transition-all group-hover:bg-white/10 ring-1 ring-white/5 shadow-inner`,children:p.icon}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:`${u?"text-[10px]":"text-sm"} font-black uppercase tracking-widest`,children:p.title}),h&&s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1 opacity-0 group-hover:opacity-100 transition-opacity line-clamp-1",children:t==="new_deck"?"Start your next brew":t==="add_cards"?"Grow your collection":"Quick Access"})]})]})]})},J4e=({size:t,actions:e})=>{const{setIsIssueModalOpen:r}=e,[n,i]=y.useState([]),[a,o]=y.useState(!1),l=t==="xs",c=t==="small",u=t==="large"||t==="xlarge";y.useEffect(()=>{l||(o(!0),Ge.getTickets({limit:5}).then(p=>i(Array.isArray(p)?p:[])).catch(p=>console.error("[SystemStatus] Load error:",p)).finally(()=>o(!1)))},[t]);const h=p=>{switch(p){case"completed":return"text-green-400";case"in_progress":return"text-yellow-400";case"planned":return"text-blue-400";default:return"text-gray-400"}};return l?s.jsxs("div",{onClick:()=>r(!0),className:"bg-indigo-500/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[s.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(99,102,241,0.5)] group-hover:scale-125 transition-transform"}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-2 uppercase tracking-widest",children:"Support"})]}):s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h2",{className:"font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),"Support Hub"]}),u&&s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold mt-1",children:"Live Updates & Feedback"})]}),!c&&s.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-green-500/10 rounded-lg border border-green-500/20",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-bold text-green-400 uppercase tracking-tighter",children:"Systems Live"})]})]}),s.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[a&&n.length===0?s.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 text-xs",children:"Fetching tickets..."}):n.length>0?s.jsx("div",{className:"space-y-3",children:n.slice(0,u?4:2).map(p=>s.jsxs("div",{className:"group flex flex-col p-2.5 bg-gray-950/40 border border-white/5 rounded-xl hover:bg-gray-800/60 transition-colors cursor-pointer",onClick:()=>r(!0),children:[s.jsxs("div",{className:"flex justify-between items-start gap-2",children:[s.jsx("span",{className:"text-xs text-white font-medium truncate group-hover:text-indigo-400 transition-colors",children:p.title}),s.jsx("span",{className:`text-[9px] font-black uppercase px-1.5 py-0.5 rounded bg-white/5 ${h(p.status)} border border-white/5 whitespace-nowrap`,children:p.status?.replace("_"," ")})]}),u&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),p.votes||0]}),s.jsxs("div",{className:"text-[10px] text-gray-600",children:[" by ",p.created_by_username||"user"]})]})]},p.id))}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 italic mb-2",children:"No active tickets."}),!c&&s.jsx("p",{className:"text-[10px] text-gray-600 uppercase",children:"Found a bug? Use the button below."})]}),!u&&n.length>2&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-gray-900/40 to-transparent pointer-events-none"})]}),s.jsxs("button",{onClick:()=>r(!0),className:`w-full ${c?"h-10 text-xs":"h-12 text-sm"} bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-lg hover:shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 mt-4 shrink-0`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Report Issue"]})]})},Z4e=({size:t,actions:e})=>{const{setShowBinderGuide:r,setShowPodGuide:n,setShowAuditGuide:i}=e,a=t==="xs",o=t==="small",l=t==="large",c=t==="xlarge",u=l||c;if(a)return s.jsx("div",{onClick:()=>r(!0),className:"bg-blue-900/10 border border-blue-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-blue-500/20 transition-all group",children:s.jsx("svg",{className:"w-6 h-6 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})});const h=[{title:"Smart Binders",desc:"Automate your collection logic",icon:"",color:"indigo",progress:80,onClick:()=>r(!0)},{title:"Pods & Sharing",desc:"Manage permissions & social",icon:"",color:"purple",progress:40,onClick:()=>n(!0)},{title:"Verification",desc:"Maintain inventory accuracy",icon:"",color:"green",progress:0,onClick:()=>i(!0)}];return s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col group relative overflow-hidden`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[s.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[s.jsx("span",{className:"p-1.5 bg-blue-500/10 rounded-lg text-blue-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.247 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),"Learning Center"]}),c&&s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tighter",children:"Community Knowledge Base"})]}),s.jsx("div",{className:`flex-grow relative z-10 ${u?"grid grid-cols-3 gap-4":o?"grid grid-cols-3 gap-2":"grid grid-cols-3 gap-3"}`,children:h.map((p,m)=>{const g=!o&&!u;return s.jsxs("button",{onClick:p.onClick,className:`w-full text-left ${o||g?"p-2":"p-4"} rounded-2xl bg-gray-950/40 hover:bg-gray-800 border border-white/5 hover:border-${p.color}-500/30 transition-all group/item flex ${c?"flex-col justify-between":o||g?"flex-col items-center justify-center text-center":"items-center"} gap-3 h-full`,children:[s.jsxs("div",{className:`flex ${o||g?"flex-col":""} items-center ${o||g?"gap-1":"gap-3"}`,children:[s.jsx("div",{className:`${o||g?"p-1.5":"p-2"} bg-${p.color}-500/10 rounded-xl ${o?"text-base":g?"text-lg":"text-xl"} group-hover/item:scale-110 transition-transform`,children:p.icon}),s.jsxs("div",{className:"block text-center",children:[s.jsx("div",{className:`${o||g?"text-[10px] leading-tight":"text-xs"} font-black text-gray-200 group-hover/item:text-white uppercase tracking-wide`,children:o?m===0?"Binders":m===1?"Pods":"Audit":g?s.jsx(s.Fragment,{children:p.title.split(" ").map((b,v)=>s.jsx("span",{className:"block",children:b},v))}):p.title}),u&&!c&&s.jsx("div",{className:"text-[9px] text-gray-500 font-bold mt-0.5 line-clamp-1",children:p.desc})]})]}),c&&s.jsxs("div",{className:"mt-4 w-full",children:[s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase mb-2 line-clamp-2 leading-relaxed",children:p.desc}),s.jsxs("div",{className:"flex justify-between items-center mb-1 text-[9px] font-mono",children:[s.jsx("span",{className:"text-gray-600 uppercase",children:"Progress"}),s.jsxs("span",{className:`text-${p.color}-400`,children:[p.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-900 rounded-full h-1 overflow-hidden",children:s.jsx("div",{className:`h-full bg-${p.color}-500 transition-all duration-1000 delay-${m*100}`,style:{width:`${p.progress}%`}})})]})]},m)})}),!u&&!o&&s.jsxs("button",{onClick:()=>r(!0),className:"mt-4 text-[10px] font-black text-blue-400 hover:text-blue-300 uppercase tracking-widest flex items-center gap-1 justify-center relative z-10 group/all",children:["View All Resources ",s.jsx("svg",{className:"w-3 h-3 group-hover/all:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/0 to-blue-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},Qv={stats_total:{title:"Total Cards",component:xje,description:"Tracking the total volume of your magical collection.",sizes:{xs:"A micro-pill showing just the count and a label.",small:"Standard card count widget with icon.",medium:"Detailed count with growth markers.",large:"Full spread of collection statistics.",xlarge:"Deep dive into total counts and distribution."}},stats_decks:{title:"Unique Decks",component:bje,description:"Your strategic fleet of decks currently active.",sizes:{xs:"Compact count of distinct decks.",small:"Standard deck counter.",medium:"Show total decks vs archive.",large:"Stats on deck archetypes and colors.",xlarge:"Advanced deck-building analytics."}},stats_value:{title:"Collection Value",component:vje,description:"Real-time market value of your entire assortment.",sizes:{xs:"Brief dollar amount with high contrast label.",small:"Value widget with currency symbol.",medium:"Display price change trends.",large:"Breakdown of most valuable items.",xlarge:"Historical value charting and top gainers."}},identity:{title:"Color Identity",component:jje,description:"A visual spectrum of your collection colors.",sizes:{xs:"Top color pips in a row.",small:"Pips plus name of identity.",medium:"Flavorful breakdown of colors.",large:"Percentage distribution of mana colors.",xlarge:"Deep meta-analysis and signature staples."}},quick_actions:{title:"Quick Actions",component:_je,description:"A dashboard hub for your most common tasks.",sizes:{xs:"Icon-only vertical stack.",small:"Balanced grid of action buttons.",medium:"Full width icon row.",large:"Detailed actions with shortcuts.",xlarge:"Admin-style toolbelt for your collection."}},action_new_deck:{title:"New Deck",component:t=>s.jsx(Sy,{...t,actionType:"new_deck"}),description:"Initiate a new deck building session.",sizes:{xs:'Simple "New" button pill.',small:"Standard action square.",medium:"Stretched action bar.",large:"Action with creative flavor text."}},action_add_cards:{title:"Add Cards",component:t=>s.jsx(Sy,{...t,actionType:"add_cards"}),description:"Quickly add cards to your library.",sizes:{xs:"Add icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with collection tips."}},action_browse:{title:"Browse Sets",component:t=>s.jsx(Sy,{...t,actionType:"browse_sets"}),description:"Explore card sets and expansions.",sizes:{xs:"Search icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with latest set spotlight."}},action_wishlist:{title:"Wishlist",component:t=>s.jsx(Sy,{...t,actionType:"wishlist"}),description:"Access your hunting list for new cards.",sizes:{xs:"Heart icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with total wishlist value."}},action_tournaments:{title:"Tournaments",component:t=>s.jsx(Sy,{...t,actionType:"tournaments"}),description:"Check upcoming events and pairings.",sizes:{xs:"Trophy icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with active pairings count."}},recent_decks:{title:"Recent Decks",component:Nje,description:"Quick access to your latest deck projects.",sizes:{xs:"Last active deck name.",small:"Commander art for the latest deck.",medium:"Last two decks with color identities.",large:"Triple deck spread with mini-summaries.",xlarge:"Full chronological deck feed."}},system_status:{title:"System Status",component:J4e,description:"Real-time health pulse of the forge.",sizes:{xs:"Simple status dot.",small:"Current uptime percentage.",medium:"Detailed service status.",large:"Full system health dashboard."}},subscription:{title:"Subscription",component:Sje,description:"Manage your membership and perks.",sizes:{xs:"Tier logo pill.",small:"Current plan summary.",medium:"Plan features and renewal date.",large:"Full tier comparison and billing."}},community:{title:"My Pods",component:Cje,description:"Stay connected with your local playgroups.",sizes:{xs:"Member count pill.",small:"Active friends avatars.",medium:"Recent group activity feed.",large:"Post to pod wall / social hub.",xlarge:"Full community management center."}},social_stats:{title:"Social Battery",component:W4e,description:"Monitor your engagement and shared assets.",sizes:{xs:"Battery percentage pill.",small:"Standard social gauge.",medium:"Share counts and feedback analytics.",large:"Detailed audience insights."}},audit:{title:"Collection Audit",component:K4e,description:"Verify your digital collection against physical cards.",sizes:{xs:"Current audit progress %.",small:"Next item in audit queue.",medium:"Audit stats and mismatch count.",large:"Detailed audit results and resume info.",xlarge:"Grand overview of collection integrity."}},tips:{title:"Forge Tips",component:Eje,description:"Pro tips for mastering the forge.",sizes:{xs:"Tip icon pill.",small:"One random pro tip.",medium:"Daily pro trick with icons.",large:"Top 3 tips for your current tier."}},releases:{title:"New Sets",component:H4e,description:"Incoming card sets and set reviews.",sizes:{xs:"Release date pill.",small:"Latest set name.",medium:"Next 3 releases with dates.",large:"Detailed set review feed."}},guides:{title:"Guides & Resources",component:Z4e,description:"Learn how to brew better decks.",sizes:{xs:"Book icon pill.",small:"Featured guide link.",medium:"Top 3 reading recommendations.",large:"Full resource library access."}},action_log:{title:"Session History",component:Y4e,description:"Track your recent deck edits and actions.",sizes:{xs:"Last action pill.",small:"Scrollable list of recent actions.",medium:"Extended list with timestamps.",large:"Full session log with analysis.",xlarge:"Detailed history timeline."}},trade_matches:{title:"Trade Alerts",component:X4e,description:"Notifications for automated trade matches in your Pod.",sizes:{xs:"Pill with match count.",small:"Standard widget with count and label.",medium:"Detailed alert box.",large:"Expanded match list preview.",xlarge:"Full trade hub integration."}}},eke=({id:t,onAdd:e})=>{const r=Qv[t];return s.jsx(xx,{as:"div",className:"mb-2",children:({open:n})=>s.jsxs("div",{className:"group",children:[s.jsxs("div",{className:"relative flex items-center justify-between p-3 rounded-xl border border-white/5 bg-gray-900/60 hover:bg-gray-800/80 shadow-sm transition-all",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-[11px] font-black text-gray-200 uppercase tracking-widest truncate",children:r.title})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>e(t),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-all hover:scale-105 active:scale-95",children:"Add"}),s.jsx(xx.Button,{className:"p-1.5 rounded-lg text-gray-500 hover:text-white hover:bg-white/5 transition-all",children:s.jsx("svg",{className:`w-3.5 h-3.5 transition-transform duration-300 ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsx(Vh,{show:n,enter:"transition-all duration-300 ease-out",enterFrom:"opacity-0 max-h-0",enterTo:"opacity-100 max-h-[500px]",leave:"transition-all duration-200 ease-in",leaveFrom:"opacity-100 max-h-[500px]",leaveTo:"opacity-0 max-h-0",children:s.jsxs(xx.Panel,{className:"px-4 py-3 mt-1 bg-gray-950/40 rounded-xl border border-white/5 text-[10px] space-y-3",children:[s.jsx("p",{className:"text-gray-400 font-medium italic leading-relaxed",children:r.description}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"text-[9px] font-black text-indigo-400/80 uppercase tracking-tighter",children:"Size Specifics"}),Object.entries(r.sizes||{}).map(([i,a])=>s.jsxs("div",{className:"flex gap-2 p-1.5 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[s.jsx("span",{className:"text-gray-300 font-black uppercase w-10 shrink-0 tracking-tighter",children:i}),s.jsx("span",{className:"text-gray-500 leading-tight",children:a})]},i))]})]})})]})})},tke=({layout:t,isOpen:e,onClose:r,onAddWidget:n})=>{const i=new Set(t.grid||[]),a=Object.keys(Qv).filter(o=>!i.has(o));return s.jsx(Vh,{show:e,enter:"transition-transform duration-500 ease-out",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition-transform duration-300 ease-in",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",className:"fixed top-0 right-0 h-full w-80 z-[100] border-l border-white/10 shadow-2xl",children:s.jsxs("div",{className:"h-full bg-gray-950/80 backdrop-blur-2xl flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-black text-white uppercase tracking-[0.2em]",children:"Forge Library"}),s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1",children:"CLICK ADD TO USE WIDGETS"})]}),s.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-white hover:bg-white/5 rounded-xl transition-all",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"flex-grow overflow-y-auto p-4 custom-scrollbar",children:a.length===0?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40 p-8",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),s.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Library Empty"}),s.jsx("p",{className:"text-[10px] text-gray-600 mt-2 italic",children:"All available widgets are currently on your dashboard."})]}):a.map(o=>s.jsx(eke,{id:o,onAdd:n},o))}),s.jsx("div",{className:"p-6 bg-indigo-600/5 mt-auto border-t border-white/5",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/20 text-indigo-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] font-bold text-indigo-200",children:"Pro Tip"}),s.jsx("p",{className:"text-[10px] text-indigo-400/70 leading-relaxed mt-1",children:"Widgets snap to the 12-column grid. Try placing smaller ones next to larger ones to auto-stack."})]})]})})]})})},eZ=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,targetName:a})=>{const[o,l]=y.useState(""),c=o.toUpperCase()==="DELETE";return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-red-500/50 rounded-2xl max-w-md w-full p-6 shadow-2xl shadow-red-900/20 transform transition-all scale-100",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center border border-red-500/50",children:s.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:n||"Confirm Deletion"}),s.jsx("p",{className:"text-red-400 text-sm font-medium",children:"This action cannot be undone."})]})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx("p",{className:"text-gray-300 leading-relaxed",children:i}),a&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[s.jsx("span",{className:"text-red-200 text-sm",children:"Target: "}),s.jsx("span",{className:"text-white font-mono font-bold",children:a})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:["Type ",s.jsx("span",{className:"text-white font-mono",children:"DELETE"})," to confirm"]}),s.jsx("input",{type:"text",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-colors font-mono",placeholder:"DELETE",value:o,onChange:u=>l(u.target.value)})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-xl transition-colors",children:"Cancel"}),s.jsx("button",{onClick:r,disabled:!c,className:`flex-1 px-4 py-3 font-bold rounded-xl transition-all shadow-lg ${c?"bg-red-600 hover:bg-red-500 text-white shadow-red-900/30":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Delete Forever"})]})]})}):null},rke=({isOpen:t,onClose:e,onImport:r})=>{const[n,i]=y.useState(""),[a,o]=y.useState(""),[l,c]=y.useState("");if(y.useEffect(()=>{t||(i(""),o(""),c(""))},[t]),!t)return null;const u=()=>{if(!n.trim())return c("Please enter a layout name");if(!a.trim())return c("Please paste the layout code");try{if(!a.startsWith("ey"))throw new Error;r(n,a),e()}catch{c("Invalid layout code format")}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Import Layout"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Name"}),s.jsx("input",{value:n,onChange:h=>i(h.target.value),placeholder:"My Awesome Layout",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none",autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Code"}),s.jsx("textarea",{value:a,onChange:h=>o(h.target.value),placeholder:"Paste the base64 code here...",className:"w-full h-32 bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white font-mono text-xs placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none resize-none"})]}),l&&s.jsx("p",{className:"text-red-400 text-sm",children:l}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors",children:"Cancel"}),s.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-colors shadow-lg shadow-indigo-500/20",children:"Import"})]})]})]})})},nke=({isOpen:t,onClose:e,layoutCode:r,layoutName:n})=>{const[i,a]=y.useState(!1);if(!t)return null;const o=()=>{navigator.clipboard.writeText(r),a(!0),setTimeout(()=>a(!1),2e3)};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Share Layout"}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-300",children:["Copy the code below to share ",s.jsxs("strong",{children:['"',n,'"']})," with others."]}),s.jsx("div",{className:"relative",children:s.jsx("textarea",{readOnly:!0,value:r,className:"w-full h-32 bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-indigo-300 font-mono text-xs focus:border-indigo-500 outline-none resize-none",onClick:l=>l.target.select()})}),s.jsx("button",{onClick:o,className:`w-full py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${i?"bg-green-600 text-white":"bg-indigo-600 hover:bg-indigo-500 text-white"}`,children:i?s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Copy Code"]})})]})]})})},ske=({isOpen:t,onClose:e,onSave:r})=>{const[n,i]=y.useState(""),[a,o]=y.useState("");return y.useEffect(()=>{t||(i(""),o(""))},[t]),t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Save Layout"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Name"}),s.jsx("input",{value:n,onChange:l=>i(l.target.value),placeholder:"e.g. Commander Focus",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none",autoFocus:!0,onKeyDown:l=>{l.key==="Enter"&&n.trim()&&(r(n),e())}})]}),a&&s.jsx("p",{className:"text-red-400 text-sm",children:a}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors",children:"Cancel"}),s.jsx("button",{onClick:()=>{if(!n.trim())return o("Please enter a name");r(n),e()},className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-colors shadow-lg shadow-indigo-500/20",children:"Save"})]})]})]})}):null};var tZ=typeof global=="object"&&global&&global.Object===Object&&global,ike=typeof self=="object"&&self&&self.Object===Object&&self,Xd=tZ||ike||Function("return this")(),O0=Xd.Symbol,rZ=Object.prototype,ake=rZ.hasOwnProperty,oke=rZ.toString,Cy=O0?O0.toStringTag:void 0;function lke(t){var e=ake.call(t,Cy),r=t[Cy];try{t[Cy]=void 0;var n=!0}catch{}var i=oke.call(t);return n&&(e?t[Cy]=r:delete t[Cy]),i}var cke=Object.prototype,uke=cke.toString;function dke(t){return uke.call(t)}var hke="[object Null]",fke="[object Undefined]",s$=O0?O0.toStringTag:void 0;function yb(t){return t==null?t===void 0?fke:hke:s$&&s$ in Object(t)?lke(t):dke(t)}function Qh(t){return t!=null&&typeof t=="object"}var hm=Array.isArray;function q0(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function nZ(t){return t}var pke="[object AsyncFunction]",mke="[object Function]",gke="[object GeneratorFunction]",xke="[object Proxy]";function dL(t){if(!q0(t))return!1;var e=yb(t);return e==mke||e==gke||e==pke||e==xke}var rC=Xd["__core-js_shared__"],i$=(function(){var t=/[^.]+$/.exec(rC&&rC.keys&&rC.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function bke(t){return!!i$&&i$ in t}var yke=Function.prototype,vke=yke.toString;function Mm(t){if(t!=null){try{return vke.call(t)}catch{}try{return t+""}catch{}}return""}var wke=/[\\^$.*+?()[\]{}|]/g,Nke=/^\[object .+?Constructor\]$/,jke=Function.prototype,kke=Object.prototype,_ke=jke.toString,Ske=kke.hasOwnProperty,Cke=RegExp("^"+_ke.call(Ske).replace(wke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Eke(t){if(!q0(t)||bke(t))return!1;var e=dL(t)?Cke:Nke;return e.test(Mm(t))}function Ake(t,e){return t?.[e]}function Dm(t,e){var r=Ake(t,e);return Eke(r)?r:void 0}var WA=Dm(Xd,"WeakMap"),a$=Object.create,Tke=(function(){function t(){}return function(e){if(!q0(e))return{};if(a$)return a$(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function Ike(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Lke(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Pke=800,Oke=16,Rke=Date.now;function Mke(t){var e=0,r=0;return function(){var n=Rke(),i=Oke-(n-r);if(r=n,i>0){if(++e>=Pke)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Dke(t){return function(){return t}}var pj=(function(){try{var t=Dm(Object,"defineProperty");return t({},"",{}),t}catch{}})(),Bke=pj?function(t,e){return pj(t,"toString",{configurable:!0,enumerable:!1,value:Dke(e),writable:!0})}:nZ,$ke=Mke(Bke);function Fke(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Uke=9007199254740991,zke=/^(?:0|[1-9]\d*)$/;function sZ(t,e){var r=typeof t;return e=e??Uke,!!e&&(r=="number"||r!="symbol"&&zke.test(t))&&t>-1&&t%1==0&&t<e}function hL(t,e,r){e=="__proto__"&&pj?pj(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Q1(t,e){return t===e||t!==t&&e!==e}var qke=Object.prototype,Vke=qke.hasOwnProperty;function iZ(t,e,r){var n=t[e];(!(Vke.call(t,e)&&Q1(n,r))||r===void 0&&!(e in t))&&hL(t,e,r)}function Hke(t,e,r,n){var i=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var l=e[a],c=void 0;c===void 0&&(c=t[l]),i?hL(r,l,c):iZ(r,l,c)}return r}var o$=Math.max;function Wke(t,e,r){return e=o$(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=o$(n.length-e,0),o=Array(a);++i<a;)o[i]=n[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=n[i];return l[e]=r(o),Ike(t,this,l)}}function Gke(t,e){return $ke(Wke(t,e,nZ),t+"")}var Kke=9007199254740991;function aZ(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Kke}function bk(t){return t!=null&&aZ(t.length)&&!dL(t)}function Yke(t,e,r){if(!q0(r))return!1;var n=typeof e;return(n=="number"?bk(r)&&sZ(e,r.length):n=="string"&&e in r)?Q1(r[e],t):!1}function Xke(t){return Gke(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,o&&Yke(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var l=r[n];l&&t(e,l,n,a)}return e})}var Qke=Object.prototype;function fL(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Qke;return t===r}function Jke(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Zke="[object Arguments]";function l$(t){return Qh(t)&&yb(t)==Zke}var oZ=Object.prototype,e_e=oZ.hasOwnProperty,t_e=oZ.propertyIsEnumerable,GA=l$((function(){return arguments})())?l$:function(t){return Qh(t)&&e_e.call(t,"callee")&&!t_e.call(t,"callee")};function r_e(){return!1}var lZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,c$=lZ&&typeof module=="object"&&module&&!module.nodeType&&module,n_e=c$&&c$.exports===lZ,u$=n_e?Xd.Buffer:void 0,s_e=u$?u$.isBuffer:void 0,Jv=s_e||r_e,i_e="[object Arguments]",a_e="[object Array]",o_e="[object Boolean]",l_e="[object Date]",c_e="[object Error]",u_e="[object Function]",d_e="[object Map]",h_e="[object Number]",f_e="[object Object]",p_e="[object RegExp]",m_e="[object Set]",g_e="[object String]",x_e="[object WeakMap]",b_e="[object ArrayBuffer]",y_e="[object DataView]",v_e="[object Float32Array]",w_e="[object Float64Array]",N_e="[object Int8Array]",j_e="[object Int16Array]",k_e="[object Int32Array]",__e="[object Uint8Array]",S_e="[object Uint8ClampedArray]",C_e="[object Uint16Array]",E_e="[object Uint32Array]",ei={};ei[v_e]=ei[w_e]=ei[N_e]=ei[j_e]=ei[k_e]=ei[__e]=ei[S_e]=ei[C_e]=ei[E_e]=!0;ei[i_e]=ei[a_e]=ei[b_e]=ei[o_e]=ei[y_e]=ei[l_e]=ei[c_e]=ei[u_e]=ei[d_e]=ei[h_e]=ei[f_e]=ei[p_e]=ei[m_e]=ei[g_e]=ei[x_e]=!1;function A_e(t){return Qh(t)&&aZ(t.length)&&!!ei[yb(t)]}function pL(t){return function(e){return t(e)}}var cZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Nv=cZ&&typeof module=="object"&&module&&!module.nodeType&&module,T_e=Nv&&Nv.exports===cZ,nC=T_e&&tZ.process,Kx=(function(){try{var t=Nv&&Nv.require&&Nv.require("util").types;return t||nC&&nC.binding&&nC.binding("util")}catch{}})(),d$=Kx&&Kx.isTypedArray,mL=d$?pL(d$):A_e,I_e=Object.prototype,L_e=I_e.hasOwnProperty;function uZ(t,e){var r=hm(t),n=!r&&GA(t),i=!r&&!n&&Jv(t),a=!r&&!n&&!i&&mL(t),o=r||n||i||a,l=o?Jke(t.length,String):[],c=l.length;for(var u in t)(e||L_e.call(t,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||sZ(u,c)))&&l.push(u);return l}function dZ(t,e){return function(r){return t(e(r))}}var P_e=dZ(Object.keys,Object),O_e=Object.prototype,R_e=O_e.hasOwnProperty;function M_e(t){if(!fL(t))return P_e(t);var e=[];for(var r in Object(t))R_e.call(t,r)&&r!="constructor"&&e.push(r);return e}function D_e(t){return bk(t)?uZ(t):M_e(t)}function B_e(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var $_e=Object.prototype,F_e=$_e.hasOwnProperty;function U_e(t){if(!q0(t))return B_e(t);var e=fL(t),r=[];for(var n in t)n=="constructor"&&(e||!F_e.call(t,n))||r.push(n);return r}function hZ(t){return bk(t)?uZ(t,!0):U_e(t)}var Zv=Dm(Object,"create");function z_e(){this.__data__=Zv?Zv(null):{},this.size=0}function q_e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var V_e="__lodash_hash_undefined__",H_e=Object.prototype,W_e=H_e.hasOwnProperty;function G_e(t){var e=this.__data__;if(Zv){var r=e[t];return r===V_e?void 0:r}return W_e.call(e,t)?e[t]:void 0}var K_e=Object.prototype,Y_e=K_e.hasOwnProperty;function X_e(t){var e=this.__data__;return Zv?e[t]!==void 0:Y_e.call(e,t)}var Q_e="__lodash_hash_undefined__";function J_e(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Zv&&e===void 0?Q_e:e,this}function fm(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}fm.prototype.clear=z_e;fm.prototype.delete=q_e;fm.prototype.get=G_e;fm.prototype.has=X_e;fm.prototype.set=J_e;function Z_e(){this.__data__=[],this.size=0}function yk(t,e){for(var r=t.length;r--;)if(Q1(t[r][0],e))return r;return-1}var eSe=Array.prototype,tSe=eSe.splice;function rSe(t){var e=this.__data__,r=yk(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():tSe.call(e,r,1),--this.size,!0}function nSe(t){var e=this.__data__,r=yk(e,t);return r<0?void 0:e[r][1]}function sSe(t){return yk(this.__data__,t)>-1}function iSe(t,e){var r=this.__data__,n=yk(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function hf(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}hf.prototype.clear=Z_e;hf.prototype.delete=rSe;hf.prototype.get=nSe;hf.prototype.has=sSe;hf.prototype.set=iSe;var e1=Dm(Xd,"Map");function aSe(){this.size=0,this.__data__={hash:new fm,map:new(e1||hf),string:new fm}}function oSe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function vk(t,e){var r=t.__data__;return oSe(e)?r[typeof e=="string"?"string":"hash"]:r.map}function lSe(t){var e=vk(this,t).delete(t);return this.size-=e?1:0,e}function cSe(t){return vk(this,t).get(t)}function uSe(t){return vk(this,t).has(t)}function dSe(t,e){var r=vk(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Bm(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Bm.prototype.clear=aSe;Bm.prototype.delete=lSe;Bm.prototype.get=cSe;Bm.prototype.has=uSe;Bm.prototype.set=dSe;function hSe(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var fZ=dZ(Object.getPrototypeOf,Object),fSe="[object Object]",pSe=Function.prototype,mSe=Object.prototype,pZ=pSe.toString,gSe=mSe.hasOwnProperty,xSe=pZ.call(Object);function bSe(t){if(!Qh(t)||yb(t)!=fSe)return!1;var e=fZ(t);if(e===null)return!0;var r=gSe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&pZ.call(r)==xSe}function ySe(){this.__data__=new hf,this.size=0}function vSe(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function wSe(t){return this.__data__.get(t)}function NSe(t){return this.__data__.has(t)}var jSe=200;function kSe(t,e){var r=this.__data__;if(r instanceof hf){var n=r.__data__;if(!e1||n.length<jSe-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Bm(n)}return r.set(t,e),this.size=r.size,this}function Rd(t){var e=this.__data__=new hf(t);this.size=e.size}Rd.prototype.clear=ySe;Rd.prototype.delete=vSe;Rd.prototype.get=wSe;Rd.prototype.has=NSe;Rd.prototype.set=kSe;var mZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,h$=mZ&&typeof module=="object"&&module&&!module.nodeType&&module,_Se=h$&&h$.exports===mZ,f$=_Se?Xd.Buffer:void 0,p$=f$?f$.allocUnsafe:void 0;function gZ(t,e){if(e)return t.slice();var r=t.length,n=p$?p$(r):new t.constructor(r);return t.copy(n),n}function SSe(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a}function CSe(){return[]}var ESe=Object.prototype,ASe=ESe.propertyIsEnumerable,m$=Object.getOwnPropertySymbols,TSe=m$?function(t){return t==null?[]:(t=Object(t),SSe(m$(t),function(e){return ASe.call(t,e)}))}:CSe;function ISe(t,e,r){var n=e(t);return hm(t)?n:hSe(n,r(t))}function KA(t){return ISe(t,D_e,TSe)}var YA=Dm(Xd,"DataView"),XA=Dm(Xd,"Promise"),QA=Dm(Xd,"Set"),g$="[object Map]",LSe="[object Object]",x$="[object Promise]",b$="[object Set]",y$="[object WeakMap]",v$="[object DataView]",PSe=Mm(YA),OSe=Mm(e1),RSe=Mm(XA),MSe=Mm(QA),DSe=Mm(WA),Eu=yb;(YA&&Eu(new YA(new ArrayBuffer(1)))!=v$||e1&&Eu(new e1)!=g$||XA&&Eu(XA.resolve())!=x$||QA&&Eu(new QA)!=b$||WA&&Eu(new WA)!=y$)&&(Eu=function(t){var e=yb(t),r=e==LSe?t.constructor:void 0,n=r?Mm(r):"";if(n)switch(n){case PSe:return v$;case OSe:return g$;case RSe:return x$;case MSe:return b$;case DSe:return y$}return e});var BSe=Object.prototype,$Se=BSe.hasOwnProperty;function FSe(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&$Se.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var mj=Xd.Uint8Array;function gL(t){var e=new t.constructor(t.byteLength);return new mj(e).set(new mj(t)),e}function USe(t,e){var r=gL(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var zSe=/\w*$/;function qSe(t){var e=new t.constructor(t.source,zSe.exec(t));return e.lastIndex=t.lastIndex,e}var w$=O0?O0.prototype:void 0,N$=w$?w$.valueOf:void 0;function VSe(t){return N$?Object(N$.call(t)):{}}function xZ(t,e){var r=e?gL(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var HSe="[object Boolean]",WSe="[object Date]",GSe="[object Map]",KSe="[object Number]",YSe="[object RegExp]",XSe="[object Set]",QSe="[object String]",JSe="[object Symbol]",ZSe="[object ArrayBuffer]",e3e="[object DataView]",t3e="[object Float32Array]",r3e="[object Float64Array]",n3e="[object Int8Array]",s3e="[object Int16Array]",i3e="[object Int32Array]",a3e="[object Uint8Array]",o3e="[object Uint8ClampedArray]",l3e="[object Uint16Array]",c3e="[object Uint32Array]";function u3e(t,e,r){var n=t.constructor;switch(e){case ZSe:return gL(t);case HSe:case WSe:return new n(+t);case e3e:return USe(t);case t3e:case r3e:case n3e:case s3e:case i3e:case a3e:case o3e:case l3e:case c3e:return xZ(t,r);case GSe:return new n;case KSe:case QSe:return new n(t);case YSe:return qSe(t);case XSe:return new n;case JSe:return VSe(t)}}function bZ(t){return typeof t.constructor=="function"&&!fL(t)?Tke(fZ(t)):{}}var d3e="[object Map]";function h3e(t){return Qh(t)&&Eu(t)==d3e}var j$=Kx&&Kx.isMap,f3e=j$?pL(j$):h3e,p3e="[object Set]";function m3e(t){return Qh(t)&&Eu(t)==p3e}var k$=Kx&&Kx.isSet,g3e=k$?pL(k$):m3e,x3e=1,yZ="[object Arguments]",b3e="[object Array]",y3e="[object Boolean]",v3e="[object Date]",w3e="[object Error]",vZ="[object Function]",N3e="[object GeneratorFunction]",j3e="[object Map]",k3e="[object Number]",wZ="[object Object]",_3e="[object RegExp]",S3e="[object Set]",C3e="[object String]",E3e="[object Symbol]",A3e="[object WeakMap]",T3e="[object ArrayBuffer]",I3e="[object DataView]",L3e="[object Float32Array]",P3e="[object Float64Array]",O3e="[object Int8Array]",R3e="[object Int16Array]",M3e="[object Int32Array]",D3e="[object Uint8Array]",B3e="[object Uint8ClampedArray]",$3e="[object Uint16Array]",F3e="[object Uint32Array]",zs={};zs[yZ]=zs[b3e]=zs[T3e]=zs[I3e]=zs[y3e]=zs[v3e]=zs[L3e]=zs[P3e]=zs[O3e]=zs[R3e]=zs[M3e]=zs[j3e]=zs[k3e]=zs[wZ]=zs[_3e]=zs[S3e]=zs[C3e]=zs[E3e]=zs[D3e]=zs[B3e]=zs[$3e]=zs[F3e]=!0;zs[w3e]=zs[vZ]=zs[A3e]=!1;function iN(t,e,r,n,i,a){var o,l=e&x3e;if(o!==void 0)return o;if(!q0(t))return t;var c=hm(t);if(c)o=FSe(t);else{var u=Eu(t),h=u==vZ||u==N3e;if(Jv(t))return gZ(t,l);if(u==wZ||u==yZ||h&&!i)o=h?{}:bZ(t);else{if(!zs[u])return i?t:{};o=u3e(t,u,l)}}a||(a=new Rd);var p=a.get(t);if(p)return p;a.set(t,o),g3e(t)?t.forEach(function(b){o.add(iN(b,e,r,b,t,a))}):f3e(t)&&t.forEach(function(b,v){o.set(v,iN(b,e,r,v,t,a))});var m=KA,g=c?void 0:m(t);return Fke(g||t,function(b,v){g&&(v=b,b=t[v]),iZ(o,v,iN(b,e,r,v,t,a))}),o}var U3e=1,z3e=4;function wx(t){return iN(t,U3e|z3e)}var q3e="__lodash_hash_undefined__";function V3e(t){return this.__data__.set(t,q3e),this}function H3e(t){return this.__data__.has(t)}function gj(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Bm;++e<r;)this.add(t[e])}gj.prototype.add=gj.prototype.push=V3e;gj.prototype.has=H3e;function W3e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function G3e(t,e){return t.has(e)}var K3e=1,Y3e=2;function NZ(t,e,r,n,i,a){var o=r&K3e,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var u=a.get(t),h=a.get(e);if(u&&h)return u==e&&h==t;var p=-1,m=!0,g=r&Y3e?new gj:void 0;for(a.set(t,e),a.set(e,t);++p<l;){var b=t[p],v=e[p];if(n)var w=o?n(v,b,p,e,t,a):n(b,v,p,t,e,a);if(w!==void 0){if(w)continue;m=!1;break}if(g){if(!W3e(e,function(j,_){if(!G3e(g,_)&&(b===j||i(b,j,r,n,a)))return g.push(_)})){m=!1;break}}else if(!(b===v||i(b,v,r,n,a))){m=!1;break}}return a.delete(t),a.delete(e),m}function X3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function Q3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var J3e=1,Z3e=2,eCe="[object Boolean]",tCe="[object Date]",rCe="[object Error]",nCe="[object Map]",sCe="[object Number]",iCe="[object RegExp]",aCe="[object Set]",oCe="[object String]",lCe="[object Symbol]",cCe="[object ArrayBuffer]",uCe="[object DataView]",_$=O0?O0.prototype:void 0,sC=_$?_$.valueOf:void 0;function dCe(t,e,r,n,i,a,o){switch(r){case uCe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case cCe:return!(t.byteLength!=e.byteLength||!a(new mj(t),new mj(e)));case eCe:case tCe:case sCe:return Q1(+t,+e);case rCe:return t.name==e.name&&t.message==e.message;case iCe:case oCe:return t==e+"";case nCe:var l=X3e;case aCe:var c=n&J3e;if(l||(l=Q3e),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;n|=Z3e,o.set(t,e);var h=NZ(l(t),l(e),n,i,a,o);return o.delete(t),h;case lCe:if(sC)return sC.call(t)==sC.call(e)}return!1}var hCe=1,fCe=Object.prototype,pCe=fCe.hasOwnProperty;function mCe(t,e,r,n,i,a){var o=r&hCe,l=KA(t),c=l.length,u=KA(e),h=u.length;if(c!=h&&!o)return!1;for(var p=c;p--;){var m=l[p];if(!(o?m in e:pCe.call(e,m)))return!1}var g=a.get(t),b=a.get(e);if(g&&b)return g==e&&b==t;var v=!0;a.set(t,e),a.set(e,t);for(var w=o;++p<c;){m=l[p];var j=t[m],_=e[m];if(n)var E=o?n(_,j,m,e,t,a):n(j,_,m,t,e,a);if(!(E===void 0?j===_||i(j,_,r,n,a):E)){v=!1;break}w||(w=m=="constructor")}if(v&&!w){var I=t.constructor,O=e.constructor;I!=O&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof O=="function"&&O instanceof O)&&(v=!1)}return a.delete(t),a.delete(e),v}var gCe=1,S$="[object Arguments]",C$="[object Array]",Vw="[object Object]",xCe=Object.prototype,E$=xCe.hasOwnProperty;function bCe(t,e,r,n,i,a){var o=hm(t),l=hm(e),c=o?C$:Eu(t),u=l?C$:Eu(e);c=c==S$?Vw:c,u=u==S$?Vw:u;var h=c==Vw,p=u==Vw,m=c==u;if(m&&Jv(t)){if(!Jv(e))return!1;o=!0,h=!1}if(m&&!h)return a||(a=new Rd),o||mL(t)?NZ(t,e,r,n,i,a):dCe(t,e,c,r,n,i,a);if(!(r&gCe)){var g=h&&E$.call(t,"__wrapped__"),b=p&&E$.call(e,"__wrapped__");if(g||b){var v=g?t.value():t,w=b?e.value():e;return a||(a=new Rd),i(v,w,r,n,a)}}return m?(a||(a=new Rd),mCe(t,e,r,n,i,a)):!1}function jZ(t,e,r,n,i){return t===e?!0:t==null||e==null||!Qh(t)&&!Qh(e)?t!==t&&e!==e:bCe(t,e,r,n,jZ,i)}function yCe(t){return function(e,r,n){for(var i=-1,a=Object(e),o=n(e),l=o.length;l--;){var c=o[++i];if(r(a[c],c,a)===!1)break}return e}}var vCe=yCe();function JA(t,e,r){(r!==void 0&&!Q1(t[e],r)||r===void 0&&!(e in t))&&hL(t,e,r)}function wCe(t){return Qh(t)&&bk(t)}function ZA(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function NCe(t){return Hke(t,hZ(t))}function jCe(t,e,r,n,i,a,o){var l=ZA(t,r),c=ZA(e,r),u=o.get(c);if(u){JA(t,r,u);return}var h=a?a(l,c,r+"",t,e,o):void 0,p=h===void 0;if(p){var m=hm(c),g=!m&&Jv(c),b=!m&&!g&&mL(c);h=c,m||g||b?hm(l)?h=l:wCe(l)?h=Lke(l):g?(p=!1,h=gZ(c,!0)):b?(p=!1,h=xZ(c,!0)):h=[]:bSe(c)||GA(c)?(h=l,GA(l)?h=NCe(l):(!q0(l)||dL(l))&&(h=bZ(c))):p=!1}p&&(o.set(c,h),i(h,c,n,a,o),o.delete(c)),JA(t,r,h)}function kZ(t,e,r,n,i){t!==e&&vCe(e,function(a,o){if(i||(i=new Rd),q0(a))jCe(t,e,o,r,kZ,n,i);else{var l=n?n(ZA(t,o),a,o+"",t,e,i):void 0;l===void 0&&(l=a),JA(t,o,l)}},hZ)}function f0(t,e){return jZ(t,e)}var C0=Xke(function(t,e,r){kZ(t,e,r)}),wr=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(wr||{});class zd{constructor(e,r,n={}){this.attrName=e,this.keyName=r;const i=wr.TYPE&wr.ATTRIBUTE;this.scope=n.scope!=null?n.scope&wr.LEVEL|i:wr.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(e){return Array.from(e.attributes).map(r=>r.name)}add(e,r){return this.canAdd(e,r)?(e.setAttribute(this.keyName,r),!0):!1}canAdd(e,r){return this.whitelist==null?!0:typeof r=="string"?this.whitelist.indexOf(r.replace(/["']/g,""))>-1:this.whitelist.indexOf(r)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const r=e.getAttribute(this.keyName);return this.canAdd(e,r)&&r?r:""}}class Nx extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const _Z=class eT{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,r=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(r){let n=null;try{n=e.parentNode}catch{return null}return this.find(n,r)}return null}create(e,r,n){const i=this.query(r);if(i==null)throw new Nx(`Unable to create ${r} blot`);const a=i,o=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:a.create(n),l=new a(e,o,n);return eT.blots.set(l.domNode,l),l}find(e,r=!1){return eT.find(e,r)}query(e,r=wr.ANY){let n;return typeof e=="string"?n=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?n=this.types.text:typeof e=="number"?e&wr.LEVEL&wr.BLOCK?n=this.types.block:e&wr.LEVEL&wr.INLINE&&(n=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(i=>(n=this.classes[i],!!n)),n=n||this.tags[e.tagName]),n==null?null:"scope"in n&&r&wr.LEVEL&n.scope&&r&wr.TYPE&n.scope?n:null}register(...e){return e.map(r=>{const n="blotName"in r,i="attrName"in r;if(!n&&!i)throw new Nx("Invalid definition");if(n&&r.blotName==="abstract")throw new Nx("Cannot register abstract class");const a=n?r.blotName:i?r.attrName:void 0;return this.types[a]=r,i?typeof r.keyName=="string"&&(this.attributes[r.keyName]=r):n&&(r.className&&(this.classes[r.className]=r),r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map(o=>o.toUpperCase()):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach(o=>{(this.tags[o]==null||r.className==null)&&(this.tags[o]=r)}))),r})}};_Z.blots=new WeakMap;let Yx=_Z;function A$(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter(r=>r.indexOf(`${e}-`)===0)}class kCe extends zd{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(r=>r.split("-").slice(0,-1).join("-"))}add(e,r){return this.canAdd(e,r)?(this.remove(e),e.classList.add(`${this.keyName}-${r}`),!0):!1}remove(e){A$(e,this.keyName).forEach(r=>{e.classList.remove(r)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const r=(A$(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,r)?r:""}}const Ju=kCe;function iC(t){const e=t.split("-"),r=e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return e[0]+r}class _Ce extends zd{static keys(e){return(e.getAttribute("style")||"").split(";").map(r=>r.split(":")[0].trim())}add(e,r){return this.canAdd(e,r)?(e.style[iC(this.keyName)]=r,!0):!1}remove(e){e.style[iC(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const r=e.style[iC(this.keyName)];return this.canAdd(e,r)?r:""}}const V0=_Ce;class SCe{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,r){r?e.add(this.domNode,r)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Yx.find(this.domNode);if(e==null)return;const r=zd.keys(this.domNode),n=Ju.keys(this.domNode),i=V0.keys(this.domNode);r.concat(n).concat(i).forEach(a=>{const o=e.scroll.query(a,wr.ATTRIBUTE);o instanceof zd&&(this.attributes[o.attrName]=o)})}copy(e){Object.keys(this.attributes).forEach(r=>{const n=this.attributes[r].value(this.domNode);e.format(r,n)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(r=>{this.attributes[r].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,r)=>(e[r]=this.attributes[r].value(this.domNode),e),{})}}const wk=SCe,SZ=class{constructor(e,r){this.scroll=e,this.domNode=r,Yx.blots.set(r,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new Nx("Blot definition missing tagName");let r,n;return Array.isArray(this.tagName)?(typeof e=="string"?(n=e.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof e=="number"&&(n=e),typeof n=="number"?r=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?r=document.createElement(n):r=document.createElement(this.tagName[0])):r=document.createElement(this.tagName),this.className&&r.classList.add(this.className),r}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),Yx.blots.delete(this.domNode)}deleteAt(e,r){this.isolate(e,r).remove()}formatAt(e,r,n,i){const a=this.isolate(e,r);if(this.scroll.query(n,wr.BLOT)!=null&&i)a.wrap(n,i);else if(this.scroll.query(n,wr.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);a.wrap(o),o.format(n,i)}}insertAt(e,r,n){const i=n==null?this.scroll.create("text",r):this.scroll.create(r,n),a=this.split(e);this.parent.insertBefore(i,a||void 0)}isolate(e,r){const n=this.split(e);if(n==null)throw new Error("Attempt to isolate at end");return n.split(r),n}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(e,r){return e===0?this:this.next}update(e,r){}wrap(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new Nx(`Cannot wrap ${e}`);return n.appendChild(this),n}};SZ.blotName="abstract";let CZ=SZ;const EZ=class extends CZ{static value(e){return!0}index(e,r){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(r,1):-1}position(e,r){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};EZ.scope=wr.INLINE_BLOT;let CCe=EZ;const Qo=CCe;class ECe{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const r=e.slice(1);this.append(...r)}}at(e){const r=this.iterator();let n=r();for(;n&&e>0;)e-=1,n=r();return n}contains(e){const r=this.iterator();let n=r();for(;n;){if(n===e)return!0;n=r()}return!1}indexOf(e){const r=this.iterator();let n=r(),i=0;for(;n;){if(n===e)return i;i+=1,n=r()}return-1}insertBefore(e,r){e!=null&&(this.remove(e),e.next=r,r!=null?(e.prev=r.prev,r.prev!=null&&(r.prev.next=e),r.prev=e,r===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let r=0,n=this.head;for(;n!=null;){if(n===e)return r;r+=n.length(),n=n.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const r=e;return e!=null&&(e=e.next),r}}find(e,r=!1){const n=this.iterator();let i=n();for(;i;){const a=i.length();if(e<a||r&&e===a&&(i.next==null||i.next.length()!==0))return[i,e];e-=a,i=n()}return[null,0]}forEach(e){const r=this.iterator();let n=r();for(;n;)e(n),n=r()}forEachAt(e,r,n){if(r<=0)return;const[i,a]=this.find(e);let o=e-a;const l=this.iterator(i);let c=l();for(;c&&o<e+r;){const u=c.length();e>o?n(c,e-o,Math.min(r,o+u-e)):n(c,0,Math.min(u,e+r-o)),o+=u,c=l()}}map(e){return this.reduce((r,n)=>(r.push(e(n)),r),[])}reduce(e,r){const n=this.iterator();let i=n();for(;i;)r=e(r,i),i=n();return r}}function T$(t,e){const r=e.find(t);if(r)return r;try{return e.create(t)}catch{const n=e.create(wr.INLINE);return Array.from(t.childNodes).forEach(i=>{n.domNode.appendChild(i)}),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const AZ=class n0 extends CZ{constructor(e,r){super(e,r),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,n0.uiClass&&this.uiNode.classList.add(n0.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new ECe,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const r=T$(e,this.scroll);this.insertBefore(r,this.children.head||void 0)}catch(r){if(r instanceof Nx)return;throw r}})}deleteAt(e,r){if(e===0&&r===this.length())return this.remove();this.children.forEachAt(e,r,(n,i,a)=>{n.deleteAt(i,a)})}descendant(e,r=0){const[n,i]=this.children.find(r);return e.blotName==null&&e(n)||e.blotName!=null&&n instanceof e?[n,i]:n instanceof n0?n.descendant(e,i):[null,-1]}descendants(e,r=0,n=Number.MAX_VALUE){let i=[],a=n;return this.children.forEachAt(r,n,(o,l,c)=>{(e.blotName==null&&e(o)||e.blotName!=null&&o instanceof e)&&i.push(o),o instanceof n0&&(i=i.concat(o.descendants(e,l,a))),a-=c}),i}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(r=>{e||this.statics.allowedChildren.some(n=>r instanceof n)||(r.statics.scope===wr.BLOCK_BLOT?(r.next!=null&&this.splitAfter(r),r.prev!=null&&this.splitAfter(r.prev),r.parent.unwrap(),e=!0):r instanceof n0?r.unwrap():r.remove())})}formatAt(e,r,n,i){this.children.forEachAt(e,r,(a,o,l)=>{a.formatAt(o,l,n,i)})}insertAt(e,r,n){const[i,a]=this.children.find(e);if(i)i.insertAt(a,r,n);else{const o=n==null?this.scroll.create("text",r):this.scroll.create(r,n);this.appendChild(o)}}insertBefore(e,r){e.parent!=null&&e.parent.children.remove(e);let n=null;this.children.insertBefore(e,r||null),e.parent=this,r!=null&&(n=r.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(e.domNode,n),e.attach()}length(){return this.children.reduce((e,r)=>e+r.length(),0)}moveChildren(e,r){this.children.forEach(n=>{e.insertBefore(n,r)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r)}else this.remove()}path(e,r=!1){const[n,i]=this.children.find(e,r),a=[[this,e]];return n instanceof n0?a.concat(n.path(i,r)):(n!=null&&a.push([n,i]),a)}removeChild(e){this.children.remove(e)}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return n instanceof n0&&this.moveChildren(n),super.replaceWith(n)}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(e,this.length(),(i,a,o)=>{const l=i.split(a,r);l!=null&&n.appendChild(l)}),n}splitAfter(e){const r=this.clone();for(;e.next!=null;)r.appendChild(e.next);return this.parent&&this.parent.insertBefore(r,this.next||void 0),r}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,r){const n=[],i=[];e.forEach(a=>{a.target===this.domNode&&a.type==="childList"&&(n.push(...a.addedNodes),i.push(...a.removedNodes))}),i.forEach(a=>{if(a.parentNode!=null&&a.tagName!=="IFRAME"&&document.body.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(a);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),n.filter(a=>a.parentNode===this.domNode&&a!==this.uiNode).sort((a,o)=>a===o?0:a.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(a=>{let o=null;a.nextSibling!=null&&(o=this.scroll.find(a.nextSibling));const l=T$(a,this.scroll);(l.next!==o||l.next==null)&&(l.parent!=null&&l.parent.removeChild(this),this.insertBefore(l,o||void 0))}),this.enforceAllowedChildren()}};AZ.uiClass="";let ACe=AZ;const Fu=ACe;function TCe(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}const Xg=class Qg extends Fu{static create(e){return super.create(e)}static formats(e,r){const n=r.query(Qg.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new wk(this.domNode)}format(e,r){if(e===this.statics.blotName&&!r)this.children.forEach(n=>{n instanceof Qg||(n=n.wrap(Qg.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(e,wr.INLINE);if(n==null)return;n instanceof zd?this.attributes.attribute(n,r):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r)}}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.formats()[n]!=null||this.scroll.query(n,wr.ATTRIBUTE)?this.isolate(e,r).format(n,i):super.formatAt(e,r,n,i)}optimize(e){super.optimize(e);const r=this.formats();if(Object.keys(r).length===0)return this.unwrap();const n=this.next;n instanceof Qg&&n.prev===this&&TCe(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(e,r){const n=super.wrap(e,r);return n instanceof Qg&&this.attributes.move(n),n}};Xg.allowedChildren=[Xg,Qo],Xg.blotName="inline",Xg.scope=wr.INLINE_BLOT,Xg.tagName="SPAN";let ICe=Xg;const xL=ICe,Jg=class tT extends Fu{static create(e){return super.create(e)}static formats(e,r){const n=r.query(tT.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new wk(this.domNode)}format(e,r){const n=this.scroll.query(e,wr.BLOCK);n!=null&&(n instanceof zd?this.attributes.attribute(n,r):e===this.statics.blotName&&!r?this.replaceWith(tT.blotName):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r))}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.scroll.query(n,wr.BLOCK)!=null?this.format(n,i):super.formatAt(e,r,n,i)}insertAt(e,r,n){if(n==null||this.scroll.query(r,wr.INLINE)!=null)super.insertAt(e,r,n);else{const i=this.split(e);if(i!=null){const a=this.scroll.create(r,n);i.parent.insertBefore(a,i)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};Jg.blotName="block",Jg.scope=wr.BLOCK_BLOT,Jg.tagName="P",Jg.allowedChildren=[xL,Jg,Qo];let LCe=Jg;const t1=LCe,rT=class extends Fu{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,r){super.deleteAt(e,r),this.enforceAllowedChildren()}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.enforceAllowedChildren()}insertAt(e,r,n){super.insertAt(e,r,n),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};rT.blotName="container",rT.scope=wr.BLOCK_BLOT;let PCe=rT;const Nk=PCe;class OCe extends Qo{static formats(e,r){}format(e,r){super.formatAt(0,this.length(),e,r)}formatAt(e,r,n,i){e===0&&r===this.length()?this.format(n,i):super.formatAt(e,r,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Cc=OCe,RCe={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},MCe=100,Zg=class extends Fu{constructor(e,r){super(null,r),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,RCe),this.attach()}create(e,r){return this.registry.create(this,e,r)}find(e,r=!1){const n=this.registry.find(e,r);return n?n.scroll===this?n:r?this.find(n.scroll.domNode.parentNode,!0):null:null}query(e,r=wr.ANY){return this.registry.query(e,r)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,r){this.update(),e===0&&r===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(e,r)}formatAt(e,r,n,i){this.update(),super.formatAt(e,r,n,i)}insertAt(e,r,n){this.update(),super.insertAt(e,r,n)}optimize(e=[],r={}){super.optimize(r);const n=r.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)e.push(i.pop());const a=(c,u=!0)=>{c==null||c===this||c.domNode.parentNode!=null&&(n.has(c.domNode)||n.set(c.domNode,[]),u&&a(c.parent))},o=c=>{n.has(c.domNode)&&(c instanceof Fu&&c.children.forEach(o),n.delete(c.domNode),c.optimize(r))};let l=e;for(let c=0;l.length>0;c+=1){if(c>=MCe)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach(u=>{const h=this.find(u.target,!0);h!=null&&(h.domNode===u.target&&(u.type==="childList"?(a(this.find(u.previousSibling,!1)),Array.from(u.addedNodes).forEach(p=>{const m=this.find(p,!1);a(m,!1),m instanceof Fu&&m.children.forEach(g=>{a(g,!1)})})):u.type==="attributes"&&a(h.prev)),a(h))}),this.children.forEach(o),l=Array.from(this.observer.takeRecords()),i=l.slice();i.length>0;)e.push(i.pop())}}update(e,r={}){e=e||this.observer.takeRecords();const n=new WeakMap;e.map(i=>{const a=this.find(i.target,!0);return a==null?null:n.has(a.domNode)?(n.get(a.domNode).push(i),null):(n.set(a.domNode,[i]),a)}).forEach(i=>{i!=null&&i!==this&&n.has(i.domNode)&&i.update(n.get(i.domNode)||[],r)}),r.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),r),this.optimize(e,r)}};Zg.blotName="scroll",Zg.defaultChild=t1,Zg.allowedChildren=[t1,Nk],Zg.scope=wr.BLOCK_BLOT,Zg.tagName="DIV";let DCe=Zg;const bL=DCe,nT=class TZ extends Qo{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,r){super(e,r),this.text=this.statics.value(this.domNode)}deleteAt(e,r){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+r)}index(e,r){return this.domNode===e?r:-1}insertAt(e,r,n){n==null?(this.text=this.text.slice(0,e)+r+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,r,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof TZ&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,r=!1){return[this.domNode,e]}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(e,r){e.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};nT.blotName="text",nT.scope=wr.INLINE_BLOT;let BCe=nT;const xj=BCe,$Ce=Object.freeze(Object.defineProperty({__proto__:null,Attributor:zd,AttributorStore:wk,BlockBlot:t1,ClassAttributor:Ju,ContainerBlot:Nk,EmbedBlot:Cc,InlineBlot:xL,LeafBlot:Qo,ParentBlot:Fu,Registry:Yx,Scope:wr,ScrollBlot:bL,StyleAttributor:V0,TextBlot:xj},Symbol.toStringTag,{value:"Module"}));var Hw={exports:{}},aC,I$;function FCe(){if(I$)return aC;I$=1;var t=-1,e=1,r=0;function n(k,L,R,V,Y){if(k===L)return k?[[r,k]]:[];if(R!=null){var X=M(k,L,R);if(X)return X}var J=l(k,L),re=k.substring(0,J);k=k.substring(J),L=L.substring(J),J=u(k,L);var se=k.substring(k.length-J);k=k.substring(0,k.length-J),L=L.substring(0,L.length-J);var ee=i(k,L);return re&&ee.unshift([r,re]),se&&ee.push([r,se]),_(ee,Y),V&&p(ee),ee}function i(k,L){var R;if(!k)return[[e,L]];if(!L)return[[t,k]];var V=k.length>L.length?k:L,Y=k.length>L.length?L:k,X=V.indexOf(Y);if(X!==-1)return R=[[e,V.substring(0,X)],[r,Y],[e,V.substring(X+Y.length)]],k.length>L.length&&(R[0][0]=R[2][0]=t),R;if(Y.length===1)return[[t,k],[e,L]];var J=h(k,L);if(J){var re=J[0],se=J[1],ee=J[2],q=J[3],U=J[4],W=n(re,ee),Z=n(se,q);return W.concat([[r,U]],Z)}return a(k,L)}function a(k,L){for(var R=k.length,V=L.length,Y=Math.ceil((R+V)/2),X=Y,J=2*Y,re=new Array(J),se=new Array(J),ee=0;ee<J;ee++)re[ee]=-1,se[ee]=-1;re[X+1]=0,se[X+1]=0;for(var q=R-V,U=q%2!==0,W=0,Z=0,de=0,be=0,oe=0;oe<Y;oe++){for(var ne=-oe+W;ne<=oe-Z;ne+=2){var H=X+ne,le;ne===-oe||ne!==oe&&re[H-1]<re[H+1]?le=re[H+1]:le=re[H-1]+1;for(var ye=le-ne;le<R&&ye<V&&k.charAt(le)===L.charAt(ye);)le++,ye++;if(re[H]=le,le>R)Z+=2;else if(ye>V)W+=2;else if(U){var me=X+q-ne;if(me>=0&&me<J&&se[me]!==-1){var ke=R-se[me];if(le>=ke)return o(k,L,le,ye)}}}for(var Ie=-oe+de;Ie<=oe-be;Ie+=2){var me=X+Ie,ke;Ie===-oe||Ie!==oe&&se[me-1]<se[me+1]?ke=se[me+1]:ke=se[me-1]+1;for(var ce=ke-Ie;ke<R&&ce<V&&k.charAt(R-ke-1)===L.charAt(V-ce-1);)ke++,ce++;if(se[me]=ke,ke>R)be+=2;else if(ce>V)de+=2;else if(!U){var H=X+q-Ie;if(H>=0&&H<J&&re[H]!==-1){var le=re[H],ye=X+le-H;if(ke=R-ke,le>=ke)return o(k,L,le,ye)}}}}return[[t,k],[e,L]]}function o(k,L,R,V){var Y=k.substring(0,R),X=L.substring(0,V),J=k.substring(R),re=L.substring(V),se=n(Y,X),ee=n(J,re);return se.concat(ee)}function l(k,L){if(!k||!L||k.charAt(0)!==L.charAt(0))return 0;for(var R=0,V=Math.min(k.length,L.length),Y=V,X=0;R<Y;)k.substring(X,Y)==L.substring(X,Y)?(R=Y,X=R):V=Y,Y=Math.floor((V-R)/2+R);return E(k.charCodeAt(Y-1))&&Y--,Y}function c(k,L){var R=k.length,V=L.length;if(R==0||V==0)return 0;R>V?k=k.substring(R-V):R<V&&(L=L.substring(0,R));var Y=Math.min(R,V);if(k==L)return Y;for(var X=0,J=1;;){var re=k.substring(Y-J),se=L.indexOf(re);if(se==-1)return X;J+=se,(se==0||k.substring(Y-J)==L.substring(0,J))&&(X=J,J++)}}function u(k,L){if(!k||!L||k.slice(-1)!==L.slice(-1))return 0;for(var R=0,V=Math.min(k.length,L.length),Y=V,X=0;R<Y;)k.substring(k.length-Y,k.length-X)==L.substring(L.length-Y,L.length-X)?(R=Y,X=R):V=Y,Y=Math.floor((V-R)/2+R);return I(k.charCodeAt(k.length-Y))&&Y--,Y}function h(k,L){var R=k.length>L.length?k:L,V=k.length>L.length?L:k;if(R.length<4||V.length*2<R.length)return null;function Y(Z,de,be){for(var oe=Z.substring(be,be+Math.floor(Z.length/4)),ne=-1,H="",le,ye,me,ke;(ne=de.indexOf(oe,ne+1))!==-1;){var Ie=l(Z.substring(be),de.substring(ne)),ce=u(Z.substring(0,be),de.substring(0,ne));H.length<ce+Ie&&(H=de.substring(ne-ce,ne)+de.substring(ne,ne+Ie),le=Z.substring(0,be-ce),ye=Z.substring(be+Ie),me=de.substring(0,ne-ce),ke=de.substring(ne+Ie))}return H.length*2>=Z.length?[le,ye,me,ke,H]:null}var X=Y(R,V,Math.ceil(R.length/4)),J=Y(R,V,Math.ceil(R.length/2)),re;if(!X&&!J)return null;J?X?re=X[4].length>J[4].length?X:J:re=J:re=X;var se,ee,q,U;k.length>L.length?(se=re[0],ee=re[1],q=re[2],U=re[3]):(q=re[0],U=re[1],se=re[2],ee=re[3]);var W=re[4];return[se,ee,q,U,W]}function p(k){for(var L=!1,R=[],V=0,Y=null,X=0,J=0,re=0,se=0,ee=0;X<k.length;)k[X][0]==r?(R[V++]=X,J=se,re=ee,se=0,ee=0,Y=k[X][1]):(k[X][0]==e?se+=k[X][1].length:ee+=k[X][1].length,Y&&Y.length<=Math.max(J,re)&&Y.length<=Math.max(se,ee)&&(k.splice(R[V-1],0,[t,Y]),k[R[V-1]+1][0]=e,V--,V--,X=V>0?R[V-1]:-1,J=0,re=0,se=0,ee=0,Y=null,L=!0)),X++;for(L&&_(k),j(k),X=1;X<k.length;){if(k[X-1][0]==t&&k[X][0]==e){var q=k[X-1][1],U=k[X][1],W=c(q,U),Z=c(U,q);W>=Z?(W>=q.length/2||W>=U.length/2)&&(k.splice(X,0,[r,U.substring(0,W)]),k[X-1][1]=q.substring(0,q.length-W),k[X+1][1]=U.substring(W),X++):(Z>=q.length/2||Z>=U.length/2)&&(k.splice(X,0,[r,q.substring(0,Z)]),k[X-1][0]=e,k[X-1][1]=U.substring(0,U.length-Z),k[X+1][0]=t,k[X+1][1]=q.substring(Z),X++),X++}X++}}var m=/[^a-zA-Z0-9]/,g=/\s/,b=/[\r\n]/,v=/\n\r?\n$/,w=/^\r?\n\r?\n/;function j(k){function L(Z,de){if(!Z||!de)return 6;var be=Z.charAt(Z.length-1),oe=de.charAt(0),ne=be.match(m),H=oe.match(m),le=ne&&be.match(g),ye=H&&oe.match(g),me=le&&be.match(b),ke=ye&&oe.match(b),Ie=me&&Z.match(v),ce=ke&&de.match(w);return Ie||ce?5:me||ke?4:ne&&!le&&ye?3:le||ye?2:ne||H?1:0}for(var R=1;R<k.length-1;){if(k[R-1][0]==r&&k[R+1][0]==r){var V=k[R-1][1],Y=k[R][1],X=k[R+1][1],J=u(V,Y);if(J){var re=Y.substring(Y.length-J);V=V.substring(0,V.length-J),Y=re+Y.substring(0,Y.length-J),X=re+X}for(var se=V,ee=Y,q=X,U=L(V,Y)+L(Y,X);Y.charAt(0)===X.charAt(0);){V+=Y.charAt(0),Y=Y.substring(1)+X.charAt(0),X=X.substring(1);var W=L(V,Y)+L(Y,X);W>=U&&(U=W,se=V,ee=Y,q=X)}k[R-1][1]!=se&&(se?k[R-1][1]=se:(k.splice(R-1,1),R--),k[R][1]=ee,q?k[R+1][1]=q:(k.splice(R+1,1),R--))}R++}}function _(k,L){k.push([r,""]);for(var R=0,V=0,Y=0,X="",J="",re;R<k.length;){if(R<k.length-1&&!k[R][1]){k.splice(R,1);continue}switch(k[R][0]){case e:Y++,J+=k[R][1],R++;break;case t:V++,X+=k[R][1],R++;break;case r:var se=R-Y-V-1;if(L){if(se>=0&&B(k[se][1])){var ee=k[se][1].slice(-1);if(k[se][1]=k[se][1].slice(0,-1),X=ee+X,J=ee+J,!k[se][1]){k.splice(se,1),R--;var q=se-1;k[q]&&k[q][0]===e&&(Y++,J=k[q][1]+J,q--),k[q]&&k[q][0]===t&&(V++,X=k[q][1]+X,q--),se=q}}if(O(k[R][1])){var ee=k[R][1].charAt(0);k[R][1]=k[R][1].slice(1),X+=ee,J+=ee}}if(R<k.length-1&&!k[R][1]){k.splice(R,1);break}if(X.length>0||J.length>0){X.length>0&&J.length>0&&(re=l(J,X),re!==0&&(se>=0?k[se][1]+=J.substring(0,re):(k.splice(0,0,[r,J.substring(0,re)]),R++),J=J.substring(re),X=X.substring(re)),re=u(J,X),re!==0&&(k[R][1]=J.substring(J.length-re)+k[R][1],J=J.substring(0,J.length-re),X=X.substring(0,X.length-re)));var U=Y+V;X.length===0&&J.length===0?(k.splice(R-U,U),R=R-U):X.length===0?(k.splice(R-U,U,[e,J]),R=R-U+1):J.length===0?(k.splice(R-U,U,[t,X]),R=R-U+1):(k.splice(R-U,U,[t,X],[e,J]),R=R-U+2)}R!==0&&k[R-1][0]===r?(k[R-1][1]+=k[R][1],k.splice(R,1)):R++,Y=0,V=0,X="",J="";break}}k[k.length-1][1]===""&&k.pop();var W=!1;for(R=1;R<k.length-1;)k[R-1][0]===r&&k[R+1][0]===r&&(k[R][1].substring(k[R][1].length-k[R-1][1].length)===k[R-1][1]?(k[R][1]=k[R-1][1]+k[R][1].substring(0,k[R][1].length-k[R-1][1].length),k[R+1][1]=k[R-1][1]+k[R+1][1],k.splice(R-1,1),W=!0):k[R][1].substring(0,k[R+1][1].length)==k[R+1][1]&&(k[R-1][1]+=k[R+1][1],k[R][1]=k[R][1].substring(k[R+1][1].length)+k[R+1][1],k.splice(R+1,1),W=!0)),R++;W&&_(k,L)}function E(k){return k>=55296&&k<=56319}function I(k){return k>=56320&&k<=57343}function O(k){return I(k.charCodeAt(0))}function B(k){return E(k.charCodeAt(k.length-1))}function S(k){for(var L=[],R=0;R<k.length;R++)k[R][1].length>0&&L.push(k[R]);return L}function T(k,L,R,V){return B(k)||O(V)?null:S([[r,k],[t,L],[e,R],[r,V]])}function M(k,L,R){var V=typeof R=="number"?{index:R,length:0}:R.oldRange,Y=typeof R=="number"?null:R.newRange,X=k.length,J=L.length;if(V.length===0&&(Y===null||Y.length===0)){var re=V.index,se=k.slice(0,re),ee=k.slice(re),q=Y?Y.index:null;e:{var U=re+J-X;if(q!==null&&q!==U||U<0||U>J)break e;var W=L.slice(0,U),Z=L.slice(U);if(Z!==ee)break e;var de=Math.min(re,U),be=se.slice(0,de),oe=W.slice(0,de);if(be!==oe)break e;var ne=se.slice(de),H=W.slice(de);return T(be,ne,H,ee)}e:{if(q!==null&&q!==re)break e;var le=re,W=L.slice(0,le),Z=L.slice(le);if(W!==se)break e;var ye=Math.min(X-le,J-le),me=ee.slice(ee.length-ye),ke=Z.slice(Z.length-ye);if(me!==ke)break e;var ne=ee.slice(0,ee.length-ye),H=Z.slice(0,Z.length-ye);return T(se,ne,H,me)}}if(V.length>0&&Y&&Y.length===0)e:{var be=k.slice(0,V.index),me=k.slice(V.index+V.length),de=be.length,ye=me.length;if(J<de+ye)break e;var oe=L.slice(0,de),ke=L.slice(J-ye);if(be!==oe||me!==ke)break e;var ne=k.slice(de,X-ye),H=L.slice(de,J-ye);return T(be,ne,H,me)}return null}function $(k,L,R,V){return n(k,L,R,V,!0)}return $.INSERT=e,$.DELETE=t,$.EQUAL=r,aC=$,aC}var Zy={exports:{}};Zy.exports;var L$;function IZ(){return L$||(L$=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Function]",p="[object GeneratorFunction]",m="[object Map]",g="[object Number]",b="[object Object]",v="[object Promise]",w="[object RegExp]",j="[object Set]",_="[object String]",E="[object Symbol]",I="[object WeakMap]",O="[object ArrayBuffer]",B="[object DataView]",S="[object Float32Array]",T="[object Float64Array]",M="[object Int8Array]",$="[object Int16Array]",k="[object Int32Array]",L="[object Uint8Array]",R="[object Uint8ClampedArray]",V="[object Uint16Array]",Y="[object Uint32Array]",X=/[\\^$.*+?()[\]{}|]/g,J=/\w*$/,re=/^\[object .+?Constructor\]$/,se=/^(?:0|[1-9]\d*)$/,ee={};ee[a]=ee[o]=ee[O]=ee[B]=ee[l]=ee[c]=ee[S]=ee[T]=ee[M]=ee[$]=ee[k]=ee[m]=ee[g]=ee[b]=ee[w]=ee[j]=ee[_]=ee[E]=ee[L]=ee[R]=ee[V]=ee[Y]=!0,ee[u]=ee[h]=ee[I]=!1;var q=typeof m0=="object"&&m0&&m0.Object===Object&&m0,U=typeof self=="object"&&self&&self.Object===Object&&self,W=q||U||Function("return this")(),Z=e&&!e.nodeType&&e,de=Z&&!0&&t&&!t.nodeType&&t,be=de&&de.exports===Z;function oe(Q,xe){return Q.set(xe[0],xe[1]),Q}function ne(Q,xe){return Q.add(xe),Q}function H(Q,xe){for(var Te=-1,dt=Q?Q.length:0;++Te<dt&&xe(Q[Te],Te,Q)!==!1;);return Q}function le(Q,xe){for(var Te=-1,dt=xe.length,_r=Q.length;++Te<dt;)Q[_r+Te]=xe[Te];return Q}function ye(Q,xe,Te,dt){for(var _r=-1,er=Q?Q.length:0;++_r<er;)Te=xe(Te,Q[_r],_r,Q);return Te}function me(Q,xe){for(var Te=-1,dt=Array(Q);++Te<Q;)dt[Te]=xe(Te);return dt}function ke(Q,xe){return Q?.[xe]}function Ie(Q){var xe=!1;if(Q!=null&&typeof Q.toString!="function")try{xe=!!(Q+"")}catch{}return xe}function ce(Q){var xe=-1,Te=Array(Q.size);return Q.forEach(function(dt,_r){Te[++xe]=[_r,dt]}),Te}function Be(Q,xe){return function(Te){return Q(xe(Te))}}function ct(Q){var xe=-1,Te=Array(Q.size);return Q.forEach(function(dt){Te[++xe]=dt}),Te}var Ve=Array.prototype,Ne=Function.prototype,Ye=Object.prototype,St=W["__core-js_shared__"],Vt=(function(){var Q=/[^.]+$/.exec(St&&St.keys&&St.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""})(),Lt=Ne.toString,at=Ye.hasOwnProperty,gt=Ye.toString,vt=RegExp("^"+Lt.call(at).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ft=be?W.Buffer:void 0,ot=W.Symbol,ut=W.Uint8Array,At=Be(Object.getPrototypeOf,Object),Fe=Object.create,Ut=Ye.propertyIsEnumerable,jt=Ve.splice,qe=Object.getOwnPropertySymbols,rt=ft?ft.isBuffer:void 0,Ot=Be(Object.keys,Object),pt=Ks(W,"DataView"),Jt=Ks(W,"Map"),Kt=Ks(W,"Promise"),rr=Ks(W,"Set"),Br=Ks(W,"WeakMap"),zt=Ks(Object,"create"),Wt=ls(pt),qt=ls(Jt),ur=ls(Kt),Re=ls(rr),Nt=ls(Br),Pt=ot?ot.prototype:void 0,It=Pt?Pt.valueOf:void 0;function Zt(Q){var xe=-1,Te=Q?Q.length:0;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function Ae(){this.__data__=zt?zt(null):{}}function et(Q){return this.has(Q)&&delete this.__data__[Q]}function Rt(Q){var xe=this.__data__;if(zt){var Te=xe[Q];return Te===n?void 0:Te}return at.call(xe,Q)?xe[Q]:void 0}function $t(Q){var xe=this.__data__;return zt?xe[Q]!==void 0:at.call(xe,Q)}function Qt(Q,xe){var Te=this.__data__;return Te[Q]=zt&&xe===void 0?n:xe,this}Zt.prototype.clear=Ae,Zt.prototype.delete=et,Zt.prototype.get=Rt,Zt.prototype.has=$t,Zt.prototype.set=Qt;function Ee(Q){var xe=-1,Te=Q?Q.length:0;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function Me(){this.__data__=[]}function Je(Q){var xe=this.__data__,Te=Li(xe,Q);if(Te<0)return!1;var dt=xe.length-1;return Te==dt?xe.pop():jt.call(xe,Te,1),!0}function Ft(Q){var xe=this.__data__,Te=Li(xe,Q);return Te<0?void 0:xe[Te][1]}function tr(Q){return Li(this.__data__,Q)>-1}function Rr(Q,xe){var Te=this.__data__,dt=Li(Te,Q);return dt<0?Te.push([Q,xe]):Te[dt][1]=xe,this}Ee.prototype.clear=Me,Ee.prototype.delete=Je,Ee.prototype.get=Ft,Ee.prototype.has=tr,Ee.prototype.set=Rr;function Kr(Q){var xe=-1,Te=Q?Q.length:0;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function $s(){this.__data__={hash:new Zt,map:new(Jt||Ee),string:new Zt}}function Ki(Q){return fo(this,Q).delete(Q)}function Ws(Q){return fo(this,Q).get(Q)}function Ts(Q){return fo(this,Q).has(Q)}function wa(Q,xe){return fo(this,Q).set(Q,xe),this}Kr.prototype.clear=$s,Kr.prototype.delete=Ki,Kr.prototype.get=Ws,Kr.prototype.has=Ts,Kr.prototype.set=wa;function Hn(Q){this.__data__=new Ee(Q)}function wi(){this.__data__=new Ee}function Yi(Q){return this.__data__.delete(Q)}function aa(Q){return this.__data__.get(Q)}function os(Q){return this.__data__.has(Q)}function kl(Q,xe){var Te=this.__data__;if(Te instanceof Ee){var dt=Te.__data__;if(!Jt||dt.length<r-1)return dt.push([Q,xe]),this;Te=this.__data__=new Kr(dt)}return Te.set(Q,xe),this}Hn.prototype.clear=wi,Hn.prototype.delete=Yi,Hn.prototype.get=aa,Hn.prototype.has=os,Hn.prototype.set=kl;function Gs(Q,xe){var Te=go(Q)||mr(Q)?me(Q.length,String):[],dt=Te.length,_r=!!dt;for(var er in Q)at.call(Q,er)&&!(_r&&(er=="length"||El(er,dt)))&&Te.push(er);return Te}function Xi(Q,xe,Te){var dt=Q[xe];(!(at.call(Q,xe)&&mo(dt,Te))||Te===void 0&&!(xe in Q))&&(Q[xe]=Te)}function Li(Q,xe){for(var Te=Q.length;Te--;)if(mo(Q[Te][0],xe))return Te;return-1}function Pi(Q,xe){return Q&&Sl(xe,bo(xe),Q)}function Bo(Q,xe,Te,dt,_r,er,Hr){var Xr;if(dt&&(Xr=er?dt(Q,_r,er,Hr):dt(Q)),Xr!==void 0)return Xr;if(!rn(Q))return Q;var Cn=go(Q);if(Cn){if(Xr=nc(Q),!xe)return tl(Q,Xr)}else{var Qr=Oi(Q),Un=Qr==h||Qr==p;if(Fs(Q))return Yr(Q,xe);if(Qr==b||Qr==a||Un&&!er){if(Ie(Q))return er?Q:{};if(Xr=oa(Un?{}:Q),!xe)return rc(Q,Pi(Xr,Q))}else{if(!ee[Qr])return er?Q:{};Xr=Cl(Q,Qr,Bo,xe)}}Hr||(Hr=new Hn);var Us=Hr.get(Q);if(Us)return Us;if(Hr.set(Q,Xr),!Cn)var ss=Te?Ni(Q):bo(Q);return H(ss||Q,function(Rn,Wn){ss&&(Wn=Rn,Rn=Q[Wn]),Xi(Xr,Wn,Bo(Rn,xe,Te,dt,Wn,Q,Hr))}),Xr}function _l(Q){return rn(Q)?Fe(Q):{}}function tc(Q,xe,Te){var dt=xe(Q);return go(Q)?dt:le(dt,Te(Q))}function Qi(Q){return gt.call(Q)}function oi(Q){if(!rn(Q)||Ri(Q))return!1;var xe=ys(Q)||Ie(Q)?vt:re;return xe.test(ls(Q))}function xs(Q){if(!la(Q))return Ot(Q);var xe=[];for(var Te in Object(Q))at.call(Q,Te)&&Te!="constructor"&&xe.push(Te);return xe}function Yr(Q,xe){if(xe)return Q.slice();var Te=new Q.constructor(Q.length);return Q.copy(Te),Te}function Na(Q){var xe=new Q.constructor(Q.byteLength);return new ut(xe).set(new ut(Q)),xe}function li(Q,xe){var Te=xe?Na(Q.buffer):Q.buffer;return new Q.constructor(Te,Q.byteOffset,Q.byteLength)}function an(Q,xe,Te){var dt=xe?Te(ce(Q),!0):ce(Q);return ye(dt,oe,new Q.constructor)}function ho(Q){var xe=new Q.constructor(Q.source,J.exec(Q));return xe.lastIndex=Q.lastIndex,xe}function Is(Q,xe,Te){var dt=xe?Te(ct(Q),!0):ct(Q);return ye(dt,ne,new Q.constructor)}function Zn(Q){return It?Object(It.call(Q)):{}}function bs(Q,xe){var Te=xe?Na(Q.buffer):Q.buffer;return new Q.constructor(Te,Q.byteOffset,Q.length)}function tl(Q,xe){var Te=-1,dt=Q.length;for(xe||(xe=Array(dt));++Te<dt;)xe[Te]=Q[Te];return xe}function Sl(Q,xe,Te,dt){Te||(Te={});for(var _r=-1,er=xe.length;++_r<er;){var Hr=xe[_r],Xr=void 0;Xi(Te,Hr,Xr===void 0?Q[Hr]:Xr)}return Te}function rc(Q,xe){return Sl(Q,es(Q),xe)}function Ni(Q){return tc(Q,bo,es)}function fo(Q,xe){var Te=Q.__data__;return po(xe)?Te[typeof xe=="string"?"string":"hash"]:Te.map}function Ks(Q,xe){var Te=ke(Q,xe);return oi(Te)?Te:void 0}var es=qe?Be(qe,Object):ja,Oi=Qi;(pt&&Oi(new pt(new ArrayBuffer(1)))!=B||Jt&&Oi(new Jt)!=m||Kt&&Oi(Kt.resolve())!=v||rr&&Oi(new rr)!=j||Br&&Oi(new Br)!=I)&&(Oi=function(Q){var xe=gt.call(Q),Te=xe==b?Q.constructor:void 0,dt=Te?ls(Te):void 0;if(dt)switch(dt){case Wt:return B;case qt:return m;case ur:return v;case Re:return j;case Nt:return I}return xe});function nc(Q){var xe=Q.length,Te=Q.constructor(xe);return xe&&typeof Q[0]=="string"&&at.call(Q,"index")&&(Te.index=Q.index,Te.input=Q.input),Te}function oa(Q){return typeof Q.constructor=="function"&&!la(Q)?_l(At(Q)):{}}function Cl(Q,xe,Te,dt){var _r=Q.constructor;switch(xe){case O:return Na(Q);case l:case c:return new _r(+Q);case B:return li(Q,dt);case S:case T:case M:case $:case k:case L:case R:case V:case Y:return bs(Q,dt);case m:return an(Q,dt,Te);case g:case _:return new _r(Q);case w:return ho(Q);case j:return Is(Q,dt,Te);case E:return Zn(Q)}}function El(Q,xe){return xe=xe??i,!!xe&&(typeof Q=="number"||se.test(Q))&&Q>-1&&Q%1==0&&Q<xe}function po(Q){var xe=typeof Q;return xe=="string"||xe=="number"||xe=="symbol"||xe=="boolean"?Q!=="__proto__":Q===null}function Ri(Q){return!!Vt&&Vt in Q}function la(Q){var xe=Q&&Q.constructor,Te=typeof xe=="function"&&xe.prototype||Ye;return Q===Te}function ls(Q){if(Q!=null){try{return Lt.call(Q)}catch{}try{return Q+""}catch{}}return""}function ji(Q){return Bo(Q,!0,!0)}function mo(Q,xe){return Q===xe||Q!==Q&&xe!==xe}function mr(Q){return $o(Q)&&at.call(Q,"callee")&&(!Ut.call(Q,"callee")||gt.call(Q)==a)}var go=Array.isArray;function xo(Q){return Q!=null&&Fo(Q.length)&&!ys(Q)}function $o(Q){return Mi(Q)&&xo(Q)}var Fs=rt||sc;function ys(Q){var xe=rn(Q)?gt.call(Q):"";return xe==h||xe==p}function Fo(Q){return typeof Q=="number"&&Q>-1&&Q%1==0&&Q<=i}function rn(Q){var xe=typeof Q;return!!Q&&(xe=="object"||xe=="function")}function Mi(Q){return!!Q&&typeof Q=="object"}function bo(Q){return xo(Q)?Gs(Q):xs(Q)}function ja(){return[]}function sc(){return!1}t.exports=ji})(Zy,Zy.exports)),Zy.exports}var ev={exports:{}};ev.exports;var P$;function LZ(){return P$||(P$=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",h="[object Boolean]",p="[object Date]",m="[object Error]",g="[object Function]",b="[object GeneratorFunction]",v="[object Map]",w="[object Number]",j="[object Null]",_="[object Object]",E="[object Promise]",I="[object Proxy]",O="[object RegExp]",B="[object Set]",S="[object String]",T="[object Symbol]",M="[object Undefined]",$="[object WeakMap]",k="[object ArrayBuffer]",L="[object DataView]",R="[object Float32Array]",V="[object Float64Array]",Y="[object Int8Array]",X="[object Int16Array]",J="[object Int32Array]",re="[object Uint8Array]",se="[object Uint8ClampedArray]",ee="[object Uint16Array]",q="[object Uint32Array]",U=/[\\^$.*+?()[\]{}|]/g,W=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,de={};de[R]=de[V]=de[Y]=de[X]=de[J]=de[re]=de[se]=de[ee]=de[q]=!0,de[l]=de[c]=de[k]=de[h]=de[L]=de[p]=de[m]=de[g]=de[v]=de[w]=de[_]=de[O]=de[B]=de[S]=de[$]=!1;var be=typeof m0=="object"&&m0&&m0.Object===Object&&m0,oe=typeof self=="object"&&self&&self.Object===Object&&self,ne=be||oe||Function("return this")(),H=e&&!e.nodeType&&e,le=H&&!0&&t&&!t.nodeType&&t,ye=le&&le.exports===H,me=ye&&be.process,ke=(function(){try{return me&&me.binding&&me.binding("util")}catch{}})(),Ie=ke&&ke.isTypedArray;function ce(Q,xe){for(var Te=-1,dt=Q==null?0:Q.length,_r=0,er=[];++Te<dt;){var Hr=Q[Te];xe(Hr,Te,Q)&&(er[_r++]=Hr)}return er}function Be(Q,xe){for(var Te=-1,dt=xe.length,_r=Q.length;++Te<dt;)Q[_r+Te]=xe[Te];return Q}function ct(Q,xe){for(var Te=-1,dt=Q==null?0:Q.length;++Te<dt;)if(xe(Q[Te],Te,Q))return!0;return!1}function Ve(Q,xe){for(var Te=-1,dt=Array(Q);++Te<Q;)dt[Te]=xe(Te);return dt}function Ne(Q){return function(xe){return Q(xe)}}function Ye(Q,xe){return Q.has(xe)}function St(Q,xe){return Q?.[xe]}function Vt(Q){var xe=-1,Te=Array(Q.size);return Q.forEach(function(dt,_r){Te[++xe]=[_r,dt]}),Te}function Lt(Q,xe){return function(Te){return Q(xe(Te))}}function at(Q){var xe=-1,Te=Array(Q.size);return Q.forEach(function(dt){Te[++xe]=dt}),Te}var gt=Array.prototype,vt=Function.prototype,ft=Object.prototype,ot=ne["__core-js_shared__"],ut=vt.toString,At=ft.hasOwnProperty,Fe=(function(){var Q=/[^.]+$/.exec(ot&&ot.keys&&ot.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""})(),Ut=ft.toString,jt=RegExp("^"+ut.call(At).replace(U,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=ye?ne.Buffer:void 0,rt=ne.Symbol,Ot=ne.Uint8Array,pt=ft.propertyIsEnumerable,Jt=gt.splice,Kt=rt?rt.toStringTag:void 0,rr=Object.getOwnPropertySymbols,Br=qe?qe.isBuffer:void 0,zt=Lt(Object.keys,Object),Wt=es(ne,"DataView"),qt=es(ne,"Map"),ur=es(ne,"Promise"),Re=es(ne,"Set"),Nt=es(ne,"WeakMap"),Pt=es(Object,"create"),It=ls(Wt),Zt=ls(qt),Ae=ls(ur),et=ls(Re),Rt=ls(Nt),$t=rt?rt.prototype:void 0,Qt=$t?$t.valueOf:void 0;function Ee(Q){var xe=-1,Te=Q==null?0:Q.length;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function Me(){this.__data__=Pt?Pt(null):{},this.size=0}function Je(Q){var xe=this.has(Q)&&delete this.__data__[Q];return this.size-=xe?1:0,xe}function Ft(Q){var xe=this.__data__;if(Pt){var Te=xe[Q];return Te===n?void 0:Te}return At.call(xe,Q)?xe[Q]:void 0}function tr(Q){var xe=this.__data__;return Pt?xe[Q]!==void 0:At.call(xe,Q)}function Rr(Q,xe){var Te=this.__data__;return this.size+=this.has(Q)?0:1,Te[Q]=Pt&&xe===void 0?n:xe,this}Ee.prototype.clear=Me,Ee.prototype.delete=Je,Ee.prototype.get=Ft,Ee.prototype.has=tr,Ee.prototype.set=Rr;function Kr(Q){var xe=-1,Te=Q==null?0:Q.length;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function $s(){this.__data__=[],this.size=0}function Ki(Q){var xe=this.__data__,Te=Yr(xe,Q);if(Te<0)return!1;var dt=xe.length-1;return Te==dt?xe.pop():Jt.call(xe,Te,1),--this.size,!0}function Ws(Q){var xe=this.__data__,Te=Yr(xe,Q);return Te<0?void 0:xe[Te][1]}function Ts(Q){return Yr(this.__data__,Q)>-1}function wa(Q,xe){var Te=this.__data__,dt=Yr(Te,Q);return dt<0?(++this.size,Te.push([Q,xe])):Te[dt][1]=xe,this}Kr.prototype.clear=$s,Kr.prototype.delete=Ki,Kr.prototype.get=Ws,Kr.prototype.has=Ts,Kr.prototype.set=wa;function Hn(Q){var xe=-1,Te=Q==null?0:Q.length;for(this.clear();++xe<Te;){var dt=Q[xe];this.set(dt[0],dt[1])}}function wi(){this.size=0,this.__data__={hash:new Ee,map:new(qt||Kr),string:new Ee}}function Yi(Q){var xe=Ks(this,Q).delete(Q);return this.size-=xe?1:0,xe}function aa(Q){return Ks(this,Q).get(Q)}function os(Q){return Ks(this,Q).has(Q)}function kl(Q,xe){var Te=Ks(this,Q),dt=Te.size;return Te.set(Q,xe),this.size+=Te.size==dt?0:1,this}Hn.prototype.clear=wi,Hn.prototype.delete=Yi,Hn.prototype.get=aa,Hn.prototype.has=os,Hn.prototype.set=kl;function Gs(Q){var xe=-1,Te=Q==null?0:Q.length;for(this.__data__=new Hn;++xe<Te;)this.add(Q[xe])}function Xi(Q){return this.__data__.set(Q,n),this}function Li(Q){return this.__data__.has(Q)}Gs.prototype.add=Gs.prototype.push=Xi,Gs.prototype.has=Li;function Pi(Q){var xe=this.__data__=new Kr(Q);this.size=xe.size}function Bo(){this.__data__=new Kr,this.size=0}function _l(Q){var xe=this.__data__,Te=xe.delete(Q);return this.size=xe.size,Te}function tc(Q){return this.__data__.get(Q)}function Qi(Q){return this.__data__.has(Q)}function oi(Q,xe){var Te=this.__data__;if(Te instanceof Kr){var dt=Te.__data__;if(!qt||dt.length<r-1)return dt.push([Q,xe]),this.size=++Te.size,this;Te=this.__data__=new Hn(dt)}return Te.set(Q,xe),this.size=Te.size,this}Pi.prototype.clear=Bo,Pi.prototype.delete=_l,Pi.prototype.get=tc,Pi.prototype.has=Qi,Pi.prototype.set=oi;function xs(Q,xe){var Te=mr(Q),dt=!Te&&mo(Q),_r=!Te&&!dt&&xo(Q),er=!Te&&!dt&&!_r&&Mi(Q),Hr=Te||dt||_r||er,Xr=Hr?Ve(Q.length,String):[],Cn=Xr.length;for(var Qr in Q)At.call(Q,Qr)&&!(Hr&&(Qr=="length"||_r&&(Qr=="offset"||Qr=="parent")||er&&(Qr=="buffer"||Qr=="byteLength"||Qr=="byteOffset")||Cl(Qr,Cn)))&&Xr.push(Qr);return Xr}function Yr(Q,xe){for(var Te=Q.length;Te--;)if(ji(Q[Te][0],xe))return Te;return-1}function Na(Q,xe,Te){var dt=xe(Q);return mr(Q)?dt:Be(dt,Te(Q))}function li(Q){return Q==null?Q===void 0?M:j:Kt&&Kt in Object(Q)?Oi(Q):la(Q)}function an(Q){return rn(Q)&&li(Q)==l}function ho(Q,xe,Te,dt,_r){return Q===xe?!0:Q==null||xe==null||!rn(Q)&&!rn(xe)?Q!==Q&&xe!==xe:Is(Q,xe,Te,dt,ho,_r)}function Is(Q,xe,Te,dt,_r,er){var Hr=mr(Q),Xr=mr(xe),Cn=Hr?c:oa(Q),Qr=Xr?c:oa(xe);Cn=Cn==l?_:Cn,Qr=Qr==l?_:Qr;var Un=Cn==_,Us=Qr==_,ss=Cn==Qr;if(ss&&xo(Q)){if(!xo(xe))return!1;Hr=!0,Un=!1}if(ss&&!Un)return er||(er=new Pi),Hr||Mi(Q)?Sl(Q,xe,Te,dt,_r,er):rc(Q,xe,Cn,Te,dt,_r,er);if(!(Te&i)){var Rn=Un&&At.call(Q,"__wrapped__"),Wn=Us&&At.call(xe,"__wrapped__");if(Rn||Wn){var Wa=Rn?Q.value():Q,Ys=Wn?xe.value():xe;return er||(er=new Pi),_r(Wa,Ys,Te,dt,er)}}return ss?(er||(er=new Pi),Ni(Q,xe,Te,dt,_r,er)):!1}function Zn(Q){if(!Fo(Q)||po(Q))return!1;var xe=Fs(Q)?jt:W;return xe.test(ls(Q))}function bs(Q){return rn(Q)&&ys(Q.length)&&!!de[li(Q)]}function tl(Q){if(!Ri(Q))return zt(Q);var xe=[];for(var Te in Object(Q))At.call(Q,Te)&&Te!="constructor"&&xe.push(Te);return xe}function Sl(Q,xe,Te,dt,_r,er){var Hr=Te&i,Xr=Q.length,Cn=xe.length;if(Xr!=Cn&&!(Hr&&Cn>Xr))return!1;var Qr=er.get(Q);if(Qr&&er.get(xe))return Qr==xe;var Un=-1,Us=!0,ss=Te&a?new Gs:void 0;for(er.set(Q,xe),er.set(xe,Q);++Un<Xr;){var Rn=Q[Un],Wn=xe[Un];if(dt)var Wa=Hr?dt(Wn,Rn,Un,xe,Q,er):dt(Rn,Wn,Un,Q,xe,er);if(Wa!==void 0){if(Wa)continue;Us=!1;break}if(ss){if(!ct(xe,function(Ys,Ga){if(!Ye(ss,Ga)&&(Rn===Ys||_r(Rn,Ys,Te,dt,er)))return ss.push(Ga)})){Us=!1;break}}else if(!(Rn===Wn||_r(Rn,Wn,Te,dt,er))){Us=!1;break}}return er.delete(Q),er.delete(xe),Us}function rc(Q,xe,Te,dt,_r,er,Hr){switch(Te){case L:if(Q.byteLength!=xe.byteLength||Q.byteOffset!=xe.byteOffset)return!1;Q=Q.buffer,xe=xe.buffer;case k:return!(Q.byteLength!=xe.byteLength||!er(new Ot(Q),new Ot(xe)));case h:case p:case w:return ji(+Q,+xe);case m:return Q.name==xe.name&&Q.message==xe.message;case O:case S:return Q==xe+"";case v:var Xr=Vt;case B:var Cn=dt&i;if(Xr||(Xr=at),Q.size!=xe.size&&!Cn)return!1;var Qr=Hr.get(Q);if(Qr)return Qr==xe;dt|=a,Hr.set(Q,xe);var Un=Sl(Xr(Q),Xr(xe),dt,_r,er,Hr);return Hr.delete(Q),Un;case T:if(Qt)return Qt.call(Q)==Qt.call(xe)}return!1}function Ni(Q,xe,Te,dt,_r,er){var Hr=Te&i,Xr=fo(Q),Cn=Xr.length,Qr=fo(xe),Un=Qr.length;if(Cn!=Un&&!Hr)return!1;for(var Us=Cn;Us--;){var ss=Xr[Us];if(!(Hr?ss in xe:At.call(xe,ss)))return!1}var Rn=er.get(Q);if(Rn&&er.get(xe))return Rn==xe;var Wn=!0;er.set(Q,xe),er.set(xe,Q);for(var Wa=Hr;++Us<Cn;){ss=Xr[Us];var Ys=Q[ss],Ga=xe[ss];if(dt)var z=Hr?dt(Ga,Ys,ss,xe,Q,er):dt(Ys,Ga,ss,Q,xe,er);if(!(z===void 0?Ys===Ga||_r(Ys,Ga,Te,dt,er):z)){Wn=!1;break}Wa||(Wa=ss=="constructor")}if(Wn&&!Wa){var ue=Q.constructor,_e=xe.constructor;ue!=_e&&"constructor"in Q&&"constructor"in xe&&!(typeof ue=="function"&&ue instanceof ue&&typeof _e=="function"&&_e instanceof _e)&&(Wn=!1)}return er.delete(Q),er.delete(xe),Wn}function fo(Q){return Na(Q,bo,nc)}function Ks(Q,xe){var Te=Q.__data__;return El(xe)?Te[typeof xe=="string"?"string":"hash"]:Te.map}function es(Q,xe){var Te=St(Q,xe);return Zn(Te)?Te:void 0}function Oi(Q){var xe=At.call(Q,Kt),Te=Q[Kt];try{Q[Kt]=void 0;var dt=!0}catch{}var _r=Ut.call(Q);return dt&&(xe?Q[Kt]=Te:delete Q[Kt]),_r}var nc=rr?function(Q){return Q==null?[]:(Q=Object(Q),ce(rr(Q),function(xe){return pt.call(Q,xe)}))}:ja,oa=li;(Wt&&oa(new Wt(new ArrayBuffer(1)))!=L||qt&&oa(new qt)!=v||ur&&oa(ur.resolve())!=E||Re&&oa(new Re)!=B||Nt&&oa(new Nt)!=$)&&(oa=function(Q){var xe=li(Q),Te=xe==_?Q.constructor:void 0,dt=Te?ls(Te):"";if(dt)switch(dt){case It:return L;case Zt:return v;case Ae:return E;case et:return B;case Rt:return $}return xe});function Cl(Q,xe){return xe=xe??o,!!xe&&(typeof Q=="number"||Z.test(Q))&&Q>-1&&Q%1==0&&Q<xe}function El(Q){var xe=typeof Q;return xe=="string"||xe=="number"||xe=="symbol"||xe=="boolean"?Q!=="__proto__":Q===null}function po(Q){return!!Fe&&Fe in Q}function Ri(Q){var xe=Q&&Q.constructor,Te=typeof xe=="function"&&xe.prototype||ft;return Q===Te}function la(Q){return Ut.call(Q)}function ls(Q){if(Q!=null){try{return ut.call(Q)}catch{}try{return Q+""}catch{}}return""}function ji(Q,xe){return Q===xe||Q!==Q&&xe!==xe}var mo=an((function(){return arguments})())?an:function(Q){return rn(Q)&&At.call(Q,"callee")&&!pt.call(Q,"callee")},mr=Array.isArray;function go(Q){return Q!=null&&ys(Q.length)&&!Fs(Q)}var xo=Br||sc;function $o(Q,xe){return ho(Q,xe)}function Fs(Q){if(!Fo(Q))return!1;var xe=li(Q);return xe==g||xe==b||xe==u||xe==I}function ys(Q){return typeof Q=="number"&&Q>-1&&Q%1==0&&Q<=o}function Fo(Q){var xe=typeof Q;return Q!=null&&(xe=="object"||xe=="function")}function rn(Q){return Q!=null&&typeof Q=="object"}var Mi=Ie?Ne(Ie):bs;function bo(Q){return go(Q)?xs(Q):tl(Q)}function ja(){return[]}function sc(){return!1}t.exports=$o})(ev,ev.exports)),ev.exports}var Ww={},O$;function UCe(){if(O$)return Ww;O$=1,Object.defineProperty(Ww,"__esModule",{value:!0});const t=IZ(),e=LZ();var r;return(function(n){function i(c={},u={},h=!1){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});let p=t(u);h||(p=Object.keys(p).reduce((m,g)=>(p[g]!=null&&(m[g]=p[g]),m),{}));for(const m in c)c[m]!==void 0&&u[m]===void 0&&(p[m]=c[m]);return Object.keys(p).length>0?p:void 0}n.compose=i;function a(c={},u={}){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});const h=Object.keys(c).concat(Object.keys(u)).reduce((p,m)=>(e(c[m],u[m])||(p[m]=u[m]===void 0?null:u[m]),p),{});return Object.keys(h).length>0?h:void 0}n.diff=a;function o(c={},u={}){c=c||{};const h=Object.keys(u).reduce((p,m)=>(u[m]!==c[m]&&c[m]!==void 0&&(p[m]=u[m]),p),{});return Object.keys(c).reduce((p,m)=>(c[m]!==u[m]&&u[m]===void 0&&(p[m]=null),p),h)}n.invert=o;function l(c,u,h=!1){if(typeof c!="object")return u;if(typeof u!="object")return;if(!h)return u;const p=Object.keys(u).reduce((m,g)=>(c[g]===void 0&&(m[g]=u[g]),m),{});return Object.keys(p).length>0?p:void 0}n.transform=l})(r||(r={})),Ww.default=r,Ww}var Gw={},R$;function PZ(){if(R$)return Gw;R$=1,Object.defineProperty(Gw,"__esModule",{value:!0});var t;return(function(e){function r(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=r})(t||(t={})),Gw.default=t,Gw}var Kw={},M$;function zCe(){if(M$)return Kw;M$=1,Object.defineProperty(Kw,"__esModule",{value:!0});const t=PZ();class e{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const i=this.ops[this.index];if(i){const a=this.offset,o=t.default.length(i);if(n>=o-a?(n=o-a,this.index+=1,this.offset=0):this.offset+=n,typeof i.delete=="number")return{delete:n};{const l={};return i.attributes&&(l.attributes=i.attributes),typeof i.retain=="number"?l.retain=n:typeof i.retain=="object"&&i.retain!==null?l.retain=i.retain:typeof i.insert=="string"?l.insert=i.insert.substr(a,n):l.insert=i.insert,l}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?t.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,i=this.index,a=this.next(),o=this.ops.slice(this.index);return this.offset=n,this.index=i,[a].concat(o)}}else return[]}}return Kw.default=e,Kw}var D$;function qCe(){return D$||(D$=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const r=FCe(),n=IZ(),i=LZ(),a=UCe();e.AttributeMap=a.default;const o=PZ();e.Op=o.default;const l=zCe();e.OpIterator=l.default;const c="\0",u=(p,m)=>{if(typeof p!="object"||p===null)throw new Error(`cannot retain a ${typeof p}`);if(typeof m!="object"||m===null)throw new Error(`cannot retain a ${typeof m}`);const g=Object.keys(p)[0];if(!g||g!==Object.keys(m)[0])throw new Error(`embed types not matched: ${g} != ${Object.keys(m)[0]}`);return[g,p[g],m[g]]};class h{constructor(m){Array.isArray(m)?this.ops=m:m!=null&&Array.isArray(m.ops)?this.ops=m.ops:this.ops=[]}static registerEmbed(m,g){this.handlers[m]=g}static unregisterEmbed(m){delete this.handlers[m]}static getHandler(m){const g=this.handlers[m];if(!g)throw new Error(`no handlers for embed type "${m}"`);return g}insert(m,g){const b={};return typeof m=="string"&&m.length===0?this:(b.insert=m,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(b.attributes=g),this.push(b))}delete(m){return m<=0?this:this.push({delete:m})}retain(m,g){if(typeof m=="number"&&m<=0)return this;const b={retain:m};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(b.attributes=g),this.push(b)}push(m){let g=this.ops.length,b=this.ops[g-1];if(m=n(m),typeof b=="object"){if(typeof m.delete=="number"&&typeof b.delete=="number")return this.ops[g-1]={delete:b.delete+m.delete},this;if(typeof b.delete=="number"&&m.insert!=null&&(g-=1,b=this.ops[g-1],typeof b!="object"))return this.ops.unshift(m),this;if(i(m.attributes,b.attributes)){if(typeof m.insert=="string"&&typeof b.insert=="string")return this.ops[g-1]={insert:b.insert+m.insert},typeof m.attributes=="object"&&(this.ops[g-1].attributes=m.attributes),this;if(typeof m.retain=="number"&&typeof b.retain=="number")return this.ops[g-1]={retain:b.retain+m.retain},typeof m.attributes=="object"&&(this.ops[g-1].attributes=m.attributes),this}}return g===this.ops.length?this.ops.push(m):this.ops.splice(g,0,m),this}chop(){const m=this.ops[this.ops.length-1];return m&&typeof m.retain=="number"&&!m.attributes&&this.ops.pop(),this}filter(m){return this.ops.filter(m)}forEach(m){this.ops.forEach(m)}map(m){return this.ops.map(m)}partition(m){const g=[],b=[];return this.forEach(v=>{(m(v)?g:b).push(v)}),[g,b]}reduce(m,g){return this.ops.reduce(m,g)}changeLength(){return this.reduce((m,g)=>g.insert?m+o.default.length(g):g.delete?m-g.delete:m,0)}length(){return this.reduce((m,g)=>m+o.default.length(g),0)}slice(m=0,g=1/0){const b=[],v=new l.default(this.ops);let w=0;for(;w<g&&v.hasNext();){let j;w<m?j=v.next(m-w):(j=v.next(g-w),b.push(j)),w+=o.default.length(j)}return new h(b)}compose(m){const g=new l.default(this.ops),b=new l.default(m.ops),v=[],w=b.peek();if(w!=null&&typeof w.retain=="number"&&w.attributes==null){let _=w.retain;for(;g.peekType()==="insert"&&g.peekLength()<=_;)_-=g.peekLength(),v.push(g.next());w.retain-_>0&&b.next(w.retain-_)}const j=new h(v);for(;g.hasNext()||b.hasNext();)if(b.peekType()==="insert")j.push(b.next());else if(g.peekType()==="delete")j.push(g.next());else{const _=Math.min(g.peekLength(),b.peekLength()),E=g.next(_),I=b.next(_);if(I.retain){const O={};if(typeof E.retain=="number")O.retain=typeof I.retain=="number"?_:I.retain;else if(typeof I.retain=="number")E.retain==null?O.insert=E.insert:O.retain=E.retain;else{const S=E.retain==null?"insert":"retain",[T,M,$]=u(E[S],I.retain),k=h.getHandler(T);O[S]={[T]:k.compose(M,$,S==="retain")}}const B=a.default.compose(E.attributes,I.attributes,typeof E.retain=="number");if(B&&(O.attributes=B),j.push(O),!b.hasNext()&&i(j.ops[j.ops.length-1],O)){const S=new h(g.rest());return j.concat(S).chop()}}else typeof I.delete=="number"&&(typeof E.retain=="number"||typeof E.retain=="object"&&E.retain!==null)&&j.push(I)}return j.chop()}concat(m){const g=new h(this.ops.slice());return m.ops.length>0&&(g.push(m.ops[0]),g.ops=g.ops.concat(m.ops.slice(1))),g}diff(m,g){if(this.ops===m.ops)return new h;const b=[this,m].map(E=>E.map(I=>{if(I.insert!=null)return typeof I.insert=="string"?I.insert:c;const O=E===m?"on":"with";throw new Error("diff() called "+O+" non-document")}).join("")),v=new h,w=r(b[0],b[1],g,!0),j=new l.default(this.ops),_=new l.default(m.ops);return w.forEach(E=>{let I=E[1].length;for(;I>0;){let O=0;switch(E[0]){case r.INSERT:O=Math.min(_.peekLength(),I),v.push(_.next(O));break;case r.DELETE:O=Math.min(I,j.peekLength()),j.next(O),v.delete(O);break;case r.EQUAL:O=Math.min(j.peekLength(),_.peekLength(),I);const B=j.next(O),S=_.next(O);i(B.insert,S.insert)?v.retain(O,a.default.diff(B.attributes,S.attributes)):v.push(S).delete(O);break}I-=O}}),v.chop()}eachLine(m,g=`
`){const b=new l.default(this.ops);let v=new h,w=0;for(;b.hasNext();){if(b.peekType()!=="insert")return;const j=b.peek(),_=o.default.length(j)-b.peekLength(),E=typeof j.insert=="string"?j.insert.indexOf(g,_)-_:-1;if(E<0)v.push(b.next());else if(E>0)v.push(b.next(E));else{if(m(v,b.next(1).attributes||{},w)===!1)return;w+=1,v=new h}}v.length()>0&&m(v,{},w)}invert(m){const g=new h;return this.reduce((b,v)=>{if(v.insert)g.delete(o.default.length(v));else{if(typeof v.retain=="number"&&v.attributes==null)return g.retain(v.retain),b+v.retain;if(v.delete||typeof v.retain=="number"){const w=v.delete||v.retain;return m.slice(b,b+w).forEach(_=>{v.delete?g.push(_):v.retain&&v.attributes&&g.retain(o.default.length(_),a.default.invert(v.attributes,_.attributes))}),b+w}else if(typeof v.retain=="object"&&v.retain!==null){const w=m.slice(b,b+1),j=new l.default(w.ops).next(),[_,E,I]=u(v.retain,j.insert),O=h.getHandler(_);return g.retain({[_]:O.invert(E,I)},a.default.invert(v.attributes,j.attributes)),b+1}}return b},0),g.chop()}transform(m,g=!1){if(g=!!g,typeof m=="number")return this.transformPosition(m,g);const b=m,v=new l.default(this.ops),w=new l.default(b.ops),j=new h;for(;v.hasNext()||w.hasNext();)if(v.peekType()==="insert"&&(g||w.peekType()!=="insert"))j.retain(o.default.length(v.next()));else if(w.peekType()==="insert")j.push(w.next());else{const _=Math.min(v.peekLength(),w.peekLength()),E=v.next(_),I=w.next(_);if(E.delete)continue;if(I.delete)j.push(I);else{const O=E.retain,B=I.retain;let S=typeof B=="object"&&B!==null?B:_;if(typeof O=="object"&&O!==null&&typeof B=="object"&&B!==null){const T=Object.keys(O)[0];if(T===Object.keys(B)[0]){const M=h.getHandler(T);M&&(S={[T]:M.transform(O[T],B[T],g)})}}j.retain(S,a.default.transform(E.attributes,I.attributes,g))}}return j.chop()}transformPosition(m,g=!1){g=!!g;const b=new l.default(this.ops);let v=0;for(;b.hasNext()&&v<=m;){const w=b.peekLength(),j=b.peekType();if(b.next(),j==="delete"){m-=Math.min(w,m-v);continue}else j==="insert"&&(v<m||!g)&&(m+=w);v+=w}return m}}h.Op=o.default,h.OpIterator=l.default,h.AttributeMap=a.default,h.handlers={},e.default=h,t.exports=h,t.exports.default=h})(Hw,Hw.exports)),Hw.exports}var Zc=qCe();const br=bl(Zc);class Zu extends Cc{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Zu.blotName="break";Zu.tagName="BR";let Wu=class extends xj{};const VCe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function jk(t){return t.replace(/[&<>"']/g,e=>VCe[e])}class ll extends xL{static allowedChildren=[ll,Zu,Cc,Wu];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,r){const n=ll.order.indexOf(e),i=ll.order.indexOf(r);return n>=0||i>=0?n-i:e===r?0:e<r?-1:1}formatAt(e,r,n,i){if(ll.compare(this.statics.blotName,n)<0&&this.scroll.query(n,wr.BLOT)){const a=this.isolate(e,r);i&&a.wrap(n,i)}else super.formatAt(e,r,n,i)}optimize(e){if(super.optimize(e),this.parent instanceof ll&&ll.compare(this.statics.blotName,this.parent.statics.blotName)>0){const r=this.parent.isolate(this.offset(),this.length());this.moveChildren(r),r.wrap(this)}}}const B$=1;class Oo extends t1{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=OZ(this)),this.cache.delta}deleteAt(e,r){super.deleteAt(e,r),this.cache={}}formatAt(e,r,n,i){r<=0||(this.scroll.query(n,wr.BLOCK)?e+r===this.length()&&this.format(n,i):super.formatAt(e,Math.min(r,this.length()-e-1),n,i),this.cache={})}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n),this.cache={};return}if(r.length===0)return;const i=r.split(`
`),a=i.shift();a.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});let o=this;i.reduce((l,c)=>(o=o.split(l,!0),o.insertAt(0,c),c.length),e+a.length)}insertBefore(e,r){const{head:n}=this.children;super.insertBefore(e,r),n instanceof Zu&&n.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+B$),this.cache.length}moveChildren(e,r){super.moveChildren(e,r),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(e===0||e>=this.length()-B$)){const i=this.clone();return e===0?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}const n=super.split(e,r);return this.cache={},n}}Oo.blotName="block";Oo.tagName="P";Oo.defaultChild=Zu;Oo.allowedChildren=[Zu,ll,Cc,Wu];class Jc extends Cc{attach(){super.attach(),this.attributes=new wk(this.domNode)}delta(){return new br().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,r){const n=this.scroll.query(e,wr.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,r)}formatAt(e,r,n,i){this.format(n,i)}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n);return}const i=r.split(`
`),a=i.pop(),o=i.map(c=>{const u=this.scroll.create(Oo.blotName);return u.insertAt(0,c),u}),l=this.split(e);o.forEach(c=>{this.parent.insertBefore(c,l)}),a&&this.parent.insertBefore(this.scroll.create("text",a),l)}}Jc.scope=wr.BLOCK_BLOT;function OZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.descendants(Qo).reduce((r,n)=>n.length()===0?r:r.insert(n.value(),Xc(n,{},e)),new br).insert(`
`,Xc(t))}function Xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return t==null||("formats"in t&&typeof t.formats=="function"&&(e={...e,...t.formats()},r&&delete e["code-token"]),t.parent==null||t.parent.statics.blotName==="scroll"||t.parent.statics.scope!==t.statics.scope)?e:Xc(t.parent,e,r)}let kk=class bp extends Cc{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,r,n){super(e,r),this.selection=n,this.textNode=document.createTextNode(bp.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,r){if(this.savedLength!==0){super.format(e,r);return}let n=this,i=0;for(;n!=null&&n.statics.scope!==wr.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=bp.CONTENTS.length,n.optimize(),n.formatAt(i,bp.CONTENTS.length,e,r),this.savedLength=0)}index(e,r){return e===this.textNode?0:super.index(e,r)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const r=this.prev instanceof Wu?this.prev:null,n=r?r.length():0,i=this.next instanceof Wu?this.next:null,a=i?i.text:"",{textNode:o}=this,l=o.data.split(bp.CONTENTS).join("");o.data=bp.CONTENTS;let c;if(r)c=r,(l||i)&&(r.insertAt(r.length(),l+a),i&&i.remove());else if(i)c=i,i.insertAt(0,l);else{const u=document.createTextNode(l);c=this.scroll.create(u),this.parent.insertBefore(c,this)}if(this.remove(),e){const u=(m,g)=>r&&m===r.domNode?g:m===o?n+g-1:i&&m===i.domNode?n+l.length+g:null,h=u(e.start.node,e.start.offset),p=u(e.end.node,e.end.offset);if(h!==null&&p!==null)return{startNode:c.domNode,startOffset:h,endNode:c.domNode,endOffset:p}}return null}update(e,r){if(e.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(r.range=n)}}optimize(e){super.optimize(e);let{parent:r}=this;for(;r;){if(r.domNode.tagName==="A"){this.savedLength=bp.CONTENTS.length,r.isolate(this.offset(r),this.length()).unwrap(),this.savedLength=0;break}r=r.parent}}value(){return""}};var oC={exports:{}},$$;function HCe(){return $$||($$=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,h){this.fn=c,this.context=u,this.once=h||!1}function a(c,u,h,p,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new i(h,p||c,m),b=r?r+u:u;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],g]:c._events[b].push(g):(c._events[b]=g,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,p;if(this._eventsCount===0)return u;for(p in h=this._events)e.call(h,p)&&u.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=r?r+u:u,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,g=p.length,b=new Array(g);m<g;m++)b[m]=p[m].fn;return b},l.prototype.listenerCount=function(u){var h=r?r+u:u,p=this._events[h];return p?p.fn?1:p.length:0},l.prototype.emit=function(u,h,p,m,g,b){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],j=arguments.length,_,E;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),j){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,p),!0;case 4:return w.fn.call(w.context,h,p,m),!0;case 5:return w.fn.call(w.context,h,p,m,g),!0;case 6:return w.fn.call(w.context,h,p,m,g,b),!0}for(E=1,_=new Array(j-1);E<j;E++)_[E-1]=arguments[E];w.fn.apply(w.context,_)}else{var I=w.length,O;for(E=0;E<I;E++)switch(w[E].once&&this.removeListener(u,w[E].fn,void 0,!0),j){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,h);break;case 3:w[E].fn.call(w[E].context,h,p);break;case 4:w[E].fn.call(w[E].context,h,p,m);break;default:if(!_)for(O=1,_=new Array(j-1);O<j;O++)_[O-1]=arguments[O];w[E].fn.apply(w[E].context,_)}}return!0},l.prototype.on=function(u,h,p){return a(this,u,h,p,!1)},l.prototype.once=function(u,h,p){return a(this,u,h,p,!0)},l.prototype.removeListener=function(u,h,p,m){var g=r?r+u:u;if(!this._events[g])return this;if(!h)return o(this,g),this;var b=this._events[g];if(b.fn)b.fn===h&&(!m||b.once)&&(!p||b.context===p)&&o(this,g);else{for(var v=0,w=[],j=b.length;v<j;v++)(b[v].fn!==h||m&&!b[v].once||p&&b[v].context!==p)&&w.push(b[v]);w.length?this._events[g]=w.length===1?w[0]:w:o(this,g)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=r?r+u:u,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(oC)),oC.exports}var WCe=HCe();const RZ=bl(WCe),sT=new WeakMap,iT=["error","warn","log","info"];let aT="warn";function MZ(t){if(aT&&iT.indexOf(t)<=iT.indexOf(aT)){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];console[t](...r)}}function ff(t){return iT.reduce((e,r)=>(e[r]=MZ.bind(console,r,t),e),{})}ff.level=t=>{aT=t};MZ.level=ff.level;const lC=ff("quill:events"),GCe=["selectionchange","mousedown","mouseup","click"];GCe.forEach(t=>{document.addEventListener(t,function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(i=>{const a=sT.get(i);a&&a.emitter&&a.emitter.handleDOM(...r)})})});class gr extends RZ{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",lC.error)}emit(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lC.log.call(lC,...r),super.emit(...r)}handleDOM(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(this.domListeners[e.type]||[]).forEach(a=>{let{node:o,handler:l}=a;(e.target===o||o.contains(e.target))&&l(e,...n)})}listenDOM(e,r,n){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:r,handler:n})}}const cC=ff("quill:selection");class pm{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=r}}class KCe{constructor(e,r){this.emitter=r,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new pm(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,gr.sources.USER),1)}),this.emitter.on(gr.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(gr.events.SCROLL_UPDATE,(i,a)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const o=a.some(l=>l.type==="characterData"||l.type==="childList"||l.type==="attributes"&&l.target===this.root);this.update(o?gr.sources.SILENT:i)}catch{}})}),this.emitter.on(gr.events.SCROLL_OPTIMIZE,(n,i)=>{if(i.range){const{startNode:a,startOffset:o,endNode:l,endOffset:c}=i.range;this.setNativeRange(a,o,l,c),this.update(gr.sources.SILENT)}}),this.update(gr.sources.SILENT)}handleComposition(){this.emitter.on(gr.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(gr.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(gr.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,r){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(e,wr.BLOCK))){if(n.start.node!==this.cursor.textNode){const i=this.scroll.find(n.start.node,!1);if(i==null)return;if(i instanceof Qo){const a=i.split(n.start.offset);i.parent.insertBefore(this.cursor,a)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,r),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();e=Math.min(e,n-1),r=Math.min(e+r,n-1)-e;let i,[a,o]=this.scroll.leaf(e);if(a==null)return null;if(r>0&&o===a.length()){const[h]=this.scroll.leaf(e+1);if(h){const[p]=this.scroll.line(e),[m]=this.scroll.line(e+1);p===m&&(a=h,o=0)}}[i,o]=a.position(o,!0);const l=document.createRange();if(r>0)return l.setStart(i,o),[a,o]=this.scroll.leaf(e+r),a==null?null:([i,o]=a.position(o,!0),l.setEnd(i,o),l.getBoundingClientRect());let c="left",u;if(i instanceof Text){if(!i.data.length)return null;o<i.data.length?(l.setStart(i,o),l.setEnd(i,o+1)):(l.setStart(i,o-1),l.setEnd(i,o),c="right"),u=l.getBoundingClientRect()}else{if(!(a.domNode instanceof Element))return null;u=a.domNode.getBoundingClientRect(),o>0&&(c="right")}return{bottom:u.top+u.height,height:u.height,left:u[c],right:u[c],top:u.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const r=e.getRangeAt(0);if(r==null)return null;const n=this.normalizeNative(r);return cC.info("getNativeRange",n),n}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const r=this.getNativeRange();return r==null?[null,null]:[this.normalizedToRange(r),r]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&uC(this.root,document.activeElement)}normalizedToRange(e){const r=[[e.start.node,e.start.offset]];e.native.collapsed||r.push([e.end.node,e.end.offset]);const n=r.map(o=>{const[l,c]=o,u=this.scroll.find(l,!0),h=u.offset(this.scroll);return c===0?h:u instanceof Qo?h+u.index(l,c):h+u.length()}),i=Math.min(Math.max(...n),this.scroll.length()-1),a=Math.min(i,...n);return new pm(a,i-a)}normalizeNative(e){if(!uC(this.root,e.startContainer)||!e.collapsed&&!uC(this.root,e.endContainer))return null;const r={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[r.start,r.end].forEach(n=>{let{node:i,offset:a}=n;for(;!(i instanceof Text)&&i.childNodes.length>0;)if(i.childNodes.length>a)i=i.childNodes[a],a=0;else if(i.childNodes.length===a)i=i.lastChild,i instanceof Text?a=i.data.length:i.childNodes.length>0?a=i.childNodes.length:a=i.childNodes.length+1;else break;n.node=i,n.offset=a}),r}rangeToNative(e){const r=this.scroll.length(),n=(i,a)=>{i=Math.min(r-1,i);const[o,l]=this.scroll.leaf(i);return o?o.position(l,a):[null,-1]};return[...n(e.index,!1),...n(e.index+e.length,!0)]}setNativeRange(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(cC.info("setNativeRange",e,r,n,i),e!=null&&(this.root.parentNode==null||e.parentNode==null||n.parentNode==null))return;const o=document.getSelection();if(o!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:l}=this.getNativeRange()||{};if(l==null||a||e!==l.startContainer||r!==l.startOffset||n!==l.endContainer||i!==l.endOffset){e instanceof Element&&e.tagName==="BR"&&(r=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),n instanceof Element&&n.tagName==="BR"&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const c=document.createRange();c.setStart(e,r),c.setEnd(n,i),o.removeAllRanges(),o.addRange(c)}}else o.removeAllRanges(),this.root.blur()}setRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gr.sources.API;if(typeof r=="string"&&(n=r,r=!1),cC.info("setRange",e),e!=null){const i=this.rangeToNative(e);this.setNativeRange(...i,r)}else this.setNativeRange(null);this.update(n)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gr.sources.USER;const r=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,this.lastRange!=null&&(this.savedRange=this.lastRange),!f0(r,this.lastRange)){if(!this.composing&&i!=null&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const a=[gr.events.SELECTION_CHANGE,wx(this.lastRange),wx(r),e];this.emitter.emit(gr.events.EDITOR_CHANGE,...a),e!==gr.sources.SILENT&&this.emitter.emit(...a)}}}function uC(t,e){try{e.parentNode}catch{return!1}return t.contains(e)}const YCe=/^[ -~]*$/;class XCe{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let r=this.scroll.length();this.scroll.batchStart();const n=F$(e),i=new br;return JCe(n.ops.slice()).reduce((o,l)=>{const c=Zc.Op.length(l);let u=l.attributes||{},h=!1,p=!1;if(l.insert!=null){if(i.retain(c),typeof l.insert=="string"){const b=l.insert;p=!b.endsWith(`
`)&&(r<=o||!!this.scroll.descendant(Jc,o)[0]),this.scroll.insertAt(o,b);const[v,w]=this.scroll.line(o);let j=C0({},Xc(v));if(v instanceof Oo){const[_]=v.descendant(Qo,w);_&&(j=C0(j,Xc(_)))}u=Zc.AttributeMap.diff(j,u)||{}}else if(typeof l.insert=="object"){const b=Object.keys(l.insert)[0];if(b==null)return o;const v=this.scroll.query(b,wr.INLINE)!=null;if(v)(r<=o||this.scroll.descendant(Jc,o)[0])&&(p=!0);else if(o>0){const[w,j]=this.scroll.descendant(Qo,o-1);w instanceof Wu?w.value()[j]!==`
`&&(h=!0):w instanceof Cc&&w.statics.scope===wr.INLINE_BLOT&&(h=!0)}if(this.scroll.insertAt(o,b,l.insert[b]),v){const[w]=this.scroll.descendant(Qo,o);if(w){const j=C0({},Xc(w));u=Zc.AttributeMap.diff(j,u)||{}}}}r+=c}else if(i.push(l),l.retain!==null&&typeof l.retain=="object"){const b=Object.keys(l.retain)[0];if(b==null)return o;this.scroll.updateEmbedAt(o,b,l.retain[b])}Object.keys(u).forEach(b=>{this.scroll.formatAt(o,c,b,u[b])});const m=h?1:0,g=p?1:0;return r+=m+g,i.retain(m),i.delete(g),o+c+m+g},0),i.reduce((o,l)=>typeof l.delete=="number"?(this.scroll.deleteAt(o,l.delete),o):o+Zc.Op.length(l),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(e,r){return this.scroll.deleteAt(e,r),this.update(new br().retain(e).delete(r))}formatLine(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(a=>{this.scroll.lines(e,Math.max(r,1)).forEach(o=>{o.format(a,n[a])})}),this.scroll.optimize();const i=new br().retain(e).retain(r,wx(n));return this.update(i)}formatText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(a=>{this.scroll.formatAt(e,r,a,n[a])});const i=new br().retain(e).retain(r,wx(n));return this.update(i)}getContents(e,r){return this.delta.slice(e,e+r)}getDelta(){return this.scroll.lines().reduce((e,r)=>e.concat(r.delta()),new br)}getFormat(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],i=[];r===0?this.scroll.path(e).forEach(l=>{const[c]=l;c instanceof Oo?n.push(c):c instanceof Qo&&i.push(c)}):(n=this.scroll.lines(e,r),i=this.scroll.descendants(Qo,e,r));const[a,o]=[n,i].map(l=>{const c=l.shift();if(c==null)return{};let u=Xc(c);for(;Object.keys(u).length>0;){const h=l.shift();if(h==null)return u;u=QCe(Xc(h),u)}return u});return{...a,...o}}getHTML(e,r){const[n,i]=this.scroll.line(e);if(n){const a=n.length();return n.length()>=i+r&&!(i===0&&r===a)?r1(n,i,r,!0):r1(this.scroll,e,r,!0)}return""}getText(e,r){return this.getContents(e,r).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(e,r){const n=F$(r),i=new br().retain(e).concat(n);return this.scroll.insertContents(e,n),this.update(i)}insertEmbed(e,r,n){return this.scroll.insertAt(e,r,n),this.update(new br().retain(e).insert({[r]:n}))}insertText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,r),Object.keys(n).forEach(i=>{this.scroll.formatAt(e,r.length,i,n[i])}),this.update(new br().retain(e).insert(r,wx(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==Oo.blotName)return!1;const r=e;return r.children.length>1?!1:r.children.head instanceof Zu}removeFormat(e,r){const n=this.getText(e,r),[i,a]=this.scroll.line(e+r);let o=0,l=new br;i!=null&&(o=i.length()-a,l=i.delta().slice(a,a+o-1).insert(`
`));const u=this.getContents(e,r+o).diff(new br().insert(n).concat(l)),h=new br().retain(e).concat(u);return this.applyDelta(h)}update(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=this.delta;if(r.length===1&&r[0].type==="characterData"&&r[0].target.data.match(YCe)&&this.scroll.find(r[0].target)){const a=this.scroll.find(r[0].target),o=Xc(a),l=a.offset(this.scroll),c=r[0].oldValue.replace(kk.CONTENTS,""),u=new br().insert(c),h=new br().insert(a.value()),p=n&&{oldRange:U$(n.oldRange,-l),newRange:U$(n.newRange,-l)};e=new br().retain(l).concat(u.diff(h,p)).reduce((g,b)=>b.insert?g.insert(b.insert,o):g.push(b),new br),this.delta=i.compose(e)}else this.delta=this.getDelta(),(!e||!f0(i.compose(e),this.delta))&&(e=i.diff(this.delta,n));return e}}function ex(t,e,r){if(t.length===0){const[g]=dC(r.pop());return e<=0?`</li></${g}>`:`</li></${g}>${ex([],e-1,r)}`}const[{child:n,offset:i,length:a,indent:o,type:l},...c]=t,[u,h]=dC(l);if(o>e)return r.push(l),o===e+1?`<${u}><li${h}>${r1(n,i,a)}${ex(c,o,r)}`:`<${u}><li>${ex(t,e+1,r)}`;const p=r[r.length-1];if(o===e&&l===p)return`</li><li${h}>${r1(n,i,a)}${ex(c,o,r)}`;const[m]=dC(r.pop());return`</li></${m}>${ex(t,e-1,r)}`}function r1(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in t&&typeof t.html=="function")return t.html(e,r);if(t instanceof Wu)return jk(t.value().slice(e,e+r)).replaceAll(" ","&nbsp;");if(t instanceof Fu){if(t.statics.blotName==="list-container"){const u=[];return t.children.forEachAt(e,r,(h,p,m)=>{const g="formats"in h&&typeof h.formats=="function"?h.formats():{};u.push({child:h,offset:p,length:m,indent:g.indent||0,type:g.list})}),ex(u,-1,[])}const i=[];if(t.children.forEachAt(e,r,(u,h,p)=>{i.push(r1(u,h,p))}),n||t.statics.blotName==="list")return i.join("");const{outerHTML:a,innerHTML:o}=t.domNode,[l,c]=a.split(`>${o}<`);return l==="<table"?`<table style="border: 1px solid #000;">${i.join("")}<${c}`:`${l}>${i.join("")}<${c}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function QCe(t,e){return Object.keys(e).reduce((r,n)=>{if(t[n]==null)return r;const i=e[n];return i===t[n]?r[n]=i:Array.isArray(i)?i.indexOf(t[n])<0?r[n]=i.concat([t[n]]):r[n]=i:r[n]=[i,t[n]],r},{})}function dC(t){const e=t==="ordered"?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function F$(t){return t.reduce((e,r)=>{if(typeof r.insert=="string"){const n=r.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(n,r.attributes)}return e.push(r)},new br)}function U$(t,e){let{index:r,length:n}=t;return new pm(r+e,n)}function JCe(t){const e=[];return t.forEach(r=>{typeof r.insert=="string"?r.insert.split(`
`).forEach((i,a)=>{a&&e.push({insert:`
`,attributes:r.attributes}),i&&e.push({insert:i,attributes:r.attributes})}):e.push(r)}),e}class Qd{static DEFAULTS={};constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=r}}const Yw="\uFEFF";class yL extends Cc{constructor(e,r){super(e,r),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(Yw),this.rightGuard=document.createTextNode(Yw),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,r){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,r)}restore(e){let r=null,n;const i=e.data.split(Yw).join("");if(e===this.leftGuard)if(this.prev instanceof Wu){const a=this.prev.length();this.prev.insertAt(a,i),r={startNode:this.prev.domNode,startOffset:a+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this),r={startNode:n,startOffset:i.length};else e===this.rightGuard&&(this.next instanceof Wu?(this.next.insertAt(0,i),r={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this.next),r={startNode:n,startOffset:i.length}));return e.data=Yw,r}update(e,r){e.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const i=this.restore(n.target);i&&(r.range=i)}})}}class ZCe{isComposing=!1;constructor(e,r){this.scroll=e,this.emitter=r,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const r=e.target instanceof Node?this.scroll.find(e.target,!0):null;r&&!(r instanceof yL)&&(this.emitter.emit(gr.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(gr.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(gr.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(gr.events.COMPOSITION_END,e),this.isComposing=!1}}class vb{static DEFAULTS={modules:{}};static themes={default:vb};modules={};constructor(e,r){this.quill=e,this.options=r}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const r=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new r(this.quill,this.options.modules[e]||{}),this.modules[e]}}const eEe=t=>t.parentElement||t.getRootNode().host||null,tEe=t=>{const e=t.getBoundingClientRect(),r="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,n="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*r,bottom:e.top+t.clientHeight*n,left:e.left}},Xw=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},z$=(t,e,r,n,i,a)=>t<r&&e>n?0:t<r?-(r-t+i):e>n?e-t>n-r?t+i-r:e-n+a:0,rEe=(t,e)=>{const r=t.ownerDocument;let n=e,i=t;for(;i;){const a=i===r.body,o=a?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:tEe(i),l=getComputedStyle(i),c=z$(n.left,n.right,o.left,o.right,Xw(l.scrollPaddingLeft),Xw(l.scrollPaddingRight)),u=z$(n.top,n.bottom,o.top,o.bottom,Xw(l.scrollPaddingTop),Xw(l.scrollPaddingBottom));if(c||u)if(a)r.defaultView?.scrollBy(c,u);else{const{scrollLeft:h,scrollTop:p}=i;u&&(i.scrollTop+=u),c&&(i.scrollLeft+=c);const m=i.scrollLeft-h,g=i.scrollTop-p;n={left:n.left-m,top:n.top-g,right:n.right-m,bottom:n.bottom-g}}i=a||l.position==="fixed"?null:eEe(i)}},nEe=100,sEe=["block","break","cursor","inline","scroll","text"],iEe=(t,e,r)=>{const n=new Yx;return sEe.forEach(i=>{const a=e.query(i);a&&n.register(a)}),t.forEach(i=>{let a=e.query(i);a||r.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;a;)if(n.register(a),a="blotName"in a?a.requiredContainer??null:null,o+=1,o>nEe){r.error(`Cycle detected in registering blot requiredContainer: "${i}"`);break}}),n},jx=ff("quill"),Qw=new Yx;Fu.uiClass="ql-ui";class _t{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:Qw,theme:"default"};static events=gr.events;static sources=gr.sources;static version="2.0.3";static imports={delta:br,parchment:$Ce,"core/module":Qd,"core/theme":vb};static debug(e){e===!0&&(e="log"),ff.level(e)}static find(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return sT.get(e)||Qw.find(e,r)}static import(e){return this.imports[e]==null&&jx.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],r=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in e?e.attrName:e.blotName;typeof n=="string"?this.register(`formats/${n}`,e,r):Object.keys(e).forEach(i=>{this.register(i,e[i],r)})}else{const e=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!n&&jx.warn(`Overwriting ${e} with`,r),this.imports[e]=r,(e.startsWith("blots/")||e.startsWith("formats/"))&&r&&typeof r!="boolean"&&r.blotName!=="abstract"&&Qw.register(r),typeof r.register=="function"&&r.register(Qw)}}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=aEe(e,r),this.container=this.options.container,this.container==null){jx.error("Invalid Quill container",e);return}this.options.debug&&_t.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",sT.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new gr;const i=bL.blotName,a=this.options.registry.query(i);if(!a||!("blotName"in a))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new a(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new XCe(this.scroll),this.selection=new KCe(this.scroll,this.emitter),this.composition=new ZCe(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(gr.events.EDITOR_CHANGE,o=>{o===gr.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(gr.events.SCROLL_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),h=c&&u?{oldRange:c,newRange:u}:void 0;ku.call(this,()=>this.editor.update(null,l,h),o)}),this.emitter.on(gr.events.SCROLL_EMBED_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),h=c&&u?{oldRange:c,newRange:u}:void 0;ku.call(this,()=>{const p=new br().retain(o.offset(this)).retain({[o.statics.blotName]:l});return this.editor.update(p,[],h)},_t.sources.USER)}),n){const o=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const n=e;e=document.createElement("div"),e.classList.add(n)}return this.container.insertBefore(e,r),e}blur(){this.selection.setRange(null)}deleteText(e,r,n){return[e,r,,n]=vh(e,r,n),ku.call(this,()=>this.editor.deleteText(e,r),n,e,-1*r)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const r=e();return this.allowReadOnlyEdits=!1,r}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gr.sources.API;return ku.call(this,()=>{const i=this.getSelection(!0);let a=new br;if(i==null)return a;if(this.scroll.query(e,wr.BLOCK))a=this.editor.formatLine(i.index,i.length,{[e]:r});else{if(i.length===0)return this.selection.format(e,r),a;a=this.editor.formatText(i.index,i.length,{[e]:r})}return this.setSelection(i,gr.sources.SILENT),a},n)}formatLine(e,r,n,i,a){let o;return[e,r,o,a]=vh(e,r,n,i,a),ku.call(this,()=>this.editor.formatLine(e,r,o),a,e,0)}formatText(e,r,n,i,a){let o;return[e,r,o,a]=vh(e,r,n,i,a),ku.call(this,()=>this.editor.formatText(e,r,o),a,e,0)}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof e=="number"?n=this.selection.getBounds(e,r):n=this.selection.getBounds(e.index,e.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,r]=vh(e,r),this.editor.getContents(e,r)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,r):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,r)}getModule(e){return this.theme.modules[e]}getSelection(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=vh(e,r),this.editor.getHTML(e,r)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=vh(e,r),this.editor.getText(e,r)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:_t.sources.API;return ku.call(this,()=>this.editor.insertEmbed(e,r,n),i,e)}insertText(e,r,n,i,a){let o;return[e,,o,a]=vh(e,0,n,i,a),ku.call(this,()=>this.editor.insertText(e,r,o),a,e,r.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,r,n){return[e,r,,n]=vh(e,r,n),ku.call(this,()=>this.editor.removeFormat(e,r),n,e)}scrollRectIntoView(e){rEe(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,r=e&&this.selection.getBounds(e.index,e.length);r&&this.scrollRectIntoView(r)}setContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gr.sources.API;return ku.call(this,()=>{e=new br(e);const n=this.getLength(),i=this.editor.deleteText(0,n),a=this.editor.insertContents(0,e),o=this.editor.deleteText(this.getLength()-1,1);return i.compose(a).compose(o)},r)}setSelection(e,r,n){e==null?this.selection.setRange(null,r||_t.sources.API):([e,r,,n]=vh(e,r,n),this.selection.setRange(new pm(Math.max(0,e),r),n),n!==gr.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gr.sources.API;const n=new br().insert(e);return this.setContents(n,r)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gr.sources.USER;const r=this.scroll.update(e);return this.selection.update(e),r}updateContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gr.sources.API;return ku.call(this,()=>(e=new br(e),this.editor.applyDelta(e)),r,!0)}}function q$(t){return typeof t=="string"?document.querySelector(t):t}function hC(t){return Object.entries(t??{}).reduce((e,r)=>{let[n,i]=r;return{...e,[n]:i===!0?{}:i}},{})}function V$(t){return Object.fromEntries(Object.entries(t).filter(e=>e[1]!==void 0))}function aEe(t,e){const r=q$(t);if(!r)throw new Error("Invalid Quill container");const i=!e.theme||e.theme===_t.DEFAULTS.theme?vb:_t.import(`themes/${e.theme}`);if(!i)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:a,...o}=_t.DEFAULTS,{modules:l,...c}=i.DEFAULTS;let u=hC(e.modules);u!=null&&u.toolbar&&u.toolbar.constructor!==Object&&(u={...u,toolbar:{container:u.toolbar}});const h=C0({},hC(a),hC(l),u),p={...o,...V$(c),...V$(e)};let m=e.registry;return m?e.formats&&jx.warn('Ignoring "formats" option because "registry" is specified'):m=e.formats?iEe(e.formats,p.registry,jx):p.registry,{...p,registry:m,container:r,theme:i,modules:Object.entries(h).reduce((g,b)=>{let[v,w]=b;if(!w)return g;const j=_t.import(`modules/${v}`);return j==null?(jx.error(`Cannot load ${v} module. Are you sure you registered it?`),g):{...g,[v]:C0({},j.DEFAULTS||{},w)}},{}),bounds:q$(p.bounds)}}function ku(t,e,r,n){if(!this.isEnabled()&&e===gr.sources.USER&&!this.allowReadOnlyEdits)return new br;let i=r==null?null:this.getSelection();const a=this.editor.delta,o=t();if(i!=null&&(r===!0&&(r=i.index),n==null?i=H$(i,o,e):n!==0&&(i=H$(i,r,n,e)),this.setSelection(i,gr.sources.SILENT)),o.length()>0){const l=[gr.events.TEXT_CHANGE,o,a,e];this.emitter.emit(gr.events.EDITOR_CHANGE,...l),e!==gr.sources.SILENT&&this.emitter.emit(...l)}return o}function vh(t,e,r,n,i){let a={};return typeof t.index=="number"&&typeof t.length=="number"?typeof e!="number"?(i=n,n=r,r=e,e=t.length,t=t.index):(e=t.length,t=t.index):typeof e!="number"&&(i=n,n=r,r=e,e=0),typeof r=="object"?(a=r,i=n):typeof r=="string"&&(n!=null?a[r]=n:i=r),i=i||gr.sources.API,[t,e,a,i]}function H$(t,e,r,n){const i=typeof r=="number"?r:0;if(t==null)return null;let a,o;return e&&typeof e.transformPosition=="function"?[a,o]=[t.index,t.index+t.length].map(l=>e.transformPosition(l,n!==gr.sources.USER)):[a,o]=[t.index,t.index+t.length].map(l=>l<e||l===e&&n===gr.sources.USER?l:i>=0?l+i:Math.max(e,l+i)),new pm(a,o-a)}class $m extends Nk{}function W$(t){return t instanceof Oo||t instanceof Jc}function G$(t){return typeof t.updateContent=="function"}class oEe extends bL{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Oo;static allowedChildren=[Oo,Jc,$m];constructor(e,r,n){let{emitter:i}=n;super(e,r),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",a=>this.handleDragStart(a))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(gr.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(gr.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,r){this.emitter.emit(gr.events.SCROLL_EMBED_UPDATE,e,r)}deleteAt(e,r){const[n,i]=this.line(e),[a]=this.line(e+r);if(super.deleteAt(e,r),a!=null&&n!==a&&i>0){if(n instanceof Jc||a instanceof Jc){this.optimize();return}const o=a.children.head instanceof Zu?null:a.children.head;n.moveChildren(a,o),n.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.optimize()}insertAt(e,r,n){if(e>=this.length())if(n==null||this.scroll.query(r,wr.BLOCK)==null){const i=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(i),n==null&&r.endsWith(`
`)?i.insertAt(0,r.slice(0,-1),n):i.insertAt(0,r,n)}else{const i=this.scroll.create(r,n);this.appendChild(i)}else super.insertAt(e,r,n);this.optimize()}insertBefore(e,r){if(e.statics.scope===wr.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(e),super.insertBefore(n,r)}else super.insertBefore(e,r)}insertContents(e,r){const n=this.deltaToRenderBlocks(r.concat(new br().insert(`
`))),i=n.pop();if(i==null)return;this.batchStart();const a=n.shift();if(a){const c=a.type==="block"&&(a.delta.length()===0||!this.descendant(Jc,e)[0]&&e<this.length()),u=a.type==="block"?a.delta:new br().insert({[a.key]:a.value});fC(this,e,u);const h=a.type==="block"?1:0,p=e+u.length()+h;c&&this.insertAt(p-1,`
`);const m=Xc(this.line(e)[0]),g=Zc.AttributeMap.diff(m,a.attributes)||{};Object.keys(g).forEach(b=>{this.formatAt(p-1,1,b,g[b])}),e=p}let[o,l]=this.children.find(e);if(n.length&&(o&&(o=o.split(l),l=0),n.forEach(c=>{if(c.type==="block"){const u=this.createBlock(c.attributes,o||void 0);fC(u,0,c.delta)}else{const u=this.create(c.key,c.value);this.insertBefore(u,o||void 0),Object.keys(c.attributes).forEach(h=>{u.format(h,c.attributes[h])})}})),i.type==="block"&&i.delta.length()){const c=o?o.offset(o.scroll)+l:this.length();fC(this,c,i.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const r=this.path(e).pop();if(!r)return[null,-1];const[n,i]=r;return n instanceof Qo?[n,i]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(W$,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(i,a,o)=>{let l=[],c=o;return i.children.forEachAt(a,o,(u,h,p)=>{W$(u)?l.push(u):u instanceof Nk&&(l=l.concat(n(u,h,c))),c-=p}),l};return n(this,e,r)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,r),e.length>0&&this.emitter.emit(gr.events.SCROLL_OPTIMIZE,e,r))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let r=gr.sources.USER;typeof e=="string"&&(r=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(n=>{let{target:i}=n;const a=this.find(i,!0);return a&&!G$(a)}),e.length>0&&this.emitter.emit(gr.events.SCROLL_BEFORE_UPDATE,r,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(gr.events.SCROLL_UPDATE,r,e)}updateEmbedAt(e,r,n){const[i]=this.descendant(a=>a instanceof Jc,e);i&&i.statics.blotName===r&&G$(i)&&i.updateContent(n)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const r=[];let n=new br;return e.forEach(i=>{const a=i?.insert;if(a)if(typeof a=="string"){const o=a.split(`
`);o.slice(0,-1).forEach(c=>{n.insert(c,i.attributes),r.push({type:"block",delta:n,attributes:i.attributes??{}}),n=new br});const l=o[o.length-1];l&&n.insert(l,i.attributes)}else{const o=Object.keys(a)[0];if(!o)return;this.query(o,wr.INLINE)?n.push(i):(n.length()&&r.push({type:"block",delta:n,attributes:{}}),n=new br,r.push({type:"blockEmbed",key:o,value:a[o],attributes:i.attributes??{}}))}}),n.length()&&r.push({type:"block",delta:n,attributes:{}}),r}createBlock(e,r){let n;const i={};Object.entries(e).forEach(l=>{let[c,u]=l;this.query(c,wr.BLOCK&wr.BLOT)!=null?n=c:i[c]=u});const a=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(a,r||void 0);const o=a.length();return Object.entries(i).forEach(l=>{let[c,u]=l;a.formatAt(0,o,c,u)}),a}}function fC(t,e,r){r.reduce((n,i)=>{const a=Zc.Op.length(i);let o=i.attributes||{};if(i.insert!=null){if(typeof i.insert=="string"){const l=i.insert;t.insertAt(n,l);const[c]=t.descendant(Qo,n),u=Xc(c);o=Zc.AttributeMap.diff(u,o)||{}}else if(typeof i.insert=="object"){const l=Object.keys(i.insert)[0];if(l==null)return n;if(t.insertAt(n,l,i.insert[l]),t.scroll.query(l,wr.INLINE)!=null){const[u]=t.descendant(Qo,n),h=Xc(u);o=Zc.AttributeMap.diff(h,o)||{}}}}return Object.keys(o).forEach(l=>{t.formatAt(n,a,l,o[l])}),n+a},e)}const vL={scope:wr.BLOCK,whitelist:["right","center","justify"]},lEe=new zd("align","align",vL),DZ=new Ju("align","ql-align",vL),BZ=new V0("align","text-align",vL);class $Z extends V0{value(e){let r=super.value(e);return r.startsWith("rgb(")?(r=r.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${r.split(",").map(i=>`00${parseInt(i,10).toString(16)}`.slice(-2)).join("")}`):r}}const cEe=new Ju("color","ql-color",{scope:wr.INLINE}),wL=new $Z("color","color",{scope:wr.INLINE}),uEe=new Ju("background","ql-bg",{scope:wr.INLINE}),NL=new $Z("background","background-color",{scope:wr.INLINE});class Fm extends $m{static create(e){const r=super.create(e);return r.setAttribute("spellcheck","false"),r}code(e,r){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(e,e+r)}html(e,r){return`<pre>
${jk(this.code(e,r))}
</pre>`}}class ml extends Oo{static TAB="  ";static register(){_t.register(Fm)}}class jL extends ll{}jL.blotName="code";jL.tagName="CODE";ml.blotName="code-block";ml.className="ql-code-block";ml.tagName="DIV";Fm.blotName="code-block-container";Fm.className="ql-code-block-container";Fm.tagName="DIV";Fm.allowedChildren=[ml];ml.allowedChildren=[Wu,Zu,kk];ml.requiredContainer=Fm;const kL={scope:wr.BLOCK,whitelist:["rtl"]},FZ=new zd("direction","dir",kL),UZ=new Ju("direction","ql-direction",kL),zZ=new V0("direction","direction",kL),qZ={scope:wr.INLINE,whitelist:["serif","monospace"]},VZ=new Ju("font","ql-font",qZ);class dEe extends V0{value(e){return super.value(e).replace(/["']/g,"")}}const HZ=new dEe("font","font-family",qZ),WZ=new Ju("size","ql-size",{scope:wr.INLINE,whitelist:["small","large","huge"]}),GZ=new V0("size","font-size",{scope:wr.INLINE,whitelist:["10px","18px","32px"]}),hEe=ff("quill:keyboard"),fEe=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class _k extends Qd{static match(e,r){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!r[n]!==e[n]&&r[n]!==null)?!1:r.key===e.key||r.key===e.which}constructor(e,r){super(e,r),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=mEe(e);if(i==null){hEe.warn("Attempted to add invalid keyboard binding",i);return}typeof r=="function"&&(r={handler:r}),typeof n=="function"&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach(o=>{const l={...i,key:o,...r,...n};this.bindings[l.key]=this.bindings[l.key]||[],this.bindings[l.key].push(l)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const i=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(j=>_k.match(e,j));if(i.length===0)return;const a=_t.find(e.target,!0);if(a&&a.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[l,c]=this.quill.getLine(o.index),[u,h]=this.quill.getLeaf(o.index),[p,m]=o.length===0?[u,h]:this.quill.getLeaf(o.index+o.length),g=u instanceof xj?u.value().slice(0,h):"",b=p instanceof xj?p.value().slice(m):"",v={collapsed:o.length===0,empty:o.length===0&&l.length()<=1,format:this.quill.getFormat(o),line:l,offset:c,prefix:g,suffix:b,event:e};i.some(j=>{if(j.collapsed!=null&&j.collapsed!==v.collapsed||j.empty!=null&&j.empty!==v.empty||j.offset!=null&&j.offset!==v.offset)return!1;if(Array.isArray(j.format)){if(j.format.every(_=>v.format[_]==null))return!1}else if(typeof j.format=="object"&&!Object.keys(j.format).every(_=>j.format[_]===!0?v.format[_]!=null:j.format[_]===!1?v.format[_]==null:f0(j.format[_],v.format[_])))return!1;return j.prefix!=null&&!j.prefix.test(v.prefix)||j.suffix!=null&&!j.suffix.test(v.suffix)?!1:j.handler.call(this,o,v,j)!==!0})&&e.preventDefault()})}handleBackspace(e,r){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(r.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let i={};const[a]=this.quill.getLine(e.index);let o=new br().retain(e.index-n).delete(n);if(r.offset===0){const[l]=this.quill.getLine(e.index-1);if(l&&!(l.statics.blotName==="block"&&l.length()<=1)){const u=a.formats(),h=this.quill.getFormat(e.index-1,1);if(i=Zc.AttributeMap.diff(u,h)||{},Object.keys(i).length>0){const p=new br().retain(e.index+a.length()-2).retain(1,i);o=o.compose(p)}}}this.quill.updateContents(o,_t.sources.USER),this.quill.focus()}handleDelete(e,r){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(r.suffix)?2:1;if(e.index>=this.quill.getLength()-n)return;let i={};const[a]=this.quill.getLine(e.index);let o=new br().retain(e.index).delete(n);if(r.offset>=a.length()-1){const[l]=this.quill.getLine(e.index+1);if(l){const c=a.formats(),u=this.quill.getFormat(e.index,1);i=Zc.AttributeMap.diff(c,u)||{},Object.keys(i).length>0&&(o=o.retain(l.length()-1).retain(1,i))}}this.quill.updateContents(o,_t.sources.USER),this.quill.focus()}handleDeleteRange(e){_L({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,r){const n=Object.keys(r.format).reduce((a,o)=>(this.quill.scroll.query(o,wr.BLOCK)&&!Array.isArray(r.format[o])&&(a[o]=r.format[o]),a),{}),i=new br().retain(e.index).delete(e.length).insert(`
`,n);this.quill.updateContents(i,_t.sources.USER),this.quill.setSelection(e.index+1,_t.sources.SILENT),this.quill.focus()}}const pEe={bindings:{bold:pC("bold"),italic:pC("italic"),underline:pC("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",_t.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",_t.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){e.format.indent!=null?this.quill.format("indent","-1",_t.sources.USER):e.format.list!=null&&this.quill.format("list",!1,_t.sources.USER)}},"indent code-block":K$(!0),"outdent code-block":K$(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,_t.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const r=new br().retain(t.index).delete(t.length).insert("	");return this.quill.updateContents(r,_t.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,_t.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,_t.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const r={list:!1};e.format.indent&&(r.indent=!1),this.quill.formatLine(t.index,t.length,r,_t.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,r]=this.quill.getLine(t.index),n={...e.formats(),list:"checked"},i=new br().retain(t.index).insert(`
`,n).retain(e.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,_t.sources.USER),this.quill.setSelection(t.index+1,_t.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[r,n]=this.quill.getLine(t.index),i=new br().retain(t.index).insert(`
`,e.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,_t.sources.USER),this.quill.setSelection(t.index+1,_t.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[r,n,i,a]=e.getTable(t),o=gEe(r,n,i,a);if(o==null)return;let l=r.offset();if(o<0){const c=new br().retain(l).insert(`
`);this.quill.updateContents(c,_t.sources.USER),this.quill.setSelection(t.index+1,t.length,_t.sources.SILENT)}else if(o>0){l+=r.length();const c=new br().retain(l).insert(`
`);this.quill.updateContents(c,_t.sources.USER),this.quill.setSelection(l,_t.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:r,line:n}=e,i=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(i-1,_t.sources.USER):this.quill.setSelection(i+n.length(),_t.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query("list")==null)return!0;const{length:r}=e.prefix,[n,i]=this.quill.getLine(t.index);if(i>r)return!0;let a;switch(e.prefix.trim()){case"[]":case"[ ]":a="unchecked";break;case"[x]":a="checked";break;case"-":case"*":a="bullet";break;default:a="ordered"}this.quill.insertText(t.index," ",_t.sources.USER),this.quill.history.cutoff();const o=new br().retain(t.index-i).delete(r+1).retain(n.length()-2-i).retain(1,{list:a});return this.quill.updateContents(o,_t.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-r,_t.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,r]=this.quill.getLine(t.index);let n=2,i=e;for(;i!=null&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const a=new br().retain(t.index+e.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(a,_t.sources.USER),this.quill.setSelection(t.index-1,_t.sources.SILENT),!1}return!0}},"embed left":Jw("ArrowLeft",!1),"embed left shift":Jw("ArrowLeft",!0),"embed right":Jw("ArrowRight",!1),"embed right shift":Jw("ArrowRight",!0),"table down":Y$(!1),"table up":Y$(!0)}};_k.DEFAULTS=pEe;function K$(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,r){let{event:n}=r;const i=this.quill.scroll.query("code-block"),{TAB:a}=i;if(e.length===0&&!n.shiftKey){this.quill.insertText(e.index,a,_t.sources.USER),this.quill.setSelection(e.index+a.length,_t.sources.SILENT);return}const o=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:l,length:c}=e;o.forEach((u,h)=>{t?(u.insertAt(0,a),h===0?l+=a.length:c+=a.length):u.domNode.textContent.startsWith(a)&&(u.deleteAt(0,a.length),h===0?l-=a.length:c-=a.length)}),this.quill.update(_t.sources.USER),this.quill.setSelection(l,c,_t.sources.SILENT)}}}function Jw(t,e){return{key:t,shiftKey:e,altKey:null,[t==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;t==="ArrowRight"&&(i+=n.length+1);const[a]=this.quill.getLeaf(i);return a instanceof Cc?(t==="ArrowLeft"?e?this.quill.setSelection(n.index-1,n.length+1,_t.sources.USER):this.quill.setSelection(n.index-1,_t.sources.USER):e?this.quill.setSelection(n.index,n.length+1,_t.sources.USER):this.quill.setSelection(n.index+n.length+1,_t.sources.USER),!1):!0}}}function pC(t){return{key:t[0],shortKey:!0,handler(e,r){this.quill.format(t,!r.format[t],_t.sources.USER)}}}function Y$(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,r){const n=t?"prev":"next",i=r.line,a=i.parent[n];if(a!=null){if(a.statics.blotName==="table-row"){let o=a.children.head,l=i;for(;l.prev!=null;)l=l.prev,o=o.next;const c=o.offset(this.quill.scroll)+Math.min(r.offset,o.length()-1);this.quill.setSelection(c,0,_t.sources.USER)}}else{const o=i.table()[n];o!=null&&(t?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,_t.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,_t.sources.USER))}return!1}}}function mEe(t){if(typeof t=="string"||typeof t=="number")t={key:t};else if(typeof t=="object")t=wx(t);else return null;return t.shortKey&&(t[fEe]=t.shortKey,delete t.shortKey),t}function _L(t){let{quill:e,range:r}=t;const n=e.getLines(r);let i={};if(n.length>1){const a=n[0].formats(),o=n[n.length-1].formats();i=Zc.AttributeMap.diff(o,a)||{}}e.deleteText(r,_t.sources.USER),Object.keys(i).length>0&&e.formatLine(r.index,1,i,_t.sources.USER),e.setSelection(r.index,_t.sources.SILENT)}function gEe(t,e,r,n){return e.prev==null&&e.next==null?r.prev==null&&r.next==null?n===0?-1:1:r.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const xEe=/font-weight:\s*normal/,bEe=["P","OL","UL"],X$=t=>t&&bEe.includes(t.tagName),yEe=t=>{Array.from(t.querySelectorAll("br")).filter(e=>X$(e.previousElementSibling)&&X$(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},vEe=t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(xEe)).forEach(e=>{const r=t.createDocumentFragment();r.append(...e.childNodes),e.parentNode?.replaceChild(r,e)})};function wEe(t){t.querySelector('[id^="docs-internal-guid-"]')&&(vEe(t),yEe(t))}const NEe=/\bmso-list:[^;]*ignore/i,jEe=/\bmso-list:[^;]*\bl(\d+)/i,kEe=/\bmso-list:[^;]*\blevel(\d+)/i,_Ee=(t,e)=>{const r=t.getAttribute("style"),n=r?.match(jEe);if(!n)return null;const i=Number(n[1]),a=r?.match(kEe),o=a?Number(a[1]):1,l=new RegExp(`@list l${i}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),c=e.match(l),u=c&&c[1]==="bullet"?"bullet":"ordered";return{id:i,indent:o,type:u,element:t}},SEe=t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),r=[],n=[];e.forEach(o=>{(o.getAttribute("style")||"").match(NEe)?r.push(o):n.push(o)}),r.forEach(o=>o.parentNode?.removeChild(o));const i=t.documentElement.innerHTML,a=n.map(o=>_Ee(o,i)).filter(o=>o);for(;a.length;){const o=[];let l=a.shift();for(;l;)o.push(l),l=a.length&&a[0]?.element===l.element.nextElementSibling&&a[0].id===l.id?a.shift():null;const c=document.createElement("ul");o.forEach(p=>{const m=document.createElement("li");m.setAttribute("data-list",p.type),p.indent>1&&m.setAttribute("class",`ql-indent-${p.indent-1}`),m.innerHTML=p.element.innerHTML,c.appendChild(m)});const u=o[0]?.element,{parentNode:h}=u??{};u&&h?.replaceChild(c,u),o.slice(1).forEach(p=>{let{element:m}=p;h?.removeChild(m)})}};function CEe(t){t.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&SEe(t)}const EEe=[CEe,wEe],AEe=t=>{t.documentElement&&EEe.forEach(e=>{e(t)})},TEe=ff("quill:clipboard"),IEe=[[Node.TEXT_NODE,VEe],[Node.TEXT_NODE,J$],["br",DEe],[Node.ELEMENT_NODE,J$],[Node.ELEMENT_NODE,MEe],[Node.ELEMENT_NODE,REe],[Node.ELEMENT_NODE,zEe],["li",FEe],["ol, ul",UEe],["pre",BEe],["tr",qEe],["b",mC("bold")],["i",mC("italic")],["strike",mC("strike")],["style",$Ee]],LEe=[lEe,FZ].reduce((t,e)=>(t[e.keyName]=e,t),{}),Q$=[BZ,NL,wL,zZ,HZ,GZ].reduce((t,e)=>(t[e.keyName]=e,t),{});class PEe extends Qd{static DEFAULTS={matchers:[]};constructor(e,r){super(e,r),this.quill.root.addEventListener("copy",n=>this.onCaptureCopy(n,!1)),this.quill.root.addEventListener("cut",n=>this.onCaptureCopy(n,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],IEe.concat(this.options.matchers??[]).forEach(n=>{let[i,a]=n;this.addMatcher(i,a)})}addMatcher(e,r){this.matchers.push([e,r])}convert(e){let{html:r,text:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i[ml.blotName])return new br().insert(n||"",{[ml.blotName]:i[ml.blotName]});if(!r)return new br().insert(n||"",i);const a=this.convertHTML(r);return J1(a,`
`)&&(a.ops[a.ops.length-1].attributes==null||i.table)?a.compose(new br().retain(a.length()-1).delete(1)):a}normalizeHTML(e){AEe(e)}convertHTML(e){const r=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(r);const n=r.body,i=new WeakMap,[a,o]=this.prepareMatching(n,i);return SL(this.quill.scroll,n,a,o,i)}dangerouslyPasteHTML(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_t.sources.API;if(typeof e=="string"){const i=this.convert({html:e,text:""});this.quill.setContents(i,r),this.quill.setSelection(0,_t.sources.SILENT)}else{const i=this.convert({html:r,text:""});this.quill.updateContents(new br().retain(e).concat(i),n),this.quill.setSelection(e+i.length(),_t.sources.SILENT)}}onCaptureCopy(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:i,text:a}=this.onCopy(n,r);e.clipboardData?.setData("text/plain",a),e.clipboardData?.setData("text/html",i),r&&_L({range:n,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(r=>r[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const r=this.quill.getSelection(!0);if(r==null)return;const n=e.clipboardData?.getData("text/html");let i=e.clipboardData?.getData("text/plain");if(!n&&!i){const o=e.clipboardData?.getData("text/uri-list");o&&(i=this.normalizeURIList(o))}const a=Array.from(e.clipboardData?.files||[]);if(!n&&a.length>0){this.quill.uploader.upload(r,a);return}if(n&&a.length>0){const o=new DOMParser().parseFromString(n,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(r,a);return}}this.onPaste(r,{html:n,text:i})}onCopy(e){const r=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:r}}onPaste(e,r){let{text:n,html:i}=r;const a=this.quill.getFormat(e.index),o=this.convert({text:n,html:i},a);TEe.log("onPaste",o,{text:n,html:i});const l=new br().retain(e.index).delete(e.length).concat(o);this.quill.updateContents(l,_t.sources.USER),this.quill.setSelection(l.length()-e.length,_t.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,r){const n=[],i=[];return this.matchers.forEach(a=>{const[o,l]=a;switch(o){case Node.TEXT_NODE:i.push(l);break;case Node.ELEMENT_NODE:n.push(l);break;default:Array.from(e.querySelectorAll(o)).forEach(c=>{r.has(c)?r.get(c)?.push(l):r.set(c,[l])});break}}),[n,i]}}function Um(t,e,r,n){return n.query(e)?t.reduce((i,a)=>{if(!a.insert)return i;if(a.attributes&&a.attributes[e])return i.push(a);const o=r?{[e]:r}:{};return i.insert(a.insert,{...o,...a.attributes})},new br):t}function J1(t,e){let r="";for(let n=t.ops.length-1;n>=0&&r.length<e.length;--n){const i=t.ops[n];if(typeof i.insert!="string")break;r=i.insert+r}return r.slice(-1*e.length)===e}function b0(t,e){if(!(t instanceof Element))return!1;const r=e.query(t);return r&&r.prototype instanceof Cc?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}function OEe(t,e){return t.previousElementSibling&&t.nextElementSibling&&!b0(t.previousElementSibling,e)&&!b0(t.nextElementSibling,e)}const Zw=new WeakMap;function KZ(t){return t==null?!1:(Zw.has(t)||(t.tagName==="PRE"?Zw.set(t,!0):Zw.set(t,KZ(t.parentNode))),Zw.get(t))}function SL(t,e,r,n,i){return e.nodeType===e.TEXT_NODE?n.reduce((a,o)=>o(e,a,t),new br):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((a,o)=>{let l=SL(t,o,r,n,i);return o.nodeType===e.ELEMENT_NODE&&(l=r.reduce((c,u)=>u(o,c,t),l),l=(i.get(o)||[]).reduce((c,u)=>u(o,c,t),l)),a.concat(l)},new br):new br}function mC(t){return(e,r,n)=>Um(r,t,!0,n)}function REe(t,e,r){const n=zd.keys(t),i=Ju.keys(t),a=V0.keys(t),o={};return n.concat(i).concat(a).forEach(l=>{let c=r.query(l,wr.ATTRIBUTE);c!=null&&(o[c.attrName]=c.value(t),o[c.attrName])||(c=LEe[l],c!=null&&(c.attrName===l||c.keyName===l)&&(o[c.attrName]=c.value(t)||void 0),c=Q$[l],c!=null&&(c.attrName===l||c.keyName===l)&&(c=Q$[l],o[c.attrName]=c.value(t)||void 0))}),Object.entries(o).reduce((l,c)=>{let[u,h]=c;return Um(l,u,h,r)},e)}function MEe(t,e,r){const n=r.query(t);if(n==null)return e;if(n.prototype instanceof Cc){const i={},a=n.value(t);if(a!=null)return i[n.blotName]=a,new br().insert(i,n.formats(t,r))}else if(n.prototype instanceof t1&&!J1(e,`
`)&&e.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return Um(e,n.blotName,n.formats(t,r),r);return e}function DEe(t,e){return J1(e,`
`)||e.insert(`
`),e}function BEe(t,e,r){const n=r.query("code-block"),i=n&&"formats"in n&&typeof n.formats=="function"?n.formats(t,r):!0;return Um(e,"code-block",i,r)}function $Ee(){return new br}function FEe(t,e,r){const n=r.query(t);if(n==null||n.blotName!=="list"||!J1(e,`
`))return e;let i=-1,a=t.parentNode;for(;a!=null;)["OL","UL"].includes(a.tagName)&&(i+=1),a=a.parentNode;return i<=0?e:e.reduce((o,l)=>l.insert?l.attributes&&typeof l.attributes.indent=="number"?o.push(l):o.insert(l.insert,{indent:i,...l.attributes||{}}):o,new br)}function UEe(t,e,r){const n=t;let i=n.tagName==="OL"?"ordered":"bullet";const a=n.getAttribute("data-checked");return a&&(i=a==="true"?"checked":"unchecked"),Um(e,"list",i,r)}function J$(t,e,r){if(!J1(e,`
`)){if(b0(t,r)&&(t.childNodes.length>0||t instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&t.nextSibling){let n=t.nextSibling;for(;n!=null;){if(b0(n,r))return e.insert(`
`);const i=r.query(n);if(i&&i.prototype instanceof Jc)return e.insert(`
`);n=n.firstChild}}}return e}function zEe(t,e,r){const n={},i=t.style||{};return i.fontStyle==="italic"&&(n.italic=!0),i.textDecoration==="underline"&&(n.underline=!0),i.textDecoration==="line-through"&&(n.strike=!0),(i.fontWeight?.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),e=Object.entries(n).reduce((a,o)=>{let[l,c]=o;return Um(a,l,c,r)},e),parseFloat(i.textIndent||0)>0?new br().insert("	").concat(e):e}function qEe(t,e,r){const n=t.parentElement?.tagName==="TABLE"?t.parentElement:t.parentElement?.parentElement;if(n!=null){const a=Array.from(n.querySelectorAll("tr")).indexOf(t)+1;return Um(e,"table",a,r)}return e}function VEe(t,e,r){let n=t.data;if(t.parentElement?.tagName==="O:P")return e.insert(n.trim());if(!KZ(t)){if(n.trim().length===0&&n.includes(`
`)&&!OEe(t,r))return e;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(t.previousSibling==null&&t.parentElement!=null&&b0(t.parentElement,r)||t.previousSibling instanceof Element&&b0(t.previousSibling,r))&&(n=n.replace(/^ /,"")),(t.nextSibling==null&&t.parentElement!=null&&b0(t.parentElement,r)||t.nextSibling instanceof Element&&b0(t.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll(""," ")}return e.insert(n)}class HEe extends Qd{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,r){super(e,r),this.quill.on(_t.events.EDITOR_CHANGE,(n,i,a,o)=>{n===_t.events.SELECTION_CHANGE?i&&o!==_t.sources.SILENT&&(this.currentRange=i):n===_t.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===_t.sources.USER?this.record(i,a):this.transform(i)),this.currentRange=oT(this.currentRange,i))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",n=>{n.inputType==="historyUndo"?(this.undo(),n.preventDefault()):n.inputType==="historyRedo"&&(this.redo(),n.preventDefault())})}change(e,r){if(this.stack[e].length===0)return;const n=this.stack[e].pop();if(!n)return;const i=this.quill.getContents(),a=n.delta.invert(i);this.stack[r].push({delta:a,range:oT(n.range,a)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,_t.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,r){if(e.ops.length===0)return;this.stack.redo=[];let n=e.invert(r),i=this.currentRange;const a=Date.now();if(this.lastRecorded+this.options.delay>a&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(n=n.compose(o.delta),i=o.range)}else this.lastRecorded=a;n.length()!==0&&(this.stack.undo.push({delta:n,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){Z$(this.stack.undo,e),Z$(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,_t.sources.USER);else{const r=GEe(this.quill.scroll,e.delta);this.quill.setSelection(r,_t.sources.USER)}}}function Z$(t,e){let r=e;for(let n=t.length-1;n>=0;n-=1){const i=t[n];t[n]={delta:r.transform(i.delta,!0),range:i.range&&oT(i.range,r)},r=i.delta.transform(r),t[n].delta.length()===0&&t.splice(n,1)}}function WEe(t,e){const r=e.ops[e.ops.length-1];return r==null?!1:r.insert!=null?typeof r.insert=="string"&&r.insert.endsWith(`
`):r.attributes!=null?Object.keys(r.attributes).some(n=>t.query(n,wr.BLOCK)!=null):!1}function GEe(t,e){const r=e.reduce((i,a)=>i+(a.delete||0),0);let n=e.length()-r;return WEe(t,e)&&(n-=1),n}function oT(t,e){if(!t)return t;const r=e.transformPosition(t.index),n=e.transformPosition(t.index+t.length);return{index:r,length:n-r}}class YZ extends Qd{constructor(e,r){super(e,r),e.root.addEventListener("drop",n=>{n.preventDefault();let i=null;if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(n.clientX,n.clientY);i=document.createRange(),i.setStart(o.offsetNode,o.offset),i.setEnd(o.offsetNode,o.offset)}const a=i&&e.selection.normalizeNative(i);if(a){const o=e.selection.normalizedToRange(a);n.dataTransfer?.files&&this.upload(o,n.dataTransfer.files)}})}upload(e,r){const n=[];Array.from(r).forEach(i=>{i&&this.options.mimetypes?.includes(i.type)&&n.push(i)}),n.length>0&&this.options.handler.call(this,e,n)}}YZ.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){if(!this.quill.scroll.query("image"))return;const r=e.map(n=>new Promise(i=>{const a=new FileReader;a.onload=()=>{i(a.result)},a.readAsDataURL(n)}));Promise.all(r).then(n=>{const i=n.reduce((a,o)=>a.insert({image:o}),new br().retain(t.index).delete(t.length));this.quill.updateContents(i,gr.sources.USER),this.quill.setSelection(t.index+n.length,gr.sources.SILENT)})}};const KEe=["insertText","insertReplacementText"];class YEe extends Qd{constructor(e,r){super(e,r),e.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||e.on(_t.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){_L({range:e,quill:this.quill})}replaceText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(r){const n=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new br().retain(e.index).insert(r,n),_t.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+r.length,0,_t.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!KEe.includes(e.inputType))return;const r=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!r||r.collapsed===!0)return;const n=XEe(e);if(n==null)return;const i=this.quill.selection.normalizeNative(r),a=i?this.quill.selection.normalizedToRange(i):null;a&&this.replaceText(a,n)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function XEe(t){return typeof t.data=="string"?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}const QEe=/Mac/i.test(navigator.platform),JEe=100,ZEe=t=>!!(t.key==="ArrowLeft"||t.key==="ArrowRight"||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="Home"||QEe&&t.key==="a"&&t.ctrlKey===!0);class e6e extends Qd{isListening=!1;selectionChangeDeadline=0;constructor(e,r){super(e,r),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,r){let{line:n,event:i}=r;if(!(n instanceof Fu)||!n.uiNode)return!0;const a=getComputedStyle(n.domNode).direction==="rtl";return a&&i.key!=="ArrowRight"||!a&&i.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(i.shiftKey?1:0),_t.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&ZEe(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+JEe,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const r=e.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;const n=this.quill.scroll.find(r.startContainer);if(!(n instanceof Fu)||!n.uiNode)return;const i=document.createRange();i.setStartAfter(n.uiNode),i.setEndAfter(n.uiNode),e.removeAllRanges(),e.addRange(i)}}_t.register({"blots/block":Oo,"blots/block/embed":Jc,"blots/break":Zu,"blots/container":$m,"blots/cursor":kk,"blots/embed":yL,"blots/inline":ll,"blots/scroll":oEe,"blots/text":Wu,"modules/clipboard":PEe,"modules/history":HEe,"modules/keyboard":_k,"modules/uploader":YZ,"modules/input":YEe,"modules/uiNode":e6e});class t6e extends Ju{add(e,r){let n=0;if(r==="+1"||r==="-1"){const i=this.value(e)||0;n=r==="+1"?i+1:i-1}else typeof r=="number"&&(n=r);return n===0?(this.remove(e),!0):super.add(e,n.toString())}canAdd(e,r){return super.canAdd(e,r)||super.canAdd(e,parseInt(r,10))}value(e){return parseInt(super.value(e),10)||void 0}}const r6e=new t6e("indent","ql-indent",{scope:wr.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class n6e extends Oo{static blotName="blockquote";static tagName="blockquote"}class s6e extends Oo{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class Z1 extends $m{}Z1.blotName="list-container";Z1.tagName="OL";class e2 extends Oo{static create(e){const r=super.create();return r.setAttribute("data-list",e),r}static formats(e){return e.getAttribute("data-list")||void 0}static register(){_t.register(Z1)}constructor(e,r){super(e,r);const n=r.ownerDocument.createElement("span"),i=a=>{if(!e.isEnabled())return;const o=this.statics.formats(r,e);o==="checked"?(this.format("list","unchecked"),a.preventDefault()):o==="unchecked"&&(this.format("list","checked"),a.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-list",r):super.format(e,r)}}e2.blotName="list";e2.tagName="LI";Z1.allowedChildren=[e2];e2.requiredContainer=Z1;class CL extends ll{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class i6e extends CL{static blotName="italic";static tagName=["EM","I"]}class bj extends ll{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const r=super.create(e);return r.setAttribute("href",this.sanitize(e)),r.setAttribute("rel","noopener noreferrer"),r.setAttribute("target","_blank"),r}static formats(e){return e.getAttribute("href")}static sanitize(e){return XZ(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,r){e!==this.statics.blotName||!r?super.format(e,r):this.domNode.setAttribute("href",this.constructor.sanitize(r))}}function XZ(t,e){const r=document.createElement("a");r.href=t;const n=r.href.slice(0,r.href.indexOf(":"));return e.indexOf(n)>-1}class a6e extends ll{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class o6e extends CL{static blotName="strike";static tagName=["S","STRIKE"]}class l6e extends ll{static blotName="underline";static tagName="U"}class c6e extends yL{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const r=super.create(e);return typeof e=="string"&&(window.katex.render(e,r,{throwOnError:!1,errorColor:"#f00"}),r.setAttribute("data-value",e)),r}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const eF=["alt","height","width"];let u6e=class extends Cc{static blotName="image";static tagName="IMG";static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("src",this.sanitize(e)),r}static formats(e){return eF.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return XZ(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,r){eF.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}};const tF=["height","width"];class d6e extends Jc{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const r=super.create(e);return r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),r.setAttribute("src",this.sanitize(e)),r}static formats(e){return tF.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static sanitize(e){return bj.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,r){tF.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const tv=new Ju("code-token","hljs",{scope:wr.INLINE});class Jh extends ll{static formats(e,r){for(;e!=null&&e!==r.domNode;){if(e.classList&&e.classList.contains(ml.className))return super.formats(e,r);e=e.parentNode}}constructor(e,r,n){super(e,r,n),tv.add(this.domNode,n)}format(e,r){e!==Jh.blotName?super.format(e,r):r?tv.add(this.domNode,r):(tv.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),tv.value(this.domNode)||this.unwrap()}}Jh.blotName="code-token";Jh.className="ql-token";class Qc extends ml{static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("data-language",e),r}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-language",r):super.format(e,r)}replaceWith(e,r){return this.formatAt(0,this.length(),Jh.blotName,!1),super.replaceWith(e,r)}}class jv extends Fm{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,r){e===Qc.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(e,r)}))}formatAt(e,r,n,i){n===Qc.blotName&&(this.forceNext=!0),super.formatAt(e,r,n,i)}highlight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const i=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,a=Qc.formats(this.children.head.domNode);if(r||this.forceNext||this.cachedText!==i){if(i.trim().length>0||this.cachedText==null){const o=this.children.reduce((c,u)=>c.concat(OZ(u,!1)),new br),l=e(i,a);o.diff(l).reduce((c,u)=>{let{retain:h,attributes:p}=u;return h?(p&&Object.keys(p).forEach(m=>{[Qc.blotName,Jh.blotName].includes(m)&&this.formatAt(c,h,m,p[m])}),c+h):c},0)}this.cachedText=i,this.forceNext=!1}}html(e,r){const[n]=this.children.find(e);return`<pre data-language="${n?Qc.formats(n.domNode):"plain"}">
${jk(this.code(e,r))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const r=Qc.formats(this.children.head.domNode);r!==this.uiNode.value&&(this.uiNode.value=r)}}}jv.allowedChildren=[Qc];Qc.requiredContainer=jv;Qc.allowedChildren=[Jh,kk,Wu,Zu];const h6e=(t,e,r)=>{if(typeof t.versionString=="string"){const n=t.versionString.split(".")[0];if(parseInt(n,10)>=11)return t.highlight(r,{language:e}).value}return t.highlight(e,r).value};class QZ extends Qd{static register(){_t.register(Jh,!0),_t.register(Qc,!0),_t.register(jv,!0)}constructor(e,r){if(super(e,r),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,i)=>{let{key:a}=i;return n[a]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(_t.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof jv))return;const r=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:i,label:a}=n;const o=r.ownerDocument.createElement("option");o.textContent=a,o.setAttribute("value",i),r.appendChild(o)}),r.addEventListener("change",()=>{e.format(Qc.blotName,r.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(r),e.children.head&&(r.value=Qc.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(_t.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(_t.sources.USER);const n=this.quill.getSelection();(e==null?this.quill.scroll.descendants(jv):[e]).forEach(a=>{a.highlight(this.highlightBlot,r)}),this.quill.update(_t.sources.SILENT),n!=null&&this.quill.setSelection(n,_t.sources.SILENT)}highlightBlot(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(r=this.languages[r]?r:"plain",r==="plain")return jk(e).split(`
`).reduce((i,a,o)=>(o!==0&&i.insert(`
`,{[ml.blotName]:r}),i.insert(a)),new br);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(ml.className),n.innerHTML=h6e(this.options.hljs,r,e),SL(this.quill.scroll,n,[(i,a)=>{const o=tv.value(i);return o?a.compose(new br().retain(a.length(),{[Jh.blotName]:o})):a}],[(i,a)=>i.data.split(`
`).reduce((o,l,c)=>(c!==0&&o.insert(`
`,{[ml.blotName]:r}),o.insert(l)),a)],new WeakMap)}}QZ.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Tu extends Oo{static blotName="table";static tagName="TD";static create(e){const r=super.create();return e?r.setAttribute("data-row",e):r.setAttribute("data-row",EL()),r}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,r){e===Tu.blotName&&r?this.domNode.setAttribute("data-row",r):super.format(e,r)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class mm extends $m{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),r=this.children.tail.formats(),n=this.next.children.head.formats(),i=this.next.children.tail.formats();return e.table===r.table&&e.table===n.table&&e.table===i.table}return!1}optimize(e){super.optimize(e),this.children.forEach(r=>{if(r.next==null)return;const n=r.formats(),i=r.next.formats();if(n.table!==i.table){const a=this.splitAfter(r);a&&a.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class E0 extends $m{static blotName="table-body";static tagName="TBODY"}class yj extends $m{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(mm),r=e.reduce((n,i)=>Math.max(i.children.length,n),0);e.forEach(n=>{new Array(r-n.children.length).fill(0).forEach(()=>{let i;n.children.head!=null&&(i=Tu.formats(n.children.head.domNode));const a=this.scroll.create(Tu.blotName,i);n.appendChild(a),a.optimize()})})}cells(e){return this.rows().map(r=>r.children.at(e))}deleteColumn(e){const[r]=this.descendant(E0);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e);i?.remove()})}insertColumn(e){const[r]=this.descendant(E0);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e),a=Tu.formats(n.children.head.domNode),o=this.scroll.create(Tu.blotName,a);n.insertBefore(o,i)})}insertRow(e){const[r]=this.descendant(E0);if(r==null||r.children.head==null)return;const n=EL(),i=this.scroll.create(mm.blotName);r.children.head.children.forEach(()=>{const o=this.scroll.create(Tu.blotName,n);i.appendChild(o)});const a=r.children.at(e);r.insertBefore(i,a)}rows(){const e=this.children.head;return e==null?[]:e.children.map(r=>r)}}yj.allowedChildren=[E0];E0.requiredContainer=yj;E0.allowedChildren=[mm];mm.requiredContainer=E0;mm.allowedChildren=[Tu];Tu.requiredContainer=mm;function EL(){return`row-${Math.random().toString(36).slice(2,6)}`}class f6e extends Qd{static register(){_t.register(Tu),_t.register(mm),_t.register(E0),_t.register(yj)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(yj).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,r]=this.getTable();r!=null&&(e.deleteColumn(r.cellOffset()),this.quill.update(_t.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(_t.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const r=e.offset();e.remove(),this.quill.update(_t.sources.USER),this.quill.setSelection(r,_t.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[r,n]=this.quill.getLine(e.index);if(r==null||r.statics.blotName!==Tu.blotName)return[null,null,null,-1];const i=r.parent;return[i.parent.parent,i,r,n]}insertColumn(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const o=a.cellOffset();n.insertColumn(o+e),this.quill.update(_t.sources.USER);let l=i.rowOffset();e===0&&(l+=1),this.quill.setSelection(r.index+l,r.length,_t.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const o=i.rowOffset();n.insertRow(o+e),this.quill.update(_t.sources.USER),e>0?this.quill.setSelection(r,_t.sources.SILENT):this.quill.setSelection(r.index+i.children.length,r.length,_t.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,r){const n=this.quill.getSelection();if(n==null)return;const i=new Array(e).fill(0).reduce(a=>{const o=new Array(r).fill(`
`).join("");return a.insert(o,{table:EL()})},new br().retain(n.index));this.quill.updateContents(i,_t.sources.USER),this.quill.setSelection(n.index,_t.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(_t.events.SCROLL_OPTIMIZE,e=>{e.some(r=>["TD","TR","TBODY","TABLE"].includes(r.target.tagName)?(this.quill.once(_t.events.TEXT_CHANGE,(n,i,a)=>{a===_t.sources.USER&&this.balanceTables()}),!0):!1)})}}const rF=ff("quill:toolbar");class AL extends Qd{constructor(e,r){if(super(e,r),Array.isArray(this.options.container)){const n=document.createElement("div");n.setAttribute("role","toolbar"),p6e(n,this.options.container),e.container?.parentNode?.insertBefore(n,e.container),this.container=n}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){rF.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(n=>{const i=this.options.handlers?.[n];i&&this.addHandler(n,i)}),Array.from(this.container.querySelectorAll("button, select")).forEach(n=>{this.attach(n)}),this.quill.on(_t.events.EDITOR_CHANGE,()=>{const[n]=this.quill.selection.getRange();this.update(n)})}addHandler(e,r){this.handlers[e]=r}attach(e){let r=Array.from(e.classList).find(i=>i.indexOf("ql-")===0);if(!r)return;if(r=r.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[r]==null&&this.quill.scroll.query(r)==null){rF.warn("ignoring attaching to nonexistent format",r,e);return}const n=e.tagName==="SELECT"?"change":"click";e.addEventListener(n,i=>{let a;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const l=e.options[e.selectedIndex];l.hasAttribute("selected")?a=!1:a=l.value||!1}else e.classList.contains("ql-active")?a=!1:a=e.value||!e.hasAttribute("value"),i.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[r]!=null)this.handlers[r].call(this,a);else if(this.quill.scroll.query(r).prototype instanceof Cc){if(a=prompt(`Enter ${r}`),!a)return;this.quill.updateContents(new br().retain(o.index).delete(o.length).insert({[r]:a}),_t.sources.USER)}else this.quill.format(r,a,_t.sources.USER);this.update(o)}),this.controls.push([r,e])}update(e){const r=e==null?{}:this.quill.getFormat(e);this.controls.forEach(n=>{const[i,a]=n;if(a.tagName==="SELECT"){let o=null;if(e==null)o=null;else if(r[i]==null)o=a.querySelector("option[selected]");else if(!Array.isArray(r[i])){let l=r[i];typeof l=="string"&&(l=l.replace(/"/g,'\\"')),o=a.querySelector(`option[value="${l}"]`)}o==null?(a.value="",a.selectedIndex=-1):o.selected=!0}else if(e==null)a.classList.remove("ql-active"),a.setAttribute("aria-pressed","false");else if(a.hasAttribute("value")){const o=r[i],l=o===a.getAttribute("value")||o!=null&&o.toString()===a.getAttribute("value")||o==null&&!a.getAttribute("value");a.classList.toggle("ql-active",l),a.setAttribute("aria-pressed",l.toString())}else{const o=r[i]!=null;a.classList.toggle("ql-active",o),a.setAttribute("aria-pressed",o.toString())}})}}AL.DEFAULTS={};function nF(t,e,r){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${e}`),n.setAttribute("aria-pressed","false"),r!=null?(n.value=r,n.setAttribute("aria-label",`${e}: ${r}`)):n.setAttribute("aria-label",e),t.appendChild(n)}function p6e(t,e){Array.isArray(e[0])||(e=[e]),e.forEach(r=>{const n=document.createElement("span");n.classList.add("ql-formats"),r.forEach(i=>{if(typeof i=="string")nF(n,i);else{const a=Object.keys(i)[0],o=i[a];Array.isArray(o)?m6e(n,a,o):nF(n,a,o)}}),t.appendChild(n)})}function m6e(t,e,r){const n=document.createElement("select");n.classList.add(`ql-${e}`),r.forEach(i=>{const a=document.createElement("option");i!==!1?a.setAttribute("value",String(i)):a.setAttribute("selected","selected"),n.appendChild(a)}),t.appendChild(n)}AL.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(t!=null)if(t.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(r=>{this.quill.scroll.query(r,wr.INLINE)!=null&&this.quill.format(r,!1,_t.sources.USER)})}else this.quill.removeFormat(t.index,t.length,_t.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();t==="rtl"&&e==null?this.quill.format("align","right",_t.sources.USER):!t&&e==="right"&&this.quill.format("align",!1,_t.sources.USER),this.quill.format("direction",t,_t.sources.USER)},indent(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e),n=parseInt(r.indent||0,10);if(t==="+1"||t==="-1"){let i=t==="+1"?1:-1;r.direction==="rtl"&&(i*=-1),this.quill.format("indent",n+i,_t.sources.USER)}},link(t){t===!0&&(t=prompt("Enter link URL:")),this.quill.format("link",t,_t.sources.USER)},list(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e);t==="check"?r.list==="checked"||r.list==="unchecked"?this.quill.format("list",!1,_t.sources.USER):this.quill.format("list","unchecked",_t.sources.USER):this.quill.format("list",t,_t.sources.USER)}}};const g6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',x6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',b6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',y6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',v6e='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',w6e='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',N6e='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',j6e='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',sF='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',k6e='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',_6e='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',S6e='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',C6e='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',E6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',A6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',T6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',I6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',L6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',P6e='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',O6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',R6e='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',M6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',D6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',B6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',$6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',F6e='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',U6e='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',z6e='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',q6e='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',V6e='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',H6e='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',W6e='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',G6e='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',n1={align:{"":g6e,center:x6e,right:b6e,justify:y6e},background:v6e,blockquote:w6e,bold:N6e,clean:j6e,code:sF,"code-block":sF,color:k6e,direction:{"":_6e,rtl:S6e},formula:C6e,header:{1:E6e,2:A6e,3:T6e,4:I6e,5:L6e,6:P6e},italic:O6e,image:R6e,indent:{"+1":M6e,"-1":D6e},link:B6e,list:{bullet:$6e,check:F6e,ordered:U6e},script:{sub:z6e,super:q6e},strike:V6e,table:H6e,underline:W6e,video:G6e},K6e='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let iF=0;function aF(t,e){t.setAttribute(e,`${t.getAttribute(e)!=="true"}`)}class Sk{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",r=>{switch(r.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),r.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),aF(this.label,"aria-expanded"),aF(this.options,"aria-hidden")}buildItem(e){const r=document.createElement("span");r.tabIndex="0",r.setAttribute("role","button"),r.classList.add("ql-picker-item");const n=e.getAttribute("value");return n&&r.setAttribute("data-value",n),e.textContent&&r.setAttribute("data-label",e.textContent),r.addEventListener("click",()=>{this.selectItem(r,!0)}),r.addEventListener("keydown",i=>{switch(i.key){case"Enter":this.selectItem(r,!0),i.preventDefault();break;case"Escape":this.escape(),i.preventDefault();break}}),r}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=K6e,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${iF}`,iF+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(r=>{const n=this.buildItem(r);e.appendChild(n),r.selected===!0&&this.selectItem(n)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");e!==n&&(n?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),r&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const r=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",r)}}class JZ extends Sk{constructor(e,r){super(e),this.label.innerHTML=r,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(e){const r=super.buildItem(e);return r.style.backgroundColor=e.getAttribute("value")||"",r}selectItem(e,r){super.selectItem(e,r);const n=this.label.querySelector(".ql-color-label"),i=e&&e.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=i:n.style.fill=i)}}class ZZ extends Sk{constructor(e,r){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=r[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,r){super.selectItem(e,r);const n=e||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const Y6e=t=>{const{overflowY:e}=getComputedStyle(t,null);return e!=="visible"&&e!=="clip"};let eee=class{constructor(e,r){this.quill=e,this.boundsContainer=r||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Y6e(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const r=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${r}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),a=this.root.getBoundingClientRect();let o=0;if(a.right>i.right&&(o=i.right-a.right,this.root.style.left=`${r+o}px`),a.left<i.left&&(o=i.left-a.left,this.root.style.left=`${r+o}px`),a.bottom>i.bottom){const l=a.bottom-a.top,c=e.bottom-e.top+l;this.root.style.top=`${n-c}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}};const X6e=[!1,"center","right","justify"],Q6e=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],J6e=[!1,"serif","monospace"],Z6e=["1","2","3",!1],eAe=["small",!1,"large","huge"];class t2 extends vb{constructor(e,r){super(e,r);const n=i=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(i.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(a=>{a.container.contains(i.target)||a.close()})};e.emitter.listenDOM("click",document.body,n)}addModule(e){const r=super.addModule(e);return e==="toolbar"&&this.extendToolbar(r),r}buildButtons(e,r){Array.from(e).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(a=>{if(a.startsWith("ql-")&&(a=a.slice(3),r[a]!=null))if(a==="direction")n.innerHTML=r[a][""]+r[a].rtl;else if(typeof r[a]=="string")n.innerHTML=r[a];else{const o=n.value||"";o!=null&&r[a][o]&&(n.innerHTML=r[a][o])}})})}buildPickers(e,r){this.pickers=Array.from(e).map(i=>{if(i.classList.contains("ql-align")&&(i.querySelector("option")==null&&Ey(i,X6e),typeof r.align=="object"))return new ZZ(i,r.align);if(i.classList.contains("ql-background")||i.classList.contains("ql-color")){const a=i.classList.contains("ql-background")?"background":"color";return i.querySelector("option")==null&&Ey(i,Q6e,a==="background"?"#ffffff":"#000000"),new JZ(i,r[a])}return i.querySelector("option")==null&&(i.classList.contains("ql-font")?Ey(i,J6e):i.classList.contains("ql-header")?Ey(i,Z6e):i.classList.contains("ql-size")&&Ey(i,eAe)),new Sk(i)});const n=()=>{this.pickers.forEach(i=>{i.update()})};this.quill.on(gr.events.EDITOR_CHANGE,n)}}t2.DEFAULTS=C0({},vb.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");t==null&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""}),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class tee extends eee{constructor(e,r){super(e,r),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;r!=null?this.textbox.value=r:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:r}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,gr.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,gr.sources.USER)),this.quill.root.scrollTop=r;break}case"video":e=tAe(e);case"formula":{if(!e)break;const r=this.quill.getSelection(!0);if(r!=null){const n=r.index+r.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),e,gr.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",gr.sources.USER),this.quill.setSelection(n+2,gr.sources.USER)}break}}this.textbox.value="",this.hide()}}function tAe(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}function Ey(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(n=>{const i=document.createElement("option");n===r?i.setAttribute("selected","selected"):i.setAttribute("value",String(n)),t.appendChild(i)})}const rAe=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class nAe extends tee{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,r){super(e,r),this.quill.on(gr.events.EDITOR_CHANGE,(n,i,a,o)=>{if(n===gr.events.SELECTION_CHANGE)if(i!=null&&i.length>0&&o===gr.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const l=this.quill.getLines(i.index,i.length);if(l.length===1){const c=this.quill.getBounds(i);c!=null&&this.position(c)}else{const c=l[l.length-1],u=this.quill.getIndex(c),h=Math.min(c.length()-1,i.index+i.length-u),p=this.quill.getBounds(new pm(u,h));p!=null&&this.position(p)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(gr.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const r=this.quill.getBounds(e);r!=null&&this.position(r)}},1)})}cancel(){this.show()}position(e){const r=super.position(e),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",r!==0&&(n.style.marginLeft=`${-1*r-n.offsetWidth/2}px`),r}}class ree extends t2{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=rAe),super(e,r),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new nAe(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),n1),this.buildPickers(e.container.querySelectorAll("select"),n1))}}ree.DEFAULTS=C0({},t2.DEFAULTS,{modules:{toolbar:{handlers:{link(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1,_t.sources.USER)}}}}});const sAe=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class iAe extends tee{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const r=this.linkRange;this.restoreFocus(),this.quill.formatText(r,"link",!1,gr.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(gr.events.SELECTION_CHANGE,(e,r,n)=>{if(e!=null){if(e.length===0&&n===gr.sources.USER){const[i,a]=this.quill.scroll.descendant(bj,e.index);if(i!=null){this.linkRange=new pm(e.index-a,i.length());const o=bj.formats(i.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const l=this.quill.getBounds(this.linkRange);l!=null&&this.position(l);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class nee extends t2{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=sAe),super(e,r),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),n1),this.buildPickers(e.container.querySelectorAll("select"),n1),this.tooltip=new iAe(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(r,n)=>{e.handlers.link.call(e,!n.format.link)}))}}nee.DEFAULTS=C0({},t2.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const e=this.quill.getSelection();if(e==null||e.length===0)return;let r=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(r)&&r.indexOf("mailto:")!==0&&(r=`mailto:${r}`);const{tooltip:n}=this.quill.theme;n.edit("link",r)}else this.quill.format("link",!1,_t.sources.USER)}}}}});_t.register({"attributors/attribute/direction":FZ,"attributors/class/align":DZ,"attributors/class/background":uEe,"attributors/class/color":cEe,"attributors/class/direction":UZ,"attributors/class/font":VZ,"attributors/class/size":WZ,"attributors/style/align":BZ,"attributors/style/background":NL,"attributors/style/color":wL,"attributors/style/direction":zZ,"attributors/style/font":HZ,"attributors/style/size":GZ},!0);_t.register({"formats/align":DZ,"formats/direction":UZ,"formats/indent":r6e,"formats/background":NL,"formats/color":wL,"formats/font":VZ,"formats/size":WZ,"formats/blockquote":n6e,"formats/code-block":ml,"formats/header":s6e,"formats/list":e2,"formats/bold":CL,"formats/code":jL,"formats/italic":i6e,"formats/link":bj,"formats/script":a6e,"formats/strike":o6e,"formats/underline":l6e,"formats/formula":c6e,"formats/image":u6e,"formats/video":d6e,"modules/syntax":QZ,"modules/table":f6e,"modules/toolbar":AL,"themes/bubble":ree,"themes/snow":nee,"ui/icons":n1,"ui/picker":Sk,"ui/icon-picker":ZZ,"ui/color-picker":JZ,"ui/tooltip":eee},!0);class Ck extends Pe.Component{constructor(e){super(e),this.editingAreaRef=y.createRef(),this.containerRef=y.createRef(),this.dirtyProps=["modules","formats","bounds","theme","children"],this.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],this.state={generation:0},this.selection=null,this.onEditorChange=(n,i,a,o)=>{n==="text-change"?this.onEditorChangeText?.(this.editor.getSemanticHTML(),i,o,this.unprivilegedEditor):n==="selection-change"&&this.onEditorChangeSelection?.(i,o,this.unprivilegedEditor)};const r=this.isControlled()?e.value:e.defaultValue;this.value=r??""}validateProps(e){if(Pe.Children.count(e.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Pe.Children.count(e.children)&&Pe.Children.only(e.children)?.type==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.");if(this.lastDeltaChangeSet&&e.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")}shouldComponentUpdate(e,r){if(this.validateProps(e),!this.editor||this.state.generation!==r.generation)return!0;if("value"in e){const n=this.getEditorContents(),i=e.value??"";this.isEqualValue(i,n)||this.setEditorContents(this.editor,i)}return e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),[...this.cleanProps,...this.dirtyProps].some(n=>!f0(e[n],this.props[n]))}shouldComponentRegenerate(e){return this.dirtyProps.some(r=>!f0(e[r],this.props[r]))}componentDidMount(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())}componentWillUnmount(){this.destroyEditor()}componentDidUpdate(e,r){if(this.editor&&this.shouldComponentRegenerate(e)){const n=this.editor.getContents(),i=this.editor.getSelection();this.regenerationSnapshot={delta:n,selection:i},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.editor&&e.placeholder!==this.props.placeholder&&(this.editor.root.dataset.placeholder=this.props.placeholder||""),this.state.generation!==r.generation){const{delta:n,selection:i}=this.regenerationSnapshot;delete this.regenerationSnapshot,this.instantiateEditor();const a=this.editor;a.setContents(n),oF(()=>this.setEditorSelection(a,i))}}instantiateEditor(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())}destroyEditor(){if(!this.editor)return;this.unhookEditor(this.editor);const e=this.props.modules?.toolbar;if(!(typeof e=="object"&&e&&"container"in e&&typeof e.container=="string"||typeof e=="string")){const n=this.containerRef.current?.querySelector(".ql-toolbar");n&&n.remove()}delete this.editor}isControlled(){return"value"in this.props}getEditorConfig(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,theme:this.props.theme}}getEditor(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor}createEditor(e,r){const n=new _t(e,r);return r.tabIndex!=null&&this.setEditorTabIndex(n,r.tabIndex),this.hookEditor(n),n}hookEditor(e){this.unprivilegedEditor=this.makeUnprivilegedEditor(e),e.on("editor-change",this.onEditorChange)}unhookEditor(e){e.off("editor-change",this.onEditorChange)}getEditorContents(){return this.value}getEditorSelection(){return this.selection}isDelta(e){return e&&e.ops}isEqualValue(e,r){return this.isDelta(e)&&this.isDelta(r)?f0(e.ops,r.ops):f0(e,r)}setEditorContents(e,r){this.value=r;const n=this.getEditorSelection();typeof r=="string"?e.setContents(e.clipboard.convert({html:r})):e.setContents(r),oF(()=>this.setEditorSelection(e,n))}setEditorSelection(e,r){if(this.selection=r,r){const n=e.getLength();r.index=Math.max(0,Math.min(r.index,n-1)),r.length=Math.max(0,Math.min(r.length,n-1-r.index)),e.setSelection(r)}}setEditorTabIndex(e,r){e?.scroll?.domNode&&(e.scroll.domNode.tabIndex=r)}setEditorReadOnly(e,r){r?e.disable():e.enable()}makeUnprivilegedEditor(e){const r=e;return{getHTML:()=>r.root.innerHTML,getSemanticHTML:r.getSemanticHTML.bind(r),getLength:r.getLength.bind(r),getText:r.getText.bind(r),getContents:r.getContents.bind(r),getSelection:r.getSelection.bind(r),getBounds:r.getBounds.bind(r)}}getEditingArea(){const e=this.editingAreaRef.current;if(!e)throw new Error("Cannot find element for editing area");if(e.nodeType===3)throw new Error("Editing area cannot be a text node");return e}renderEditingArea(){const{children:e,preserveWhitespace:r}=this.props,{generation:n}=this.state,i={key:n,ref:this.editingAreaRef};return Pe.Children.count(e)?Pe.cloneElement(Pe.Children.only(e),i):r?Pe.createElement("pre",{...i}):Pe.createElement("div",{...i})}render(){return Pe.createElement("div",{ref:this.containerRef,id:this.props.id,style:this.props.style,key:this.state.generation,className:`quill ${this.props.className??""}`,onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())}onEditorChangeText(e,r,n,i){if(!this.editor)return;const a=this.isDelta(this.value)?i.getContents():i.getSemanticHTML();a!==this.getEditorContents()&&(this.lastDeltaChangeSet=r,this.value=a,this.props.onChange?.(e,r,n,i))}onEditorChangeSelection(e,r,n){if(!this.editor)return;const i=this.getEditorSelection(),a=!i&&e,o=i&&!e;f0(e,i)||(this.selection=e,this.props.onChangeSelection?.(e,r,n),a?this.props.onFocus?.(e,r,n):o&&this.props.onBlur?.(i,r,n))}focus(){this.editor&&this.editor.focus()}blur(){this.editor&&(this.selection=null,this.editor.blur())}}Ck.displayName="React Quill";Ck.Quill=_t;Ck.defaultProps={theme:"snow",modules:{},readOnly:!1};function oF(t){Promise.resolve().then(t)}const aAe={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["clean"]]},lT=({value:t,onChange:e,placeholder:r,type:n="General",height:i="h-40"})=>{const{userProfile:a}=Or(),{addToast:o}=jn(),[l,c]=y.useState(!1),u=async()=>{const h=a?.settings?.geminiApiKey;if(!h){o("AI API Key missing in settings.","error");return}if(!t||t.replace(/<[^>]*>/g,"").trim().length<5){o("Please write a bit more first!","warning");return}c(!0);try{const p=await ul.spruceUpText(h,t,n);e(p),o("Spruced up successfully!","success")}catch(p){console.error(p),o("AI failed to enhance text.","error")}finally{c(!1)}};return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.jsxs("button",{type:"button",onClick:u,disabled:l,className:"flex items-center gap-1 text-[10px] uppercase font-bold tracking-wider bg-indigo-600/80 hover:bg-indigo-500 text-white px-3 py-1.5 rounded-full transition-all backdrop-blur-sm disabled:opacity-50 shadow-lg border border-indigo-400/30",title:"Spruce up with AI",children:[l?s.jsx("span",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Polish"]})}),s.jsx("div",{className:`bg-gray-900 border border-gray-700 rounded-lg overflow-hidden ${i} flex flex-col`,children:s.jsx(Ck,{theme:"snow",value:t||"",onChange:e,modules:aAe,placeholder:r,className:"flex-1 text-white flex flex-col h-full"})}),s.jsx("style",{children:`
                .quill { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
                .ql-toolbar.ql-snow { border: none !important; border-bottom: 1px solid #374151 !important; background: #111827; flex-shrink: 0; }
                .ql-container.ql-snow { border: none !important; flex: 1; display: flex; flex-direction: column; overflow: hidden; background: transparent; }
                .ql-editor { color: #e5e7eb; flex: 1; overflow-y: auto; font-family: inherit; padding: 1rem; }
                .ql-editor.ql-blank::before { color: #6b7280; font-style: normal; font-style: italic; }
                
                /* Icon/Picker Colors */
                .ql-snow .ql-stroke { stroke: #9ca3af !important; }
                .ql-snow .ql-fill { fill: #9ca3af !important; }
                .ql-snow .ql-picker { color: #9ca3af !important; }
                .ql-snow .ql-picker-options { background-color: #1f2937 !important; border-color: #374151 !important; color: #e5e7eb !important; }
                .ql-snow .ql-picker-item:hover { color: #818cf8 !important; }
                .ql-snow .ql-picker-item.ql-selected { color: #6366f1 !important; }
            `})]})},oAe=({ticket:t,isAdmin:e,currentUserId:r,onEdit:n,onDelete:i,onVote:a,getTypeBadge:o,getStatusBadge:l})=>{const[c,u]=y.useState(!1),[h,p]=y.useState([]);return y.useEffect(()=>{c&&t.note_count>0&&h.length===0&&Ge.getTicketNotes(t.id).then(p).catch(console.error)},[c,t.note_count,t.id]),s.jsx("div",{className:"bg-gray-800/40 border border-white/5 rounded-lg p-4 hover:bg-gray-800/60 transition-colors group",children:s.jsxs("div",{className:"flex justify-between items-start gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[o(t.type),s.jsx("h4",{className:"text-white font-medium hover:text-indigo-300 cursor-pointer truncate",onClick:()=>(e||t.created_by===r&&t.status==="open")&&n(t),children:t.title}),l(t.status),t.epic_title&&s.jsx("span",{className:"text-[10px] bg-indigo-500/10 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/20 whitespace-nowrap",children:t.epic_title})]}),s.jsx("div",{className:`text-sm text-gray-400 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-0 [&>ul]:list-none [&>ul]:pl-0 ${c?"":"line-clamp-2"}`,dangerouslySetInnerHTML:{__html:t.description||""}}),s.jsx("button",{onClick:m=>{m.stopPropagation(),u(!c)},className:"text-xs text-indigo-400 hover:text-indigo-300 mt-1 hover:underline focus:outline-none",children:c?"Show less":"Read more..."}),s.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-500 flex-wrap",children:[s.jsxs("span",{children:["b/",t.created_by_username||"Unknown"]}),t.assigned_to&&s.jsxs("span",{className:"text-indigo-400",children:["Assigned: ",t.assigned_to_username]}),t.due_date&&s.jsxs("span",{children:["Due: ",Gi(new Date(t.due_date),"MMM d")]}),t.estimated_release_date&&s.jsxs("span",{className:"text-orange-400",children:["Est. Release: ",Gi(new Date(t.estimated_release_date),"MMM d")]}),t.date_released&&s.jsxs("span",{className:"text-green-400",children:["Released: ",Gi(new Date(t.date_released),"MMM d")]}),t.note_count>0&&s.jsxs("span",{className:"flex items-center gap-1 text-gray-400 bg-gray-700/50 px-1.5 py-0.5 rounded",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),t.note_count," ",t.note_count===1?"Note":"Notes",t.last_note_at&&s.jsxs("span",{className:"opacity-70 ml-1",children:[" ",Gi(new Date(t.last_note_at),"MMM d, h:mm a")]})]}),(e||t.created_by===r&&t.status==="open")&&s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>n(t),className:"hover:text-white transition-colors",children:["Edit ",e&&t.created_by!==r?"(Admin)":""]}),s.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this ticket?")&&i(t.id)},className:"text-gray-500 hover:text-red-400 transition-colors",children:"Delete"})]})]}),c&&h.length>0&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 space-y-2",children:[s.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase",children:"Latest Notes"}),h.map(m=>s.jsxs("div",{className:"bg-gray-900/30 p-2 rounded text-xs border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-gray-500 mb-0.5",children:[s.jsx("span",{className:"font-bold text-indigo-400",children:m.username}),s.jsx("span",{children:Gi(new Date(m.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-gray-300 mb-0",children:m.note})]},m.id))]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-1 pl-4 border-l border-white/5 shrink-0",children:[s.jsx("button",{onClick:()=>a(t.id),className:"text-gray-400 hover:text-indigo-400",children:""}),s.jsx("span",{className:"font-mono text-sm font-bold text-white",children:t.votes})]})]})})},lAe=({isOpen:t,onClose:e})=>{const{user:r,userProfile:n}=Or(),[i,a]=y.useState("issues"),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,p]=y.useState(!1),[m,g]=y.useState(""),[b,v]=y.useState(""),[w,j]=y.useState({title:"",description:"",type:"bug",epic_id:""}),[_,E]=y.useState(null),[I,O]=y.useState([]),[B,S]=y.useState([]),[T,M]=y.useState(""),k=r?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||n?.settings?.isAdmin||n?.settings?.permissions?.includes("manage_tickets");y.useEffect(()=>{t&&L()},[t,i]),y.useEffect(()=>{k&&t&&(async()=>{try{const q=await Ge.getAssignees();O(q)}catch(q){console.error(q)}})()},[k,t]),y.useEffect(()=>{_?(async()=>{try{const q=await Ge.getTicketNotes(_.id);S(q)}catch(q){console.error(q)}})():(S([]),M(""))},[_]);const L=async()=>{p(!0);try{if(i==="issues"){const ee={};m&&(ee.status=m),b&&(ee.type=b);const q=await Ge.getTickets(ee);l(q)}else if(i==="projects"||i==="new_ticket"){const ee=await Ge.getEpics();u(ee)}}catch(ee){console.error("Failed to load data",ee)}finally{p(!1)}},R=async ee=>{ee.preventDefault();try{await Ge.createTicket(w),j({title:"",description:"",type:"bug",epic_id:""}),a("issues"),L()}catch(q){alert("Failed to create ticket: "+q.message)}},V=async ee=>{try{await Ge.voteTicket(ee),l(o.map(q=>q.id===ee?{...q,votes:(q.votes||0)+1}:q))}catch(q){console.error(q)}},Y=async ee=>{try{await Ge.deleteTicket(ee),l(o.filter(q=>q.id!==ee))}catch(q){console.error("Delete error:",q),alert("Failed to delete ticket: "+q.message)}},X=async ee=>{if(ee.preventDefault(),!!_)try{await Ge.updateTicket(_.id,_),E(null),L()}catch(q){alert("Update failed: "+q.message)}},J=async ee=>{if(ee.preventDefault(),!!T.trim())try{const q=await Ge.addTicketNote(_.id,T);S([...B,q]),M("")}catch(q){alert("Failed to add note: "+q.message)}},re=ee=>{const q={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},U={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Complete - Pending Release",complete_scheduled:"Complete - Release Scheduled",complete_blocked:"Complete - Waiting on Epic",wont_fix:"Won't Fix"};return s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold border ${q[ee]||q.open} uppercase tracking-wider whitespace-nowrap`,children:U[ee]||(ee||"open").replace(/_/g," ")})},se=ee=>ee==="bug"?s.jsx("span",{className:"text-red-400 font-mono text-xs",children:"[BUG]"}):s.jsx("span",{className:"text-cyan-400 font-mono text-xs",children:"[FEAT]"});return t?s.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-50 inline-block align-bottom bg-gray-900 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full border border-white/10",children:[s.jsxs("div",{className:"bg-gray-800/50 px-6 py-4 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," System Status & Feedback"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("a",{href:"https://discord.gg/p4ybr8h6QV",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"bg-gray-800/30 px-6 border-b border-white/5 flex gap-6 overflow-x-auto",children:["issues","projects","new_ticket"].map(ee=>s.jsxs("button",{onClick:()=>a(ee),className:`py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${i===ee?"border-indigo-500 text-white":"border-transparent text-gray-400 hover:text-gray-300"}`,children:[ee==="issues"&&"Board & Issues",ee==="projects"&&"Projects (Epics)",ee==="new_ticket"&&"Review / Submit Issue"]},ee))}),s.jsxs("div",{className:"p-6 min-h-[400px] max-h-[70vh] overflow-y-auto bg-gray-900",children:[i==="issues"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:m,onChange:ee=>g(ee.target.value),children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]}),s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:b,onChange:ee=>v(ee.target.value),children:[s.jsx("option",{value:"",children:"All Types"}),s.jsx("option",{value:"bug",children:"Bugs"}),s.jsx("option",{value:"feature",children:"Features"})]}),s.jsx("button",{onClick:L,className:"text-xs text-indigo-400 hover:text-indigo-300 underline",children:"Refresh"})]}),h?s.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading issues..."}):o.length===0?s.jsxs("div",{className:"text-center py-12 text-gray-500 border border-dashed border-white/10 rounded-xl",children:["No tickets found. ",s.jsx("button",{onClick:()=>a("new_ticket"),className:"text-indigo-400 hover:underline",children:"Create one?"})]}):s.jsx("div",{className:"space-y-3",children:o.map(ee=>s.jsx(oAe,{ticket:ee,isAdmin:k,currentUserId:n?.id,onEdit:E,onDelete:Y,onVote:V,getTypeBadge:se,getStatusBadge:re},ee.id))})]}),i==="projects"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"Large scale projects and goals for the platform."}),c.map(ee=>s.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h4",{className:"text-lg font-bold text-white",children:ee.title}),s.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-700 text-gray-300",children:ee.status})]}),s.jsx("div",{className:"text-gray-400 text-sm mt-2 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-2 [&>ul]:list-disc [&>ul]:pl-4",dangerouslySetInnerHTML:{__html:ee.description||""}}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 text-xs text-gray-500",children:[ee.ticket_count||0," Tickets linked"]})]},ee.id)),c.length===0&&s.jsx("div",{className:"text-gray-500 text-center py-8",children:"No active projects. Admins can create them via API for now."})]}),i==="new_ticket"&&s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("form",{onSubmit:R,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Issue Type"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${w.type==="bug"?"bg-red-500/10 border-red-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"bug",checked:w.type==="bug",onChange:ee=>j({...w,type:ee.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Bug Report"}),s.jsx("div",{className:"text-xs opacity-70",children:"Something is broken"})]}),s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${w.type==="feature"?"bg-indigo-500/10 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"feature",checked:w.type==="feature",onChange:ee=>j({...w,type:ee.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Feature Request"}),s.jsx("div",{className:"text-xs opacity-70",children:"New idea or improvement"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",placeholder:"Short summary of the issue...",value:w.title,onChange:ee=>j({...w,title:ee.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(lT,{value:w.description,onChange:ee=>j({...w,description:ee}),placeholder:"Detailed description, steps to reproduce, or link to screenshots...",type:"Ticket",height:"h-56"})})]}),c.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Project (Optional)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:w.epic_id,onChange:ee=>j({...w,epic_id:ee.target.value}),children:[s.jsx("option",{value:"",children:"- None -"}),c.map(ee=>s.jsx("option",{value:ee.id,children:ee.title},ee.id))]})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all",children:"Submit Issue"})})]})})]})]})]}),_&&s.jsx("div",{className:"absolute inset-0 z-[110] flex items-center justify-center p-4 bg-black/70 backdrop-blur-md",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-3xl w-full p-8 border border-white/10 shadow-3xl overflow-y-auto max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-2xl font-black text-white italic uppercase tracking-tight",children:k?"Edit Ticket (Admin)":"Edit Your Ticket"}),s.jsx("button",{onClick:()=>E(null),className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:X,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Issue Type"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:_.type,onChange:ee=>E({..._,type:ee.target.value}),children:[s.jsx("option",{value:"bug",children:"Bug Report"}),s.jsx("option",{value:"feature",children:"Feature Request"})]})]}),k&&s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:_.status,onChange:ee=>E({..._,status:ee.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:_.title,onChange:ee=>E({..._,title:ee.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(lT,{value:_.description,onChange:ee=>E({..._,description:ee}),placeholder:"Update description...",type:"Ticket",height:"h-56"})})]}),k&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Project (Epic)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:_.epic_id||"",onChange:ee=>E({..._,epic_id:ee.target.value||null}),children:[s.jsx("option",{value:"",children:"None"}),c.map(ee=>s.jsx("option",{value:ee.id,children:ee.title},ee.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Assignee"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:_.assigned_to||"",onChange:ee=>E({..._,assigned_to:ee.target.value||null}),children:[s.jsx("option",{value:"",children:"- Unassigned -"}),I.map(ee=>s.jsx("option",{value:ee.id,children:ee.username},ee.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Due Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:_.due_date?Gi(new Date(_.due_date),"yyyy-MM-dd"):"",onChange:ee=>E({..._,due_date:ee.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Completion"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:_.est_completion_date?Gi(new Date(_.est_completion_date),"yyyy-MM-dd"):"",onChange:ee=>E({..._,est_completion_date:ee.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Release"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:_.estimated_release_date?Gi(new Date(_.estimated_release_date),"yyyy-MM-dd"):"",onChange:ee=>E({..._,estimated_release_date:ee.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Date Released"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:_.date_released?Gi(new Date(_.date_released),"yyyy-MM-dd"):"",onChange:ee=>E({..._,date_released:ee.target.value})})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-6 mt-6",children:[s.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4",children:"Internal Notes"}),s.jsxs("div",{className:"space-y-3 max-h-48 overflow-y-auto mb-4 custom-scrollbar",children:[B.length===0&&s.jsx("p",{className:"text-xs text-gray-600 italic",children:"No notes yet."}),B.map(ee=>s.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[s.jsx("span",{className:"font-bold text-indigo-400 uppercase tracking-widest",children:ee.username}),s.jsx("span",{children:Gi(new Date(ee.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-sm text-gray-300",children:ee.note})]},ee.id))]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",placeholder:"Add a note...",value:T,onChange:ee=>M(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&(ee.preventDefault(),J(ee))}),s.jsx("button",{type:"button",onClick:J,className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white text-xs font-bold uppercase tracking-widest rounded-xl transition-all",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[s.jsx("button",{type:"button",onClick:()=>E(null),className:"px-6 py-3 text-gray-500 font-bold uppercase tracking-widest text-xs hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-indigo-500/20 transition-all",children:"Save Changes"})]})]})]})})]}):null};var see="clover",cAe=function(e){return e===3?"v3":e},iee="https://js.stripe.com",uAe="".concat(iee,"/").concat(see,"/stripe.js"),dAe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,hAe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var fAe=function(e){return dAe.test(e)||hAe.test(e)},pAe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(iee,'"]')),r=0;r<e.length;r++){var n=e[r];if(fAe(n.src))return n}return null},lF=function(e){var r="",n=document.createElement("script");n.src="".concat(uAe).concat(r);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},mAe=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.6.0",startTime:r})},Ay=null,e5=null,t5=null,gAe=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},xAe=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},bAe=function(e){return Ay!==null?Ay:(Ay=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var i=pAe();if(!(i&&e)){if(!i)i=lF(e);else if(i&&t5!==null&&e5!==null){var a;i.removeEventListener("load",t5),i.removeEventListener("error",e5),(a=i.parentNode)===null||a===void 0||a.removeChild(i),i=lF(e)}}t5=xAe(r,n),e5=gAe(n),i.addEventListener("load",t5),i.addEventListener("error",e5)}catch(o){n(o);return}}),Ay.catch(function(r){return Ay=null,Promise.reject(r)}))},yAe=function(e,r,n){if(e===null)return null;var i=r[0],a=i.match(/^pk_test/),o=cAe(e.version),l=see;a&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.6.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,r);return mAe(c,n),c},Ty,aee=!1,oee=function(){return Ty||(Ty=bAe(null).catch(function(e){return Ty=null,Promise.reject(e)}),Ty)};Promise.resolve().then(function(){return oee()}).catch(function(t){aee||console.warn(t)});var vAe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];aee=!0;var i=Date.now();return oee().then(function(a){return yAe(a,r,i)})},wAe=ZI();const Ms=bl(wAe);function cF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cF(Object(r),!0).forEach(function(n){lee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aN(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?aN=function(e){return typeof e}:aN=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aN(t)}function lee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NAe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function jAe(t,e){if(t==null)return{};var r=NAe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function cee(t,e){return kAe(t)||_Ae(t,e)||SAe(t,e)||CAe()}function kAe(t){if(Array.isArray(t))return t}function _Ae(t,e){var r=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(r!=null){var n=[],i=!0,a=!1,o,l;try{for(r=r.call(t);!(i=(o=r.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(c){a=!0,l=c}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw l}}return n}}function SAe(t,e){if(t){if(typeof t=="string")return dF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dF(t,e)}}function dF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ol=function(e,r,n){var i=!!n,a=Pe.useRef(n);Pe.useEffect(function(){a.current=n},[n]),Pe.useEffect(function(){if(!i||!e)return function(){};var o=function(){a.current&&a.current.apply(a,arguments)};return e.on(r,o),function(){e.off(r,o)}},[i,r,e,a])},cT=function(e){var r=Pe.useRef(e);return Pe.useEffect(function(){r.current=e},[e]),r.current},Xx=function(e){return e!==null&&aN(e)==="object"},EAe=function(e){return Xx(e)&&typeof e.then=="function"},AAe=function(e){return Xx(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},hF="[object Object]",TAe=function t(e,r){if(!Xx(e)||!Xx(r))return e===r;var n=Array.isArray(e),i=Array.isArray(r);if(n!==i)return!1;var a=Object.prototype.toString.call(e)===hF,o=Object.prototype.toString.call(r)===hF;if(a!==o)return!1;if(!a&&!n)return e===r;var l=Object.keys(e),c=Object.keys(r);if(l.length!==c.length)return!1;for(var u={},h=0;h<l.length;h+=1)u[l[h]]=!0;for(var p=0;p<c.length;p+=1)u[c[p]]=!0;var m=Object.keys(u);if(m.length!==l.length)return!1;var g=e,b=r,v=function(j){return t(g[j],b[j])};return m.every(v)},uee=function(e,r,n){return Xx(e)?Object.keys(e).reduce(function(i,a){var o=!Xx(r)||!TAe(e[a],r[a]);return n.includes(a)?(o&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),i):o?uF(uF({},i||{}),{},lee({},a,e[a])):i},null):null},dee="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",fF=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dee;if(e===null||AAe(e))return e;throw new Error(r)},IAe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dee;if(EAe(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(i){return fF(i,r)})};var n=fF(e,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},LAe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.4.1"}),e.registerAppInfo({name:"react-stripe-js",version:"5.4.1",url:"https://stripe.com/docs/stripe-js/react"}))},Ek=Pe.createContext(null);Ek.displayName="ElementsContext";var hee=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e},fee=function(e){var r=e.stripe,n=e.options,i=e.children,a=Pe.useMemo(function(){return IAe(r)},[r]),o=Pe.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),l=cee(o,2),c=l[0],u=l[1];Pe.useEffect(function(){var m=!0,g=function(v){u(function(w){return w.stripe?w:{stripe:v,elements:v.elements(n)}})};return a.tag==="async"&&!c.stripe?a.stripePromise.then(function(b){b&&m&&g(b)}):a.tag==="sync"&&!c.stripe&&g(a.stripe),function(){m=!1}},[a,c,n]);var h=cT(r);Pe.useEffect(function(){h!==null&&h!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[h,r]);var p=cT(n);return Pe.useEffect(function(){if(c.elements){var m=uee(n,p,["clientSecret","fonts"]);m&&c.elements.update(m)}},[n,p,c.elements]),Pe.useEffect(function(){LAe(c.stripe)},[c.stripe]),Pe.createElement(Ek.Provider,{value:c},i)};fee.propTypes={stripe:Ms.any,options:Ms.object};var PAe=function(e){var r=Pe.useContext(Ek);return hee(r,e)},OAe=function(){var e=PAe("calls useElements()"),r=e.elements;return r};Ms.func.isRequired;var pee=Pe.createContext(null);pee.displayName="CheckoutContext";Ms.any,Ms.shape({clientSecret:Ms.oneOfType([Ms.string,Ms.instanceOf(Promise)]).isRequired,elementsOptions:Ms.object}).isRequired;var uT=function(e){var r=Pe.useContext(pee),n=Pe.useContext(Ek);if(r){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return hee(n,e)},RAe=["mode"],MAe=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Ql=function(e,r){var n="".concat(MAe(e),"Element"),i=function(c){var u=c.id,h=c.className,p=c.options,m=p===void 0?{}:p,g=c.onBlur,b=c.onFocus,v=c.onReady,w=c.onChange,j=c.onEscape,_=c.onClick,E=c.onLoadError,I=c.onLoaderStart,O=c.onNetworksChange,B=c.onConfirm,S=c.onCancel,T=c.onShippingAddressChange,M=c.onShippingRateChange,$=c.onSavedPaymentMethodRemove,k=c.onSavedPaymentMethodUpdate,L=uT("mounts <".concat(n,">")),R="elements"in L?L.elements:null,V="checkoutState"in L?L.checkoutState:null,Y=V?.type==="success"||V?.type==="loading"?V.sdk:null,X=Pe.useState(null),J=cee(X,2),re=J[0],se=J[1],ee=Pe.useRef(null),q=Pe.useRef(null);ol(re,"blur",g),ol(re,"focus",b),ol(re,"escape",j),ol(re,"click",_),ol(re,"loaderror",E),ol(re,"loaderstart",I),ol(re,"networkschange",O),ol(re,"confirm",B),ol(re,"cancel",S),ol(re,"shippingaddresschange",T),ol(re,"shippingratechange",M),ol(re,"savedpaymentmethodremove",$),ol(re,"savedpaymentmethodupdate",k),ol(re,"change",w);var U;v&&(e==="expressCheckout"?U=v:U=function(){v(re)}),ol(re,"ready",U),Pe.useLayoutEffect(function(){if(ee.current===null&&q.current!==null&&(R||Y)){var Z=null;if(Y)switch(e){case"paymentForm":Z=Y.createPaymentFormElement();break;case"payment":Z=Y.createPaymentElement(m);break;case"address":if("mode"in m){var de=m.mode,be=jAe(m,RAe);if(de==="shipping")Z=Y.createShippingAddressElement(be);else if(de==="billing")Z=Y.createBillingAddressElement(be);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":Z=Y.createExpressCheckoutElement(m);break;case"currencySelector":Z=Y.createCurrencySelectorElement();break;case"taxId":Z=Y.createTaxIdElement(m);break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else R&&(Z=R.create(e,m));ee.current=Z,se(Z),Z&&Z.mount(q.current)}},[R,Y,m]);var W=cT(m);return Pe.useEffect(function(){if(ee.current){var Z=uee(m,W,["paymentRequest"]);Z&&"update"in ee.current&&ee.current.update(Z)}},[m,W]),Pe.useLayoutEffect(function(){return function(){if(ee.current&&typeof ee.current.destroy=="function")try{ee.current.destroy(),ee.current=null}catch{}}},[]),Pe.createElement("div",{id:u,className:h,ref:q})},a=function(c){uT("mounts <".concat(n,">"));var u=c.id,h=c.className;return Pe.createElement("div",{id:u,className:h})},o=r?a:i;return o.propTypes={id:Ms.string,className:Ms.string,onChange:Ms.func,onBlur:Ms.func,onFocus:Ms.func,onReady:Ms.func,onEscape:Ms.func,onClick:Ms.func,onLoadError:Ms.func,onLoaderStart:Ms.func,onNetworksChange:Ms.func,onConfirm:Ms.func,onCancel:Ms.func,onShippingAddressChange:Ms.func,onShippingRateChange:Ms.func,onSavedPaymentMethodRemove:Ms.func,onSavedPaymentMethodUpdate:Ms.func,options:Ms.object},o.displayName=n,o.__elementType=e,o},Jl=typeof window>"u",DAe=Pe.createContext(null);DAe.displayName="EmbeddedCheckoutProviderContext";var BAe=function(){var e=uT("calls useStripe()"),r=e.stripe;return r};Ql("auBankAccount",Jl);Ql("card",Jl);Ql("cardNumber",Jl);Ql("cardExpiry",Jl);Ql("cardCvc",Jl);Ql("iban",Jl);var $Ae=Ql("payment",Jl);Ql("expressCheckout",Jl);Ql("paymentRequestButton",Jl);Ql("linkAuthentication",Jl);Ql("address",Jl);Ql("shippingAddress",Jl);Ql("paymentMethodMessaging",Jl);Ql("taxId",Jl);const FAe=vAe("pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W"),UAe=({amount:t,onCancel:e,onSuccess:r})=>{const n=BAe(),i=OAe(),[a,o]=y.useState(null),[l,c]=y.useState(!1),[u,h]=y.useState(!1),p="pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W".startsWith("pk_live")&&window.location.protocol==="http:",m=async g=>{if(g.preventDefault(),!n||!i)return;c(!0);const{error:b}=await n.confirmPayment({elements:i,confirmParams:{return_url:window.location.origin+"/dashboard?donation=success"},redirect:"if_required"});b?(o(b.message),c(!1)):r()};return s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[p?s.jsxs("div",{className:"bg-amber-900/30 border border-amber-500/50 p-6 rounded-xl text-center space-y-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsx("h3",{className:"font-bold text-amber-200",children:"HTTPS Required"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Live Stripe payments require a secure (HTTPS) connection. Please use ",s.jsx("strong",{children:"test keys"})," for local development or deploy to a secure server."]})]}):s.jsxs("div",{className:"relative min-h-[100px]",children:[!u&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 rounded-xl border border-gray-700 animate-pulse text-gray-500 text-sm",children:"Loading Secure Form..."}),s.jsx($Ae,{onReady:()=>h(!0),onLoadError:g=>o(g.error?.message||"Failed to load payment form."),className:"bg-gray-900 p-4 rounded-xl border border-gray-700"})]}),a&&s.jsx("div",{className:"text-red-500 text-sm mt-2 p-3 bg-red-950/30 border border-red-500/30 rounded-lg",children:a}),s.jsxs("div",{className:"flex gap-4 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-xl font-bold transition-all",children:"Change Amount"}),s.jsx("button",{disabled:l||!n,className:"flex-1 px-4 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/25 disabled:opacity-50",children:l?"Processing...":`Donate $${t}`})]})]})},zAe=({isOpen:t,onClose:e})=>{const[r,n]=y.useState("amount"),[i,a]=y.useState(10),[o,l]=y.useState(""),[c,u]=y.useState(!1),[h,p]=y.useState("stripe");y.useEffect(()=>{t||(n("amount"),l(""),u(!1))},[t]);const m=async g=>{a(g),u(!0);try{const b=await Ge.post("/api/payments/create-intent",{amount:g});l(b.clientSecret),n("payment")}catch(b){alert("Error creating payment: "+b.message)}finally{u(!1)}};return t?s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 w-full max-w-lg rounded-3xl flex flex-col max-h-[calc(100vh-4rem)] shadow-2xl animate-fade-in-up overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950/50 flex-shrink-0",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-pink-500 text-2xl",children:""})," Support MTG-Forge"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-grow",children:[r==="amount"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-400 mb-6",children:"Your support helps us keep the servers running and the AI Architect dreaming of new decks."}),s.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[5,10,20].map(g=>s.jsxs("button",{onClick:()=>a(g),className:`py-4 rounded-xl border font-bold transition-all ${i===g?"bg-indigo-600 border-indigo-400 text-white shadow-lg shadow-indigo-500/20 scale-105":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:["$",g]},g))}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),s.jsx("input",{type:"number",value:i,onChange:g=>a(parseFloat(g.target.value)||""),className:"w-full bg-gray-800 border border-gray-700 rounded-xl py-3 pl-8 pr-4 text-white font-bold focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Other amount"})]})]}),s.jsx("button",{onClick:()=>m(i),disabled:c||!i||i<1,className:"w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-indigo-500/30 transition-all transform hover:-translate-y-1 disabled:opacity-50",children:c?"Loading...":"Continue to Payment"})]}),r==="payment"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("div",{className:"flex bg-gray-950 p-1 rounded-xl mb-4",children:["stripe","google","paypal"].map(g=>s.jsx("button",{onClick:()=>p(g),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${h===g?"bg-gray-800 text-white shadow-sm":"text-gray-500 hover:text-gray-400"}`,children:g==="stripe"?"Card":g==="google"?"Google Pay":"PayPal"},g))}),h==="stripe"&&o&&s.jsx(fee,{stripe:FAe,options:{clientSecret:o,appearance:{theme:"night"}},children:s.jsx(UAe,{amount:i,onCancel:()=>n("amount"),onSuccess:()=>n("success")})}),(h==="google"||h==="paypal")&&s.jsxs("div",{className:"text-center py-12 space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-800 rounded-full flex items-center justify-center text-2xl",children:h==="google"?"":""}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-gray-300 capitalize",children:[h," Pay Integration"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Coming incredibly soon! Please use Card for now."})]}),s.jsx("button",{onClick:()=>p("stripe"),className:"text-indigo-400 text-sm hover:underline font-bold",children:"Back to Card Payment"})]})]}),r==="success"&&s.jsxs("div",{className:"text-center space-y-8 animate-fade-in py-8",children:[s.jsxs("div",{className:"w-24 h-24 mx-auto relative",children:[s.jsx("div",{className:"absolute inset-0 bg-pink-500 rounded-full animate-ping opacity-20"}),s.jsx("div",{className:"relative bg-gradient-to-br from-pink-500 to-rose-600 w-24 h-24 rounded-full flex items-center justify-center text-4xl shadow-lg ring-4 ring-pink-500/20",children:""})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-4xl font-black text-white tracking-tight",children:"YOU ARE ABSOLUTELY INCREDIBLE!"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-gray-300 text-lg",children:["From the bottom of our digital hearts, ",s.jsx("span",{className:"text-pink-400 font-bold",children:"THANK YOU!"})]}),s.jsx("p",{className:"text-gray-400 leading-relaxed max-w-xs mx-auto text-sm italic",children:`"Your generosity fuels the spark of creativity. You're not just a donor; you're a patron of the Multiverse."`})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black tracking-[0.2em]",children:"Honorary Title Acquired"}),s.jsx("div",{className:"bg-indigo-500/10 border border-indigo-500/30 py-2 px-4 rounded-full inline-block mx-auto text-indigo-300 font-bold text-sm",children:"Guardian of the Forge"})]}),s.jsx("button",{onClick:e,className:"w-full py-4 bg-gray-800 hover:bg-gray-700 text-white rounded-xl font-bold transition-all border border-gray-700 mt-4",children:"Continue Forging"})]})]}),r!=="success"&&s.jsx("div",{className:"bg-gray-950/80 p-4 border-t border-gray-800 text-center flex-shrink-0",children:s.jsxs("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Payments by Stripe"]})})]})]}):null},pf=({steps:t,isOpen:e,onClose:r,onComplete:n,tourId:i})=>{const[a,o]=y.useState(0),[l,c]=y.useState(null);if(y.useEffect(()=>{e&&o(0)},[e]),y.useEffect(()=>{if(!e||!t[a])return;const g=()=>{const b=t[a],v=document.querySelector(b.target);if(v){const w=v.getBoundingClientRect();c({top:w.top,left:w.left,width:w.width,height:w.height,bottom:w.bottom,right:w.right}),v.scrollIntoView({behavior:"smooth",block:"center"})}else console.warn(`Tour target not found: ${b.target}`)};return g(),window.addEventListener("resize",g),window.addEventListener("scroll",g,!0),()=>{window.removeEventListener("resize",g),window.removeEventListener("scroll",g,!0)}},[e,a,t]),!e||!t[a])return null;const u=t[a],h=a===t.length-1,p=()=>{h?(i&&localStorage.setItem(`tour_seen_${i}`,"true"),n&&n(),r()):o(g=>g+1)},m=()=>{o(g=>Math.max(0,g-1))};return Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] pointer-events-none",children:[l&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:0,left:0,right:0,height:l.top}}),s.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.bottom,left:0,right:0,bottom:0}}),s.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.top,left:0,width:l.left,height:l.height}}),s.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.top,left:l.right,right:0,height:l.height}}),s.jsx("div",{className:"absolute border-2 border-indigo-500 rounded shadow-[0_0_20px_rgba(99,102,241,0.5)] transition-all duration-300 pointer-events-none animate-pulse",style:{top:l.top-4,left:l.left-4,width:l.width+8,height:l.height+8}})]}),l&&s.jsx("div",{className:"absolute pointer-events-auto transition-all duration-300 z-[1001]",style:u.placement==="center"?{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"300px"}:{top:l.bottom+12,left:Math.min(Math.max(10,l.left),window.innerWidth-320),width:"300px"},children:s.jsxs("div",{className:"bg-gray-800 border border-indigo-500/30 rounded-xl shadow-2xl p-4 animate-fade-in-up",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:u.title}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("p",{className:"text-sm text-gray-300 mb-4 leading-relaxed",children:u.content}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["Step ",a+1," of ",t.length]}),s.jsxs("div",{className:"flex gap-2",children:[!h&&s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-xs text-gray-400 hover:text-white font-medium",children:"Skip"}),a>0&&s.jsx("button",{onClick:m,className:"px-3 py-1.5 rounded-lg border border-gray-600 text-gray-300 hover:text-white text-xs font-bold",children:"Back"}),s.jsx("button",{onClick:p,className:"px-4 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-bold shadow-lg shadow-indigo-500/20",children:h?"Finish":"Next"})]})]})]})})]}),document.body)},kv={stats_value:"xs",stats_total:"xs",stats_decks:"xs",audit:"xs",action_browse:"xs",action_wishlist:"xs",identity:"small",quick_actions:"small",community:"medium",action_new_deck:"xs",action_add_cards:"xs",action_tournaments:"xs",system_status:"small",subscription:"small",social_stats:"small",trade_matches:"small",tips:"small",guides:"small",recent_decks:"large",releases:"large"},dT={grid:["stats_value","stats_total","stats_decks","audit","quick_actions","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_browse","action_wishlist","action_tournaments","system_status","subscription","social_stats","trade_matches","tips","guides"]},oN={Default:{layout:dT,sizes:kv},"Decks Focused":{layout:{grid:["action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","identity","recent_decks","community","releases","stats_value","stats_total","audit","action_browse","action_wishlist","system_status","subscription","social_stats","tips","guides"]},sizes:{...kv,action_new_deck:"small",action_add_cards:"small",action_tournaments:"small",recent_decks:"xlarge",community:"large"}},Collector:{layout:{grid:["stats_value","stats_total","audit","action_browse","action_wishlist","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","system_status","subscription","tips","guides","action_log","trade_matches"]},sizes:{...kv,tips:"small",audit:"xs",guides:"small",identity:"xs",releases:"xlarge",community:"medium",stats_decks:"xs",stats_total:"xs",stats_value:"xlarge",recent_decks:"medium",social_stats:"small",subscription:"small",action_browse:"xs",quick_actions:"small",system_status:"small",trade_matches:"small",action_new_deck:"xs",action_wishlist:"xs",action_add_cards:"xs",action_tournaments:"xs"}}},gC=oN,qAe=({id:t,widgetKey:e,editMode:r,data:n,actions:i,containerId:a,size:o,onResize:l,onRemove:c})=>{const{attributes:u,listeners:h,setNodeRef:p,transform:m,transition:g,isDragging:b}=HJ({id:t}),[v,w]=y.useState(null),j=t==="system_status"||t==="releases",I=a==="grid"?{xs:"col-span-2 row-span-1",small:"col-span-4 row-span-3",medium:"col-span-4 row-span-5",large:"col-span-6 row-span-8",xlarge:"col-span-8 row-span-8"}[o||"small"]||"md:col-span-3 md:row-span-2":{xs:"max-w-[150px] mx-auto lg:mx-0",small:"max-w-[300px] mx-auto lg:mx-0",medium:"max-w-md mx-auto lg:mx-0",large:"w-full",xlarge:"w-full"}[o||"small"],O={transform:Yh.Transform.toString(m),transition:v?"none":g,zIndex:b||v?100:"auto",opacity:b?.3:1,width:v?`${v.w}px`:void 0,height:v?`${v.h}px`:void 0},S=(Qv[e]||Qv[t])?.component,T=$=>{$.stopPropagation(),l(t)},M=$=>{$.stopPropagation(),$.preventDefault();const k=$.clientX,L=$.clientY,R=o||"small",V=$.currentTarget.closest(".relative").getBoundingClientRect(),Y=V.width,X=V.height;w({w:Y,h:X});const J=se=>{const ee=se.clientX,q=se.clientY,U=ee-k,W=q-L;w({w:Math.max(150,Y+U),h:Math.max(100,X+W)})},re=se=>{document.removeEventListener("mousemove",J),document.removeEventListener("mouseup",re);const ee=se.clientX,q=se.clientY,U=(ee-k)/100,W=(q-L)/50,Z=le=>le==="xs"?[2,1]:le==="small"?[4,2]:le==="medium"?[4,4]:le==="large"?[6,6]:le==="xlarge"?[8,6]:[4,2],[de,be]=Z(R);let oe=de+(U>.4||U<-.4?Math.round(U):0),ne=be+(W>.4||W<-.4?Math.round(W):0),H=R;ne>=5?oe>=7?H="xlarge":H="large":ne>=2.5?oe>=4?H="medium":H="small":ne>=1.5?H="small":H="xs",w(null),H!==R&&l(t,H)};document.addEventListener("mousemove",J),document.addEventListener("mouseup",re)};return S?s.jsxs("div",{ref:p,style:O,className:`relative h-full ${!b&&!v?"transition-all duration-300":""} ${I}`,children:[r&&s.jsxs("div",{className:`absolute z-50 flex gap-1 origin-top-right transition-all ${o==="xs"?"-top-2 -right-2 scale-[0.7]":"-top-3 -right-3"}`,children:[!j&&s.jsx("div",{onMouseDown:$=>{$.stopPropagation(),c(t)},className:`bg-red-600 rounded-full cursor-pointer hover:bg-red-500 border border-red-400 text-white shadow-lg flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Remove Widget",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{onMouseDown:T,className:`bg-gray-700 cursor-ew-resize rounded-full hover:bg-gray-600 border border-gray-500 text-white shadow-lg font-bold flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"w-5 h-5 text-[9px] p-0.5":"w-6 h-6 text-[10px] p-1.5"}`,title:"Drag horizontal to resize",children:o==="xs"?"XS":o==="xlarge"?"XL":o==="large"?"L":o==="medium"?"M":"S"}),s.jsx("div",{...u,...h,className:`bg-indigo-600 rounded-full cursor-grab active:cursor-grabbing hover:bg-indigo-500 border border-indigo-400 text-white shadow-lg transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Drag to Move",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"})})})]}),s.jsx("div",{className:`h-full overflow-hidden rounded-3xl ${r?"ring-2 ring-indigo-500/30 pointer-events-none":""}`,children:s.jsx(S,{data:n,actions:i,size:o})}),r&&s.jsxs("div",{onMouseDown:M,className:"absolute bottom-1 right-1 w-10 h-10 cursor-nwse-resize z-50 flex items-end justify-end p-1 group/resize hover:scale-110 transition-transform pointer-events-auto",title:"Drag corner to resize",children:[s.jsx("div",{className:"w-5 h-5 border-r-4 border-b-4 border-indigo-500/50 rounded-br-lg group-hover/resize:border-indigo-400"}),s.jsx("div",{className:"absolute inset-0 flex items-end justify-end p-2 opacity-50 group-hover/resize:opacity-100",children:s.jsxs("svg",{className:"w-3 h-3 text-indigo-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[s.jsx("line",{x1:"21",y1:"15",x2:"15",y2:"21"}),s.jsx("line",{x1:"21",y1:"9",x2:"9",y2:"21"})]})})]})]}):null},VAe=()=>{const{currentUser:t,userProfile:e,updateSettings:r}=Or(),{addToast:n}=jn(),{cards:i,refresh:a}=vl(),{decks:o,loading:l}=z0(),[c,u]=y.useState(!1),[h,p]=y.useState(!1),[m,g]=y.useState(!1),[b,v]=y.useState(!1),[w,j]=y.useState(!1),[_,E]=y.useState(!1),[I,O]=y.useState(!1),[B,S]=y.useState(!1),[T,M]=y.useState(dT),[$,k]=y.useState({}),[L,R]=y.useState(null),[V,Y]=y.useState({}),[X,J]=y.useState(!1),[re,se]=y.useState(!1),[ee,q]=y.useState(!1),[U,W]=y.useState({isOpen:!1,code:"",name:""}),[Z,de]=y.useState({isOpen:!1,name:""});y.useRef(null);const[be,oe]=y.useState({top:0,right:0}),[ne,H]=y.useState(!1);y.useEffect(()=>{const qe=()=>{H(!0),I||O(!1)};return window.addEventListener("start-tour",qe),()=>window.removeEventListener("start-tour",qe)},[I]);const le=[{title:"Welcome to Dashboard",content:"This is your command center. Get a quick overview of your collection and decks here.",target:"h1"},{title:"Customize",content:"Toggle this switch to enter Edit Mode. In Edit Mode, you can add, remove, and resize widgets.",target:"#customize-toggle"},{title:"Load & Save",content:"Use this menu to load presets, save your layout, or share it with others.",target:"#layout-menu-btn"}],ye=qe=>qe?.grid&&Array.isArray(qe.grid)?qe:qe?.top||qe?.main||qe?.sidebar?{grid:[...qe.top||[],...qe.main||[],...qe.sidebar||[]]}:dT;y.useEffect(()=>{if(!(!e||I)){if(e.settings?.dashboard_layout){const qe=e.settings.dashboard_layout,rt=ye(qe);M(Ot=>JSON.stringify(Ot)===JSON.stringify(rt)?Ot:rt)}if(e.settings?.dashboard_sizes){const qe=e.settings.dashboard_sizes;k(rt=>JSON.stringify(rt)===JSON.stringify(qe)?rt:qe)}else k(qe=>JSON.stringify(qe)===JSON.stringify(kv)?qe:kv);if(e.settings?.saved_layouts){const qe=e.settings.saved_layouts;Y(rt=>JSON.stringify(rt)===JSON.stringify(qe)?rt:qe)}}},[e,I]);const me=async()=>{E(!0);try{await Ge.post("/api/sync/prices"),await a()}catch(qe){console.error("Sync failed",qe)}finally{E(!1)}},ke=()=>q(!0),Ie=async qe=>{if(!qe)return;const rt={...V||{},[qe]:{layout:T,widgetSizes:$}};await At(rt),n(`Layout "${qe}" saved!`,"success")},ce=qe=>{if(V&&V[qe]){const rt=V[qe].layout;M(ye(rt)),k(V[qe].widgetSizes||{}),n(`Loaded layout: ${qe}`,"success")}else if(gC[qe]){const{layout:rt,sizes:Ot}=gC[qe];M(ye(rt)),Ot&&k(Ot),n(`Loaded preset: ${qe}`,"success")}},Be=()=>{const rt=btoa(JSON.stringify({l:T,s:$}));W({isOpen:!0,code:rt,name:"Current Layout"})},ct=()=>se(!0),Ve=async(qe,rt,Ot)=>{try{const pt=JSON.parse(atob(rt));if(!pt.l)throw new Error("Invalid layout data");const Jt={...V||{},[qe]:{layout:pt.l,widgetSizes:pt.s||{}}};await At(Jt),Ot?(M(pt.l),k(pt.s||{}),n(`Layout "${qe}" imported and loaded!`,"success")):n(`Layout "${qe}" imported successfully!`,"success"),se(!1)}catch(pt){console.error(pt),n("Invalid layout code","error")}},Ne=qe=>de({isOpen:!0,name:qe}),Ye=async()=>{const qe=Z.name;if(!qe)return;const rt={...V};delete rt[qe],await At(rt),n("Layout deleted","success"),de({isOpen:!1,name:""})},St=async qe=>{if(!window.confirm(`Overwrite "${qe}" with current layout?`))return;const rt={...V,[qe]:{layout:T,widgetSizes:$}};Y(rt);try{await r({saved_layouts:rt}),n("Layout updated","success")}catch{n("Failed to update layout","error")}},Vt=y.useMemo(()=>{if(!i||!o)return{totalCards:0,uniqueDecks:0,value:0,topColor:null};const qe=new Set(i.map(qt=>qt.scryfall_id||qt.id)),rt=i.filter(qt=>!qt.is_wishlist),Ot=i.filter(qt=>qt.is_wishlist);let pt=rt.reduce((qt,ur)=>qt+(ur.count||1),0),Jt=Ot.reduce((qt,ur)=>qt+(ur.count||1),0),Kt=pt;o.forEach(qt=>{if(qt.commander){const ur=qt.commander.id||qt.commander.scryfall_id;ur&&!qe.has(ur)&&(pt++,qe.add(ur))}if(qt.commander_partner){const ur=qt.commander_partner.id||qt.commander_partner.scryfall_id;ur&&!qe.has(ur)&&(pt++,qe.add(ur))}});const rr=i.reduce((qt,ur)=>{const Nt=(ur.finish==="foil"||ur.is_foil||ur.val_foil)&&ur.prices?.usd_foil||ur.prices?.usd,Pt=parseFloat(Nt||0);return qt+Pt*(ur.count||1)},0),Br={};i.forEach(qt=>{const ur=qt.color_identity||[],Re={W:0,U:1,B:2,R:3,G:4},Nt=ur.filter(It=>Re[It]!==void 0).sort((It,Zt)=>Re[It]-Re[Zt]).join(""),Pt=Nt.length===0?"C":Nt;Br[Pt]=(Br[Pt]||0)+(qt.count||1)});const zt=Object.entries(Br);let Wt=dj("C");if(zt.length>0){const[qt]=zt.reduce((ur,Re)=>Re[1]>ur[1]?Re:ur);Wt=dj(qt)}return{totalCards:pt,collectionCount:Kt,wishlistCount:Jt,uniqueDecks:o.length,value:rr.toLocaleString("en-US",{style:"currency",currency:"USD"}),topColor:Wt}},[i,o]),Lt=sL(Gx(dk),Gx(uk,{coordinateGetter:WJ})),at=qe=>R(qe.active.id),gt=qe=>{const{active:rt,over:Ot}=qe;if(!Ot||rt.id===Ot.id)return;if(rt.data?.current?.fromLibrary)M(Jt=>({...Jt,grid:[...Jt.grid||[],rt.id]}));else{const Jt=T.grid.indexOf(rt.id),Kt=T.grid.indexOf(Ot.id);Jt!==-1&&Kt!==-1&&Jt!==Kt&&M(rr=>({...rr,grid:pk(rr.grid,Jt,Kt)}))}},vt=qe=>{R(null)},ft=(qe,rt)=>{k(Ot=>{if(rt)return{...Ot,[qe]:rt};const pt=Ot[qe]||"small",Jt=pt==="xs"?"small":pt==="small"?"medium":pt==="medium"?"large":pt==="large"?"xlarge":"xs";return{...Ot,[qe]:Jt}})},ot=qe=>{M(rt=>({...rt,grid:rt.grid.filter(Ot=>Ot!==qe)})),n("Widget removed from dashboard","success")},ut=async qe=>{if(e?.id)try{await r({dashboard_layout:qe,dashboard_sizes:$}),n("Layout saved","success")}catch(rt){console.error(rt),n("Failed to save layout","error")}},At=async qe=>{Y(qe);try{await r({saved_layouts:qe})}catch(rt){console.error("Failed to save saved_layouts",rt),n("Failed to sync layouts","error")}},Fe=()=>{I&&(ut(T),S(!1)),O(!I)},Ut=y.useMemo(()=>({stats:Vt,decks:o,decksLoading:l,collection:i,userProfile:e,syncLoading:_}),[Vt,o,l,i,e,_]),jt=y.useMemo(()=>({handleSyncPrices:me,setIsIssueModalOpen:u,setIsDonationModalOpen:j,setShowBinderGuide:p,setShowPodGuide:g,setShowAuditGuide:v}),[me]);return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 space-y-8 animate-fade-in w-full",children:[s.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/30 rounded-xl p-4 flex items-start gap-3 backdrop-blur-md",children:[s.jsx("span",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-indigo-400 text-sm",children:"Looking for Default Layout suggestions!"}),s.jsx("p",{className:"text-xs text-gray-300 mt-1 leading-relaxed",children:"Layouts are awkward atm to promote suggestions. When editing, click the share icon up at the top and send me your suggestion with a description of what it is."})]})]}),s.jsxs("div",{className:`relative z-50 flex flex-col md:flex-row gap-4 ${I?"justify-center items-center":"justify-between items-end"}`,children:[s.jsxs("div",{className:`text-center md:text-left ${I?"opacity-50 scale-90 transition-all":""}`,children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"Dashboard"}),s.jsxs("p",{className:"text-gray-400",children:["Welcome back, ",s.jsx("span",{className:"text-indigo-400 font-bold",children:t?t.displayName||t.email:"Guest"}),"."]})]}),s.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-2 rounded-xl backdrop-blur-md border border-white/5",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("button",{id:"layout-menu-btn",onClick:()=>J(!X),className:"bg-gray-800 text-white text-xs rounded-lg border border-gray-700 px-3 py-1.5 hover:bg-gray-700 transition-colors flex items-center gap-2",children:[s.jsx("span",{children:"Load Layout..."}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40 cursor-default",onClick:()=>J(!1)}),s.jsxs("div",{className:"absolute top-full right-0 mt-2 w-72 bg-gray-900 border border-indigo-500/30 rounded-xl shadow-2xl z-[100] overflow-hidden flex flex-col animate-fade-in-down",children:[s.jsxs("div",{className:"p-2 border-b border-white/5 bg-gray-950/50",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1",children:"Presets"}),Object.keys(gC).map(qe=>s.jsx("button",{onClick:()=>{ce(qe),J(!1)},className:"w-full text-left px-2 py-1.5 text-sm text-gray-300 hover:bg-white/5 hover:text-white rounded-lg transition-colors",children:qe},qe))]}),s.jsxs("div",{className:"p-2 flex-grow overflow-y-auto max-h-[300px] bg-gray-900",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1 flex justify-between items-center",children:s.jsx("span",{children:"My Layouts"})}),Object.keys(V).length===0?s.jsx("div",{className:"px-2 py-2 text-xs text-gray-600 italic",children:"No saved layouts"}):Object.keys(V).map(qe=>s.jsxs("div",{className:"flex items-center gap-1 group/item rounded-lg hover:bg-white/5 p-1 mb-0.5",children:[s.jsx("button",{onClick:()=>{ce(qe),J(!1)},className:"flex-grow text-left px-1 text-sm text-gray-300 group-hover/item:text-white truncate transition-colors font-medium",children:qe}),s.jsx("button",{onClick:()=>St(qe),className:"p-1.5 text-gray-600 hover:text-green-400 opacity-0 group-hover/item:opacity-100 transition-all rounded hover:bg-white/5",title:"Overwrite with current",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})}),s.jsx("button",{onClick:()=>Ne(qe),className:"p-1.5 text-gray-600 hover:text-red-400 opacity-0 group-hover/item:opacity-100 transition-all rounded hover:bg-white/5",title:"Delete",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},qe))]}),s.jsxs("div",{className:"p-2 border-t border-white/5 bg-gray-950/50 grid grid-cols-3 gap-2",children:[s.jsxs("button",{onClick:()=>{ct(),J(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Import",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import"]}),s.jsxs("button",{onClick:()=>{ke(),J(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Save As",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Save New"]}),s.jsxs("button",{onClick:()=>{Be(),J(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Share (Copy Code)",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]})]})]})]}),s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),I&&s.jsx("div",{className:"flex items-center gap-2 mr-2 border-r border-white/10 pr-4",children:s.jsx("button",{onClick:()=>S(!B),className:`p-1.5 rounded border transition-all ${I&&!B?"bg-indigo-600/20 text-indigo-400 border-indigo-500/50 animate-bounce shadow-lg shadow-indigo-500/20":"hover:bg-indigo-600/20 text-indigo-400 hover:text-indigo-300 border-indigo-500/30"}`,title:"Forge Library",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})}),s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${I?"text-indigo-400":"text-gray-500"}`,children:I?"Done":"Customize"}),s.jsx(Qve,{checked:I,onChange:Fe,className:`${I?"bg-indigo-600":"bg-gray-700"} relative inline-flex h-6 w-11 items-center rounded-full transition-colors`,children:s.jsx("span",{className:`${I?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})}),s.jsx("div",{id:"customize-toggle",className:"absolute inset-0 pointer-events-none"})]})]}),s.jsxs(lL,{sensors:Lt,collisionDetection:yJ,onDragStart:at,onDragOver:gt,onDragEnd:vt,children:[s.jsx(tke,{layout:T,isOpen:B&&I,onClose:()=>S(!1),onAddWidget:qe=>{M(rt=>({...rt,grid:[...rt.grid||[],qe]}))},onClearDashboard:()=>{M({grid:[]})}}),s.jsx(qJ,{items:T.grid||[],strategy:mk,id:"grid",children:s.jsxs("div",{className:"relative w-full min-h-[600px]",children:[(!T.grid||T.grid.length===0)&&s.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none z-20",children:s.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border border-indigo-500/30 p-8 rounded-3xl text-center shadow-2xl max-w-lg pointer-events-auto",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Dashboard is Empty"}),s.jsx("p",{className:"text-gray-400 mb-8",children:"Start by loading a preset layout or customize it from scratch."}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsxs("button",{onClick:()=>ce("Starter Standard"),className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/20 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Load Preset"]}),s.jsxs("button",{onClick:()=>{O(!0),S(!0)},className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white border border-gray-600 rounded-xl font-bold transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Widgets"]})]})]})}),I&&s.jsx("div",{className:"absolute inset-0 grid grid-cols-12 gap-3 pointer-events-none z-0 select-none",children:Array.from({length:12}).map((qe,rt)=>s.jsx("div",{className:"h-full border-x border-dashed border-indigo-500/10 bg-indigo-500/5 flex items-start justify-center pt-2 -mt-6",children:s.jsxs("span",{className:"text-[9px] font-black text-indigo-400/50 uppercase tracking-wider",children:["Col ",rt+1]})},rt))}),s.jsx("div",{className:"grid grid-cols-12 auto-rows-[50px] gap-3 relative z-10 w-full",style:{width:"100%",minWidth:"100%",minHeight:"600px",gridTemplateColumns:"repeat(12, minmax(0, 1fr))",gridAutoRows:"75px",gap:"12px",boxSizing:"border-box"},children:T.grid.map(qe=>s.jsx(qAe,{id:qe,widgetKey:qe,containerId:"grid",editMode:I,data:Ut,actions:jt,onRemove:ot,onResize:ft,size:$[qe]||"medium"},qe))})]})}),s.jsx(pf,{isOpen:ne,onClose:()=>H(!1),steps:le,tourId:"dashboard_tour"}),s.jsx(cL,{dropAnimation:{sideEffects:FJ({styles:{active:{opacity:"0.5"}}})},children:L?(()=>{const qe=Qv[L],rt=qe?.component,Ot=$[L]||"small",pt={xs:"w-[400px] h-[50px]",small:"w-[400px] h-[200px]",medium:"w-[600px] h-[200px]",large:"w-[800px] h-[400px]",xlarge:"w-full max-w-7xl h-[400px]"}[Ot]||"w-[400px] h-[200px]";return s.jsx("div",{className:`${pt} overflow-hidden rounded-3xl shadow-2xl ring-2 ring-indigo-500/50 cursor-grabbing bg-gray-900 z-50`,children:rt?s.jsx("div",{className:"h-full pointer-events-none p-1",children:s.jsx(rt,{data:Ut,actions:jt,size:Ot})}):s.jsx("div",{className:"h-full flex items-center justify-center p-4 bg-gray-800 text-white font-bold border border-gray-700 rounded-3xl",children:qe?.title||"Widget"})})})():null})]})]}),s.jsx(lAe,{isOpen:c,onClose:()=>u(!1)}),s.jsx(zAe,{isOpen:w,onClose:()=>j(!1)}),s.jsx(eL,{isOpen:h,onClose:()=>p(!1)}),s.jsx(tJ,{isOpen:m,onClose:()=>g(!1)}),s.jsx(tL,{isOpen:b,onClose:()=>v(!1)}),s.jsx(rke,{isOpen:re,onClose:()=>se(!1),onImport:Ve}),s.jsx(ske,{isOpen:ee,onClose:()=>q(!1),onSave:Ie}),s.jsx(nke,{isOpen:U.isOpen,onClose:()=>W({...U,isOpen:!1}),layoutCode:U.code,layoutName:U.name}),s.jsx(eZ,{isOpen:Z.isOpen,onClose:()=>de({isOpen:!1,name:""}),onConfirm:Ye,title:"Delete Layout",message:`Are you sure you want to delete the layout "${Z.name}"? This cannot be undone.`,targetName:Z.name})]})},mee=[{name:"Limits",items:[{label:"Collection size",type:"limit",key:"collection"},{label:"Wishlist size",type:"limit",key:"wishlist"},{label:"Deck count",type:"limit",key:"decks"},{label:"Pod Count",type:"limit",key:"pods"}]},{name:"Collection",items:[{label:"Organization customization",type:"static",value:!0},{label:"Tags",type:"static",value:!0},{label:"Bulk Import",type:"static",value:!0},{label:"Manual Price Sync",type:"static",value:!0},{label:"Smart Binders",type:"feature",key:"smartBinders"},{label:"Binders",type:"feature",key:"binders"},{label:"Collection Audit",type:"feature",key:"collectionAudit"},{label:"Snap Version (Scanner)",type:"feature",key:"snapScan"},{label:"Quick Scan (Batch)",type:"feature",key:"batchScan"}]},{name:"Wishlist",items:[{label:"Mass Deletion",type:"static",value:!0},{label:"Precon Addition",type:"static",value:!0}]},{name:"Decks",items:[{label:"Public/Private View",type:"static",value:!0},{label:"Deck Stats",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0},{label:"Mockup Deck",type:"feature",key:"mockupDeck"},{label:"AI Strategy",type:"feature",key:"aiStrategy"},{label:"Deck Doctor",type:"feature",key:"deckDoctor"},{label:"Deck Suggestions",type:"feature",key:"deckSuggestions"},{label:"Deck Audit",type:"feature",key:"deckAudit"},{label:"Shared edit",type:"feature",key:"sharedEdit"}]},{name:"Precons",items:[{label:"Add to collection",type:"static",value:!0},{label:"Add to wishlist",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0}]},{name:"Sets",items:[{label:"Quick Add",type:"static",value:!0},{label:"Set Audit",type:"feature",key:"setAudit"}]},{name:"AI",items:[{label:"Chatbot",type:"static",value:!0},{label:"Default Oracle",type:"static",value:!0},{label:"Custom AI Persona",type:"feature",key:"customAiPersona"}]},{name:"Settings",items:[{label:"Collection Backup",type:"feature",key:"collectionBackup"},{label:"Deck Backup",type:"feature",key:"deckBackup"},{label:"Pods / Linking",type:"limit_check",key:"pods"}]}],HAe=(t,e)=>{const r=Vs[t],n=e?Vs[e]:null;if(!n)return t===nr.FREE?{limits:[{label:`Collection: ${r.limits.collection}`,type:"limit"},{label:`Wishlist: ${r.limits.wishlist}`,type:"limit"},{label:`Decks: ${r.limits.decks}`,type:"limit"},{label:"Pods (Shared Accounts): 0",type:"limit"}],features:[{label:"AI Chatbot",type:"feature"}]}:{limits:[],features:[]};const i=[],a=[];r.limits.collection>n.limits.collection&&i.push({label:`Collection: ${r.limits.collection===1/0?"Unlimited":r.limits.collection}`,type:"limit"}),r.limits.wishlist>n.limits.wishlist&&i.push({label:`Wishlist: ${r.limits.wishlist===1/0?"Unlimited":r.limits.wishlist}`,type:"limit"}),r.limits.decks>n.limits.decks&&i.push({label:`Decks: ${r.limits.decks===1/0?"Unlimited":r.limits.decks}`,type:"limit"});const o=t===nr.TIER_3,l=[nr.TIER_1,nr.TIER_2].includes(t);return(r.limits.pods>n.limits.pods||l)&&i.push({label:`Pods (Shared Accounts): ${r.limits.pods===1/0?"Unlimited":r.limits.pods}`,type:"limit",bold:o,tooltip:"Pods allow you to link accounts (friends/family) to share your collection and deck building tools."}),Object.keys(r.features).forEach(c=>{if(r.features[c]&&!n.features[c]){const u=mee.flatMap(h=>h.items).find(h=>h.key===c);a.push({label:u?u.label:c.replace(/([A-Z])/g," $1").trim(),type:"feature"})}}),{limits:i,features:a}},pF=({label:t,check:e,highlight:r,bold:n,tooltip:i})=>s.jsxs("div",{className:`flex items-start text-sm ${e?r?"text-white font-medium":"text-gray-300":"text-gray-500"} ${n?"font-bold":""}`,title:i,children:[e?s.jsx(Od,{className:`w-4 h-4 mr-2 mt-0.5 flex-shrink-0 ${r?"text-purple-400":"text-green-500"}`}):s.jsx(Fd,{className:"w-4 h-4 mr-2 text-red-900/50 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:t})]}),TL=({billingInterval:t,setBillingInterval:e,onSubscribe:r,isLoading:n,currentTier:i,showIntervalSelector:a=!0})=>{const o=Object.values(nr),l=c=>{const u=Vs[c];return!u.prices.monthly&&!u.prices.biannual&&!u.prices.yearly?"Free":{[nr.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[nr.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[nr.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[nr.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[nr.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[c]?.[t]||"Free"};return s.jsxs("div",{className:"w-full",children:[a&&s.jsx("div",{className:"flex justify-center mb-8",children:s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(c=>s.jsx("button",{onClick:()=>e(c),className:`px-4 py-2 rounded-lg transition-all capitalize ${t===c?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:c==="biannual"?"6 Months":c},c))})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:o.map((c,u)=>{const h=Vs[c],p=i===c,m=u>0?o[u-1]:null,{limits:g,features:b}=HAe(c,m);return s.jsxs("div",{className:`relative flex flex-col p-5 rounded-2xl border ${p?"border-purple-500 shadow-[0_0_20px_rgba(168,85,247,0.3)]":"border-gray-700"} bg-gray-800/50 backdrop-blur-sm hover:border-purple-500/50 transition-all duration-300`,children:[p&&s.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-white text-[10px] px-2 py-0.5 rounded-full uppercase tracking-wider font-bold shadow-lg z-10",children:"Current"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-100",children:h.name}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-2xl font-bold text-white",children:l(c)}),s.jsxs("span",{className:"text-sm text-gray-500",children:["/",t==="monthly"?"mo":t==="biannual"?"6mo":"yr"]})]}),s.jsx("p",{className:"text-sm text-gray-400 mt-2 min-h-[48px]",children:h.description})]}),s.jsx("button",{onClick:()=>r(c),disabled:n||p,className:`w-full py-2 rounded-lg font-bold text-sm mb-6 transition-all ${p?"bg-gray-700 cursor-default text-gray-400":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white shadow-lg"}`,children:n?"...":p?"Active":c===nr.FREE?"Select":"Subscribe"}),s.jsxs("div",{className:"space-y-3 flex-grow",children:[(g.length>0||b.length>0)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] uppercase tracking-wider text-purple-400 font-bold mb-2 border-b border-purple-500/30 pb-1",children:c===nr.FREE?"Includes:":"Adds / Increases:"}),g.map((v,w)=>s.jsx(pF,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`limit-${w}`)),g.length>0&&b.length>0&&s.jsx("div",{className:"my-3 border-t border-gray-700"}),b.map((v,w)=>s.jsx(pF,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`feat-${w}`))]}),g.length===0&&b.length===0&&c!==nr.FREE&&s.jsx("p",{className:"text-xs text-gray-500 italic",children:"Includes all previous features"})]})]},c)})})]})},WAe=()=>{const{currentUser:t,userProfile:e}=Or(),r=xn(),{addToast:n}=jn(),[i,a]=y.useState("monthly"),[o,l]=y.useState(!1),[c,u]=y.useState("cards"),[h,p]=y.useState(null),[m,g]=y.useState(null),b=async E=>{if(!t){r("/login");return}if(E===nr.FREE){n("You are already on the free tier.","info");return}l(!0);try{const I=await Ge.post("/api/payments/create-checkout-session",{tierId:E,interval:i});I.url&&(window.location.href=I.url)}catch(I){console.error("Subscription error:",I),n("Failed to start checkout. Please try again.","error")}finally{l(!1)}},v=E=>{const I=Vs[E];return!I.prices.monthly&&!I.prices.biannual&&!I.prices.yearly?"Free":{[nr.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[nr.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[nr.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[nr.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[nr.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[E]?.[i]||"Free"},w=()=>i==="biannual"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"1 Month Free"}):i==="yearly"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"2 Months Free"}):null,j=(E,I)=>{const O=Vs[I];if(E.type==="static")return s.jsx(Od,{className:"w-5 h-5 text-green-500 mx-auto"});if(E.type==="limit"){const B=O.limits[E.key];return B===1/0?"Unlimited":B}if(E.type==="limit_check"){const B=O.limits[E.key];return B>0||B===1/0?s.jsx(Od,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Fd,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"})}return E.type==="feature"?O.features[E.key]?s.jsx(Od,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Fd,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"}):"-"},_=Object.values(nr);return s.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8",children:[s.jsxs("div",{className:"max-w-[1800px] mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto mb-8",children:"Comparing plans to find the perfect fit for your magic journey."}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6",children:[s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(E=>s.jsx("button",{onClick:()=>a(E),className:`px-4 py-2 rounded-lg transition-all capitalize ${i===E?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:E==="biannual"?"6 Months":E},E))}),s.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:[s.jsxs("button",{onClick:()=>u("cards"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="cards"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(o2e,{className:"w-4 h-4"})," Cards"]}),s.jsxs("button",{onClick:()=>u("table"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="table"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(f2e,{className:"w-4 h-4"})," Compare All"]})]})]}),s.jsx("div",{className:"mt-4 h-8",children:w()})]}),c==="cards"?s.jsx(TL,{billingInterval:i,setBillingInterval:a,onSubscribe:b,isLoading:o,currentTier:e?.subscription_tier}):s.jsx("div",{className:"overflow-x-auto pb-12 pt-12 animate-in fade-in duration-300",children:s.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-4 w-[250px] sticky left-0 z-20 bg-gray-900 border-b border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]",children:s.jsx("div",{className:"text-xl font-bold text-gray-500",children:"Features"})}),_.map((E,I)=>{const O=Vs[E],B=e?.subscription_tier===E,S=m===I;return s.jsxs("th",{className:`p-4 min-w-[180px] text-center relative transition-colors duration-300 border-b border-gray-800
                                                ${S?"bg-gray-800/80":"bg-gray-900"}
                                                ${B?"ring-2 ring-purple-500 ring-inset bg-purple-900/10":""}
                                            `,onMouseEnter:()=>g(I),onMouseLeave:()=>g(null),children:[B&&s.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Current"}),s.jsx("h3",{className:`text-xl font-bold mb-1 ${B?"text-purple-300":"text-gray-200"}`,children:O.name}),s.jsxs("div",{className:"text-2xl font-bold mb-2",children:[v(E),s.jsxs("span",{className:"text-xs text-gray-500 font-normal",children:["/",i==="monthly"?"mo":i==="biannual"?"6mo":"yr"]})]}),s.jsx("button",{onClick:()=>b(E),disabled:o||B,className:`w-full py-2 rounded text-sm font-bold transition-all ${B?"bg-gray-800 text-gray-500 cursor-default":"bg-purple-600 hover:bg-purple-500 text-white shadow-lg shadow-purple-900/20"}`,children:B?"Active":E===nr.FREE?"Default":"Subscribe"})]},E)})]})}),s.jsx("tbody",{children:mee.map((E,I)=>s.jsx(Pe.Fragment,{children:E.items.map((O,B)=>{const S=`${I}-${B}`,T=h===S;return s.jsxs("tr",{className:`transition-colors duration-200 border-b border-gray-800/50
                                                    ${T?"bg-gray-800/60":"hover:bg-gray-800/30"}
                                                `,onMouseEnter:()=>p(S),onMouseLeave:()=>p(null),children:[s.jsx("td",{className:`p-3 pl-4 text-sm font-medium text-gray-300 sticky left-0 z-10
                                                    bg-gray-900 transition-colors duration-200 border-r border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]
                                                    ${T?"text-white bg-gray-800":""}
                                                `,children:E.name==="Limits"||E.name==="Settings"||E.name==="AI"?O.label:`${E.name} - ${O.label}`}),_.map((M,$)=>{const k=m===$,L=T&&k;return s.jsx("td",{className:`p-3 text-center text-sm transition-colors duration-200
                                                                ${k?"bg-gray-800/40":""}
                                                                ${L?"bg-purple-500/10":""}
                                                            `,onMouseEnter:()=>g($),onMouseLeave:()=>g(null),children:j(O,M)},M)})]},O.label)})},E.name))})]})})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"* Prices and limits subject to change. VAT may apply."})})]})},GAe=()=>{const[t,e]=y.useState(!0),[r,n]=y.useState(""),[i,a]=y.useState(""),[o,l]=y.useState(""),[c,u]=y.useState(""),[h,p]=y.useState(""),[m,g]=y.useState(""),[b,v]=y.useState(!1),[w,j]=y.useState(!1),[_,E]=y.useState(""),{login:I,signup:O,loginWithGoogle:B,resetPassword:S}=Or(),T=xn(),M=async k=>{k.preventDefault();try{if(E(""),b){await S(r),j(!0);return}if(t)await I(r,i),T("/dashboard");else{if(i!==o)return E("Passwords do not match");if(i.length<6)return E("Password must be at least 6 characters");await O(r,i,{username:c,first_name:h,last_name:m}),T("/onboarding")}}catch(L){E("Failed to "+(t?"log in":"sign up")+": "+L.message)}},$=async()=>{try{E(""),await B(),T("/dashboard")}catch(k){E("Failed to log in with Google: "+k.message)}};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8 relative",children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-50"})}),s.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10 bg-black/60 p-10 rounded-2xl backdrop-blur-md border border-white/10 shadow-2xl",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:b?"Reset Password":t?"Sign in to MTG-Forge":"Create an Account"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-400",children:b?"Enter your email to receive a reset link":t?"Access your collection and decks anywhere":"Start your journey with MTG-Forge"})]}),w&&s.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-100 p-3 rounded text-sm text-center",children:"Reset link sent! Check your inbox."}),_&&s.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 p-3 rounded text-sm text-center",children:_}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:M,children:[s.jsxs("div",{className:"space-y-4",children:[!t&&!b&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"First Name",value:h,onChange:k=>p(k.target.value)})}),s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Last Name",value:m,onChange:k=>g(k.target.value)})})]}),!t&&!b&&s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Username",value:c,onChange:k=>u(k.target.value)})}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:r,onChange:k=>n(k.target.value)})]}),!b&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:t?"current-password":"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:i,onChange:k=>a(k.target.value)})]}),!t&&!b&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),s.jsx("input",{id:"confirm-password",name:"confirmConnectPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:o,onChange:k=>l(k.target.value)})]})]}),t&&!b&&s.jsx("div",{className:"flex items-center justify-end",children:s.jsx("button",{type:"button",onClick:()=>v(!0),className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot your password?"})}),s.jsx("div",{children:s.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:b?"Send Reset Link":t?"Sign in with Email":"Sign Up with Email"})})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"button",onClick:()=>{b?(v(!1),j(!1)):e(!t),E("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:b?"Back to Sign In":t?"Don't have an account? Sign Up":"Already have an account? Sign In"})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-transparent text-gray-400 uppercase font-bold bg-[#1a1c23]",children:"Or continue with"})})]}),s.jsxs("button",{onClick:$,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),s.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),s.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),s.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),t?"Sign in with Google":"Sign up with Google"]})]})]})},Ak=0,H0=1,wb=2,gee=4;function mF(t){return()=>t}function KAe(t){t()}function vj(t,e){return r=>t(e(r))}function gF(t,e){return()=>t(e)}function YAe(t,e){return r=>t(e,r)}function IL(t){return t!==void 0}function XAe(...t){return()=>{t.map(KAe)}}function r2(){}function Tk(t,e){return e(t),t}function QAe(t,e){return e(t)}function ai(...t){return t}function as(t,e){return t(H0,e)}function cn(t,e){t(Ak,e)}function LL(t){t(wb)}function mi(t){return t(gee)}function jr(t,e){return as(t,YAe(e,Ak))}function Uu(t,e){const r=t(H0,n=>{r(),e(n)});return r}function xF(t){let e,r;return n=>i=>{e=i,r&&clearTimeout(r),r=setTimeout(()=>{n(e)},t)}}function xee(t,e){return t===e}function ri(t=xee){let e;return r=>n=>{t(e,n)||(e=n,r(n))}}function Ur(t){return e=>r=>{t(r)&&e(r)}}function ar(t){return e=>vj(e,t)}function jd(t){return e=>()=>{e(t)}}function Dt(t,...e){const r=JAe(...e);return((n,i)=>{switch(n){case wb:LL(t);return;case H0:return as(t,r(i))}})}function Ed(t,e){return r=>n=>{r(e=t(e,n))}}function gm(t){return e=>r=>{t>0?t--:e(r)}}function Mh(t){let e=null,r;return n=>i=>{e=i,!r&&(r=setTimeout(()=>{r=void 0,n(e)},t))}}function fn(...t){const e=new Array(t.length);let r=0,n=null;const i=Math.pow(2,t.length)-1;return t.forEach((a,o)=>{const l=Math.pow(2,o);as(a,c=>{const u=r;r=r|l,e[o]=c,u!==i&&r===i&&n&&(n(),n=null)})}),a=>o=>{const l=()=>{a([o].concat(e))};r===i?l():n=l}}function JAe(...t){return e=>t.reduceRight(QAe,e)}function ZAe(t){let e,r;const n=()=>e?.();return function(i,a){switch(i){case H0:return a?r===a?void 0:(n(),r=a,e=as(t,a),e):(n(),r2);case wb:n(),r=null;return}}}function Gt(t){let e=t;const r=Pn();return((n,i)=>{switch(n){case Ak:e=i;break;case H0:{i(e);break}case gee:return e}return r(n,i)})}function Jo(t,e){return Tk(Gt(e),r=>jr(t,r))}function Pn(){const t=[];return((e,r)=>{switch(e){case Ak:t.slice().forEach(n=>{n(r)});return;case wb:t.splice(0,t.length);return;case H0:return t.push(r),()=>{const n=t.indexOf(r);n>-1&&t.splice(n,1)}}})}function vc(t){return Tk(Pn(),e=>jr(t,e))}function Qn(t,e=[],{singleton:r}={singleton:!0}){return{constructor:t,dependencies:e,id:eTe(),singleton:r}}const eTe=()=>Symbol();function tTe(t){const e=new Map,r=({constructor:n,dependencies:i,id:a,singleton:o})=>{if(o&&e.has(a))return e.get(a);const l=n(i.map(c=>r(c)));return o&&e.set(a,l),l};return r(t)}function ga(...t){const e=Pn(),r=new Array(t.length);let n=0;const i=Math.pow(2,t.length)-1;return t.forEach((a,o)=>{const l=Math.pow(2,o);as(a,c=>{r[o]=c,n=n|l,n===i&&cn(e,r)})}),function(a,o){switch(a){case wb:{LL(e);return}case H0:return n===i&&o(r),as(e,o)}}}function Fr(t,e=xee){return Dt(t,ri(e))}function hT(...t){return function(e,r){switch(e){case wb:return;case H0:return XAe(...t.map(n=>as(n,r)))}}}var wc=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(wc||{});const rTe={0:"debug",3:"error",1:"log",2:"warn"},nTe=()=>typeof globalThis>"u"?window:globalThis,W0=Qn(()=>{const t=Gt(3);return{log:Gt((e,r,n=1)=>{var i;const a=(i=nTe().VIRTUOSO_LOG_LEVEL)!=null?i:mi(t);n>=a&&console[rTe[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,r)}),logLevel:t}},[],{singleton:!0});function xm(t,e,r){return PL(t,e,r).callbackRef}function PL(t,e,r){const n=Pe.useRef(null);let i=o=>{};const a=Pe.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const l=()=>{const c=o[0].target;c.offsetParent!==null&&t(c)};r?l():requestAnimationFrame(l)}):null,[t,r]);return i=o=>{o&&e?(a?.observe(o),n.current=o):(n.current&&a?.unobserve(n.current),n.current=null)},{callbackRef:i,ref:n}}function sTe(t,e,r,n,i,a,o,l,c){const u=Pe.useCallback(h=>{const p=iTe(h.children,e,"offsetHeight",i);let m=h.parentElement;for(;!m.dataset.virtuosoScroller;)m=m.parentElement;const g=m.lastElementChild.dataset.viewportType==="window";let b;g&&(b=m.ownerDocument.defaultView);const v=o?o.scrollTop:g?b.scrollY||b.document.documentElement.scrollTop:m.scrollTop,w=o?o.scrollHeight:g?b.document.documentElement.scrollHeight:m.scrollHeight,j=o?o.offsetHeight:g?b.innerHeight:m.offsetHeight;n({scrollHeight:w,scrollTop:Math.max(v,0),viewportHeight:j}),p!==null&&t(p)},[t,e,i,a,o,n,l]);return PL(u,r,c)}function iTe(t,e,r,n){const i=t.length;if(i===0)return null;const a=[];for(let o=0;o<i;o++){const l=t.item(o);if(l.dataset.index===void 0)continue;const c=parseInt(l.dataset.index),u=parseFloat(l.dataset.knownSize),h=e(l,r);if(h===0&&n("Zero-sized element, this should not happen",{child:l},wc.ERROR),h===u)continue;const p=a[a.length-1];a.length===0||p.size!==h||p.endIndex!==c-1?a.push({endIndex:c,size:h,startIndex:c}):a[a.length-1].endIndex++}return a}function bee(t,e,r){const n=Pe.useRef(null),i=Pe.useCallback(c=>{if(!(c!=null&&c.offsetParent))return;const u=c.getBoundingClientRect(),h=u.width;let p,m;if(e){const g=e.getBoundingClientRect(),b=u.top-g.top;m=g.height-Math.max(0,b),p=b+e.scrollTop}else{const g=o.current.ownerDocument.defaultView;m=g.innerHeight-Math.max(0,u.top),p=u.top+g.scrollY}n.current={offsetTop:p,visibleHeight:m,visibleWidth:h},t(n.current)},[t,e]),{callbackRef:a,ref:o}=PL(i,!0,r),l=Pe.useCallback(()=>{i(o.current)},[i,o]);return Pe.useEffect(()=>{var c;if(e){e.addEventListener("scroll",l);const u=new ResizeObserver(()=>{requestAnimationFrame(l)});return u.observe(e),()=>{e.removeEventListener("scroll",l),u.unobserve(e)}}else{const u=(c=o.current)==null?void 0:c.ownerDocument.defaultView;return u?.addEventListener("scroll",l),u?.addEventListener("resize",l),()=>{u?.removeEventListener("scroll",l),u?.removeEventListener("resize",l)}}},[l,e,o]),a}const jl=Qn(()=>{const t=Pn(),e=Pn(),r=Gt(0),n=Pn(),i=Gt(0),a=Pn(),o=Pn(),l=Gt(0),c=Gt(0),u=Gt(0),h=Gt(0),p=Pn(),m=Pn(),g=Gt(!1),b=Gt(!1),v=Gt(!1);return jr(Dt(t,ar(({scrollTop:w})=>w)),e),jr(Dt(t,ar(({scrollHeight:w})=>w)),o),jr(e,i),{deviation:r,fixedFooterHeight:u,fixedHeaderHeight:c,footerHeight:h,headerHeight:l,horizontalDirection:b,scrollBy:m,scrollContainerState:t,scrollHeight:o,scrollingInProgress:g,scrollTo:p,scrollTop:e,skipAnimationFrameInResizeObserver:v,smoothScrollTargetReached:n,statefulScrollTop:i,viewportHeight:a}},[],{singleton:!0}),s1={lvl:0};function yee(t,e){const r=t.length;if(r===0)return[];let{index:n,value:i}=e(t[0]);const a=[];for(let o=1;o<r;o++){const{index:l,value:c}=e(t[o]);a.push({end:l-1,start:n,value:i}),n=l,i=c}return a.push({end:1/0,start:n,value:i}),a}function As(t){return t===s1}function i1(t,e){if(!As(t))return e===t.k?t.v:e<t.k?i1(t.l,e):i1(t.r,e)}function Gu(t,e,r="k"){if(As(t))return[-1/0,void 0];if(Number(t[r])===e)return[t.k,t.v];if(Number(t[r])<e){const n=Gu(t.r,e,r);return n[0]===-1/0?[t.k,t.v]:n}return Gu(t.l,e,r)}function gc(t,e,r){return As(t)?Nee(e,r,1):e===t.k?Oa(t,{k:e,v:r}):e<t.k?bF(Oa(t,{l:gc(t.l,e,r)})):bF(Oa(t,{r:gc(t.r,e,r)}))}function kx(){return s1}function _x(t,e,r){if(As(t))return[];const n=Gu(t,e)[0];return aTe(pT(t,n,r))}function fT(t,e){if(As(t))return s1;const{k:r,l:n,r:i}=t;if(e===r){if(As(n))return i;if(As(i))return n;{const[a,o]=wee(n);return lN(Oa(t,{k:a,l:vee(n),v:o}))}}else return e<r?lN(Oa(t,{l:fT(n,e)})):lN(Oa(t,{r:fT(i,e)}))}function Rp(t){return As(t)?[]:[...Rp(t.l),{k:t.k,v:t.v},...Rp(t.r)]}function pT(t,e,r){if(As(t))return[];const{k:n,l:i,r:a,v:o}=t;let l=[];return n>e&&(l=l.concat(pT(i,e,r))),n>=e&&n<=r&&l.push({k:n,v:o}),n<=r&&(l=l.concat(pT(a,e,r))),l}function lN(t){const{l:e,lvl:r,r:n}=t;if(n.lvl>=r-1&&e.lvl>=r-1)return t;if(r>n.lvl+1){if(xC(e))return jee(Oa(t,{lvl:r-1}));if(!As(e)&&!As(e.r))return Oa(e.r,{l:Oa(e,{r:e.r.l}),lvl:r,r:Oa(t,{l:e.r.r,lvl:r-1})});throw new Error("Unexpected empty nodes")}else{if(xC(t))return mT(Oa(t,{lvl:r-1}));if(!As(n)&&!As(n.l)){const i=n.l,a=xC(i)?n.lvl-1:n.lvl;return Oa(i,{l:Oa(t,{lvl:r-1,r:i.l}),lvl:i.lvl+1,r:mT(Oa(n,{l:i.r,lvl:a}))})}else throw new Error("Unexpected empty nodes")}}function Oa(t,e){return Nee(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function vee(t){return As(t.r)?t.l:lN(Oa(t,{r:vee(t.r)}))}function xC(t){return As(t)||t.lvl>t.r.lvl}function wee(t){return As(t.r)?[t.k,t.v]:wee(t.r)}function Nee(t,e,r,n=s1,i=s1){return{k:t,l:n,lvl:r,r:i,v:e}}function bF(t){return mT(jee(t))}function jee(t){const{l:e}=t;return!As(e)&&e.lvl===t.lvl?Oa(e,{r:Oa(t,{l:e.r})}):t}function mT(t){const{lvl:e,r}=t;return!As(r)&&!As(r.r)&&r.lvl===e&&r.r.lvl===e?Oa(r,{l:Oa(t,{r:r.l}),lvl:e+1}):t}function aTe(t){return yee(t,({k:e,v:r})=>({index:e,value:r}))}function kee(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function a1(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const OL=Qn(()=>({recalcInProgress:Gt(!1)}),[],{singleton:!0});function _ee(t,e,r){return t[wj(t,e,r)]}function wj(t,e,r,n=0){let i=t.length-1;for(;n<=i;){const a=Math.floor((n+i)/2),o=t[a],l=r(o,e);if(l===0)return a;if(l===-1){if(i-n<2)return a-1;i=a-1}else{if(i===n)return a;n=a+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function oTe(t,e,r,n){const i=wj(t,e,n),a=wj(t,r,n,i);return t.slice(i,a+1)}function R0(t,e){return Math.round(t.getBoundingClientRect()[e])}function Ik(t){return!As(t.groupOffsetTree)}function RL({index:t},e){return e===t?0:e<t?-1:1}function lTe(){return{groupIndices:[],groupOffsetTree:kx(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:kx()}}function cTe(t,e){let r=As(t)?0:1/0;for(const n of e){const{endIndex:i,size:a,startIndex:o}=n;if(r=Math.min(r,o),As(t)){t=gc(t,0,a);continue}const l=_x(t,o-1,i+1);if(l.some(gTe(n)))continue;let c=!1,u=!1;for(const{end:h,start:p,value:m}of l)c?(i>=p||a===m)&&(t=fT(t,p)):(u=m!==a,c=!0),h>i&&i>=p&&m!==a&&(t=gc(t,i+1,m));u&&(t=gc(t,o,a))}return[t,r]}function uTe(t){return typeof t.groupIndex<"u"}function dTe({offset:t},e){return e===t?0:e<t?-1:1}function o1(t,e,r){if(e.length===0)return 0;const{index:n,offset:i,size:a}=_ee(e,t,RL),o=t-n,l=a*o+(o-1)*r+i;return l>0?l+r:l}function See(t,e){if(!Ik(e))return t;let r=0;for(;e.groupIndices[r]<=t+r;)r++;return t+r}function Cee(t,e,r){if(uTe(t))return e.groupIndices[t.groupIndex]+1;{const n=t.index==="LAST"?r:t.index;let i=See(n,e);return i=Math.max(0,i,Math.min(r,i)),i}}function hTe(t,e,r,n=0){return n>0&&(e=Math.max(e,_ee(t,n,RL).offset)),yee(oTe(t,e,r,dTe),mTe)}function fTe(t,[e,r,n,i]){e.length>0&&n("received item sizes",e,wc.DEBUG);const a=t.sizeTree;let o=a,l=0;if(r.length>0&&As(a)&&e.length===2){const m=e[0].size,g=e[1].size;o=r.reduce((b,v)=>gc(gc(b,v,m),v+1,g),o)}else[o,l]=cTe(o,e);if(o===a)return t;const{lastIndex:c,lastOffset:u,lastSize:h,offsetTree:p}=gT(t.offsetTree,l,o,i);return{groupIndices:r,groupOffsetTree:r.reduce((m,g)=>gc(m,g,o1(g,p,i)),kx()),lastIndex:c,lastOffset:u,lastSize:h,offsetTree:p,sizeTree:o}}function pTe(t){return Rp(t).map(({k:e,v:r},n,i)=>{const a=i[n+1];return{endIndex:a?a.k-1:1/0,size:r,startIndex:e}})}function yF(t,e){let r=0,n=0;for(;r<t;)r+=e[n+1]-e[n]-1,n++;return n-(r===t?0:1)}function gT(t,e,r,n){let i=t,a=0,o=0,l=0,c=0;if(e!==0){c=wj(i,e-1,RL),l=i[c].offset;const u=Gu(r,e-1);a=u[0],o=u[1],i.length&&i[c].size===Gu(r,e)[1]&&(c-=1),i=i.slice(0,c+1)}else i=[];for(const{start:u,value:h}of _x(r,e,1/0)){const p=u-a,m=p*o+l+p*n;i.push({index:u,offset:m,size:h}),a=u,l=m,o=h}return{lastIndex:a,lastOffset:l,lastSize:o,offsetTree:i}}function mTe(t){return{index:t.index,value:t}}function gTe(t){const{endIndex:e,size:r,startIndex:n}=t;return i=>i.start===n&&(i.end===e||i.end===1/0)&&i.value===r}const xTe={offsetHeight:"height",offsetWidth:"width"},Jd=Qn(([{log:t},{recalcInProgress:e}])=>{const r=Pn(),n=Pn(),i=Jo(n,0),a=Pn(),o=Pn(),l=Gt(0),c=Gt([]),u=Gt(void 0),h=Gt(void 0),p=Gt(void 0),m=Gt(void 0),g=Gt((S,T)=>R0(S,xTe[T])),b=Gt(void 0),v=Gt(0),w=lTe(),j=Jo(Dt(r,fn(c,t,v),Ed(fTe,w),ri()),w),_=Jo(Dt(c,ri(),Ed((S,T)=>({current:T,prev:S.current}),{current:[],prev:[]}),ar(({prev:S})=>S)),[]);jr(Dt(c,Ur(S=>S.length>0),fn(j,v),ar(([S,T,M])=>{const $=S.reduce((k,L,R)=>gc(k,L,o1(L,T.offsetTree,M)||R),kx());return{...T,groupIndices:S,groupOffsetTree:$}})),j),jr(Dt(n,fn(j),Ur(([S,{lastIndex:T}])=>S<T),ar(([S,{lastIndex:T,lastSize:M}])=>[{endIndex:T,size:M,startIndex:S}])),r),jr(u,h);const E=Jo(Dt(u,ar(S=>S===void 0)),!0);jr(Dt(h,Ur(S=>S!==void 0&&As(mi(j).sizeTree)),ar(S=>{const T=mi(p),M=mi(c).length>0;return T?M?[{endIndex:0,size:T,startIndex:0},{endIndex:1,size:S,startIndex:1}]:[]:[{endIndex:0,size:S,startIndex:0}]})),r),jr(Dt(m,Ur(S=>S!==void 0&&S.length>0&&As(mi(j).sizeTree)),ar(S=>{const T=[];let M=S[0],$=0;for(let k=1;k<S.length;k++){const L=S[k];L!==M&&(T.push({endIndex:k-1,size:M,startIndex:$}),M=L,$=k)}return T.push({endIndex:S.length-1,size:M,startIndex:$}),T})),r),jr(Dt(c,fn(p,h),Ur(([,S,T])=>S!==void 0&&T!==void 0),ar(([S,T,M])=>{const $=[];for(let k=0;k<S.length;k++){const L=S[k],R=S[k+1];$.push({startIndex:L,endIndex:L,size:T}),R!==void 0&&$.push({startIndex:L+1,endIndex:R-1,size:M})}return $})),r);const I=vc(Dt(r,fn(j),Ed(({sizes:S},[T,M])=>({changed:M!==S,sizes:M}),{changed:!1,sizes:w}),ar(S=>S.changed)));as(Dt(l,Ed((S,T)=>({diff:S.prev-T,prev:T}),{diff:0,prev:0}),ar(S=>S.diff)),S=>{const{groupIndices:T}=mi(j);if(S>0)cn(e,!0),cn(a,S+yF(S,T));else if(S<0){const M=mi(_);M.length>0&&(S-=yF(-S,M)),cn(o,S)}}),as(Dt(l,fn(t)),([S,T])=>{S<0&&T("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:l},wc.ERROR)});const O=vc(a);jr(Dt(a,fn(j),ar(([S,T])=>{const M=T.groupIndices.length>0,$=[],k=T.lastSize;if(M){const L=i1(T.sizeTree,0);let R=0,V=0;for(;R<S;){const X=T.groupIndices[V],J=T.groupIndices.length===V+1?1/0:T.groupIndices[V+1]-X-1;$.push({endIndex:X,size:L,startIndex:X}),$.push({endIndex:X+1+J-1,size:k,startIndex:X+1}),V++,R+=J+1}const Y=Rp(T.sizeTree);return R!==S&&Y.shift(),Y.reduce((X,{k:J,v:re})=>{let se=X.ranges;return X.prevSize!==0&&(se=[...X.ranges,{endIndex:J+S-1,size:X.prevSize,startIndex:X.prevIndex}]),{prevIndex:J+S,prevSize:re,ranges:se}},{prevIndex:S,prevSize:0,ranges:$}).ranges}return Rp(T.sizeTree).reduce((L,{k:R,v:V})=>({prevIndex:R+S,prevSize:V,ranges:[...L.ranges,{endIndex:R+S-1,size:L.prevSize,startIndex:L.prevIndex}]}),{prevIndex:0,prevSize:k,ranges:[]}).ranges})),r);const B=vc(Dt(o,fn(j,v),ar(([S,{offsetTree:T},M])=>{const $=-S;return o1($,T,M)})));return jr(Dt(o,fn(j,v),ar(([S,T,M])=>{if(T.groupIndices.length>0){if(As(T.sizeTree))return T;let $=kx();const k=mi(_);let L=0,R=0,V=0;for(;L<-S;){V=k[R];const Y=k[R+1]-V-1;R++,L+=Y+1}if($=Rp(T.sizeTree).reduce((Y,{k:X,v:J})=>gc(Y,Math.max(0,X+S),J),$),L!==-S){const Y=i1(T.sizeTree,V);$=gc($,0,Y);const X=Gu(T.sizeTree,-S+1)[1];$=gc($,1,X)}return{...T,sizeTree:$,...gT(T.offsetTree,0,$,M)}}else{const $=Rp(T.sizeTree).reduce((k,{k:L,v:R})=>gc(k,Math.max(0,L+S),R),kx());return{...T,sizeTree:$,...gT(T.offsetTree,0,$,M)}}})),j),{beforeUnshiftWith:O,data:b,defaultItemSize:h,firstItemIndex:l,fixedItemSize:u,fixedGroupSize:p,gap:v,groupIndices:c,heightEstimates:m,itemSize:g,listRefresh:I,shiftWith:o,shiftWithOffset:B,sizeRanges:r,sizes:j,statefulTotalCount:i,totalCount:n,trackItemSizes:E,unshiftWith:a}},ai(W0,OL),{singleton:!0});function bTe(t){return t.reduce((e,r)=>(e.groupIndices.push(e.totalCount),e.totalCount+=r+1,e),{groupIndices:[],totalCount:0})}const Eee=Qn(([{groupIndices:t,sizes:e,totalCount:r},{headerHeight:n,scrollTop:i}])=>{const a=Pn(),o=Pn(),l=vc(Dt(a,ar(bTe)));return jr(Dt(l,ar(c=>c.totalCount)),r),jr(Dt(l,ar(c=>c.groupIndices)),t),jr(Dt(ga(i,e,n),Ur(([c,u])=>Ik(u)),ar(([c,u,h])=>Gu(u.groupOffsetTree,Math.max(c-h,0),"v")[0]),ri(),ar(c=>[c])),o),{groupCounts:a,topItemsIndexes:o}},ai(Jd,jl)),G0=Qn(([{log:t}])=>{const e=Gt(!1),r=vc(Dt(e,Ur(n=>n),ri()));return as(e,n=>{n&&mi(t)("props updated",{},wc.DEBUG)}),{didMount:r,propsReady:e}},ai(W0),{singleton:!0}),yTe=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Aee(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!yTe)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const n2=Qn(([{gap:t,listRefresh:e,sizes:r,totalCount:n},{fixedFooterHeight:i,fixedHeaderHeight:a,footerHeight:o,headerHeight:l,scrollingInProgress:c,scrollTo:u,smoothScrollTargetReached:h,viewportHeight:p},{log:m}])=>{const g=Pn(),b=Pn(),v=Gt(0);let w=null,j=null,_=null;function E(){w&&(w(),w=null),_&&(_(),_=null),j&&(clearTimeout(j),j=null),cn(c,!1)}return jr(Dt(g,fn(r,p,n,v,l,o,m),fn(t,a,i),ar(([[I,O,B,S,T,M,$,k],L,R,V])=>{const Y=Aee(I),{align:X,behavior:J,offset:re}=Y,se=S-1,ee=Cee(Y,O,se);let q=o1(ee,O.offsetTree,L)+M;X==="end"?(q+=R+Gu(O.sizeTree,ee)[1]-B+V,ee===se&&(q+=$)):X==="center"?q+=(R+Gu(O.sizeTree,ee)[1]-B+V)/2:q-=T,re&&(q+=re);const U=W=>{E(),W?(k("retrying to scroll to",{location:I},wc.DEBUG),cn(g,I)):(cn(b,!0),k("list did not change, scroll successful",{},wc.DEBUG))};if(E(),J==="smooth"){let W=!1;_=as(e,Z=>{W=W||Z}),w=Uu(h,()=>{U(W)})}else w=Uu(Dt(e,vTe(150)),U);return j=setTimeout(()=>{E()},1200),cn(c,!0),k("scrolling from index to",{behavior:J,index:ee,top:q},wc.DEBUG),{behavior:J,top:q}})),u),{scrollTargetReached:b,scrollToIndex:g,topListHeight:v}},ai(Jd,jl,W0),{singleton:!0});function vTe(t){return e=>{const r=setTimeout(()=>{e(!1)},t);return n=>{n&&(e(!0),clearTimeout(r))}}}function ML(t,e){t==0?e():requestAnimationFrame(()=>{ML(t-1,e)})}function DL(t,e){const r=e-1;return typeof t=="number"?t:t.index==="LAST"?r:t.index}const s2=Qn(([{defaultItemSize:t,listRefresh:e,sizes:r},{scrollTop:n},{scrollTargetReached:i,scrollToIndex:a},{didMount:o}])=>{const l=Gt(!0),c=Gt(0),u=Gt(!0);return jr(Dt(o,fn(c),Ur(([h,p])=>!!p),jd(!1)),l),jr(Dt(o,fn(c),Ur(([h,p])=>!!p),jd(!1)),u),as(Dt(ga(e,o),fn(l,r,t,u),Ur(([[,h],p,{sizeTree:m},g,b])=>h&&(!As(m)||IL(g))&&!p&&!b),fn(c)),([,h])=>{Uu(i,()=>{cn(u,!0)}),ML(4,()=>{Uu(n,()=>{cn(l,!0)}),cn(a,h)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:c,scrolledToInitialItem:l}},ai(Jd,jl,n2,G0),{singleton:!0});function Tee(t,e){return Math.abs(t-e)<1.01}const l1="up",_v="down",wTe="none",NTe={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},jTe=0,i2=Qn(([{footerHeight:t,headerHeight:e,scrollBy:r,scrollContainerState:n,scrollTop:i,viewportHeight:a}])=>{const o=Gt(!1),l=Gt(!0),c=Pn(),u=Pn(),h=Gt(4),p=Gt(jTe),m=Jo(Dt(hT(Dt(Fr(i),gm(1),jd(!0)),Dt(Fr(i),gm(1),jd(!1),xF(100))),ri()),!1),g=Jo(Dt(hT(Dt(r,jd(!0)),Dt(r,jd(!1),xF(200))),ri()),!1);jr(Dt(ga(Fr(i),Fr(p)),ar(([_,E])=>_<=E),ri()),l),jr(Dt(l,Mh(50)),u);const b=vc(Dt(ga(n,Fr(a),Fr(e),Fr(t),Fr(h)),Ed((_,[{scrollHeight:E,scrollTop:I},O,B,S,T])=>{const M=I+O-E>-T,$={scrollHeight:E,scrollTop:I,viewportHeight:O};if(M){let L,R;return I>_.state.scrollTop?(L="SCROLLED_DOWN",R=_.state.scrollTop-I):(L="SIZE_DECREASED",R=_.state.scrollTop-I||_.scrollTopDelta),{atBottom:!0,atBottomBecause:L,scrollTopDelta:R,state:$}}let k;return $.scrollHeight>_.state.scrollHeight?k="SIZE_INCREASED":O<_.state.viewportHeight?k="VIEWPORT_HEIGHT_DECREASING":I<_.state.scrollTop?k="SCROLLING_UPWARDS":k="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:k,state:$}},NTe),ri((_,E)=>_&&_.atBottom===E.atBottom))),v=Jo(Dt(n,Ed((_,{scrollHeight:E,scrollTop:I,viewportHeight:O})=>{if(Tee(_.scrollHeight,E))return{changed:!1,jump:0,scrollHeight:E,scrollTop:I};{const B=E-(I+O)<1;return _.scrollTop!==I&&B?{changed:!0,jump:_.scrollTop-I,scrollHeight:E,scrollTop:I}:{changed:!0,jump:0,scrollHeight:E,scrollTop:I}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),Ur(_=>_.changed),ar(_=>_.jump)),0);jr(Dt(b,ar(_=>_.atBottom)),o),jr(Dt(o,Mh(50)),c);const w=Gt(_v);jr(Dt(n,ar(({scrollTop:_})=>_),ri(),Ed((_,E)=>mi(g)?{direction:_.direction,prevScrollTop:E}:{direction:E<_.prevScrollTop?l1:_v,prevScrollTop:E},{direction:_v,prevScrollTop:0}),ar(_=>_.direction)),w),jr(Dt(n,Mh(50),jd(wTe)),w);const j=Gt(0);return jr(Dt(m,Ur(_=>!_),jd(0)),j),jr(Dt(i,Mh(100),fn(m),Ur(([_,E])=>E),Ed(([_,E],[I])=>[E,I],[0,0]),ar(([_,E])=>E-_)),j),{atBottomState:b,atBottomStateChange:c,atBottomThreshold:h,atTopStateChange:u,atTopThreshold:p,isAtBottom:o,isAtTop:l,isScrolling:m,lastJumpDueToItemResize:v,scrollDirection:w,scrollVelocity:j}},ai(jl)),c1="top",u1="bottom",vF="none";function wF(t,e,r){return typeof t=="number"?r===l1&&e===c1||r===_v&&e===u1?t:0:r===l1?e===c1?t.main:t.reverse:e===u1?t.main:t.reverse}function NF(t,e){var r;return typeof t=="number"?t:(r=t[e])!=null?r:0}const BL=Qn(([{deviation:t,fixedHeaderHeight:e,headerHeight:r,scrollTop:n,viewportHeight:i}])=>{const a=Pn(),o=Gt(0),l=Gt(0),c=Gt(0),u=Jo(Dt(ga(Fr(n),Fr(i),Fr(r),Fr(a,a1),Fr(c),Fr(o),Fr(e),Fr(t),Fr(l)),ar(([h,p,m,[g,b],v,w,j,_,E])=>{const I=h-_,O=w+j,B=Math.max(m-I,0);let S=vF;const T=NF(E,c1),M=NF(E,u1);return g-=_,g+=m+j,b+=m+j,b-=_,g>h+O-T&&(S=l1),b<h-B+p+M&&(S=_v),S!==vF?[Math.max(I-m-wF(v,c1,S)-T,0),I-B-j+p+wF(v,u1,S)+M]:null}),Ur(h=>h!=null),ri(a1)),[0,0]);return{increaseViewportBy:l,listBoundary:a,overscan:c,topListHeight:o,visibleRange:u}},ai(jl),{singleton:!0});function kTe(t,e,r){if(Ik(e)){const n=See(t,e);return[{index:Gu(e.groupOffsetTree,n)[0],offset:0,size:0},{data:r?.[0],index:n,offset:0,size:0}]}return[{data:r?.[0],index:t,offset:0,size:0}]}const bC={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function cN(t,e,r,n,i,a){const{lastIndex:o,lastOffset:l,lastSize:c}=i;let u=0,h=0;if(t.length>0){u=t[0].offset;const v=t[t.length-1];h=v.offset+v.size}const p=r-o,m=l+p*c+(p-1)*n,g=u,b=m-h;return{bottom:h,firstItemIndex:a,items:jF(t,i,a),offsetBottom:b,offsetTop:u,top:g,topItems:jF(e,i,a),topListHeight:e.reduce((v,w)=>w.size+v,0),totalCount:r}}function Iee(t,e,r,n,i,a){let o=0;if(r.groupIndices.length>0)for(const h of r.groupIndices){if(h-o>=t)break;o++}const l=t+o,c=DL(e,l),u=Array.from({length:l}).map((h,p)=>({data:a[p+c],index:p+c,offset:0,size:0}));return cN(u,[],l,i,r,n)}function jF(t,e,r){if(t.length===0)return[];if(!Ik(e))return t.map(u=>({...u,index:u.index+r,originalIndex:u.index}));const n=t[0].index,i=t[t.length-1].index,a=[],o=_x(e.groupOffsetTree,n,i);let l,c=0;for(const u of t){(!l||l.end<u.index)&&(l=o.shift(),c=e.groupIndices.indexOf(l.start));let h;u.index===l.start?h={index:c,type:"group"}:h={groupIndex:c,index:u.index-(c+1)+r},a.push({...h,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return a}function kF(t,e){var r;return t===void 0?0:typeof t=="number"?t:(r=t[e])!=null?r:0}const zm=Qn(([{data:t,firstItemIndex:e,gap:r,sizes:n,totalCount:i},a,{listBoundary:o,topListHeight:l,visibleRange:c},{initialTopMostItemIndex:u,scrolledToInitialItem:h},{topListHeight:p},m,{didMount:g},{recalcInProgress:b}])=>{const v=Gt([]),w=Gt(0),j=Pn(),_=Gt(0);jr(a.topItemsIndexes,v);const E=Jo(Dt(ga(g,b,Fr(c,a1),Fr(i),Fr(n),Fr(u),h,Fr(v),Fr(e),Fr(r),Fr(_),t),Ur(([S,T,,M,,,,,,,,$])=>{const k=$&&$.length!==M;return S&&!T&&!k}),ar(([,,[S,T],M,$,k,L,R,V,Y,X,J])=>{var re,se,ee,q;const U=$,{offsetTree:W,sizeTree:Z}=U,de=mi(w);if(M===0)return{...bC,totalCount:M};if(S===0&&T===0)return de===0?{...bC,totalCount:M}:Iee(de,k,$,V,Y,J||[]);if(As(Z))return de>0?null:cN(kTe(DL(k,M),U,J),[],M,Y,U,V);const be=[];if(R.length>0){const ke=R[0],Ie=R[R.length-1];let ce=0;for(const Be of _x(Z,ke,Ie)){const ct=Be.value,Ve=Math.max(Be.start,ke),Ne=Math.min(Be.end,Ie);for(let Ye=Ve;Ye<=Ne;Ye++)be.push({data:J?.[Ye],index:Ye,offset:ce,size:ct}),ce+=ct}}if(!L)return cN([],be,M,Y,U,V);const oe=R.length>0?R[R.length-1]+1:0,ne=hTe(W,S,T,oe);if(ne.length===0)return null;const H=M-1,le=Tk([],ke=>{for(const Ie of ne){const ce=Ie.value;let Be=ce.offset,ct=Ie.start;const Ve=ce.size;if(ce.offset<S){ct+=Math.floor((S-ce.offset+Y)/(Ve+Y));const Ye=ct-Ie.start;Be+=Ye*Ve+Ye*Y}ct<oe&&(Be+=(oe-ct)*Ve,ct=oe);const Ne=Math.min(Ie.end,H);for(let Ye=ct;Ye<=Ne&&!(Be>=T);Ye++)ke.push({data:J?.[Ye],index:Ye,offset:Be,size:Ve}),Be+=Ve+Y}}),ye=kF(X,c1),me=kF(X,u1);if(le.length>0&&(ye>0||me>0)){const ke=le[0],Ie=le[le.length-1];if(ye>0&&ke.index>oe){const ce=Math.min(ye,ke.index-oe),Be=[];let ct=ke.offset;for(let Ve=ke.index-1;Ve>=ke.index-ce;Ve--){const Ne=(se=(re=_x(Z,Ve,Ve)[0])==null?void 0:re.value)!=null?se:ke.size;ct-=Ne+Y,Be.unshift({data:J?.[Ve],index:Ve,offset:ct,size:Ne})}le.unshift(...Be)}if(me>0&&Ie.index<H){const ce=Math.min(me,H-Ie.index);let Be=Ie.offset+Ie.size+Y;for(let ct=Ie.index+1;ct<=Ie.index+ce;ct++){const Ve=(q=(ee=_x(Z,ct,ct)[0])==null?void 0:ee.value)!=null?q:Ie.size;le.push({data:J?.[ct],index:ct,offset:Be,size:Ve}),Be+=Ve+Y}}}return cN(le,be,M,Y,U,V)}),Ur(S=>S!==null),ri()),bC);jr(Dt(t,Ur(IL),ar(S=>S?.length)),i),jr(Dt(E,ar(S=>S.topListHeight)),p),jr(p,l),jr(Dt(E,ar(S=>[S.top,S.bottom])),o),jr(Dt(E,ar(S=>S.items)),j);const I=vc(Dt(E,Ur(({items:S})=>S.length>0),fn(i,t),Ur(([{items:S},T])=>S[S.length-1].originalIndex===T-1),ar(([,S,T])=>[S-1,T]),ri(a1),ar(([S])=>S))),O=vc(Dt(E,Mh(200),Ur(({items:S,topItems:T})=>S.length>0&&S[0].originalIndex===T.length),ar(({items:S})=>S[0].index),ri())),B=vc(Dt(E,Ur(({items:S})=>S.length>0),ar(({items:S})=>{let T=0,M=S.length-1;for(;S[T].type==="group"&&T<M;)T++;for(;S[M].type==="group"&&M>T;)M--;return{endIndex:S[M].index,startIndex:S[T].index}}),ri(kee)));return{endReached:I,initialItemCount:w,itemsRendered:j,listState:E,minOverscanItemCount:_,rangeChanged:B,startReached:O,topItemsIndexes:v,...m}},ai(Jd,Eee,BL,s2,n2,i2,G0,OL),{singleton:!0}),Lee=Qn(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:r,headerHeight:n},{listState:i}])=>{const a=Pn(),o=Jo(Dt(ga(r,t,n,e,i),ar(([l,c,u,h,p])=>l+c+u+h+p.offsetBottom+p.bottom)),0);return jr(Fr(o),a),{totalListHeight:o,totalListHeightChanged:a}},ai(jl,zm),{singleton:!0}),_Te=Qn(([{viewportHeight:t},{totalListHeight:e}])=>{const r=Gt(!1),n=Jo(Dt(ga(r,t,e),Ur(([i])=>i),ar(([,i,a])=>Math.max(0,i-a)),Mh(0),ri()),0);return{alignToBottom:r,paddingTopAddition:n}},ai(jl,Lee),{singleton:!0}),Pee=Qn(()=>({context:Gt(null)})),STe=({itemBottom:t,itemTop:e,locationParams:{align:r,behavior:n,...i},viewportBottom:a,viewportTop:o})=>e<o?{...i,align:r??"start",behavior:n}:t>a?{...i,align:r??"end",behavior:n}:null,Oee=Qn(([{gap:t,sizes:e,totalCount:r},{fixedFooterHeight:n,fixedHeaderHeight:i,headerHeight:a,scrollingInProgress:o,scrollTop:l,viewportHeight:c},{scrollToIndex:u}])=>{const h=Pn();return jr(Dt(h,fn(e,c,r,a,i,n,l),fn(t),ar(([[p,m,g,b,v,w,j,_],E])=>{const{align:I,behavior:O,calculateViewLocation:B=STe,done:S,...T}=p,M=Cee(p,m,b-1),$=o1(M,m.offsetTree,E)+v+w,k=$+Gu(m.sizeTree,M)[1],L=_+w,R=_+g-j,V=B({itemBottom:k,itemTop:$,locationParams:{align:I,behavior:O,...T},viewportBottom:R,viewportTop:L});return V?S&&Uu(Dt(o,Ur(Y=>!Y),gm(mi(o)?1:2)),S):S?.(),V}),Ur(p=>p!==null)),u),{scrollIntoView:h}},ai(Jd,jl,n2,zm,W0),{singleton:!0});function _F(t){return t?t==="smooth"?"smooth":"auto":!1}const CTe=(t,e)=>typeof t=="function"?_F(t(e)):e&&_F(t),ETe=Qn(([{listRefresh:t,totalCount:e,fixedItemSize:r,data:n},{atBottomState:i,isAtBottom:a},{scrollToIndex:o},{scrolledToInitialItem:l},{didMount:c,propsReady:u},{log:h},{scrollingInProgress:p},{context:m},{scrollIntoView:g}])=>{const b=Gt(!1),v=Pn();let w=null;function j(O){cn(o,{align:"end",behavior:O,index:"LAST"})}as(Dt(ga(Dt(Fr(e),gm(1)),c),fn(Fr(b),a,l,p),ar(([[O,B],S,T,M,$])=>{let k=B&&M,L="auto";return k&&(L=CTe(S,T||$),k=k&&!!L),{followOutputBehavior:L,shouldFollow:k,totalCount:O}}),Ur(({shouldFollow:O})=>O)),({followOutputBehavior:O,totalCount:B})=>{w&&(w(),w=null),mi(r)?requestAnimationFrame(()=>{mi(h)("following output to ",{totalCount:B},wc.DEBUG),j(O)}):w=Uu(t,()=>{mi(h)("following output to ",{totalCount:B},wc.DEBUG),j(O),w=null})});function _(O){const B=Uu(i,S=>{O&&!S.atBottom&&S.notAtBottomBecause==="SIZE_INCREASED"&&!w&&(mi(h)("scrolling to bottom due to increased size",{},wc.DEBUG),j("auto"))});setTimeout(B,100)}as(Dt(ga(Fr(b),e,u),Ur(([O,,B])=>O&&B),Ed(({value:O},[,B])=>({refreshed:O===B,value:B}),{refreshed:!1,value:0}),Ur(({refreshed:O})=>O),fn(b,e)),([,O])=>{mi(l)&&_(O!==!1)}),as(v,()=>{_(mi(b)!==!1)}),as(ga(Fr(b),i),([O,B])=>{O&&!B.atBottom&&B.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&j("auto")});const E=Gt(null),I=Pn();return jr(hT(Dt(Fr(n),ar(O=>{var B;return(B=O?.length)!=null?B:0})),Dt(Fr(e))),I),as(Dt(ga(Dt(I,gm(1)),c),fn(Fr(E),l,p,m),ar(([[O,B],S,T,M,$])=>B&&T&&S?.({context:$,totalCount:O,scrollingInProgress:M})),Ur(O=>!!O),Mh(0)),O=>{w&&(w(),w=null),mi(r)?requestAnimationFrame(()=>{mi(h)("scrolling into view",{}),cn(g,O)}):w=Uu(t,()=>{mi(h)("scrolling into view",{}),cn(g,O),w=null})}),{autoscrollToBottom:v,followOutput:b,scrollIntoViewOnChange:E}},ai(Jd,i2,n2,s2,G0,W0,jl,Pee,Oee)),ATe=Qn(([{data:t,firstItemIndex:e,gap:r,sizes:n},{initialTopMostItemIndex:i},{initialItemCount:a,listState:o},{didMount:l}])=>(jr(Dt(l,fn(a),Ur(([,c])=>c!==0),fn(i,n,e,r,t),ar(([[,c],u,h,p,m,g=[]])=>Iee(c,u,h,p,m,g))),o),{}),ai(Jd,s2,zm,G0),{singleton:!0}),TTe=Qn(([{didMount:t},{scrollTo:e},{listState:r}])=>{const n=Gt(0);return as(Dt(t,fn(n),Ur(([,i])=>i!==0),ar(([,i])=>({top:i}))),i=>{Uu(Dt(r,gm(1),Ur(a=>a.items.length>1)),()=>{requestAnimationFrame(()=>{cn(e,i)})})}),{initialScrollTop:n}},ai(G0,jl,zm),{singleton:!0}),Ree=Qn(([{scrollVelocity:t}])=>{const e=Gt(!1),r=Pn(),n=Gt(!1);return jr(Dt(t,fn(n,e,r),Ur(([i,a])=>!!a),ar(([i,a,o,l])=>{const{enter:c,exit:u}=a;if(o){if(u(i,l))return!1}else if(c(i,l))return!0;return o}),ri()),e),as(Dt(ga(e,t,r),fn(n)),([[i,a,o],l])=>{i&&l&&l.change&&l.change(a,o)}),{isSeeking:e,scrollSeekConfiguration:n,scrollSeekRangeChanged:r,scrollVelocity:t}},ai(i2),{singleton:!0}),$L=Qn(([{scrollContainerState:t,scrollTo:e}])=>{const r=Pn(),n=Pn(),i=Pn(),a=Gt(!1),o=Gt(void 0);return jr(Dt(ga(r,n),ar(([{scrollHeight:l,scrollTop:c,viewportHeight:u},{offsetTop:h}])=>({scrollHeight:l,scrollTop:Math.max(0,c-h),viewportHeight:u}))),t),jr(Dt(e,fn(n),ar(([l,{offsetTop:c}])=>({...l,top:l.top+c}))),i),{customScrollParent:o,useWindowScroll:a,windowScrollContainerState:r,windowScrollTo:i,windowViewportRect:n}},ai(jl)),ITe=Qn(([{sizeRanges:t,sizes:e},{headerHeight:r,scrollTop:n},{initialTopMostItemIndex:i},{didMount:a},{useWindowScroll:o,windowScrollContainerState:l,windowViewportRect:c}])=>{const u=Pn(),h=Gt(void 0),p=Gt(null),m=Gt(null);return jr(l,p),jr(c,m),as(Dt(u,fn(e,n,o,p,m,r)),([g,b,v,w,j,_,E])=>{const I=pTe(b.sizeTree);w&&j!==null&&_!==null&&(v=j.scrollTop-_.offsetTop),v-=E,g({ranges:I,scrollTop:v})}),jr(Dt(h,Ur(IL),ar(LTe)),i),jr(Dt(a,fn(h),Ur(([,g])=>g!==void 0),ri(),ar(([,g])=>g.ranges)),t),{getState:u,restoreStateFrom:h}},ai(Jd,jl,s2,G0,$L));function LTe(t){return{align:"start",index:0,offset:t.scrollTop}}const PTe=Qn(([{topItemsIndexes:t}])=>{const e=Gt(0);return jr(Dt(e,Ur(r=>r>=0),ar(r=>Array.from({length:r}).map((n,i)=>i))),t),{topItemCount:e}},ai(zm));function Mee(t){let e=!1,r;return(()=>(e||(e=!0,r=t()),r))}const OTe=Mee(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),RTe=Qn(([{deviation:t,scrollBy:e,scrollingInProgress:r,scrollTop:n},{isAtBottom:i,isScrolling:a,lastJumpDueToItemResize:o,scrollDirection:l},{listState:c},{beforeUnshiftWith:u,gap:h,shiftWithOffset:p,sizes:m},{log:g},{recalcInProgress:b}])=>{const v=vc(Dt(c,fn(o),Ed(([,j,_,E],[{bottom:I,items:O,offsetBottom:B,totalCount:S},T])=>{const M=I+B;let $=0;return _===S&&j.length>0&&O.length>0&&(O[0].originalIndex===0&&j[0].originalIndex===0||($=M-E,$!==0&&($+=T))),[$,O,S,M]},[0,[],0,0]),Ur(([j])=>j!==0),fn(n,l,r,i,g,b),Ur(([,j,_,E,,,I])=>!I&&!E&&j!==0&&_===l1),ar(([[j],,,,,_])=>(_("Upward scrolling compensation",{amount:j},wc.DEBUG),j))));function w(j){j>0?(cn(e,{behavior:"auto",top:-j}),cn(t,0)):(cn(t,0),cn(e,{behavior:"auto",top:-j}))}return as(Dt(v,fn(t,a)),([j,_,E])=>{E&&OTe()?cn(t,_-j):w(-j)}),as(Dt(ga(Jo(a,!1),t,b),Ur(([j,_,E])=>!j&&!E&&_!==0),ar(([j,_])=>_),Mh(1)),w),jr(Dt(p,ar(j=>({top:-j}))),e),as(Dt(u,fn(m,h),ar(([j,{groupIndices:_,lastSize:E,sizeTree:I},O])=>{function B(S){return S*(E+O)}if(_.length===0)return B(j);{let S=0;const T=i1(I,0);let M=0,$=0;for(;M<j;){M++,S+=T;let k=_.length===$+1?1/0:_[$+1]-_[$]-1;M+k>j&&(S-=T,k=j-M+1),M+=k,S+=B(k),$++}return S}})),j=>{cn(t,j),requestAnimationFrame(()=>{cn(e,{top:j}),requestAnimationFrame(()=>{cn(t,0),cn(b,!1)})})}),{deviation:t}},ai(jl,i2,zm,Jd,W0,OL)),MTe=Qn(([t,e,r,n,i,a,o,l,c,u,h])=>({...t,...e,...r,...n,...i,...a,...o,...l,...c,...u,...h}),ai(BL,ATe,G0,Ree,Lee,TTe,_Te,$L,Oee,W0,Pee)),Dee=Qn(([{data:t,defaultItemSize:e,firstItemIndex:r,fixedItemSize:n,fixedGroupSize:i,gap:a,groupIndices:o,heightEstimates:l,itemSize:c,sizeRanges:u,sizes:h,statefulTotalCount:p,totalCount:m,trackItemSizes:g},{initialItemFinalLocationReached:b,initialTopMostItemIndex:v,scrolledToInitialItem:w},j,_,E,I,{scrollToIndex:O},B,{topItemCount:S},{groupCounts:T},M])=>{const{listState:$,minOverscanItemCount:k,topItemsIndexes:L,rangeChanged:R,...V}=I;return jr(R,M.scrollSeekRangeChanged),jr(Dt(M.windowViewportRect,ar(Y=>Y.visibleHeight)),j.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:r,fixedItemHeight:n,fixedGroupHeight:i,gap:a,groupCounts:T,heightEstimates:l,initialItemFinalLocationReached:b,initialTopMostItemIndex:v,scrolledToInitialItem:w,sizeRanges:u,topItemCount:S,topItemsIndexes:L,totalCount:m,...E,groupIndices:o,itemSize:c,listState:$,minOverscanItemCount:k,scrollToIndex:O,statefulTotalCount:p,trackItemSizes:g,rangeChanged:R,...V,...M,...j,sizes:h,..._}},ai(Jd,s2,jl,ITe,ETe,zm,n2,RTe,PTe,Eee,MTe));function DTe(t,e){const r={},n={};let i=0;const a=t.length;for(;i<a;)n[t[i]]=1,i+=1;for(const o in e)Object.hasOwn(n,o)||(r[o]=e[o]);return r}const r5=typeof document<"u"?Pe.useLayoutEffect:Pe.useEffect;function Bee(t,e,r){const n=Object.keys(e.required||{}),i=Object.keys(e.optional||{}),a=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),l=Pe.createContext({});function c(w,j){w.propsReady&&cn(w.propsReady,!1);for(const _ of n){const E=w[e.required[_]];cn(E,j[_])}for(const _ of i)if(_ in j){const E=w[e.optional[_]];cn(E,j[_])}w.propsReady&&cn(w.propsReady,!0)}function u(w){return a.reduce((j,_)=>(j[_]=E=>{const I=w[e.methods[_]];cn(I,E)},j),{})}function h(w){return o.reduce((j,_)=>(j[_]=ZAe(w[e.events[_]]),j),{})}const p=Pe.forwardRef((w,j)=>{const{children:_,...E}=w,[I]=Pe.useState(()=>Tk(tTe(t),S=>{c(S,E)})),[O]=Pe.useState(gF(h,I));r5(()=>{for(const S of o)S in E&&as(O[S],E[S]);return()=>{Object.values(O).map(LL)}},[E,O,I]),r5(()=>{c(I,E)}),Pe.useImperativeHandle(j,mF(u(I)));const B=r;return s.jsx(l.Provider,{value:I,children:r?s.jsx(B,{...DTe([...n,...i,...o],E),children:_}):_})}),m=w=>{const j=Pe.useContext(l);return Pe.useCallback(_=>{cn(j[w],_)},[j,w])},g=w=>{const j=Pe.useContext(l)[w],_=Pe.useCallback(E=>as(j,E),[j]);return Pe.useSyncExternalStore(_,()=>mi(j),()=>mi(j))},b=w=>{const j=Pe.useContext(l)[w],[_,E]=Pe.useState(gF(mi,j));return r5(()=>as(j,I=>{I!==_&&E(mF(I))}),[j,_]),_},v=Pe.version.startsWith("18")?g:b;return{Component:p,useEmitter:(w,j)=>{const _=Pe.useContext(l)[w];r5(()=>as(_,j),[j,_])},useEmitterValue:v,usePublisher:m}}const $ee=Pe.createContext(void 0),Fee=Pe.createContext(void 0),Uee=typeof document<"u"?Pe.useLayoutEffect:Pe.useEffect;function yC(t){return"self"in t}function BTe(t){return"body"in t}function zee(t,e,r,n=r2,i,a){const o=Pe.useRef(null),l=Pe.useRef(null),c=Pe.useRef(null),u=Pe.useCallback(m=>{let g,b,v;const w=m.target;if(BTe(w)||yC(w)){const _=yC(w)?w:w.defaultView;v=a?_.scrollX:_.scrollY,g=a?_.document.documentElement.scrollWidth:_.document.documentElement.scrollHeight,b=a?_.innerWidth:_.innerHeight}else v=a?w.scrollLeft:w.scrollTop,g=a?w.scrollWidth:w.scrollHeight,b=a?w.offsetWidth:w.offsetHeight;const j=()=>{t({scrollHeight:g,scrollTop:Math.max(v,0),viewportHeight:b})};m.suppressFlushSync?j():w4.flushSync(j),l.current!==null&&(v===l.current||v<=0||v===g-b)&&(l.current=null,e(!0),c.current&&(clearTimeout(c.current),c.current=null))},[t,e,a]);Pe.useEffect(()=>{const m=i||o.current;return n(i||o.current),u({suppressFlushSync:!0,target:m}),m.addEventListener("scroll",u,{passive:!0}),()=>{n(null),m.removeEventListener("scroll",u)}},[o,u,r,n,i]);function h(m){const g=o.current;if(!g||(a?"offsetWidth"in g&&g.offsetWidth===0:"offsetHeight"in g&&g.offsetHeight===0))return;const b=m.behavior==="smooth";let v,w,j;yC(g)?(w=Math.max(R0(g.document.documentElement,a?"width":"height"),a?g.document.documentElement.scrollWidth:g.document.documentElement.scrollHeight),v=a?g.innerWidth:g.innerHeight,j=a?window.scrollX:window.scrollY):(w=g[a?"scrollWidth":"scrollHeight"],v=R0(g,a?"width":"height"),j=g[a?"scrollLeft":"scrollTop"]);const _=w-v;if(m.top=Math.ceil(Math.max(Math.min(_,m.top),0)),Tee(v,w)||m.top===j){t({scrollHeight:w,scrollTop:j,viewportHeight:v}),b&&e(!0);return}b?(l.current=m.top,c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{c.current=null,l.current=null,e(!0)},1e3)):l.current=null,a&&(m={behavior:m.behavior,left:m.top}),g.scrollTo(m)}function p(m){a&&(m={behavior:m.behavior,left:m.top}),o.current.scrollBy(m)}return{scrollByCallback:p,scrollerRef:o,scrollToCallback:h}}const vC="-webkit-sticky",SF="sticky",FL=Mee(()=>{if(typeof document>"u")return SF;const t=document.createElement("div");return t.style.position=vC,t.style.position===vC?vC:SF});function UL(t){return t}const $Te=Qn(()=>{const t=Gt(l=>`Item ${l}`),e=Gt(l=>`Group ${l}`),r=Gt({}),n=Gt(UL),i=Gt("div"),a=Gt(r2),o=(l,c=null)=>Jo(Dt(r,ar(u=>u[l]),ri()),c);return{components:r,computeItemKey:n,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:i,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}});ai(Dee,$Te);FL();const FTe={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},UTe={outline:"none",overflowX:"auto",position:"relative"},Lk=t=>({height:"100%",position:"absolute",top:0,width:"100%"});FL();function Lo(t,e){if(typeof t!="string")return{context:e}}function zTe(t,e){return{item:typeof t=="string"?void 0:e}}function qee({useEmitter:t,useEmitterValue:e,usePublisher:r}){return Pe.memo(function({children:n,style:i,context:a,...o}){const l=r("scrollContainerState"),c=e("ScrollerComponent"),u=r("smoothScrollTargetReached"),h=e("scrollerRef"),p=e("horizontalDirection")||!1,{scrollByCallback:m,scrollerRef:g,scrollToCallback:b}=zee(l,u,c,h,void 0,p);return t("scrollTo",b),t("scrollBy",m),s.jsx(c,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:g,style:{...p?UTe:FTe,...i},tabIndex:0,...o,...Lo(c,a),children:n})})}function Vee({useEmitter:t,useEmitterValue:e,usePublisher:r}){return Pe.memo(function({children:n,style:i,context:a,...o}){const l=r("windowScrollContainerState"),c=e("ScrollerComponent"),u=r("smoothScrollTargetReached"),h=e("totalListHeight"),p=e("deviation"),m=e("customScrollParent"),g=Pe.useRef(null),b=e("scrollerRef"),{scrollByCallback:v,scrollerRef:w,scrollToCallback:j}=zee(l,u,c,b,m);return Uee(()=>{var _;return w.current=m||((_=g.current)==null?void 0:_.ownerDocument.defaultView),()=>{w.current=null}},[w,m]),t("windowScrollTo",j),t("scrollBy",v),s.jsx(c,{ref:g,"data-virtuoso-scroller":!0,style:{position:"relative",...i,...h!==0?{height:h+p}:{}},...o,...Lo(c,a),children:n})})}const qTe=Qn(()=>{const t=Gt(u=>s.jsxs("td",{children:["Item $",u]})),e=Gt(null),r=Gt(u=>s.jsxs("td",{colSpan:1e3,children:["Group ",u]})),n=Gt(null),i=Gt(null),a=Gt({}),o=Gt(UL),l=Gt(r2),c=(u,h=null)=>Jo(Dt(a,ar(p=>p[u]),ri()),h);return{components:a,computeItemKey:o,context:e,EmptyPlaceholder:c("EmptyPlaceholder"),FillerRow:c("FillerRow"),fixedFooterContent:i,fixedHeaderContent:n,itemContent:t,groupContent:r,ScrollerComponent:c("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder"),TableBodyComponent:c("TableBody","tbody"),TableComponent:c("Table","table"),TableFooterComponent:c("TableFoot","tfoot"),TableHeadComponent:c("TableHead","thead"),TableRowComponent:c("TableRow","tr"),GroupComponent:c("Group","tr")}}),VTe=Qn(([t,e])=>({...t,...e}),ai(Dee,qTe)),HTe=({height:t})=>s.jsx("tr",{children:s.jsx("td",{style:{height:t}})}),WTe=({height:t})=>s.jsx("tr",{children:s.jsx("td",{style:{border:0,height:t,padding:0}})}),GTe={overflowAnchor:"none"},CF={position:FL(),zIndex:2,overflowAnchor:"none"},EF=Pe.memo(function({showTopList:t=!1}){const e=ln("listState"),r=ln("computeItemKey"),n=ln("firstItemIndex"),i=ln("context"),a=ln("isSeeking"),o=ln("fixedHeaderHeight"),l=ln("groupIndices").length>0,c=ln("itemContent"),u=ln("groupContent"),h=ln("ScrollSeekPlaceholder")||HTe,p=ln("GroupComponent"),m=ln("TableRowComponent"),g=(t?e.topItems:[]).reduce((v,w,j)=>(j===0?v.push(w.size):v.push(v[j-1]+w.size),v),[]),b=(t?e.topItems:e.items).map(v=>{const w=v.originalIndex,j=r(w+n,v.data,i),_=t?w===0?0:g[w-1]:0;return a?y.createElement(h,{...Lo(h,i),height:v.size,index:v.index,key:j,type:v.type||"item"}):v.type==="group"?y.createElement(p,{...Lo(p,i),"data-index":w,"data-item-index":v.index,"data-known-size":v.size,key:j,style:{...CF,top:o}},u(v.index,i)):y.createElement(m,{...Lo(m,i),...zTe(m,v.data),"data-index":w,"data-item-index":v.index,"data-known-size":v.size,"data-item-group-index":v.groupIndex,key:j,style:t?{...CF,top:o+_}:GTe},l?c(v.index,v.groupIndex,v.data,i):c(v.index,v.data,i))});return s.jsx(s.Fragment,{children:b})}),KTe=Pe.memo(function(){const t=ln("listState"),e=ln("topItemsIndexes").length>0,r=zu("sizeRanges"),n=ln("useWindowScroll"),i=ln("customScrollParent"),a=zu("windowScrollContainerState"),o=zu("scrollContainerState"),l=i||n?a:o,c=ln("trackItemSizes"),u=ln("itemSize"),h=ln("log"),{callbackRef:p,ref:m}=sTe(r,u,c,l,h,void 0,i,!1,ln("skipAnimationFrameInResizeObserver")),[g,b]=Pe.useState(0);zL("deviation",$=>{g!==$&&(m.current.style.marginTop=`${$}px`,b($))});const v=ln("EmptyPlaceholder"),w=ln("FillerRow")||WTe,j=ln("TableBodyComponent"),_=ln("paddingTopAddition"),E=ln("statefulTotalCount"),I=ln("context");if(E===0&&v)return s.jsx(v,{...Lo(v,I)});const O=(e?t.topItems:[]).reduce(($,k)=>$+k.size,0),B=t.offsetTop+_+g-O,S=t.offsetBottom,T=B>0?s.jsx(w,{context:I,height:B},"padding-top"):null,M=S>0?s.jsx(w,{context:I,height:S},"padding-bottom"):null;return s.jsxs(j,{"data-testid":"virtuoso-item-list",ref:p,...Lo(j,I),children:[T,e&&s.jsx(EF,{showTopList:!0}),s.jsx(EF,{}),M]})}),YTe=({children:t})=>{const e=Pe.useContext($ee),r=zu("viewportHeight"),n=zu("fixedItemHeight"),i=xm(Pe.useMemo(()=>vj(r,a=>R0(a,"height")),[r]),!0,ln("skipAnimationFrameInResizeObserver"));return Pe.useEffect(()=>{e&&(r(e.viewportHeight),n(e.itemHeight))},[e,r,n]),s.jsx("div",{"data-viewport-type":"element",ref:i,style:Lk(),children:t})},XTe=({children:t})=>{const e=Pe.useContext($ee),r=zu("windowViewportRect"),n=zu("fixedItemHeight"),i=ln("customScrollParent"),a=bee(r,i,ln("skipAnimationFrameInResizeObserver"));return Pe.useEffect(()=>{e&&(n(e.itemHeight),r({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,r,n]),s.jsx("div",{"data-viewport-type":"window",ref:a,style:Lk(),children:t})},QTe=Pe.memo(function(t){const e=ln("useWindowScroll"),r=ln("customScrollParent"),n=zu("fixedHeaderHeight"),i=zu("fixedFooterHeight"),a=ln("fixedHeaderContent"),o=ln("fixedFooterContent"),l=ln("context"),c=xm(Pe.useMemo(()=>vj(n,j=>R0(j,"height")),[n]),!0,ln("skipAnimationFrameInResizeObserver")),u=xm(Pe.useMemo(()=>vj(i,j=>R0(j,"height")),[i]),!0,ln("skipAnimationFrameInResizeObserver")),h=r||e?e8e:ZTe,p=r||e?XTe:YTe,m=ln("TableComponent"),g=ln("TableHeadComponent"),b=ln("TableFooterComponent"),v=a?s.jsx(g,{ref:c,style:{position:"sticky",top:0,zIndex:2},...Lo(g,l),children:a()},"TableHead"):null,w=o?s.jsx(b,{ref:u,style:{bottom:0,position:"sticky",zIndex:1},...Lo(b,l),children:o()},"TableFoot"):null;return s.jsx(h,{...t,...Lo(h,l),children:s.jsx(p,{children:s.jsxs(m,{style:{borderSpacing:0,overflowAnchor:"none"},...Lo(m,l),children:[v,s.jsx(KTe,{},"TableBody"),w]})})})}),{Component:JTe,useEmitter:zL,useEmitterValue:ln,usePublisher:zu}=Bee(VTe,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},QTe),ZTe=qee({useEmitter:zL,useEmitterValue:ln,usePublisher:zu}),e8e=Vee({useEmitter:zL,useEmitterValue:ln,usePublisher:zu}),t8e=JTe,AF={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},r8e={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:TF,floor:Nj,max:Sv,min:wC,round:IF}=Math;function LF(t,e,r){return Array.from({length:e-t+1}).map((n,i)=>({data:r===null?null:r[i+t],index:i+t}))}function n8e(t){return{...r8e,items:t}}function n5(t,e){return t&&t.width===e.width&&t.height===e.height}function s8e(t,e){return t&&t.column===e.column&&t.row===e.row}const i8e=Qn(([{increaseViewportBy:t,listBoundary:e,overscan:r,visibleRange:n},{footerHeight:i,headerHeight:a,scrollBy:o,scrollContainerState:l,scrollTo:c,scrollTop:u,smoothScrollTargetReached:h,viewportHeight:p},m,g,{didMount:b,propsReady:v},{customScrollParent:w,useWindowScroll:j,windowScrollContainerState:_,windowScrollTo:E,windowViewportRect:I},O])=>{const B=Gt(0),S=Gt(0),T=Gt(AF),M=Gt({height:0,width:0}),$=Gt({height:0,width:0}),k=Pn(),L=Pn(),R=Gt(0),V=Gt(null),Y=Gt({column:0,row:0}),X=Pn(),J=Pn(),re=Gt(!1),se=Gt(0),ee=Gt(!0),q=Gt(!1),U=Gt(!1);as(Dt(b,fn(se),Ur(([ne,H])=>!!H)),()=>{cn(ee,!1)}),as(Dt(ga(b,ee,$,M,se,q),Ur(([ne,H,le,ye,,me])=>ne&&!H&&le.height!==0&&ye.height!==0&&!me)),([,,,,ne])=>{cn(q,!0),ML(1,()=>{cn(k,ne)}),Uu(Dt(u),()=>{cn(e,[0,0]),cn(ee,!0)})}),jr(Dt(J,Ur(ne=>ne!=null&&ne.scrollTop>0),jd(0)),S),as(Dt(b,fn(J),Ur(([,ne])=>ne!=null)),([,ne])=>{ne&&(cn(M,ne.viewport),cn($,ne.item),cn(Y,ne.gap),ne.scrollTop>0&&(cn(re,!0),Uu(Dt(u,gm(1)),H=>{cn(re,!1)}),cn(c,{top:ne.scrollTop})))}),jr(Dt(M,ar(({height:ne})=>ne)),p),jr(Dt(ga(Fr(M,n5),Fr($,n5),Fr(Y,(ne,H)=>ne&&ne.column===H.column&&ne.row===H.row),Fr(u)),ar(([ne,H,le,ye])=>({gap:le,item:H,scrollTop:ye,viewport:ne}))),X),jr(Dt(ga(Fr(B),n,Fr(Y,s8e),Fr($,n5),Fr(M,n5),Fr(V),Fr(S),Fr(re),Fr(ee),Fr(se)),Ur(([,,,,,,,ne])=>!ne),ar(([ne,[H,le],ye,me,ke,Ie,ce,,Be,ct])=>{const{column:Ve,row:Ne}=ye,{height:Ye,width:St}=me,{width:Vt}=ke;if(ce===0&&(ne===0||Vt===0))return AF;if(St===0){const Fe=DL(ct,ne),Ut=Fe+Math.max(ce-1,0);return n8e(LF(Fe,Ut,Ie))}const Lt=Hee(Vt,St,Ve);let at,gt;Be?H===0&&le===0&&ce>0?(at=0,gt=ce-1):(at=Lt*Nj((H+Ne)/(Ye+Ne)),gt=Lt*TF((le+Ne)/(Ye+Ne))-1,gt=wC(ne-1,Sv(gt,Lt-1)),at=wC(gt,Sv(0,at))):(at=0,gt=-1);const vt=LF(at,gt,Ie),{bottom:ft,top:ot}=PF(ke,ye,me,vt),ut=TF(ne/Lt),At=ut*Ye+(ut-1)*Ne-ft;return{bottom:ft,itemHeight:Ye,items:vt,itemWidth:St,offsetBottom:At,offsetTop:ot,top:ot}})),T),jr(Dt(V,Ur(ne=>ne!==null),ar(ne=>ne.length)),B),jr(Dt(ga(M,$,T,Y),Ur(([ne,H,{items:le}])=>le.length>0&&H.height!==0&&ne.height!==0),ar(([ne,H,{items:le},ye])=>{const{bottom:me,top:ke}=PF(ne,ye,H,le);return[ke,me]}),ri(a1)),e);const W=Gt(!1);jr(Dt(u,fn(W),ar(([ne,H])=>H||ne!==0)),W);const Z=vc(Dt(ga(T,B),Ur(([{items:ne}])=>ne.length>0),fn(W),Ur(([[ne,H],le])=>{const ye=ne.items[ne.items.length-1].index===H-1;return(le||ne.bottom>0&&ne.itemHeight>0&&ne.offsetBottom===0&&ne.items.length===H)&&ye}),ar(([[,ne]])=>ne-1),ri())),de=vc(Dt(Fr(T),Ur(({items:ne})=>ne.length>0&&ne[0].index===0),jd(0),ri())),be=vc(Dt(Fr(T),fn(re),Ur(([{items:ne},H])=>ne.length>0&&!H),ar(([{items:ne}])=>({endIndex:ne[ne.length-1].index,startIndex:ne[0].index})),ri(kee),Mh(0)));jr(be,g.scrollSeekRangeChanged),jr(Dt(k,fn(M,$,B,Y),ar(([ne,H,le,ye,me])=>{const ke=Aee(ne),{align:Ie,behavior:ce,offset:Be}=ke;let ct=ke.index;ct==="LAST"&&(ct=ye-1),ct=Sv(0,ct,wC(ye-1,ct));let Ve=xT(H,me,le,ct);return Ie==="end"?Ve=IF(Ve-H.height+le.height):Ie==="center"&&(Ve=IF(Ve-H.height/2+le.height/2)),Be&&(Ve+=Be),{behavior:ce,top:Ve}})),c);const oe=Jo(Dt(T,ar(ne=>ne.offsetBottom+ne.bottom)),0);return jr(Dt(I,ar(ne=>({height:ne.visibleHeight,width:ne.visibleWidth}))),M),{customScrollParent:w,data:V,deviation:R,footerHeight:i,gap:Y,headerHeight:a,increaseViewportBy:t,initialItemCount:S,itemDimensions:$,overscan:r,restoreStateFrom:J,scrollBy:o,scrollContainerState:l,scrollHeight:L,scrollTo:c,scrollToIndex:k,scrollTop:u,smoothScrollTargetReached:h,totalCount:B,useWindowScroll:j,viewportDimensions:M,windowScrollContainerState:_,windowScrollTo:E,windowViewportRect:I,...g,gridState:T,horizontalDirection:U,initialTopMostItemIndex:se,totalListHeight:oe,...m,endReached:Z,propsReady:v,rangeChanged:be,startReached:de,stateChanged:X,stateRestoreInProgress:re,...O}},ai(BL,jl,i2,Ree,G0,$L,W0));function Hee(t,e,r){return Sv(1,Nj((t+r)/(Nj(e)+r)))}function PF(t,e,r,n){const{height:i}=r;if(i===void 0||n.length===0)return{bottom:0,top:0};const a=xT(t,e,r,n[0].index);return{bottom:xT(t,e,r,n[n.length-1].index)+i,top:a}}function xT(t,e,r,n){const i=Hee(t.width,r.width,e.column),a=Nj(n/i),o=a*r.height+Sv(0,a-1)*e.row;return o>0?o+e.row:o}const a8e=Qn(()=>{const t=Gt(p=>`Item ${p}`),e=Gt({}),r=Gt(null),n=Gt("virtuoso-grid-item"),i=Gt("virtuoso-grid-list"),a=Gt(UL),o=Gt("div"),l=Gt(r2),c=(p,m=null)=>Jo(Dt(e,ar(g=>g[p]),ri()),m),u=Gt(!1),h=Gt(!1);return jr(Fr(h),u),{components:e,computeItemKey:a,context:r,FooterComponent:c("Footer"),HeaderComponent:c("Header"),headerFooterTag:o,itemClassName:n,ItemComponent:c("Item","div"),itemContent:t,listClassName:i,ListComponent:c("List","div"),readyStateChanged:u,reportReadyState:h,ScrollerComponent:c("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder","div")}}),o8e=Qn(([t,e])=>({...t,...e}),ai(i8e,a8e)),l8e=Pe.memo(function(){const t=pi("gridState"),e=pi("listClassName"),r=pi("itemClassName"),n=pi("itemContent"),i=pi("computeItemKey"),a=pi("isSeeking"),o=eu("scrollHeight"),l=pi("ItemComponent"),c=pi("ListComponent"),u=pi("ScrollSeekPlaceholder"),h=pi("context"),p=eu("itemDimensions"),m=eu("gap"),g=pi("log"),b=pi("stateRestoreInProgress"),v=eu("reportReadyState"),w=xm(Pe.useMemo(()=>j=>{const _=j.parentElement.parentElement.scrollHeight;o(_);const E=j.firstChild;if(E){const{height:I,width:O}=E.getBoundingClientRect();p({height:I,width:O})}m({column:OF("column-gap",getComputedStyle(j).columnGap,g),row:OF("row-gap",getComputedStyle(j).rowGap,g)})},[o,p,m,g]),!0,!1);return Uee(()=>{t.itemHeight>0&&t.itemWidth>0&&v(!0)},[t]),b?null:s.jsx(c,{className:e,ref:w,...Lo(c,h),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(j=>{const _=i(j.index,j.data,h);return a?s.jsx(u,{...Lo(u,h),height:t.itemHeight,index:j.index,width:t.itemWidth},_):y.createElement(l,{...Lo(l,h),className:r,"data-index":j.index,key:_},n(j.index,j.data,h))})})}),c8e=Pe.memo(function(){const t=pi("HeaderComponent"),e=eu("headerHeight"),r=pi("headerFooterTag"),n=xm(Pe.useMemo(()=>a=>{e(R0(a,"height"))},[e]),!0,!1),i=pi("context");return t?s.jsx(r,{ref:n,children:s.jsx(t,{...Lo(t,i)})}):null}),u8e=Pe.memo(function(){const t=pi("FooterComponent"),e=eu("footerHeight"),r=pi("headerFooterTag"),n=xm(Pe.useMemo(()=>a=>{e(R0(a,"height"))},[e]),!0,!1),i=pi("context");return t?s.jsx(r,{ref:n,children:s.jsx(t,{...Lo(t,i)})}):null}),d8e=({children:t})=>{const e=Pe.useContext(Fee),r=eu("itemDimensions"),n=eu("viewportDimensions"),i=xm(Pe.useMemo(()=>a=>{n(a.getBoundingClientRect())},[n]),!0,!1);return Pe.useEffect(()=>{e&&(n({height:e.viewportHeight,width:e.viewportWidth}),r({height:e.itemHeight,width:e.itemWidth}))},[e,n,r]),s.jsx("div",{ref:i,style:Lk(),children:t})},h8e=({children:t})=>{const e=Pe.useContext(Fee),r=eu("windowViewportRect"),n=eu("itemDimensions"),i=pi("customScrollParent"),a=bee(r,i,!1);return Pe.useEffect(()=>{e&&(n({height:e.itemHeight,width:e.itemWidth}),r({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,r,n]),s.jsx("div",{ref:a,style:Lk(),children:t})},f8e=Pe.memo(function({...t}){const e=pi("useWindowScroll"),r=pi("customScrollParent"),n=r||e?g8e:m8e,i=r||e?h8e:d8e,a=pi("context");return s.jsx(n,{...t,...Lo(n,a),children:s.jsxs(i,{children:[s.jsx(c8e,{}),s.jsx(l8e,{}),s.jsx(u8e,{})]})})}),{Component:p8e,useEmitter:Wee,useEmitterValue:pi,usePublisher:eu}=Bee(o8e,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},f8e),m8e=qee({useEmitter:Wee,useEmitterValue:pi,usePublisher:eu}),g8e=Vee({useEmitter:Wee,useEmitterValue:pi,usePublisher:eu});function OF(t,e,r){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&r(`${t} was not resolved to pixel value correctly`,e,wc.WARN),e==="normal"?0:parseInt(e??"0",10)}const RF=p8e;function Gee(){const{currentUser:t}=Or();Lm();const e=["binders",{userId:t?.uid}],{data:r=[],isLoading:n,refetch:i}=U1({queryKey:e,queryFn:async()=>t?await Ge.getBinders():[],enabled:!!t,staleTime:1e3*60*5});return{binders:r,loading:n,refreshBinders:i}}const NC={W:{name:"White",flavor:"A single spark of light can banish a world of shadows.",theme:"Absolute Order",pips:["W"],bg:"bg-yellow-600"},U:{name:"Blue",flavor:"The mind is the only battlefield where victory is absolute.",theme:"Infinite Inquiry",pips:["U"],bg:"bg-blue-600"},B:{name:"Black",flavor:"Power at any cost, for greatness is written in blood.",theme:"Unrestricted Power",pips:["B"],bg:"bg-gray-800"},R:{name:"Red",flavor:"Do not fear the fire; fear the heart that commands it.",theme:"Chaotic Passion",pips:["R"],bg:"bg-red-600"},G:{name:"Green",flavor:"The forest does not ask for permission to grow.",theme:"Primal Growth",pips:["G"],bg:"bg-green-600"},C:{name:"Colorless",flavor:"Existence is a fleeting dream in the eyes of the silent.",theme:"The Great Void",pips:["C"],bg:"bg-gray-500"},WU:{name:"Azorius Senate",flavor:"Justice is blind, but she has a very long reach.",theme:"Bureaucratic Control",pips:["W","U"],bg:"bg-gradient-to-br from-yellow-300 to-blue-500"},UB:{name:"House Dimir",flavor:"The finest secrets are those that kill the ones who keep them.",theme:"Subterfuge & Infiltration",pips:["U","B"],bg:"bg-gradient-to-br from-blue-600 to-black"},BR:{name:"Cult of Rakdos",flavor:"Entertain us, or become the entertainment.",theme:"Carnival of Carnage",pips:["B","R"],bg:"bg-gradient-to-br from-black to-red-600"},RG:{name:"Gruul Clans",flavor:"Not for city-dwellers. Not for the weak. Only for the wild.",theme:"Primal Destruction",pips:["R","G"],bg:"bg-gradient-to-br from-red-500 to-green-600"},WG:{name:"Selesnya Conclave",flavor:"One voice is a whisper; the Conclave is a roar.",theme:"Collective Harmony",pips:["W","G"],bg:"bg-gradient-to-br from-green-500 to-yellow-200"},WB:{name:"Orzhov Syndicate",flavor:"Even death is no excuse for a breach of contract.",theme:"Indentured Eternity",pips:["W","B"],bg:"bg-gradient-to-br from-gray-200 to-gray-900"},BG:{name:"Golgari Swarm",flavor:"Every grave is a garden if you wait long enough.",theme:"Cycles of Rot",pips:["B","G"],bg:"bg-gradient-to-br from-gray-900 to-green-600"},UG:{name:"Simic Combine",flavor:"Nature is a rough draft; we are the final edit.",theme:"Biological Evolution",pips:["U","G"],bg:"bg-gradient-to-br from-green-400 to-blue-500"},UR:{name:"Izzet League",flavor:"If it doesn't explode, you aren't trying hard enough.",theme:"Volatile Genius",pips:["U","R"],bg:"bg-gradient-to-br from-blue-500 to-red-500"},WR:{name:"Boros Legion",flavor:"First to the fight, last to the fall.",theme:"Tactical Aggression",pips:["W","R"],bg:"bg-gradient-to-br from-red-600 to-yellow-200"},WUG:{name:"Bant",flavor:"The sigil of the sun protects those who stand together.",theme:"Knightly Order",pips:["W","U","G"],bg:"bg-gradient-to-r from-green-400 via-yellow-200 to-blue-400"},WUB:{name:"Esper",flavor:"Perfection is not a goal; it is a requirement.",theme:"Obsidian Logic",pips:["W","U","B"],bg:"bg-gradient-to-r from-yellow-200 via-blue-400 to-black"},UBR:{name:"Grixis",flavor:"A wasteland of power where only the cruelest thrive.",theme:"Ruthless Tyranny",pips:["U","B","R"],bg:"bg-gradient-to-r from-blue-600 via-black to-red-600"},BRG:{name:"Jund",flavor:"In this world, you are either the dragon or the meal.",theme:"Apex Predation",pips:["B","R","G"],bg:"bg-gradient-to-r from-black via-red-600 to-green-600"},WRG:{name:"Naya",flavor:"Where the mountains wake and the earth trembles.",theme:"Primal Majesty",pips:["W","R","G"],bg:"bg-gradient-to-r from-red-500 via-green-500 to-yellow-200"},WBG:{name:"Abzan",flavor:"We do not break; we simply outlast.",theme:"Eternal Endurance",pips:["W","B","G"],bg:"bg-gradient-to-r from-yellow-100 via-black to-green-600"},WUR:{name:"Jeskai",flavor:"The wind carries the strike; the mind guides the bolt.",theme:"Disciplined Spark",pips:["W","U","R"],bg:"bg-gradient-to-r from-blue-500 via-red-500 to-yellow-100"},UBG:{name:"Sultai",flavor:"Power is measured in gold and the bones of the fallen.",theme:"Opulent Decay",pips:["U","B","G"],bg:"bg-gradient-to-r from-black via-green-600 to-blue-600"},WBR:{name:"Mardu",flavor:"Victory is the only law worth following.",theme:"Relentless Conquest",pips:["W","B","R"],bg:"bg-gradient-to-r from-red-600 via-yellow-100 to-black"},URG:{name:"Temur",flavor:"The wild does not think; it reacts with ice and fire.",theme:"Elemental Instinct",pips:["U","R","G"],bg:"bg-gradient-to-r from-green-500 via-blue-500 to-red-500"},UBRG:{name:"Glint-Eye",flavor:"Order is a cage; we have chosen to break the locks.",theme:"Chaotic Adaptation",pips:["U","B","R","G"],bg:"bg-indigo-900"},WBRG:{name:"Dune-Brood",flavor:"When the logic of the mind fails, the instinct of the swarm prevails.",theme:"Sandless Conquest",pips:["W","B","R","G"],bg:"bg-orange-900"},WURG:{name:"Ink-Treader",flavor:"To touch one is to touch the whole of the world.",theme:"Radiant Reflection",pips:["W","U","R","G"],bg:"bg-sky-900"},WUBG:{name:"Witch-Maw",flavor:"There is a hunger beneath the earth that knows no fire.",theme:"Eldritch Growth",pips:["W","U","B","G"],bg:"bg-emerald-900"},WUBR:{name:"Yore-Tiller",flavor:"The past is a weapon we sharpen for the future.",theme:"Relentless History",pips:["W","U","B","R"],bg:"bg-slate-900"},WUBRG:{name:"WUBRG",flavor:"The full spectrum of power, bound in a single hand.",theme:"The Convergence",pips:["W","U","B","R","G"],bg:"bg-gradient-to-r from-yellow-500 via-blue-500 to-green-500"}},x8e=t=>{if(!t)return NC.C;const e={W:0,U:1,B:2,R:3,G:4,C:-1};let r=Array.isArray(t)?t:t.split("");const i=[...new Set(r)].filter(a=>e[a]!==void 0&&a!=="C").sort((a,o)=>e[a]-e[o]).join("");return NC[i]||NC.C},uN=({options:t=[],selected:e=[],onChange:r,placeholder:n="Select...",label:i})=>{const[a,o]=y.useState(!1),[l,c]=y.useState(""),u=y.useRef(null);y.useEffect(()=>{const m=g=>{u.current&&!u.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const h=t.filter(m=>m.label.toLowerCase().includes(l.toLowerCase())),p=m=>{const g=e.includes(m)?e.filter(b=>b!==m):[...e,m];r(g)};return s.jsxs("div",{className:"relative",ref:u,children:[i&&s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:i}),s.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-left text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent flex justify-between items-center",children:[s.jsx("span",{className:"truncate",children:e.length===0?n:`${e.length} selected`}),s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&s.jsxs("div",{className:"absolute z-50 mt-2 w-full bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl max-h-68 flex flex-col overflow-hidden animate-fade-in-down",children:[s.jsx("div",{className:"p-3 border-b border-white/5",children:s.jsx("input",{type:"text",placeholder:"Filter options...",className:"w-full bg-gray-950/50 border border-gray-800 rounded-xl px-3 py-2 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 placeholder-gray-600",value:l,onChange:m=>c(m.target.value),autoFocus:!0})}),s.jsx("div",{className:"overflow-y-auto flex-1 p-2 custom-scrollbar",children:h.length===0?s.jsx("div",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest p-4 text-center",children:"No results found"}):h.map(m=>s.jsxs("div",{onClick:()=>p(m.value),className:`
                                        flex items-center gap-3 px-3 py-2 rounded-xl cursor-pointer text-xs font-medium transition-all
                                        ${e.includes(m.value)?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/40":"text-gray-400 hover:bg-white/5 hover:text-white"}
                                    `,children:[s.jsx("div",{className:`w-4 h-4 rounded-md border transition-all flex items-center justify-center ${e.includes(m.value)?"bg-white border-white scale-110":"border-gray-700 bg-gray-950/50"}`,children:e.includes(m.value)&&s.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:"truncate",children:m.label})]},m.value))})]})]})},qL=()=>s.jsx("div",{className:"relative aspect-[2.5/3.5] bg-gray-800 rounded-lg overflow-hidden border border-gray-700 animate-pulse",children:s.jsx("div",{className:"absolute inset-0 bg-gray-700/50"})}),bT=({src:t,alt:e,className:r,placeholder:n})=>{const[i,a]=y.useState(!1),[o,l]=y.useState(!1),c=()=>{a(!0)},u=()=>{l(!0),a(!0)};return s.jsxs("div",{className:`relative overflow-hidden ${r} bg-gray-900`,children:[!i&&s.jsx("div",{className:"absolute inset-0 z-0",children:n||s.jsx(qL,{})}),s.jsx("img",{src:o?"https://placehold.co/250x350?text=No+Image":t,alt:e,className:`
                    w-full h-full object-cover transition-opacity duration-500 ease-out
                    ${i?"opacity-100":"opacity-0"}
                `,onLoad:c,onError:u,loading:"lazy"})]})},Qx=y.memo(function({card:e,availableFoils:r,onRemove:n,showQuantity:i=!0,onClick:a,decks:o=[],ownerName:l,currentUser:c,showOwnerTag:u=!1,hideDeckTag:h=!1,hideOwnerTag:p=!1,selectMode:m=!1,isSelected:g=!1,onToggleSelect:b}){const[v,w]=y.useState(!1),{openCardModal:j}=z1(),_=o?.find(k=>k.id===e.deck_id)?.name,E=l||e.owner_username||(c&&(e.owner_id===c.id||e.user_id===c.id)?c.username||"ME":null),I=k=>parseFloat(e.prices?.[k]||e.data?.prices?.[k])||0,O=(k,L=0)=>{if(!k)return"https://placehold.co/250x350?text=No+Image";const R=k.data||k;return R.card_faces&&R.card_faces.length>1&&R.card_faces[L]?.image_uris?.normal?R.card_faces[L].image_uris.normal:R.image_uris?.normal||k.image_uri||"https://placehold.co/250x350?text=No+Image"},B=e.data?.card_faces?.length>1&&e.data?.card_faces?.[1]?.image_uris||e.card_faces?.length>1&&e.card_faces?.[1]?.image_uris,S=O(e,0),T=B?O(e,1):null,M=e.countInDeck||e.quantity||e.count||1,$=k=>{if(k.stopPropagation(),m&&b){b(e.id);return}a?a(e):j(e)};return s.jsx("div",{className:`relative group perspective-1000 h-full w-full aspect-[2.5/3.5] min-h-[200px] cursor-pointer ${g?"ring-4 ring-indigo-500 rounded-xl":""}`,onClick:$,children:s.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${v?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx(bT,{src:S,alt:e.name,className:"w-full h-full rounded-lg"}),i&&M>1&&s.jsxs("div",{className:"absolute top-1.5 right-1.5 bg-black/80 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-sm z-20",children:["x",M]}),!h&&_&&s.jsxs("div",{className:"absolute top-[3.75rem] left-1.5 max-w-[80%] bg-indigo-600/90 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow-lg z-20 backdrop-blur-md border border-indigo-400/50 truncate uppercase tracking-tight",title:`In deck: ${_}`,children:[" ",_]}),!p&&u&&E&&s.jsxs("div",{className:`absolute ${_?"top-[5.25rem]":"top-[3.75rem]"} left-1.5 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-20 backdrop-blur-md uppercase tracking-wider`,children:[" ",E]}),e.finish==="foil"?s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-yellow-500/80 text-yellow-100 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-300/50",children:""}):e.is_wishlist?s.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-600/90 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-orange-400/50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"WISH"]}):r?.has(e.name)&&s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-gray-700/90 text-yellow-400 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-500/30 cursor-help",title:"Foil copy available in collection",children:""}),s.jsx("div",{className:"absolute bottom-1.5 left-1.5 right-1.5 bg-black/70 backdrop-blur-md px-2 py-1 rounded border border-white/10 z-20 text-[9px] font-mono flex items-center justify-center",children:s.jsxs("span",{className:e.finish==="foil"?"text-yellow-400":"text-green-400",children:["$",(e.finish==="foil"?I("usd_foil")||I("usd"):I("usd")||I("usd_foil")).toFixed(2)]})}),m&&s.jsx("div",{className:`absolute inset-0 z-40 transition-all duration-200 flex items-center justify-center ${g?"bg-indigo-500/20":"bg-black/40 hover:bg-black/20"}`,children:s.jsx("div",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all scale-110 ${g?"bg-indigo-500 border-indigo-500 text-white":"border-white/50 bg-black/40"}`,children:g&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})}),!m&&s.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-300 z-30",children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/95 to-transparent p-3 pt-6",children:[s.jsx("p",{className:"font-black text-sm text-white leading-tight line-clamp-1 drop-shadow-lg mb-2",children:e.name}),s.jsx("div",{className:"flex items-center gap-2 mb-3",children:s.jsxs("div",{className:`flex items-center gap-1.5 border rounded-lg px-2.5 py-1 backdrop-blur-md ${e.finish==="foil"?"bg-yellow-500/20 border-yellow-500/40":"bg-green-500/20 border-green-500/40"}`,children:[s.jsx("svg",{className:`w-3 h-3 ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("span",{className:`text-xs font-bold font-mono ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,children:["$",(e.finish==="foil"?I("usd_foil")||I("usd"):I("usd")||I("usd_foil")).toFixed(2)]})]})}),s.jsxs("div",{className:"flex gap-1.5",children:[s.jsxs("button",{onClick:$,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 text-white font-bold py-2 px-3 rounded-lg transition-all duration-200 flex items-center justify-center gap-1.5 shadow-lg hover:shadow-indigo-500/50 active:scale-95",children:[s.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),s.jsx("span",{className:"text-[10px] uppercase tracking-wider font-black",children:"View"})]}),B&&s.jsx("button",{onClick:k=>{k.stopPropagation(),w(!v)},className:"bg-gray-700/90 hover:bg-gray-600 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-gray-500/30 active:scale-95",title:"Flip",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),n&&s.jsx("button",{onClick:k=>{k.stopPropagation(),n(e.firestoreId||e.id,e.name)},className:"bg-red-600/90 hover:bg-red-500 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-red-500/50 active:scale-95",title:"Remove",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})]}),B&&s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx(bT,{src:T,alt:`${e.name} (Back)`,className:"w-full h-full rounded-lg"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:e.name})}),s.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"Click to Flip"})]})]})]})})}),b8e=({cards:t,isMixed:e})=>{const[r,n]=y.useState({key:"name",direction:"asc"}),i=y.useMemo(()=>{let c=[...t];return r.key&&c.sort((u,h)=>{let p=u[r.key],m=h[r.key];return r.key==="price"?(p=parseFloat(u.prices?.usd||0),m=parseFloat(h.prices?.usd||0)):r.key==="type"?(p=u.type_line||"",m=h.type_line||""):r.key==="set"&&(p=u.set_name||"",m=h.set_name||""),p<m?r.direction==="asc"?-1:1:p>m?r.direction==="asc"?1:-1:0}),c},[t,r]),a=c=>{let u="asc";r.key===c&&r.direction==="asc"&&(u="desc"),n({key:c,direction:u})},o=c=>r.key!==c?s.jsx("svg",{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):r.direction==="asc"?s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),l=({label:c,sortKey:u,className:h=""})=>s.jsx("th",{className:`px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group hover:text-white transition-colors select-none bg-gray-900 border-b border-gray-800 ${h}`,onClick:()=>a(u),children:s.jsxs("div",{className:"flex items-center gap-2",children:[c,o(u)]})});return s.jsx("div",{className:"h-[calc(100vh-300px)] w-full bg-gray-950/40 rounded-2xl overflow-hidden border border-white/5 backdrop-blur-md",children:s.jsx(t8e,{data:i,components:{Table:c=>s.jsx("table",{...c,className:"w-full min-w-[1000px] border-collapse"}),TableRow:c=>s.jsx("tr",{...c,className:"group hover:bg-gray-800/30 transition-colors border-b border-gray-800/50"})},fixedHeaderContent:()=>s.jsxs("tr",{className:"bg-gray-900",children:[s.jsx(l,{label:"Card Name",sortKey:"name"}),s.jsx(l,{label:"Set",sortKey:"set"}),s.jsx(l,{label:"Type",sortKey:"type"}),s.jsx(l,{label:"Rarity",sortKey:"rarity"}),s.jsx(l,{label:"Market Price",sortKey:"price"}),s.jsx(l,{label:"Paid",sortKey:"price_bought"}),e&&s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider bg-gray-900 border-b border-gray-800",children:"Owner"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider bg-gray-900 border-b border-gray-800",children:"Tags"})]}),itemContent:(c,u)=>s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0 relative rounded overflow-hidden mr-4 border border-gray-700 bg-gray-900 group-hover:scale-150 group-hover:z-10 transition-all origin-left",children:s.jsx(bT,{src:u.image_uri||u.image_uris?.small,alt:"",className:"h-full w-full object-cover",placeholder:s.jsx("div",{className:"w-full h-full bg-gray-800 animate-pulse"})})}),s.jsxs("div",{className:"ml-0",children:[s.jsx("div",{className:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors",children:u.name}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["x",u.count]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300 border border-gray-700",children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3 text-indigo-400",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),u.set_name]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 truncate max-w-[200px]",title:u.type_line,children:u.type_line}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`
                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide
                                    ${u.rarity==="mythic"?"text-orange-400 bg-orange-900/10 border border-orange-500/20":u.rarity==="rare"?"text-yellow-400 bg-yellow-900/10 border border-yellow-500/20":u.rarity==="uncommon"?"text-blue-400 bg-blue-900/10 border border-blue-500/20":"text-gray-400 bg-gray-800 border border-gray-700"}
                                `,children:u.rarity})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-mono",children:["$",parseFloat(u.prices?.usd||0).toFixed(2)]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono",children:u.price_bought?`$${parseFloat(u.price_bought).toFixed(2)}`:"-"}),e&&s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center gap-2",title:u.owner_username,children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white text-[10px] font-bold",children:u.owner_username?u.owner_username[0].toUpperCase():"?"}),s.jsx("span",{className:"text-xs text-gray-400 truncate max-w-[80px]",children:u.owner_username})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[(u.tags&&typeof u.tags=="string"?JSON.parse(u.tags):u.tags||[]).map((h,p)=>s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:h},p)),(!u.tags||Array.isArray(u.tags)&&u.tags.length===0)&&s.jsx("span",{className:"text-gray-600 text-xs italic",children:"No tags"})]})})]})})})},y8e=({mode:t,onChange:e})=>s.jsxs("div",{className:"bg-gray-900 p-1 rounded-xl flex border border-gray-800",children:[s.jsx("button",{onClick:()=>e("folder"),className:`p-2 rounded-lg transition-all ${t==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Folder Group View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),s.jsx("button",{onClick:()=>e("grid"),className:`p-2 rounded-lg transition-all ${t==="grid"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>e("table"),className:`p-2 rounded-lg transition-all ${t==="table"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Table List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]}),v8e=({isOpen:t,onClose:e})=>{const{currentUser:r}=Or(),{addToast:n}=jn(),{refreshCollection:i}=vl(),[a,o]=y.useState(""),[l,c]=y.useState([]),[u,h]=y.useState(!1),[p,m]=y.useState("input"),[g,b]=y.useState([]),[v,w]=y.useState(""),[j,_]=y.useState(!1),[E,I]=y.useState([]),O=y.useRef(null),B=k=>{const L=k.trim();if(!L)return null;const R=L.split(/[,\t]/).map(re=>re.trim());if(R.length<1)return null;const V=R[0],Y=R[1]||null,X=R[2]||null,J=R[3]||null;return{count:1,name:V,set:Y,collector_number:X,tag:J,mode:"unified"}},S=async()=>{if(a.trim()){h(!0);try{const L=a.split(`
`).map(B).filter(Boolean),R=await Promise.all(L.map(async V=>{try{let Y="";if(V.set&&V.collector_number)Y=`https://api.scryfall.com/cards/${V.set.toLowerCase()}/${V.collector_number}`;else{let J=V.name;V.set&&(J+=` set:${V.set}`),Y=`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(J)}`}const X=await fetch(Y);if(X.ok){const J=await X.json();return{...V,valid:!0,scryfallId:J.id,data:J,image:J.image_uris?.small||J.card_faces?.[0]?.image_uris?.small}}else{if(V.set&&V.collector_number){const J=await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(V.name)}`);if(J.ok){const re=await J.json();return{...V,valid:!0,scryfallId:re.id,data:re,image:re.image_uris?.small||re.card_faces?.[0]?.image_uris?.small,warning:"Exact match failed, found by name."}}}return{...V,valid:!1}}}catch{return{...V,valid:!1}}}));c(R),m("preview")}catch{n("Failed to parse cards","error")}finally{h(!1)}}},T=k=>{const L=k.target.files[0];if(!L)return;const R=new FileReader;R.onload=V=>{o(V.target.result)},R.readAsText(L)},M=async()=>{_(!0);const k=l.filter(L=>L.valid);try{const L=k.map(Y=>{const X=[...g];return Y.tag&&!X.includes(Y.tag)&&X.push(Y.tag),{name:Y.data.name,scryfall_id:Y.scryfallId,set_code:Y.data.set,collector_number:Y.data.collector_number,image_uri:Y.data.image_uris?.normal||Y.data.card_faces?.[0]?.image_uris?.normal,count:Y.count,data:Y.data,tags:JSON.stringify(X)}}),R=await r.getIdToken();if(!(await fetch("http://localhost:3000/api/collection/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify({cards:L,mode:"merge"})})).ok)throw new Error("Import failed");I(L),m("success"),i(),n(`Successfully imported ${k.length} cards!`,"success")}catch(L){console.error(L),n("Import failed. Check console.","error")}finally{_(!1)}},$=k=>{k.key==="Enter"&&v.trim()&&(g.includes(v.trim())||b([...g,v.trim()]),w(""))};return t?Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:p==="success"?"Import Complete":"Bulk Import"}),s.jsx("p",{className:"text-gray-400",children:p==="success"?`Successfully added ${E.length} cards to your collection.`:"Import cards from CSV or text list."})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[p==="input"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl text-blue-200 text-sm",children:[s.jsx("p",{className:"font-bold mb-2",children:"Supported Formats:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"CSV (Recommended)"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Black Lotus, LEA, 1, Power 9"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"Text List"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Command Tower, CMD, , Base"]})]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>O.current.click(),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-lg text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload CSV / Text File"]}),s.jsx("input",{type:"file",ref:O,onChange:T,accept:".csv,.txt",className:"hidden"})]}),s.jsx("textarea",{value:a,onChange:k=>o(k.target.value),placeholder:"Paste your list here...",className:"w-full h-80 bg-gray-800/50 border border-gray-700 text-gray-200 p-4 rounded-xl font-mono focus:ring-2 focus:ring-indigo-500 outline-none resize-none text-sm"})]}),p==="preview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Apply Tags to Batch"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[g.map(k=>s.jsxs("span",{className:"bg-indigo-600 text-white px-2 py-1 rounded text-sm flex items-center gap-1",children:[k,s.jsx("button",{onClick:()=>b(g.filter(L=>L!==k)),className:"hover:text-red-300",children:""})]},k)),s.jsx("input",{type:"text",placeholder:"Type tag & Enter...",value:v,onChange:k=>w(k.target.value),onKeyDown:$,className:"bg-transparent border-none focus:ring-0 text-white placeholder-gray-600 text-sm min-w-[120px]"})]})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Matched Tag"}),s.jsx("th",{className:"p-3 text-right",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:l.map((k,L)=>s.jsxs("tr",{className:k.valid?"":"bg-red-900/10",children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[k.image?s.jsx("img",{src:k.image,className:"w-8 h-8 rounded object-cover",alt:""}):s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded flex items-center justify-center text-xs",children:"?"}),s.jsxs("div",{children:[s.jsx("div",{className:k.valid?"text-white font-bold":"text-red-400 line-through",children:k.name}),k.warning&&s.jsx("div",{className:"text-[10px] text-yellow-500",children:k.warning})]})]}),s.jsx("td",{className:"p-3",children:k.data?.set_name||k.set||"-"}),s.jsx("td",{className:"p-3 text-center font-mono",children:k.count}),s.jsx("td",{className:"p-3",children:k.tag&&s.jsx("span",{className:"text-xs bg-gray-700 px-1 rounded text-gray-300",children:k.tag})}),s.jsx("td",{className:"p-3 text-right",children:k.valid?s.jsx("span",{className:"text-green-400",children:"Ready"}):s.jsx("span",{className:"text-red-500",children:"Not Found"})})]},L))})]})})]}),p==="success"&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-4 rounded-xl text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-2",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Import Successful!"}),s.jsx("p",{className:"text-green-200 text-sm",children:"Your new cards have been added to the collection."})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800 max-h-[50vh] overflow-y-auto",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold sticky top-0 bg-gray-900 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Applied Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:E.map((k,L)=>s.jsxs("tr",{children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[s.jsx("img",{src:k.image_uri,className:"w-8 h-8 rounded object-cover",alt:""}),s.jsx("span",{className:"text-white font-bold",children:k.name})]}),s.jsx("td",{className:"p-3",children:k.set_code?.toUpperCase()}),s.jsx("td",{className:"p-3 text-center font-mono",children:k.count}),s.jsx("td",{className:"p-3",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:JSON.parse(k.tags).map(R=>s.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:R},R))})})]},L))})]})})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-900/50 rounded-b-2xl",children:p==="input"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:e,className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Cancel"}),s.jsx("button",{onClick:S,disabled:u||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:u?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Review Cards"]}):"Review Cards"})]}):p==="preview"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>m("input"),className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Back to Edit"}),s.jsx("button",{onClick:M,disabled:j||l.filter(k=>k.valid).length===0,className:"bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:j?"Importing...":`Import ${l.filter(k=>k.valid).length} Cards`})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{}),s.jsx("button",{onClick:e,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg",children:"Done"})]})})]})}),document.body):null},w8e=t=>{const e=t.toLowerCase(),r=[];let n="Smart Binder",i="",a="blue",o=`Generated from "${t}"`;(e.includes("red")||e.includes("fire")||e.includes("mountain")||e.includes("burn"))&&(a="red",e.includes("goblin")||(n="Red Collection")),(e.includes("green")||e.includes("forest")||e.includes("elf")||e.includes("nature"))&&(a="green",e.includes("elf")||(n="Green Collection")),(e.includes("blue")||e.includes("island")||e.includes("control")||e.includes("water"))&&(a="blue",n="Blue Collection"),(e.includes("black")||e.includes("swamp")||e.includes("death")||e.includes("grave"))&&(a="purple",n="Black Collection"),(e.includes("white")||e.includes("plains")||e.includes("light")||e.includes("angel"))&&(a="gray",n="White Collection"),e.includes("commander")||e.includes("legend")||e.includes("edh")?(r.push({field:"type",operator:"contains",value:"Legendary Creature"}),i="",n="Commanders",(e.includes("potential")||e.includes("candidate"))&&(n="Potential Commanders")):e.includes("creature")&&(r.push({field:"type",operator:"contains",value:"Creature"}),n==="Smart Binder"&&(n="Creatures",i="")),e.includes("land")&&(r.push({field:"type",operator:"contains",value:"Land"}),i="",n="Lands"),(e.includes("artifact")||e.includes("rock"))&&(r.push({field:"type",operator:"contains",value:"Artifact"}),i="",n="Artifacts"),e.includes("enchantment")&&(r.push({field:"type",operator:"contains",value:"Enchantment"}),i="",n="Enchantments"),e.includes("goblin")&&(r.push({field:"type",operator:"contains",value:"Goblin"}),i="",n="Goblin Tribe",a="red"),(e.includes("elf")||e.includes("elves"))&&(r.push({field:"type",operator:"contains",value:"Elf"}),i="",n="Elven Tribe",a="green"),e.includes("not in deck")||e.includes("unused")||e.includes("spare")||e.includes("binder fodder")?(r.push({field:"in_deck",operator:"is",value:"false"}),n==="Smart Binder"?n="Unused Cards":n=`Unused ${n}`):(e.includes("in deck")||e.includes("used")||e.includes("active"))&&(r.push({field:"in_deck",operator:"is",value:"true"}),n=`Active ${n}`),(e.includes("expensive")||e.includes("value")||e.includes("money")||e.includes("high end")||e.includes("sell")&&!e.includes("not")&&!e.includes("dont")&&!e.includes("wouldnt"))&&(r.push({field:"price",operator:"gt",value:"5.00"}),i="",n.includes("Commander")||(n="High Value")),(e.includes("bulk")||e.includes("cheap")||e.includes("pauper")||e.includes("sell")&&(e.includes("not")||e.includes("dont")||e.includes("wouldnt")))&&(r.push({field:"price",operator:"lt",value:"1.00"}),i="",n="Bulk Storage"),e.includes("trade")&&(r.some(c=>c.field==="in_deck")||r.push({field:"in_deck",operator:"is",value:"false"}),n="Trade Binder",i="");const l=[];return e.includes("rare")&&l.push("rare"),e.includes("mythic")&&l.push("mythic"),l.length>0&&(r.push({field:"rarity",operator:"in",value:l}),(!i||i==="")&&(i="")),(e.includes("duplicate")||e.includes("playset")||e.includes("extra")||e.includes("few of")||e.includes("many"))&&(r.push({field:"count",operator:"gt",value:"4"}),n==="Smart Binder"&&(n="Trade Stock"),i=""),r.length===0&&r.push({field:"name",operator:"contains",value:t}),{id:`ai-${Date.now()}`,name:n,description:o,icon:i,color:a,rules:r}},s5={string:[{id:"contains",label:"contains"},{id:"is",label:"is exactly"},{id:"not",label:"is not"}],number:[{id:"gt",label:"is greater than"},{id:"lt",label:"is less than"},{id:"eq",label:"is exactly"}],select:[{id:"in",label:"is one of"},{id:"not_in",label:"is none of"}],color:[{id:"contains",label:"contains"},{id:"contains_any",label:"contains any of"},{id:"is_exactly",label:"is exactly"}],boolean:[{id:"is",label:"is"}]},i5=[{id:"name",label:"Name",type:"string"},{id:"colors",label:"Color Identity",type:"color"},{id:"rarity",label:"Rarity",type:"select",options:["common","uncommon","rare","mythic"]},{id:"type",label:"Type Line",type:"string"},{id:"price",label:"Market Price ($)",type:"number"},{id:"cmc",label:"Mana Value (CMC)",type:"number"},{id:"set",label:"Set Code",type:"string"},{id:"count",label:"Quantity",type:"number"},{id:"in_deck",label:"In a Deck?",type:"boolean",options:[{id:"true",label:"In a Deck"},{id:"false",label:"Not in a Deck"}]}],N8e=({rules:t=[],onChange:e})=>{const r=Array.isArray(t)?t:[],[n,i]=y.useState(!1),a=()=>{const u={field:"name",operator:"contains",value:""};e([...r,u])},o=(u,h)=>{const p=[...r];if(p[u]={...p[u],...h},h.field){const m=i5.find(b=>b.id===h.field),g=s5[m.type]||s5.string;p[u].operator=g[0].id,p[u].value=m.type==="select"?[]:m.type==="color"?[]:m.type==="boolean"?m.options[0].id:""}e(p)},l=u=>{e(r.filter((h,p)=>p!==u))},c=(u,h)=>{const p=r[u].value||[],m=p.includes(h)?p.filter(g=>g!==h):[...p,h].sort((g,b)=>"WUBRG".indexOf(g)-"WUBRG".indexOf(b));o(u,{value:m})};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-500",children:"Logic Rules"}),s.jsx("button",{onClick:a,className:"text-[10px] font-bold bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 px-3 py-1 rounded-full hover:bg-indigo-600 hover:text-white transition-all",children:"+ Add Condition"})]}),s.jsxs("div",{className:"space-y-3",children:[r.map((u,h)=>{const p=i5.find(g=>g.id===u.field)||i5[0],m=s5[p.type]||s5.string;return s.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center gap-2 bg-gray-950/40 p-3 rounded-2xl border border-gray-800/50 hover:border-gray-700 transition-all",children:[s.jsx("div",{className:"w-12 text-[10px] font-black uppercase text-indigo-500/60",children:h===0?"IF":"AND"}),s.jsx("select",{value:u.field,onChange:g=>o(h,{field:g.target.value}),className:"bg-gray-950/50 border border-white/5 text-white text-xs font-black rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:i5.map(g=>s.jsx("option",{value:g.id,children:g.label},g.id))}),s.jsx("select",{value:u.operator,onChange:g=>o(h,{operator:g.target.value}),className:"bg-gray-950/50 border border-white/5 text-indigo-400 text-xs font-bold rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:m.map(g=>s.jsx("option",{value:g.id,children:g.label},g.id))}),s.jsx("div",{className:"flex-1 min-w-[150px]",children:p.type==="color"?s.jsx("div",{className:"flex gap-1",children:"WUBRGC".split("").map(g=>s.jsx("button",{onClick:()=>c(h,g),className:`w-7 h-7 rounded-full flex items-center justify-center transition-all border ${u.value?.includes(g)?"bg-indigo-600 border-indigo-400 shadow-[0_0_10px_rgba(79,70,229,0.4)]":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-500"}`,children:s.jsx("i",{className:`ms ms-${g.toLowerCase()} ms-cost text-xs ${u.value?.includes(g)?"text-white":""}`})},g))}):p.type==="select"?s.jsx("div",{className:"flex flex-wrap gap-1",children:p.options.map(g=>s.jsx("button",{onClick:()=>{const b=u.value||[],v=b.includes(g)?b.filter(w=>w!==g):[...b,g];o(h,{value:v})},className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase transition-all border ${u.value?.includes(g)?"bg-indigo-600/20 border-indigo-500 text-indigo-400":"bg-gray-800 border-gray-700 text-gray-500"}`,children:g},g))}):p.type==="boolean"?s.jsx("div",{className:"flex gap-1",children:p.options.map(g=>s.jsx("button",{onClick:()=>o(h,{value:g.id}),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all border ${u.value===g.id?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-600"}`,children:g.label},g.id))}):s.jsx("input",{type:p.type==="number"?"number":"text",value:u.value,placeholder:"Value...",onChange:g=>o(h,{value:g.target.value}),className:"w-full bg-gray-900/50 border-none text-white text-xs rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 outline-none"})}),s.jsx("button",{onClick:()=>l(h),className:"p-1 px-2 text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all text-sm",title:"Remove Rule",children:""})]},h)}),r.length===0&&s.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium italic",children:"No rules defined. This binder will be empty or use manual selection."}),s.jsx("button",{onClick:a,className:"text-indigo-400 text-xs font-bold mt-2 hover:underline",children:"+ Click to create your first rule"})]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-indigo-950/10 border border-indigo-900/20 rounded-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Binder Recipe Output"})]}),s.jsx("button",{onClick:()=>i(!n),className:"text-[10px] font-bold text-gray-500 hover:text-white transition-colors uppercase tracking-wider",children:n?"Show Preview":"Import / Export"})]}),n?s.jsxs("div",{children:[s.jsx("textarea",{value:JSON.stringify(r,null,2),onChange:u=>{try{const h=JSON.parse(u.target.value);Array.isArray(h)&&e(h)}catch{}},className:"w-full h-32 bg-gray-900/50 border border-indigo-500/30 rounded-xl p-3 text-[10px] font-mono text-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 resize-y",placeholder:"Paste rule JSON here..."}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Copy this JSON to share rules between binders. Paste existing JSON to load it."})]}):s.jsx("div",{className:"font-mono text-[10px] text-gray-500 break-all leading-relaxed select-text cursor-text active:text-indigo-400 transition-colors",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(r,null,2))},title:"Click to copy JSON to clipboard",children:r.length>0?s.jsxs(s.Fragment,{children:["SELECT * FROM collection WHERE user_id = current_user",r.map((u,h)=>s.jsxs("span",{className:"text-indigo-300/60 block ml-4",children:["AND ",u.field," ",u.operator," '",Array.isArray(u.value)?u.value.join(", "):u.value,"'"]},h))]}):"-- No rules defined yet --"})]})]})},Vl={METHOD:1,CONFIG:2,REVIEW:3},j8e=[...new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","0","1","2","3","4","5","6","7","8","9","","","#","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""])],k8e=({isOpen:t,onClose:e,selectedCards:r=[],editingBinder:n=null})=>{const{addToast:i}=jn();vl();const[a,o]=y.useState(Vl.METHOD),[l,c]=y.useState(!1),[u,h]=y.useState(""),[p,m]=y.useState("collection"),[g,b]=y.useState("emoji"),[v,w]=y.useState(""),[j,_]=y.useState("blue"),[E,I]=y.useState([]),[O,B]=y.useState([]),[S,T]=y.useState(!1);y.useEffect(()=>{if(t){if(n){o(Vl.CONFIG),h(n.name||""),m(n.type||"collection"),b(n.icon_type||"emoji"),w(n.icon_value||""),_(n.color_preference||"blue");let U=[];try{const W=n.rules?typeof n.rules=="string"?JSON.parse(n.rules):n.rules:[];U=Array.isArray(W)?W:[]}catch(W){console.error("Failed to parse binder rules",W)}B(U),T(!!n.rules),I([])}else o(Vl.METHOD),h(""),m("collection"),b("emoji"),w(""),_("blue"),I(r||[]),B([]),T(!1);$([])}},[t,n]);const[M,$]=y.useState([]),[k,L]=y.useState(""),[R,V]=y.useState(!1),Y=async()=>{k.trim()&&(V(!0),$([]),setTimeout(()=>{const U=w8e(k);$([U]),V(!1)},800))},X=U=>{h(U.name),w(U.icon),_(U.color),B(U.rules),T(!0),o(Vl.CONFIG)},J=async()=>{c(!0);try{const U={name:u,type:p,icon_type:g,icon_value:v,color_preference:j,rules:S?O:null};let W;if(n?(await Ge.updateBinder(n.id,U),W=n.id):W=(await Ge.post("/api/binders",U)).id,E.length>0){const Z=E.map(de=>de.firestoreId||de.id);await Ge.put("/api/collection/batch-update",{cardIds:Z,binderId:W})}i(n?"Binder updated!":"Binder created successfully!","success"),e()}catch(U){console.error("[BinderWizard] Submit error:",U),i("Failed to save binder","error")}finally{c(!1)}},re=async()=>{if(n&&window.confirm(`Are you sure you want to delete "${n.name}"? This will NOT delete the cards inside.`)){c(!0);try{await Ge.deleteBinder(n.id),i("Binder deleted","success"),e()}catch(U){console.error("[BinderWizard] Delete error:",U),i("Failed to delete binder","error")}finally{c(!1)}}},se=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>{T(!1),o(Vl.CONFIG)},className:"p-6 bg-gray-950/40 hover:bg-indigo-900/10 border border-white/5 hover:border-indigo-500/50 rounded-3xl text-left transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),s.jsx("div",{className:"w-14 h-14 bg-gray-800 rounded-2xl flex items-center justify-center text-3xl mb-4 group-hover:scale-110 transition-transform shadow-xl",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Manual Binder"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:"Classic storage. Move cards in and out exactly how you want."})]}),s.jsxs("div",{className:"p-6 bg-indigo-950/20 border border-indigo-500/20 rounded-3xl relative overflow-hidden flex flex-col h-full",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.381z",clipRule:"evenodd"})})}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-600/20 text-indigo-400 rounded-2xl flex items-center justify-center text-3xl mb-4 shadow-xl shadow-indigo-900/20",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Smart Creator"}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["Describe what you want, and AI will build the rules for you. ",s.jsx("button",{onClick:()=>window.open("https://github.com/TristinParker/MTGLibrary/blob/main/docs/SMART_BINDERS.md","_blank"),className:"text-indigo-400 hover:text-indigo-300 underline md:hidden",children:"What is this?"})]}),s.jsx("div",{className:"mt-auto",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:k,onChange:U=>L(U.target.value),placeholder:'e.g., "Red Goblins over $5"',className:"w-full bg-black/40 border border-indigo-500/30 rounded-xl pl-4 pr-12 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-sm",onKeyDown:U=>U.key==="Enter"&&Y()}),s.jsx("button",{onClick:Y,disabled:!k.trim()||R,className:"absolute right-1 top-1 bottom-1 px-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-all flex items-center justify-center",children:R?s.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})})]})]})]}),(R||M.length>0)&&s.jsxs("div",{className:"mt-8 space-y-4 animate-fade-in-up",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px bg-white/10 flex-1"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Suggested Blueprints"}),s.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),R?s.jsxs("div",{className:"py-8 flex flex-col items-center",children:[s.jsxs("div",{className:"relative w-16 h-16",children:[s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500/20 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),s.jsx("p",{className:"mt-4 text-indigo-400 font-mono text-xs animate-pulse",children:"Generating rules..."})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:M.map(U=>s.jsxs("button",{onClick:()=>X(U),className:"p-4 bg-gray-900/60 hover:bg-gray-800 border border-white/5 hover:border-indigo-500/30 rounded-2xl flex items-center gap-4 transition-all text-left group shadow-lg",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-transform group-hover:scale-110",style:{backgroundColor:`rgba(${U.color==="purple"?"139, 92, 246":U.color==="green"?"16, 185, 129":U.color==="orange"?"249, 115, 22":"239, 68, 68"}, 0.1)`},children:U.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white text-sm",children:U.name}),s.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:U.description})]}),s.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-indigo-500",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]},U.id))})]})]}),ee=()=>s.jsxs("div",{className:"space-y-8 max-w-xl mx-auto",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Binder Name"}),s.jsx("input",{type:"text",value:u,onChange:U=>h(U.target.value),placeholder:"e.g., The Vault",autoFocus:!0,className:"w-full bg-gray-950 border-2 border-white/5 focus:border-indigo-500/50 text-white px-5 py-4 rounded-2xl focus:outline-none font-black text-xl transition-all shadow-inner shadow-black/40 placeholder:text-gray-800"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Icon Type"}),s.jsxs("div",{className:"flex bg-gray-950 p-1 rounded-xl border border-white/5",children:[s.jsx("button",{onClick:()=>b("emoji"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${g==="emoji"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Emoji"}),s.jsx("button",{onClick:()=>b("mtg"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${g==="mtg"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Symbols"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Theme Color"}),s.jsxs("div",{className:"flex gap-2 bg-gray-950 p-2 rounded-xl border border-white/5 overflow-x-auto custom-scrollbar no-scrollbar items-center",children:[["blue","red","green","purple","orange","gray"].map(U=>s.jsx("button",{onClick:()=>_(U),className:`w-6 h-6 shrink-0 rounded-full transition-all ${j===U?"ring-2 ring-white scale-110 shadow-lg":"opacity-40 hover:opacity-100"}`,style:{backgroundColor:U==="blue"?"#3B82F6":U==="red"?"#EF4444":U==="green"?"#10B981":U==="purple"?"#8B5CF6":U==="orange"?"#F59E0B":"#6B7280"}},U)),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("div",{className:"relative group",children:s.jsx("div",{className:`w-6 h-6 rounded-full border border-white/20 flex items-center justify-center overflow-hidden ${["blue","red","green","purple","orange","gray"].includes(j)?"":"ring-2 ring-white"}`,children:s.jsx("input",{type:"color",value:["blue","red","green","purple","orange","gray"].includes(j)?"#ffffff":j,onChange:U=>_(U.target.value),className:"w-8 h-8 -m-1 cursor-pointer"})})})]})]})]})]}),s.jsx("div",{className:"bg-gray-950 rounded-3xl p-5 border border-white/5 shadow-inner shadow-black/40",children:s.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 gap-3 h-40 overflow-y-auto custom-scrollbar pr-2",children:g==="emoji"?j8e.map(U=>s.jsx("button",{onClick:()=>w(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40":"bg-gray-900 border border-white/5 text-gray-500 hover:bg-gray-800 hover:text-white"}`,children:U},U)):["ms-w","ms-u","ms-b","ms-r","ms-g","ms-c","ms-wp","ms-up","ms-bp","ms-rp","ms-gp","ms-s","ms-x","ms-e","ms-planeswalker","ms-land","ms-artifact","ms-enchantment","ms-creature","ms-instant","ms-sorcery","ms-multiple","ms-guild-azorius","ms-guild-selesnya","ms-guild-boros","ms-guild-dimir","ms-guild-simic","ms-guild-gruul","ms-guild-rakdos","ms-guild-orzhov","ms-guild-izzet","ms-guild-golgari","ms-clan-abzan","ms-clan-jeskai","ms-clan-sultai","ms-clan-mardu","ms-clan-temur","ms-shard-bant","ms-shard-esper","ms-shard-grixis","ms-shard-jund","ms-shard-naya","ms-p","ms-chaos","ms-loyalty-up","ms-loyalty-down","ms-loyalty-zero","ms-tap","ms-untap","ms-flashback","ms-dfc-day","ms-dfc-night"].map(U=>s.jsx("button",{onClick:()=>w(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40 text-white":"bg-gray-900 border border-white/5 text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:s.jsx("i",{className:`ms ${U} ms-cost`})},U))})}),s.jsxs("div",{className:"bg-gray-950 rounded-3xl p-6 border border-white/5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-xl transition-colors ${S?"bg-indigo-600/20 text-indigo-400":"bg-gray-800 text-gray-500"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold text-sm",children:"Automated Smart Rules"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"Auto-organize collection based on conditions."})]})]}),s.jsx("button",{onClick:()=>T(!S),className:`w-12 h-6 rounded-full transition-all relative ${S?"bg-indigo-600":"bg-gray-800"}`,children:s.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-md ${S?"left-7":"left-1"}`})})]}),S&&s.jsx("div",{className:"pt-4 border-t border-white/5 animate-fade-in",children:s.jsx(N8e,{rules:O,onChange:B})})]})]}),q=()=>s.jsxs("div",{className:"text-center py-10 space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:`absolute inset-0 bg-${j}-500/20 blur-3xl rounded-full scale-150 animate-pulse`}),s.jsxs("div",{className:"relative w-32 h-32 bg-gray-900 border-4 border-white/10 rounded-[2.5rem] flex items-center justify-center text-6xl shadow-2xl z-10 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none"}),v.startsWith("ms")?s.jsx("i",{className:`ms ${v} ms-2x`}):v]}),s.jsx("div",{className:"absolute -bottom-2 -right-2 px-3 py-1 bg-indigo-600 text-white text-[10px] font-black uppercase rounded-full shadow-lg border border-white/20 z-20",children:S?"Smart":"Manual"})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-black text-white mb-2 leading-tight",children:u||"Unnamed Binder"}),s.jsx("p",{className:"text-gray-500 text-sm",children:S?`Smart Binder with ${O.length} rule(s)`:"Curated collection binder"})]}),s.jsx("div",{className:"bg-gray-950/40 rounded-3xl p-6 border border-white/5 max-w-sm mx-auto shadow-inner shadow-black/60",children:S?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[s.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Recipe Preview"})]}),s.jsxs("div",{className:"space-y-2",children:[O.map((U,W)=>s.jsxs("div",{className:"text-xs text-gray-400 bg-black/40 p-2 rounded-xl border border-white/5 flex gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:W===0?"IF":"AND"}),s.jsxs("span",{children:[U.field," ",s.jsx("span",{className:"text-indigo-400",children:U.operator})," '",Array.isArray(U.value)?U.value.join(", "):U.value,"'"]})]},W)),O.length===0&&s.jsx("p",{className:"text-xs text-red-400 italic",children:"Warning: No rules defined! This binder will be empty."})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Manifest"}),s.jsxs("span",{children:[E.length," Cards"]})]}),s.jsx("div",{className:"flex justify-center -space-x-4 pl-4 h-24 items-end pb-2",children:E.length>0?E.slice(0,5).map((U,W)=>s.jsx("div",{className:"w-16 h-20 bg-gray-800 rounded-lg border-2 border-white/10 shadow-2xl relative transition-transform hover:-translate-y-2 overflow-hidden",style:{transform:`rotate(${(W-2)*8}deg)`},children:U.data?.image_uris?.small||U.image_uris?.small?s.jsx("img",{src:U.data?.image_uris?.small||U.image_uris.small,className:"w-full h-full object-cover",alt:""}):null},W)):s.jsx("div",{className:"text-gray-700 italic text-xs",children:"Empty binder (add cards later)"})}),E.length>5&&s.jsxs("div",{className:"text-[10px] text-gray-600 font-bold",children:["+ ",E.length-5," more items"]})]})})]});return t?Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-950 border border-white/10 rounded-[2.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] w-full max-w-2xl flex flex-col max-h-[90vh] overflow-hidden relative",children:[s.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-48 h-1 bg-${j}-500 blur-md opacity-30`}),s.jsxs("div",{className:"p-8 pb-4 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.3em]",children:["Step 0",a]}),s.jsx("div",{className:"h-px w-8 bg-indigo-500/30"})]}),s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:a===Vl.METHOD?"Initialize Binder":a===Vl.CONFIG?"Configure Profile":"Final Review"})]}),s.jsx("button",{onClick:e,className:"w-10 h-10 rounded-2xl bg-white/5 hover:bg-white/10 flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-8 py-4 no-scrollbar",children:[a===Vl.METHOD&&se(),a===Vl.CONFIG&&ee(),a===Vl.REVIEW&&q()]}),s.jsxs("div",{className:"p-8 pt-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>a>1?o(a-1):e(),className:"px-6 py-3 font-black text-gray-500 hover:text-white transition-colors text-xs uppercase tracking-widest active:scale-95",children:a===1?"Cancel":"Back"}),n&&a===Vl.CONFIG&&s.jsxs("button",{onClick:re,disabled:l,className:"px-4 py-3 text-[10px] font-black text-red-500/60 hover:text-red-500 transition-colors uppercase tracking-[0.2em] flex items-center gap-2 bg-red-500/5 rounded-xl border border-red-500/10 hover:border-red-500/30",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),s.jsx("button",{onClick:()=>{a===Vl.REVIEW?J():o(a+1)},disabled:l||a===Vl.CONFIG&&!u,className:`group px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all ${l?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-2xl shadow-indigo-900/40 active:scale-95 flex items-center gap-3"}`,children:l?s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/30 border-t-white rounded-full"}):s.jsxs(s.Fragment,{children:[a===Vl.REVIEW?n?"Push Changes":"Initialize":"Proceed",s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7-7 7"})})]})})]})]})}),document.body):null},MF=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],_8e=[{value:"color",label:"Color"},{value:"color_identity",label:"Color Identity"},{value:"type",label:"Card Type"},{value:"cmc",label:"Mana Value (CMC)"},{value:"rarity",label:"Rarity"},{value:"set",label:"Set Release"},{value:"collector_number",label:"Collector Number"},{value:"name",label:"Name"},{value:"price",label:"Price"},{value:"power",label:"Power"},{value:"toughness",label:"Toughness"},{value:"artist",label:"Artist"}],Kee=({isOpen:t,onClose:e,onComplete:r})=>{const{updateSettings:n}=Or();Gee();const[i,a]=y.useState(1),[o,l]=y.useState(null),[c,u]=y.useState([null,null,null,null]),[h,p]=y.useState({rares:!0,foils:!0,value:!0,valueThreshold:2}),[m,g]=y.useState(!1);if(!t)return null;const b=j=>{const _=MF.find(E=>E.id===j);l(_),j==="advanced"?a(1.5):j==="hybrid"?a(2):w(_.sort,_.grouping)},v=(j,_)=>{const E=[...c];E[j]=_,u(E)},w=async(j,_)=>{g(!0);try{const E=j.filter(Boolean);let I=_;if(_==="custom"&&E.length>0){const B=E[0];["color","color_identity"].includes(B)?I="color":["set","release"].includes(B)?I="set":["type"].includes(B)?I="type":["rarity"].includes(B)?I="rarity":I="color"}const O={mode:o.id,sortHierarchy:E,groupingPreference:I};await n({organization:O}),r?r():e()}catch(E){console.error("Failed to save organization settings",E)}finally{g(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-5xl overflow-hidden shadow-2xl relative",children:[s.jsxs("div",{className:"p-8 pb-0 text-center",children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400",children:"Make your digital library feel like home."})]}),s.jsxs("div",{className:"p-8",children:[i===1&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:MF.map(j=>s.jsxs("button",{onClick:()=>b(j.id),className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl flex flex-col h-full",children:[s.jsx("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform",children:j.icon}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:j.name}),s.jsx("p",{className:"text-sm text-gray-300 mb-4 h-12",children:j.description}),s.jsx("ul",{className:"text-xs text-gray-400 space-y-2 mt-auto pt-4 border-t border-gray-700/50",children:j.features.map((_,E)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),_]},E))})]},j.id))}),i===1.5&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("p",{className:"text-indigo-300 font-bold uppercase tracking-widest text-xs text-center",children:"Define your custom hierarchy (Max 4)"}),s.jsx("div",{className:"space-y-3 max-w-md mx-auto",children:[0,1,2,3].map(j=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:j+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:c[j]||"",onChange:_=>v(j,_.target.value),children:[s.jsx("option",{value:"",children:"(None)"}),_8e.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))]})]},j))}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>w(c,"custom"),disabled:!c[0]||m,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:m?"Applying...":"Apply Hierarchy"})]})]}),i===2&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl mb-4",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["We'll set your main view to ",s.jsx("strong",{children:"Set & Collector Number"})," (for your boxes), and create ",s.jsx("strong",{children:"Smart Binders"})," for your special cards."]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h.rares,onChange:j=>p({...h,rares:j.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Rares & Mythics"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "Trade Binder" for high rarity cards.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h.foils,onChange:j=>p({...h,foils:j.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Foils"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a separate "Foils" binder.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h.value,onChange:j=>p({...h,value:j.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white",children:"Valuable Cards"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "High Value" binder.'})]}),h.value&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-400",children:"$"}),s.jsx("input",{type:"number",value:h.valueThreshold,onChange:j=>p({...h,valueThreshold:j.target.value}),className:"w-16 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white text-sm",onClick:j=>j.stopPropagation()})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>w(o.sort,o.grouping),disabled:m,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:m?"Configuring...":"Finish Setup"})]})]})]})]})})},S8e=({selectedCount:t,totalCount:e,onSelectAll:r,onDeselectAll:n,onDelete:i,onMove:a,onExport:o,decks:l=[],isAllSelected:c})=>{const[u,h]=y.useState(!1);return t===0&&!c?null:s.jsxs("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-[60] bg-gray-900/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl px-6 py-3 flex items-center gap-4 animate-bounce-in",children:[s.jsxs("div",{className:"flex items-center gap-2 border-r border-gray-700 pr-4",children:[s.jsx("span",{className:"text-white font-bold bg-indigo-600 px-2 py-0.5 rounded-full text-xs",children:t}),s.jsx("span",{className:"text-gray-300 text-sm font-medium",children:"Selected"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:c?n:r,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors text-xs uppercase font-bold tracking-wider",children:c?"Deselect All":"Select All"}),s.jsx("div",{className:"h-4 w-px bg-gray-700 mx-2"}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>h(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all text-sm font-bold",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Move to Deck"]}),u&&s.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-gray-900 border border-gray-700 rounded-xl shadow-xl overflow-hidden max-h-60 overflow-y-auto z-50",children:l.length>0?l.map(p=>s.jsx("button",{onClick:()=>{a(p.id),h(!1)},className:"w-full text-left px-4 py-3 hover:bg-indigo-900/30 text-gray-300 hover:text-indigo-300 border-b border-gray-800 last:border-0 text-sm transition-colors",children:p.name},p.id)):s.jsx("div",{className:"px-4 py-3 text-gray-500 text-sm italic",children:"No decks found"})})]}),s.jsx("button",{onClick:o,className:"p-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all",title:"Export JSON",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),s.jsx("button",{onClick:i,className:"p-2 bg-red-900/30 hover:bg-red-600 text-red-400 hover:text-white rounded-lg transition-all border border-red-500/20 hover:border-red-500/50",title:"Delete Selected",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},C8e=(t,e)=>!e||!Array.isArray(e)||e.length===0?!0:e.every(r=>{const{field:n,operator:i,value:a}=r;let o;switch(n){case"name":o=t.name||"";break;case"colors":o=t.data?.color_identity||[];break;case"rarity":o=t.data?.rarity||"";break;case"type":o=t.data?.type_line||"";break;case"price":o=parseFloat(t.data?.prices?.usd||0);break;case"set":o=t.data?.set_name||"";const c=t.data?.set||"";if(i==="contains")return o.toLowerCase().includes(String(a).toLowerCase())||c.toLowerCase().includes(String(a).toLowerCase());break;case"cmc":o=parseFloat(t.data?.cmc||0);break;case"count":o=parseInt(t.count||0,10);break;case"in_deck":const u=!!t.deck_id;return a==="true"?u:!u;default:o=t.data?.[n]||""}const l=Array.isArray(a)?a:String(a);switch(i){case"is":case"eq":return String(o).toLowerCase()===String(l).toLowerCase();case"not":return String(o).toLowerCase()!==String(l).toLowerCase();case"contains":return String(o).toLowerCase().includes(String(l).toLowerCase());case"gt":case"greater_than":return parseFloat(o)>parseFloat(l);case"lt":case"less_than":return parseFloat(o)<parseFloat(l);case"in":return Array.isArray(l)?l.includes(String(o).toLowerCase()):!1;case"not_in":return Array.isArray(l)?!l.includes(String(o).toLowerCase()):!0;case"contains_any":return Array.isArray(o)&&Array.isArray(l)?l.some(c=>o.includes(c)):!1;case"is_exactly":return Array.isArray(o)?JSON.stringify(o.sort())===JSON.stringify(l.sort()):!1;default:return!1}}),E8e=()=>{const{userProfile:t,updateSettings:e}=Or(),{addToast:r}=jn(),n=Mo(),i=new URLSearchParams(n.search),a=i.get("wishlist")==="true",o=i.get("onboarding")==="true",l=i.get("openAdd")==="true",[c,u]=y.useState(!1),[h,p]=y.useState("collection_tour_v1");y.useEffect(()=>{const Ae=()=>{p("collection_tour_v1"),u(!0)};return window.addEventListener("start-tour",Ae),l?(Ye(!0),p("add_card_tour"),setTimeout(()=>u(!0),800)):(!localStorage.getItem("tour_seen_collection_tour_v1")||o)&&(p("collection_tour_v1"),setTimeout(()=>u(!0),1e3),o&&setTimeout(()=>r("Welcome to your Collection! Let's get you started.","success"),500)),()=>window.removeEventListener("start-tour",Ae)},[o,l,r]);const[m,g]=y.useState([]),[b,v]=y.useState("me");y.useEffect(()=>{ia.fetchIncomingPermissions().then(Ae=>{const et=[],Rt=new Set;(Array.isArray(Ae)?Ae:Ae.data||[]).forEach(Qt=>{Qt.owner_id&&!Rt.has(Qt.owner_id)&&(Rt.add(Qt.owner_id),et.push({id:Qt.owner_id,name:Qt.owner_username||"Unknown"}))}),g(et)}).catch(Ae=>console.error("Failed to fetch shared sources",Ae))},[]);const w=b!=="me"&&b!=="all",j=b==="all",{cards:_,error:E,refresh:I}=vl({wishlist:a,userId:b==="me"?null:b}),{binders:O,refreshBinders:B}=Gee(),{decks:S}=z0(b==="me"?null:b),[T,M]=y.useState(""),[$,k]=y.useState(!1),L=y.useMemo(()=>h==="add_card_tour"?[{target:"#card-search-input",title:"Search for Cards",content:"Type any card name here. We search Scryfall directly so you can find anything.",disableBeacon:!0},{target:"#card-search-advanced-toggle",title:"Advanced Filters",content:"Need to find a specific print? Filter by set, color, rarity, or artist."},{target:"#card-search-results",title:"Adding to Collection",content:'Hover over any card result and click "Add" to put it in your collection. You can toggle between Normal and Foil.',placement:"center"}]:[{target:"h1",title:"Welcome to your Collection",content:"This is the heart of your library. Here you can view, filter, and manage every card you own."},{target:"#collection-sync-btn",title:"Sync Prices",content:"Click here to fetch the latest prices from Scryfall. We track your collection value daily."},{target:"#collection-view-toggle",title:"View Modes",content:"Switch between Grid (visual), Folder (organized), and Table (data) views."},{target:"#collection-filter-bar",title:"Filters",content:"Drill down by color, type, rarity, and more to find exactly what you need."},{target:"#collection-add-card-btn",title:"Add Cards",content:"Manually add cards to your collection using our search tool."},{target:"#collection-forge-lens-btn",title:"Forge Lens",content:"Use your camera to scan physical cards directly into your digital collection."},..._.length>0?[{target:"#collection-first-card",title:"Card Details",content:"Click on any card to view detailed pricing, oracle text, and legality information."}]:[]],[_.length,h]),[R,V]=y.useState(!1),[Y,X]=y.useState(!1),[J,re]=y.useState(new Set),se=()=>{X(!Y),re(new Set)},ee=Ae=>{const et=new Set(J);et.has(Ae)?et.delete(Ae):et.add(Ae),re(et)},q=()=>{const Ae=Nt.map(et=>et.firestoreId||et.id);re(new Set(Ae))},U=()=>{re(new Set)},W=async()=>{if(window.confirm(`Are you sure you want to delete ${J.size} cards? This cannot be undone.`))try{await Ge.batchDeleteCollection(Array.from(J)),r(`Successfully deleted ${J.size} cards.`,"success"),re(new Set),X(!1),I()}catch(Ae){console.error("Bulk delete failed",Ae),r("Failed to delete cards","error")}},Z=async Ae=>{try{const et=Nt.filter($t=>J.has($t.firestoreId||$t.id)),Rt=et.map($t=>({...$t,quantity:$t.count||1}));await Ge.batchAddCardsToDeck(Ae,Rt),r(`Added ${et.size} cards to deck.`,"success"),re(new Set),X(!1)}catch(et){console.error("Bulk move failed",et),r("Failed to move cards","error")}},de=()=>{const Ae=Nt.filter($t=>J.has($t.firestoreId||$t.id)),et="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(Ae,null,2)),Rt=document.createElement("a");Rt.setAttribute("href",et),Rt.setAttribute("download","selected_cards_export.json"),document.body.appendChild(Rt),Rt.click(),Rt.remove(),r(`Exported ${Ae.size} cards.`,"success")},be=async()=>{V(!0);try{await Ge.post("/api/sync/prices"),await I()}catch(Ae){console.error("Sync failed",Ae)}finally{V(!1)}},oe=(Ae,et)=>t?.settings?.collection?.[Ae]||localStorage.getItem(`collection_${Ae}`)||et,ne=()=>{if(t?.settings?.collection?.filters)return t.settings.collection.filters;const Ae=localStorage.getItem("collection_filters");return Ae?JSON.parse(Ae):{colors:[],rarity:[],types:[],sets:[],decks:[],users:[]}},[H,le]=y.useState(()=>oe("viewMode","grid")),[ye,me]=y.useState(()=>oe("groupingMode","binders")),[ke,Ie]=y.useState(null),[ce,Be]=y.useState([]),[ct,Ve]=y.useState(!1),[Ne,Ye]=y.useState(!1),[St,Vt]=y.useState(!1),[Lt,at]=y.useState(!1),[gt,vt]=y.useState(!1),[ft,ot]=y.useState(!1),[ut,At]=y.useState(!1),[Fe,Ut]=y.useState(null),[jt,qe]=y.useState(()=>ne()),[rt,Ot]=y.useState(()=>oe("sortBy","added_at")),[pt,Jt]=y.useState(()=>oe("sortOrder","desc")),[Kt,rr]=y.useState(()=>{const Ae=t?.settings?.collection?.itemsPerPage||localStorage.getItem("collection_itemsPerPage");return Ae?parseInt(Ae):50}),Br=y.forwardRef(({style:Ae,children:et,...Rt},$t)=>s.jsx("div",{ref:$t,...Rt,style:Ae,className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 animate-fade-in pb-24",children:et})),zt=y.forwardRef(({children:Ae,...et},Rt)=>s.jsx("div",{ref:Rt,...et,className:"h-full",children:Ae}));y.useEffect(()=>{if(!t?.settings?.collection)return;const Ae=t.settings.collection;Ae.viewMode&&Ae.viewMode!==H&&le(Ae.viewMode),Ae.groupingMode&&Ae.groupingMode!==ye&&me(Ae.groupingMode),Ae.sortBy&&Ae.sortBy!==rt&&Ot(Ae.sortBy),Ae.sortOrder&&Ae.sortOrder!==pt&&Jt(Ae.sortOrder),Ae.itemsPerPage&&parseInt(Ae.itemsPerPage)!==Kt&&rr(parseInt(Ae.itemsPerPage)),Ae.filters&&JSON.stringify(Ae.filters)!==JSON.stringify(jt)&&qe(Ae.filters)},[t]),y.useEffect(()=>{if(!t?.id)return;const Ae={viewMode:H,groupingMode:ye,sortBy:rt,sortOrder:pt,itemsPerPage:Kt,filters:jt},et=t.settings?.collection||{},Rt={viewMode:et.viewMode,groupingMode:et.groupingMode,sortBy:et.sortBy,sortOrder:et.sortOrder,itemsPerPage:et.itemsPerPage?parseInt(et.itemsPerPage):void 0,filters:et.filters};JSON.stringify(Ae)!==JSON.stringify(Rt)&&e({collection:{...et,...Ae}}),localStorage.setItem("collection_viewMode",H),localStorage.setItem("collection_groupingMode",ye),localStorage.setItem("collection_filters",JSON.stringify(jt)),localStorage.setItem("collection_sortBy",rt),localStorage.setItem("collection_sortOrder",pt),localStorage.setItem("collection_itemsPerPage",Kt)},[H,ye,jt,rt,pt,Kt,t?.id]),y.useEffect(()=>{if(ke&&ke.startsWith("binder-")){const Ae=ke.replace("binder-","");Ve(!0),Ge.getBinderCards(Ae).then(et=>Be(et)).catch(et=>r("Failed to load binder cards","error")).finally(()=>Ve(!1))}else Be([])},[ke,r]);const Wt=y.useMemo(()=>{const Ae=new Set;return _.forEach(et=>{et.set&&et.set_name&&Ae.add(JSON.stringify({value:et.set,label:et.set_name}))}),Array.from(Ae).map(et=>JSON.parse(et)).sort((et,Rt)=>et.label.localeCompare(Rt.label))},[_]),qt=y.useMemo(()=>m.map(Ae=>({value:Ae.id,label:Ae.name})),[m]),ur=y.useMemo(()=>{const Ae=S.map(et=>({value:et.id,label:et.name}));return[{value:"none",label:"Unassigned (No Deck)"},...Ae]},[S]),Re=(Ae,et,Rt)=>{switch(Rt){case"color":case"color_identity":{const $t={W:0,U:1,B:2,R:3,G:4},Qt=Ee=>{let Me=Ee.color_identity||[];if(typeof Me=="string")try{Me=JSON.parse(Me)}catch{}return Me.length===0?6:Me.length>1?5:$t[Me[0]]??7};return Qt(Ae)-Qt(et)}case"type":{const $t={Creature:0,Instant:1,Sorcery:2,Enchantment:3,Artifact:4,Planeswalker:5,Land:6},Qt=Ee=>{const Me=Ee.type_line||"";for(const[Je,Ft]of Object.entries($t))if(Me.includes(Je))return Ft;return 7};return Qt(Ae)-Qt(et)}case"cmc":return(parseFloat(Ae.cmc)||0)-(parseFloat(et.cmc)||0);case"price":return parseFloat(Ae.prices?.usd||0)-parseFloat(et.prices?.usd||0);case"collector_number":{const $t=parseInt(Ae.collector_number||0),Qt=parseInt(et.collector_number||0);return $t-Qt}case"set":return(Ae.set||"").localeCompare(et.set||"");case"name":return(Ae.name||"").localeCompare(et.name||"");case"power":return(parseFloat(Ae.power)||0)-(parseFloat(et.power)||0);case"toughness":return(parseFloat(Ae.toughness)||0)-(parseFloat(et.toughness)||0);case"artist":return(Ae.artist||"").localeCompare(et.artist||"");default:return 0}},Nt=y.useMemo(()=>_.filter(et=>{const Rt=et.name||"";if(T&&!Rt.toLowerCase().includes(T.toLowerCase()))return!1;if(jt.colors.length>0){const $t=et.color_identity||[],Qt=$t.length>1,Ee=$t.length===0;if(!jt.colors.some(Je=>Je==="C"?Ee:Je==="M"?Qt:$t.includes(Je)))return!1}if(jt.rarity.length>0&&!jt.rarity.includes(et.rarity))return!1;if(jt.types.length>0){const $t=(et.type_line||"").toLowerCase();if(!jt.types.some(Ee=>$t.includes(Ee.toLowerCase())))return!1}return!(jt.sets.length>0&&!jt.sets.includes(et.set)||jt.decks.length>0&&!jt.decks.some(Qt=>Qt==="none"?!et.deckId:et.deckId===Qt)||jt.users&&jt.users.length>0&&!jt.users.includes(et.user_id)&&!jt.users.includes(et.owner_id))}).sort((et,Rt)=>{const $t=t?.settings?.organization?.sortHierarchy;if($t&&Array.isArray($t)&&$t.length>0){for(const Me of $t){const Je=Re(et,Rt,Me);if(Je!==0)return Je}return Re(et,Rt,"name")}if(rt==="added_at"){const Me=new Date(et.added_at||0).getTime(),Je=new Date(Rt.added_at||0).getTime();return pt==="asc"?Me-Je:Je-Me}let Qt=rt;if(rt==="owner")return(et.owner_username||"ME").localeCompare(Rt.owner_username||"ME");const Ee=Re(et,Rt,Qt);return pt==="asc"?Ee:-Ee}),[_,T,jt,rt,pt,t]),Pt=y.useMemo(()=>{if(H!=="folder")return[];if(ye==="custom"){const Ae={},et=[];Nt.forEach($t=>{const Qt=typeof $t.tags=="string"?JSON.parse($t.tags):$t.tags||[];Qt.length===0?et.push($t):Qt.forEach(Ee=>{Ae[Ee]||(Ae[Ee]=[]),Ae[Ee].push($t)})});const Rt=Object.entries(Ae).map(([$t,Qt])=>({id:`tag-${$t}`,label:$t,type:"tag",cards:Qt,icon:"",color:"indigo"}));return et.length>0&&Rt.push({id:"unsorted",label:"Unsorted",type:"tag",cards:et,icon:"",color:"gray"}),Rt.sort(($t,Qt)=>$t.label.localeCompare(Qt.label))}if(ye==="smart"){const Ae=[],et={};Nt.forEach(Ee=>{if(Ee.deck_id){const Me=S.find(Je=>Je.id===Ee.deck_id)?.name||"Unknown Deck";et[Me]||(et[Me]=[]),et[Me].push(Ee)}}),Object.entries(et).forEach(([Ee,Me])=>{const Je=j&&Me[0]?.owner_username?Me[0].owner_username:null;Ae.push({id:`deck-${Ee}`,label:Ee,type:"deck",cards:Me,icon:"",color:"purple",sub:"Deck",ownerName:Je})});const Rt=t?.settings?.organization?.groupingPreference||"color",$t={};Nt.forEach(Ee=>{let Me="Other",Je="Other",Ft=0,tr={};if(Rt==="set")Me=Ee.set||"unknown",Je=Ee.set_name||"Unknown Set",Ft=Ee.released_at?new Date(Ee.released_at).getTime():0,tr={icon:"",color:"blue"};else if(Rt==="type"){const Rr=["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"],Kr=Ee.type_line||"",$s=Rr.find(Ki=>Kr.includes(Ki))||"Other";Me=$s,Je=$s,tr={icon:"",color:"emerald"}}else if(Rt==="rarity")Me=Ee.rarity||"common",Je=Me.charAt(0).toUpperCase()+Me.slice(1),Ft={common:0,uncommon:1,rare:2,mythic:3}[Me]||0,tr={icon:"",color:"yellow"};else{let Rr=Ee.color_identity;if(typeof Rr=="string")try{Rr=JSON.parse(Rr)}catch{Rr=[]}Array.isArray(Rr)||(Rr=[]);const Kr={W:0,U:1,B:2,R:3,G:4},Ki=Rr.filter(Ts=>Kr[Ts]!==void 0).sort((Ts,wa)=>Kr[Ts]-Kr[wa]).join("");Me=Ki.length===0?"C":Ki;const Ws=x8e(Me);Je=Ws.name,Ft=Me==="C"?-1:Me.length,tr={icon:"",color:Ws.bg?.replace("bg-","")?.split(" ")[0]||"blue",pips:Ws.pips,flavor:Ws.flavor,theme:Ws.theme}}$t[Me]||($t[Me]={label:Je,cards:[],sortValue:Ft,...tr}),$t[Me].cards.push(Ee)});const Qt=Object.entries($t).map(([Ee,Me])=>({id:`group-${Ee}`,label:Me.label,type:Rt,cards:Me.cards,icon:Me.icon,color:Me.color||"gray",sub:Rt.charAt(0).toUpperCase()+Rt.slice(1),pips:Me.pips,flavor:Me.flavor,theme:Me.theme,sortValue:Me.sortValue}));return Qt.sort((Ee,Me)=>Rt==="rarity"||Rt==="set"?Me.sortValue-Ee.sortValue:Rt==="color"?(Ee.id.replace("group-","").length,Ee.theme&&Me.theme?Ee.label.localeCompare(Me.label):0):Ee.label.localeCompare(Me.label)),[...Ae,...Qt]}return ye==="binders"?O.map(Ae=>{const et=Ae.rules?typeof Ae.rules=="string"?JSON.parse(Ae.rules):Ae.rules:null,Rt=et?_.filter($t=>C8e($t,et)):_.filter($t=>String($t.binder_id)===String(Ae.id));return{id:`binder-${Ae.id}`,label:Ae.name,type:"binder",cards:Rt,icon:Ae.icon_value||"",color:Ae.color_preference||"blue",sub:et?"Smart Binder":"Collection Binder",isSmart:!!et}}):[]},[Nt,ye,H,S,O,_,t]),It=(Ae,et)=>{qe(Rt=>{const $t=Rt[Ae],Qt=$t.includes(et)?$t.filter(Ee=>Ee!==et):[...$t,et];return{...Rt,[Ae]:Qt}})},Zt=y.useMemo(()=>{const Ae=Pt.find(et=>et.id===ke);return Ae&&Ae.type==="binder"?{...Ae,cards:ce}:Ae},[Pt,ke,ce]);return y.useEffect(()=>{const Ae=Ln(t?.subscription_tier).features.binders;H==="folder"&&ye==="binders"&&!Ae&&le("grid")},[t,H,ye]),s.jsxs("div",{className:"relative min-h-screen overflow-x-hidden",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transform-gpu",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto px-4 md:px-6 py-8 space-y-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 bg-gray-950/40 p-4 md:p-6 rounded-3xl backdrop-blur-md border border-white/5 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-4xl font-black text-white tracking-tight mb-1 md:mb-2",children:a?"My Wishlist":"My Collection"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("p",{className:"text-gray-400 font-medium text-xs md:text-sm",children:[Nt.length," ",Nt.length===1?"card":"cards"," found  ",s.jsxs("span",{className:"text-indigo-400",children:["$",Nt.reduce((Ae,et)=>Ae+parseFloat(et.prices?.usd||0)*(et.count||1),0).toFixed(2)]})]}),s.jsxs("button",{id:"collection-sync-btn",onClick:be,disabled:R,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-[10px] font-black uppercase tracking-widest transition-all border border-indigo-500/20 ${R?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[s.jsx("svg",{className:`w-3 h-3 ${R?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),R?"Syncing...":"Sync Prices"]})]})]}),s.jsxs("div",{className:"flex gap-2 md:gap-3 w-full md:w-auto items-center justify-between md:justify-end",children:[s.jsx("div",{id:"collection-view-toggle",children:s.jsx(y8e,{mode:H,onChange:Ae=>{le(Ae),Ie(null),Ae==="folder"&&(Ln(t?.subscription_tier).features.binders||me("smart"))}})}),!w&&s.jsxs("div",{className:"flex h-10 items-center gap-2",children:[s.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1 md:mx-2"}),s.jsxs("button",{onClick:()=>{if(!Ln(t?.subscription_tier).features.binders){r("Custom Binders are available on Wizard tier and above.","info");return}at(!0)},className:`flex p-2.5 md:px-4 md:py-3 rounded-xl transition-all border items-center justify-center gap-2 group ${Ln(t?.subscription_tier).features.binders?"bg-gray-800 hover:bg-gray-700 text-indigo-400 hover:text-white border-gray-700 hover:border-indigo-500/50 cursor-pointer":"bg-gray-800/50 text-gray-600 border-gray-700 cursor-not-allowed opacity-60"}`,title:Ln(t?.subscription_tier).features.binders?"Create New Binder":"Requires Wizard Tier",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest hidden lg:inline-block",children:"New Binder"})]}),s.jsx("button",{onClick:()=>{if(!Ln(t?.subscription_tier).features.collectionAudit){r("Collection Organization tools are available on Wizard tier.","info");return}ot(!0)},className:`hidden md:flex p-2.5 md:px-3 md:py-3 rounded-xl transition-all border items-center justify-center shadow-lg ${Ln(t?.subscription_tier).features.collectionAudit?"bg-gray-900 hover:bg-gray-800 text-gray-400 hover:text-white border-gray-800 hover:border-gray-700 cursor-pointer":"bg-gray-900/50 text-gray-600 border-gray-800 cursor-not-allowed opacity-50"}`,title:Ln(t?.subscription_tier).features.collectionAudit?"Organize Collection":"Requires Wizard Tier",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),s.jsx("button",{onClick:()=>vt(!0),className:"hidden md:flex bg-gray-900 hover:bg-indigo-900/30 text-gray-500 hover:text-indigo-400 p-2.5 md:px-3 md:py-3 rounded-xl transition-all border border-gray-800 hover:border-indigo-500/30 items-center justify-center shadow-lg",title:"Binder Guide",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("button",{onClick:()=>Vt(!0),className:"flex text-gray-400 hover:text-white font-bold p-2.5 md:px-4 md:py-3 rounded-xl hover:bg-gray-800 transition-all items-center gap-2 text-xs uppercase tracking-widest",title:"Bulk Paste",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),s.jsxs("button",{id:"collection-add-card-btn",onClick:()=>Ye(!0),className:"flex bg-indigo-600 hover:bg-indigo-500 text-white font-bold p-2.5 md:px-6 md:py-3 rounded-xl shadow-lg shadow-indigo-900/40 transition-all items-center gap-2 uppercase tracking-widest text-xs whitespace-nowrap",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"hidden md:inline-block",children:"Add Cards"})]}),s.jsxs("button",{id:"collection-forge-lens-btn",onClick:()=>At(!0),className:"flex bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-400 font-bold p-2.5 md:px-6 md:py-3 rounded-xl border border-indigo-500/20 transition-all items-center gap-2 uppercase tracking-widest text-xs whitespace-nowrap",title:"Scan Cards with Camera",children:[s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"hidden md:inline-block italic",children:"Forge Lens"})]})]})]})]}),s.jsx(pf,{steps:L,isOpen:c,onClose:()=>u(!1),tourId:"collection_tour_v1"}),E&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-3xl p-8 text-center backdrop-blur-md",children:[s.jsx("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Failed to load collection"}),s.jsx("p",{className:"text-red-200 mb-6",children:E.message||"Something went wrong while fetching your cards."}),s.jsx("button",{onClick:()=>I(),className:"px-6 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-900/20",children:"Try Again"})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-4 md:p-6 backdrop-blur-md shadow-2xl",children:[s.jsxs("div",{id:"collection-filter-bar",className:"flex flex-col lg:flex-row gap-3 md:gap-4 mb-6 justify-between",children:[s.jsxs("div",{className:"flex gap-2 flex-wrap flex-1",children:[s.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[s.jsx("input",{type:"text",placeholder:"Search cards...",value:T,onChange:Ae=>M(Ae.target.value),className:"w-full bg-gray-900/50 border border-gray-700 text-white px-4 py-2.5 md:py-3 pl-10 md:pl-12 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-gray-500 font-medium text-sm h-10 md:h-12"}),s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 absolute left-3 md:left-4 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("select",{value:b,onChange:Ae=>{v(Ae.target.value),Ie(null)},className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 whitespace-nowrap h-10 md:h-12",children:[s.jsx("option",{value:"me",children:"My Collection"}),s.jsx("option",{value:"all",children:"All Linked Collections"}),m.map(Ae=>s.jsxs("option",{value:Ae.id,children:[Ae.name,"'s Collection"]},Ae.id))]}),s.jsxs("select",{value:rt,onChange:Ae=>Ot(Ae.target.value),className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 h-10 md:h-12",children:[s.jsx("option",{value:"added_at",children:"Date Added"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"}),j&&s.jsx("option",{value:"owner",children:"Owner"})]}),s.jsx("button",{onClick:()=>Jt(pt==="asc"?"desc":"asc"),className:"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white px-3 py-2 md:px-4 md:py-3 rounded-xl transition-all h-10 md:h-12",title:`Sort Order: ${pt.toUpperCase()}`,children:pt==="asc"?s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}):s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})})}),s.jsxs("button",{onClick:se,className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${Y?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20 ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),Y?"Cancel Selection":"Select"]}),s.jsxs("button",{onClick:()=>k(!$),className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${$?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Filters"})]})]}),H==="folder"&&!ke&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-1 rounded-xl flex self-start overflow-hidden",children:[s.jsxs("button",{onClick:()=>{if(!Ln(t?.subscription_tier).features.binders){r(`Custom Binders are available on ${Vs[nr.TIER_2].name} tier.`,"info");return}me("binders")},className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${ye==="binders"?"bg-indigo-600 text-white":Ln(t?.subscription_tier).features.binders?"text-gray-500 hover:text-gray-300":"text-gray-600 cursor-not-allowed opacity-60"}`,children:["Binders",!Ln(t?.subscription_tier).features.binders&&s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),s.jsx("button",{onClick:()=>me("smart"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${ye==="smart"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Smart"}),s.jsx("button",{onClick:()=>me("custom"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${ye==="custom"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Tags"})]})})]}),$&&s.jsx("div",{className:"mb-8 p-6 bg-gray-900/50 rounded-2xl border border-gray-800 space-y-6 animate-fade-in-down",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(Ae=>s.jsxs("button",{onClick:()=>It("colors",Ae),className:`
w - 8 h - 8 rounded - full border flex items - center justify - center transition - all transform hover: scale - 110
                                                    ${jt.colors.includes(Ae)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 shadow-lg scale-110":"opacity-60 hover:opacity-100"}
                                                    ${Ae==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                                    ${Ae==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                                    ${Ae==="B"?"bg-[#1F2937] text-white border-gray-600":""}
                                                    ${Ae==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                                    ${Ae==="G"?"bg-[#10B981] text-white border-green-600":""}
                                                    ${Ae==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                                    ${Ae==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
`,title:Ae==="C"?"Colorless":Ae==="M"?"Multicolor":Ae,children:[Ae!=="M"&&Ae!=="C"&&s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Ae}.svg`,alt:Ae,className:"w-4 h-4"}),Ae==="M"&&s.jsx("span",{className:"font-bold text-xs",children:"M"}),Ae==="C"&&s.jsx("span",{className:"font-bold text-xs",children:"C"})]},Ae))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(Ae=>s.jsx("button",{onClick:()=>It("rarity",Ae),className:`
                                                    px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                    ${jt.rarity.includes(Ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                `,children:Ae},Ae))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(Ae=>s.jsx("button",{onClick:()=>It("types",Ae),className:`
                                                     px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                     ${jt.types.includes(Ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                 `,children:Ae},Ae))})]}),s.jsxs("div",{className:"col-span-1 space-y-4",children:[s.jsx(uN,{label:"Sets",options:Wt,selected:jt.sets,onChange:Ae=>qe({...jt,sets:Ae})}),j&&s.jsx(uN,{label:"Card Owner",options:qt,selected:jt.users,onChange:Ae=>qe({...jt,users:Ae})}),s.jsx(uN,{label:"Filter by Deck",options:ur,selected:jt.decks,onChange:Ae=>qe(et=>({...et,decks:Ae})),placeholder:"All Decks"})]})]})}),E?s.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-8 rounded-2xl text-center",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Collection"}),s.jsx("p",{children:E.message})]}):s.jsxs(s.Fragment,{children:[H==="folder"&&!Zt&&s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 animate-fade-in",children:[Pt.map(Ae=>s.jsxs("div",{onClick:()=>Ie(Ae.id),className:"bg-gray-900/40 hover:bg-gray-800/60 border border-white/5 hover:border-indigo-500/30 rounded-2xl p-4 md:p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-2 md:gap-3 backdrop-blur-sm relative overflow-hidden",children:[s.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 bg-${Ae.color}-500/10 rounded-full blur-3xl`}),s.jsx("div",{className:"flex gap-1 mb-1 md:mb-2 group-hover:scale-110 transition-transform",children:Ae.pips?Ae.pips.map((et,Rt)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${et}.svg`,alt:et,className:"w-6 h-6 md:w-8 md:h-8 drop-shadow-md transition-transform group-hover:scale-110"},Rt)):Ae.icon&&Ae.icon.startsWith("ms-")?s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ae.color}-900/30 text-${Ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:s.jsx("i",{className:`ms ${Ae.icon} ms-cost`})}):s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ae.color}-900/30 text-${Ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:Ae.icon})}),s.jsxs("div",{className:"z-10 px-2 mt-4",children:[s.jsx("div",{className:"text-[10px] uppercase tracking-tighter text-indigo-400 font-black mb-1",children:Ae.theme||Ae.sub}),s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors leading-tight",children:Ae.label}),Ae.flavor&&s.jsxs("p",{className:"text-[10px] text-gray-500 italic mt-2 font-serif px-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity",children:['"',Ae.flavor,'"']}),Ae.ownerName&&s.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 bg-gray-950/80 text-gray-300 text-[9px] font-bold px-2 py-1 rounded-full border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),Ae.ownerName]})]}),s.jsxs("span",{className:"mt-4 px-3 py-1 bg-black/30 rounded-full text-xs font-mono text-gray-400 border border-white/5",children:[Ae.cards.length," cards"]})]},Ae.id)),Pt.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards match your filter criteria."})]}),H==="folder"&&Zt&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>Ie(null),className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[Zt.icon," ",Zt.label]}),Zt.type==="binder"&&s.jsx("button",{onClick:()=>{const Ae=O.find(et=>et.id===parseInt(ke.replace("binder-","")));Ut(Ae),at(!0)},className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-indigo-400 hover:text-white transition-colors",title:"Edit Binder Rules",children:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),Zt.type==="binder"&&s.jsx(xk,{type:"binder",targetId:ke.replace("binder-",""),label:"Audit",className:"text-xs bg-gray-800 border-gray-700 hover:bg-gray-700 hover:text-white py-2"})]}),s.jsx(RF,{useWindowScroll:!0,totalCount:Zt.cards.length,overscan:200,components:{List:Br,Item:zt},itemContent:Ae=>{const et=Zt.cards[Ae];return s.jsx(Qx,{card:et,decks:S,currentUser:t,showOwnerTag:j})}})]}),H==="grid"&&s.jsx(s.Fragment,{children:Nt.length>0?s.jsx(RF,{useWindowScroll:!0,totalCount:Nt.length,overscan:200,components:{List:Br,Item:zt},itemContent:Ae=>{const et=Nt[Ae];return s.jsx(Qx,{card:et,decks:S,currentUser:t,showOwnerTag:j,selectMode:Y,isSelected:J.has(et.firestoreId||et.id),onToggleSelect:Rt=>ee(Rt)})}}):s.jsx("div",{className:"py-20 text-center text-gray-500 italic",children:"No cards found."})}),H==="table"&&s.jsx("div",{className:"animate-fade-in",children:s.jsx(b8e,{cards:Nt,isMixed:j})})]})]})]}),Y&&s.jsx(S8e,{selectedCount:J.size,totalCount:Nt.length,onSelectAll:q,onDeselectAll:U,onDelete:W,onMove:Z,onExport:de,decks:S,isAllSelected:J.size===Nt.length&&Nt.length>0}),s.jsx(II,{isOpen:Ne,onClose:()=>Ye(!1),onAddCard:()=>I()}),s.jsx(v8e,{isOpen:St,onClose:()=>Vt(!1)}),s.jsx(eL,{isOpen:gt,onClose:()=>vt(!1)}),s.jsx(sk,{isOpen:ut,onClose:()=>At(!1),onFinish:async Ae=>{if(Ae.length)try{const et=Ae.map(Rt=>({name:Rt.name,scryfall_id:Rt.scryfall_id,set_code:Rt.set_code,collector_number:Rt.collector_number,image_uri:Rt.data.image_uris?.normal||Rt.data.card_faces?.[0]?.image_uris?.normal,count:Rt.quantity,data:Rt.data,is_wishlist:Rt.is_wishlist,tags:[]}));await Ge.batchAddToCollection(et),r(`Successfully added ${Ae.length} cards to collection!`,"success"),I()}catch(et){console.error("Forge Lens Add Failed",et),r("Failed to add scanned cards.","error")}}}),s.jsx(k8e,{isOpen:Lt,editingBinder:Fe,onClose:()=>{if(at(!1),Ut(null),B(),ke&&ke.startsWith("binder-")){const Ae=ke.replace("binder-","");Ve(!0),Ge.getBinderCards(Ae).then(Be).finally(()=>Ve(!1))}}}),s.jsx(Kee,{isOpen:ft,onClose:()=>ot(!1),onComplete:()=>{ot(!1),window.location.reload()}})]})},Xo={async addCardToDeck(t,e,r){return Ge.post("/api/collection",{scryfall_id:r.id,name:r.name,set_code:r.set||r.set_code,collector_number:r.collector_number,finish:r.finish||"nonfoil",data:r,deck_id:e,count:1,board:r.board})},async batchAddCardsToDeck(t,e,r,n="merge"){const i=r.map(a=>({...a,deck_id:e}));return Ge.batchAddToCollection(i,n)},async removeCardFromDeck(t,e,r){return Ge.put(`/api/collection/${r}`,{deck_id:null})},async updateCardQuantity(t,e,r,n){return n<=0?this.removeCardFromDeck(t,e,r):Ge.put(`/api/collection/${r}`,{count:n})},async moveCardToBoard(t,e,r,n){return Ge.put(`/api/collection/${r}`,{board:n})},async setCommander(t,e,r){return Ge.put(`/api/decks/${e}`,{commander:r})},async updateDeck(t,e,r){return Ge.put(`/api/decks/${e}`,r)},async reorderDecks(t,e){return Ge.put("/api/decks/reorder",{deckIds:e})},async batchRemoveCards(t,e,r,n){return Ge.delete(`/api/decks/${e}/cards/batch`,{cardIds:r,action:n})},async importDeck(t,e,r,n){return Ge.post("/api/decks/import",{deck:e,cards:r,options:n})},async createDeck(t,e){return Ge.post("/api/decks",e)},async updateDeck(t,e,r){return Ge.put(`/api/decks/${e}`,r)},async deleteDeck(t,e,r={}){const n=new URLSearchParams(r).toString();return Ge.delete(`/api/decks/${e}?${n}`)},async batchRemoveCards(t,e,r,n="remove"){return Ge.delete(`/api/decks/${e}/cards?action=${n}`,{cardIds:r})}},DF=t=>{if(!t)return null;const e=t.data||t;return e.image_uris?.art_crop?e.image_uris.art_crop:e.card_faces?.[0]?.image_uris?.art_crop?e.card_faces[0].image_uris.art_crop:e.image_uris?.normal?e.image_uris.normal:null},A8e=t=>{const e=t?.commander?.color_identity||[],r=t?.commander_partner?.color_identity||[],n=[...new Set([...e,...r])];return n.length>0?n:["C"]},VL=y.memo(function({deck:e}){const r=xn(),n=A8e(e),i=dj(n),a=parseInt(e.card_count||0),o=DF(e.commander),l=DF(e.commander_partner);return s.jsx("div",{onClick:()=>r(`/decks/${e.id}`),className:"group relative flex flex-col h-[420px] rounded-3xl transition-all duration-300 hover:-translate-y-2 cursor-pointer",children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[60%] w-full relative overflow-hidden bg-gray-950 shrink-0",children:[e.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:o||"https://placehold.co/400x600?text=?",alt:e.commander?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:l||"https://placehold.co/400x600?text=?",alt:e.commander_partner?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]})]}):o?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:o,alt:e.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("svg",{className:"w-16 h-16 text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1 z-10",children:[e.tags&&e.tags.includes("Precon")&&s.jsx("div",{className:"px-2 py-1 bg-teal-500/20 text-teal-400 border border-teal-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Precon"}),e.is_mockup&&s.jsx("div",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 border border-orange-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Mockup"})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 pointer-events-none group-hover:pointer-events-auto",children:s.jsx(Er,{to:`/solitaire/${e.id}`,onClick:c=>c.stopPropagation(),className:"transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300 bg-amber-600/90 hover:bg-amber-500 text-white p-4 rounded-full shadow-2xl backdrop-blur-sm border 2 border-white/20 flex flex-col items-center gap-1",title:"Play Solitaire",children:s.jsx("svg",{className:"w-8 h-8 ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 5v14l11-7z"})})})})]}),s.jsxs("div",{className:"h-[40%] p-5 flex flex-col justify-between relative grow",children:[s.jsx("div",{className:"absolute -top-3 left-5 flex gap-1 bg-gray-900/80 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:(e.format?.toLowerCase()==="standard"?e.colors||[]:n).map(c=>{const u=`https://svgs.scryfall.io/card-symbols/${c}.svg`;return s.jsx("img",{src:u,alt:c,className:"w-4 h-4 shadow-sm"},c)})}),(e.ai_blueprint?.grade?.powerLevel>0||e.aiBlueprint?.grade?.powerLevel>0)&&s.jsxs("div",{className:"absolute -top-3 right-5 flex items-center gap-1.5 bg-gray-900 backdrop-blur-md rounded-full px-3 py-1 border border-white/10 shadow-xl group-hover:border-indigo-500/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-indigo-400 tracking-wider",children:"B"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:e.ai_blueprint?.grade?.commanderBracket||e.aiBlueprint?.grade?.commanderBracket||"?"})]}),s.jsx("div",{className:"w-px h-2.5 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-teal-400 tracking-wider",children:"PWR"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:Number(e.ai_blueprint?.grade?.powerLevel||e.aiBlueprint?.grade?.powerLevel).toFixed(1)})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-1 opacity-80",children:i.badge}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:e.name||"Untitled Deck"}),s.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:e.commander_partner?`${e.commander?.name} & ${e.commander_partner?.name}`:e.commander?.name||"No Commander"})]}),s.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4 mt-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Format"}),s.jsx("span",{className:"text-xs text-gray-300 font-medium",children:e.format||"Commander"})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Cards"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${a>=(e.format?.toLowerCase()==="standard"?60:100)?"text-green-500":"text-indigo-400"}`,children:[a,s.jsxs("span",{className:"text-gray-600 text-[10px]",children:["/",e.format?.toLowerCase()==="standard"?"60":"100"]})]})]})]})]})]})})}),jj=y.memo(function({title:e,decks:r,loading:n,error:i,isOwner:a=!1}){const[o,l]=y.useState(!1),c=o?r:r.slice(0,4),u=r.length>4;return n?s.jsxs("div",{className:"mb-12",children:[s.jsx("div",{className:"h-8 w-48 bg-gray-800 rounded-lg animate-pulse mb-6"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(h=>s.jsx("div",{className:"h-[420px] bg-gray-900 rounded-3xl animate-pulse"},h))})]}):i?s.jsx("div",{className:"mb-12 p-6 bg-red-900/20 border border-red-500/50 rounded-2xl",children:s.jsx("h3",{className:"text-red-400 font-bold",children:"Error loading decks"})}):r.length===0?null:s.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:[e,s.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:r.length})]})}),u&&s.jsxs("button",{onClick:()=>l(!o),className:"text-indigo-400 hover:text-indigo-300 text-sm font-bold uppercase tracking-wider transition-colors flex items-center gap-2",children:[o?"Show Less":`Show All (${r.length})`,s.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:c.map(h=>s.jsx(VL,{deck:h},h.id))}),a&&r.length===0&&s.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 mb-6",children:"You haven't built any decks yet."}),s.jsx(Er,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]})}),T8e=Pe.memo(({friend:t})=>{const{decks:e,loading:r,error:n}=z0(t.owner_id),i=t.owner?.username||t.owner_username||"Unknown Friend";return!r&&!n&&e.length===0?null:s.jsx(jj,{title:`Decks by ${i}`,decks:e,loading:r,error:n,isOwner:!1})}),BF={getPrice(t,e="usd"){if(!t)return 0;let r=null;return t.prices&&t.prices[e]&&(r=t.prices[e]),r?parseFloat(r):0},getDeckValue(t=[],e="usd"){let r=0,n=0,i=null;const a={bulk:0,budget:0,mid:0,high:0,premium:0};return t.map(o=>{const l=this.getPrice(o,e);return r+=l*(o.quantity||1),l>n&&(n=l,i=o),l<1?a.bulk+=o.quantity||1:l<5?a.budget+=o.quantity||1:l<20?a.mid+=o.quantity||1:l<50?a.high+=o.quantity||1:a.premium+=o.quantity||1,{...o,price:l}}),{total:parseFloat(r.toFixed(2)),max:parseFloat(n.toFixed(2)),maxCard:i,average:t.length?parseFloat((r/t.length).toFixed(2)):0,distribution:a,currency:e}},generateTCGPlayerLink(t,e="MTGLibrary"){if(!t||t.length===0)return"";const r=t.map(a=>`${a.quantity||1} ${a.name}`).join("||"),n="https://store.tcgplayer.com/massentry",i=new URLSearchParams({partner:e,utm_campaign:"affiliate",utm_medium:"mtglibrary",utm_source:"MTGLibrary",c:r});return`${n}?${i.toString()}`}};function I8e(t=[]){const e=y.useMemo(()=>!t||t.length===0?null:BF.getDeckValue(t),[t]),r=y.useMemo(()=>BF.generateTCGPlayerLink(t),[t]);return{value:e,tcgPlayerLink:r}}const L8e=()=>{const{cards:t,loading:e}=vl(),{value:r}=I8e(t),n=y.useMemo(()=>t?[...t].sort((o,l)=>(l.currPrice||0)*(l.quantity||1)-(o.currPrice||0)*(o.quantity||1)).slice(0,5):[],[t]);if(e)return s.jsx("div",{className:"animate-pulse h-12 bg-gray-900 rounded-xl"});const i=Math.random()>.5?"up":"down",a=(Math.random()*5).toFixed(1);return s.jsxs("div",{className:"bg-gray-900/50 border border-white/5 rounded-2xl p-4 flex flex-col md:flex-row items-center justify-between gap-6 overflow-hidden relative",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2"}),s.jsxs("div",{className:"flex-shrink-0 flex items-center gap-4 z-10",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Collection Value"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-mono font-bold text-white",children:["$",r?.total?.toFixed(2)||"0.00"]}),s.jsxs("span",{className:`text-xs font-bold ${i==="up"?"text-green-500":"text-red-500"} flex items-center`,children:[i==="up"?"":""," ",a,"%"]})]})]})]}),s.jsx("div",{className:"hidden md:block w-px h-10 bg-white/10"}),s.jsx("div",{className:"flex-grow overflow-hidden w-full relative z-10",children:s.jsxs("div",{className:"flex gap-6 animate-scroll-subtle hover:pause-scroll",children:[n.map(o=>s.jsxs("div",{className:"flex items-center gap-2 group flex-shrink-0 cursor-pointer",children:[s.jsx("div",{className:"w-8 h-8 rounded overflow-hidden relative border border-white/10 group-hover:border-indigo-500 transition-colors",children:s.jsx("img",{src:o.image_uris?.small||o.image_uri,className:"w-full h-full object-cover",alt:""})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),s.jsxs("div",{className:"text-[10px] font-mono text-emerald-400",children:["$",((o.currPrice||0)*(o.quantity||1)).toFixed(2)]})]})]},o.id||o.firestoreId)),n.length===0&&s.jsx("div",{className:"text-xs text-gray-500 italic",children:"Add cards to see market analysis"})]})}),s.jsx("style",{children:`
                .pause-scroll:hover {
                     animation-play-state: paused;
                }
            `})]})},P8e=({deck:t})=>{const{attributes:e,listeners:r,setNodeRef:n,transform:i,transition:a,isDragging:o}=HJ({id:t.id}),l={transform:Yh.Transform.toString(i),transition:a,opacity:o?.3:1,zIndex:o?999:"auto"};return s.jsx("div",{ref:n,style:l,...e,...r,children:s.jsx(VL,{deck:t})})},O8e=t=>{const e=new Set;return t.forEach(r=>{Array.isArray(r.tags)&&r.tags.forEach(n=>e.add(n))}),Array.from(e).sort()},R8e=()=>{const{user:t,userProfile:e}=Or(),{addToast:r}=jn(),[n,i]=y.useState([]),{decks:a,loading:o,error:l}=z0(null),[c,u]=y.useState([]),[h,p]=y.useState([]),[m,g]=y.useState(""),[b,v]=y.useState("custom"),[w,j]=y.useState([]),[_,E]=y.useState([]),[I,O]=y.useState(!1),B=sL(Gx(dk),Gx(uk,{coordinateGetter:WJ}));y.useEffect(()=>{if(a){p(a);const L=a.map(R=>({...R,tags:typeof R.tags=="string"?JSON.parse(R.tags):R.tags||[]}));u(L),E(O8e(L))}},[a]);const S=y.useMemo(()=>{let L=[...c];if(m){const R=m.toLowerCase();L=L.filter(V=>V.name.toLowerCase().includes(R)||V.commander&&V.commander.name.toLowerCase().includes(R))}return w.length>0&&(L=L.filter(R=>w.every(V=>(R.tags||[]).includes(V)))),b!=="custom"&&L.sort((R,V)=>{switch(b){case"name":return R.name.localeCompare(V.name);case"updated":return new Date(V.updated_at)-new Date(R.updated_at);case"created":return new Date(V.created_at)-new Date(R.created_at);case"color":const Y=X=>(X.commander?.color_identity||[]).join("");return Y(R).localeCompare(Y(V));default:return 0}}),L},[c,m,b,w]);y.useEffect(()=>{(async()=>{if(t)try{const R=await ia.fetchIncomingPermissions(),V=(Array.isArray(R)?R:[]).filter(Y=>!Y.target_deck_id);i(V)}catch(R){console.error("Failed to load shared sources",R)}})()},[t]);const T=L=>{const R=Vs[e?.subscription_tier||"free"].limits.decks,V=c.length||0;R!==1/0&&V>=R&&(L.preventDefault(),r(`Deck limit reached (${V}/${R}). Upgrade to create more!`,"error"))};y.useEffect(()=>{(m||w.length>0)&&O(!1)},[m,w]);const M=async L=>{const{active:R,over:V}=L;!V||R.id===V.id||u(Y=>{const X=Y.findIndex(ee=>ee.id===R.id),J=Y.findIndex(ee=>ee.id===V.id),re=pk(Y,X,J),se=re.map(ee=>ee.id);return Xo.reorderDecks(t.uid,se).catch(ee=>{console.error("Failed to save deck order",ee),r("Failed to save new order","error")}),re})},$=L=>{j(R=>R.includes(L)?R.filter(V=>V!==L):[...R,L])},k=()=>{I?O(!1):(v("custom"),g(""),j([]),O(!0),r("Reordering unlocked. Drag decks to arrange.","info"))};return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-10 relative z-10",children:[s.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-end mb-12 gap-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"My Strategies"}),s.jsx("p",{className:"text-gray-400 font-medium",children:"Manage your collection and view shared decks."})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full xl:w-auto items-center",children:[s.jsx("button",{onClick:k,className:`p-2 h-10 w-10 flex items-center justify-center rounded-xl border transition-all ${I?"bg-indigo-600 text-white border-indigo-500 shadow-lg shadow-indigo-500/20":"bg-gray-900/50 text-gray-400 border-gray-700 hover:text-white hover:border-gray-500"}`,title:I?"Lock Order":"Unlock to Reorder",children:I?s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})})}),s.jsxs("div",{className:"relative group flex-1 md:w-64",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-900 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Search decks...",value:m,onChange:L=>g(L.target.value),disabled:I})]}),_.length>0&&s.jsx("div",{className:"relative group",children:s.jsxs("select",{className:"appearance-none block w-full md:w-48 pl-3 pr-10 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed",onChange:L=>L.target.value&&$(L.target.value),value:"",disabled:I,children:[s.jsx("option",{value:"",children:"Filter by Tag..."}),_.map(L=>s.jsx("option",{value:L,disabled:w.includes(L),children:L},L))]})}),s.jsx("div",{className:"relative",children:s.jsxs("select",{value:b,onChange:L=>v(L.target.value),className:"appearance-none block w-full md:w-40 pl-3 pr-10 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed",disabled:I,children:[s.jsx("option",{value:"custom",children:"Custom Order"}),s.jsx("option",{value:"name",children:"Name (A-Z)"}),s.jsx("option",{value:"updated",children:"Last Updated"}),s.jsx("option",{value:"created",children:"Newest First"}),s.jsx("option",{value:"color",children:"Color Identity"})]})}),s.jsxs(Er,{to:"/decks/new",onClick:T,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center justify-center gap-2 border border-indigo-400/20 hover:border-indigo-400 whitespace-nowrap",children:[s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"New Deck"]})]})]}),w.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-2 mb-8 animate-fade-in",children:[w.map(L=>s.jsxs("button",{onClick:()=>$(L),className:"bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 text-xs font-bold px-3 py-1 rounded-full flex items-center gap-2 hover:bg-indigo-500/30 transition-colors",children:[L,s.jsx("span",{className:"text-indigo-400/50 hover:text-white",children:""})]},L)),s.jsx("button",{onClick:()=>j([]),className:"text-gray-500 text-xs hover:text-white transition-colors underline decoration-dotted",children:"Clear Filter"})]}),s.jsx("div",{className:"mb-8",children:s.jsx(L8e,{})}),o?s.jsx(jj,{title:"My Decks",decks:[],loading:!0}):l?s.jsx(jj,{title:"My Decks",decks:[],error:l}):s.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:["My Decks",s.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:S.length})]}),I&&s.jsxs("div",{className:"w-full md:w-auto bg-indigo-500/10 border border-indigo-500/30 rounded-xl px-4 py-2 flex items-center justify-center gap-3 animate-pulse",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),s.jsx("span",{className:"text-sm md:text-base font-bold text-indigo-300",children:"Reordering Enabled - Drag to arrange!"})]})]}),I?s.jsxs(lL,{sensors:B,collisionDetection:X5e,onDragEnd:M,children:[s.jsx(qJ,{items:S.map(L=>L.id),strategy:mk,children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map(L=>s.jsx(P8e,{deck:L},L.id))})}),s.jsx(cL,{})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map(L=>s.jsx(VL,{deck:L},L.id))}),S.length===0&&s.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 mb-6",children:"No matching decks found."}),s.jsx(Er,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]}),n.length>0&&s.jsxs("div",{className:"mt-16 border-t border-white/5 pt-12",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-500 uppercase tracking-widest mb-8 flex items-center gap-4",children:[s.jsx("span",{className:"h-px bg-gray-800 flex-1"}),"Shared Libraries",s.jsx("span",{className:"h-px bg-gray-800 flex-1"})]}),s.jsx("div",{className:"space-y-4",children:n.map(L=>s.jsx(T8e,{friend:L},L.id))})]})]})]})},M8e=()=>{const{decks:t,loading:e,refresh:r}=z0(),{currentUser:n,userProfile:i}=Or(),{addToast:a}=jn();xn();const[o,l]=y.useState(!1),[c,u]=y.useState(!1);y.useEffect(()=>{const g=()=>u(!0);return window.addEventListener("start-tour",g),localStorage.getItem("tour_seen_binders_tour_v1")||setTimeout(()=>u(!0),1e3),()=>window.removeEventListener("start-tour",g)},[]);const h=[{target:"h1",title:"The Armory",content:"Manage your binders here. Binders are like decks but for trading or showcasing."},{target:"#new-binder-btn",title:"Create Binder",content:"Start a new binder to organize your cards."}],p=t.filter(g=>g.format==="binder"),m=async()=>{l(!0);try{const g=Vs[i?.subscription_tier||"free"];if(p.length>=(g?.limits?.binders||5)){a(`Upgrade to create more binders! (Limit: ${g?.limits?.binders||5})`,"error");return}const b=`New Binder ${p.length+1}`,v=await Xo.createDeck(n.uid,{name:b,format:"binder",description:"A dedicated trade binder.",isPublic:!0});await r(),a("Binder created!","success")}catch(g){console.error(g),a("Failed to create binder.","error")}finally{l(!1)}};return e?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):s.jsxs("div",{className:"min-h-screen bg-[#0B0C15] pb-24 relative overflow-hidden",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-10",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white tracking-tight mb-2",children:s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Armory"})}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"Manage your trade binders and share your collection with the community."})]}),s.jsxs("button",{id:"new-binder-btn",onClick:m,disabled:o,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?s.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"New Binder"]})]}),p.length>0?s.jsx(jj,{title:"Your Binders",decks:p,canCreate:!1}):s.jsxs("div",{className:"text-center py-24 bg-gray-900/30 rounded-3xl border border-dashed border-gray-700",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Binders Yet"}),s.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"Create a binder to start organizing your trades or showcased cards separately from your playable decks."}),s.jsx("button",{onClick:m,className:"text-indigo-400 hover:text-indigo-300 font-bold uppercase tracking-widest text-xs hover:underline",children:"Create your first binder"})]})]}),s.jsx(pf,{steps:h,isOpen:c,onClose:()=>u(!1),tourId:"binders_tour_v1"})]})},D8e=({isOpen:t,onClose:e,onAdd:r})=>{const{addToast:n}=jn(),[i,a]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState([]),[h,p]=y.useState(null),[m,g]=y.useState(!1),[b,v]=y.useState([]),[w,j]=y.useState("and"),[_,E]=y.useState(""),[I,O]=y.useState(""),B=$=>{v(k=>k.includes($)?k.filter(L=>L!==$):[...k,$])},S=async $=>{$.preventDefault();const k=b.length>0||_.trim()||I.trim();if(!(!i.trim()&&!k)){l(!0);try{let L=null;if(I.trim()){const Y=I.trim().match(/^([<>]=?|=)?\s*(\d+)$/);Y&&(L={operator:Y[1]||"=",value:parseInt(Y[2],10)})}const R={query:i,type:"legendary creature",text:_,colors:b.length>0?b:void 0,colorIdentity:!0,colorLogic:w,mv:L},V=await Ge.post("/api/cards/search",R);u(V.data||[])}catch(L){console.error(L),n("Search failed. The Oracle is unreachable.","error")}finally{l(!1)}}},T=async $=>{p({id:$.id,name:$.name});try{const k={scryfall_id:$.id,name:$.name,set_code:$.set,collector_number:$.collector_number,finish:"nonfoil",count:1,data:$,is_wishlist:!0};await Ge.post("/api/collection",k),n(`"${$.name}" added to Wishlist!`,"success"),r&&r(),e()}catch(k){console.error(k),n("Failed to add to wishlist.","error")}finally{p(null)}};if(!t)return null;const M={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"}};return Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gray-950/50 flex justify-between items-center shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-purple-400",children:"Summon Legend"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-300 uppercase tracking-wider border border-purple-500/30",children:"Wishlist"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the multiverse for a commander you don't own yet."})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"bg-gray-900 border-b border-white/5 flex flex-col shrink-0",children:s.jsxs("form",{onSubmit:S,className:"p-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",value:i,onChange:$=>a($.target.value),placeholder:"Search by name...",className:"w-full bg-gray-950 border border-white/10 rounded-2xl py-4 pl-14 pr-14 text-lg text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all shadow-inner",autoFocus:!m}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>a(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("button",{type:"button",onClick:()=>g(!m),className:`px-4 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${m?"bg-purple-600 text-white border-purple-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(hX,{className:"w-5 h-5"}),"Filters"]}),s.jsx("button",{type:"submit",disabled:o,className:"px-8 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-2xl transition-all disabled:opacity-50 shadow-lg shadow-purple-500/20",children:o?"Searching...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${m?"max-h-96 opacity-100 mt-6":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Color Identity"}),s.jsx("div",{className:"flex gap-2",children:Object.entries(M).map(([$,k])=>s.jsx("button",{type:"button",onClick:()=>B($),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${b.includes($)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:b.includes($)?"transparent":""},children:s.jsx("img",{src:k.symbol,alt:$,className:`w-full h-full ${b.includes($)?"drop-shadow-md":"grayscale"}`})},$))}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[s.jsx("span",{className:`cursor-pointer ${w==="or"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>j("or"),children:"Includes any (OR)"}),s.jsx("div",{className:"w-10 h-5 bg-gray-800 rounded-full relative cursor-pointer border border-white/10",onClick:()=>j($=>$==="or"?"and":"or"),children:s.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-purple-500 transition-all ${w==="and"?"left-5.5":"left-0.5"}`})}),s.jsx("span",{className:`cursor-pointer ${w==="and"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>j("and"),children:"Exact match (AND)"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Oracle Text"}),s.jsx("input",{type:"text",value:_,onChange:$=>E($.target.value),placeholder:"e.g. 'draw cards', 'counter'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm"}),s.jsx("p",{className:"text-[10px] text-gray-600",children:"Searches abilities and rules text."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Mana Value (CMC)"}),s.jsx("input",{type:"text",value:I,onChange:$=>O($.target.value),placeholder:"e.g. '4' or '<= 3'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm font-mono"})]})]})})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-950/30 custom-scrollbar",children:[!o&&c.length===0&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),s.jsx("p",{className:"text-xl font-bold text-gray-400",children:"No legends found."}),s.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map($=>{const k=$.image_uris?.art_crop||$.image_uris?.normal||$.data?.image_uris?.art_crop||$.data?.image_uris?.normal,L=h?.id===$.id;return s.jsxs("div",{className:"group relative bg-gray-900 rounded-2xl border border-white/5 overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-2xl hover:shadow-purple-500/10 hover:-translate-y-1",children:[s.jsxs("div",{className:"h-60 w-full bg-black relative",children:[k?s.jsx("img",{src:k,alt:$.name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-500"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 font-bold",children:"No Art"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent"})]}),s.jsxs("div",{className:"p-4 relative",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-300 transition-colors line-clamp-1",children:$.name}),s.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-1",children:$.type_line}),s.jsx("button",{onClick:()=>T($),disabled:L,className:"w-full py-2 bg-white/5 hover:bg-purple-600 text-gray-300 hover:text-white rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 group-hover:bg-purple-600 group-hover:text-white",children:L?s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Wishlist"]})})]})]},$.id)})})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(168, 85, 247, 0.4); }
            `}})]}),document.body)};class yT{static parseText(e){if(!e||typeof e!="string")return{mainboard:[],sideboard:[],errors:["Empty input"]};const r=e.split(/\r?\n/).map(a=>a.trim()).filter(a=>a),n={mainboard:[],sideboard:[],errors:[]};let i="mainboard";return r.forEach(a=>{if(a.toLowerCase()==="deck"||a.toLowerCase()==="mainboard"){i="mainboard";return}if(a.toLowerCase()==="sideboard"||a.toLowerCase()==="commander"){i="sideboard";return}const o=this.parseLine(a);o?n[i].push(o):a.length>2&&n.errors.push(`Could not parse line: "${a}"`)}),n.mainboard=this.consolidate(n.mainboard),n.sideboard=this.consolidate(n.sideboard),n}static parseLine(e){const r=/^(\d+)[xX]?\s+(.+)\s+\(([A-Za-z0-9]{3,4})\)\s*(\d+)?/,n=e.match(r);if(n)return{quantity:parseInt(n[1],10),name:n[2].trim(),set:n[3].toUpperCase(),collectorNumber:n[4]||null,isFoil:e.toLowerCase().includes(" *f*")};const i=/^(\d+)[xX]?\s+(.+)/,a=e.match(i);if(a){let o=a[2].trim(),l=null;const c=o.match(/\(([A-Za-z0-9]{3,4})\)$/);return c&&(l=c[1],o=o.replace(c[0],"").trim()),{quantity:parseInt(a[1],10),name:o,set:l,collectorNumber:null}}return/[a-zA-Z]/.test(e)?{quantity:1,name:e,set:null,collectorNumber:null}:null}static consolidate(e){const r=new Map;return e.forEach(n=>{const i=n.set?`${n.name}|${n.set}|${n.collectorNumber||""}`:n.name;r.has(i)?r.get(i).quantity+=n.quantity:r.set(i,{...n})}),Array.from(r.values())}static async resolveCards(e){if(!e||e.length===0)return[];const r=[],n=75;for(let o=0;o<e.length;o+=n)r.push(e.slice(o,o+n));const i=[],a=[];for(const o of r){const l=o.map(c=>c.set&&c.collectorNumber?{set:c.set,collector_number:c.collectorNumber}:c.set?{name:c.name,set:c.set}:{name:c.name});try{const c=await fetch("https://api.scryfall.com/cards/collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifiers:l})});if(!c.ok)throw new Error("Scryfall API Error");const u=await c.json();u.data.forEach(h=>{const p=o.find(m=>m.set&&m.collectorNumber?m.set.toLowerCase()===h.set&&m.collectorNumber===h.collector_number:m.name.toLowerCase()===h.name.toLowerCase()||h.card_faces&&h.card_faces[0].name.toLowerCase()===m.name.toLowerCase());p&&i.push({...p,scryfall_id:h.id,name:h.name,set_code:h.set,collector_number:h.collector_number,image_uri:h.image_uris?.normal||h.card_faces?.[0]?.image_uris?.normal,data:h})}),u.not_found&&u.not_found.length>0&&u.not_found.forEach(h=>{console.warn("Card not found:",h),a.push(h.name)})}catch(c){console.error("Failed to resolve batch",c)}}return i}static async parseUrl(e){try{const r=await Ge.post("/api/import/url",{url:e});return{mainboard:r.mainboard||[],sideboard:r.sideboard||[],name:r.name,errors:[]}}catch(r){return console.error("URL Import Error",r),{mainboard:[],sideboard:[],errors:[r.response?.data?.error||"Failed to fetch URL"]}}}}const B8e=({isOpen:t,onClose:e,onImport:r})=>{const[n,i]=y.useState(""),[a,o]=y.useState(null),[l,c]=y.useState("paste"),[u,h]=y.useState(""),[p,m]=y.useState(!1),g=async()=>{if(l==="paste"){const w=yT.parseText(n);o(w)}else{m(!0);try{const w=await yT.parseUrl(u);o(w)}finally{m(!1)}}},b=()=>{a&&(r(a),e())},v=()=>{i(""),o(null)};return s.jsx(_0,{open:t,onClose:e,className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl p-6 shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx(_0.Title,{className:"text-2xl font-black text-white",children:"Import Deck"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a?s.jsxs("div",{className:"flex flex-col h-[500px]",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-8 flex-1 overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h4",{className:"text-green-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Mainboard (",a.mainboard.reduce((w,j)=>w+j.quantity,0),")"]}),s.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.mainboard.map((w,j)=>s.jsxs("div",{className:"flex justify-between items-center text-sm group",children:[s.jsxs("span",{className:"text-gray-300",children:[s.jsx("span",{className:"font-bold text-white mr-2",children:w.quantity}),w.name]}),w.set&&s.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:w.set})]},j))})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h4",{className:"text-purple-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),"Sideboard / Commander (",a.sideboard.reduce((w,j)=>w+j.quantity,0),")"]}),s.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.sideboard.length>0?a.sideboard.map((w,j)=>s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsxs("span",{className:"text-gray-300",children:[s.jsx("span",{className:"font-bold text-white mr-2",children:w.quantity}),w.name]}),w.set&&s.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:w.set})]},j)):s.jsx("div",{className:"h-full flex items-center justify-center text-gray-600 italic",children:"No Sideboard"})})]})]}),a.errors.length>0&&s.jsxs("div",{className:"mt-4 bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[s.jsx("h5",{className:"text-red-400 text-xs font-bold uppercase mb-1",children:"Parse Warnings"}),s.jsx("ul",{className:"text-xs text-red-300/80 list-disc ml-4",children:a.errors.map((w,j)=>s.jsx("li",{children:w},j))})]}),s.jsxs("div",{className:"mt-6 flex justify-between items-center pt-4 border-t border-white/5",children:[s.jsx("button",{onClick:v,className:"text-gray-400 hover:text-white font-medium text-sm",children:" Back to Paste"}),s.jsx("button",{onClick:b,className:"bg-green-600 hover:bg-green-500 text-white px-8 py-2 rounded-xl font-bold shadow-lg shadow-green-500/20",children:"Confirm Import"})]})]}):s.jsxs("div",{className:"flex gap-8 min-h-[400px]",children:[s.jsxs("div",{className:"w-48 flex flex-col gap-2 border-r border-white/5 pr-4",children:[s.jsx("button",{onClick:()=>c("paste"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="paste"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"Paste Text"}),s.jsx("button",{onClick:()=>c("url"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="url"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"From URL"}),s.jsxs("div",{className:"mt-auto p-3 bg-gray-800/50 rounded-lg text-xs text-gray-500",children:["Supports:",s.jsxs("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[s.jsx("li",{children:"Arena Exports"}),s.jsx("li",{children:"MTGO text"}),s.jsx("li",{children:"Moxfield URLs"})]})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col",children:[l==="paste"&&s.jsxs(s.Fragment,{children:[s.jsx("textarea",{value:n,onChange:w=>i(w.target.value),placeholder:`Paste your decklist here...

Example:
1 Sol Ring
1 Command Tower
1 Arcane Signet`,className:"w-full flex-1 bg-gray-950 border border-white/10 rounded-xl p-4 text-gray-300 font-mono text-sm focus:ring-2 focus:ring-indigo-500 outline-none resize-none"}),s.jsx("div",{className:"flex justify-end mt-4",children:s.jsx("button",{onClick:g,disabled:!n.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-6 py-2 rounded-xl font-bold",children:"Parse Deck"})})]}),l==="url"&&s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Import from Website"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Paste a URL from Moxfield, Archidekt, or TappedOut."}),s.jsxs("div",{className:"flex w-full max-w-lg gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:w=>h(w.target.value),placeholder:"https://moxfield.com/decks/...",className:"flex-1 bg-gray-950 border border-white/10 rounded-xl px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),s.jsx("button",{onClick:g,disabled:!u||p,className:"bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-xl font-bold disabled:opacity-50",children:p?"...":"Fetch"})]}),s.jsx("p",{className:"mt-4 text-xs text-green-500/80",children:"Supports Moxfield & Archidekt"})]})]})]})]})]})})},Ei={BASICS:1,COMMANDER:2,PARTNER:2.5,AI_STRATEGY:3,REVIEW:4},$8e=()=>{const t=xn(),{userProfile:e}=Or(),{addToast:r}=jn(),[n,i]=y.useState(Ei.BASICS),[a,o]=y.useState(!1),[l,c]=y.useState("folder"),[u,h]=y.useState({}),[p,m]=y.useState(null),[g,b]=y.useState(""),[v,w]=y.useState("Commander"),[j,_]=y.useState([]),[E,I]=y.useState(null),[O,B]=y.useState(null),[S,T]=y.useState(""),[M,$]=y.useState(""),[k,L]=y.useState(null),[R,V]=y.useState("Consulting the Oracle..."),[Y,X]=y.useState(!1),[J,re]=y.useState(!1),[se,ee]=y.useState([]),[q,U]=y.useState(!0),[W,Z]=y.useState(!1),[de,be]=y.useState(!1);y.useEffect(()=>{oe()},[]);const oe=async()=>{try{const at=await Ge.get("/api/precons/types");ee(at)}catch(at){console.error("Failed to fetch precon types",at)}finally{U(!1)}};y.useEffect(()=>{window.scrollTo(0,0)},[n]);const ne=at=>{if(!at)return null;const gt=at.data||at;return gt.image_uris?.art_crop?gt.image_uris.art_crop:gt.card_faces?.[0]?.image_uris?.art_crop?gt.card_faces[0].image_uris.art_crop:gt.image_uris?.normal?gt.image_uris.normal:null},H=at=>{const vt=(at.data||at).color_identity||[];return vt.length>0?vt:["C"]},le=(at,gt)=>{at==="Commander"||at==="Standard"?ye(at,gt):console.warn("Unknown format selected")},ye=async(at,gt)=>{o(!0);try{const vt={unused:!0};at==="Commander"&&(vt.type_line="legendary creature"),gt||(vt.wishlist="false");const ft=await Ge.get("/api/collection",vt);_(ft),i(Ei.COMMANDER)}catch(vt){console.error(vt),r("Failed to load cards","error")}finally{o(!1)}},me=at=>{if(I(at),v==="Standard"){r("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info"),i(Ei.REVIEW);return}const gt=at.data||at,vt=gt.keywords||[],ft=gt.oracle_text||"";if(vt.includes("Partner")||ft.includes("Partner"))i(Ei.PARTNER);else{const ut=Ln(e?.subscription_tier).features.aiStrategy;i(ut?Ei.AI_STRATEGY:Ei.REVIEW)}},ke=at=>{B(at);const gt=Ln(e?.subscription_tier).features.aiStrategy;i(gt?Ei.AI_STRATEGY:Ei.REVIEW)},Ie=async()=>{if(v==="Standard")return;const at=e?.settings?.geminiApiKey,gt=e?.settings?.helper?.name||"The Oracle";if(!at){r("AI Key missing. Skipping strategy.","warning"),i(Ei.REVIEW);return}o(!0),V(`${gt} is analyzing ${O?"your commanders":"your commander"}...`);try{const vt=O?`${E.name} & ${O.name}`:E.name,ft=await ul.getDeckStrategy(at,vt,e.playstyle,[],e?.settings?.helper);ft.layout||(ft.layout={functional:{Lands:36,"Mana Ramp":10,"Card Draw":10,Removal:10,"Board Wipes":3,Synergy:30},types:{Creatures:30,Instants:10,Sorceries:10,Artifacts:10,Enchantments:4,Planeswalkers:0,Lands:36}}),L(ft),!g.trim()&&ft.suggestedName&&b(ft.suggestedName),i(Ei.REVIEW)}catch(vt){console.error(vt),r("AI Generation Failed. Proceeding manually.","error"),L({theme:"",strategy:"Manual strategy required.",layout:{functional:{Lands:36,Creatures:63},types:{Lands:36,Creatures:63}}}),i(Ei.REVIEW)}finally{o(!1)}},ce=async()=>{o(!0);try{const at={name:g||(O?`${E.name} & ${O.name}`:E?.name)||"New Commander Deck",format:v,commander:E?.data||E||null,commanderPartner:O?.data||O||null,aiBlueprint:k?{theme:k.theme,strategy:k.strategy,suggestedCounts:k.layout?.functional||k.layout,typeCounts:k.layout?.types}:null,isMockup:Y},gt=await Ge.post("/api/decks",at);r("Deck created successfully!","success"),t(`/decks/${gt.id}`)}catch(at){console.error(at),r("Failed to create deck","error")}finally{o(!1)}},Be=async at=>{be(!0),Z(!1),r("Resolving cards with Oracle...","info",1e4);try{const gt=[...at.mainboard,...at.sideboard],vt=await yT.resolveCards(gt);if(vt.length===0){r("No valid cards found to import.","error"),be(!1);return}const ft={deck:{name:"Imported Deck",format:"Commander",commander:null},cards:vt.map(ut=>({scryfall_id:ut.scryfall_id,name:ut.name,set_code:ut.set_code,collector_number:ut.collector_number,finish:ut.isFoil?"foil":"nonfoil",count:ut.quantity||1,data:ut.data})),options:{checkCollection:!0,addToCollection:!0}},ot=await Ge.post("/api/decks/import",ft);r(`Deck imported! ${ot.missingCards?.length?`(${ot.missingCards.length} missing)`:""}`,"success"),t(`/decks/${ot.deckId}`)}catch(gt){console.error(gt),r("Import Failed","error")}finally{be(!1)}};y.useEffect(()=>{n===Ei.AI_STRATEGY&&E&&!k&&Ie()},[n]);const ct=({card:at,onClick:gt,isSelected:vt})=>{const ft=ne(at),ot=H(at),ut=at.data||at;return s.jsx("div",{onClick:()=>gt(at),className:`group relative h-[480px] rounded-3xl cursor-pointer transition-all duration-300 hover:-translate-y-2 ${vt?"ring-4 ring-indigo-500 scale-105":""}`,children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[55%] w-full relative overflow-hidden bg-gray-950",children:[ft?s.jsx("img",{src:ft,alt:at.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("span",{className:"text-gray-700 font-bold",children:"No Art"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}),s.jsxs("div",{className:"h-[45%] p-5 flex flex-col relative",children:[s.jsxs("div",{className:"absolute -top-3 left-5 flex gap-2 z-10",children:[s.jsx("div",{className:"flex gap-1 bg-gray-900/90 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:ot.map((At,Fe)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${At}.svg`,alt:At,className:"w-4 h-4 shadow-sm"},Fe))}),at.finish==="foil"&&s.jsx("div",{className:"flex items-center justify-center w-8 h-8 -mt-1 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-[0_0_15px_rgba(250,204,21,0.6)] animate-pulse",title:"Foil",children:s.jsx("svg",{className:"w-5 h-5 text-white drop-shadow-sm",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),s.jsxs("div",{className:"mt-4 flex-1 flex flex-col gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:at.name}),s.jsx("p",{className:"text-xs text-gray-400 font-medium line-clamp-1 border-b border-white/5 pb-2 mb-2",children:ut.type_line})]}),s.jsx("p",{className:"text-[10px] text-gray-300 leading-relaxed font-serif opacity-80 line-clamp-4",children:ut.oracle_text})]}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[ut.power&&ut.toughness&&s.jsxs("div",{className:"bg-gray-800/80 px-2 py-1 rounded text-xs font-bold text-white border border-white/10 shadow-inner",children:[ut.power," / ",ut.toughness]}),s.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select"})]})]})]})})},Ve=y.useMemo(()=>{if(!j.length)return{};const at={};return j.filter(vt=>vt.name.toLowerCase().includes(S.toLowerCase())||(vt.data?.type_line||"").toLowerCase().includes(S.toLowerCase())).forEach(vt=>{const ft=H(vt),ot=dj(ft);at[ot.badge]||(at[ot.badge]={identity:ot,cards:[]}),at[ot.badge].cards.push(vt)}),at},[j,S]),Ne=()=>{const at=S.trim().length>0,gt=Object.entries(Ve).sort((ft,ot)=>{const ut=ft[1].identity.colors.length-ot[1].identity.colors.length;return ut!==0?ut:ot[1].cards.length-ft[1].cards.length}),vt=(ft,ot,ut)=>s.jsxs("div",{onClick:ut,className:"w-full bg-gray-900/60 hover:bg-gray-800/60 backdrop-blur-md border border-white/5 rounded-2xl p-6 cursor-pointer transition-all flex items-center justify-between group mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-1.5 border border-white/5",children:ft.identity.colors.map(At=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${At}.svg`,alt:At,className:"w-5 h-5 shadow-sm"},At))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:ft.identity.badge}),s.jsxs("p",{className:"text-sm text-gray-400 italic line-clamp-1",children:['"',ft.identity.flavor,'"']})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[ft.cards.length," ",v==="Commander"?"Legends":"Cards"]}),s.jsx("svg",{className:`w-6 h-6 text-gray-400 transform transition-transform ${ot?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-4 gap-4 shrink-0",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:v==="Commander"?"Choose Commander":"Choose Spotlight Card"}),s.jsx("p",{className:"text-gray-400",children:v==="Commander"?"Select the legend who will lead your deck.":"Select a card to feature as the face of your deck."})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:()=>re(!0),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-purple-500/20 flex items-center gap-2 transition-all hover:-translate-y-0.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Database"]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-1 flex border border-white/10",children:[s.jsx("button",{onClick:()=>c("list"),className:`p-2 rounded-lg transition-all ${l==="list"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("button",{onClick:()=>c("folder"),className:`p-2 rounded-lg transition-all ${l==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"Folder View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:v==="Commander"?"Search legends...":"Search cards...",value:S,onChange:ft=>T(ft.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),S&&s.jsx("button",{onClick:()=>T(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:[l==="folder"&&!p&&s.jsx(s.Fragment,{children:gt.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mb-6 border border-gray-700",children:s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Cards Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:S?"No cards match your search filters.":"We couldn't find any qualifying cards in your collection."}),s.jsxs("button",{onClick:()=>re(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/20 hover:-translate-y-1 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Full Database"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:gt.map(([ft,ot])=>s.jsxs("div",{onClick:()=>m(ft),className:"bg-gray-800/40 hover:bg-gray-700/50 border border-white/5 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-2 border border-white/5",children:ot.identity.colors.map(ut=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ut}.svg`,alt:ut,className:"w-6 h-6"},ut))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-indigo-300 transition-colors uppercase tracking-wide",children:ot.identity.badge}),s.jsx("div",{className:"h-0.5 w-8 bg-indigo-500/50 mx-auto my-2"}),s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',ot.identity.flavor,'"']})]}),s.jsxs("span",{className:"text-sm font-mono font-bold text-gray-500 bg-black/20 px-3 py-1 rounded-full mt-2",children:[ot.cards.length," ",v==="Commander"?"Legends":"Cards"]})]},ft))})}),l==="folder"&&p&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:()=>m(null),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors font-bold uppercase text-xs tracking-widest mb-4",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Groups"]}),s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("h3",{className:"text-3xl font-black text-white",children:Ve[p].identity.badge}),s.jsx("div",{className:"flex gap-1",children:Ve[p].identity.colors.map(ft=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ft}.svg`,alt:ft,className:"w-6 h-6"},ft))})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ve[p].cards.map(ft=>s.jsx(ct,{card:ft,onClick:me},ft.id))})]}),l==="list"&&s.jsx("div",{className:"space-y-4",children:gt.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in border border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-400",children:"No cards found in your collection matching criteria."}),s.jsx("button",{onClick:()=>re(!0),className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 hover:underline",children:"Search Scryfall Database"})]}):gt.map(([ft,ot])=>{const ut=u[ft]||at;return s.jsxs("div",{children:[vt(ot,ut,()=>h(At=>({...At,[ft]:!At[ft]}))),ut&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8 pl-4 border-l-2 border-white/5 animate-fade-in",children:ot.cards.map(At=>s.jsx(ct,{card:At,onClick:me},At.id))})]},ft)})})]})]})},Ye=()=>{const at=j.filter(gt=>{const vt=gt.data||gt,ft=vt.keywords||[],ot=vt.oracle_text||"",ut=ft.includes("Partner")||ot.includes("Partner");return gt.id===E?.id||!ut?!1:gt.name.toLowerCase().includes(M.toLowerCase())});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Choose Partner"}),s.jsxs("p",{className:"text-gray-400",children:["Select a partner for ",E?.name,"."]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search partners...",value:M,onChange:gt=>$(gt.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),M&&s.jsx("button",{onClick:()=>$(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("button",{onClick:()=>{B(null),i(Ei.AI_STRATEGY)},className:"text-sm font-bold text-gray-400 hover:text-white underline self-center",children:"Skip / Solo Commander"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[at.map(gt=>s.jsx(ct,{card:gt,onClick:ke},gt.id)),at.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500",children:"No valid partners found matching your search."})]})]})},St=()=>s.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in text-center",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full animate-ping absolute inset-0"}),s.jsx("div",{className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center relative shadow-[0_0_50px_rgba(79,70,229,0.5)]",children:s.jsx("svg",{className:"w-10 h-10 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})]}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:R}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Brewing a perfect strategy tailored to your playstyle."})]}),Vt=()=>{const at=k?.layout?.functional||{},gt=k?.layout?.types||{};return s.jsxs("div",{className:"animate-fade-in flex flex-col space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-6 mb-8 shrink-0 sticky -top-8 z-30 bg-gray-950/90 backdrop-blur-xl pt-4 pb-6 -mx-8 px-8 rounded-t-3xl border-b border-white/5",children:[s.jsxs("div",{className:"space-y-2 flex-1 w-full",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deck Name"}),s.jsx("input",{type:"text",value:g,onChange:vt=>b(vt.target.value),className:"w-full text-4xl font-black bg-transparent border-b-2 border-white/10 focus:border-indigo-500 text-white placeholder-gray-600 outline-none pb-2 transition-colors",placeholder:"Name your deck..."})]}),s.jsxs("button",{onClick:ce,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 px-10 rounded-2xl shadow-lg shadow-indigo-500/20 transform hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 shrink-0",children:[a?"Forging...":"Create Deck",!a&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),s.jsx("div",{className:"space-y-8 flex-1",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md",children:[s.jsx("h3",{className:"text-xl font-bold text-indigo-300 mb-4",children:"Theme & Strategy"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Theme"}),s.jsx("p",{className:"text-lg text-white font-medium",children:k?.theme})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Gameplan"}),s.jsx("div",{className:"text-sm text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:k?.strategy}})]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Composition Preview"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Functional Needs"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(at).map(([vt,ft])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:vt}),s.jsx("span",{className:"font-mono font-bold text-indigo-400",children:ft})]},vt))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Type Balance"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(gt).map(([vt,ft])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:vt}),s.jsx("span",{className:"font-mono font-bold text-emerald-400",children:ft})]},vt))})]})]})]})})]})},Lt=E?ne(E):null;return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative flex flex-col pb-20",children:[Lt&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-cover bg-center transition-all duration-1000 transform scale-105",style:{backgroundImage:`url(${Lt})`}}),s.jsx("div",{className:"fixed inset-0 bg-gray-950/60 backdrop-blur-2xl transition-all duration-1000"}),s.jsx("div",{className:"fixed inset-0 bg-gradient-to-t from-gray-950 via-gray-950/50 to-transparent"})]}),!Lt&&s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/20 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto w-full px-6 py-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>t("/decks"),className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),s.jsx("div",{className:"h-8 w-[1px] bg-white/10 mx-2"}),s.jsx("div",{className:"flex gap-2",children:[Ei.BASICS,Ei.COMMANDER,Ei.AI_STRATEGY,Ei.REVIEW].map((at,gt)=>s.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${n>=at?"w-12 bg-indigo-500":"w-4 bg-gray-700"}`},at))})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 shadow-2xl backdrop-blur-xl animate-fade-in-up",children:[a&&n!==Ei.AI_STRATEGY&&s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),!a&&n===Ei.BASICS&&s.jsxs("div",{className:"flex flex-col items-center space-y-12 animate-fade-in py-8",children:[s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tight text-center",children:["Let's build something ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"legendary."})]}),s.jsxs("div",{className:"w-full max-w-5xl px-4 space-y-12",children:[E&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-white/5 backdrop-blur-sm animate-fade-in-down",children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:v==="Commander"?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl opacity-50 group-hover:opacity-75 blur transition duration-500"}),s.jsx("img",{src:E.image_uris?.normal||E.image_uris?.large,alt:E.name,className:"relative w-64 rounded-xl shadow-2xl transform group-hover:scale-[1.02] transition-all duration-500"})]}),s.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-3xl font-black text-white mb-2",children:E.name}),s.jsx("p",{className:"text-gray-400 text-sm",children:E.type_line}),s.jsx("p",{className:"text-gray-300 mt-4 text-base leading-relaxed",children:E.oracle_text})]}),s.jsxs("button",{onClick:()=>I(null),className:"self-start text-sm font-bold text-red-400 hover:text-red-300 underline mt-4",children:["Change ",v==="Commander"?"Commander":"Spotlight Card"]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Commander"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{X(!1),w("Commander"),le("Commander",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-indigo-900/20 border border-white/10 hover:border-indigo-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-indigo-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"From Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build using only cards you own.",s.jsx("br",{}),"Oracle verifies your binder."]})]})]}),s.jsxs("div",{onClick:()=>{X(!0),w("Commander"),le("Commander",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-purple-900/20 border border-white/10 hover:border-purple-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-purple-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-purple-300 transition-colors",children:"Theorycraft Mockup"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Design without limits.",s.jsx("br",{}),"Missing cards added to wishlist."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Quick Actions"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 max-w-2xl mx-auto w-full",children:[s.jsxs("div",{onClick:()=>Z(!0),className:"group cursor-pointer bg-gray-800/40 hover:bg-blue-900/20 border border-white/10 hover:border-blue-500/50 rounded-3xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-blue-500/10 flex items-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-blue-500/30 flex-shrink-0",children:s.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),s.jsxs("div",{className:"relative z-10 text-left",children:[s.jsx("h3",{className:"text-xl font-black text-white mb-1 group-hover:text-blue-300 transition-colors",children:"Import Deck"}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Paste from Arena, Moxfield, or text file."})]})]}),s.jsxs("div",{className:"group opacity-50 cursor-not-allowed bg-gray-800/20 border border-white/5 rounded-3xl p-6 flex items-center gap-4 relative",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-700/20 rounded-2xl flex items-center justify-center border border-white/5 flex-shrink-0",children:s.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10 text-left",children:[s.jsx("h3",{className:"text-xl font-black text-gray-500 mb-1",children:"Scan Deck"}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Coming soon to Mobile Companion."})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Standard"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),"                                        ",s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{X(!1),w("Standard"),le("Standard",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-emerald-900/20 border border-white/10 hover:border-emerald-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-emerald-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-emerald-300 transition-colors",children:"Standard Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build a 60-card Standard deck.",s.jsx("br",{}),"Using your own cards."]})]})]}),s.jsxs("div",{onClick:()=>{X(!0),w("Standard"),le("Standard",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-cyan-900/20 border border-white/10 hover:border-cyan-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-cyan-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-cyan-300 transition-colors",children:"Standard Theorycraft"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Test new Standard meta decks.",s.jsx("br",{}),"Without owning every card."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Precons"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),q?s.jsx("div",{className:"flex justify-center p-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[se.map(at=>s.jsxs("div",{onClick:()=>t(`/precons?type=${encodeURIComponent(at)}`),className:"group cursor-pointer bg-gray-800/40 hover:bg-amber-900/20 border border-white/10 hover:border-amber-500/50 rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-amber-500/10 flex flex-col items-center text-center gap-3 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-amber-500/30",children:s.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-amber-300 transition-colors",children:at})]},at)),se.length===0&&s.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No precon types found. (Is the DB populated?)"})]})]})]})]}),!a&&n===Ei.COMMANDER&&Ne(),!a&&n===Ei.PARTNER&&Ye(),n===Ei.AI_STRATEGY&&St(),!a&&n===Ei.REVIEW&&Vt()]})]}),s.jsx(D8e,{isOpen:J,onClose:()=>re(!1),onAdd:()=>ye()}),s.jsx(B8e,{isOpen:W,onClose:()=>Z(!1),onImport:Be}),de&&s.jsxs("div",{className:"fixed inset-0 z-[60] bg-black/80 flex flex-col items-center justify-center backdrop-blur-sm",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mb-4"}),s.jsx("div",{className:"text-white font-bold text-xl",children:"Importing Deck..."}),s.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"Checking collection for matches"})]})]})};function HL(t){const{currentUser:e}=Or(),r=Lm(),n=["deck",t],{data:i,isLoading:a,error:o,refetch:l}=U1({queryKey:n,queryFn:async()=>{if(!e||!t||t==="new")return null;const{deck:m,items:g}=await Ge.get(`/api/decks/${t}`),b=g.map(v=>({...v,countInDeck:v.count||1,managedId:v.id}));return{deck:m,cards:b}},enabled:!!e&&!!t&&t!=="new",staleTime:1e3*60*5}),c=i?.deck||null,u=i?.cards||[];return{deck:c,cards:u,setDeck:m=>{r.setQueryData(n,g=>({...g,deck:typeof m=="function"?m(g.deck):m}))},setCards:m=>{r.setQueryData(n,g=>({...g,cards:typeof m=="function"?m(g.cards):m}))},loading:a,error:o,refresh:l}}const Yee=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmLabel:a="Confirm",isDangerous:o=!1})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:`bg-gray-900 border ${o?"border-red-500/50":"border-blue-500/50"} rounded-2xl max-w-sm w-full p-6 shadow-2xl transform transition-all scale-100`,children:[s.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[s.jsx("div",{className:`w-12 h-12 rounded-full ${o?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-400"} flex items-center justify-center mb-4`,children:s.jsx(J5,{className:"w-6 h-6"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:i})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-lg transition-colors",children:"Cancel"}),s.jsx("button",{onClick:r,className:`flex-1 px-4 py-2 font-bold rounded-lg transition-colors ${o?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:a})]})]})}):null,F8e=(t,e)=>{if(!t||t.length===0)return!0;const r=new Set(e||[]);return t.every(n=>r.has(n))},U8e=({isOpen:t,onClose:e,deck:r,deckCards:n=[],onCardAdded:i})=>{const{cards:a,loading:o}=vl(),{currentUser:l}=Or(),{addToast:c}=jn(),{openCardModal:u}=z1(),[h,p]=y.useState(""),[m,g]=y.useState("All"),[b,v]=y.useState(!1),[w,j]=y.useState({colors:[],rarity:[],set:"",manaValue:""}),[_,E]=y.useState("name"),I=y.useMemo(()=>{if(!a||!r)return[];const S=r.format?.toLowerCase()==="standard",T=r.commander?.color_identity||[],M=r.commander_partner?.color_identity||[],$=new Set([...T,...M]);return a.filter(L=>{if(L.deckId)return!1;const R=L.type_line?.toLowerCase().includes("basic land");if(!S&&!F8e(L.color_identity,[...$]))return!1;if(w.colors.length>0){const J=L.color_identity||[];if(!w.colors.some(se=>se==="C"?J.length===0:J.includes(se)))return!1}if(w.rarity.length>0&&!w.rarity.includes(L.rarity?.toLowerCase()))return!1;if(w.set){const J=w.set.toLowerCase();if(!L.set?.toLowerCase().includes(J)&&!L.set_name?.toLowerCase().includes(J))return!1}if(w.manaValue!==""){const J=parseFloat(w.manaValue);if(L.cmc!==J)return!1}const V=n.filter(J=>J.name===L.name).reduce((J,re)=>J+(re.countInDeck||1),0);if(!R&&V>=(S?4:1))return!1;const X=h.toLowerCase();return!(X&&!L.name.toLowerCase().includes(X)&&!L.type_line?.toLowerCase().includes(X)||m!=="All"&&!L.type_line?.toLowerCase().includes(m.toLowerCase()))}).sort((L,R)=>{if(_==="name")return L.name.localeCompare(R.name);if(_.startsWith("price")){const V=parseFloat(L.prices?.usd||L.data?.prices?.usd||0),Y=parseFloat(R.prices?.usd||R.data?.prices?.usd||0);return _==="price-asc"?V-Y:Y-V}if(_==="rarity"){const V={mythic:4,rare:3,uncommon:2,common:1},Y=V[L.rarity?.toLowerCase()]||0;return(V[R.rarity?.toLowerCase()]||0)-Y}return 0})},[a,r,n,h,m,w,_]),O=async(S,T="mainboard")=>{try{const M={...S,board:T};await Xo.addCardToDeck(l.uid,r.id,M);const $=T==="mainboard"?"Mainboard":T==="sideboard"?"Sideboard":"Maybeboard";c(`Added ${S.name} to ${$}`,"success"),i&&i()}catch(M){console.error(M),c("Failed to add card","error")}};if(!t)return null;const B=["All","Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"];return Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl h-[85vh] flex flex-col border border-gray-700",children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50 rounded-t-xl shrink-0",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-indigo-400",children:"Add from Collection"}),s.jsxs("span",{className:"text-sm font-normal text-gray-400 bg-gray-800 px-2 py-0.5 rounded-full border border-gray-700",children:[I.length," Available"]})]})}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 hover:bg-gray-700 p-2 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700 space-y-4 shrink-0",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, type, or text...",className:"w-full bg-gray-900 text-white border border-gray-700 rounded-lg py-3 px-4 pl-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-inner",value:h,onChange:S=>p(S.target.value),autoFocus:!0}),s.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(S=>s.jsx("button",{onClick:()=>g(S),className:`px-3 py-1 text-xs font-bold rounded-full transition-colors border ${m===S?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200"}`,children:S},S))}),s.jsxs("button",{onClick:()=>v(!b),className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg border transition-all ${b?"bg-indigo-600 text-white border-indigo-500 shadow-lg":"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),b?"Hide Filters":"Advanced Filters"]})]}),b&&s.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-700 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-down shadow-inner",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Color Identity"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["W","U","B","R","G"].filter(S=>r?.format?.toLowerCase()==="standard"?!0:new Set([...r?.commander?.color_identity||[],...r?.commander_partner?.color_identity||[]]).has(S)).map(S=>s.jsx("button",{onClick:()=>j(T=>({...T,colors:T.colors.includes(S)?T.colors.filter(M=>M!==S):[...T.colors,S]})),className:`w-8 h-8 rounded-full border flex items-center justify-center transition-all ${w.colors.includes(S)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-gray-700":"opacity-40 grayscale hover:grayscale-0 hover:opacity-100 border-gray-600 bg-gray-800"}`,children:s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${S}.svg`,alt:S,className:"w-5 h-5 shadow-sm"})},S)),s.jsx("button",{onClick:()=>j(S=>({...S,colors:S.colors.includes("C")?S.colors.filter(T=>T!=="C"):[...S.colors,"C"]})),className:`w-8 h-8 rounded-full border flex items-center justify-center text-[10px] font-black transition-all ${w.colors.includes("C")?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-indigo-600 text-white":"opacity-40 border-gray-600 bg-gray-800 text-gray-500 hover:opacity-100"}`,children:"C"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(S=>s.jsx("button",{onClick:()=>j(T=>({...T,rarity:T.rarity.includes(S)?T.rarity.filter(M=>M!==S):[...T.rarity,S]})),className:`px-3 py-1 text-[10px] font-bold uppercase rounded-lg border transition-all ${w.rarity.includes(S)?"bg-indigo-600 text-white border-indigo-400 shadow-md":"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:text-gray-300"}`,children:S.charAt(0)},S))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Set (Name/Code)"}),s.jsx("input",{type:"text",placeholder:"e.g. MH3 or Modern Horizons 3",value:w.set,onChange:S=>j(T=>({...T,set:S.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Mana Value"}),s.jsx("input",{type:"number",min:"0",placeholder:"CMC",value:w.manaValue,onChange:S=>j(T=>({...T,manaValue:S.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Sort By"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("select",{value:_,onChange:S=>E(S.target.value),className:"bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500 w-full",children:[s.jsx("option",{value:"name",children:"Name (A-Z)"}),s.jsx("option",{value:"price-desc",children:"Price (Highest)"}),s.jsx("option",{value:"price-asc",children:"Price (Lowest)"}),s.jsx("option",{value:"rarity",children:"Rarity"})]}),s.jsx("button",{onClick:()=>{j({colors:[],rarity:[],set:"",manaValue:""}),E("name"),p(""),g("All")},className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 transition-colors uppercase tracking-widest mt-1",children:"Reset All"})]})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-950/50 p-4 custom-scrollbar",children:o?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):I.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-2",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),s.jsx("p",{children:"No cards found matching your criteria."})]}):s.jsx("div",{className:"space-y-3",children:I.map((S,T)=>{const M=S.data||S,$=M.image_uris?.art_crop||M.image_uris?.normal||M.card_faces?.[0]?.image_uris?.art_crop||M.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/100x100?text=No+Img",k=parseFloat(S.prices?.[S.finish==="foil"?"usd_foil":"usd"]||0).toFixed(2);return s.jsxs("div",{className:"flex bg-gray-800/60 rounded-xl border border-gray-700/50 hover:bg-gray-800 hover:border-indigo-500/50 transition-all group overflow-hidden h-24 relative",children:[s.jsxs("div",{className:"w-24 shrink-0 relative overflow-hidden cursor-pointer",onClick:()=>u(S),children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent to-gray-900/90 z-10"}),s.jsx("img",{src:$,className:"w-full h-full object-cover scale-150 transition-transform duration-700 group-hover:scale-125",alt:S.name,loading:"lazy"}),S.finish==="foil"&&s.jsx("div",{className:"absolute top-1 left-1 z-20 text-yellow-500 bg-black/60 rounded-full p-1 leading-none shadow-sm border border-yellow-500/30",title:"Foil",children:s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})})]}),s.jsxs("div",{className:"flex-1 flex items-center justify-between px-4 py-2 min-w-0",children:[s.jsxs("div",{className:"flex flex-col justify-center min-w-0 pr-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"font-bold text-gray-100 text-base truncate cursor-pointer hover:text-indigo-400 transition-colors",onClick:()=>u(S),children:S.name}),s.jsx("span",{className:"text-xs font-mono text-gray-500 bg-gray-900 px-1.5 py-0.5 rounded border border-gray-700 shrink-0",children:S.mana_cost||""})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[s.jsx("span",{className:"truncate",children:S.type_line}),s.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),s.jsx("span",{className:"font-mono text-xs uppercase bg-gray-700/50 px-1.5 rounded text-gray-300 border border-gray-600/50",children:S.set?.toUpperCase()}),k>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),s.jsxs("span",{className:"text-green-400/90 font-mono text-xs font-bold",children:["$",k]})]})]}),s.jsx("div",{className:"mt-1.5 flex items-center gap-2",children:s.jsxs("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider bg-gray-900/80 px-2 py-0.5 rounded-full",children:["Stack: ",S.count||1]})})]}),s.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[s.jsx("button",{onClick:L=>{L.stopPropagation(),O(S,"mainboard")},className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg shadow-lg shadow-indigo-900/20 border border-indigo-500/50 transition-all active:scale-95 flex flex-col items-center min-w-[80px]",children:s.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Main"})}),s.jsx("button",{onClick:L=>{L.stopPropagation(),O(S,"sideboard")},className:"bg-gray-700 hover:bg-gray-600 text-gray-200 hover:text-white px-4 py-2 rounded-lg shadow-lg border border-gray-600 transition-all active:scale-95 flex flex-col items-center min-w-[80px]",children:s.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Side"})})]})]})]},S.firestoreId||`${S.id}-${T}`)})})})]})}),document.body)},a5=[{key:"W",name:"White",color:"bg-yellow-100",text:"text-yellow-600",border:"border-yellow-200/50",bg:"bg-yellow-500/10",pip:""},{key:"U",name:"Blue",color:"bg-blue-400",text:"text-blue-400",border:"border-blue-500/30",bg:"bg-blue-500/10",pip:""},{key:"B",name:"Black",color:"bg-gray-600",text:"text-gray-400",border:"border-gray-500/30",bg:"bg-gray-500/10",pip:""},{key:"R",name:"Red",color:"bg-red-500",text:"text-red-400",border:"border-red-500/30",bg:"bg-red-500/10",pip:""},{key:"G",name:"Green",color:"bg-green-500",text:"text-green-400",border:"border-green-500/30",bg:"bg-green-500/10",pip:""},{key:"C",name:"Colorless",color:"bg-gray-400",text:"text-gray-500",border:"border-gray-600/30",bg:"bg-gray-600/10",pip:""}],z8e=({cards:t=[]})=>{const e=y.useMemo(()=>{const n={pips:{W:0,U:0,B:0,R:0,G:0,C:0},production:{W:0,U:0,B:0,R:0,G:0,C:0},curve:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0},colorCurve:{W:[0,0,0,0,0,0,0,0],U:[0,0,0,0,0,0,0,0],B:[0,0,0,0,0,0,0,0],R:[0,0,0,0,0,0,0,0],G:[0,0,0,0,0,0,0,0],C:[0,0,0,0,0,0,0,0]},totalPips:0,totalProduction:0,nonLandCount:0,avgCMC:0};let i=0;return t.forEach(a=>{const o=a.data||a,l=(o.type_line||"").toLowerCase(),c=l.includes("land"),u=o.mana_cost||"",h=(o.oracle_text||"").toLowerCase();if(!c){n.nonLandCount+=a.countInDeck||1;const g=o.cmc??0;i+=g*(a.countInDeck||1),(u.match(/\{([^}]+)\}/g)||[]).forEach(w=>{w.slice(1,-1).split("/").forEach(E=>{if(["W","U","B","R","G","C"].includes(E)){n.pips[E]+=a.countInDeck||1,n.totalPips+=a.countInDeck||1;const I=Math.min(Math.floor(g),7);n.colorCurve[E][I]+=a.countInDeck||1}})});const v=g>=7?"7+":Math.floor(g);n.curve[v]+=a.countInDeck||1}let p=o.produced_mana||[];(h.includes("any color")||h.includes("mana of any color"))&&(p=["W","U","B","R","G"]),p.length===0&&c&&(l.includes("plains")&&p.push("W"),l.includes("island")&&p.push("U"),l.includes("swamp")&&p.push("B"),l.includes("mountain")&&p.push("R"),l.includes("forest")&&p.push("G")),!c&&h.includes("add {")&&["w","u","b","r","g","c"].forEach(g=>{h.includes(`add {${g}}`)&&p.push(g.toUpperCase())}),[...new Set(p)].forEach(g=>{n.production[g]!==void 0&&(n.production[g]+=a.countInDeck||1,n.totalProduction+=a.countInDeck||1)})}),n.avgCMC=n.nonLandCount>0?(i/n.nonLandCount).toFixed(2):0,n},[t]),r=(n,i="bg-indigo-500",a="h-48")=>{const o=Object.entries(n),l=Math.max(...o.map(c=>c[1]),1);return s.jsx("div",{className:`flex gap-1 ${a} w-full px-2`,children:o.map(([c,u])=>s.jsxs("div",{className:"flex-1 h-full flex flex-col justify-end items-center group relative",children:[u>0&&s.jsx("div",{className:`w-full ${i} rounded-t transition-all duration-500 group-hover:brightness-125`,style:{height:`${u/l*100}%`},children:s.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 px-1 rounded",children:u})}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 mt-2",children:c})]},c))})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Cost (Pips)"}),s.jsxs("span",{children:[e.totalPips," Total"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800",children:a5.filter(n=>e.pips[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700`,style:{width:`${e.pips[n.key]/e.totalPips*100}%`},title:`${n.name}: ${e.pips[n.key]}`},n.key))})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Production"}),s.jsxs("span",{children:[e.totalProduction," Sources"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800 shadow-inner",children:a5.filter(n=>e.production[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700 opacity-80`,style:{width:`${e.production[n.key]/e.totalProduction*100}%`},title:`${n.name}: ${e.production[n.key]}`},n.key))})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:a5.map(n=>{const i=e.pips[n.key],a=e.production[n.key],o=e.totalPips>0?Math.round(i/e.totalPips*100):0,l=e.totalProduction>0?Math.round(a/e.totalProduction*100):0,c=i>0||a>0;return s.jsxs("div",{className:`p-4 rounded-2xl border transition-all duration-300 ${c?`${n.bg} ${n.border}`:"bg-gray-800/10 border-gray-800/50 opacity-40"}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("span",{className:"text-2xl",children:n.pip}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:`text-[10px] font-black uppercase tracking-tighter ${n.text}`,children:n.name})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Cost"}),s.jsxs("span",{className:"text-white",children:[o,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} transition-all duration-1000`,style:{width:`${o}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[i," pips"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Prod"}),s.jsxs("span",{className:"text-white",children:[l,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} opacity-60 transition-all duration-1000`,style:{width:`${l}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[a," mana"]})]})]})]},n.key)})}),s.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-2xl border border-gray-800/50",children:[s.jsx("div",{className:"flex justify-between items-end mb-8",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"Mana Curve"}),s.jsxs("p",{className:"text-xs text-gray-500 font-medium",children:["Average Mana Value (Non-lands): ",s.jsx("span",{className:"text-indigo-400",children:e.avgCMC})]})]})}),r(e.curve,"bg-indigo-500","h-40")]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a5.filter(n=>e.pips[n.key]>0).map(n=>s.jsxs("div",{className:"bg-gray-900/30 p-4 rounded-xl border border-gray-800/50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-lg",children:n.pip}),s.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${n.text}`,children:[n.name," Spells"]})]}),r(Object.fromEntries(e.colorCurve[n.key].map((i,a)=>[a===7?"7+":a,i])),n.color,"h-24")]},n.key))})]})},Xee=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{userProfile:i}=Or(),a=i?.settings?.helper?.name||"The Oracle";return t?w4.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-6xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[10px] font-black font-mono text-indigo-400 uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Analytics"}),s.jsx("span",{className:"text-[10px] font-black font-mono text-gray-400 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded border border-white/5",children:a})]}),s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Deck Performance"})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 custom-scrollbar",children:s.jsx(z8e,{cards:r})}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Analytics"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body):null},q8e=({isOpen:t,onClose:e,deck:r,cards:n=[],onStrategyUpdate:i})=>{const{userProfile:a,currentUser:o}=Or(),{addToast:l}=jn(),c=a?.settings?.helper?.name||"The Oracle",[u,h]=Pe.useState(!1),[p,m]=Pe.useState(0),[g,b]=Pe.useState(!1),[v,w]=Pe.useState(r.notes||""),[j,_]=Pe.useState(!1),[E,I]=Pe.useState(!!(r.notes&&r.notes.length>0)),O=async()=>{if(v!==(r.notes||"")){_(!0);try{await Xo.updateDeck(o.uid,r.id,{notes:v}),l("Notes saved","success"),i&&i()}catch(re){console.error(re),l("Failed to save notes","error")}finally{_(!1)}}};if(Pe.useEffect(()=>(t?(m(0),b(!1),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t||!r)return null;const B=r.aiBlueprint||{},S=B.strategy||`<p class="text-gray-400 italic">No strategy generated for this deck yet. Ask ${c} to analyze it.</p>`,T=B.theme||"Uncharted Strategy",M=[r.commander];r.commander_partner&&M.push(r.commander_partner);const $=M[p]||M[0],k=$?.card_faces?.length>1,L=()=>{if(!$)return"https://placehold.co/480x680?text=Commander";if(k){const re=$.card_faces[g?1:0];return re.image_uris?.art_crop||re.image_uris?.large||re.image_uris?.normal}return $.image_uris?.art_crop||$.image_uris?.large||$.image_uris?.normal||$.image_uri},R=B.layout?.functional||B.suggestedCounts||{},V=B.layout?.types||B.typeCounts||{},Y=Ln(a?.subscription_tier).features.aiStrategy,X=!!B.strategy,J=async()=>{if(!a?.settings?.geminiApiKey){l("Gemini API Key missing in settings.","error");return}h(!0);try{console.log("[DeckStrategy] requesting new strategy...");const re=await ul.getDeckStrategy(a.settings.geminiApiKey,r.commander?.name||"Unknown Commander",a.playstyle,n,r.commander_partner?.name);console.log("[DeckStrategy] new strategy received:",re);const se=await Xo.updateDeck(o.uid,r.id,{aiBlueprint:{...B,theme:re.theme,strategy:re.strategy,layout:re.layout}});console.log("[DeckStrategy] update response:",se),l("Strategy updated based on your current build!","success"),await new Promise(ee=>setTimeout(ee,500)),i&&await i()}catch(re){console.error(re),l("Failed to rerun strategy analysis.","error")}finally{h(!1)}};return w4.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-5xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"absolute -top-[20%] -right-[10%] w-[500px] h-[500px] bg-indigo-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute -bottom-[20%] -left-[10%] w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"px-4 py-6 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsxs("div",{className:"flex items-center gap-4 md:gap-6 w-full md:w-auto",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm",children:s.jsx("span",{className:"text-3xl",children:""})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl md:text-3xl font-black text-white tracking-tighter uppercase leading-none mb-1",dangerouslySetInnerHTML:{__html:T}}),s.jsxs("p",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.3em]",children:[c," Strategic Blueprint"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4 w-full md:w-auto justify-end",children:[s.jsxs("button",{onClick:Y?J:()=>l(`Upgrade to ${Vs[nr.TIER_2].name} to use AI Strategy tools.`,"info"),disabled:u||!Y,className:`flex-1 md:flex-none flex items-center justify-center gap-2 md:gap-3 px-4 md:px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all border ${u||!Y?"bg-white/5 text-gray-500 border-white/5 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white border-white/20 shadow-[0_0_20px_rgba(79,70,229,0.3)] hover:shadow-[0_0_30px_rgba(79,70,229,0.5)] active:scale-95"}`,title:Y?"":`Requires ${Vs[nr.TIER_2].name} Tier`,children:[u?s.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{className:"md:hidden",children:u?"Consulting...":"Recreate"}),s.jsx("span",{className:"hidden md:inline",children:u?`Consulting with ${c}...`:`Have ${c} Recreate Strategy`})]}),s.jsx("div",{className:"w-px h-8 bg-white/10 mx-2"}),s.jsx("button",{onClick:e,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl transition-all text-gray-400 hover:text-white border border-white/5 hover:border-white/10 group",children:s.jsx("svg",{className:"w-6 h-6 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-10 py-10 custom-scrollbar space-y-12 relative z-10 overscroll-contain",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"sticky top-0 space-y-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl rounded-[2rem] group-hover:bg-indigo-500/30 transition-all duration-700"}),s.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden shadow-2xl border border-white/10 z-10 bg-black/40",children:[s.jsx("img",{src:L(),className:"w-full h-full object-cover transition-transform duration-700 active:scale-95",alt:$?.name}),k&&s.jsx("button",{onClick:()=>b(!g),className:"absolute top-4 right-4 p-3 bg-black/60 hover:bg-indigo-600 backdrop-blur-md rounded-full text-white border border-white/20 shadow-lg transition-all group/flip z-30",title:"Flip Card",children:s.jsx("svg",{className:`w-5 h-5 transition-transform duration-500 ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:s.jsxs("div",{className:"text-white font-bold text-center text-sm leading-tight drop-shadow-md",children:[$.name,k&&s.jsx("span",{className:"block text-[9px] text-gray-400 font-normal mt-0.5 uppercase tracking-widest",children:g?"Back Face":"Front Face"})]})})]}),s.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20",children:s.jsxs("div",{className:"bg-black/80 text-white px-5 py-2 rounded-full border border-white/10 shadow-xl backdrop-blur-md flex items-center gap-2 whitespace-nowrap",children:[s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Cards"}),s.jsx("div",{className:"w-px h-3 bg-white/20"}),s.jsxs("span",{className:"text-sm font-black font-mono",children:[(n||[]).length,"/100"]})]})})]}),s.jsxs("div",{className:"text-center pt-4 space-y-4",children:[s.jsxs("div",{onClick:()=>{m(0),b(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${p===0?"bg-indigo-500/10 border-indigo-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${p===0?"text-indigo-400":"text-gray-600"}`,children:"Lead Commander"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${p===0?"text-white":"text-gray-400"}`,children:M[0]?.name})]}),M[1]&&s.jsxs("div",{onClick:()=>{m(1),b(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${p===1?"bg-purple-500/10 border-purple-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${p===1?"text-purple-400":"text-gray-600"}`,children:"Partnered With"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${p===1?"text-white":"text-gray-400"}`,children:M[1].name})]})]})]})}),s.jsxs("div",{className:"space-y-10",children:[s.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-9xl",children:""})}),s.jsx("button",{onClick:()=>I(!E),className:"w-full text-left focus:outline-none group/header",children:s.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-px bg-gray-700 transition-colors group-hover/header:bg-indigo-500"}),"Deck Notes",s.jsx("span",{className:`transform transition-transform duration-300 ${E?"rotate-180":""}`,children:s.jsx("svg",{className:"w-4 h-4 text-gray-500 group-hover/header:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),j&&s.jsx("span",{className:"text-indigo-400 animate-pulse ml-2 text-[9px]",children:"Saving..."})]})}),E&&s.jsx("textarea",{value:v,onChange:re=>w(re.target.value),onBlur:O,placeholder:"Add your own notes about card choices, combos, or future upgrade plans...",className:"w-full bg-transparent border-0 text-gray-300 placeholder-gray-600 focus:ring-0 resize-none h-32 leading-relaxed animate-fade-in origin-top"})]}),s.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-9xl",children:""})}),s.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-px bg-gray-700"}),X||Y?"Tactical Overview":`Tactical Overview (Requires ${Vs[nr.TIER_2].name})`]}),s.jsx("div",{className:"text-gray-300 leading-relaxed strategy-content-refined font-medium text-lg/8",dangerouslySetInnerHTML:{__html:X||Y?S:`<p class="italic text-gray-500">Strategy generation is available on the ${Vs[nr.TIER_2].name} tier. Upgrade to unlock deep strategic insights for your deck.</p>`}})]}),s.jsxs("div",{className:"space-y-8",children:[Object.keys(R).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),"Target Functional Needs"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(R).map(([re,se])=>s.jsxs("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-indigo-400 transition-colors h-8 flex items-center justify-center",children:re}),s.jsx("div",{className:"text-3xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:se})]},re))})]}),Object.keys(V).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-purple-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Target Type Distribution"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(V).map(([re,se])=>s.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-purple-400 transition-colors h-8 flex items-center justify-center",children:re}),s.jsx("div",{className:"text-2xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:se})]},re))})]})]})]})]})}),s.jsx("div",{className:"px-10 py-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0 relative z-10",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Blueprint"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .strategy-content-refined h4 {
                    font-size: 1.1rem;
                    font-weight: 800;
                    color: white;
                    margin-top: 1.5rem;
                    margin-bottom: 0.5rem;
                }
                .strategy-content-refined p {
                    margin-bottom: 1rem;
                }
                .strategy-content-refined strong {
                    color: #a5b4fc; /* Indigo 300 */
                }
                .strategy-content-refined ul {
                    list-style-type: disc;
                    padding-left: 1.5rem;
                    margin-bottom: 1rem;
                    color: #9ca3af;
                }
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body)},V8e=({isOpen:t,onClose:e,deck:r,onUpdateDeck:n})=>{const{user:i}=Or(),[a,o]=y.useState([]),[l,c]=y.useState([]),[u,h]=y.useState(!0),[p,m]=y.useState(!1),[g,b]=y.useState(""),[v,w]=y.useState(!1),[j,_]=y.useState(""),[E,I]=y.useState("viewer"),[O,B]=y.useState(!1);y.useEffect(()=>{t&&r&&(T(),m(r.is_public||!1),b(r.share_slug||S(r.name)))},[t,r]);const S=R=>R.toLowerCase().replace(/[^a-z0-9]+/g,"-")+"-"+Math.random().toString(36).substring(2,6),T=async()=>{h(!0);try{const R=await ia.fetchPermissions(r.id);o(R);const Y=(await ia.fetchRelationships()).filter(X=>X.status==="accepted").map(X=>X.friend);c(Y)}catch(R){console.error("Failed to load share data",R)}finally{h(!1)}},M=async R=>{if(R.preventDefault(),!!j){B(!0);try{await ia.grantPermission(j,E,r.id),await T(),_("")}catch(V){alert(`Failed to share: ${V.message}`)}finally{B(!1)}}},$=async R=>{try{await ia.revokePermission(R),await T()}catch{alert("Failed to revoke access.")}},k=async()=>{const R=!p,V=g||S(r.name);try{await ia.updateDeckPublicStatus(r.id,R,V),m(R),b(V),n({...r,is_public:R,share_slug:V})}catch{alert("Failed to update public status.")}},L=()=>{const R=window.location.origin;navigator.clipboard.writeText(`${R}/share/${g}`),w(!0),setTimeout(()=>w(!1),2e3)};return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-indigo-500/20 rounded-2xl w-full max-w-lg shadow-2xl p-6 animate-fade-in-up",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),s.jsx("p",{className:"text-sm text-gray-400 mb-6 truncate",children:r?.name}),s.jsxs("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl p-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${p?"bg-green-500":"bg-gray-500"}`}),s.jsx("span",{className:"font-bold text-gray-200",children:"Public Link"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"sr-only peer",checked:p,onChange:k}),s.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500"})]})]}),p&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/share/${g}`,className:"flex-1 bg-gray-950 border border-gray-700 rounded-lg px-3 py-2 text-xs text-gray-300 select-all"}),s.jsx("button",{onClick:L,className:"px-3 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-colors",children:v?"Copied!":"Copy"})]}),s.jsx("div",{className:"flex justify-center p-4 bg-white rounded-xl w-fit mx-auto shadow-lg",children:s.jsx(ZQ,{value:`${window.location.origin}/share/${g}`,size:128,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 128 128"})}),s.jsx("p",{className:"text-center text-[10px] text-gray-400",children:"Scan to view on mobile"})]}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:p?"Anyone with this link can view this deck.":"Only people you explicitly add below can access this deck."})]}),s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest mb-3",children:"Add People"}),s.jsxs("form",{onSubmit:M,className:"flex gap-2 mb-6",children:[s.jsxs("select",{value:j,onChange:R=>_(R.target.value),className:"flex-1 bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",required:!0,children:[s.jsx("option",{value:"",children:"Select a friend..."}),l.map(R=>s.jsx("option",{value:R.id,children:R.username},R.id))]}),s.jsxs("select",{value:E,onChange:R=>I(R.target.value),className:"bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",children:[s.jsx("option",{value:"viewer",children:"Viewer"}),s.jsx("option",{value:"contributor",children:"Contributor"}),s.jsx("option",{value:"editor",children:"Editor"})]}),s.jsx("button",{type:"submit",disabled:O||!j,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Add"})]}),s.jsx("div",{className:"space-y-4 max-h-[200px] overflow-y-auto",children:a.length===0?s.jsx("p",{className:"text-center text-gray-500 text-xs italic py-4",children:"No specific people have access."}):a.map(R=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 text-xs font-bold",children:R.grantee_username?.[0]?.toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-gray-200",children:R.grantee_username}),s.jsx("div",{className:"text-xs text-gray-500 capitalize",children:R.permission_level})]})]}),s.jsx("button",{onClick:()=>$(R.id),className:"text-red-400 hover:text-red-300 text-xs font-bold px-2 py-1 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Remove"})]},R.id))})]})]}):null},Qee=({isOpen:t,onClose:e,deck:r,cards:n,isOwner:i})=>{const{userProfile:a,currentUser:o}=Or(),{addToast:l}=jn();xn();const c=a?.settings?.helper?.name||"The Oracle",[u,h]=y.useState(!1),[p,m]=y.useState(r?.aiBlueprint?.grade||null),[g,b]=y.useState(!1);if(Pe.useEffect(()=>{t&&r?.aiBlueprint?.grade&&m(r.aiBlueprint.grade)},[t,r]),!t)return null;const v=async()=>{h(!0);try{const w=a?.settings?.geminiApiKey;if(!w){l("Please save your API Key in Settings > AI first.","error"),h(!1);return}const j=await ul.gradeDeck(w,{deckName:r.name,commander:r.commander?.name||"Unknown",cards:n,playerProfile:"Competitive but casual friendly",strategyGuide:r.description||"General synergy",helperPersona:a?.settings?.helper});if(m(j),i){const _={...r.aiBlueprint,grade:j,lastDiagnosed:new Date().toISOString()};await Xo.updateDeck(o.uid,r.id,{aiBlueprint:_}),l("Power Level Calibrated & Saved!","success")}}catch(w){console.error(w),l("Doctor is out. Try again later.","error")}finally{h(!1)}};return w4.createPortal(s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full max-w-4xl rounded-3xl border border-white/10 shadow-2xl p-8 relative flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-start mb-8 relative z-10",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white italic uppercase",children:"Deck Power Analysis"}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Evaluated by ",c]})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white p-2",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.12] saturate-[1.5] brightness-125",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"",className:"w-[80%] h-[80%] object-contain"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-12 relative z-10",children:[!p&&!u&&s.jsxs("div",{className:"text-center py-20",children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Ready to calibrate?"}),s.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"This process will analyze every card in your deck to determine its competitive bracket and numerical power level."}),s.jsxs("button",{onClick:v,className:"px-10 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black text-lg rounded-2xl shadow-xl hover:shadow-indigo-500/20 transition-all uppercase tracking-widest flex items-center gap-3 mx-auto",children:[s.jsx("span",{children:"Run Diagnosis"}),s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),u&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-6",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-b-4 border-indigo-500"}),s.jsx("p",{className:"text-indigo-400 font-black text-xl animate-pulse uppercase tracking-widest",children:"Simulating Matchups..."})]}),p&&s.jsxs("div",{className:"animate-fade-in space-y-10",children:[s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"inline-flex flex-col items-center",children:[s.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm mb-2",children:"Power Level"}),s.jsxs("div",{className:"text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 filter drop-shadow-lg",children:[Number(p.powerLevel).toFixed(2),s.jsx("span",{className:"text-3xl text-gray-600 ml-2",children:"/ 10"})]})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[p.metrics.efficiency,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Efficiency"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[p.metrics.interaction,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Interaction"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["Turn ",p.metrics.winTurn]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Avg Win Turn"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-center text-gray-500 text-xs font-black uppercase tracking-[0.2em]",children:["Commander Bracket: ",p.commanderBracket]}),s.jsx("div",{className:"grid grid-cols-5 gap-1 h-32 rounded-2xl overflow-hidden border border-white/10",children:[{id:1,label:"Exhibition",desc:"Ultra-Casual",color:"bg-yellow-500/20 text-yellow-500 border-yellow-500/50"},{id:2,label:"Core",desc:"Average Precon",color:"bg-green-500/20 text-green-500 border-green-500/50"},{id:3,label:"Upgraded",desc:"Beyond Precon",color:"bg-blue-500/20 text-blue-500 border-blue-500/50"},{id:4,label:"Optimized",desc:"High Power",color:"bg-orange-500/20 text-orange-500 border-orange-500/50"},{id:5,label:"cEDH",desc:"Competitive",color:"bg-purple-500/20 text-purple-500 border-purple-500/50"}].map(w=>{const j=p.commanderBracket===w.id;return s.jsxs("div",{className:`relative flex flex-col items-center justify-center p-4 border-t-4 transition-all ${j?`bg-gray-800 ${w.color.replace("/20","/10")} border-t-4 border-b-0 border-l-0 border-r-0`:"bg-gray-950 border-gray-800 opacity-40 grayscale"}`,style:{borderColor:j?void 0:"transparent"},children:[j&&s.jsx("div",{className:"absolute top-2 right-2 bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded",children:"MATCH"}),s.jsx("div",{className:`text-2xl font-black mb-1 ${j?w.color.split(" ")[1]:"text-gray-500"}`,children:w.id}),s.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider mb-1",children:w.label}),s.jsx("div",{className:"text-[10px] text-gray-400 text-center leading-tight",children:w.desc})]},w.id)})})]}),s.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:"Bracket Justification"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed italic",children:['"',p.bracketJustification,'"']})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," Clinical Critique"]}),s.jsx("div",{className:"bg-gray-950/50 p-8 rounded-3xl border border-white/5 shadow-inner",children:s.jsx("p",{className:"text-gray-300 leading-relaxed text-lg font-medium",children:p.critique})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-orange-500",children:""})," Mechanical improvements"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.mechanicalImprovements.map((w,j)=>s.jsxs("div",{className:"flex gap-4 p-5 bg-white/5 rounded-2xl border border-white/5 items-start group hover:bg-orange-500/10 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400 font-bold shrink-0",children:j+1}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed group-hover:text-white transition-colors",children:w})]},j))})]}),s.jsxs("div",{className:"space-y-6 pb-12",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""})," Surgical Swaps"]}),s.jsx("div",{className:"space-y-4",children:p.recommendedSwaps.map((w,j)=>s.jsxs("div",{className:"p-6 bg-gray-950/50 rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-2",children:"Cut This Card"}),s.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:s.jsx("span",{className:"text-white font-bold",children:w.remove})})]}),s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 border border-white/10 flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})}),s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-2",children:"Slot This In"}),s.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl text-right",children:s.jsx("span",{className:"text-white font-bold",children:w.add})})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',w.reason,'"']})})]},j))})]}),s.jsx("div",{className:"flex justify-center pb-12",children:s.jsxs("button",{onClick:v,disabled:u,className:"flex items-center gap-2 px-8 py-3 bg-indigo-900/40 hover:bg-indigo-600/40 text-indigo-300 rounded-xl border border-indigo-500/20 transition-all font-bold uppercase text-xs tracking-widest group",children:[s.jsx("svg",{className:`w-4 h-4 transition-transform duration-700 ${u?"animate-spin":"group-hover:rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),u?"Consulting Oracle...":"Rerun Diagnosis"]})})]})]})]})}),document.body)},H8e="modulepreload",W8e=function(t){return"/"+t},$F={},dN=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let c=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=c(r.map(u=>{if(u=W8e(u),u in $F)return;$F[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":H8e,h||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((g,b)=>{m.addEventListener("load",g),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function ms(t){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(t)}var Ku=Uint8Array,bc=Uint16Array,WL=Int32Array,GL=new Ku([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),KL=new Ku([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),FF=new Ku([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jee=function(t,e){for(var r=new bc(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new WL(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},Zee=Jee(GL,2),G8e=Zee.b,vT=Zee.r;G8e[28]=258,vT[258]=28;var K8e=Jee(KL,0),UF=K8e.r,wT=new bc(32768);for(var ni=0;ni<32768;++ni){var t0=(ni&43690)>>1|(ni&21845)<<1;t0=(t0&52428)>>2|(t0&13107)<<2,t0=(t0&61680)>>4|(t0&3855)<<4,wT[ni]=((t0&65280)>>8|(t0&255)<<8)>>1}var Cv=(function(t,e,r){for(var n=t.length,i=0,a=new bc(e);i<n;++i)t[i]&&++a[t[i]-1];var o=new bc(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var l;if(r){l=new bc(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],p=o[t[i]-1]++<<h,m=p|(1<<h)-1;p<=m;++p)l[wT[p]>>c]=u}else for(l=new bc(n),i=0;i<n;++i)t[i]&&(l[i]=wT[o[t[i]-1]++]>>15-t[i]);return l}),bm=new Ku(288);for(var ni=0;ni<144;++ni)bm[ni]=8;for(var ni=144;ni<256;++ni)bm[ni]=9;for(var ni=256;ni<280;++ni)bm[ni]=7;for(var ni=280;ni<288;++ni)bm[ni]=8;var kj=new Ku(32);for(var ni=0;ni<32;++ni)kj[ni]=5;var Y8e=Cv(bm,9,0),X8e=Cv(kj,5,0),ete=function(t){return(t+7)/8|0},Q8e=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ku(t.subarray(e,r))},wh=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Iy=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},jC=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:rte,l:0};if(i==1){var o=new Ku(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(O,B){return O.f-B.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,h=1,p=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=i-1;)l=r[r[u].f<r[p].f?u++:p++],c=r[u!=h&&r[u].f<r[p].f?u++:p++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var m=a[0].s,n=1;n<i;++n)a[n].s>m&&(m=a[n].s);var g=new bc(m+1),b=NT(r[h-1],g,0);if(b>e){var n=0,v=0,w=b-e,j=1<<w;for(a.sort(function(B,S){return g[S.s]-g[B.s]||B.f-S.f});n<i;++n){var _=a[n].s;if(g[_]>e)v+=j-(1<<b-g[_]),g[_]=e;else break}for(v>>=w;v>0;){var E=a[n].s;g[E]<e?v-=1<<e-g[E]++-1:++n}for(;n>=0&&v;--n){var I=a[n].s;g[I]==e&&(--g[I],++v)}b=e}return{t:new Ku(g),l:b}},NT=function(t,e,r){return t.s==-1?Math.max(NT(t.l,e,r+1),NT(t.r,e,r+1)):e[t.s]=r},zF=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new bc(++e),n=0,i=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[l]}return{c:r.subarray(0,n),n:e}},Ly=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},tte=function(t,e,r){var n=r.length,i=ete(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},qF=function(t,e,r,n,i,a,o,l,c,u,h){wh(e,h++,r),++i[256];for(var p=jC(i,15),m=p.t,g=p.l,b=jC(a,15),v=b.t,w=b.l,j=zF(m),_=j.c,E=j.n,I=zF(v),O=I.c,B=I.n,S=new bc(19),T=0;T<_.length;++T)++S[_[T]&31];for(var T=0;T<O.length;++T)++S[O[T]&31];for(var M=jC(S,7),$=M.t,k=M.l,L=19;L>4&&!$[FF[L-1]];--L);var R=u+5<<3,V=Ly(i,bm)+Ly(a,kj)+o,Y=Ly(i,m)+Ly(a,v)+o+14+3*L+Ly(S,$)+2*S[16]+3*S[17]+7*S[18];if(c>=0&&R<=V&&R<=Y)return tte(e,h,t.subarray(c,c+u));var X,J,re,se;if(wh(e,h,1+(Y<V)),h+=2,Y<V){X=Cv(m,g,0),J=m,re=Cv(v,w,0),se=v;var ee=Cv($,k,0);wh(e,h,E-257),wh(e,h+5,B-1),wh(e,h+10,L-4),h+=14;for(var T=0;T<L;++T)wh(e,h+3*T,$[FF[T]]);h+=3*L;for(var q=[_,O],U=0;U<2;++U)for(var W=q[U],T=0;T<W.length;++T){var Z=W[T]&31;wh(e,h,ee[Z]),h+=$[Z],Z>15&&(wh(e,h,W[T]>>5&127),h+=W[T]>>12)}}else X=Y8e,J=bm,re=X8e,se=kj;for(var T=0;T<l;++T){var de=n[T];if(de>255){var Z=de>>18&31;Iy(e,h,X[Z+257]),h+=J[Z+257],Z>7&&(wh(e,h,de>>23&31),h+=GL[Z]);var be=de&31;Iy(e,h,re[be]),h+=se[be],be>3&&(Iy(e,h,de>>5&8191),h+=KL[be])}else Iy(e,h,X[de]),h+=J[de]}return Iy(e,h,X[256]),h+J[256]},J8e=new WL([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rte=new Ku(0),Z8e=function(t,e,r,n,i,a){var o=a.z||t.length,l=new Ku(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=a.l,h=(a.r||0)&7;if(e){h&&(c[0]=a.r>>3);for(var p=J8e[e-1],m=p>>13,g=p&8191,b=(1<<r)-1,v=a.p||new bc(32768),w=a.h||new bc(b+1),j=Math.ceil(r/3),_=2*j,E=function(Ie){return(t[Ie]^t[Ie+1]<<j^t[Ie+2]<<_)&b},I=new WL(25e3),O=new bc(288),B=new bc(32),S=0,T=0,M=a.i||0,$=0,k=a.w||0,L=0;M+2<o;++M){var R=E(M),V=M&32767,Y=w[R];if(v[V]=Y,w[R]=V,k<=M){var X=o-M;if((S>7e3||$>24576)&&(X>423||!u)){h=qF(t,c,0,I,O,B,T,$,L,M-L,h),$=S=T=0,L=M;for(var J=0;J<286;++J)O[J]=0;for(var J=0;J<30;++J)B[J]=0}var re=2,se=0,ee=g,q=V-Y&32767;if(X>2&&R==E(M-q))for(var U=Math.min(m,X)-1,W=Math.min(32767,M),Z=Math.min(258,X);q<=W&&--ee&&V!=Y;){if(t[M+re]==t[M+re-q]){for(var de=0;de<Z&&t[M+de]==t[M+de-q];++de);if(de>re){if(re=de,se=q,de>U)break;for(var be=Math.min(q,de-2),oe=0,J=0;J<be;++J){var ne=M-q+J&32767,H=v[ne],le=ne-H&32767;le>oe&&(oe=le,Y=ne)}}}V=Y,Y=v[V],q+=V-Y&32767}if(se){I[$++]=268435456|vT[re]<<18|UF[se];var ye=vT[re]&31,me=UF[se]&31;T+=GL[ye]+KL[me],++O[257+ye],++B[me],k=M+re,++S}else I[$++]=t[M],++O[t[M]]}}for(M=Math.max(M,k);M<o;++M)I[$++]=t[M],++O[t[M]];h=qF(t,c,u,I,O,B,T,$,L,M-L,h),u||(a.r=h&7|c[h/8|0]<<3,h-=7,a.h=w,a.p=v,a.i=M,a.w=k)}else{for(var M=a.w||0;M<o+u;M+=65535){var ke=M+65535;ke>=o&&(c[h/8|0]=u,ke=o),h=tte(c,h+1,t.subarray(M,ke))}a.i=o}return Q8e(l,0,n+ete(h)+i)},nte=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},eIe=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Ku(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return Z8e(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},ste=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},tIe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=nte();i.p(e.dictionary),ste(t,2,i.d())}};function jT(t,e){e||(e={});var r=nte();r.p(t);var n=eIe(t,e,e.dictionary?6:2,4);return tIe(n,e),ste(n,n.length-4,r.d()),n}var rIe=typeof TextDecoder<"u"&&new TextDecoder,nIe=0;try{rIe.decode(rte,{stream:!0}),nIe=1}catch{}function sIe(t){if(Array.isArray(t))return t}function iIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(h){u=!0,i=h}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function VF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function aIe(t,e){if(t){if(typeof t=="string")return VF(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?VF(t,e):void 0}}function oIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HF(t,e){return sIe(t)||iIe(t,e)||aIe(t,e)||oIe()}function WF(t,e="utf8"){return new TextDecoder(e).decode(t)}const lIe=new TextEncoder;function cIe(t){return lIe.encode(t)}const uIe=1024*8,dIe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),kC={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class YL{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=uIe,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof YL)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=kC[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===dIe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new kC[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new kC[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return WF(this.readBytes(e))}decodeText(e=1,r="utf8"){return WF(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(cIe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Nb(t){let e=t.length;for(;--e>=0;)t[e]=0}const hIe=3,fIe=258,ite=29,pIe=256,mIe=pIe+1+ite,ate=30,gIe=512,xIe=new Array((mIe+2)*2);Nb(xIe);const bIe=new Array(ate*2);Nb(bIe);const yIe=new Array(gIe);Nb(yIe);const vIe=new Array(fIe-hIe+1);Nb(vIe);const wIe=new Array(ite);Nb(wIe);const NIe=new Array(ate);Nb(NIe);const jIe=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+e[n++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var kT=jIe;const kIe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},_Ie=new Uint32Array(kIe()),SIe=(t,e,r,n)=>{const i=_Ie,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var xd=SIe,_T={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ote={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const CIe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var EIe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)CIe(r,n)&&(t[n]=r[n])}}return t},AIe=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let o=t[n];r.set(o,i),i+=o.length}return r},lte={assign:EIe,flattenChunks:AIe};let cte=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cte=!1}const d1=new Uint8Array(256);for(let t=0;t<256;t++)d1[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;d1[254]=d1[254]=1;var TIe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,o=t.length,l=0;for(i=0;i<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,i=0;a<l;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const IIe=(t,e)=>{if(e<65534&&t.subarray&&cte)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var LIe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let o=t[n++];if(o<128){a[i++]=o;continue}let l=d1[o];if(l>4){a[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return IIe(a,i)},PIe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+d1[t[r]]>e?r:e},ST={string2buf:TIe,buf2string:LIe,utf8border:PIe};function OIe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var RIe=OIe;const o5=16209,MIe=16191;var DIe=function(e,r){let n,i,a,o,l,c,u,h,p,m,g,b,v,w,j,_,E,I,O,B,S,T,M,$;const k=e.state;n=e.next_in,M=e.input,i=n+(e.avail_in-5),a=e.next_out,$=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=k.dmax,u=k.wsize,h=k.whave,p=k.wnext,m=k.window,g=k.hold,b=k.bits,v=k.lencode,w=k.distcode,j=(1<<k.lenbits)-1,_=(1<<k.distbits)-1;e:do{b<15&&(g+=M[n++]<<b,b+=8,g+=M[n++]<<b,b+=8),E=v[g&j];t:for(;;){if(I=E>>>24,g>>>=I,b-=I,I=E>>>16&255,I===0)$[a++]=E&65535;else if(I&16){O=E&65535,I&=15,I&&(b<I&&(g+=M[n++]<<b,b+=8),O+=g&(1<<I)-1,g>>>=I,b-=I),b<15&&(g+=M[n++]<<b,b+=8,g+=M[n++]<<b,b+=8),E=w[g&_];r:for(;;){if(I=E>>>24,g>>>=I,b-=I,I=E>>>16&255,I&16){if(B=E&65535,I&=15,b<I&&(g+=M[n++]<<b,b+=8,b<I&&(g+=M[n++]<<b,b+=8)),B+=g&(1<<I)-1,B>c){e.msg="invalid distance too far back",k.mode=o5;break e}if(g>>>=I,b-=I,I=a-o,B>I){if(I=B-I,I>h&&k.sane){e.msg="invalid distance too far back",k.mode=o5;break e}if(S=0,T=m,p===0){if(S+=u-I,I<O){O-=I;do $[a++]=m[S++];while(--I);S=a-B,T=$}}else if(p<I){if(S+=u+p-I,I-=p,I<O){O-=I;do $[a++]=m[S++];while(--I);if(S=0,p<O){I=p,O-=I;do $[a++]=m[S++];while(--I);S=a-B,T=$}}}else if(S+=p-I,I<O){O-=I;do $[a++]=m[S++];while(--I);S=a-B,T=$}for(;O>2;)$[a++]=T[S++],$[a++]=T[S++],$[a++]=T[S++],O-=3;O&&($[a++]=T[S++],O>1&&($[a++]=T[S++]))}else{S=a-B;do $[a++]=$[S++],$[a++]=$[S++],$[a++]=$[S++],O-=3;while(O>2);O&&($[a++]=$[S++],O>1&&($[a++]=$[S++]))}}else if((I&64)===0){E=w[(E&65535)+(g&(1<<I)-1)];continue r}else{e.msg="invalid distance code",k.mode=o5;break e}break}}else if((I&64)===0){E=v[(E&65535)+(g&(1<<I)-1)];continue t}else if(I&32){k.mode=MIe;break e}else{e.msg="invalid literal/length code",k.mode=o5;break e}break}}while(n<i&&a<l);O=b>>3,n-=O,b-=O<<3,g&=(1<<b)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<l?257+(l-a):257-(a-l),k.hold=g,k.bits=b};const $g=15,GF=852,KF=592,YF=0,_C=1,XF=2,BIe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$Ie=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),FIe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),UIe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),zIe=(t,e,r,n,i,a,o,l)=>{const c=l.bits;let u=0,h=0,p=0,m=0,g=0,b=0,v=0,w=0,j=0,_=0,E,I,O,B,S,T=null,M;const $=new Uint16Array($g+1),k=new Uint16Array($g+1);let L=null,R,V,Y;for(u=0;u<=$g;u++)$[u]=0;for(h=0;h<n;h++)$[e[r+h]]++;for(g=c,m=$g;m>=1&&$[m]===0;m--);if(g>m&&(g=m),m===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<m&&$[p]===0;p++);for(g<p&&(g=p),w=1,u=1;u<=$g;u++)if(w<<=1,w-=$[u],w<0)return-1;if(w>0&&(t===YF||m!==1))return-1;for(k[1]=0,u=1;u<$g;u++)k[u+1]=k[u]+$[u];for(h=0;h<n;h++)e[r+h]!==0&&(o[k[e[r+h]]++]=h);if(t===YF?(T=L=o,M=20):t===_C?(T=BIe,L=$Ie,M=257):(T=FIe,L=UIe,M=0),_=0,h=0,u=p,S=a,b=g,v=0,O=-1,j=1<<g,B=j-1,t===_C&&j>GF||t===XF&&j>KF)return 1;for(;;){R=u-v,o[h]+1<M?(V=0,Y=o[h]):o[h]>=M?(V=L[o[h]-M],Y=T[o[h]-M]):(V=96,Y=0),E=1<<u-v,I=1<<b,p=I;do I-=E,i[S+(_>>v)+I]=R<<24|V<<16|Y|0;while(I!==0);for(E=1<<u-1;_&E;)E>>=1;if(E!==0?(_&=E-1,_+=E):_=0,h++,--$[u]===0){if(u===m)break;u=e[r+o[h]]}if(u>g&&(_&B)!==O){for(v===0&&(v=g),S+=p,b=u-v,w=1<<b;b+v<m&&(w-=$[b+v],!(w<=0));)b++,w<<=1;if(j+=1<<b,t===_C&&j>GF||t===XF&&j>KF)return 1;O=_&B,i[O]=g<<24|b<<16|S-a|0}}return _!==0&&(i[S+_]=u-v<<24|64<<16|0),l.bits=g,0};var Ev=zIe;const qIe=0,ute=1,dte=2,{Z_FINISH:QF,Z_BLOCK:VIe,Z_TREES:l5,Z_OK:ym,Z_STREAM_END:HIe,Z_NEED_DICT:WIe,Z_STREAM_ERROR:su,Z_DATA_ERROR:hte,Z_MEM_ERROR:fte,Z_BUF_ERROR:GIe,Z_DEFLATED:JF}=ote,Pk=16180,ZF=16181,eU=16182,tU=16183,rU=16184,nU=16185,sU=16186,iU=16187,aU=16188,oU=16189,_j=16190,Nh=16191,SC=16192,lU=16193,CC=16194,cU=16195,uU=16196,dU=16197,hU=16198,c5=16199,u5=16200,fU=16201,pU=16202,mU=16203,gU=16204,xU=16205,EC=16206,bU=16207,yU=16208,fi=16209,pte=16210,mte=16211,KIe=852,YIe=592,XIe=15,QIe=XIe,vU=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function JIe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qm=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Pk||e.mode>mte?1:0},gte=t=>{if(qm(t))return su;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Pk,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(KIe),e.distcode=e.distdyn=new Int32Array(YIe),e.sane=1,e.back=-1,ym},xte=t=>{if(qm(t))return su;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,gte(t)},bte=(t,e)=>{let r;if(qm(t))return su;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?su:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,xte(t))},yte=(t,e)=>{if(!t)return su;const r=new JIe;t.state=r,r.strm=t,r.window=null,r.mode=Pk;const n=bte(t,e);return n!==ym&&(t.state=null),n},ZIe=t=>yte(t,QIe);let wU=!0,AC,TC;const eLe=t=>{if(wU){AC=new Int32Array(512),TC=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Ev(ute,t.lens,0,288,AC,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Ev(dte,t.lens,0,32,TC,0,t.work,{bits:5}),wU=!1}t.lencode=AC,t.lenbits=9,t.distcode=TC,t.distbits=5},vte=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},tLe=(t,e)=>{let r,n,i,a,o,l,c,u,h,p,m,g,b,v,w=0,j,_,E,I,O,B,S,T;const M=new Uint8Array(4);let $,k;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qm(t)||!t.output||!t.input&&t.avail_in!==0)return su;r=t.state,r.mode===Nh&&(r.mode=SC),o=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,h=r.bits,p=l,m=c,T=ym;e:for(;;)switch(r.mode){case Pk:if(r.wrap===0){r.mode=SC;break}for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,M[0]=u&255,M[1]=u>>>8&255,r.check=xd(r.check,M,2,0),u=0,h=0,r.mode=ZF;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=fi;break}if((u&15)!==JF){t.msg="unknown compression method",r.mode=fi;break}if(u>>>=4,h-=4,S=(u&15)+8,r.wbits===0&&(r.wbits=S),S>15||S>r.wbits){t.msg="invalid window size",r.mode=fi;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?oU:Nh,u=0,h=0;break;case ZF:for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.flags=u,(r.flags&255)!==JF){t.msg="unknown compression method",r.mode=fi;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=fi;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=xd(r.check,M,2,0)),u=0,h=0,r.mode=eU;case eU:for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=xd(r.check,M,4,0)),u=0,h=0,r.mode=tU;case tU:for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=xd(r.check,M,2,0)),u=0,h=0,r.mode=rU;case rU:if(r.flags&1024){for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=xd(r.check,M,2,0)),u=0,h=0}else r.head&&(r.head.extra=null);r.mode=nU;case nU:if(r.flags&1024&&(g=r.length,g>l&&(g=l),g&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+g),S)),r.flags&512&&r.wrap&4&&(r.check=xd(r.check,n,g,a)),l-=g,a+=g,r.length-=g),r.length))break e;r.length=0,r.mode=sU;case sU:if(r.flags&2048){if(l===0)break e;g=0;do S=n[a+g++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S));while(S&&g<l);if(r.flags&512&&r.wrap&4&&(r.check=xd(r.check,n,g,a)),l-=g,a+=g,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=iU;case iU:if(r.flags&4096){if(l===0)break e;g=0;do S=n[a+g++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S));while(S&&g<l);if(r.flags&512&&r.wrap&4&&(r.check=xd(r.check,n,g,a)),l-=g,a+=g,S)break e}else r.head&&(r.head.comment=null);r.mode=aU;case aU:if(r.flags&512){for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=fi;break}u=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Nh;break;case oU:for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}t.adler=r.check=vU(u),u=0,h=0,r.mode=_j;case _j:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,WIe;t.adler=r.check=1,r.mode=Nh;case Nh:if(e===VIe||e===l5)break e;case SC:if(r.last){u>>>=h&7,h-=h&7,r.mode=EC;break}for(;h<3;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}switch(r.last=u&1,u>>>=1,h-=1,u&3){case 0:r.mode=lU;break;case 1:if(eLe(r),r.mode=c5,e===l5){u>>>=2,h-=2;break e}break;case 2:r.mode=uU;break;case 3:t.msg="invalid block type",r.mode=fi}u>>>=2,h-=2;break;case lU:for(u>>>=h&7,h-=h&7;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=fi;break}if(r.length=u&65535,u=0,h=0,r.mode=CC,e===l5)break e;case CC:r.mode=cU;case cU:if(g=r.length,g){if(g>l&&(g=l),g>c&&(g=c),g===0)break e;i.set(n.subarray(a,a+g),o),l-=g,a+=g,c-=g,o+=g,r.length-=g;break}r.mode=Nh;break;case uU:for(;h<14;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.nlen=(u&31)+257,u>>>=5,h-=5,r.ndist=(u&31)+1,u>>>=5,h-=5,r.ncode=(u&15)+4,u>>>=4,h-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=fi;break}r.have=0,r.mode=dU;case dU:for(;r.have<r.ncode;){for(;h<3;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.lens[L[r.have++]]=u&7,u>>>=3,h-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,$={bits:r.lenbits},T=Ev(qIe,r.lens,0,19,r.lencode,0,r.work,$),r.lenbits=$.bits,T){t.msg="invalid code lengths set",r.mode=fi;break}r.have=0,r.mode=hU;case hU:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[u&(1<<r.lenbits)-1],j=w>>>24,_=w>>>16&255,E=w&65535,!(j<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(E<16)u>>>=j,h-=j,r.lens[r.have++]=E;else{if(E===16){for(k=j+2;h<k;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(u>>>=j,h-=j,r.have===0){t.msg="invalid bit length repeat",r.mode=fi;break}S=r.lens[r.have-1],g=3+(u&3),u>>>=2,h-=2}else if(E===17){for(k=j+3;h<k;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=j,h-=j,S=0,g=3+(u&7),u>>>=3,h-=3}else{for(k=j+7;h<k;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=j,h-=j,S=0,g=11+(u&127),u>>>=7,h-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=fi;break}for(;g--;)r.lens[r.have++]=S}}if(r.mode===fi)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=fi;break}if(r.lenbits=9,$={bits:r.lenbits},T=Ev(ute,r.lens,0,r.nlen,r.lencode,0,r.work,$),r.lenbits=$.bits,T){t.msg="invalid literal/lengths set",r.mode=fi;break}if(r.distbits=6,r.distcode=r.distdyn,$={bits:r.distbits},T=Ev(dte,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,$),r.distbits=$.bits,T){t.msg="invalid distances set",r.mode=fi;break}if(r.mode=c5,e===l5)break e;case c5:r.mode=u5;case u5:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,DIe(t,m),o=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,h=r.bits,r.mode===Nh&&(r.back=-1);break}for(r.back=0;w=r.lencode[u&(1<<r.lenbits)-1],j=w>>>24,_=w>>>16&255,E=w&65535,!(j<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(_&&(_&240)===0){for(I=j,O=_,B=E;w=r.lencode[B+((u&(1<<I+O)-1)>>I)],j=w>>>24,_=w>>>16&255,E=w&65535,!(I+j<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=I,h-=I,r.back+=I}if(u>>>=j,h-=j,r.back+=j,r.length=E,_===0){r.mode=xU;break}if(_&32){r.back=-1,r.mode=Nh;break}if(_&64){t.msg="invalid literal/length code",r.mode=fi;break}r.extra=_&15,r.mode=fU;case fU:if(r.extra){for(k=r.extra;h<k;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=pU;case pU:for(;w=r.distcode[u&(1<<r.distbits)-1],j=w>>>24,_=w>>>16&255,E=w&65535,!(j<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if((_&240)===0){for(I=j,O=_,B=E;w=r.distcode[B+((u&(1<<I+O)-1)>>I)],j=w>>>24,_=w>>>16&255,E=w&65535,!(I+j<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=I,h-=I,r.back+=I}if(u>>>=j,h-=j,r.back+=j,_&64){t.msg="invalid distance code",r.mode=fi;break}r.offset=E,r.extra=_&15,r.mode=mU;case mU:if(r.extra){for(k=r.extra;h<k;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=fi;break}r.mode=gU;case gU:if(c===0)break e;if(g=m-c,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=fi;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),v=r.window}else v=i,b=o-r.offset,g=r.length;g>c&&(g=c),c-=g,r.length-=g;do i[o++]=v[b++];while(--g);r.length===0&&(r.mode=u5);break;case xU:if(c===0)break e;i[o++]=r.length,c--,r.mode=u5;break;case EC:if(r.wrap){for(;h<32;){if(l===0)break e;l--,u|=n[a++]<<h,h+=8}if(m-=c,t.total_out+=m,r.total+=m,r.wrap&4&&m&&(t.adler=r.check=r.flags?xd(r.check,i,m,o-m):kT(r.check,i,m,o-m)),m=c,r.wrap&4&&(r.flags?u:vU(u))!==r.check){t.msg="incorrect data check",r.mode=fi;break}u=0,h=0}r.mode=bU;case bU:if(r.wrap&&r.flags){for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=fi;break}u=0,h=0}r.mode=yU;case yU:T=HIe;break e;case fi:T=hte;break e;case pte:return fte;case mte:default:return su}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,(r.wsize||m!==t.avail_out&&r.mode<fi&&(r.mode<EC||e!==QF))&&vte(t,t.output,t.next_out,m-t.avail_out),p-=t.avail_in,m-=t.avail_out,t.total_in+=p,t.total_out+=m,r.total+=m,r.wrap&4&&m&&(t.adler=r.check=r.flags?xd(r.check,i,m,t.next_out-m):kT(r.check,i,m,t.next_out-m)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Nh?128:0)+(r.mode===c5||r.mode===CC?256:0),(p===0&&m===0||e===QF)&&T===ym&&(T=GIe),T},rLe=t=>{if(qm(t))return su;let e=t.state;return e.window&&(e.window=null),t.state=null,ym},nLe=(t,e)=>{if(qm(t))return su;const r=t.state;return(r.wrap&2)===0?su:(r.head=e,e.done=!1,ym)},sLe=(t,e)=>{const r=e.length;let n,i,a;return qm(t)||(n=t.state,n.wrap!==0&&n.mode!==_j)?su:n.mode===_j&&(i=1,i=kT(i,e,r,0),i!==n.check)?hte:(a=vte(t,e,r,r),a?(n.mode=pte,fte):(n.havedict=1,ym))};var iLe=xte,aLe=bte,oLe=gte,lLe=ZIe,cLe=yte,uLe=tLe,dLe=rLe,hLe=nLe,fLe=sLe,pLe="pako inflate (from Nodeca project)",kh={inflateReset:iLe,inflateReset2:aLe,inflateResetKeep:oLe,inflateInit:lLe,inflateInit2:cLe,inflate:uLe,inflateEnd:dLe,inflateGetHeader:hLe,inflateSetDictionary:fLe,inflateInfo:pLe};function mLe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gLe=mLe;const wte=Object.prototype.toString,{Z_NO_FLUSH:xLe,Z_FINISH:bLe,Z_OK:h1,Z_STREAM_END:IC,Z_NEED_DICT:LC,Z_STREAM_ERROR:yLe,Z_DATA_ERROR:NU,Z_MEM_ERROR:vLe}=ote;function a2(t){this.options=lte.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new RIe,this.strm.avail_out=0;let r=kh.inflateInit2(this.strm,e.windowBits);if(r!==h1)throw new Error(_T[r]);if(this.header=new gLe,kh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ST.string2buf(e.dictionary):wte.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=kh.inflateSetDictionary(this.strm,e.dictionary),r!==h1)))throw new Error(_T[r])}a2.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?bLe:xLe,wte.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=kh.inflate(r,o),a===LC&&i&&(a=kh.inflateSetDictionary(r,i),a===h1?a=kh.inflate(r,o):a===NU&&(a=LC));r.avail_in>0&&a===IC&&r.state.wrap>0&&t[r.next_in]!==0;)kh.inflateReset(r),a=kh.inflate(r,o);switch(a){case yLe:case NU:case LC:case vLe:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===IC))if(this.options.to==="string"){let c=ST.utf8border(r.output,r.next_out),u=r.next_out-c,h=ST.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===h1&&l===0)){if(a===IC)return a=kh.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};a2.prototype.onData=function(t){this.chunks.push(t)};a2.prototype.onEnd=function(t){t===h1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lte.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function wLe(t,e){const r=new a2(e);if(r.push(t),r.err)throw r.msg||_T[r.err];return r.result}var NLe=a2,jLe=wLe,kLe={Inflate:NLe,inflate:jLe};const{Inflate:_Le,inflate:SLe}=kLe;var jU=_Le,CLe=SLe;const Nte=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Nte[t]=e}const kU=4294967295;function ELe(t,e,r){let n=t;for(let i=0;i<r;i++)n=Nte[(n^e[i])&255]^n>>>8;return n}function ALe(t,e){return(ELe(kU,t,e)^kU)>>>0}function _U(t,e,r){const n=t.readUint32(),i=ALe(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function jte(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function kte(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function _te(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function Ste(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function Cte(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+TLe(e[a-i],r[a],r[a-i])&255}}function TLe(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return i<=a&&i<=o?t:a<=o?e:r}function ILe(t,e,r,n,i,a){switch(t){case 0:jte(e,r,i);break;case 1:kte(e,r,i,a);break;case 2:_te(e,r,n,i);break;case 3:Ste(e,r,n,i,a);break;case 4:Cte(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const LLe=new Uint16Array([255]),PLe=new Uint8Array(LLe.buffer),OLe=PLe[0]===255;function RLe(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let h=0;h<7;h++){const p=o[h],m=Math.ceil((r-p.x)/p.xStep),g=Math.ceil((n-p.y)/p.yStep);if(m<=0||g<=0)continue;const b=m*l,v=new Uint8Array(b);for(let w=0;w<g;w++){const j=e[u++],_=e.subarray(u,u+b);u+=b;const E=new Uint8Array(b);ILe(j,_,E,v,b,l),v.set(E);for(let I=0;I<m;I++){const O=p.x+I*p.xStep,B=p.y+w*p.yStep;if(!(O>=r||B>=n))for(let S=0;S<l;S++)c[(B*r+O)*l+S]=E[I*l+S]}}}if(a===16){const h=new Uint16Array(c.buffer);if(OLe)for(let p=0;p<h.length;p++)h[p]=MLe(h[p]);return h}else return c}function MLe(t){return(t&255)<<8|t>>8&255}const DLe=new Uint16Array([255]),BLe=new Uint8Array(DLe.buffer),$Le=BLe[0]===255,FLe=new Uint8Array(0);function SU(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,o=Math.ceil(a/8)*i,l=Math.ceil(a/8*i*r),c=new Uint8Array(n*l);let u=FLe,h=0,p,m;for(let g=0;g<n;g++){switch(p=e.subarray(h+1,h+1+l),m=c.subarray(g*l,(g+1)*l),e[h]){case 0:jte(p,m,l);break;case 1:kte(p,m,l,o);break;case 2:_te(p,m,u,l);break;case 3:Ste(p,m,u,l,o);break;case 4:Cte(p,m,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[h]}`)}u=m,h+=l+1}if(a===16){const g=new Uint16Array(c.buffer);if($Le)for(let b=0;b<g.length;b++)g[b]=ULe(g[b]);return g}else return c}function ULe(t){return(t&255)<<8|t>>8&255}const hN=Uint8Array.of(137,80,78,71,13,10,26,10);function CU(t){if(!zLe(t.readBytes(hN.length)))throw new Error("wrong PNG signature")}function zLe(t){if(t.length<hN.length)return!1;for(let e=0;e<hN.length;e++)if(t[e]!==hN[e])return!1;return!0}const qLe="tEXt",VLe=0,Ete=new TextDecoder("latin1");function HLe(t){if(GLe(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const WLe=/^[\u0000-\u00FF]*$/;function GLe(t){if(!WLe.test(t))throw new Error("invalid latin1 text")}function KLe(t,e,r){const n=Ate(e);t[n]=YLe(e,r-n.length-1)}function Ate(t){for(t.mark();t.readByte()!==VLe;);const e=t.offset;t.reset();const r=Ete.decode(t.readBytes(e-t.offset-1));return t.skip(1),HLe(r),r}function YLe(t,e){return Ete.decode(t.readBytes(e))}const hc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},PC={UNKNOWN:-1,DEFLATE:0},EU={UNKNOWN:-1,ADAPTIVE:0},OC={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},d5={NONE:0,BACKGROUND:1,PREVIOUS:2},RC={SOURCE:0,OVER:1};class XLe extends YL{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new jU,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=PC.UNKNOWN,this._filterMethod=EU.UNKNOWN,this._interlaceMethod=OC.UNKNOWN,this._colorType=hc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(CU(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(CU(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case qLe:KLe(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?_U(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?_U(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=QLe(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case hc.GREYSCALE:n=1;break;case hc.TRUECOLOUR:n=3;break;case hc.INDEXED_COLOUR:n=1;break;case hc.GREYSCALE_ALPHA:n=2;break;case hc.TRUECOLOUR_ALPHA:n=4;break;case hc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==PC.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case hc.GREYSCALE:case hc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case hc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case hc.UNKNOWN:case hc.GREYSCALE_ALPHA:case hc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Ate(this),n=this.readUint8();if(n!==PC.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:CLe(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=SU({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case d5.NONE:break;case d5.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const o=(i*e.width+a)*this._png.channels;for(let l=0;l<this._png.channels;l++)n.data[o+l]=0}break;case d5.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,o)=>{const l=((a+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,c=(a*r.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(r.blendOp){case RC.SOURCE:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let u=0;u<this._png.channels;u++)e.data[l+u]=r.data[c+u]}break;case RC.OVER:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let u=0;u<this._png.channels;u++){const h=r.data[c+this._png.channels-1]/n,p=u%(this._png.channels-1)===0?1:r.data[c+u],m=Math.floor(h*p+(1-h)*e.data[l+u]);e.data[l+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==EU.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===OC.NO_INTERLACE)this._png.data=SU({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===OC.ADAM7)this._png.data=RLe({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:d5.NONE,blendOp:RC.SOURCE,data:e}),this._inflator=new jU,this._writingDataChunks=!1}}function QLe(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var AU;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(AU||(AU={}));function JLe(t,e){return new XLe(t,e).decode()}var Gr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function MC(){Gr.console&&typeof Gr.console.log=="function"&&Gr.console.log.apply(Gr.console,arguments)}var Rs={log:MC,warn:function(t){Gr.console&&(typeof Gr.console.warn=="function"?Gr.console.warn.apply(Gr.console,arguments):MC.call(null,arguments))},error:function(t){Gr.console&&(typeof Gr.console.error=="function"?Gr.console.error.apply(Gr.console,arguments):MC(t))}};function DC(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){yp(n.response,e,r)},n.onerror=function(){Rs.error("could not download file")},n.send()}function TU(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function h5(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var yp=Gr.saveAs||((typeof window>"u"?"undefined":ms(window))!=="object"||window!==Gr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Gr.URL||Gr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?TU(i.href)?DC(t,e,r):h5(i,i.target="_blank"):h5(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){h5(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(TU(t))DC(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){h5(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:ms(a)!=="object"&&(Rs.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return DC(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Gr.HTMLElement)||Gr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":ms(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=o?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=Gr.URL||Gr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function Tte(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var fN=Gr.atob.bind(Gr),IU=Gr.btoa.bind(Gr);function BC(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Ho(r,n,i,a,e[0],7,-680876936),a=Ho(a,r,n,i,e[1],12,-389564586),i=Ho(i,a,r,n,e[2],17,606105819),n=Ho(n,i,a,r,e[3],22,-1044525330),r=Ho(r,n,i,a,e[4],7,-176418897),a=Ho(a,r,n,i,e[5],12,1200080426),i=Ho(i,a,r,n,e[6],17,-1473231341),n=Ho(n,i,a,r,e[7],22,-45705983),r=Ho(r,n,i,a,e[8],7,1770035416),a=Ho(a,r,n,i,e[9],12,-1958414417),i=Ho(i,a,r,n,e[10],17,-42063),n=Ho(n,i,a,r,e[11],22,-1990404162),r=Ho(r,n,i,a,e[12],7,1804603682),a=Ho(a,r,n,i,e[13],12,-40341101),i=Ho(i,a,r,n,e[14],17,-1502002290),r=Wo(r,n=Ho(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Wo(a,r,n,i,e[6],9,-1069501632),i=Wo(i,a,r,n,e[11],14,643717713),n=Wo(n,i,a,r,e[0],20,-373897302),r=Wo(r,n,i,a,e[5],5,-701558691),a=Wo(a,r,n,i,e[10],9,38016083),i=Wo(i,a,r,n,e[15],14,-660478335),n=Wo(n,i,a,r,e[4],20,-405537848),r=Wo(r,n,i,a,e[9],5,568446438),a=Wo(a,r,n,i,e[14],9,-1019803690),i=Wo(i,a,r,n,e[3],14,-187363961),n=Wo(n,i,a,r,e[8],20,1163531501),r=Wo(r,n,i,a,e[13],5,-1444681467),a=Wo(a,r,n,i,e[2],9,-51403784),i=Wo(i,a,r,n,e[7],14,1735328473),r=Go(r,n=Wo(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=Go(a,r,n,i,e[8],11,-2022574463),i=Go(i,a,r,n,e[11],16,1839030562),n=Go(n,i,a,r,e[14],23,-35309556),r=Go(r,n,i,a,e[1],4,-1530992060),a=Go(a,r,n,i,e[4],11,1272893353),i=Go(i,a,r,n,e[7],16,-155497632),n=Go(n,i,a,r,e[10],23,-1094730640),r=Go(r,n,i,a,e[13],4,681279174),a=Go(a,r,n,i,e[0],11,-358537222),i=Go(i,a,r,n,e[3],16,-722521979),n=Go(n,i,a,r,e[6],23,76029189),r=Go(r,n,i,a,e[9],4,-640364487),a=Go(a,r,n,i,e[12],11,-421815835),i=Go(i,a,r,n,e[15],16,530742520),r=Ko(r,n=Go(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Ko(a,r,n,i,e[7],10,1126891415),i=Ko(i,a,r,n,e[14],15,-1416354905),n=Ko(n,i,a,r,e[5],21,-57434055),r=Ko(r,n,i,a,e[12],6,1700485571),a=Ko(a,r,n,i,e[3],10,-1894986606),i=Ko(i,a,r,n,e[10],15,-1051523),n=Ko(n,i,a,r,e[1],21,-2054922799),r=Ko(r,n,i,a,e[8],6,1873313359),a=Ko(a,r,n,i,e[15],10,-30611744),i=Ko(i,a,r,n,e[6],15,-1560198380),n=Ko(n,i,a,r,e[13],21,1309151649),r=Ko(r,n,i,a,e[4],6,-145523070),a=Ko(a,r,n,i,e[11],10,-1120210379),i=Ko(i,a,r,n,e[2],15,718787259),n=Ko(n,i,a,r,e[9],21,-343485551),t[0]=y0(r,t[0]),t[1]=y0(n,t[1]),t[2]=y0(i,t[2]),t[3]=y0(a,t[3])}function Ok(t,e,r,n,i,a){return e=y0(y0(e,t),y0(n,a)),y0(e<<i|e>>>32-i,r)}function Ho(t,e,r,n,i,a,o){return Ok(e&r|~e&n,t,e,i,a,o)}function Wo(t,e,r,n,i,a,o){return Ok(e&n|r&~n,t,e,i,a,o)}function Go(t,e,r,n,i,a,o){return Ok(e^r^n,t,e,i,a,o)}function Ko(t,e,r,n,i,a,o){return Ok(r^(e|~n),t,e,i,a,o)}function Ite(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)BC(n,ZLe(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(BC(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,BC(n,i),n}function ZLe(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var LU="0123456789abcdef".split("");function ePe(t){for(var e="",r=0;r<4;r++)e+=LU[t>>8*r+4&15]+LU[t>>8*r&15];return e}function tPe(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function CT(t){return Ite(t).map(tPe).join("")}var rPe=(function(t){for(var e=0;e<t.length;e++)t[e]=ePe(t[e]);return t.join("")})(Ite("hello"))!="5d41402abc4b2a76b9719d911017c592";function y0(t,e){if(rPe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function ET(t,e){var r,n,i,a;if(t!==r){for(var o=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var h=l[c];u=(u+h+o.charCodeAt(c))%256,l[c]=l[u],l[u]=h}r=t,n=l}else l=n;var p=e.length,m=0,g=0,b="";for(c=0;c<p;c++)g=(g+(h=l[m=(m+1)%256]))%256,l[m]=l[g],l[g]=h,o=l[(l[m]+l[g])%256],b+=String.fromCharCode(e.charCodeAt(c)^o);return b}var PU={print:4,modify:8,copy:16,"annot-forms":32};function tx(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(PU.perm!==void 0)throw new Error("Invalid permission: "+l);i+=PU[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=CT(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=ET(this.encryptionKey,this.padding)}function rx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function OU(t){if(ms(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Gr.console&&Rs.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Sj(t){if(!(this instanceof Sj))return new Sj(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Lte(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Ep(t,e,r,n,i){if(!(this instanceof Ep))return new Ep(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Lte.call(this,n,i)}function ox(t,e,r,n,i){if(!(this instanceof ox))return new ox(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Lte.call(this,n,i)}function Cr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],o=[],l=1,c=16,u="S",h=null;ms(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,m={},g={internal:{},__private__:{}};g.__private__.PubSub=OU;var b="1.3",v=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(z){b=z};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var j=g.__private__.getPageFormat=function(z){return w[z]};i=i||"a4";var _="compat",E="advanced",I=_;function O(){this.saveGraphicsState(),ce(new It(At,0,0,-At,0,Ys()*At).toString()+" cm"),this.setFontSize(this.getFontSize()/At),u="n",I=E}function B(){this.restoreGraphicsState(),u="S",I=_}var S=g.__private__.combineFontStyleAndFontWeight=function(z,ue){if(z=="bold"&&ue=="normal"||z=="bold"&&ue==400||z=="normal"&&ue=="italic"||z=="bold"&&ue=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ue&&(z=ue==400||ue==="normal"?z==="italic"?"italic":"normal":ue!=700&&ue!=="bold"||z!=="normal"?(ue==700?"bold":ue)+""+z:"bold"),z};g.advancedAPI=function(z){var ue=I===_;return ue&&O.call(this),typeof z!="function"||(z(this),ue&&B.call(this)),this},g.compatAPI=function(z){var ue=I===E;return ue&&B.call(this),typeof z!="function"||(z(this),ue&&O.call(this)),this},g.isAdvancedAPI=function(){return I===E};var T,M=function(z){if(I!==E)throw new Error(z+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=g.roundToPrecision=g.__private__.roundToPrecision=function(z,ue){var _e=e||ue;if(isNaN(z)||isNaN(_e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return z.toFixed(_e).replace(/0+$/,"")};T=g.hpf=g.__private__.hpf=typeof c=="number"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,c)}:c==="smart"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,z>-1&&z<1?16:5)}:function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,16)};var k=g.f2=g.__private__.f2=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f2");return $(z,2)},L=g.__private__.f3=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f3");return $(z,3)},R=g.scale=g.__private__.scale=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.scale");return I===_?z*At:I===E?z:void 0},V=function(z){return R((function(ue){return I===_?Ys()-ue:I===E?ue:void 0})(z))};g.__private__.setPrecision=g.setPrecision=function(z){typeof parseInt(z,10)=="number"&&(e=parseInt(z,10))};var Y,X="00000000000000000000000000000000",J=g.__private__.getFileId=function(){return X},re=g.__private__.setFileId=function(z){return X=z!==void 0&&/^[a-fA-F0-9]{32}$/.test(z)?z.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Zn=new tx(h.userPermissions,h.userPassword,h.ownerPassword,X)),X};g.setFileId=function(z){return re(z),this},g.getFileId=function(){return J()};var se=g.__private__.convertDateToPDFDate=function(z){var ue=z.getTimezoneOffset(),_e=ue<0?"+":"-",Oe=Math.floor(Math.abs(ue/60)),ze=Math.abs(ue%60),bt=[_e,Z(Oe),"'",Z(ze),"'"].join("");return["D:",z.getFullYear(),Z(z.getMonth()+1),Z(z.getDate()),Z(z.getHours()),Z(z.getMinutes()),Z(z.getSeconds()),bt].join("")},ee=g.__private__.convertPDFDateToDate=function(z){var ue=parseInt(z.substr(2,4),10),_e=parseInt(z.substr(6,2),10)-1,Oe=parseInt(z.substr(8,2),10),ze=parseInt(z.substr(10,2),10),bt=parseInt(z.substr(12,2),10),Tt=parseInt(z.substr(14,2),10);return new Date(ue,_e,Oe,ze,bt,Tt,0)},q=g.__private__.setCreationDate=function(z){var ue;if(z===void 0&&(z=new Date),z instanceof Date)ue=se(z);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(z))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ue=z}return Y=ue},U=g.__private__.getCreationDate=function(z){var ue=Y;return z==="jsDate"&&(ue=ee(Y)),ue};g.setCreationDate=function(z){return q(z),this},g.getCreationDate=function(z){return U(z)};var W,Z=g.__private__.padd2=function(z){return("0"+parseInt(z)).slice(-2)},de=g.__private__.padd2Hex=function(z){return("00"+(z=z.toString())).substr(z.length)},be=0,oe=[],ne=[],H=0,le=[],ye=[],me=!1,ke=ne;g.__private__.setCustomOutputDestination=function(z){me=!0,ke=z};var Ie=function(z){me||(ke=z)};g.__private__.resetCustomOutputDestination=function(){me=!1,ke=ne};var ce=g.__private__.out=function(z){return z=z.toString(),H+=z.length+1,ke.push(z),ke},Be=g.__private__.write=function(z){return ce(arguments.length===1?z.toString():Array.prototype.join.call(arguments," "))},ct=g.__private__.getArrayBuffer=function(z){for(var ue=z.length,_e=new ArrayBuffer(ue),Oe=new Uint8Array(_e);ue--;)Oe[ue]=z.charCodeAt(ue);return _e},Ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Ve};var Ne=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(z){return Ne=I===E?z/At:z,this};var Ye,St=g.__private__.getFontSize=g.getFontSize=function(){return I===_?Ne:Ne*At},Vt=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(z){return Vt=z,this},g.__private__.getR2L=g.getR2L=function(){return Vt};var Lt,at=g.__private__.setZoomMode=function(z){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(z))Ye=z;else if(isNaN(z)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(z)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+z+'" is not recognized.');Ye=z}else Ye=parseInt(z,10)};g.__private__.getZoomMode=function(){return Ye};var gt,vt=g.__private__.setPageMode=function(z){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(z)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+z+'" is not recognized.');Lt=z};g.__private__.getPageMode=function(){return Lt};var ft=g.__private__.setLayoutMode=function(z){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(z)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+z+'" is not recognized.');gt=z};g.__private__.getLayoutMode=function(){return gt},g.__private__.setDisplayMode=g.setDisplayMode=function(z,ue,_e){return at(z),ft(ue),vt(_e),this};var ot={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(z){if(Object.keys(ot).indexOf(z)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ot[z]},g.__private__.getDocumentProperties=function(){return ot},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(z){for(var ue in ot)ot.hasOwnProperty(ue)&&z[ue]&&(ot[ue]=z[ue]);return this},g.__private__.setDocumentProperty=function(z,ue){if(Object.keys(ot).indexOf(z)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ot[z]=ue};var ut,At,Fe,Ut,jt,qe={},rt={},Ot=[],pt={},Jt={},Kt={},rr={},Br=null,zt=0,Wt=[],qt=new OU(g),ur=t.hotfixes||[],Re={},Nt={},Pt=[],It=function z(ue,_e,Oe,ze,bt,Tt){if(!(this instanceof z))return new z(ue,_e,Oe,ze,bt,Tt);isNaN(ue)&&(ue=1),isNaN(_e)&&(_e=0),isNaN(Oe)&&(Oe=0),isNaN(ze)&&(ze=1),isNaN(bt)&&(bt=0),isNaN(Tt)&&(Tt=0),this._matrix=[ue,_e,Oe,ze,bt,Tt]};Object.defineProperty(It.prototype,"sx",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(It.prototype,"shy",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(It.prototype,"shx",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(It.prototype,"sy",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(It.prototype,"tx",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(It.prototype,"ty",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(It.prototype,"a",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(It.prototype,"b",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(It.prototype,"c",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(It.prototype,"d",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(It.prototype,"e",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(It.prototype,"f",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(It.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(It.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(It.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(It.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),It.prototype.join=function(z){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(z)},It.prototype.multiply=function(z){var ue=z.sx*this.sx+z.shy*this.shx,_e=z.sx*this.shy+z.shy*this.sy,Oe=z.shx*this.sx+z.sy*this.shx,ze=z.shx*this.shy+z.sy*this.sy,bt=z.tx*this.sx+z.ty*this.shx+this.tx,Tt=z.tx*this.shy+z.ty*this.sy+this.ty;return new It(ue,_e,Oe,ze,bt,Tt)},It.prototype.decompose=function(){var z=this.sx,ue=this.shy,_e=this.shx,Oe=this.sy,ze=this.tx,bt=this.ty,Tt=Math.sqrt(z*z+ue*ue),or=(z/=Tt)*_e+(ue/=Tt)*Oe;_e-=z*or,Oe-=ue*or;var hr=Math.sqrt(_e*_e+Oe*Oe);return or/=hr,z*(Oe/=hr)<ue*(_e/=hr)&&(z=-z,ue=-ue,or=-or,Tt=-Tt),{scale:new It(Tt,0,0,hr,0,0),translate:new It(1,0,0,1,ze,bt),rotate:new It(z,ue,-ue,z,0,0),skew:new It(1,0,or,1,0,0)}},It.prototype.toString=function(z){return this.join(" ")},It.prototype.inversed=function(){var z=this.sx,ue=this.shy,_e=this.shx,Oe=this.sy,ze=this.tx,bt=this.ty,Tt=1/(z*Oe-ue*_e),or=Oe*Tt,hr=-ue*Tt,Ir=-_e*Tt,Sr=z*Tt;return new It(or,hr,Ir,Sr,-or*ze-Ir*bt,-hr*ze-Sr*bt)},It.prototype.applyToPoint=function(z){var ue=z.x*this.sx+z.y*this.shx+this.tx,_e=z.x*this.shy+z.y*this.sy+this.ty;return new er(ue,_e)},It.prototype.applyToRectangle=function(z){var ue=this.applyToPoint(z),_e=this.applyToPoint(new er(z.x+z.w,z.y+z.h));return new Hr(ue.x,ue.y,_e.x-ue.x,_e.y-ue.y)},It.prototype.clone=function(){var z=this.sx,ue=this.shy,_e=this.shx,Oe=this.sy,ze=this.tx,bt=this.ty;return new It(z,ue,_e,Oe,ze,bt)},g.Matrix=It;var Zt=g.matrixMult=function(z,ue){return ue.multiply(z)},Ae=new It(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Ae;var et=function(z,ue){if(!Jt[z]){var _e=(ue instanceof Ep?"Sh":"P")+(Object.keys(pt).length+1).toString(10);ue.id=_e,Jt[z]=_e,pt[_e]=ue,qt.publish("addPattern",ue)}};g.ShadingPattern=Ep,g.TilingPattern=ox,g.addShadingPattern=function(z,ue){return M("addShadingPattern()"),et(z,ue),this},g.beginTilingPattern=function(z){M("beginTilingPattern()"),Cn(z.boundingBox[0],z.boundingBox[1],z.boundingBox[2]-z.boundingBox[0],z.boundingBox[3]-z.boundingBox[1],z.matrix)},g.endTilingPattern=function(z,ue){M("endTilingPattern()"),ue.stream=ye[W].join(`
`),et(z,ue),qt.publish("endTilingPattern",ue),Pt.pop().restore()};var Rt,$t=g.__private__.newObject=function(){var z=Qt();return Ee(z,!0),z},Qt=g.__private__.newObjectDeferred=function(){return be++,oe[be]=function(){return H},be},Ee=function(z,ue){return ue=typeof ue=="boolean"&&ue,oe[z]=H,ue&&ce(z+" 0 obj"),z},Me=g.__private__.newAdditionalObject=function(){var z={objId:Qt(),content:""};return le.push(z),z},Je=Qt(),Ft=Qt(),tr=g.__private__.decodeColorString=function(z){var ue=z.split(" ");if(ue.length!==2||ue[1]!=="g"&&ue[1]!=="G")ue.length!==5||ue[4]!=="k"&&ue[4]!=="K"||(ue=[(1-ue[0])*(1-ue[3]),(1-ue[1])*(1-ue[3]),(1-ue[2])*(1-ue[3]),"r"]);else{var _e=parseFloat(ue[0]);ue=[_e,_e,_e,"r"]}for(var Oe="#",ze=0;ze<3;ze++)Oe+=("0"+Math.floor(255*parseFloat(ue[ze])).toString(16)).slice(-2);return Oe},Rr=g.__private__.encodeColorString=function(z){var ue;typeof z=="string"&&(z={ch1:z});var _e=z.ch1,Oe=z.ch2,ze=z.ch3,bt=z.ch4,Tt=z.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof _e=="string"&&_e.charAt(0)!=="#"){var or=new Tte(_e);if(or.ok)_e=or.toHex();else if(!/^\d*\.?\d*$/.test(_e))throw new Error('Invalid color "'+_e+'" passed to jsPDF.encodeColorString.')}if(typeof _e=="string"&&/^#[0-9A-Fa-f]{3}$/.test(_e)&&(_e="#"+_e[1]+_e[1]+_e[2]+_e[2]+_e[3]+_e[3]),typeof _e=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_e)){var hr=parseInt(_e.substr(1),16);_e=hr>>16&255,Oe=hr>>8&255,ze=255&hr}if(Oe===void 0||bt===void 0&&_e===Oe&&Oe===ze)ue=typeof _e=="string"?_e+" "+Tt[0]:z.precision===2?k(_e/255)+" "+Tt[0]:L(_e/255)+" "+Tt[0];else if(bt===void 0||ms(bt)==="object"){if(bt&&!isNaN(bt.a)&&bt.a===0)return["1.","1.","1.",Tt[1]].join(" ");ue=typeof _e=="string"?[_e,Oe,ze,Tt[1]].join(" "):z.precision===2?[k(_e/255),k(Oe/255),k(ze/255),Tt[1]].join(" "):[L(_e/255),L(Oe/255),L(ze/255),Tt[1]].join(" ")}else ue=typeof _e=="string"?[_e,Oe,ze,bt,Tt[2]].join(" "):z.precision===2?[k(_e),k(Oe),k(ze),k(bt),Tt[2]].join(" "):[L(_e),L(Oe),L(ze),L(bt),Tt[2]].join(" ");return ue},Kr=g.__private__.getFilters=function(){return o},$s=g.__private__.putStream=function(z){var ue=(z=z||{}).data||"",_e=z.filters||Kr(),Oe=z.alreadyAppliedFilters||[],ze=z.addLength1||!1,bt=ue.length,Tt=z.objectId,or=function(K){return K};if(h!==null&&Tt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(or=Zn.encryptor(Tt,0));var hr={};_e===!0&&(_e=["FlateEncode"]);var Ir=z.additionalKeyValues||[],Sr=(hr=Cr.API.processDataByFilters!==void 0?Cr.API.processDataByFilters(ue,_e):{data:ue,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(hr.data.length!==0&&(Ir.push({key:"Length",value:hr.data.length}),ze===!0&&Ir.push({key:"Length1",value:bt})),Sr.length!=0)if(Sr.split("/").length-1==1)Ir.push({key:"Filter",value:Sr});else{Ir.push({key:"Filter",value:"["+Sr+"]"});for(var pn=0;pn<Ir.length;pn+=1)if(Ir[pn].key==="DecodeParms"){for(var vs=[],is=0;is<hr.reverseChain.split("/").length-1;is+=1)vs.push("null");vs.push(Ir[pn].value),Ir[pn].value="["+vs.join(" ")+"]"}}ce("<<");for(var A=0;A<Ir.length;A++)ce("/"+Ir[A].key+" "+Ir[A].value);ce(">>"),hr.data.length!==0&&(ce("stream"),ce(or(hr.data)),ce("endstream"))},Ki=g.__private__.putPage=function(z){var ue=z.number,_e=z.data,Oe=z.objId,ze=z.contentsObjId;Ee(Oe,!0),ce("<</Type /Page"),ce("/Parent "+z.rootDictionaryObjId+" 0 R"),ce("/Resources "+z.resourceDictionaryObjId+" 0 R"),ce("/MediaBox ["+parseFloat(T(z.mediaBox.bottomLeftX))+" "+parseFloat(T(z.mediaBox.bottomLeftY))+" "+T(z.mediaBox.topRightX)+" "+T(z.mediaBox.topRightY)+"]"),z.cropBox!==null&&ce("/CropBox ["+T(z.cropBox.bottomLeftX)+" "+T(z.cropBox.bottomLeftY)+" "+T(z.cropBox.topRightX)+" "+T(z.cropBox.topRightY)+"]"),z.bleedBox!==null&&ce("/BleedBox ["+T(z.bleedBox.bottomLeftX)+" "+T(z.bleedBox.bottomLeftY)+" "+T(z.bleedBox.topRightX)+" "+T(z.bleedBox.topRightY)+"]"),z.trimBox!==null&&ce("/TrimBox ["+T(z.trimBox.bottomLeftX)+" "+T(z.trimBox.bottomLeftY)+" "+T(z.trimBox.topRightX)+" "+T(z.trimBox.topRightY)+"]"),z.artBox!==null&&ce("/ArtBox ["+T(z.artBox.bottomLeftX)+" "+T(z.artBox.bottomLeftY)+" "+T(z.artBox.topRightX)+" "+T(z.artBox.topRightY)+"]"),typeof z.userUnit=="number"&&z.userUnit!==1&&ce("/UserUnit "+z.userUnit),qt.publish("putPage",{objId:Oe,pageContext:Wt[ue],pageNumber:ue,page:_e}),ce("/Contents "+ze+" 0 R"),ce(">>"),ce("endobj");var bt=_e.join(`
`);return I===E&&(bt+=`
Q`),Ee(ze,!0),$s({data:bt,filters:Kr(),objectId:ze}),ce("endobj"),Oe},Ws=g.__private__.putPages=function(){var z,ue,_e=[];for(z=1;z<=zt;z++)Wt[z].objId=Qt(),Wt[z].contentsObjId=Qt();for(z=1;z<=zt;z++)_e.push(Ki({number:z,data:ye[z],objId:Wt[z].objId,contentsObjId:Wt[z].contentsObjId,mediaBox:Wt[z].mediaBox,cropBox:Wt[z].cropBox,bleedBox:Wt[z].bleedBox,trimBox:Wt[z].trimBox,artBox:Wt[z].artBox,userUnit:Wt[z].userUnit,rootDictionaryObjId:Je,resourceDictionaryObjId:Ft}));Ee(Je,!0),ce("<</Type /Pages");var Oe="/Kids [";for(ue=0;ue<zt;ue++)Oe+=_e[ue]+" 0 R ";ce(Oe+"]"),ce("/Count "+zt),ce(">>"),ce("endobj"),qt.publish("postPutPages")},Ts=function(z){qt.publish("putFont",{font:z,out:ce,newObject:$t,putStream:$s}),z.isAlreadyPutted!==!0&&(z.objectNumber=$t(),ce("<<"),ce("/Type /Font"),ce("/BaseFont /"+rx(z.postScriptName)),ce("/Subtype /Type1"),typeof z.encoding=="string"&&ce("/Encoding /"+z.encoding),ce("/FirstChar 32"),ce("/LastChar 255"),ce(">>"),ce("endobj"))},wa=function(z){z.objectNumber=$t();var ue=[];ue.push({key:"Type",value:"/XObject"}),ue.push({key:"Subtype",value:"/Form"}),ue.push({key:"BBox",value:"["+[T(z.x),T(z.y),T(z.x+z.width),T(z.y+z.height)].join(" ")+"]"}),ue.push({key:"Matrix",value:"["+z.matrix.toString()+"]"});var _e=z.pages[1].join(`
`);$s({data:_e,additionalKeyValues:ue,objectId:z.objectNumber}),ce("endobj")},Hn=function(z,ue){ue||(ue=21);var _e=$t(),Oe=(function(Tt,or){var hr,Ir=[],Sr=1/(or-1);for(hr=0;hr<1;hr+=Sr)Ir.push(hr);if(Ir.push(1),Tt[0].offset!=0){var pn={offset:0,color:Tt[0].color};Tt.unshift(pn)}if(Tt[Tt.length-1].offset!=1){var vs={offset:1,color:Tt[Tt.length-1].color};Tt.push(vs)}for(var is="",A=0,K=0;K<Ir.length;K++){for(hr=Ir[K];hr>Tt[A+1].offset;)A++;var ae=Tt[A].offset,we=(hr-ae)/(Tt[A+1].offset-ae),We=Tt[A].color,nt=Tt[A+1].color;is+=de(Math.round((1-we)*We[0]+we*nt[0]).toString(16))+de(Math.round((1-we)*We[1]+we*nt[1]).toString(16))+de(Math.round((1-we)*We[2]+we*nt[2]).toString(16))}return is.trim()})(z.colors,ue),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+ue+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),$s({data:Oe,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:_e}),ce("endobj"),z.objectNumber=$t(),ce("<< /ShadingType "+z.type),ce("/ColorSpace /DeviceRGB");var bt="/Coords ["+T(parseFloat(z.coords[0]))+" "+T(parseFloat(z.coords[1]))+" ";z.type===2?bt+=T(parseFloat(z.coords[2]))+" "+T(parseFloat(z.coords[3])):bt+=T(parseFloat(z.coords[2]))+" "+T(parseFloat(z.coords[3]))+" "+T(parseFloat(z.coords[4]))+" "+T(parseFloat(z.coords[5])),ce(bt+="]"),z.matrix&&ce("/Matrix ["+z.matrix.toString()+"]"),ce("/Function "+_e+" 0 R"),ce("/Extend [true true]"),ce(">>"),ce("endobj")},wi=function(z,ue){var _e=Qt(),Oe=$t();ue.push({resourcesOid:_e,objectOid:Oe}),z.objectNumber=Oe;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+z.boundingBox.map(T).join(" ")+"]"}),ze.push({key:"XStep",value:T(z.xStep)}),ze.push({key:"YStep",value:T(z.yStep)}),ze.push({key:"Resources",value:_e+" 0 R"}),z.matrix&&ze.push({key:"Matrix",value:"["+z.matrix.toString()+"]"}),$s({data:z.stream,additionalKeyValues:ze,objectId:z.objectNumber}),ce("endobj")},Yi=function(z){for(var ue in z.objectNumber=$t(),ce("<<"),z)switch(ue){case"opacity":ce("/ca "+k(z[ue]));break;case"stroke-opacity":ce("/CA "+k(z[ue]))}ce(">>"),ce("endobj")},aa=function(z){Ee(z.resourcesOid,!0),ce("<<"),ce("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ue in ce("/Font <<"),qe)qe.hasOwnProperty(ue)&&(p===!1||p===!0&&m.hasOwnProperty(ue))&&ce("/"+ue+" "+qe[ue].objectNumber+" 0 R");ce(">>")})(),(function(){if(Object.keys(pt).length>0){for(var ue in ce("/Shading <<"),pt)pt.hasOwnProperty(ue)&&pt[ue]instanceof Ep&&pt[ue].objectNumber>=0&&ce("/"+ue+" "+pt[ue].objectNumber+" 0 R");qt.publish("putShadingPatternDict"),ce(">>")}})(),(function(ue){if(Object.keys(pt).length>0){for(var _e in ce("/Pattern <<"),pt)pt.hasOwnProperty(_e)&&pt[_e]instanceof g.TilingPattern&&pt[_e].objectNumber>=0&&pt[_e].objectNumber<ue&&ce("/"+_e+" "+pt[_e].objectNumber+" 0 R");qt.publish("putTilingPatternDict"),ce(">>")}})(z.objectOid),(function(){if(Object.keys(Kt).length>0){var ue;for(ue in ce("/ExtGState <<"),Kt)Kt.hasOwnProperty(ue)&&Kt[ue].objectNumber>=0&&ce("/"+ue+" "+Kt[ue].objectNumber+" 0 R");qt.publish("putGStateDict"),ce(">>")}})(),(function(){for(var ue in ce("/XObject <<"),Re)Re.hasOwnProperty(ue)&&Re[ue].objectNumber>=0&&ce("/"+ue+" "+Re[ue].objectNumber+" 0 R");qt.publish("putXobjectDict"),ce(">>")})(),ce(">>"),ce("endobj")},os=function(z){rt[z.fontName]=rt[z.fontName]||{},rt[z.fontName][z.fontStyle]=z.id},kl=function(z,ue,_e,Oe,ze){var bt={id:"F"+(Object.keys(qe).length+1).toString(10),postScriptName:z,fontName:ue,fontStyle:_e,encoding:Oe,isStandardFont:ze||!1,metadata:{}};return qt.publish("addFont",{font:bt,instance:this}),qe[bt.id]=bt,os(bt),bt.id},Gs=g.__private__.pdfEscape=g.pdfEscape=function(z,ue){return(function(_e,Oe){var ze,bt,Tt,or,hr,Ir,Sr,pn,vs;if(Tt=(Oe=Oe||{}).sourceEncoding||"Unicode",hr=Oe.outputEncoding,(Oe.autoencode||hr)&&qe[ut].metadata&&qe[ut].metadata[Tt]&&qe[ut].metadata[Tt].encoding&&(or=qe[ut].metadata[Tt].encoding,!hr&&qe[ut].encoding&&(hr=qe[ut].encoding),!hr&&or.codePages&&(hr=or.codePages[0]),typeof hr=="string"&&(hr=or[hr]),hr)){for(Sr=!1,Ir=[],ze=0,bt=_e.length;ze<bt;ze++)(pn=hr[_e.charCodeAt(ze)])?Ir.push(String.fromCharCode(pn)):Ir.push(_e[ze]),Ir[ze].charCodeAt(0)>>8&&(Sr=!0);_e=Ir.join("")}for(ze=_e.length;Sr===void 0&&ze!==0;)_e.charCodeAt(ze-1)>>8&&(Sr=!0),ze--;if(!Sr)return _e;for(Ir=Oe.noBOM?[]:[254,255],ze=0,bt=_e.length;ze<bt;ze++){if((vs=(pn=_e.charCodeAt(ze))>>8)>>8)throw new Error("Character at position "+ze+" of string '"+_e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ir.push(vs),Ir.push(pn-(vs<<8))}return String.fromCharCode.apply(void 0,Ir)})(z,ue).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xi=g.__private__.beginPage=function(z){ye[++zt]=[],Wt[zt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(z[0]),topRightY:Number(z[1])}},Bo(zt),Ie(ye[W])},Li=function(z,ue){var _e,Oe,ze;switch(r=ue||r,typeof z=="string"&&(_e=j(z.toLowerCase()),Array.isArray(_e)&&(Oe=_e[0],ze=_e[1])),Array.isArray(z)&&(Oe=z[0]*At,ze=z[1]*At),isNaN(Oe)&&(Oe=i[0],ze=i[1]),(Oe>14400||ze>14400)&&(Rs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),ze=Math.min(14400,ze)),i=[Oe,ze],r.substr(0,1)){case"l":ze>Oe&&(i=[ze,Oe]);break;case"p":Oe>ze&&(i=[ze,Oe])}Xi(i),mr(ji),ce(Mi),Te!==0&&ce(Te+" J"),dt!==0&&ce(dt+" j"),qt.publish("addPage",{pageNumber:zt})},Pi=function(z){z>0&&z<=zt&&(ye.splice(z,1),Wt.splice(z,1),zt--,W>zt&&(W=zt),this.setPage(W))},Bo=function(z){z>0&&z<=zt&&(W=z)},_l=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return ye.length-1},tc=function(z,ue,_e){var Oe,ze=void 0;return _e=_e||{},z=z!==void 0?z:qe[ut].fontName,ue=ue!==void 0?ue:qe[ut].fontStyle,Oe=z.toLowerCase(),rt[Oe]!==void 0&&rt[Oe][ue]!==void 0?ze=rt[Oe][ue]:rt[z]!==void 0&&rt[z][ue]!==void 0?ze=rt[z][ue]:_e.disableWarning===!1&&Rs.warn("Unable to look up font label for font '"+z+"', '"+ue+"'. Refer to getFontList() for available fonts."),ze||_e.noFallback||(ze=rt.times[ue])==null&&(ze=rt.times.normal),ze},Qi=g.__private__.putInfo=function(){var z=$t(),ue=function(Oe){return Oe};for(var _e in h!==null&&(ue=Zn.encryptor(z,0)),ce("<<"),ce("/Producer ("+Gs(ue("jsPDF "+Cr.version))+")"),ot)ot.hasOwnProperty(_e)&&ot[_e]&&ce("/"+_e.substr(0,1).toUpperCase()+_e.substr(1)+" ("+Gs(ue(ot[_e]))+")");ce("/CreationDate ("+Gs(ue(Y))+")"),ce(">>"),ce("endobj")},oi=g.__private__.putCatalog=function(z){var ue=(z=z||{}).rootDictionaryObjId||Je;switch($t(),ce("<<"),ce("/Type /Catalog"),ce("/Pages "+ue+" 0 R"),Ye||(Ye="fullwidth"),Ye){case"fullwidth":ce("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ce("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ce("/OpenAction [3 0 R /Fit]");break;case"original":ce("/OpenAction [3 0 R /XYZ null null 1]");break;default:var _e=""+Ye;_e.substr(_e.length-1)==="%"&&(Ye=parseInt(Ye)/100),typeof Ye=="number"&&ce("/OpenAction [3 0 R /XYZ null null "+k(Ye)+"]")}switch(gt||(gt="continuous"),gt){case"continuous":ce("/PageLayout /OneColumn");break;case"single":ce("/PageLayout /SinglePage");break;case"two":case"twoleft":ce("/PageLayout /TwoColumnLeft");break;case"tworight":ce("/PageLayout /TwoColumnRight")}Lt&&ce("/PageMode /"+Lt),qt.publish("putCatalog"),ce(">>"),ce("endobj")},xs=g.__private__.putTrailer=function(){ce("trailer"),ce("<<"),ce("/Size "+(be+1)),ce("/Root "+be+" 0 R"),ce("/Info "+(be-1)+" 0 R"),h!==null&&ce("/Encrypt "+Zn.oid+" 0 R"),ce("/ID [ <"+X+"> <"+X+"> ]"),ce(">>")},Yr=g.__private__.putHeader=function(){ce("%PDF-"+b),ce("%")},Na=g.__private__.putXRef=function(){var z="0000000000";ce("xref"),ce("0 "+(be+1)),ce("0000000000 65535 f ");for(var ue=1;ue<=be;ue++)typeof oe[ue]=="function"?ce((z+oe[ue]()).slice(-10)+" 00000 n "):oe[ue]!==void 0?ce((z+oe[ue]).slice(-10)+" 00000 n "):ce("0000000000 00000 n ")},li=g.__private__.buildDocument=function(){var z;be=0,H=0,ne=[],oe=[],le=[],Je=Qt(),Ft=Qt(),Ie(ne),qt.publish("buildDocument"),Yr(),Ws(),(function(){qt.publish("putAdditionalObjects");for(var _e=0;_e<le.length;_e++){var Oe=le[_e];Ee(Oe.objId,!0),ce(Oe.content),ce("endobj")}qt.publish("postPutAdditionalObjects")})(),z=[],(function(){for(var _e in qe)qe.hasOwnProperty(_e)&&(p===!1||p===!0&&m.hasOwnProperty(_e))&&Ts(qe[_e])})(),(function(){var _e;for(_e in Kt)Kt.hasOwnProperty(_e)&&Yi(Kt[_e])})(),(function(){for(var _e in Re)Re.hasOwnProperty(_e)&&wa(Re[_e])})(),(function(_e){var Oe;for(Oe in pt)pt.hasOwnProperty(Oe)&&(pt[Oe]instanceof Ep?Hn(pt[Oe]):pt[Oe]instanceof ox&&wi(pt[Oe],_e))})(z),qt.publish("putResources"),z.forEach(aa),aa({resourcesOid:Ft,objectOid:Number.MAX_SAFE_INTEGER}),qt.publish("postPutResources"),h!==null&&(Zn.oid=$t(),ce("<<"),ce("/Filter /Standard"),ce("/V "+Zn.v),ce("/R "+Zn.r),ce("/U <"+Zn.toHexString(Zn.U)+">"),ce("/O <"+Zn.toHexString(Zn.O)+">"),ce("/P "+Zn.P),ce(">>"),ce("endobj")),Qi(),oi();var ue=H;return Na(),xs(),ce("startxref"),ce(""+ue),ce("%%EOF"),Ie(ye[W]),ne.join(`
`)},an=g.__private__.getBlob=function(z){return new Blob([ct(z)],{type:"application/pdf"})},ho=g.output=g.__private__.output=(Rt=function(z,ue){switch(typeof(ue=ue||{})=="string"?ue={filename:ue}:ue.filename=ue.filename||"generated.pdf",z){case void 0:return li();case"save":g.save(ue.filename);break;case"arraybuffer":return ct(li());case"blob":return an(li());case"bloburi":case"bloburl":if(Gr.URL!==void 0&&typeof Gr.URL.createObjectURL=="function")return Gr.URL&&Gr.URL.createObjectURL(an(li()))||void 0;Rs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var _e="",Oe=li();try{_e=IU(Oe)}catch{_e=IU(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+ue.filename+";base64,"+_e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Gr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ue.pdfObjectUrl&&(ze=ue.pdfObjectUrl,bt="");var Tt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ue)+");<\/script></body></html>",or=Gr.open();return or!==null&&or.document.write(Tt),or}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Gr)==="[object Window]"){var hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ue.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ue.filename+'" width="500px" height="400px" /></body></html>',Ir=Gr.open();if(Ir!==null){Ir.document.write(hr);var Sr=this;Ir.document.documentElement.querySelector("#pdfViewer").onload=function(){Ir.document.title=ue.filename,Ir.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Sr.output("bloburl"))}}return Ir}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Gr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var pn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ue)+'"></iframe></body></html>',vs=Gr.open();if(vs!==null&&(vs.document.write(pn),vs.document.title=ue.filename),vs||typeof safari>"u")return vs;break;case"datauri":case"dataurl":return Gr.document.location.href=this.output("datauristring",ue);default:return null}},Rt.foo=function(){try{return Rt.apply(this,arguments)}catch(_e){var z=_e.stack||"";~z.indexOf(" at ")&&(z=z.split(" at ")[1]);var ue="Error in function "+z.split(`
`)[0].split("<")[0]+": "+_e.message;if(!Gr.console)throw new Error(ue);Gr.console.error(ue,_e),Gr.alert&&alert(ue)}},Rt.foo.bar=Rt,Rt.foo),Is=function(z){return Array.isArray(ur)===!0&&ur.indexOf(z)>-1};switch(n){case"pt":At=1;break;case"mm":At=72/25.4;break;case"cm":At=72/2.54;break;case"in":At=72;break;case"px":At=Is("px_scaling")==1?.75:96/72;break;case"pc":case"em":At=12;break;case"ex":At=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);At=n}var Zn=null;q(),re();var bs=g.__private__.getPageInfo=g.getPageInfo=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wt[z].objId,pageNumber:z,pageContext:Wt[z]}},tl=g.__private__.getPageInfoByObjId=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ue in Wt)if(Wt[ue].objId===z)break;return bs(ue)},Sl=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Wt[W].objId,pageNumber:W,pageContext:Wt[W]}};g.addPage=function(){return Li.apply(this,arguments),this},g.setPage=function(){return Bo.apply(this,arguments),Ie.call(this,ye[W]),this},g.insertPage=function(z){return this.addPage(),this.movePage(W,z),this},g.movePage=function(z,ue){var _e,Oe;if(z>ue){_e=ye[z],Oe=Wt[z];for(var ze=z;ze>ue;ze--)ye[ze]=ye[ze-1],Wt[ze]=Wt[ze-1];ye[ue]=_e,Wt[ue]=Oe,this.setPage(ue)}else if(z<ue){_e=ye[z],Oe=Wt[z];for(var bt=z;bt<ue;bt++)ye[bt]=ye[bt+1],Wt[bt]=Wt[bt+1];ye[ue]=_e,Wt[ue]=Oe,this.setPage(ue)}return this},g.deletePage=function(){return Pi.apply(this,arguments),this},g.__private__.text=g.text=function(z,ue,_e,Oe,ze){var bt,Tt,or,hr,Ir,Sr,pn,vs,is,A=(Oe=Oe||{}).scope||this;if(typeof z=="number"&&typeof ue=="number"&&(typeof _e=="string"||Array.isArray(_e))){var K=_e;_e=ue,ue=z,z=K}if(arguments[3]instanceof It==0?(or=arguments[4],hr=arguments[5],ms(pn=arguments[3])==="object"&&pn!==null||(typeof or=="string"&&(hr=or,or=null),typeof pn=="string"&&(hr=pn,pn=null),typeof pn=="number"&&(or=pn,pn=null),Oe={flags:pn,angle:or,align:hr})):(M("The transform parameter of text() with a Matrix value"),is=ze),isNaN(ue)||isNaN(_e)||z==null)throw new Error("Invalid arguments passed to jsPDF.text");if(z.length===0)return A;var ae,we="",We=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:ls,nt=A.internal.scaleFactor;function Ht(zn){return zn=zn.split("	").join(Array(Oe.TabLen||9).join(" ")),Gs(zn,pn)}function Vr(zn){for(var En,Ns=zn.concat(),_i=[],Mc=Ns.length;Mc--;)typeof(En=Ns.shift())=="string"?_i.push(En):Array.isArray(zn)&&(En.length===1||En[1]===void 0&&En[2]===void 0)?_i.push(En[0]):_i.push([En[0],En[1],En[2]]);return _i}function ws(zn,En){var Ns;if(typeof zn=="string")Ns=En(zn)[0];else if(Array.isArray(zn)){for(var _i,Mc,oc=zn.concat(),rh=[],J0=oc.length;J0--;)typeof(_i=oc.shift())=="string"?rh.push(En(_i)[0]):Array.isArray(_i)&&typeof _i[0]=="string"&&(Mc=En(_i[0],_i[1],_i[2]),rh.push([Mc[0],Mc[1],Mc[2]]));Ns=rh}return Ns}var un=!1,Gn=!0;if(typeof z=="string")un=!0;else if(Array.isArray(z)){var ca=z.concat();Tt=[];for(var ka,cs=ca.length;cs--;)(typeof(ka=ca.shift())!="string"||Array.isArray(ka)&&typeof ka[0]!="string")&&(Gn=!1);un=Gn}if(un===!1)throw new Error('Type of text must be string or Array. "'+z+'" is not recognized.');typeof z=="string"&&(z=z.match(/[\r?\n]/)?z.split(/\r\n|\r|\n/g):[z]);var _a=Ne/A.internal.scaleFactor,rl=_a*(We-1);switch(Oe.baseline){case"bottom":_e-=rl;break;case"top":_e+=_a-rl;break;case"hanging":_e+=_a-2*rl;break;case"middle":_e+=_a/2-rl}if((Sr=Oe.maxWidth||0)>0&&(typeof z=="string"?z=A.splitTextToSize(z,Sr):Object.prototype.toString.call(z)==="[object Array]"&&(z=z.reduce(function(zn,En){return zn.concat(A.splitTextToSize(En,Sr))},[]))),bt={text:z,x:ue,y:_e,options:Oe,mutex:{pdfEscape:Gs,activeFontKey:ut,fonts:qe,activeFontSize:Ne}},qt.publish("preProcessText",bt),z=bt.text,or=(Oe=bt.options).angle,is instanceof It==0&&or&&typeof or=="number"){or*=Math.PI/180,Oe.rotationDirection===0&&(or=-or),I===E&&(or=-or);var Ac=Math.cos(or),Tc=Math.sin(or);is=new It(Ac,Tc,-Tc,Ac,0,0)}else or&&or instanceof It&&(is=or);I!==E||is||(is=Ae),(Ir=Oe.charSpace||Q)!==void 0&&(we+=T(R(Ir))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(vs=Oe.horizontalScale)!==void 0&&(we+=T(100*vs)+` Tz
`),Oe.lang;var yo=-1,cu=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,Nf=A.internal.getCurrentPageInfo().pageContext;switch(cu){case 0:case!1:case"fill":yo=0;break;case 1:case!0:case"stroke":yo=1;break;case 2:case"fillThenStroke":yo=2;break;case 3:case"invisible":yo=3;break;case 4:case"fillAndAddForClipping":yo=4;break;case 5:case"strokeAndAddPathForClipping":yo=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":yo=6;break;case 7:case"addToPathForClipping":yo=7}var X0=Nf.usedRenderingMode!==void 0?Nf.usedRenderingMode:-1;yo!==-1?we+=yo+` Tr
`:X0!==-1&&(we+=`0 Tr
`),yo!==-1&&(Nf.usedRenderingMode=yo),hr=Oe.align||"left";var nl,ic=Ne*We,uu=A.internal.pageSize.getWidth(),Q0=qe[ut];Ir=Oe.charSpace||Q,Sr=Oe.maxWidth||0,pn=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var ac=[],nd=function(zn){return A.getStringUnitWidth(zn,{font:Q0,charSpace:Ir,fontSize:Ne,doKerning:!1})*Ne/nt};if(Object.prototype.toString.call(z)==="[object Array]"){var Uo;Tt=Vr(z),hr!=="left"&&(nl=Tt.map(nd));var vo,Ic=0;if(hr==="right"){ue-=nl[0],z=[],cs=Tt.length;for(var Lc=0;Lc<cs;Lc++)Lc===0?(vo=Fs(ue),Uo=ys(_e)):(vo=R(Ic-nl[Lc]),Uo=-ic),z.push([Tt[Lc],vo,Uo]),Ic=nl[Lc]}else if(hr==="center"){ue-=nl[0]/2,z=[],cs=Tt.length;for(var du=0;du<cs;du++)du===0?(vo=Fs(ue),Uo=ys(_e)):(vo=R((Ic-nl[du])/2),Uo=-ic),z.push([Tt[du],vo,Uo]),Ic=nl[du]}else if(hr==="left"){z=[],cs=Tt.length;for(var jf=0;jf<cs;jf++)z.push(Tt[jf])}else if(hr==="justify"&&Q0.encoding==="Identity-H"){z=[],cs=Tt.length,Sr=Sr!==0?Sr:uu;for(var kf=0,ki=0;ki<cs;ki++)if(Uo=ki===0?ys(_e):-ic,vo=ki===0?Fs(ue):kf,ki<cs-1){var Xm=R((Sr-nl[ki])/(Tt[ki].split(" ").length-1)),Pc=Tt[ki].split(" ");z.push([Pc[0]+" ",vo,Uo]),kf=0;for(var Oc=1;Oc<Pc.length;Oc++){var Sa=(nd(Pc[Oc-1]+" "+Pc[Oc])-nd(Pc[Oc]))*nt+Xm;Oc==Pc.length-1?z.push([Pc[Oc],Sa,0]):z.push([Pc[Oc]+" ",Sa,0]),kf-=Sa}}else z.push([Tt[ki],vo,Uo]);z.push(["",kf,0])}else{if(hr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(z=[],cs=Tt.length,Sr=Sr!==0?Sr:uu,ki=0;ki<cs;ki++){Uo=ki===0?ys(_e):-ic,vo=ki===0?Fs(ue):0;var hu=Tt[ki].split(" ").length-1,_f=hu>0?(Sr-nl[ki])/hu:0;ki<cs-1?ac.push(T(R(_f))):ac.push(0),z.push([Tt[ki],vo,Uo])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:Vt)===!0&&(z=ws(z,function(zn,En,Ns){return[zn.split("").reverse().join(""),En,Ns]})),bt={text:z,x:ue,y:_e,options:Oe,mutex:{pdfEscape:Gs,activeFontKey:ut,fonts:qe,activeFontSize:Ne}},qt.publish("postProcessText",bt),z=bt.text,ae=bt.mutex.isHex||!1;var Sf=qe[ut].encoding;Sf!=="WinAnsiEncoding"&&Sf!=="StandardEncoding"||(z=ws(z,function(zn,En,Ns){return[Ht(zn),En,Ns]})),Tt=Vr(z),z=[];for(var fu,pu,Rc,th=Array.isArray(Tt[0])?1:0,sl="",mu=function(zn,En,Ns){var _i="";return Ns instanceof It?(Ns=typeof Oe.angle=="number"?Zt(Ns,new It(1,0,0,1,zn,En)):Zt(new It(1,0,0,1,zn,En),Ns),I===E&&(Ns=Zt(new It(1,0,0,-1,0,0),Ns)),_i=Ns.join(" ")+` Tm
`):_i=T(zn)+" "+T(En)+` Td
`,_i},Ka=0;Ka<Tt.length;Ka++){switch(sl="",th){case 1:Rc=(ae?"<":"(")+Tt[Ka][0]+(ae?">":")"),fu=parseFloat(Tt[Ka][1]),pu=parseFloat(Tt[Ka][2]);break;case 0:Rc=(ae?"<":"(")+Tt[Ka]+(ae?">":")"),fu=Fs(ue),pu=ys(_e)}ac!==void 0&&ac[Ka]!==void 0&&(sl=ac[Ka]+` Tw
`),Ka===0?z.push(sl+mu(fu,pu,is)+Rc):th===0?z.push(sl+Rc):th===1&&z.push(sl+mu(fu,pu,is)+Rc)}z=th===0?z.join(` Tj
T* `):z.join(` Tj
`),z+=` Tj
`;var Al=`BT
/`;return Al+=ut+" "+Ne+` Tf
`,Al+=T(Ne*We)+` TL
`,Al+=ja+`
`,Al+=we,Al+=z,ce(Al+="ET"),m[ut]=!0,A};var rc=g.__private__.clip=g.clip=function(z){return ce(z==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return rc("evenodd")},g.__private__.discardPath=g.discardPath=function(){return ce("n"),this};var Ni=g.__private__.isValidStyle=function(z){var ue=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(z)!==-1&&(ue=!0),ue};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(z){return Ni(z)&&(u=z),this};var fo=g.__private__.getStyle=g.getStyle=function(z){var ue=u;switch(z){case"D":case"S":ue="S";break;case"F":ue="f";break;case"FD":case"DF":ue="B";break;case"f":case"f*":case"B":case"B*":ue=z}return ue},Ks=g.close=function(){return ce("h"),this};g.stroke=function(){return ce("S"),this},g.fill=function(z){return es("f",z),this},g.fillEvenOdd=function(z){return es("f*",z),this},g.fillStroke=function(z){return es("B",z),this},g.fillStrokeEvenOdd=function(z){return es("B*",z),this};var es=function(z,ue){ms(ue)==="object"?oa(ue,z):ce(z)},Oi=function(z){z===null||I===E&&z===void 0||(z=fo(z),ce(z))};function nc(z,ue,_e,Oe,ze){var bt=new ox(ue||this.boundingBox,_e||this.xStep,Oe||this.yStep,this.gState,ze||this.matrix);bt.stream=this.stream;var Tt=z+"$$"+this.cloneIndex+++"$$";return et(Tt,bt),bt}var oa=function(z,ue){var _e=Jt[z.key],Oe=pt[_e];if(Oe instanceof Ep)ce("q"),ce(Cl(ue)),Oe.gState&&g.setGState(Oe.gState),ce(z.matrix.toString()+" cm"),ce("/"+_e+" sh"),ce("Q");else if(Oe instanceof ox){var ze=new It(1,0,0,-1,0,Ys());z.matrix&&(ze=ze.multiply(z.matrix||Ae),_e=nc.call(Oe,z.key,z.boundingBox,z.xStep,z.yStep,ze).id),ce("q"),ce("/Pattern cs"),ce("/"+_e+" scn"),Oe.gState&&g.setGState(Oe.gState),ce(ue),ce("Q")}},Cl=function(z){switch(z){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},El=g.moveTo=function(z,ue){return ce(T(R(z))+" "+T(V(ue))+" m"),this},po=g.lineTo=function(z,ue){return ce(T(R(z))+" "+T(V(ue))+" l"),this},Ri=g.curveTo=function(z,ue,_e,Oe,ze,bt){return ce([T(R(z)),T(V(ue)),T(R(_e)),T(V(Oe)),T(R(ze)),T(V(bt)),"c"].join(" ")),this};g.__private__.line=g.line=function(z,ue,_e,Oe,ze){if(isNaN(z)||isNaN(ue)||isNaN(_e)||isNaN(Oe)||!Ni(ze))throw new Error("Invalid arguments passed to jsPDF.line");return I===_?this.lines([[_e-z,Oe-ue]],z,ue,[1,1],ze||"S"):this.lines([[_e-z,Oe-ue]],z,ue,[1,1]).stroke()},g.__private__.lines=g.lines=function(z,ue,_e,Oe,ze,bt){var Tt,or,hr,Ir,Sr,pn,vs,is,A,K,ae,we;if(typeof z=="number"&&(we=_e,_e=ue,ue=z,z=we),Oe=Oe||[1,1],bt=bt||!1,isNaN(ue)||isNaN(_e)||!Array.isArray(z)||!Array.isArray(Oe)||!Ni(ze)||typeof bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(El(ue,_e),Tt=Oe[0],or=Oe[1],Ir=z.length,K=ue,ae=_e,hr=0;hr<Ir;hr++)(Sr=z[hr]).length===2?(K=Sr[0]*Tt+K,ae=Sr[1]*or+ae,po(K,ae)):(pn=Sr[0]*Tt+K,vs=Sr[1]*or+ae,is=Sr[2]*Tt+K,A=Sr[3]*or+ae,K=Sr[4]*Tt+K,ae=Sr[5]*or+ae,Ri(pn,vs,is,A,K,ae));return bt&&Ks(),Oi(ze),this},g.path=function(z){for(var ue=0;ue<z.length;ue++){var _e=z[ue],Oe=_e.c;switch(_e.op){case"m":El(Oe[0],Oe[1]);break;case"l":po(Oe[0],Oe[1]);break;case"c":Ri.apply(this,Oe);break;case"h":Ks()}}return this},g.__private__.rect=g.rect=function(z,ue,_e,Oe,ze){if(isNaN(z)||isNaN(ue)||isNaN(_e)||isNaN(Oe)||!Ni(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return I===_&&(Oe=-Oe),ce([T(R(z)),T(V(ue)),T(R(_e)),T(R(Oe)),"re"].join(" ")),Oi(ze),this},g.__private__.triangle=g.triangle=function(z,ue,_e,Oe,ze,bt,Tt){if(isNaN(z)||isNaN(ue)||isNaN(_e)||isNaN(Oe)||isNaN(ze)||isNaN(bt)||!Ni(Tt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[_e-z,Oe-ue],[ze-_e,bt-Oe],[z-ze,ue-bt]],z,ue,[1,1],Tt,!0),this},g.__private__.roundedRect=g.roundedRect=function(z,ue,_e,Oe,ze,bt,Tt){if(isNaN(z)||isNaN(ue)||isNaN(_e)||isNaN(Oe)||isNaN(ze)||isNaN(bt)||!Ni(Tt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var or=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*_e),bt=Math.min(bt,.5*Oe),this.lines([[_e-2*ze,0],[ze*or,0,ze,bt-bt*or,ze,bt],[0,Oe-2*bt],[0,bt*or,-ze*or,bt,-ze,bt],[2*ze-_e,0],[-ze*or,0,-ze,-bt*or,-ze,-bt],[0,2*bt-Oe],[0,-bt*or,ze*or,-bt,ze,-bt]],z+ze,ue,[1,1],Tt,!0),this},g.__private__.ellipse=g.ellipse=function(z,ue,_e,Oe,ze){if(isNaN(z)||isNaN(ue)||isNaN(_e)||isNaN(Oe)||!Ni(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var bt=4/3*(Math.SQRT2-1)*_e,Tt=4/3*(Math.SQRT2-1)*Oe;return El(z+_e,ue),Ri(z+_e,ue-Tt,z+bt,ue-Oe,z,ue-Oe),Ri(z-bt,ue-Oe,z-_e,ue-Tt,z-_e,ue),Ri(z-_e,ue+Tt,z-bt,ue+Oe,z,ue+Oe),Ri(z+bt,ue+Oe,z+_e,ue+Tt,z+_e,ue),Oi(ze),this},g.__private__.circle=g.circle=function(z,ue,_e,Oe){if(isNaN(z)||isNaN(ue)||isNaN(_e)||!Ni(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(z,ue,_e,_e,Oe)},g.setFont=function(z,ue,_e){return _e&&(ue=S(ue,_e)),ut=tc(z,ue,{disableWarning:!1}),this};var la=g.__private__.getFont=g.getFont=function(){return qe[tc.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var z,ue,_e={};for(z in rt)if(rt.hasOwnProperty(z))for(ue in _e[z]=[],rt[z])rt[z].hasOwnProperty(ue)&&_e[z].push(ue);return _e},g.addFont=function(z,ue,_e,Oe,ze){var bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&bt.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&bt.indexOf(arguments[3])==-1&&(_e=S(_e,Oe)),kl.call(this,z,ue,_e,ze=ze||"Identity-H")};var ls,ji=t.lineWidth||.200025,mo=g.__private__.getLineWidth=g.getLineWidth=function(){return ji},mr=g.__private__.setLineWidth=g.setLineWidth=function(z){return ji=z,ce(T(R(z))+" w"),this};g.__private__.setLineDash=Cr.API.setLineDash=Cr.API.setLineDashPattern=function(z,ue){if(z=z||[],ue=ue||0,isNaN(ue)||!Array.isArray(z))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return z=z.map(function(_e){return T(R(_e))}).join(" "),ue=T(R(ue)),ce("["+z+"] "+ue+" d"),this};var go=g.__private__.getLineHeight=g.getLineHeight=function(){return Ne*ls};g.__private__.getLineHeight=g.getLineHeight=function(){return Ne*ls};var xo=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(z){return typeof(z=z||1.15)=="number"&&(ls=z),this},$o=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return ls};xo(t.lineHeight);var Fs=g.__private__.getHorizontalCoordinate=function(z){return R(z)},ys=g.__private__.getVerticalCoordinate=function(z){return I===E?z:Wt[W].mediaBox.topRightY-Wt[W].mediaBox.bottomLeftY-R(z)},Fo=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(z){return T(Fs(z))},rn=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(z){return T(ys(z))},Mi=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return tr(Mi)},g.__private__.setStrokeColor=g.setDrawColor=function(z,ue,_e,Oe){return Mi=Rr({ch1:z,ch2:ue,ch3:_e,ch4:Oe,pdfColorType:"draw",precision:2}),ce(Mi),this};var bo=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return tr(bo)},g.__private__.setFillColor=g.setFillColor=function(z,ue,_e,Oe){return bo=Rr({ch1:z,ch2:ue,ch3:_e,ch4:Oe,pdfColorType:"fill",precision:2}),ce(bo),this};var ja=t.textColor||"0 g",sc=g.__private__.getTextColor=g.getTextColor=function(){return tr(ja)};g.__private__.setTextColor=g.setTextColor=function(z,ue,_e,Oe){return ja=Rr({ch1:z,ch2:ue,ch3:_e,ch4:Oe,pdfColorType:"text",precision:3}),this};var Q=t.charSpace,xe=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Q||0)};g.__private__.setCharSpace=g.setCharSpace=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Q=z,this};var Te=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(z){var ue=g.CapJoinStyles[z];if(ue===void 0)throw new Error("Line cap style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Te=ue,ce(ue+" J"),this};var dt=0;g.__private__.setLineJoin=g.setLineJoin=function(z){var ue=g.CapJoinStyles[z];if(ue===void 0)throw new Error("Line join style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return dt=ue,ce(ue+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(z){if(z=z||0,isNaN(z))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ce(T(R(z))+" M"),this},g.GState=Sj,g.setGState=function(z){(z=typeof z=="string"?Kt[rr[z]]:_r(null,z)).equals(Br)||(ce("/"+z.id+" gs"),Br=z)};var _r=function(z,ue){if(!z||!rr[z]){var _e=!1;for(var Oe in Kt)if(Kt.hasOwnProperty(Oe)&&Kt[Oe].equals(ue)){_e=!0;break}if(_e)ue=Kt[Oe];else{var ze="GS"+(Object.keys(Kt).length+1).toString(10);Kt[ze]=ue,ue.id=ze}return z&&(rr[z]=ue.id),qt.publish("addGState",ue),ue}};g.addGState=function(z,ue){return _r(z,ue),this},g.saveGraphicsState=function(){return ce("q"),Ot.push({key:ut,size:Ne,color:ja}),this},g.restoreGraphicsState=function(){ce("Q");var z=Ot.pop();return ut=z.key,Ne=z.size,ja=z.color,Br=null,this},g.setCurrentTransformationMatrix=function(z){return ce(z.toString()+" cm"),this},g.comment=function(z){return ce("#"+z),this};var er=function(z,ue){var _e=z||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return _e},set:function(bt){isNaN(bt)||(_e=parseFloat(bt))}});var Oe=ue||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(bt){isNaN(bt)||(Oe=parseFloat(bt))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(bt){ze=bt.toString()}}),this},Hr=function(z,ue,_e,Oe){er.call(this,z,ue),this.type="rect";var ze=_e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(Tt){isNaN(Tt)||(ze=parseFloat(Tt))}});var bt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return bt},set:function(Tt){isNaN(Tt)||(bt=parseFloat(Tt))}}),this},Xr=function(){this.page=zt,this.currentPage=W,this.pages=ye.slice(0),this.pagesContext=Wt.slice(0),this.x=Fe,this.y=Ut,this.matrix=jt,this.width=Un(W),this.height=ss(W),this.outputDestination=ke,this.id="",this.objectNumber=-1};Xr.prototype.restore=function(){zt=this.page,W=this.currentPage,Wt=this.pagesContext,ye=this.pages,Fe=this.x,Ut=this.y,jt=this.matrix,Us(W,this.width),Rn(W,this.height),ke=this.outputDestination};var Cn=function(z,ue,_e,Oe,ze){Pt.push(new Xr),zt=W=0,ye=[],Fe=z,Ut=ue,jt=ze,Xi([_e,Oe])};for(var Qr in g.beginFormObject=function(z,ue,_e,Oe,ze){return Cn(z,ue,_e,Oe,ze),this},g.endFormObject=function(z){return(function(ue){if(Nt[ue])Pt.pop().restore();else{var _e=new Xr,Oe="Xo"+(Object.keys(Re).length+1).toString(10);_e.id=Oe,Nt[ue]=Oe,Re[Oe]=_e,qt.publish("addFormObject",_e),Pt.pop().restore()}})(z),this},g.doFormObject=function(z,ue){var _e=Re[Nt[z]];return ce("q"),ce(ue.toString()+" cm"),ce("/"+_e.id+" Do"),ce("Q"),this},g.getFormObject=function(z){var ue=Re[Nt[z]];return{x:ue.x,y:ue.y,width:ue.width,height:ue.height,matrix:ue.matrix}},g.save=function(z,ue){return z=z||"generated.pdf",(ue=ue||{}).returnPromise=ue.returnPromise||!1,ue.returnPromise===!1?(yp(an(li()),z),typeof yp.unload=="function"&&Gr.setTimeout&&setTimeout(yp.unload,911),this):new Promise(function(_e,Oe){try{var ze=yp(an(li()),z);typeof yp.unload=="function"&&Gr.setTimeout&&setTimeout(yp.unload,911),_e(ze)}catch(bt){Oe(bt.message)}})},Cr.API)Cr.API.hasOwnProperty(Qr)&&(Qr==="events"&&Cr.API.events.length?(function(z,ue){var _e,Oe,ze;for(ze=ue.length-1;ze!==-1;ze--)_e=ue[ze][0],Oe=ue[ze][1],z.subscribe.apply(z,[_e].concat(typeof Oe=="function"?[Oe]:Oe))})(qt,Cr.API.events):g[Qr]=Cr.API[Qr]);function Un(z){return Wt[z].mediaBox.topRightX-Wt[z].mediaBox.bottomLeftX}function Us(z,ue){Wt[z].mediaBox.topRightX=ue+Wt[z].mediaBox.bottomLeftX}function ss(z){return Wt[z].mediaBox.topRightY-Wt[z].mediaBox.bottomLeftY}function Rn(z,ue){Wt[z].mediaBox.topRightY=ue+Wt[z].mediaBox.bottomLeftY}var Wn=g.getPageWidth=function(z){return Un(z=z||W)/At},Wa=g.setPageWidth=function(z,ue){Us(z,ue*At)},Ys=g.getPageHeight=function(z){return ss(z=z||W)/At},Ga=g.setPageHeight=function(z,ue){Rn(z,ue*At)};return g.internal={pdfEscape:Gs,getStyle:fo,getFont:la,getFontSize:St,getCharSpace:xe,getTextColor:sc,getLineHeight:go,getLineHeightFactor:$o,getLineWidth:mo,write:Be,getHorizontalCoordinate:Fs,getVerticalCoordinate:ys,getCoordinateString:Fo,getVerticalCoordinateString:rn,collections:{},newObject:$t,newAdditionalObject:Me,newObjectDeferred:Qt,newObjectDeferredBegin:Ee,getFilters:Kr,putStream:$s,events:qt,scaleFactor:At,pageSize:{getWidth:function(){return Wn(W)},setWidth:function(z){Wa(W,z)},getHeight:function(){return Ys(W)},setHeight:function(z){Ga(W,z)}},encryptionOptions:h,encryption:Zn,getEncryptor:function(z){return h!==null?Zn.encryptor(z,0):function(ue){return ue}},output:ho,getNumberOfPages:_l,get pages(){return ye},out:ce,f2:k,f3:L,getPageInfo:bs,getPageInfoByObjId:tl,getCurrentPageInfo:Sl,getPDFVersion:v,Point:er,Rectangle:Hr,Matrix:It,hasHotfix:Is},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return Wn(W)},set:function(z){Wa(W,z)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return Ys(W)},set:function(z){Ga(W,z)},enumerable:!0,configurable:!0}),(function(z){for(var ue=0,_e=Ve.length;ue<_e;ue++){var Oe=kl.call(this,z[ue][0],z[ue][1],z[ue][2],Ve[ue][3],!0);p===!1&&(m[Oe]=!0);var ze=z[ue][0].split("-");os({id:Oe,fontName:ze[0],fontStyle:ze[1]||""})}qt.publish("addFonts",{fonts:qe,dictionary:rt})}).call(g,Ve),ut="F1",Li(i,r),qt.publish("initialized"),g}tx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},tx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},tx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},tx.prototype.processOwnerPassword=function(t,e){return ET(CT(e).substr(0,5),t)},tx.prototype.encryptor=function(t,e){var r=CT(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return ET(r,n)}},Sj.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ms(t)!==ms(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},Cr.API={events:[]},Cr.version="4.0.0";var Vi=Cr.API,XL=1,Vm=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fg=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},tn=function(t){return t.toFixed(2)},r0=function(t){return t.toFixed(5)};Vi.__acroform__={};var Zl=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},RU=function(t){return t*XL},vd=function(t){var e=new Ote,r=pr.internal.getHeight(t)||0,n=pr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(tn(n)),Number(tn(r))],e},nPe=Vi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},sPe=Vi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},iPe=Vi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},ta=Vi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return iPe(t,e-1)},ra=Vi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return nPe(t,e-1)},na=Vi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sPe(t,e-1)},aPe=Vi.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(a)||0,[Number(tn(c.lowerLeft_X)),Number(tn(c.lowerLeft_Y)),Number(tn(c.upperRight_X)),Number(tn(c.upperRight_Y))]},oPe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=AT(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+tn(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=vd(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},AT=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(k){return k.split(`
`)}):i.map(function(k){return[k]});var a=r,o=pr.internal.getHeight(t)||0;o=o<0?-o:o;var l=pr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,L,R){if(k+1<i.length){var V=L+" "+i[k+1][0];return f5(V,t,R).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var u,h,p=f5("3",t,a).height,m=t.multiline?o-a:(o-p)/2,g=m+=2,b=0,v=0,w=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+f5(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var j="",_=0,E=0;E<i.length;E++)if(i.hasOwnProperty(E)){var I=!1;if(i[E].length!==1&&w!==i[E].length-1){if((p+2)*(_+2)+2>o)continue e;j+=i[E][w],I=!0,v=E,E--}else{j=(j+=i[E][w]+" ").substr(j.length-1)==" "?j.substr(0,j.length-1):j;var O=parseInt(E),B=c(O,j,a),S=E>=i.length-1;if(B&&!S){j+=" ",w=0;continue}if(B||S){if(S)v=O;else if(t.multiline&&(p+2)*(_+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(_+2)+2>o)continue e;v=O}}for(var T="",M=b;M<=v;M++){var $=i[M];if(t.multiline){if(M===v){T+=$[w]+" ",w=(w+1)%$.length;continue}if(M===b){T+=$[$.length-1]+" ";continue}}T+=$[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,h=f5(T,t,a).width,t.textAlign){case"right":u=l-h-2;break;case"center":u=(l-h)/2;break;default:u=2}e+=tn(u)+" "+tn(g)+` Td
`,e+="("+Vm(T)+`) Tj
`,e+=-tn(u)+` 0 Td
`,g=-(a+2),h=0,b=I?v:v+1,_++,j=""}break}return n.text=e,n.fontSize=a,n},f5=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},lPe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cPe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},uPe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ed.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(lPe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");XL=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Rte,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&cPe(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=aPe(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=pr.createDefaultAppearanceStream(l),ms(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=oPe(l);c.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var p="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var g=l.appearanceStreamContent[m];if(p+="/"+m+" ",p+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var b=g[o];typeof b=="function"&&(b=b.call(i,l)),p+="/"+o+" "+b+" ",i.internal.acroformPlugin.xForms.indexOf(b)>=0||i.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(i,l)),p+="/"+o+" "+b,i.internal.acroformPlugin.xForms.indexOf(b)>=0||i.internal.acroformPlugin.xForms.push(b);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}a&&(function(v,w){for(var j in v)if(v.hasOwnProperty(j)){var _=j,E=v[j];w.internal.newObjectDeferredBegin(E.objId,!0),ms(E)==="object"&&typeof E.putStream=="function"&&E.putStream(),delete v[_]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Pte=Vi.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),ms(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Vm(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},$C=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Vm(n(t))+")"},Ad=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ad.prototype.toString=function(){return this.objId+" 0 R"},Ad.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Ad.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:Pte(i,this.objId,this.scope)}):i instanceof Ad?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var Ote=function(){Ad.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Zl(Ote,Ad);var Rte=function(){Ad.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Vm(r(t))+")"}},set:function(r){t=r}})};Zl(Rte,Ad);var ed=function t(){Ad.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(j){if(isNaN(j))throw new Error('Invalid value "'+j+'" for attribute F supplied.');e=j}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ta(e,3)},set:function(j){j?this.F=ra(e,3):this.F=na(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(j){if(isNaN(j))throw new Error('Invalid value "'+j+'" for attribute Ff supplied.');r=j}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(j){n=j!==void 0?j:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(j){n[0]=j}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(j){n[1]=j}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(j){n[2]=j}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(j){n[3]=j}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(j){switch(j){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=j;break;default:throw new Error('Invalid value "'+j+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Cj)return;a="FieldObject"+t.FieldNum++}var j=function(_){return _};return this.scope&&(j=this.scope.internal.getEncryptor(this.objId)),"("+Vm(j(a))+")"},set:function(j){a=j.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(j){a=j}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(j){o=j}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(j){l=j}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(j){c=j}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/XL:u},set:function(j){u=j}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(j){h=j}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Cj||this instanceof Hp))return $C(p,this.objId,this.scope)},set:function(j){j=j.toString(),p=j}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ao==0?$C(m,this.objId,this.scope):m},set:function(j){j=j.toString(),m=this instanceof ao==0?j.substr(0,1)==="("?Fg(j.substr(1,j.length-2)):Fg(j):j}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ao==1?Fg(m.substr(1,m.length-1)):m},set:function(j){j=j.toString(),m=this instanceof ao==1?"/"+j:j}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(j){this.V=j}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ao==0?$C(g,this.objId,this.scope):g},set:function(j){j=j.toString(),g=this instanceof ao==0?j.substr(0,1)==="("?Fg(j.substr(1,j.length-2)):Fg(j):j}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ao==1?Fg(g.substr(1,g.length-1)):g},set:function(j){j=j.toString(),g=this instanceof ao==1?"/"+j:j}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(j){j=!!j,v=j}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(j){b=j}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,1)},set:function(j){j?this.Ff=ra(this.Ff,1):this.Ff=na(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,2)},set:function(j){j?this.Ff=ra(this.Ff,2):this.Ff=na(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,3)},set:function(j){j?this.Ff=ra(this.Ff,3):this.Ff=na(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(j){if([0,1,2].indexOf(j)===-1)throw new Error('Invalid value "'+j+'" for attribute Q supplied.');w=j}}),Object.defineProperty(this,"textAlign",{get:function(){var j;switch(w){case 0:default:j="left";break;case 1:j="center";break;case 2:j="right"}return j},configurable:!0,enumerable:!0,set:function(j){switch(j){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};Zl(ed,Ad);var Sx=function(){ed.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Pte(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,o,l){l||(l=1);for(var c,u=[];c=o.exec(a);)u.push(c[l]);return u})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,18)},set:function(r){r?this.Ff=ra(this.Ff,18):this.Ff=na(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ra(this.Ff,19):this.Ff=na(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,20)},set:function(r){r?(this.Ff=ra(this.Ff,20),e.sort()):this.Ff=na(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,22)},set:function(r){r?this.Ff=ra(this.Ff,22):this.Ff=na(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,23)},set:function(r){r?this.Ff=ra(this.Ff,23):this.Ff=na(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,27)},set:function(r){r?this.Ff=ra(this.Ff,27):this.Ff=na(this.Ff,27)}}),this.hasAppearanceStream=!1};Zl(Sx,ed);var Cx=function(){Sx.call(this),this.fontName="helvetica",this.combo=!1};Zl(Cx,Sx);var Ex=function(){Cx.call(this),this.combo=!0};Zl(Ex,Cx);var pN=function(){Ex.call(this),this.edit=!0};Zl(pN,Ex);var ao=function(){ed.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,15)},set:function(r){r?this.Ff=ra(this.Ff,15):this.Ff=na(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,16)},set:function(r){r?this.Ff=ra(this.Ff,16):this.Ff=na(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,17)},set:function(r){r?this.Ff=ra(this.Ff,17):this.Ff=na(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,26)},set:function(r){r?this.Ff=ra(this.Ff,26):this.Ff=na(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Vm(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){ms(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Zl(ao,ed);var mN=function(){ao.call(this),this.pushButton=!0};Zl(mN,ao);var Ax=function(){ao.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Zl(Ax,ao);var Cj=function(){var t,e;ed.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Vm(i(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){ms(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Zl(Cj,ed),Ax.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Ax.prototype.createOption=function(t){var e=new Cj;return e.Parent=this,e.optionName=t,this.Kids.push(e),dPe.call(this.scope,e),e};var gN=function(){ao.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pr.CheckBox.createAppearanceStream()};Zl(gN,ao);var Hp=function(){ed.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,13)},set:function(e){e?this.Ff=ra(this.Ff,13):this.Ff=na(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,21)},set:function(e){e?this.Ff=ra(this.Ff,21):this.Ff=na(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,23)},set:function(e){e?this.Ff=ra(this.Ff,23):this.Ff=na(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,24)},set:function(e){e?this.Ff=ra(this.Ff,24):this.Ff=na(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,25)},set:function(e){e?this.Ff=ra(this.Ff,25):this.Ff=na(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,26)},set:function(e){e?this.Ff=ra(this.Ff,26):this.Ff=na(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Zl(Hp,ed);var xN=function(){Hp.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ta(this.Ff,14)},set:function(t){t?this.Ff=ra(this.Ff,14):this.Ff=na(this.Ff,14)}}),this.password=!0};Zl(xN,Hp);var pr={CheckBox:{createAppearanceStream:function(){return{N:{On:pr.CheckBox.YesNormal},D:{On:pr.CheckBox.YesPushDown,Off:pr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=AT(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+tn(pr.internal.getWidth(t))+" "+tn(pr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+tn(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=vd(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=pr.internal.getHeight(t),o=pr.internal.getWidth(t),l=AT(t,t.caption);return i.push("1 g"),i.push("0 0 "+tn(o)+" "+tn(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+tn(o-1)+" "+tn(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+tn(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+tn(pr.internal.getWidth(t))+" "+tn(pr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:pr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=pr.RadioButton.Circle.YesNormal,e.D[t]=pr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=vd(t);e.scope=t.scope;var r=[],n=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=pr.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+r0(pr.internal.getWidth(t)/2)+" "+r0(pr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=[],n=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*pr.internal.Bezier_C).toFixed(5)),o=Number((n*pr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+r0(pr.internal.getWidth(t)/2)+" "+r0(pr.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+r0(pr.internal.getWidth(t)/2)+" "+r0(pr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=[],n=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*pr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+r0(pr.internal.getWidth(t)/2)+" "+r0(pr.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:pr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=pr.RadioButton.Cross.YesNormal,e.D[t]=pr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=vd(t);e.scope=t.scope;var r=[],n=pr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+tn(pr.internal.getWidth(t)-2)+" "+tn(pr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(tn(n.x1.x)+" "+tn(n.x1.y)+" m"),r.push(tn(n.x2.x)+" "+tn(n.x2.y)+" l"),r.push(tn(n.x4.x)+" "+tn(n.x4.y)+" m"),r.push(tn(n.x3.x)+" "+tn(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=pr.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+tn(pr.internal.getWidth(t))+" "+tn(pr.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+tn(pr.internal.getWidth(t)-2)+" "+tn(pr.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(tn(r.x1.x)+" "+tn(r.x1.y)+" m"),n.push(tn(r.x2.x)+" "+tn(r.x2.y)+" l"),n.push(tn(r.x4.x)+" "+tn(r.x4.y)+" m"),n.push(tn(r.x3.x)+" "+tn(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=vd(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+tn(pr.internal.getWidth(t))+" "+tn(pr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};pr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=pr.internal.getWidth(t),r=pr.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},pr.internal.getWidth=function(t){var e=0;return ms(t)==="object"&&(e=RU(t.Rect[2])),e},pr.internal.getHeight=function(t){var e=0;return ms(t)==="object"&&(e=RU(t.Rect[3])),e};var dPe=Vi.addField=function(t){if(uPe(this,t),!(t instanceof ed))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Vi.AcroFormChoiceField=Sx,Vi.AcroFormListBox=Cx,Vi.AcroFormComboBox=Ex,Vi.AcroFormEditBox=pN,Vi.AcroFormButton=ao,Vi.AcroFormPushButton=mN,Vi.AcroFormRadioButton=Ax,Vi.AcroFormCheckBox=gN,Vi.AcroFormTextField=Hp,Vi.AcroFormPasswordField=xN,Vi.AcroFormAppearance=pr,Vi.AcroForm={ChoiceField:Sx,ListBox:Cx,ComboBox:Ex,EditBox:pN,Button:ao,PushButton:mN,RadioButton:Ax,CheckBox:gN,TextField:Hp,PasswordField:xN,Appearance:pr},Cr.AcroForm={ChoiceField:Sx,ListBox:Cx,ComboBox:Ex,EditBox:pN,Button:ao,PushButton:mN,RadioButton:Ax,CheckBox:gN,TextField:Hp,PasswordField:xN,Appearance:pr};Cr.AcroForm;function Mte(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(k,L){var R,V,Y,X,J,re=r;if((L=L||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(B(k))for(J in n)for(Y=n[J],R=0;R<Y.length;R+=1){for(X=!0,V=0;V<Y[R].length;V+=1)if(Y[R][V]!==void 0&&Y[R][V]!==k[V]){X=!1;break}if(X===!0){re=J;break}}else for(J in n)for(Y=n[J],R=0;R<Y.length;R+=1){for(X=!0,V=0;V<Y[R].length;V+=1)if(Y[R][V]!==void 0&&Y[R][V]!==k.charCodeAt(V)){X=!1;break}if(X===!0){re=J;break}}return re===r&&L!==r&&(re=L),re},a=function k(L){for(var R=this.internal.write,V=this.internal.putStream,Y=(0,this.internal.getFilters)();Y.indexOf("FlateEncode")!==-1;)Y.splice(Y.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:L.width}),X.push({key:"Height",value:L.height}),L.colorSpace===j.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===j.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var J="",re=0,se=L.transparency.length;re<se;re++)J+=L.transparency[re]+" "+L.transparency[re]+" ";X.push({key:"Mask",value:"["+J+"]"})}L.sMask!==void 0&&X.push({key:"SMask",value:L.objectId+1+" 0 R"});var ee=L.filter!==void 0?["/"+L.filter]:void 0;if(V({data:L.data,additionalKeyValues:X,alreadyAppliedFilters:ee,objectId:L.objectId}),R("endobj"),"sMask"in L&&L.sMask!==void 0){var q,U=(q=L.sMaskBitsPerComponent)!==null&&q!==void 0?q:L.bitsPerComponent,W={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:U,data:L.sMask};"filter"in L&&(W.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(U," /Columns ").concat(L.width),W.filter=L.filter),k.call(this,W)}if(L.colorSpace===j.INDEXED){var Z=this.internal.newObject();V({data:T(new Uint8Array(L.palette)),objectId:Z}),R("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var L in k)a.call(this,k[L])},l=function(){var k,L=this.internal.collections[e+"images"],R=this.internal.write;for(var V in L)R("/I"+(k=L[V]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},h=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(k){return typeof t["process"+k.toUpperCase()]=="function"},m=function(k){return ms(k)==="object"&&k.nodeType===1},g=function(k,L){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var R=""+k.getAttribute("src");if(R.indexOf("data:image/")===0)return fN(unescape(R).split("base64,").pop());var V=t.loadFile(R,!0);if(V!==void 0)return V}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var Y;switch(L){case"PNG":Y="image/png";break;case"WEBP":Y="image/webp";break;default:Y="image/jpeg"}return fN(k.toDataURL(Y,1).split("base64,").pop())}},b=function(k){var L=this.internal.collections[e+"images"];if(L){for(var R in L)if(k===L[R].alias)return L[R]}},v=function(k,L,R){return k||L||(k=-96,L=-96),k<0&&(k=-1*R.width*72/k/this.internal.scaleFactor),L<0&&(L=-1*R.height*72/L/this.internal.scaleFactor),k===0&&(k=L*R.width/R.height),L===0&&(L=k*R.height/R.width),[k,L]},w=function(k,L,R,V,Y,X){var J=v.call(this,R,V,Y),re=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,ee=u.call(this);if(R=J[0],V=J[1],ee[Y.index]=Y,X){X*=Math.PI/180;var q=Math.cos(X),U=Math.sin(X),W=function(de){return de.toFixed(4)},Z=[W(q),W(U),W(-1*U),W(q),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,re(k),se(L+V),"cm"].join(" ")),this.internal.write(Z.join(" ")),this.internal.write([re(R),"0","0",re(V),"0","0","cm"].join(" "))):this.internal.write([re(R),"0","0",re(V),re(k),se(L+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Y.index+" Do"),this.internal.write("Q")},j=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=t.__addimage__.sHashCode=function(k){var L,R,V=0;if(typeof k=="string")for(R=k.length,L=0;L<R;L++)V=(V<<5)-V+k.charCodeAt(L),V|=0;else if(B(k))for(R=k.byteLength/2,L=0;L<R;L++)V=(V<<5)-V+k[L],V|=0;return V},I=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var L=!0;return k.length===0&&(L=!1),k.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(L=!1),L},O=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var L=k.indexOf(",");return L<0?null:k.substring(0,L).trim().endsWith("base64")?k.substring(L+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var B=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},S=t.__addimage__.binaryStringToUint8Array=function(k){for(var L=k.length,R=new Uint8Array(L),V=0;V<L;V++)R[V]=k.charCodeAt(V);return R},T=t.__addimage__.arrayBufferToBinaryString=function(k){for(var L="",R=B(k)?k:new Uint8Array(k),V=0;V<R.length;V+=8192)L+=String.fromCharCode.apply(null,R.subarray(V,V+8192));return L};t.addImage=function(){var k,L,R,V,Y,X,J,re,se;if(typeof arguments[1]=="number"?(L=r,R=arguments[1],V=arguments[2],Y=arguments[3],X=arguments[4],J=arguments[5],re=arguments[6],se=arguments[7]):(L=arguments[1],R=arguments[2],V=arguments[3],Y=arguments[4],X=arguments[5],J=arguments[6],re=arguments[7],se=arguments[8]),ms(k=arguments[0])==="object"&&!m(k)&&"imageData"in k){var ee=k;k=ee.imageData,L=ee.format||L||r,R=ee.x||R||0,V=ee.y||V||0,Y=ee.w||ee.width||Y,X=ee.h||ee.height||X,J=ee.alias||J,re=ee.compression||re,se=ee.rotation||ee.angle||se}var q=this.internal.getFilters();if(re===void 0&&q.indexOf("FlateEncode")!==-1&&(re="SLOW"),isNaN(R)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var U=M.call(this,k,L,J,re);return w.call(this,R,V,Y,X,U,se),this};var M=function(k,L,R,V){var Y,X,J;if(typeof k=="string"&&i(k)===r){k=unescape(k);var re=$(k,!1);(re!==""||(re=t.loadFile(k,!0))!==void 0)&&(k=re)}if(m(k)&&(k=g(k,L)),L=i(k,L),!p(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((J=R)==null||J.length===0)&&(R=(function(se){return typeof se=="string"||B(se)?E(se):B(se.data)?E(se.data):null})(k)),(Y=b.call(this,R))||(k instanceof Uint8Array||L==="RGBA"||(X=k,k=S(k)),Y=this["process"+L.toUpperCase()](k,h.call(this),R,(function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in t.image_compression?se:_.NONE})(V),X)),!Y)throw new Error("An unknown error occurred whilst processing the image.");return Y},$=t.__addimage__.convertBase64ToBinaryString=function(k,L){L=typeof L!="boolean"||L;var R,V="";if(typeof k=="string"){var Y;R=(Y=O(k))!==null&&Y!==void 0?Y:k;try{V=fN(R)}catch(X){if(L)throw I(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(k){var L,R,V="";if(m(k)&&(k=g(k)),typeof k=="string"&&i(k)===r&&((V=$(k,!1))===""&&(V=t.loadFile(k)||""),k=V),R=i(k),!p(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(k instanceof Uint8Array||(k=S(k)),!(L=this["process"+R.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=R,L}})(Cr.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};Cr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,p=0;p<u.length&&!h;p++)switch((n=u[p]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),j=this.internal.getEncryptor(v.objId),_=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+g(j(n.contents))+")",a+=" /Popup "+w.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+g(j(_))+") >>",v.content=a;var E=v.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+E,n.open&&(a+=" /Open true"),a+=" >>",w.content=a,this.internal.write(v.objId,"0 R",w.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var I=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+g(b(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+I+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var B=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,i,a){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var h=this.splitTextToSize(r,l).length;o=Math.ceil(u*h)}else l=c,o=u;return this.text(r,n,i,a),i+=.2*u,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,i-u,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(Cr.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},l=t.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&i.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(v){var w=0,j=r,_="",E=0;for(w=0;w<v.length;w+=1)j[v.charCodeAt(w)]!==void 0?(E++,typeof(j=j[v.charCodeAt(w)])=="number"&&(_+=String.fromCharCode(j),j=r,E=0),w===v.length-1&&(j=r,_+=v.charAt(w-(E-1)),w-=E-1,E=0)):(j=r,_+=v.charAt(w-E),w-=E,E=0);return _};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var m=t.__arabicParser__.getCorrectForm=function(v,w,j){return o(v)?a(v)===!1?-1:!u(v)||!o(w)&&!o(j)||!o(j)&&l(w)||l(v)&&!o(w)||l(v)&&c(w)||l(v)&&l(w)?0:h(v)&&o(w)&&!l(w)&&o(j)&&u(j)?3:l(v)||!o(j)?1:2:-1},g=function(v){var w=0,j=0,_=0,E="",I="",O="",B=(v=v||"").split("\\s+"),S=[];for(w=0;w<B.length;w+=1){for(S.push(""),j=0;j<B[w].length;j+=1)E=B[w][j],I=B[w][j-1],O=B[w][j+1],o(E)?(_=m(E,I,O),S[w]+=_!==-1?String.fromCharCode(e[E.charCodeAt(0)][_]):E):S[w]+=E;S[w]=p(S[w])}return S.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var v,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,j=[];if(Array.isArray(w)){var _=0;for(j=[],_=0;_<w.length;_+=1)Array.isArray(w[_])?j.push([g(w[_][0]),w[_][1],w[_][2]]):j.push([g(w[_])]);v=j}else v=g(w);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",b])})(Cr.API),Cr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Cr.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(v){b=v}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,g=0,b=0,v=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var j=u.maxWidth;j>0?typeof c=="string"?c=this.splitTextToSize(c,j):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(E,I){return E.concat(w.splitTextToSize(I,j))},[])):c=Array.isArray(c)?c:[c];for(var _=0;_<c.length;_++)g<(v=this.getStringUnitWidth(c[_],{font:p})*h)&&(g=v);return g!==0&&(b=c.length),{w:g/=m,h:Math.max((b*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,g&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,p,m){if(n.call(this),!h)throw new Error("No data for PDF table.");var g,b,v,w,j=[],_=[],E=[],I={},O={},B=[],S=[],T=(m=m||{}).autoSize||!1,M=m.printHeaders!==!1,$=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,k=m.margins||Object.assign({width:this.getPageWidth()},e),L=typeof m.padding=="number"?m.padding:3,R=m.headerBackgroundColor||"#c8c8c8",V=m.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=$,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=V,this.setFontSize($),p==null)_=j=Object.keys(h[0]),E=j.map(function(){return"left"});else if(Array.isArray(p)&&ms(p[0])==="object")for(j=p.map(function(ee){return ee.name}),_=p.map(function(ee){return ee.prompt||ee.name||""}),E=p.map(function(ee){return ee.align||"left"}),g=0;g<p.length;g+=1)O[p[g].name]=.7499990551181103*p[g].width;else Array.isArray(p)&&typeof p[0]=="string"&&(_=j=p,E=j.map(function(){return"left"}));if(T||Array.isArray(p)&&typeof p[0]=="string")for(g=0;g<j.length;g+=1){for(I[w=j[g]]=h.map(function(ee){return ee[w]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(_[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=I[w],this.setFont(void 0,"normal"),v=0;v<b.length;v+=1)B.push(this.getTextDimensions(b[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[w]=Math.max.apply(null,B)+L+L,B=[]}if(M){var Y={};for(g=0;g<j.length;g+=1)Y[j[g]]={},Y[j[g]].text=_[g],Y[j[g]].align=E[g];var X=l.call(this,Y,O);S=j.map(function(ee){return new a(c,u,O[ee],X,Y[ee].text,void 0,Y[ee].align)}),this.setTableHeaderRow(S),this.printHeaderRow(1,!1)}var J=p.reduce(function(ee,q){return ee[q.name]=q.align,ee},{});for(g=0;g<h.length;g+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:g,data:h[g]},this);var re=l.call(this,h[g],O);for(v=0;v<j.length;v+=1){var se=h[g][j[v]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:g,col:v,data:se},this),o.call(this,new a(c,u,O[j[v]],re,se,g+2,J[j[v]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var h=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(g){var b=c[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,u[g]-h-h)},this).map(function(g){return this.getLineHeightFactor()*g.length*p/m+h+h},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){h=this.internal.__cell__.tableHeaderRow[g].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=c;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,h),this.setTextColor(b)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}})(Cr.API);var Dte={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Bte=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],TT=Mte(Bte),$te=[100,200,300,400,500,600,700,800,900],hPe=Mte($te);function FC(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return Dte[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof TT[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function MU(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var fPe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},DU={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function BU(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function $U(t){return t.trimLeft()}function pPe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function mPe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var p5,FU,UU,Ug,m5,zU,qU,VU,UC=["times"];function HU(t,e,r,n,i){var a=4,o=GU;switch(i){case Cr.API.image_compression.FAST:a=1,o=WU;break;case Cr.API.image_compression.MEDIUM:a=6,o=KU;break;case Cr.API.image_compression.SLOW:a=9,o=YU}t=(function(c,u,h,p){for(var m,g=c.length/u,b=new Uint8Array(c.length+g),v=[gPe,WU,GU,KU,YU],w=0;w<g;w+=1){var j=w*u,_=c.subarray(j,j+u);if(p)b.set(p(_,h,m),j+w);else{for(var E=v.length,I=[],O=0;O<E;O+=1)I[O]=v[O](_,h,m);var B=bPe(I.concat());b.set(I[B],j+w)}m=_}return b})(t,e,Math.ceil(r*n/8),o);var l=jT(t,{level:a});return Cr.API.__addimage__.arrayBufferToBinaryString(l)}function gPe(t){var e=Array.apply([],t);return e.unshift(0),e}function WU(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function GU(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;i[a+1]=t[a]-o+256&255}return i}function KU(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;i[a+1]=t[a]+256-(o+l>>>1)&255}return i}function YU(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var o=xPe(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-o+256&255}return i}function xPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function bPe(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function zC(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),o=(1<<r)-1;return Fte(t,i)>>a&o}function XU(t,e,r,n){var i=r*n,a=Math.floor(i/8),o=16-(i-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,h,p){if(h+1<u.byteLength)u.setUint16(h,p,!1);else{var m=p>>8&255;u.setUint8(h,m)}})(t,a,Fte(t,a)&~(l<<o)&65535|c)}function Fte(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function yPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var u=!0,h=[],p=0,m=null,g=0,b=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[e++];p=t[e++]|t[e++]<<8,m=t[e++],1&v||(m=null),g=v>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,I=t[e++],O=I>>6&1,B=1<<1+(7&I),S=l,T=c,M=!1;I>>7&&(M=!0,S=e,T=B,e+=3*B);var $=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}h.push({x:w,y:j,width:_,height:E,has_local_palette:M,palette_offset:S,palette_size:T,data_offset:$,data_length:e-$,transparent_index:m,interlaced:!!O,delay:p,disposal:g});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return b},this.frameInfo=function(L){if(L<0||L>=h.length)throw new Error("Frame index out of range.");return h[L]},this.decodeAndBlitFrameBGRA=function(L,R){var V=this.frameInfo(L),Y=V.width*V.height,X=new Uint8Array(Y);QU(t,V.data_offset,X,Y);var J=V.palette_offset,re=V.transparent_index;re===null&&(re=256);var se=V.width,ee=r-se,q=se,U=4*(V.y*r+V.x),W=4*((V.y+V.height)*r+V.x),Z=U,de=4*ee;V.interlaced===!0&&(de+=4*r*7);for(var be=8,oe=0,ne=X.length;oe<ne;++oe){var H=X[oe];if(q===0&&(q=se,(Z+=de)>=W&&(de=4*ee+4*r*(be-1),Z=U+(se+ee)*(be<<1),be>>=1)),H===re)Z+=4;else{var le=t[J+3*H],ye=t[J+3*H+1],me=t[J+3*H+2];R[Z++]=me,R[Z++]=ye,R[Z++]=le,R[Z++]=255}--q}},this.decodeAndBlitFrameRGBA=function(L,R){var V=this.frameInfo(L),Y=V.width*V.height,X=new Uint8Array(Y);QU(t,V.data_offset,X,Y);var J=V.palette_offset,re=V.transparent_index;re===null&&(re=256);var se=V.width,ee=r-se,q=se,U=4*(V.y*r+V.x),W=4*((V.y+V.height)*r+V.x),Z=U,de=4*ee;V.interlaced===!0&&(de+=4*r*7);for(var be=8,oe=0,ne=X.length;oe<ne;++oe){var H=X[oe];if(q===0&&(q=se,(Z+=de)>=W&&(de=4*ee+4*r*(be-1),Z=U+(se+ee)*(be<<1),be>>=1)),H===re)Z+=4;else{var le=t[J+3*H],ye=t[J+3*H+1],me=t[J+3*H+2];R[Z++]=le,R[Z++]=ye,R[Z++]=me,R[Z++]=255}--q}}}function QU(t,e,r,n){for(var i=t[e++],a=1<<i,o=a+1,l=o+1,c=i+1,u=(1<<c)-1,h=0,p=0,m=0,g=t[e++],b=new Int32Array(4096),v=null;;){for(;h<16&&g!==0;)p|=t[e++]<<h,h+=8,g===1?g=t[e++]:--g;if(h<c)break;var w=p&u;if(p>>=c,h-=c,w!==a){if(w===o)break;for(var j=w<l?w:v,_=0,E=j;E>a;)E=b[E]>>8,++_;var I=E;if(m+_+(j!==w?1:0)>n)return void Rs.log("Warning, gif stream longer than expected.");r[m++]=I;var O=m+=_;for(j!==w&&(r[m++]=I),E=j;_--;)E=b[E],r[--O]=255&E,E>>=8;v!==null&&l<4096&&(b[l++]=v<<8|I,l>=u+1&&c<12&&(++c,u=u<<1|1)),v=w}else l=o+1,u=(1<<(c=i+1))-1,v=null}return m!==n&&Rs.log("Warning, gif stream shorter than expected."),r}function qC(t){var e,r,n,i,a,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),p=new Array(65535),m=new Array(65535),g=new Array(64),b=new Array(64),v=[],w=0,j=7,_=new Array(64),E=new Array(64),I=new Array(64),O=new Array(256),B=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(U,W){for(var Z=0,de=0,be=new Array,oe=1;oe<=16;oe++){for(var ne=1;ne<=U[oe];ne++)be[W[de]]=[],be[W[de]][0]=Z,be[W[de]][1]=oe,de++,Z++;Z*=2}return be}function J(U){for(var W=U[0],Z=U[1]-1;Z>=0;)W&1<<Z&&(w|=1<<j),Z--,--j<0&&(w==255?(re(255),re(0)):re(w),j=7,w=0)}function re(U){v.push(U)}function se(U){re(U>>8&255),re(255&U)}function ee(U,W,Z,de,be){for(var oe,ne=be[0],H=be[240],le=(function(Ne,Ye){var St,Vt,Lt,at,gt,vt,ft,ot,ut,At,Fe=0;for(ut=0;ut<8;++ut){St=Ne[Fe],Vt=Ne[Fe+1],Lt=Ne[Fe+2],at=Ne[Fe+3],gt=Ne[Fe+4],vt=Ne[Fe+5],ft=Ne[Fe+6];var Ut=St+(ot=Ne[Fe+7]),jt=St-ot,qe=Vt+ft,rt=Vt-ft,Ot=Lt+vt,pt=Lt-vt,Jt=at+gt,Kt=at-gt,rr=Ut+Jt,Br=Ut-Jt,zt=qe+Ot,Wt=qe-Ot;Ne[Fe]=rr+zt,Ne[Fe+4]=rr-zt;var qt=.707106781*(Wt+Br);Ne[Fe+2]=Br+qt,Ne[Fe+6]=Br-qt;var ur=.382683433*((rr=Kt+pt)-(Wt=rt+jt)),Re=.5411961*rr+ur,Nt=1.306562965*Wt+ur,Pt=.707106781*(zt=pt+rt),It=jt+Pt,Zt=jt-Pt;Ne[Fe+5]=Zt+Re,Ne[Fe+3]=Zt-Re,Ne[Fe+1]=It+Nt,Ne[Fe+7]=It-Nt,Fe+=8}for(Fe=0,ut=0;ut<8;++ut){St=Ne[Fe],Vt=Ne[Fe+8],Lt=Ne[Fe+16],at=Ne[Fe+24],gt=Ne[Fe+32],vt=Ne[Fe+40],ft=Ne[Fe+48];var Ae=St+(ot=Ne[Fe+56]),et=St-ot,Rt=Vt+ft,$t=Vt-ft,Qt=Lt+vt,Ee=Lt-vt,Me=at+gt,Je=at-gt,Ft=Ae+Me,tr=Ae-Me,Rr=Rt+Qt,Kr=Rt-Qt;Ne[Fe]=Ft+Rr,Ne[Fe+32]=Ft-Rr;var $s=.707106781*(Kr+tr);Ne[Fe+16]=tr+$s,Ne[Fe+48]=tr-$s;var Ki=.382683433*((Ft=Je+Ee)-(Kr=$t+et)),Ws=.5411961*Ft+Ki,Ts=1.306562965*Kr+Ki,wa=.707106781*(Rr=Ee+$t),Hn=et+wa,wi=et-wa;Ne[Fe+40]=wi+Ws,Ne[Fe+24]=wi-Ws,Ne[Fe+8]=Hn+Ts,Ne[Fe+56]=Hn-Ts,Fe++}for(ut=0;ut<64;++ut)At=Ne[ut]*Ye[ut],g[ut]=At>0?At+.5|0:At-.5|0;return g})(U,W),ye=0;ye<64;++ye)b[S[ye]]=le[ye];var me=b[0]-Z;Z=b[0],me==0?J(de[0]):(J(de[m[oe=32767+me]]),J(p[oe]));for(var ke=63;ke>0&&b[ke]==0;)ke--;if(ke==0)return J(ne),Z;for(var Ie,ce=1;ce<=ke;){for(var Be=ce;b[ce]==0&&ce<=ke;)++ce;var ct=ce-Be;if(ct>=16){Ie=ct>>4;for(var Ve=1;Ve<=Ie;++Ve)J(H);ct&=15}oe=32767+b[ce],J(be[(ct<<4)+m[oe]]),J(p[oe]),ce++}return ke!=63&&J(ne),Z}function q(U){U=Math.min(Math.max(U,1),100),a!=U&&((function(W){for(var Z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],de=0;de<64;de++){var be=o((Z[de]*W+50)/100);be=Math.min(Math.max(be,1),255),l[S[de]]=be}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ne=0;ne<64;ne++){var H=o((oe[ne]*W+50)/100);H=Math.min(Math.max(H,1),255),c[S[ne]]=H}for(var le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ye=0,me=0;me<8;me++)for(var ke=0;ke<8;ke++)u[ye]=1/(l[S[ye]]*le[me]*le[ke]*8),h[ye]=1/(c[S[ye]]*le[me]*le[ke]*8),ye++})(U<50?Math.floor(5e3/U):Math.floor(200-2*U)),a=U)}this.encode=function(U,W){W&&q(W),v=new Array,w=0,j=7,se(65496),se(65504),se(16),re(74),re(70),re(73),re(70),re(0),re(1),re(1),re(0),se(1),se(1),re(0),re(0),(function(){se(65499),se(132),re(0);for(var Vt=0;Vt<64;Vt++)re(l[Vt]);re(1);for(var Lt=0;Lt<64;Lt++)re(c[Lt])})(),(function(Vt,Lt){se(65472),se(17),re(8),se(Lt),se(Vt),re(3),re(1),re(17),re(0),re(2),re(17),re(1),re(3),re(17),re(1)})(U.width,U.height),(function(){se(65476),se(418),re(0);for(var Vt=0;Vt<16;Vt++)re(T[Vt+1]);for(var Lt=0;Lt<=11;Lt++)re(M[Lt]);re(16);for(var at=0;at<16;at++)re($[at+1]);for(var gt=0;gt<=161;gt++)re(k[gt]);re(1);for(var vt=0;vt<16;vt++)re(L[vt+1]);for(var ft=0;ft<=11;ft++)re(R[ft]);re(17);for(var ot=0;ot<16;ot++)re(V[ot+1]);for(var ut=0;ut<=161;ut++)re(Y[ut])})(),se(65498),se(12),re(3),re(1),re(0),re(2),re(17),re(3),re(17),re(0),re(63),re(0);var Z=0,de=0,be=0;w=0,j=7,this.encode.displayName="_encode_";for(var oe,ne,H,le,ye,me,ke,Ie,ce,Be=U.data,ct=U.width,Ve=U.height,Ne=4*ct,Ye=0;Ye<Ve;){for(oe=0;oe<Ne;){for(ye=Ne*Ye+oe,ke=-1,Ie=0,ce=0;ce<64;ce++)me=ye+(Ie=ce>>3)*Ne+(ke=4*(7&ce)),Ye+Ie>=Ve&&(me-=Ne*(Ye+1+Ie-Ve)),oe+ke>=Ne&&(me-=oe+ke-Ne+4),ne=Be[me++],H=Be[me++],le=Be[me++],_[ce]=(B[ne]+B[H+256|0]+B[le+512|0]>>16)-128,E[ce]=(B[ne+768|0]+B[H+1024|0]+B[le+1280|0]>>16)-128,I[ce]=(B[ne+1280|0]+B[H+1536|0]+B[le+1792|0]>>16)-128;Z=ee(_,u,Z,e,n),de=ee(E,h,de,r,i),be=ee(I,h,be,r,i),oe+=32}Ye+=8}if(j>=0){var St=[];St[1]=j+1,St[0]=(1<<j+1)-1,J(St)}return se(65497),new Uint8Array(v)},t=t||50,(function(){for(var U=String.fromCharCode,W=0;W<256;W++)O[W]=U(W)})(),e=X(T,M),r=X(L,R),n=X($,k),i=X(V,Y),(function(){for(var U=1,W=2,Z=1;Z<=15;Z++){for(var de=U;de<W;de++)m[32767+de]=Z,p[32767+de]=[],p[32767+de][1]=Z,p[32767+de][0]=de;for(var be=-(W-1);be<=-U;be++)m[32767+be]=Z,p[32767+be]=[],p[32767+be][1]=Z,p[32767+be][0]=W-1+be;U<<=1,W<<=1}})(),(function(){for(var U=0;U<256;U++)B[U]=19595*U,B[U+256|0]=38470*U,B[U+512|0]=7471*U+32768,B[U+768|0]=-11059*U,B[U+1024|0]=-21709*U,B[U+1280|0]=32768*U+8421375,B[U+1536|0]=-27439*U,B[U+1792|0]=-5329*U})(),q(t)}function _u(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function JU(t){function e(M){if(!M)throw Error("assert :P")}function r(M,$,k){for(var L=0;4>L;L++)if(M[$+L]!=k.charCodeAt(L))return!0;return!1}function n(M,$,k,L,R){for(var V=0;V<R;V++)M[$+V]=k[L+V]}function i(M,$,k,L){for(var R=0;R<L;R++)M[$+R]=k}function a(M){return new Int32Array(M)}function o(M,$){for(var k=[],L=0;L<M;L++)k.push(new $);return k}function l(M,$){var k=[];return(function L(R,V,Y){for(var X=Y[V],J=0;J<X&&(R.push(Y.length>V+1?[]:new $),!(Y.length<V+1));J++)L(R[J],V+1,Y)})(k,0,M),k}var c=function(){var M=this;function $(C,D){for(var G=1<<D-1>>>0;C&G;)G>>>=1;return G?(C&G-1)+G:C}function k(C,D,G,te,he){e(!(te%G));do C[D+(te-=G)]=he;while(0<te)}function L(C,D,G,te,he){if(e(2328>=he),512>=he)var fe=a(512);else if((fe=a(he))==null)return 0;return(function(pe,ve,je,Ce,De,Qe){var Se,Ue,Ke=ve,xt=1<<je,Xe=a(16),mt=a(16);for(e(De!=0),e(Ce!=null),e(pe!=null),e(0<je),Ue=0;Ue<De;++Ue){if(15<Ce[Ue])return 0;++Xe[Ce[Ue]]}if(Xe[0]==De)return 0;for(mt[1]=0,Se=1;15>Se;++Se){if(Xe[Se]>1<<Se)return 0;mt[Se+1]=mt[Se]+Xe[Se]}for(Ue=0;Ue<De;++Ue)Se=Ce[Ue],0<Ce[Ue]&&(Qe[mt[Se]++]=Ue);if(mt[15]==1)return(Ce=new R).g=0,Ce.value=Qe[0],k(pe,Ke,1,xt,Ce),xt;var wt,Bt=-1,Et=xt-1,fr=0,sr=1,Wr=1,lr=1<<je;for(Ue=0,Se=1,De=2;Se<=je;++Se,De<<=1){if(sr+=Wr<<=1,0>(Wr-=Xe[Se]))return 0;for(;0<Xe[Se];--Xe[Se])(Ce=new R).g=Se,Ce.value=Qe[Ue++],k(pe,Ke+fr,De,lr,Ce),fr=$(fr,Se)}for(Se=je+1,De=2;15>=Se;++Se,De<<=1){if(sr+=Wr<<=1,0>(Wr-=Xe[Se]))return 0;for(;0<Xe[Se];--Xe[Se]){if(Ce=new R,(fr&Et)!=Bt){for(Ke+=lr,wt=1<<(Bt=Se)-je;15>Bt&&!(0>=(wt-=Xe[Bt]));)++Bt,wt<<=1;xt+=lr=1<<(wt=Bt-je),pe[ve+(Bt=fr&Et)].g=wt+je,pe[ve+Bt].value=Ke-ve-Bt}Ce.g=Se-je,Ce.value=Qe[Ue++],k(pe,Ke+(fr>>je),De,lr,Ce),fr=$(fr,Se)}}return sr!=2*mt[15]-1?0:xt})(C,D,G,te,he,fe)}function R(){this.value=this.g=0}function V(){this.value=this.g=0}function Y(){this.G=o(5,R),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(nd,V)}function X(C,D,G,te){e(C!=null),e(D!=null),e(2147483648>te),C.Ca=254,C.I=0,C.b=-8,C.Ka=0,C.oa=D,C.pa=G,C.Jd=D,C.Yc=G+te,C.Zc=4<=te?G+te-4+1:G,ne(C)}function J(C,D){for(var G=0;0<D--;)G|=le(C,128)<<D;return G}function re(C,D){var G=J(C,D);return H(C)?-G:G}function se(C,D,G,te){var he,fe=0;for(e(C!=null),e(D!=null),e(4294967288>te),C.Sb=te,C.Ra=0,C.u=0,C.h=0,4<te&&(te=4),he=0;he<te;++he)fe+=D[G+he]<<8*he;C.Ra=fe,C.bb=te,C.oa=D,C.pa=G}function ee(C){for(;8<=C.u&&C.bb<C.Sb;)C.Ra>>>=8,C.Ra+=C.oa[C.pa+C.bb]<<Ic-8>>>0,++C.bb,C.u-=8;de(C)&&(C.h=1,C.u=0)}function q(C,D){if(e(0<=D),!C.h&&D<=vo){var G=Z(C)&Uo[D];return C.u+=D,ee(C),G}return C.h=1,C.u=0}function U(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function W(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Z(C){return C.Ra>>>(C.u&Ic-1)>>>0}function de(C){return e(C.bb<=C.Sb),C.h||C.bb==C.Sb&&C.u>Ic}function be(C,D){C.u=D,C.h=de(C)}function oe(C){C.u>=Lc&&(e(C.u>=Lc),ee(C))}function ne(C){e(C!=null&&C.oa!=null),C.pa<C.Zc?(C.I=(C.oa[C.pa++]|C.I<<8)>>>0,C.b+=8):(e(C!=null&&C.oa!=null),C.pa<C.Yc?(C.b+=8,C.I=C.oa[C.pa++]|C.I<<8):C.Ka?C.b=0:(C.I<<=8,C.b+=8,C.Ka=1))}function H(C){return J(C,1)}function le(C,D){var G=C.Ca;0>C.b&&ne(C);var te=C.b,he=G*D>>>8,fe=(C.I>>>te>he)+0;for(fe?(G-=he,C.I-=he+1<<te>>>0):G=he+1,te=G,he=0;256<=te;)he+=8,te>>=8;return te=7^he+du[te],C.b-=te,C.Ca=(G<<te)-1,fe}function ye(C,D,G){C[D+0]=G>>24&255,C[D+1]=G>>16&255,C[D+2]=G>>8&255,C[D+3]=255&G}function me(C,D){return C[D+0]|C[D+1]<<8}function ke(C,D){return me(C,D)|C[D+2]<<16}function Ie(C,D){return me(C,D)|me(C,D+2)<<16}function ce(C,D){var G=1<<D;return e(C!=null),e(0<D),C.X=a(G),C.X==null?0:(C.Mb=32-D,C.Xa=D,1)}function Be(C,D){e(C!=null),e(D!=null),e(C.Xa==D.Xa),n(D.X,0,C.X,0,1<<D.Xa)}function ct(){this.X=[],this.Xa=this.Mb=0}function Ve(C,D,G,te){e(G!=null),e(te!=null);var he=G[0],fe=te[0];return he==0&&(he=(C*fe+D/2)/D),fe==0&&(fe=(D*he+C/2)/C),0>=he||0>=fe?0:(G[0]=he,te[0]=fe,1)}function Ne(C,D){return C+(1<<D)-1>>>D}function Ye(C,D){return((4278255360&C)+(4278255360&D)>>>0&4278255360)+((16711935&C)+(16711935&D)>>>0&16711935)>>>0}function St(C,D){M[D]=function(G,te,he,fe,pe,ve,je){var Ce;for(Ce=0;Ce<pe;++Ce){var De=M[C](ve[je+Ce-1],he,fe+Ce);ve[je+Ce]=Ye(G[te+Ce],De)}}}function Vt(){this.ud=this.hd=this.jd=0}function Lt(C,D){return((4278124286&(C^D))>>>1)+(C&D)>>>0}function at(C){return 0<=C&&256>C?C:0>C?0:255<C?255:void 0}function gt(C,D){return at(C+(C-D+.5>>1))}function vt(C,D,G){return Math.abs(D-G)-Math.abs(C-G)}function ft(C,D,G,te,he,fe,pe){for(te=fe[pe-1],G=0;G<he;++G)fe[pe+G]=te=Ye(C[D+G],te)}function ot(C,D,G,te,he){var fe;for(fe=0;fe<G;++fe){var pe=C[D+fe],ve=pe>>8&255,je=16711935&(je=(je=16711935&pe)+((ve<<16)+ve));te[he+fe]=(4278255360&pe)+je>>>0}}function ut(C,D){D.jd=255&C,D.hd=C>>8&255,D.ud=C>>16&255}function At(C,D,G,te,he,fe){var pe;for(pe=0;pe<te;++pe){var ve=D[G+pe],je=ve>>>8,Ce=ve,De=255&(De=(De=ve>>>16)+((C.jd<<24>>24)*(je<<24>>24)>>>5));Ce=255&(Ce=(Ce+=(C.hd<<24>>24)*(je<<24>>24)>>>5)+((C.ud<<24>>24)*(De<<24>>24)>>>5)),he[fe+pe]=(4278255360&ve)+(De<<16)+Ce}}function Fe(C,D,G,te,he){M[D]=function(fe,pe,ve,je,Ce,De,Qe,Se,Ue){for(je=Qe;je<Se;++je)for(Qe=0;Qe<Ue;++Qe)Ce[De++]=he(ve[te(fe[pe++])])},M[C]=function(fe,pe,ve,je,Ce,De,Qe){var Se=8>>fe.b,Ue=fe.Ea,Ke=fe.K[0],xt=fe.w;if(8>Se)for(fe=(1<<fe.b)-1,xt=(1<<Se)-1;pe<ve;++pe){var Xe,mt=0;for(Xe=0;Xe<Ue;++Xe)Xe&fe||(mt=te(je[Ce++])),De[Qe++]=he(Ke[mt&xt]),mt>>=Se}else M["VP8LMapColor"+G](je,Ce,Ke,xt,De,Qe,pe,ve,Ue)}}function Ut(C,D,G,te,he){for(G=D+G;D<G;){var fe=C[D++];te[he++]=fe>>16&255,te[he++]=fe>>8&255,te[he++]=255&fe}}function jt(C,D,G,te,he){for(G=D+G;D<G;){var fe=C[D++];te[he++]=fe>>16&255,te[he++]=fe>>8&255,te[he++]=255&fe,te[he++]=fe>>24&255}}function qe(C,D,G,te,he){for(G=D+G;D<G;){var fe=(pe=C[D++])>>16&240|pe>>12&15,pe=240&pe|pe>>28&15;te[he++]=fe,te[he++]=pe}}function rt(C,D,G,te,he){for(G=D+G;D<G;){var fe=(pe=C[D++])>>16&248|pe>>13&7,pe=pe>>5&224|pe>>3&31;te[he++]=fe,te[he++]=pe}}function Ot(C,D,G,te,he){for(G=D+G;D<G;){var fe=C[D++];te[he++]=255&fe,te[he++]=fe>>8&255,te[he++]=fe>>16&255}}function pt(C,D,G,te,he,fe){if(fe==0)for(G=D+G;D<G;)ye(te,((fe=C[D++])[0]>>24|fe[1]>>8&65280|fe[2]<<8&16711680|fe[3]<<24)>>>0),he+=32;else n(te,he,C,D,G)}function Jt(C,D){M[D][0]=M[C+"0"],M[D][1]=M[C+"1"],M[D][2]=M[C+"2"],M[D][3]=M[C+"3"],M[D][4]=M[C+"4"],M[D][5]=M[C+"5"],M[D][6]=M[C+"6"],M[D][7]=M[C+"7"],M[D][8]=M[C+"8"],M[D][9]=M[C+"9"],M[D][10]=M[C+"10"],M[D][11]=M[C+"11"],M[D][12]=M[C+"12"],M[D][13]=M[C+"13"],M[D][14]=M[C+"0"],M[D][15]=M[C+"0"]}function Kt(C){return C==sp||C==tg||C==Ef||C==rg}function rr(){this.eb=[],this.size=this.A=this.fb=0}function Br(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function zt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new rr,this.f.kb=new Br,this.sd=null}function Wt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ur(C){return alert("todo:WebPSamplerProcessPlane"),C.T}function Re(C,D){var G=C.T,te=D.ba.f.RGBA,he=te.eb,fe=te.fb+C.ka*te.A,pe=Aa[D.ba.S],ve=C.y,je=C.O,Ce=C.f,De=C.N,Qe=C.ea,Se=C.W,Ue=D.cc,Ke=D.dc,xt=D.Mc,Xe=D.Nc,mt=C.ka,wt=C.ka+C.T,Bt=C.U,Et=Bt+1>>1;for(mt==0?pe(ve,je,null,null,Ce,De,Qe,Se,Ce,De,Qe,Se,he,fe,null,null,Bt):(pe(D.ec,D.fc,ve,je,Ue,Ke,xt,Xe,Ce,De,Qe,Se,he,fe-te.A,he,fe,Bt),++G);mt+2<wt;mt+=2)Ue=Ce,Ke=De,xt=Qe,Xe=Se,De+=C.Rc,Se+=C.Rc,fe+=2*te.A,pe(ve,(je+=2*C.fa)-C.fa,ve,je,Ue,Ke,xt,Xe,Ce,De,Qe,Se,he,fe-te.A,he,fe,Bt);return je+=C.fa,C.j+wt<C.o?(n(D.ec,D.fc,ve,je,Bt),n(D.cc,D.dc,Ce,De,Et),n(D.Mc,D.Nc,Qe,Se,Et),G--):1&wt||pe(ve,je,null,null,Ce,De,Qe,Se,Ce,De,Qe,Se,he,fe+te.A,null,null,Bt),G}function Nt(C,D,G){var te=C.F,he=[C.J];if(te!=null){var fe=C.U,pe=D.ba.S,ve=pe==np||pe==Ef;D=D.ba.f.RGBA;var je=[0],Ce=C.ka;je[0]=C.T,C.Kb&&(Ce==0?--je[0]:(--Ce,he[0]-=C.width),C.j+C.ka+C.T==C.o&&(je[0]=C.o-C.j-Ce));var De=D.eb;Ce=D.fb+Ce*D.A,C=Z0(te,he[0],C.width,fe,je,De,Ce+(ve?0:3),D.A),e(G==je),C&&Kt(pe)&&nh(De,Ce,ve,fe,je,D.A)}return 0}function Pt(C){var D=C.ma,G=D.ba.S,te=11>G,he=G==Xa||G==Il||G==np||G==Cf||G==12||Kt(G);if(D.memory=null,D.Ib=null,D.Jb=null,D.Nd=null,!uu(D.Oa,C,he?11:12))return 0;if(he&&Kt(G)&&Vr(),C.da)alert("todo:use_scaling");else{if(te){if(D.Ib=ur,C.Kb){if(G=C.U+1>>1,D.memory=a(C.U+2*G),D.memory==null)return 0;D.ec=D.memory,D.fc=0,D.cc=D.ec,D.dc=D.fc+C.U,D.Mc=D.cc,D.Nc=D.dc+G,D.Ib=Re,Vr()}}else alert("todo:EmitYUV");he&&(D.Jb=Nt,te&&nt())}if(te&&!ud){for(C=0;256>C;++C)Ta[C]=89858*(C-128)+If>>Dl,A_[C]=-22014*(C-128)+If,R2[C]=-45773*(C-128),og[C]=113618*(C-128)+If>>Dl;for(C=oh;C<cd;++C)D=76283*(C-16)+If>>Dl,T_[C-oh]=Qi(D,255),I_[C-oh]=Qi(D+8>>4,15);ud=1}return 1}function It(C){var D=C.ma,G=C.U,te=C.T;return e(!(1&C.ka)),0>=G||0>=te?0:(G=D.Ib(C,D),D.Jb!=null&&D.Jb(C,D,G),D.Dc+=G,1)}function Zt(C){C.ma.memory=null}function Ae(C,D,G,te){return q(C,8)!=47?0:(D[0]=q(C,14)+1,G[0]=q(C,14)+1,te[0]=q(C,1),q(C,3)!=0?0:!C.h)}function et(C,D){if(4>C)return C+1;var G=C-2>>1;return(2+(1&C)<<G)+q(D,G)+1}function Rt(C,D){return 120<D?D-120:1<=(G=((G=Pl[D-1])>>4)*C+(8-(15&G)))?G:1;var G}function $t(C,D,G){var te=Z(G),he=C[D+=255&te].g-8;return 0<he&&(be(G,G.u+8),te=Z(G),D+=C[D].value,D+=te&(1<<he)-1),be(G,G.u+C[D].g),C[D].value}function Qt(C,D,G){return G.g+=C.g,G.value+=C.value<<D>>>0,e(8>=G.g),C.g}function Ee(C,D,G){var te=C.xc;return e((D=te==0?0:C.vc[C.md*(G>>te)+(D>>te)])<C.Wb),C.Ya[D]}function Me(C,D,G,te){var he=C.ab,fe=C.c*D,pe=C.C;D=pe+D;var ve=G,je=te;for(te=C.Ta,G=C.Ua;0<he--;){var Ce=C.gc[he],De=pe,Qe=D,Se=ve,Ue=je,Ke=(je=te,ve=G,Ce.Ea);switch(e(De<Qe),e(Qe<=Ce.nc),Ce.hc){case 2:ki(Se,Ue,(Qe-De)*Ke,je,ve);break;case 0:var xt=De,Xe=Qe,mt=je,wt=ve,Bt=(lr=Ce).Ea;xt==0&&(jf(Se,Ue,null,null,1,mt,wt),ft(Se,Ue+1,0,0,Bt-1,mt,wt+1),Ue+=Bt,wt+=Bt,++xt);for(var Et=1<<lr.b,fr=Et-1,sr=Ne(Bt,lr.b),Wr=lr.K,lr=lr.w+(xt>>lr.b)*sr;xt<Xe;){var mn=Wr,Ps=lr,Jr=1;for(kf(Se,Ue,mt,wt-Bt,1,mt,wt);Jr<Bt;){var ir=(Jr&~fr)+Et;ir>Bt&&(ir=Bt),(0,hu[mn[Ps++]>>8&15])(Se,Ue+ +Jr,mt,wt+Jr-Bt,ir-Jr,mt,wt+Jr),Jr=ir}Ue+=Bt,wt+=Bt,++xt&fr||(lr+=sr)}Qe!=Ce.nc&&n(je,ve-Ke,je,ve+(Qe-De-1)*Ke,Ke);break;case 1:for(Ke=Se,Xe=Ue,Bt=(Se=Ce.Ea)-(wt=Se&~(mt=(Ue=1<<Ce.b)-1)),xt=Ne(Se,Ce.b),Et=Ce.K,Ce=Ce.w+(De>>Ce.b)*xt;De<Qe;){for(fr=Et,sr=Ce,Wr=new Vt,lr=Xe+wt,mn=Xe+Se;Xe<lr;)ut(fr[sr++],Wr),_f(Wr,Ke,Xe,Ue,je,ve),Xe+=Ue,ve+=Ue;Xe<mn&&(ut(fr[sr++],Wr),_f(Wr,Ke,Xe,Bt,je,ve),Xe+=Bt,ve+=Bt),++De&mt||(Ce+=xt)}break;case 3:if(Se==je&&Ue==ve&&0<Ce.b){for(Xe=je,Se=Ke=ve+(Qe-De)*Ke-(wt=(Qe-De)*Ne(Ce.Ea,Ce.b)),Ue=je,mt=ve,xt=[],wt=(Bt=wt)-1;0<=wt;--wt)xt[wt]=Ue[mt+wt];for(wt=Bt-1;0<=wt;--wt)Xe[Se+wt]=xt[wt];Xm(Ce,De,Qe,je,Ke,je,ve)}else Xm(Ce,De,Qe,Se,Ue,je,ve)}ve=te,je=G}je!=G&&n(te,G,ve,je,fe)}function Je(C,D){var G=C.V,te=C.Ba+C.c*C.C,he=D-C.C;if(e(D<=C.l.o),e(16>=he),0<he){var fe=C.l,pe=C.Ta,ve=C.Ua,je=fe.width;if(Me(C,he,G,te),he=ve=[ve],e((G=C.C)<(te=D)),e(fe.v<fe.va),te>fe.o&&(te=fe.o),G<fe.j){var Ce=fe.j-G;G=fe.j,he[0]+=Ce*je}if(G>=te?G=0:(he[0]+=4*fe.v,fe.ka=G-fe.j,fe.U=fe.va-fe.v,fe.T=te-G,G=1),G){if(ve=ve[0],11>(G=C.ca).S){var De=G.f.RGBA,Qe=(te=G.S,he=fe.U,fe=fe.T,Ce=De.eb,De.A),Se=fe;for(De=De.fb+C.Ma*De.A;0<Se--;){var Ue=pe,Ke=ve,xt=he,Xe=Ce,mt=De;switch(te){case Zm:Sf(Ue,Ke,xt,Xe,mt);break;case Xa:fu(Ue,Ke,xt,Xe,mt);break;case sp:fu(Ue,Ke,xt,Xe,mt),nh(Xe,mt,0,xt,1,0);break;case eg:th(Ue,Ke,xt,Xe,mt);break;case Il:pt(Ue,Ke,xt,Xe,mt,1);break;case tg:pt(Ue,Ke,xt,Xe,mt,1),nh(Xe,mt,0,xt,1,0);break;case np:pt(Ue,Ke,xt,Xe,mt,0);break;case Ef:pt(Ue,Ke,xt,Xe,mt,0),nh(Xe,mt,1,xt,1,0);break;case Cf:pu(Ue,Ke,xt,Xe,mt);break;case rg:pu(Ue,Ke,xt,Xe,mt),Tl(Xe,mt,xt,1,0);break;case sd:Rc(Ue,Ke,xt,Xe,mt);break;default:e(0)}ve+=je,De+=Qe}C.Ma+=fe}else alert("todo:EmitRescaledRowsYUVA");e(C.Ma<=G.height)}}C.C=D,e(C.C<=C.i)}function Ft(C){var D;if(0<C.ua)return 0;for(D=0;D<C.Wb;++D){var G=C.Ya[D].G,te=C.Ya[D].H;if(0<G[1][te[1]+0].g||0<G[2][te[2]+0].g||0<G[3][te[3]+0].g)return 0}return 1}function tr(C,D,G,te,he,fe){if(C.Z!=0){var pe=C.qd,ve=C.rd;for(e(xu[C.Z]!=null);D<G;++D)xu[C.Z](pe,ve,te,he,te,he,fe),pe=te,ve=he,he+=fe;C.qd=pe,C.rd=ve}}function Rr(C,D){var G=C.l.ma,te=G.Z==0||G.Z==1?C.l.j:C.C;if(te=C.C<te?te:C.C,e(D<=C.l.o),D>te){var he=C.l.width,fe=G.ca,pe=G.tb+he*te,ve=C.V,je=C.Ba+C.c*te,Ce=C.gc;e(C.ab==1),e(Ce[0].hc==3),Oc(Ce[0],te,D,ve,je,fe,pe),tr(G,te,D,fe,pe,he)}C.C=C.Ma=D}function Kr(C,D,G,te,he,fe,pe){var ve=C.$/te,je=C.$%te,Ce=C.m,De=C.s,Qe=G+C.$,Se=Qe;he=G+te*he;var Ue=G+te*fe,Ke=280+De.ua,xt=C.Pb?ve:16777216,Xe=0<De.ua?De.Wa:null,mt=De.wc,wt=Qe<Ue?Ee(De,je,ve):null;e(C.C<fe),e(Ue<=he);var Bt=!1;e:for(;;){for(;Bt||Qe<Ue;){var Et=0;if(ve>=xt){var fr=Qe-G;e((xt=C).Pb),xt.wd=xt.m,xt.xd=fr,0<xt.s.ua&&Be(xt.s.Wa,xt.s.vb),xt=ve+id}if(je&mt||(wt=Ee(De,je,ve)),e(wt!=null),wt.Qb&&(D[Qe]=wt.qb,Bt=!0),!Bt)if(oe(Ce),wt.jc){Et=Ce,fr=D;var sr=Qe,Wr=wt.pd[Z(Et)&nd-1];e(wt.jc),256>Wr.g?(be(Et,Et.u+Wr.g),fr[sr]=Wr.value,Et=0):(be(Et,Et.u+Wr.g-256),e(256<=Wr.value),Et=Wr.value),Et==0&&(Bt=!0)}else Et=$t(wt.G[0],wt.H[0],Ce);if(Ce.h)break;if(Bt||256>Et){if(!Bt)if(wt.nd)D[Qe]=(wt.qb|Et<<8)>>>0;else{if(oe(Ce),Bt=$t(wt.G[1],wt.H[1],Ce),oe(Ce),fr=$t(wt.G[2],wt.H[2],Ce),sr=$t(wt.G[3],wt.H[3],Ce),Ce.h)break;D[Qe]=(sr<<24|Bt<<16|Et<<8|fr)>>>0}if(Bt=!1,++Qe,++je>=te&&(je=0,++ve,pe!=null&&ve<=fe&&!(ve%16)&&pe(C,ve),Xe!=null))for(;Se<Qe;)Et=D[Se++],Xe.X[(506832829*Et&4294967295)>>>Xe.Mb]=Et}else if(280>Et){if(Et=et(Et-256,Ce),fr=$t(wt.G[4],wt.H[4],Ce),oe(Ce),fr=Rt(te,fr=et(fr,Ce)),Ce.h)break;if(Qe-G<fr||he-Qe<Et)break e;for(sr=0;sr<Et;++sr)D[Qe+sr]=D[Qe+sr-fr];for(Qe+=Et,je+=Et;je>=te;)je-=te,++ve,pe!=null&&ve<=fe&&!(ve%16)&&pe(C,ve);if(e(Qe<=he),je&mt&&(wt=Ee(De,je,ve)),Xe!=null)for(;Se<Qe;)Et=D[Se++],Xe.X[(506832829*Et&4294967295)>>>Xe.Mb]=Et}else{if(!(Et<Ke))break e;for(Bt=Et-280,e(Xe!=null);Se<Qe;)Et=D[Se++],Xe.X[(506832829*Et&4294967295)>>>Xe.Mb]=Et;Et=Qe,e(!(Bt>>>(fr=Xe).Xa)),D[Et]=fr.X[Bt],Bt=!0}Bt||e(Ce.h==de(Ce))}if(C.Pb&&Ce.h&&Qe<he)e(C.m.h),C.a=5,C.m=C.wd,C.$=C.xd,0<C.s.ua&&Be(C.s.vb,C.s.Wa);else{if(Ce.h)break e;pe?.(C,ve>fe?fe:ve),C.a=0,C.$=Qe-G}return 1}return C.a=3,0}function $s(C){e(C!=null),C.vc=null,C.yc=null,C.Ya=null;var D=C.Wa;D!=null&&(D.X=null),C.vb=null,e(C!=null)}function Ki(){var C=new Ir;return C==null?null:(C.a=0,C.xb=Mb,Jt("Predictor","VP8LPredictors"),Jt("Predictor","VP8LPredictors_C"),Jt("PredictorAdd","VP8LPredictorsAdd"),Jt("PredictorAdd","VP8LPredictorsAdd_C"),ki=ot,_f=At,Sf=Ut,fu=jt,pu=qe,Rc=rt,th=Ot,M.VP8LMapColor32b=Pc,M.VP8LMapColor8b=Sa,C)}function Ws(C,D,G,te,he){var fe=1,pe=[C],ve=[D],je=te.m,Ce=te.s,De=null,Qe=0;e:for(;;){if(G)for(;fe&&q(je,1);){var Se=pe,Ue=ve,Ke=te,xt=1,Xe=Ke.m,mt=Ke.gc[Ke.ab],wt=q(Xe,2);if(Ke.Oc&1<<wt)fe=0;else{switch(Ke.Oc|=1<<wt,mt.hc=wt,mt.Ea=Se[0],mt.nc=Ue[0],mt.K=[null],++Ke.ab,e(4>=Ke.ab),wt){case 0:case 1:mt.b=q(Xe,3)+2,xt=Ws(Ne(mt.Ea,mt.b),Ne(mt.nc,mt.b),0,Ke,mt.K),mt.K=mt.K[0];break;case 3:var Bt,Et=q(Xe,8)+1,fr=16<Et?0:4<Et?1:2<Et?2:3;if(Se[0]=Ne(mt.Ea,fr),mt.b=fr,Bt=xt=Ws(Et,1,0,Ke,mt.K)){var sr,Wr=Et,lr=mt,mn=1<<(8>>lr.b),Ps=a(mn);if(Ps==null)Bt=0;else{var Jr=lr.K[0],ir=lr.w;for(Ps[0]=lr.K[0][0],sr=1;sr<1*Wr;++sr)Ps[sr]=Ye(Jr[ir+sr],Ps[sr-1]);for(;sr<4*mn;++sr)Ps[sr]=0;lr.K[0]=null,lr.K[0]=Ps,Bt=1}}xt=Bt;break;case 2:break;default:e(0)}fe=xt}}if(pe=pe[0],ve=ve[0],fe&&q(je,1)&&!(fe=1<=(Qe=q(je,4))&&11>=Qe)){te.a=3;break e}var Yt;if(Yt=fe)t:{var Xs,Dr,nn,ts=te,Ji=pe,Ia=ve,js=Qe,Di=G,Qa=ts.m,Bi=ts.s,dn=[null],Mn=1,Qs=0,qn=Ol[js];r:for(;;){if(Di&&q(Qa,1)){var Zi=q(Qa,3)+2,Js=Ne(Ji,Zi),Dn=Ne(Ia,Zi),Ci=Js*Dn;if(!Ws(Js,Dn,0,ts,dn))break r;for(dn=dn[0],Bi.xc=Zi,Xs=0;Xs<Ci;++Xs){var rs=dn[Xs]>>8&65535;dn[Xs]=rs,rs>=Mn&&(Mn=rs+1)}}if(Qa.h)break r;for(Dr=0;5>Dr;++Dr){var $i=ih[Dr];!Dr&&0<js&&($i+=1<<js),Qs<$i&&(Qs=$i)}var Fi=o(Mn*qn,R),us=Mn,An=o(us,Y);if(An==null)var Ja=null;else e(65536>=us),Ja=An;var ui=a(Qs);if(Ja==null||ui==null||Fi==null){ts.a=1;break r}var Ar=Fi;for(Xs=nn=0;Xs<Mn;++Xs){var Lr=Ja[Xs],Bn=Lr.G,zo=Lr.H,Bl=0,No=1,Ui=0;for(Dr=0;5>Dr;++Dr){$i=ih[Dr],Bn[Dr]=Ar,zo[Dr]=nn,!Dr&&0<js&&($i+=1<<js);s:{var dd,hd=$i,cg=ts,ks=ui,Bb=Ar,$b=nn,ug=0,bu=cg.m,L_=q(bu,1);if(i(ks,0,0,hd),L_){var Fb=q(bu,1)+1,Ub=q(bu,1),dg=q(bu,Ub==0?1:8);ks[dg]=1,Fb==2&&(ks[dg=q(bu,8)]=1);var ua=1}else{var di=a(19),lp=q(bu,4)+4;if(19<lp){cg.a=3;var fd=0;break s}for(dd=0;dd<lp;++dd)di[ip[dd]]=q(bu,3);var Pf=void 0,lh=void 0,Bc=cg,hg=di,Of=hd,fg=ks,pg=0,yu=Bc.m,zb=8,qb=o(128,R);n:for(;L(qb,0,7,hg,19);){if(q(yu,1)){var M2=2+2*q(yu,3);if((Pf=2+q(yu,M2))>Of)break n}else Pf=Of;for(lh=0;lh<Of&&Pf--;){oe(yu);var Vb=qb[0+(127&Z(yu))];be(yu,yu.u+Vb.g);var pd=Vb.value;if(16>pd)fg[lh++]=pd,pd!=0&&(zb=pd);else{var D2=pd==16,B2=pd-16,$2=Af[B2],Hb=q(yu,Ll[B2])+$2;if(lh+Hb>Of)break n;for(var F2=D2?zb:0;0<Hb--;)fg[lh++]=F2}}pg=1;break n}pg||(Bc.a=3),ua=pg}(ua=ua&&!bu.h)&&(ug=L(Bb,$b,8,ks,hd)),ua&&ug!=0?fd=ug:(cg.a=3,fd=0)}if(fd==0)break r;if(No&&ng[Dr]==1&&(No=Ar[nn].g==0),Bl+=Ar[nn].g,nn+=fd,3>=Dr){var ch,mg=ui[0];for(ch=1;ch<$i;++ch)ui[ch]>mg&&(mg=ui[ch]);Ui+=mg}}if(Lr.nd=No,Lr.Qb=0,No&&(Lr.qb=(Bn[3][zo[3]+0].value<<24|Bn[1][zo[1]+0].value<<16|Bn[2][zo[2]+0].value)>>>0,Bl==0&&256>Bn[0][zo[0]+0].value&&(Lr.Qb=1,Lr.qb+=Bn[0][zo[0]+0].value<<8)),Lr.jc=!Lr.Qb&&6>Ui,Lr.jc){var cp,$c=Lr;for(cp=0;cp<nd;++cp){var vu=cp,wu=$c.pd[vu],gg=$c.G[0][$c.H[0]+vu];256<=gg.value?(wu.g=gg.g+256,wu.value=gg.value):(wu.g=0,wu.value=0,vu>>=Qt(gg,8,wu),vu>>=Qt($c.G[1][$c.H[1]+vu],16,wu),vu>>=Qt($c.G[2][$c.H[2]+vu],0,wu),Qt($c.G[3][$c.H[3]+vu],24,wu))}}}Bi.vc=dn,Bi.Wb=Mn,Bi.Ya=Ja,Bi.yc=Fi,Yt=1;break t}Yt=0}if(!(fe=Yt)){te.a=3;break e}if(0<Qe){if(Ce.ua=1<<Qe,!ce(Ce.Wa,Qe)){te.a=1,fe=0;break e}}else Ce.ua=0;var xg=te,uh=pe,U2=ve,Rf=xg.s,Mf=Rf.xc;if(xg.c=uh,xg.i=U2,Rf.md=Ne(uh,Mf),Rf.wc=Mf==0?-1:(1<<Mf)-1,G){te.xb=ad;break e}if((De=a(pe*ve))==null){te.a=1,fe=0;break e}fe=(fe=Kr(te,De,0,pe,ve,ve,null))&&!je.h;break e}return fe?(he!=null?he[0]=De:(e(De==null),e(G)),te.$=0,G||$s(Ce)):$s(Ce),fe}function Ts(C,D){var G=C.c*C.i,te=G+D+16*D;return e(C.c<=D),C.V=a(te),C.V==null?(C.Ta=null,C.Ua=0,C.a=1,0):(C.Ta=C.V,C.Ua=C.Ba+G+D,1)}function wa(C,D){var G=C.C,te=D-G,he=C.V,fe=C.Ba+C.c*G;for(e(D<=C.l.o);0<te;){var pe=16<te?16:te,ve=C.l.ma,je=C.l.width,Ce=je*pe,De=ve.ca,Qe=ve.tb+je*G,Se=C.Ta,Ue=C.Ua;Me(C,pe,he,fe),il(Se,Ue,De,Qe,Ce),tr(ve,G,G+pe,De,Qe,je),te-=pe,he+=pe*C.c,G+=pe}e(G==D),C.C=C.Ma=D}function Hn(){this.ub=this.yd=this.td=this.Rb=0}function wi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Yi(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function aa(){this.Yb=(function(){var C=[];return(function D(G,te,he){for(var fe=he[te],pe=0;pe<fe&&(G.push(he.length>te+1?[]:0),!(he.length<te+1));pe++)D(G[pe],te+1,he)})(C,0,[3,11]),C})()}function os(){this.jb=a(3),this.Wc=l([4,8],aa),this.Xc=l([4,17],aa)}function kl(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Gs(){this.ld=this.La=this.dd=this.tc=0}function Xi(){this.Na=this.la=0}function Li(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Pi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Bo(){this.uc=this.M=this.Nb=0,this.wa=Array(new Gs),this.Y=0,this.ya=Array(new Pi),this.aa=0,this.l=new oi}function _l(){this.y=a(16),this.f=a(8),this.ea=a(8)}function tc(){this.cb=this.a=0,this.sc="",this.m=new U,this.Od=new Hn,this.Kc=new wi,this.ed=new kl,this.Qa=new Yi,this.Ic=this.$c=this.Aa=0,this.D=new Bo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,U),this.ia=0,this.pb=o(4,Li),this.Pa=new os,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new _l),this.Hd=0,this.rb=Array(new Xi),this.sb=0,this.wa=Array(new Gs),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Pi),this.L=this.aa=0,this.gd=l([4,2],Gs),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qi(C,D){return 0>C?0:C>D?D:C}function oi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function xs(){var C=new tc;return C!=null&&(C.a=0,C.sc="OK",C.cb=0,C.Xb=0,al||(al=an)),C}function Yr(C,D,G){return C.a==0&&(C.a=D,C.sc=G,C.cb=0),0}function Na(C,D,G){return 3<=G&&C[D+0]==157&&C[D+1]==1&&C[D+2]==42}function li(C,D){if(C==null)return 0;if(C.a=0,C.sc="OK",D==null)return Yr(C,2,"null VP8Io passed to VP8GetHeaders()");var G=D.data,te=D.w,he=D.ha;if(4>he)return Yr(C,7,"Truncated header.");var fe=G[te+0]|G[te+1]<<8|G[te+2]<<16,pe=C.Od;if(pe.Rb=!(1&fe),pe.td=fe>>1&7,pe.yd=fe>>4&1,pe.ub=fe>>5,3<pe.td)return Yr(C,3,"Incorrect keyframe parameters.");if(!pe.yd)return Yr(C,4,"Frame not displayable.");te+=3,he-=3;var ve=C.Kc;if(pe.Rb){if(7>he)return Yr(C,7,"cannot parse picture header");if(!Na(G,te,he))return Yr(C,3,"Bad code word");ve.c=16383&(G[te+4]<<8|G[te+3]),ve.Td=G[te+4]>>6,ve.i=16383&(G[te+6]<<8|G[te+5]),ve.Ud=G[te+6]>>6,te+=7,he-=7,C.za=ve.c+15>>4,C.Ub=ve.i+15>>4,D.width=ve.c,D.height=ve.i,D.Da=0,D.j=0,D.v=0,D.va=D.width,D.o=D.height,D.da=0,D.ib=D.width,D.hb=D.height,D.U=D.width,D.T=D.height,i((fe=C.Pa).jb,0,255,fe.jb.length),e((fe=C.Qa)!=null),fe.Cb=0,fe.Bb=0,fe.Fb=1,i(fe.Zb,0,0,fe.Zb.length),i(fe.Lb,0,0,fe.Lb)}if(pe.ub>he)return Yr(C,7,"bad partition length");X(fe=C.m,G,te,pe.ub),te+=pe.ub,he-=pe.ub,pe.Rb&&(ve.Ld=H(fe),ve.Kd=H(fe)),ve=C.Qa;var je,Ce=C.Pa;if(e(fe!=null),e(ve!=null),ve.Cb=H(fe),ve.Cb){if(ve.Bb=H(fe),H(fe)){for(ve.Fb=H(fe),je=0;4>je;++je)ve.Zb[je]=H(fe)?re(fe,7):0;for(je=0;4>je;++je)ve.Lb[je]=H(fe)?re(fe,6):0}if(ve.Bb)for(je=0;3>je;++je)Ce.jb[je]=H(fe)?J(fe,8):255}else ve.Bb=0;if(fe.Ka)return Yr(C,3,"cannot parse segment header");if((ve=C.ed).zd=H(fe),ve.Tb=J(fe,6),ve.wb=J(fe,3),ve.Pc=H(fe),ve.Pc&&H(fe)){for(Ce=0;4>Ce;++Ce)H(fe)&&(ve.vd[Ce]=re(fe,6));for(Ce=0;4>Ce;++Ce)H(fe)&&(ve.od[Ce]=re(fe,6))}if(C.L=ve.Tb==0?0:ve.zd?1:2,fe.Ka)return Yr(C,3,"cannot parse filter header");var De=he;if(he=je=te,te=je+De,ve=De,C.Xb=(1<<J(C.m,2))-1,De<3*(Ce=C.Xb))G=7;else{for(je+=3*Ce,ve-=3*Ce,De=0;De<Ce;++De){var Qe=G[he+0]|G[he+1]<<8|G[he+2]<<16;Qe>ve&&(Qe=ve),X(C.Jc[+De],G,je,Qe),je+=Qe,ve-=Qe,he+=3}X(C.Jc[+Ce],G,je,ve),G=je<te?0:5}if(G!=0)return Yr(C,G,"cannot parse partitions");for(G=J(je=C.m,7),he=H(je)?re(je,4):0,te=H(je)?re(je,4):0,ve=H(je)?re(je,4):0,Ce=H(je)?re(je,4):0,je=H(je)?re(je,4):0,De=C.Qa,Qe=0;4>Qe;++Qe){if(De.Cb){var Se=De.Zb[Qe];De.Fb||(Se+=G)}else{if(0<Qe){C.pb[Qe]=C.pb[0];continue}Se=G}var Ue=C.pb[Qe];Ue.Sc[0]=Rl[Qi(Se+he,127)],Ue.Sc[1]=Ml[Qi(Se+0,127)],Ue.Eb[0]=2*Rl[Qi(Se+te,127)],Ue.Eb[1]=101581*Ml[Qi(Se+ve,127)]>>16,8>Ue.Eb[1]&&(Ue.Eb[1]=8),Ue.Qc[0]=Rl[Qi(Se+Ce,117)],Ue.Qc[1]=Ml[Qi(Se+je,127)],Ue.lc=Se+je}if(!pe.Rb)return Yr(C,4,"Not a key frame.");for(H(fe),pe=C.Pa,G=0;4>G;++G){for(he=0;8>he;++he)for(te=0;3>te;++te)for(ve=0;11>ve;++ve)Ce=le(fe,Ls[G][he][te][ve])?J(fe,8):O2[G][he][te][ve],pe.Wc[G][he].Yb[te][ve]=Ce;for(he=0;17>he;++he)pe.Xc[G][he]=pe.Wc[G][bn[he]]}return C.kc=H(fe),C.kc&&(C.Bd=J(fe,8)),C.cb=1}function an(C,D,G,te,he,fe,pe){var ve=D[he].Yb[G];for(G=0;16>he;++he){if(!le(C,ve[G+0]))return he;for(;!le(C,ve[G+1]);)if(ve=D[++he].Yb[0],G=0,he==16)return 16;var je=D[he+1].Yb;if(le(C,ve[G+2])){var Ce=C,De=0;if(le(Ce,(Se=ve)[(Qe=G)+3]))if(le(Ce,Se[Qe+6])){for(ve=0,Qe=2*(De=le(Ce,Se[Qe+8]))+(Se=le(Ce,Se[Qe+9+De])),De=0,Se=P2[Qe];Se[ve];++ve)De+=De+le(Ce,Se[ve]);De+=3+(8<<Qe)}else le(Ce,Se[Qe+7])?(De=7+2*le(Ce,165),De+=le(Ce,145)):De=5+le(Ce,159);else De=le(Ce,Se[Qe+4])?3+le(Ce,Se[Qe+5]):2;ve=je[2]}else De=1,ve=je[1];je=pe+Rb[he],0>(Ce=C).b&&ne(Ce);var Qe,Se=Ce.b,Ue=(Qe=Ce.Ca>>1)-(Ce.I>>Se)>>31;--Ce.b,Ce.Ca+=Ue,Ce.Ca|=1,Ce.I-=(Qe+1&Ue)<<Se,fe[je]=((De^Ue)-Ue)*te[(0<he)+0]}return 16}function ho(C){var D=C.rb[C.sb-1];D.la=0,D.Na=0,i(C.zc,0,0,C.zc.length),C.ja=0}function Is(C,D,G,te,he){he=C[D+G+32*te]+(he>>3),C[D+G+32*te]=-256&he?0>he?0:255:he}function Zn(C,D,G,te,he,fe){Is(C,D,0,G,te+he),Is(C,D,1,G,te+fe),Is(C,D,2,G,te-fe),Is(C,D,3,G,te-he)}function bs(C){return(20091*C>>16)+C}function tl(C,D,G,te){var he,fe=0,pe=a(16);for(he=0;4>he;++he){var ve=C[D+0]+C[D+8],je=C[D+0]-C[D+8],Ce=(35468*C[D+4]>>16)-bs(C[D+12]),De=bs(C[D+4])+(35468*C[D+12]>>16);pe[fe+0]=ve+De,pe[fe+1]=je+Ce,pe[fe+2]=je-Ce,pe[fe+3]=ve-De,fe+=4,D++}for(he=fe=0;4>he;++he)ve=(C=pe[fe+0]+4)+pe[fe+8],je=C-pe[fe+8],Ce=(35468*pe[fe+4]>>16)-bs(pe[fe+12]),Is(G,te,0,0,ve+(De=bs(pe[fe+4])+(35468*pe[fe+12]>>16))),Is(G,te,1,0,je+Ce),Is(G,te,2,0,je-Ce),Is(G,te,3,0,ve-De),fe++,te+=32}function Sl(C,D,G,te){var he=C[D+0]+4,fe=35468*C[D+4]>>16,pe=bs(C[D+4]),ve=35468*C[D+1]>>16;Zn(G,te,0,he+pe,C=bs(C[D+1]),ve),Zn(G,te,1,he+fe,C,ve),Zn(G,te,2,he-fe,C,ve),Zn(G,te,3,he-pe,C,ve)}function rc(C,D,G,te,he){tl(C,D,G,te),he&&tl(C,D+16,G,te+4)}function Ni(C,D,G,te){mu(C,D+0,G,te,1),mu(C,D+32,G,te+128,1)}function fo(C,D,G,te){var he;for(C=C[D+0]+4,he=0;4>he;++he)for(D=0;4>D;++D)Is(G,te,D,he,C)}function Ks(C,D,G,te){C[D+0]&&zn(C,D+0,G,te),C[D+16]&&zn(C,D+16,G,te+4),C[D+32]&&zn(C,D+32,G,te+128),C[D+48]&&zn(C,D+48,G,te+128+4)}function es(C,D,G,te){var he,fe=a(16);for(he=0;4>he;++he){var pe=C[D+0+he]+C[D+12+he],ve=C[D+4+he]+C[D+8+he],je=C[D+4+he]-C[D+8+he],Ce=C[D+0+he]-C[D+12+he];fe[0+he]=pe+ve,fe[8+he]=pe-ve,fe[4+he]=Ce+je,fe[12+he]=Ce-je}for(he=0;4>he;++he)pe=(C=fe[0+4*he]+3)+fe[3+4*he],ve=fe[1+4*he]+fe[2+4*he],je=fe[1+4*he]-fe[2+4*he],Ce=C-fe[3+4*he],G[te+0]=pe+ve>>3,G[te+16]=Ce+je>>3,G[te+32]=pe-ve>>3,G[te+48]=Ce-je>>3,te+=64}function Oi(C,D,G){var te,he=D-32,fe=Ya,pe=255-C[he-1];for(te=0;te<G;++te){var ve,je=fe,Ce=pe+C[D-1];for(ve=0;ve<G;++ve)C[D+ve]=je[Ce+C[he+ve]];D+=32}}function nc(C,D){Oi(C,D,4)}function oa(C,D){Oi(C,D,8)}function Cl(C,D){Oi(C,D,16)}function El(C,D){var G;for(G=0;16>G;++G)n(C,D+32*G,C,D-32,16)}function po(C,D){var G;for(G=16;0<G;--G)i(C,D,C[D-1],16),D+=32}function Ri(C,D,G){var te;for(te=0;16>te;++te)i(D,G+32*te,C,16)}function la(C,D){var G,te=16;for(G=0;16>G;++G)te+=C[D-1+32*G]+C[D+G-32];Ri(te>>5,C,D)}function ls(C,D){var G,te=8;for(G=0;16>G;++G)te+=C[D-1+32*G];Ri(te>>4,C,D)}function ji(C,D){var G,te=8;for(G=0;16>G;++G)te+=C[D+G-32];Ri(te>>4,C,D)}function mo(C,D){Ri(128,C,D)}function mr(C,D,G){return C+2*D+G+2>>2}function go(C,D){var G,te=D-32;for(te=new Uint8Array([mr(C[te-1],C[te+0],C[te+1]),mr(C[te+0],C[te+1],C[te+2]),mr(C[te+1],C[te+2],C[te+3]),mr(C[te+2],C[te+3],C[te+4])]),G=0;4>G;++G)n(C,D+32*G,te,0,te.length)}function xo(C,D){var G=C[D-1],te=C[D-1+32],he=C[D-1+64],fe=C[D-1+96];ye(C,D+0,16843009*mr(C[D-1-32],G,te)),ye(C,D+32,16843009*mr(G,te,he)),ye(C,D+64,16843009*mr(te,he,fe)),ye(C,D+96,16843009*mr(he,fe,fe))}function $o(C,D){var G,te=4;for(G=0;4>G;++G)te+=C[D+G-32]+C[D-1+32*G];for(te>>=3,G=0;4>G;++G)i(C,D+32*G,te,4)}function Fs(C,D){var G=C[D-1+0],te=C[D-1+32],he=C[D-1+64],fe=C[D-1-32],pe=C[D+0-32],ve=C[D+1-32],je=C[D+2-32],Ce=C[D+3-32];C[D+0+96]=mr(te,he,C[D-1+96]),C[D+1+96]=C[D+0+64]=mr(G,te,he),C[D+2+96]=C[D+1+64]=C[D+0+32]=mr(fe,G,te),C[D+3+96]=C[D+2+64]=C[D+1+32]=C[D+0+0]=mr(pe,fe,G),C[D+3+64]=C[D+2+32]=C[D+1+0]=mr(ve,pe,fe),C[D+3+32]=C[D+2+0]=mr(je,ve,pe),C[D+3+0]=mr(Ce,je,ve)}function ys(C,D){var G=C[D+1-32],te=C[D+2-32],he=C[D+3-32],fe=C[D+4-32],pe=C[D+5-32],ve=C[D+6-32],je=C[D+7-32];C[D+0+0]=mr(C[D+0-32],G,te),C[D+1+0]=C[D+0+32]=mr(G,te,he),C[D+2+0]=C[D+1+32]=C[D+0+64]=mr(te,he,fe),C[D+3+0]=C[D+2+32]=C[D+1+64]=C[D+0+96]=mr(he,fe,pe),C[D+3+32]=C[D+2+64]=C[D+1+96]=mr(fe,pe,ve),C[D+3+64]=C[D+2+96]=mr(pe,ve,je),C[D+3+96]=mr(ve,je,je)}function Fo(C,D){var G=C[D-1+0],te=C[D-1+32],he=C[D-1+64],fe=C[D-1-32],pe=C[D+0-32],ve=C[D+1-32],je=C[D+2-32],Ce=C[D+3-32];C[D+0+0]=C[D+1+64]=fe+pe+1>>1,C[D+1+0]=C[D+2+64]=pe+ve+1>>1,C[D+2+0]=C[D+3+64]=ve+je+1>>1,C[D+3+0]=je+Ce+1>>1,C[D+0+96]=mr(he,te,G),C[D+0+64]=mr(te,G,fe),C[D+0+32]=C[D+1+96]=mr(G,fe,pe),C[D+1+32]=C[D+2+96]=mr(fe,pe,ve),C[D+2+32]=C[D+3+96]=mr(pe,ve,je),C[D+3+32]=mr(ve,je,Ce)}function rn(C,D){var G=C[D+0-32],te=C[D+1-32],he=C[D+2-32],fe=C[D+3-32],pe=C[D+4-32],ve=C[D+5-32],je=C[D+6-32],Ce=C[D+7-32];C[D+0+0]=G+te+1>>1,C[D+1+0]=C[D+0+64]=te+he+1>>1,C[D+2+0]=C[D+1+64]=he+fe+1>>1,C[D+3+0]=C[D+2+64]=fe+pe+1>>1,C[D+0+32]=mr(G,te,he),C[D+1+32]=C[D+0+96]=mr(te,he,fe),C[D+2+32]=C[D+1+96]=mr(he,fe,pe),C[D+3+32]=C[D+2+96]=mr(fe,pe,ve),C[D+3+64]=mr(pe,ve,je),C[D+3+96]=mr(ve,je,Ce)}function Mi(C,D){var G=C[D-1+0],te=C[D-1+32],he=C[D-1+64],fe=C[D-1+96];C[D+0+0]=G+te+1>>1,C[D+2+0]=C[D+0+32]=te+he+1>>1,C[D+2+32]=C[D+0+64]=he+fe+1>>1,C[D+1+0]=mr(G,te,he),C[D+3+0]=C[D+1+32]=mr(te,he,fe),C[D+3+32]=C[D+1+64]=mr(he,fe,fe),C[D+3+64]=C[D+2+64]=C[D+0+96]=C[D+1+96]=C[D+2+96]=C[D+3+96]=fe}function bo(C,D){var G=C[D-1+0],te=C[D-1+32],he=C[D-1+64],fe=C[D-1+96],pe=C[D-1-32],ve=C[D+0-32],je=C[D+1-32],Ce=C[D+2-32];C[D+0+0]=C[D+2+32]=G+pe+1>>1,C[D+0+32]=C[D+2+64]=te+G+1>>1,C[D+0+64]=C[D+2+96]=he+te+1>>1,C[D+0+96]=fe+he+1>>1,C[D+3+0]=mr(ve,je,Ce),C[D+2+0]=mr(pe,ve,je),C[D+1+0]=C[D+3+32]=mr(G,pe,ve),C[D+1+32]=C[D+3+64]=mr(te,G,pe),C[D+1+64]=C[D+3+96]=mr(he,te,G),C[D+1+96]=mr(fe,he,te)}function ja(C,D){var G;for(G=0;8>G;++G)n(C,D+32*G,C,D-32,8)}function sc(C,D){var G;for(G=0;8>G;++G)i(C,D,C[D-1],8),D+=32}function Q(C,D,G){var te;for(te=0;8>te;++te)i(D,G+32*te,C,8)}function xe(C,D){var G,te=8;for(G=0;8>G;++G)te+=C[D+G-32]+C[D-1+32*G];Q(te>>4,C,D)}function Te(C,D){var G,te=4;for(G=0;8>G;++G)te+=C[D+G-32];Q(te>>3,C,D)}function dt(C,D){var G,te=4;for(G=0;8>G;++G)te+=C[D-1+32*G];Q(te>>3,C,D)}function _r(C,D){Q(128,C,D)}function er(C,D,G){var te=C[D-G],he=C[D+0],fe=3*(he-te)+gu[1020+C[D-2*G]-C[D+G]],pe=rp[112+(fe+4>>3)];C[D-G]=Ya[255+te+rp[112+(fe+3>>3)]],C[D+0]=Ya[255+he-pe]}function Hr(C,D,G,te){var he=C[D+0],fe=C[D+G];return Ca[255+C[D-2*G]-C[D-G]]>te||Ca[255+fe-he]>te}function Xr(C,D,G,te){return 4*Ca[255+C[D-G]-C[D+0]]+Ca[255+C[D-2*G]-C[D+G]]<=te}function Cn(C,D,G,te,he){var fe=C[D-3*G],pe=C[D-2*G],ve=C[D-G],je=C[D+0],Ce=C[D+G],De=C[D+2*G],Qe=C[D+3*G];return 4*Ca[255+ve-je]+Ca[255+pe-Ce]>te?0:Ca[255+C[D-4*G]-fe]<=he&&Ca[255+fe-pe]<=he&&Ca[255+pe-ve]<=he&&Ca[255+Qe-De]<=he&&Ca[255+De-Ce]<=he&&Ca[255+Ce-je]<=he}function Qr(C,D,G,te){var he=2*te+1;for(te=0;16>te;++te)Xr(C,D+te,G,he)&&er(C,D+te,G)}function Un(C,D,G,te){var he=2*te+1;for(te=0;16>te;++te)Xr(C,D+te*G,1,he)&&er(C,D+te*G,1)}function Us(C,D,G,te){var he;for(he=3;0<he;--he)Qr(C,D+=4*G,G,te)}function ss(C,D,G,te){var he;for(he=3;0<he;--he)Un(C,D+=4,G,te)}function Rn(C,D,G,te,he,fe,pe,ve){for(fe=2*fe+1;0<he--;){if(Cn(C,D,G,fe,pe))if(Hr(C,D,G,ve))er(C,D,G);else{var je=C,Ce=D,De=G,Qe=je[Ce-2*De],Se=je[Ce-De],Ue=je[Ce+0],Ke=je[Ce+De],xt=je[Ce+2*De],Xe=27*(wt=gu[1020+3*(Ue-Se)+gu[1020+Qe-Ke]])+63>>7,mt=18*wt+63>>7,wt=9*wt+63>>7;je[Ce-3*De]=Ya[255+je[Ce-3*De]+wt],je[Ce-2*De]=Ya[255+Qe+mt],je[Ce-De]=Ya[255+Se+Xe],je[Ce+0]=Ya[255+Ue-Xe],je[Ce+De]=Ya[255+Ke-mt],je[Ce+2*De]=Ya[255+xt-wt]}D+=te}}function Wn(C,D,G,te,he,fe,pe,ve){for(fe=2*fe+1;0<he--;){if(Cn(C,D,G,fe,pe))if(Hr(C,D,G,ve))er(C,D,G);else{var je=C,Ce=D,De=G,Qe=je[Ce-De],Se=je[Ce+0],Ue=je[Ce+De],Ke=rp[112+(4+(xt=3*(Se-Qe))>>3)],xt=rp[112+(xt+3>>3)],Xe=Ke+1>>1;je[Ce-2*De]=Ya[255+je[Ce-2*De]+Xe],je[Ce-De]=Ya[255+Qe+xt],je[Ce+0]=Ya[255+Se-Ke],je[Ce+De]=Ya[255+Ue-Xe]}D+=te}}function Wa(C,D,G,te,he,fe){Rn(C,D,G,1,16,te,he,fe)}function Ys(C,D,G,te,he,fe){Rn(C,D,1,G,16,te,he,fe)}function Ga(C,D,G,te,he,fe){var pe;for(pe=3;0<pe;--pe)Wn(C,D+=4*G,G,1,16,te,he,fe)}function z(C,D,G,te,he,fe){var pe;for(pe=3;0<pe;--pe)Wn(C,D+=4,1,G,16,te,he,fe)}function ue(C,D,G,te,he,fe,pe,ve){Rn(C,D,he,1,8,fe,pe,ve),Rn(G,te,he,1,8,fe,pe,ve)}function _e(C,D,G,te,he,fe,pe,ve){Rn(C,D,1,he,8,fe,pe,ve),Rn(G,te,1,he,8,fe,pe,ve)}function Oe(C,D,G,te,he,fe,pe,ve){Wn(C,D+4*he,he,1,8,fe,pe,ve),Wn(G,te+4*he,he,1,8,fe,pe,ve)}function ze(C,D,G,te,he,fe,pe,ve){Wn(C,D+4,1,he,8,fe,pe,ve),Wn(G,te+4,1,he,8,fe,pe,ve)}function bt(){this.ba=new zt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Tt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function or(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function hr(){this.ua=0,this.Wa=new ct,this.vb=new ct,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Y,this.yc=new R}function Ir(){this.xb=this.a=0,this.l=new oi,this.ca=new zt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new W,this.Pb=0,this.wd=new W,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new hr,this.ab=0,this.gc=o(4,or),this.Oc=0}function Sr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new oi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function pn(C,D,G,te,he,fe,pe){for(C=C==null?0:C[D+0],D=0;D<pe;++D)he[fe+D]=C+G[te+D]&255,C=he[fe+D]}function vs(C,D,G,te,he,fe,pe){var ve;if(C==null)pn(null,null,G,te,he,fe,pe);else for(ve=0;ve<pe;++ve)he[fe+ve]=C[D+ve]+G[te+ve]&255}function is(C,D,G,te,he,fe,pe){if(C==null)pn(null,null,G,te,he,fe,pe);else{var ve,je=C[D+0],Ce=je,De=je;for(ve=0;ve<pe;++ve)Ce=De+(je=C[D+ve])-Ce,De=G[te+ve]+(-256&Ce?0>Ce?0:255:Ce)&255,Ce=je,he[fe+ve]=De}}function A(C,D,G,te){var he=D.width,fe=D.o;if(e(C!=null&&D!=null),0>G||0>=te||G+te>fe)return null;if(!C.Cc){if(C.ga==null){var pe;if(C.ga=new Sr,(pe=C.ga==null)||(pe=D.width*D.o,e(C.Gb.length==0),C.Gb=a(pe),C.Uc=0,C.Gb==null?pe=0:(C.mb=C.Gb,C.nb=C.Uc,C.rc=null,pe=1),pe=!pe),!pe){pe=C.ga;var ve=C.Fa,je=C.P,Ce=C.qc,De=C.mb,Qe=C.nb,Se=je+1,Ue=Ce-1,Ke=pe.l;if(e(ve!=null&&De!=null&&D!=null),xu[0]=null,xu[1]=pn,xu[2]=vs,xu[3]=is,pe.ca=De,pe.tb=Qe,pe.c=D.width,pe.i=D.height,e(0<pe.c&&0<pe.i),1>=Ce)D=0;else if(pe.$a=3&ve[je+0],pe.Z=ve[je+0]>>2&3,pe.Lc=ve[je+0]>>4&3,je=ve[je+0]>>6&3,0>pe.$a||1<pe.$a||4<=pe.Z||1<pe.Lc||je)D=0;else if(Ke.put=It,Ke.ac=Pt,Ke.bc=Zt,Ke.ma=pe,Ke.width=D.width,Ke.height=D.height,Ke.Da=D.Da,Ke.v=D.v,Ke.va=D.va,Ke.j=D.j,Ke.o=D.o,pe.$a)e:{e(pe.$a==1),D=Ki();t:for(;;){if(D==null){D=0;break e}if(e(pe!=null),pe.mc=D,D.c=pe.c,D.i=pe.i,D.l=pe.l,D.l.ma=pe,D.l.width=pe.c,D.l.height=pe.i,D.a=0,se(D.m,ve,Se,Ue),!Ws(pe.c,pe.i,1,D,null)||(D.ab==1&&D.gc[0].hc==3&&Ft(D.s)?(pe.ic=1,ve=D.c*D.i,D.Ta=null,D.Ua=0,D.V=a(ve),D.Ba=0,D.V==null?(D.a=1,D=0):D=1):(pe.ic=0,D=Ts(D,pe.c)),!D))break t;D=1;break e}pe.mc=null,D=0}else D=Ue>=pe.c*pe.i;pe=!D}if(pe)return null;C.ga.Lc!=1?C.Ga=0:te=fe-G}e(C.ga!=null),e(G+te<=fe);e:{if(D=(ve=C.ga).c,fe=ve.l.o,ve.$a==0){if(Se=C.rc,Ue=C.Vc,Ke=C.Fa,je=C.P+1+G*D,Ce=C.mb,De=C.nb+G*D,e(je<=C.P+C.qc),ve.Z!=0)for(e(xu[ve.Z]!=null),pe=0;pe<te;++pe)xu[ve.Z](Se,Ue,Ke,je,Ce,De,D),Se=Ce,Ue=De,De+=D,je+=D;else for(pe=0;pe<te;++pe)n(Ce,De,Ke,je,D),Se=Ce,Ue=De,De+=D,je+=D;C.rc=Se,C.Vc=Ue}else{if(e(ve.mc!=null),D=G+te,e((pe=ve.mc)!=null),e(D<=pe.i),pe.C>=D)D=1;else if(ve.ic||nt(),ve.ic){ve=pe.V,Se=pe.Ba,Ue=pe.c;var xt=pe.i,Xe=(Ke=1,je=pe.$/Ue,Ce=pe.$%Ue,De=pe.m,Qe=pe.s,pe.$),mt=Ue*xt,wt=Ue*D,Bt=Qe.wc,Et=Xe<wt?Ee(Qe,Ce,je):null;e(Xe<=mt),e(D<=xt),e(Ft(Qe));t:for(;;){for(;!De.h&&Xe<wt;){if(Ce&Bt||(Et=Ee(Qe,Ce,je)),e(Et!=null),oe(De),256>(xt=$t(Et.G[0],Et.H[0],De)))ve[Se+Xe]=xt,++Xe,++Ce>=Ue&&(Ce=0,++je<=D&&!(je%16)&&Rr(pe,je));else{if(!(280>xt)){Ke=0;break t}xt=et(xt-256,De);var fr,sr=$t(Et.G[4],Et.H[4],De);if(oe(De),!(Xe>=(sr=Rt(Ue,sr=et(sr,De)))&&mt-Xe>=xt)){Ke=0;break t}for(fr=0;fr<xt;++fr)ve[Se+Xe+fr]=ve[Se+Xe+fr-sr];for(Xe+=xt,Ce+=xt;Ce>=Ue;)Ce-=Ue,++je<=D&&!(je%16)&&Rr(pe,je);Xe<wt&&Ce&Bt&&(Et=Ee(Qe,Ce,je))}e(De.h==de(De))}Rr(pe,je>D?D:je);break t}!Ke||De.h&&Xe<mt?(Ke=0,pe.a=De.h?5:3):pe.$=Xe,D=Ke}else D=Kr(pe,pe.V,pe.Ba,pe.c,pe.i,D,wa);if(!D){te=0;break e}}G+te>=fe&&(C.Cc=1),te=1}if(!te)return null;if(C.Cc&&((te=C.ga)!=null&&(te.mc=null),C.ga=null,0<C.Ga))return alert("todo:WebPDequantizeLevels"),null}return C.nb+G*he}function K(C,D,G,te,he,fe){for(;0<he--;){var pe,ve=C,je=D+(G?1:0),Ce=C,De=D+(G?0:3);for(pe=0;pe<te;++pe){var Qe=Ce[De+4*pe];Qe!=255&&(Qe*=32897,ve[je+4*pe+0]=ve[je+4*pe+0]*Qe>>23,ve[je+4*pe+1]=ve[je+4*pe+1]*Qe>>23,ve[je+4*pe+2]=ve[je+4*pe+2]*Qe>>23)}D+=fe}}function ae(C,D,G,te,he){for(;0<te--;){var fe;for(fe=0;fe<G;++fe){var pe=C[D+2*fe+0],ve=15&(Ce=C[D+2*fe+1]),je=4369*ve,Ce=(240&Ce|Ce>>4)*je>>16;C[D+2*fe+0]=(240&pe|pe>>4)*je>>16&240|(15&pe|pe<<4)*je>>16>>4&15,C[D+2*fe+1]=240&Ce|ve}D+=he}}function we(C,D,G,te,he,fe,pe,ve){var je,Ce,De=255;for(Ce=0;Ce<he;++Ce){for(je=0;je<te;++je){var Qe=C[D+je];fe[pe+4*je]=Qe,De&=Qe}D+=G,pe+=ve}return De!=255}function We(C,D,G,te,he){var fe;for(fe=0;fe<he;++fe)G[te+fe]=C[D+fe]>>8}function nt(){nh=K,Tl=ae,Z0=we,il=We}function Ht(C,D,G){M[C]=function(te,he,fe,pe,ve,je,Ce,De,Qe,Se,Ue,Ke,xt,Xe,mt,wt,Bt){var Et,fr=Bt-1>>1,sr=ve[je+0]|Ce[De+0]<<16,Wr=Qe[Se+0]|Ue[Ke+0]<<16;e(te!=null);var lr=3*sr+Wr+131074>>2;for(D(te[he+0],255&lr,lr>>16,xt,Xe),fe!=null&&(lr=3*Wr+sr+131074>>2,D(fe[pe+0],255&lr,lr>>16,mt,wt)),Et=1;Et<=fr;++Et){var mn=ve[je+Et]|Ce[De+Et]<<16,Ps=Qe[Se+Et]|Ue[Ke+Et]<<16,Jr=sr+mn+Wr+Ps+524296,ir=Jr+2*(mn+Wr)>>3;lr=ir+sr>>1,sr=(Jr=Jr+2*(sr+Ps)>>3)+mn>>1,D(te[he+2*Et-1],255&lr,lr>>16,xt,Xe+(2*Et-1)*G),D(te[he+2*Et-0],255&sr,sr>>16,xt,Xe+(2*Et-0)*G),fe!=null&&(lr=Jr+Wr>>1,sr=ir+Ps>>1,D(fe[pe+2*Et-1],255&lr,lr>>16,mt,wt+(2*Et-1)*G),D(fe[pe+2*Et+0],255&sr,sr>>16,mt,wt+(2*Et+0)*G)),sr=mn,Wr=Ps}1&Bt||(lr=3*sr+Wr+131074>>2,D(te[he+Bt-1],255&lr,lr>>16,xt,Xe+(Bt-1)*G),fe!=null&&(lr=3*Wr+sr+131074>>2,D(fe[pe+Bt-1],255&lr,lr>>16,mt,wt+(Bt-1)*G)))}}function Vr(){Aa[Zm]=ah,Aa[Xa]=Tf,Aa[eg]=Db,Aa[Il]=ig,Aa[np]=od,Aa[Cf]=Dc,Aa[sd]=ld,Aa[sp]=Tf,Aa[tg]=ig,Aa[Ef]=od,Aa[rg]=Dc}function ws(C){return C&-16384?0>C?0:255:C>>ag}function un(C,D){return ws((19077*C>>8)+(26149*D>>8)-14234)}function Gn(C,D,G){return ws((19077*C>>8)-(6419*D>>8)-(13320*G>>8)+8708)}function ca(C,D){return ws((19077*C>>8)+(33050*D>>8)-17685)}function ka(C,D,G,te,he){te[he+0]=un(C,G),te[he+1]=Gn(C,D,G),te[he+2]=ca(C,D)}function cs(C,D,G,te,he){te[he+0]=ca(C,D),te[he+1]=Gn(C,D,G),te[he+2]=un(C,G)}function _a(C,D,G,te,he){var fe=Gn(C,D,G);D=fe<<3&224|ca(C,D)>>3,te[he+0]=248&un(C,G)|fe>>5,te[he+1]=D}function rl(C,D,G,te,he){var fe=240&ca(C,D)|15;te[he+0]=240&un(C,G)|Gn(C,D,G)>>4,te[he+1]=fe}function Ac(C,D,G,te,he){te[he+0]=255,ka(C,D,G,te,he+1)}function Tc(C,D,G,te,he){cs(C,D,G,te,he),te[he+3]=255}function yo(C,D,G,te,he){ka(C,D,G,te,he),te[he+3]=255}function cu(C,D,G){M[C]=function(te,he,fe,pe,ve,je,Ce,De,Qe){for(var Se=De+(-2&Qe)*G;De!=Se;)D(te[he+0],fe[pe+0],ve[je+0],Ce,De),D(te[he+1],fe[pe+0],ve[je+0],Ce,De+G),he+=2,++pe,++je,De+=2*G;1&Qe&&D(te[he+0],fe[pe+0],ve[je+0],Ce,De)}}function Nf(C,D,G){return G==0?C==0?D==0?6:5:D==0?4:0:G}function X0(C,D,G,te,he){switch(C>>>30){case 3:mu(D,G,te,he,0);break;case 2:Ka(D,G,te,he);break;case 1:zn(D,G,te,he)}}function nl(C,D){var G,te,he=D.M,fe=D.Nb,pe=C.oc,ve=C.pc+40,je=C.oc,Ce=C.pc+584,De=C.oc,Qe=C.pc+600;for(G=0;16>G;++G)pe[ve+32*G-1]=129;for(G=0;8>G;++G)je[Ce+32*G-1]=129,De[Qe+32*G-1]=129;for(0<he?pe[ve-1-32]=je[Ce-1-32]=De[Qe-1-32]=129:(i(pe,ve-32-1,127,21),i(je,Ce-32-1,127,9),i(De,Qe-32-1,127,9)),te=0;te<C.za;++te){var Se=D.ya[D.aa+te];if(0<te){for(G=-1;16>G;++G)n(pe,ve+32*G-4,pe,ve+32*G+12,4);for(G=-1;8>G;++G)n(je,Ce+32*G-4,je,Ce+32*G+4,4),n(De,Qe+32*G-4,De,Qe+32*G+4,4)}var Ue=C.Gd,Ke=C.Hd+te,xt=Se.ad,Xe=Se.Hc;if(0<he&&(n(pe,ve-32,Ue[Ke].y,0,16),n(je,Ce-32,Ue[Ke].f,0,8),n(De,Qe-32,Ue[Ke].ea,0,8)),Se.Za){var mt=pe,wt=ve-32+16;for(0<he&&(te>=C.za-1?i(mt,wt,Ue[Ke].y[15],4):n(mt,wt,Ue[Ke+1].y,0,4)),G=0;4>G;G++)mt[wt+128+G]=mt[wt+256+G]=mt[wt+384+G]=mt[wt+0+G];for(G=0;16>G;++G,Xe<<=2)mt=pe,wt=ve+Si[G],ci[Se.Ob[G]](mt,wt),X0(Xe,xt,16*+G,mt,wt)}else if(mt=Nf(te,he,Se.Ob[0]),wo[mt](pe,ve),Xe!=0)for(G=0;16>G;++G,Xe<<=2)X0(Xe,xt,16*+G,pe,ve+Si[G]);for(G=Se.Gc,mt=Nf(te,he,Se.Dd),lc[mt](je,Ce),lc[mt](De,Qe),Xe=xt,mt=je,wt=Ce,255&(Se=0|G)&&(170&Se?Al(Xe,256,mt,wt):En(Xe,256,mt,wt)),Se=De,Xe=Qe,255&(G>>=8)&&(170&G?Al(xt,320,Se,Xe):En(xt,320,Se,Xe)),he<C.Ub-1&&(n(Ue[Ke].y,0,pe,ve+480,16),n(Ue[Ke].f,0,je,Ce+224,8),n(Ue[Ke].ea,0,De,Qe+224,8)),G=8*fe*C.B,Ue=C.sa,Ke=C.ta+16*te+16*fe*C.R,xt=C.qa,Se=C.ra+8*te+G,Xe=C.Ha,mt=C.Ia+8*te+G,G=0;16>G;++G)n(Ue,Ke+G*C.R,pe,ve+32*G,16);for(G=0;8>G;++G)n(xt,Se+G*C.B,je,Ce+32*G,8),n(Xe,mt+G*C.B,De,Qe+32*G,8)}}function ic(C,D,G,te,he,fe,pe,ve,je){var Ce=[0],De=[0],Qe=0,Se=je!=null?je.kd:0,Ue=je??new Tt;if(C==null||12>G)return 7;Ue.data=C,Ue.w=D,Ue.ha=G,D=[D],G=[G],Ue.gb=[Ue.gb];e:{var Ke=D,xt=G,Xe=Ue.gb;if(e(C!=null),e(xt!=null),e(Xe!=null),Xe[0]=0,12<=xt[0]&&!r(C,Ke[0],"RIFF")){if(r(C,Ke[0]+8,"WEBP")){Xe=3;break e}var mt=Ie(C,Ke[0]+4);if(12>mt||4294967286<mt){Xe=3;break e}if(Se&&mt>xt[0]-8){Xe=7;break e}Xe[0]=mt,Ke[0]+=12,xt[0]-=12}Xe=0}if(Xe!=0)return Xe;for(mt=0<Ue.gb[0],G=G[0];;){e:{var wt=C;xt=D,Xe=G;var Bt=Ce,Et=De,fr=Ke=[0];if((lr=Qe=[Qe])[0]=0,8>Xe[0])Xe=7;else{if(!r(wt,xt[0],"VP8X")){if(Ie(wt,xt[0]+4)!=10){Xe=3;break e}if(18>Xe[0]){Xe=7;break e}var sr=Ie(wt,xt[0]+8),Wr=1+ke(wt,xt[0]+12);if(2147483648<=Wr*(wt=1+ke(wt,xt[0]+15))){Xe=3;break e}fr!=null&&(fr[0]=sr),Bt!=null&&(Bt[0]=Wr),Et!=null&&(Et[0]=wt),xt[0]+=18,Xe[0]-=18,lr[0]=1}Xe=0}}if(Qe=Qe[0],Ke=Ke[0],Xe!=0)return Xe;if(xt=!!(2&Ke),!mt&&Qe)return 3;if(fe!=null&&(fe[0]=!!(16&Ke)),pe!=null&&(pe[0]=xt),ve!=null&&(ve[0]=0),pe=Ce[0],Ke=De[0],Qe&&xt&&je==null){Xe=0;break}if(4>G){Xe=7;break}if(mt&&Qe||!mt&&!Qe&&!r(C,D[0],"ALPH")){G=[G],Ue.na=[Ue.na],Ue.P=[Ue.P],Ue.Sa=[Ue.Sa];e:{sr=C,Xe=D,mt=G;var lr=Ue.gb;Bt=Ue.na,Et=Ue.P,fr=Ue.Sa,Wr=22,e(sr!=null),e(mt!=null),wt=Xe[0];var mn=mt[0];for(e(Bt!=null),e(fr!=null),Bt[0]=null,Et[0]=null,fr[0]=0;;){if(Xe[0]=wt,mt[0]=mn,8>mn){Xe=7;break e}var Ps=Ie(sr,wt+4);if(4294967286<Ps){Xe=3;break e}var Jr=8+Ps+1&-2;if(Wr+=Jr,0<lr&&Wr>lr){Xe=3;break e}if(!r(sr,wt,"VP8 ")||!r(sr,wt,"VP8L")){Xe=0;break e}if(mn[0]<Jr){Xe=7;break e}r(sr,wt,"ALPH")||(Bt[0]=sr,Et[0]=wt+8,fr[0]=Ps),wt+=Jr,mn-=Jr}}if(G=G[0],Ue.na=Ue.na[0],Ue.P=Ue.P[0],Ue.Sa=Ue.Sa[0],Xe!=0)break}G=[G],Ue.Ja=[Ue.Ja],Ue.xa=[Ue.xa];e:if(lr=C,Xe=D,mt=G,Bt=Ue.gb[0],Et=Ue.Ja,fr=Ue.xa,sr=Xe[0],wt=!r(lr,sr,"VP8 "),Wr=!r(lr,sr,"VP8L"),e(lr!=null),e(mt!=null),e(Et!=null),e(fr!=null),8>mt[0])Xe=7;else{if(wt||Wr){if(lr=Ie(lr,sr+4),12<=Bt&&lr>Bt-12){Xe=3;break e}if(Se&&lr>mt[0]-8){Xe=7;break e}Et[0]=lr,Xe[0]+=8,mt[0]-=8,fr[0]=Wr}else fr[0]=5<=mt[0]&&lr[sr+0]==47&&!(lr[sr+4]>>5),Et[0]=mt[0];Xe=0}if(G=G[0],Ue.Ja=Ue.Ja[0],Ue.xa=Ue.xa[0],D=D[0],Xe!=0)break;if(4294967286<Ue.Ja)return 3;if(ve==null||xt||(ve[0]=Ue.xa?2:1),pe=[pe],Ke=[Ke],Ue.xa){if(5>G){Xe=7;break}ve=pe,Se=Ke,xt=fe,C==null||5>G?C=0:5<=G&&C[D+0]==47&&!(C[D+4]>>5)?(mt=[0],lr=[0],Bt=[0],se(Et=new W,C,D,G),Ae(Et,mt,lr,Bt)?(ve!=null&&(ve[0]=mt[0]),Se!=null&&(Se[0]=lr[0]),xt!=null&&(xt[0]=Bt[0]),C=1):C=0):C=0}else{if(10>G){Xe=7;break}ve=Ke,C==null||10>G||!Na(C,D+3,G-3)?C=0:(Se=C[D+0]|C[D+1]<<8|C[D+2]<<16,xt=16383&(C[D+7]<<8|C[D+6]),C=16383&(C[D+9]<<8|C[D+8]),1&Se||3<(Se>>1&7)||!(Se>>4&1)||Se>>5>=Ue.Ja||!xt||!C?C=0:(pe&&(pe[0]=xt),ve&&(ve[0]=C),C=1))}if(!C||(pe=pe[0],Ke=Ke[0],Qe&&(Ce[0]!=pe||De[0]!=Ke)))return 3;je!=null&&(je[0]=Ue,je.offset=D-je.w,e(4294967286>D-je.w),e(je.offset==je.ha-G));break}return Xe==0||Xe==7&&Qe&&je==null?(fe!=null&&(fe[0]|=Ue.na!=null&&0<Ue.na.length),te!=null&&(te[0]=pe),he!=null&&(he[0]=Ke),0):Xe}function uu(C,D,G){var te=D.width,he=D.height,fe=0,pe=0,ve=te,je=he;if(D.Da=C!=null&&0<C.Da,D.Da&&(ve=C.cd,je=C.bd,fe=C.v,pe=C.j,11>G||(fe&=-2,pe&=-2),0>fe||0>pe||0>=ve||0>=je||fe+ve>te||pe+je>he))return 0;if(D.v=fe,D.j=pe,D.va=fe+ve,D.o=pe+je,D.U=ve,D.T=je,D.da=C!=null&&0<C.da,D.da){if(!Ve(ve,je,G=[C.ib],fe=[C.hb]))return 0;D.ib=G[0],D.hb=fe[0]}return D.ob=C!=null&&C.ob,D.Kb=C==null||!C.Sd,D.da&&(D.ob=D.ib<3*te/4&&D.hb<3*he/4,D.Kb=0),1}function Q0(C){if(C==null)return 2;if(11>C.S){var D=C.f.RGBA;D.fb+=(C.height-1)*D.A,D.A=-D.A}else D=C.f.kb,C=C.height,D.O+=(C-1)*D.fa,D.fa=-D.fa,D.N+=(C-1>>1)*D.Ab,D.Ab=-D.Ab,D.W+=(C-1>>1)*D.Db,D.Db=-D.Db,D.F!=null&&(D.J+=(C-1)*D.lb,D.lb=-D.lb);return 0}function ac(C,D,G,te){if(te==null||0>=C||0>=D)return 2;if(G!=null){if(G.Da){var he=G.cd,fe=G.bd,pe=-2&G.v,ve=-2&G.j;if(0>pe||0>ve||0>=he||0>=fe||pe+he>C||ve+fe>D)return 2;C=he,D=fe}if(G.da){if(!Ve(C,D,he=[G.ib],fe=[G.hb]))return 2;C=he[0],D=fe[0]}}te.width=C,te.height=D;e:{var je=te.width,Ce=te.height;if(C=te.S,0>=je||0>=Ce||!(C>=Zm&&13>C))C=2;else{if(0>=te.Rd&&te.sd==null){pe=fe=he=D=0;var De=(ve=je*lg[C])*Ce;if(11>C||(fe=(Ce+1)/2*(D=(je+1)/2),C==12&&(pe=(he=je)*Ce)),(Ce=a(De+2*fe+pe))==null){C=1;break e}te.sd=Ce,11>C?((je=te.f.RGBA).eb=Ce,je.fb=0,je.A=ve,je.size=De):((je=te.f.kb).y=Ce,je.O=0,je.fa=ve,je.Fd=De,je.f=Ce,je.N=0+De,je.Ab=D,je.Cd=fe,je.ea=Ce,je.W=0+De+fe,je.Db=D,je.Ed=fe,C==12&&(je.F=Ce,je.J=0+De+2*fe),je.Tc=pe,je.lb=he)}if(D=1,he=te.S,fe=te.width,pe=te.height,he>=Zm&&13>he)if(11>he)C=te.f.RGBA,D&=(ve=Math.abs(C.A))*(pe-1)+fe<=C.size,D&=ve>=fe*lg[he],D&=C.eb!=null;else{C=te.f.kb,ve=(fe+1)/2,De=(pe+1)/2,je=Math.abs(C.fa),Ce=Math.abs(C.Ab);var Qe=Math.abs(C.Db),Se=Math.abs(C.lb),Ue=Se*(pe-1)+fe;D&=je*(pe-1)+fe<=C.Fd,D&=Ce*(De-1)+ve<=C.Cd,D=(D&=Qe*(De-1)+ve<=C.Ed)&je>=fe&Ce>=ve&Qe>=ve,D&=C.y!=null,D&=C.f!=null,D&=C.ea!=null,he==12&&(D&=Se>=fe,D&=Ue<=C.Tc,D&=C.F!=null)}else D=0;C=D?0:2}}return C!=0||G!=null&&G.fd&&(C=Q0(te)),C}var nd=64,Uo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],vo=24,Ic=32,Lc=8,du=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];St("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(C){return C},M.Predictor2=function(C,D,G){return D[G+0]},M.Predictor3=function(C,D,G){return D[G+1]},M.Predictor4=function(C,D,G){return D[G-1]},M.Predictor5=function(C,D,G){return Lt(Lt(C,D[G+1]),D[G+0])},M.Predictor6=function(C,D,G){return Lt(C,D[G-1])},M.Predictor7=function(C,D,G){return Lt(C,D[G+0])},M.Predictor8=function(C,D,G){return Lt(D[G-1],D[G+0])},M.Predictor9=function(C,D,G){return Lt(D[G+0],D[G+1])},M.Predictor10=function(C,D,G){return Lt(Lt(C,D[G-1]),Lt(D[G+0],D[G+1]))},M.Predictor11=function(C,D,G){var te=D[G+0];return 0>=vt(te>>24&255,C>>24&255,(D=D[G-1])>>24&255)+vt(te>>16&255,C>>16&255,D>>16&255)+vt(te>>8&255,C>>8&255,D>>8&255)+vt(255&te,255&C,255&D)?te:C},M.Predictor12=function(C,D,G){var te=D[G+0];return(at((C>>24&255)+(te>>24&255)-((D=D[G-1])>>24&255))<<24|at((C>>16&255)+(te>>16&255)-(D>>16&255))<<16|at((C>>8&255)+(te>>8&255)-(D>>8&255))<<8|at((255&C)+(255&te)-(255&D)))>>>0},M.Predictor13=function(C,D,G){var te=D[G-1];return(gt((C=Lt(C,D[G+0]))>>24&255,te>>24&255)<<24|gt(C>>16&255,te>>16&255)<<16|gt(C>>8&255,te>>8&255)<<8|gt(255&C,255&te))>>>0};var jf=M.PredictorAdd0;M.PredictorAdd1=ft,St("Predictor2","PredictorAdd2"),St("Predictor3","PredictorAdd3"),St("Predictor4","PredictorAdd4"),St("Predictor5","PredictorAdd5"),St("Predictor6","PredictorAdd6"),St("Predictor7","PredictorAdd7"),St("Predictor8","PredictorAdd8"),St("Predictor9","PredictorAdd9"),St("Predictor10","PredictorAdd10"),St("Predictor11","PredictorAdd11"),St("Predictor12","PredictorAdd12"),St("Predictor13","PredictorAdd13");var kf=M.PredictorAdd2;Fe("ColorIndexInverseTransform","MapARGB","32b",function(C){return C>>8&255},function(C){return C}),Fe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(C){return C},function(C){return C>>8&255});var ki,Xm=M.ColorIndexInverseTransform,Pc=M.MapARGB,Oc=M.VP8LColorIndexInverseTransformAlpha,Sa=M.MapAlpha,hu=M.VP8LPredictorsAdd=[];hu.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var _f,Sf,fu,pu,Rc,th,sl,mu,Ka,Al,zn,En,Ns,_i,Mc,oc,rh,J0,Lb,T2,I2,L2,Pb,Ob,nh,Tl,Z0,il,sh=a(511),Qm=a(2041),ep=a(225),tp=a(767),Jm=0,gu=Qm,rp=ep,Ya=tp,Ca=sh,Zm=0,Xa=1,eg=2,Il=3,np=4,Cf=5,sd=6,sp=7,tg=8,Ef=9,rg=10,Ll=[2,3,7],Af=[3,3,11],ih=[280,256,256,256,40],ng=[0,1,1,1,0],ip=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Pl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ol=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],id=8,Rl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ml=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],al=null,P2=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Rb=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],O2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ea=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ls=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],bn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],wo=[],ci=[],lc=[],ad=1,Mb=2,xu=[],Aa=[];Ht("UpsampleRgbLinePair",ka,3),Ht("UpsampleBgrLinePair",cs,3),Ht("UpsampleRgbaLinePair",yo,4),Ht("UpsampleBgraLinePair",Tc,4),Ht("UpsampleArgbLinePair",Ac,4),Ht("UpsampleRgba4444LinePair",rl,2),Ht("UpsampleRgb565LinePair",_a,2);var ah=M.UpsampleRgbLinePair,Db=M.UpsampleBgrLinePair,Tf=M.UpsampleRgbaLinePair,ig=M.UpsampleBgraLinePair,od=M.UpsampleArgbLinePair,Dc=M.UpsampleRgba4444LinePair,ld=M.UpsampleRgb565LinePair,Dl=16,If=1<<Dl-1,oh=-227,cd=482,ag=6,ud=0,Ta=a(256),og=a(256),R2=a(256),A_=a(256),T_=a(cd-oh),I_=a(cd-oh);cu("YuvToRgbRow",ka,3),cu("YuvToBgrRow",cs,3),cu("YuvToRgbaRow",yo,4),cu("YuvToBgraRow",Tc,4),cu("YuvToArgbRow",Ac,4),cu("YuvToRgba4444Row",rl,2),cu("YuvToRgb565Row",_a,2);var Si=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Lf=[0,2,8],ap=[8,7,6,4,4,2,2,2,1,1,1,1],op=1;this.WebPDecodeRGBA=function(C,D,G,te,he){var fe=Xa,pe=new bt,ve=new zt;pe.ba=ve,ve.S=fe,ve.width=[ve.width],ve.height=[ve.height];var je=ve.width,Ce=ve.height,De=new Wt;if(De==null||C==null)var Qe=2;else e(De!=null),Qe=ic(C,D,G,De.width,De.height,De.Pd,De.Qd,De.format,null);if(Qe!=0?je=0:(je!=null&&(je[0]=De.width[0]),Ce!=null&&(Ce[0]=De.height[0]),je=1),je){ve.width=ve.width[0],ve.height=ve.height[0],te!=null&&(te[0]=ve.width),he!=null&&(he[0]=ve.height);e:{if(te=new oi,(he=new Tt).data=C,he.w=D,he.ha=G,he.kd=1,D=[0],e(he!=null),((C=ic(he.data,he.w,he.ha,null,null,null,D,null,he))==0||C==7)&&D[0]&&(C=4),(D=C)==0){if(e(pe!=null),te.data=he.data,te.w=he.w+he.offset,te.ha=he.ha-he.offset,te.put=It,te.ac=Pt,te.bc=Zt,te.ma=pe,he.xa){if((C=Ki())==null){pe=1;break e}if((function(Se,Ue){var Ke=[0],xt=[0],Xe=[0];t:for(;;){if(Se==null)return 0;if(Ue==null)return Se.a=2,0;if(Se.l=Ue,Se.a=0,se(Se.m,Ue.data,Ue.w,Ue.ha),!Ae(Se.m,Ke,xt,Xe)){Se.a=3;break t}if(Se.xb=Mb,Ue.width=Ke[0],Ue.height=xt[0],!Ws(Ke[0],xt[0],1,Se,null))break t;return 1}return e(Se.a!=0),0})(C,te)){if(te=(D=ac(te.width,te.height,pe.Oa,pe.ba))==0){t:{te=C;r:for(;;){if(te==null){te=0;break t}if(e(te.s.yc!=null),e(te.s.Ya!=null),e(0<te.s.Wb),e((G=te.l)!=null),e((he=G.ma)!=null),te.xb!=0){if(te.ca=he.ba,te.tb=he.tb,e(te.ca!=null),!uu(he.Oa,G,Il)){te.a=2;break r}if(!Ts(te,G.width)||G.da)break r;if((G.da||Kt(te.ca.S))&&nt(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&nt()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!ce(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!Kr(te,te.V,te.Ba,te.c,te.i,G.o,Je))break r;he.Dc=te.Ma,te=1;break t}e(te.a!=0),te=0}te=!te}te&&(D=C.a)}else D=C.a}else{if((C=new xs)==null){pe=1;break e}if(C.Fa=he.na,C.P=he.P,C.qc=he.Sa,li(C,te)){if((D=ac(te.width,te.height,pe.Oa,pe.ba))==0){if(C.Aa=0,G=pe.Oa,e((he=C)!=null),G!=null){if(0<(je=0>(je=G.Md)?0:100<je?255:255*je/100)){for(Ce=De=0;4>Ce;++Ce)12>(Qe=he.pb[Ce]).lc&&(Qe.ia=je*ap[0>Qe.lc?0:Qe.lc]>>3),De|=Qe.ia;De&&(alert("todo:VP8InitRandom"),he.ia=1)}he.Ga=G.Id,100<he.Ga?he.Ga=100:0>he.Ga&&(he.Ga=0)}(function(Se,Ue){if(Se==null)return 0;if(Ue==null)return Yr(Se,2,"NULL VP8Io parameter in VP8Decode().");if(!Se.cb&&!li(Se,Ue))return 0;if(e(Se.cb),Ue.ac==null||Ue.ac(Ue)){Ue.ob&&(Se.L=0);var Ke=Lf[Se.L];if(Se.L==2?(Se.yb=0,Se.zb=0):(Se.yb=Ue.v-Ke>>4,Se.zb=Ue.j-Ke>>4,0>Se.yb&&(Se.yb=0),0>Se.zb&&(Se.zb=0)),Se.Va=Ue.o+15+Ke>>4,Se.Hb=Ue.va+15+Ke>>4,Se.Hb>Se.za&&(Se.Hb=Se.za),Se.Va>Se.Ub&&(Se.Va=Se.Ub),0<Se.L){var xt=Se.ed;for(Ke=0;4>Ke;++Ke){var Xe;if(Se.Qa.Cb){var mt=Se.Qa.Lb[Ke];Se.Qa.Fb||(mt+=xt.Tb)}else mt=xt.Tb;for(Xe=0;1>=Xe;++Xe){var wt=Se.gd[Ke][Xe],Bt=mt;if(xt.Pc&&(Bt+=xt.vd[0],Xe&&(Bt+=xt.od[0])),0<(Bt=0>Bt?0:63<Bt?63:Bt)){var Et=Bt;0<xt.wb&&(Et=4<xt.wb?Et>>2:Et>>1)>9-xt.wb&&(Et=9-xt.wb),1>Et&&(Et=1),wt.dd=Et,wt.tc=2*Bt+Et,wt.ld=40<=Bt?2:15<=Bt?1:0}else wt.tc=0;wt.La=Xe}}}Ke=0}else Yr(Se,6,"Frame setup failed"),Ke=Se.a;if(Ke=Ke==0){if(Ke){Se.$c=0,0<Se.Aa||(Se.Ic=op);t:{Ke=Se.Ic,xt=4*(Et=Se.za);var fr=32*Et,sr=Et+1,Wr=0<Se.L?Et*(0<Se.Aa?2:1):0,lr=(Se.Aa==2?2:1)*Et;if((wt=xt+832+(Xe=3*(16*Ke+Lf[Se.L])/2*fr)+(mt=Se.Fa!=null&&0<Se.Fa.length?Se.Kc.c*Se.Kc.i:0))!=wt)Ke=0;else{if(wt>Se.Vb){if(Se.Vb=0,Se.Ec=a(wt),Se.Fc=0,Se.Ec==null){Ke=Yr(Se,1,"no memory during frame initialization.");break t}Se.Vb=wt}wt=Se.Ec,Bt=Se.Fc,Se.Ac=wt,Se.Bc=Bt,Bt+=xt,Se.Gd=o(fr,_l),Se.Hd=0,Se.rb=o(sr+1,Xi),Se.sb=1,Se.wa=Wr?o(Wr,Gs):null,Se.Y=0,Se.D.Nb=0,Se.D.wa=Se.wa,Se.D.Y=Se.Y,0<Se.Aa&&(Se.D.Y+=Et),e(!0),Se.oc=wt,Se.pc=Bt,Bt+=832,Se.ya=o(lr,Pi),Se.aa=0,Se.D.ya=Se.ya,Se.D.aa=Se.aa,Se.Aa==2&&(Se.D.aa+=Et),Se.R=16*Et,Se.B=8*Et,Et=(fr=Lf[Se.L])*Se.R,fr=fr/2*Se.B,Se.sa=wt,Se.ta=Bt+Et,Se.qa=Se.sa,Se.ra=Se.ta+16*Ke*Se.R+fr,Se.Ha=Se.qa,Se.Ia=Se.ra+8*Ke*Se.B+fr,Se.$c=0,Bt+=Xe,Se.mb=mt?wt:null,Se.nb=mt?Bt:null,e(Bt+mt<=Se.Fc+Se.Vb),ho(Se),i(Se.Ac,Se.Bc,0,xt),Ke=1}}if(Ke){if(Ue.ka=0,Ue.y=Se.sa,Ue.O=Se.ta,Ue.f=Se.qa,Ue.N=Se.ra,Ue.ea=Se.Ha,Ue.Vd=Se.Ia,Ue.fa=Se.R,Ue.Rc=Se.B,Ue.F=null,Ue.J=0,!Jm){for(Ke=-255;255>=Ke;++Ke)sh[255+Ke]=0>Ke?-Ke:Ke;for(Ke=-1020;1020>=Ke;++Ke)Qm[1020+Ke]=-128>Ke?-128:127<Ke?127:Ke;for(Ke=-112;112>=Ke;++Ke)ep[112+Ke]=-16>Ke?-16:15<Ke?15:Ke;for(Ke=-255;510>=Ke;++Ke)tp[255+Ke]=0>Ke?0:255<Ke?255:Ke;Jm=1}sl=es,mu=rc,Al=Ni,zn=fo,En=Ks,Ka=Sl,Ns=Wa,_i=Ys,Mc=ue,oc=_e,rh=Ga,J0=z,Lb=Oe,T2=ze,I2=Qr,L2=Un,Pb=Us,Ob=ss,ci[0]=$o,ci[1]=nc,ci[2]=go,ci[3]=xo,ci[4]=Fs,ci[5]=Fo,ci[6]=ys,ci[7]=rn,ci[8]=bo,ci[9]=Mi,wo[0]=la,wo[1]=Cl,wo[2]=El,wo[3]=po,wo[4]=ls,wo[5]=ji,wo[6]=mo,lc[0]=xe,lc[1]=oa,lc[2]=ja,lc[3]=sc,lc[4]=dt,lc[5]=Te,lc[6]=_r,Ke=1}else Ke=0}Ke&&(Ke=(function(mn,Ps){for(mn.M=0;mn.M<mn.Va;++mn.M){var Jr,ir=mn.Jc[mn.M&mn.Xb],Yt=mn.m,Xs=mn;for(Jr=0;Jr<Xs.za;++Jr){var Dr=Yt,nn=Xs,ts=nn.Ac,Ji=nn.Bc+4*Jr,Ia=nn.zc,js=nn.ya[nn.aa+Jr];if(nn.Qa.Bb?js.$b=le(Dr,nn.Pa.jb[0])?2+le(Dr,nn.Pa.jb[2]):le(Dr,nn.Pa.jb[1]):js.$b=0,nn.kc&&(js.Ad=le(Dr,nn.Bd)),js.Za=!le(Dr,145)+0,js.Za){var Di=js.Ob,Qa=0;for(nn=0;4>nn;++nn){var Bi,dn=Ia[0+nn];for(Bi=0;4>Bi;++Bi){dn=Ea[ts[Ji+Bi]][dn];for(var Mn=sg[le(Dr,dn[0])];0<Mn;)Mn=sg[2*Mn+le(Dr,dn[Mn])];dn=-Mn,ts[Ji+Bi]=dn}n(Di,Qa,ts,Ji,4),Qa+=4,Ia[0+nn]=dn}}else dn=le(Dr,156)?le(Dr,128)?1:3:le(Dr,163)?2:0,js.Ob[0]=dn,i(ts,Ji,dn,4),i(Ia,0,dn,4);js.Dd=le(Dr,142)?le(Dr,114)?le(Dr,183)?1:3:2:0}if(Xs.m.Ka)return Yr(mn,7,"Premature end-of-partition0 encountered.");for(;mn.ja<mn.za;++mn.ja){if(Xs=ir,Dr=(Yt=mn).rb[Yt.sb-1],ts=Yt.rb[Yt.sb+Yt.ja],Jr=Yt.ya[Yt.aa+Yt.ja],Ji=Yt.kc?Jr.Ad:0)Dr.la=ts.la=0,Jr.Za||(Dr.Na=ts.Na=0),Jr.Hc=0,Jr.Gc=0,Jr.ia=0;else{var Qs,qn;if(Dr=ts,ts=Xs,Ji=Yt.Pa.Xc,Ia=Yt.ya[Yt.aa+Yt.ja],js=Yt.pb[Ia.$b],nn=Ia.ad,Di=0,Qa=Yt.rb[Yt.sb-1],dn=Bi=0,i(nn,Di,0,384),Ia.Za)var Zi=0,Js=Ji[3];else{Mn=a(16);var Dn=Dr.Na+Qa.Na;if(Dn=al(ts,Ji[1],Dn,js.Eb,0,Mn,0),Dr.Na=Qa.Na=(0<Dn)+0,1<Dn)sl(Mn,0,nn,Di);else{var Ci=Mn[0]+3>>3;for(Mn=0;256>Mn;Mn+=16)nn[Di+Mn]=Ci}Zi=1,Js=Ji[0]}var rs=15&Dr.la,$i=15&Qa.la;for(Mn=0;4>Mn;++Mn){var Fi=1&$i;for(Ci=qn=0;4>Ci;++Ci)rs=rs>>1|(Fi=(Dn=al(ts,Js,Dn=Fi+(1&rs),js.Sc,Zi,nn,Di))>Zi)<<7,qn=qn<<2|(3<Dn?3:1<Dn?2:nn[Di+0]!=0),Di+=16;rs>>=4,$i=$i>>1|Fi<<7,Bi=(Bi<<8|qn)>>>0}for(Js=rs,Zi=$i>>4,Qs=0;4>Qs;Qs+=2){for(qn=0,rs=Dr.la>>4+Qs,$i=Qa.la>>4+Qs,Mn=0;2>Mn;++Mn){for(Fi=1&$i,Ci=0;2>Ci;++Ci)Dn=Fi+(1&rs),rs=rs>>1|(Fi=0<(Dn=al(ts,Ji[2],Dn,js.Qc,0,nn,Di)))<<3,qn=qn<<2|(3<Dn?3:1<Dn?2:nn[Di+0]!=0),Di+=16;rs>>=2,$i=$i>>1|Fi<<5}dn|=qn<<4*Qs,Js|=rs<<4<<Qs,Zi|=(240&$i)<<Qs}Dr.la=Js,Qa.la=Zi,Ia.Hc=Bi,Ia.Gc=dn,Ia.ia=43690&dn?0:js.ia,Ji=!(Bi|dn)}if(0<Yt.L&&(Yt.wa[Yt.Y+Yt.ja]=Yt.gd[Jr.$b][Jr.Za],Yt.wa[Yt.Y+Yt.ja].La|=!Ji),Xs.Ka)return Yr(mn,7,"Premature end-of-file encountered.")}if(ho(mn),Yt=Ps,Xs=1,Jr=(ir=mn).D,Dr=0<ir.L&&ir.M>=ir.zb&&ir.M<=ir.Va,ir.Aa==0)t:{if(Jr.M=ir.M,Jr.uc=Dr,nl(ir,Jr),Xs=1,Jr=(qn=ir.D).Nb,Dr=(dn=Lf[ir.L])*ir.R,ts=dn/2*ir.B,Mn=16*Jr*ir.R,Ci=8*Jr*ir.B,Ji=ir.sa,Ia=ir.ta-Dr+Mn,js=ir.qa,nn=ir.ra-ts+Ci,Di=ir.Ha,Qa=ir.Ia-ts+Ci,$i=(rs=qn.M)==0,Bi=rs>=ir.Va-1,ir.Aa==2&&nl(ir,qn),qn.uc)for(Fi=(Dn=ir).D.M,e(Dn.D.uc),qn=Dn.yb;qn<Dn.Hb;++qn){Zi=qn,Js=Fi;var us=(An=(Ui=Dn).D).Nb;Qs=Ui.R;var An=An.wa[An.Y+Zi],Ja=Ui.sa,ui=Ui.ta+16*us*Qs+16*Zi,Ar=An.dd,Lr=An.tc;if(Lr!=0)if(e(3<=Lr),Ui.L==1)0<Zi&&L2(Ja,ui,Qs,Lr+4),An.La&&Ob(Ja,ui,Qs,Lr),0<Js&&I2(Ja,ui,Qs,Lr+4),An.La&&Pb(Ja,ui,Qs,Lr);else{var Bn=Ui.B,zo=Ui.qa,Bl=Ui.ra+8*us*Bn+8*Zi,No=Ui.Ha,Ui=Ui.Ia+8*us*Bn+8*Zi;us=An.ld,0<Zi&&(_i(Ja,ui,Qs,Lr+4,Ar,us),oc(zo,Bl,No,Ui,Bn,Lr+4,Ar,us)),An.La&&(J0(Ja,ui,Qs,Lr,Ar,us),T2(zo,Bl,No,Ui,Bn,Lr,Ar,us)),0<Js&&(Ns(Ja,ui,Qs,Lr+4,Ar,us),Mc(zo,Bl,No,Ui,Bn,Lr+4,Ar,us)),An.La&&(rh(Ja,ui,Qs,Lr,Ar,us),Lb(zo,Bl,No,Ui,Bn,Lr,Ar,us))}}if(ir.ia&&alert("todo:DitherRow"),Yt.put!=null){if(qn=16*rs,rs=16*(rs+1),$i?(Yt.y=ir.sa,Yt.O=ir.ta+Mn,Yt.f=ir.qa,Yt.N=ir.ra+Ci,Yt.ea=ir.Ha,Yt.W=ir.Ia+Ci):(qn-=dn,Yt.y=Ji,Yt.O=Ia,Yt.f=js,Yt.N=nn,Yt.ea=Di,Yt.W=Qa),Bi||(rs-=dn),rs>Yt.o&&(rs=Yt.o),Yt.F=null,Yt.J=null,ir.Fa!=null&&0<ir.Fa.length&&qn<rs&&(Yt.J=A(ir,Yt,qn,rs-qn),Yt.F=ir.mb,Yt.F==null&&Yt.F.length==0)){Xs=Yr(ir,3,"Could not decode alpha data.");break t}qn<Yt.j&&(dn=Yt.j-qn,qn=Yt.j,e(!(1&dn)),Yt.O+=ir.R*dn,Yt.N+=ir.B*(dn>>1),Yt.W+=ir.B*(dn>>1),Yt.F!=null&&(Yt.J+=Yt.width*dn)),qn<rs&&(Yt.O+=Yt.v,Yt.N+=Yt.v>>1,Yt.W+=Yt.v>>1,Yt.F!=null&&(Yt.J+=Yt.v),Yt.ka=qn-Yt.j,Yt.U=Yt.va-Yt.v,Yt.T=rs-qn,Xs=Yt.put(Yt))}Jr+1!=ir.Ic||Bi||(n(ir.sa,ir.ta-Dr,Ji,Ia+16*ir.R,Dr),n(ir.qa,ir.ra-ts,js,nn+8*ir.B,ts),n(ir.Ha,ir.Ia-ts,Di,Qa+8*ir.B,ts))}if(!Xs)return Yr(mn,6,"Output aborted.")}return 1})(Se,Ue)),Ue.bc!=null&&Ue.bc(Ue),Ke&=1}return Ke?(Se.cb=0,Ke):0})(C,te)||(D=C.a)}}else D=C.a}D==0&&pe.Oa!=null&&pe.Oa.fd&&(D=Q0(pe.ba))}pe=D}fe=pe!=0?null:11>fe?ve.f.RGBA.eb:ve.f.kb.y}else fe=null;return fe};var lg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(M,$){for(var k="",L=0;L<4;L++)k+=String.fromCharCode(M[$++]);return k}function h(M,$){return M[$+0]|M[$+1]<<8}function p(M,$){return(M[$+0]|M[$+1]<<8|M[$+2]<<16)>>>0}function m(M,$){return(M[$+0]|M[$+1]<<8|M[$+2]<<16|M[$+3]<<24)>>>0}new c;var g=[0],b=[0],v=[],w=new c,j=t,_=(function(M,$){var k={},L=0,R=!1,V=0,Y=0;if(k.frames=[],!(function(U,W){for(var Z=0;Z<4;Z++)if(U[W+Z]!="RIFF".charCodeAt(Z))return!0;return!1})(M,$)){for(m(M,$+=4),$+=8;$<M.length;){var X=u(M,$),J=m(M,$+=4);$+=4;var re=J+(1&J);switch(X){case"VP8 ":case"VP8L":k.frames[L]===void 0&&(k.frames[L]={}),(q=k.frames[L]).src_off=R?Y:$-8,q.src_size=V+J+8,L++,R&&(R=!1,V=0,Y=0);break;case"VP8X":(q=k.header={}).feature_flags=M[$];var se=$+4;q.canvas_width=1+p(M,se),se+=3,q.canvas_height=1+p(M,se),se+=3;break;case"ALPH":R=!0,V=re+8,Y=$-8;break;case"ANIM":(q=k.header).bgcolor=m(M,$),se=$+4,q.loop_count=h(M,se),se+=2;break;case"ANMF":var ee,q;(q=k.frames[L]={}).offset_x=2*p(M,$),$+=3,q.offset_y=2*p(M,$),$+=3,q.width=1+p(M,$),$+=3,q.height=1+p(M,$),$+=3,q.duration=p(M,$),$+=3,ee=M[$++],q.dispose=1&ee,q.blend=ee>>1&1}X!="ANMF"&&($+=re)}return k}})(j,0);_.response=j,_.rgbaoutput=!0,_.dataurl=!1;var E=_.header?_.header:null,I=_.frames?_.frames:null;if(E){E.loop_counter=E.loop_count,g=[E.canvas_height],b=[E.canvas_width];for(var O=0;O<I.length&&I[O].blend!=0;O++);}var B=I[0],S=w.WebPDecodeRGBA(j,B.src_off,B.src_size,b,g);B.rgba=S,B.imgwidth=b[0],B.imgheight=g[0];for(var T=0;T<b[0]*g[0]*4;T++)v[T]=S[T];return this.width=b,this.height=g,this.data=v,this}(function(t){var e,r,n,i,a,o,l,c,u,h=function(U){return U=U||{},this.isStrokeTransparent=U.isStrokeTransparent||!1,this.strokeOpacity=U.strokeOpacity||1,this.strokeStyle=U.strokeStyle||"#000000",this.fillStyle=U.fillStyle||"#000000",this.isFillTransparent=U.isFillTransparent||!1,this.fillOpacity=U.fillOpacity||1,this.font=U.font||"10px sans-serif",this.textBaseline=U.textBaseline||"alphabetic",this.textAlign=U.textAlign||"left",this.lineWidth=U.lineWidth||1,this.lineJoin=U.lineJoin||"miter",this.lineCap=U.lineCap||"butt",this.path=U.path||[],this.transform=U.transform!==void 0?U.transform.clone():new c,this.globalCompositeOperation=U.globalCompositeOperation||"normal",this.globalAlpha=U.globalAlpha||1,this.clip_path=U.clip_path||[],this.currentPoint=U.currentPoint||new o,this.miterLimit=U.miterLimit||10,this.lastPoint=U.lastPoint||new o,this.lineDashOffset=U.lineDashOffset||0,this.lineDash=U.lineDash||[],this.margin=U.margin||[0,0,0,0],this.prevPageLastElemOffset=U.prevPageLastElemOffset||0,this.ignoreClearRect=typeof U.ignoreClearRect!="boolean"||U.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var p=function(U){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=U;Object.defineProperty(this,"pdf",{get:function(){return W}});var Z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Z},set:function(ce){Z=!!ce}});var de=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return de},set:function(ce){de=!!ce}});var be=0;Object.defineProperty(this,"posX",{get:function(){return be},set:function(ce){isNaN(ce)||(be=ce)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(ce){isNaN(ce)||(oe=ce)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(ce){var Be;typeof ce=="number"?Be=[ce,ce,ce,ce]:((Be=new Array(4))[0]=ce[0],Be[1]=ce.length>=2?ce[1]:Be[0],Be[2]=ce.length>=3?ce[2]:Be[0],Be[3]=ce.length>=4?ce[3]:Be[1]),u.margin=Be}});var ne=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ne},set:function(ce){ne=ce}});var H=0;Object.defineProperty(this,"lastBreak",{get:function(){return H},set:function(ce){H=ce}});var le=[];Object.defineProperty(this,"pageBreaks",{get:function(){return le},set:function(ce){le=ce}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(ce){ce instanceof h&&(u=ce)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(ce){u.path=ce}});var ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return ye},set:function(ce){ye=ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ce){var Be;Be=m(ce),this.ctx.fillStyle=Be.style,this.ctx.isFillTransparent=Be.a===0,this.ctx.fillOpacity=Be.a,this.pdf.setFillColor(Be.r,Be.g,Be.b,{a:Be.a}),this.pdf.setTextColor(Be.r,Be.g,Be.b,{a:Be.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ce){var Be=m(ce);this.ctx.strokeStyle=Be.style,this.ctx.isStrokeTransparent=Be.a===0,this.ctx.strokeOpacity=Be.a,Be.a===0?this.pdf.setDrawColor(255,255,255):(Be.a,this.pdf.setDrawColor(Be.r,Be.g,Be.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ce){["butt","round","square"].indexOf(ce)!==-1&&(this.ctx.lineCap=ce,this.pdf.setLineCap(ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ce){isNaN(ce)||(this.ctx.lineWidth=ce,this.pdf.setLineWidth(ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ce){["bevel","round","miter"].indexOf(ce)!==-1&&(this.ctx.lineJoin=ce,this.pdf.setLineJoin(ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ce){isNaN(ce)||(this.ctx.miterLimit=ce,this.pdf.setMiterLimit(ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ce){this.ctx.textBaseline=ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ce){["right","end","center","left","start"].indexOf(ce)!==-1&&(this.ctx.textAlign=ce)}});var me=null,ke=null,Ie=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ie},set:function(ce){me=null,ke=null,Ie=ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ce){var Be;if(this.ctx.font=ce,(Be=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ce))!==null){var ct=Be[1];Be[2];var Ve=Be[3],Ne=Be[4];Be[5];var Ye=Be[6],St=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ne)[2];Ne=Math.floor(St==="px"?parseFloat(Ne)*this.pdf.internal.scaleFactor:St==="em"?parseFloat(Ne)*this.pdf.getFontSize():parseFloat(Ne)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ne);var Vt=(function(Fe){var Ut,jt,qe=[],rt=Fe.trim();if(rt==="")return UC;if(rt in DU)return[DU[rt]];for(;rt!=="";){switch(jt=null,Ut=(rt=$U(rt)).charAt(0)){case'"':case"'":jt=pPe(rt.substring(1),Ut);break;default:jt=mPe(rt)}if(jt===null||(qe.push(jt[0]),(rt=$U(jt[1]))!==""&&rt.charAt(0)!==","))return UC;rt=rt.replace(/^,/,"")}return qe})(Ye);if(this.fontFaces){var Lt=(function(Fe,Ut){var jt=Fe.getFontList(),qe=JSON.stringify(jt);if(me===null||ke!==qe){var rt=(function(Ot){var pt=[];return Object.keys(Ot).forEach(function(Jt){Ot[Jt].forEach(function(Kt){var rr=null;switch(Kt){case"bold":rr={family:Jt,weight:"bold"};break;case"italic":rr={family:Jt,style:"italic"};break;case"bolditalic":rr={family:Jt,weight:"bold",style:"italic"};break;case"":case"normal":rr={family:Jt}}rr!==null&&(rr.ref={name:Jt,style:Kt},pt.push(rr))})}),pt})(jt);me=(function(Ot){for(var pt={},Jt=0;Jt<Ot.length;++Jt){var Kt=FC(Ot[Jt]),rr=Kt.family,Br=Kt.stretch,zt=Kt.style,Wt=Kt.weight;pt[rr]=pt[rr]||{},pt[rr][Br]=pt[rr][Br]||{},pt[rr][Br][zt]=pt[rr][Br][zt]||{},pt[rr][Br][zt][Wt]=Kt}return pt})(rt.concat(Ut)),ke=qe}return me})(this.pdf,this.fontFaces),at=Vt.map(function(Fe){return{family:Fe,stretch:"normal",weight:Ve,style:ct}}),gt=(function(Fe,Ut,jt){for(var qe=(jt=jt||{}).defaultFontFamily||"times",rt=Object.assign({},fPe,jt.genericFontFamilies||{}),Ot=null,pt=null,Jt=0;Jt<Ut.length;++Jt)if(rt[(Ot=FC(Ut[Jt])).family]&&(Ot.family=rt[Ot.family]),Fe.hasOwnProperty(Ot.family)){pt=Fe[Ot.family];break}if(!(pt=pt||Fe[qe]))throw new Error("Could not find a font-family for the rule '"+BU(Ot)+"' and default family '"+qe+"'.");if(pt=(function(Kt,rr){if(rr[Kt])return rr[Kt];var Br=TT[Kt],zt=Br<=TT.normal?-1:1,Wt=MU(rr,Bte,Br,zt);if(!Wt)throw new Error("Could not find a matching font-stretch value for "+Kt);return Wt})(Ot.stretch,pt),pt=(function(Kt,rr){if(rr[Kt])return rr[Kt];for(var Br=Dte[Kt],zt=0;zt<Br.length;++zt)if(rr[Br[zt]])return rr[Br[zt]];throw new Error("Could not find a matching font-style for "+Kt)})(Ot.style,pt),!(pt=(function(Kt,rr){if(rr[Kt])return rr[Kt];if(Kt===400&&rr[500])return rr[500];if(Kt===500&&rr[400])return rr[400];var Br=hPe[Kt],zt=MU(rr,$te,Br,Kt<400?-1:1);if(!zt)throw new Error("Could not find a matching font-weight for value "+Kt);return zt})(Ot.weight,pt)))throw new Error("Failed to resolve a font for the rule '"+BU(Ot)+"'.");return pt})(Lt,at);this.pdf.setFont(gt.ref.name,gt.ref.style)}else{var vt="";(Ve==="bold"||parseInt(Ve,10)>=700||ct==="bold")&&(vt="bold"),ct==="italic"&&(vt+="italic"),vt.length===0&&(vt="normal");for(var ft="",ot={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ut=0;ut<Vt.length;ut++){if(this.pdf.internal.getFont(Vt[ut],vt,{noFallback:!0,disableWarning:!0})!==void 0){ft=Vt[ut];break}if(vt==="bolditalic"&&this.pdf.internal.getFont(Vt[ut],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ft=Vt[ut],vt="bold";else if(this.pdf.internal.getFont(Vt[ut],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ft=Vt[ut],vt="normal";break}}if(ft===""){for(var At=0;At<Vt.length;At++)if(ot[Vt[At]]){ft=ot[Vt[At]];break}}ft=ft===""?"Times":ft,this.pdf.setFont(ft,vt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ce){this.ctx.globalCompositeOperation=ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ce){this.ctx.globalAlpha=ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ce){this.ctx.lineDashOffset=ce,q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ce){this.ctx.lineDash=ce,q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ce){this.ctx.ignoreClearRect=!!ce}})};p.prototype.setLineDash=function(U){this.lineDash=U},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){I.call(this,"fill",!1)},p.prototype.stroke=function(){I.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(U,W){if(isNaN(U)||isNaN(W))throw Rs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Z=this.ctx.transform.applyToPoint(new o(U,W));this.path.push({type:"mt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(U,W)},p.prototype.closePath=function(){var U=new o(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&ms(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){U=new o(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(U.x,U.y)},p.prototype.lineTo=function(U,W){if(isNaN(U)||isNaN(W))throw Rs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Z=this.ctx.transform.applyToPoint(new o(U,W));this.path.push({type:"lt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(Z.x,Z.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),I.call(this,null,!0)},p.prototype.quadraticCurveTo=function(U,W,Z,de){if(isNaN(Z)||isNaN(de)||isNaN(U)||isNaN(W))throw Rs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var be=this.ctx.transform.applyToPoint(new o(Z,de)),oe=this.ctx.transform.applyToPoint(new o(U,W));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:be.x,y:be.y}),this.ctx.lastPoint=new o(be.x,be.y)},p.prototype.bezierCurveTo=function(U,W,Z,de,be,oe){if(isNaN(be)||isNaN(oe)||isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de))throw Rs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ne=this.ctx.transform.applyToPoint(new o(be,oe)),H=this.ctx.transform.applyToPoint(new o(U,W)),le=this.ctx.transform.applyToPoint(new o(Z,de));this.path.push({type:"bct",x1:H.x,y1:H.y,x2:le.x,y2:le.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new o(ne.x,ne.y)},p.prototype.arc=function(U,W,Z,de,be,oe){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de)||isNaN(be))throw Rs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var ne=this.ctx.transform.applyToPoint(new o(U,W));U=ne.x,W=ne.y;var H=this.ctx.transform.applyToPoint(new o(0,Z)),le=this.ctx.transform.applyToPoint(new o(0,0));Z=Math.sqrt(Math.pow(H.x-le.x,2)+Math.pow(H.y-le.y,2))}Math.abs(be-de)>=2*Math.PI&&(de=0,be=2*Math.PI),this.path.push({type:"arc",x:U,y:W,radius:Z,startAngle:de,endAngle:be,counterclockwise:oe})},p.prototype.arcTo=function(U,W,Z,de,be){throw new Error("arcTo not implemented.")},p.prototype.rect=function(U,W,Z,de){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de))throw Rs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(U,W),this.lineTo(U+Z,W),this.lineTo(U+Z,W+de),this.lineTo(U,W+de),this.lineTo(U,W),this.lineTo(U+Z,W),this.lineTo(U,W)},p.prototype.fillRect=function(U,W,Z,de){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de))throw Rs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var be={};this.lineCap!=="butt"&&(be.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(be.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(U,W,Z,de),this.fill(),be.hasOwnProperty("lineCap")&&(this.lineCap=be.lineCap),be.hasOwnProperty("lineJoin")&&(this.lineJoin=be.lineJoin)}},p.prototype.strokeRect=function(U,W,Z,de){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de))throw Rs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(U,W,Z,de),this.stroke())},p.prototype.clearRect=function(U,W,Z,de){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de))throw Rs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(U,W,Z,de))},p.prototype.save=function(U){U=typeof U!="boolean"||U;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),U){this.ctx.fontSize=this.pdf.internal.getFontSize();var de=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=de}},p.prototype.restore=function(U){U=typeof U!="boolean"||U;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("Q");this.pdf.setPage(W),U&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(U){var W,Z,de,be;if(U.isCanvasGradient===!0&&(U=U.getColor()),!U)return{r:0,g:0,b:0,a:0,style:U};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(U))W=0,Z=0,de=0,be=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(U);if(oe!==null)W=parseInt(oe[1]),Z=parseInt(oe[2]),de=parseInt(oe[3]),be=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(U))!==null)W=parseInt(oe[1]),Z=parseInt(oe[2]),de=parseInt(oe[3]),be=parseFloat(oe[4]);else{if(be=1,typeof U=="string"&&U.charAt(0)!=="#"){var ne=new Tte(U);U=ne.ok?ne.toHex():"#000000"}U.length===4?(W=U.substring(1,2),W+=W,Z=U.substring(2,3),Z+=Z,de=U.substring(3,4),de+=de):(W=U.substring(1,3),Z=U.substring(3,5),de=U.substring(5,7)),W=parseInt(W,16),Z=parseInt(Z,16),de=parseInt(de,16)}}return{r:W,g:Z,b:de,a:be,style:U}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(U,W,Z,de){if(isNaN(W)||isNaN(Z)||typeof U!="string")throw Rs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(de=isNaN(de)?void 0:de,!g.call(this)){var be=re(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;L.call(this,{text:U,x:W,y:Z,scale:oe,angle:be,align:this.textAlign,maxWidth:de})}},p.prototype.strokeText=function(U,W,Z,de){if(isNaN(W)||isNaN(Z)||typeof U!="string")throw Rs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){de=isNaN(de)?void 0:de;var be=re(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;L.call(this,{text:U,x:W,y:Z,scale:oe,renderingMode:"stroke",angle:be,align:this.textAlign,maxWidth:de})}},p.prototype.measureText=function(U){if(typeof U!="string")throw Rs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,Z=this.pdf.internal.scaleFactor,de=W.internal.getFontSize(),be=W.getStringUnitWidth(U)*de/W.internal.scaleFactor;return new function(oe){var ne=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ne}}),this}({width:be*=Math.round(96*Z/72*1e4)/1e4})},p.prototype.scale=function(U,W){if(isNaN(U)||isNaN(W))throw Rs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Z=new c(U,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},p.prototype.rotate=function(U){if(isNaN(U))throw Rs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new c(Math.cos(U),Math.sin(U),-Math.sin(U),Math.cos(U),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.translate=function(U,W){if(isNaN(U)||isNaN(W))throw Rs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Z=new c(1,0,0,1,U,W);this.ctx.transform=this.ctx.transform.multiply(Z)},p.prototype.transform=function(U,W,Z,de,be,oe){if(isNaN(U)||isNaN(W)||isNaN(Z)||isNaN(de)||isNaN(be)||isNaN(oe))throw Rs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ne=new c(U,W,Z,de,be,oe);this.ctx.transform=this.ctx.transform.multiply(ne)},p.prototype.setTransform=function(U,W,Z,de,be,oe){U=isNaN(U)?1:U,W=isNaN(W)?0:W,Z=isNaN(Z)?0:Z,de=isNaN(de)?1:de,be=isNaN(be)?0:be,oe=isNaN(oe)?0:oe,this.ctx.transform=new c(U,W,Z,de,be,oe)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(U,W,Z,de,be,oe,ne,H,le){var ye=this.pdf.getImageProperties(U),me=1,ke=1,Ie=1,ce=1;de!==void 0&&H!==void 0&&(Ie=H/de,ce=le/be,me=ye.width/de*H/de,ke=ye.height/be*le/be),oe===void 0&&(oe=W,ne=Z,W=0,Z=0),de!==void 0&&H===void 0&&(H=de,le=be),de===void 0&&H===void 0&&(H=ye.width,le=ye.height);var Be=this.ctx.transform.decompose(),ct=re(Be.rotate.shx),Ve=new c,Ne=(Ve=(Ve=(Ve=Ve.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale)).applyToRectangle(new l(oe-W*Ie,ne-Z*ce,de*me,be*ke));if(this.autoPaging){for(var Ye,St=w.call(this,Ne),Vt=[],Lt=0;Lt<St.length;Lt+=1)Vt.indexOf(St[Lt])===-1&&Vt.push(St[Lt]);E(Vt);for(var at=Vt[0],gt=Vt[Vt.length-1],vt=at;vt<gt+1;vt++){this.pdf.setPage(vt);var ft=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ot=vt===1?this.posY+this.margin[0]:this.margin[0],ut=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Fe=vt===1?0:ut+(vt-2)*At;if(this.ctx.clip_path.length!==0){var Ut=this.path;Ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Ye,this.posX+this.margin[3],-Fe+ot+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=Ut}var jt=JSON.parse(JSON.stringify(Ne));jt=_([jt],this.posX+this.margin[3],-Fe+ot+this.ctx.prevPageLastElemOffset)[0];var qe=(vt>at||vt<gt)&&v.call(this);qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ft,At,null).clip().discardPath()),this.pdf.addImage(U,"JPEG",jt.x,jt.y,jt.w,jt.h,null,null,ct),qe&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(U,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,ct)};var w=function(U,W,Z){var de=[];W=W||this.pdf.internal.pageSize.width,Z=Z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var be=this.posY+this.ctx.prevPageLastElemOffset;switch(U.type){default:case"mt":case"lt":de.push(Math.floor((U.y+be)/Z)+1);break;case"arc":de.push(Math.floor((U.y+be-U.radius)/Z)+1),de.push(Math.floor((U.y+be+U.radius)/Z)+1);break;case"qct":var oe=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x,U.y);de.push(Math.floor((oe.y+be)/Z)+1),de.push(Math.floor((oe.y+oe.h+be)/Z)+1);break;case"bct":var ne=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x2,U.y2,U.x,U.y);de.push(Math.floor((ne.y+be)/Z)+1),de.push(Math.floor((ne.y+ne.h+be)/Z)+1);break;case"rect":de.push(Math.floor((U.y+be)/Z)+1),de.push(Math.floor((U.y+U.h+be)/Z)+1)}for(var H=0;H<de.length;H+=1)for(;this.pdf.internal.getNumberOfPages()<de[H];)j.call(this);return de},j=function(){var U=this.fillStyle,W=this.strokeStyle,Z=this.font,de=this.lineCap,be=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=U,this.strokeStyle=W,this.font=Z,this.lineCap=de,this.lineWidth=be,this.lineJoin=oe},_=function(U,W,Z){for(var de=0;de<U.length;de++)switch(U[de].type){case"bct":U[de].x2+=W,U[de].y2+=Z;case"qct":U[de].x1+=W,U[de].y1+=Z;default:U[de].x+=W,U[de].y+=Z}return U},E=function(U){return U.sort(function(W,Z){return W-Z})},I=function(U,W){var Z=this.fillStyle,de=this.strokeStyle,be=this.lineCap,oe=this.lineWidth,ne=Math.abs(oe*this.ctx.transform.scaleX),H=this.lineJoin;if(this.autoPaging){for(var le,ye,me=JSON.parse(JSON.stringify(this.path)),ke=JSON.parse(JSON.stringify(this.path)),Ie=[],ce=0;ce<ke.length;ce++)if(ke[ce].x!==void 0)for(var Be=w.call(this,ke[ce]),ct=0;ct<Be.length;ct+=1)Ie.indexOf(Be[ct])===-1&&Ie.push(Be[ct]);for(var Ve=0;Ve<Ie.length;Ve++)for(;this.pdf.internal.getNumberOfPages()<Ie[Ve];)j.call(this);E(Ie);for(var Ne=Ie[0],Ye=Ie[Ie.length-1],St=Ne;St<Ye+1;St++){this.pdf.setPage(St),this.fillStyle=Z,this.strokeStyle=de,this.lineCap=be,this.lineWidth=ne,this.lineJoin=H;var Vt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=St===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],gt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],vt=St===1?0:at+(St-2)*gt;if(this.ctx.clip_path.length!==0){var ft=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(le,this.posX+this.margin[3],-vt+Lt+this.ctx.prevPageLastElemOffset),O.call(this,U,!0),this.path=ft}if(ye=JSON.parse(JSON.stringify(me)),this.path=_(ye,this.posX+this.margin[3],-vt+Lt+this.ctx.prevPageLastElemOffset),W===!1||St===0){var ot=(St>Ne||St<Ye)&&v.call(this);ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Vt,gt,null).clip().discardPath()),O.call(this,U,W),ot&&this.pdf.restoreGraphicsState()}this.lineWidth=oe}this.path=me}else this.lineWidth=ne,O.call(this,U,W),this.lineWidth=oe},O=function(U,W){if((U!=="stroke"||W||!b.call(this))&&(U==="stroke"||W||!g.call(this))){for(var Z,de,be=[],oe=this.path,ne=0;ne<oe.length;ne++){var H=oe[ne];switch(H.type){case"begin":be.push({begin:!0});break;case"close":be.push({close:!0});break;case"mt":be.push({start:H,deltas:[],abs:[]});break;case"lt":var le=be.length;if(oe[ne-1]&&!isNaN(oe[ne-1].x)&&(Z=[H.x-oe[ne-1].x,H.y-oe[ne-1].y],le>0)){for(;le>=0;le--)if(be[le-1].close!==!0&&be[le-1].begin!==!0){be[le-1].deltas.push(Z),be[le-1].abs.push(H);break}}break;case"bct":Z=[H.x1-oe[ne-1].x,H.y1-oe[ne-1].y,H.x2-oe[ne-1].x,H.y2-oe[ne-1].y,H.x-oe[ne-1].x,H.y-oe[ne-1].y],be[be.length-1].deltas.push(Z);break;case"qct":var ye=oe[ne-1].x+2/3*(H.x1-oe[ne-1].x),me=oe[ne-1].y+2/3*(H.y1-oe[ne-1].y),ke=H.x+2/3*(H.x1-H.x),Ie=H.y+2/3*(H.y1-H.y),ce=H.x,Be=H.y;Z=[ye-oe[ne-1].x,me-oe[ne-1].y,ke-oe[ne-1].x,Ie-oe[ne-1].y,ce-oe[ne-1].x,Be-oe[ne-1].y],be[be.length-1].deltas.push(Z);break;case"arc":be.push({deltas:[],abs:[],arc:!0}),Array.isArray(be[be.length-1].abs)&&be[be.length-1].abs.push(H)}}de=W?null:U==="stroke"?"stroke":"fill";for(var ct=!1,Ve=0;Ve<be.length;Ve++)if(be[Ve].arc)for(var Ne=be[Ve].abs,Ye=0;Ye<Ne.length;Ye++){var St=Ne[Ye];St.type==="arc"?T.call(this,St.x,St.y,St.radius,St.startAngle,St.endAngle,St.counterclockwise,void 0,W,!ct):R.call(this,St.x,St.y),ct=!0}else if(be[Ve].close===!0)this.pdf.internal.out("h"),ct=!1;else if(be[Ve].begin!==!0){var Vt=be[Ve].start.x,Lt=be[Ve].start.y;V.call(this,be[Ve].deltas,Vt,Lt),ct=!0}de&&M.call(this,de),W&&$.call(this)}},B=function(U){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Z=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return U-Z;case"top":return U+W-Z;case"hanging":return U+W-2*Z;case"middle":return U+W/2-Z;default:return U}},S=function(U){return U+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var U=function(){};return U.colorStops=[],U.addColorStop=function(W,Z){this.colorStops.push([W,Z])},U.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},U.isCanvasGradient=!0,U},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(U,W,Z,de,be,oe,ne,H,le){for(var ye=X.call(this,Z,de,be,oe),me=0;me<ye.length;me++){var ke=ye[me];me===0&&(le?k.call(this,ke.x1+U,ke.y1+W):R.call(this,ke.x1+U,ke.y1+W)),Y.call(this,U,W,ke.x2,ke.y2,ke.x3,ke.y3,ke.x4,ke.y4)}H?$.call(this):M.call(this,ne)},M=function(U){switch(U){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},$=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(U,W){this.pdf.internal.out(r(U)+" "+n(W)+" m")},L=function(U){var W;switch(U.align){case"right":case"end":W="right";break;case"center":W="center";break;default:W="left"}var Z,de,be,oe=this.pdf.getTextDimensions(U.text),ne=B.call(this,U.y),H=S.call(this,ne)-oe.h,le=this.ctx.transform.applyToPoint(new o(U.x,ne));if(this.autoPaging){var ye=this.ctx.transform.decompose(),me=new c;me=(me=(me=me.multiply(ye.translate)).multiply(ye.skew)).multiply(ye.scale);for(var ke=this.ctx.transform.applyToRectangle(new l(U.x,ne,oe.w,oe.h)),Ie=me.applyToRectangle(new l(U.x,H,oe.w,oe.h)),ce=w.call(this,Ie),Be=[],ct=0;ct<ce.length;ct+=1)Be.indexOf(ce[ct])===-1&&Be.push(ce[ct]);E(Be);for(var Ve=Be[0],Ne=Be[Be.length-1],Ye=Ve;Ye<Ne+1;Ye++){this.pdf.setPage(Ye);var St=Ye===1?this.posY+this.margin[0]:this.margin[0],Vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Lt=this.pdf.internal.pageSize.height-this.margin[2],at=Lt-this.margin[0],gt=this.pdf.internal.pageSize.width-this.margin[1],vt=gt-this.margin[3],ft=Ye===1?0:Vt+(Ye-2)*at;if(this.ctx.clip_path.length!==0){var ot=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Z,this.posX+this.margin[3],-1*ft+St),O.call(this,"fill",!0),this.path=ot}var ut=_([JSON.parse(JSON.stringify(Ie))],this.posX+this.margin[3],-ft+St+this.ctx.prevPageLastElemOffset)[0];U.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*U.scale),be=this.lineWidth,this.lineWidth=be*U.scale);var At=this.autoPaging!=="text";if(At||ut.y+ut.h<=Lt){if(At||ut.y>=St&&ut.x<=gt){var Fe=At?U.text:this.pdf.splitTextToSize(U.text,U.maxWidth||gt-ut.x)[0],Ut=_([JSON.parse(JSON.stringify(ke))],this.posX+this.margin[3],-ft+St+this.ctx.prevPageLastElemOffset)[0],jt=At&&(Ye>Ve||Ye<Ne)&&v.call(this);jt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vt,at,null).clip().discardPath()),this.pdf.text(Fe,Ut.x,Ut.y,{angle:U.angle,align:W,renderingMode:U.renderingMode}),jt&&this.pdf.restoreGraphicsState()}}else ut.y<Lt&&(this.ctx.prevPageLastElemOffset+=Lt-ut.y);U.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=be)}}else U.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*U.scale),be=this.lineWidth,this.lineWidth=be*U.scale),this.pdf.text(U.text,le.x+this.posX,le.y+this.posY,{angle:U.angle,align:W,renderingMode:U.renderingMode,maxWidth:U.maxWidth}),U.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=be)},R=function(U,W,Z,de){Z=Z||0,de=de||0,this.pdf.internal.out(r(U+Z)+" "+n(W+de)+" l")},V=function(U,W,Z){return this.pdf.lines(U,W,Z,null,null)},Y=function(U,W,Z,de,be,oe,ne,H){this.pdf.internal.out([e(i(Z+U)),e(a(de+W)),e(i(be+U)),e(a(oe+W)),e(i(ne+U)),e(a(H+W)),"c"].join(" "))},X=function(U,W,Z,de){for(var be=2*Math.PI,oe=Math.PI/2;W>Z;)W-=be;var ne=Math.abs(Z-W);ne<be&&de&&(ne=be-ne);for(var H=[],le=de?-1:1,ye=W;ne>1e-5;){var me=ye+le*Math.min(ne,oe);H.push(J.call(this,U,ye,me)),ne-=Math.abs(me-ye),ye=me}return H},J=function(U,W,Z){var de=(Z-W)/2,be=U*Math.cos(de),oe=U*Math.sin(de),ne=be,H=-oe,le=ne*ne+H*H,ye=le+ne*be+H*oe,me=4/3*(Math.sqrt(2*le*ye)-ye)/(ne*oe-H*be),ke=ne-me*H,Ie=H+me*ne,ce=ke,Be=-Ie,ct=de+W,Ve=Math.cos(ct),Ne=Math.sin(ct);return{x1:U*Math.cos(W),y1:U*Math.sin(W),x2:ke*Ve-Ie*Ne,y2:ke*Ne+Ie*Ve,x3:ce*Ve-Be*Ne,y3:ce*Ne+Be*Ve,x4:U*Math.cos(Z),y4:U*Math.sin(Z)}},re=function(U){return 180*U/Math.PI},se=function(U,W,Z,de,be,oe){var ne=U+.5*(Z-U),H=W+.5*(de-W),le=be+.5*(Z-be),ye=oe+.5*(de-oe),me=Math.min(U,be,ne,le),ke=Math.max(U,be,ne,le),Ie=Math.min(W,oe,H,ye),ce=Math.max(W,oe,H,ye);return new l(me,Ie,ke-me,ce-Ie)},ee=function(U,W,Z,de,be,oe,ne,H){var le,ye,me,ke,Ie,ce,Be,ct,Ve,Ne,Ye,St,Vt,Lt,at=Z-U,gt=de-W,vt=be-Z,ft=oe-de,ot=ne-be,ut=H-oe;for(ye=0;ye<41;ye++)Ve=(Be=(me=U+(le=ye/40)*at)+le*((Ie=Z+le*vt)-me))+le*(Ie+le*(be+le*ot-Ie)-Be),Ne=(ct=(ke=W+le*gt)+le*((ce=de+le*ft)-ke))+le*(ce+le*(oe+le*ut-ce)-ct),ye==0?(Ye=Ve,St=Ne,Vt=Ve,Lt=Ne):(Ye=Math.min(Ye,Ve),St=Math.min(St,Ne),Vt=Math.max(Vt,Ve),Lt=Math.max(Lt,Ne));return new l(Math.round(Ye),Math.round(St),Math.round(Vt-Ye),Math.round(Lt-St))},q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var U,W,Z=(U=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:U,lineDashOffset:W}));this.prevLineDash!==Z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Z)}}})(Cr.API),(function(t){var e=function(o){var l,c,u,h,p,m,g,b,v,w;for(c=[],u=0,h=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;h>u;u+=4)(p=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(m=(p=((p=((p=((p=(p-(w=p%85))/85)-(v=p%85))/85)-(b=p%85))/85)-(g=p%85))/85)%85,c.push(m+33,g+33,b+33,v+33,w+33)):c.push(122);return(function(j,_){for(var E=_;E>0;E--)j.pop()})(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,h,p,m=String,g="length",b=255,v="charCodeAt",w="slice",j="replace";for(o[w](-2),o=o[w](0,-2)[j](/\s/g,"")[j]("z","!!!!!"),u=[],h=0,p=(o+=l="uuuuu"[w](o[g]%5||5))[g];p>h;h+=5)c=52200625*(o[v](h)-33)+614125*(o[v](h+1)-33)+7225*(o[v](h+2)-33)+85*(o[v](h+3)-33)+(o[v](h+4)-33),u.push(b&c>>24,b&c>>16,b&c>>8,b&c);return(function(_,E){for(var I=E;I>0;I--)_.pop()})(u,l[g]),m.fromCharCode.apply(m,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=jT(l)).reduce(function(u,h){return u+String.fromCharCode(h)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",h=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:h.reverse().join(" ")}}})(Cr.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(c,u,h){var p=new XMLHttpRequest,m=0,g=function(b){var v=b.length,w=[],j=String.fromCharCode;for(m=0;m<v;m+=1)w.push(j(255&b.charCodeAt(m)));return w.join("")};if(p.open("GET",c,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?h(g(this.responseText)):h(void 0)}),p.send(null),u&&p.status===200)return g(p.responseText)})(i,a,o)}catch{}return l})(e,r,n)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Cr.API),(function(t){function e(){return(Gr.html2canvas?Promise.resolve(Gr.html2canvas):dN(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Gr.DOMPurify?Promise.resolve(Gr.DOMPurify):dN(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=ms(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var h in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[h]=c.style[h];return u},a=function l(c,u){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),h=l.convert(Promise.resolve(),u);return(h=h.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||(function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,h=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=h,h)for(var g=0;g<h.length;++g){var b=h[g],v=b.src.find(function(w){return w.format==="truetype"});v&&u.addFont(v.url,b.ref.name,b.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,u.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,h){return Math.floor(u*h/72*96)}return this.then(function(){(l=l||Cr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,h){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,h){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,h?this.progress.stack.concat(h):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(h,p){return u.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(m){return u.updateProgress(null,h),m}).then(h,p).then(function(m){return u.updateProgress(1),m})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var h=this;l&&(l=l.bind(h)),c&&(c=c.bind(h));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:o.convert(Object.assign({},h),Promise.prototype),m=u.call(p,l,c);return o.convert(m,h.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Cr.getPageSize=function(l,c,u){if(ms(l)==="object"){var h=l;l=h.orientation,c=h.unit||c,u=h.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var p,m=(""+u).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var b,v=0,w=0;if(g.hasOwnProperty(m))v=g[m][1]/p,w=g[m][0]/p;else try{v=u[1],w=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",w>v&&(b=w,w=v,v=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",v>w&&(b=w,w=v,v=b)}return{width:w,height:v,unit:c,k:p,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(FC):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}})(Cr.API),Cr.API.addJS=function(t){return UU=t,this.internal.events.subscribe("postPutResources",function(){p5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(p5+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),FU=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+UU+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){p5!==void 0&&FU!==void 0&&this.internal.out("/Names <</JavaScript "+p5+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(a=0;a<u;a++){var p=r.internal.newObject();h.push(p);var m=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<h.length;a++)r.internal.write("(page_"+(a+1)+")"+h[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var o={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(Cr.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,o,l){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(p){for(var m,g=256*p.charCodeAt(4)+p.charCodeAt(5),b=p.length,v={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=g,e.indexOf(p.charCodeAt(w+1))!==-1){m=256*p.charCodeAt(w+5)+p.charCodeAt(w+6),v={width:256*p.charCodeAt(w+7)+p.charCodeAt(w+8),height:m,numcomponents:p.charCodeAt(w+9)};break}g=256*p.charCodeAt(w+2)+p.charCodeAt(w+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return h}})(Cr.API),Cr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=JLe(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,u=a.palette,h=a.depth;i=u&&c===1?(function(T){for(var M=T.width,$=T.height,k=T.data,L=T.palette,R=T.depth,V=!1,Y=[],X=[],J=void 0,re=!1,se=0,ee=0;ee<L.length;ee++){var q=HF(L[ee],4),U=q[0],W=q[1],Z=q[2],de=q[3];Y.push(U,W,Z),de!=null&&(de===0?(se++,X.length<1&&X.push(ee)):de<255&&(re=!0))}if(re||se>1){V=!0,X=void 0;var be=M*$;J=new Uint8Array(be);for(var oe=new DataView(k.buffer),ne=0;ne<be;ne++){var H=zC(oe,ne,R),le=HF(L[H],4)[3];J[ne]=le}}else se===0&&(X=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:V?8:void 0,colorBytes:k,alphaBytes:J,needSMask:V,palette:Y,mask:X}})(a):c===2||c===4?(function(T){for(var M=T.data,$=T.width,k=T.height,L=T.channels,R=T.depth,V=L===2?"DeviceGray":"DeviceRGB",Y=L-1,X=$*k,J=Y,re=X*J,se=1*X,ee=Math.ceil(re*R/8),q=Math.ceil(se*R/8),U=new Uint8Array(ee),W=new Uint8Array(q),Z=new DataView(M.buffer),de=new DataView(U.buffer),be=new DataView(W.buffer),oe=!1,ne=0;ne<X;ne++){for(var H=ne*L,le=0;le<J;le++)XU(de,zC(Z,H+le,R),ne*J+le,R);var ye=zC(Z,H+J,R);ye<(1<<R)-1&&(oe=!0),XU(be,ye,1*ne,R)}return{colorSpace:V,colorsPerPixel:Y,sMaskBitsPerComponent:oe?R:void 0,colorBytes:U,alphaBytes:W,needSMask:oe}})(a):(function(T){var M=T.data,$=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:$,colorsPerPixel:$==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?(function(k){for(var L=k.length,R=new Uint8Array(2*L),V=new DataView(R.buffer,R.byteOffset,R.byteLength),Y=0;Y<L;Y++)V.setUint16(2*Y,k[Y],!1);return R})(M):M,needSMask:!1}})(a);var p,m,g,b=i,v=b.colorSpace,w=b.colorsPerPixel,j=b.sMaskBitsPerComponent,_=b.colorBytes,E=b.alphaBytes,I=b.needSMask,O=b.palette,B=b.mask,S=null;return n!==Cr.API.image_compression.NONE&&typeof jT=="function"?(S=(function(T){var M;switch(T){case Cr.API.image_compression.FAST:M=11;break;case Cr.API.image_compression.MEDIUM:M=13;break;case Cr.API.image_compression.SLOW:M=14;break;default:M=12}return M})(n),p=this.decode.FLATE_DECODE,m="/Predictor ".concat(S," /Colors ").concat(w," /BitsPerComponent ").concat(h," /Columns ").concat(o),t=HU(_,Math.ceil(o*w*h/8),w,h,n),I&&(g=HU(E,Math.ceil(o*j/8),1,j,n))):(p=void 0,m=void 0,t=_,I&&(g=E)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:p,decodeParameters:m,transparency:B,palette:O,sMask:g,predictor:S,width:o,height:l,bitsPerComponent:h,sMaskBitsPerComponent:j,colorSpace:v}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new yPe(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},h=new qC(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)},t.processGIF87A=t.processGIF89A})(Cr.API),_u.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},_u.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Rs.log("bit decode error:"+r)}},_u.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},_u.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=a>>4,c=15&a,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},_u.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},_u.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,u=a>>15?255:0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=u}this.pos+=t}},_u.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,h=i*this.width*4+4*a;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},_u.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},_u.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},_u.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new _u(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new qC(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}})(Cr.API),JU.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new JU(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new qC(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}})(Cr.API),Cr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var h=n[u],p=n[u+1],m=n[u+2],g=n[u+3];a[l++]=h,a[l++]=p,a[l++]=m,o[c++]=g}var b=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Cr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ug=Cr.API,m5=Ug.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,p=e.doKerning!==!1,m=0,g=t.length,b=0,v=l[0]||c,w=[];for(r=0;r<g;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?w.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(m=p&&ms(u[n])==="object"&&!isNaN(parseInt(u[n][b],10))?u[n][b]/h:0,w.push((l[n]||v)/c+m)),b=n;return w},zU=Ug.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Ug.processArabic&&(t=Ug.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:m5.apply(this,arguments).reduce(function(a,o){return a+o},0)},qU=function(t,e,r,n){for(var i=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;i.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(i.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},VU=function(t,e,r){r||(r={});var n,i,a,o,l,c,u,h=[],p=[h],m=r.textIndent||0,g=0,b=0,v=t.split(" "),w=m5.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var j=Array(c).join(" "),_=[];v.map(function(I){(I=I.split(/\s*\n/)).length>1?_=_.concat(I.map(function(O,B){return(B&&O.length?`
`:"")+O})):_.push(I[0])}),v=_,c=zU.apply(this,[j,r])}for(a=0,o=v.length;a<o;a++){var E=0;if(n=v[a],c&&n[0]==`
`&&(n=n.substr(1),E=1),m+g+(b=(i=m5.apply(this,[n,r])).reduce(function(I,O){return I+O},0))>e||E){if(b>e){for(l=qU.apply(this,[n,i,e-(m+g),e]),h.push(l.shift()),h=[l.pop()];l.length;)p.push([l.shift()]);b=i.slice(n.length-(h[0]?h[0].length:0)).reduce(function(I,O){return I+O},0)}else h=[n];p.push(h),m=b+c,g=w}else h.push(n),m+=g+b,g=w}return u=c?function(I,O){return(O?j:"")+I.join(" ")}:function(I){return I.join(" ")},p.map(u)},Ug.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var p=this.internal.getFont(h.fontName,h.fontStyle),m="Unicode";return p.metadata[m]?{widths:p.metadata[m].widths||{0:1},kerning:p.metadata[m].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(VU.apply(this,[n[l],o,a]));return u},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var o=function(m){return"0x"+parseInt(m,10).toString(16)},l=t.__fontmetrics__.compress=function(m){var g,b,v,w,j=["{"];for(var _ in m){if(g=m[_],isNaN(parseInt(_,10))?b="'"+_+"'":(_=parseInt(_,10),b=(b=o(_).slice(2)).slice(0,-1)+i[b.slice(-1)]),typeof g=="number")g<0?(v=o(g).slice(3),w="-"):(v=o(g).slice(2),w=""),v=w+v.slice(0,-1)+i[v.slice(-1)];else{if(ms(g)!=="object")throw new Error("Don't know what to do with value type "+ms(g)+".");v=l(g)}j.push(b+v)}return j.push("}"),j.join("")},c=t.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,v,w,j={},_=1,E=j,I=[],O="",B="",S=m.length-1,T=1;T<S;T+=1)(w=m[T])=="'"?g?(v=g.join(""),g=void 0):g=[]:g?g.push(w):w=="{"?(I.push([E,v]),E={},v=void 0):w=="}"?((b=I.pop())[0][b[1]]=E,v=void 0,E=b[0]):w=="-"?_=-1:v===void 0?n.hasOwnProperty(w)?(O+=n[w],v=parseInt(O,16)*_,_=1,O=""):O+=w:n.hasOwnProperty(w)?(B+=n[w],E[v]=parseInt(B,16)*_,_=1,v=void 0,B=""):B+=w;return j},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(m){var g=m.font,b=p.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var v=h.Unicode[g.postScriptName];v&&(g.metadata.Unicode.encoding=v,g.encoding=v.codePages[0])}])})(Cr.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(fN(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])})(Cr),Cr.API.addSvgAsImage=function(t,e,r,n,i,a,o,l){if(isNaN(e)||isNaN(r))throw Rs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Rs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(Gr.canvg?Promise.resolve(Gr.canvg):dN(()=>import("./index.es-D_ZvTbOw.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,o,l)})},Cr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},Cr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,h=0,p=0;function m(b,v){var w,j=!1;for(w=0;w<b.length;w+=1)b[w]===v&&(j=!0);return j}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=l.length;for(p=0;p<g;p+=1)r[l[p]].value=r[l[p]].defaultValue,r[l[p]].explicitSet=!1}if(ms(t)==="object"){for(i in t)if(a=t[i],m(l,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&m(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")c.push(String(a[u]-1));else if(a[u].length>1){for(h=0;h<a[u].length;h+=1)typeof a[u][h]!="number"&&(n=!1);n===!0&&c.push([a[u][0]-1,a[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,v=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?v.push("/"+b+" /"+r[b].value):v.push("/"+b+" "+r[b].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(Cr.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],p=0,m=a.length;p<m;++p){if(l=o.metadata.characterToGlyph(a.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(u[4-l.length],l)}return h.join("")},n=function(a){var o,l,c,u,h,p,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,m=(l=Object.keys(a).sort(function(g,b){return g-b})).length;p<m;p++)o=l[p],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(u=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,h=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),g="",b=0;b<m.length;b++)g+=String.fromCharCode(m[b]);var v=u();h({data:g,addLength1:!0,objectId:v}),c("endobj");var w=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var j=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+rx(l.fontName)),c("/FontFile2 "+v+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var _=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+rx(l.fontName)),c("/FontDescriptor "+j+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+rx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+_+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,h=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,m="",g=0;g<p.length;g++)m+=String.fromCharCode(p[g]);var b=u();h({data:m,addLength1:!0,objectId:b}),c("endobj");var v=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var w=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+b+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+rx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var j=0;j<l.metadata.hmtx.widths.length;j++)l.metadata.hmtx.widths[j]=parseInt(l.metadata.hmtx.widths[j]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+rx(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,l=a.text||"",c=a.x,u=a.y,h=a.options||{},p=a.mutex||{},m=p.pdfEscape,g=p.activeFontKey,b=p.fonts,v=g,w="",j=0,_="",E=b[v].encoding;if(b[v].encoding!=="Identity-H")return{text:l,x:c,y:u,options:h,mutex:p};for(_=l,v=g,Array.isArray(l)&&(_=l[0]),j=0;j<_.length;j+=1)b[v].metadata.hasOwnProperty("cmap")&&(o=b[v].metadata.cmap.unicode.codeMap[_[j].charCodeAt(0)]),o||_[j].charCodeAt(0)<256&&b[v].metadata.hasOwnProperty("Unicode")?w+=_[j]:w+="";var I="";return parseInt(v.slice(1))<14||E==="WinAnsiEncoding"?I=m(w,v).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(I=r(w,b[v])),p.isHex=!0,{text:I,x:c,y:u,options:h,mutex:p}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);a.text=l}else a.text=i(Object.assign({},c,{text:o})).text}])})(Cr),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(Cr.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,o,l,c,u,h,p=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],j=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,E=0;this.__bidiEngine__={};var I=function(k){var L=k.charCodeAt(),R=L>>8,V=v[R];return V!==void 0?p[256*V+(255&L)]:R===252||R===253?"AL":j.test(R)?"L":R===8?"R":"N"},O=function(k){for(var L,R=0;R<k.length;R++){if((L=I(k.charAt(R)))==="L")return!1;if(L==="R")return!0}return!1},B=function(k,L,R,V){var Y,X,J,re,se=L[V];switch(se){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"N":case"AN":break;case"EN":_&&(se="AN");break;case"AL":_=!0,se="R";break;case"WS":case"BN":se="N";break;case"CS":V<1||V+1>=L.length||(Y=R[V-1])!=="EN"&&Y!=="AN"||(X=L[V+1])!=="EN"&&X!=="AN"?se="N":_&&(X="AN"),se=X===Y?X:"N";break;case"ES":se=(Y=V>0?R[V-1]:"B")==="EN"&&V+1<L.length&&L[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&R[V-1]==="EN"){se="EN";break}if(_){se="N";break}for(J=V+1,re=L.length;J<re&&L[J]==="ET";)J++;se=J<re&&L[J]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(re=L.length,J=V+1;J<re&&L[J]==="NSM";)J++;if(J<re){var ee=k[V],q=ee>=1425&&ee<=2303||ee===64286;if(Y=L[J],q&&(Y==="R"||Y==="AL")){se="R";break}}}se=V<1||(Y=L[V-1])==="B"?"N":R[V-1];break;case"B":_=!1,i=!0,se=E;break;case"S":a=!0,se="N"}return se},S=function(k,L,R){var V=k.split("");return R&&T(V,R,{hiLevel:E}),V.reverse(),L&&L.reverse(),V.join("")},T=function(k,L,R){var V,Y,X,J,re,se=-1,ee=k.length,q=0,U=[],W=E?g:m,Z=[];for(_=!1,i=!1,a=!1,Y=0;Y<ee;Y++)Z[Y]=I(k[Y]);for(X=0;X<ee;X++){if(re=q,U[X]=B(k,Z,U,X),V=240&(q=W[re][b[U[X]]]),q&=15,L[X]=J=W[q][5],V>0)if(V===16){for(Y=se;Y<X;Y++)L[Y]=1;se=-1}else se=-1;if(W[q][6])se===-1&&(se=X);else if(se>-1){for(Y=se;Y<X;Y++)L[Y]=J;se=-1}Z[X]==="B"&&(L[X]=0),R.hiLevel|=J}a&&(function(de,be,oe){for(var ne=0;ne<oe;ne++)if(de[ne]==="S"){be[ne]=E;for(var H=ne-1;H>=0&&de[H]==="WS";H--)be[H]=E}})(Z,L,ee)},M=function(k,L,R,V,Y){if(!(Y.hiLevel<k)){if(k===1&&E===1&&!i)return L.reverse(),void(R&&R.reverse());for(var X,J,re,se,ee=L.length,q=0;q<ee;){if(V[q]>=k){for(re=q+1;re<ee&&V[re]>=k;)re++;for(se=q,J=re-1;se<J;se++,J--)X=L[se],L[se]=L[J],L[J]=X,R&&(X=R[se],R[se]=R[J],R[J]=X);q=re}q++}}},$=function(k,L,R){var V=k.split(""),Y={hiLevel:E};return R||(R=[]),T(V,R,Y),(function(X,J,re){if(re.hiLevel!==0&&h)for(var se,ee=0;ee<X.length;ee++)J[ee]===1&&(se=w.indexOf(X[ee]))>=0&&(X[ee]=w[se+1])})(V,R,Y),M(2,V,L,R,Y),M(1,V,L,R,Y),V.join("")};return this.__bidiEngine__.doBidiReorder=function(k,L,R){if((function(Y,X){if(X)for(var J=0;J<Y.length;J++)X[J]=J;l===void 0&&(l=O(Y)),u===void 0&&(u=O(Y))})(k,L),o||!c||u)if(o&&c&&l^u)E=l?1:0,k=S(k,L,R);else if(!o&&c&&u)E=l?1:0,k=$(k,L,R),k=S(k,L);else if(!o||l||c||u){if(o&&!c&&l^u)k=S(k,L),l?(E=0,k=$(k,L,R)):(E=1,k=$(k,L,R),k=S(k,L));else if(o&&l&&!c&&u)E=1,k=$(k,L,R),k=S(k,L);else if(!o&&!c&&l^u){var V=h;l?(E=1,k=$(k,L,R),E=0,h=!1,k=$(k,L,R),h=V):(E=0,k=$(k,L,R),k=S(k,L),E=1,h=!1,k=$(k,L,R),h=V,k=S(k,L))}}else E=0,k=$(k,L,R);else E=l?1:0,k=$(k,L,R);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,h=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(Cr),Cr.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new M0(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new OPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new vPe(this.contents),this.head=new NPe(this),this.name=new CPe(this),this.cmap=new Ute(this),this.toUnicode={},this.hhea=new jPe(this),this.maxp=new EPe(this),this.hmtx=new APe(this),this.post=new _Pe(this),this.os2=new kPe(this),this.loca=new PPe(this),this.glyf=new TPe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var td,M0=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),vPe=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,o,l,c,u,h,p,m,g,b,v;for(v in g=Object.keys(r).length,c=Math.log(2),p=16*Math.floor(Math.log(g)/c),o=Math.floor(p/c),h=16*g-p,(i=new M0).writeInt(this.scalarType),i.writeShort(g),i.writeShort(p),i.writeShort(o),i.writeShort(h),a=16*g,u=i.pos+a,l=null,b=[],r)for(m=r[v],i.writeString(v),i.writeInt(t(m)),i.writeInt(u),i.writeInt(m.length),b=b.concat(m),v==="head"&&(l=u),u+=m.length;u%4;)b.push(0),u++;return i.write(b),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,o;for(r=zte.call(r);r.length%4;)r.push(0);for(a=new M0(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),wPe={}.hasOwnProperty,Zd=function(t,e){for(var r in e)wPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};td=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var NPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new M0).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),ZU=(function(){function t(e,r){var n,i,a,o,l,c,u,h,p,m,g,b,v,w,j,_,E;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(g=e.readUInt16(),m=g/2,e.pos+=6,a=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),e.pos+=2,v=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),u=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),h=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),i=(this.length-e.pos+this.offset)/2,l=(function(){var I,O;for(O=[],c=I=0;0<=i?I<i:I>i;c=0<=i?++I:--I)O.push(e.readUInt16());return O})(),c=j=0,E=a.length;j<E;c=++j)for(w=a[c],n=_=b=v[c];b<=w?_<=w:_>=w;n=b<=w?++_:--_)h[c]===0?o=n+u[c]:(o=l[h[c]/2+(n-b)-(m-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=p}return t.encode=function(e,r){var n,i,a,o,l,c,u,h,p,m,g,b,v,w,j,_,E,I,O,B,S,T,M,$,k,L,R,V,Y,X,J,re,se,ee,q,U,W,Z,de,be,oe,ne,H,le,ye,me;switch(V=new M0,o=Object.keys(e).sort(function(ke,Ie){return ke-Ie}),r){case"macroman":for(v=0,w=(function(){var ke=[];for(b=0;b<256;++b)ke.push(0);return ke})(),_={0:0},a={},Y=0,se=o.length;Y<se;Y++)_[H=e[i=o[Y]]]==null&&(_[H]=++v),a[i]={old:e[i],new:_[e[i]]},w[i]=_[e[i]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(w),{charMap:a,subtable:V.data,maxGlyphID:v+1};case"unicode":for(L=[],p=[],E=0,_={},n={},j=u=null,X=0,ee=o.length;X<ee;X++)_[O=e[i=o[X]]]==null&&(_[O]=++E),n[i]={old:O,new:_[O]},l=_[O]-i,j!=null&&l===u||(j&&p.push(j),L.push(i),u=l),j=i;for(j&&p.push(j),p.push(65535),L.push(65535),$=2*(M=L.length),T=2*Math.pow(Math.log(M)/Math.LN2,2),m=Math.log(T/2)/Math.LN2,S=2*M-T,c=[],B=[],g=[],b=J=0,q=L.length;J<q;b=++J){if(k=L[b],h=p[b],k===65535){c.push(0),B.push(0);break}if(k-(R=n[k].new)>=32768)for(c.push(0),B.push(2*(g.length+M-b)),i=re=k;k<=h?re<=h:re>=h;i=k<=h?++re:--re)g.push(n[i].new);else c.push(R-k),B.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*M+2*g.length),V.writeUInt16(0),V.writeUInt16($),V.writeUInt16(T),V.writeUInt16(m),V.writeUInt16(S),oe=0,U=p.length;oe<U;oe++)i=p[oe],V.writeUInt16(i);for(V.writeUInt16(0),ne=0,W=L.length;ne<W;ne++)i=L[ne],V.writeUInt16(i);for(le=0,Z=c.length;le<Z;le++)l=c[le],V.writeUInt16(l);for(ye=0,de=B.length;ye<de;ye++)I=B[ye],V.writeUInt16(I);for(me=0,be=g.length;me<be;me++)v=g[me],V.writeUInt16(v);return{charMap:n,subtable:V.data,maxGlyphID:E+1}}},t})(),Ute=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new ZU(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=ZU.encode(e,r),(i=new M0).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),jPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),kPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),_Pe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t})(),SPe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},CPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,o,l,c,u,h,p,m;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=h=0,p=n.length;h<p;a=++h)i=n[a],e.pos=i.offset,u=e.readString(i.length),o=new SPe(u,i),c[m=i.nameID]==null&&(c[m]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),EPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),APe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,h;for(h=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)h.push(e.readInt16());return h})(),this.widths=(function(){var u,h,p,m;for(m=[],u=0,h=(p=this.metrics).length;u<h;u++)a=p[u],m.push(a.advance);return m}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),zte=[].slice,TPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,o,l,c,u,h,p;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new M0(r.read(i))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),h=l.readShort(),this.cache[e]=o===-1?new LPe(l,u,p,c,h):new IPe(l,o,u,p,c,h),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)i=e[r[l]],a.push(o.length),i&&(o=o.concat(i.encode(n)));return a.push(o.length),{table:o,offsets:a}},t})(),IPe=(function(){function t(e,r,n,i,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),LPe=(function(){function t(e,r,n,i,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new M0(zte.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),PPe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Zd(t,td),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<n.length;++o)if(n[o]=i,a<r.length&&r[a]==o){++a,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),h=0;h<n.length;++h)u[4*h+3]=255&n[h],u[4*h+2]=(65280&n[h])>>8,u[4*h+1]=(16711680&n[h])>>16,u[4*h]=(4278190080&n[h])>>24;return u},t})(),OPe=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,o,l,c,u,h,p,m,g,b,v,w,j;for(i in n=Ute.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),g={0:0},j=n.charMap)g[(c=j[i]).old]=c.new;for(b in m=n.maxGlyphID,o)b in g||(g[b]=m++);return h=(function(_){var E,I;for(E in I={},_)I[_[E]]=E;return I})(g),p=Object.keys(h).sort(function(_,E){return _-E}),v=(function(){var _,E,I;for(I=[],_=0,E=p.length;_<E;_++)l=p[_],I.push(h[l]);return I})(),a=this.font.glyf.encode(o,v,g),u=this.font.loca.encode(a.offsets,v),w={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();Cr.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,o;if(Array.isArray(r))return"["+(function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)o=r[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e})();const RPe={async generatePDF(t,e={paperSize:"letter",cutLines:!0},r){const a={letter:{width:215.9,height:279.4},a4:{width:210,height:297}},o=new Cr({orientation:"portrait",unit:"mm",format:e.paperSize}),l=a[e.paperSize].width,c=a[e.paperSize].height,u=3,h=3,p=u*h,m=u*63,g=h*88,b=(l-m)/2,v=(c-g)/2,w=async _=>{try{const E=`/api/proxy/image?url=${encodeURIComponent(_)}`,I=await fetch(E);if(!I.ok)throw new Error(`Failed to fetch image: ${I.statusText}`);const O=await I.blob();return new Promise((B,S)=>{const T=new FileReader;T.onloadend=()=>B(T.result),T.onerror=S,T.readAsDataURL(O)})}catch(E){return console.error("Image load failed",_,E),null}},j=t.length;for(let _=0;_<j;_++){r&&r(_+1,j),_>0&&_%p===0&&o.addPage();const E=_%p,I=E%u,O=Math.floor(E/u),B=b+I*63,S=v+O*88,T=t[_],M=T.image_uri||T.image_uris?.normal||T.data?.image_uris?.normal||T.card_faces?.[0]?.image_uris?.normal||T.data?.card_faces?.[0]?.image_uris?.normal;let $=!1;if(M)try{const k=await w(M);k&&(o.addImage(k,"JPEG",B,S,63,88),$=!0)}catch(k){console.error("Error adding image to PDF",k)}if(!$){o.setDrawColor(0),o.rect(B,S,63,88),o.setFontSize(10);const k=o.splitTextToSize(T.name,53);if(o.text(k,B+5,S+10),o.setFontSize(8),T.mana_cost&&o.text(T.mana_cost,B+5,S+20),T.type_line){const L=o.splitTextToSize(T.type_line,53);o.text(L,B+5,S+30)}}e.cutLines&&(o.setDrawColor(200,200,200),o.rect(B,S,63,88))}return o}},MPe=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{addToast:i}=jn(),[a,o]=y.useState("letter"),[l,c]=y.useState(!0),[u,h]=y.useState(!1),[p,m]=y.useState(0);if(!t)return null;const g=async()=>{h(!0),m(0);try{(await RPe.generatePDF(r,{paperSize:a,cutLines:l},(v,w)=>{m(Math.round(v/w*100))})).save(`${n}_Proxies.pdf`),i("PDF ready for download!","success"),e()}catch(b){console.error(b),i("Failed to generate PDF","error")}finally{h(!1)}};return s.jsx(Vh,{appear:!0,show:t,as:y.Fragment,children:s.jsxs(_0,{as:"div",className:"relative z-[100]",onClose:u?()=>{}:e,children:[s.jsx(Vh.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),s.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:s.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:s.jsx(Vh.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:s.jsxs(_0.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-gray-900 border border-gray-700 shadow-2xl transition-all text-left align-middle",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[s.jsxs(_0.Title,{as:"h2",className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Print Proxies"]}),s.jsx("button",{onClick:e,disabled:u,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg text-sm text-blue-200",children:["Generates a checklist or visual proxies for playtesting. ",s.jsx("br",{}),s.jsxs("strong",{children:[r.length," cards"]})," selected."]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Paper Size"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:()=>o("letter"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="letter"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"Letter (8.5 x 11)"}),s.jsx("button",{onClick:()=>o("a4"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="a4"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"A4 (210 x 297mm)"})]})]}),s.jsx("div",{children:s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg border border-gray-700 cursor-pointer hover:bg-gray-750 transition-colors",children:[s.jsx("input",{type:"checkbox",checked:l,onChange:b=>c(b.target.checked),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300 font-medium",children:"Show Cut Lines"})]})}),u&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs text-indigo-300 font-bold uppercase",children:[s.jsx("span",{children:"Generating PDF..."}),s.jsxs("span",{children:[p,"%"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:`${p}%`}})})]}),s.jsx("button",{onClick:g,disabled:u,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-sm shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:u?"Processing...":"Download PDF"})]})]})})})})]})})},g5=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],DPe=()=>{const{deckId:t}=yl(),e=xn(),{currentUser:r,userProfile:n,updateSettings:i}=Or(),{addToast:a}=jn(),o=n?.settings?.helper?.name||"The Oracle",[l,c]=y.useState(!1),[u,h]=y.useState(!1),[p,m]=y.useState(!1),[g,b]=y.useState(!1),[v,w]=y.useState(!1),[j,_]=y.useState(""),[E,I]=y.useState(0),[O,B]=y.useState(!1),[S,T]=y.useState(!1),[M,$]=y.useState(new Set),k=Ee=>{const Me=new Set(M);Me.has(Ee)?Me.delete(Ee):Me.add(Ee),$(Me)},L=()=>{M.size===Ye.length?$(new Set):$(new Set(Ye.map(Ee=>Ee.id)))},R=async()=>{if(M.size===0)return;const Ee=Ne.is_mockup?"delete":"remove",Me=M.size;if(window.confirm(`Are you sure you want to ${Ee==="delete"?"delete":"remove"} ${Me} cards?`))try{await Xo.batchRemoveCards(r.uid,t,Array.from(M),Ee),a(`Successfully removed ${Me} cards`,"success"),T(!1),$(new Set),window.location.reload()}catch(Je){console.error(Je),a("Failed to remove cards","error")}},[V,Y]=y.useState({}),[X,J]=y.useState(!1),[re,se]=y.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[ee,q]=y.useState(!1),[U,W]=y.useState(!1),[Z,de]=y.useState(!1),[be,oe]=y.useState(!1),[ne,H]=y.useState(!1),le=y.useRef(null),[ye,me]=y.useState(!0),[ke,Ie]=y.useState(n?.settings?.deckViewMode||"grid");y.useEffect(()=>{const Ee=Me=>{le.current&&!le.current.contains(Me.target)&&H(!1)};return document.addEventListener("mousedown",Ee),()=>document.removeEventListener("mousedown",Ee)},[]);const[ce,Be]=y.useState(!1);y.useEffect(()=>{const Ee=()=>Be(!0);return window.addEventListener("start-tour",Ee),localStorage.getItem("tour_seen_deck_details_v1")||setTimeout(()=>Be(!0),1e3),()=>window.removeEventListener("start-tour",Ee)},[]);const ct=[{target:"h2",title:"Deck Command",content:"Rename your deck, see its colors, and track its stats."},{target:"#deck-identity-badge",title:"Identity & Theme",content:"Automatically detected color identity and archetype theme."},{target:"#deck-stats-bar",title:"Vital Stats",content:"Track power level, value, and mana curve brackets."},{target:"#deck-tools-trigger",title:"Tools & Strategy",content:"Access AI strategy analysis, Mana Curve Doctor, and more."}],Ve=Ee=>{Ie(Ee),i({deckViewMode:Ee})},{deck:Ne,cards:Ye,loading:St,error:Vt,refresh:Lt}=HL(t),{decks:at}=z0(),{cards:gt}=vl(),vt=Ne?.permissionLevel||"viewer",ft=vt==="owner",ot=vt==="owner"||vt==="editor",ut=y.useMemo(()=>{if(Ne?.format?.toLowerCase()==="standard"){const tr=Ne.colors||Ne.commander?.color_identity||[];return g5.find(Kr=>Kr.colors.length!==tr.length?!1:Kr.colors.every($s=>tr.includes($s)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const Ee=Ne?.commander?.color_identity||[],Me=Ne?.commander_partner?.color_identity||[],Je=[...new Set([...Ee,...Me])];return!Ne||Je.length===0?g5.find(tr=>tr.badge==="Colorless"):g5.find(tr=>tr.colors.length!==Je.length?!1:tr.colors.every(Rr=>Je.includes(Rr)))||g5.find(tr=>tr.badge==="Colorless")},[Ne]),At=y.useMemo(()=>{if(!gt)return new Set;const Ee=new Set;return gt.forEach(Me=>{Me.finish==="foil"&&!Me.deckId&&Ee.add(Me.name)}),Ee},[gt]),Fe=Ee=>{if(!Ye)return 0;let Me=Ye.reduce((Je,Ft)=>(Ft.data?.type_line||Ft.type_line||"").includes(Ee)?Je+(Ft.countInDeck||1):Je,0);return Ne?.commander&&!Ye.some(Je=>Je.scryfall_id===(Ne.commander.id||Ne.commander.scryfall_id)||Je.oracle_id&&Je.oracle_id===Ne.commander.oracle_id)&&(Ne.commander.type_line||"").includes(Ee)&&Me++,Ne?.commander_partner&&!Ye.some(Je=>Je.scryfall_id===(Ne.commander_partner.id||Ne.commander_partner.scryfall_id)||Je.oracle_id&&Je.oracle_id===Ne.commander_partner.oracle_id)&&(Ne.commander_partner.type_line||"").includes(Ee)&&Me++,Me},Ut=y.useMemo(()=>{if(!Ye)return 0;let Ee=Ye.reduce((Me,Je)=>Me+(Je.countInDeck||1),0);return Ne?.commander&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander.id||Ne.commander.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander.oracle_id)&&Ee++,Ne?.commander_partner&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander_partner.id||Ne.commander_partner.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander_partner.oracle_id)&&Ee++,Ee},[Ye,Ne]),jt=y.useMemo(()=>{if(!Ye)return 0;let Ee=Ye.filter(Me=>!Me.is_wishlist).reduce((Me,Je)=>Me+(Je.countInDeck||1),0);return Ne?.commander&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander.id||Ne.commander.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander.oracle_id)&&Ee++,Ne?.commander_partner&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander_partner.id||Ne.commander_partner.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander_partner.oracle_id)&&Ee++,Ee},[Ye,Ne]),qe=y.useMemo(()=>{if(!Ye)return 0;let Ee=Ye.reduce((Me,Je)=>{const Ft=parseFloat(Je.prices?.[Je.finish==="foil"?"usd_foil":"usd"])||parseFloat(Je.data?.prices?.[Je.finish==="foil"?"usd_foil":"usd"])||0;return Me+Ft*(Je.countInDeck||1)},0);if(Ne?.commander&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander.id||Ne.commander.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander.oracle_id)){const Me=Ne.commander,Je=parseFloat(Me.prices?.[Me.finish==="foil"?"usd_foil":"usd"])||0;Ee+=Je}if(Ne?.commander_partner&&!Ye.some(Me=>Me.scryfall_id===(Ne.commander_partner.id||Ne.commander_partner.scryfall_id)||Me.oracle_id&&Me.oracle_id===Ne.commander_partner.oracle_id)){const Me=Ne.commander_partner,Je=parseFloat(Me.prices?.[Me.finish==="foil"?"usd_foil":"usd"])||0;Ee+=Je}return Ee},[Ye,Ne]),rt=y.useMemo(()=>{const Ee=Ne?.aiBlueprint||{},Me=Ee.layout?.types||Ee.suggestedCounts||{};return[{label:"Total",current:Ut,target:Ne?.format?.toLowerCase()==="standard"||Ne?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:Fe("Creature"),target:Me.Creatures||Me.Creature||30},{label:"Lands",current:Fe("Land"),target:Me.Lands||Me.Land||36},{label:"Instants",current:Fe("Instant"),target:Me.Instants||Me.Instant||10},{label:"Sorceries",current:Fe("Sorcery"),target:Me.Sorceries||Me.Sorcery||10},{label:"Enchantments",current:Fe("Enchantment"),target:Me.Enchantments||Me.Enchantment||5},{label:"Artifacts",current:Fe("Artifact"),target:Me.Artifacts||Me.Artifact||10},{label:"Planeswalkers",current:Fe("Planeswalker"),target:Me.Planeswalkers||Me.Planeswalker||0}].filter(Ft=>Ft.target>0)},[Ne,Ut,Ye]),Ot=y.useMemo(()=>{if(!Ye)return{};const Ee={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return Ye.forEach(Me=>{const Je=Me,Ft=(Je.data?.type_line||Je.type_line||"").toLowerCase(),tr=Ne?.commander&&(Je.scryfall_id===(Ne.commander.id||Ne.commander.scryfall_id)||Je.oracle_id&&Je.oracle_id===Ne.commander.oracle_id),Rr=Ne?.commander_partner&&(Je.scryfall_id===(Ne.commander_partner.id||Ne.commander_partner.scryfall_id)||Je.oracle_id&&Je.oracle_id===Ne.commander_partner.oracle_id);if(tr||Rr){Ee.Commander.push(Je);return}Ft.includes("creature")?Ee.Creature.push(Je):Ft.includes("planeswalker")?Ee.Planeswalker.push(Je):Ft.includes("instant")?Ee.Instant.push(Je):Ft.includes("sorcery")?Ee.Sorcery.push(Je):Ft.includes("artifact")?Ee.Artifact.push(Je):Ft.includes("enchantment")?Ee.Enchantment.push(Je):Ft.includes("land")?Ee.Land.push(Je):Ee.Other.push(Je)}),Object.fromEntries(Object.entries(Ee).filter(([Me,Je])=>Je.length>0))},[Ye,Ne]),pt=()=>{if(!Ne||!Ye)return;const Ee={deck:{name:Ne.name,commander:Ne.commander},cards:Ye,exported_at:new Date},Me=JSON.stringify(Ee,null,2),Je=new Blob([Me],{type:"application/json"}),Ft=URL.createObjectURL(Je),tr=document.createElement("a");tr.href=Ft,tr.download=`${Ne.name.replace(/[^a-z0-9]/yi,"_")}_backup.json`,document.body.appendChild(tr),tr.click(),document.body.removeChild(tr)},Jt=Ee=>{let Me=Ee.split(/[\r\n~]/);Me.forEach((Ft,tr)=>{Ft=Ft.split("(")[0],Ft=Ft.replace(/ *\[[^\]]*\] */g," "),Ft=Ft.replace(/ *<[^>]*> */g," "),Ft=Ft.trim(),Me[tr]=Ft});const Je=Me.join("~");return encodeURIComponent(Je).replace(/%20/g,"+")+"~Z~"},Kt=()=>{if(!Ne||!Ye)return;const Ee=[];Ne.commander&&Ee.push(`1 ${Ne.commander.name}`),Ne.commander_partner&&Ee.push(`1 ${Ne.commander_partner.name}`),Ye.forEach(Ft=>{const tr=Ft.countInDeck||1,Rr=Ft.name||Ft.data?.name||"";Rr&&Ee.push(`${tr} ${Rr}`)});const Me=Ee.join(`
`),Je=Jt(Me);window.open(`https://edhpowerlevel.com?d=${Je}`,"_blank")},rr=()=>{if(!Ne||!Ye)return;const Ee=[];Ne.commander&&Ee.push(`1 ${Ne.commander.name}`),Ne.commander_partner&&Ee.push(`1 ${Ne.commander_partner.name}`),Ye.forEach(Ft=>{const tr=Ft.countInDeck||1,Rr=Ft.name||Ft.data?.name||"";Rr&&Ee.push(`${tr} ${Rr}`)});const Me=Ee.join(`
`),Je=encodeURIComponent(Me);window.open(`https://www.tcgplayer.com/massentry?c=${Je}`,"_blank")},Br=async Ee=>{try{await Xo.addCardToDeck(r.uid,t,Ee),a(`Added ${Ee.name} to deck`,"success")}catch(Me){console.error(Me),a("Failed to add card to deck","error")}},zt=async(Ee,Me)=>{se({isOpen:!0,title:"Remove Card",message:`Are you sure you want to remove ${Me} from this deck?`,onConfirm:async()=>{try{await Xo.removeCardFromDeck(r.uid,t,Ee),a(`Removed ${Me} from deck`,"success")}catch(Je){console.error(Je),a("Failed to remove card","error")}}})},Wt=Ee=>{if(!Ee)return"https://placehold.co/250x350?text=No+Image";const Me=Ee.data||Ee;return V[Me.id]&&Me.card_faces&&Me.card_faces[1]&&Me.card_faces[1].image_uris?.normal?Me.card_faces[1].image_uris.normal:Me.image_uris?.normal?Me.image_uris.normal:Me.card_faces?.[0]?.image_uris?.normal?Me.card_faces[0].image_uris.normal:Ee.image_uri?Ee.image_uri:"https://placehold.co/250x350?text=No+Image"},qt=async(Ee,Me,Je)=>{if(Ee.stopPropagation(),Ne.commander_partner&&E!==Je){I(Je);return}const Ft=Me.data||Me;if(!(!Ft.card_faces||Ft.card_faces.length<2)){if(!V[Ft.id]&&!Ft.card_faces[1].image_uris){J(!0);try{a("Fetching back face data...","info");const tr=await fetch(`https://api.scryfall.com/cards/${Ft.id}`);if(!tr.ok)throw new Error("Fetch failed");const Rr=await tr.json(),Kr=Je===0?{commander:Rr}:{commanderPartner:Rr};await Xo.updateDeck(r.uid,t,Kr),Je===0?Ne.commander=Rr:Ne.commander_partner=Rr,a("Commander data updated.","success")}catch(tr){console.error("Flip fix failed",tr),a("Could not load card back.","error")}finally{J(!1)}}Y(tr=>({...tr,[Ft.id]:!tr[Ft.id]}))}},ur=()=>{_(Ne.name),w(!0)},Re=async()=>{try{await Xo.updateDeck(r.uid,t,{name:j}),a("Deck renamed successfully","success"),w(!1),window.location.reload()}catch(Ee){console.error(Ee),a("Failed to rename deck","error")}},Nt=async()=>{try{await Xo.updateDeck(r.uid,t,{is_mockup:!Ne.is_mockup}),a(`Deck set to ${Ne.is_mockup?"Collection":"Mockup"} mode`,"info"),window.location.reload()}catch(Ee){console.error(Ee),a("Failed to update deck mode","error")}},Pt=Pe.useRef(!1),[It,Zt]=y.useState(!1),Ae=()=>{Pt.current=!1,Zt(!0),se({isOpen:!0,title:"Delete Deck",message:"Are you sure you want to delete this deck? Cards inside will be returned to your collection binder.",onConfirm:async()=>{try{await Xo.deleteDeck(r.uid,t,{deleteCards:Pt.current}),a("Deck deleted successfully","success"),e("/decks")}catch(Ee){console.error(Ee),a("Failed to delete deck","error")}finally{Zt(!1)}}})},et=Ee=>{if(!Ee)return"";const Me=Ee.data||Ee;return V[Me.id]&&Me.card_faces&&Me.card_faces[1]&&Me.card_faces[1].image_uris?.art_crop?Me.card_faces[1].image_uris.art_crop:Me.image_uris?.art_crop?Me.image_uris.art_crop:Me.card_faces?.[0]?.image_uris?.art_crop?Me.card_faces[0].image_uris.art_crop:Me.image_uris?.normal?Me.image_uris.normal:Ee.image_uri?Ee.image_uri:""};if(St)return s.jsx("div",{className:"flex justify-center p-20",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(Vt)return s.jsxs("div",{className:"p-20 text-center text-red-500 text-xl font-bold",children:["Error loading deck: ",Vt.message]});if(!Ne)return null;const Rt=E===0?Ne.commander:Ne.commander_partner||Ne.commander,$t=et(Rt),Qt={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"};return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${$t})`,backgroundSize:"cover",backgroundPosition:"center"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"})}),s.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 md:p-6 space-y-6 animate-fade-in pb-24 relative z-10",children:[s.jsx("div",{className:"sticky top-16 z-40 bg-gradient-to-r from-gray-900/95 via-gray-900/80 to-gray-900/40 backdrop-blur-3xl border-b border-white/10 shadow-2xl transition-all duration-300 mx-auto w-full max-w-[1600px] rounded-b-3xl",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 md:gap-6 px-3 md:px-8 py-3 md:py-4",children:[s.jsxs("div",{className:"flex items-start gap-3 md:gap-4 min-w-0 shrink-0",children:[s.jsx(Er,{to:"/decks",className:"w-9 h-9 md:w-12 md:h-12 flex items-center justify-center bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shrink-0 mt-0.5 md:mt-0",title:"Back to Decks",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[v?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:j,onChange:Ee=>_(Ee.target.value),className:"bg-black/50 text-2xl font-black text-white border-b-2 border-indigo-500 outline-none px-2 py-1 w-full max-w-md backdrop-blur-sm rounded",autoFocus:!0}),s.jsx("button",{onClick:Re,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}):s.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 group max-w-full",children:[s.jsx("h2",{className:"text-xl md:text-3xl lg:text-4xl font-black text-white tracking-tighter uppercase truncate leading-tight flex-1",title:Ne.name,children:Ne.name}),ot&&s.jsx("button",{onClick:ur,className:"p-1 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity text-gray-500 hover:text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("div",{id:"deck-identity-badge",className:"text-[10px] md:text-[11px] text-indigo-300 font-black uppercase tracking-[0.15em] md:tracking-[0.2em] opacity-80 whitespace-nowrap",children:[ut.badge,"  ",ut.theme]}),!ft&&s.jsxs("span",{className:`text-[9px] md:text-[10px] font-bold uppercase tracking-widest px-2 py-0.5 rounded-full border whitespace-nowrap ${ot?"bg-green-900/40 text-green-400 border-green-500/30":"bg-gray-800 text-gray-400 border-gray-700"}`,children:[vt," Access"]}),s.jsx("div",{className:"flex items-center gap-1 shrink-0",children:(()=>{const Ee=Ne?.commander?.color_identity||[],Me=Ne?.commander_partner?.color_identity||[];return[...new Set([...Ee,...Me])].map(Ft=>s.jsx("img",{src:Qt[Ft],alt:Ft,className:"w-5 h-5 md:w-6 md:h-6 shadow-sm"},Ft))})()})]})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-2 md:mt-3",children:s.jsxs("div",{id:"deck-stats-bar",className:"flex items-center gap-2 bg-black/40 px-2.5 md:px-3 py-1 md:py-1.5 rounded-xl border border-white/5 backdrop-blur-md shadow-2xl",children:[s.jsx("span",{className:"bg-orange-600/20 text-orange-400 px-2 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-orange-500/30",children:Ne.format||"Commander"}),Ne.tags&&Ne.tags.includes("Precon")&&s.jsx("span",{className:"bg-teal-600/20 text-teal-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-teal-500/30",children:"Precon"}),Ne.aiBlueprint?.grade?.commanderBracket&&s.jsxs("span",{className:"bg-indigo-600/20 text-indigo-300 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-indigo-500/30",children:[s.jsx("span",{className:"hidden md:inline",children:"Bracket "}),Ne.aiBlueprint.grade.commanderBracket]}),Ne.is_mockup&&s.jsx("span",{className:"bg-red-600/20 text-red-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-red-500/30",children:"Mockup"}),Ne.aiBlueprint?.grade?.powerLevel>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold uppercase tracking-widest opacity-80",children:[s.jsx("span",{className:"hidden md:inline",children:"power "}),Ne.aiBlueprint.grade.powerLevel.toFixed(1)]})]}),s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold font-mono",children:["$",qe.toFixed(2)]})]})})]})]}),s.jsx("div",{className:"hidden sm:block flex-1 px-8 text-center",children:s.jsxs("div",{className:"text-[12px] md:text-[13px] text-white/30 italic font-medium tracking-tight mx-auto max-w-2xl leading-relaxed",children:['"',ut.flavor_text,'"']})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-3 bg-gray-950/40 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md relative self-end lg:self-auto",ref:le,children:[s.jsxs("button",{onClick:()=>q(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-indigo-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Strategy"})]}),ot&&s.jsxs("button",{onClick:()=>h(!0),className:"bg-green-600 hover:bg-green-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-green-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),s.jsx("span",{className:"hidden sm:inline",children:"Collection"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{id:"deck-tools-trigger",onClick:()=>H(!ne),className:`group relative flex items-center justify-center w-12 h-11 md:w-auto md:px-5 transition-all rounded-xl border ${ne?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"} shadow-md`,title:"Deck Tools & Management",children:[s.jsxs("div",{className:"hidden md:flex items-center -space-x-2 mr-3 opacity-70 group-hover:opacity-100 transition-opacity",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),s.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),s.jsx("span",{className:"text-[10px] md:text-xs font-black uppercase tracking-widest",children:ne?"Close":"Tools"}),!ne&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-indigo-500 rounded-full border-2 border-gray-900 md:hidden animate-pulse"})]}),ne&&s.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[60] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Deck Building"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[ot&&s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),m(!0),H(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group",children:[s.jsxs("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Scan"})]}),s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),c(!0),H(!1)},className:`flex flex-col items-center gap-2 p-3 bg-white/5 rounded-xl border border-white/5 transition-all group ${ot?"hover:bg-indigo-500/20":"opacity-50 cursor-not-allowed"}`,disabled:!ot,children:[s.jsx("svg",{className:"w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Search"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Logic & Analysis"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:Ee=>{if(Ee.stopPropagation(),!Ln(n?.subscription_tier).features.deckDoctor){a("Deck Doctor is available on Wizard tier and above.","info");return}de(!0),H(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-xl border transition-all group ${Ln(n?.subscription_tier).features.deckDoctor?"bg-indigo-500/10 hover:bg-indigo-500/30 border-indigo-500/20":"bg-gray-900 border-gray-800 opacity-40 cursor-not-allowed"}`,children:[s.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-indigo-300",children:"Doctor"})]}),ot&&(Ln(n?.subscription_tier).features.deckAudit?s.jsx("div",{onClick:()=>H(!1),className:"h-full",children:s.jsx(xk,{type:"deck",targetId:t,label:"Audit",className:"w-full h-full flex flex-col items-center gap-2 p-3 bg-purple-500/10 hover:bg-purple-500/30 border border-purple-500/20 rounded-xl transition-all font-bold text-[10px] text-purple-300"})}):s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),a("Deck Audits are available on Magician tier and above.","info")},className:"flex flex-col items-center gap-2 p-3 bg-gray-900 border border-gray-800 rounded-xl opacity-40 cursor-not-allowed",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"Audit"})]}))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Tabletop Tools"}),s.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),e(`/solitaire/${t}`),H(!1)},className:"w-full py-3 bg-emerald-900/10 hover:bg-emerald-900/20 text-emerald-400 rounded-xl border border-emerald-500/10 hover:border-emerald-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group",children:[s.jsx("span",{className:"text-lg group-hover:scale-110 transition-transform",children:""}),"Solitaire & Playtest"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),b(!0),H(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/5 transition-all group",children:[s.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Print Proxies"})]}),s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),e("/play/lobby"),H(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/5 transition-all group",children:[s.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Live Session"})]})]}),s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),e("/tournaments"),H(!1)},className:"w-full py-2 bg-amber-900/10 hover:bg-amber-900/20 text-amber-500 rounded-xl border border-amber-500/10 hover:border-amber-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-2 group",children:[s.jsx("span",{className:"text-sm group-hover:scale-110 transition-transform",children:""}),"Find Tournament"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5",children:[s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),oe(!0),H(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center justify-between hover:bg-indigo-500/10 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Share Deck"})]}),s.jsx("svg",{className:"w-3 h-3 text-gray-600 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),Ln(n?.subscription_tier).features.deckBackup?(pt(),H(!1)):a("Deck Export is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Ln(n?.subscription_tier).features.deckBackup?"hover:bg-gray-800":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Export JSON"})]}),!Ln(n?.subscription_tier).features.deckBackup&&s.jsx("span",{className:"text-[8px] bg-amber-500/20 text-amber-500 px-1.5 py-0.5 rounded leading-none",children:"PRO"})]}),ot&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),Ln(n?.subscription_tier).features.mockupDeck?(Nt(),H(!1)):a("Mockup Mode is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Ln(n?.subscription_tier).features.mockupDeck?"hover:bg-orange-950/20":"opacity-40 cursor-not-allowed"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:Ne.is_mockup?"To Collection":"To Mockup"})]})}),s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),Ae(),H(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-red-900/30 text-red-400 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{className:"font-bold",children:"Delete Deck"})]})]})]})]})]})})]})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:rt.map((Ee,Me)=>{const Je=Ee.target>0?Math.min(Ee.current/Ee.target*100,100):0,Ft=Ee.target>0&&Ee.current===Ee.target,tr=Ee.target>0&&Ee.current>Ee.target;return s.jsxs("div",{className:"bg-gray-950/30 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg group hover:border-indigo-500/30 transition-all hover:bg-gray-950/50",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:Ee.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${Ft?"text-green-400":tr?"text-orange-400":"text-indigo-300"}`,children:[Ee.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),Ee.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${Ft?"bg-green-500":tr?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${Je||0}%`}})})]},Me)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsxs("div",{className:"flex-1 min-w-0 bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl border border-white/10 order-2 lg:order-1 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5 rounded-t-xl backdrop-blur-sm",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),Ut>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-700",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acquired"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${jt===Ut?"text-green-400":"text-orange-400"}`,children:[jt,"/",Ut]}),s.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden ml-1",children:s.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${jt/Ut*100}%`}})})]})]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700 items-center",children:[S?s.jsxs("div",{className:"flex items-center gap-2 mr-2 animate-fade-in",children:[s.jsx("button",{onClick:L,className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:M.size===Ye.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2",children:[M.size," Selected"]}),s.jsx("button",{onClick:R,disabled:M.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:Ne.is_mockup?"Delete":"Remove"}),s.jsx("button",{onClick:()=>T(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>T(!0),className:"text-xs font-bold text-gray-400 hover:text-indigo-400 px-3 transition-colors uppercase mr-1",children:"Select"}),s.jsx("div",{className:"w-px h-4 bg-gray-700 mx-1"}),s.jsx("button",{onClick:()=>Ve("grid"),className:`p-1.5 rounded-md transition-all ${ke==="grid"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>Ve("table"),className:`p-1.5 rounded-md transition-all ${ke==="table"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Table View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsxs("div",{className:"p-4 space-y-8 min-h-[500px]",children:[Object.entries(Ot).length===0&&s.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:'Use the "Collection" button to start building your deck.'}),Object.entries(Ot).map(([Ee,Me])=>s.jsxs("div",{className:"animate-fade-in text-left",children:[s.jsxs("h4",{className:"text-sm font-bold text-indigo-300 border-b border-white/5 mb-4 pb-2 sticky top-0 bg-gray-950/60 backdrop-blur-md z-10 flex justify-between uppercase tracking-wider pl-1",children:[s.jsx("span",{children:Ee}),s.jsx("span",{className:"text-gray-500 text-xs bg-gray-900 px-2 py-0.5 rounded-full border border-gray-700",children:Me.reduce((Je,Ft)=>Je+(Ft.countInDeck||1),0)})]}),ke==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 px-1",children:Me.map(Je=>s.jsx(Qx,{card:Je,availableFoils:At,onRemove:zt,decks:at,currentUser:n,showOwnerTag:!0,hideDeckTag:!0,hideOwnerTag:!0,selectMode:S,isSelected:M.has(Je.id),onToggleSelect:k},Je.firestoreId||Je.id))}):s.jsx("div",{className:"space-y-1",children:Me.map((Je,Ft)=>s.jsxs("div",{className:`flex items-center justify-between p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm group border ${M.has(Je.id)?"bg-indigo-900/20 border-indigo-500/50":"border-transparent hover:border-gray-700"}`,onClick:tr=>{S&&(tr.stopPropagation(),k(Je.id))},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[S&&s.jsx("input",{type:"checkbox",checked:M.has(Je.id),readOnly:!0,className:"rounded bg-gray-700 border-gray-600 text-indigo-500 focus:ring-0 w-4 h-4 cursor-pointer"}),s.jsx("span",{className:"font-mono text-gray-500 w-6 text-center bg-gray-900 rounded py-0.5 text-xs",children:Je.countInDeck}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`font-medium ${Je.finish==="foil"?"text-yellow-200":"text-gray-200"}`,children:Je.name}),Je.finish!=="foil"&&At.has(Je.name)&&s.jsx("span",{className:"text-yellow-500 text-xs cursor-help",title:"Foil copy available in collection",children:""})]}),Je.finish==="foil"&&s.jsx("span",{className:"text-[10px] bg-yellow-900/40 text-yellow-500 px-1 rounded uppercase tracking-wider border border-yellow-800",children:"Foil"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[s.jsx("span",{className:"hidden md:inline-block text-xs text-gray-500",children:Je.data?.type_line||Je.type_line||""}),s.jsx("span",{className:"font-mono w-16 text-right text-xs",children:Je.mana_cost||""}),s.jsxs("span",{className:"font-mono w-16 text-right text-green-400/80 text-xs",children:["$",(parseFloat(Je.prices?.[Je.finish==="foil"?"usd_foil":"usd"])||0).toFixed(2)]}),ot&&!S&&s.jsx("button",{onClick:()=>zt(Je.firestoreId||Je.id,Je.name),className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]},Je.id+Ft))})]},Ee))]})]}),s.jsxs("div",{className:"w-full lg:w-80 space-y-6 shrink-0 order-1 lg:order-2",children:[Ne.commander&&s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:Ne.format?.toLowerCase()==="standard"?"Spotlight Card":Ne.commander_partner?"Partners":"Commander"}),Ne.commander_partner&&s.jsx("button",{onClick:()=>I(Ee=>Ee===0?1:0),className:"text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider transition-colors",children:"Swap View "})]}),s.jsxs("div",{className:"p-4 flex justify-center relative min-h-[350px]",children:[Ne.commander_partner&&s.jsx("div",{className:`transition-all duration-500 ease-out transform absolute top-4 
                                            ${E===0?"scale-90 opacity-60 translate-x-4 -rotate-3 z-0 blur-[1px] hover:blur-0":"scale-100 opacity-100 z-10 translate-x-0 rotate-0"}
                                            cursor-pointer`,onClick:Ee=>qt(Ee,Ne.commander_partner,1),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:Wt(Ne.commander_partner),className:"w-full max-w-[250px] rounded-lg shadow-2xl skew-y-1",alt:Ne.commander_partner.name}),(Ne.commander_partner.card_faces||Ne.commander_partner.data?.card_faces)&&E===1&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${X?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),s.jsx("div",{className:`transition-all duration-500 ease-out transform relative 
                                        ${Ne.commander_partner&&E===1?"scale-90 opacity-60 -translate-x-4 rotate-3 z-0 blur-[1px] hover:blur-0 cursor-pointer":"scale-100 opacity-100 z-10"}
                                        `,onClick:Ee=>qt(Ee,Ne.commander,0),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:Wt(Ne.commander),className:"w-full max-w-[250px] rounded-lg shadow-2xl hover:shadow-indigo-500/30 transition-shadow duration-300",alt:Ne.commander.name}),(Ne.commander.card_faces||Ne.commander.data?.card_faces)&&E===0&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${X?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl p-6 border border-white/10 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),o," Tools"]}),s.jsxs("div",{className:"space-y-3 relative z-10",children:[s.jsxs("button",{onClick:()=>{Ne.format?.toLowerCase()==="standard"?a("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info",0):e(`/decks/${t}/build`)},className:"w-full py-4 bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-300 rounded-xl border border-indigo-500/20 hover:border-indigo-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),o,"'s Deck Builder"]}),s.jsxs("button",{onClick:()=>W(!0),className:"w-full py-4 bg-indigo-900/10 hover:bg-indigo-900/20 text-indigo-400 rounded-xl border border-indigo-500/10 hover:border-indigo-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Full Deck Stats"]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 p-4 pb-0 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse"}),"External Sites"]}),s.jsxs("div",{className:"space-y-3 relative z-10 p-4 pt-3",children:[s.jsxs("button",{onClick:Kt,className:"w-full py-4 bg-purple-600/10 hover:bg-purple-600/20 text-purple-300 rounded-xl border border-purple-500/20 hover:border-purple-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),"EDH Power Level"]}),s.jsxs("button",{onClick:rr,className:"w-full py-4 bg-green-900/10 hover:bg-green-900/20 text-green-400 rounded-xl border border-green-500/10 hover:border-green-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Buy on TCGPlayer"]})]})]})]})]}),s.jsx(V8e,{isOpen:be,onClose:()=>oe(!1),deck:Ne,onUpdateDeck:Ee=>Object.assign(Ne,Ee)}),s.jsx(Qee,{isOpen:Z,onClose:()=>de(!1),deck:Ne,cards:Ye,isOwner:ot}),s.jsx(II,{isOpen:l,onClose:()=>c(!1),onAddCard:Br}),s.jsx(Yee,{isOpen:re.isOpen,onClose:()=>se({...re,isOpen:!1}),onConfirm:re.onConfirm,title:re.title,message:re.message,isDanger:!0,confirmText:"Remove",children:It&&s.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white/5 p-3 rounded-lg border border-white/10",children:[s.jsx("input",{type:"checkbox",id:"deleteCardsCheckbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500",onChange:Ee=>Pt.current=Ee.target.checked}),s.jsxs("label",{htmlFor:"deleteCardsCheckbox",className:"text-gray-300 text-sm select-none",children:["Also remove these cards from my ",Ne.is_mockup?"wishlist":"collection binder"]})]})}),s.jsx(q8e,{isOpen:ee,onClose:()=>q(!1),deck:Ne,cards:Ye,onStrategyUpdate:()=>Lt(!0)}),s.jsx(U8e,{isOpen:u,onClose:()=>h(!1),deck:Ne,deckCards:Ye}),s.jsx(Xee,{isOpen:U,onClose:()=>W(!1),cards:Ye,deckName:Ne.name}),s.jsx(sk,{isOpen:p,onClose:()=>m(!1),onFinish:async Ee=>{if(Ee.length)try{const Me=Ee.map(Je=>({name:Je.name,scryfall_id:Je.scryfall_id,set_code:Je.set_code,collector_number:Je.collector_number,image_uri:Je.data.image_uris?.normal||Je.data.card_faces?.[0]?.image_uris?.normal,count:Je.quantity,data:Je.data,finish:Je.finish||"nonfoil",is_wishlist:Je.is_wishlist,tags:[]}));await Xo.batchAddCardsToDeck(r.uid,t,Me),a(`Successfully added ${Ee.length} cards to deck!`,"success"),Lt()}catch(Me){console.error("Forge Lens Add Failed",Me),a("Failed to add scanned cards.","error")}}}),s.jsx(MPe,{isOpen:g,onClose:()=>b(!1),cards:Ye,deckName:Ne.name})]}),s.jsx(pf,{steps:ct,isOpen:ce,onClose:()=>Be(!1),tourId:"deck_details_v1"})]})};function BPe(){const[t,e]=y.useState([]),[r,n]=y.useState(!0),[i,a]=y.useState(null);return y.useEffect(()=>{(async()=>{try{const c=(await Ge.get("/api/sets")).data||[];e(c),n(!1)}catch(l){console.error("Error fetching sets:",l),a(l),n(!1)}})()},[]),{sets:t,loading:r,error:i}}const qte=({value:t,onChange:e,onSelect:r,placeholder:n="Find card in sets..."})=>{const[i,a]=y.useState([]),[o,l]=y.useState(!1),[c,u]=y.useState(!1),h=y.useRef(null);y.useEffect(()=>{const m=g=>{h.current&&!h.current.contains(g.target)&&l(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),y.useEffect(()=>{const g=setTimeout(async()=>{if(t.length<2){a([]);return}u(!0);try{const b=await Ge.get("/api/cards/autocomplete",{q:t});a(b.data||[]),l(!0)}catch(b){console.error("Autocomplete failed",b)}finally{u(!1)}},300);return()=>clearTimeout(g)},[t]);const p=m=>{e(m),l(!1),r&&r(m)};return s.jsxs("div",{ref:h,className:"relative w-full",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c?s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-indigo-400"}):s.jsx("svg",{className:"h-4 w-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 bg-gray-900/50 border border-indigo-500/20 rounded-xl text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none text-sm",placeholder:n,value:t,onChange:m=>e(m.target.value),onFocus:()=>t.length>=2&&l(!0)}),t&&s.jsx("button",{onClick:()=>e(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o&&i.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl overflow-hidden animate-fade-in",children:i.map((m,g)=>s.jsx("button",{onClick:()=>p(m),className:"w-full text-left px-4 py-2.5 text-sm text-gray-300 hover:bg-indigo-600 hover:text-white transition-colors border-b border-white/5 last:border-0",children:m},g))})]})},$Pe=()=>{const{sets:t,loading:e,error:r}=BPe(),{cards:n}=vl(),[i,a]=y.useState(""),[o,l]=y.useState(sessionStorage.getItem("mtg_card_search")||""),[c,u]=y.useState(null),[h,p]=y.useState(!1),[m,g]=y.useState(!1),b=xn(),[v,w]=y.useState(!1);y.useEffect(()=>{const B=()=>w(!0);return window.addEventListener("start-tour",B),localStorage.getItem("tour_seen_sets_tour_v1")||setTimeout(()=>w(!0),1e3),()=>window.removeEventListener("start-tour",B)},[]);const j=[{target:"h1",title:"Set Library",content:"Browse every Magic: The Gathering set ever released."},{target:"#sets-search",title:"Find Sets",content:'Search for sets by name or code (e.g. "ELD").'},{target:"#sets-card-search",title:"Find Card in Sets",content:"Looking for a specific card? Find which sets contain it."},{target:"#sets-owned-toggle",title:"Collection Filter",content:"Toggle to show only sets where you own cards."}];y.useEffect(()=>{const S=setTimeout(async()=>{const T=o.trim();if(!T){u(null),sessionStorage.removeItem("mtg_card_search");return}sessionStorage.setItem("mtg_card_search",T),p(!0);try{const M=await Ge.get("/api/cards/sets-for-card",{name:T});u(new Set(M.data||[]))}catch(M){console.error("Local card search failed",M),u(new Set)}finally{p(!1)}},500);return()=>clearTimeout(S)},[o]);const _=y.useMemo(()=>{const B=new Map;n&&n.forEach(T=>{if(T.is_wishlist||T.deck_id)return;const M=(T.set||T.set_code)?.toLowerCase(),$=T.name;B.has(M)||B.set(M,new Set),$&&B.get(M).add($)});const S={};return B.forEach((T,M)=>{S[M]=T.size}),S},[n]),E=y.useMemo(()=>{if(!t)return{};const B={Expansion:[],Core:[],Commander:[],Masters:[],"Draft Innovation":[],Other:[]},S={expansion:"Expansion",core:"Core",commander:"Commander",masters:"Masters",draft_innovation:"Draft Innovation"};return t.forEach(T=>{const M=_[T.code.toLowerCase()]||0,$=M>0,k=!i||T.name.toLowerCase().includes(i.toLowerCase())||T.code.toLowerCase().includes(i.toLowerCase()),L=!c||c.has(T.code.toLowerCase());if(!k||!(!m||$)||!L)return;const V=S[T.set_type]||"Other";B[V]?B[V].push({...T,ownedCount:M}):B.Other.push({...T,ownedCount:M})}),Object.keys(B).forEach(T=>{B[T].sort((M,$)=>new Date($.released_at)-new Date(M.released_at))}),B},[t,i,m,_,c]),I=B=>{b(`/sets/${B}`)};if(e)return s.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(r)return s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-red-500 bg-red-500/10 p-8 rounded-2xl border border-red-500/20 max-w-md",children:[s.jsx("p",{className:"font-bold text-xl mb-2",children:"Error loading sets"}),s.jsx("p",{className:"text-sm opacity-80",children:r.message})]})});const O=["Expansion","Core","Commander","Masters","Draft Innovation","Other"];return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-gray-950/80 backdrop-blur-xl border-b border-white/10 sticky top-16 z-30 py-3 md:py-4",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[s.jsx("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:["Set ",s.jsx("span",{className:"text-indigo-500",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Browse Collections"})]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto lg:flex-1 lg:justify-end",children:[s.jsxs("div",{className:"relative flex-grow max-w-xs group",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-3.5 w-3.5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-9 pr-10 py-2 bg-gray-900/50 border border-white/5 rounded-lg text-xs text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all outline-none",placeholder:"Search sets...",value:i,onChange:B=>a(B.target.value),id:"sets-search"}),i&&s.jsx("button",{onClick:()=>a(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"relative flex-grow max-w-sm",id:"sets-card-search",children:s.jsx(qte,{value:o,onChange:l,placeholder:"Find card in sets..."})}),s.jsx("button",{onClick:()=>g(!m),id:"sets-owned-toggle",className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${m?"bg-indigo-600 text-white shadow-lg":"bg-gray-800/80 text-gray-400 border border-white/5 hover:bg-gray-700"}`,children:m?"Owned":"Show All"})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:O.map(B=>E[B]&&E[B].length>0&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-3",children:[B,s.jsx("div",{className:"h-[2px] w-12 bg-indigo-500/50"})]}),s.jsxs("span",{className:"text-[10px] font-black text-gray-500 bg-gray-800/50 border border-white/5 px-3 py-1 rounded-full uppercase tracking-widest",children:[E[B].length," Sets"]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:E[B].map(S=>{const T=Math.min(100,Math.round(S.ownedCount/S.card_count*100)),M=T>=100;return s.jsxs("div",{onClick:()=>I(S.code),className:"relative bg-gray-800/40 backdrop-blur-md rounded-2xl border border-white/5 p-5 group cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:border-indigo-500/30 overflow-hidden min-h-[160px] flex flex-col justify-between",children:[s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-1000 ease-out z-0",style:{height:`${T}%`,background:M?"linear-gradient(to top, rgba(34, 197, 94, 0.15) 0%, transparent 100%)":"linear-gradient(to top, rgba(79, 70, 229, 0.15) 0%, transparent 100%)"}}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-900/80 rounded-xl flex items-center justify-center border border-white/5 shadow-inner",children:S.icon_svg_uri?s.jsx("img",{src:S.icon_svg_uri,alt:S.name,className:"w-6 h-6 filter invert opacity-60 group-hover:opacity-100 transition-opacity"}):s.jsx("span",{className:"text-xs font-black text-gray-500",children:S.code.toUpperCase()})}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Code"}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 mb-2",children:S.code.toUpperCase()}),s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Release"}),s.jsx("span",{className:"text-xs font-bold text-gray-400",children:S.released_at?.split("-")[0]})]})})]}),s.jsx("h3",{className:"text-sm font-black text-white leading-snug group-hover:text-indigo-400 transition-colors",children:S.name})]}),s.jsxs("div",{className:"relative z-10 pt-4 mt-4 border-t border-white/5 flex items-end justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:`text-lg font-black tabular-nums ${M?"text-green-400":"text-indigo-400"}`,children:S.ownedCount}),s.jsxs("span",{className:"text-gray-600 text-[10px] font-bold",children:["/ ",S.card_count]})]})]}),s.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-[10px] font-black ${M?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-gray-950/80 text-gray-400 border border-white/5"}`,children:[T,"%"]})]})]},S.id)})})]},B))}),s.jsx(pf,{steps:j,isOpen:v,onClose:()=>w(!1),tourId:"sets_tour_v1"})]})},FPe=()=>{const{setCode:t}=yl(),[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(null),[l,c]=y.useState("all"),[u,h]=y.useState(sessionStorage.getItem("mtg_card_search")||""),{currentUser:p,userProfile:m}=Or(),{addToast:g}=jn(),{cards:b,refresh:v}=vl();y.useEffect(()=>{u?sessionStorage.setItem("mtg_card_search",u):sessionStorage.removeItem("mtg_card_search")},[u]);const w=y.useMemo(()=>{const O=new Map;return b&&b.forEach(B=>{const S=B.scryfall_id||B.data&&(B.data.scryfall_id||B.data.id)||B.id;O.has(S)||O.set(S,[]),O.get(S).push(B)}),O},[b]),j=y.useMemo(()=>{const O=new Set(e.map(T=>T.name)),B=new Set;let S=0;return e.forEach(T=>{const M=w.get(T.scryfall_id||T.id)||[],$=M.filter(L=>L.finish==="nonfoil"&&!L.is_wishlist).reduce((L,R)=>L+(R.count||1),0),k=M.filter(L=>L.finish==="foil"&&!L.is_wishlist).reduce((L,R)=>L+(R.count||1),0);if($>0||k>0){B.add(T.name);const L=parseFloat(T.prices?.usd||0)*$,R=parseFloat(T.prices?.usd_foil||0)*k;S+=L+R}}),{collected:B.size,total:O.size,value:S.toFixed(2)}},[e,w]),_=y.useMemo(()=>{let O=e;if(l!=="all"&&(O=O.filter(B=>{const T=(w.get(B.scryfall_id||B.id)||[]).some(M=>!M.is_wishlist&&(M.count||0)>0);return l==="owned"?T:!T})),u){const B=u.toLowerCase();O=O.filter(S=>S.name.toLowerCase().includes(B)||(S.data?.name_en||"").toLowerCase().includes(B))}return O},[e,w,l,u]);y.useEffect(()=>{(async()=>{if(t){i(!0);try{const B=await Ge.get(`/api/sets/${t}/cards`);r(B.data||[]),o(null)}catch(B){console.error("Failed to load set cards",B),o(B.message)}finally{i(!1)}}})()},[t]);const E=async(O,B,S)=>{if(!p)return g("Please log in","error");try{const T=O.id,M=w.get(T)||[],$=B==="foil"?"foil":"nonfoil",k=M.find(L=>L.finish===$&&!L.deck_id&&!L.is_wishlist);S>0?k?(await so.updateCard(k.id,{count:(k.count||1)+1}),g(`Added ${$} ${O.name}`,"success")):(await so.addCardToCollection(p.uid,O,1,$),g(`Added new ${$} ${O.name}`,"success")):k&&((k.count||1)>1?(await so.updateCard(k.id,{count:k.count-1}),g(`Removed ${$} ${O.name}`,"info")):(await so.removeCard(k.id),g(`Removed last ${$} ${O.name}`,"info"))),await v()}catch(T){console.error("Update failed",T),g("Failed to update collection","error")}},I=async(O,B)=>{if(!p)return g("Please log in","error");try{const S=O.id,M=(w.get(S)||[]).find($=>$.is_wishlist&&!$.deck_id);B>0?M?(await so.updateCard(M.id,{count:(M.count||1)+1}),g(`Increased wishlist for ${O.name}`,"success")):(await so.addCardToCollection(p.uid,O,1,"nonfoil",!0),g(`Added ${O.name} to wishlist`,"success")):M&&((M.count||1)>1?(await so.updateCard(M.id,{count:M.count-1}),g(`Decreased wishlist for ${O.name}`,"info")):(await so.removeCard(M.id),g(`Removed ${O.name} from wishlist`,"info"))),await v()}catch(S){console.error("Wishlist update failed",S),g("Failed to update wishlist","error")}};return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"sticky top-16 z-30 bg-gray-950/80 backdrop-blur-xl border-b border-white/10 shadow-2xl",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Er,{to:"/sets",className:"p-1.5 bg-gray-800/50 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white transition-all group",title:"Back to Sets",children:s.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:[t," ",s.jsx("span",{className:"text-gray-500 font-bold ml-1",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Expansion Collection"})]})]}),s.jsxs("div",{className:"flex items-center gap-6 bg-gray-900/50 border border-white/5 px-4 py-2 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-black text-indigo-400",children:j.collected}),s.jsxs("span",{className:"text-gray-600 font-bold text-[10px]",children:["/ ",j.total]})]})]}),s.jsx("div",{className:"w-[1px] h-4 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Estimate Value"}),s.jsxs("span",{className:"text-sm font-black text-emerald-400 tabular-nums",children:["$",j.value]})]})]}),Ln(m?.subscription_tier).features.setAudit?s.jsx(xk,{type:"set",targetId:t,label:"Audit Set",className:"text-xs py-1.5"}):s.jsxs("button",{onClick:()=>g(`Set Audits are available on ${Vs[nr.TIER_2].name} tier and above.`,"info"),className:"bg-gray-800/50 border border-gray-700 text-gray-500 px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-widest cursor-not-allowed flex items-center gap-2",title:`Requires ${Vs[nr.TIER_2].name} Tier`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Audit Set"]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 pt-3 border-t border-white/5",children:[s.jsx("div",{className:"flex bg-gray-900/80 rounded-lg p-0.5 border border-white/5 w-full md:w-auto overflow-hidden",children:["all","owned","missing"].map(O=>s.jsx("button",{onClick:()=>c(O),className:`flex-1 md:flex-none px-4 py-1.5 rounded-md text-[10px] font-black uppercase tracking-widest transition-all duration-300 ${l===O?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white hover:bg-white/5"}`,children:O},O))}),s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto md:flex-1 justify-end",children:[s.jsx("div",{className:"relative w-full max-w-sm",children:s.jsx(qte,{value:u,onChange:h,placeholder:"Filter cards..."})}),u&&s.jsx("button",{onClick:()=>{h(""),sessionStorage.removeItem("mtg_card_search")},className:"p-2 bg-indigo-500/10 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/20 hover:text-white rounded-lg transition-all",title:"Clear filter",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:n?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",children:Array.from({length:12}).map((O,B)=>s.jsx(qL,{},B))}):a?s.jsxs("div",{className:"text-center text-red-500 py-12 bg-red-500/10 rounded-2xl border border-red-500/20",children:["Error loading set: ",a]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:_.map((O,B)=>{const S=w.get(O.scryfall_id||O.id)||[],T=S.filter(k=>k.finish==="nonfoil"&&!k.is_wishlist).reduce((k,L)=>k+(L.count||1),0),M=S.filter(k=>k.finish==="foil"&&!k.is_wishlist).reduce((k,L)=>k+(L.count||1),0),$=S.filter(k=>k.is_wishlist).reduce((k,L)=>k+(L.count||1),0);return s.jsx(dX,{card:O,normalCount:T,foilCount:M,wishlistCount:$,onUpdateCount:E,onUpdateWishlistCount:I,currentUser:m,showOwnerTag:!0},O.id||B)})})})]})},UPe=({isOpen:t,onClose:e,mode:r="global"})=>{const{currentUser:n}=Or(),{addToast:i}=jn(),a=y.useRef(null),[o,l]=y.useState(null),[c,u]=y.useState(!1),[h,p]=y.useState("cards"),[m,g]=y.useState("merge"),[b,v]=y.useState({checkCollection:!0,addToCollection:!0}),w=_=>{const E=_.target.files[0];if(!E)return;const I=new FileReader;I.onload=O=>{try{const B=JSON.parse(O.target.result);if(B.deck&&B.cards)p("deck"),l(B);else if(B.cards&&B.decks)p("cards"),l(B);else if(B.collection&&typeof B.collection=="object"&&!Array.isArray(B.collection)){const S=Object.values(B.collection);p("cards"),l({cards:S})}else if(Array.isArray(B))p("cards"),l({cards:B});else if(B.cards&&Array.isArray(B.cards))p("cards"),l(B);else if(typeof B=="object"){const S=Object.values(B).find(T=>Array.isArray(T)&&T.length>0&&(T[0].name||T[0].id));S?(p("cards"),l({cards:S})):(console.error("Invalid JSON structure",B),i("Invalid JSON: Could not find card data","error"))}else i("Invalid JSON format","error")}catch(B){console.error(B),i("Failed to parse JSON","error")}},I.readAsText(E)},j=async()=>{if(o){u(!0);try{if(h==="cards")await so.importBatch(n.uid,o.cards,m,o.decks),i(`Successfully imported ${o.cards.length} cards${o.decks?.length?` and ${o.decks.length} decks`:""}`,"success"),e();else if(h==="deck"){const _=await Xo.importDeck(n.uid,o.deck,o.cards,b);_.missingCards?.length>0?i(`Imported deck with ${_.missingCards.length} missing cards`,"warning"):i("Deck imported successfully","success"),e()}}catch(_){console.error(_),i("Import failed","error")}finally{u(!1)}}};return t?Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import Data"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 space-y-6",children:o?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg border border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detected Content"}),s.jsx("p",{className:"text-white font-bold text-lg",children:h==="cards"?s.jsxs(s.Fragment,{children:["Collection (",o.cards?.length||0," cards)",o.decks?.length>0&&` + ${o.decks.length} Decks`]}):`Deck: ${o.deck?.name} (${o.cards?.length||0} cards)`})]}),s.jsx("button",{onClick:()=>l(null),className:"text-sm text-red-400 hover:text-red-300 underline",children:"Change File"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-700 pb-2",children:"Import Options"}),h==="cards"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-700 hover:bg-gray-700/50 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:m==="merge",onChange:()=>g("merge"),className:"mt-1 bg-gray-900 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Merge (Recommended)"}),s.jsx("span",{className:"block text-gray-400 text-sm",children:"Add records to your existing collection. Updates if exists."})]})]}),s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-red-900/30 hover:bg-red-900/10 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:m==="replace",onChange:()=>g("replace"),className:"mt-1 bg-gray-900 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Replace (Use with Caution)"}),s.jsxs("span",{className:"block text-red-300 text-sm",children:["Delete your ENTIRE current collection.",o.decks?.length>0?" Existing decks will also be replaced by those in the backup.":" Your decks will be preserved since this backup only contains cards."]})]})]})]}),h==="deck"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:b.checkCollection,onChange:_=>v(E=>({...E,checkCollection:_.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Use existing unassigned copies from collection"})]}),s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:b.addToCollection,onChange:_=>v(E=>({...E,addToCollection:_.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Add missing cards to collection automatically"})]})]})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 hover:bg-gray-700/30 transition-all group",onClick:()=>a.current?.click(),children:[s.jsx("svg",{className:"w-12 h-12 text-gray-500 group-hover:text-indigo-400 mb-4 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsx("p",{className:"text-gray-300 font-medium",children:"Click to select backup JSON"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Supports Collection exports and Deck exports"}),s.jsx("input",{type:"file",ref:a,onChange:w,accept:".json",className:"hidden"})]})}),s.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",disabled:c,children:"Cancel"}),s.jsx("button",{onClick:j,disabled:!o||c,className:`px-6 py-2 rounded-lg font-bold text-white transition-all shadow-lg ${c?"bg-indigo-800 cursor-wait":m==="replace"&&h==="cards"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:c?"Importing...":"Start Import"})]})]})}),document.body):null},zPe=({isOpen:t,onClose:e})=>{const{userProfile:r,refreshUserProfile:n}=Or(),[i,a]=y.useState(!1),[o,l]=y.useState(r?.settings?.helper?.name||""),[c,u]=y.useState(r?.settings?.helper?.type||""),[h,p]=y.useState(r?.settings?.helper?.personality||""),[m,g]=y.useState(!1),[b,v]=y.useState([]),[w,j]=y.useState(""),[_,E]=y.useState(!1),[I,O]=y.useState({});Pe.useEffect(()=>{if(t){const $=r?.settings?.helper||{};l($.name||""),u($.type||""),p($.personality||""),a(!1),v([]),O({})}},[t,r]);const B=async()=>{g(!0);try{const k={...r?.settings||{},helper:{name:o,type:c,personality:h}};await Ge.updateUser(r.id,{settings:k}),await n(),e()}catch($){console.error($),alert("Failed to save helper.")}finally{g(!1)}},S=async()=>{a(!0),E(!0),O({}),v([]);try{const $=r?.settings?.geminiApiKey;if(!$)throw new Error("API Key missing");const k=await ul.forgeHelperChat($,[],{});v([{role:"model",content:k.aiResponse}])}catch($){console.error($),v([{role:"model",content:"Error connecting to the Forge. Please try again."}])}finally{E(!1)}},T=async()=>{if(!w.trim())return;const $=w;j(""),v(k=>[...k,{role:"user",content:$}]),E(!0);try{const k=r?.settings?.geminiApiKey,L=b.map(V=>({role:V.role,content:V.content}));L.push({role:"user",content:$});const R=await ul.forgeHelperChat(k,L,I);O(R.updatedDraft||{}),v(V=>[...V,{role:"model",content:R.aiResponse}])}catch(k){console.error(k),v(L=>[...L,{role:"model",content:"Reviewing the blueprints... (Error, try again)"}])}finally{E(!1)}},M=()=>{I.name&&l(I.name),I.type&&u(I.type),I.personality&&p(I.personality),a(!1)};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500",children:"Helper Settings"}),s.jsx("span",{className:"text-xs bg-gray-800 text-gray-500 px-2 py-1 rounded border border-gray-700",children:"Beta"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:i?s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-lg mb-4 text-sm text-gray-400 flex justify-between items-center",children:[s.jsx("span",{children:"Forging new identity..."}),s.jsx("button",{onClick:()=>a(!1),className:"text-white hover:underline",children:"Cancel"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-950/30 rounded-lg border border-gray-800",children:[b.map(($,k)=>s.jsx("div",{className:`flex ${$.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-xl text-sm ${$.role==="user"?"bg-emerald-600 text-white":"bg-gray-800 text-gray-200"}`,children:$.content})},k)),_&&s.jsx("div",{className:"flex justify-start",children:s.jsx("span",{className:"animate-pulse text-emerald-500",children:"..."})})]}),(I.name||I.type)&&s.jsxs("div",{className:"bg-black/40 p-3 rounded border border-emerald-500/30 mb-4 flex gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"})," ",s.jsx("span",{className:"text-white",children:I.name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Type:"})," ",s.jsx("span",{className:"text-white",children:I.type||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Personality:"})," ",s.jsx("span",{className:"text-white",children:I.personality||"-"})]}),s.jsx("button",{onClick:M,className:"ml-auto bg-emerald-600 text-white px-3 py-1 rounded hover:bg-emerald-500",children:"Apply This"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:w,onChange:$=>j($.target.value),onKeyDown:$=>$.key==="Enter"&&T(),placeholder:"Describe your helper...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-emerald-500 outline-none"}),s.jsx("button",{onClick:T,disabled:_,className:"bg-emerald-600 p-2 rounded-lg text-white",children:""})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex gap-4 items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-teal-500 to-emerald-700 rounded-full flex items-center justify-center text-2xl shadow-lg",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:o||"Unknown Helper"}),s.jsx("p",{className:"text-emerald-400 text-sm font-medium",children:c||"Generic Construct"}),s.jsxs("p",{className:"text-gray-400 text-sm italic mt-1",children:['"',h||"Standard protocol.",'"']})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Name"}),s.jsx("input",{type:"text",value:o,onChange:$=>l($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),s.jsx("input",{type:"text",value:c,onChange:$=>u($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Personality"}),s.jsx("input",{type:"text",value:h,onChange:$=>p($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-800",children:[s.jsxs("button",{onClick:S,className:"text-emerald-400 hover:text-emerald-300 font-bold flex items-center gap-2 px-4 py-2 hover:bg-emerald-900/20 rounded-lg transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Re-Forge Persona"]}),s.jsx("button",{onClick:B,disabled:m,className:"bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-6 rounded-lg transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m?"Saving...":"Save Changes"})]})]})})]})}):null},Vte=({isOpen:t,onClose:e})=>t?Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Everything you need to know about Pods & Permissions."})]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsx("div",{className:"bg-blue-900/10 border border-blue-500/20 p-4 rounded-xl",children:s.jsx("p",{className:"text-blue-200 text-sm font-medium",children:" Pro Tip: Only add people you actually know and trust to your Pod."})})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-indigo-400 font-black uppercase text-xs tracking-wider",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Private Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Download/Clone Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Edit Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-purple-400 font-black uppercase text-xs tracking-wider",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Editor"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Everything in Viewer"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," ",s.jsx("strong",{children:"Add/Remove Cards"})," from Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Add Cards to Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Delete Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-sm text-gray-400 border border-gray-700",children:[s.jsx("strong",{children:"How to use:"}),` In the Deck Builder, open the "Sources" dropdown and select a friend's collection to see their cards alongside yours.`]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-red-500/20 text-red-400 flex items-center justify-center text-xs",children:"4"}),"Safety & Revoking"]}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["You are always in control. You can revoke access at any time from this menu or the Settings page. Revoking access is ",s.jsx("strong",{children:"immediate"}),". The other user will be disconnected from your session instantly."]}),s.jsx("div",{className:"mt-4 flex gap-4",children:s.jsxs("div",{className:"flex-1 p-3 bg-red-900/10 border border-red-500/10 rounded-lg",children:[s.jsx("h5",{className:"font-bold text-red-400 text-xs uppercase mb-1",children:"They Cannot"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Delete your account, change your password, or permanently delete your cards/decks."})]})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors font-bold text-sm shadow-lg",children:"Got it, thanks!"})})]})]}),document.body):null,qPe=({isOpen:t,onClose:e,connection:r})=>{const{addToast:n}=jn(),[i,a]=y.useState([]),[o,l]=y.useState(!0),[c,u]=y.useState(!1),[h,p]=y.useState(!1);y.useEffect(()=>{t&&r&&(async()=>{l(!0);try{const w=await ia.fetchPermissions(),j=(Array.isArray(w)?w:[]).filter(_=>_.grantee_id===r.friend.id);a(j)}catch(w){console.error(w),n("Failed to load permissions","error")}finally{l(!1)}})()},[t,r]);const m=async v=>{u(!0);try{await ia.grantPermission(r.friend.id,v,null),n(`Global ${v} access granted`,"success");const w=await ia.fetchPermissions(),j=(Array.isArray(w)?w:[]).filter(_=>_.grantee_id===r.friend.id);a(j)}catch(w){console.error(w),n("Failed to update permission","error")}finally{u(!1)}},g=async v=>{try{await ia.revokePermission(v),n("Permission revoked","info"),a(w=>w.filter(j=>j.id!==v))}catch(w){console.error(w),n("Failed to revoke permission","error")}};if(!t||!r)return null;const b=i.find(v=>v.target_deck_id===null);return Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-2xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsx("div",{className:"p-8 border-b border-white/5 bg-gradient-to-r from-gray-900 to-gray-950 flex justify-between items-start",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-black text-3xl shadow-lg ring-4 ring-gray-900",children:r.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:r.friend.username}),s.jsx("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-xs mt-1",children:"Manage Permissions"})]})]})}),s.jsxs("div",{className:"p-8 space-y-8 overflow-y-auto custom-scrollbar",children:[s.jsx("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl overflow-hidden",children:s.jsx(xx,{children:({open:v})=>s.jsxs(s.Fragment,{children:[s.jsxs(xx.Button,{className:"flex justify-between w-full px-4 py-3 text-sm font-bold text-indigo-300 hover:text-indigo-200 transition-colors uppercase tracking-wider text-left",children:[s.jsx("span",{children:"What does Linking Accounts do?"}),s.jsx(Ixe,{className:`${v?"transform rotate-180":""} w-5 h-5 text-indigo-400`})]}),s.jsxs(xx.Panel,{className:"px-4 pb-4 text-sm text-indigo-200/80 leading-relaxed space-y-2",children:[s.jsx("p",{children:"Linking accounts allows you to share your Magic: The Gathering experience with trusted friends."}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-2",children:[s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Sharing Decks:"})," Friends can view your private decks to offer advice or clone them."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Shared Collection:"})," Combine your card pools visually to build decks together."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Deck Editing:"})," If granted ",s.jsx("strong",{children:"Editor"})," access, friends can actively tweak your deck lists (add/remove cards)."]})]}),s.jsx("p",{className:"mt-2 text-xs italic opacity-70",children:"Note: Friends can NEVER delete your decks or account, regardless of permission level."}),s.jsx("div",{className:"pt-2 mt-2 border-t border-indigo-500/20",children:s.jsxs("a",{href:"#",className:"flex items-center gap-2 text-indigo-400 hover:text-white font-bold transition-colors",onClick:w=>{w.preventDefault(),p(!0)},children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Read the Full Setup Guide"]})})]})]})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Global Access Level"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>m("viewer"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${b?.permission_level==="viewer"?"bg-indigo-600/10 border-indigo-500 shadow-indigo-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${b?.permission_level==="viewer"?"text-indigo-400":"text-white"}`,children:"Viewer"}),b?.permission_level==="viewer"&&s.jsx("span",{className:"bg-indigo-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Read-only access. Can view your ",s.jsx("strong",{children:"private decks"}),", ",s.jsx("strong",{children:"binders"}),", and ",s.jsx("strong",{children:"collection"}),". Cannot make changes."]})]}),s.jsxs("button",{onClick:()=>m("editor"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${b?.permission_level==="editor"?"bg-purple-600/10 border-purple-500 shadow-purple-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${b?.permission_level==="editor"?"text-purple-400":"text-white"}`,children:"Editor"}),b?.permission_level==="editor"&&s.jsx("span",{className:"bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Full collaboration. Can ",s.jsx("strong",{children:"edit your decks"}),", add cards to your ",s.jsx("strong",{children:"collection"}),", and view everything."]})]})]}),b&&s.jsx("div",{className:"mt-6 flex justify-center",children:s.jsxs("button",{onClick:()=>g(b.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Revoke All Access"]})})]}),s.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Specific Deck Overrides"}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto custom-scrollbar bg-gray-950/30 rounded-xl border border-white/5 p-2",children:i.filter(v=>v.target_deck_id).length>0?i.filter(v=>v.target_deck_id).map(v=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded bg-gray-900 flex items-center justify-center text-gray-500",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{children:[s.jsxs("span",{className:"text-sm font-bold text-gray-200 block",children:["Deck #",v.target_deck_id.slice(0,8),"..."]}),s.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wider",children:[v.permission_level," Access"]})]})]}),s.jsx("button",{onClick:()=>g(v.id),className:"text-gray-500 hover:text-red-400 p-2 hover:bg-white/5 rounded-lg transition-colors",title:"Revoke Permission",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},v.id)):s.jsx("div",{className:"text-center py-6 text-gray-500",children:s.jsx("p",{className:"text-xs italic",children:"No specific deck permissions granted."})})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-3 bg-white text-gray-900 hover:bg-gray-200 rounded-xl transition-colors font-bold text-sm shadow-xl",children:"Done"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
            `}}),s.jsx(Vte,{isOpen:h,onClose:()=>p(!1)})]}),document.body)},VPe=({isOpen:t,onClose:e,onSuccess:r})=>{const{updateProfileFields:n}=Or(),[i,a]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(null),h=async p=>{if(p.preventDefault(),u(null),!i.trim()){u("Username is required.");return}l(!0);try{await n({username:i.trim()}),r(),e()}catch(m){console.error(m),u("Failed to update username. It might be taken.")}finally{l(!1)}};return t?Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm"}),s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md relative z-10 shadow-2xl p-8 animate-fade-in-up",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Identify Yourself"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"To connect with friends and share decks, you need to set a unique username so others can find you."}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Username"}),s.jsx("input",{type:"text",value:i,onChange:p=>a(p.target.value),placeholder:"e.g. Planeswalker99",className:"w-full bg-gray-950 border border-gray-800 text-white px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-600 focus:border-transparent outline-none transition-all",autoFocus:!0})]}),c&&s.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:c}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:o,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-xl shadow-lg shadow-indigo-600/20 transition-all disabled:opacity-50 flex items-center gap-2",children:o?"Saving...":"Save & Continue"})]})]})]})]}),document.body):null},HPe=({isOpen:t,onClose:e,referralUrl:r,username:n})=>{if(!t)return null;const i=()=>{const a=document.getElementById("qr-gen"),o=new XMLSerializer().serializeToString(a),l=document.createElement("canvas"),c=l.getContext("2d"),u=new Image;u.onload=()=>{l.width=u.width,l.height=u.height,c.drawImage(u,0,0);const h=l.toDataURL("image/png"),p=document.createElement("a");p.download=`MTG-Forge-Referral-${n}.png`,p.href=`${h}`,p.click()},u.src="data:image/svg+xml;base64,"+btoa(o)};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-[#1a1c23] border border-indigo-500/30 w-full max-w-sm rounded-3xl p-8 shadow-2xl animate-fade-in pointer-events-auto",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white p-2 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white mb-2",children:"Share The Forge"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Scan this code to join ",n,"'s Pod and start brewing together."]})]}),s.jsx("div",{className:"bg-white p-4 rounded-3xl inline-block shadow-inner mx-auto",children:s.jsx(ik,{id:"qr-gen",value:r,size:200,level:"H",includeMargin:!0,imageSettings:{src:"/logo.png",x:void 0,y:void 0,height:40,width:40,excavate:!0}})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:i,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all shadow-lg flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download QR Code"]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:"Supports iOS & Android Camera Apps"})]})]})]})]})},WPe=()=>{const{user:t,userProfile:e}=Or(),[r,n]=y.useState([]),[i,a]=y.useState(!0),[o,l]=y.useState(null),[c,u]=y.useState(""),[h,p]=y.useState("pod"),[m,g]=y.useState(!1),[b,v]=y.useState(null),[w,j]=y.useState(!1),_=`https://mtg-forge.com/?ref=${e?.username||t.uid}`,[E,I]=y.useState(null),[O,B]=y.useState(!1),[S,T]=y.useState(!1),[M,$]=y.useState(!1),k=async()=>{a(!0);try{const re=await ia.fetchRelationships();n(re)}catch(re){console.error(re),l("Failed to load connections.")}finally{a(!1)}};y.useEffect(()=>{k()},[]);const L=async re=>{if(re.preventDefault(),!e?.username){$(!0);return}g(!0),v(null);try{await ia.sendRequest(c,h),v({type:"success",text:`Invite sent to ${c}!`}),u(""),k()}catch(se){v({type:"error",text:se.response?.data?.error||"Failed to send request."})}finally{g(!1)}},R=async(re,se)=>{if(!e?.username){$(!0);return}try{await ia.respondToRequest(re,se),k()}catch(ee){console.error(ee),l("Failed to update request.")}},V=r.filter(re=>re.status==="pending"),Y=V.filter(re=>re.direction==="incoming"),X=V.filter(re=>re.direction==="outgoing"),J=r.filter(re=>re.status==="accepted");return s.jsxs("div",{className:"space-y-8 animate-fade-in relative z-0",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 border-b border-gray-800 pb-6 relative",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 mb-2",children:"My Pod"}),s.jsx("p",{className:"text-gray-400 text-sm max-w-xl leading-relaxed",children:"Connect with trusted friends to view their decks, share collections, and collaborate on brews."})]}),s.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors text-sm font-bold bg-indigo-900/20 hover:bg-indigo-900/40 px-4 py-2 rounded-lg border border-indigo-500/30",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"How it Works"]})]}),i?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):J.length===0&&Y.length===0&&X.length===0?s.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-gray-800 p-8 md:p-12 text-center animate-fade-in-up shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),s.jsxs("div",{className:"max-w-md mx-auto relative z-10",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 text-indigo-400 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl ring-1 ring-inset ring-indigo-500/20",children:s.jsx("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("h2",{className:"text-2xl font-black text-white mb-3",children:"Start Your Pod"}),s.jsx("p",{className:"text-gray-400 mb-8 leading-relaxed",children:"Magic is better with friends. Invite someone to your Pod to start sharing decks and combining collections."}),s.jsxs("form",{onSubmit:L,className:"space-y-6",children:[s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl max-w-xs mx-auto",children:[s.jsx("button",{type:"button",onClick:()=>p("pod"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${h==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod Invite"}),s.jsx("button",{type:"button",onClick:()=>p("friend"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${h==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Social Friend"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"email",required:!0,placeholder:"Enter friend's email address...",value:c,onChange:re=>u(re.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-5 py-4 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-center placeholder-gray-600 shadow-inner"}),s.jsx("button",{type:"submit",disabled:m,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg shadow-indigo-900/20 transform hover:-translate-y-1",children:m?"Sending Invite...":h==="pod"?"Send Pod Invitation":"Send Friend Invite"})]}),b&&s.jsx("div",{className:`text-sm font-medium mt-2 ${b.type==="success"?"text-green-400":"text-red-400"}`,children:b.text})]})]})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsxs("div",{className:"bg-gray-900/30 rounded-3xl border border-gray-800 p-8 shadow-xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-2 rounded-lg shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Active Connections"]}),J.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:J.map(re=>s.jsxs("div",{className:"relative group bg-gray-800/40 p-5 rounded-2xl border border-gray-700/50 hover:border-indigo-500/50 transition-all duration-300 hover:bg-gray-800/60 hover:shadow-xl hover:shadow-indigo-900/10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center text-white font-black text-2xl shadow-lg ring-2 ring-gray-900",children:re.friend.username?.[0]?.toUpperCase()||"?"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-lg truncate group-hover:text-indigo-300 transition-colors uppercase",children:re.friend.username}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-[10px] uppercase tracking-widest font-black px-2 py-0.5 rounded ${re.type==="friend"?"bg-purple-900/30 text-purple-400 border border-purple-800/50":"bg-indigo-900/30 text-indigo-400 border border-indigo-800/50"}`,children:re.type==="friend"?"Friend":"Pod"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:re.type==="friend"?"Social Connect":"Full Access"})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{I(re),B(!0)},className:"flex-1 bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white py-2 rounded-lg text-xs font-bold transition-colors uppercase tracking-wider border border-white/5",children:"Manage"}),s.jsx("button",{onClick:async()=>{if(window.confirm(`Are you sure you want to remove ${re.friend.username} from your Pod?`))try{await ia.deleteRelationship(re.id),n(se=>se.filter(ee=>ee.id!==re.id))}catch(se){console.error(se),alert("Failed to remove")}},className:"px-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 rounded-lg transition-colors border border-red-500/10",title:"Remove Connection",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},re.id))}):s.jsx("div",{className:"text-center py-12 text-gray-500 italic opacity-50",children:"No active connections. Check your pending requests!"})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Add to Pod"}),s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl mb-4",children:[s.jsx("button",{type:"button",onClick:()=>p("pod"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${h==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod"}),s.jsx("button",{type:"button",onClick:()=>p("friend"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${h==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Friend"})]}),s.jsxs("form",{onSubmit:L,className:"space-y-3",children:[s.jsx("input",{type:"email",required:!0,placeholder:"friend@example.com",value:c,onChange:re=>u(re.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-4 py-3 rounded-xl focus:outline-none focus:border-indigo-500 text-sm transition-all"}),s.jsxs("button",{type:"submit",disabled:m,className:`w-full ${h==="friend"?"bg-purple-600 hover:bg-purple-500":"bg-indigo-600 hover:bg-indigo-500"} text-white font-bold py-3 px-4 rounded-xl transition-all shadow-lg text-sm flex items-center justify-center gap-2`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Invite ",h==="pod"?"to Pod":"as Friend"]}),b&&s.jsx("div",{className:`text-xs text-center ${b.type==="success"?"text-green-400":"text-red-400"}`,children:b.text})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/10 to-purple-900/10 rounded-2xl border border-indigo-500/20 p-6 space-y-4",children:[s.jsx("h3",{className:"text-sm font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 uppercase tracking-wider mb-2",children:"Referral & Sharing"}),s.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Spread the word about MTG Forge. Anyone who joins using your unique link will be automatically connected as a Social Friend."}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded-xl p-3 flex items-center gap-2",children:[s.jsxs("span",{className:"text-[10px] text-indigo-400 font-mono truncate flex-1 leading-none select-all pt-1",children:["https://mtg-forge.com/?ref=$",e?.username||t.uid]}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://mtg-forge.com/?ref=${e?.username||t.uid}`),alert("Referral link copied!")},className:"p-1.5 hover:bg-indigo-500/20 text-indigo-400 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>window.open(`mailto:?subject=Join me on MTG Forge&body=Hey, I've been using this awesome MTG collection manager and deck builder. Check it out: https://mtg-forge.com/?ref=${e?.username||t.uid}`),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),s.jsxs("button",{onClick:()=>j(!0),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1l-3 3h2v5h2V8h2l-3-3V4h-2zm-6 8v1h12v-1H6zm0 3v1h12v-1H6z"})}),"QR Code"]})]})]})]}),s.jsx(HPe,{isOpen:w,onClose:()=>j(!1),referralUrl:_,username:e?.username||"Hunter"}),Y.length>0&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/30 to-purple-900/30 rounded-2xl border border-indigo-500/30 p-6 animate-pulse-border",children:[s.jsxs("h3",{className:"text-sm font-bold text-indigo-300 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsxs("span",{className:"relative flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-indigo-500"})]}),"Pending Requests"]}),s.jsx("div",{className:"space-y-3",children:Y.map(re=>s.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-indigo-500/20 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:re.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-sm truncate",children:re.friend.username}),s.jsx("div",{className:"text-xs text-indigo-300 truncate",children:"wants to join your Pod"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>R(re.id,"accepted"),className:"flex-1 bg-indigo-500 hover:bg-indigo-400 text-white text-xs font-bold py-2 rounded-lg transition-colors shadow-md",children:"Accept"}),s.jsx("button",{onClick:()=>R(re.id,"blocked"),className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-400 text-xs font-bold py-2 rounded-lg transition-colors border border-gray-700",children:"Decline"})]})]},re.id))})]}),X.length>0&&s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6 opacity-60 hover:opacity-100 transition-opacity",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Pending Invites"}),s.jsx("div",{className:"space-y-3",children:X.map(re=>s.jsxs("div",{className:"flex items-center gap-3 text-sm bg-gray-900 p-3 rounded-lg border border-gray-800",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 animate-pulse"}),s.jsx("span",{className:"text-gray-300 truncate flex-1",children:re.friend.email})]},re.id))})]})]})]}),s.jsx(qPe,{isOpen:O,onClose:()=>B(!1),connection:E,currentUser:t}),s.jsx(VPe,{isOpen:M,onClose:()=>$(!1),onSuccess:()=>{}}),s.jsx(Vte,{isOpen:S,onClose:()=>T(!1)})]})},GPe=({isOpen:t,onClose:e,onConfirm:r,user:n})=>{const[i,a]=y.useState(nr.FREE);if(y.useEffect(()=>{t&&n&&a(n.override_tier||n.subscription_tier||nr.FREE)},[t,n]),!t||!n)return null;const o=Vs[i],l=i===nr.FREE;o.prices;const u={[nr.FREE]:{m:"$0",b:"$0",y:"$0"},[nr.TIER_1]:{m:"$2.99",b:"$14.99",y:"$29.99"},[nr.TIER_2]:{m:"$4.99",b:"$24.99",y:"$49.99"},[nr.TIER_3]:{m:"$9.99",b:"$49.99",y:"$99.99"},[nr.TIER_4]:{m:"$14.99",b:"$74.99",y:"$149.99"},[nr.TIER_5]:{m:"$19.99",b:"$99.99",y:"$199.99"}}[i]||{m:"-",b:"-",y:"-"};return s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-purple-500/30 rounded-xl p-6 max-w-lg w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Override Subscription"}),s.jsxs("p",{className:"text-gray-400 text-sm mb-6",children:["Manually set the subscription tier for ",s.jsx("span",{className:"text-white font-bold",children:n.username}),". This will bypass Stripe billing."]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Select Tier"}),s.jsx("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-500",value:i,onChange:h=>a(h.target.value),children:Object.values(nr).map(h=>s.jsxs("option",{value:h,children:[Vs[h].name," (",h.replace("tier_","Tier "),")"]},h))})]}),!l&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[s.jsx("h4",{className:"text-red-400 font-bold text-sm mb-2",children:" Potential Revenue Loss"}),s.jsxs("p",{className:"text-gray-400 text-xs mb-3",children:["By overriding this user to ",s.jsx("strong",{children:o.name}),", you are bypassing the following billing options:"]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Monthly"}),s.jsx("div",{className:"text-white font-mono",children:u.m})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"6 Months"}),s.jsx("div",{className:"text-white font-mono",children:u.b})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Yearly"}),s.jsx("div",{className:"text-white font-mono",children:u.y})]})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[n.override_tier&&s.jsx("button",{onClick:()=>r(null),className:"mr-auto px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold border border-red-500/30 transition-colors",children:"Remove Override"}),s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:()=>r(i),className:"px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-500 text-white font-bold shadow-lg",children:"Apply Override"})]})]})})},KPe=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",creating:o})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-300 mb-6",children:i}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:e,disabled:o,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:o,className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-bold shadow-lg disabled:opacity-50 flex items-center gap-2",children:[o&&s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})]})]})}):null,YPe=()=>{const{userProfile:t,refreshUserProfile:e}=Or(),[r,n]=y.useState("sync"),[i,a]=y.useState([]),[o,l]=y.useState(""),[c,u]=y.useState([]),[h,p]=y.useState(!1),m=Pe.useRef(!1),[g,b]=y.useState({current:0,total:0}),[v,w]=y.useState({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),[j,_]=y.useState({updatePrices:!0,updateInfo:!0}),[E,I]=y.useState(null),[O,B]=y.useState([]),[S,T]=y.useState(!1),[M,$]=y.useState([]),[k,L]=y.useState(!1);y.useEffect(()=>{R();const Re=localStorage.getItem("admin_last_sync");if(Re)try{I(JSON.parse(Re))}catch(Nt){console.error(Nt)}},[]),y.useEffect(()=>{r==="permissions"?V():r==="referrals"&&Y()},[r]);const R=async()=>{try{const Re=await Ge.get("/api/admin/sets");a(Re.data||[])}catch(Re){console.error(Re)}},V=async()=>{T(!0);try{const Re=await Ge.getUsers();Re.sort((Nt,Pt)=>(Pt.settings?.isAdmin?1:0)-(Nt.settings?.isAdmin?1:0)||Nt.id-Pt.id),B(Re)}catch(Re){console.error(Re)}finally{T(!1)}},Y=async()=>{L(!0);try{const Re=await Ge.get("/api/admin/invitations");$(Re)}catch(Re){console.error(Re)}finally{L(!1)}},X=async Re=>{if(window.confirm("Are you sure you want to reset this invitation? This will delete the pending record."))try{await Ge.delete(`/api/admin/invitations/${Re}`),Y()}catch{alert("Failed to reset invitation")}},J=Re=>u(Nt=>[...Nt,`${new Date().toLocaleTimeString()} - ${Re}`]),re=(Re,Nt)=>{w(Pt=>{const It={...Pt};return It.totalCards+=Re,Nt&&Object.keys(Nt).forEach(Zt=>It.types[Zt]=(It.types[Zt]||0)+(Nt[Zt]||0)),It})},se=Re=>{const Nt={date:new Date().toISOString(),stats:Re};I(Nt),localStorage.setItem("admin_last_sync",JSON.stringify(Nt))},ee=async(Re,Nt=!1)=>{if(Re)try{J(`Starting sync for ${Re}...`);const It=await(await fetch("/api/admin/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({setCode:Re,...j})})).json();It.success?(J(`Success: ${Re}. Processed ${It.count} cards.`),re(It.count,It.typeStats),Nt&&b(Zt=>({...Zt,current:Zt.current+1}))):J(`Error: ${It.error}`)}catch(Pt){J(`Request Failed: ${Pt.message}`)}},q=()=>{window.confirm("Cancel sync?")&&(m.current=!0,J("Cancelling..."))},U=async()=>{if(window.confirm("Sync ALL sets?")){p(!0),m.current=!1,J("Starting Mass Sync..."),w({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),b({current:0,total:i.length});for(const Re of i){if(m.current)break;await ee(Re.code,!0)}J("Mass Sync Complete!"),se(v),p(!1)}},W=async()=>{o&&(p(!0),w({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),await ee(o),p(!1))},Z=async Re=>{const Nt=Re.target.files[0];if(!Nt||!window.confirm(`Upload ${Nt.name}?`))return;const Pt=new FormData;Pt.append("file",Nt);try{const Zt=await(await fetch("/api/admin/precons/upload",{method:"POST",body:Pt})).json();Zt.success?alert(`Uploaded ${Zt.name}`):alert(`Error: ${Zt.error}`)}catch{alert("Upload failed")}Re.target.value=null},de=async(Re,Nt)=>{try{const Pt=Re.settings?.permissions||[],It=Pt.includes(Nt);let Zt;It?Zt=Pt.filter(Ae=>Ae!==Nt):Zt=[...Pt,Nt],B(O.map(Ae=>Ae.id===Re.id?{...Ae,settings:{...Ae.settings,permissions:Zt}}:Ae)),await Ge.updateUserPermissions(Re.id,Zt,Re.settings?.isAdmin)}catch{alert("Failed to update permission"),V()}},be=async Re=>{if(window.confirm(`Are you sure you want to toggle ADMIN status for ${Re.username}?`))try{const Nt=!Re.settings?.isAdmin;B(O.map(Pt=>Pt.id===Re.id?{...Pt,settings:{...Pt.settings,isAdmin:Nt}}:Pt)),await Ge.updateUserPermissions(Re.id,Re.settings?.permissions,Nt)}catch{alert("Failed to update admin status"),V()}},[oe,ne]=y.useState(!1),[H,le]=y.useState(null),ye=Re=>{le(Re),ne(!0)},me=async Re=>{if(H)try{const Nt=Re||"free";B(O.map(It=>It.id===H.id?{...It,override_tier:Re,subscription_tier:Nt}:It));const Pt={user_override_tier:Re,subscription_status:Re?"active":"canceled"};Pt.subscription_tier=Nt,await Ge.updateUserPermissions(H.id,H.settings?.permissions,H.settings?.isAdmin,Pt),ne(!1),le(null)}catch(Nt){alert(Nt.message||"Failed to update subscription"),V()}},[ke,Ie]=y.useState([]),[ce,Be]=y.useState({title:"",description:"",status:"open"}),[ct,Ve]=y.useState(null),[Ne,Ye]=y.useState(!1),[St,Vt]=y.useState({start:Gi(new Date(Date.now()-10080*60*1e3),"yyyy-MM-dd"),end:Gi(new Date,"yyyy-MM-dd")}),[Lt,at]=y.useState([]),[gt,vt]=y.useState(!1),[ft,ot]=y.useState(""),[ut,At]=y.useState(!1),[Fe,Ut]=y.useState(!1),[jt,qe]=y.useState(""),[rt,Ot]=y.useState(!1);y.useEffect(()=>{r==="epics"&&pt()},[r]);const pt=async()=>{Ye(!0);try{const Re=await Ge.getEpics();Ie(Re||[])}catch(Re){console.error(Re)}finally{Ye(!1)}},Jt=async Re=>{Re.preventDefault();try{await Ge.createEpic(ce),Be({title:"",description:"",status:"open"}),pt(),alert("Epic created successfully!")}catch(Nt){alert("Failed to create epic: "+Nt.message)}},Kt=async Re=>{if(Re.preventDefault(),!!ct)try{await Ge.updateEpic(ct.id,ct),Ve(null),pt(),alert("Epic updated successfully!")}catch(Nt){alert("Failed to update epic: "+Nt.message)}},rr=async Re=>{if(window.confirm("Delete this epic? This will NOT delete associated tickets but will unlink them."))try{await Ge.deleteEpic(Re),pt()}catch(Nt){alert("Failed to delete epic: "+Nt.message)}},Br=Re=>{const Nt={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},Pt={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Pend. Release",complete_scheduled:"Rel. Sched.",complete_blocked:"Blocked",wont_fix:"Won't Fix"};return s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-bold tracking-wider border ${Nt[Re]||Nt.open}`,children:Pt[Re]||Re})},zt=async()=>{vt(!0);try{const Re=await Ge.getTicketReport({startDate:St.start,endDate:St.end,excludeReleased:!0,status:""});at(Re)}catch(Re){alert("Failed to fetch report: "+Re.message)}finally{vt(!1)}},Wt=async()=>{if(!t?.settings?.geminiApiKey){alert("Missing Gemini API Key. Please add it in Settings > AI.");return}At(!0);try{const Re=await ul.generateReleaseNotes(t.settings.geminiApiKey,Lt);ot(Re),qe(`v${new Date().toISOString().slice(0,10).replace(/-/g,".")}`)}catch(Re){alert("Failed to generate release notes: "+Re.message)}finally{At(!1)}},qt=()=>{if(!jt)return alert("Please enter a version number (e.g. v1.2.0)");if(!ft)return alert("No notes generated");Ot(!0)},ur=async()=>{Ut(!0);try{const Re={features:Lt.filter(Nt=>Nt.type==="feature").length,bugs:Lt.filter(Nt=>Nt.type==="bug").length,total:Lt.length};await Ge.publishRelease({version:jt,notes:ft,ticketIds:Lt.map(Nt=>Nt.id),typeStats:Re}),Ot(!1),ot(""),at([]),alert("Release Published Successfully!")}catch(Re){alert("Failed to publish: "+Re.message),Ot(!1)}finally{Ut(!1)}};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx(KPe,{isOpen:rt,onClose:()=>Ot(!1),onConfirm:ur,title:`Publish Release ${jt}?`,message:`This will move ${Lt.length} tickets to the "Released" status and they will no longer appear on the active board. Are you sure?`,confirmText:Fe?"Publishing...":"Confirm Publish",creating:Fe}),s.jsx(GPe,{isOpen:oe,onClose:()=>ne(!1),onConfirm:me,user:H}),s.jsxs("div",{className:"flex border-b border-gray-700 mb-6 overflow-x-auto",children:[s.jsx("button",{onClick:()=>n("sync"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="sync"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"DB Sync & Tools"}),s.jsx("button",{onClick:()=>n("permissions"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="permissions"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"User Permissions"}),s.jsx("button",{onClick:()=>n("epics"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="epics"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Epics / Projects"}),s.jsx("button",{onClick:()=>n("release"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="release"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Release Notes"}),s.jsx("button",{onClick:()=>n("referrals"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="referrals"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Referrals"}),s.jsx("button",{onClick:()=>n("presets"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${r==="presets"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Dashboard Presets"})]}),r==="presets"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Dashboard Presets Manager"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Manage layouts saved in your admin account. These can act as system presets."}),s.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Saved Layouts"}),s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid gap-3",children:(()=>{const Re=t?.settings?.saved_layouts||{};return Array.from(new Set([...Object.keys(oN),...Object.keys(Re)])).map(Pt=>{const It=!!oN[Pt],Zt=!!Re[Pt],Ae=It&&Zt,et=Zt?Re[Pt]:oN[Pt];return s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${Ae?"bg-indigo-900/20 border-indigo-500/50":"bg-gray-800 border-gray-700"}`,children:[s.jsxs("div",{className:"min-w-0 flex-1 mr-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("div",{className:"font-bold text-white text-sm break-all",children:Pt}),It&&!Zt&&s.jsx("span",{className:"text-[10px] bg-gray-700 text-gray-300 px-1 rounded",children:"SYSTEM"}),Ae&&s.jsx("span",{className:"text-[10px] bg-indigo-500 text-white px-1 rounded",children:"OVERRIDE"}),!It&&s.jsx("span",{className:"text-[10px] bg-green-900 text-green-300 px-1 rounded",children:"CUSTOM"})]}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[et.layout?.grid?.length||0," widgets  ",(JSON.stringify(et).length/1024).toFixed(1)," KB"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{const Rt={l:et.layout,s:et.widgetSizes||{}},$t=JSON.stringify(Rt,null,2),Qt=document.getElementById("admin-import-code"),Ee=document.getElementById("admin-import-name");Qt&&Ee&&(Qt.value=$t,Ee.value=Pt,document.getElementById("admin-import-section")?.scrollIntoView({behavior:"smooth"}))},className:"p-2 text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors",title:"Edit JSON",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(btoa(JSON.stringify(et))),alert("Layout code copied!")},className:"p-2 text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-colors",title:"Copy Code",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-12a2 2 0 01-2-2V6a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),Zt&&s.jsx("button",{onClick:async()=>{if(window.confirm(It?`Revert "${Pt}" to system default?`:`Delete layout "${Pt}"?`)){const Rt={...t.settings.saved_layouts};delete Rt[Pt],await Ge.updateUser(t.id,{settings:{...t.settings,saved_layouts:Rt}}),e()}},className:"p-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:It?"Revert to Default":"Delete",children:It?s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},Pt)})})()})})]}),s.jsxs("div",{id:"admin-import-section",className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Add / Edit Preset"}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"w-full",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Preset Name"}),s.jsx("input",{id:"admin-import-name",type:"text",className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white text-sm",placeholder:"e.g. Default"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Layout Configuration (JSON or Base64)"}),s.jsx("textarea",{id:"admin-import-code",className:"w-full bg-gray-950 border border-gray-700 rounded-lg px-4 py-3 text-green-400 font-mono text-xs focus:ring-2 focus:ring-indigo-500 h-64",placeholder:'Paste Base64 code or raw JSON object like { "l": {...}, "s": {...} }'})]})]}),s.jsx("div",{className:"mt-4 text-right",children:s.jsx("button",{onClick:async()=>{const Re=document.getElementById("admin-import-code").value.trim(),Nt=document.getElementById("admin-import-name").value.trim();if(!Re||!Nt)return alert("Please enter code/json and name");try{let Pt;try{Pt=JSON.parse(Re)}catch{try{Pt=JSON.parse(atob(Re))}catch{throw new Error("Invalid format: Must be valid JSON or Base64 string")}}if(!Pt.l&&!Pt.layout)throw new Error("Invalid data structure (missing layout)");const It=Pt.l||Pt.layout,Zt=Pt.s||Pt.widgetSizes||{},Ae={...t.settings.saved_layouts||{},[Nt]:{layout:It,widgetSizes:Zt}};await Ge.updateUser(t.id,{settings:{...t.settings,saved_layouts:Ae}}),e(),alert("Saved successfully!"),document.getElementById("admin-import-code").value="",document.getElementById("admin-import-name").value=""}catch(Pt){alert("Error: "+Pt.message)}},className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-lg font-bold",children:"Save Preset"})})]})]}),r==="sync"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Scryfall Sync"}),E&&s.jsxs("div",{className:"text-right text-xs text-gray-400",children:[s.jsxs("p",{children:["Last: ",new Date(E.date).toLocaleString()]}),s.jsxs("p",{children:[E.stats.totalCards," cards"]})]})]}),s.jsxs("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Upload Precon JSON"}),s.jsx("input",{type:"file",accept:".json",onChange:Z,className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-indigo-900/40 p-4 rounded-lg border border-indigo-700/50",children:[s.jsx("p",{className:"text-xs text-indigo-300 uppercase font-bold",children:"Total Cards"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:v.totalCards})]}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700",children:[s.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Progress"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:g.total>0?`${g.current} / ${g.total}`:"-"}),g.total>0&&s.jsx("div",{className:"w-full bg-gray-700 h-1.5 mt-2 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${g.current/g.total*100}%`}})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-lg border border-gray-700/50 flex flex-wrap gap-6 items-center",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:j.updatePrices,onChange:Re=>_(Nt=>({...Nt,updatePrices:Re.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Prices"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:j.updateInfo,onChange:Re=>_(Nt=>({...Nt,updateInfo:Re.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Card Info"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Single Set"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white flex-1 min-w-0 max-w-full",value:o,onChange:Re=>l(Re.target.value),children:[s.jsx("option",{value:"",children:"Select Set..."}),i.map(Re=>s.jsxs("option",{value:Re.code,className:"truncate",children:[Re.name," (",Re.code.toUpperCase(),")"]},Re.code))]}),s.jsx("button",{onClick:W,disabled:h||!o,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg",children:h?"...":"Sync"})]})]}),s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Mass Sync"}),h?s.jsx("button",{onClick:q,className:"bg-red-600 text-white px-6 py-3 rounded-lg w-full font-bold animate-pulse",children:"CANCEL"}):s.jsx("button",{onClick:U,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold",children:"SYNC ALL"})]})]}),s.jsx("div",{className:"bg-black/50 p-4 rounded-lg font-mono text-xs text-green-400 h-64 overflow-y-auto border border-white/10",children:c.map((Re,Nt)=>s.jsx("div",{children:Re},Nt))})]})]}),r==="permissions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"User Permissions Manager"}),S?s.jsx("p",{className:"text-gray-400",children:"Loading users..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"User"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Subscription"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Admin"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Ticket Mgr"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-800",children:O.map(Re=>{const Nt=Re.settings?.permissions?.includes("manage_tickets"),Pt=Re.settings?.isAdmin;return s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-white",children:[Re.username||"No Username",Re.id===1&&s.jsx("span",{className:"ml-2 text-[10px] bg-yellow-500 text-black px-1 rounded",children:"ROOT"})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:Re.email}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${Re.override_tier?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-gray-700 text-gray-300 border-gray-600"}`,children:(Re.override_tier||Re.subscription_tier||"free").replace("tier_","Tier ")}),s.jsx("button",{onClick:()=>ye(Re),className:"text-[10px] bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition-colors",children:"Manage"})]})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>be(Re),className:`w-8 h-4 rounded-full transition-colors relative ${Pt?"bg-indigo-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Pt?"translate-x-4":"translate-x-0"}`})})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>de(Re,"manage_tickets"),className:`w-8 h-4 rounded-full transition-colors relative ${Nt?"bg-green-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Nt?"translate-x-4":"translate-x-0"}`})})}),s.jsxs("td",{className:"py-3 px-4 text-right text-xs text-gray-500",children:["ID: ",Re.id]})]},Re.id)})})]})})]}),r==="epics"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Manage Projects (Epics)"}),s.jsxs("div",{className:`bg-gray-800/50 p-6 rounded-xl border ${ct?"border-indigo-500/50 shadow-lg shadow-indigo-500/10":"border-white/10"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:ct?"Edit Project":"Create New Project"}),ct&&s.jsx("button",{onClick:()=>Ve(null),className:"text-xs text-gray-400 hover:text-white underline",children:"Cancel Edit"})]}),s.jsxs("form",{onSubmit:ct?Kt:Jt,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:ct?ct.title:ce.title,onChange:Re=>ct?Ve({...ct,title:Re.target.value}):Be({...ce,title:Re.target.value}),placeholder:"e.g. Q1 Mobile App"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-48",children:s.jsx(lT,{value:ct?ct.description:ce.description,onChange:Re=>ct?Ve({...ct,description:Re}):Be({...ce,description:Re}),placeholder:"Detailed epic goal...",type:"Epic",height:"h-40"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:ct?ct.status:ce.status,onChange:Re=>ct?Ve({...ct,status:Re.target.value}):Be({...ce,status:Re.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"}),s.jsx("option",{value:"active",className:"text-gray-500",children:"Active (Legacy)"}),s.jsx("option",{value:"archived",className:"text-gray-500",children:"Archived (Legacy)"})]})]}),s.jsx("div",{className:"flex justify-end pt-4 gap-2",children:s.jsx("button",{type:"submit",className:`px-6 py-2 font-bold rounded-lg shadow-lg transition-all text-white ${ct?"bg-green-600 hover:bg-green-500":"bg-indigo-600 hover:bg-indigo-500"}`,children:ct?"Save Changes":"Create Epic"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:"Existing Projects"}),Ne?s.jsx("div",{className:"text-gray-500",children:"Loading..."}):s.jsxs("div",{className:"space-y-2",children:[ke.map(Re=>s.jsxs("div",{className:`bg-gray-800 p-4 rounded-xl border flex justify-between items-center group transition-all ${ct?.id===Re.id?"border-indigo-500 ring-1 ring-indigo-500 bg-gray-800/80":"border-white/5 hover:border-white/10"}`,children:[s.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("h4",{className:"font-bold text-white truncate",children:Re.title}),Br(Re.status)]}),s.jsx("div",{className:"text-sm text-gray-400 prose prose-invert prose-sm max-w-none line-clamp-1",dangerouslySetInnerHTML:{__html:Re.description||""}})]}),s.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[s.jsxs("div",{className:"text-right hidden sm:block",children:[s.jsxs("span",{className:"text-xs text-gray-500 block",children:["ID: ",Re.id]}),s.jsxs("span",{className:"text-xs text-indigo-400 block",children:[Re.ticket_count||0," tickets"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{Ve(Re),window.scrollTo({top:0,behavior:"smooth"})},className:"p-2 text-gray-400 hover:text-white bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Edit",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("button",{onClick:()=>rr(Re.id),className:"p-2 text-gray-400 hover:text-red-400 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Delete",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},Re.id)),ke.length===0&&s.jsx("div",{className:"text-gray-500 italic",children:"No projects found."})]})]})]}),r==="release"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Release Notes Generator"}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-white/10 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Start Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:St.start,onChange:Re=>Vt({...St,start:Re.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"End Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:St.end,onChange:Re=>Vt({...St,end:Re.target.value})})]}),s.jsx("button",{onClick:zt,disabled:gt,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg transition-all disabled:opacity-50",children:gt?"Fetching...":"Fetch Active Tickets"})]}),Lt.length>0&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-medium text-white italic",children:["Tickets Found (",Lt.length,")"]}),s.jsxs("button",{onClick:Wt,disabled:ut,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white font-bold rounded-lg shadow-lg transition-all disabled:opacity-50",children:[" ",ut?"Generating...":"Generate AI Release Notes"]})]}),s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 pr-2",children:Lt.map(Re=>s.jsxs("div",{className:"bg-black/30 p-3 rounded-lg border border-white/5 flex gap-4 items-center",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${Re.type==="bug"?"bg-red-500/20 text-red-400":"bg-emerald-500/20 text-emerald-400"}`,children:Re.type}),s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${Re.status==="completed"?"bg-green-500/20 text-green-400":"bg-indigo-500/20 text-indigo-400"}`,children:Re.status.replace("_"," ")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-white truncate",children:Re.title}),s.jsxs("div",{className:"flex gap-2",children:[Re.epic_title&&s.jsxs("p",{className:"text-[10px] text-gray-400",children:["Project: ",Re.epic_title]}),Re.type==="bug"&&Re.created_by_username&&s.jsxs("p",{className:"text-[10px] text-indigo-400",children:["By: ",Re.created_by_username]})]})]}),s.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:Gi(new Date(Re.updated_at),"MMM d")})]},Re.id))})]}),ft&&s.jsxs("div",{className:"space-y-4 pt-6 border-t border-indigo-500/30",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-medium text-indigo-400 font-black uppercase tracking-widest",children:"Release Notes Preview"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"text",placeholder:"v1.0.0",className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-1 text-white text-sm",value:jt,onChange:Re=>qe(Re.target.value)}),s.jsx("button",{onClick:qt,disabled:Fe,className:"px-4 py-1.5 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg text-sm shadow-lg disabled:opacity-50",children:" Publish Release"}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ft),alert("Copied to clipboard!")},className:"text-xs text-indigo-400 hover:text-white transition-colors",children:"Copy HTML"})]})]}),s.jsx("div",{className:"bg-gray-900 border border-indigo-500/20 p-6 rounded-xl prose prose-invert max-w-none shadow-2xl",dangerouslySetInnerHTML:{__html:ft}})]})]})]}),r==="referrals"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"External Invitations (Referrals)"}),s.jsx("button",{onClick:Y,className:"text-xs text-indigo-400 hover:text-indigo-300 font-medium",children:"Refresh List"})]}),k?s.jsx("p",{className:"text-gray-400",children:"Loading invitations..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"Invitee Email"}),s.jsx("th",{className:"py-3 px-4",children:"Invited By"}),s.jsx("th",{className:"py-3 px-4",children:"Sent At"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsxs("tbody",{className:"text-sm divide-y divide-gray-800",children:[M.map(Re=>s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-white",children:Re.invitee_email}),s.jsxs("td",{className:"py-3 px-4 text-gray-400",children:[s.jsx("div",{children:Re.inviter_username}),s.jsx("div",{className:"text-[10px] text-gray-500",children:Re.inviter_email})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:Gi(new Date(Re.created_at),"MMM dd, yyyy HH:mm")}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${Re.status==="completed"?"bg-green-500/10 text-green-400 border-green-500/20":"bg-yellow-500/10 text-yellow-400 border-yellow-500/20"}`,children:Re.status})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsx("button",{onClick:()=>X(Re.id),className:"text-red-400 hover:text-red-300 transition-colors font-medium text-xs",children:"Reset"})})]},Re.id)),M.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"py-8 text-center text-gray-500 italic",children:"No invitations found."})})]})]})})]})]})},XPe=()=>{const{userProfile:t,currentUser:e,refreshUserProfile:r}=Or();xn();const[n,i]=y.useState(!1),[a,o]=y.useState(!1),[l,c]=y.useState("monthly"),{cards:u}=vl(),{decks:h}=z0(),p=t?.override_tier||t?.subscription_tier||nr.FREE,m=Ln(p),g=t?.subscription_status||(p!==nr.FREE?"active":"free"),b=t?.subscription_end_date?new Date(t.subscription_end_date).toLocaleDateString():null,v=y.useMemo(()=>{if(!u||!h)return{decks:0,collection:0,wishlist:0};const I=u.filter(T=>!T.is_wishlist),O=u.filter(T=>T.is_wishlist);let B=I.reduce((T,M)=>T+(M.count||1),0),S=O.reduce((T,M)=>T+(M.count||1),0);return{decks:h.length,collection:B,wishlist:S}},[u,h]),w=async()=>{i(!0);try{const I=await Ge.post("/api/payments/create-portal-session",{});I.url?window.location.href=I.url:alert("Failed to redirect to billing portal.")}catch(I){console.error("Billing portal error:",I),alert("Could not open billing portal. "+(I.response?.data?.error||I.message))}finally{i(!1)}},j=async I=>{i(!0);try{const O=await Ge.post("/api/payments/create-checkout-session",{tierId:I,interval:l,successUrl:`${window.location.origin}/settings?success=true`,cancelUrl:`${window.location.origin}/settings?canceled=true`});if(O.url)window.location.href=O.url;else throw new Error("No checkout URL returned")}catch(O){console.error("Subscription error:",O),alert(O.message||"Failed to start subscription process"),i(!1)}},_=I=>{switch(I){case nr.FREE:return s.jsx(lm,{className:"w-12 h-12 text-gray-400"});case nr.TIER_1:return s.jsx(V2e,{className:"w-12 h-12 text-blue-400"});case nr.TIER_2:return s.jsx(um,{className:"w-12 h-12 text-purple-400"});case nr.TIER_3:return s.jsx(bx,{className:"w-12 h-12 text-yellow-400"});case nr.TIER_4:return s.jsx(bx,{className:"w-12 h-12 text-orange-500"});case nr.TIER_5:return s.jsx(bx,{className:"w-12 h-12 text-red-500"});default:return s.jsx(lm,{className:"w-12 h-12 text-gray-400"})}},E=(I,O,B,S)=>{const T=B===1/0?0:Math.min(O/B*100,100),M=B!==1/0&&O/B>=.9;let $="bg-green-500";return B===1/0?$="bg-blue-500":T>=90?$="bg-red-500":T>=75&&($="bg-yellow-500"),s.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-gray-300 text-sm font-medium flex items-center gap-2",children:[s.jsx("span",{children:S})," ",I]}),s.jsxs("span",{className:`font-bold text-sm ${M?"text-red-400":"text-white"}`,children:[O," / ",B===1/0?"":B]})]}),s.jsx("div",{className:"h-2 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/50",children:s.jsx("div",{className:`h-full ${$} transition-all duration-1000 ease-out`,style:{width:B===1/0?"100%":`${T}%`}})}),M&&s.jsx("p",{className:"text-[10px] text-red-400 mt-1 mt-2",children:"Running low on space!"})]})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Membership & Billing"}),s.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between relative z-10 gap-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"p-3 bg-gray-800 rounded-lg border border-gray-700 shrink-0",children:_(p)}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:m.name}),s.jsx("p",{className:"text-gray-400 text-sm max-w-md",children:m.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border ${g==="active"?"bg-green-500/10 text-green-400 border-green-500/20":g==="canceled"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/20":g==="past_due"?"bg-red-500/10 text-red-400 border-red-500/20":"bg-gray-700 text-gray-300 border-gray-600"}`,children:g==="free"?"Free Plan":g.replace("_"," ")}),t?.override_tier&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border bg-purple-500/10 text-purple-400 border-purple-500/20",children:"Admin Override"}),b&&g!=="free"&&!t?.override_tier&&s.jsxs("span",{className:"text-xs text-gray-500",children:[g==="canceled"?"Expires":"Renews"," on ",b]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:[s.jsx("button",{onClick:()=>o(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-purple-900/20 transition-all hover:scale-105 whitespace-nowrap",children:p===nr.FREE?"Upgrade Plan":"Change Plan"}),p!==nr.FREE&&s.jsxs("button",{onClick:w,disabled:n,className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium border border-gray-600 transition-colors text-sm",children:[s.jsx(Z1e,{className:"w-4 h-4"}),n?"Loading...":"Manage Billing"]})]})]}),s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-b from-purple-500/10 to-transparent rounded-bl-full pointer-events-none"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:""})," Usage & Limits"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[E("Decks",v.decks,m.limits.decks,""),E("Collection",v.collection,m.limits.collection,""),E("Wishlist",v.wishlist,m.limits.wishlist,"")]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 text-right",children:"* Limits apply to active items. Archived/Deleted items do not count."})]}),a&&Vn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center p-4 pt-24 text-left font-sans",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>o(!1)}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-[95vw] max-h-[85vh] overflow-y-auto shadow-2xl animate-scale-in",children:[s.jsxs("div",{className:"sticky top-0 z-20 flex justify-between items-center p-6 bg-gray-900/95 backdrop-blur border-b border-gray-800",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select a Plan"}),s.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx(Fd,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"p-6 md:p-8",children:s.jsx(TL,{billingInterval:l,setBillingInterval:c,onSubscribe:j,isLoading:n,currentTier:p})})]})]}),document.body)]})},Hte=({players:t,logs:e})=>{const r=y.useMemo(()=>{if(!e||e.length===0)return null;const _=Math.max(...e.map(k=>k.metadata?.turn||k.turn||0),0)+1,E=["#6366f1","#ec4899","#22c55e","#eab308","#ef4444","#3b82f6"],I={};t.forEach((k,L)=>{I[k.id]=E[L%E.length]});const O={0:{}};t.forEach(k=>O[0][k.id]=40);let B={};t.forEach(k=>B[k.id]=40),[...e].sort((k,L)=>new Date(k.created_at||k.timestamp)-new Date(L.created_at||L.timestamp)).forEach(k=>{if(k.type==="life"||k.action_type==="life"){const R=k.playerId||k.actor_participant_id;if(R){const V=k.currentLife??k.metadata?.currentLife;V!==void 0?B[R]=V:B[R]=(B[R]||40)+(k.change||k.value||0)}}const L=k.turn||k.metadata?.turn||1;O[L]||(O[L]={}),t.forEach(R=>{O[L][R.id]=B[R.id]})});const T={};t.forEach(k=>T[k.id]=[]);let M=0,$=45;return Object.keys(O).forEach(k=>{const L=parseInt(k);t.forEach(R=>{let V=O[L][R.id];V!==void 0&&(T[R.id].push({x:L,y:V}),V>$&&($=V),V<M&&(M=V))})}),t.forEach(k=>{const L=T[k.id];L.length===0&&L.push({x:0,y:40}),L[L.length-1].x<_&&L.push({x:_,y:B[k.id]});const V=B[k.id];V>$&&($=V),V<M&&(M=V)}),{playerPoints:T,minLife:M,maxLife:$,maxTurn:_,playerColorMap:I,finalLife:B}},[t,e]);if(!r)return null;const{playerPoints:n,minLife:i,maxLife:a,maxTurn:o,playerColorMap:l,finalLife:c}=r,u=300,h=150,p={top:10,right:10,bottom:20,left:25},m=u-p.left-p.right,g=h-p.top-p.bottom,b=_=>p.left+_/(o-1||1)*m,v=_=>{const E=a-i||1;return p.top+g-(_-i)/E*g},w=Array.from({length:o},(_,E)=>E),j=(()=>{const _=[],I=a-i>20?10:5;for(let O=Math.ceil(i/I)*I;O<=a;O+=I)_.push(O);return _.includes(i)||_.unshift(i),_.includes(a)||_.push(a),[...new Set(_)].sort((O,B)=>O-B)})();return s.jsxs("div",{className:"w-full h-full flex flex-col relative",children:[s.jsx("div",{className:"flex flex-wrap gap-3 absolute top-2 right-2 z-10 pointer-events-none",children:t.map(_=>s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-white/10 shadow-sm",children:[s.jsx("div",{className:"w-2 h-2 rounded-full shadow-[0_0_5px]",style:{backgroundColor:l[_.id],boxShadow:`0 0 5px ${l[_.id]}`}}),s.jsxs("span",{className:"text-[10px] text-gray-200 font-bold leading-none",children:[_.name,": ",s.jsx("span",{className:"text-white",children:c[_.id]??"?"})]})]},_.id))}),s.jsxs("svg",{viewBox:`0 0 ${u} ${h}`,className:"w-full h-full overflow-visible font-mono select-none",children:[s.jsxs("g",{className:"opacity-20",children:[j.map(_=>s.jsx("line",{x1:p.left,y1:v(_),x2:u-p.right,y2:v(_),stroke:"currentColor",strokeWidth:"0.5",strokeDasharray:"2",className:"text-gray-500"},`y-${_}`)),w.map(_=>s.jsx("line",{x1:b(_),y1:p.top,x2:b(_),y2:h-p.bottom,stroke:"currentColor",strokeWidth:"0.5",className:"text-gray-500"},`x-${_}`))]}),s.jsxs("g",{className:"text-[8px] fill-gray-500 font-medium",children:[j.map(_=>s.jsx("text",{x:p.left-4,y:v(_),dy:"0.3em",textAnchor:"end",children:_},`yl-${_}`)),w.map(_=>s.jsx("text",{x:b(_),y:h-p.bottom+10,textAnchor:"middle",children:_},`xl-${_}`))]}),t.map(_=>{const E=n[_.id];if(!E||E.length===0)return null;const I=E.map((O,B)=>`${B===0?"M":"L"} ${b(O.x)} ${v(O.y)}`).join(" ");return s.jsxs("g",{children:[s.jsx("path",{d:I,fill:"none",stroke:l[_.id],strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"drop-shadow-md vector-effect-non-scaling-stroke"}),E.map((O,B)=>s.jsx("circle",{cx:b(O.x),cy:v(O.y),r:"1.5",fill:l[_.id],stroke:"black",strokeWidth:"0.5"},B))]},_.id)})]})]})},VC=({label:t,value:e,subtext:r,icon:n,color:i="text-gray-400"})=>s.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:t}),s.jsx("div",{className:"text-2xl font-black text-white",children:e}),r&&s.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:r})]}),n&&s.jsx(n,{className:`w-8 h-8 opacity-20 ${i}`})]}),QPe=({isOpen:t,onClose:e,match:r,logs:n})=>{if(!t||!r)return null;const i=y.useMemo(()=>{if(!n||n.length===0)return null;const o=r.my_participant_id;let l=0,c=0;const u={poison:0,energy:0,experience:0},h={};n.forEach(g=>{const b=g.metadata?.turn||0;if(b>c&&(c=b),g.action_type==="life"&&(g.actor_participant_id===o||g.playerId===o)){const v=g.value||g.change;if(v<0){const w=Math.abs(v);l+=w,h[b]=(h[b]||0)+w}}g.action_type==="counter"&&(g.actor_participant_id===o||g.playerId===o)&&u[g.counterType]!==void 0&&(u[g.counterType]=g.newValue)});const p=c>0?(l/c).toFixed(1):"0.0",m=Math.max(0,...Object.values(h));return{avgDamageTaken:p,maxDamageInTurn:m,turns:c,finalResources:u}},[r,n]),a=[{id:r.my_participant_id,name:"Me"},...(r.opponents||[]).map(o=>({id:o.participant_id,name:o.name}))];return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-200",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl h-[90vh] shadow-2xl overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-gradient-to-r from-gray-900 to-indigo-950/30",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center gap-3",children:[s.jsx(EA,{className:"w-6 h-6 text-indigo-500"}),"Match Report"]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-gray-400 mt-2",children:[s.jsx("span",{children:Gi(new Date(r.ended_at),"PPP p")}),s.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),s.jsx("span",{children:r.duration_seconds?`${Math.floor(r.duration_seconds/60)}m`:"Unknown duration"})]})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx(Fd,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[s.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/5 p-6 min-h-[400px] flex flex-col relative",children:[s.jsx("div",{className:"absolute top-4 left-4 z-10",children:s.jsx("h3",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:"Life History"})}),!n||n.length===0?s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 italic",children:"No combat data available"}):s.jsx(Hte,{players:a,logs:n})]}),i&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(VC,{label:"Avg Dmg Taken / Turn",value:i.avgDamageTaken,icon:lm,color:"text-red-500"}),s.jsx(VC,{label:"Most Dmg / Turn",value:i.maxDamageInTurn,icon:rj,color:"text-orange-500"}),s.jsx(VC,{label:"Turns Played",value:i.turns,icon:EA,color:"text-blue-500"}),s.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[s.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"My Resources"}),s.jsxs("div",{className:"flex items-center gap-3",children:[i.finalResources.poison>0&&s.jsxs("div",{className:"flex items-center gap-1 text-green-500",title:"Poison",children:[s.jsx(rj,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.poison})]}),i.finalResources.energy>0&&s.jsxs("div",{className:"flex items-center gap-1 text-yellow-400",title:"Energy",children:[s.jsx(um,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.energy})]}),i.finalResources.experience>0&&s.jsxs("div",{className:"flex items-center gap-1 text-blue-400",title:"Experience",children:[s.jsx(GI,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.experience})]}),!i.finalResources.poison&&!i.finalResources.energy&&!i.finalResources.experience&&s.jsx("span",{className:"text-gray-500 text-xs italic",children:"None recorded"})]})]})]})]})]})})},JPe=()=>{const{userProfile:t}=Or(),[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(null),[l,c]=y.useState({}),[u,h]=y.useState(!1),[p,m]=y.useState(null);y.useEffect(()=>{t?.id&&g()},[t]);const g=async()=>{try{i(!0);const I=await Ge.get(`/api/matches/user/${t.id}`);r(I||[])}catch(I){console.error("Failed to load match history:",I),o("Failed to load match history.")}finally{i(!1)}},b=async I=>{if(window.confirm("Are you sure you want to delete this match record?"))try{await Ge.delete(`/api/matches/${I}`),r(O=>O.filter(B=>B.match_id!==I))}catch(O){console.error(O),alert("Failed to delete match")}},v=async()=>{if(window.confirm("Are you sure you want to clear ALL match history? This cannot be undone."))try{await Ge.delete(`/api/matches/user/${t.id}`),r([])}catch(I){console.error(I),alert("Failed to clear history")}},w=async I=>{const O=I.match_id;if(m(I),!l[O]){h(!0);try{const B=await Ge.get(`/api/matches/${O}/logs`);c(S=>({...S,[O]:B}))}catch(B){console.error("Failed to fetch logs:",B)}finally{h(!1)}}};if(n)return s.jsx("div",{className:"flex justify-center p-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})});if(a)return s.jsx("div",{className:"text-center p-8 text-red-400 bg-red-900/10 rounded-xl border border-red-500/20",children:a});if(e.length===0)return s.jsxs("div",{className:"text-center p-12 bg-gray-900 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"bg-gray-800 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ro,{className:"w-8 h-8 text-gray-600"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Matches Yet"}),s.jsx("p",{className:"text-gray-400",children:"Join a Live Session to track your games!"})]});const j=e.length,_=e.filter(I=>I.placement===1).length,E=Math.round(_/j*100);return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Games"}),s.jsx("div",{className:"text-3xl font-black text-white",children:j})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Wins"}),s.jsx("div",{className:"text-3xl font-black text-indigo-400",children:_})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Win Rate"}),s.jsxs("div",{className:"text-3xl font-black text-green-400",children:[E,"%"]})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Recent Activity"}),s.jsx("div",{className:"text-sm font-medium text-gray-300 mt-1",children:e[0]?Gi(new Date(e[0].ended_at),"MMM d"):"-"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Recent Matches"}),e.length>0&&s.jsxs("button",{onClick:v,className:"text-red-400 hover:text-red-300 text-xs font-bold uppercase tracking-wider flex items-center gap-2 px-3 py-2 hover:bg-red-500/10 rounded transition-colors",children:[s.jsx(OQ,{className:"w-4 h-4"}),"Clear History"]})]}),s.jsx("div",{className:"grid gap-3",children:e.map(I=>{const O=I.placement===1,B=new Date(I.ended_at),S=Math.floor((new Date(I.ended_at)-new Date(I.started_at))/1e3/60);return[I.my_participant_id,...(I.opponents||[]).map(T=>({id:T.participant_id,name:T.name}))],s.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden group",children:s.jsxs("div",{className:"p-4 flex flex-col md:flex-row items-start md:items-center gap-4 hover:bg-gray-750 transition-colors",children:[s.jsx("div",{className:`shrink-0 w-12 h-12 rounded-lg flex items-center justify-center border ${O?"bg-yellow-500/10 border-yellow-500/30 text-yellow-500":"bg-gray-700/50 border-gray-600 text-gray-400"}`,children:O?s.jsx(Ro,{className:"w-6 h-6"}):s.jsxs("span",{className:"text-lg font-bold",children:["#",I.placement]})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex flex-col gap-1 mb-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Me:"}),s.jsx("h4",{className:"font-bold text-white truncate max-w-[200px]",children:I.deck_name||"Generic Deck"}),I.deck_commander&&s.jsx("span",{className:"text-[10px] bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/30 truncate max-w-[150px]",children:typeof I.deck_commander=="object"?I.deck_commander.name:I.deck_commander})]}),I.opponents?.length>0&&s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-1",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"VS:"}),I.opponents.map((T,M)=>s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/20 px-2 py-1 rounded",children:[s.jsx(OA,{className:"w-3 h-3 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-300",children:T.name}),s.jsx("span",{className:"text-xs text-gray-500 border-l border-gray-700 pl-1.5 ml-0.5",children:T.deck_name||"Generic"}),T.commander&&s.jsxs("span",{className:"text-[10px] text-gray-600 truncate max-w-[80px]",children:["(",typeof T.commander=="object"?T.commander.name:T.commander,")"]})]},M))]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-400 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(AQ,{className:"w-3 h-3"}),Gi(B,"MMM d, h:mm a")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(TQ,{className:"w-3 h-3"}),S," min"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>w(I),className:"p-2 text-indigo-400 hover:text-white bg-indigo-500/10 hover:bg-indigo-500 rounded-lg transition-colors flex items-center gap-2 border border-indigo-500/20",children:[s.jsx(F1e,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Report"})]}),s.jsx("button",{onClick:()=>b(I.match_id),className:"p-2 text-gray-600 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete Record",children:s.jsx(K1e,{className:"w-5 h-5"})})]})]})},I.match_id)})})]}),s.jsx(QPe,{isOpen:!!p,onClose:()=>m(null),match:p,logs:p?l[p.match_id]:[]})]})},ZPe=()=>{const{user:t,userProfile:e,refreshUserProfile:r,resetPassword:n,sendVerification:i,updateProfileFields:a}=Or(),{tab:o}=yl(),l=xn(),c=o||"account",[u,h]=y.useState(!1),[p,m]=y.useState(!1),[g,b]=y.useState(!1),[v,w]=y.useState(!1),[j,_]=y.useState(!1),[E,I]=y.useState(!1),[O,B]=y.useState(null),[S,T]=y.useState(!1),[M,$]=y.useState(""),[k,L]=y.useState("grid"),[R,V]=y.useState("md"),[Y,X]=y.useState(""),[J,re]=y.useState(""),[se,ee]=y.useState(""),[q,U]=y.useState(!1),[W,Z]=y.useState(!1),[de,be]=y.useState(!1),[oe,ne]=y.useState(""),[H,le]=y.useState(""),[ye,me]=v4();y.useEffect(()=>{e?.settings&&(e.settings.geminiApiKey&&$(e.settings.geminiApiKey),e.settings.viewMode&&L(e.settings.viewMode),e.settings.gridSize&&V(e.settings.gridSize)),e&&(X(e.username||""),re(e.first_name||""),ee(e.last_name||""),be(e.is_public_library||!1),ne(e.data?.bio||""),le(e.data?.avatar||"")),ye.get("success")==="true"&&(async()=>{try{await Ge.post("/api/payments/sync-subscription"),await r(),me({}),alert("Subscription updated successfully!")}catch(Ye){console.error("Sync failed",Ye)}})()},[e,ye,me,r]);const ke=async()=>{if(!e?.id){alert("User profile not ready. Please try again.");return}m(!0);try{const Ne={...e?.settings||{},geminiApiKey:M,viewMode:k,gridSize:R};await Ge.updateUser(e.id,{settings:Ne}),await r(),alert("Settings saved!")}catch(Ve){console.error("Failed to save settings:",Ve),alert("Error saving settings: "+(Ve.message||"Unknown error"))}finally{m(!1)}},Ie=async()=>{m(!0);try{await a({username:Y,first_name:J,last_name:se,is_public_library:de,data:{...e?.data||{},bio:oe,avatar:H}}),alert("Profile updated successfully!")}catch(Ve){console.error("Failed to update profile:",Ve),alert("Error updating profile: "+(Ve.message||"Unknown error"))}finally{m(!1)}},ce=async()=>{if(t?.email){U(!0);try{await n(t.email),alert("Password reset email sent!")}catch(Ve){alert("Error: "+Ve.message)}finally{U(!1)}}},Be=async()=>{Z(!0);try{await i(),alert("Verification email sent!")}catch(Ve){alert("Error: "+Ve.message)}finally{Z(!1)}},ct=async()=>{try{const Ve=await Ge.get("/api/collection/export");let Ne=[],Ye=[];if(Array.isArray(Ve)?Ne=Ve:Ve&&typeof Ve=="object"&&(Ne=Ve.cards||[],Ye=Ve.decks||[]),Ne.length===0&&Ye.length===0){alert("No data to export.");return}const St=JSON.stringify({cards:Ne,decks:Ye,exported_at:new Date},null,2),Vt=new Blob([St],{type:"application/json"}),Lt=URL.createObjectURL(Vt),at=document.createElement("a");at.href=Lt,at.download=`mtg_library_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(at),at.click(),document.body.removeChild(at)}catch(Ve){console.error("Export failed:",Ve),alert("Failed to export library.")}};return t?s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Settings"}),s.jsx("div",{className:"flex border-b border-gray-700 overflow-x-auto",children:["account","history","membership","general","community","ai","display","data",...t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin?["admin"]:[]].map(Ve=>s.jsx("button",{onClick:()=>l(`/settings/${Ve}`),className:`px-6 py-3 font-medium transition-colors border-b-2 whitespace-nowrap ${c===Ve?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:Ve.charAt(0).toUpperCase()+Ve.slice(1)},Ve))}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg min-h-[400px]",children:[c==="account"&&s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("section",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Profile Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"First Name"}),s.jsx("input",{type:"text",value:J,onChange:Ve=>re(Ve.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Last Name"}),s.jsx("input",{type:"text",value:se,onChange:Ve=>ee(Ve.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Username"}),s.jsx("input",{type:"text",value:Y,onChange:Ve=>X(Ve.target.value),placeholder:"Enter username...",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsx("div",{className:"flex justify-start",children:s.jsx("button",{onClick:Ie,disabled:p,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50",children:"Update Profile"})}),s.jsxs("div",{className:"pt-6 border-t border-gray-700 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Public Profile"}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Public Library Access"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Allow others to view your collection and decks via your profile."})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:de,onChange:Ve=>be(Ve.target.checked),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Avatar URL"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("input",{type:"text",value:H,onChange:Ve=>le(Ve.target.value),placeholder:"https://example.com/avatar.jpg",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})}),s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 overflow-hidden flex-shrink-0 border border-gray-600",children:H?s.jsx("img",{src:H,alt:"Avatar Preview",className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:"?"})})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Bio"}),s.jsx("textarea",{value:oe,onChange:Ve=>ne(Ve.target.value),placeholder:"Tell us about yourself...",rows:3,className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]})]})]}),s.jsxs("section",{className:"pt-6 border-t border-gray-700 space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Security & Account"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Email Address"}),s.jsx("p",{className:"text-sm text-gray-400",children:t.email}),!t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-yellow-500/20 text-yellow-500 px-1.5 py-0.5 rounded-full border border-yellow-500/30 mt-1 inline-block",children:"Unverified"}),t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-green-500/20 text-green-500 px-1.5 py-0.5 rounded-full border border-green-500/30 mt-1 inline-block",children:"Verified"})]}),!t.emailVerified&&s.jsx("button",{onClick:Be,disabled:W,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium",children:W?"Sending...":"Send Verification"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Password"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Change your account password"})]}),s.jsx("button",{onClick:ce,disabled:q,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium disabled:opacity-50",children:q?"Sending...":"Reset Password"})]})]})]})]}),c==="history"&&s.jsx(JPe,{}),c==="general"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"App Preferences"}),s.jsxs("div",{className:"pt-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Guided Experience"}),s.jsx("button",{onClick:async()=>{window.confirm("This will restart the welcome tour. Continue?")&&(await Ge.updateUser(e.id,{settings:{...e.settings,onboarding_complete:!1,onboarding_step:0}}),await r(),l("/onboarding"))},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg border border-gray-600 transition-colors text-sm font-medium",children:"Reset Onboarding Tour"})]})]}),c==="ai"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Integrations"}),s.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded border border-indigo-700/50",children:"Gemini"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"To enable the AI Assistant and Deck Suggestions, you need a Google Gemini API Key. Keys are stored securely in your user profile."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Gemini API Key"}),s.jsx("input",{type:"password",value:M,onChange:Ve=>$(Ve.target.value),placeholder:"Enter AI Key...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"}),s.jsxs("div",{className:"text-xs text-gray-500 flex justify-between",children:[s.jsx("span",{children:"Never share your API key."}),s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 hover:underline",children:"Get a key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Personalization"}),s.jsx("div",{className:"flex flex-wrap gap-4",children:s.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-3 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-5 py-3 rounded-xl transition-all hover:shadow-lg hover:border-emerald-500 group",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center text-xl group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-sm",children:"Helper Settings"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Customize your AI companion"})]})]})})]})]}),c==="display"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Display Preferences"}),s.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-xl p-4 md:p-6 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Organization Profile"}),s.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Current Mode: ",s.jsx("span",{className:"text-indigo-400 font-bold capitalize",children:e?.settings?.organization?.mode||"Default"})]}),s.jsx("p",{className:"text-xs text-gray-500 max-w-lg mb-4",children:"Your organization profile determines how your collection is sorted and grouped by default."})]}),s.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})]}),s.jsx("button",{onClick:()=>_(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors",children:"Configure Organization..."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Default View "}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${k==="grid"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"grid",checked:k==="grid",onChange:()=>L("grid"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Grid View"})]}),s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${k==="table"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"table",checked:k==="table",onChange:()=>L("table"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Table View"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Grid Size"}),s.jsxs("select",{value:R,onChange:Ve=>V(Ve.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 w-full sm:w-48",children:[s.jsx("option",{value:"sm",children:"Small"}),s.jsx("option",{value:"md",children:"Medium"}),s.jsx("option",{value:"lg",children:"Large"})]})]})]})]}),c==="community"&&s.jsx(WPe,{}),c==="data"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Data Management"}),s.jsxs("details",{className:"group border border-red-500/20 rounded-xl bg-red-500/5 open:bg-red-500/10 transition-colors",children:[s.jsxs("summary",{className:"flex items-center justify-between p-4 cursor-pointer select-none",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""}),s.jsx("h3",{className:"text-lg font-bold text-red-500 uppercase tracking-wide",children:"Danger Zone"})]}),s.jsx("div",{className:"text-red-500 transform transition-transform group-open:rotate-180",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"p-4 pt-0 border-t border-red-500/10 mt-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Clear Wishlist"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Permanently delete all items from your wishlist."})]}),s.jsx("button",{onClick:()=>{B("wishlist"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Clear Wishlist"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete All Decks"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all your decks. Cards will remain in your collection."})]}),s.jsx("button",{onClick:()=>{B("decks"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Decks"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Collection"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all cards. This will empty your decks."})]}),s.jsx("button",{onClick:()=>{B("collection"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Collection"})]}),s.jsxs("div",{className:"p-4 bg-red-900/20 rounded-lg flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Everything"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Wipe your entire library: decks, cards, and wishlist."})]}),s.jsx("button",{onClick:()=>{B("all"),I(!0)},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-bold transition-colors shadow-lg shadow-red-900/20",children:"Delete Everything"})]})]})})]}),s.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-yellow-500 font-bold mb-1 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Note"]}),s.jsx("p",{className:"text-yellow-200/80 text-sm",children:"Backups include your collection data. Deck exports can be done from individual deck pages."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Export Collection"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Download a JSON backup of your entire card collection."})]}),s.jsx("button",{onClick:ct,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export JSON"})]}),s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Import Data"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Restore from a backup or import cards. Supports Merge and Replace."})]}),s.jsx("button",{onClick:()=>b(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors border border-gray-600",children:"Import..."})]})]})]}),c==="membership"&&s.jsx(XPe,{}),c==="admin"&&(t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin)&&s.jsx(YPe,{})]}),s.jsx(UPe,{isOpen:g,onClose:()=>b(!1),mode:"global"}),s.jsx(zPe,{isOpen:v,onClose:()=>w(!1)}),s.jsx(Kee,{isOpen:j,onClose:()=>_(!1),onComplete:()=>{_(!1),r()}}),s.jsx(eZ,{isOpen:E,onClose:()=>I(!1),targetName:O?O.toUpperCase():"",title:O==="all"?"Delete Everything?":O==="decks"?"Delete All Decks?":O==="collection"?"Delete Collection?":"Clear Wishlist?",message:O==="all"?"This will permanently delete ALL data associated with your account, including decks, cards, and wishlist. This cannot be undone.":O==="decks"?"This will delete all your deck lists. Your cards will be returned to your binder.":O==="collection"?"This will delete all cards in your collection. Your decks will remain but will be empty.":"This will remove all cards from your wishlist.",onConfirm:async()=>{T(!0);try{await Ge.delete("/api/users/me/data",{target:O}),window.location.reload()}catch(Ve){console.error(Ve),alert("Failed to delete data.")}finally{T(!1),I(!1)}}}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:ke,disabled:p,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-lg shadow-lg shadow-indigo-500/20 transition-all transform hover:-translate-y-0.5 ${p?"opacity-50 cursor-not-allowed":""}`,children:p?"Saving...":"Save Settings"})})]}):s.jsx("div",{className:"p-8 text-center text-gray-500",children:"Please log in to view settings."})},eOe=()=>{const{cards:t,loading:e,error:r}=vl({wishlist:!0}),{currentUser:n}=Or(),{addToast:i}=jn(),[a,o]=y.useState(""),[l,c]=y.useState(!1),[u,h]=y.useState(!1);y.useEffect(()=>{const T=()=>h(!0);return window.addEventListener("start-tour",T),localStorage.getItem("tour_seen_wishlist_tour_v1")||setTimeout(()=>h(!0),1e3),()=>window.removeEventListener("start-tour",T)},[]);const p=[{target:"h1",title:"Wishlist",content:"Track cards you want to acquire here."},{target:"#wishlist-search",title:"Search",content:"Quickly find specific cards in your wishlist."},{target:"#wishlist-manage-btn",title:"Bulk Actions",content:"Switch to selection mode to remove multiple cards at once."},{target:"#wishlist-filter-btn",title:"Filters",content:"Filter by color, scarcity, or set to prioritize."}],[m,g]=y.useState(!1),[b,v]=y.useState(new Set),w=T=>{const M=new Set(b);M.has(T)?M.delete(T):M.add(T),v(M)},j=T=>{b.size===T.length?v(new Set):v(new Set(T.map(M=>M.id)))},_=async()=>{if(b.size===0)return;const T=b.size;if(window.confirm(`Are you sure you want to delete ${T} cards from your wishlist?`))try{await so.batchRemoveCards(Array.from(b)),i(`Successfully removed ${T} cards`,"success"),g(!1),v(new Set),window.location.reload()}catch(M){console.error(M),i("Failed to remove cards","error")}},[E,I]=y.useState({colors:[],rarity:[],types:[],sets:[]}),O=y.useMemo(()=>{const T=new Set;return t.forEach(M=>{M.set&&M.set_name&&T.add(JSON.stringify({value:M.set,label:M.set_name}))}),Array.from(T).map(M=>JSON.parse(M)).sort((M,$)=>M.label.localeCompare($.label))},[t]),B=y.useMemo(()=>t.filter(T=>{const M=T.name||"";if(a&&!M.toLowerCase().includes(a.toLowerCase()))return!1;if(E.colors.length>0){const $=T.color_identity||[],k=$.length>1,L=$.length===0;if(!E.colors.some(V=>V==="C"?L:V==="M"?k:$.includes(V)))return!1}if(E.rarity.length>0&&!E.rarity.includes(T.rarity))return!1;if(E.types.length>0){const $=(T.type_line||"").toLowerCase();if(!E.types.some(L=>$.includes(L.toLowerCase())))return!1}return!(E.sets.length>0&&!E.sets.includes(T.set))}),[t,a,E]),S=(T,M)=>{I($=>{const k=$[T],L=k.includes(M)?k.filter(R=>R!==M):[...k,M];return{...$,[T]:L}})};return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-orange-500/10 rounded-xl",children:s.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Wishlist"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Manage cards you want to acquire"})]}),s.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"relative w-full md:w-80",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{id:"wishlist-search",type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-700 rounded-md leading-5 bg-gray-800 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-700 focus:border-orange-500 transition duration-150 ease-in-out sm:text-sm",placeholder:"Search wishlist...",value:a,onChange:T=>o(T.target.value)}),a&&s.jsx("button",{onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[m?s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 p-1 rounded-lg border border-gray-700 animate-fade-in mr-2",children:[s.jsx("button",{onClick:()=>j(B),className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:b.size===B.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2 whitespace-nowrap",children:[b.size," Selected"]}),s.jsx("button",{onClick:_,disabled:b.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"}),s.jsx("button",{onClick:()=>g(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>g(!0),id:"wishlist-manage-btn",className:"px-3 py-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-indigo-400 border border-gray-700 rounded-md transition-colors text-sm font-bold uppercase",children:"Select"}),s.jsxs("button",{id:"wishlist-filter-btn",onClick:()=>c(!l),className:`px-3 py-2 rounded-md border transition-colors flex items-center gap-2 ${l?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})]})]}),l&&s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8 border border-gray-700 gap-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 animate-fade-in-down",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(T=>s.jsx("button",{onClick:()=>S("colors",T),className:`
                                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border shadow-sm transition-transform hover:scale-105
                                        ${E.colors.includes(T)?"ring-2 ring-orange-500 ring-offset-2 ring-offset-gray-800":"opacity-70 hover:opacity-100"}
                                        ${T==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                        ${T==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                        ${T==="B"?"bg-[#1F2937] text-white border-gray-900":""}
                                        ${T==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                        ${T==="G"?"bg-[#10B981] text-white border-green-600":""}
                                        ${T==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                        ${T==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                    `,children:T},T))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(T=>s.jsx("button",{onClick:()=>S("rarity",T),className:`
                                        px-3 py-1 rounded text-xs font-bold uppercase border transition-colors
                                        ${E.rarity.includes(T)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                    `,children:T},T))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(T=>s.jsx("button",{onClick:()=>S("types",T),className:`
                                         px-2 py-1 rounded text-xs border transition-colors
                                         ${E.types.includes(T)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                     `,children:T},T))})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(uN,{label:"Filter by Set",options:O,selected:E.sets,onChange:T=>I(M=>({...M,sets:T})),placeholder:"All Sets"})})]}),e?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:Array.from({length:12}).map((T,M)=>s.jsx(qL,{},M))}):r?s.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg",children:["Error loading wishlist: ",r.message]}):s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[B.map(T=>s.jsx("div",{className:"h-full",children:s.jsx(Qx,{card:T,selectMode:m,isSelected:b.has(T.id),onToggleSelect:w})},T.id)),B.length===0&&s.jsxs("div",{className:"col-span-full text-center text-gray-500 py-12 flex flex-col items-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("p",{className:"text-xl",children:"Your wishlist is empty"}),s.jsx("p",{className:"text-sm mt-2 font-medium",children:"Add cards to your wishlist from the search modal!"})]})]}),s.jsx(pf,{steps:p,isOpen:u,onClose:()=>h(!1),tourId:"wishlist_tour_v1"})]})},HC=()=>{const t=xn(),{type:e,set:r}=yl(),{addToast:n}=jn(),[i,a]=y.useState([]),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,p]=y.useState("types"),[m,g]=y.useState(!0),[b,v]=y.useState(""),[w,j]=y.useState("");y.useEffect(()=>{const S=setTimeout(()=>j(b),500);return()=>clearTimeout(S)},[b]),y.useEffect(()=>{(async()=>(i.length===0&&await _(),o.length===0&&await E()))()},[]),y.useEffect(()=>{(async()=>{g(!0);try{w?await I({search:w}):e?await I({type:e}):r?await I({set_code:r}):u([])}finally{g(!1)}})()},[w,e,r]);const _=async()=>{try{const S=await Ge.get("/api/precons/types");a(S)}catch(S){console.error(S),n("Failed to load types","error")}},E=async()=>{try{const S=await Ge.get("/api/precons/sets");l(S)}catch(S){console.error(S)}},I=async S=>{try{const T=new URLSearchParams(S).toString(),M=await Ge.get(`/api/precons?${T}`);u(M)}catch(T){console.error(T),n("Failed to load precons","error")}},O=S=>{const T=["from-purple-500/20 to-blue-500/5 hover:border-purple-500","from-emerald-500/20 to-teal-500/5 hover:border-emerald-500","from-amber-500/20 to-orange-500/5 hover:border-amber-500","from-rose-500/20 to-red-500/5 hover:border-rose-500","from-cyan-500/20 to-blue-500/5 hover:border-cyan-500"];let M=0;for(let k=0;k<S.length;k++)M=S.charCodeAt(k)+((M<<5)-M);const $=Math.abs(M)%T.length;return T[$]},B=!!(e||r||w);return s.jsx("div",{className:"min-h-screen bg-gray-950 p-6 md:p-8 pt-24",children:s.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 border-b border-gray-800 pb-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:["Precon ",s.jsx("span",{className:"text-purple-500",children:"Database"})]}),s.jsx("p",{className:"text-gray-400",children:B?s.jsxs(s.Fragment,{children:[s.jsx(Er,{to:"/precons",onClick:()=>{v("")},className:"hover:text-white transition-colors underline decoration-dotted",children:"Database"})," > ",s.jsx("span",{className:"text-white font-bold",children:w?`Search: "${w}"`:e||r})]}):"Browse official preconstructed decks."})]}),s.jsxs("div",{className:"flex gap-4",children:[!B&&s.jsxs("div",{className:"bg-gray-900 rounded-lg p-1 border border-gray-700 flex text-sm font-bold",children:[s.jsx("button",{onClick:()=>p("types"),className:`px-4 py-2 rounded-md transition-colors ${h==="types"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Types"}),s.jsx("button",{onClick:()=>p("sets"),className:`px-4 py-2 rounded-md transition-colors ${h==="sets"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Sets"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search decks or commanders...",value:b,onChange:S=>v(S.target.value),className:"bg-gray-900 border border-gray-700 text-white px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none w-64 md:w-80 pl-10 pr-10"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),b&&s.jsx("button",{onClick:()=>v(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),m?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):B?c.length===0?s.jsx("div",{className:"text-center py-20 text-gray-500",children:"No precons found."}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(S=>s.jsxs(Er,{to:`/precons/deck/${S.id}`,className:"bg-gray-900 border border-gray-800 rounded-2xl overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-xl group flex flex-col cursor-pointer hover:-translate-y-1",children:[s.jsxs("div",{className:"p-6 flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-purple-400 transition-colors line-clamp-2",children:S.name}),s.jsx("span",{className:"text-xs font-bold bg-gray-800 text-gray-400 px-2 py-1 rounded uppercase tracking-wider",children:S.data?.code||"???"})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Commander"}),s.jsx("span",{className:"text-gray-200 font-medium truncate ml-2 max-w-[150px] text-right",children:S.data?.commander?.[0]?.name||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Cards"}),s.jsx("span",{className:"text-gray-200",children:(S.data?.mainBoard?.length||0)+(S.data?.sideBoard?.length||0)+(S.data?.commander?.length||0)})]}),S.total_price>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Market Price"}),s.jsxs("span",{className:"text-green-400 font-bold",children:["$",S.total_price.toFixed(2)]})]})]})]}),s.jsx("div",{className:"bg-gray-800/50 p-4 border-t border-gray-800 flex justify-center text-purple-400 font-bold text-sm group-hover:bg-purple-900/20 transition-colors",children:"View Deck List"})]},S.id))}):h==="types"?s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:i.map(S=>s.jsx("div",{onClick:()=>t(`/precons/type/${encodeURIComponent(S)}`),className:`group cursor-pointer bg-gray-900 border border-gray-800 rounded-2xl p-8 transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${O(S)}`,children:s.jsx("h3",{className:"text-xl font-bold text-white text-center group-hover:scale-105 transition-transform",children:S})},S))}):s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.map(S=>s.jsxs("div",{onClick:()=>t(`/precons/set/${S}`),className:"group cursor-pointer bg-gray-900 border border-gray-800 rounded-xl p-6 transition-all hover:-translate-y-1 hover:border-purple-500 flex flex-col items-center justify-center gap-2",children:[s.jsx("span",{className:"text-2xl font-black text-gray-700 group-hover:text-white transition-colors uppercase",children:S}),s.jsx("span",{className:"text-xs text-purple-400 font-bold",children:"Set Code"})]},S))})]})})};var tOe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function QL(t){if(typeof t!="string")return!1;var e=tOe;return e.includes(t)}var rOe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],nOe=new Set(rOe);function Wte(t){return typeof t!="string"?!1:nOe.has(t)}function Gte(t){return typeof t=="string"&&t.startsWith("data-")}function qd(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Wte(r)||Gte(r))&&(e[r]=t[r]);return e}function f1(t){if(t==null)return null;if(y.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return qd(e)}return typeof t=="object"&&!Array.isArray(t)?qd(t):null}function iu(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Wte(r)||Gte(r)||QL(r))&&(e[r]=t[r]);return e}var sOe=["children","width","height","viewBox","className","style","title","desc"];function IT(){return IT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IT.apply(null,arguments)}function iOe(t,e){if(t==null)return{};var r,n,i=aOe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function aOe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var JL=y.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:o,style:l,title:c,desc:u}=t,h=iOe(t,sOe),p=a||{width:n,height:i,x:0,y:0},m=gs("recharts-surface",o);return y.createElement("svg",IT({},iu(h),{className:m,width:n,height:i,style:l,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:e}),y.createElement("title",null,c),y.createElement("desc",null,u),r)}),oOe=["children","className"];function LT(){return LT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},LT.apply(null,arguments)}function lOe(t,e){if(t==null)return{};var r,n,i=cOe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function cOe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var gl=y.forwardRef((t,e)=>{var{children:r,className:n}=t,i=lOe(t,oOe),a=gs("recharts-layer",n);return y.createElement("g",LT({className:a},iu(i),{ref:e}),r)}),Kte=y.createContext(null),uOe=()=>y.useContext(Kte);function qs(t){return function(){return t}}const Yte=Math.cos,Ej=Math.sin,rd=Math.sqrt,Aj=Math.PI,Rk=2*Aj,PT=Math.PI,OT=2*PT,vp=1e-6,dOe=OT-vp;function Xte(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function hOe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Xte;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class fOe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Xte:hOe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,o){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,l=this._y1,c=n-e,u=i-r,h=o-e,p=l-r,m=h*h+p*p;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>vp)if(!(Math.abs(p*c-u*h)>vp)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let g=n-o,b=i-l,v=c*c+u*u,w=g*g+b*b,j=Math.sqrt(v),_=Math.sqrt(m),E=a*Math.tan((PT-Math.acos((v+m-w)/(2*j*_)))/2),I=E/_,O=E/j;Math.abs(I-1)>vp&&this._append`L${e+I*h},${r+I*p}`,this._append`A${a},${a},0,0,${+(p*g>h*b)},${this._x1=e+O*c},${this._y1=r+O*u}`}}arc(e,r,n,i,a,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=e+l,h=r+c,p=1^o,m=o?i-a:a-i;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>vp||Math.abs(this._y1-h)>vp)&&this._append`L${u},${h}`,n&&(m<0&&(m=m%OT+OT),m>dOe?this._append`A${n},${n},0,1,${p},${e-l},${r-c}A${n},${n},0,1,${p},${this._x1=u},${this._y1=h}`:m>vp&&this._append`A${n},${n},0,${+(m>=PT)},${p},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function ZL(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new fOe(e)}function eP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Qte(t){this._context=t}Qte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Mk(t){return new Qte(t)}function Jte(t){return t[0]}function Zte(t){return t[1]}function ere(t,e){var r=qs(!0),n=null,i=Mk,a=null,o=ZL(l);t=typeof t=="function"?t:t===void 0?Jte:qs(t),e=typeof e=="function"?e:e===void 0?Zte:qs(e);function l(c){var u,h=(c=eP(c)).length,p,m=!1,g;for(n==null&&(a=i(g=o())),u=0;u<=h;++u)!(u<h&&r(p=c[u],u,c))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(p,u,c),+e(p,u,c));if(g)return a=null,g+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:qs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:qs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:qs(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),l):n},l}function x5(t,e,r){var n=null,i=qs(!0),a=null,o=Mk,l=null,c=ZL(u);t=typeof t=="function"?t:t===void 0?Jte:qs(+t),e=typeof e=="function"?e:qs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?Zte:qs(+r);function u(p){var m,g,b,v=(p=eP(p)).length,w,j=!1,_,E=new Array(v),I=new Array(v);for(a==null&&(l=o(_=c())),m=0;m<=v;++m){if(!(m<v&&i(w=p[m],m,p))===j)if(j=!j)g=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),b=m-1;b>=g;--b)l.point(E[b],I[b]);l.lineEnd(),l.areaEnd()}j&&(E[m]=+t(w,m,p),I[m]=+e(w,m,p),l.point(n?+n(w,m,p):E[m],r?+r(w,m,p):I[m]))}if(_)return l=null,_+""||null}function h(){return ere().defined(i).curve(o).context(a)}return u.x=function(p){return arguments.length?(t=typeof p=="function"?p:qs(+p),n=null,u):t},u.x0=function(p){return arguments.length?(t=typeof p=="function"?p:qs(+p),u):t},u.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:qs(+p),u):n},u.y=function(p){return arguments.length?(e=typeof p=="function"?p:qs(+p),r=null,u):e},u.y0=function(p){return arguments.length?(e=typeof p=="function"?p:qs(+p),u):e},u.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:qs(+p),u):r},u.lineX0=u.lineY0=function(){return h().x(t).y(e)},u.lineY1=function(){return h().x(t).y(r)},u.lineX1=function(){return h().x(n).y(e)},u.defined=function(p){return arguments.length?(i=typeof p=="function"?p:qs(!!p),u):i},u.curve=function(p){return arguments.length?(o=p,a!=null&&(l=o(a)),u):o},u.context=function(p){return arguments.length?(p==null?a=l=null:l=o(a=p),u):a},u}class tre{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function pOe(t){return new tre(t,!0)}function mOe(t){return new tre(t,!1)}const tP={draw(t,e){const r=rd(e/Aj);t.moveTo(r,0),t.arc(0,0,r,0,Rk)}},gOe={draw(t,e){const r=rd(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},rre=rd(1/3),xOe=rre*2,bOe={draw(t,e){const r=rd(e/xOe),n=r*rre;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},yOe={draw(t,e){const r=rd(e),n=-r/2;t.rect(n,n,r,r)}},vOe=.8908130915292852,nre=Ej(Aj/10)/Ej(7*Aj/10),wOe=Ej(Rk/10)*nre,NOe=-Yte(Rk/10)*nre,jOe={draw(t,e){const r=rd(e*vOe),n=wOe*r,i=NOe*r;t.moveTo(0,-r),t.lineTo(n,i);for(let a=1;a<5;++a){const o=Rk*a/5,l=Yte(o),c=Ej(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*i,c*n+l*i)}t.closePath()}},WC=rd(3),kOe={draw(t,e){const r=-rd(e/(WC*3));t.moveTo(0,r*2),t.lineTo(-WC*r,-r),t.lineTo(WC*r,-r),t.closePath()}},qc=-.5,Vc=rd(3)/2,RT=1/rd(12),_Oe=(RT/2+1)*3,SOe={draw(t,e){const r=rd(e/_Oe),n=r/2,i=r*RT,a=n,o=r*RT+r,l=-a,c=o;t.moveTo(n,i),t.lineTo(a,o),t.lineTo(l,c),t.lineTo(qc*n-Vc*i,Vc*n+qc*i),t.lineTo(qc*a-Vc*o,Vc*a+qc*o),t.lineTo(qc*l-Vc*c,Vc*l+qc*c),t.lineTo(qc*n+Vc*i,qc*i-Vc*n),t.lineTo(qc*a+Vc*o,qc*o-Vc*a),t.lineTo(qc*l+Vc*c,qc*c-Vc*l),t.closePath()}};function COe(t,e){let r=null,n=ZL(i);t=typeof t=="function"?t:qs(t||tP),e=typeof e=="function"?e:qs(e===void 0?64:+e);function i(){let a;if(r||(r=a=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:qs(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:qs(+a),i):e},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function Tj(){}function Ij(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function sre(t){this._context=t}sre.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ij(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ij(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function EOe(t){return new sre(t)}function ire(t){this._context=t}ire.prototype={areaStart:Tj,areaEnd:Tj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Ij(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function AOe(t){return new ire(t)}function are(t){this._context=t}are.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Ij(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function TOe(t){return new are(t)}function ore(t){this._context=t}ore.prototype={areaStart:Tj,areaEnd:Tj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function IOe(t){return new ore(t)}function ez(t){return t<0?-1:1}function tz(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),o=(r-t._y1)/(i||n<0&&-0),l=(a*i+o*n)/(n+i);return(ez(a)+ez(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function rz(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function GC(t,e,r){var n=t._x0,i=t._y0,a=t._x1,o=t._y1,l=(a-n)/3;t._context.bezierCurveTo(n+l,i+l*e,a-l,o-l*r,a,o)}function Lj(t){this._context=t}Lj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:GC(this,this._t0,rz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,GC(this,rz(this,r=tz(this,t,e)),r);break;default:GC(this,this._t0,r=tz(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function lre(t){this._context=new cre(t)}(lre.prototype=Object.create(Lj.prototype)).point=function(t,e){Lj.prototype.point.call(this,e,t)};function cre(t){this._context=t}cre.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function LOe(t){return new Lj(t)}function POe(t){return new lre(t)}function ure(t){this._context=t}ure.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=nz(t),i=nz(e),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function nz(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function OOe(t){return new ure(t)}function Dk(t,e){this._context=t,this._t=e}Dk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function ROe(t){return new Dk(t,.5)}function MOe(t){return new Dk(t,0)}function DOe(t){return new Dk(t,1)}function vm(t,e){if((o=t.length)>1)for(var r=1,n,i,a=t[e[0]],o,l=a.length;r<o;++r)for(i=a,a=t[e[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function MT(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function BOe(t,e){return t[e]}function $Oe(t){const e=[];return e.key=t,e}function FOe(){var t=qs([]),e=MT,r=vm,n=BOe;function i(a){var o=Array.from(t.apply(this,arguments),$Oe),l,c=o.length,u=-1,h;for(const p of a)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(p,o[l].key,u,a)]).data=p;for(l=0,h=eP(e(o));l<c;++l)o[h[l]].index=l;return r(o,h),o}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:qs(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:qs(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?MT:typeof a=="function"?a:qs(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??vm,i):r},i}function UOe(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=t[r][i][1]||0;if(o)for(r=0;r<n;++r)t[r][i][1]/=o}vm(t,e)}}function zOe(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var o=0,l=0;o<i;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}vm(t,e)}}function qOe(t,e){if(!(!((o=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var l=0,c=0,u=0;l<o;++l){for(var h=t[e[l]],p=h[n][1]||0,m=h[n-1][1]||0,g=(p-m)/2,b=0;b<l;++b){var v=t[e[b]],w=v[n][1]||0,j=v[n-1][1]||0;g+=w-j}c+=p,u+=g*p}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,vm(t,e)}}var KC={},YC={},sz;function VOe(){return sz||(sz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(YC)),YC}var XC={},iz;function dre(){return iz||(iz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(XC)),XC}var QC={},az;function rP(){return az||(az=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(QC)),QC}var JC={},ZC={},oz;function HOe(){return oz||(oz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(ZC)),ZC}var lz;function nP(){return lz||(lz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HOe(),r=rP();function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=e.toString(i);const a=[],o=i.length;if(o===0)return a;let l=0,c="",u="",h=!1;for(i.charCodeAt(0)===46&&(a.push(""),l++);l<o;){const p=i[l];u?p==="\\"&&l+1<o?(l++,c+=i[l]):p===u?u="":c+=p:h?p==='"'||p==="'"?u=p:p==="]"?(h=!1,a.push(c),c=""):c+=p:p==="["?(h=!0,c&&(a.push(c),c="")):p==="."?c&&(a.push(c),c=""):c+=p,l++}return c&&a.push(c),a}t.toPath=n})(JC)),JC}var cz;function sP(){return cz||(cz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=VOe(),r=dre(),n=rP(),i=nP();function a(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?r.isDeepKey(c)?a(l,i.toPath(c),u):u:h}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const h=l[c];return h===void 0?u:h}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?u:h}}}function o(l,c,u){if(c.length===0)return u;let h=l;for(let p=0;p<c.length;p++){if(h==null||e.isUnsafeProperty(c[p]))return u;h=h[c[p]]}return h===void 0?u:h}t.get=a})(KC)),KC}var eE,uz;function WOe(){return uz||(uz=1,eE=sP().get),eE}var GOe=WOe();const wm=bl(GOe);var KOe=4;function v0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KOe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function Hi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((i,a,o)=>{var l=r[o-1];return typeof l=="string"?i+l+a:l!==void 0?i+v0(l)+a:i+a},"")}var Po=t=>t===0?0:t>0?1:-1,Vd=t=>typeof t=="number"&&t!=+t,Zh=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Tr=t=>(typeof t=="number"||t instanceof Number)&&!Vd(t),Hd=t=>Tr(t)||typeof t=="string",YOe=0,p1=t=>{var e=++YOe;return"".concat(t||"").concat(e)},el=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Tr(e)&&typeof e!="string")return n;var a;if(Zh(e)){if(r==null)return n;var o=e.indexOf("%");a=r*parseFloat(e.slice(0,o))/100}else a=+e;return Vd(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},hre=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Ra(t,e,r){return Tr(t)&&Tr(e)?v0(t+r*(e-t)):e}function XOe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):wm(n,e))===r)}var lo=t=>t===null||typeof t>"u",o2=t=>lo(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function QOe(t){return t!=null}function l2(){}var JOe=["type","size","sizeType"];function DT(){return DT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DT.apply(null,arguments)}function dz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dz(Object(r),!0).forEach(function(n){ZOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZOe(t,e,r){return(e=eRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eRe(t){var e=tRe(t,"string");return typeof e=="symbol"?e:e+""}function tRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rRe(t,e){if(t==null)return{};var r,n,i=nRe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function nRe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fre={symbolCircle:tP,symbolCross:gOe,symbolDiamond:bOe,symbolSquare:yOe,symbolStar:jOe,symbolTriangle:kOe,symbolWye:SOe},sRe=Math.PI/180,iRe=t=>{var e="symbol".concat(o2(t));return fre[e]||tP},aRe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*sRe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},oRe=(t,e)=>{fre["symbol".concat(o2(t))]=e},iP=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,i=rRe(t,JOe),a=hz(hz({},i),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var m=iRe(o),g=COe().type(m).size(aRe(r,n,o)),b=g();if(b!==null)return b},{className:c,cx:u,cy:h}=a,p=iu(a);return Tr(u)&&Tr(h)&&Tr(r)?y.createElement("path",DT({},p,{className:gs("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(h,")"),d:l()})):null};iP.registerSymbol=oRe;var pre=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,lRe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(y.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{QL(i)&&(n[i]=(a=>r[i](r,a)))}),n},cRe=(t,e,r)=>n=>(t(e,r,n),null),c2=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];QL(i)&&typeof a=="function"&&(n||(n={}),n[i]=cRe(a,e,r))}),n};function fz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uRe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fz(Object(r),!0).forEach(function(n){dRe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dRe(t,e,r){return(e=hRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hRe(t){var e=fRe(t,"string");return typeof e=="symbol"?e:e+""}function fRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Do(t,e){var r=uRe({},t),n=e,i=Object.keys(e),a=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return a}function Pj(){return Pj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pj.apply(null,arguments)}function pz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pRe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pz(Object(r),!0).forEach(function(n){mRe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mRe(t,e,r){return(e=gRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gRe(t){var e=xRe(t,"string");return typeof e=="symbol"?e:e+""}function xRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wc=32,bRe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function yRe(t){var{data:e,iconType:r,inactiveColor:n}=t,i=Wc/2,a=Wc/6,o=Wc/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return y.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Wc,y2:i,className:"recharts-legend-icon"})}if(c==="line")return y.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Wc,"M").concat(2*o,",").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return y.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Wc/8,"h").concat(Wc,"v").concat(Wc*3/4,"h").concat(-Wc,"z"),className:"recharts-legend-icon"});if(y.isValidElement(e.legendIcon)){var h=pRe({},e);return delete h.legendIcon,y.cloneElement(e.legendIcon,h)}return y.createElement(iP,{fill:l,cx:i,cy:i,size:Wc,sizeType:"diameter",type:c})}function vRe(t){var{payload:e,iconSize:r,layout:n,formatter:i,inactiveColor:a,iconType:o}=t,l={x:0,y:0,width:Wc,height:Wc},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((h,p)=>{var m=h.formatter||i,g=gs({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:h.inactive});if(h.type==="none")return null;var b=h.inactive?a:h.color,v=m?m(h.value,h,p):h.value;return y.createElement("li",Pj({className:g,style:c,key:"legend-item-".concat(p)},c2(t,h,p)),y.createElement(JL,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(v," legend icon")},y.createElement(yRe,{data:h,iconType:o,inactiveColor:a})),y.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},v))})}var wRe=t=>{var e=Do(t,bRe),{payload:r,layout:n,align:i}=e;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return y.createElement("ul",{className:"recharts-default-legend",style:a},y.createElement(vRe,Pj({},e,{payload:r})))},tE={},rE={},mz;function NRe(){return mz||(mz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const o=r[a],l=n(o);i.has(l)||i.set(l,o)}return Array.from(i.values())}t.uniqBy=e})(rE)),rE}var nE={},gz;function mre(){return gz||(gz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(nE)),nE}var sE={},iE={},aE={},xz;function jRe(){return xz||(xz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(aE)),aE}var bz;function aP(){return bz||(bz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jRe();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(iE)),iE}var oE={},yz;function kRe(){return yz||(yz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(oE)),oE}var vz;function _Re(){return vz||(vz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aP(),r=kRe();function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(sE)),sE}var lE={},cE={},wz;function SRe(){return wz||(wz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sP();function r(n){return function(i){return e.get(i,n)}}t.property=r})(cE)),cE}var uE={},dE={},hE={},fE={},Nz;function gre(){return Nz||(Nz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(fE)),fE}var pE={},jz;function xre(){return jz||(jz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(pE)),pE}var mE={},kz;function bre(){return kz||(kz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(mE)),mE}var _z;function CRe(){return _z||(_z=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gre(),r=xre(),n=bre();function i(h,p,m){return typeof m!="function"?i(h,p,()=>{}):a(h,p,function g(b,v,w,j,_,E){const I=m(b,v,w,j,_,E);return I!==void 0?!!I:a(b,v,g,E)},new Map)}function a(h,p,m,g){if(p===h)return!0;switch(typeof p){case"object":return o(h,p,m,g);case"function":return Object.keys(p).length>0?a(h,{...p},m,g):n.eq(h,p);default:return e.isObject(h)?typeof p=="string"?p==="":!0:n.eq(h,p)}}function o(h,p,m,g){if(p==null)return!0;if(Array.isArray(p))return c(h,p,m,g);if(p instanceof Map)return l(h,p,m,g);if(p instanceof Set)return u(h,p,m,g);const b=Object.keys(p);if(h==null||r.isPrimitive(h))return b.length===0;if(b.length===0)return!0;if(g?.has(p))return g.get(p)===h;g?.set(p,h);try{for(let v=0;v<b.length;v++){const w=b[v];if(!r.isPrimitive(h)&&!(w in h)||p[w]===void 0&&h[w]!==void 0||p[w]===null&&h[w]!==null||!m(h[w],p[w],w,h,p,g))return!1}return!0}finally{g?.delete(p)}}function l(h,p,m,g){if(p.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,v]of p.entries()){const w=h.get(b);if(m(w,v,b,h,p,g)===!1)return!1}return!0}function c(h,p,m,g){if(p.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let v=0;v<p.length;v++){const w=p[v];let j=!1;for(let _=0;_<h.length;_++){if(b.has(_))continue;const E=h[_];let I=!1;if(m(E,w,v,h,p,g)&&(I=!0),I){b.add(_),j=!0;break}}if(!j)return!1}return!0}function u(h,p,m,g){return p.size===0?!0:h instanceof Set?c([...h],[...p],m,g):!1}t.isMatchWith=i,t.isSetMatch=u})(hE)),hE}var Sz;function yre(){return Sz||(Sz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CRe();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r})(dE)),dE}var gE={},xE={},bE={},Cz;function ERe(){return Cz||(Cz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(bE)),bE}var yE={},Ez;function vre(){return Ez||(Ez=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(yE)),yE}var vE={},Az;function wre(){return Az||(Az=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",h="[object Array]",p="[object Function]",m="[object ArrayBuffer]",g="[object Object]",b="[object Error]",v="[object DataView]",w="[object Uint8Array]",j="[object Uint8ClampedArray]",_="[object Uint16Array]",E="[object Uint32Array]",I="[object BigUint64Array]",O="[object Int8Array]",B="[object Int16Array]",S="[object Int32Array]",T="[object BigInt64Array]",M="[object Float32Array]",$="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=h,t.bigInt64ArrayTag=T,t.bigUint64ArrayTag=I,t.booleanTag=i,t.dataViewTag=v,t.dateTag=l,t.errorTag=b,t.float32ArrayTag=M,t.float64ArrayTag=$,t.functionTag=p,t.int16ArrayTag=B,t.int32ArrayTag=S,t.int8ArrayTag=O,t.mapTag=c,t.numberTag=n,t.objectTag=g,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=_,t.uint32ArrayTag=E,t.uint8ArrayTag=w,t.uint8ClampedArrayTag=j})(vE)),vE}var wE={},Tz;function ARe(){return Tz||(Tz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(wE)),wE}var Iz;function Nre(){return Iz||(Iz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ERe(),r=vre(),n=wre(),i=xre(),a=ARe();function o(h,p){return l(h,void 0,h,new Map,p)}function l(h,p,m,g=new Map,b=void 0){const v=b?.(h,p,m,g);if(v!==void 0)return v;if(i.isPrimitive(h))return h;if(g.has(h))return g.get(h);if(Array.isArray(h)){const w=new Array(h.length);g.set(h,w);for(let j=0;j<h.length;j++)w[j]=l(h[j],j,m,g,b);return Object.hasOwn(h,"index")&&(w.index=h.index),Object.hasOwn(h,"input")&&(w.input=h.input),w}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const w=new RegExp(h.source,h.flags);return w.lastIndex=h.lastIndex,w}if(h instanceof Map){const w=new Map;g.set(h,w);for(const[j,_]of h)w.set(j,l(_,j,m,g,b));return w}if(h instanceof Set){const w=new Set;g.set(h,w);for(const j of h)w.add(l(j,void 0,m,g,b));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(a.isTypedArray(h)){const w=new(Object.getPrototypeOf(h)).constructor(h.length);g.set(h,w);for(let j=0;j<h.length;j++)w[j]=l(h[j],j,m,g,b);return w}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const w=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return g.set(h,w),c(w,h,m,g,b),w}if(typeof File<"u"&&h instanceof File){const w=new File([h],h.name,{type:h.type});return g.set(h,w),c(w,h,m,g,b),w}if(typeof Blob<"u"&&h instanceof Blob){const w=new Blob([h],{type:h.type});return g.set(h,w),c(w,h,m,g,b),w}if(h instanceof Error){const w=new h.constructor;return g.set(h,w),w.message=h.message,w.name=h.name,w.stack=h.stack,w.cause=h.cause,c(w,h,m,g,b),w}if(h instanceof Boolean){const w=new Boolean(h.valueOf());return g.set(h,w),c(w,h,m,g,b),w}if(h instanceof Number){const w=new Number(h.valueOf());return g.set(h,w),c(w,h,m,g,b),w}if(h instanceof String){const w=new String(h.valueOf());return g.set(h,w),c(w,h,m,g,b),w}if(typeof h=="object"&&u(h)){const w=Object.create(Object.getPrototypeOf(h));return g.set(h,w),c(w,h,m,g,b),w}return h}function c(h,p,m=h,g,b){const v=[...Object.keys(p),...e.getSymbols(p)];for(let w=0;w<v.length;w++){const j=v[w],_=Object.getOwnPropertyDescriptor(h,j);(_==null||_.writable)&&(h[j]=l(p[j],j,m,g,b))}}function u(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(xE)),xE}var Lz;function TRe(){return Lz||(Lz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nre();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(gE)),gE}var Pz;function IRe(){return Pz||(Pz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yre(),r=TRe();function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(uE)),uE}var NE={},jE={},kE={},Oz;function LRe(){return Oz||(Oz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nre(),r=wre();function n(i,a){return e.cloneDeepWith(i,(o,l,c,u)=>{const h=a?.(o,l,c,u);if(h!==void 0)return h;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new i.constructor(i?.valueOf());return e.copyProperties(p,i),p}case r.argumentsTag:{const p={};return e.copyProperties(p,i),p.length=i.length,p[Symbol.iterator]=i[Symbol.iterator],p}default:return}})}t.cloneDeepWith=n})(kE)),kE}var Rz;function PRe(){return Rz||(Rz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=LRe();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(jE)),jE}var _E={},SE={},Mz;function jre(){return Mz||(Mz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(SE)),SE}var CE={},Dz;function ORe(){return Dz||(Dz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vre();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(CE)),CE}var Bz;function RRe(){return Bz||(Bz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dre(),r=jre(),n=ORe(),i=nP();function a(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&o?.[l]==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let h=0;h<c.length;h++){const p=c[h];if((u==null||!Object.hasOwn(u,p))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(p)&&p<u.length))return!1;u=u[p]}return!0}t.has=a})(_E)),_E}var $z;function MRe(){return $z||($z=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yre(),r=rP(),n=PRe(),i=sP(),a=RRe();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const h=i.get(u,l);return h===void 0?a.has(u,l):c===void 0?h===void 0:e.isMatch(h,c)}}t.matchesProperty=o})(NE)),NE}var Fz;function DRe(){return Fz||(Fz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mre(),r=SRe(),n=IRe(),i=MRe();function a(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=a})(lE)),lE}var Uz;function BRe(){return Uz||(Uz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=NRe(),r=mre(),n=_Re(),i=DRe();function a(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),i.iteratee(l)):[]}t.uniqBy=a})(tE)),tE}var EE,zz;function $Re(){return zz||(zz=1,EE=BRe().uniqBy),EE}var FRe=$Re();const qz=bl(FRe);function kre(t,e,r){return e===!0?qz(t,r):typeof e=="function"?qz(t,e):t}var AE={exports:{}},TE={},IE={exports:{}},LE={};var Vz;function URe(){if(Vz)return LE;Vz=1;var t=of();function e(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function l(p,m){var g=m(),b=n({inst:{value:g,getSnapshot:m}}),v=b[0].inst,w=b[1];return a(function(){v.value=g,v.getSnapshot=m,c(v)&&w({inst:v})},[p,g,m]),i(function(){return c(v)&&w({inst:v}),p(function(){c(v)&&w({inst:v})})},[p]),o(g),g}function c(p){var m=p.getSnapshot;p=p.value;try{var g=m();return!r(p,g)}catch{return!0}}function u(p,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return LE.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,LE}var Hz;function zRe(){return Hz||(Hz=1,IE.exports=URe()),IE.exports}var Wz;function qRe(){if(Wz)return TE;Wz=1;var t=of(),e=zRe();function r(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,a=t.useRef,o=t.useEffect,l=t.useMemo,c=t.useDebugValue;return TE.useSyncExternalStoreWithSelector=function(u,h,p,m,g){var b=a(null);if(b.current===null){var v={hasValue:!1,value:null};b.current=v}else v=b.current;b=l(function(){function j(B){if(!_){if(_=!0,E=B,B=m(B),g!==void 0&&v.hasValue){var S=v.value;if(g(S,B))return I=S}return I=B}if(S=I,n(E,B))return S;var T=m(B);return g!==void 0&&g(S,T)?(E=B,S):(E=B,I=T)}var _=!1,E,I,O=p===void 0?null:p;return[function(){return j(h())},O===null?void 0:function(){return j(O())}]},[h,p,m,g]);var w=i(u,b[0],b[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),c(w),w},TE}var Gz;function VRe(){return Gz||(Gz=1,AE.exports=qRe()),AE.exports}var HRe=VRe(),oP=y.createContext(null),WRe=t=>t,Hs=()=>{var t=y.useContext(oP);return t?t.store.dispatch:WRe},bN=()=>{},GRe=()=>bN,KRe=(t,e)=>t===e;function kr(t){var e=y.useContext(oP);return HRe.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:GRe,e?e.store.getState:bN,e?e.store.getState:bN,e?t:bN,KRe)}function YRe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function XRe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function QRe(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var Kz=t=>Array.isArray(t)?t:[t];function JRe(t){const e=Array.isArray(t[0])?t[0]:t;return QRe(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function ZRe(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var eMe=class{constructor(t){this.value=t}deref(){return this.value}},tMe=typeof WeakRef<"u"?WeakRef:eMe,rMe=0,Yz=1;function b5(){return{s:rMe,v:void 0,o:null,p:null}}function _re(t,e={}){let r=b5();const{resultEqualityCheck:n}=e;let i,a=0;function o(){let l=r;const{length:c}=arguments;for(let p=0,m=c;p<m;p++){const g=arguments[p];if(typeof g=="function"||typeof g=="object"&&g!==null){let b=l.o;b===null&&(l.o=b=new WeakMap);const v=b.get(g);v===void 0?(l=b5(),b.set(g,l)):l=v}else{let b=l.p;b===null&&(l.p=b=new Map);const v=b.get(g);v===void 0?(l=b5(),b.set(g,l)):l=v}}const u=l;let h;if(l.s===Yz)h=l.v;else if(h=t.apply(null,arguments),a++,n){const p=i?.deref?.()??i;p!=null&&n(p,h)&&(h=p,a!==0&&a--),i=typeof h=="object"&&h!==null||typeof h=="function"?new tMe(h):h}return u.s=Yz,u.v=h,h}return o.clearCache=()=>{r=b5(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function nMe(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),YRe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...r,...c},{memoize:p,memoizeOptions:m=[],argsMemoize:g=_re,argsMemoizeOptions:b=[]}=h,v=Kz(m),w=Kz(b),j=JRe(i),_=p(function(){return a++,u.apply(null,arguments)},...v),E=g(function(){o++;const O=ZRe(j,arguments);return l=_.apply(null,O),l},...w);return Object.assign(E,{resultFunc:u,memoizedResultFunc:_,dependencies:j,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:p,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var it=nMe(_re),sMe=Object.assign((t,e=it)=>{XRe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>sMe}),PE={},OE={},RE={},Xz;function iMe(){return Xz||(Xz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const o=e(n),l=e(i);if(o===l&&o===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?l-o:o-l}return 0};t.compareValues=r})(RE)),RE}var ME={},DE={},Qz;function Sre(){return Qz||(Qz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(DE)),DE}var Jz;function aMe(){return Jz||(Jz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sre(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,o){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||o!=null&&Object.hasOwn(o,a)}t.isKey=i})(ME)),ME}var Zz;function oMe(){return Zz||(Zz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iMe(),r=aMe(),n=nP();function i(a,o,l,c){if(a==null)return[];l=c?void 0:l,Array.isArray(a)||(a=Object.values(a)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(g=>String(g));const u=(g,b)=>{let v=g;for(let w=0;w<b.length&&v!=null;++w)v=v[b[w]];return v},h=(g,b)=>b==null||g==null?b:typeof g=="object"&&"key"in g?Object.hasOwn(b,g.key)?b[g.key]:u(b,g.path):typeof g=="function"?g(b):Array.isArray(g)?u(b,g):typeof b=="object"?b[g]:b,p=o.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return a.map(g=>({original:g,criteria:p.map(b=>h(b,g))})).slice().sort((g,b)=>{for(let v=0;v<p.length;v++){const w=e.compareValues(g.criteria[v],b.criteria[v],l[v]);if(w!==0)return w}return 0}).map(g=>g.original)}t.orderBy=i})(OE)),OE}var BE={},eq;function lMe(){return eq||(eq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const h=l[u];Array.isArray(h)&&c<a?o(h,c+1):i.push(h)}};return o(r,0),i}t.flatten=e})(BE)),BE}var $E={},tq;function Cre(){return tq||(tq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jre(),r=aP(),n=gre(),i=bre();function a(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.eq(c[l],o):!1}t.isIterateeCall=a})($E)),$E}var rq;function cMe(){return rq||(rq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oMe(),r=lMe(),n=Cre();function i(a,...o){const l=o.length;return l>1&&n.isIterateeCall(a,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(a,r.flatten(o),["asc"])}t.sortBy=i})(PE)),PE}var FE,nq;function uMe(){return nq||(nq=1,FE=cMe().sortBy),FE}var dMe=uMe();const Bk=bl(dMe);var Ere=t=>t.legend.settings,hMe=t=>t.legend.size,fMe=t=>t.legend.payload,pMe=it([fMe,Ere],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?Bk(n,r):n});function mMe(){return kr(pMe)}var y5=1;function Are(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=y.useState({height:0,left:0,top:0,width:0}),n=y.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),o={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(o.height-e.height)>y5||Math.abs(o.left-e.left)>y5||Math.abs(o.top-e.top)>y5||Math.abs(o.width-e.width)>y5)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function So(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var gMe=typeof Symbol=="function"&&Symbol.observable||"@@observable",sq=gMe,UE=()=>Math.random().toString(36).substring(7).split("").join("."),xMe={INIT:`@@redux/INIT${UE()}`,REPLACE:`@@redux/REPLACE${UE()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${UE()}`},Oj=xMe;function lP(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Tre(t,e,r){if(typeof t!="function")throw new Error(So(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(So(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(So(1));return r(Tre)(t,e)}let n=t,i=e,a=new Map,o=a,l=0,c=!1;function u(){o===a&&(o=new Map,a.forEach((w,j)=>{o.set(j,w)}))}function h(){if(c)throw new Error(So(3));return i}function p(w){if(typeof w!="function")throw new Error(So(4));if(c)throw new Error(So(5));let j=!0;u();const _=l++;return o.set(_,w),function(){if(j){if(c)throw new Error(So(6));j=!1,u(),o.delete(_),a=null}}}function m(w){if(!lP(w))throw new Error(So(7));if(typeof w.type>"u")throw new Error(So(8));if(typeof w.type!="string")throw new Error(So(17));if(c)throw new Error(So(9));try{c=!0,i=n(i,w)}finally{c=!1}return(a=o).forEach(_=>{_()}),w}function g(w){if(typeof w!="function")throw new Error(So(10));n=w,m({type:Oj.REPLACE})}function b(){const w=p;return{subscribe(j){if(typeof j!="object"||j===null)throw new Error(So(11));function _(){const I=j;I.next&&I.next(h())}return _(),{unsubscribe:w(_)}},[sq](){return this}}}return m({type:Oj.INIT}),{dispatch:m,subscribe:p,getState:h,replaceReducer:g,[sq]:b}}function bMe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Oj.INIT})>"u")throw new Error(So(12));if(typeof r(void 0,{type:Oj.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(So(13))})}function Ire(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const o=e[a];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let i;try{bMe(r)}catch(a){i=a}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let h=0;h<n.length;h++){const p=n[h],m=r[p],g=o[p],b=m(g,l);if(typeof b>"u")throw l&&l.type,new Error(So(14));u[p]=b,c=c||b!==g}return c=c||n.length!==Object.keys(o).length,c?u:o}}function Rj(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function yMe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(So(15))};const o={getState:i.getState,dispatch:(c,...u)=>a(c,...u)},l=t.map(c=>c(o));return a=Rj(...l)(i.dispatch),{...i,dispatch:a}}}function Lre(t){return lP(t)&&"type"in t&&typeof t.type=="string"}var Pre=Symbol.for("immer-nothing"),iq=Symbol.for("immer-draftable"),xl=Symbol.for("immer-state");function Iu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var yc=Object,Jx=yc.getPrototypeOf,Mj="constructor",$k="prototype",BT="configurable",Dj="enumerable",yN="writable",m1="value",ef=t=>!!t&&!!t[xl];function Yu(t){return t?Ore(t)||Fk(t)||!!t[iq]||!!t[Mj]?.[iq]||Uk(t)||zk(t):!1}var vMe=yc[$k][Mj].toString(),aq=new WeakMap;function Ore(t){if(!t||!cP(t))return!1;const e=Jx(t);if(e===null||e===yc[$k])return!0;const r=yc.hasOwnProperty.call(e,Mj)&&e[Mj];if(r===Object)return!0;if(!nx(r))return!1;let n=aq.get(r);return n===void 0&&(n=Function.toString.call(r),aq.set(r,n)),n===vMe}function u2(t,e,r=!0){d2(t)===0?(r?Reflect.ownKeys(t):yc.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function d2(t){const e=t[xl];return e?e.type_:Fk(t)?1:Uk(t)?2:zk(t)?3:0}var oq=(t,e,r=d2(t))=>r===2?t.has(e):yc[$k].hasOwnProperty.call(t,e),$T=(t,e,r=d2(t))=>r===2?t.get(e):t[e],Bj=(t,e,r,n=d2(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function wMe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var Fk=Array.isArray,Uk=t=>t instanceof Map,zk=t=>t instanceof Set,cP=t=>typeof t=="object",nx=t=>typeof t=="function",zE=t=>typeof t=="boolean";function NMe(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var _h=t=>t.copy_||t.base_,uP=t=>t.modified_?t.copy_:t.base_;function FT(t,e){if(Uk(t))return new Map(t);if(zk(t))return new Set(t);if(Fk(t))return Array[$k].slice.call(t);const r=Ore(t);if(e===!0||e==="class_only"&&!r){const n=yc.getOwnPropertyDescriptors(t);delete n[xl];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],l=n[o];l[yN]===!1&&(l[yN]=!0,l[BT]=!0),(l.get||l.set)&&(n[o]={[BT]:!0,[yN]:!0,[Dj]:l[Dj],[m1]:t[o]})}return yc.create(Jx(t),n)}else{const n=Jx(t);if(n!==null&&r)return{...t};const i=yc.create(n);return yc.assign(i,t)}}function dP(t,e=!1){return qk(t)||ef(t)||!Yu(t)||(d2(t)>1&&yc.defineProperties(t,{set:v5,add:v5,clear:v5,delete:v5}),yc.freeze(t),e&&u2(t,(r,n)=>{dP(n,!0)},!1)),t}function jMe(){Iu(2)}var v5={[m1]:jMe};function qk(t){return t===null||!cP(t)?!0:yc.isFrozen(t)}var $j="MapSet",UT="Patches",lq="ArrayMethods",Rre={};function Nm(t){const e=Rre[t];return e||Iu(0,t),e}var cq=t=>!!Rre[t],g1,Mre=()=>g1,kMe=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:cq($j)?Nm($j):void 0,arrayMethodsPlugin_:cq(lq)?Nm(lq):void 0});function uq(t,e){e&&(t.patchPlugin_=Nm(UT),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function zT(t){qT(t),t.drafts_.forEach(_Me),t.drafts_=null}function qT(t){t===g1&&(g1=t.parent_)}var dq=t=>g1=kMe(g1,t);function _Me(t){const e=t[xl];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function hq(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[xl].modified_&&(zT(e),Iu(4)),Yu(t)&&(t=fq(e,t));const{patchPlugin_:i}=e;i&&i.generateReplacementPatches_(r[xl].base_,t,e)}else t=fq(e,r);return SMe(e,t,!0),zT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Pre?t:void 0}function fq(t,e){if(qk(e))return e;const r=e[xl];if(!r)return hP(e,t.handledSet_,t);if(!Vk(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);$re(r,t)}return r.copy_}function SMe(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&dP(e,r)}function Dre(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var Vk=(t,e)=>t.scope_===e,CMe=[];function Bre(t,e,r,n){const i=_h(t),a=t.type_;if(n!==void 0&&$T(i,n,a)===e){Bj(i,n,r,a);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;u2(i,(c,u)=>{if(ef(u)){const h=l.get(u)||[];h.push(c),l.set(u,h)}})}const o=t.draftLocations_.get(e)??CMe;for(const l of o)Bj(i,l,r,a)}function EMe(t,e,r){t.callbacks_.push(function(i){const a=e;if(!a||!Vk(a,i))return;i.mapSetPlugin_?.fixSetContents(a);const o=uP(a);Bre(t,a.draft_??a,o,r),$re(a,i)})}function $re(t,e){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){const{patchPlugin_:n}=e;if(n){const i=n.getPath(t);i&&n.generatePatches_(t,i,e)}Dre(t)}}function AMe(t,e,r){const{scope_:n}=t;if(ef(r)){const i=r[xl];Vk(i,n)&&i.callbacks_.push(function(){vN(t);const o=uP(i);Bre(t,r,o,e)})}else Yu(r)&&t.callbacks_.push(function(){const a=_h(t);$T(a,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&hP($T(t.copy_,e,t.type_),n.handledSet_,n)})}function hP(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ef(t)||e.has(t)||!Yu(t)||qk(t)||(e.add(t),u2(t,(n,i)=>{if(ef(i)){const a=i[xl];if(Vk(a,r)){const o=uP(a);Bj(t,n,o,t.type_),Dre(a)}}else Yu(i)&&hP(i,e,r)})),t}function TMe(t,e){const r=Fk(t),n={type_:r?1:0,scope_:e?e.scope_:Mre(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,a=fP;r&&(i=[n],a=x1);const{revoke:o,proxy:l}=Proxy.revocable(i,a);return n.draft_=l,n.revoke_=o,[l,n]}var fP={get(t,e){if(e===xl)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r?.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const i=_h(t);if(!oq(i,e,t.type_))return IMe(t,i,e);const a=i[e];if(t.finalized_||!Yu(a)||n&&t.operationMethod&&r?.isMutatingArrayMethod(t.operationMethod)&&NMe(e))return a;if(a===qE(t.base_,e)){vN(t);const o=t.type_===1?+e:e,l=HT(t.scope_,a,t,o);return t.copy_[o]=l}return a},has(t,e){return e in _h(t)},ownKeys(t){return Reflect.ownKeys(_h(t))},set(t,e,r){const n=Fre(_h(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=qE(_h(t),e),a=i?.[xl];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(wMe(r,i)&&(r!==void 0||oq(t.base_,e,t.type_)))return!0;vN(t),VT(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),AMe(t,e,r)),!0},deleteProperty(t,e){return vN(t),qE(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),VT(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=_h(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[yN]:!0,[BT]:t.type_!==1||e!=="length",[Dj]:n[Dj],[m1]:r[e]}},defineProperty(){Iu(11)},getPrototypeOf(t){return Jx(t.base_)},setPrototypeOf(){Iu(12)}},x1={};u2(fP,(t,e)=>{x1[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}});x1.deleteProperty=function(t,e){return x1.set.call(this,t,e,void 0)};x1.set=function(t,e,r){return fP.set.call(this,t[0],e,r,t[0])};function qE(t,e){const r=t[xl];return(r?_h(r):t)[e]}function IMe(t,e,r){const n=Fre(e,r);return n?m1 in n?n[m1]:n.get?.call(t.draft_):void 0}function Fre(t,e){if(!(e in t))return;let r=Jx(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Jx(r)}}function VT(t){t.modified_||(t.modified_=!0,t.parent_&&VT(t.parent_))}function vN(t){t.copy_||(t.assigned_=new Map,t.copy_=FT(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var LMe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(nx(r)&&!nx(n)){const o=n;n=r;const l=this;return function(u=o,...h){return l.produce(u,p=>n.call(this,p,...h))}}nx(n)||Iu(6),i!==void 0&&!nx(i)&&Iu(7);let a;if(Yu(r)){const o=dq(this),l=HT(o,r,void 0);let c=!0;try{a=n(l),c=!1}finally{c?zT(o):qT(o)}return uq(o,i),hq(a,o)}else if(!r||!cP(r)){if(a=n(r),a===void 0&&(a=r),a===Pre&&(a=void 0),this.autoFreeze_&&dP(a,!0),i){const o=[],l=[];Nm(UT).generateReplacementPatches_(r,a,{patches_:o,inversePatches_:l}),i(o,l)}return a}else Iu(1,r)},this.produceWithPatches=(r,n)=>{if(nx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,a;return[this.produce(r,n,(l,c)=>{i=l,a=c}),i,a]},zE(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),zE(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),zE(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Yu(e)||Iu(8),ef(e)&&(e=qu(e));const r=dq(this),n=HT(r,e,void 0);return n[xl].isManual_=!0,qT(r),n}finishDraft(e,r){const n=e&&e[xl];(!n||!n.isManual_)&&Iu(9);const{scope_:i}=n;return uq(i,r),hq(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(r=r.slice(n+1));const i=Nm(UT).applyPatches_;return ef(e)?i(e,r):this.produce(e,a=>i(a,r))}};function HT(t,e,r,n){const[i,a]=Uk(e)?Nm($j).proxyMap_(e,r):zk(e)?Nm($j).proxySet_(e,r):TMe(e,r);return(r?.scope_??Mre()).drafts_.push(i),a.callbacks_=r?.callbacks_??[],a.key_=n,r&&n!==void 0?EMe(r,a,n):a.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(a);const{patchPlugin_:u}=c;a.modified_&&u&&u.generatePatches_(a,[],c)}),i}function qu(t){return ef(t)||Iu(10,t),Ure(t)}function Ure(t){if(!Yu(t)||qk(t))return t;const e=t[xl];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=FT(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=FT(t,!0);return u2(r,(i,a)=>{Bj(r,i,Ure(a))},n),e&&(e.finalized_=!1),r}var PMe=new LMe,zre=PMe.produce;function qre(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var OMe=qre(),RMe=qre,MMe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Rj:Rj.apply(null,arguments)};function au(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Nc(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Lre(n)&&n.type===t,r}var Vre=class rv extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,rv.prototype)}static get[Symbol.species](){return rv}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new rv(...e[0].concat(this)):new rv(...e.concat(this))}};function pq(t){return Yu(t)?zre(t,()=>{}):t}function w5(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function DMe(t){return typeof t=="boolean"}var BMe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let o=new Vre;return r&&(DMe(r)?o.push(OMe):o.push(RMe(r.extraArgument))),o},Hre="RTK_autoBatch",gi=()=>t=>({payload:t,meta:{[Hre]:!0}}),mq=t=>e=>{setTimeout(e,t)},Wre=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:mq(10):t.type==="callback"?t.queueNotification:mq(t.timeout),u=()=>{o=!1,a&&(a=!1,l.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const p=()=>i&&h(),m=n.subscribe(p);return l.add(h),()=>{m(),l.delete(h)}},dispatch(h){try{return i=!h?.meta?.[Hre],a=!i,a&&(o||(o=!0,c(u))),n.dispatch(h)}finally{i=!0}}})},$Me=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new Vre(t);return n&&i.push(Wre(typeof n=="object"?n:void 0)),i};function FMe(t){const e=BMe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(lP(r))l=Ire(r);else throw new Error(Nc(1));let c;typeof n=="function"?c=n(e):c=e();let u=Rj;i&&(u=MMe({trace:!1,...typeof i=="object"&&i}));const h=yMe(...c),p=$Me(h);let m=typeof o=="function"?o(p):p();const g=u(...m);return Tre(l,a,g)}function Gre(t){const e={},r=[];let n;const i={addCase(a,o){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(Nc(28));if(l in e)throw new Error(Nc(29));return e[l]=o,i},addAsyncThunk(a,o){return o.pending&&(e[a.pending.type]=o.pending),o.rejected&&(e[a.rejected.type]=o.rejected),o.fulfilled&&(e[a.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:a.settled,reducer:o.settled}),i},addMatcher(a,o){return r.push({matcher:a,reducer:o}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function UMe(t){return typeof t=="function"}function zMe(t,e){let[r,n,i]=Gre(e),a;if(UMe(t))a=()=>pq(t());else{const l=pq(t);a=()=>l}function o(l=a(),c){let u=[r[c.type],...n.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[i]),u.reduce((h,p)=>{if(p)if(ef(h)){const g=p(h,c);return g===void 0?h:g}else{if(Yu(h))return zre(h,m=>p(m,c));{const m=p(h,c);if(m===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return h},l)}return o.getInitialState=a,o}var qMe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",VMe=(t=21)=>{let e="",r=t;for(;r--;)e+=qMe[Math.random()*64|0];return e},HMe=Symbol.for("rtk-slice-createasyncthunk");function WMe(t,e){return`${t}/${e}`}function GMe({creators:t}={}){const e=t?.asyncThunk?.[HMe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Nc(11));const o=(typeof n.reducers=="function"?n.reducers(YMe()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(E,I){const O=typeof E=="string"?E:E.type;if(!O)throw new Error(Nc(12));if(O in c.sliceCaseReducersByType)throw new Error(Nc(13));return c.sliceCaseReducersByType[O]=I,u},addMatcher(E,I){return c.sliceMatchers.push({matcher:E,reducer:I}),u},exposeAction(E,I){return c.actionCreators[E]=I,u},exposeCaseReducer(E,I){return c.sliceCaseReducersByName[E]=I,u}};l.forEach(E=>{const I=o[E],O={reducerName:E,type:WMe(i,E),createNotation:typeof n.reducers=="function"};QMe(I)?ZMe(O,I,u,e):XMe(O,I,u)});function h(){const[E={},I=[],O=void 0]=typeof n.extraReducers=="function"?Gre(n.extraReducers):[n.extraReducers],B={...E,...c.sliceCaseReducersByType};return zMe(n.initialState,S=>{for(let T in B)S.addCase(T,B[T]);for(let T of c.sliceMatchers)S.addMatcher(T.matcher,T.reducer);for(let T of I)S.addMatcher(T.matcher,T.reducer);O&&S.addDefaultCase(O)})}const p=E=>E,m=new Map,g=new WeakMap;let b;function v(E,I){return b||(b=h()),b(E,I)}function w(){return b||(b=h()),b.getInitialState()}function j(E,I=!1){function O(S){let T=S[E];return typeof T>"u"&&I&&(T=w5(g,O,w)),T}function B(S=p){const T=w5(m,I,()=>new WeakMap);return w5(T,S,()=>{const M={};for(const[$,k]of Object.entries(n.selectors??{}))M[$]=KMe(k,S,()=>w5(g,S,w),I);return M})}return{reducerPath:E,getSelectors:B,get selectors(){return B(O)},selectSlice:O}}const _={name:i,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...j(a),injectInto(E,{reducerPath:I,...O}={}){const B=I??a;return E.inject({reducerPath:B,reducer:v},O),{..._,...j(B,!0)}}};return _}}function KMe(t,e,r,n){function i(a,...o){let l=e(a);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return i.unwrapped=t,i}var ec=GMe();function YMe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function XMe({type:t,reducerName:e,createNotation:r},n,i){let a,o;if("reducer"in n){if(r&&!JMe(n))throw new Error(Nc(17));a=n.reducer,o=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,o?au(t,o):au(t))}function QMe(t){return t._reducerDefinitionType==="asyncThunk"}function JMe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function ZMe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Nc(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:u,options:h}=r,p=i(t,a,h);n.exposeAction(e,p),o&&n.addCase(p.fulfilled,o),l&&n.addCase(p.pending,l),c&&n.addCase(p.rejected,c),u&&n.addMatcher(p.settled,u),n.exposeCaseReducer(e,{fulfilled:o||N5,pending:l||N5,rejected:c||N5,settled:u||N5})}function N5(){}var e7e="task",Kre="listener",Yre="completed",pP="cancelled",t7e=`task-${pP}`,r7e=`task-${Yre}`,WT=`${Kre}-${pP}`,n7e=`${Kre}-${Yre}`,Hk=class{constructor(t){this.code=t,this.message=`${e7e} ${pP} (reason: ${t})`}name="TaskAbortError";message},mP=(t,e)=>{if(typeof t!="function")throw new TypeError(Nc(32))},Fj=()=>{},Xre=(t,e=Fj)=>(t.catch(e),t),Qre=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Wp=t=>{if(t.aborted)throw new Hk(t.reason)};function Jre(t,e){let r=Fj;return new Promise((n,i)=>{const a=()=>i(new Hk(t.reason));if(t.aborted){a();return}r=Qre(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=Fj})}var s7e=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Hk?"cancelled":"rejected",error:r}}finally{e?.()}},Uj=t=>e=>Xre(Jre(t,e).then(r=>(Wp(t),r))),Zre=t=>{const e=Uj(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:Tx}=Object,gq={},Wk="listenerMiddleware",i7e=(t,e)=>{const r=n=>Qre(t,()=>n.abort(t.reason));return(n,i)=>{mP(n);const a=new AbortController;r(a);const o=s7e(async()=>{Wp(t),Wp(a.signal);const l=await n({pause:Uj(a.signal),delay:Zre(a.signal),signal:a.signal});return Wp(a.signal),l},()=>a.abort(r7e));return i?.autoJoin&&e.push(o.catch(Fj)),{result:Uj(t)(o),cancel(){a.abort(t7e)}}}},a7e=(t,e)=>{const r=async(n,i)=>{Wp(e);let a=()=>{};const l=[new Promise((c,u)=>{let h=t({predicate:n,effect:(p,m)=>{m.unsubscribe(),c([p,m.getState(),m.getOriginalState()])}});a=()=>{h(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await Jre(e,Promise.race(l));return Wp(e),c}finally{a()}};return(n,i)=>Xre(r(n,i))},ene=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=au(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Nc(21));return mP(a),{predicate:i,type:e,effect:a}},tne=Tx(t=>{const{type:e,predicate:r,effect:n}=ene(t);return{id:VMe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Nc(22))}}},{withTypes:()=>tne}),xq=(t,e)=>{const{type:r,effect:n,predicate:i}=ene(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},GT=t=>{t.pending.forEach(e=>{e.abort(WT)})},o7e=(t,e)=>()=>{for(const r of e.keys())GT(r);t.clear()},bq=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},rne=Tx(au(`${Wk}/add`),{withTypes:()=>rne}),l7e=au(`${Wk}/removeAll`),nne=Tx(au(`${Wk}/remove`),{withTypes:()=>nne}),c7e=(...t)=>{console.error(`${Wk}/error`,...t)},h2=(t={})=>{const e=new Map,r=new Map,n=g=>{const b=r.get(g)??0;r.set(g,b+1)},i=g=>{const b=r.get(g)??1;b===1?r.delete(g):r.set(g,b-1)},{extra:a,onError:o=c7e}=t;mP(o);const l=g=>(g.unsubscribe=()=>e.delete(g.id),e.set(g.id,g),b=>{g.unsubscribe(),b?.cancelActive&&GT(g)}),c=g=>{const b=xq(e,g)??tne(g);return l(b)};Tx(c,{withTypes:()=>c});const u=g=>{const b=xq(e,g);return b&&(b.unsubscribe(),g.cancelActive&&GT(b)),!!b};Tx(u,{withTypes:()=>u});const h=async(g,b,v,w)=>{const j=new AbortController,_=a7e(c,j.signal),E=[];try{g.pending.add(j),n(g),await Promise.resolve(g.effect(b,Tx({},v,{getOriginalState:w,condition:(I,O)=>_(I,O).then(Boolean),take:_,delay:Zre(j.signal),pause:Uj(j.signal),extra:a,signal:j.signal,fork:i7e(j.signal,E),unsubscribe:g.unsubscribe,subscribe:()=>{e.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((I,O,B)=>{I!==j&&(I.abort(WT),B.delete(I))})},cancel:()=>{j.abort(WT),g.pending.delete(j)},throwIfCancelled:()=>{Wp(j.signal)}})))}catch(I){I instanceof Hk||bq(o,I,{raisedBy:"effect"})}finally{await Promise.all(E),j.abort(n7e),i(g),g.pending.delete(j)}},p=o7e(e,r);return{middleware:g=>b=>v=>{if(!Lre(v))return b(v);if(rne.match(v))return c(v.payload);if(l7e.match(v)){p();return}if(nne.match(v))return u(v.payload);let w=g.getState();const j=()=>{if(w===gq)throw new Error(Nc(23));return w};let _;try{if(_=b(v),e.size>0){const E=g.getState(),I=Array.from(e.values());for(const O of I){let B=!1;try{B=O.predicate(v,E,w)}catch(S){B=!1,bq(o,S,{raisedBy:"predicate"})}B&&h(O,v,g,j)}}}finally{w=gq}return _},startListening:c,stopListening:u,clearListeners:p}};function Nc(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var u7e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sne=ec({name:"chartLayout",initialState:u7e,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,i,a;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(i=e.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(a=e.payload.left)!==null&&a!==void 0?a:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:d7e,setLayout:h7e,setChartSize:f7e,setScale:p7e}=sne.actions,m7e=sne.reducer;function ine(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Ti(t){return Number.isFinite(t)}function D0(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function yq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yq(Object(r),!0).forEach(function(n){g7e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g7e(t,e,r){return(e=x7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x7e(t){var e=b7e(t,"string");return typeof e=="symbol"?e:e+""}function b7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function si(t,e,r){return lo(t)||lo(e)?r:Hd(e)?wm(t,e,r):typeof e=="function"?e(t):r}var y7e=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&a!=="center"&&Tr(t[a]))return lx(lx({},t),{},{[a]:t[a]+(n||0)});if((l==="horizontal"||l==="vertical"&&a==="center")&&o!=="middle"&&Tr(t[o]))return lx(lx({},t),{},{[o]:t[o]+(i||0)})}return t},Hm=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",vq=1e-4,v7e=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-vq,a=Math.max(n[0],n[1])+vq,o=t(e[0]),l=t(e[r-1]);(o<i||o>a||l<i||l>a)&&t.domain([e[0],e[r-1]])}},w7e=(t,e)=>{if(!e||e.length!==2||!Tr(e[0])||!Tr(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),i=[t[0],t[1]];return(!Tr(t[0])||t[0]<r)&&(i[0]=r),(!Tr(t[1])||t[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},N7e=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0,l=0;l<r;++l){var c=t[l],u=c?.[i];if(u!=null){var h=u[1],p=u[0],m=Vd(h)?p:h;m>=0?(u[0]=a,u[1]=a+m,a=h):(u[0]=o,u[1]=o+m,o=h)}}}},j7e=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0;o<r;++o){var l=t[o],c=l?.[i];if(c!=null){var u=Vd(c[1])?c[0]:c[1];u>=0?(c[0]=a,c[1]=a+u,a=c[1]):(c[0]=0,c[1]=0)}}}},k7e={sign:N7e,expand:UOe,none:vm,silhouette:zOe,wiggle:qOe,positive:j7e},_7e=(t,e,r)=>{var n,i=(n=k7e[r])!==null&&n!==void 0?n:vm,a=FOe().keys(e).value((l,c)=>Number(si(l,c,0))).order(MT).offset(i),o=a(t);return o.forEach((l,c)=>{l.forEach((u,h)=>{var p=si(t[h],e[c],0);Array.isArray(p)&&p.length===2&&Tr(p[0])&&Tr(p[1])&&(u[0]=p[0],u[1]=p[1])})}),o};function S7e(t){return t==null?void 0:String(t)}var wq=t=>{var{axis:e,ticks:r,offset:n,bandSize:i,entry:a,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=si(a,e.dataKey,e.scale.domain()[o]);return lo(l)?null:e.scale(l)-i/2+n},C7e=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},E7e=t=>{var e=t.flat(2).filter(Tr);return[Math.min(...e),Math.max(...e)]},A7e=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],T7e=(t,e,r)=>{if(t!=null)return A7e(Object.keys(t).reduce((n,i)=>{var a=t[i];if(!a)return n;var{stackedData:o}=a,l=o.reduce((c,u)=>{var h=ine(u,e,r),p=E7e(h);return!Ti(p[0])||!Ti(p[1])?c:[Math.min(c[0],p[0]),Math.max(c[1],p[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},Nq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zj=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=Bk(e,h=>h.coordinate),a=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];a=Math.min((c?.coordinate||0)-(u?.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function kq(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return lx(lx({},e),{},{dataKey:r,payload:n,value:i,name:a})}function Gk(t,e){if(t)return String(t);if(typeof e=="string")return e}var I7e=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},L7e=(t,e)=>e==="centric"?t.angle:t.radius,mf=t=>t.layout.width,gf=t=>t.layout.height,P7e=t=>t.layout.scale,ane=t=>t.layout.margin,Kk=it(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Yk=it(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),one="data-recharts-item-index",lne="data-recharts-item-id",f2=60;function _q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function j5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_q(Object(r),!0).forEach(function(n){O7e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_q(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function O7e(t,e,r){return(e=R7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R7e(t){var e=M7e(t,"string");return typeof e=="symbol"?e:e+""}function M7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var D7e=t=>t.brush.height;function B7e(t){var e=Yk(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:f2;return r+i}return r},0)}function $7e(t){var e=Yk(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:f2;return r+i}return r},0)}function F7e(t){var e=Kk(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function U7e(t){var e=Kk(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var za=it([mf,gf,ane,D7e,B7e,$7e,F7e,U7e,Ere,hMe],(t,e,r,n,i,a,o,l,c,u)=>{var h={left:(r.left||0)+i,right:(r.right||0)+a},p={top:(r.top||0)+o,bottom:(r.bottom||0)+l},m=j5(j5({},p),h),g=m.bottom;m.bottom+=n,m=y7e(m,c,u);var b=t-m.left-m.right,v=e-m.top-m.bottom;return j5(j5({brushBottom:g},m),{},{width:Math.max(b,0),height:Math.max(v,0)})}),z7e=it(za,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),gP=it(mf,gf,(t,e)=>({x:0,y:0,width:t,height:e})),q7e=y.createContext(null),Ec=()=>y.useContext(q7e)!=null,Xk=t=>t.brush,Qk=it([Xk,za,ane],(t,e,r)=>({height:t.height,x:Tr(t.x)?t.x:e.left,y:Tr(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:Tr(t.width)?t.width:e.width})),VE={},HE={},WE={},Sq;function V7e(){return Sq||(Sq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:i,edges:a}={}){let o,l=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),h=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},p=()=>{u&&h(),v()};let m=null;const g=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,p()},n)},b=()=>{m!==null&&(clearTimeout(m),m=null)},v=()=>{b(),o=void 0,l=null},w=()=>{h()},j=function(..._){if(i?.aborted)return;o=this,l=_;const E=m==null;g(),c&&E&&h()};return j.schedule=g,j.cancel=v,j.flush=w,i?.addEventListener("abort",v,{once:!0}),j}t.debounce=e})(WE)),WE}var Cq;function H7e(){return Cq||(Cq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=V7e();function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:o=!1,trailing:l=!0,maxWait:c}=a,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let h,p=null;const m=e.debounce(function(...v){h=n.apply(this,v),p=null},i,{edges:u}),g=function(...v){return c!=null&&(p===null&&(p=Date.now()),Date.now()-p>=c)?(h=n.apply(this,v),p=Date.now(),m.cancel(),m.schedule(),h):(m.apply(this,v),h)},b=()=>(m.flush(),h);return g.cancel=m.cancel,g.flush=b,g}t.debounce=r})(HE)),HE}var Eq;function W7e(){return Eq||(Eq=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=H7e();function r(n,i=0,a={}){const{leading:o=!0,trailing:l=!0}=a;return e.debounce(n,i,{leading:o,maxWait:i,trailing:l})}t.throttle=r})(VE)),VE}var GE,Aq;function G7e(){return Aq||(Aq=1,GE=W7e().throttle),GE}var K7e=G7e();const Y7e=bl(K7e);var Tq=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},cne=(t,e,r)=>{var{width:n="100%",height:i="100%",aspect:a,maxHeight:o}=r,l=Zh(n)?t:Number(n),c=Zh(i)?e:Number(i);return a&&a>0&&(l?c=l/a:c&&(l=c*a),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},X7e={width:0,height:0,overflow:"visible"},Q7e={width:0,overflowX:"visible"},J7e={height:0,overflowY:"visible"},Z7e={},eDe=t=>{var{width:e,height:r}=t,n=Zh(e),i=Zh(r);return n&&i?X7e:n?Q7e:i?J7e:Z7e};function tDe(t){var{width:e,height:r,aspect:n}=t,i=e,a=r;return i===void 0&&a===void 0?(i="100%",a="100%"):i===void 0?i=n&&n>0?void 0:"100%":a===void 0&&(a=n&&n>0?void 0:"100%"),{width:i,height:a}}function KT(){return KT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},KT.apply(null,arguments)}function Iq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Lq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Iq(Object(r),!0).forEach(function(n){rDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Iq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rDe(t,e,r){return(e=nDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nDe(t){var e=sDe(t,"string");return typeof e=="symbol"?e:e+""}function sDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var une=y.createContext({width:-1,height:-1});function iDe(t){return D0(t.width)&&D0(t.height)}function dne(t){var{children:e,width:r,height:n}=t,i=y.useMemo(()=>({width:r,height:n}),[r,n]);return iDe(i)?y.createElement(une.Provider,{value:i},e):null}var xP=()=>y.useContext(une),aDe=y.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i,height:a,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:h=0,id:p,className:m,onResize:g,style:b={}}=t,v=y.useRef(null),w=y.useRef();w.current=g,y.useImperativeHandle(e,()=>v.current);var[j,_]=y.useState({containerWidth:n.width,containerHeight:n.height}),E=y.useCallback((T,M)=>{_($=>{var k=Math.round(T),L=Math.round(M);return $.containerWidth===k&&$.containerHeight===L?$:{containerWidth:k,containerHeight:L}})},[]);y.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return l2;var T=L=>{var R,{width:V,height:Y}=L[0].contentRect;E(V,Y),(R=w.current)===null||R===void 0||R.call(w,V,Y)};h>0&&(T=Y7e(T,h,{trailing:!0,leading:!1}));var M=new ResizeObserver(T),{width:$,height:k}=v.current.getBoundingClientRect();return E($,k),M.observe(v.current),()=>{M.disconnect()}},[E,h]);var{containerWidth:I,containerHeight:O}=j;Tq(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:B,calculatedHeight:S}=cne(I,O,{width:i,height:a,aspect:r,maxHeight:c});return Tq(B!=null&&B>0||S!=null&&S>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,B,S,i,a,o,l,r),y.createElement("div",{id:p?"".concat(p):void 0,className:gs("recharts-responsive-container",m),style:Lq(Lq({},b),{},{width:i,height:a,minWidth:o,minHeight:l,maxHeight:c}),ref:v},y.createElement("div",{style:eDe({width:i,height:a})},y.createElement(dne,{width:B,height:S},u)))}),Pq=y.forwardRef((t,e)=>{var r=xP();if(D0(r.width)&&D0(r.height))return t.children;var{width:n,height:i}=tDe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:a,calculatedHeight:o}=cne(void 0,void 0,{width:n,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return Tr(a)&&Tr(o)?y.createElement(dne,{width:a,height:o},t.children):y.createElement(aDe,KT({},t,{width:n,height:i,ref:e}))});function hne(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var Jk=()=>{var t,e=Ec(),r=kr(z7e),n=kr(Qk),i=(t=kr(Xk))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},oDe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},lDe=()=>{var t;return(t=kr(za))!==null&&t!==void 0?t:oDe},fne=()=>kr(mf),pne=()=>kr(gf),cDe=()=>kr(t=>t.layout.margin),Jn=t=>t.layout.layoutType,p2=()=>kr(Jn),uDe=()=>{var t=p2();return t!==void 0},Zk=t=>{var e=Hs(),r=Ec(),{width:n,height:i}=t,a=xP(),o=n,l=i;return a&&(o=a.width>0?a.width:n,l=a.height>0?a.height:i),y.useEffect(()=>{!r&&D0(o)&&D0(l)&&e(f7e({width:o,height:l}))},[e,r,o,l]),null},mne=Symbol.for("immer-nothing"),Oq=Symbol.for("immer-draftable"),_c=Symbol.for("immer-state");function Lu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var b1=Object.getPrototypeOf;function Zx(t){return!!t&&!!t[_c]}function jm(t){return t?gne(t)||Array.isArray(t)||!!t[Oq]||!!t.constructor?.[Oq]||m2(t)||t_(t):!1}var dDe=Object.prototype.constructor.toString(),Rq=new WeakMap;function gne(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=Rq.get(r);return n===void 0&&(n=Function.toString.call(r),Rq.set(r,n)),n===dDe}function qj(t,e,r=!0){e_(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function e_(t){const e=t[_c];return e?e.type_:Array.isArray(t)?1:m2(t)?2:t_(t)?3:0}function YT(t,e){return e_(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function xne(t,e,r){const n=e_(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function hDe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function m2(t){return t instanceof Map}function t_(t){return t instanceof Set}function wp(t){return t.copy_||t.base_}function XT(t,e){if(m2(t))return new Map(t);if(t_(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=gne(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[_c];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(b1(t),n)}else{const n=b1(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function bP(t,e=!1){return r_(t)||Zx(t)||!jm(t)||(e_(t)>1&&Object.defineProperties(t,{set:k5,add:k5,clear:k5,delete:k5}),Object.freeze(t),e&&Object.values(t).forEach(r=>bP(r,!0))),t}function fDe(){Lu(2)}var k5={value:fDe};function r_(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var pDe={};function km(t){const e=pDe[t];return e||Lu(0,t),e}var y1;function bne(){return y1}function mDe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Mq(t,e){e&&(km("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function QT(t){JT(t),t.drafts_.forEach(gDe),t.drafts_=null}function JT(t){t===y1&&(y1=t.parent_)}function Dq(t){return y1=mDe(y1,t)}function gDe(t){const e=t[_c];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Bq(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[_c].modified_&&(QT(e),Lu(4)),jm(t)&&(t=Vj(e,t),e.parent_||Hj(e,t)),e.patches_&&km("Patches").generateReplacementPatches_(r[_c].base_,t,e.patches_,e.inversePatches_)):t=Vj(e,r,[]),QT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==mne?t:void 0}function Vj(t,e,r){if(r_(e))return e;const n=t.immer_.shouldUseStrictIteration(),i=e[_c];if(!i)return qj(e,(a,o)=>$q(t,i,e,a,o,r),n),e;if(i.scope_!==t)return e;if(!i.modified_)return Hj(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const a=i.copy_;let o=a,l=!1;i.type_===3&&(o=new Set(a),a.clear(),l=!0),qj(o,(c,u)=>$q(t,i,a,c,u,r,l),n),Hj(t,a,!1),r&&t.patches_&&km("Patches").generatePatches_(i,r,t.patches_,t.inversePatches_)}return i.copy_}function $q(t,e,r,n,i,a,o){if(i==null||typeof i!="object"&&!o)return;const l=r_(i);if(!(l&&!o)){if(Zx(i)){const c=a&&e&&e.type_!==3&&!YT(e.assigned_,n)?a.concat(n):void 0,u=Vj(t,i,c);if(xne(r,n,u),Zx(u))t.canAutoFreeze_=!1;else return}else o&&r.add(i);if(jm(i)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===i&&l)return;Vj(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(m2(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Hj(t,i)}}}function Hj(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&bP(e,r)}function xDe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:bne(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=yP;r&&(i=[n],a=v1);const{revoke:o,proxy:l}=Proxy.revocable(i,a);return n.draft_=l,n.revoke_=o,l}var yP={get(t,e){if(e===_c)return t;const r=wp(t);if(!YT(r,e))return bDe(t,r,e);const n=r[e];return t.finalized_||!jm(n)?n:n===KE(t.base_,e)?(YE(t),t.copy_[e]=e8(n,t)):n},has(t,e){return e in wp(t)},ownKeys(t){return Reflect.ownKeys(wp(t))},set(t,e,r){const n=yne(wp(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=KE(wp(t),e),a=i?.[_c];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(hDe(r,i)&&(r!==void 0||YT(t.base_,e)))return!0;YE(t),ZT(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return KE(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,YE(t),ZT(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=wp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Lu(11)},getPrototypeOf(t){return b1(t.base_)},setPrototypeOf(){Lu(12)}},v1={};qj(yP,(t,e)=>{v1[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});v1.deleteProperty=function(t,e){return v1.set.call(this,t,e,void 0)};v1.set=function(t,e,r){return yP.set.call(this,t[0],e,r,t[0])};function KE(t,e){const r=t[_c];return(r?wp(r):t)[e]}function bDe(t,e,r){const n=yne(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function yne(t,e){if(!(e in t))return;let r=b1(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=b1(r)}}function ZT(t){t.modified_||(t.modified_=!0,t.parent_&&ZT(t.parent_))}function YE(t){t.copy_||(t.copy_=XT(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var yDe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const o=this;return function(c=a,...u){return o.produce(c,h=>r.call(this,h,...u))}}typeof r!="function"&&Lu(6),n!==void 0&&typeof n!="function"&&Lu(7);let i;if(jm(e)){const a=Dq(this),o=e8(e,void 0);let l=!0;try{i=r(o),l=!1}finally{l?QT(a):JT(a)}return Mq(a,n),Bq(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===mne&&(i=void 0),this.autoFreeze_&&bP(i,!0),n){const a=[],o=[];km("Patches").generateReplacementPatches_(e,i,a,o),n(a,o)}return i}else Lu(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,i;return[this.produce(e,r,(o,l)=>{n=o,i=l}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){jm(t)||Lu(8),Zx(t)&&(t=vDe(t));const e=Dq(this),r=e8(t,void 0);return r[_c].isManual_=!0,JT(e),r}finishDraft(t,e){const r=t&&t[_c];(!r||!r.isManual_)&&Lu(9);const{scope_:n}=r;return Mq(n,e),Bq(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=km("Patches").applyPatches_;return Zx(t)?n(t,e):this.produce(t,i=>n(i,e))}};function e8(t,e){const r=m2(t)?km("MapSet").proxyMap_(t,e):t_(t)?km("MapSet").proxySet_(t,e):xDe(t,e);return(e?e.scope_:bne()).drafts_.push(r),r}function vDe(t){return Zx(t)||Lu(10,t),vne(t)}function vne(t){if(!jm(t)||r_(t))return t;const e=t[_c];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=XT(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=XT(t,!0);return qj(r,(i,a)=>{xne(r,i,vne(a))},n),e&&(e.finalized_=!1),r}var wDe=new yDe;wDe.produce;var NDe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},wne=ec({name:"legend",initialState:NDe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:gi()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,i=qu(t).payload.indexOf(r);i>-1&&(t.payload[i]=n)},prepare:gi()},removeLegendPayload:{reducer(t,e){var r=qu(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:gi()}}}),{setLegendSize:Fq,setLegendSettings:jDe,addLegendPayload:Nne,replaceLegendPayload:jne,removeLegendPayload:kne}=wne.actions,kDe=wne.reducer,_De=["contextPayload"];function t8(){return t8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},t8.apply(null,arguments)}function Uq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function eb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uq(Object(r),!0).forEach(function(n){SDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SDe(t,e,r){return(e=CDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CDe(t){var e=EDe(t,"string");return typeof e=="symbol"?e:e+""}function EDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ADe(t,e){if(t==null)return{};var r,n,i=TDe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function TDe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function IDe(t){return t.value}function LDe(t){var{contextPayload:e}=t,r=ADe(t,_De),n=kre(e,t.payloadUniqBy,IDe),i=eb(eb({},r),{},{payload:n});return y.isValidElement(t.content)?y.cloneElement(t.content,i):typeof t.content=="function"?y.createElement(t.content,i):y.createElement(wRe,i)}function PDe(t,e,r,n,i,a){var{layout:o,align:l,verticalAlign:c}=e,u,h;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-a.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?h={top:((i||0)-a.height)/2}:h=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),eb(eb({},u),h)}function ODe(t){var e=Hs();return y.useEffect(()=>{e(jDe(t))},[e,t]),null}function RDe(t){var e=Hs();return y.useEffect(()=>(e(Fq(t)),()=>{e(Fq({width:0,height:0}))}),[e,t]),null}function MDe(t,e,r,n){return t==="vertical"&&Tr(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var DDe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function _ne(t){var e=Do(t,DDe),r=mMe(),n=uOe(),i=cDe(),{width:a,height:o,wrapperStyle:l,portal:c}=e,[u,h]=Are([r]),p=fne(),m=pne();if(p==null||m==null)return null;var g=p-(i?.left||0)-(i?.right||0),b=MDe(e.layout,o,a,g),v=c?l:eb(eb({position:"absolute",width:b?.width||a||"auto",height:b?.height||o||"auto"},PDe(l,e,i,p,m,u)),l),w=c??n;if(w==null||r==null)return null;var j=y.createElement("div",{className:"recharts-legend-wrapper",style:v,ref:h},y.createElement(ODe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&y.createElement(RDe,{width:u.width,height:u.height}),y.createElement(LDe,t8({},e,b,{margin:i,chartWidth:p,chartHeight:m,contextPayload:r})));return Vn.createPortal(j,w)}_ne.displayName="Legend";function r8(){return r8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},r8.apply(null,arguments)}function zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function XE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zq(Object(r),!0).forEach(function(n){BDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BDe(t,e,r){return(e=$De(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $De(t){var e=FDe(t,"string");return typeof e=="symbol"?e:e+""}function FDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UDe(t){return Array.isArray(t)&&Hd(t[0])&&Hd(t[1])?t.join(" ~ "):t}var zDe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:h,labelFormatter:p,accessibilityLayer:m=!1}=t,g=()=>{if(a&&a.length){var O={padding:0,margin:0},B=(l?Bk(a,l):a).map((S,T)=>{if(S.type==="none")return null;var M=S.formatter||o||UDe,{value:$,name:k}=S,L=$,R=k;if(M){var V=M($,k,S,T,a);if(Array.isArray(V))[L,R]=V;else if(V!=null)L=V;else return null}var Y=XE({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:Y},Hd(R)?y.createElement("span",{className:"recharts-tooltip-item-name"},R):null,Hd(R)?y.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,y.createElement("span",{className:"recharts-tooltip-item-value"},L),y.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:O},B)}return null},b=XE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=XE({margin:0},i),w=!lo(h),j=w?h:"",_=gs("recharts-default-tooltip",c),E=gs("recharts-tooltip-label",u);w&&p&&a!==void 0&&a!==null&&(j=p(h,a));var I=m?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",r8({className:_,style:b},I),y.createElement("p",{className:E,style:v},y.isValidElement(j)?j:"".concat(j)),g())},Py="recharts-tooltip-wrapper",qDe={visibility:"hidden"};function VDe(t){var{coordinate:e,translateX:r,translateY:n}=t;return gs(Py,{["".concat(Py,"-right")]:Tr(r)&&e&&Tr(e.x)&&r>=e.x,["".concat(Py,"-left")]:Tr(r)&&e&&Tr(e.x)&&r<e.x,["".concat(Py,"-bottom")]:Tr(n)&&e&&Tr(e.y)&&n>=e.y,["".concat(Py,"-top")]:Tr(n)&&e&&Tr(e.y)&&n<e.y})}function qq(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(a&&Tr(a[n]))return a[n];var h=r[n]-l-(i>0?i:0),p=r[n]+i;if(e[n])return o[n]?h:p;var m=c[n];if(m==null)return 0;if(o[n]){var g=h,b=m;return g<b?Math.max(p,m):Math.max(h,m)}if(u==null)return 0;var v=p+l,w=m+u;return v>w?Math.max(h,m):Math.max(p,m)}function HDe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function WDe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,h,p;return o.height>0&&o.width>0&&r?(h=qq({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),p=qq({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=HDe({translateX:h,translateY:p,useTranslate3d:l})):u=qDe,{cssProperties:u,cssClasses:VDe({translateX:h,translateY:p,coordinate:r})}}function Vq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vq(Object(r),!0).forEach(function(n){n8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function n8(t,e,r){return(e=GDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GDe(t){var e=KDe(t,"string");return typeof e=="symbol"?e:e+""}function KDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YDe extends y.PureComponent{constructor(){super(...arguments),n8(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),n8(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:h,reverseDirection:p,useTranslate3d:m,viewBox:g,wrapperStyle:b,lastBoundingBox:v,innerRef:w,hasPortalFromProps:j}=this.props,{cssClasses:_,cssProperties:E}=WDe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:h,reverseDirection:p,tooltipBox:{height:v.height,width:v.width},useTranslate3d:m,viewBox:g}),I=j?{}:_5(_5({transition:c&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),O=_5(_5({},I),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},b);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:O,ref:w},a)}}var Sne=()=>{var t;return(t=kr(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function s8(){return s8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s8.apply(null,arguments)}function Hq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Wq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hq(Object(r),!0).forEach(function(n){XDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XDe(t,e,r){return(e=QDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QDe(t){var e=JDe(t,"string");return typeof e=="symbol"?e:e+""}function JDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gq={curveBasisClosed:AOe,curveBasisOpen:TOe,curveBasis:EOe,curveBumpX:pOe,curveBumpY:mOe,curveLinearClosed:IOe,curveLinear:Mk,curveMonotoneX:LOe,curveMonotoneY:POe,curveNatural:OOe,curveStep:ROe,curveStepAfter:DOe,curveStepBefore:MOe},Wj=t=>Ti(t.x)&&Ti(t.y),Kq=t=>t.base!=null&&Wj(t.base)&&Wj(t),Oy=t=>t.x,Ry=t=>t.y,ZDe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(o2(t));return(r==="curveMonotone"||r==="curveBump")&&e?Gq["".concat(r).concat(e==="vertical"?"Y":"X")]:Gq[r]||Mk},e9e=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,o=ZDe(e,i),l=a?r.filter(Wj):r,c;if(Array.isArray(n)){var u=r.map((g,b)=>Wq(Wq({},g),{},{base:n[b]}));i==="vertical"?c=x5().y(Ry).x1(Oy).x0(g=>g.base.x):c=x5().x(Oy).y1(Ry).y0(g=>g.base.y);var h=c.defined(Kq).curve(o),p=a?u.filter(Kq):u;return h(p)}i==="vertical"&&Tr(n)?c=x5().y(Ry).x1(Oy).x0(n):Tr(n)?c=x5().x(Oy).y1(Ry).y0(n):c=ere().x(Oy).y(Ry);var m=c.defined(Wj).curve(o);return m(l)},vP=t=>{var{className:e,points:r,path:n,pathRef:i}=t,a=p2();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||a,connectNulls:t.connectNulls},l=r&&r.length?e9e(o):n;return y.createElement("path",s8({},qd(t),lRe(t),{className:gs("recharts-curve",e),d:l===null?void 0:l,ref:i}))},t9e=["x","y","top","left","width","height","className"];function i8(){return i8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},i8.apply(null,arguments)}function Yq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function r9e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yq(Object(r),!0).forEach(function(n){n9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function n9e(t,e,r){return(e=s9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s9e(t){var e=i9e(t,"string");return typeof e=="symbol"?e:e+""}function i9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a9e(t,e){if(t==null)return{};var r,n,i=o9e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function o9e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var l9e=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),c9e=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:o=0,className:l}=t,c=a9e(t,t9e),u=r9e({x:e,y:r,top:n,left:i,width:a,height:o},c);return!Tr(e)||!Tr(r)||!Tr(a)||!Tr(o)||!Tr(n)||!Tr(i)?null:y.createElement("path",i8({},iu(u),{className:gs("recharts-cross",l),d:l9e(e,r,a,o,n,i)}))};function u9e(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Xq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Qq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xq(Object(r),!0).forEach(function(n){d9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function d9e(t,e,r){return(e=h9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h9e(t){var e=f9e(t,"string");return typeof e=="symbol"?e:e+""}function f9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var p9e=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),Cne=(t,e,r)=>t.map(n=>"".concat(p9e(n)," ").concat(e,"ms ").concat(r)).join(","),m9e=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),w1=(t,e)=>Object.keys(e).reduce((r,n)=>Qq(Qq({},r),{},{[n]:t(n,e[n])}),{});function Jq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ma(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jq(Object(r),!0).forEach(function(n){g9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g9e(t,e,r){return(e=x9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x9e(t){var e=b9e(t,"string");return typeof e=="symbol"?e:e+""}function b9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gj=(t,e,r)=>t+(e-t)*r,a8=t=>{var{from:e,to:r}=t;return e!==r},Ene=(t,e,r)=>{var n=w1((i,a)=>{if(a8(a)){var[o,l]=t(a.from,a.to,a.velocity);return Ma(Ma({},a),{},{from:o,velocity:l})}return a},e);return r<1?w1((i,a)=>a8(a)&&n[i]!=null?Ma(Ma({},a),{},{velocity:Gj(a.velocity,n[i].velocity,r),from:Gj(a.from,n[i].from,r)}):a,e):Ene(t,n,r-1)};function y9e(t,e,r,n,i,a){var o,l=n.reduce((m,g)=>Ma(Ma({},m),{},{[g]:{from:t[g],velocity:0,to:e[g]}}),{}),c=()=>w1((m,g)=>g.from,l),u=()=>!Object.values(l).filter(a8).length,h=null,p=m=>{o||(o=m);var g=m-o,b=g/r.dt;l=Ene(r,l,b),i(Ma(Ma(Ma({},t),e),c())),o=m,u()||(h=a.setTimeout(p))};return()=>(h=a.setTimeout(p),()=>{var m;(m=h)===null||m===void 0||m()})}function v9e(t,e,r,n,i,a,o){var l=null,c=i.reduce((p,m)=>{var g=t[m],b=e[m];return g==null||b==null?p:Ma(Ma({},p),{},{[m]:[g,b]})},{}),u,h=p=>{u||(u=p);var m=(p-u)/n,g=w1((v,w)=>Gj(...w,r(m)),c);if(a(Ma(Ma(Ma({},t),e),g)),m<1)l=o.setTimeout(h);else{var b=w1((v,w)=>Gj(...w,r(1)),c);a(Ma(Ma(Ma({},t),e),b))}};return()=>(l=o.setTimeout(h),()=>{var p;(p=l)===null||p===void 0||p()})}const w9e=(t,e,r,n,i,a)=>{var o=m9e(t,e);return r==null?()=>(i(Ma(Ma({},t),e)),()=>{}):r.isStepper===!0?y9e(t,e,r,o,i,a):v9e(t,e,r,n,o,i,a)};var Kj=1e-4,Ane=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Tne=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Zq=(t,e)=>r=>{var n=Ane(t,e);return Tne(n,r)},N9e=(t,e)=>r=>{var n=Ane(t,e),i=[...n.map((a,o)=>a*o).slice(1),0];return Tne(i,r)},j9e=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var i=n.map(a=>parseFloat(a));return[i[0],i[1],i[2],i[3]]},k9e=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=j9e(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},_9e=(t,e,r,n)=>{var i=Zq(t,r),a=Zq(e,n),o=N9e(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var h=u>1?1:u,p=h,m=0;m<8;++m){var g=i(p)-h,b=o(p);if(Math.abs(g-h)<Kj||b<Kj)return a(p);p=l(p-g/b)}return a(p)};return c.isStepper=!1,c},eV=function(){return _9e(...k9e(...arguments))},S9e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(o,l,c)=>{var u=-(o-l)*r,h=c*n,p=c+(u-h)*i/1e3,m=c*i/1e3+o;return Math.abs(m-l)<Kj&&Math.abs(p)<Kj?[l,0]:[m,p]};return a.isStepper=!0,a.dt=i,a},C9e=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return eV(t);case"spring":return S9e();default:if(t.split("(")[0]==="cubic-bezier")return eV(t)}return typeof t=="function"?t:null};function E9e(t){var e,r=()=>null,n=!1,i=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=t.setTimeout(a.bind(null,u),c);return}a(c),i=t.setTimeout(a.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),a(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class A9e{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{i!=null&&cancelAnimationFrame(i)}}}function T9e(){return E9e(new A9e)}var I9e=y.createContext(T9e);function L9e(t,e){var r=y.useContext(I9e);return y.useMemo(()=>e??r(t),[t,e,r])}var P9e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),n_={isSsr:P9e()},O9e={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},tV={t:0},QE={t:1};function s_(t){var e=Do(t,O9e),{isActive:r,canBegin:n,duration:i,easing:a,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,h=r==="auto"?!n_.isSsr:r,p=L9e(e.animationId,e.animationManager),[m,g]=y.useState(h?tV:QE),b=y.useRef(null);return y.useEffect(()=>{h||g(QE)},[h]),y.useEffect(()=>{if(!h||!n)return l2;var v=w9e(tV,QE,C9e(a),i,g,p.getTimeoutController()),w=()=>{b.current=v()};return p.start([c,o,w,i,l]),()=>{p.stop(),b.current&&b.current(),l()}},[h,n,i,a,o,c,l,p]),u(m.t)}function i_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=y.useRef(p1(e)),n=y.useRef(t);return n.current!==t&&(r.current=p1(e),n.current=t),r.current}var R9e=["radius"],M9e=["radius"],rV,nV,sV,iV,aV,oV,lV,cV,uV,dV;function hV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function fV(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hV(Object(r),!0).forEach(function(n){D9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function D9e(t,e,r){return(e=B9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B9e(t){var e=$9e(t,"string");return typeof e=="symbol"?e:e+""}function $9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yj(){return Yj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yj.apply(null,arguments)}function pV(t,e){if(t==null)return{};var r,n,i=F9e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function F9e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var mV=(t,e,r,n,i)=>{var a=v0(r),o=v0(n),l=Math.min(Math.abs(a)/2,Math.abs(o)/2),c=o>=0?1:-1,u=a>=0?1:-1,h=o>=0&&a>=0||o<0&&a<0?1:0,p;if(l>0&&i instanceof Array){for(var m=[0,0,0,0],g=0,b=4;g<b;g++)m[g]=i[g]>l?l:i[g];p=Hi(rV||(rV=bd(["M",",",""])),t,e+c*m[0]),m[0]>0&&(p+=Hi(nV||(nV=bd(["A ",",",",0,0,",",",",",""])),m[0],m[0],h,t+u*m[0],e)),p+=Hi(sV||(sV=bd(["L ",",",""])),t+r-u*m[1],e),m[1]>0&&(p+=Hi(iV||(iV=bd(["A ",",",",0,0,",`,
        `,",",""])),m[1],m[1],h,t+r,e+c*m[1])),p+=Hi(aV||(aV=bd(["L ",",",""])),t+r,e+n-c*m[2]),m[2]>0&&(p+=Hi(oV||(oV=bd(["A ",",",",0,0,",`,
        `,",",""])),m[2],m[2],h,t+r-u*m[2],e+n)),p+=Hi(lV||(lV=bd(["L ",",",""])),t+u*m[3],e+n),m[3]>0&&(p+=Hi(cV||(cV=bd(["A ",",",",0,0,",`,
        `,",",""])),m[3],m[3],h,t,e+n-c*m[3])),p+="Z"}else if(l>0&&i===+i&&i>0){var v=Math.min(l,i);p=Hi(uV||(uV=bd(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*v,v,v,h,t+u*v,e,t+r-u*v,e,v,v,h,t+r,e+c*v,t+r,e+n-c*v,v,v,h,t+r-u*v,e+n,t+u*v,e+n,v,v,h,t,e+n-c*v)}else p=Hi(dV||(dV=bd(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return p},gV={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ine=t=>{var e=Do(t,gV),r=y.useRef(null),[n,i]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var J=r.current.getTotalLength();J&&i(J)}catch{}},[]);var{x:a,y:o,width:l,height:c,radius:u,className:h}=e,{animationEasing:p,animationDuration:m,animationBegin:g,isAnimationActive:b,isUpdateAnimationActive:v}=e,w=y.useRef(l),j=y.useRef(c),_=y.useRef(a),E=y.useRef(o),I=y.useMemo(()=>({x:a,y:o,width:l,height:c,radius:u}),[a,o,l,c,u]),O=i_(I,"rectangle-");if(a!==+a||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var B=gs("recharts-rectangle",h);if(!v){var S=iu(e),{radius:T}=S,M=pV(S,R9e);return y.createElement("path",Yj({},M,{x:v0(a),y:v0(o),width:v0(l),height:v0(c),radius:typeof u=="number"?u:void 0,className:B,d:mV(a,o,l,c,u)}))}var $=w.current,k=j.current,L=_.current,R=E.current,V="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),X=Cne(["strokeDasharray"],m,typeof p=="string"?p:gV.animationEasing);return y.createElement(s_,{animationId:O,key:O,canBegin:n>0,duration:m,easing:p,isActive:v,begin:g},J=>{var re=Ra($,l,J),se=Ra(k,c,J),ee=Ra(L,a,J),q=Ra(R,o,J);r.current&&(w.current=re,j.current=se,_.current=ee,E.current=q);var U;b?J>0?U={transition:X,strokeDasharray:Y}:U={strokeDasharray:V}:U={strokeDasharray:Y};var W=iu(e),{radius:Z}=W,de=pV(W,M9e);return y.createElement("path",Yj({},de,{radius:typeof u=="number"?u:void 0,className:B,d:mV(ee,q,re,se,u),ref:r,style:fV(fV({},U),e.style)}))})};function xV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bV(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xV(Object(r),!0).forEach(function(n){U9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U9e(t,e,r){return(e=z9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z9e(t){var e=q9e(t,"string");return typeof e=="symbol"?e:e+""}function q9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xj=Math.PI/180,V9e=t=>t*180/Math.PI,ya=(t,e,r,n)=>({x:t+Math.cos(-Xj*n)*r,y:e+Math.sin(-Xj*n)*r}),Lne=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},H9e=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},W9e=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,o=H9e({x:r,y:n},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>a&&(c=2*Math.PI-c),{radius:o,angle:V9e(c),angleInRadian:c}},G9e=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},K9e=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return t+o*360},Y9e=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:i,angle:a}=W9e({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=G9e(e),h=a,p;if(c<=u){for(;h>u;)h-=360;for(;h<c;)h+=360;p=h>=c&&h<=u}else{for(;h>c;)h-=360;for(;h<u;)h+=360;p=h>=u&&h<=c}return p?bV(bV({},e),{},{radius:i,angle:K9e(h,e)}):null};function Pne(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,o=ya(e,r,n,i),l=ya(e,r,n,a);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}var yV,vV,wV,NV,jV,kV,_V;function o8(){return o8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},o8.apply(null,arguments)}function Mp(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var X9e=(t,e)=>{var r=Po(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},S5=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,h=Math.asin(l/u)/Xj,p=c?i:i+a*h,m=ya(e,r,u,p),g=ya(e,r,n,p),b=c?i-a*h:i,v=ya(e,r,u*Math.cos(h*Xj),b);return{center:m,circleTangency:g,lineTangency:v,theta:h}},One=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o}=t,l=X9e(a,o),c=a+l,u=ya(e,r,i,a),h=ya(e,r,i,c),p=Hi(yV||(yV=Mp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(a>c),h.x,h.y);if(n>0){var m=ya(e,r,n,a),g=ya(e,r,n,c);p+=Hi(vV||(vV=Mp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),g.x,g.y,n,n,+(Math.abs(l)>180),+(a<=c),m.x,m.y)}else p+=Hi(wV||(wV=Mp(["L ",","," Z"])),e,r);return p},Q9e=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,h=Po(u-c),{circleTangency:p,lineTangency:m,theta:g}=S5({cx:e,cy:r,radius:i,angle:c,sign:h,cornerRadius:a,cornerIsExternal:l}),{circleTangency:b,lineTangency:v,theta:w}=S5({cx:e,cy:r,radius:i,angle:u,sign:-h,cornerRadius:a,cornerIsExternal:l}),j=l?Math.abs(c-u):Math.abs(c-u)-g-w;if(j<0)return o?Hi(NV||(NV=Mp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),m.x,m.y,a,a,a*2,a,a,-a*2):One({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var _=Hi(jV||(jV=Mp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),m.x,m.y,a,a,+(h<0),p.x,p.y,i,i,+(j>180),+(h<0),b.x,b.y,a,a,+(h<0),v.x,v.y);if(n>0){var{circleTangency:E,lineTangency:I,theta:O}=S5({cx:e,cy:r,radius:n,angle:c,sign:h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),{circleTangency:B,lineTangency:S,theta:T}=S5({cx:e,cy:r,radius:n,angle:u,sign:-h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-O-T;if(M<0&&a===0)return"".concat(_,"L").concat(e,",").concat(r,"Z");_+=Hi(kV||(kV=Mp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),S.x,S.y,a,a,+(h<0),B.x,B.y,n,n,+(M>180),+(h>0),E.x,E.y,a,a,+(h<0),I.x,I.y)}else _+=Hi(_V||(_V=Mp(["L",",","Z"])),e,r);return _},J9e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Rne=t=>{var e=Do(t,J9e),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h,className:p}=e;if(a<i||u===h)return null;var m=gs("recharts-sector",p),g=a-i,b=el(o,g,0,!0),v;return b>0&&Math.abs(u-h)<360?v=Q9e({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(b,g/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h}):v=One({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:u,endAngle:h}),y.createElement("path",o8({},iu(e),{className:m,d:v}))};function Z9e(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(pre(e)){if(t==="centric"){var{cx:n,cy:i,innerRadius:a,outerRadius:o,angle:l}=e,c=ya(n,i,a,l),u=ya(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Pne(e)}}var JE={},ZE={},e6={},SV;function eBe(){return SV||(SV=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sre();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(e6)),e6}var CV;function tBe(){return CV||(CV=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eBe();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(ZE)),ZE}var EV;function rBe(){return EV||(EV=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cre(),r=tBe();function n(i,a,o){o&&typeof o!="number"&&e.isIterateeCall(i,a,o)&&(a=o=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),o=o===void 0?i<a?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((a-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}t.range=n})(JE)),JE}var t6,AV;function nBe(){return AV||(AV=1,t6=rBe().range),t6}var sBe=nBe();const Mne=bl(sBe);function A0(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function iBe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function wP(t){let e,r,n;t.length!==2?(e=A0,r=(l,c)=>A0(t(l),c),n=(l,c)=>t(l)-c):(e=t===A0||t===iBe?t:aBe,r=t,n=t);function i(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const p=u+h>>>1;r(l[p],c)<0?u=p+1:h=p}while(u<h)}return u}function a(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const p=u+h>>>1;r(l[p],c)<=0?u=p+1:h=p}while(u<h)}return u}function o(l,c,u=0,h=l.length){const p=i(l,c,u,h-1);return p>u&&n(l[p-1],c)>-n(l[p],c)?p-1:p}return{left:i,center:o,right:a}}function aBe(){return 0}function Dne(t){return t===null?NaN:+t}function*oBe(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const lBe=wP(A0),g2=lBe.right;wP(Dne).center;class TV extends Map{constructor(e,r=dBe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(IV(this,e))}has(e){return super.has(IV(this,e))}set(e,r){return super.set(cBe(this,e),r)}delete(e){return super.delete(uBe(this,e))}}function IV({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function cBe({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function uBe({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function dBe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function hBe(t=A0){if(t===A0)return Bne;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function Bne(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const fBe=Math.sqrt(50),pBe=Math.sqrt(10),mBe=Math.sqrt(2);function Qj(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=fBe?10:a>=pBe?5:a>=mBe?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?Qj(t,e,r*2):[l,c,u]}function l8(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,o]=n?Qj(e,t,r):Qj(t,e,r);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(a-u)/-o;else for(let u=0;u<l;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function c8(t,e,r){return e=+e,t=+t,r=+r,Qj(t,e,r)[2]}function u8(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?c8(e,t,r):c8(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function LV(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function PV(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function $ne(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?Bne:hBe(i);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,h=Math.log(c),p=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*p*(c-p)/c)*(u-c/2<0?-1:1),g=Math.max(r,Math.floor(e-u*p/c+m)),b=Math.min(n,Math.floor(e+(c-u)*p/c+m));$ne(t,e,g,b,i)}const a=t[e];let o=r,l=n;for(My(t,r,e),i(t[n],a)>0&&My(t,r,n);o<l;){for(My(t,o,l),++o,--l;i(t[o],a)<0;)++o;for(;i(t[l],a)>0;)--l}i(t[r],a)===0?My(t,r,l):(++l,My(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function My(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function gBe(t,e,r){if(t=Float64Array.from(oBe(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return PV(t);if(e>=1)return LV(t);var n,i=(n-1)*e,a=Math.floor(i),o=LV($ne(t,a).subarray(0,a+1)),l=PV(t.subarray(a+1));return o+(l-o)*(i-a)}}function xBe(t,e,r=Dne){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),o=+r(t[a],a,t),l=+r(t[a+1],a+1,t);return o+(l-o)*(i-a)}}function bBe(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function lu(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function xf(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const d8=Symbol("implicit");function NP(){var t=new TV,e=[],r=[],n=d8;function i(a){let o=t.get(a);if(o===void 0){if(n!==d8)return n;t.set(a,o=e.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new TV;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return NP(e,r).unknown(n)},lu.apply(i,arguments),i}function jP(){var t=NP().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,o,l=!1,c=0,u=0,h=.5;delete t.unknown;function p(){var m=e().length,g=i<n,b=g?i:n,v=g?n:i;a=(v-b)/Math.max(1,m-c+u*2),l&&(a=Math.floor(a)),b+=(v-b-a*(m-c))*h,o=a*(1-c),l&&(b=Math.round(b),o=Math.round(o));var w=bBe(m).map(function(j){return b+a*j});return r(g?w.reverse():w)}return t.domain=function(m){return arguments.length?(e(m),p()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,p()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,l=!0,p()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(m){return arguments.length?(l=!!m,p()):l},t.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),p()):c},t.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),p()):c},t.paddingOuter=function(m){return arguments.length?(u=+m,p()):u},t.align=function(m){return arguments.length?(h=Math.max(0,Math.min(1,m)),p()):h},t.copy=function(){return jP(e(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(h)},lu.apply(p(),arguments)}function Fne(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Fne(e())},t}function yBe(){return Fne(jP.apply(null,arguments).paddingInner(1))}function kP(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Une(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function x2(){}var N1=.7,Jj=1/N1,Ix="\\s*([+-]?\\d+)\\s*",j1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Md="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vBe=/^#([0-9a-f]{3,8})$/,wBe=new RegExp(`^rgb\\(${Ix},${Ix},${Ix}\\)$`),NBe=new RegExp(`^rgb\\(${Md},${Md},${Md}\\)$`),jBe=new RegExp(`^rgba\\(${Ix},${Ix},${Ix},${j1}\\)$`),kBe=new RegExp(`^rgba\\(${Md},${Md},${Md},${j1}\\)$`),_Be=new RegExp(`^hsl\\(${j1},${Md},${Md}\\)$`),SBe=new RegExp(`^hsla\\(${j1},${Md},${Md},${j1}\\)$`),OV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kP(x2,k1,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:RV,formatHex:RV,formatHex8:CBe,formatHsl:EBe,formatRgb:MV,toString:MV});function RV(){return this.rgb().formatHex()}function CBe(){return this.rgb().formatHex8()}function EBe(){return zne(this).formatHsl()}function MV(){return this.rgb().formatRgb()}function k1(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=vBe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?DV(e):r===3?new Kl(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?C5(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?C5(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=wBe.exec(t))?new Kl(e[1],e[2],e[3],1):(e=NBe.exec(t))?new Kl(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=jBe.exec(t))?C5(e[1],e[2],e[3],e[4]):(e=kBe.exec(t))?C5(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=_Be.exec(t))?FV(e[1],e[2]/100,e[3]/100,1):(e=SBe.exec(t))?FV(e[1],e[2]/100,e[3]/100,e[4]):OV.hasOwnProperty(t)?DV(OV[t]):t==="transparent"?new Kl(NaN,NaN,NaN,0):null}function DV(t){return new Kl(t>>16&255,t>>8&255,t&255,1)}function C5(t,e,r,n){return n<=0&&(t=e=r=NaN),new Kl(t,e,r,n)}function ABe(t){return t instanceof x2||(t=k1(t)),t?(t=t.rgb(),new Kl(t.r,t.g,t.b,t.opacity)):new Kl}function h8(t,e,r,n){return arguments.length===1?ABe(t):new Kl(t,e,r,n??1)}function Kl(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}kP(Kl,h8,Une(x2,{brighter(t){return t=t==null?Jj:Math.pow(Jj,t),new Kl(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?N1:Math.pow(N1,t),new Kl(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Kl(Gp(this.r),Gp(this.g),Gp(this.b),Zj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:BV,formatHex:BV,formatHex8:TBe,formatRgb:$V,toString:$V}));function BV(){return`#${Dp(this.r)}${Dp(this.g)}${Dp(this.b)}`}function TBe(){return`#${Dp(this.r)}${Dp(this.g)}${Dp(this.b)}${Dp((isNaN(this.opacity)?1:this.opacity)*255)}`}function $V(){const t=Zj(this.opacity);return`${t===1?"rgb(":"rgba("}${Gp(this.r)}, ${Gp(this.g)}, ${Gp(this.b)}${t===1?")":`, ${t})`}`}function Zj(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Gp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Dp(t){return t=Gp(t),(t<16?"0":"")+t.toString(16)}function FV(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Pu(t,e,r,n)}function zne(t){if(t instanceof Pu)return new Pu(t.h,t.s,t.l,t.opacity);if(t instanceof x2||(t=k1(t)),!t)return new Pu;if(t instanceof Pu)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),o=NaN,l=a-i,c=(a+i)/2;return l?(e===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new Pu(o,l,c,t.opacity)}function IBe(t,e,r,n){return arguments.length===1?zne(t):new Pu(t,e,r,n??1)}function Pu(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}kP(Pu,IBe,Une(x2,{brighter(t){return t=t==null?Jj:Math.pow(Jj,t),new Pu(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?N1:Math.pow(N1,t),new Pu(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Kl(r6(t>=240?t-240:t+120,i,n),r6(t,i,n),r6(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Pu(UV(this.h),E5(this.s),E5(this.l),Zj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Zj(this.opacity);return`${t===1?"hsl(":"hsla("}${UV(this.h)}, ${E5(this.s)*100}%, ${E5(this.l)*100}%${t===1?")":`, ${t})`}`}}));function UV(t){return t=(t||0)%360,t<0?t+360:t}function E5(t){return Math.max(0,Math.min(1,t||0))}function r6(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const _P=t=>()=>t;function LBe(t,e){return function(r){return t+r*e}}function PBe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function OBe(t){return(t=+t)==1?qne:function(e,r){return r-e?PBe(e,r,t):_P(isNaN(e)?r:e)}}function qne(t,e){var r=e-t;return r?LBe(t,r):_P(isNaN(t)?e:t)}const zV=(function t(e){var r=OBe(e);function n(i,a){var o=r((i=h8(i)).r,(a=h8(a)).r),l=r(i.g,a.g),c=r(i.b,a.b),u=qne(i.opacity,a.opacity);return function(h){return i.r=o(h),i.g=l(h),i.b=c(h),i.opacity=u(h),i+""}}return n.gamma=t,n})(1);function RBe(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function MBe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function DBe(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=jb(t[o],e[o]);for(;o<r;++o)a[o]=e[o];return function(l){for(o=0;o<n;++o)a[o]=i[o](l);return a}}function BBe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function e4(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function $Be(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=jb(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var f8=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,n6=new RegExp(f8.source,"g");function FBe(t){return function(){return t}}function UBe(t){return function(e){return t(e)+""}}function zBe(t,e){var r=f8.lastIndex=n6.lastIndex=0,n,i,a,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=f8.exec(t))&&(i=n6.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:e4(n,i)})),r=n6.lastIndex;return r<e.length&&(a=e.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?UBe(c[0].x):FBe(e):(e=c.length,function(u){for(var h=0,p;h<e;++h)l[(p=c[h]).i]=p.x(u);return l.join("")})}function jb(t,e){var r=typeof e,n;return e==null||r==="boolean"?_P(e):(r==="number"?e4:r==="string"?(n=k1(e))?(e=n,zV):zBe:e instanceof k1?zV:e instanceof Date?BBe:MBe(e)?RBe:Array.isArray(e)?DBe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?$Be:e4)(t,e)}function SP(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function qBe(t,e){e===void 0&&(e=t,t=jb);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[l](o-l)}}function VBe(t){return function(){return t}}function t4(t){return+t}var qV=[0,1];function hl(t){return t}function p8(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:VBe(isNaN(e)?NaN:.5)}function HBe(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function WBe(t,e,r){var n=t[0],i=t[1],a=e[0],o=e[1];return i<n?(n=p8(i,n),a=r(o,a)):(n=p8(n,i),a=r(a,o)),function(l){return a(n(l))}}function GBe(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=p8(t[o],t[o+1]),a[o]=r(e[o],e[o+1]);return function(l){var c=g2(t,l,1,n)-1;return a[c](i[c](l))}}function b2(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function a_(){var t=qV,e=qV,r=jb,n,i,a,o=hl,l,c,u;function h(){var m=Math.min(t.length,e.length);return o!==hl&&(o=HBe(t[0],t[m-1])),l=m>2?GBe:WBe,c=u=null,p}function p(m){return m==null||isNaN(m=+m)?a:(c||(c=l(t.map(n),e,r)))(n(o(m)))}return p.invert=function(m){return o(i((u||(u=l(e,t.map(n),e4)))(m)))},p.domain=function(m){return arguments.length?(t=Array.from(m,t4),h()):t.slice()},p.range=function(m){return arguments.length?(e=Array.from(m),h()):e.slice()},p.rangeRound=function(m){return e=Array.from(m),r=SP,h()},p.clamp=function(m){return arguments.length?(o=m?!0:hl,h()):o!==hl},p.interpolate=function(m){return arguments.length?(r=m,h()):r},p.unknown=function(m){return arguments.length?(a=m,p):a},function(m,g){return n=m,i=g,h()}}function CP(){return a_()(hl,hl)}function KBe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function r4(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function tb(t){return t=r4(Math.abs(t)),t?t[1]:NaN}function YBe(t,e){return function(r,n){for(var i=r.length,a=[],o=0,l=t[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return a.reverse().join(e)}}function XBe(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var QBe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _1(t){if(!(e=QBe.exec(t)))throw new Error("invalid format: "+t);var e;return new EP({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}_1.prototype=EP.prototype;function EP(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}EP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function JBe(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var Vne;function ZBe(t,e){var r=r4(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(Vne=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+r4(t,Math.max(0,e+a-1))[0]}function VV(t,e){var r=r4(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const HV={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:KBe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>VV(t*100,e),r:VV,s:ZBe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function WV(t){return t}var GV=Array.prototype.map,KV=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function e$e(t){var e=t.grouping===void 0||t.thousands===void 0?WV:YBe(GV.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?WV:XBe(GV.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(p){p=_1(p);var m=p.fill,g=p.align,b=p.sign,v=p.symbol,w=p.zero,j=p.width,_=p.comma,E=p.precision,I=p.trim,O=p.type;O==="n"?(_=!0,O="g"):HV[O]||(E===void 0&&(E=12),I=!0,O="g"),(w||m==="0"&&g==="=")&&(w=!0,m="0",g="=");var B=v==="$"?r:v==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",S=v==="$"?n:/[%p]/.test(O)?o:"",T=HV[O],M=/[defgprs%]/.test(O);E=E===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function $(k){var L=B,R=S,V,Y,X;if(O==="c")R=T(k)+R,k="";else{k=+k;var J=k<0||1/k<0;if(k=isNaN(k)?c:T(Math.abs(k),E),I&&(k=JBe(k)),J&&+k==0&&b!=="+"&&(J=!1),L=(J?b==="("?b:l:b==="-"||b==="("?"":b)+L,R=(O==="s"?KV[8+Vne/3]:"")+R+(J&&b==="("?")":""),M){for(V=-1,Y=k.length;++V<Y;)if(X=k.charCodeAt(V),48>X||X>57){R=(X===46?i+k.slice(V+1):k.slice(V))+R,k=k.slice(0,V);break}}}_&&!w&&(k=e(k,1/0));var re=L.length+k.length+R.length,se=re<j?new Array(j-re+1).join(m):"";switch(_&&w&&(k=e(se+k,se.length?j-R.length:1/0),se=""),g){case"<":k=L+k+R+se;break;case"=":k=L+se+k+R;break;case"^":k=se.slice(0,re=se.length>>1)+L+k+R+se.slice(re);break;default:k=se+L+k+R;break}return a(k)}return $.toString=function(){return p+""},$}function h(p,m){var g=u((p=_1(p),p.type="f",p)),b=Math.max(-8,Math.min(8,Math.floor(tb(m)/3)))*3,v=Math.pow(10,-b),w=KV[8+b/3];return function(j){return g(v*j)+w}}return{format:u,formatPrefix:h}}var A5,AP,Hne;t$e({thousands:",",grouping:[3],currency:["$",""]});function t$e(t){return A5=e$e(t),AP=A5.format,Hne=A5.formatPrefix,A5}function r$e(t){return Math.max(0,-tb(Math.abs(t)))}function n$e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(tb(e)/3)))*3-tb(Math.abs(t)))}function s$e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,tb(e)-tb(t))+1}function Wne(t,e,r,n){var i=u8(t,e,r),a;switch(n=_1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=n$e(i,o))&&(n.precision=a),Hne(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=s$e(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=r$e(i))&&(n.precision=a-(n.type==="%")*2);break}}return AP(n)}function K0(t){var e=t.domain;return t.ticks=function(r){var n=e();return l8(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return Wne(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,o=n[i],l=n[a],c,u,h=10;for(l<o&&(u=o,o=l,l=u,u=i,i=a,a=u);h-- >0;){if(u=c8(o,l,r),u===c)return n[i]=o,n[a]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function Gne(){var t=CP();return t.copy=function(){return b2(t,Gne())},lu.apply(t,arguments),K0(t)}function Kne(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,t4),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return Kne(t).unknown(e)},t=arguments.length?Array.from(t,t4):[0,1],K0(r)}function Yne(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),t[r]=e.floor(i),t[n]=e.ceil(a),t}function YV(t){return Math.log(t)}function XV(t){return Math.exp(t)}function i$e(t){return-Math.log(-t)}function a$e(t){return-Math.exp(-t)}function o$e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function l$e(t){return t===10?o$e:t===Math.E?Math.exp:e=>Math.pow(t,e)}function c$e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function QV(t){return(e,r)=>-t(-e,r)}function TP(t){const e=t(YV,XV),r=e.domain;let n=10,i,a;function o(){return i=c$e(n),a=l$e(n),r()[0]<0?(i=QV(i),a=QV(a),t(i$e,a$e)):t(YV,XV),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],h=c[c.length-1];const p=h<u;p&&([u,h]=[h,u]);let m=i(u),g=i(h),b,v;const w=l==null?10:+l;let j=[];if(!(n%1)&&g-m<w){if(m=Math.floor(m),g=Math.ceil(g),u>0){for(;m<=g;++m)for(b=1;b<n;++b)if(v=m<0?b/a(-m):b*a(m),!(v<u)){if(v>h)break;j.push(v)}}else for(;m<=g;++m)for(b=n-1;b>=1;--b)if(v=m>0?b/a(-m):b*a(m),!(v<u)){if(v>h)break;j.push(v)}j.length*2<w&&(j=l8(u,h,w))}else j=l8(m,g,Math.min(g-m,w)).map(a);return p?j.reverse():j},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=_1(c)).precision==null&&(c.trim=!0),c=AP(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return h=>{let p=h/a(Math.round(i(h)));return p*n<n-.5&&(p*=n),p<=u?c(h):""}},e.nice=()=>r(Yne(r(),{floor:l=>a(Math.floor(i(l))),ceil:l=>a(Math.ceil(i(l)))})),e}function Xne(){const t=TP(a_()).domain([1,10]);return t.copy=()=>b2(t,Xne()).base(t.base()),lu.apply(t,arguments),t}function JV(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function ZV(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function IP(t){var e=1,r=t(JV(e),ZV(e));return r.constant=function(n){return arguments.length?t(JV(e=+n),ZV(e)):e},K0(r)}function Qne(){var t=IP(a_());return t.copy=function(){return b2(t,Qne()).constant(t.constant())},lu.apply(t,arguments)}function eH(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function u$e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function d$e(t){return t<0?-t*t:t*t}function LP(t){var e=t(hl,hl),r=1;function n(){return r===1?t(hl,hl):r===.5?t(u$e,d$e):t(eH(r),eH(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},K0(e)}function PP(){var t=LP(a_());return t.copy=function(){return b2(t,PP()).exponent(t.exponent())},lu.apply(t,arguments),t}function h$e(){return PP.apply(null,arguments).exponent(.5)}function tH(t){return Math.sign(t)*t*t}function f$e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Jne(){var t=CP(),e=[0,1],r=!1,n;function i(a){var o=f$e(t(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return t.invert(tH(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,t4)).map(tH)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Jne(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},lu.apply(i,arguments),K0(i)}function Zne(){var t=[],e=[],r=[],n;function i(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=xBe(t,o/l);return a}function a(o){return o==null||isNaN(o=+o)?n:e[g2(r,o)]}return a.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(A0),i()},a.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return Zne().domain(t).range(e).unknown(n)},lu.apply(a,arguments)}function ese(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function o(c){return c!=null&&c<=c?i[g2(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return ese().domain([t,e]).range(i).unknown(a)},lu.apply(K0(o),arguments)}function tse(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[g2(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return tse().domain(t).range(e).unknown(r)},lu.apply(i,arguments)}const s6=new Date,i6=new Date;function qa(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const o=i(a),l=i.ceil(a);return a-o<l-a?o:l},i.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,l)=>{const c=[];if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<o)||!(l>0))return c;let u;do c.push(u=new Date(+a)),e(a,l),t(a);while(u<a&&a<o);return c},i.filter=a=>qa(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!a(o););else for(;--l>=0;)for(;e(o,1),!a(o););}),r&&(i.count=(a,o)=>(s6.setTime(+a),i6.setTime(+o),t(s6),t(i6),Math.floor(r(s6,i6))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const n4=qa(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);n4.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?qa(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):n4);n4.range;const Dh=1e3,tu=Dh*60,Bh=tu*60,tf=Bh*24,OP=tf*7,rH=tf*30,a6=tf*365,Bp=qa(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Dh)},(t,e)=>(e-t)/Dh,t=>t.getUTCSeconds());Bp.range;const RP=qa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dh)},(t,e)=>{t.setTime(+t+e*tu)},(t,e)=>(e-t)/tu,t=>t.getMinutes());RP.range;const MP=qa(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*tu)},(t,e)=>(e-t)/tu,t=>t.getUTCMinutes());MP.range;const DP=qa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dh-t.getMinutes()*tu)},(t,e)=>{t.setTime(+t+e*Bh)},(t,e)=>(e-t)/Bh,t=>t.getHours());DP.range;const BP=qa(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Bh)},(t,e)=>(e-t)/Bh,t=>t.getUTCHours());BP.range;const y2=qa(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*tu)/tf,t=>t.getDate()-1);y2.range;const o_=qa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/tf,t=>t.getUTCDate()-1);o_.range;const rse=qa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/tf,t=>Math.floor(t/tf));rse.range;function Wm(t){return qa(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*tu)/OP)}const l_=Wm(0),s4=Wm(1),p$e=Wm(2),m$e=Wm(3),rb=Wm(4),g$e=Wm(5),x$e=Wm(6);l_.range;s4.range;p$e.range;m$e.range;rb.range;g$e.range;x$e.range;function Gm(t){return qa(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/OP)}const c_=Gm(0),i4=Gm(1),b$e=Gm(2),y$e=Gm(3),nb=Gm(4),v$e=Gm(5),w$e=Gm(6);c_.range;i4.range;b$e.range;y$e.range;nb.range;v$e.range;w$e.range;const $P=qa(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());$P.range;const FP=qa(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());FP.range;const rf=qa(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());rf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:qa(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});rf.range;const nf=qa(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());nf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:qa(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});nf.range;function nse(t,e,r,n,i,a){const o=[[Bp,1,Dh],[Bp,5,5*Dh],[Bp,15,15*Dh],[Bp,30,30*Dh],[a,1,tu],[a,5,5*tu],[a,15,15*tu],[a,30,30*tu],[i,1,Bh],[i,3,3*Bh],[i,6,6*Bh],[i,12,12*Bh],[n,1,tf],[n,2,2*tf],[r,1,OP],[e,1,rH],[e,3,3*rH],[t,1,a6]];function l(u,h,p){const m=h<u;m&&([u,h]=[h,u]);const g=p&&typeof p.range=="function"?p:c(u,h,p),b=g?g.range(u,+h+1):[];return m?b.reverse():b}function c(u,h,p){const m=Math.abs(h-u)/p,g=wP(([,,w])=>w).right(o,m);if(g===o.length)return t.every(u8(u/a6,h/a6,p));if(g===0)return n4.every(Math.max(u8(u,h,p),1));const[b,v]=o[m/o[g-1][2]<o[g][2]/m?g-1:g];return b.every(v)}return[l,c]}const[N$e,j$e]=nse(nf,FP,c_,rse,BP,MP),[k$e,_$e]=nse(rf,$P,l_,y2,DP,RP);function o6(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function l6(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Dy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function S$e(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=By(i),h=$y(i),p=By(a),m=$y(a),g=By(o),b=$y(o),v=By(l),w=$y(l),j=By(c),_=$y(c),E={a:J,A:re,b:se,B:ee,c:null,d:lH,e:lH,f:Y$e,g:iFe,G:oFe,H:W$e,I:G$e,j:K$e,L:sse,m:X$e,M:Q$e,p:q,q:U,Q:dH,s:hH,S:J$e,u:Z$e,U:eFe,V:tFe,w:rFe,W:nFe,x:null,X:null,y:sFe,Y:aFe,Z:lFe,"%":uH},I={a:W,A:Z,b:de,B:be,c:null,d:cH,e:cH,f:hFe,g:NFe,G:kFe,H:cFe,I:uFe,j:dFe,L:ase,m:fFe,M:pFe,p:oe,q:ne,Q:dH,s:hH,S:mFe,u:gFe,U:xFe,V:bFe,w:yFe,W:vFe,x:null,X:null,y:wFe,Y:jFe,Z:_Fe,"%":uH},O={a:$,A:k,b:L,B:R,c:V,d:aH,e:aH,f:z$e,g:iH,G:sH,H:oH,I:oH,j:B$e,L:U$e,m:D$e,M:$$e,p:M,q:M$e,Q:V$e,s:H$e,S:F$e,u:I$e,U:L$e,V:P$e,w:T$e,W:O$e,x:Y,X,y:iH,Y:sH,Z:R$e,"%":q$e};E.x=B(r,E),E.X=B(n,E),E.c=B(e,E),I.x=B(r,I),I.X=B(n,I),I.c=B(e,I);function B(H,le){return function(ye){var me=[],ke=-1,Ie=0,ce=H.length,Be,ct,Ve;for(ye instanceof Date||(ye=new Date(+ye));++ke<ce;)H.charCodeAt(ke)===37&&(me.push(H.slice(Ie,ke)),(ct=nH[Be=H.charAt(++ke)])!=null?Be=H.charAt(++ke):ct=Be==="e"?" ":"0",(Ve=le[Be])&&(Be=Ve(ye,ct)),me.push(Be),Ie=ke+1);return me.push(H.slice(Ie,ke)),me.join("")}}function S(H,le){return function(ye){var me=Dy(1900,void 0,1),ke=T(me,H,ye+="",0),Ie,ce;if(ke!=ye.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if(le&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(Ie=l6(Dy(me.y,0,1)),ce=Ie.getUTCDay(),Ie=ce>4||ce===0?i4.ceil(Ie):i4(Ie),Ie=o_.offset(Ie,(me.V-1)*7),me.y=Ie.getUTCFullYear(),me.m=Ie.getUTCMonth(),me.d=Ie.getUTCDate()+(me.w+6)%7):(Ie=o6(Dy(me.y,0,1)),ce=Ie.getDay(),Ie=ce>4||ce===0?s4.ceil(Ie):s4(Ie),Ie=y2.offset(Ie,(me.V-1)*7),me.y=Ie.getFullYear(),me.m=Ie.getMonth(),me.d=Ie.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),ce="Z"in me?l6(Dy(me.y,0,1)).getUTCDay():o6(Dy(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(ce+5)%7:me.w+me.U*7-(ce+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,l6(me)):o6(me)}}function T(H,le,ye,me){for(var ke=0,Ie=le.length,ce=ye.length,Be,ct;ke<Ie;){if(me>=ce)return-1;if(Be=le.charCodeAt(ke++),Be===37){if(Be=le.charAt(ke++),ct=O[Be in nH?le.charAt(ke++):Be],!ct||(me=ct(H,ye,me))<0)return-1}else if(Be!=ye.charCodeAt(me++))return-1}return me}function M(H,le,ye){var me=u.exec(le.slice(ye));return me?(H.p=h.get(me[0].toLowerCase()),ye+me[0].length):-1}function $(H,le,ye){var me=g.exec(le.slice(ye));return me?(H.w=b.get(me[0].toLowerCase()),ye+me[0].length):-1}function k(H,le,ye){var me=p.exec(le.slice(ye));return me?(H.w=m.get(me[0].toLowerCase()),ye+me[0].length):-1}function L(H,le,ye){var me=j.exec(le.slice(ye));return me?(H.m=_.get(me[0].toLowerCase()),ye+me[0].length):-1}function R(H,le,ye){var me=v.exec(le.slice(ye));return me?(H.m=w.get(me[0].toLowerCase()),ye+me[0].length):-1}function V(H,le,ye){return T(H,e,le,ye)}function Y(H,le,ye){return T(H,r,le,ye)}function X(H,le,ye){return T(H,n,le,ye)}function J(H){return o[H.getDay()]}function re(H){return a[H.getDay()]}function se(H){return c[H.getMonth()]}function ee(H){return l[H.getMonth()]}function q(H){return i[+(H.getHours()>=12)]}function U(H){return 1+~~(H.getMonth()/3)}function W(H){return o[H.getUTCDay()]}function Z(H){return a[H.getUTCDay()]}function de(H){return c[H.getUTCMonth()]}function be(H){return l[H.getUTCMonth()]}function oe(H){return i[+(H.getUTCHours()>=12)]}function ne(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var le=B(H+="",E);return le.toString=function(){return H},le},parse:function(H){var le=S(H+="",!1);return le.toString=function(){return H},le},utcFormat:function(H){var le=B(H+="",I);return le.toString=function(){return H},le},utcParse:function(H){var le=S(H+="",!0);return le.toString=function(){return H},le}}}var nH={"-":"",_:" ",0:"0"},uo=/^\s*\d+/,C$e=/^%/,E$e=/[\\^$*+?|[\]().{}]/g;function Xn(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function A$e(t){return t.replace(E$e,"\\$&")}function By(t){return new RegExp("^(?:"+t.map(A$e).join("|")+")","i")}function $y(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function T$e(t,e,r){var n=uo.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function I$e(t,e,r){var n=uo.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function L$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function P$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function O$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function sH(t,e,r){var n=uo.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function iH(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function R$e(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function M$e(t,e,r){var n=uo.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function D$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function aH(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function B$e(t,e,r){var n=uo.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function oH(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function $$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function F$e(t,e,r){var n=uo.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function U$e(t,e,r){var n=uo.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function z$e(t,e,r){var n=uo.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function q$e(t,e,r){var n=C$e.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function V$e(t,e,r){var n=uo.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function H$e(t,e,r){var n=uo.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function lH(t,e){return Xn(t.getDate(),e,2)}function W$e(t,e){return Xn(t.getHours(),e,2)}function G$e(t,e){return Xn(t.getHours()%12||12,e,2)}function K$e(t,e){return Xn(1+y2.count(rf(t),t),e,3)}function sse(t,e){return Xn(t.getMilliseconds(),e,3)}function Y$e(t,e){return sse(t,e)+"000"}function X$e(t,e){return Xn(t.getMonth()+1,e,2)}function Q$e(t,e){return Xn(t.getMinutes(),e,2)}function J$e(t,e){return Xn(t.getSeconds(),e,2)}function Z$e(t){var e=t.getDay();return e===0?7:e}function eFe(t,e){return Xn(l_.count(rf(t)-1,t),e,2)}function ise(t){var e=t.getDay();return e>=4||e===0?rb(t):rb.ceil(t)}function tFe(t,e){return t=ise(t),Xn(rb.count(rf(t),t)+(rf(t).getDay()===4),e,2)}function rFe(t){return t.getDay()}function nFe(t,e){return Xn(s4.count(rf(t)-1,t),e,2)}function sFe(t,e){return Xn(t.getFullYear()%100,e,2)}function iFe(t,e){return t=ise(t),Xn(t.getFullYear()%100,e,2)}function aFe(t,e){return Xn(t.getFullYear()%1e4,e,4)}function oFe(t,e){var r=t.getDay();return t=r>=4||r===0?rb(t):rb.ceil(t),Xn(t.getFullYear()%1e4,e,4)}function lFe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Xn(e/60|0,"0",2)+Xn(e%60,"0",2)}function cH(t,e){return Xn(t.getUTCDate(),e,2)}function cFe(t,e){return Xn(t.getUTCHours(),e,2)}function uFe(t,e){return Xn(t.getUTCHours()%12||12,e,2)}function dFe(t,e){return Xn(1+o_.count(nf(t),t),e,3)}function ase(t,e){return Xn(t.getUTCMilliseconds(),e,3)}function hFe(t,e){return ase(t,e)+"000"}function fFe(t,e){return Xn(t.getUTCMonth()+1,e,2)}function pFe(t,e){return Xn(t.getUTCMinutes(),e,2)}function mFe(t,e){return Xn(t.getUTCSeconds(),e,2)}function gFe(t){var e=t.getUTCDay();return e===0?7:e}function xFe(t,e){return Xn(c_.count(nf(t)-1,t),e,2)}function ose(t){var e=t.getUTCDay();return e>=4||e===0?nb(t):nb.ceil(t)}function bFe(t,e){return t=ose(t),Xn(nb.count(nf(t),t)+(nf(t).getUTCDay()===4),e,2)}function yFe(t){return t.getUTCDay()}function vFe(t,e){return Xn(i4.count(nf(t)-1,t),e,2)}function wFe(t,e){return Xn(t.getUTCFullYear()%100,e,2)}function NFe(t,e){return t=ose(t),Xn(t.getUTCFullYear()%100,e,2)}function jFe(t,e){return Xn(t.getUTCFullYear()%1e4,e,4)}function kFe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?nb(t):nb.ceil(t),Xn(t.getUTCFullYear()%1e4,e,4)}function _Fe(){return"+0000"}function uH(){return"%"}function dH(t){return+t}function hH(t){return Math.floor(+t/1e3)}var zg,lse,cse;SFe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function SFe(t){return zg=S$e(t),lse=zg.format,zg.parse,cse=zg.utcFormat,zg.utcParse,zg}function CFe(t){return new Date(t)}function EFe(t){return t instanceof Date?+t:+new Date(+t)}function UP(t,e,r,n,i,a,o,l,c,u){var h=CP(),p=h.invert,m=h.domain,g=u(".%L"),b=u(":%S"),v=u("%I:%M"),w=u("%I %p"),j=u("%a %d"),_=u("%b %d"),E=u("%B"),I=u("%Y");function O(B){return(c(B)<B?g:l(B)<B?b:o(B)<B?v:a(B)<B?w:n(B)<B?i(B)<B?j:_:r(B)<B?E:I)(B)}return h.invert=function(B){return new Date(p(B))},h.domain=function(B){return arguments.length?m(Array.from(B,EFe)):m().map(CFe)},h.ticks=function(B){var S=m();return t(S[0],S[S.length-1],B??10)},h.tickFormat=function(B,S){return S==null?O:u(S)},h.nice=function(B){var S=m();return(!B||typeof B.range!="function")&&(B=e(S[0],S[S.length-1],B??10)),B?m(Yne(S,B)):h},h.copy=function(){return b2(h,UP(t,e,r,n,i,a,o,l,c,u))},h}function AFe(){return lu.apply(UP(k$e,_$e,rf,$P,l_,y2,DP,RP,Bp,lse).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function TFe(){return lu.apply(UP(N$e,j$e,nf,FP,c_,o_,BP,MP,Bp,cse).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function u_(){var t=0,e=1,r,n,i,a,o=hl,l=!1,c;function u(p){return p==null||isNaN(p=+p)?c:o(i===0?.5:(p=(a(p)-r)*i,l?Math.max(0,Math.min(1,p)):p))}u.domain=function(p){return arguments.length?([t,e]=p,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(p){return arguments.length?(l=!!p,u):l},u.interpolator=function(p){return arguments.length?(o=p,u):o};function h(p){return function(m){var g,b;return arguments.length?([g,b]=m,o=p(g,b),u):[o(0),o(1)]}}return u.range=h(jb),u.rangeRound=h(SP),u.unknown=function(p){return arguments.length?(c=p,u):c},function(p){return a=p,r=p(t),n=p(e),i=r===n?0:1/(n-r),u}}function Y0(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function use(){var t=K0(u_()(hl));return t.copy=function(){return Y0(t,use())},xf.apply(t,arguments)}function dse(){var t=TP(u_()).domain([1,10]);return t.copy=function(){return Y0(t,dse()).base(t.base())},xf.apply(t,arguments)}function hse(){var t=IP(u_());return t.copy=function(){return Y0(t,hse()).constant(t.constant())},xf.apply(t,arguments)}function zP(){var t=LP(u_());return t.copy=function(){return Y0(t,zP()).exponent(t.exponent())},xf.apply(t,arguments)}function IFe(){return zP.apply(null,arguments).exponent(.5)}function fse(){var t=[],e=hl;function r(n){if(n!=null&&!isNaN(n=+n))return e((g2(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(A0),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>gBe(t,a/n))},r.copy=function(){return fse(e).domain(t)},xf.apply(r,arguments)}function d_(){var t=0,e=.5,r=1,n=1,i,a,o,l,c,u=hl,h,p=!1,m;function g(v){return isNaN(v=+v)?m:(v=.5+((v=+h(v))-a)*(n*v<n*a?l:c),u(p?Math.max(0,Math.min(1,v)):v))}g.domain=function(v){return arguments.length?([t,e,r]=v,i=h(t=+t),a=h(e=+e),o=h(r=+r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,g):[t,e,r]},g.clamp=function(v){return arguments.length?(p=!!v,g):p},g.interpolator=function(v){return arguments.length?(u=v,g):u};function b(v){return function(w){var j,_,E;return arguments.length?([j,_,E]=w,u=qBe(v,[j,_,E]),g):[u(0),u(.5),u(1)]}}return g.range=b(jb),g.rangeRound=b(SP),g.unknown=function(v){return arguments.length?(m=v,g):m},function(v){return h=v,i=v(t),a=v(e),o=v(r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,g}}function pse(){var t=K0(d_()(hl));return t.copy=function(){return Y0(t,pse())},xf.apply(t,arguments)}function mse(){var t=TP(d_()).domain([.1,1,10]);return t.copy=function(){return Y0(t,mse()).base(t.base())},xf.apply(t,arguments)}function gse(){var t=IP(d_());return t.copy=function(){return Y0(t,gse()).constant(t.constant())},xf.apply(t,arguments)}function qP(){var t=LP(d_());return t.copy=function(){return Y0(t,qP()).exponent(t.exponent())},xf.apply(t,arguments)}function LFe(){return qP.apply(null,arguments).exponent(.5)}const nv=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:jP,scaleDiverging:pse,scaleDivergingLog:mse,scaleDivergingPow:qP,scaleDivergingSqrt:LFe,scaleDivergingSymlog:gse,scaleIdentity:Kne,scaleImplicit:d8,scaleLinear:Gne,scaleLog:Xne,scaleOrdinal:NP,scalePoint:yBe,scalePow:PP,scaleQuantile:Zne,scaleQuantize:ese,scaleRadial:Jne,scaleSequential:use,scaleSequentialLog:dse,scaleSequentialPow:zP,scaleSequentialQuantile:fse,scaleSequentialSqrt:IFe,scaleSequentialSymlog:hse,scaleSqrt:h$e,scaleSymlog:Qne,scaleThreshold:tse,scaleTime:AFe,scaleUtc:TFe,tickFormat:Wne},Symbol.toStringTag,{value:"Module"}));var bf=t=>t.chartData,h_=it([bf],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),xse=(t,e,r,n)=>n?h_(t):bf(t),PFe=(t,e,r)=>r?h_(t):bf(t);function B0(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Ti(e)&&Ti(r))return!0}return!1}function fH(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function bse(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(Ti(r))i=r;else if(typeof r=="function")return;if(Ti(n))a=n;else if(typeof n=="function")return;var o=[i,a];if(B0(o))return o}}function OFe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(B0(n))return fH(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,o,l;if(i==="auto")e!=null&&(o=Math.min(...e));else if(Tr(i))o=i;else if(typeof i=="function")try{e!=null&&(o=i(e?.[0]))}catch{}else if(typeof i=="string"&&Nq.test(i)){var c=Nq.exec(i);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e?.[0];if(a==="auto")e!=null&&(l=Math.max(...e));else if(Tr(a))l=a;else if(typeof a=="function")try{e!=null&&(l=a(e?.[1]))}catch{}else if(typeof a=="string"&&jq.test(a)){var h=jq.exec(a);if(h==null||h[1]==null||e==null)l=void 0;else{var p=+h[1];l=e[1]+p}}else l=e?.[1];var m=[o,l];if(B0(m))return e==null?m:fH(m,e,r)}}}var kb=1e9,RFe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},HP,bi=!0,ou="[DecimalError] ",Kp=ou+"Invalid argument: ",VP=ou+"Exponent out of range: ",_b=Math.floor,Np=Math.pow,MFe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,xc,no=1e7,ti=7,yse=9007199254740991,a4=_b(yse/ti),cr={};cr.absoluteValue=cr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};cr.comparedTo=cr.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};cr.decimalPlaces=cr.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*ti;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};cr.dividedBy=cr.div=function(t){return Hh(this,new this.constructor(t))};cr.dividedToIntegerBy=cr.idiv=function(t){var e=this,r=e.constructor;return Ds(Hh(e,new r(t),0,1),r.precision)};cr.equals=cr.eq=function(t){return!this.cmp(t)};cr.exponent=function(){return va(this)};cr.greaterThan=cr.gt=function(t){return this.cmp(t)>0};cr.greaterThanOrEqualTo=cr.gte=function(t){return this.cmp(t)>=0};cr.isInteger=cr.isint=function(){return this.e>this.d.length-2};cr.isNegative=cr.isneg=function(){return this.s<0};cr.isPositive=cr.ispos=function(){return this.s>0};cr.isZero=function(){return this.s===0};cr.lessThan=cr.lt=function(t){return this.cmp(t)<0};cr.lessThanOrEqualTo=cr.lte=function(t){return this.cmp(t)<1};cr.logarithm=cr.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(xc))throw Error(ou+"NaN");if(r.s<1)throw Error(ou+(r.s?"NaN":"-Infinity"));return r.eq(xc)?new n(0):(bi=!1,e=Hh(S1(r,a),S1(t,a),a),bi=!0,Ds(e,i))};cr.minus=cr.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Nse(e,t):vse(e,(t.s=-t.s,t))};cr.modulo=cr.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(ou+"NaN");return r.s?(bi=!1,e=Hh(r,t,0,1).times(t),bi=!0,r.minus(e)):Ds(new n(r),i)};cr.naturalExponential=cr.exp=function(){return wse(this)};cr.naturalLogarithm=cr.ln=function(){return S1(this)};cr.negated=cr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};cr.plus=cr.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?vse(e,t):Nse(e,(t.s=-t.s,t))};cr.precision=cr.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Kp+t);if(e=va(i)+1,n=i.d.length-1,r=n*ti+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};cr.squareRoot=cr.sqrt=function(){var t,e,r,n,i,a,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ou+"NaN")}for(t=va(l),bi=!1,i=Math.sqrt(+l),i==0||i==1/0?(e=Td(l.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=_b((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(a=n,n=a.plus(Hh(l,a,o+2)).times(.5),Td(a.d).slice(0,o)===(e=Td(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(Ds(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(e!="9999")break;o+=4}return bi=!0,Ds(n,r)};cr.times=cr.mul=function(t){var e,r,n,i,a,o,l,c,u,h=this,p=h.constructor,m=h.d,g=(t=new p(t)).d;if(!h.s||!t.s)return new p(0);for(t.s*=h.s,r=h.e+t.e,c=m.length,u=g.length,c<u&&(a=m,m=g,g=a,o=c,c=u,u=o),a=[],o=c+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(e=0,i=c+n;i>n;)l=a[i]+g[n]*m[i-n-1]+e,a[i--]=l%no|0,e=l/no|0;a[i]=(a[i]+e)%no|0}for(;!a[--o];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,bi?Ds(t,p.precision):t};cr.toDecimalPlaces=cr.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Wd(t,0,kb),e===void 0?e=n.rounding:Wd(e,0,8),Ds(r,t+va(r)+1,e))};cr.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=_m(n,!0):(Wd(t,0,kb),e===void 0?e=i.rounding:Wd(e,0,8),n=Ds(new i(n),t+1,e),r=_m(n,!0,t+1)),r};cr.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?_m(i):(Wd(t,0,kb),e===void 0?e=a.rounding:Wd(e,0,8),n=Ds(new a(i),t+va(i)+1,e),r=_m(n.abs(),!1,t+va(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};cr.toInteger=cr.toint=function(){var t=this,e=t.constructor;return Ds(new e(t),va(t)+1,e.rounding)};cr.toNumber=function(){return+this};cr.toPower=cr.pow=function(t){var e,r,n,i,a,o,l=this,c=l.constructor,u=12,h=+(t=new c(t));if(!t.s)return new c(xc);if(l=new c(l),!l.s){if(t.s<1)throw Error(ou+"Infinity");return l}if(l.eq(xc))return l;if(n=c.precision,t.eq(xc))return Ds(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,a=l.s,o){if((r=h<0?-h:h)<=yse){for(i=new c(xc),e=Math.ceil(n/ti+4),bi=!1;r%2&&(i=i.times(l),mH(i.d,e)),r=_b(r/2),r!==0;)l=l.times(l),mH(l.d,e);return bi=!0,t.s<0?new c(xc).div(i):Ds(i,n)}}else if(a<0)throw Error(ou+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,bi=!1,i=t.times(S1(l,n+u)),bi=!0,i=wse(i),i.s=a,i};cr.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=va(i),n=_m(i,r<=a.toExpNeg||r>=a.toExpPos)):(Wd(t,1,kb),e===void 0?e=a.rounding:Wd(e,0,8),i=Ds(new a(i),t,e),r=va(i),n=_m(i,t<=r||r<=a.toExpNeg,t)),n};cr.toSignificantDigits=cr.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Wd(t,1,kb),e===void 0?e=n.rounding:Wd(e,0,8)),Ds(new n(r),t,e)};cr.toString=cr.valueOf=cr.val=cr.toJSON=cr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=va(t),r=t.constructor;return _m(t,e<=r.toExpNeg||e>=r.toExpPos)};function vse(t,e){var r,n,i,a,o,l,c,u,h=t.constructor,p=h.precision;if(!t.s||!e.s)return e.s||(e=new h(t)),bi?Ds(e,p):e;if(c=t.d,u=e.d,o=t.e,i=e.e,c=c.slice(),a=o-i,a){for(a<0?(n=c,a=-a,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(p/ti),l=o>l?o+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=c.length,a=u.length,l-a<0&&(a=l,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/no|0,c[a]%=no;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=i,bi?Ds(e,p):e}function Wd(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Kp+t)}function Td(t){var e,r,n,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)n=t[e]+"",r=ti-n.length,r&&(a+=a0(r)),a+=n;o=t[e],n=o+"",r=ti-n.length,r&&(a+=a0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var Hh=(function(){function t(n,i){var a,o=0,l=n.length;for(n=n.slice();l--;)a=n[l]*i+o,n[l]=a%no|0,o=a/no|0;return o&&n.unshift(o),n}function e(n,i,a,o){var l,c;if(a!=o)c=a>o?1:-1;else for(l=c=0;l<a;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,a){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*no+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o){var l,c,u,h,p,m,g,b,v,w,j,_,E,I,O,B,S,T,M=n.constructor,$=n.s==i.s?1:-1,k=n.d,L=i.d;if(!n.s)return new M(n);if(!i.s)throw Error(ou+"Division by zero");for(c=n.e-i.e,S=L.length,O=k.length,g=new M($),b=g.d=[],u=0;L[u]==(k[u]||0);)++u;if(L[u]>(k[u]||0)&&--c,a==null?_=a=M.precision:o?_=a+(va(n)-va(i))+1:_=a,_<0)return new M(0);if(_=_/ti+2|0,u=0,S==1)for(h=0,L=L[0],_++;(u<O||h)&&_--;u++)E=h*no+(k[u]||0),b[u]=E/L|0,h=E%L|0;else{for(h=no/(L[0]+1)|0,h>1&&(L=t(L,h),k=t(k,h),S=L.length,O=k.length),I=S,v=k.slice(0,S),w=v.length;w<S;)v[w++]=0;T=L.slice(),T.unshift(0),B=L[0],L[1]>=no/2&&++B;do h=0,l=e(L,v,S,w),l<0?(j=v[0],S!=w&&(j=j*no+(v[1]||0)),h=j/B|0,h>1?(h>=no&&(h=no-1),p=t(L,h),m=p.length,w=v.length,l=e(p,v,m,w),l==1&&(h--,r(p,S<m?T:L,m))):(h==0&&(l=h=1),p=L.slice()),m=p.length,m<w&&p.unshift(0),r(v,p,w),l==-1&&(w=v.length,l=e(L,v,S,w),l<1&&(h++,r(v,S<w?T:L,w))),w=v.length):l===0&&(h++,v=[0]),b[u++]=h,l&&v[0]?v[w++]=k[I]||0:(v=[k[I]],w=1);while((I++<O||v[0]!==void 0)&&_--)}return b[0]||b.shift(),g.e=c,Ds(g,o?a+va(g)+1:a)}})();function wse(t,e){var r,n,i,a,o,l,c=0,u=0,h=t.constructor,p=h.precision;if(va(t)>16)throw Error(VP+va(t));if(!t.s)return new h(xc);for(bi=!1,l=p,o=new h(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(Np(2,u))/Math.LN10*2+5|0,l+=n,r=i=a=new h(xc),h.precision=l;;){if(i=Ds(i.times(t),l),r=r.times(++c),o=a.plus(Hh(i,r,l)),Td(o.d).slice(0,l)===Td(a.d).slice(0,l)){for(;u--;)a=Ds(a.times(a),l);return h.precision=p,e==null?(bi=!0,Ds(a,p)):a}a=o}}function va(t){for(var e=t.e*ti,r=t.d[0];r>=10;r/=10)e++;return e}function c6(t,e,r){if(e>t.LN10.sd())throw bi=!0,r&&(t.precision=r),Error(ou+"LN10 precision limit exceeded");return Ds(new t(t.LN10),e)}function a0(t){for(var e="";t--;)e+="0";return e}function S1(t,e){var r,n,i,a,o,l,c,u,h,p=1,m=10,g=t,b=g.d,v=g.constructor,w=v.precision;if(g.s<1)throw Error(ou+(g.s?"NaN":"-Infinity"));if(g.eq(xc))return new v(0);if(e==null?(bi=!1,u=w):u=e,g.eq(10))return e==null&&(bi=!0),c6(v,u);if(u+=m,v.precision=u,r=Td(b),n=r.charAt(0),a=va(g),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(t),r=Td(g.d),n=r.charAt(0),p++;a=va(g),n>1?(g=new v("0."+r),a++):g=new v(n+"."+r.slice(1))}else return c=c6(v,u+2,w).times(a+""),g=S1(new v(n+"."+r.slice(1)),u-m).plus(c),v.precision=w,e==null?(bi=!0,Ds(g,w)):g;for(l=o=g=Hh(g.minus(xc),g.plus(xc),u),h=Ds(g.times(g),u),i=3;;){if(o=Ds(o.times(h),u),c=l.plus(Hh(o,new v(i),u)),Td(c.d).slice(0,u)===Td(l.d).slice(0,u))return l=l.times(2),a!==0&&(l=l.plus(c6(v,u+2,w).times(a+""))),l=Hh(l,new v(p),u),v.precision=w,e==null?(bi=!0,Ds(l,w)):l;l=c,i+=2}}function pH(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=_b(r/ti),t.d=[],n=(r+1)%ti,r<0&&(n+=ti),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=ti;n<i;)t.d.push(+e.slice(n,n+=ti));e=e.slice(n),n=ti-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),bi&&(t.e>a4||t.e<-a4))throw Error(VP+r)}else t.s=0,t.e=0,t.d=[0];return t}function Ds(t,e,r){var n,i,a,o,l,c,u,h,p=t.d;for(o=1,a=p[0];a>=10;a/=10)o++;if(n=e-o,n<0)n+=ti,i=e,u=p[h=0];else{if(h=Math.ceil((n+1)/ti),a=p.length,h>=a)return t;for(u=a=p[h],o=1;a>=10;a/=10)o++;n%=ti,i=n-ti+o}if(r!==void 0&&(a=Np(10,o-i-1),l=u/a%10|0,c=e<0||p[h+1]!==void 0||u%a,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Np(10,o-i):0:p[h-1])%10&1||r==(t.s<0?8:7))),e<1||!p[0])return c?(a=va(t),p.length=1,e=e-a-1,p[0]=Np(10,(ti-e%ti)%ti),t.e=_b(-e/ti)||0):(p.length=1,p[0]=t.e=t.s=0),t;if(n==0?(p.length=h,a=1,h--):(p.length=h+1,a=Np(10,ti-n),p[h]=i>0?(u/Np(10,o-i)%Np(10,i)|0)*a:0),c)for(;;)if(h==0){(p[0]+=a)==no&&(p[0]=1,++t.e);break}else{if(p[h]+=a,p[h]!=no)break;p[h--]=0,a=1}for(n=p.length;p[--n]===0;)p.pop();if(bi&&(t.e>a4||t.e<-a4))throw Error(VP+va(t));return t}function Nse(t,e){var r,n,i,a,o,l,c,u,h,p,m=t.constructor,g=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),bi?Ds(e,g):e;if(c=t.d,p=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(h=o<0,h?(r=c,o=-o,l=p.length):(r=p,n=u,l=c.length),i=Math.max(Math.ceil(g/ti),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=p.length,h=i<l,h&&(l=i),i=0;i<l;i++)if(c[i]!=p[i]){h=c[i]<p[i];break}o=0}for(h&&(r=c,c=p,p=r,e.s=-e.s),l=c.length,i=p.length-l;i>0;--i)c[l++]=0;for(i=p.length;i>o;){if(c[--i]<p[i]){for(a=i;a&&c[--a]===0;)c[a]=no-1;--c[a],c[i]+=no}c[i]-=p[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,bi?Ds(e,g):e):new m(0)}function _m(t,e,r){var n,i=va(t),a=Td(t.d),o=a.length;return e?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+a0(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+a0(-i-1)+a,r&&(n=r-o)>0&&(a+=a0(n))):i>=o?(a+=a0(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+a0(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=a0(n))),t.s<0?"-"+a:a}function mH(t,e){if(t.length>e)return t.length=e,!0}function jse(t){var e,r,n;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Kp+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return pH(o,a.toString())}else if(typeof a!="string")throw Error(Kp+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,MFe.test(a))pH(o,a);else throw Error(Kp+a)}if(i.prototype=cr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=jse,i.config=i.set=DFe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function DFe(t){if(!t||typeof t!="object")throw Error(ou+"Object expected");var e,r,n,i=["precision",1,kb,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(_b(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(Kp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Kp+r+": "+n);return this}var HP=jse(RFe);xc=new HP(1);const ps=HP;var BFe=t=>t,kse={},_se=t=>t===kse,gH=t=>function e(){return arguments.length===0||arguments.length===1&&_se(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},Sse=(t,e)=>t===1?e:gH(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(o=>o!==kse).length;return a>=t?e(...n):Sse(t-a,gH(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(h=>_se(h)?l.shift():h);return e(...u,...l)}))}),$Fe=t=>Sse(t.length,t),m8=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},FFe=$Fe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),UFe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return BFe;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce((l,c)=>c(l),a(...arguments))}};function Cse(t){var e;return t===0?e=1:e=Math.floor(new ps(t).abs().log(10).toNumber())+1,e}function Ese(t,e,r){for(var n=new ps(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var Ase=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},Tse=(t,e,r)=>{if(t.lte(0))return new ps(0);var n=Cse(t.toNumber()),i=new ps(10).pow(n),a=t.div(i),o=n!==1?.05:.1,l=new ps(Math.ceil(a.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return e?new ps(c.toNumber()):new ps(Math.ceil(c.toNumber()))},zFe=(t,e,r)=>{var n=new ps(1),i=new ps(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new ps(10).pow(Cse(t)-1),i=new ps(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new ps(Math.floor(t)))}else t===0?i=new ps(Math.floor((e-1)/2)):r||(i=new ps(Math.floor(t)));var o=Math.floor((e-1)/2),l=UFe(FFe(c=>i.add(new ps(c-o).mul(n)).toNumber()),m8);return l(0,e)},Ise=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new ps(0),tickMin:new ps(0),tickMax:new ps(0)};var o=Tse(new ps(r).sub(e).div(n-1),i,a),l;e<=0&&r>=0?l=new ps(0):(l=new ps(e).add(r).div(2),l=l.sub(new ps(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new ps(r).sub(l).div(o).toNumber()),h=c+u+1;return h>n?Ise(e,r,n,i,a+1):(h<n&&(u=r>0?u+(n-h):u,c=r>0?c:c+(n-h)),{step:o,tickMin:l.sub(new ps(c).mul(o)),tickMax:l.add(new ps(u).mul(o))})},qFe=function(e){var[r,n]=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=Ase([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...m8(0,i-1).map(()=>1/0)]:[...m8(0,i-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return zFe(l,i,a);var{step:h,tickMin:p,tickMax:m}=Ise(l,c,o,a,0),g=Ese(p,m.add(new ps(.1).mul(h)),h);return r>n?g.reverse():g},VFe=function(e,r){var[n,i]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=Ase([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=Tse(new ps(l).sub(o).div(c-1),a,0),h=[...Ese(new ps(o),new ps(l),u),l];return a===!1&&(h=h.map(p=>Math.round(p))),n>i?h.reverse():h},Lse=t=>t.rootProps.maxBarSize,HFe=t=>t.rootProps.barGap,Pse=t=>t.rootProps.barCategoryGap,WFe=t=>t.rootProps.barSize,v2=t=>t.rootProps.stackOffset,Ose=t=>t.rootProps.reverseStackOrder,WP=t=>t.options.chartName,GP=t=>t.rootProps.syncId,Rse=t=>t.rootProps.syncMethod,KP=t=>t.options.eventEmitter,Zo={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Th={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},pc={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},f_=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},GFe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Th.angleAxisId,includeHidden:!1,name:void 0,reversed:Th.reversed,scale:Th.scale,tick:Th.tick,tickCount:void 0,ticks:void 0,type:Th.type,unit:void 0},KFe={allowDataOverflow:pc.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:pc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:pc.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:pc.scale,tick:pc.tick,tickCount:pc.tickCount,ticks:void 0,type:pc.type,unit:void 0},YFe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Th.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Th.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Th.scale,tick:Th.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},XFe={allowDataOverflow:pc.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:pc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:pc.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:pc.scale,tick:pc.tick,tickCount:pc.tickCount,ticks:void 0,type:"category",unit:void 0},YP=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?YFe:GFe,XP=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?XFe:KFe,p_=t=>t.polarOptions,QP=it([mf,gf,za],Lne),Mse=it([p_,QP],(t,e)=>{if(t!=null)return el(t.innerRadius,e,0)}),Dse=it([p_,QP],(t,e)=>{if(t!=null)return el(t.outerRadius,e,e*.8)}),QFe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},Bse=it([p_],QFe);it([YP,Bse],f_);var $se=it([QP,Mse,Dse],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});it([XP,$se],f_);var Fse=it([Jn,p_,Mse,Dse,mf,gf],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:el(o,i,i/2),cy:el(l,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),vi=(t,e)=>e,w2=(t,e,r)=>r;function JP(t){return t?.id}function Use(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:i,dataKey:a}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var h=JP(l);u.forEach((p,m)=>{var g=a==null||i?m:String(si(p,a,null)),b=si(p,l.dataKey,0),v;o.has(g)?v=o.get(g):v={},Object.assign(v,{[h]:b}),o.set(g,v)})}}),Array.from(o.values())}function m_(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var g_=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function x_(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function JFe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Va=t=>{var e=Jn(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Sb=t=>t.tooltip.settings.axisId;function xH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function o4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xH(Object(r),!0).forEach(function(n){ZFe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZFe(t,e,r){return(e=eUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eUe(t){var e=tUe(t,"string");return typeof e=="symbol"?e:e+""}function tUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var g8=[0,"auto"],eo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},zse=(t,e)=>t.cartesianAxis.xAxis[e],yf=(t,e)=>{var r=zse(t,e);return r??eo},to={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:g8,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:f2},qse=(t,e)=>t.cartesianAxis.yAxis[e],vf=(t,e)=>{var r=qse(t,e);return r??to},rUe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ZP=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??rUe},Ii=(t,e,r)=>{switch(e){case"xAxis":return yf(t,r);case"yAxis":return vf(t,r);case"zAxis":return ZP(t,r);case"angleAxis":return YP(t,r);case"radiusAxis":return XP(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},nUe=(t,e,r)=>{switch(e){case"xAxis":return yf(t,r);case"yAxis":return vf(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},N2=(t,e,r)=>{switch(e){case"xAxis":return yf(t,r);case"yAxis":return vf(t,r);case"angleAxis":return YP(t,r);case"radiusAxis":return XP(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Vse=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function eO(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var tO=t=>t.graphicalItems.cartesianItems,sUe=it([vi,w2],eO),rO=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),j2=it([tO,Ii,sUe],rO,{memoizeOptions:{resultEqualityCheck:x_}}),Hse=it([j2],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(m_)),Wse=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),iUe=it([j2],Wse),nO=t=>t.map(e=>e.data).filter(Boolean).flat(1),aUe=it([j2],nO,{memoizeOptions:{resultEqualityCheck:x_}}),sO=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},iO=it([aUe,xse],sO),aO=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:si(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:si(i,n)}))):t.map(n=>({value:n})),b_=it([iO,Ii,j2],aO);function Gse(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function wN(t){if(Hd(t)||t instanceof Date){var e=Number(t);if(Ti(e))return e}}function bH(t){if(Array.isArray(t)){var e=[wN(t[0]),wN(t[1])];return B0(e)?e:void 0}var r=wN(t);if(r!=null)return[r,r]}function sf(t){return t.map(wN).filter(QOe)}function oUe(t,e,r){return!r||typeof e!="number"||Vd(e)?[]:r.length?sf(r.flatMap(n=>{var i=si(t,n.dataKey),a,o;if(Array.isArray(i)?[a,o]=i:a=o=i,!(!Ti(a)||!Ti(o)))return[e-a,e+o]})):[]}var Ha=t=>{var e=Va(t),r=Sb(t);return N2(t,e,r)},k2=it([Ha],t=>t?.dataKey),lUe=it([Hse,xse,Ha],Use),Kse=(t,e,r,n)=>{var i={},a=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(a).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,h=u.map(JP);return[l,{stackedData:_7e(t,h,r),graphicalItems:u}]}))},x8=it([lUe,Hse,v2,Ose],Kse),Yse=(t,e,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=e;if(n==null&&r!=="zAxis"){var o=T7e(t,i,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},cUe=it([Ii],t=>t.allowDataOverflow),oO=t=>{var e;if(t==null||!("domain"in t))return g8;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=sf(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:g8},lO=it([Ii],oO),cO=it([lO,cUe],bse),uUe=it([x8,bf,vi,cO],Yse,{memoizeOptions:{resultEqualityCheck:g_}}),y_=t=>t.errorBars,dUe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>Gse(r,n)),l4=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),o=Math.min(...a),l=Math.max(...a);return[o,l]}},uO=(t,e,r,n,i)=>{var a,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,h,p=(u=n[c.id])===null||u===void 0?void 0:u.filter(j=>Gse(i,j)),m=si(l,(h=e.dataKey)!==null&&h!==void 0?h:c.dataKey),g=oUe(l,m,p);if(g.length>=2){var b=Math.min(...g),v=Math.max(...g);(a==null||b<a)&&(a=b),(o==null||v>o)&&(o=v)}var w=bH(m);w!=null&&(a=a==null?w[0]:Math.min(a,w[0]),o=o==null?w[1]:Math.max(o,w[1]))})}),e?.dataKey!=null&&t.forEach(l=>{var c=bH(si(l,e.dataKey));c!=null&&(a=a==null?c[0]:Math.min(a,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Ti(a)&&Ti(o))return[a,o]},hUe=it([iO,Ii,iUe,y_,vi],uO,{memoizeOptions:{resultEqualityCheck:g_}});function fUe(t){var{value:e}=t;if(Hd(e)||e instanceof Date)return e}var pUe=(t,e,r)=>{var n=t.map(fUe).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&hre(n))?Mne(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Xse=t=>t.referenceElements.dots,Cb=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),mUe=it([Xse,vi,w2],Cb),Qse=t=>t.referenceElements.areas,gUe=it([Qse,vi,w2],Cb),Jse=t=>t.referenceElements.lines,xUe=it([Jse,vi,w2],Cb),Zse=(t,e)=>{if(t!=null){var r=sf(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},bUe=it(mUe,vi,Zse),eie=(t,e)=>{if(t!=null){var r=sf(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},yUe=it([gUe,vi],eie);function vUe(t){var e;if(t.x!=null)return sf([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:sf(r)}function wUe(t){var e;if(t.y!=null)return sf([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:sf(r)}var tie=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?vUe(n):wUe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},NUe=it([xUe,vi],tie),jUe=it(bUe,NUe,yUe,(t,e,r)=>l4(t,r,e)),dO=(t,e,r,n,i,a,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?l4(n,a,i):l4(a,i);return OFe(e,u,t.allowDataOverflow)},kUe=it([Ii,lO,cO,uUe,hUe,jUe,Jn,vi],dO,{memoizeOptions:{resultEqualityCheck:g_}}),_Ue=[0,1],hO=(t,e,r,n,i,a,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=Hm(e,a);if(u&&l==null){var h;return Mne(0,(h=r?.length)!==null&&h!==void 0?h:0)}return c==="category"?pUe(n,t,u):i==="expand"?_Ue:o}},fO=it([Ii,Jn,iO,b_,v2,vi,kUe],hO),rie=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:o}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof a=="string"){var l="scale".concat(o2(a));return l in nv?l:"point"}}},Eb=it([Ii,Jn,Vse,WP,vi],rie);function SUe(t){if(t!=null){if(t in nv)return nv[t]();var e="scale".concat(o2(t));if(e in nv)return nv[e]()}}function pO(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=SUe(e);if(i!=null){var a=i.domain(r).range(n);return v7e(a),a}}}var mO=(t,e,r)=>{var n=oO(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&B0(t))return qFe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&B0(t))return VFe(t,e.tickCount,e.allowDecimals)}},gO=it([fO,N2,Eb],mO),xO=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&B0(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],o=e[1],l=r[r.length-1];return[Math.min(i,a),Math.max(o,l)]}return e},CUe=it([Ii,fO,gO,vi],xO),EUe=it(b_,Ii,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(sf(t.map(p=>p.value))).sort((p,m)=>p-m),i=n[0],a=n[n.length-1];if(i==null||a==null)return 1/0;var o=a-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var h=u-c;r=Math.min(r,h)}}return r/o}}),nie=it(EUe,Jn,Pse,za,(t,e,r,n,i)=>i,(t,e,r,n,i)=>{if(!Ti(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var o=el(r,t*a),l=t*a/2;return l-o-(l-o)/a*o}return 0}),AUe=(t,e,r)=>{var n=yf(t,e);return n==null||typeof n.padding!="string"?0:nie(t,"xAxis",e,r,n.padding)},TUe=(t,e,r)=>{var n=vf(t,e);return n==null||typeof n.padding!="string"?0:nie(t,"yAxis",e,r,n.padding)},IUe=it(yf,AUe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),LUe=it(vf,TUe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),PUe=it([za,IUe,Qk,Xk,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),OUe=it([za,Jn,LUe,Qk,Xk,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:o}=i;return a?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),_2=(t,e,r,n)=>{var i;switch(e){case"xAxis":return PUe(t,r,n);case"yAxis":return OUe(t,r,n);case"zAxis":return(i=ZP(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return Bse(t);case"radiusAxis":return $se(t,r);default:return}},sie=it([Ii,_2],f_),v_=it([Ii,Eb,CUe,sie],pO);it([j2,y_,vi],dUe);function iie(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var w_=(t,e)=>e,N_=(t,e,r)=>r,RUe=it(Kk,w_,N_,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(iie)),MUe=it(Yk,w_,N_,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(iie)),aie=(t,e)=>({width:t.width,height:e.height}),DUe=(t,e)=>{var r=typeof e.width=="number"?e.width:f2;return{width:r,height:t.height}},oie=it(za,yf,aie),BUe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},$Ue=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},FUe=it(gf,za,RUe,w_,N_,(t,e,r,n,i)=>{var a={},o;return r.forEach(l=>{var c=aie(e,l);o==null&&(o=BUe(e,n,t));var u=n==="top"&&!i||n==="bottom"&&i;a[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),a}),UUe=it(mf,za,MUe,w_,N_,(t,e,r,n,i)=>{var a={},o;return r.forEach(l=>{var c=DUe(e,l);o==null&&(o=$Ue(e,n,t));var u=n==="left"&&!i||n==="right"&&i;a[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),a}),zUe=(t,e)=>{var r=yf(t,e);if(r!=null)return FUe(t,r.orientation,r.mirror)},qUe=it([za,yf,zUe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),VUe=(t,e)=>{var r=vf(t,e);if(r!=null)return UUe(t,r.orientation,r.mirror)},HUe=it([za,vf,VUe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),lie=it(za,vf,(t,e)=>{var r=typeof e.width=="number"?e.width:f2;return{width:r,height:t.height}}),yH=(t,e,r)=>{switch(e){case"xAxis":return oie(t,r).width;case"yAxis":return lie(t,r).height;default:return}},cie=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:o}=r,l=Hm(t,n),c=e.map(u=>u.value);if(o&&l&&a==="category"&&i&&hre(c))return c}},bO=it([Jn,b_,Ii,vi],cie),uie=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,o=Hm(t,n);if(o&&(i==="number"||a!=="auto"))return e.map(l=>l.value)}},yO=it([Jn,b_,N2,vi],uie);it([Jn,nUe,Eb,v_,bO,yO,_2,gO,vi],(t,e,r,n,i,a,o,l,c)=>{if(e!=null){var u=Hm(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var WUe=(t,e,r,n,i,a,o,l,c)=>{if(!(e==null||n==null)){var u=Hm(t,c),{type:h,ticks:p,tickCount:m}=e,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,b=h==="category"&&n.bandwidth?n.bandwidth()/g:0;b=c==="angleAxis"&&a!=null&&a.length>=2?Po(a[0]-a[1])*2*b:b;var v=p||i;if(v){var w=v.map((j,_)=>{var E=o?o.indexOf(j):j;return{index:_,coordinate:n(E)+b,value:j,offset:b}});return w.filter(j=>Ti(j.coordinate))}return u&&l?l.map((j,_)=>({coordinate:n(j)+b,value:j,index:_,offset:b})).filter(j=>Ti(j.coordinate)):n.ticks?n.ticks(m).map(j=>({coordinate:n(j)+b,value:j,offset:b})):n.domain().map((j,_)=>({coordinate:n(j)+b,value:o?o[j]:j,index:_,offset:b}))}},die=it([Jn,N2,Eb,v_,gO,_2,bO,yO,vi],WUe),GUe=(t,e,r,n,i,a,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=Hm(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&n?.length>=2?Po(n[0]-n[1])*2*u:u,l&&a?a.map((h,p)=>({coordinate:r(h)+u,value:h,index:p,offset:u})):r.ticks?r.ticks(c).map(h=>({coordinate:r(h)+u,value:h,offset:u})):r.domain().map((h,p)=>({coordinate:r(h)+u,value:i?i[h]:h,index:p,offset:u}))}},sb=it([Jn,N2,v_,_2,bO,yO,vi],GUe),ib=it(Ii,v_,(t,e)=>{if(!(t==null||e==null))return o4(o4({},t),{},{scale:e})}),KUe=it([Ii,Eb,fO,sie],pO);it((t,e,r)=>ZP(t,r),KUe,(t,e)=>{if(!(t==null||e==null))return o4(o4({},t),{},{scale:e})});var YUe=it([Jn,Kk,Yk],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),hie=t=>t.options.defaultTooltipEventType,fie=t=>t.options.validateTooltipEventTypes;function pie(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function vO(t,e){var r=hie(t),n=fie(t);return pie(e,r,n)}function XUe(t){return kr(e=>vO(e,t))}var mie=(t,e)=>{var r,n=Number(e);if(!(Vd(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},QUe=t=>t.tooltip.settings,p0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},JUe={itemInteraction:{click:p0,hover:p0},axisInteraction:{click:p0,hover:p0},keyboardInteraction:p0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},gie=ec({name:"tooltip",initialState:JUe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:gi()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,i=qu(t).tooltipItemPayloads.indexOf(r);i>-1&&(t.tooltipItemPayloads[i]=n)},prepare:gi()},removeTooltipEntrySettings:{reducer(t,e){var r=qu(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:gi()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:ZUe,replaceTooltipEntrySettings:eze,removeTooltipEntrySettings:tze,setTooltipSettingsState:rze,setActiveMouseOverItemIndex:xie,mouseLeaveItem:nze,mouseLeaveChart:bie,setActiveClickItemIndex:sze,setMouseOverAxisIndex:yie,setMouseClickAxisIndex:ize,setSyncInteraction:b8,setKeyboardInteraction:y8}=gie.actions,aze=gie.reducer;function vH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function T5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vH(Object(r),!0).forEach(function(n){oze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oze(t,e,r){return(e=lze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lze(t){var e=cze(t,"string");return typeof e=="symbol"?e:e+""}function cze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uze(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function dze(t){return t.index!=null}var vie=(t,e,r,n)=>{if(e==null)return p0;var i=uze(t,e,r);if(i==null)return p0;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(dze(i)){if(a)return T5(T5({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return T5(T5({},p0),{},{coordinate:i.coordinate})};function hze(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function fze(t,e){var r=hze(t),n=e[0],i=e[1];if(r===void 0)return!1;var a=Math.min(n,i),o=Math.max(n,i);return r>=a&&r<=o}function pze(t,e,r){if(r==null||e==null)return!0;var n=si(t,e);return n==null||!B0(r)?!0:fze(n,r)}var wO=(t,e,r,n)=>{var i=t?.index;if(i==null)return null;var a=Number(i);if(!Ti(a))return i;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(a,l)),u=e[c];return u==null||pze(u,r,n)?String(c):null},wie=(t,e,r,n,i,a,o,l)=>{if(!(a==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,a);if(u!=null)return u;var h=i?.[Number(a)];if(h)return r==="horizontal"?{x:h.coordinate,y:(n.top+e)/2}:{x:(n.left+t)/2,y:h.coordinate}}},Nie=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=t.itemInteraction.hover.graphicalItemId:i=t.itemInteraction.click.graphicalItemId,i==null&&n!=null){var a=t.tooltipItemPayloads[0];return a!=null?[a]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},S2=t=>t.options.tooltipPayloadSearcher,Ab=t=>t.tooltip;function wH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function NH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wH(Object(r),!0).forEach(function(n){mze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mze(t,e,r){return(e=gze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gze(t){var e=xze(t,"string");return typeof e=="symbol"?e:e+""}function xze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bze(t,e){return t??e}var jie=(t,e,r,n,i,a,o)=>{if(!(e==null||a==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:h}=r,p=[];return t.reduce((m,g)=>{var b,{dataDefinedOnItem:v,settings:w}=g,j=bze(v,l),_=Array.isArray(j)?ine(j,u,h):j,E=(b=w?.dataKey)!==null&&b!==void 0?b:n,I=w?.nameKey,O;if(n&&Array.isArray(_)&&!Array.isArray(_[0])&&o==="axis"?O=XOe(_,n,i):O=a(_,e,c,I),Array.isArray(O))O.forEach(S=>{var T=NH(NH({},w),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});m.push(kq({tooltipEntrySettings:T,dataKey:S.dataKey,payload:S.payload,value:si(S.payload,S.dataKey),name:S.name}))});else{var B;m.push(kq({tooltipEntrySettings:w,dataKey:E,payload:O,value:si(O,E),name:(B=si(O,I))!==null&&B!==void 0?B:w?.name}))}return m},p)}},NO=it([Ha,Jn,Vse,WP,Va],rie),yze=it([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),vze=it([Va,Sb],eO),Tb=it([yze,Ha,vze],rO,{memoizeOptions:{resultEqualityCheck:x_}}),wze=it([Tb],t=>t.filter(m_)),Nze=it([Tb],nO,{memoizeOptions:{resultEqualityCheck:x_}}),Ib=it([Nze,bf],sO),jze=it([wze,bf,Ha],Use),jO=it([Ib,Ha,Tb],aO),kie=it([Ha],oO),kze=it([Ha],t=>t.allowDataOverflow),_ie=it([kie,kze],bse),_ze=it([Tb],t=>t.filter(m_)),Sze=it([jze,_ze,v2,Ose],Kse),Cze=it([Sze,bf,Va,_ie],Yse),Eze=it([Tb],Wse),Aze=it([Ib,Ha,Eze,y_,Va],uO,{memoizeOptions:{resultEqualityCheck:g_}}),Tze=it([Xse,Va,Sb],Cb),Ize=it([Tze,Va],Zse),Lze=it([Qse,Va,Sb],Cb),Pze=it([Lze,Va],eie),Oze=it([Jse,Va,Sb],Cb),Rze=it([Oze,Va],tie),Mze=it([Ize,Rze,Pze],l4),Dze=it([Ha,kie,_ie,Cze,Aze,Mze,Jn,Va],dO),C2=it([Ha,Jn,Ib,jO,v2,Va,Dze],hO),Bze=it([C2,Ha,NO],mO),$ze=it([Ha,C2,Bze,Va],xO),Sie=t=>{var e=Va(t),r=Sb(t),n=!1;return _2(t,e,r,n)},Cie=it([Ha,Sie],f_),Eie=it([Ha,NO,$ze,Cie],pO),Fze=it([Jn,jO,Ha,Va],cie),Uze=it([Jn,jO,Ha,Va],uie),zze=(t,e,r,n,i,a,o,l)=>{if(e){var{type:c}=e,u=Hm(t,l);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=c==="category"&&n.bandwidth?n.bandwidth()/h:0;return p=l==="angleAxis"&&i!=null&&i?.length>=2?Po(i[0]-i[1])*2*p:p,u&&o?o.map((m,g)=>({coordinate:n(m)+p,value:m,index:g,offset:p})):n.domain().map((m,g)=>({coordinate:n(m)+p,value:a?a[m]:m,index:g,offset:p}))}}},wf=it([Jn,Ha,NO,Eie,Sie,Fze,Uze,Va],zze),kO=it([hie,fie,QUe],(t,e,r)=>pie(r.shared,t,e)),Aie=t=>t.tooltip.settings.trigger,_O=t=>t.tooltip.settings.defaultIndex,E2=it([Ab,kO,Aie,_O],vie),Sm=it([E2,Ib,k2,C2],wO),Tie=it([wf,Sm],mie),SO=it([E2],t=>{if(t)return t.dataKey}),qze=it([E2],t=>{if(t)return t.graphicalItemId}),Iie=it([Ab,kO,Aie,_O],Nie),Vze=it([mf,gf,Jn,za,wf,_O,Iie,S2],wie),Hze=it([E2,Vze],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),Wze=it([E2],t=>{var e;return(e=t?.active)!==null&&e!==void 0?e:!1}),Gze=it([Iie,Sm,bf,k2,Tie,S2,kO],jie);it([Gze],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function jH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jH(Object(r),!0).forEach(function(n){Kze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kze(t,e,r){return(e=Yze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yze(t){var e=Xze(t,"string");return typeof e=="symbol"?e:e+""}function Xze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Qze=()=>kr(Ha),Jze=()=>{var t=Qze(),e=kr(wf),r=kr(Eie);return zj(!t||!r?void 0:kH(kH({},t),{},{scale:r}),e)};function _H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function qg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_H(Object(r),!0).forEach(function(n){Zze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zze(t,e,r){return(e=eqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eqe(t){var e=tqe(t,"string");return typeof e=="symbol"?e:e+""}function tqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rqe=(t,e,r,n)=>{var i=e.find(a=>a&&a.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},nqe=(t,e,r,n)=>{var i=e.find(u=>u&&u.index===r);if(i){if(t==="centric"){var a=i.coordinate,{radius:o}=n;return qg(qg(qg({},n),ya(n.cx,n.cy,o,a)),{},{angle:a,radius:o})}var l=i.coordinate,{angle:c}=n;return qg(qg(qg({},n),ya(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function sqe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Lie=(t,e,r,n,i)=>{var a,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,h,p,m,g=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,b=(h=r[l])===null||h===void 0?void 0:h.coordinate,v=l>=o-1?(p=r[0])===null||p===void 0?void 0:p.coordinate:(m=r[l+1])===null||m===void 0?void 0:m.coordinate,w=void 0;if(!(g==null||b==null||v==null))if(Po(b-g)!==Po(v-b)){var j=[];if(Po(v-b)===Po(i[1]-i[0])){w=v;var _=b+i[1]-i[0];j[0]=Math.min(_,(_+g)/2),j[1]=Math.max(_,(_+g)/2)}else{w=g;var E=v+i[1]-i[0];j[0]=Math.min(b,(E+b)/2),j[1]=Math.max(b,(E+b)/2)}var I=[Math.min(b,(w+b)/2),Math.max(b,(w+b)/2)];if(t>I[0]&&t<=I[1]||t>=j[0]&&t<=j[1]){var O;return(O=r[l])===null||O===void 0?void 0:O.index}}else{var B=Math.min(g,v),S=Math.max(g,v);if(t>(B+b)/2&&t<=(S+b)/2){var T;return(T=r[l])===null||T===void 0?void 0:T.index}}}else if(e)for(var M=0;M<o;M++){var $=e[M];if($!=null){var k=e[M+1],L=e[M-1];if(M===0&&k!=null&&t<=($.coordinate+k.coordinate)/2||M===o-1&&L!=null&&t>($.coordinate+L.coordinate)/2||M>0&&M<o-1&&L!=null&&k!=null&&t>($.coordinate+L.coordinate)/2&&t<=($.coordinate+k.coordinate)/2)return $.index}}return-1},iqe=()=>kr(WP),CO=(t,e)=>e,Pie=(t,e,r)=>r,EO=(t,e,r,n)=>n,aqe=it(wf,t=>Bk(t,e=>e.coordinate)),AO=it([Ab,CO,Pie,EO],vie),TO=it([AO,Ib,k2,C2],wO),oqe=(t,e,r)=>{if(e!=null){var n=Ab(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Oie=it([Ab,CO,Pie,EO],Nie),c4=it([mf,gf,Jn,za,wf,EO,Oie,S2],wie),lqe=it([AO,c4],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Rie=it([wf,TO],mie),cqe=it([Oie,TO,bf,k2,Rie,S2,CO],jie),uqe=it([AO,TO],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),dqe=(t,e,r,n,i,a,o)=>{if(!(!t||!r||!n||!i)&&sqe(t,o)){var l=I7e(t,e),c=Lie(l,a,i,r,n),u=rqe(e,i,c,t);return{activeIndex:String(c),activeCoordinate:u}}},hqe=(t,e,r,n,i,a,o)=>{if(!(!t||!n||!i||!a||!r)){var l=Y9e(t,r);if(l){var c=L7e(l,e),u=Lie(c,o,a,n,i),h=nqe(e,a,u,l);return{activeIndex:String(u),activeCoordinate:h}}}},fqe=(t,e,r,n,i,a,o,l)=>{if(!(!t||!e||!n||!i||!a))return e==="horizontal"||e==="vertical"?dqe(t,e,n,i,a,o,l):hqe(t,e,r,n,i,a,o)},pqe=it(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),mqe=it(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(Zo)),r=Array.from(new Set(e));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:JFe}});function SH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function CH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SH(Object(r),!0).forEach(function(n){gqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gqe(t,e,r){return(e=xqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xqe(t){var e=bqe(t,"string");return typeof e=="symbol"?e:e+""}function bqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yqe={},vqe={zIndexMap:Object.values(Zo).reduce((t,e)=>CH(CH({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),yqe)},wqe=new Set(Object.values(Zo));function Nqe(t){return wqe.has(t)}var Mie=ec({name:"zIndex",initialState:vqe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:gi()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!Nqe(r)&&delete t.zIndexMap[r])},prepare:gi()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:i}=e.payload;t.zIndexMap[r]?i?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:gi()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:gi()}}}),{registerZIndexPortal:jqe,unregisterZIndexPortal:kqe,registerZIndexPortalElement:_qe,unregisterZIndexPortalElement:Sqe}=Mie.actions,Cqe=Mie.reducer;function eh(t){var{zIndex:e,children:r}=t,n=uDe(),i=n&&e!==void 0&&e!==0,a=Ec(),o=Hs();y.useLayoutEffect(()=>i?(o(jqe({zIndex:e})),()=>{o(kqe({zIndex:e}))}):l2,[o,e,i]);var l=kr(c=>pqe(c,e,a));return i?l?Vn.createPortal(r,l):null:r}function v8(){return v8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},v8.apply(null,arguments)}function EH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function I5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EH(Object(r),!0).forEach(function(n){Eqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Eqe(t,e,r){return(e=Aqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aqe(t){var e=Tqe(t,"string");return typeof e=="symbol"?e:e+""}function Tqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iqe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return y.isValidElement(e)?y.cloneElement(e,n):y.createElement(r,n)}function Lqe(t){var e,{coordinate:r,payload:n,index:i,offset:a,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:h}=t,p=r,m=n,g=i;if(!c||!p||h!=="ScatterChart"&&u!=="axis")return null;var b,v,w;if(h==="ScatterChart")b=p,v=c9e,w=Zo.cursorLine;else if(h==="BarChart")b=u9e(l,p,a,o),v=Ine,w=Zo.cursorRectangle;else if(l==="radial"&&pre(p)){var{cx:j,cy:_,radius:E,startAngle:I,endAngle:O}=Pne(p);b={cx:j,cy:_,startAngle:I,endAngle:O,innerRadius:E,outerRadius:E},v=Rne,w=Zo.cursorLine}else b={points:Z9e(l,p,a)},v=vP,w=Zo.cursorLine;var B=typeof c=="object"&&"className"in c?c.className:void 0,S=I5(I5(I5(I5({stroke:"#ccc",pointerEvents:"none"},a),b),f1(c)),{},{payload:m,payloadIndex:g,className:gs("recharts-tooltip-cursor",B)});return y.createElement(eh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:w},y.createElement(Iqe,{cursor:c,cursorComp:v,cursorProps:S}))}function Pqe(t){var e=Jze(),r=lDe(),n=p2(),i=iqe();return e==null||r==null||n==null||i==null?null:y.createElement(Lqe,v8({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var Die=y.createContext(null),Oqe=()=>y.useContext(Die),C1=new RZ,w8="recharts.syncEvent.tooltip",AH="recharts.syncEvent.brush";function Bie(t,e){if(e){var r=Number.parseInt(e,10);if(!Vd(r))return t?.[r]}}var Rqe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},$ie=ec({name:"options",initialState:Rqe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Mqe=$ie.reducer,{createEventEmitter:Dqe}=$ie.actions;function Bqe(t){return t.tooltip.syncInteraction}var $qe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Fie=ec({name:"chartData",initialState:$qe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:TH,setDataStartEndIndexes:Fqe,setComputedData:mJe}=Fie.actions,Uqe=Fie.reducer,zqe=["x","y"];function IH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?IH(Object(r),!0).forEach(function(n){qqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):IH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qqe(t,e,r){return(e=Vqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vqe(t){var e=Hqe(t,"string");return typeof e=="symbol"?e:e+""}function Hqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wqe(t,e){if(t==null)return{};var r,n,i=Gqe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Gqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Kqe(){var t=kr(GP),e=kr(KP),r=Hs(),n=kr(Rse),i=kr(wf),a=p2(),o=Jk(),l=kr(c=>c.rootProps.className);y.useEffect(()=>{if(t==null)return l2;var c=(u,h,p)=>{if(e!==p&&t===u){if(n==="index"){var m;if(o&&h!==null&&h!==void 0&&(m=h.payload)!==null&&m!==void 0&&m.coordinate&&h.payload.sourceViewBox){var g=h.payload.coordinate,{x:b,y:v}=g,w=Wqe(g,zqe),{x:j,y:_,width:E,height:I}=h.payload.sourceViewBox,O=Vg(Vg({},w),{},{x:o.x+(E?(b-j)/E:0)*o.width,y:o.y+(I?(v-_)/I:0)*o.height});r(Vg(Vg({},h),{},{payload:Vg(Vg({},h.payload),{},{coordinate:O})}))}else r(h);return}if(i!=null){var B;if(typeof n=="function"){var S={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},T=n(i,S);B=i[T]}else n==="value"&&(B=i.find(X=>String(X.value)===h.payload.label));var{coordinate:M}=h.payload;if(B==null||h.payload.active===!1||M==null||o==null){r(b8({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:$,y:k}=M,L=Math.min($,o.x+o.width),R=Math.min(k,o.y+o.height),V={x:a==="horizontal"?B.coordinate:L,y:a==="horizontal"?R:B.coordinate},Y=b8({active:h.payload.active,coordinate:V,dataKey:h.payload.dataKey,index:String(B.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});r(Y)}}};return C1.on(w8,c),()=>{C1.off(w8,c)}},[l,r,e,t,n,i,a,o])}function Yqe(){var t=kr(GP),e=kr(KP),r=Hs();y.useEffect(()=>{if(t==null)return l2;var n=(i,a,o)=>{e!==o&&t===i&&r(Fqe(a))};return C1.on(AH,n),()=>{C1.off(AH,n)}},[r,e,t])}function Xqe(){var t=Hs();y.useEffect(()=>{t(Dqe())},[t]),Kqe(),Yqe()}function Qqe(t,e,r,n,i,a){var o=kr(g=>oqe(g,t,e)),l=kr(KP),c=kr(GP),u=kr(Rse),h=kr(Bqe),p=h?.active,m=Jk();y.useEffect(()=>{if(!p&&c!=null&&l!=null){var g=b8({active:a,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:m,graphicalItemId:void 0});C1.emit(w8,c,g,l)}},[p,r,o,i,n,l,c,u,a,m])}function LH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function PH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LH(Object(r),!0).forEach(function(n){Jqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jqe(t,e,r){return(e=Zqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zqe(t){var e=eVe(t,"string");return typeof e=="symbol"?e:e+""}function eVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tVe(t){return t.dataKey}function rVe(t,e){return y.isValidElement(t)?y.cloneElement(t,e):typeof t=="function"?y.createElement(t,e):y.createElement(zDe,e)}var OH=[],nVe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function RH(t){var e,r,n=Do(t,nVe),{active:i,allowEscapeViewBox:a,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:h,offset:p,payloadUniqBy:m,position:g,reverseDirection:b,useTranslate3d:v,wrapperStyle:w,cursor:j,shared:_,trigger:E,defaultIndex:I,portal:O,axisId:B}=n,S=Hs(),T=typeof I=="number"?String(I):I;y.useEffect(()=>{S(rze({shared:_,trigger:E,axisId:B,active:i,defaultIndex:T}))},[S,_,E,B,i,T]);var M=Jk(),$=Sne(),k=XUe(_),{activeIndex:L,isActive:R}=(e=kr(oe=>uqe(oe,k,E,T)))!==null&&e!==void 0?e:{},V=kr(oe=>cqe(oe,k,E,T)),Y=kr(oe=>Rie(oe,k,E,T)),X=kr(oe=>lqe(oe,k,E,T)),J=V,re=Oqe(),se=(r=i??R)!==null&&r!==void 0?r:!1,[ee,q]=Are([J,se]),U=k==="axis"?Y:void 0;Qqe(k,E,X,U,L,se);var W=O??re;if(W==null||M==null||k==null)return null;var Z=J??OH;se||(Z=OH),u&&Z.length&&(Z=kre(Z.filter(oe=>oe.value!=null&&(oe.hide!==!0||n.includeHidden)),m,tVe));var de=Z.length>0,be=y.createElement(YDe,{allowEscapeViewBox:a,animationDuration:o,animationEasing:l,isAnimationActive:h,active:se,coordinate:X,hasPayload:de,offset:p,position:g,reverseDirection:b,useTranslate3d:v,viewBox:M,wrapperStyle:w,lastBoundingBox:ee,innerRef:q,hasPortalFromProps:!!O},rVe(c,PH(PH({},n),{},{payload:Z,label:U,active:se,activeIndex:L,coordinate:X,accessibilityLayer:$})));return y.createElement(y.Fragment,null,Vn.createPortal(be,W),se&&y.createElement(Pqe,{cursor:j,tooltipEventType:k,coordinate:X,payload:Z,index:L}))}var ab=t=>null;ab.displayName="Cell";function sVe(t,e,r){return(e=iVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iVe(t){var e=aVe(t,"string");return typeof e=="symbol"?e:e+""}function aVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oVe{constructor(e){sVe(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function MH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lVe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MH(Object(r),!0).forEach(function(n){cVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cVe(t,e,r){return(e=uVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uVe(t){var e=dVe(t,"string");return typeof e=="symbol"?e:e+""}function dVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hVe={cacheSize:2e3,enableCache:!0},Uie=lVe({},hVe),DH=new oVe(Uie.cacheSize),fVe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},BH="recharts_measurement_span";function pVe(t,e){var r=e.fontSize||"",n=e.fontFamily||"",i=e.fontWeight||"",a=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(o,"|").concat(l)}var $H=(t,e)=>{try{var r=document.getElementById(BH);r||(r=document.createElement("span"),r.setAttribute("id",BH),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,fVe,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Av=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||n_.isSsr)return{width:0,height:0};if(!Uie.enableCache)return $H(e,r);var n=pVe(e,r),i=DH.get(n);if(i)return i;var a=$H(e,r);return DH.set(n,a),a},zie;function mVe(t,e,r){return(e=gVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gVe(t){var e=xVe(t,"string");return typeof e=="symbol"?e:e+""}function xVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,bVe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,yVe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,vVe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},wVe=["cm","mm","pt","pc","in","Q","px"];function NVe(t){return wVe.includes(t)}var cx="NaN";function jVe(t,e){return t*vVe[e]}class Co{static parse(e){var r,[,n,i]=(r=yVe.exec(e))!==null&&r!==void 0?r:[];return n==null?Co.NaN:new Co(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Vd(e)&&(this.unit=""),r!==""&&!bVe.test(r)&&(this.num=NaN,this.unit=""),NVe(r)&&(this.num=jVe(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new Co(NaN,""):new Co(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Co(NaN,""):new Co(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Co(NaN,""):new Co(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Co(NaN,""):new Co(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vd(this.num)}}zie=Co;mVe(Co,"NaN",new zie(NaN,""));function qie(t){if(t==null||t.includes(cx))return cx;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=FH.exec(e))!==null&&r!==void 0?r:[],o=Co.parse(n??""),l=Co.parse(a??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return cx;e=e.replace(FH,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,h,p,m]=(u=UH.exec(e))!==null&&u!==void 0?u:[],g=Co.parse(h??""),b=Co.parse(m??""),v=p==="+"?g.add(b):g.subtract(b);if(v.isNaN())return cx;e=e.replace(UH,v.toString())}return e}var zH=/\(([^()]*)\)/;function kVe(t){for(var e=t,r;(r=zH.exec(e))!=null;){var[,n]=r;e=e.replace(zH,qie(n))}return e}function _Ve(t){var e=t.replace(/\s+/g,"");return e=kVe(e),e=qie(e),e}function SVe(t){try{return _Ve(t)}catch{return cx}}function u6(t){var e=SVe(t.slice(5,-1));return e===cx?"":e}var CVe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],EVe=["dx","dy","angle","className","breakAll"];function N8(){return N8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},N8.apply(null,arguments)}function qH(t,e){if(t==null)return{};var r,n,i=AVe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function AVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Vie=/[ \f\n\r\t\v\u2028\u2029]+/,Hie=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];lo(e)||(r?i=e.toString().split(""):i=e.toString().split(Vie));var a=i.map(l=>({word:l,width:Av(l,n).width})),o=r?0:Av("",n).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}};function TVe(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Wie=(t,e,r,n)=>t.reduce((i,a)=>{var{word:o,width:l}=a,c=i[i.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),Gie=t=>t.reduce((e,r)=>e.width>r.width?e:r),IVe="",VH=(t,e,r,n,i,a,o,l)=>{var c=t.slice(0,e),u=Hie({breakAll:r,style:n,children:c+IVe});if(!u)return[!1,[]];var h=Wie(u.wordsWithComputedWidth,a,o,l),p=h.length>i||Gie(h).width>Number(a);return[p,h]},LVe=(t,e,r,n,i)=>{var{maxLines:a,children:o,style:l,breakAll:c}=t,u=Tr(a),h=String(o),p=Wie(e,n,r,i);if(!u||i)return p;var m=p.length>a||Gie(p).width>Number(n);if(!m)return p;for(var g=0,b=h.length-1,v=0,w;g<=b&&v<=h.length-1;){var j=Math.floor((g+b)/2),_=j-1,[E,I]=VH(h,_,c,l,a,n,r,i),[O]=VH(h,j,c,l,a,n,r,i);if(!E&&!O&&(g=j+1),E&&O&&(b=j-1),!E&&O){w=I;break}v++}return w||p},HH=t=>{var e=lo(t)?[]:t.toString().split(Vie);return[{words:e,width:void 0}]},PVe=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:o}=t;if((e||r)&&!n_.isSsr){var l,c,u=Hie({breakAll:a,children:n,style:i});if(u){var{wordsWithComputedWidth:h,spaceWidth:p}=u;l=h,c=p}else return HH(n);return LVe({breakAll:a,children:n,maxLines:o,style:i},l,c,e,!!r)}return HH(n)},Kie="#808080",OVe={angle:0,breakAll:!1,capHeight:"0.71em",fill:Kie,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},j_=y.forwardRef((t,e)=>{var r=Do(t,OVe),{x:n,y:i,lineHeight:a,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:h}=r,p=qH(r,CVe),m=y.useMemo(()=>PVe({breakAll:p.breakAll,children:p.children,maxLines:p.maxLines,scaleToFit:c,style:p.style,width:p.width}),[p.breakAll,p.children,p.maxLines,c,p.style,p.width]),{dx:g,dy:b,angle:v,className:w,breakAll:j}=p,_=qH(p,EVe);if(!Hd(n)||!Hd(i)||m.length===0)return null;var E=Number(n)+(Tr(g)?g:0),I=Number(i)+(Tr(b)?b:0);if(!Ti(E)||!Ti(I))return null;var O;switch(h){case"start":O=u6("calc(".concat(o,")"));break;case"middle":O=u6("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:O=u6("calc(".concat(m.length-1," * -").concat(a,")"));break}var B=[];if(c){var S=m[0].width,{width:T}=p;B.push("scale(".concat(Tr(T)&&Tr(S)?T/S:1,")"))}return v&&B.push("rotate(".concat(v,", ").concat(E,", ").concat(I,")")),B.length&&(_.transform=B.join(" ")),y.createElement("text",N8({},iu(_),{ref:e,x:E,y:I,className:gs("recharts-text",w),textAnchor:u,fill:l.includes("url")?Kie:l}),m.map((M,$)=>{var k=M.words.join(j?"":" ");return y.createElement("tspan",{x:E,dy:$===0?O:a,key:"".concat(k,"-").concat($)},k)}))});j_.displayName="Text";var RVe=["labelRef"],MVe=["content"];function WH(t,e){if(t==null)return{};var r,n,i=DVe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function DVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function GH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ea(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GH(Object(r),!0).forEach(function(n){BVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BVe(t,e,r){return(e=$Ve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Ve(t){var e=FVe(t,"string");return typeof e=="symbol"?e:e+""}function FVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ih(){return Ih=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ih.apply(null,arguments)}var Yie=y.createContext(null),UVe=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:o,children:l}=t,c=y.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:o}),[e,r,n,i,a,o]);return y.createElement(Yie.Provider,{value:c},l)},Xie=()=>{var t=y.useContext(Yie),e=Jk();return t||hne(e)},zVe=y.createContext(null),qVe=()=>{var t=y.useContext(zVe),e=kr(Fse);return t||e},VVe=t=>{var{value:e,formatter:r}=t,n=lo(t.children)?e:t.children;return typeof r=="function"?r(n):n},IO=t=>t!=null&&typeof t=="function",HVe=(t,e)=>{var r=Po(e-t),n=Math.min(Math.abs(e-t),360);return r*n},WVe=(t,e,r,n,i)=>{var{offset:a,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:h,startAngle:p,endAngle:m,clockWise:g}=i,b=(u+h)/2,v=HVe(p,m),w=v>=0?1:-1,j,_;switch(e){case"insideStart":j=p+w*a,_=g;break;case"insideEnd":j=m-w*a,_=!g;break;case"end":j=m+w*a,_=g;break;default:throw new Error("Unsupported position ".concat(e))}_=v<=0?_:!_;var E=ya(l,c,b,j),I=ya(l,c,b,j+(_?1:-1)*359),O="M".concat(E.x,",").concat(E.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(_?0:1,`,
    `).concat(I.x,",").concat(I.y),B=lo(t.id)?p1("recharts-radial-line-"):t.id;return y.createElement("text",Ih({},n,{dominantBaseline:"central",className:gs("recharts-radial-bar-label",o)}),y.createElement("defs",null,y.createElement("path",{id:B,d:O})),y.createElement("textPath",{xlinkHref:"#".concat(B)},r))},GVe=(t,e,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:h,y:p}=ya(n,i,o+e,u);return{x:h,y:p,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(a+o)/2,{x:g,y:b}=ya(n,i,m,u);return{x:g,y:b,textAnchor:"middle",verticalAnchor:"middle"}},j8=t=>"cx"in t&&Tr(t.cx),KVe=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,a;r!=null&&!j8(r)&&(a=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:h}=e,p=o,m=o+(c-u)/2,g=(p+m)/2,b=(c+u)/2,v=p+c/2,w=h>=0?1:-1,j=w*n,_=w>0?"end":"start",E=w>0?"start":"end",I=c>=0?1:-1,O=I*n,B=I>0?"end":"start",S=I>0?"start":"end";if(i==="top"){var T={x:p+c/2,y:l-j,textAnchor:"middle",verticalAnchor:_};return ea(ea({},T),a?{height:Math.max(l-a.y,0),width:c}:{})}if(i==="bottom"){var M={x:m+u/2,y:l+h+j,textAnchor:"middle",verticalAnchor:E};return ea(ea({},M),a?{height:Math.max(a.y+a.height-(l+h),0),width:u}:{})}if(i==="left"){var $={x:g-O,y:l+h/2,textAnchor:B,verticalAnchor:"middle"};return ea(ea({},$),a?{width:Math.max($.x-a.x,0),height:h}:{})}if(i==="right"){var k={x:g+b+O,y:l+h/2,textAnchor:S,verticalAnchor:"middle"};return ea(ea({},k),a?{width:Math.max(a.x+a.width-k.x,0),height:h}:{})}var L=a?{width:b,height:h}:{};return i==="insideLeft"?ea({x:g+O,y:l+h/2,textAnchor:S,verticalAnchor:"middle"},L):i==="insideRight"?ea({x:g+b-O,y:l+h/2,textAnchor:B,verticalAnchor:"middle"},L):i==="insideTop"?ea({x:p+c/2,y:l+j,textAnchor:"middle",verticalAnchor:E},L):i==="insideBottom"?ea({x:m+u/2,y:l+h-j,textAnchor:"middle",verticalAnchor:_},L):i==="insideTopLeft"?ea({x:p+O,y:l+j,textAnchor:S,verticalAnchor:E},L):i==="insideTopRight"?ea({x:p+c-O,y:l+j,textAnchor:B,verticalAnchor:E},L):i==="insideBottomLeft"?ea({x:m+O,y:l+h-j,textAnchor:S,verticalAnchor:_},L):i==="insideBottomRight"?ea({x:m+u-O,y:l+h-j,textAnchor:B,verticalAnchor:_},L):i&&typeof i=="object"&&(Tr(i.x)||Zh(i.x))&&(Tr(i.y)||Zh(i.y))?ea({x:o+el(i.x,b),y:l+el(i.y,h),textAnchor:"end",verticalAnchor:"end"},L):ea({x:v,y:l+h/2,textAnchor:"middle",verticalAnchor:"middle"},L)},YVe={angle:0,offset:5,zIndex:Zo.label,position:"middle",textBreakAll:!1};function o0(t){var e=Do(t,YVe),{viewBox:r,position:n,value:i,children:a,content:o,className:l="",textBreakAll:c,labelRef:u}=e,h=qVe(),p=Xie(),m=n==="center"?p:h??p,g,b,v;if(r==null?g=m:j8(r)?g=r:g=hne(r),!g||lo(i)&&lo(a)&&!y.isValidElement(o)&&typeof o!="function")return null;var w=ea(ea({},e),{},{viewBox:g});if(y.isValidElement(o)){var{labelRef:j}=w,_=WH(w,RVe);return y.cloneElement(o,_)}if(typeof o=="function"){var{content:E}=w,I=WH(w,MVe);if(b=y.createElement(o,I),y.isValidElement(b))return b}else b=VVe(e);var O=iu(e);if(j8(g)){if(n==="insideStart"||n==="insideEnd"||n==="end")return WVe(e,n,b,O,g);v=GVe(g,e.offset,e.position)}else v=KVe(e,g);return y.createElement(eh,{zIndex:e.zIndex},y.createElement(j_,Ih({ref:u,className:gs("recharts-label",l)},O,v,{textAnchor:TVe(O.textAnchor)?O.textAnchor:v.textAnchor,breakAll:c}),b))}o0.displayName="Label";var XVe=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?y.createElement(o0,Ih({key:"label-implicit"},n)):Hd(t)?y.createElement(o0,Ih({key:"label-implicit",value:t},n)):y.isValidElement(t)?t.type===o0?y.cloneElement(t,ea({key:"label-implicit"},n)):y.createElement(o0,Ih({key:"label-implicit",content:t},n)):IO(t)?y.createElement(o0,Ih({key:"label-implicit",content:t},n)):t&&typeof t=="object"?y.createElement(o0,Ih({},t,{key:"label-implicit"},n)):null};function QVe(t){var{label:e,labelRef:r}=t,n=Xie();return XVe(e,n,r)||null}var d6={},h6={},KH;function JVe(){return KH||(KH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(h6)),h6}var f6={},YH;function ZVe(){return YH||(YH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(f6)),f6}var XH;function eHe(){return XH||(XH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JVe(),r=ZVe(),n=aP();function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(d6)),d6}var p6,QH;function tHe(){return QH||(QH=1,p6=eHe().last),p6}var rHe=tHe();const nHe=bl(rHe);var sHe=["valueAccessor"],iHe=["dataKey","clockWise","id","textBreakAll","zIndex"];function u4(){return u4=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u4.apply(null,arguments)}function JH(t,e){if(t==null)return{};var r,n,i=aHe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function aHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var oHe=t=>Array.isArray(t.value)?nHe(t.value):t.value,Qie=y.createContext(void 0),lHe=Qie.Provider,Jie=y.createContext(void 0),cHe=Jie.Provider;function uHe(){return y.useContext(Qie)}function dHe(){return y.useContext(Jie)}function NN(t){var{valueAccessor:e=oHe}=t,r=JH(t,sHe),{dataKey:n,clockWise:i,id:a,textBreakAll:o,zIndex:l}=r,c=JH(r,iHe),u=uHe(),h=dHe(),p=u||h;return!p||!p.length?null:y.createElement(eh,{zIndex:l??Zo.label},y.createElement(gl,{className:"recharts-label-list"},p.map((m,g)=>{var b,v=lo(n)?e(m,g):si(m&&m.payload,n),w=lo(a)?{}:{id:"".concat(a,"-").concat(g)};return y.createElement(o0,u4({key:"label-".concat(g)},iu(m),c,w,{fill:(b=r.fill)!==null&&b!==void 0?b:m.fill,parentViewBox:m.parentViewBox,value:v,textBreakAll:o,viewBox:m.viewBox,index:g,zIndex:0}))})))}NN.displayName="LabelList";function Zie(t){var{label:e}=t;return e?e===!0?y.createElement(NN,{key:"labelList-implicit"}):y.isValidElement(e)||IO(e)?y.createElement(NN,{key:"labelList-implicit",content:e}):typeof e=="object"?y.createElement(NN,u4({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var eae=t=>t.graphicalItems.polarItems,hHe=it([vi,w2],eO),k_=it([eae,Ii,hHe],rO),fHe=it([k_],nO),__=it([fHe,h_],sO),pHe=it([__,Ii,k_],aO);it([__,Ii,k_],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(i=>{var a,o=si(n,(a=e.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:si(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var ZH=()=>{},mHe=it([__,Ii,k_,y_,vi],uO),gHe=it([Ii,lO,cO,ZH,mHe,ZH,Jn,vi],dO),tae=it([Ii,Jn,__,pHe,v2,vi,gHe],hO),xHe=it([tae,Ii,Eb],mO);it([Ii,tae,xHe,vi],xO);var bHe={radiusAxis:{},angleAxis:{}},rae=ec({name:"polarAxis",initialState:bHe,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:gJe,removeRadiusAxis:xJe,addAngleAxis:bJe,removeAngleAxis:yJe}=rae.actions,yHe=rae.reducer;function eW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eW(Object(r),!0).forEach(function(n){vHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vHe(t,e,r){return(e=wHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wHe(t){var e=NHe(t,"string");return typeof e=="symbol"?e:e+""}function NHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jHe=(t,e)=>e,LO=it([eae,jHe],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),kHe=[],PO=(t,e,r)=>r?.length===0?kHe:r,nae=it([h_,LO,PO],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var i;if(e?.data!=null&&e.data.length>0?i=e.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>tW(tW({},e.presentationProps),a.props))),i!=null)return i}}),_He=it([nae,LO,PO],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,i)=>{var a,o=si(n,e.nameKey,e.name),l;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:Gk(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),SHe=it([nae,LO,PO,za],(t,e,r,n)=>{if(!(e==null||t==null))return TWe({offset:n,pieSettings:e,displayedData:t,cells:r})}),m6={exports:{}},Cs={};var rW;function CHe(){if(rW)return Cs;rW=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function b(v){if(typeof v=="object"&&v!==null){var w=v.$$typeof;switch(w){case t:switch(v=v.type,v){case r:case i:case n:case c:case u:case m:return v;default:switch(v=v&&v.$$typeof,v){case o:case l:case p:case h:return v;case a:return v;default:return w}}case e:return w}}}return Cs.ContextConsumer=a,Cs.ContextProvider=o,Cs.Element=t,Cs.ForwardRef=l,Cs.Fragment=r,Cs.Lazy=p,Cs.Memo=h,Cs.Portal=e,Cs.Profiler=i,Cs.StrictMode=n,Cs.Suspense=c,Cs.SuspenseList=u,Cs.isContextConsumer=function(v){return b(v)===a},Cs.isContextProvider=function(v){return b(v)===o},Cs.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},Cs.isForwardRef=function(v){return b(v)===l},Cs.isFragment=function(v){return b(v)===r},Cs.isLazy=function(v){return b(v)===p},Cs.isMemo=function(v){return b(v)===h},Cs.isPortal=function(v){return b(v)===e},Cs.isProfiler=function(v){return b(v)===i},Cs.isStrictMode=function(v){return b(v)===n},Cs.isSuspense=function(v){return b(v)===c},Cs.isSuspenseList=function(v){return b(v)===u},Cs.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===r||v===i||v===n||v===c||v===u||typeof v=="object"&&v!==null&&(v.$$typeof===p||v.$$typeof===h||v.$$typeof===o||v.$$typeof===a||v.$$typeof===l||v.$$typeof===g||v.getModuleId!==void 0)},Cs.typeOf=b,Cs}var nW;function EHe(){return nW||(nW=1,m6.exports=CHe()),m6.exports}var AHe=EHe(),sW=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",iW=null,g6=null,sae=t=>{if(t===iW&&Array.isArray(g6))return g6;var e=[];return y.Children.forEach(t,r=>{lo(r)||(AHe.isFragment(r)?e=e.concat(sae(r.props.children)):e.push(r))}),g6=e,iW=t,e};function OO(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>sW(i)):n=[sW(e)],sae(t).forEach(i=>{var a=wm(i,"type.displayName")||wm(i,"type.name");a&&n.indexOf(a)!==-1&&r.push(i)}),r}var x6={},aW;function THe(){return aW||(aW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(x6)),x6}var b6,oW;function IHe(){return oW||(oW=1,b6=THe().isPlainObject),b6}var LHe=IHe();const PHe=bl(LHe);var lW,cW,uW,dW,hW;function fW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fW(Object(r),!0).forEach(function(n){OHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OHe(t,e,r){return(e=RHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RHe(t){var e=MHe(t,"string");return typeof e=="symbol"?e:e+""}function MHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d4(){return d4=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},d4.apply(null,arguments)}function Fy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var mW=(t,e,r,n,i)=>{var a=r-n,o;return o=Hi(lW||(lW=Fy(["M ",",",""])),t,e),o+=Hi(cW||(cW=Fy(["L ",",",""])),t+r,e),o+=Hi(uW||(uW=Fy(["L ",",",""])),t+r-a/2,e+i),o+=Hi(dW||(dW=Fy(["L ",",",""])),t+r-a/2-n,e+i),o+=Hi(hW||(hW=Fy(["L ",","," Z"])),t,e),o},DHe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},BHe=t=>{var e=Do(t,DHe),{x:r,y:n,upperWidth:i,lowerWidth:a,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:h,isUpdateAnimationActive:p}=e,m=y.useRef(null),[g,b]=y.useState(-1),v=y.useRef(i),w=y.useRef(a),j=y.useRef(o),_=y.useRef(r),E=y.useRef(n),I=i_(t,"trapezoid-");if(y.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var V=m.current.getTotalLength();V&&b(V)}catch{}},[]),r!==+r||n!==+n||i!==+i||a!==+a||o!==+o||i===0&&a===0||o===0)return null;var O=gs("recharts-trapezoid",l);if(!p)return y.createElement("g",null,y.createElement("path",d4({},iu(e),{className:O,d:mW(r,n,i,a,o)})));var B=v.current,S=w.current,T=j.current,M=_.current,$=E.current,k="0px ".concat(g===-1?1:g,"px"),L="".concat(g,"px 0px"),R=Cne(["strokeDasharray"],u,c);return y.createElement(s_,{animationId:I,key:I,canBegin:g>0,duration:u,easing:c,isActive:p,begin:h},V=>{var Y=Ra(B,i,V),X=Ra(S,a,V),J=Ra(T,o,V),re=Ra(M,r,V),se=Ra($,n,V);m.current&&(v.current=Y,w.current=X,j.current=J,_.current=re,E.current=se);var ee=V>0?{transition:R,strokeDasharray:L}:{strokeDasharray:k};return y.createElement("path",d4({},iu(e),{className:O,d:mW(re,se,Y,X,J),ref:m,style:pW(pW({},ee),e.style)}))})},$He=["option","shapeType","activeClassName"];function FHe(t,e){if(t==null)return{};var r,n,i=UHe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function UHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function gW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function h4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gW(Object(r),!0).forEach(function(n){zHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zHe(t,e,r){return(e=qHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qHe(t){var e=VHe(t,"string");return typeof e=="symbol"?e:e+""}function VHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HHe(t,e){return h4(h4({},e),t)}function WHe(t,e){return t==="symbols"}function xW(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return y.createElement(Ine,r);case"trapezoid":return y.createElement(BHe,r);case"sector":return y.createElement(Rne,r);case"symbols":if(WHe(e))return y.createElement(iP,r);break;case"curve":return y.createElement(vP,r);default:return null}}function GHe(t){return y.isValidElement(t)?t.props:t}function iae(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,i=FHe(t,$He),a;if(y.isValidElement(e))a=y.cloneElement(e,h4(h4({},i),GHe(e)));else if(typeof e=="function")a=e(i,i.index);else if(PHe(e)&&typeof e!="boolean"){var o=HHe(e,i);a=y.createElement(xW,{shapeType:r,elementProps:o})}else{var l=i;a=y.createElement(xW,{shapeType:r,elementProps:l})}return i.isActive?y.createElement(gl,{className:n},a):a}var RO=(t,e,r)=>{var n=Hs();return(i,a)=>o=>{t?.(i,a,o),n(xie({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},MO=t=>{var e=Hs();return(r,n)=>i=>{t?.(r,n,i),e(nze())}},DO=(t,e,r)=>{var n=Hs();return(i,a)=>o=>{t?.(i,a,o),n(sze({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function aae(t){var{tooltipEntrySettings:e}=t,r=Hs(),n=Ec(),i=y.useRef(null);return y.useLayoutEffect(()=>{n||(i.current===null?r(ZUe(e)):i.current!==e&&r(eze({prev:i.current,next:e})),i.current=e)},[e,r,n]),y.useLayoutEffect(()=>()=>{i.current&&(r(tze(i.current)),i.current=null)},[r]),null}function KHe(t){var{legendPayload:e}=t,r=Hs(),n=Ec(),i=y.useRef(null);return y.useLayoutEffect(()=>{n||(i.current===null?r(Nne(e)):i.current!==e&&r(jne({prev:i.current,next:e})),i.current=e)},[r,n,e]),y.useLayoutEffect(()=>()=>{i.current&&(r(kne(i.current)),i.current=null)},[r]),null}function YHe(t){var{legendPayload:e}=t,r=Hs(),n=kr(Jn),i=y.useRef(null);return y.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(Nne(e)):i.current!==e&&r(jne({prev:i.current,next:e})),i.current=e)},[r,n,e]),y.useLayoutEffect(()=>()=>{i.current&&(r(kne(i.current)),i.current=null)},[r]),null}var y6,XHe=()=>{var[t]=y.useState(()=>p1("uid-"));return t},QHe=(y6=C6.useId)!==null&&y6!==void 0?y6:XHe;function JHe(t,e){var r=QHe();return e||(t?"".concat(t,"-").concat(r):r)}var ZHe=y.createContext(void 0),oae=t=>{var{id:e,type:r,children:n}=t,i=JHe("recharts-".concat(r),e);return y.createElement(ZHe.Provider,{value:i},n(i))},eWe={cartesianItems:[],polarItems:[]},lae=ec({name:"graphicalItems",initialState:eWe,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:gi()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,i=qu(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},prepare:gi()},removeCartesianGraphicalItem:{reducer(t,e){var r=qu(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:gi()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:gi()},removePolarGraphicalItem:{reducer(t,e){var r=qu(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:gi()}}}),{addCartesianGraphicalItem:tWe,replaceCartesianGraphicalItem:rWe,removeCartesianGraphicalItem:nWe,addPolarGraphicalItem:sWe,removePolarGraphicalItem:iWe}=lae.actions,aWe=lae.reducer,oWe=t=>{var e=Hs(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e(tWe(t)):r.current!==t&&e(rWe({prev:r.current,next:t})),r.current=t},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(e(nWe(r.current)),r.current=null)},[e]),null},lWe=y.memo(oWe);function cWe(t){var e=Hs();return y.useLayoutEffect(()=>(e(sWe(t)),()=>{e(iWe(t))}),[e,t]),null}var uWe=["key"],dWe=["onMouseEnter","onClick","onMouseLeave"],hWe=["id"],fWe=["id"];function bW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Wi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bW(Object(r),!0).forEach(function(n){pWe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pWe(t,e,r){return(e=mWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mWe(t){var e=gWe(t,"string");return typeof e=="symbol"?e:e+""}function gWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $0(){return $0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$0.apply(null,arguments)}function S_(t,e){if(t==null)return{};var r,n,i=xWe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function xWe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bWe(t){var e=y.useMemo(()=>OO(t.children,ab),[t.children]),r=kr(n=>_He(n,t.id,e));return r==null?null:y.createElement(YHe,{legendPayload:r})}var yWe=y.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:o,name:l,hide:c,tooltipType:u,id:h}=t,p={dataDefinedOnItem:n.map(m=>m.tooltipPayload),positions:n.map(m=>m.tooltipPosition),settings:{stroke:i,strokeWidth:a,fill:o,dataKey:e,nameKey:r,name:Gk(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:h}};return y.createElement(aae,{tooltipEntrySettings:p})}),vWe=(t,e)=>t>e?"start":t<e?"end":"middle",wWe=(t,e,r)=>el(typeof e=="function"?e(t):e,r,r*.8),NWe=(t,e,r)=>{var{top:n,left:i,width:a,height:o}=e,l=Lne(a,o),c=i+el(t.cx,a,a/2),u=n+el(t.cy,o,o/2),h=el(t.innerRadius,l,0),p=wWe(r,t.outerRadius,l),m=t.maxRadius||Math.sqrt(a*a+o*o)/2;return{cx:c,cy:u,innerRadius:h,outerRadius:p,maxRadius:m}},jWe=(t,e)=>{var r=Po(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function kWe(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var _We=(t,e)=>{if(y.isValidElement(t))return y.cloneElement(t,e);if(typeof t=="function")return t(e);var r=gs("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,i=S_(e,uWe);return y.createElement(vP,$0({},i,{type:"linear",className:r}))},SWe=(t,e,r)=>{if(y.isValidElement(t))return y.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),y.isValidElement(n)))return n;var i=gs("recharts-pie-label-text",kWe(t));return y.createElement(j_,$0({},e,{alignmentBaseline:"middle",className:i}),n)};function CWe(t){var{sectors:e,props:r,showLabels:n}=t,{label:i,labelLine:a,dataKey:o}=r;if(!n||!i||!e)return null;var l=qd(r),c=f1(i),u=f1(a),h=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,p=e.map((m,g)=>{var b=(m.startAngle+m.endAngle)/2,v=ya(m.cx,m.cy,m.outerRadius+h,b),w=Wi(Wi(Wi(Wi({},l),m),{},{stroke:"none"},c),{},{index:g,textAnchor:vWe(v.x,m.cx)},v),j=Wi(Wi(Wi(Wi({},l),m),{},{fill:"none",stroke:m.fill},u),{},{index:g,points:[ya(m.cx,m.cy,m.outerRadius,b),v],key:"line"});return y.createElement(eh,{zIndex:Zo.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(g)},y.createElement(gl,null,a&&_We(a,j),SWe(i,w,si(m,o))))});return y.createElement(gl,{className:"recharts-pie-labels"},p)}function EWe(t){var{sectors:e,props:r,showLabels:n}=t,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?y.createElement(Zie,{label:i}):y.createElement(CWe,{sectors:e,props:r,showLabels:n})}function AWe(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:a,id:o}=t,l=kr(Sm),c=kr(SO),u=kr(qze),{onMouseEnter:h,onClick:p,onMouseLeave:m}=i,g=S_(i,dWe),b=RO(h,i.dataKey,o),v=MO(m),w=DO(p,i.dataKey,o);return e==null||e.length===0?null:y.createElement(y.Fragment,null,e.map((j,_)=>{if(j?.startAngle===0&&j?.endAngle===0&&e.length!==1)return null;var E=u==null||u===o,I=String(_)===l&&(c==null||i.dataKey===c)&&E,O=l?n:null,B=r&&I?r:O,S=Wi(Wi({},j),{},{stroke:j.stroke,tabIndex:-1,[one]:_,[lne]:o});return y.createElement(gl,$0({key:"sector-".concat(j?.startAngle,"-").concat(j?.endAngle,"-").concat(j.midAngle,"-").concat(_),tabIndex:-1,className:"recharts-pie-sector"},c2(g,j,_),{onMouseEnter:b(j,_),onMouseLeave:v(j,_),onClick:w(j,_)}),y.createElement(iae,$0({option:a??B,index:_,shapeType:"sector",isActive:I},S)))}))}function TWe(t){var e,{pieSettings:r,displayedData:n,cells:i,offset:a}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:h,tooltipType:p}=r,m=Math.abs(r.minAngle),g=jWe(l,c),b=Math.abs(g),v=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,w=n.filter(B=>si(B,u,0)!==0).length,j=(b>=360?w:w-1)*v,_=b-w*m-j,E=n.reduce((B,S)=>{var T=si(S,u,0);return B+(Tr(T)?T:0)},0),I;if(E>0){var O;I=n.map((B,S)=>{var T=si(B,u,0),M=si(B,h,S),$=NWe(r,a,B),k=(Tr(T)?T:0)/E,L,R=Wi(Wi({},B),i&&i[S]&&i[S].props);S?L=O.endAngle+Po(g)*v*(T!==0?1:0):L=l;var V=L+Po(g)*((T!==0?m:0)+k*_),Y=(L+V)/2,X=($.innerRadius+$.outerRadius)/2,J=[{name:M,value:T,payload:R,dataKey:u,type:p,graphicalItemId:r.id}],re=ya($.cx,$.cy,X,Y);return O=Wi(Wi(Wi(Wi({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:J,midAngle:Y,middleRadius:X,tooltipPosition:re},R),$),{},{value:T,dataKey:u,startAngle:L,endAngle:V,payload:R,paddingAngle:Po(g)*v}),O})}return I}function IWe(t){var{showLabels:e,sectors:r,children:n}=t,i=y.useMemo(()=>!e||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,e]);return y.createElement(cHe,{value:e?i:void 0},n)}function LWe(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:i,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:h,onAnimationStart:p,onAnimationEnd:m}=e,g=i_(e,"recharts-pie-"),b=r.current,[v,w]=y.useState(!1),j=y.useCallback(()=>{typeof m=="function"&&m(),w(!1)},[m]),_=y.useCallback(()=>{typeof p=="function"&&p(),w(!0)},[p]);return y.createElement(IWe,{showLabels:!v,sectors:i},y.createElement(s_,{animationId:g,begin:o,duration:l,isActive:a,easing:c,onAnimationStart:_,onAnimationEnd:j,key:g},E=>{var I=[],O=i&&i[0],B=O?.startAngle;return i?.forEach((S,T)=>{var M=b&&b[T],$=T>0?wm(S,"paddingAngle",0):0;if(M){var k=Ra(M.endAngle-M.startAngle,S.endAngle-S.startAngle,E),L=Wi(Wi({},S),{},{startAngle:B+$,endAngle:B+k+$});I.push(L),B=L.endAngle}else{var{endAngle:R,startAngle:V}=S,Y=Ra(0,R-V,E),X=Wi(Wi({},S),{},{startAngle:B+$,endAngle:B+Y+$});I.push(X),B=X.endAngle}}),r.current=I,y.createElement(gl,null,y.createElement(AWe,{sectors:I,activeShape:u,inactiveShape:h,allOtherPieProps:e,shape:e.shape,id:n}))}),y.createElement(EWe,{showLabels:!v,sectors:i,props:e}),e.children)}var PWe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Zo.area};function OWe(t){var{id:e}=t,r=S_(t,hWe),{hide:n,className:i,rootTabIndex:a}=t,o=y.useMemo(()=>OO(t.children,ab),[t.children]),l=kr(h=>SHe(h,e,o)),c=y.useRef(null),u=gs("recharts-pie",i);return n||l==null?(c.current=null,y.createElement(gl,{tabIndex:a,className:u})):y.createElement(eh,{zIndex:t.zIndex},y.createElement(yWe,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),y.createElement(gl,{tabIndex:a,className:u},y.createElement(LWe,{props:Wi(Wi({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function cae(t){var e=Do(t,PWe),{id:r}=e,n=S_(e,fWe),i=qd(n);return y.createElement(oae,{id:r,type:"pie"},a=>y.createElement(y.Fragment,null,y.createElement(cWe,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:e.maxRadius}),y.createElement(bWe,$0({},n,{id:a})),y.createElement(OWe,$0({},n,{id:a}))))}cae.displayName="Pie";function yW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yW(Object(r),!0).forEach(function(n){RWe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RWe(t,e,r){return(e=MWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MWe(t){var e=DWe(t,"string");return typeof e=="symbol"?e:e+""}function DWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uae=0,BWe={xAxis:{},yAxis:{},zAxis:{}},dae=ec({name:"cartesianAxis",initialState:BWe,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:gi()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:gi()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:gi()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:gi()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:gi()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:gi()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:gi()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:gi()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:gi()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,i=t.yAxis[r];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&n===a[1]&&n!==i.width&&Math.abs(n-a[0])<=1)return;var o=[...a,n].slice(-3);t.yAxis[r]=vW(vW({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:$We,replaceXAxis:FWe,removeXAxis:UWe,addYAxis:zWe,replaceYAxis:qWe,removeYAxis:VWe,addZAxis:vJe,replaceZAxis:wJe,removeZAxis:NJe,updateYAxisWidth:HWe}=dae.actions,WWe=dae.reducer,GWe=it([za],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),KWe=it([GWe,mf,gf],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),hae=()=>kr(KWe),wW=(t,e,r)=>{var n=r??t;if(!lo(n))return el(n,e,0)},YWe=(t,e,r)=>{var n={},i=t.filter(m_),a=t.filter(u=>u.stackId==null),o=i.reduce((u,h)=>(u[h.stackId]||(u[h.stackId]=[]),u[h.stackId].push(h),u),n),l=Object.entries(o).map(u=>{var[h,p]=u,m=p.map(b=>b.dataKey),g=wW(e,r,p[0].barSize);return{stackId:h,dataKeys:m,barSize:g}}),c=a.map(u=>{var h=[u.dataKey].filter(m=>m!=null),p=wW(e,r,u.barSize);return{stackId:void 0,dataKeys:h,barSize:p}});return[...l,...c]};function NW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function L5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NW(Object(r),!0).forEach(function(n){XWe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XWe(t,e,r){return(e=QWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QWe(t){var e=JWe(t,"string");return typeof e=="symbol"?e:e+""}function JWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZWe(t,e,r,n,i){var a=n.length;if(!(a<1)){var o=el(t,r,0,!0),l,c=[];if(Ti(n[0].barSize)){var u=!1,h=r/a,p=n.reduce((j,_)=>j+(_.barSize||0),0);p+=(a-1)*o,p>=r&&(p-=(a-1)*o,o=0),p>=r&&h>0&&(u=!0,h*=.9,p=a*h);var m=(r-p)/2>>0,g={offset:m-o,size:0};l=n.reduce((j,_)=>{var E,I={stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:g.offset+g.size+o,size:u?h:(E=_.barSize)!==null&&E!==void 0?E:0}},O=[...j,I];return g=O[O.length-1].position,O},c)}else{var b=el(e,r,0,!0);r-2*b-(a-1)*o<=0&&(o=0);var v=(r-2*b-(a-1)*o)/a;v>1&&(v>>=0);var w=Ti(i)?Math.min(v,i):v;l=n.reduce((j,_,E)=>[...j,{stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:b+(v+o)*E+(v-w)/2,size:w}}],c)}return l}}var eGe=(t,e,r,n,i,a,o)=>{var l=lo(o)?e:o,c=ZWe(r,n,i!==a?i:a,t,l);return i!==a&&c!=null&&(c=c.map(u=>L5(L5({},u),{},{position:L5(L5({},u.position),{},{offset:u.position.offset-i/2})}))),c},tGe=(t,e)=>{var r=JP(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var i=t[n];if(i){var{stackedData:a}=i;if(a)return a.find(o=>o.key===r)}}}};function rGe(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Ti(t.zIndex)?t.zIndex:e}var fae=t=>{var{chartData:e}=t,r=Hs(),n=Ec();return y.useEffect(()=>n?()=>{}:(r(TH(e)),()=>{r(TH(void 0))}),[e,r,n]),null},jW={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},pae=ec({name:"brush",initialState:jW,reducers:{setBrushSettings(t,e){return e.payload==null?jW:e.payload}}}),{setBrushSettings:jJe}=pae.actions,nGe=pae.reducer;function sGe(t,e,r){return(e=iGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iGe(t){var e=aGe(t,"string");return typeof e=="symbol"?e:e+""}function aGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BO{static create(e){return new BO(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}sGe(BO,"EPS",1e-4);function oGe(t){return(t%180+180)%180}var lGe=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=oGe(i),o=a*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},cGe={dots:[],areas:[],lines:[]},mae=ec({name:"referenceElements",initialState:cGe,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=qu(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=qu(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=qu(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:kJe,removeDot:_Je,addArea:SJe,removeArea:CJe,addLine:EJe,removeLine:AJe}=mae.actions,uGe=mae.reducer,dGe=y.createContext(void 0),hGe=t=>{var{children:e}=t,[r]=y.useState("".concat(p1("recharts"),"-clip")),n=hae();if(n==null)return null;var{x:i,y:a,width:o,height:l}=n;return y.createElement(dGe.Provider,{value:r},y.createElement("defs",null,y.createElement("clipPath",{id:r},y.createElement("rect",{x:i,y:a,height:l,width:o}))),e)};function gae(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var i=t[n];i!==void 0&&r.push(i)}return r}function fGe(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return lGe(n,r)}function pGe(t,e,r){var n=r==="width",{x:i,y:a,width:o,height:l}=t;return e===1?{start:n?i:a,end:n?i+o:a+l}:{start:n?i+o:a+l,end:n?i:a}}function E1(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function mGe(t,e){return gae(t,e+1)}function gGe(t,e,r,n,i){for(var a=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,h=o,p=function(){var b=n?.[c];if(b===void 0)return{v:gae(n,u)};var v=c,w,j=()=>(w===void 0&&(w=r(b,v)),w),_=b.coordinate,E=c===0||E1(t,_,j,h,l);E||(c=0,h=o,u+=1),E&&(h=_+t*(j()/2+i),c+=u)},m;u<=a.length;)if(m=p(),m)return m.v;return[]}function xGe(t,e,r,n,i){var a=(n||[]).slice(),o=a.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var h=(o-1)%u,p=l,m=!0,g=function(){var _=n[b],E=b,I,O=()=>(I===void 0&&(I=r(_,E)),I),B=_.coordinate,S=b===h||E1(t,B,O,p,c);if(!S)return m=!1,1;S&&(p=B+t*(O()/2+i))},b=h;b<o&&!g();b+=u);if(m){for(var v=[],w=h;w<o;w+=u)v.push(n[w]);return v}}return[]}function kW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kW(Object(r),!0).forEach(function(n){bGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bGe(t,e,r){return(e=yGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yGe(t){var e=vGe(t,"string");return typeof e=="symbol"?e:e+""}function vGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wGe(t,e,r,n,i){for(var a=(n||[]).slice(),o=a.length,{start:l}=e,{end:c}=e,u=function(m){var g=a[m],b,v=()=>(b===void 0&&(b=r(g,m)),b);if(m===o-1){var w=t*(g.coordinate+t*v()/2-c);a[m]=g=Yo(Yo({},g),{},{tickCoord:w>0?g.coordinate-w*t:g.coordinate})}else a[m]=g=Yo(Yo({},g),{},{tickCoord:g.coordinate});if(g.tickCoord!=null){var j=E1(t,g.tickCoord,v,l,c);j&&(c=g.tickCoord-t*(v()/2+i),a[m]=Yo(Yo({},g),{},{isShow:!0}))}},h=o-1;h>=0;h--)u(h);return a}function NGe(t,e,r,n,i,a){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(a){var h=n[l-1],p=r(h,l-1),m=t*(h.coordinate+t*p/2-u);if(o[l-1]=h=Yo(Yo({},h),{},{tickCoord:m>0?h.coordinate-m*t:h.coordinate}),h.tickCoord!=null){var g=E1(t,h.tickCoord,()=>p,c,u);g&&(u=h.tickCoord-t*(p/2+i),o[l-1]=Yo(Yo({},h),{},{isShow:!0}))}}for(var b=a?l-1:l,v=function(_){var E=o[_],I,O=()=>(I===void 0&&(I=r(E,_)),I);if(_===0){var B=t*(E.coordinate-t*O()/2-c);o[_]=E=Yo(Yo({},E),{},{tickCoord:B<0?E.coordinate-B*t:E.coordinate})}else o[_]=E=Yo(Yo({},E),{},{tickCoord:E.coordinate});if(E.tickCoord!=null){var S=E1(t,E.tickCoord,O,c,u);S&&(c=E.tickCoord+t*(O()/2+i),o[_]=Yo(Yo({},E),{},{isShow:!0}))}},w=0;w<b;w++)v(w);return o}function jGe(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:h,angle:p}=t;if(!i||!i.length||!n)return[];if(Tr(c)||n_.isSsr){var m;return(m=mGe(i,Tr(c)?c:0))!==null&&m!==void 0?m:[]}var g=[],b=l==="top"||l==="bottom"?"width":"height",v=h&&b==="width"?Av(h,{fontSize:e,letterSpacing:r}):{width:0,height:0},w=(E,I)=>{var O=typeof u=="function"?u(E.value,I):E.value;return b==="width"?fGe(Av(O,{fontSize:e,letterSpacing:r}),v,p):Av(O,{fontSize:e,letterSpacing:r})[b]},j=i.length>=2?Po(i[1].coordinate-i[0].coordinate):1,_=pGe(a,j,b);return c==="equidistantPreserveStart"?gGe(j,_,w,i,o):c==="equidistantPreserveEnd"?xGe(j,_,w,i,o):(c==="preserveStart"||c==="preserveStartEnd"?g=NGe(j,_,w,i,o,c==="preserveStartEnd"):g=wGe(j,_,w,i,o),g.filter(E=>E.isShow))}var kGe=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,o=0;if(e){Array.from(e).forEach(h=>{if(h){var p=h.getBoundingClientRect();p.width>o&&(o=p.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+a,u=o+c+l+(r?n:0);return Math.round(u)}return 0},_Ge=["axisLine","width","height","className","hide","ticks","axisType"];function SGe(t,e){if(t==null)return{};var r,n,i=CGe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function CGe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Cm(){return Cm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cm.apply(null,arguments)}function _W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pa(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_W(Object(r),!0).forEach(function(n){EGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_W(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EGe(t,e,r){return(e=AGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AGe(t){var e=TGe(t,"string");return typeof e=="symbol"?e:e+""}function TGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Zo.axis};function IGe(t){var{x:e,y:r,width:n,height:i,orientation:a,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=pa(pa(pa({},c),qd(l)),{},{fill:"none"});if(a==="top"||a==="bottom"){var h=+(a==="top"&&!o||a==="bottom"&&o);u=pa(pa({},u),{},{x1:e,y1:r+h*i,x2:e+n,y2:r+h*i})}else{var p=+(a==="left"&&!o||a==="right"&&o);u=pa(pa({},u),{},{x1:e+p*n,y1:r,x2:e+p*n,y2:r+i})}return y.createElement("line",Cm({},u,{className:gs("recharts-cartesian-axis-line",wm(l,"className"))}))}function LGe(t,e,r,n,i,a,o,l,c){var u,h,p,m,g,b,v=l?-1:1,w=t.tickSize||o,j=Tr(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":u=h=t.coordinate,m=r+ +!l*i,p=m-v*w,b=p-v*c,g=j;break;case"left":p=m=t.coordinate,h=e+ +!l*n,u=h-v*w,g=u-v*c,b=j;break;case"right":p=m=t.coordinate,h=e+ +l*n,u=h+v*w,g=u+v*c,b=j;break;default:u=h=t.coordinate,m=r+ +l*i,p=m+v*w,b=p+v*c,g=j;break}return{line:{x1:u,y1:p,x2:h,y2:m},tick:{x:g,y:b}}}function PGe(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function OGe(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function RGe(t){var{option:e,tickProps:r,value:n}=t,i,a=gs(r.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(e))i=y.cloneElement(e,pa(pa({},r),{},{className:a}));else if(typeof e=="function")i=e(pa(pa({},r),{},{className:a}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=gs(o,e?.className)),i=y.createElement(j_,Cm({},r,{className:o}),n)}return i}var MGe=y.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:a,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:h,mirror:p,x:m,y:g,width:b,height:v,tickSize:w,tickMargin:j,fontSize:_,letterSpacing:E,getTicksConfig:I,events:O,axisType:B}=t,S=jGe(pa(pa({},I),{},{ticks:r}),_,E),T=PGe(h,p),M=OGe(h,p),$=qd(I),k=f1(n),L={};typeof i=="object"&&(L=i);var R=pa(pa({},$),{},{fill:"none"},L),V=S.map(J=>pa({entry:J},LGe(J,m,g,b,v,h,w,p,j))),Y=V.map(J=>{var{entry:re,line:se}=J;return y.createElement(gl,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(re.value,"-").concat(re.coordinate,"-").concat(re.tickCoord)},i&&y.createElement("line",Cm({},R,se,{className:gs("recharts-cartesian-axis-tick-line",wm(i,"className"))})))}),X=V.map((J,re)=>{var{entry:se,tick:ee}=J,q=pa(pa(pa(pa({textAnchor:T,verticalAnchor:M},$),{},{stroke:"none",fill:a},k),ee),{},{index:re,payload:se,visibleTicksCount:S.length,tickFormatter:o,padding:c},u);return y.createElement(gl,Cm({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},c2(O,se,re)),n&&y.createElement(RGe,{option:n,tickProps:q,value:"".concat(typeof o=="function"?o(se.value,re):se.value).concat(l||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(B,"-ticks")},X.length>0&&y.createElement(eh,{zIndex:Zo.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(B,"-tick-labels"),ref:e},X)),Y.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(B,"-tick-lines")},Y))}),DGe=y.forwardRef((t,e)=>{var{axisLine:r,width:n,height:i,className:a,hide:o,ticks:l,axisType:c}=t,u=SGe(t,_Ge),[h,p]=y.useState(""),[m,g]=y.useState(""),b=y.useRef(null);y.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var w;return kGe({ticks:b.current,label:(w=t.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var v=y.useCallback(w=>{if(w){var j=w.getElementsByClassName("recharts-cartesian-axis-tick-value");b.current=j;var _=j[0];if(_){var E=window.getComputedStyle(_),I=E.fontSize,O=E.letterSpacing;(I!==h||O!==m)&&(p(I),g(O))}}},[h,m]);return o||n!=null&&n<=0||i!=null&&i<=0?null:y.createElement(eh,{zIndex:t.zIndex},y.createElement(gl,{className:gs("recharts-cartesian-axis",a)},y.createElement(IGe,{x:t.x,y:t.y,width:n,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:qd(t)}),y.createElement(MGe,{ref:v,axisType:c,events:u,fontSize:h,getTicksConfig:t,height:t.height,letterSpacing:m,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),y.createElement(UVe,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},y.createElement(QVe,{label:t.label,labelRef:t.labelRef}),t.children)))}),$O=y.forwardRef((t,e)=>{var r=Do(t,Yp);return y.createElement(DGe,Cm({},r,{ref:e}))});$O.displayName="CartesianAxis";var BGe={},xae=ec({name:"errorBars",initialState:BGe,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:i}=e.payload;t[r]&&(t[r]=t[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:TJe,replaceErrorBar:IJe,removeErrorBar:LJe}=xae.actions,$Ge=xae.reducer,FGe=["children"];function UGe(t,e){if(t==null)return{};var r,n,i=zGe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function zGe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var qGe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},VGe=y.createContext(qGe);function HGe(t){var{children:e}=t,r=UGe(t,FGe);return y.createElement(VGe.Provider,{value:r},e)}function bae(t,e){var r,n,i=kr(u=>yf(u,t)),a=kr(u=>vf(u,e)),o=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:eo.allowDataOverflow,l=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:to.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function WGe(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=hae(),{needClipX:a,needClipY:o,needClip:l}=bae(e,r);if(!l||!i)return null;var{x:c,y:u,width:h,height:p}=i;return y.createElement("clipPath",{id:"clipPath-".concat(n)},y.createElement("rect",{x:a?c:c-h/2,y:o?u:u-p/2,width:a?h:h*2,height:o?p:p*2}))}function GGe(t){t()}function KGe(){let t=null,e=null;return{clear(){t=null,e=null},notify(){GGe(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var SW={notify(){},get:()=>[]};function YGe(t,e){let r,n=SW,i=0,a=!1;function o(v){h();const w=n.subscribe(v);let j=!1;return()=>{j||(j=!0,w(),p())}}function l(){n.notify()}function c(){b.onStateChange&&b.onStateChange()}function u(){return a}function h(){i++,r||(r=t.subscribe(c),n=KGe())}function p(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=SW)}function m(){a||(a=!0,h())}function g(){a&&(a=!1,p())}const b={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>n};return b}var XGe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QGe=XGe(),JGe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ZGe=JGe(),eKe=()=>QGe||ZGe?y.useLayoutEffect:y.useEffect,tKe=eKe();function CW(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function rKe(t,e){if(CW(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(e,r[i])||!CW(t[r[i]],e[r[i]]))return!1;return!0}var nKe=Symbol.for("react-redux-context"),sKe=typeof globalThis<"u"?globalThis:{};function iKe(){if(!y.createContext)return{};const t=sKe[nKe]??=new Map;let e=t.get(y.createContext);return e||(e=y.createContext(null),t.set(y.createContext,e)),e}var aKe=iKe();function oKe(t){const{children:e,context:r,serverState:n,store:i}=t,a=y.useMemo(()=>{const c=YGe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=y.useMemo(()=>i.getState(),[i]);tKe(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=r||aKe;return y.createElement(l.Provider,{value:a},e)}var lKe=oKe,cKe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function uKe(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function FO(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(cKe.has(n)){if(t[n]==null&&e[n]==null)continue;if(!rKe(t[n],e[n]))return!1}else if(!uKe(t[n],e[n]))return!1;return!0}function Km(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:uae}function Ym(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:uae}var dKe="Invariant failed";function hKe(t,e){throw new Error(dKe)}function k8(){return k8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},k8.apply(null,arguments)}function f4(t){return y.createElement(iae,k8({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var fKe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(Tr(e))return e;var a=Tr(n)||lo(n);return a?e(n,i):(a||hKe(),r)}},pKe=(t,e,r)=>r,mKe=(t,e)=>e,A2=it([tO,mKe],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),gKe=it([A2],t=>t?.maxBarSize),xKe=(t,e,r,n)=>n,bKe=it([Jn,tO,Km,Ym,pKe],(t,e,r,n,i)=>e.filter(a=>t==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),yKe=(t,e,r)=>{var n=Jn(t),i=Km(t,e),a=Ym(t,e);if(!(i==null||a==null))return n==="horizontal"?x8(t,"yAxis",a,r):x8(t,"xAxis",i,r)},vKe=(t,e)=>{var r=Jn(t),n=Km(t,e),i=Ym(t,e);if(!(n==null||i==null))return r==="horizontal"?yH(t,"xAxis",n):yH(t,"yAxis",i)},wKe=it([bKe,WFe,vKe],YWe),NKe=(t,e,r)=>{var n,i,a=A2(t,e);if(a!=null){var o=Km(t,e),l=Ym(t,e);if(!(o==null||l==null)){var c=Jn(t),u=Lse(t),{maxBarSize:h}=a,p=lo(h)?u:h,m,g;return c==="horizontal"?(m=ib(t,"xAxis",o,r),g=sb(t,"xAxis",o,r)):(m=ib(t,"yAxis",l,r),g=sb(t,"yAxis",l,r)),(n=(i=zj(m,g,!0))!==null&&i!==void 0?i:p)!==null&&n!==void 0?n:0}}},yae=(t,e,r)=>{var n=Jn(t),i=Km(t,e),a=Ym(t,e);if(!(i==null||a==null)){var o,l;return n==="horizontal"?(o=ib(t,"xAxis",i,r),l=sb(t,"xAxis",i,r)):(o=ib(t,"yAxis",a,r),l=sb(t,"yAxis",a,r)),zj(o,l)}},jKe=it([wKe,Lse,HFe,Pse,NKe,yae,gKe],eGe),kKe=(t,e,r)=>{var n=Km(t,e);if(n!=null)return ib(t,"xAxis",n,r)},_Ke=(t,e,r)=>{var n=Ym(t,e);if(n!=null)return ib(t,"yAxis",n,r)},SKe=(t,e,r)=>{var n=Km(t,e);if(n!=null)return sb(t,"xAxis",n,r)},CKe=(t,e,r)=>{var n=Ym(t,e);if(n!=null)return sb(t,"yAxis",n,r)},EKe=it([jKe,A2],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),AKe=it([yKe,A2],tGe),TKe=it([za,gP,kKe,_Ke,SKe,CKe,EKe,Jn,PFe,yae,AKe,A2,xKe],(t,e,r,n,i,a,o,l,c,u,h,p,m)=>{var{chartData:g,dataStartIndex:b,dataEndIndex:v}=c;if(!(p==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||a==null||u==null)){var{data:w}=p,j;if(w!=null&&w.length>0?j=w:j=g?.slice(b,v+1),j!=null)return iYe({layout:l,barSettings:p,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:h,displayedData:j,offset:t,cells:m,dataStartIndex:b})}}),IKe=["index"];function _8(){return _8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_8.apply(null,arguments)}function LKe(t,e){if(t==null)return{};var r,n,i=PKe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function PKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vae=y.createContext(void 0),OKe=t=>{var e=y.useContext(vae);if(e!=null)return e.stackId;if(t!=null)return S7e(t)},RKe=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),MKe=t=>{var e=y.useContext(vae);if(e!=null){var{stackId:r}=e;return"url(#".concat(RKe(r,t),")")}},DKe=t=>{var{index:e}=t,r=LKe(t,IKe),n=MKe(e);return y.createElement(gl,_8({className:"recharts-bar-stack-layer",clipPath:n},r))},BKe=["onMouseEnter","onMouseLeave","onClick"],$Ke=["value","background","tooltipPosition"],FKe=["id"],UKe=["onMouseEnter","onClick","onMouseLeave"];function af(){return af=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},af.apply(null,arguments)}function EW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function cl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EW(Object(r),!0).forEach(function(n){zKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zKe(t,e,r){return(e=qKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qKe(t){var e=VKe(t,"string");return typeof e=="symbol"?e:e+""}function VKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p4(t,e){if(t==null)return{};var r,n,i=HKe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function HKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var WKe=t=>{var{dataKey:e,name:r,fill:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:Gk(r,e),payload:t}]},GKe=y.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:i,name:a,hide:o,unit:l,tooltipType:c,id:u}=t,h={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:e,nameKey:void 0,name:Gk(a,e),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return y.createElement(aae,{tooltipEntrySettings:h})});function KKe(t){var e=kr(Sm),{data:r,dataKey:n,background:i,allOtherBarProps:a}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=a,u=p4(a,BKe),h=RO(o,n,a.id),p=MO(l),m=DO(c,n,a.id);if(!i||r==null)return null;var g=f1(i);return y.createElement(eh,{zIndex:rGe(i,Zo.barBackground)},r.map((b,v)=>{var{value:w,background:j,tooltipPosition:_}=b,E=p4(b,$Ke);if(!j)return null;var I=h(b,v),O=p(b,v),B=m(b,v),S=cl(cl(cl(cl(cl({option:i,isActive:String(v)===e},E),{},{fill:"#eee"},j),g),c2(u,b,v)),{},{onMouseEnter:I,onMouseLeave:O,onClick:B,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return y.createElement(f4,af({key:"background-bar-".concat(v)},S))}))}function YKe(t){var{showLabels:e,children:r,rects:n}=t,i=n?.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return cl(cl({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return y.createElement(lHe,{value:e?i:void 0},r)}function XKe(t){var{shape:e,activeBar:r,baseProps:n,entry:i,index:a,dataKey:o}=t,l=kr(Sm),c=kr(SO),u=r&&String(a)===l&&(c==null||o===c),h=u?r:e;return u?y.createElement(eh,{zIndex:Zo.activeBar},y.createElement(f4,af({},n,{name:String(n.name)},i,{isActive:u,option:h,index:a,dataKey:o}))):y.createElement(f4,af({},n,{name:String(n.name)},i,{isActive:u,option:h,index:a,dataKey:o}))}function QKe(t){var{shape:e,baseProps:r,entry:n,index:i,dataKey:a}=t;return y.createElement(f4,af({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:i,dataKey:a}))}function JKe(t){var e,{data:r,props:n}=t,i=(e=qd(n))!==null&&e!==void 0?e:{},{id:a}=i,o=p4(i,FKe),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:h,onClick:p,onMouseLeave:m}=n,g=p4(n,UKe),b=RO(h,c,a),v=MO(m),w=DO(p,c,a);return r?y.createElement(y.Fragment,null,r.map((j,_)=>y.createElement(DKe,af({index:_,key:"rectangle-".concat(j?.x,"-").concat(j?.y,"-").concat(j?.value,"-").concat(_),className:"recharts-bar-rectangle"},c2(g,j,_),{onMouseEnter:b(j,_),onMouseLeave:v(j,_),onClick:w(j,_)}),u?y.createElement(XKe,{shape:l,activeBar:u,baseProps:o,entry:j,index:_,dataKey:c}):y.createElement(QKe,{shape:l,baseProps:o,entry:j,index:_,dataKey:c})))):null}function ZKe(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:h}=e,p=r.current,m=i_(e,"recharts-bar-"),[g,b]=y.useState(!1),v=!g,w=y.useCallback(()=>{typeof u=="function"&&u(),b(!1)},[u]),j=y.useCallback(()=>{typeof h=="function"&&h(),b(!0)},[h]);return y.createElement(YKe,{showLabels:v,rects:n},y.createElement(s_,{animationId:m,begin:o,duration:l,isActive:a,easing:c,onAnimationEnd:w,onAnimationStart:j,key:m},_=>{var E=_===1?n:n?.map((I,O)=>{var B=p&&p[O];if(B)return cl(cl({},I),{},{x:Ra(B.x,I.x,_),y:Ra(B.y,I.y,_),width:Ra(B.width,I.width,_),height:Ra(B.height,I.height,_)});if(i==="horizontal"){var S=Ra(0,I.height,_),T=Ra(I.stackedBarStart,I.y,_);return cl(cl({},I),{},{y:T,height:S})}var M=Ra(0,I.width,_),$=Ra(I.stackedBarStart,I.x,_);return cl(cl({},I),{},{width:M,x:$})});return _>0&&(r.current=E??null),E==null?null:y.createElement(gl,null,y.createElement(JKe,{props:e,data:E}))}),y.createElement(Zie,{label:e.label}),e.children)}function eYe(t){var e=y.useRef(null);return y.createElement(ZKe,{previousRectanglesRef:e,props:t})}var wae=0,tYe=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:si(t,e)}};class rYe extends y.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var h=gs("recharts-bar",i),p=u;return y.createElement(gl,{className:h,id:u},l&&y.createElement("defs",null,y.createElement(WGe,{clipPathId:p,xAxisId:a,yAxisId:o})),y.createElement(gl,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(p,")"):void 0},y.createElement(KKe,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),y.createElement(eYe,this.props)))}}var nYe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:wae,xAxisId:0,yAxisId:0,zIndex:Zo.bar};function sYe(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h}=t,{needClip:p}=bae(e,r),m=p2(),g=Ec(),b=OO(t.children,ab),v=kr(_=>TKe(_,t.id,g,b));if(m!=="vertical"&&m!=="horizontal")return null;var w,j=v?.[0];return j==null||j.height==null||j.width==null?w=0:w=m==="vertical"?j.height/2:j.width/2,y.createElement(HGe,{xAxisId:e,yAxisId:r,data:v,dataPointFormatter:tYe,errorBarOffset:w},y.createElement(rYe,af({},t,{layout:m,needClip:p,data:v,xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h})))}function iYe(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:h,displayedData:p,offset:m,cells:g,parentViewBox:b,dataStartIndex:v}=t,w=e==="horizontal"?l:o,j=h?w.scale.domain():null,_=C7e({numericAxis:w}),E=w.scale(_);return p.map((I,O)=>{var B,S,T,M,$,k;if(h){var L=h[O+v];if(L==null)return null;B=w7e(L,j)}else B=si(I,r),Array.isArray(B)||(B=[_,B]);var R=fKe(n,wae)(B[1],O);if(e==="horizontal"){var V,[Y,X]=[l.scale(B[0]),l.scale(B[1])];S=wq({axis:o,ticks:c,bandSize:a,offset:i.offset,entry:I,index:O}),T=(V=X??Y)!==null&&V!==void 0?V:void 0,M=i.size;var J=Y-X;if($=Vd(J)?0:J,k={x:S,y:m.top,width:M,height:m.height},Math.abs(R)>0&&Math.abs($)<Math.abs(R)){var re=Po($||R)*(Math.abs(R)-Math.abs($));T-=re,$+=re}}else{var[se,ee]=[o.scale(B[0]),o.scale(B[1])];if(S=se,T=wq({axis:l,ticks:u,bandSize:a,offset:i.offset,entry:I,index:O}),M=ee-se,$=i.size,k={x:m.left,y:T,width:m.width,height:$},Math.abs(R)>0&&Math.abs(M)<Math.abs(R)){var q=Po(M||R)*(Math.abs(R)-Math.abs(M));M+=q}}if(S==null||T==null||M==null||$==null)return null;var U=cl(cl({},I),{},{stackedBarStart:E,x:S,y:T,width:M,height:$,value:h?B:B[1],payload:I,background:k,tooltipPosition:{x:S+M/2,y:T+$/2},parentViewBox:b},g&&g[O]&&g[O].props);return U}).filter(Boolean)}function aYe(t){var e=Do(t,nYe),r=OKe(e.stackId),n=Ec();return y.createElement(oae,{id:e.id,type:"bar"},i=>y.createElement(y.Fragment,null,y.createElement(KHe,{legendPayload:WKe(e)}),y.createElement(GKe,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:i}),y.createElement(lWe,{type:"bar",id:i,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),y.createElement(eh,{zIndex:e.zIndex},y.createElement(sYe,af({},e,{id:i})))))}var Nae=y.memo(aYe,FO);Nae.displayName="Bar";var oYe=["domain","range"],lYe=["domain","range"];function AW(t,e){if(t==null)return{};var r,n,i=cYe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function cYe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function TW(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function jae(t,e){if(t===e)return!0;var{domain:r,range:n}=t,i=AW(t,oYe),{domain:a,range:o}=e,l=AW(e,lYe);return!TW(r,a)||!TW(n,o)?!1:FO(i,l)}var uYe=["dangerouslySetInnerHTML","ticks","scale"],dYe=["id","scale"];function S8(){return S8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},S8.apply(null,arguments)}function IW(t,e){if(t==null)return{};var r,n,i=hYe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function hYe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function fYe(t){var e=Hs(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e($We(t)):r.current!==t&&e(FWe({prev:r.current,next:t})),r.current=t},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(e(UWe(r.current)),r.current=null)},[e]),null}var pYe=t=>{var{xAxisId:e,className:r}=t,n=kr(gP),i=Ec(),a="xAxis",o=kr(j=>die(j,a,e,i)),l=kr(j=>oie(j,e)),c=kr(j=>qUe(j,e)),u=kr(j=>zse(j,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:h,ticks:p,scale:m}=t,g=IW(t,uYe),{id:b,scale:v}=u,w=IW(u,dYe);return y.createElement($O,S8({},g,w,{x:c.x,y:c.y,width:l.width,height:l.height,className:gs("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o,axisType:a}))},mYe={allowDataOverflow:eo.allowDataOverflow,allowDecimals:eo.allowDecimals,allowDuplicatedCategory:eo.allowDuplicatedCategory,angle:eo.angle,axisLine:Yp.axisLine,height:eo.height,hide:!1,includeHidden:eo.includeHidden,interval:eo.interval,minTickGap:eo.minTickGap,mirror:eo.mirror,orientation:eo.orientation,padding:eo.padding,reversed:eo.reversed,scale:eo.scale,tick:eo.tick,tickCount:eo.tickCount,tickLine:Yp.tickLine,tickSize:Yp.tickSize,type:eo.type,xAxisId:0},gYe=t=>{var e=Do(t,mYe);return y.createElement(y.Fragment,null,y.createElement(fYe,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),y.createElement(pYe,e))},kae=y.memo(gYe,jae);kae.displayName="XAxis";var xYe=["dangerouslySetInnerHTML","ticks","scale"],bYe=["id","scale"];function C8(){return C8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},C8.apply(null,arguments)}function LW(t,e){if(t==null)return{};var r,n,i=yYe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yYe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function vYe(t){var e=Hs(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e(zWe(t)):r.current!==t&&e(qWe({prev:r.current,next:t})),r.current=t},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(e(VWe(r.current)),r.current=null)},[e]),null}var wYe=t=>{var{yAxisId:e,className:r,width:n,label:i}=t,a=y.useRef(null),o=y.useRef(null),l=kr(gP),c=Ec(),u=Hs(),h="yAxis",p=kr(B=>lie(B,e)),m=kr(B=>HUe(B,e)),g=kr(B=>die(B,h,e,c)),b=kr(B=>qse(B,e));if(y.useLayoutEffect(()=>{if(!(n!=="auto"||!p||IO(i)||y.isValidElement(i)||b==null)){var B=a.current;if(B){var S=B.getCalculatedWidth();Math.round(p.width)!==Math.round(S)&&u(HWe({id:e,width:S}))}}},[g,p,u,i,e,n,b]),p==null||m==null||b==null)return null;var{dangerouslySetInnerHTML:v,ticks:w,scale:j}=t,_=LW(t,xYe),{id:E,scale:I}=b,O=LW(b,bYe);return y.createElement($O,C8({},_,O,{ref:a,labelRef:o,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:p.width,height:p.height,className:gs("recharts-".concat(h," ").concat(h),r),viewBox:l,ticks:g,axisType:h}))},NYe={allowDataOverflow:to.allowDataOverflow,allowDecimals:to.allowDecimals,allowDuplicatedCategory:to.allowDuplicatedCategory,angle:to.angle,axisLine:Yp.axisLine,hide:!1,includeHidden:to.includeHidden,interval:to.interval,minTickGap:to.minTickGap,mirror:to.mirror,orientation:to.orientation,padding:to.padding,reversed:to.reversed,scale:to.scale,tick:to.tick,tickCount:to.tickCount,tickLine:Yp.tickLine,tickSize:Yp.tickSize,type:to.type,width:to.width,yAxisId:0},jYe=t=>{var e=Do(t,NYe);return y.createElement(y.Fragment,null,y.createElement(vYe,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),y.createElement(wYe,e))},_ae=y.memo(jYe,jae);_ae.displayName="YAxis";var kYe=(t,e)=>e,UO=it([kYe,Jn,Fse,Va,Cie,wf,aqe,za],fqe),zO=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Sae=au("mouseClick"),Cae=h2();Cae.startListening({actionCreator:Sae,effect:(t,e)=>{var r=t.payload,n=UO(e.getState(),zO(r));n?.activeIndex!=null&&e.dispatch(ize({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var E8=au("mouseMove"),Eae=h2(),P5=null;Eae.startListening({actionCreator:E8,effect:(t,e)=>{var r=t.payload;P5!==null&&cancelAnimationFrame(P5);var n=zO(r);P5=requestAnimationFrame(()=>{var i=e.getState(),a=vO(i,i.tooltip.settings.shared);if(a==="axis"){var o=UO(i,n);o?.activeIndex!=null?e.dispatch(yie({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(bie())}P5=null})}});function _Ye(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var PW={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Aae=ec({name:"rootProps",initialState:PW,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:PW.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),SYe=Aae.reducer,{updateOptions:CYe}=Aae.actions,Tae=ec({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:EYe}=Tae.actions,AYe=Tae.reducer,Iae=au("keyDown"),Lae=au("focus"),qO=h2();qO.startListening({actionCreator:Iae,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var o=wO(i,Ib(r),k2(r),C2(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=wf(r);if(a==="Enter"){var u=c4(r,"axis","hover",String(i.index));e.dispatch(y8({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var h=YUe(r),p=h==="left-to-right"?1:-1,m=a==="ArrowRight"?1:-1,g=l+m*p;if(!(c==null||g>=c.length||g<0)){var b=c4(r,"axis","hover",String(g));e.dispatch(y8({active:!0,activeIndex:g.toString(),activeCoordinate:b}))}}}}}});qO.startListening({actionCreator:Lae,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",o=c4(r,"axis","hover",String(a));e.dispatch(y8({active:!0,activeIndex:a,activeCoordinate:o}))}}}});var Hc=au("externalEvent"),Pae=h2(),v6=new Map;Pae.startListening({actionCreator:Hc,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var i=n.type,a=v6.get(i);a!==void 0&&cancelAnimationFrame(a);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:Hze(l),activeDataKey:SO(l),activeIndex:Sm(l),activeLabel:Tie(l),activeTooltipIndex:Sm(l),isTooltipActive:Wze(l)};r(c,n)}finally{v6.delete(i)}});v6.set(i,o)}}});var TYe=it([Ab],t=>t.tooltipItemPayloads),IYe=it([TYe,S2,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(l=>l.settings.graphicalItemId===n);if(i!=null){var{positions:a}=i;if(a!=null){var o=e(a,r);return o}}}),Oae=au("touchMove"),Rae=h2();Rae.startListening({actionCreator:Oae,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),i=vO(n,n.tooltip.settings.shared);if(i==="axis"){var a=r.touches[0];if(a==null)return;var o=UO(n,zO({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));o?.activeIndex!=null&&e.dispatch(yie({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var h=u.getAttribute(one),p=(l=u.getAttribute(lne))!==null&&l!==void 0?l:void 0,m=Tb(n).find(v=>v.id===p);if(h==null||m==null||p==null)return;var{dataKey:g}=m,b=IYe(n,h,p);e.dispatch(xie({activeDataKey:g,activeIndex:h,activeCoordinate:b,activeGraphicalItemId:p}))}}}});var LYe=Ire({brush:nGe,cartesianAxis:WWe,chartData:Uqe,errorBars:$Ge,graphicalItems:aWe,layout:m7e,legend:kDe,options:Mqe,polarAxis:yHe,polarOptions:AYe,referenceElements:uGe,rootProps:SYe,tooltip:aze,zIndex:Cqe}),PYe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return FMe({reducer:LYe,preloadedState:e,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([Cae.middleware,Eae.middleware,qO.middleware,Pae.middleware,Rae.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(Wre({type:"raf"}))},devTools:{serialize:{replacer:_Ye},name:"recharts-".concat(r)}})};function Mae(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=Ec(),a=y.useRef(null);if(i)return r;a.current==null&&(a.current=PYe(e,n));var o=oP;return y.createElement(lKe,{context:o,store:a.current},r)}function OYe(t){var{layout:e,margin:r}=t,n=Hs(),i=Ec();return y.useEffect(()=>{i||(n(h7e(e)),n(d7e(r)))},[n,i,e,r]),null}var Dae=y.memo(OYe,FO);function Bae(t){var e=Hs();return y.useEffect(()=>{e(CYe(t))},[e,t]),null}function OW(t){var{zIndex:e,isPanorama:r}=t,n=y.useRef(null),i=Hs();return y.useLayoutEffect(()=>(n.current&&i(_qe({zIndex:e,element:n.current,isPanorama:r})),()=>{i(Sqe({zIndex:e,isPanorama:r}))}),[i,e,r]),y.createElement("g",{tabIndex:-1,ref:n})}function RW(t){var{children:e,isPanorama:r}=t,n=kr(mqe);if(!n||n.length===0)return e;var i=n.filter(o=>o<0),a=n.filter(o=>o>0);return y.createElement(y.Fragment,null,i.map(o=>y.createElement(OW,{key:o,zIndex:o,isPanorama:r})),e,a.map(o=>y.createElement(OW,{key:o,zIndex:o,isPanorama:r})))}var RYe=["children"];function MYe(t,e){if(t==null)return{};var r,n,i=DYe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function DYe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function m4(){return m4=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},m4.apply(null,arguments)}var BYe={width:"100%",height:"100%",display:"block"},$Ye=y.forwardRef((t,e)=>{var r=fne(),n=pne(),i=Sne();if(!D0(r)||!D0(n))return null;var{children:a,otherAttributes:o,title:l,desc:c}=t,u,h;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?h=o.role:h=i?"application":void 0),y.createElement(JL,m4({},o,{title:l,desc:c,role:h,tabIndex:u,width:r,height:n,style:BYe,ref:e}),a)}),FYe=t=>{var{children:e}=t,r=kr(Qk);if(!r)return null;var{width:n,height:i,y:a,x:o}=r;return y.createElement(JL,{width:n,height:i,x:o,y:a},e)},MW=y.forwardRef((t,e)=>{var{children:r}=t,n=MYe(t,RYe),i=Ec();return i?y.createElement(FYe,null,y.createElement(RW,{isPanorama:!0},r)):y.createElement($Ye,m4({ref:e},n),y.createElement(RW,{isPanorama:!1},r))});function UYe(){var t=Hs(),[e,r]=y.useState(null),n=kr(P7e);return y.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;Ti(a)&&a!==n&&t(p7e(a))}},[e,t,n]),r}function DW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zYe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DW(Object(r),!0).forEach(function(n){qYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qYe(t,e,r){return(e=VYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VYe(t){var e=HYe(t,"string");return typeof e=="symbol"?e:e+""}function HYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Em(){return Em=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Em.apply(null,arguments)}var WYe=()=>(Xqe(),null);function g4(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var GYe=y.forwardRef((t,e)=>{var r,n,i=y.useRef(null),[a,o]=y.useState({containerWidth:g4((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:g4((n=t.style)===null||n===void 0?void 0:n.height)}),l=y.useCallback((u,h)=>{o(p=>{var m=Math.round(u),g=Math.round(h);return p.containerWidth===m&&p.containerHeight===g?p:{containerWidth:m,containerHeight:g}})},[]),c=y.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:h,height:p}=u.getBoundingClientRect();l(h,p);var m=b=>{var{width:v,height:w}=b[0].contentRect;l(v,w)},g=new ResizeObserver(m);g.observe(u),i.current=g}},[e,l]);return y.useEffect(()=>()=>{var u=i.current;u?.disconnect()},[l]),y.createElement(y.Fragment,null,y.createElement(Zk,{width:a.containerWidth,height:a.containerHeight}),y.createElement("div",Em({ref:c},t)))}),KYe=y.forwardRef((t,e)=>{var{width:r,height:n}=t,[i,a]=y.useState({containerWidth:g4(r),containerHeight:g4(n)}),o=y.useCallback((c,u)=>{a(h=>{var p=Math.round(c),m=Math.round(u);return h.containerWidth===p&&h.containerHeight===m?h:{containerWidth:p,containerHeight:m}})},[]),l=y.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:h}=c.getBoundingClientRect();o(u,h)}},[e,o]);return y.createElement(y.Fragment,null,y.createElement(Zk,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",Em({ref:l},t)))}),YYe=y.forwardRef((t,e)=>{var{width:r,height:n}=t;return y.createElement(y.Fragment,null,y.createElement(Zk,{width:r,height:n}),y.createElement("div",Em({ref:e},t)))}),XYe=y.forwardRef((t,e)=>{var{width:r,height:n}=t;return Zh(r)||Zh(n)?y.createElement(KYe,Em({},t,{ref:e})):y.createElement(YYe,Em({},t,{ref:e}))});function QYe(t){return t===!0?GYe:XYe}var JYe=y.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:h,onMouseMove:p,onMouseUp:m,onTouchEnd:g,onTouchMove:b,onTouchStart:v,style:w,width:j,responsive:_,dispatchTouchEvents:E=!0}=t,I=y.useRef(null),O=Hs(),[B,S]=y.useState(null),[T,M]=y.useState(null),$=UYe(),k=xP(),L=k?.width>0?k.width:j,R=k?.height>0?k.height:i,V=y.useCallback(H=>{$(H),typeof e=="function"&&e(H),S(H),M(H),H!=null&&(I.current=H)},[$,e,S,M]),Y=y.useCallback(H=>{O(Sae(H)),O(Hc({handler:a,reactEvent:H}))},[O,a]),X=y.useCallback(H=>{O(E8(H)),O(Hc({handler:u,reactEvent:H}))},[O,u]),J=y.useCallback(H=>{O(bie()),O(Hc({handler:h,reactEvent:H}))},[O,h]),re=y.useCallback(H=>{O(E8(H)),O(Hc({handler:p,reactEvent:H}))},[O,p]),se=y.useCallback(()=>{O(Lae())},[O]),ee=y.useCallback(H=>{O(Iae(H.key))},[O]),q=y.useCallback(H=>{O(Hc({handler:o,reactEvent:H}))},[O,o]),U=y.useCallback(H=>{O(Hc({handler:l,reactEvent:H}))},[O,l]),W=y.useCallback(H=>{O(Hc({handler:c,reactEvent:H}))},[O,c]),Z=y.useCallback(H=>{O(Hc({handler:m,reactEvent:H}))},[O,m]),de=y.useCallback(H=>{O(Hc({handler:v,reactEvent:H}))},[O,v]),be=y.useCallback(H=>{E&&O(Oae(H)),O(Hc({handler:b,reactEvent:H}))},[O,E,b]),oe=y.useCallback(H=>{O(Hc({handler:g,reactEvent:H}))},[O,g]),ne=QYe(_);return y.createElement(Die.Provider,{value:B},y.createElement(Kte.Provider,{value:T},y.createElement(ne,{width:L??w?.width,height:R??w?.height,className:gs("recharts-wrapper",n),style:zYe({position:"relative",cursor:"default",width:L,height:R},w),onClick:Y,onContextMenu:q,onDoubleClick:U,onFocus:se,onKeyDown:ee,onMouseDown:W,onMouseEnter:X,onMouseLeave:J,onMouseMove:re,onMouseUp:Z,onTouchEnd:oe,onTouchMove:be,onTouchStart:de,ref:V},y.createElement(WYe,null),r)))}),ZYe=["width","height","responsive","children","className","style","compact","title","desc"];function eXe(t,e){if(t==null)return{};var r,n,i=tXe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function tXe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var $ae=y.forwardRef((t,e)=>{var{width:r,height:n,responsive:i,children:a,className:o,style:l,compact:c,title:u,desc:h}=t,p=eXe(t,ZYe),m=qd(p);return c?y.createElement(y.Fragment,null,y.createElement(Zk,{width:r,height:n}),y.createElement(MW,{otherAttributes:m,title:u,desc:h},a)):y.createElement(JYe,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},y.createElement(MW,{otherAttributes:m,title:u,desc:h,ref:e},y.createElement(hGe,null,a)))});function A8(){return A8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A8.apply(null,arguments)}var rXe={top:5,right:5,bottom:5,left:5},nXe={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:rXe,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},sXe=y.forwardRef(function(e,r){var n,i=Do(e.categoricalChartProps,nXe),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,h={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return y.createElement(Mae,{preloadedState:{options:h},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:a},y.createElement(fae,{chartData:u.data}),y.createElement(Dae,{layout:i.layout,margin:i.margin}),y.createElement(Bae,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),y.createElement($ae,A8({},i,{ref:r})))}),iXe=["axis","item"],aXe=y.forwardRef((t,e)=>y.createElement(sXe,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:iXe,tooltipPayloadSearcher:Bie,categoricalChartProps:t,ref:e}));function oXe(t){var e=Hs();return y.useEffect(()=>{e(EYe(t))},[e,t]),null}var lXe=["layout"];function T8(){return T8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},T8.apply(null,arguments)}function cXe(t,e){if(t==null)return{};var r,n,i=uXe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function uXe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var dXe={top:5,right:5,bottom:5,left:5},Fae={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:dXe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},hXe=y.forwardRef(function(e,r){var n,i=Do(e.categoricalChartProps,Fae),{layout:a}=i,o=cXe(i,lXe),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h}=e,p={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return y.createElement(Mae,{preloadedState:{options:p},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},y.createElement(fae,{chartData:i.data}),y.createElement(Dae,{layout:a,margin:i.margin}),y.createElement(Bae,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),y.createElement(oXe,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),y.createElement($ae,T8({},o,{ref:r})))});function BW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $W(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BW(Object(r),!0).forEach(function(n){fXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fXe(t,e,r){return(e=pXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pXe(t){var e=mXe(t,"string");return typeof e=="symbol"?e:e+""}function mXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gXe=["item"],xXe=$W($W({},Fae),{},{layout:"centric",startAngle:0,endAngle:360}),bXe=y.forwardRef((t,e)=>{var r=Do(t,xXe);return y.createElement(hXe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:gXe,tooltipPayloadSearcher:Bie,categoricalChartProps:r,ref:e})});const x4=({cards:t=[],type:e="all"})=>{const r=y.useMemo(()=>{const l={0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0};return t.forEach(c=>{const u=c.data||c,h=(u.type_line||"").toLowerCase();if(h.includes("land")&&!h.includes("creature")&&!h.includes("artifact"))return;const p=u.cmc??u.manavalue??0;p>=7?l["7+"]++:l[Math.floor(p)]++}),Object.entries(l).map(([c,u])=>({label:c,value:u}))},[t]),n=y.useMemo(()=>{const l={};return t.forEach(c=>{const h=(c.data||c).type_line||"";["Creature","Instant","Sorcery","Artifact","Enchantment","Planeswalker","Land","Battle"].forEach(m=>{h.includes(m)&&(l[m]=(l[m]||0)+1)})}),Object.entries(l).map(([c,u])=>({name:c,value:u}))},[t]),i=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c","#d0ed57","#8dd1e1"],a=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[e==="all"&&s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Mana Curve"}),s.jsx(Pq,{width:"100%",height:"100%",children:s.jsxs(aXe,{data:r,children:[s.jsx(kae,{dataKey:"label",stroke:"#9ca3af",tick:{fontSize:12}}),s.jsx(_ae,{stroke:"#9ca3af",allowDecimals:!1,tick:{fontSize:12},width:30}),s.jsx(RH,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(255,255,255,0.1)"}}),s.jsx(Nae,{dataKey:"value",fill:"#6366f1",radius:[4,4,0,0],children:r.map((l,c)=>s.jsx(ab,{fill:i[c%i.length]},`cell-${c}`))})]})})]}),o=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Card Types"}),s.jsx(Pq,{width:"100%",height:"100%",children:s.jsxs(bXe,{children:[s.jsx(cae,{data:n,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",fill:"#8884d8",dataKey:"value",label:({cx:l,cy:c,midAngle:u,innerRadius:h,outerRadius:p,percent:m,index:g})=>null,children:n.map((l,c)=>s.jsx(ab,{fill:i[c%i.length]},`cell-${c}`))}),s.jsx(RH,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"}}),s.jsx(_ne,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"12px"}})]})})]});return e==="mana"?s.jsx("div",{className:"w-full h-full",children:a()}):e==="types"?s.jsx("div",{className:"w-full h-full",children:o()}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-800 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"h-64",children:a()}),s.jsx("div",{className:"h-64",children:o()})]})},yXe=({isOpen:t,onClose:e,onConfirm:r,ownership:n})=>{if(!t)return null;const{ownedCards:i,totalCards:a,percentOwned:o}=n;return Vn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-slide-up",children:[s.jsx("div",{className:"p-6 border-b border-gray-800 bg-gray-900/50",children:s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Import Deck Options"]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl p-4",children:[s.jsxs("div",{className:"flex justify-between items-end mb-2",children:[s.jsx("span",{className:"text-gray-400 text-sm font-medium uppercase tracking-wider",children:"Ownership"}),s.jsxs("span",{className:"text-indigo-300 font-mono font-bold",children:[o,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 mb-2",children:s.jsx("div",{className:"bg-indigo-500 h-2 rounded-full transition-all duration-1000",style:{width:`${o}%`}})}),s.jsxs("p",{className:"text-gray-300 text-sm",children:["You already own ",s.jsx("strong",{className:"text-white",children:i})," of the ",s.jsx("strong",{className:"text-white",children:a})," cards in this deck."]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-white font-bold text-sm",children:"How would you like to proceed?"}),s.jsxs("button",{onClick:()=>r(!0),className:"w-full flex items-start text-left p-4 rounded-xl border border-indigo-500/30 bg-indigo-900/10 hover:bg-indigo-900/20 transition-all group",children:[s.jsx("div",{className:"mt-1 shrink-0 w-6 h-6 rounded-full border-2 border-indigo-500 flex items-center justify-center mr-4 group-hover:scale-110 transition-transform",children:s.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Use Existing Cards"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Moves cards from your collection (Binder) into this deck. Best for organizing your physical collection."})]})]}),s.jsxs("button",{onClick:()=>r(!1),className:"w-full flex items-start text-left p-4 rounded-xl border border-gray-700 bg-gray-800/30 hover:bg-gray-800 hover:border-gray-600 transition-all group",children:[s.jsx("div",{className:"mt-1 shrink-0 w-6 h-6 rounded-full border-2 border-gray-600 flex items-center justify-center mr-4 group-hover:border-gray-500 transition-colors"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-300 group-hover:text-white transition-colors",children:"Add New Copies"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Adds fresh copies of all cards to your collection. Select this if you bought a new boxed Precon."})]})]})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-bold text-gray-400 hover:text-white transition-colors",children:"Cancel"})})]})}),document.body)},w6=[{badge:"White",colors:["W"],theme:"Absolute Order"},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry"},{badge:"Black",colors:["B"],theme:"Unrestricted Power"},{badge:"Red",colors:["R"],theme:"Chaotic Passion"},{badge:"Green",colors:["G"],theme:"Primal Growth"},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control"},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration"},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage"},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction"},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony"},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity"},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genus"},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot"},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression"},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution"},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic"},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny"},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation"},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty"},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order"},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance"},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark"},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay"},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest"},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct"},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence"},{badge:"Colorless",colors:["C"],theme:"The Great Void"}],vXe=()=>{const{id:t}=yl(),e=xn(),{currentUser:r,userProfile:n}=Or(),{addToast:i}=jn(),[a,o]=y.useState(null),[l,c]=y.useState(!0),[u,h]=y.useState("grid"),[p,m]=y.useState(null),[g,b]=y.useState(0),[v,w]=y.useState(!1),[j,_]=y.useState(null),[E,I]=y.useState(null);y.useEffect(()=>{(async()=>{try{const U=await Ge.get(`/api/precons/${t}`);o(U)}catch(U){console.error("Precon load failed",U),i("Failed to load precon","error"),e("/precons")}finally{c(!1)}})()},[t,e,i]);const O=y.useMemo(()=>a?[...(a.data.commander||[]).map(q=>({...q,isCommander:!0})),...a.data.mainBoard||[]]:[],[a]),B=y.useMemo(()=>{if(!a)return null;const q=a.data.commander||[];if(q.length>0)return q[0];let U=null,W=-1;const Z=de=>de.data?.cmc||de.cmc||0;for(const de of a.data.mainBoard||[]){const be=Z(de);be>W&&(W=be,U=de)}return U},[a]),S=y.useMemo(()=>!a?.data?.commander||a.data.commander.length<2?null:a.data.commander[1],[a]),T=g===0?B:S||B,M=q=>q?q.image_uris?.normal?q.image_uris.normal:q.card_faces?.[0]?.image_uris?.normal?q.card_faces[0].image_uris.normal:q.data?.image_uris?.normal?q.data.image_uris.normal:q.data?.card_faces?.[0]?.image_uris?.normal?q.data.card_faces[0].image_uris.normal:"https://placehold.co/400x600":"",k=(q=>q?q.image_uris?.art_crop?q.image_uris.art_crop:q.data?.image_uris?.art_crop?q.data.image_uris.art_crop:q.card_faces?.[0]?.image_uris?.art_crop?q.card_faces[0].image_uris.art_crop:q.data?.card_faces?.[0]?.image_uris?.art_crop?q.data.card_faces[0].image_uris.art_crop:M(q):"")(T),L={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},R=y.useMemo(()=>O.reduce((q,U)=>q+(U.count||U.quantity||1),0),[O]),V=y.useMemo(()=>O.reduce((q,U)=>{const W=parseFloat(U.prices?.usd||U.prices?.usd_foil||U.data?.prices?.usd||U.data?.prices?.usd_foil||0);return q+W*(U.count||U.quantity||1)},0),[O]),Y=y.useMemo(()=>{const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return O.forEach(U=>{if(U.isCommander){q.Commander.push(U);return}const W=(U.data?.type_line||U.type||"").toLowerCase();W.includes("creature")?q.Creature.push(U):W.includes("planeswalker")?q.Planeswalker.push(U):W.includes("instant")?q.Instant.push(U):W.includes("sorcery")?q.Sorcery.push(U):W.includes("artifact")?q.Artifact.push(U):W.includes("enchantment")?q.Enchantment.push(U):W.includes("land")?q.Land.push(U):q.Other.push(U)}),Object.keys(q).forEach(U=>{q[U]=q[U].map(W=>({...W,image_uri:M(W)}))}),Object.fromEntries(Object.entries(q).filter(([U,W])=>W.length>0))},[O]),X=y.useMemo(()=>{if(!a)return w6.find(W=>W.badge==="Colorless");const q=a.data?.colors||[];return w6.find(W=>W.colors.length!==q.length?!1:W.colors.every(Z=>q.includes(Z)))||w6.find(W=>W.badge==="Colorless")},[a]);vl();const{decks:J}=z0(),re=async q=>{const U=n?.subscription_tier||"free",Z=Ln(U).limits.decks;if(Z!==1/0&&J&&J.length>=Z){i(`Deck limit reached (${J.length}/${Z}). Upgrade to add this deck!`,"error");return}m(q);try{const de=await Ge.checkPreconOwnership(a.id);console.log("Precon Ownership Check:",de);const be=de.ownedCards||0,oe=de.totalCards||0,ne=de.percentOwned||0;be>0?(_(de),I(q),w(!0)):await ee(q,!1)}catch(de){console.error("Ownership check failed",de),window.confirm("Ownership check failed. Create deck anyway (may duplicate cards)?")&&await ee(q,!1)}finally{m(null)}},se=async q=>{if(w(!1),E){m(E);try{await ee(E,q)}finally{m(null),I(null)}}},ee=async(q,U)=>{try{const W=await Ge.createPreconDeck(a.id,{mode:q,useExisting:U});W.success&&(i(U?"Deck created using existing cards!":"Deck created with new cards!","success"),e(`/decks/${W.deckId}`))}catch(W){console.error(W),W.message&&W.message.includes("Limit reached")?i(W.message,"error"):i("Failed to create deck","error")}};return l?s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})}):a?s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${k})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2 font-bold",children:[s.jsx(Er,{to:"/precons",className:"hover:text-white transition-colors",children:"Precons"}),s.jsx("span",{children:"/"}),a.data.code&&s.jsxs(s.Fragment,{children:[s.jsx(Er,{to:`/precons/set/${a.data.code}`,className:"hover:text-white transition-colors",children:a.data.code}),s.jsx("span",{children:"/"})]}),s.jsx("span",{className:"text-white",children:a.name})]}),s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:a.type||"Commander"}),s.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:"Official Precon"})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:a.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(a.data.colors||[]).map(q=>s.jsx("img",{src:L[q],alt:q,className:"w-6 h-6"},q))}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:X?.theme||"Deck"})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",V.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[R," Cards"]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 mt-2",children:[s.jsxs("a",{href:`https://www.amazon.com/s?k=${encodeURIComponent(a.name)}&tag=mtgsite-20`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#FF9900] text-black px-4 py-2 rounded-xl font-black hover:bg-[#FF9900]/90 transition-colors shadow-lg shadow-orange-900/20 text-xs uppercase tracking-wider flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M15.54 13.924c-1.35 1.572-3.645 2.502-5.466 2.502-3.132 0-5.187-1.487-6.264-2.292l-.768 1.488c1.374 1.05 4.092 3.036 8.046 2.454 2.829-.414 5.37-2.67 6.096-3.816l-1.644-.336zM3.444 19.542l1.626 1.104c.126.066.27.018.33-.096.792-2.142 2.766-3.21 2.898-3.276.102-.054.126-.18.066-.27l-1.632-2.07c-.066-.09-.192-.09-.264-.024-.03.042-2.22 2.652-3.09 4.392-.048.102.006.21.066.24zM20.598 6.942C20.598 6.942 18.078 2.37 11.232 2.598 4.296 2.826 2.898 7.356 2.898 7.356c-.054.168.042.33.204.372l1.83.474c.144.036.294-.036.354-.168.03-.066 1.038-2.61 5.388-2.88 2.058-.126 4.194.516 5.34 1.764.57.624.81 1.434.69 2.214-1.284.186-2.58.348-3.84.48-4.2.438-6.198 2.052-6.114 4.542.06 1.764 1.344 3.324 3.96 3.258 2.634-.066 4.104-1.848 4.104-1.848v1.446c0 .168.126.3.288.3h1.992c.162 0 .288-.132.288-.3l.006-4.944c-.006-3.324-1.746-5.124-4.8-5.124H20.598zM12.924 10.998c0 .672-.084 1.458-.87 2.016-.624.456-1.398.546-1.956.558-1.098.024-1.722-.594-1.758-1.218-.048-1.02 0-1.872 4.584-2.316v.96z"})}),"Amazon"]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${a.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-black hover:bg-[#3a3a3a] transition-colors shadow-lg shadow-black/20 text-xs uppercase tracking-wider flex items-center gap-2 border border-white/10",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"TCGPlayer"]}),s.jsx("button",{onClick:()=>re("collection"),disabled:p,className:"bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm disabled:opacity-50",children:p==="collection"?"Adding...":"Add to Collection"}),s.jsx("button",{onClick:()=>re("wishlist"),disabled:p,className:"bg-gray-800 text-white border border-gray-700 px-4 py-2 rounded-xl font-bold hover:bg-gray-700 transition-colors text-sm disabled:opacity-50",children:"Wishlist"})]})]})]})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>h("grid"),className:`p-1.5 rounded ${u==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>h("table"),className:`p-1.5 rounded ${u==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries(Y).map(([q,U])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-gray-500",children:U.reduce((W,Z)=>W+(Z.count||Z.quantity||1),0)})]}),u==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:U.map((W,Z)=>s.jsx(Qx,{card:W,readOnly:!0,showQuantity:!0},Z))}):s.jsx("div",{className:"space-y-1",children:U.map((W,Z)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:W.count||W.quantity||1}),s.jsx("span",{className:W.finish==="foil"?"text-yellow-200":"",children:W.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:W.manacost||W.mana_cost||W.data?.mana_cost})]},Z))})]},q))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:B?.isCommander?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:M(T)||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Featured Card"}),T?.data?.card_faces?.length>1&&T.data.card_faces[1].image_uris&&s.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-gray-900/80 rounded block md:hidden",title:"Flip",children:""})]}),S&&s.jsx("button",{onClick:()=>b(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:g===0?"View Partner":"View Commander"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(x4,{cards:O,type:"mana"})]}),s.jsxs("div",{className:"h-[220px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(x4,{cards:O,type:"types"})]})]})]})]})]})]}),s.jsx(yXe,{isOpen:v,onClose:()=>{w(!1),m(null)},onConfirm:se,ownership:j})]}):null},jh={ANALYSIS:1,ARCHITECT:2,DEPLOY:3},wXe=()=>{const{deckId:t}=yl(),e=xn(),{userProfile:r,currentUser:n}=Or(),{addToast:i}=jn(),{deck:a,cards:o,loading:l}=HL(t),{cards:c}=vl(),[u,h]=y.useState(jh.ANALYSIS),[p,m]=y.useState(`Initializing ${r?.settings?.helper?.name||"Oracle"}...`),[g,b]=y.useState([]),[v,w]=y.useState(!1),[j,_]=y.useState({}),[E,I]=y.useState(new Set),[O,B]=y.useState("All"),[S,T]=y.useState("grid"),M=y.useRef(null),[$,k]=y.useState({ownedOnly:!0,excludeAssigned:!0,restrictSet:!1,setName:""});y.useEffect(()=>{M.current?.scrollIntoView({behavior:"smooth"})},[g]),y.useEffect(()=>{a?.commander?.set_name&&!$.setName&&k(oe=>({...oe,setName:a.commander.set_name}))},[a,$.setName]);const L=oe=>{b(ne=>[...ne,`[${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${oe}`])},R=r?.settings?.helper?.name||"The Oracle",V=oe=>{if(!oe)return null;const ne=oe.data||oe;return ne.image_uris?.art_crop?ne.image_uris.art_crop:ne.card_faces?.[0]?.image_uris?.art_crop?ne.card_faces[0].image_uris.art_crop:ne.image_uris?.normal?ne.image_uris.normal:null},Y=oe=>new Promise(ne=>setTimeout(ne,oe)),X={W:"00000000-0000-0000-0000-000000000001",U:"00000000-0000-0000-0000-000000000002",B:"00000000-0000-0000-0000-000000000003",R:"00000000-0000-0000-0000-000000000004",G:"00000000-0000-0000-0000-000000000005"},J=(oe,ne)=>{const H={W:0,U:0,B:0,R:0,G:0,total:0},le=ye=>{ye&&(H.W+=(ye.match(/\{W\}/g)||[]).length,H.U+=(ye.match(/\{U\}/g)||[]).length,H.B+=(ye.match(/\{B\}/g)||[]).length,H.R+=(ye.match(/\{R\}/g)||[]).length,H.G+=(ye.match(/\{G\}/g)||[]).length)};return oe.forEach(ye=>le(ye.mana_cost||ye.data?.mana_cost)),Object.values(ne).forEach(ye=>le(ye.data?.mana_cost||ye.type_line)),H.total=H.W+H.U+H.B+H.R+H.G,H},re=(oe,ne,H)=>{if(oe<=0)return{};if(ne.total===0)return{};const le={W:{name:"Plains",type:"Basic Land  Plains"},U:{name:"Island",type:"Basic Land  Island"},B:{name:"Swamp",type:"Basic Land  Swamp"},R:{name:"Mountain",type:"Basic Land  Mountain"},G:{name:"Forest",type:"Basic Land  Forest"}},ye={};let me=0;const ke={};if(["W","U","B","R","G"].forEach(Ie=>{if(ne[Ie]>0){const ce=ne[Ie]/ne.total,Be=Math.round(oe*ce);ke[Ie]=Be,me+=Be}}),me>0){const Ie=Object.keys(ke).filter(ce=>ke[ce]>0);Ie.sort((ce,Be)=>ke[Be]-ke[ce]),me<oe?ke[Ie[0]]+=oe-me:me>oe&&(ke[Ie[0]]-=me-oe)}return Object.entries(ke).forEach(([Ie,ce])=>{if(ce>0){const Be=le[Ie],ct=X[Ie],Ve=H.find(Ne=>Ne.name===Be.name)||{name:Be.name,type_line:Be.type,scryfall_id:ct,id:ct,image_uris:{normal:`https://api.scryfall.com/cards/named?exact=${Be.name}&format=image`}};for(let Ne=0;Ne<ce;Ne++){const Ye=`basic-${Ie}-${Ne}-${Date.now()}`;ye[Ye]={firestoreId:Ye,name:Be.name,type_line:Be.type,rating:10,reason:`Auto-filled to match ${Math.round(ne[Ie]/ne.total*100)}% ${Ie} pip density.`,suggestedType:"Land",data:{...Ve.data||Ve,scryfall_id:Ve.scryfall_id||Ve.id||ct},isVirtual:!0}}}}),ye},se=(oe,ne)=>{if(!oe||oe.length===0)return!0;if(!ne||ne.length===0)return oe.length===0;const H=new Set(ne);return oe.every(le=>H.has(le))},ee=async()=>{if(!r?.settings?.geminiApiKey){i("Gemini API Key missing in settings.","error"),e("/settings/ai");return}w(!0),m("Scanning Collection..."),L(`Starting analysis (Owned: ${$.ownedOnly}, Exclude Assigned: ${$.excludeAssigned}, Set: ${$.restrictSet?$.setName:"Any"})...`);try{const oe=[...new Set([...a.commander?.color_identity||[],...a.commander_partner?.color_identity||[]])],ne=a.aiBlueprint||{},H=["Synergy / Strategy","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Land"],le=new Set(o.map(ot=>ot.name));a.commander?.name&&le.add(a.commander.name),a.commander_partner?.name&&le.add(a.commander_partner.name);const ye={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...ne.suggestedCounts||{}},me={},ke=new Set,Ie=$.setName.toLowerCase().trim(),ce={};let Be=0;for(const ot of H){const ut=o.filter(Ut=>(Ut.data?.type_line||Ut.type_line||"").includes(ot)).reduce((Ut,jt)=>Ut+(jt.countInDeck||1),0),At=ye[ot]||0;let Fe=Math.max(0,At-ut);Fe>0&&(ce[ot]=Fe,Be+=Fe)}if(Be===0){L("Deck goals appear met! No missing slots found based on targets."),w(!1),m("Idle");return}L(`Scanning collection for candidates (Need ${Be} total items)...`);const ct=[],Ve=new Set;for(const ot of c){if(Ve.has(ot.name)||$.ownedOnly&&ot.is_wishlist||$.excludeAssigned&&ot.deckId)continue;const ut=ot.data?.color_identity||ot.data?.colors||[];if(se(ut,oe)&&!le.has(ot.name)){if($.restrictSet&&Ie){const At=(ot.set_name||ot.data?.set_name||"").toLowerCase(),Fe=(ot.set||ot.data?.set||"").toLowerCase();if(!At.includes(Ie)&&Fe!==Ie)continue}ct.push({firestoreId:ot.id,name:ot.name,type_line:ot.data?.type_line||ot.type_line}),Ve.add(ot.name)}}if(ct.length===0){L("No valid candidates found with current filters."),w(!1),m("Idle");return}const Ne={Creature:0,Instant:0,Sorcery:0,Artifact:0,Enchantment:0,Land:0,Planeswalker:0};ct.forEach(ot=>{const ut=(ot.type_line||"").toLowerCase();ut.includes("creature")&&Ne.Creature++,ut.includes("instant")&&Ne.Instant++,ut.includes("sorcery")&&Ne.Sorcery++,ut.includes("artifact")&&Ne.Artifact++,ut.includes("enchantment")&&Ne.Enchantment++,ut.includes("land")&&Ne.Land++,ut.includes("planeswalker")&&Ne.Planeswalker++}),L(`Payload: ${ct.length} Cards available for Analysis.`),L(`Breakdown: ${Ne.Creature} Creatures, ${Ne.Instant} Instants, ${Ne.Sorcery} Sorceries, ${Ne.Artifact} Artifacts, ${Ne.Enchantment} Enchantments, ${Ne.Land} Lands`);const Ye={deckName:a.name,commander:`${a.commander?.name}${a.commander_partner?" & "+a.commander_partner.name:""}`,playerProfile:JSON.stringify(r?.playstyle||{}),strategyGuide:ne?.strategy||"No specific strategy guide.",helperPersona:r?.settings?.helper,instructions:`Fill the following deck slots: ${JSON.stringify(ce)}.`,deckRequirements:ce,candidates:ct.slice(0,3500),currentContext:Array.from(le),neededCount:Be,experienceLevel:"Advanced"},St=["Consulting the archives...","Analysing mana curves...","Simulating 10,000 games...","Checking for infinite combos...","Optimizing synergy lines...","Reviewing EDHRec data...","Considering card advantage engines...","Balancing interaction package...","Calculating probability of turn 3 win...","Searching for hidden gems...","Double-checking rule 0...","Consulting the Oracle...","Gathering arcane wisdom...","Tapping into the leyline..."];let Vt=0;for(;Vt<2;){let ot;try{L(`Consulting ${R} for Holistic Analysis (Need ${Be} cards from ${ct.length} candidates)...`),ot=setInterval(()=>{const At=St[Math.floor(Math.random()*St.length)];m(`${R}: ${At}`)},2500),m(`Consulting ${R}...`),await Y(1500);const ut=await ul.generateDeckSuggestions(r.settings.geminiApiKey,Ye);if(clearInterval(ot),ut?.suggestions){ut.suggestions.forEach(At=>{const Fe=ct.find(Ut=>Ut.firestoreId===At.firestoreId);if(Fe){const Ut=c.find(rt=>rt.id===At.firestoreId),jt=At.firestoreId,qe=At.role||"Synergy / Strategy";me[jt]={...At,firestoreId:jt,name:Ut?.name||Fe.name,type_line:Ut?.data?.type_line||Fe.type_line,data:Ut?.data||Ut,rating:At.rating,reason:At.reason,suggestedType:qe},ke.add(jt)}}),L(`${R} provided ${ut.suggestions.length} suggestions across all roles.`);break}}catch(ut){ot&&clearInterval(ot),console.error(ut),L(`Error: ${ut.message}. Retrying...`),Vt++,await Y(2e3)}}const Lt=o.filter(ot=>(ot.data?.type_line||ot.type_line||"").includes("Land")).length,at=Object.values(me).filter(ot=>ot.suggestedType==="Land").length,gt=Lt+at,vt=ye.Land||36,ft=Math.max(0,vt-gt);if(ft>0){L(`Calculating mana base for ${ft} remaining land slots...`);const ot=J(o,me),ut=re(ft,ot,c);Object.assign(me,ut),Object.keys(ut).forEach(At=>ke.add(At)),L(`Added ${Object.keys(ut).length} Basic Lands to balance mana curve.`)}_(me),I(ke),L("Architecture complete. Proceeding to Architect view."),h(jh.ARCHITECT)}catch(oe){console.error(oe),i("Architecture failed. Please check your AI key.","error")}finally{w(!1),m("Ready.")}},q=()=>{(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&h(jh.ARCHITECT)},U=oe=>{const ne=new Set(E);ne.has(oe)?ne.delete(oe):ne.add(oe),I(ne)},W=()=>s.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"inline-block p-4 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-4 animate-bounce",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase italic",children:[R," Deck Architect"]}),s.jsxs("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:[R," will analyze your collection and current deck composition to architect the perfect additions for ",s.jsx("span",{className:"text-indigo-400 font-bold",children:a?.name}),"."]})]}),s.jsxs("div",{className:"bg-gray-900/40 backdrop-blur-xl rounded-3xl border border-white/10 p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),s.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Builder Configuration"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Candidate Pool"}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Owned Cards Only"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Hide wishlist items"})]}),s.jsx("div",{onClick:()=>k(oe=>({...oe,ownedOnly:!oe.ownedOnly})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${$.ownedOnly?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${$.ownedOnly?"translate-x-6":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Exclude Assigned"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Skip cards in other decks"})]}),s.jsx("div",{onClick:()=>k(oe=>({...oe,excludeAssigned:!oe.excludeAssigned})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${$.excludeAssigned?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${$.excludeAssigned?"translate-x-6":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Set Priority"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"restrictSet",checked:$.restrictSet,onChange:oe=>k(ne=>({...ne,restrictSet:oe.target.checked})),className:"rounded bg-gray-800 border-gray-700 text-indigo-500 focus:ring-indigo-500 focus:ring-offset-gray-900"}),s.jsx("label",{htmlFor:"restrictSet",className:"text-xs text-indigo-300 font-bold cursor-pointer select-none",children:"Restrict to Set"})]})]}),s.jsx("input",{type:"text",disabled:!$.restrictSet,value:$.setName,onChange:oe=>k(ne=>({...ne,setName:oe.target.value})),placeholder:"e.g. Avatar, KTK, Khans...",className:`w-full bg-gray-950/50 border rounded-xl px-4 py-2.5 text-sm transition-all focus:ring-2 focus:ring-indigo-500/50 outline-none ${$.restrictSet?"border-indigo-500/30 text-white placeholder-gray-600":"border-white/5 text-gray-600 cursor-not-allowed"}`}),$.restrictSet&&s.jsxs("p",{className:"text-[10px] text-yellow-500/80 font-medium animate-fade-in",children:[' Only cards matching "',$.setName,'" will be suggested.']})]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/5 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${v?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:p})]}),s.jsxs("div",{className:"flex gap-4",children:[(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&s.jsx("button",{onClick:q,className:"bg-amber-600/20 hover:bg-amber-600/40 text-amber-500 font-black px-6 py-3 rounded-2xl transition-all uppercase tracking-widest text-[10px] border border-amber-500/20",children:"Quick Skip (Dev)"}),!v&&s.jsx("button",{onClick:ee,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black px-8 py-3 rounded-2xl transition-all shadow-lg shadow-indigo-500/20 uppercase tracking-widest text-xs border border-white/10",children:"Start Architecture"})]})]}),s.jsxs("div",{className:"p-8 h-[400px] overflow-y-auto font-mono text-xs space-y-3 custom-scrollbar bg-black/40 backdrop-blur-inner shadow-inner box-shadow-inner border-t border-white/5 font-medium leading-relaxed",children:[g.length===0?s.jsx("div",{className:"text-gray-600 italic animate-pulse",children:"Waiting for architecture to start..."}):g.map((oe,ne)=>s.jsx("div",{className:"text-gray-300 animate-fade-in pl-4 border-l-2 border-indigo-500/40 py-1 hover:bg-white/5 transition-colors rounded-r",children:oe},ne)),s.jsx("div",{ref:M})]})]})]}),Z=()=>{const oe=Object.values(j).filter(H=>O==="All"||H.suggestedType===O),ne=["All","Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];return s.jsxs("div",{className:"h-full flex flex-col gap-6 py-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Selection Phase"}),s.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:["Review ",R,"'s suggestions and select the ones you want to draft into your deck."]})]}),s.jsx("div",{className:"flex items-center gap-3 bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md",children:[{mode:"grid",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{mode:"table",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"list",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}].map(({mode:H,icon:le})=>s.jsx("button",{onClick:()=>T(H),className:`p-2 rounded-xl transition-all ${S===H?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,title:`${H.charAt(0).toUpperCase()+H.slice(1)} View`,children:le},H))})]}),s.jsx("div",{className:"flex bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md overflow-x-auto no-scrollbar mx-4",children:ne.map(H=>{const le=Object.values(j).filter(ye=>H==="All"||ye.suggestedType===H).length;return H!=="All"&&le===0?null:s.jsxs("button",{onClick:()=>B(H),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${O===H?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[H," ",s.jsx("span",{className:"ml-1 opacity-40 font-mono",children:le})]},H)})}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 custom-scrollbar",children:[S==="list"&&s.jsx("div",{className:"space-y-4",children:oe.map(H=>s.jsxs("div",{onClick:()=>U(H.firestoreId),className:`grid grid-cols-[auto_1fr_auto_auto] gap-8 items-center p-6 rounded-[2rem] border transition-all cursor-pointer group ${E.has(H.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${E.has(H.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10 group-hover:border-white/30"}`,children:E.has(H.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"block text-xl font-black text-white uppercase italic tracking-tight group-hover:text-indigo-300 transition-colors",children:H.name}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.2em] uppercase",children:H.type_line})]}),s.jsxs("div",{className:"text-center font-mono text-indigo-400 font-bold bg-white/5 px-4 py-2 rounded-2xl border border-white/5",children:[H.rating,"/10"]}),s.jsxs("div",{className:"max-w-md bg-black/30 p-4 rounded-2xl border border-white/5 text-sm text-gray-400 font-medium italic leading-relaxed",children:['"',H.reason,'"']})]},H.firestoreId))}),S==="grid"&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-6",children:oe.map(H=>s.jsxs("div",{onClick:()=>U(H.firestoreId),className:`flex flex-col rounded-[2rem] border transition-all cursor-pointer group overflow-hidden ${E.has(H.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden",children:[s.jsx("img",{src:H.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(H.name)}&format=image`,alt:H.name,className:"w-full h-full object-cover transition-transform group-hover:scale-110",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"}),s.jsx("div",{className:`absolute top-4 right-4 w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${E.has(H.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"bg-black/40 border-white/20 group-hover:border-white/40"}`,children:E.has(H.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[s.jsx("span",{className:"block text-lg font-black text-white uppercase italic tracking-tight line-clamp-1",children:H.name}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-300 tracking-[0.2em] uppercase truncate max-w-[70%]",children:H.type_line}),s.jsxs("span",{className:"text-xs font-mono text-indigo-400 font-bold bg-black/60 px-2 py-0.5 rounded-lg border border-white/10",children:[H.rating,"/10"]})]})]})]}),s.jsx("div",{className:"p-4 flex-1 flex flex-col justify-between",children:s.jsxs("div",{className:"text-xs text-gray-400 font-medium italic leading-relaxed line-clamp-3",children:['"',H.reason,'"']})})]},H.firestoreId))}),S==="table"&&s.jsx("div",{className:"bg-gray-950/30 rounded-[2rem] border border-white/5 overflow-hidden",children:s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-white/5 font-black text-[10px] uppercase tracking-[0.2em] text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 w-16",children:"Select"}),s.jsx("th",{className:"px-6 py-4",children:"Card Name"}),s.jsx("th",{className:"px-6 py-4",children:"Type"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"Rating"}),s.jsx("th",{className:"px-6 py-4",children:"Reasoning"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:oe.map(H=>s.jsxs("tr",{onClick:()=>U(H.firestoreId),className:`hover:bg-white/5 cursor-pointer transition-colors ${E.has(H.firestoreId)?"bg-indigo-500/5":""}`,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${E.has(H.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10"}`,children:E.has(H.firestoreId)&&s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-bold text-white uppercase italic tracking-tight",children:H.name})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.1em] uppercase",children:H.type_line})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"font-mono text-indigo-400 font-bold bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:H.rating})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-xs text-gray-400 italic line-clamp-1",children:['"',H.reason,'"']})})]},H.firestoreId))})]})})]}),s.jsxs("div",{className:"p-8 bg-gray-950/40 backdrop-blur-3xl rounded-3xl border border-white/10 flex justify-between items-center shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Draft Progress"}),s.jsxs("span",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:[E.size," Cards Selected"]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>h(jh.ANALYSIS),className:"px-8 py-3.5 bg-white/5 hover:bg-white/10 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-[11px] transition-all",children:"Re-Analyze"}),s.jsx("button",{onClick:()=>h(jh.DEPLOY),className:"px-10 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/20 uppercase tracking-widest text-[11px] border border-white/10 transition-all",children:"Review & Deploy"})]})]})]})},de=()=>{const oe=Array.from(E).map(H=>j[H]),ne=async()=>{if(!v){w(!0);try{const H=[],le=new Map;c.forEach(ke=>{const Ie=ke.scryfall_id||ke.data?.scryfall_id;Ie&&!ke.deck_id&&le.set(Ie,(le.get(Ie)||0)+1)});const ye=new Set(o.map(ke=>ke.name)),me=new Set;for(const ke of oe){const Ie=ke.data||ke,ce=Ie.scryfall_id||Ie.id||(ke.isVirtual?null:ke.firestoreId),Be=ke.type_line&&ke.type_line.includes("Basic Land"),ct=ke.type_line&&(ke.type_line.includes("Relentless Rats")||ke.type_line.includes("Shadowborn Apostle")||ke.type_line.includes("Persistent Petitioners")||ke.type_line.includes("Nazgl")||ke.type_line.includes("Slime Against Humanity"));if(!Be&&!ct&&me.has(ke.name)){console.warn(`[Deploy] Skipping duplicate in batch: ${ke.name}`);continue}if(!Be&&!ct&&ye.has(ke.name)){console.warn(`[Deploy] Skipping card already in deck: ${ke.name}`);continue}me.add(ke.name);let Ve=!1;if(ce&&le.has(ce)){const Ne=le.get(ce);Ne>0&&(Ve=!0,le.set(ce,Ne-1))}if(!Ve&&a.is_mockup===!1&&!Be)throw new Error(`Cannot add unowned card "${ke.name}" to a Collection Deck.`);H.push({scryfall_id:ce,name:ke.name||Ie.name||"Unknown Card",set_code:Ie.set||Ie.set_code||"???",collector_number:Ie.collector_number||"0",finish:"nonfoil",image_uri:Ie.image_uris&&Ie.image_uris.normal||Ie.image_uri||null,data:Ie,count:1,is_wishlist:!(Ve||Be)})}await Ge.post(`/api/decks/${t}/cards/batch`,{cards:H}),i(`Successfully added ${H.length} cards to ${a.name}!`,"success"),e(`/decks/${t}`)}catch(H){console.error("Deployment failed:",H),i("Failed to deploy cards. Please try again.","error")}finally{w(!1)}}};return s.jsxs("div",{className:"max-w-5xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:"Final Deployment"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Review your selected additions before applying them to your deck."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:oe.map(H=>s.jsxs("div",{className:"bg-gray-950/30 p-6 rounded-[2rem] border border-white/10 space-y-4",children:[s.jsx("span",{className:"font-black text-white uppercase italic text-lg truncate block",children:H.name}),s.jsxs("div",{className:"text-xs text-gray-400 leading-relaxed italic",children:['"',H.reason,'"']})]},H.firestoreId))}),s.jsxs("div",{className:"flex gap-6 justify-center",children:[s.jsx("button",{onClick:()=>h(jh.ARCHITECT),className:"px-12 py-4 bg-gray-900 hover:bg-gray-800 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-xs transition-all",children:"Back to Architect"}),s.jsxs("button",{onClick:ne,disabled:v,className:"px-16 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-2xl shadow-indigo-500/40 uppercase tracking-widest text-xs border border-white/10 transition-all",children:['Apply to "',a?.name,'"']})]})]})};if(l)return s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-indigo-500 border-t-transparent rounded-full"})});const be=V(a?.commander)||V(a?.commander_partner);return s.jsxs("div",{className:"min-h-screen bg-gray-950 text-gray-200 font-sans relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${be})`,backgroundSize:"cover",backgroundPosition:"center"},children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/80 to-gray-950/40"})]}),s.jsxs("div",{className:"sticky top-0 z-50 px-6 py-4 flex justify-between items-center bg-gray-950 border-b border-white/5",children:[s.jsxs("button",{onClick:()=>e(`/decks/${t}`),className:"text-gray-500 hover:text-white flex items-center gap-2 group transition-all",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Exit Wizard"})]}),s.jsx("div",{className:"flex gap-12",children:[1,2,3].map(oe=>s.jsxs("div",{className:`flex items-center gap-3 transition-all ${u===oe?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${u>=oe?"bg-indigo-500 text-white":"bg-gray-800 text-gray-600"}`,children:oe}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em]",children:oe===1?"Analysis":oe===2?"Architect":"Deploy"})]},oe))}),s.jsx("div",{className:"w-32"})," "]}),s.jsxs("main",{className:"flex-1 relative z-10 px-4 max-w-7xl mx-auto w-full",children:[u===jh.ANALYSIS&&W(),u===jh.ARCHITECT&&Z(),u===jh.DEPLOY&&de()]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
                @keyframes pulse { 0%, 100% { opacity: 0.2; transform: scale(1.05); } 50% { opacity: 0.4; transform: scale(1); } }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]})},NXe=({onNext:t,onBack:e,currentTier:r})=>{const[n,i]=y.useState("monthly"),[a,o]=y.useState(!1),l=async c=>{o(!0),await t(c,n),o(!1)};return s.jsxs("div",{className:"max-w-7xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.3)]",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h2",{className:"text-4xl font-extrabold text-white",children:"Choose Your Power Level"}),s.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Unlock advanced deck building tools, unlimited storage, and AI-powered insights."})]}),s.jsx(TL,{billingInterval:n,setBillingInterval:i,onSubscribe:l,isLoading:a,currentTier:r||"free",showIntervalSelector:!0}),s.jsx("div",{className:"flex justify-center pt-8",children:e&&s.jsxs("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors flex items-center gap-2",disabled:a,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})})]})},jXe=({onNext:t})=>s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-indigo-500/20 rounded-full flex items-center justify-center ring-1 ring-indigo-500/50 shadow-[0_0_30px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-extrabold text-white mb-4",children:"Welcome to MTG-Forge"}),s.jsxs("p",{className:"text-xl text-gray-300 leading-relaxed",children:["Your ultimate companion for deck building, collection management, and magical optimization.",s.jsx("br",{}),"Let's get everything set up in just a few clicks."]})]}),s.jsx("button",{onClick:t,className:"px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-1",children:"Let's Go"})]}),kXe=({onNext:t,onBack:e})=>{const[r,n]=y.useState("");return s.jsxs("div",{className:"max-w-3xl w-full space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Enable AI Architect"}),s.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Our AI analyzes your cards to suggest synergies, optimal mana curves, and complete deck strategies."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Automated Building"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Generate entire commander decks from a single prompt or theme using your own collection."})]}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Synergy Scouting"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Find hidden gems in your binder that perfectly match your commander's strategy."})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Why do I need my own API Key?"}),s.jsx("p",{className:"text-sm text-blue-100/80 leading-relaxed",children:"MTG-Forge connects directly to Google's Gemini AI to power its deck architect features. To ensure usage, privacy, and zero rampingsubscription fees, we ask users to provide their own free API key. Your key is stored locally on your device and is never shared with us."}),s.jsxs("div",{className:"mt-4 p-3 bg-indigo-900/40 border border-indigo-500/30 rounded-lg",children:[s.jsxs("h4",{className:"font-bold text-indigo-200 mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-400",children:""})," AI is Experimental"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["Our AI Architect is a powerful assistant, but ",s.jsx("strong",{children:"YOU"})," are the true deck builder. AI can suggest amazing synergies, but it can also make mistakes or suggest suboptimal cards. Always review and refine the suggestions to match your personal playstyle and meta."]})]})]})]})}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700 space-y-4 text-left",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Enter your Gemini API Key"}),s.jsx("input",{type:"password",value:r,onChange:i=>n(i.target.value),placeholder:"AIzaSy...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors"}),s.jsxs("div",{className:"text-sm text-gray-400",children:["Don't have a key? ",s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300 underline",children:"Get a free key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 pt-4",children:[e&&s.jsx("button",{onClick:e,className:"nav-button px-10 py-3 rounded-lg font-bold transition-all border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-800/50",children:"Back"}),s.jsx("button",{onClick:()=>t(r),disabled:!r,className:`nav-button px-10 py-3 rounded-lg font-bold transition-all shadow-lg transform hover:-translate-y-0.5 ${r?"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/25":"bg-gray-700 text-gray-400 cursor-not-allowed shadow-none"}`,children:"Save & Enable AI"}),s.jsx("button",{onClick:()=>t(null),className:"text-gray-500 text-sm hover:text-gray-300 underline transition-colors",children:"Skip (Features Disabled)"})]})]})},_Xe=({onNext:t,onBack:e})=>{const{userProfile:r}=Or(),[n,i]=y.useState("selection"),[a,o]=y.useState({name:"",type:"",personality:""}),[l,c]=y.useState([]),[u,h]=y.useState(""),[p,m]=y.useState(!1),g=y.useRef(null),b={name:"Oracle",type:"Mystic Construct",personality:"Wise, Efficient, Slightly Mystical"};y.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[l]);const v=()=>{t(b)},w=async()=>{i("forge"),m(!0),c([{role:"model",content:"Booting Forge System... I am the construct builder. Let's create your companion. First, does your helper have a name, or shall we define their personality first?"}]),m(!1)},j=async()=>{if(!u.trim())return;const I={role:"user",content:u},O=[...l,I];c(O),h(""),m(!0);try{const B=r?.settings?.geminiApiKey;if(!B)throw new Error("API Key missing.");const S=await ul.forgeHelperChat(B,O,a);o(T=>({...T,...S.updatedDraft})),c(T=>[...T,{role:"model",content:S.aiResponse}])}catch(B){console.error("Forge Error:",B),c(S=>[...S,{role:"model",content:"System Glitch. Please repeat."}])}finally{m(!1)}},_=()=>{const I={name:a.name||"Companion",type:a.type||"Construct",personality:a.personality||"Helpful"};t(I)},E=I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),j())};return s.jsxs("div",{className:"w-full max-w-5xl animate-fade-in mx-auto",children:[n==="selection"&&s.jsxs("div",{className:"text-center space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center ring-1 ring-amber-500/50 shadow-[0_0_30px_rgba(245,158,11,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Forge Your Helper"}),s.jsx("p",{className:"text-gray-300 max-w-2xl mx-auto",children:'Who will guide you through the multiverse? You can use our standard "Oracle" construct, or forge a completely custom AI companion with its own name and personality.'})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[e&&s.jsx("button",{onClick:e,className:"col-span-1 md:col-span-2 mx-auto text-gray-500 hover:text-white mb-2 underline",children:" Go Back"}),s.jsxs("button",{onClick:v,className:"p-6 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-gray-500 rounded-xl transition-all group text-left",children:[s.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Default: The Oracle"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"A wise, mystical construct focused on efficient and accurate advice."}),s.jsx("span",{className:"text-xs font-bold uppercase text-gray-500 group-hover:text-white tracking-wider",children:"Select Oracle "})]}),s.jsxs("button",{onClick:()=>{Ln(r?.subscription_tier).features.customAiPersona&&w()},disabled:!Ln(r?.subscription_tier).features.customAiPersona,className:`p-6 border rounded-xl transition-all group text-left relative overflow-hidden ${Ln(r?.subscription_tier).features.customAiPersona?"bg-amber-900/20 hover:bg-amber-900/30 border-amber-500/30 hover:border-amber-500 cursor-pointer":"bg-gray-800/50 border-gray-700 opacity-50 cursor-not-allowed"}`,children:[s.jsx("div",{className:`absolute top-0 right-0 p-2 ${Ln(r?.subscription_tier).features.customAiPersona?"opacity-50":"opacity-20"}`,children:s.jsx("svg",{className:`w-16 h-16 ${Ln(r?.subscription_tier).features.customAiPersona?"text-amber-500":"text-gray-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:`text-xl font-bold mb-2 ${Ln(r?.subscription_tier).features.customAiPersona?"text-white group-hover:text-amber-400":"text-gray-400"}`,children:"Forge Custom Helper"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create a unique companion. Define their name, species, and personality via chat."}),s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${Ln(r?.subscription_tier).features.customAiPersona?"text-amber-500 group-hover:text-white":"text-gray-600"}`,children:Ln(r?.subscription_tier).features.customAiPersona?"Start Forging ":"Requires Wizard Tier"})]})]})]})]}),n==="forge"&&s.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border border-gray-700 rounded-2xl overflow-hidden bg-gray-900",children:[s.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-800",children:[s.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-800/50 flex justify-between items-center",children:s.jsx("span",{className:"font-mono text-amber-400 text-sm",children:"SYSTEM: FORGE PROTOCOL ENGAGED"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l.map((I,O)=>s.jsx("div",{className:`flex ${I.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${I.role==="user"?"bg-amber-600 text-white":"bg-gray-800 text-gray-300"}`,children:I.content})},O)),p&&s.jsx("div",{className:"text-gray-500 text-xs animate-pulse ml-2",children:" Processing..."}),s.jsx("div",{ref:g})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:I=>h(I.target.value),onKeyDown:E,placeholder:"Ex: Name him 'Gobbo', make him a goblin...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-amber-500 focus:outline-none",disabled:p}),s.jsx("button",{onClick:j,disabled:p||!u.trim(),className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold",children:"Send"})]})})]}),s.jsxs("div",{className:"w-full md:w-80 bg-gray-950 p-6 flex flex-col",children:[s.jsx("h3",{className:"text-gray-400 font-bold uppercase tracking-wider text-xs mb-6",children:"Blueprint Status"}),s.jsxs("div",{className:"space-y-6 flex-1",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"DESIGNATION (NAME)"}),s.jsx("div",{className:`text-lg font-bold ${a.name?"text-amber-400":"text-gray-700 italic"}`,children:a.name||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"CLASSIFICATION (TYPE)"}),s.jsx("div",{className:`text-sm font-medium ${a.type?"text-white":"text-gray-700 italic"}`,children:a.type||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"PARAMETERS (PERSONALITY)"}),s.jsx("div",{className:`text-sm font-medium ${a.personality?"text-white":"text-gray-700 italic"}`,children:a.personality||"Undefined"})]})]}),s.jsx("button",{onClick:_,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-lg hover:shadow-green-500/20 transition-all mt-4",children:"Complete Forge Protocol"})]})]})]})},SXe=({onNext:t,onBack:e})=>s.jsxs("div",{className:"text-center max-w-4xl animate-fade-in-up w-full px-4",children:[s.jsx("h2",{className:"text-4xl font-black text-white mb-6 tracking-tight",children:"Master the Forge"}),s.jsx("p",{className:"text-xl text-gray-400 mb-12 max-w-2xl mx-auto",children:"We've built a powerful system, but you don't have to learn it alone. Our integrated help tools are always one click away."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[s.jsxs("div",{className:"bg-gray-800/40 border border-gray-700/50 p-8 rounded-3xl hover:bg-gray-800/60 transition-all hover:-translate-y-1 group",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-indigo-500/10 flex items-center justify-center mb-6 mx-auto group-hover:scale-110 transition-transform",children:s.jsx(W1e,{size:32,className:"text-indigo-400"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"The Oracle"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Click the ",s.jsx("span",{className:"inline-block p-1 bg-gray-700 rounded mx-1",children:"?"})," icon anywhere to ask questions about the current page or your collection."]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-gray-700/50 p-8 rounded-3xl hover:bg-gray-800/60 transition-all hover:-translate-y-1 group",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-emerald-500/10 flex items-center justify-center mb-6 mx-auto group-hover:scale-110 transition-transform",children:s.jsx(x2e,{size:32,className:"text-emerald-400"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Interactive Tours"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Lost? Launch a ",s.jsx("strong",{children:"Tour"})," from the help menu to get a step-by-step walkthrough of any page's features."]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-gray-700/50 p-8 rounded-3xl hover:bg-gray-800/60 transition-all hover:-translate-y-1 group",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-amber-500/10 flex items-center justify-center mb-6 mx-auto group-hover:scale-110 transition-transform",children:s.jsx(I1e,{size:32,className:"text-amber-400"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Expert Guides"}),s.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"Access detailed guides and strategies directly within the app. No need to open a thousand tabs."})]})]}),s.jsxs("div",{className:"flex justify-between items-center max-w-md mx-auto",children:[s.jsx("button",{onClick:e,className:"px-6 py-3 text-gray-500 font-bold hover:text-white transition-colors",children:"Back"}),s.jsx("button",{onClick:t,className:"px-10 py-4 bg-white text-black rounded-xl font-black text-lg tracking-wide hover:scale-105 transition-all shadow-[0_0_40px_rgba(255,255,255,0.3)] hover:shadow-[0_0_60px_rgba(255,255,255,0.5)]",children:"Let's Build Decks "})]})]}),CXe=({onDeckAdded:t})=>{const{addToast:e}=jn(),[r,n]=y.useState(""),[i,a]=y.useState([]),[o,l]=y.useState(!1),[c,u]=y.useState(null),[h,p]=y.useState(!1);y.useEffect(()=>{g("")},[]);const m=async w=>{const j=w.filter(I=>!I.image_uri);if(j.length===0)return;console.log(`[Onboarding] Hydrating art for ${j.length} decks...`);const E=(await Promise.all(j.map(async I=>{try{let O=I.data;const B=L=>{if(!L)return null;const R=X=>Array.isArray(X)?X:[],V=R(L.commander);if(V.length>0)return V[0];const Y=R(L.mainBoard);return Y.length>0?[...Y].sort((J,re)=>(re.cmc||0)-(J.cmc||0))[0]:null};let S=B(O);const T=S&&(!S.set&&!S.set_code&&!S.SetCode&&!O?.code||!S.collector_number&&!S.number&&!S.cn&&!S.CollectorNumber);if(!S||T)try{const L=await Ge.get(`/api/precons/${I.id}`);L&&L.data&&(O=L.data,S=B(O))}catch(L){console.warn(`[Onboarding] Failed to fetch full deck for "${I.name}"`,L)}if(!S)return null;const M=S.set||S.set_code||S.SetCode||O?.code,$=S.collector_number||S.number||S.cn||S.CollectorNumber;if(!M||!$)return console.warn(`[Onboarding] Skipping hydration for "${I.name}": Missing Set/CN on candidate`,S),null;const k=await Ge.post("/api/cards/search",{set:M,cn:$});if(k.data&&k.data.length>0){const L=k.data[0],R=L.image_uris?.art_crop||L.card_faces?.[0]?.image_uris?.art_crop||L.image_uri||L.image_uris?.large||L.card_faces?.[0]?.image_uris?.large||L.image_uris?.normal;if(R)return{id:I.id,image_uri:R}}else console.warn(`[Onboarding] No art found in DB for ${M} #${$}`)}catch(O){console.warn(`[Onboarding] Failed to hydrate image for "${I.name}"`,O)}return null}))).filter(Boolean);E.length>0&&(console.log(`[Onboarding] Successfully hydrated ${E.length} decks.`),a(I=>I.map(O=>{const B=E.find(S=>S.id===O.id);return B?{...O,image_uri:B.image_uri}:O})))},g=async w=>{l(!0);try{let j;if(!w)j=await Ge.get("/api/precons");else{const I=`search=${encodeURIComponent(w)}`;j=await Ge.get(`/api/precons?${I}`)}const _=Array.isArray(j)?j:[],E=w?_:_.filter(I=>I.data?.type==="Commander Deck");a(E),m(E)}catch(j){console.error(j)}finally{l(!1)}},b=async()=>{if(c){p(!0);try{await Ge.createPreconDeck(c.id,{mode:"collection",useExisting:!0}),e(`Added "${c.name}" to your collection!`,"success"),t(c)}catch(w){console.error(w),e("Failed to add deck. Please try again.","error")}finally{p(!1)}}},v=w=>{if(!w||!w.data)return w?.image_uri||null;const j=O=>Array.isArray(O)?O:[],_=O=>O?O.image_uris?.art_crop?O.image_uris.art_crop:O.card_faces?.[0]?.image_uris?.art_crop?O.card_faces[0].image_uris.art_crop:O.image_uris?.large?O.image_uris.large:O.card_faces?.[0]?.image_uris?.large?O.card_faces[0].image_uris.large:null:null,E=j(w.data.commander);if(E.length>0){const O=_(E[0]);if(O)return O}if(w.image_uri)return w.image_uri;const I=[...E,...j(w.data.mainBoard),...j(w.data.sideBoard)];if(I.length===0)return null;I.sort((O,B)=>(B.cmc||0)-(O.cmc||0));for(const O of I){const B=_(O);if(B)return B}return null};return s.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-6 animate-fade-in",children:[s.jsx("div",{className:"flex gap-4",children:s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{id:"precon-search-input",type:"text",placeholder:"Search for a deck (e.g. 'Eldrazi', 'Slivers', 'Mothman')...",value:r,onChange:w=>n(w.target.value),onKeyDown:w=>w.key==="Enter"&&g(r),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-5 py-4 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all"}),s.jsx("button",{onClick:()=>g(r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:o?s.jsx("div",{className:"col-span-full flex justify-center items-center h-40",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):i.length===0?s.jsx("div",{className:"col-span-full text-center py-10 text-gray-500",children:"No decks found. Try searching for a commander or set name."}):i.map(w=>{const j=v(w);return s.jsxs("div",{onClick:()=>u(w),className:`
                                    relative group cursor-pointer rounded-xl overflow-hidden border-2 transition-all duration-200
                                    h-48 flex flex-col justify-end
                                    ${c?.id===w.id?"border-indigo-500 ring-2 ring-indigo-500/50 shadow-xl scale-[1.02] z-10":"border-gray-800 hover:border-gray-600 hover:-translate-y-1"}
                                `,children:[s.jsxs("div",{className:"absolute inset-0 bg-gray-900 z-0",children:[j&&s.jsx("img",{src:j,alt:w.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-60 transition-opacity"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"})]}),s.jsxs("div",{className:"relative z-10 p-4 w-full",children:[s.jsx("h3",{className:"text-lg font-bold text-white leading-tight mb-2 drop-shadow-md line-clamp-2",children:w.name}),s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsx("span",{className:"text-xs font-bold text-gray-200 bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-white/10",children:w.set_code?.toUpperCase()}),c?.id===w.id&&s.jsx("div",{className:"bg-indigo-500 text-white p-1.5 rounded-full shadow-lg animate-fade-in shadow-indigo-500/50",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]})]},w.id)})}),s.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-800",children:s.jsx("button",{id:"precon-import-btn",onClick:b,disabled:!c||h,className:`
                        px-8 py-3 rounded-xl font-bold text-white transition-all shadow-lg flex items-center gap-2
                        ${!c||h?"bg-gray-700 cursor-not-allowed opacity-50":"bg-indigo-600 hover:bg-indigo-500 hover:shadow-indigo-500/25 transform hover:scale-105"}
                    `,children:h?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):s.jsxs(s.Fragment,{children:["Import Selected Deck",s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})]})})})]})},EXe=({onNext:t,onManualEntry:e})=>{const[r,n]=y.useState("selection"),[i,a]=y.useState(!1),o=[{target:"#precon-search-input",title:"Search Database",content:'Type the name of any official Magic: The Gathering product. Try "Commander" or a set name.'},{target:"#precon-import-btn",title:"One-Click Import",content:"Once you select a deck, click here to instantly add all valid cards (and prints!) to your collection."}],l=c=>{setTimeout(()=>{t()},1500)};return s.jsxs("div",{className:"w-full max-w-5xl animate-fade-in-up px-4",children:[s.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-2 text-center tracking-tight",children:r==="selection"?"Start Your Collection":"Find Your Deck"}),s.jsx("p",{className:"text-gray-400 text-center mb-10 max-w-2xl mx-auto",children:r==="selection"?"Your vault is empty. Let's add your first cards.":"Search our database of official preconstructed decks."}),r==="selection"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[s.jsxs("button",{onClick:e,className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-3xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-2xl flex flex-col h-full",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-indigo-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:s.jsx(z2e,{size:32,className:"text-indigo-400"})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Add Manually"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:"Have loose cards or a custom binder? Use our fast search to add them one by one."}),s.jsx("div",{className:"mt-auto flex items-center text-indigo-400 font-bold text-sm tracking-wide",children:"GO TO COLLECTION "})]}),s.jsxs("button",{onClick:()=>{n("precon"),setTimeout(()=>a(!0),1e3)},className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-purple-500 rounded-3xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-2xl flex flex-col h-full",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-purple-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:s.jsx(LQ,{size:32,className:"text-purple-400"})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Import Precon"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:"Bought a Commander deck or Structure Deck? Find it and add all 100 cards instantly."}),s.jsx("div",{className:"mt-auto flex items-center text-purple-400 font-bold text-sm tracking-wide",children:"SEARCH DATABASE "})]})]}),r==="selection"&&s.jsx("div",{className:"mt-12 text-center",children:s.jsx("button",{onClick:t,className:"text-gray-500 hover:text-white transition-colors text-sm font-medium hover:underline underline-offset-4",children:"Skip for now, I'll figure it out later"})}),r==="precon"&&s.jsxs("div",{className:"bg-gray-900/50 border border-gray-800 rounded-3xl p-6 md:p-8 backdrop-blur-sm",children:[s.jsx("button",{onClick:()=>{n("selection"),a(!1)},className:"mb-6 flex items-center text-gray-500 hover:text-white transition-colors text-sm font-bold uppercase tracking-wider",children:" Back to Options"}),s.jsx(CXe,{onDeckAdded:l})]}),s.jsx(pf,{steps:o,isOpen:i,onClose:()=>a(!1),tourId:"onboarding_precon_tour"})]})},AXe=()=>{const t=xn(),[e,r]=v4(),{userProfile:n,updateSettings:i,refreshUserProfile:a}=Or(),[o,l]=y.useState(n?.settings?.onboarding_step||0),[c,u]=y.useState(!1),[h,p]=y.useState(null),[m,g]=y.useState([null,null,null,null]),[b,v]=y.useState(1),[w,j]=y.useState(!1);y.useEffect(()=>{e.get("success")==="true"&&o<=1&&(async()=>{try{await Ge.post("/api/payments/sync-subscription"),await a()}catch(J){console.error("Sync failed",J)}await i({subscription_status:"active",onboarding_step:2}),l(2),r({})})()},[e,o,i,r]);const _=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],E=async()=>{const Y=o+1;l(Y),await i({onboarding_step:Y})},I=async()=>{const Y=Math.max(0,o-1);l(Y),await i({onboarding_step:Y})},O=async Y=>{const X=o+1;l(X),await i({helper:Y,onboarding_step:X})},B=async(Y,X)=>{if(Y===nr.FREE||Y==="free"){const J=o+1;l(J),await i({subscription_tier:"free",onboarding_step:J});return}try{const J=await Ge.post("/api/payments/create-checkout-session",{tierId:Y,interval:X,successUrl:`${window.location.origin}/onboarding?success=true`,cancelUrl:`${window.location.origin}/onboarding?canceled=true`});J.url&&(window.location.href=J.url)}catch(J){console.error("Subscription error:",J),alert("Failed to start checkout. Please try again.")}},S=async Y=>{const X=o+1;l(X),await i({ai_enabled:!!Y,geminiApiKey:Y||void 0,onboarding_step:X})},T=async(Y,X,J)=>{j(!0);try{const re={organization:{mode:Y.id,sortHierarchy:X.filter(Boolean),groupingPreference:J}};await i(re);const se=o+1;l(se),await i({onboarding_step:se})}catch(re){console.error(re)}finally{j(!1)}},M=()=>{if(!h)return;let Y=h.sort,X=h.grouping;if(h.id==="advanced"&&(Y=m,Y.filter(Boolean).length>0)){const J=Y.filter(Boolean)[0];["color","color_identity"].includes(J)?X="color":["set","release"].includes(J)?X="set":["type"].includes(J)?X="type":["rarity"].includes(J)&&(X="rarity")}T(h,Y,X)},$=()=>{u(!0)},k=async Y=>{const X=o+1;l(X),await i({playstyle:Y,onboarding_step:X}),await a(),u(!1)},L=async()=>{const Y=o+1;l(Y),await i({onboarding_step:Y})},R=async()=>{await i({onboarding_complete:!0,onboarding_step:8}),t("/dashboard")},V=async()=>{await i({onboarding_complete:!0,onboarding_step:8}),t("/collection?onboarding=true&openAdd=true")};return s.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-30"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/90 to-black/80"})]}),s.jsxs("div",{className:"relative z-10 flex-grow flex items-center justify-center p-4",children:[o===0&&s.jsx(jXe,{onNext:E}),o===1&&s.jsx(NXe,{onNext:B,onBack:I,currentTier:n?.subscription_tier}),o===2&&s.jsx(kXe,{onNext:S,onBack:I}),o===3&&s.jsxs("div",{className:"text-center max-w-6xl animate-fade-in-up w-full",children:[b===1&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400 mb-8",children:"How do you want to sort and view your cards?"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 max-w-5xl mx-auto items-stretch",children:_.map(Y=>s.jsxs("button",{onClick:()=>{p(Y),Y.id==="advanced"?v(1.5):Y.id==="hybrid"?v(2):T(Y,Y.sort,Y.grouping)},disabled:w,className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl disabled:opacity-50 flex flex-col h-full",children:[s.jsx("div",{className:"text-3xl mb-3 group-hover:scale-110 transition-transform",children:Y.icon}),s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:Y.name}),s.jsx("p",{className:"text-xs text-gray-300 mb-3 h-8",children:Y.description}),s.jsx("ul",{className:"text-[10px] text-gray-400 space-y-1.5 mt-auto pt-4 border-t border-gray-700/50",children:Y.features.map((X,J)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),X]},J))})]},Y.id))}),s.jsx("div",{className:"mt-8",children:s.jsx("button",{onClick:I,className:"text-gray-500 hover:text-white",children:"Back"})})]}),b===1.5&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Custom Hierarchy"}),s.jsx("div",{className:"space-y-3",children:[0,1,2,3].map(Y=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:Y+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:m[Y]||"",onChange:X=>{const J=[...m];J[Y]=X.target.value,g(J)},children:[s.jsx("option",{value:"",children:"(None)"}),s.jsx("option",{value:"color",children:"Color"}),s.jsx("option",{value:"type",children:"Type"}),s.jsx("option",{value:"cmc",children:"Mana Value"}),s.jsx("option",{value:"set",children:"Set"}),s.jsx("option",{value:"rarity",children:"Rarity"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"})]})]},Y))}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>v(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:M,disabled:w,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:w?"Saving...":"Save Hierarchy"})]})]}),b===2&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Hybrid Organization"}),s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["Your collection will be grouped by ",s.jsx("strong",{children:"Set"}),"."]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>v(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:M,disabled:w,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:w?"Saving...":"Finish Setup"})]})]})]}),o===4&&s.jsx(_Xe,{onNext:O,onBack:I}),o===5&&s.jsxs("div",{className:"text-center max-w-2xl animate-fade-in-up space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500/20 rounded-full flex items-center justify-center ring-1 ring-green-500/50 shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Define Your Playstyle"}),s.jsxs("p",{className:"text-gray-300",children:["Let us get to know what kind of mage you are.",s.jsx("br",{}),"We'll tailor card suggestions and deck strategies to your personal taste."]})]}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx("button",{onClick:I,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Back"}),s.jsx("button",{onClick:$,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"Start Quiz"}),s.jsx("button",{onClick:L,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Skip for Now"})]})]}),o===6&&s.jsx(SXe,{onNext:E,onBack:I}),o===7&&s.jsx(EXe,{onNext:R,onManualEntry:V})]}),s.jsx("div",{className:"relative z-10 py-8 flex justify-center gap-3",children:[0,1,2,3,4,5,6,7].map(Y=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${Y===o?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},Y))}),s.jsx(fX,{isOpen:c,onClose:()=>u(!1),onComplete:k})]})},TXe=()=>s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsxs("div",{className:"relative py-20 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-900/10"}),s.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-6 text-center",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white mb-6 tracking-tight",children:"About The Forge"}),s.jsx("p",{className:"text-xl text-gray-400 leading-relaxed",children:"Built by players, for players. The Forge is designed to be the ultimate companion for Magic: The Gathering deck building and collection management."})]})]}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 space-y-16",children:[s.jsxs("section",{className:"space-y-6 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-amber-500 rounded-full"}),"The Human Factor"]}),s.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-3xl border border-amber-500/10 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:s.jsx("svg",{className:"w-64 h-64 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"AI is a Tool, Not a Replacement"}),s.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[s.jsx("p",{children:"At The Forge, we believe AI can be an incredible creative partner. It can scan thousands of cards in seconds, find obscure combos, and suggest perfectly curved land bases."}),s.jsxs("p",{children:[s.jsx("strong",{className:"text-amber-400",children:"However, AI is still a work in progress."}),' It can hallucinate interactions, suggest banned cards, or miss the subtle "fun factor" that makes a Commander deck truly special.']}),s.jsx("p",{children:"We built these tools to get you 80% of the way there. The final 20%the soul of the deckcomes from you. Use our suggestions as a starting point, but trust your intuition and knowledge to build something truly unique."})]})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-indigo-500 rounded-full"}),"Powered By"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("a",{href:"https://scryfall.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-indigo-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Scryfall"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"The best MTG card database in the world. All card data and imagery is provided by their incredible API."})]}),s.jsxs("a",{href:"https://tcgplayer.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-green-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-green-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"TCGPlayer"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time pricing data for card values. Keeping your collection valuation accurate and up to date."})]}),s.jsxs("a",{href:"https://magic.wizards.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-orange-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Wizards of the Coast"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Creators of Magic: The Gathering. All mana symbols, card names, and art are copyright WotC."})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up delay-100",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-purple-500 rounded-full"}),"Get in Touch"]}),s.jsx("div",{className:"bg-gradient-to-br from-indigo-900/20 to-purple-900/20 p-8 rounded-3xl border border-white/5 relative overflow-hidden",children:s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[s.jsxs("div",{className:"space-y-4 text-center md:text-left",children:[s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Join the Community"}),s.jsx("p",{className:"text-gray-400 max-w-md",children:"Have a feature request? Found a bug? Or just want to show off your latest brew? Come chat with us on Discord."})]}),s.jsxs("a",{href:"https://discord.gg/your-discord-link",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/25 flex items-center gap-3 transform hover:-translate-y-1",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]})]})})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs pt-20",children:s.jsx("p",{children:"The Forge is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Wizards of the Coast LLC."})})]})]}),Uy=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],IXe=()=>{const{slug:t}=yl(),e=xn(),{currentUser:r}=Or(),{addToast:n}=jn(),[i,a]=y.useState(null),[o,l]=y.useState(!0),[c,u]=y.useState(null),[h,p]=y.useState("grid"),[m,g]=y.useState(!1),[b,v]=y.useState(!1),[w,j]=y.useState(0);y.useEffect(()=>{(async()=>{try{const Y=await Ge.get(`/api/decks/public/${t}`);a(Y)}catch(Y){console.error("Public deck load failed",Y),u("Deck not found or private.")}finally{l(!1)}})()},[t]);const{deck:_,items:E}=i||{},I=y.useMemo(()=>{if(!_)return Uy.find(re=>re.badge==="Colorless");if(_?.format?.toLowerCase()==="standard"){const re=_.colors||_.commander?.color_identity||[];return Uy.find(ee=>ee.colors.length!==re.length?!1:ee.colors.every(q=>re.includes(q)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const V=_?.commander?.color_identity||[],Y=_?.commander_partner?.color_identity||[],X=[...new Set([...V,...Y])];return X.length===0?Uy.find(re=>re.badge==="Colorless"):Uy.find(re=>re.colors.length!==X.length?!1:re.colors.every(se=>X.includes(se)))||Uy.find(re=>re.badge==="Colorless")},[_]),O=y.useMemo(()=>{if(!E)return 0;let V=E.reduce((J,re)=>J+(re.countInDeck||re.count||1),0);const Y=_?.commander?.id||_?.commander?.scryfall_id,X=_?.commander_partner?.id||_?.commander_partner?.scryfall_id;return _?.commander&&!E.some(J=>(J.scryfall_id||J.id)===Y)&&V++,_?.commander_partner&&!E.some(J=>(J.scryfall_id||J.id)===X)&&V++,V},[E,_]),B=y.useMemo(()=>{if(!E)return 0;let V=E.reduce((J,re)=>{const se=parseFloat(re.prices?.[re.finish==="foil"?"usd_foil":"usd"]||re.data?.prices?.[re.finish==="foil"?"usd_foil":"usd"]||0);return J+se*(re.countInDeck||re.count||1)},0);const Y=_?.commander?.id||_?.commander?.scryfall_id,X=_?.commander_partner?.id||_?.commander_partner?.scryfall_id;if(_?.commander&&!E.some(J=>(J.scryfall_id||J.id)===Y)){const J=_.commander;V+=parseFloat(J.prices?.usd||0)}if(_?.commander_partner&&!E.some(J=>(J.scryfall_id||J.id)===X)){const J=_.commander_partner;V+=parseFloat(J.prices?.usd||0)}return V},[E,_]),S=V=>{if(!E)return 0;let Y=E.reduce((re,se)=>((se.data||se).type_line||"").includes(V)?re+(se.countInDeck||1):re,0);const X=_?.commander?.id||_?.commander?.scryfall_id,J=_?.commander_partner?.id||_?.commander_partner?.scryfall_id;return _?.commander&&!E.some(re=>(re.scryfall_id||re.id)===X)&&(_.commander.type_line||"").includes(V)&&Y++,_?.commander_partner&&!E.some(re=>(re.scryfall_id||re.id)===J)&&(_.commander_partner.type_line||"").includes(V)&&Y++,Y},T=y.useMemo(()=>{const V=_?.ai_blueprint||_?.aiBlueprint||{},Y=V.layout?.types||V.suggestedCounts||{};return[{label:"Total",current:O,target:_?.format?.toLowerCase()==="standard"||_?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:S("Creature"),target:Y.Creatures||Y.Creature||30},{label:"Lands",current:S("Land"),target:Y.Lands||Y.Land||36},{label:"Instants",current:S("Instant"),target:Y.Instants||Y.Instant||10},{label:"Sorceries",current:S("Sorcery"),target:Y.Sorceries||Y.Sorcery||10},{label:"Enchantments",current:S("Enchantment"),target:Y.Enchantments||Y.Enchantment||5},{label:"Artifacts",current:S("Artifact"),target:Y.Artifacts||Y.Artifact||10},{label:"Planeswalkers",current:S("Planeswalker"),target:Y.Planeswalkers||Y.Planeswalker||0}].filter(J=>J.target>0)},[_,O,E]),M=y.useMemo(()=>{if(!E)return{};const V={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return E.forEach(Y=>{const J=((Y.data||Y).type_line||"").toLowerCase(),re=Y.scryfall_id||Y.id,se=_?.commander&&re===(_.commander.id||_.commander.scryfall_id),ee=_?.commander_partner&&re===(_.commander_partner.id||_.commander_partner.scryfall_id);if(se||ee){V.Commander.push(Y);return}J.includes("creature")?V.Creature.push(Y):J.includes("planeswalker")?V.Planeswalker.push(Y):J.includes("instant")?V.Instant.push(Y):J.includes("sorcery")?V.Sorcery.push(Y):J.includes("artifact")?V.Artifact.push(Y):J.includes("enchantment")?V.Enchantment.push(Y):J.includes("land")?V.Land.push(Y):V.Other.push(Y)}),Object.fromEntries(Object.entries(V).filter(([Y,X])=>X.length>0))},[E,_]);if(o)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(c||!_)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center text-red-500 font-bold text-xl",children:c||"Deck inaccessible"});const $=w===0?_.commander:_.commander_partner||_.commander,k=$?.image_uris?.art_crop||$?.card_faces?.[0]?.image_uris?.art_crop||"",L={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},R=async()=>{if(r)try{n("Cloning deck...","info");const V=await Xo.createDeck(r.uid,{name:`Copy of ${_.name}`,commander:_.commander,commanderPartner:_.commander_partner,format:_.format,isMockup:!0}),Y=E.map(X=>({scryfall_id:X.scryfall_id||X.id,name:X.name,set_code:X.set_code,collector_number:X.collector_number,finish:X.finish,image_uri:X.image_uri,data:X.data}));await Ge.post(`/api/decks/${V.id}/cards/batch`,{cards:Y}),n("Deck cloned successfully!","success"),e(`/decks/${V.id}`)}catch(V){console.error(V),n("Failed to clone deck","error")}};return s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${k})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:_.format||"Commander"}),s.jsxs("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:["Shared by ",_.user_id?"a User":"Unknown"]})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:_.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(()=>{const V=_?.commander?.color_identity||[],Y=_?.commander_partner?.color_identity||[];return[...new Set([...V,...Y])].map(J=>s.jsx("img",{src:L[J],alt:J,className:"w-6 h-6"},J))})()}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:I.theme})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",B.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[O," Cards"]}),r?s.jsx("button",{onClick:R,className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Clone to Collection"}):s.jsx(Er,{to:"/login",className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Login to Clone"})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-8",children:T.map((V,Y)=>{const X=V.target>0?Math.min(V.current/V.target*100,100):0,J=V.target>0&&V.current===V.target,re=V.target>0&&V.current>V.target;return s.jsxs("div",{className:"bg-gray-950/20 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:V.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${J?"text-green-400":re?"text-orange-400":"text-indigo-300"}`,children:[V.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),V.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${J?"bg-green-500":re?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${X||0}%`}})})]},Y)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>p("grid"),className:`p-1.5 rounded ${h==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>p("table"),className:`p-1.5 rounded ${h==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries(M).map(([V,Y])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:V}),s.jsx("span",{className:"text-gray-500",children:Y.length})]}),h==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:Y.map((X,J)=>s.jsx(Qx,{card:X,readOnly:!0},J))}):s.jsx("div",{className:"space-y-1",children:Y.map((X,J)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:X.countInDeck||1}),s.jsx("span",{className:X.finish==="foil"?"text-yellow-200":"",children:X.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:X.mana_cost})]},J))})]},V))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[_.commander&&s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:"Commander"}),s.jsx("img",{src:$?.image_uris?.normal||$?.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Commander"}),_.commander_partner&&s.jsx("button",{onClick:()=>j(V=>V===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:"View Partner"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>v(!0),className:"text-[10px] font-black text-white uppercase tracking-[0.2em] bg-indigo-600 flex flex-col items-center gap-2 p-3 rounded-2xl hover:bg-indigo-500 transition-all shadow-xl shadow-indigo-900/40 group overflow-hidden",children:[s.jsx("svg",{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[8px]",children:"Deck Doctor"})]}),s.jsx("button",{onClick:()=>g(!0),className:"text-[10px] font-bold text-indigo-400 hover:text-white uppercase tracking-wider bg-indigo-500/10 px-2 py-1 rounded hover:bg-indigo-500/20 transition-colors",children:"Details "})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(x4,{cards:E,type:"mana"})]}),s.jsxs("div",{className:"h-[160px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(x4,{cards:E,type:"types"})]})]})]}),!r&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 backdrop-blur-md rounded-3xl border border-white/10 p-6 text-center",children:[s.jsx("h3",{className:"font-bold text-white mb-2",children:"Build Your Own Decks"}),s.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Join MTG Forge to manage your collection, build decks with AI, and track prices."}),s.jsx(Er,{to:"/login",className:"block w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-900/20 transition-all text-sm",children:"Get Started Free"})]})]})]})]}),s.jsx(Xee,{isOpen:m,onClose:()=>g(!1),cards:E,deckName:_.name}),s.jsx(Qee,{isOpen:b,onClose:()=>v(!1),deck:_,cards:E,isOwner:!1})]})},LXe=()=>{const[t,e]=y.useState([]);return y.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{i(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"fixed bottom-0 left-0 w-full h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border-t border-green-500/20",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5",children:r},n))})},PXe=()=>{const{sessionId:t}=yl(),[e,r]=y.useState("connecting"),[n,i]=y.useState(null),[a,o]=y.useState([]),l=y.useRef(null),c=y.useRef(null),[u,h]=y.useState(null),[p,m]=y.useState(!1),[g,b]=y.useState(!1),[v,w]=y.useState(null);y.useEffect(()=>{const O=Vp();return i(O),O.on("connect",()=>{console.log("Connected to Forge Bridge"),O.emit("join-pairing",t),r("ready")}),O.on("disconnect",()=>{console.log("Disconnected"),r("error")}),()=>O.disconnect()},[t]),y.useEffect(()=>{let O=null;return(async()=>{try{console.log("[OCR] Initializing Tesseract (Remote)...");const S=await SQ.createWorker("eng",1,{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),O=S,h(S),b(!0)}catch(S){console.error("OCR Worker Init Failed",S||"Unknown Error")}})(),()=>{O&&O.terminate()}},[]);const j=async()=>{if(!(!g||p||!l.current)){m(!0);try{const O=l.current.getScreenshot();if(!O)return;const B=new Image;B.src=O,await new Promise(T=>B.onload=T);const S=await _(B);await I(S)}catch(O){console.error("Processing error",O),w({error:"Processing Error"})}finally{m(!1),setTimeout(()=>{w(O=>O?.error?null:O)},3e3)}}},_=async O=>{const B=c.current,S=B.getContext("2d",{willReadFrequently:!0}),T=async(q,U,W,Z)=>{let de=250/Z;de=Math.max(.1,Math.min(de,4));let be=Math.floor(W*de),oe=Math.floor(Z*de);be>4e3&&(de=4e3/W,be=4e3,oe=Math.floor(Z*de)),console.log(`[RemoteLens] OCR Crop: ${be}x${oe} (Src: ${Math.floor(W)}x${Math.floor(Z)})`),B.width=be,B.height=oe,S.imageSmoothingEnabled=!0,S.imageSmoothingQuality="high",S.drawImage(O,q,U,W,Z,0,0,be,oe);const ne=S.getImageData(0,0,B.width,B.height),H=ne.data;for(let me=0;me<H.length;me+=4){const ke=(H[me]+H[me+1]+H[me+2])/3;H[me]=H[me+1]=H[me+2]=ke}S.putImageData(ne,0,0);const{data:{text:le}}=await u.recognize(B);return le.split(`
`).map(me=>me.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(me=>me.length>=1)},M=O.width,$=O.height,k=Math.min(M,$),L=(M-k)/2,R=($-k)/2;console.log(`[RemoteLens] Precision Mode: ${M}x${$}, Crop: ${k}x${k} @ (${L}, ${R})`);const V=await T(L+k*.1,R+k*.35,k*.8,k*.3);let Y="",X="";const J=V.join(" ").toUpperCase();console.log(`[RemoteLens] Raw Scan: "${J}"`);const se=(J.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(q=>!/^(19|20)\d{2}$/.test(q));se.length>0&&(X=se[0]);const ee=J.match(/\b[A-Z0-9]{3,4}\b/g);if(ee){const q=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],U=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],W=ee.find(Z=>!U.includes(Z)&&!q.includes(Z)&&!/^\d+$/.test(Z));W&&(Y=W)}return{name:"",set:Y,cn:X,raw_footer:J}},E=(O,B,S)=>{const T={id:Math.random().toString(36).substr(2,9),scryfall_id:O.scryfall_id||O.uuid,name:O.name,set_name:O.set_name||O.setcode,set_code:O.set||O.setcode,collector_number:O.collector_number||O.number,image:O.image_uri||O.image_uris?.small||O.card_faces?.[0]?.image_uris?.small,finish:"nonfoil",quantity:1,data:O,variants:B,raw_ocr:S};n.emit("card-scanned",{sessionId:t,card:T}),o(M=>[T,...M].slice(0,5)),w({success:!0,name:O.name})},I=async({name:O,set:B,cn:S,raw_footer:T})=>{if(console.log(`[RemoteLens] Resolving: Set="${B}", CN="${S}"`),B&&S){console.log(`[RemoteLens] Attempting Set/CN match: ${B} #${S}`);try{const M=await Ge.post("/api/cards/search",{set:B,cn:S});if(M.data&&M.data.length>0){const $=M.data[0];console.log(`[RemoteLens] Match found: ${$.name}`);const k=M.data.length>1?M.data:[$];E($,k,{name:O,set:B,cn:S});return}else{w({error:`Not Found: ${B} #${S}`});return}}catch(M){console.warn("[RemoteLens] Set/CN search failed",M)}}w({error:"Scan Set Code & Number"})};return s.jsxs("div",{className:"fixed inset-0 bg-gray-950 flex flex-col items-center justify-between p-6 text-white overflow-hidden",children:[s.jsx(LXe,{}),s.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(IA,{className:"w-5 h-5 text-indigo-400"}),s.jsx("h1",{className:"font-black italic uppercase text-lg",children:"Forge Remote"})]}),s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${e==="ready"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[e==="ready"?s.jsx(cwe,{className:"w-3 h-3"}):s.jsx(owe,{className:"w-3 h-3"}),e==="ready"?"Paired":"Connecting..."]})]}),s.jsxs("div",{className:"relative w-full aspect-[3/4] max-h-[60vh] rounded-3xl overflow-hidden border-2 border-white/10 shadow-2xl bg-black",children:[s.jsx(NQ,{ref:l,audio:!1,screenshotFormat:"image/webp",videoConstraints:{facingMode:"environment"},className:"w-full h-full object-cover brightness-110 contrast-125"}),s.jsxs("div",{className:"absolute inset-4 border-2 border-white/5 rounded-2xl pointer-events-none",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 w-full px-8",children:p?s.jsx("div",{className:"bg-indigo-600 text-white text-xs py-2 rounded-full font-black text-center animate-pulse",children:"ANALYZING..."}):v?.success?s.jsxs("div",{className:"bg-green-600 text-white text-xs py-2 rounded-full font-black text-center flex items-center justify-center gap-2",children:[s.jsx(Od,{className:"w-4 h-4"})," ",v.name," SENT!"]}):v?.error?s.jsx("div",{className:"bg-red-600 text-white text-xs py-2 rounded-full font-black text-center",children:v.error}):s.jsx("div",{className:"bg-black/60 backdrop-blur-md text-white/60 text-[10px] py-2 rounded-full text-center uppercase font-bold tracking-widest",children:"Align Set Code & Number"})})]})]}),s.jsxs("div",{className:"w-full flex flex-col items-center gap-6 mb-20",children:[s.jsx("button",{onClick:j,disabled:p||!g,className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center shadow-2xl active:scale-90 transition-all border-4 border-white/5",children:p?s.jsx(tj,{className:"w-10 h-10 animate-spin"}):s.jsx(AA,{className:"w-10 h-10"})}),s.jsx("div",{className:"w-full h-20 flex gap-3 overflow-x-auto pb-2 scroll-smooth",children:a.map((O,B)=>s.jsxs("div",{className:"flex-shrink-0 w-12 h-16 rounded-lg overflow-hidden border border-white/10 relative group",children:[s.jsx("img",{src:O.image,className:"w-full h-full object-cover",alt:""}),s.jsx("div",{className:"absolute inset-0 bg-green-500/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Od,{className:"w-4 h-4 text-white"})})]},B))})]}),s.jsx("canvas",{ref:c,className:"hidden"})]})},OXe=()=>s.jsxs("div",{className:"min-h-screen bg-gray-950 text-white relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-indigo-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-orange-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(30,27,75,0.2)_0%,transparent_70%)]"})]}),s.jsxs("div",{className:"relative z-20 max-w-7xl mx-auto px-4 w-full py-8",children:[s.jsxs(Er,{to:"/",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors gap-2 group mb-12",children:[s.jsx(EQ,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),s.jsx("span",{className:"font-bold uppercase tracking-widest text-xs",children:"Back to The Forge"})]}),s.jsxs("div",{className:"max-w-4xl",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-6 text-indigo-400",children:[s.jsx(LA,{className:"w-4 h-4"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Actionable Intelligence"})]}),s.jsxs("h1",{className:"text-5xl md:text-7xl font-black tracking-tight mb-8 leading-tight",children:["The AI Strategic",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-500 to-orange-500",children:"Companion Guide"})]}),s.jsx("p",{className:"text-xl md:text-2xl text-gray-400 leading-relaxed font-medium max-w-2xl",children:"Stop tracking data. Start forging strategy. Explore the neural engines that give you the edge in every brew and every match."})]})]}),s.jsxs("main",{className:"relative z-10 max-w-7xl mx-auto px-4 py-24 space-y-48",children:[s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/30 blur-[80px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-black/60 border border-white/10 rounded-[3rem] p-12 backdrop-blur-3xl shadow-2xl",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Neural Synthesis Engine"}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-sm font-bold text-gray-400 italic",children:'"Architect, build me a Bracket 4 competitive deck around [Selected Commander], prioritize my collection first..."'}),s.jsx("div",{className:"h-[1px] w-full bg-white/10"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{l:"Analyzing Archetype...",s:"100%"},{l:"Mapping Collection Staples...",s:"84%"},{l:"Optimizing Mana Curve...",s:"92%"},{l:"Finalizing Deck List...",s:"Processing"}].map((t,e)=>s.jsxs("div",{className:"flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-500",children:[s.jsx("span",{children:t.l}),s.jsx("span",{className:t.s==="100%"?"text-green-400":"text-indigo-400",children:t.s})]},e))})]}),s.jsxs("div",{className:"p-6 bg-indigo-500/10 rounded-2xl border border-indigo-500/20",children:[s.jsx("div",{className:"text-white font-black text-lg mb-2",children:"The Neural Architect"}),s.jsxs("div",{className:"text-gray-400 text-sm leading-relaxed",children:["Generating 100-card Commander list... ",s.jsx("br",{}),s.jsx("span",{className:"text-indigo-300",children:"62/100 Cards found in your collection."})," ",s.jsx("br",{}),s.jsx("span",{className:"text-orange-300",children:"38/100 Cards required for purchase."})]})]})]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center text-indigo-400 border border-indigo-500/20 shadow-[0_0_40px_rgba(79,70,229,0.3)]",children:s.jsx(um,{className:"w-10 h-10"})}),s.jsxs("h2",{className:"text-5xl font-black leading-tight",children:["Zero-to-Brews:",s.jsx("br",{}),"The Neural Architect"]}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"While other sites give you a search bar, we give you a brain. The **Neural Architect** is the world's first AI engine that doesn't just suggest cardsit synthesizes entire, playable decks from your Commander selection."}),s.jsx("ul",{className:"space-y-6",children:[{t:"Commander-Centric Synthesis",d:"Select your Commander and target a specific power bracket for a precision brew."},{t:"Collection-Aware logic",d:"The AI builds around what you own, drastically reducing the cost of new brews."},{t:"Bracket-Targeting",d:"Specify exactly which pod power level you want to compete in."}].map((t,e)=>s.jsxs("li",{className:"flex gap-4",children:[s.jsx("div",{className:"mt-1 w-5 h-5 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400 text-[10px] font-black border border-indigo-500/30 shrink-0",children:e+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-bold",children:t.t}),s.jsx("div",{className:"text-gray-500 text-sm",children:t.d})]})]},e))})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"space-y-8 order-2 lg:order-1",children:[s.jsx("div",{className:"w-16 h-16 bg-orange-500/10 rounded-2xl flex items-center justify-center text-orange-400 border border-orange-500/20",children:s.jsx(mB,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"The AI Deck Doctor"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Traditional deck-building tools treat your list like a static file. The **Deck Doctor** treats it like a living strategy. It uses advanced neural analysis to evaluate not just individual cards, but the synergistic web they form."}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-bold flex items-center gap-3",children:[s.jsx(G2e,{className:"w-5 h-5 text-indigo-400"}),"The 1-5 Bracket System"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[{t:"Bracket 1",d:"Casual/Precon: Narrative focus."},{t:"Bracket 3",d:"High Power: Efficient execution."},{t:"Bracket 5",d:"Maximum Power: Competitive meta."},{t:"0.01 PL Step",d:"Precision tracking of deck shifts."}].map((t,e)=>s.jsxs("div",{className:"p-4 bg-white/5 rounded-xl border border-white/10",children:[s.jsx("div",{className:"font-black text-indigo-400 text-sm mb-1 uppercase tracking-wider",children:t.t}),s.jsx("div",{className:"text-sm text-gray-400",children:t.d})]},e))})]})]}),s.jsxs("div",{className:"relative order-1 lg:order-2 group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Power Level"}),s.jsx("div",{className:"text-5xl font-black text-white",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30 text-indigo-400 font-bold uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-orange-500 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-orange-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Recommended Adjustments"}),[{out:"Murder",in:"Assassin's Trophy",reason:"Broadened threat coverage"},{out:"Sol Ring",in:"Mana Crypt",reason:"Maximum acceleration"}].map((t,e)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-black/40 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-red-400 text-xs font-bold line-through",children:["OUT: ",t.out]}),s.jsxs("div",{className:"text-green-400 text-sm font-bold mt-1",children:["IN: ",t.in]})]}),s.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:t.reason})]},e))]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-500/10 rounded-2xl flex items-center justify-center text-indigo-400 border border-indigo-500/20",children:s.jsx(um,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"Surgical Swaps"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Stop buying proxies you don't need or spending money on cards that clash with your goals. Our AI scans your **available collection** in real-time to suggest surgical changes."}),s.jsx("ul",{className:"space-y-4",children:["Find hidden staples already in your binders","Optimize curve without increasing budget","Identify over-committed resources"].map((t,e)=>s.jsxs("li",{className:"flex items-center gap-3 text-white font-medium",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),t]},e))})]})]}),s.jsxs("section",{className:"space-y-16",children:[s.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[s.jsx("h2",{className:"text-4xl font-black mb-6",children:"Tactical Advisor Personas"}),s.jsx("p",{className:"text-xl text-gray-400",children:"Different archetypes for different goals. Choose who critiques your brew."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{n:"Ruthless Optimizer",t:"Cedh Meta",icon:s.jsx(B1e,{className:"w-6 h-6"}),color:"text-red-400",bg:"hover:border-red-500/30"},{n:"Flavor Specialist",t:"Vorthos/Lore",icon:s.jsx(cm,{className:"w-6 h-6"}),color:"text-blue-400",bg:"hover:border-blue-500/30"},{n:"Budget Engineer",t:"Cost Neutral",icon:s.jsx(LA,{className:"w-6 h-6"}),color:"text-green-400",bg:"hover:border-green-500/30"},{n:"Chaos Librarian",t:"Unique Tech",icon:s.jsx(mB,{className:"w-6 h-6"}),color:"text-purple-400",bg:"hover:border-purple-500/30"}].map((t,e)=>s.jsxs("div",{className:`p-8 bg-white/5 border border-white/10 rounded-3xl transition-all ${t.bg} group`,children:[s.jsx("div",{className:`w-12 h-12 mb-6 flex items-center justify-center bg-gray-900 rounded-xl ${t.color} border border-white/5 group-hover:scale-110 transition-transform`,children:t.icon}),s.jsx("h4",{className:"text-lg font-black mb-1",children:t.n}),s.jsx("div",{className:"text-xs font-bold uppercase tracking-widest text-gray-500",children:t.t})]},e))})]}),s.jsxs("section",{className:"relative overflow-hidden rounded-[3rem] bg-gradient-to-br from-indigo-600 to-purple-800 p-12 md:p-24 text-center",children:[s.jsx("div",{className:"absolute inset-0 bg-[url(/MTG-Forge_Logo_Background.png)] bg-cover bg-center mix-blend-overlay opacity-20"}),s.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto space-y-8",children:[s.jsx("h2",{className:"text-4xl md:text-6xl font-black text-white leading-tight",children:"Ready to Forge Your Legends?"}),s.jsx("p",{className:"text-xl text-indigo-100 font-medium",children:"Join the new generation of brewers using Actionable Intelligence to dominate their pods."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-8",children:[s.jsx(Er,{to:"/dashboard",className:"px-10 py-5 bg-white text-indigo-900 font-black rounded-2xl shadow-xl hover:scale-105 transition-all",children:"Enter The Forge"}),s.jsx(Er,{to:"/pricing",className:"px-10 py-5 bg-black/30 backdrop-blur-md text-white border border-white/20 font-black rounded-2xl hover:bg-black/40 transition-all",children:"View Pricing"})]})]})]})]}),s.jsx("footer",{className:"relative z-10 py-24 border-t border-white/5 bg-gray-950 mt-auto",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center space-y-4",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."}),s.jsxs("div",{className:"flex justify-center gap-8 text-xs font-bold uppercase tracking-widest text-gray-600",children:[s.jsx(Er,{to:"/about",className:"hover:text-white transition-colors",children:"About"}),s.jsx(Er,{to:"/pricing",className:"hover:text-white transition-colors",children:"Pricing"}),s.jsx(Er,{to:"/settings",className:"hover:text-white transition-colors",children:"Settings"})]})]})})]}),RXe=Pe.memo(({item:t,onUpdate:e,onViewDetails:r,onSwapFoil:n})=>{const[i,a]=y.useState(!1),o=t.reviewed,l=o&&t.scanned_qty===t.expected_qty,c=o&&t.scanned_qty!==t.expected_qty,u=!o,h=t.finish==="foil",p=t.card_data?.card_faces,m=p&&p.length>1;let g=t.image_uri,b=t.art_uri,v=t.name;if(m){const O=p[i?1:0];O.image_uris?.art_crop&&(b=O.image_uris.art_crop),O.image_uris?.large?g=O.image_uris.large:O.image_uris?.normal&&(g=O.image_uris.normal),v=O.name}const w=c,j=I=>{I.stopPropagation(),c||e(t.id,0,!0)},_=I=>{I.stopPropagation(),l||e(t.id,t.expected_qty,!0)},E=I=>{const O=parseInt(I.target.value);isNaN(O)||O<0||e(t.id,O,!0)};return s.jsxs("div",{onClick:()=>r(t),className:`group relative flex flex-col rounded-xl overflow-hidden border transition-all duration-300 hover:-translate-y-1 hover:shadow-xl cursor-pointer 
                ${l?"bg-gray-800/80 border-green-500/30 shadow-green-500/5":""}
                ${c?"bg-red-900/20 border-red-500/50 shadow-red-500/10":""}
                ${u?"bg-gray-800/40 border-gray-700/50 hover:border-gray-500/50":""}
            `,children:[s.jsxs("div",{className:"relative aspect-[4/3] bg-gray-900 w-full overflow-hidden",children:[b||g?s.jsx("img",{src:b||g,alt:v,loading:"lazy",className:"w-full h-full object-cover transition-transform group-hover:scale-110 duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-600",children:"No Image"}),s.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 transition-colors z-20 
                    ${l?"bg-green-500":""}
                    ${c?"bg-red-500":""}
                    ${u?"bg-gray-700":""}
                `}),s.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-wider shadow-lg backdrop-blur-md border z-10 
                    ${h?"bg-gradient-to-r from-yellow-600/90 to-yellow-400/90 text-white border-yellow-300/50":"bg-gray-900/80 text-gray-400 border-gray-600/50"}`,children:h?"Foil":"Normal"}),m&&s.jsxs("button",{onClick:I=>{I.stopPropagation(),a(!i)},className:"absolute bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 bg-black/60 hover:bg-black/80 text-white text-xs font-bold rounded-full backdrop-blur-sm border border-white/20 shadow-lg flex items-center gap-1 z-30 transition-all hover:scale-105",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Flip"]})]}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[s.jsx("h3",{className:"text-white font-black text-lg leading-tight mb-1 truncate",title:v,children:v}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono mb-4 flex items-center justify-between",children:[s.jsxs("span",{children:["#",t.collector_number,"  ",t.set_code.toUpperCase()]}),s.jsxs("span",{className:"text-gray-400 font-bold",children:["Goal: ",t.expected_qty]})]}),s.jsxs("div",{className:"mt-auto flex items-center justify-between gap-3",onClick:I=>I.stopPropagation(),children:[s.jsx("button",{onClick:j,disabled:c,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${c?"bg-red-500 text-white shadow-lg shadow-red-500/20":"text-gray-500 hover:text-red-400 hover:bg-red-500/10"}`,title:"Mark Mismatch (Set to 0)",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"relative flex-1",children:s.jsx("input",{type:"number",min:"0",value:t.scanned_qty,disabled:!w,onChange:E,className:`w-full bg-gray-900 border rounded-lg px-3 py-1.5 font-mono text-center focus:outline-none focus:ring-2 transition-colors 
                                ${l?"border-green-500/50 text-green-400 opacity-90 cursor-not-allowed":""}
                                ${c?"border-red-500/50 text-white focus:ring-red-500":""}
                                ${u?"border-gray-700 text-gray-400 cursor-not-allowed":""}
                            `})}),s.jsx("button",{onClick:_,disabled:l,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${l?"bg-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-500 hover:text-green-400 hover:bg-green-500/10"}`,title:"Confirm Match",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]})]})}),MXe=({symbol:t,size:e="w-12 h-12"})=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${t.toUpperCase()}.svg`,alt:t,className:`${e} drop-shadow-md rounded-full bg-gray-900 border-2 border-white/10`,onError:r=>{r.target.style.display="none"}}),DXe=({items:t})=>s.jsx("div",{className:"flex -space-x-4 items-center justify-center p-2",children:t.split("").map((e,r)=>s.jsx("div",{className:"z-10 transition-transform hover:scale-125 hover:z-20",title:e,children:s.jsx(MXe,{symbol:e})},r))}),BXe=({type:t})=>{const e=t.toLowerCase(),r="w-12 h-12 text-gray-400 group-hover:text-indigo-400 transition-colors";return e.includes("artifact")?s.jsx(Q1e,{className:"w-12 h-12 text-gray-400 group-hover:text-slate-300",strokeWidth:1.5}):e.includes("land")?s.jsx(k2e,{className:"w-12 h-12 text-gray-400 group-hover:text-amber-600",strokeWidth:1.5}):e.includes("creature")?s.jsx(Wv,{className:"w-12 h-12 text-gray-400 group-hover:text-red-400",strokeWidth:1.5}):e.includes("enchantment")?s.jsx(LA,{className:"w-12 h-12 text-gray-400 group-hover:text-yellow-400",strokeWidth:1.5}):e.includes("instant")?s.jsx(um,{className:"w-12 h-12 text-gray-400 group-hover:text-blue-500",strokeWidth:1.5,fill:"currentColor",fillOpacity:.2}):e.includes("sorcery")?s.jsx(L2e,{className:"w-12 h-12 text-gray-400 group-hover:text-orange-500",strokeWidth:1.5}):e.includes("planeswalker")?s.jsx(bx,{className:"w-12 h-12 text-gray-400 group-hover:text-purple-500",strokeWidth:1.5}):s.jsx(P1e,{className:r,strokeWidth:1})},$Xe=({name:t,count:e,reviewed:r,onClick:n,type:i})=>{const a=(i==="color"||i==="color_identity")&&t!=="Unknown",o=i==="set"||i==="set_code",l=i==="type"||i==="type_line",c=Math.round(r/e*100)||0,u=c===100;return s.jsxs("div",{onClick:n,className:"group relative flex flex-col aspect-[4/3] bg-gray-800 rounded-xl overflow-hidden border border-gray-700 hover:border-indigo-500/50 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-indigo-900/40 to-transparent transition-all duration-500",style:{height:`${c}%`,top:"auto",bottom:0,opacity:.3}}),s.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-900/50 group-hover:bg-gray-800 transition-colors p-4 z-10",children:a?s.jsx(DXe,{items:t}):o?s.jsx("img",{src:`https://svgs.scryfall.io/sets/${t.toLowerCase()}.svg`,alt:t,className:"w-20 h-20 opacity-70 group-hover:opacity-100 transition-opacity filter drop-shadow-lg",onError:h=>{h.target.style.display="none"}}):l?s.jsx(BXe,{type:t}):s.jsx("svg",{className:"w-16 h-16 text-gray-700 group-hover:text-indigo-500/50 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),s.jsxs("div",{className:"p-4 bg-gray-900/90 border-t border-gray-800 z-10 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("div",{className:"text-white font-bold truncate text-lg uppercase tracking-tight",children:t||"Unknown"}),u&&s.jsx("span",{className:"text-green-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs font-mono uppercase tracking-wider",children:[s.jsxs("span",{className:u?"text-green-400":"text-gray-500",children:[r," / ",e," Verified"]}),s.jsxs("span",{className:`font-bold ${u?"text-green-400":"text-indigo-400"}`,children:[c,"%"]})]}),s.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full mt-2 overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-500 ${u?"bg-green-500":"bg-indigo-500"}`,style:{width:`${c}%`}})})]})]})};function FXe(){const{userProfile:t}=Or(),{auditId:e}=yl(),[r]=v4(),n=r.get("deckId"),i=r.get("group"),{openCardModal:a}=z1(),{addToast:o}=jn(),[l,c]=y.useState(!1),[u,h]=y.useState(null),[p,m]=y.useState([]),[g,b]=y.useState(!0),[v,w]=y.useState(null),[j,_]=y.useState([]),[E,I]=y.useState(50),O=y.useRef(null),[B,S]=y.useState(!1),[T,M]=y.useState("all"),$=xn();y.useEffect(()=>{const ne=new IntersectionObserver(H=>{H[0].isIntersecting&&I(le=>le+50)},{rootMargin:"200px"});return O.current&&ne.observe(O.current),()=>ne.disconnect()},[E]),y.useEffect(()=>{k(),n&&Ge.get(`/api/decks/${n}`).then(ne=>w((ne.deck||ne).name)).catch(()=>{})},[e,n]);const k=async()=>{try{const ne=await Ge.getActiveAudit();if(!ne){alert("No active audit session found."),$("/dashboard");return}h(ne);const H=await Ge.getAuditItems(ne.id,{deckId:n,group:i});m(H)}catch(ne){console.error(ne)}finally{b(!1)}},{groupHierarchy:L,leafSortOrder:R}=y.useMemo(()=>{const ne=t?.settings?.organization?.sortHierarchy;if(!ne||ne.length===0)return{groupHierarchy:[],leafSortOrder:["name"]};const H=new Set(["set","color","color_identity","type","rarity","artist","power","toughness"]),le=[],ye=[];let me=0;for(const ke of ne)me<2&&H.has(ke)?(le.push(ke),me++):ye.push(ke);return ye.includes("name")||ye.push("name"),{groupHierarchy:le,leafSortOrder:ye}},[t]),V=(ne,H)=>{if(!H)return"Unknown";let le=ne[H];return H==="type"||H==="type_line"?le=(ne.type_line||ne.card_data?.type_line||"Unknown").split("")[0].trim():H==="set"||H==="set_code"?le=(ne.set_code||ne.card_data?.set||"???").toUpperCase():H==="color"||H==="colors"?(le=ne.colors||ne.card_data?.colors,Array.isArray(le)?le=le.join("")||"C":le||(le="C")):H==="color_identity"?(le=ne.color_identity||ne.card_data?.color_identity,Array.isArray(le)?le=le.join("")||"C":le||(le="C")):H==="rarity"?le=ne.rarity||ne.card_data?.rarity||"common":H==="artist"&&(le=ne.artist||ne.card_data?.artist||"Unknown"),String(le||"Unknown")},Y=()=>p.filter(ne=>j.every(H=>V(ne,H.type)===H.value)),X=y.useMemo(()=>{let ne=Y();return T==="pending"?ne=ne.filter(H=>!H.reviewed):T==="mismatch"&&(ne=ne.filter(H=>H.reviewed&&H.actual_quantity!==H.expected_quantity)),ne.sort((H,le)=>{for(const ye of R){let me=0;if(ye==="collector_number"){const ke=parseInt(H.collector_number)||0,Ie=parseInt(le.collector_number)||0;me=ke-Ie}else if(ye==="price"){const ke=parseFloat(H.prices?.usd||H.card_data?.prices?.usd||0);me=parseFloat(le.prices?.usd||le.card_data?.prices?.usd||0)-ke}else if(ye==="cmc"){const ke=parseFloat(H.cmc||H.card_data?.cmc||0),Ie=parseFloat(le.cmc||le.card_data?.cmc||0);me=ke-Ie}else ye==="name"&&(me=(H.name||"").localeCompare(le.name||""));if(me!==0)return me}return 0})},[p,j,T,R]),J=B||j.length>=L.length,re=L[j.length],se=y.useMemo(()=>{if(J)return[];const ne={};return Y().forEach(le=>{const ye=V(le,re);ne[ye]||(ne[ye]={count:0,reviewed:0}),ne[ye].count++,le.reviewed&&ne[ye].reviewed++}),Object.entries(ne).map(([le,ye])=>({name:le,count:ye.count,reviewed:ye.reviewed,type:re})).sort((le,ye)=>le.name.localeCompare(ye.name))},[p,j,J,L]),ee=ne=>{S(!1),_([...j,{type:re,value:ne}])},q=ne=>{S(!1),_(ne===-1?[]:j.slice(0,ne+1))},[U,W]=y.useState({collectorNumber:"",finish:"nonfoil",setCode:"",isSubmitting:!1});y.useEffect(()=>{let ne="";const H=j.find(le=>le.type==="set"||le.type==="set_code");H?ne=H.value:i&&i.length<=4?ne=i:u&&u.type==="set"&&u.target_id&&(ne=u.target_id),ne&&W(le=>({...le,setCode:ne.toUpperCase()}))},[i,u,j]);const Z=async ne=>{ne.preventDefault();const{setCode:H,collectorNumber:le,finish:ye}=U;if(!(!H||!le)){W(me=>({...me,isSubmitting:!0}));try{const me=await Ge.addAuditItem(u.id,{setCode:H,collectorNumber:le,finish:ye,deckId:n||null});me.success&&me.item&&(m(ke=>ke.find(ce=>ce.id===me.item.id)?ke.map(ce=>ce.id===me.item.id?me.item:ce):[...ke,me.item]),o(`Added ${me.item.name} #${me.item.collector_number}`,"success"),W(ke=>({...ke,collectorNumber:"",isSubmitting:!1})))}catch(me){console.error(me),o(me.message||"Failed to add card","error"),W(ke=>({...ke,isSubmitting:!1}))}}},de=async(ne,H,le=null)=>{const ye=parseInt(H);if(!(isNaN(ye)||ye<0)){m(me=>me.map(ke=>ke.id!==ne?ke:{...ke,scanned_qty:ye,reviewed:le!==null?le:ke.reviewed}));try{await Ge.updateAuditItem(u.id,ne,ye,le)}catch(me){console.error(me)}}},be=async()=>{const ne=X.filter(le=>!le.reviewed);if(ne.length===0){o("All items in this section are already reviewed.","info");return}if(!window.confirm(`Mark ${ne.length} items as verified?`))return;b(!0);const H=ne.map(le=>({id:le.id,scanned_qty:le.expected_qty,reviewed:!0}));m(le=>le.map(ye=>{const me=H.find(ke=>ke.id===ye.id);return me?{...ye,...me}:ye}));try{await Ge.batchUpdateAuditItems(u.id,H),o(`Verified ${ne.length} items`,"success")}catch(le){console.error(le),o("Failed to batch verify items","error")}finally{b(!1)}},oe=X.slice(0,E);return g?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-500 rounded-full"})}):u?s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-8 bg-gray-900/50 p-6 rounded-2xl border border-white/5 backdrop-blur-md sticky top-20 z-30 shadow-xl",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("button",{onClick:()=>$(`/audit/${u.id}`),className:"text-gray-500 hover:text-white flex items-center gap-2 text-sm font-bold mb-2",children:"Back to Hub"}),s.jsxs("h1",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-indigo-400",children:"Audit:"}),v||(L.length>0?L[0].replace("_"," ").replace(/\b\w/g,ne=>ne.toUpperCase()):u.type)]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-sm font-mono",children:[s.jsx("button",{onClick:()=>q(-1),className:`hover:text-white transition-colors py-1 px-2 rounded ${j.length===0?"text-white font-bold bg-gray-800":"text-gray-500"}`,children:"ROOT"}),j.map((ne,H)=>s.jsxs(Pe.Fragment,{children:[s.jsx("span",{className:"text-gray-600",children:"/"}),s.jsx("button",{onClick:()=>q(H),className:`hover:text-white transition-colors py-1 px-2 rounded ${H===j.length-1?"text-white font-bold bg-gray-800":"text-gray-500"}`,children:ne.value})]},H))]})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[J&&s.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg flex text-xs font-bold",children:[s.jsx("button",{onClick:()=>M("all"),className:`px-3 py-1.5 rounded-md transition-colors ${T==="all"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"All"}),s.jsx("button",{onClick:()=>M("pending"),className:`px-3 py-1.5 rounded-md transition-colors ${T==="pending"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Pending"}),s.jsx("button",{onClick:()=>M("mismatch"),className:`px-3 py-1.5 rounded-md transition-colors ${T==="mismatch"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:"Mismatches"})]}),s.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 hover:bg-indigo-600/30 font-bold rounded-lg text-sm flex items-center gap-2 transition-all",title:"Verify Cards with Camera",children:[s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Scan Verify"]}),s.jsx("button",{onClick:be,className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg shadow-lg shadow-blue-500/20 text-sm flex items-center gap-2",children:"Finish Section"})]})]}),J&&s.jsxs("div",{className:"sticky top-[168px] z-20 bg-gray-800/90 backdrop-blur border border-white/10 rounded-xl p-3 mb-6 flex flex-col md:flex-row items-center gap-4 shadow-lg",children:[s.jsx("span",{className:"text-xs font-bold uppercase text-gray-400 whitespace-nowrap px-2",children:"Found Missing Card?"}),s.jsxs("form",{onSubmit:Z,className:"flex-1 flex gap-2 w-full",children:[s.jsx("input",{type:"text",placeholder:"Set (e.g. KND)",className:"w-24 bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm font-mono uppercase focus:border-indigo-500 outline-none",value:U.setCode,onChange:ne=>W({...U,setCode:ne.target.value.toUpperCase()})}),s.jsx("input",{type:"text",placeholder:"# No.",className:"w-24 bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm font-mono focus:border-indigo-500 outline-none",value:U.collectorNumber,onChange:ne=>W({...U,collectorNumber:ne.target.value})}),s.jsxs("select",{className:"bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm focus:border-indigo-500 outline-none",value:U.finish,onChange:ne=>W({...U,finish:ne.target.value}),children:[s.jsx("option",{value:"nonfoil",children:"Normal"}),s.jsx("option",{value:"foil",children:"Foil"})]}),s.jsx("button",{type:"submit",disabled:U.isSubmitting,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold px-4 py-1 rounded text-sm transition-colors flex items-center gap-1",children:U.isSubmitting?"...":s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]})})]})]}),J?s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[oe.map(ne=>s.jsx(RXe,{item:ne,onUpdate:de,onViewDetails:H=>a({...H,data:H.card_data}),onSwapFoil:()=>{}},ne.id)),E<X.length&&s.jsx("div",{ref:O,className:"h-24 flex items-center justify-center col-span-full",children:s.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-indigo-500 rounded-full"})})]}):s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{onClick:()=>S(!0),className:"group relative flex flex-col aspect-[4/3] bg-gray-800/30 border-2 border-dashed border-gray-700/50 hover:border-indigo-500/50 hover:bg-gray-800 rounded-xl overflow-hidden cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl items-center justify-center p-6 text-center",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-800 group-hover:bg-indigo-600/20 flex items-center justify-center mb-3 transition-colors",children:s.jsx("svg",{className:"w-8 h-8 text-gray-500 group-hover:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("span",{className:"text-white font-bold text-lg",children:"View All Cards"}),s.jsx("span",{className:"text-xs text-gray-500 font-mono mt-1 uppercase tracking-wider",children:"In this section"})]}),se.map(ne=>s.jsx($Xe,{name:ne.name,count:ne.count,reviewed:ne.reviewed,type:ne.type,onClick:()=>ee(ne.name)},ne.name))]}),s.jsx(sk,{isOpen:l,onClose:()=>c(!1),onFinish:async ne=>{if(!ne.length)return;let H=0;const le=[...p];for(const ye of ne){const me=le.findIndex(ke=>ke.scryfall_id===ye.scryfall_id&&(ye.finish?ke.finish===ye.finish:!0));if(me!==-1){const ke=le[me],Ie=(ke.scanned_qty||0)+ye.quantity;le[me]={...ke,scanned_qty:Ie,reviewed:!0},Ge.updateAuditItem(u.id,ke.id,Ie,!0).catch(console.error),H++}}m(le),H>0?o(`Verified ${H} cards in this audit session!`,"success"):o("No matching cards found in this session.","warning")}})]}):null}function FW(){const{id:t}=yl(),[e,r]=y.useState(null),[n,i]=y.useState(null),[a,o]=y.useState(!0),[l,c]=y.useState(null),u=xn(),[h,p]=y.useState({isOpen:!1,type:null,onConfirm:()=>{}}),[m,g]=y.useState(!1),[b,v]=y.useState(""),[w,j]=y.useState(!1);y.useEffect(()=>{const L=()=>j(!0);return window.addEventListener("start-tour",L),localStorage.getItem("tour_seen_audit_tour_v1")||setTimeout(()=>j(!0),1e3),()=>window.removeEventListener("start-tour",L)},[]);const _=[{target:"h1",title:"Audit Dashboard",content:"Track the status of your collection verification."},{target:"#audit-progress",title:"Progress",content:"See your overall completion and accuracy."},{target:"#audit-decks",title:"Decks",content:"Audit specific decks card by card."},{target:"#audit-guide-btn",title:"Guide",content:"Read the full guide if you get stuck."}];y.useEffect(()=>{(async()=>{try{let R=t;if(!R){const V=await Ge.getActiveAudit();if(V)R=V.id;else return}if(R){const V=await Ge.get(`/api/audit/${R}/stats`);i(V);const Y=await Ge.getActiveAudit();r(Y)}}catch(R){console.error("Failed to load audit hub",R),c(R.message)}finally{o(!1)}})()},[t]);const E=(L,R)=>{p({isOpen:!0,type:L,onConfirm:R}),v("")},I=async()=>{const L=h.type==="cancel"?"delete":"complete";b.toLowerCase().trim()===L&&(await h.onConfirm(),p({isOpen:!1,type:null,onConfirm:()=>{}}))},O=()=>{e&&E("cancel",async()=>{try{await Ge.cancelAudit(e.id),u("/dashboard")}catch(L){alert("Failed to cancel: "+L.message)}})},B=()=>{E("finalize",async()=>{try{await Ge.finalizeAudit(e.id),u("/dashboard")}catch(L){console.error("Finalize failed",L),alert("Finalize failed: "+L.message)}})};if(a)return s.jsx("div",{className:"p-8 text-center text-gray-400 animate-pulse",children:"Loading Audit..."});if(l)return s.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",l]});if(!e||!n)return s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"No Active Audit"}),s.jsx("button",{onClick:()=>u("/dashboard"),className:"px-4 py-2 bg-gray-700 rounded text-white",children:"Return to Dashboard"})]});const S=n.total_cards||1,T=n.total_reviewed||0,M=n.total_verified||0,$=Math.round(T/S*100),k=(L,R,V)=>{if(R===0)return"from-gray-800 to-gray-900 border-gray-700";if(V>0&&V>=R)return"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400";const Y=V/R;return Y===1?L===R?"from-green-900/40 to-green-900/20 border-green-500/50 hover:border-green-400":"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400":Y<.1?"from-gray-800/40 to-gray-800/20 border-gray-700/50 hover:border-gray-600":"from-yellow-900/40 to-yellow-900/20 border-yellow-500/50 hover:border-yellow-400"};return s.jsxs("div",{className:"min-h-screen bg-gray-900 p-8 pt-24 relative",children:[s.jsxs("div",{className:`max-w-7xl mx-auto space-y-8 animate-fade-in-up transition-all ${h.isOpen?"blur-sm pointer-events-none":""}`,children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase px-2 py-1 rounded border border-indigo-500/30",children:"Audit in Progress"}),s.jsxs("span",{className:"text-gray-500 text-sm",children:["Started ",new Date(e.created_at).toLocaleDateString()]})]}),s.jsx("h1",{className:"text-4xl font-black text-white",children:"Audit the Forge"}),s.jsxs("p",{className:"text-gray-400 mt-2 flex items-center gap-2",children:["Verify decks and binder to reconcile your inventory.",s.jsxs("button",{onClick:()=>g(!0),id:"audit-guide-btn",className:"text-indigo-400 hover:text-indigo-300 font-bold ml-2 text-sm flex items-center gap-1 group/guide",children:[s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover/guide:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Setup Guide"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:O,className:"px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors font-medium text-sm",children:"Cancel Audit"}),s.jsx("button",{onClick:B,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold rounded-lg shadow-lg shadow-green-500/20 text-sm transition-all hover:scale-105",children:"Finalize Results"})]})]}),s.jsxs("div",{id:"audit-progress",className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700 relative overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 relative z-10",children:[s.jsx("span",{className:"text-xl font-bold text-white",children:"Total Progress"}),s.jsxs("span",{className:"text-2xl font-mono text-indigo-400",children:[$,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-4 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-500 h-full transition-all duration-1000 ease-out",style:{width:`${$}%`}})}),s.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-400 relative z-10",children:[s.jsxs("span",{children:[T," / ",S," Cards Reviewed (",M," Matched)"]}),s.jsxs("span",{children:[n.decks.length," Decks  ",Object.keys(n.collection.groups).length," Loose Groups"]})]})]}),n.decks.length>0&&s.jsxs("div",{id:"audit-decks",children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decks"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.decks.map(L=>s.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?deckId=${L.id}`),className:`relative group p-6 rounded-xl border transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${k(L.verified,L.total,L.reviewed)} overflow-hidden`,children:[s.jsx("h4",{className:"font-bold text-white text-lg truncate mb-1 relative z-10 text-left",children:L.name}),s.jsxs("div",{className:"text-sm text-gray-300 mb-4 flex justify-between relative z-10",children:[s.jsx("span",{children:L.colors?L.colors.join(""):"Colorless"}),s.jsx("span",{children:L.reviewed>=L.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," Complete"]}):s.jsxs("span",{children:[L.reviewed,"/",L.total," Done"]})})]}),s.jsx("div",{className:"w-full bg-black/30 rounded-full h-1.5 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-white/80 h-full transition-all",style:{width:`${L.reviewed/L.total*100}%`}})})]},L.id))})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Collection (Loose Cards)"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.collection.groups.map(L=>s.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?group=${L.name}`),className:`relative p-4 rounded-xl border text-left transition-all hover:brightness-110 bg-gradient-to-br ${k(L.verified,L.total,L.reviewed)} overflow-hidden group isolate`,children:[s.jsx("div",{className:"text-3xl font-black text-white/5 absolute -bottom-1 -right-1 select-none pointer-events-none transition-colors z-0 whitespace-nowrap transform rotate-0 origin-bottom-right",children:L.name}),s.jsx("h4",{className:"font-bold text-white text-md mb-2 relative z-10",children:L.name}),s.jsx("div",{className:"text-xs text-gray-300 relative z-10",children:L.reviewed>=L.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})," Complete"]}):s.jsxs("span",{children:[L.reviewed,"/",L.total," Done"]})})]},L.name)),n.collection.total>0&&n.collection.groups.length===0&&s.jsx("div",{className:"col-span-full text-gray-500 italic p-4",children:"No groups found for loose cards. (All cards might be in decks)"}),n.collection.total===0&&s.jsx("div",{className:"col-span-full border border-dashed border-gray-700 rounded-xl p-8 text-center text-gray-500",children:"No loose cards in this audit scope."})]})]}),n.mismatches&&n.mismatches.length>0&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl border border-red-500/20 overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-700/50 flex items-center gap-3",children:s.jsx("h3",{className:"text-xl font-bold text-white",children:"Discrepancy Report"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-900/50 text-gray-400 text-xs uppercase tracking-wider",children:[s.jsx("th",{className:"p-4",children:"Card"}),s.jsx("th",{className:"p-4",children:"Set"}),s.jsx("th",{className:"p-4",children:"Location"}),s.jsx("th",{className:"p-4 text-center",children:"Expected"}),s.jsx("th",{className:"p-4 text-center",children:"Actual"}),s.jsx("th",{className:"p-4 text-right",children:"Diff"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-700/50",children:n.mismatches.map(L=>{const R=L.expected_qty!==void 0?L.expected_qty:L.expected,V=L.scanned_qty!==void 0?L.scanned_qty:L.actual!==void 0?L.actual:0,Y=V-R;return s.jsxs("tr",{className:"text-white hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"p-4 font-bold max-w-xs truncate",children:[L.name," ",L.finish==="foil"&&s.jsx("span",{className:"text-xs text-yellow-500 ml-1",children:"FOIL"})]}),s.jsxs("td",{className:"p-4 font-mono text-gray-400",children:[L.set_code.toUpperCase()," #",L.collector_number]}),s.jsx("td",{className:"p-4 text-gray-300",children:L.deck_name?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500"})," ",L.deck_name]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-500"})," Collection"]})}),s.jsx("td",{className:"p-4 text-center font-mono text-gray-400",children:R}),s.jsx("td",{className:"p-4 text-center font-mono font-bold",children:V}),s.jsx("td",{className:`p-4 text-right font-mono font-bold ${Y>0?"text-green-400":"text-red-400"}`,children:Y>0?`+${Y}`:Y})]},L.id)})})]})})]})]}),h.isOpen&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>p({...h,isOpen:!1})}),s.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-6 max-w-md w-full relative z-10 shadow-2xl animate-fade-in-up",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:h.type==="cancel"?"Delete Audit Session?":"Complete Audit?"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:h.type==="cancel"?"This will definitively DELETE this session and all progress. This cannot be undone.":"This will sync all verified counts to your collection. Cards in 'Reviewed' sections with mismatching counts will NOT be synced, only exact matches are auto-synced. Proceed?"}),s.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:["Type ",s.jsx("span",{className:"text-white select-none",children:h.type==="cancel"?"Delete":"Complete"})," to confirm"]}),s.jsx("input",{type:"text",value:b,onChange:L=>v(L.target.value),placeholder:h.type==="cancel"?"Delete":"Complete",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-600 focus:border-indigo-500 outline-none mb-6",autoFocus:!0}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>p({...h,isOpen:!1}),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{onClick:I,disabled:b.toLowerCase().trim()!==(h.type==="cancel"?"delete":"complete"),className:`px-4 py-2 rounded-lg font-bold text-white transition-all ${b.toLowerCase().trim()===(h.type==="cancel"?"delete":"complete")?h.type==="cancel"?"bg-red-500 hover:bg-red-600":"bg-green-600 hover:bg-green-500":"bg-gray-700 opacity-50 cursor-not-allowed"}`,children:h.type==="cancel"?"Delete Audit":"Complete Audit"})]})]})]}),s.jsx(tL,{isOpen:m,onClose:()=>g(!1)}),s.jsx(pf,{steps:_,isOpen:w,onClose:()=>j(!1),tourId:"audit_tour_v1"})]})}const UXe=()=>{const t=xn(),{currentUser:e,userProfile:r}=Or(),[n,i]=y.useState(""),[a,o]=y.useState(!1),[l,c]=y.useState(null),[u,h]=y.useState(null);y.useEffect(()=>{const g=Vp();return h(g),g.on("connect_error",b=>{console.error("Socket Connection Error:",b),c("Connection to Game Server failed.")}),()=>{g&&g.disconnect()}},[]);const p=()=>{if(!u||!u.connected){c("Connecting to server... please wait."),u&&u.connect();return}const g=Math.floor(1e5+Math.random()*9e5).toString();u.emit("host-game",{pin:g},b=>{b.success?t(`/play/room/${b.roomId}`,{state:{pin:g,isHost:!0}}):c("Failed to create game: "+(b.error||"Unknown"))})},m=g=>{if(g.preventDefault(),n.length!==6){c("PIN must be 6 digits");return}t("/play/room/game-found-via-pin",{state:{pin:n,isHost:!1}})};return s.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/20 via-gray-900 to-black z-0"}),s.jsxs("div",{className:"relative z-10 w-full max-w-md space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-wider",children:"The War Room"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"MTG Live Session"})]}),l&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/50 text-red-200 p-3 rounded-lg text-center text-sm font-bold",children:l}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 p-6 rounded-2xl space-y-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Join a Battle"}),s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Session PIN"}),s.jsx("input",{type:"text",maxLength:"6",placeholder:"000000",className:"w-full bg-black/50 border border-white/10 rounded-xl px-4 py-4 text-center text-3xl font-mono text-white tracking-[0.5em] focus:outline-none focus:border-indigo-500 transition-colors",value:n,onChange:g=>i(g.target.value.replace(/\D/g,""))})]}),s.jsx("button",{type:"submit",disabled:n.length!==6,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-500/20 transition-all transform active:scale-95 uppercase tracking-wider",children:"Enter Battlefield"})]})]}),s.jsxs("div",{className:"relative flex py-2 items-center",children:[s.jsx("div",{className:"flex-grow border-t border-white/10"}),s.jsx("span",{className:"flex-shrink-0 mx-4 text-gray-500 text-xs font-bold uppercase tracking-widest",children:"OR"}),s.jsx("div",{className:"flex-grow border-t border-white/10"})]}),s.jsxs("button",{onClick:p,className:"w-full bg-white/5 hover:bg-white/10 border border-white/10 text-white font-bold py-4 rounded-xl transition-all flex flex-col items-center justify-center gap-1 group",children:[s.jsx("span",{className:"uppercase tracking-wider",children:"Host New Session"}),s.jsx("span",{className:"text-[10px] text-gray-400 font-normal group-hover:text-indigo-300",children:"Generate a PIN for friends to join"})]})]}),s.jsx("div",{className:"text-center pt-8",children:s.jsx("button",{onClick:()=>t("/"),className:"text-gray-500 hover:text-white text-sm font-bold uppercase tracking-widest transition-colors",children:" Back to Base"})})]})]})},zXe=({isOpen:t,onClose:e,onApply:r,currentValue:n})=>{const[i,a]=y.useState(""),[o,l]=y.useState("subtract"),[c,u]=y.useState(null);if(!t)return null;const h=g=>{i.length>3||(a(b=>b+g),u(null))},p=()=>{a(g=>g.slice(0,-1)),u(null)},m=()=>{const g=parseInt(i,10);if(!g||isNaN(g)){e();return}if(!c&&g>=10){u(`Large change detected (${g}). Confirm?`);return}const b=o==="subtract"?-g:g;r(b),a(""),u(null),e()};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center pointer-events-none",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm pointer-events-auto transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border-t md:border border-gray-700 w-full md:w-[400px] md:rounded-2xl shadow-2xl overflow-hidden pointer-events-auto animate-slide-up md:animate-zoom-in p-6 z-10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider",children:"Quick Math"}),s.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-full",children:s.jsx(Fd,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"bg-black/40 rounded-xl p-4 mb-6 border border-white/5 flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"Current Life"}),s.jsx("span",{className:"text-2xl font-mono text-gray-300",children:n})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:`text-4xl font-mono font-black ${o==="subtract"?"text-red-500":"text-green-500"}`,children:[o==="subtract"?"-":"+",i||"0"]}),s.jsxs("span",{className:"text-xs text-gray-500 font-bold uppercase self-end mb-1",children:["= ",n+parseInt(i||0)*(o==="subtract"?-1:1)]})]})]}),c&&s.jsxs("div",{className:"bg-yellow-500/10 text-yellow-500 p-3 rounded-lg border border-yellow-500/20 mb-4 flex items-center justify-center gap-2 animate-pulse",children:[s.jsx(Z2e,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-bold",children:c})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[s.jsx("button",{onClick:()=>l("subtract"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="subtract"?"bg-red-500 text-white shadow-lg shadow-red-900/50":"bg-gray-800 text-gray-500"}`,children:"Damage"}),s.jsx("button",{onClick:()=>l("add"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="add"?"bg-green-500 text-white shadow-lg shadow-green-900/50":"bg-gray-800 text-gray-500"}`,children:"Life"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[[1,2,3,4,5,6,7,8,9].map(g=>s.jsx("button",{onClick:()=>h(g),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:g},g)),s.jsx("button",{onClick:()=>h(0),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:"0"}),s.jsx("button",{onClick:p,className:"bg-gray-800 hover:bg-red-900/30 text-gray-400 hover:text-red-400 text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center",children:s.jsx(r2e,{className:"w-6 h-6"})}),s.jsx("button",{onClick:m,className:`bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center ${c?"animate-bounce":""}`,children:s.jsx(Od,{className:"w-8 h-8"})})]})]})]})},qXe=({life:t,onChange:e,isSelf:r=!1,label:n})=>{const[i,a]=y.useState(!1);return s.jsxs("div",{className:`flex flex-col items-center justify-center ${r?"h-full":"h-32"} w-full relative group`,children:[s.jsx("div",{className:"absolute inset-x-0 top-0 text-center py-2 z-10 pointer-events-none",children:s.jsx("span",{className:`${r?"text-sm text-gray-400":"text-xs text-gray-500"} font-black uppercase tracking-widest truncate max-w-[90%] inline-block shadow-black drop-shadow-md`,children:n})}),s.jsxs("div",{className:"flex w-full h-full",children:[s.jsx("button",{onClick:()=>e(-1),className:`flex-1 flex items-center justify-center ${r?"bg-red-900/20 hover:bg-red-900/40":"bg-red-900/10 hover:bg-red-900/20"} active:bg-red-500/30 transition-colors touch-manipulation`,children:s.jsx("span",{className:"sr-only",children:"Minus 1 Life"})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("button",{onClick:()=>r&&a(!0),className:`pointer-events-auto ${r?"text-8xl md:text-9xl hover:scale-105 active:scale-95 cursor-pointer":"text-5xl"} font-black text-white tabular-nums drop-shadow-xl tracking-tighter transition-transform`,children:t})}),s.jsx("button",{onClick:()=>e(1),className:`flex-1 flex items-center justify-center ${r?"bg-green-900/20 hover:bg-green-900/40":"bg-green-900/10 hover:bg-green-900/20"} active:bg-green-500/30 transition-colors touch-manipulation`,children:s.jsx("span",{className:"sr-only",children:"Plus 1 Life"})})]}),s.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[1px] h-1/2 bg-white/5 pointer-events-none"}),r&&s.jsx(zXe,{isOpen:i,onClose:()=>a(!1),currentValue:t,onApply:o=>e(o)})]})},zy=({label:t,value:e,onChange:r,icon:n,color:i="text-white"})=>s.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[n&&s.jsx(n,{className:`w-5 h-5 ${i}`}),s.jsx("span",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:t})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r(e-1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",disabled:e<=0,children:"-"}),s.jsx("span",{className:"text-2xl font-black text-white w-8 text-center tabular-nums",children:e}),s.jsx("button",{onClick:()=>r(e+1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",children:"+"})]})]}),VXe=({isOpen:t,onClose:e,players:r,myPlayerId:n,myCounters:i,myCommanderDamage:a,onUpdateCounter:o,onUpdateCmdDamage:l})=>{const[c,u]=y.useState("commander");if(!t)return null;const h=r.filter(p=>p.id!==n);return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm pointer-events-auto",onClick:e}),s.jsxs("div",{className:"bg-gray-900 w-full sm:max-w-md h-[80vh] sm:h-auto sm:rounded-3xl rounded-t-3xl border-t sm:border border-white/10 shadow-2xl flex flex-col pointer-events-auto relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[s.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-wider",children:"Resources"}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx(Fd,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"flex border-b border-white/5",children:[s.jsx("button",{onClick:()=>u("counters"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="counters"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Counters"}),s.jsx("button",{onClick:()=>u("commander"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="commander"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Commander Dmg"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[c==="counters"&&s.jsxs(s.Fragment,{children:[s.jsx(zy,{label:"Poison",value:i.poison||0,onChange:p=>o("poison",p),icon:rj,color:"text-green-500"}),s.jsx(zy,{label:"Energy",value:i.energy||0,onChange:p=>o("energy",p),icon:um,color:"text-yellow-400"}),s.jsx(zy,{label:"Experience",value:i.experience||0,onChange:p=>o("experience",p),icon:GI,color:"text-blue-400"}),s.jsx(zy,{label:"Tax",value:i.commanderTax||0,onChange:p=>o("commanderTax",p),icon:IQ,color:"text-gray-400"})]}),c==="commander"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-xs text-gray-500 text-center uppercase tracking-widest mb-4",children:"Damage taken from Commanders"}),h.length===0&&s.jsx("p",{className:"text-gray-500 text-center py-4",children:"No opponents found."}),h.map(p=>s.jsx(zy,{label:p.name,value:a[p.id]||0,onChange:m=>l(p.id,m),icon:lm,color:"text-red-400"},p.id))]})]})]})]})},HXe=({isOpen:t,onClose:e,finalState:r,onSave:n,roomId:i})=>{const{userProfile:a}=Or(),[o,l]=y.useState(null),[c,u]=y.useState(null),[h,p]=y.useState([]),[m,g]=y.useState(!1),[b,v]=y.useState("summary");if(y.useEffect(()=>{t&&a&&Ge.get("/api/decks",{limit:100}).then(S=>p(Array.isArray(S)?S:S.decks||[])).catch(console.error)},[t,a]),!t||!r)return null;const{players:w,durationSeconds:j,startedAt:_,endedAt:E,logs:I}=r,O=S=>{const T=Math.floor(S/60),M=S%60;return`${T}m ${M}s`},B=async()=>{g(!0);try{const T=w.find($=>$.id===o)?.userId||null,M={roomId:i,winnerId:T,startedAt:_,endedAt:E,logs:I||[],players:w.map($=>({userId:$.userId||null,guestName:$.name,placement:$.id===o?1:2,life:$.life,deckId:$.deckId,socketId:$.id}))};await n(M)}catch(S){console.error("Failed to save match:",S)}finally{g(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-xl w-full max-w-lg shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"bg-gradient-to-r from-indigo-900/50 to-purple-900/50 p-6 text-center border-b border-white/5",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center justify-center gap-3",children:[s.jsx(Ro,{className:"w-8 h-8 text-yellow-500"}),"Game Over"]}),s.jsxs("p",{className:"text-gray-400 text-sm mt-2 font-mono",children:["Duration: ",O(j)]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex p-1 bg-gray-800 rounded-lg",children:[s.jsx("button",{onClick:()=>v("summary"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${b==="summary"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Summary"}),s.jsx("button",{onClick:()=>v("report"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${b==="report"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Combat Report"})]}),b==="summary"?s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Select Winner"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:w.map(S=>s.jsxs("button",{onClick:()=>l(S.id),className:`p-3 rounded-lg border text-sm font-bold transition-all flex items-center justify-between ${o===S.id?"bg-yellow-500/10 border-yellow-500 text-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("span",{className:"truncate",children:S.name}),o===S.id&&s.jsx(Ro,{className:"w-4 h-4"})]},S.id))})]}):s.jsx("div",{className:"h-64 w-full bg-gray-950/50 rounded-xl border border-white/5 p-4 flex flex-col justify-end relative overflow-hidden",children:!I||I.length===0?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"No battle data recorded."}):s.jsx(Hte,{players:w,logs:I})})]}),s.jsxs("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-lg font-bold text-sm transition-colors",children:"Close"}),s.jsx("button",{onClick:B,disabled:!o||m,className:"flex-[2] py-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-bold text-sm transition-colors flex items-center justify-center gap-2 shadow-lg shadow-indigo-900/20",children:m?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(T2e,{className:"w-4 h-4"}),"Save Match History"]})})]})]})})};let Tn;const WXe=()=>{const t=Mo(),e=xn(),{userProfile:r}=Or(),{addToast:n}=jn(),[i,a]=y.useState(null),[o,l]=y.useState(null),[c,u]=y.useState(null),[h,p]=y.useState(null),[m,g]=y.useState(!0),[b,v]=y.useState(!1),[w,j]=y.useState(!1),_=t.state?.pin,E=t.state?.isHost,[I,O]=y.useState(null),[B,S]=y.useState([]),[T,M]=y.useState(!1),[$,k]=y.useState(null),L=y.useRef(null),[R,V]=y.useState(null),Y=y.useRef(null),X=H=>{const le=H.counters||{},me=(H.commanderDamage||{})[c]||0;return!me&&!le.poison&&!le.energy&&!le.experience&&!le.commanderTax?null:s.jsxs("div",{className:"flex items-center justify-center gap-2 absolute bottom-2 w-full px-2 pointer-events-none",children:[me>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-red-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(lm,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:me})]}),le.poison>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-green-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(rj,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:le.poison})]}),le.energy>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-yellow-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(um,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:le.energy})]}),le.experience>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-blue-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(GI,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:le.experience})]}),le.commanderTax>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-gray-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(IQ,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:le.commanderTax})]})]})};y.useEffect(()=>{r&&Ge.get("/api/decks",{limit:100}).then(H=>S(Array.isArray(H)?H:H.decks||[])).catch(H=>{console.error("Failed to load decks:",H),S([])})},[r]),y.useEffect(()=>{if(!T)return;Tn?Tn.disconnected&&Tn.connect():Tn=Vp({transports:["websocket","polling"],reconnectionAttempts:5});const H=()=>{if(!_){p("No PIN provided. Please join from the lobby."),setTimeout(()=>e("/play/lobby"),3e3);return}const ce=r?.username||(E?"Host":"Guest");console.log("Emitting join-game..."),Tn.emit("join-game",{pin:_,name:ce,userId:r?.id,deckId:I==="generic"?null:I},Be=>{console.log("Join response:",Be),Be.success?(L.current=Be.roomId,u(Be.playerId)):(k(Be.error||"Failed to join game"),M(!1))})},le=()=>{console.log("Connected to Game Socket:",Tn.id),H()},ye=ce=>{console.log("Game State Update:",ce),a(ce),g(!1)},me=({finalState:ce})=>{console.log("Game Over!",ce),l(ce),j(!0)},ke=ce=>{console.error("Socket Connection Error:",ce),k("Connection error. Retrying...")},Ie=({entry:ce})=>{ce.type==="note"&&n(`${ce.emoji} ${ce.note}`,"info",4e3)};return Tn.on("connect",le),Tn.on("game-state-update",ye),Tn.on("game-over",me),Tn.on("connect_error",ke),Tn.on("game-log-entry",Ie),Tn.connected&&le(),()=>{Tn.off("connect",le),Tn.off("game-state-update",ye),Tn.off("game-over",me),Tn.off("connect_error",ke),Tn.off("game-log-entry",Ie),Tn&&Tn.disconnect(),Tn=null}},[_,E,r,e,T,I,n]);const J=H=>{Y.current&&clearTimeout(Y.current),V(H),Y.current=setTimeout(()=>{V(null)},5e3)},re=()=>{if(R){if(R.type==="LIFE"){const H=-R.change;a(le=>{const ye=le.players.map(me=>me.id===c?{...me,life:me.life+H}:me);return{...le,players:ye}}),Tn.emit("update-life",{roomId:L.current,change:H})}else if(R.type==="COUNTER"){const H=-R.change;Tn.emit("update-counters",{roomId:L.current,type:R.counterType,change:H})}else if(R.type==="CMDR_DMG"){const H=-R.change;Tn.emit("update-commander-damage",{roomId:L.current,targetId:R.targetId,change:H})}V(null),Y.current&&clearTimeout(Y.current)}},se=H=>{!Tn||!i||!c||!L.current||(J({type:"LIFE",change:H}),a(le=>{const ye=le.players.map(me=>me.id===c?{...me,life:me.life+H}:me);return{...le,players:ye}}),Tn.emit("update-life",{roomId:L.current,change:H}))},ee=(H,le)=>{const ye=i.players.find(ke=>ke.id===c),me=le-(ye.counters[H]||0);J({type:"COUNTER",counterType:H,change:me}),Tn.emit("update-counters",{roomId:L.current,type:H,change:me})},q=(H,le)=>{const me=i.players.find(Ie=>Ie.id===c).commanderDamage[H]||0,ke=le-me;J({type:"CMDR_DMG",targetId:H,change:ke}),Tn.emit("update-commander-damage",{roomId:L.current,targetId:H,change:ke})},U=()=>{!Tn||!L.current||window.confirm("Are you sure you want to end the game for everyone?")&&Tn.emit("end-game",{roomId:L.current})},W=async H=>{try{const le=await Ge.post("/api/matches",H);le.success?(alert("Game saved successfully!"),j(!1),e("/play/lobby")):alert("Failed to save game: "+(le.error||"Unknown error"))}catch(le){console.error(le),alert("Error saving game")}},Z=H=>{!Tn||!L.current||Tn.emit("start-game",{roomId:L.current,firstPlayerId:H})},de=()=>{!Tn||!L.current||Tn.emit("pass-turn",{roomId:L.current})},be=()=>{if(!Tn||!L.current)return;const H=window.prompt("Add a note to the game log (e.g. 'Board Wipe', 'Infinite Combo'):");H&&H.trim()&&Tn.emit("add-log-note",{roomId:L.current,note:H.trim()})};if(h)return s.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 font-bold p-4 text-center",children:[h,s.jsx("button",{onClick:()=>e("/play/lobby"),className:"block mt-4 text-sm text-gray-500 hover:text-white underline mx-auto",children:"Return to Lobby"})]});if($)return s.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 p-4 text-center",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"font-bold",children:$}),s.jsx("button",{onClick:()=>k(null),className:"text-sm bg-red-500/10 hover:bg-red-500/20 px-4 py-2 rounded text-red-400",children:"Try Again"}),s.jsx("button",{onClick:()=>e("/play/lobby"),className:"block w-full text-sm text-gray-500 hover:text-white underline",children:"Return to Lobby"})]})});if(!T)return s.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 p-4 animate-fade-in",children:s.jsxs("div",{className:"w-full max-w-md space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-widest",children:"Select Your Deck"}),s.jsx("p",{className:"text-gray-400",children:"Choose a deck to play with for this session."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("select",{value:I||"",onChange:H=>O(H.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl p-4 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-lg",children:[s.jsx("option",{value:"",children:"-- Select a Deck --"}),s.jsx("option",{value:"generic",children:"Generic Deck (No stats)"}),B.map(H=>s.jsxs("option",{value:H.id,children:[H.name," (",typeof H.commander=="object"?H.commander?.name:H.commander||"No Commander",")"]},H.id))]}),s.jsxs("button",{onClick:()=>{I&&(M(!0),g(!0))},disabled:!I,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:[s.jsx(TA,{className:"w-5 h-5 fill-current"}),"Join Game"]})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-sm text-gray-600 hover:text-gray-400 transition-colors",children:"Cancel and Return to Lobby"})})]})});if(m||!i)return s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"}),s.jsx("div",{className:"text-gray-500 text-xs uppercase tracking-widest font-bold",children:"Connecting to War Room..."})]});const oe=i.players.find(H=>H.id===c),ne=i.players.filter(H=>H.id!==c);return oe?s.jsxs("div",{className:"flex flex-col h-[100dvh] bg-black overflow-hidden relative touch-none",children:[s.jsx("div",{className:"flex-1 bg-gray-900 grid grid-cols-2 gap-px border-b border-gray-800",children:ne.length>0?ne.map(H=>s.jsxs("div",{className:`relative flex flex-col items-center justify-center bg-gray-900 p-2 border group transition-colors duration-500 ${i.activePlayerId===H.id?"border-indigo-500 shadow-[inset_0_0_20px_rgba(79,70,229,0.2)]":"border-black/20"}`,children:[s.jsx("span",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest absolute top-2 w-full text-center truncate px-2",children:H.name}),s.jsx("span",{className:"text-4xl font-black text-white/90 mb-2",children:H.life}),X(H)]},H.id)):s.jsxs("div",{className:"col-span-2 flex flex-col items-center justify-center text-gray-600 space-y-2 p-6 text-center",children:[s.jsx("div",{className:"animate-pulse",children:"Waiting for opponents..."}),s.jsxs("div",{className:"text-xs font-mono bg-white/5 px-2 py-1 rounded",children:["PIN: ",_]})]})}),s.jsxs("div",{className:"h-12 bg-gray-950 shrink-0 flex items-center justify-between px-4 border-y border-white/5 z-20",children:[s.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-4",children:[s.jsxs("span",{children:["PIN: ",s.jsx("span",{className:"text-indigo-400 font-mono tracking-widest ml-1",children:_})]}),i.turnCount>0&&s.jsxs("span",{className:"bg-white/10 px-2 py-0.5 rounded text-gray-300",children:["Turn ",i.turnCount]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:be,className:"p-2 text-gray-500 hover:text-white transition-colors",title:"Add Log Note",children:s.jsx(v2e,{className:"w-4 h-4"})}),E&&s.jsxs("button",{onClick:U,className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 text-[10px] uppercase font-bold px-3 py-1.5 rounded flex items-center gap-1.5 transition-colors border border-red-500/20",children:[s.jsx(i2e,{className:"w-3 h-3"}),"End Game"]}),s.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-[10px] uppercase font-bold text-gray-600 hover:text-white transition-colors",children:"Leave"})]})]}),s.jsxs("div",{className:`flex-[2] bg-gray-950 relative group transition-all duration-500 ${i.activePlayerId===c?"shadow-[inset_0_0_30px_rgba(79,70,229,0.15)] border-t-2 border-indigo-500":""}`,children:[s.jsx(qXe,{life:oe.life,isSelf:!0,label:oe.name,onChange:se}),s.jsx("button",{onClick:()=>v(!0),className:"absolute top-6 right-6 w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center border border-white/10 shadow-lg z-20 transition-colors",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:[s.jsx("path",{d:"M12 2v20"}),s.jsx("path",{d:"M2 12h20"}),s.jsx("path",{d:"m4.93 4.93 14.14 14.14"}),s.jsx("path",{d:"m19.07 4.93-14.14 14.14"})]})})]}),R&&s.jsx("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 z-[60] animate-fade-in-up",children:s.jsxs("button",{onClick:re,className:"bg-gray-800/90 text-white px-6 py-3 rounded-full shadow-2xl border border-white/10 flex items-center gap-3 hover:bg-gray-700 transition-colors backdrop-blur-md",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),s.jsxs("div",{className:"flex flex-col items-start leading-none",children:[s.jsx("span",{className:"text-xs font-bold uppercase text-gray-400",children:"Undo"}),s.jsxs("span",{className:"font-bold text-sm",children:[R.type==="LIFE"&&`Life ${R.change>0?"+":""}${R.change}`,R.type==="COUNTER"&&`${R.counterType} ${R.change>0?"+":""}${R.change}`,R.type==="CMDR_DMG"&&`Cmd Dmg ${R.change>0?"+":""}${R.change}`]})]}),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("span",{className:"text-xs font-mono text-gray-500",children:"5s"})]})}),s.jsx(VXe,{isOpen:b,onClose:()=>v(!1),players:i.players,myPlayerId:c,myCounters:oe.counters,myCommanderDamage:oe.commanderDamage,onUpdateCounter:ee,onUpdateCmdDamage:q}),i.turnCount===0&&s.jsxs("div",{className:"absolute inset-0 z-40 bg-black/90 flex flex-col items-center justify-center p-6 space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-widest uppercase",children:"Prepare for Battle"}),s.jsxs("p",{className:"text-gray-400",children:["Waiting for ",E?"you to start":"host to start","..."]}),s.jsx("div",{className:"pt-2",children:s.jsxs("div",{className:"inline-block bg-white/10 rounded px-4 py-2 border border-white/20",children:[s.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mr-2",children:"Session PIN"}),s.jsx("span",{className:"text-2xl font-mono font-bold text-indigo-400 tracking-widest",children:_})]})})]}),E&&s.jsxs("div",{className:"w-full max-w-sm space-y-4",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Who goes first?"}),s.jsx("div",{className:"grid gap-2",children:i.players.map(H=>s.jsxs("button",{onClick:()=>Z(H.id),className:"w-full p-4 bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-indigo-500 text-left rounded-xl transition-all flex items-center justify-between group",children:[s.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white",children:H.name}),s.jsx(TA,{className:"w-4 h-4 text-gray-600 group-hover:text-indigo-400"})]},H.id))})]})]}),i.turnCount>0&&i.activePlayerId===c&&s.jsx("div",{className:"absolute bottom-32 md:bottom-24 left-1/2 -translate-x-1/2 z-50 animate-bounce-message",children:s.jsxs("button",{onClick:de,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-full font-bold shadow-lg shadow-indigo-900/50 flex items-center gap-2 transition-transform active:scale-95 border-2 border-indigo-400/50",children:[s.jsx(D2e,{className:"w-5 h-5"}),"Pass Turn"]})}),s.jsx(HXe,{isOpen:w,onClose:()=>j(!1),finalState:o,onSave:W,roomId:L.current})]}):null},GXe=({title:t,subtitle:e,icon:r,actions:n})=>s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[r&&s.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl text-indigo-400 border border-indigo-500/20",children:s.jsx(r,{size:32})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:t}),e&&s.jsx("p",{className:"text-gray-400 mt-1 text-sm font-medium",children:e})]})]}),n&&s.jsx("div",{className:"flex items-center gap-2",children:n})]}),KXe=()=>{const[t,e]=y.useState({friends:[],pending_sent:[],pending_received:[]}),[r,n]=y.useState(""),[i,a]=y.useState([]),[o,l]=y.useState(!0),[c,u]=y.useState(null);y.useEffect(()=>{h()},[]);const h=async()=>{try{const b=await Ge.get("/api/friends");e(b)}catch(b){console.error(b),u("Failed to load friends")}finally{l(!1)}},p=async()=>{if(!(r.length<3))try{const b=await Ge.get(`/api/friends/search?q=${encodeURIComponent(r)}`),v=new Set([...t.friends.map(w=>w.id),...t.pending_sent.map(w=>w.id),...t.pending_received.map(w=>w.id)]);a(b.filter(w=>!v.has(w.id)))}catch(b){console.error(b)}},m=async b=>{try{await Ge.post("/api/friends/request",{target_id:b}),a(v=>v.filter(w=>w.id!==b)),h()}catch(v){alert(v.response?.data?.error||"Failed to send request")}},g=async(b,v)=>{try{await Ge.post("/api/friends/respond",{friendship_id:b,action:v}),h()}catch(w){console.error(w)}};return s.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Find Friends"}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(LQ,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),s.jsx("input",{type:"text",value:r,onChange:b=>n(b.target.value),onKeyDown:b=>b.key==="Enter"&&p(),placeholder:"Search by username...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg py-2 pl-10 pr-4 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("button",{onClick:p,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors",children:"Search"})]}),i.length>0&&s.jsx("div",{className:"bg-gray-900 rounded-lg overflow-hidden border border-gray-700",children:i.map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-800 last:border-0 hover:bg-gray-800/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-gray-300 font-bold",children:b.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-medium",children:b.username}),s.jsx("div",{className:"text-xs text-gray-500",children:b.email})]})]}),s.jsxs("button",{onClick:()=>m(b.id),className:"flex items-center gap-2 px-3 py-1.5 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/10 rounded-lg text-sm transition-colors",children:[s.jsx(PA,{size:16}),"Add"]})]},b.id))})]}),(t.pending_received.length>0||t.pending_sent.length>0)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Pending Requests"}),s.jsxs("div",{className:"space-y-2",children:[t.pending_received.map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 font-bold border border-indigo-500/30",children:b.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-medium",children:b.username}),s.jsx("div",{className:"text-xs text-gray-400",children:"wants to be your friend"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>g(b.friendship_id,"accept"),className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[s.jsx(Od,{size:16})," Accept"]}),s.jsxs("button",{onClick:()=>g(b.friendship_id,"reject"),className:"bg-gray-700 hover:bg-red-600/80 text-gray-300 hover:text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[s.jsx(Fd,{size:16})," Reject"]})]})]},b.id)),t.pending_sent.map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/30 rounded-lg border border-gray-800 opacity-75",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-gray-500 font-bold",children:b.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-300 font-medium",children:b.username}),s.jsx("div",{className:"text-xs text-gray-500",children:"Request sent"})]})]}),s.jsx("span",{className:"px-2 py-1 bg-gray-800 rounded text-xs text-gray-500 font-medium border border-gray-700",children:"Pending"})]},b.id))]})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-4",children:["My Friends (",t.friends.length,")"]}),t.friends.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-900/50 rounded-lg border border-dashed border-gray-700",children:[s.jsx(PA,{size:48,className:"mx-auto mb-4 opacity-20"}),s.jsx("p",{children:"You haven't added any friends yet."}),s.jsx("p",{className:"text-sm",children:"Search above to connect!"})]}):s.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.friends.map(b=>s.jsxs("div",{className:"flex items-center p-3 bg-gray-900 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors group",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-500/20 mr-4",children:b.username[0].toUpperCase()}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-white font-bold",children:b.username}),b.lfg_status&&s.jsx("span",{className:"px-1.5 py-0.5 bg-green-500/20 text-green-400 text-[10px] font-bold uppercase rounded border border-green-500/30",children:"LFG"})]}),s.jsx("div",{className:"text-xs text-gray-500",children:b.email})]}),s.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-2 text-gray-500 hover:text-red-400 transition-all"})]},b.id))})]})]})},YXe=()=>{const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{(async()=>{try{const a=await Ge.get("/api/social/feed");e(a)}catch(a){console.error(a)}finally{n(!1)}})()},[]),r?s.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:[1,2,3].map(i=>s.jsx("div",{className:"h-32 bg-gray-800/50 rounded-xl animate-pulse"},i))}):t.length===0?s.jsxs("div",{className:"text-center py-16 max-w-lg mx-auto",children:[s.jsx("div",{className:"inline-flex p-4 rounded-full bg-gray-800 mb-4",children:s.jsx(Wv,{size:48,className:"text-gray-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-300 mb-2",children:"No recent activity"}),s.jsxs("p",{className:"text-gray-500",children:["Matches played by you and your friends will appear here.",s.jsx("br",{}),"Add friends to populate your feed!"]})]}):s.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:t.map(i=>s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[s.jsx(Wv,{size:20}),s.jsx("span",{className:"font-bold text-sm uppercase tracking-wide",children:"Commander Match"})]}),s.jsx("span",{className:"text-xs text-gray-500",children:q4e(new Date(i.date),{addSuffix:!0})})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:i.participants.map(a=>s.jsxs("div",{className:`
                    flex items-center justify-between p-3 rounded-lg border 
                    ${a.outcome==="win"?"bg-amber-500/10 border-amber-500/30":"bg-gray-900/50 border-gray-800"}
                  `,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs
                        ${a.outcome==="win"?"bg-amber-500 text-black shadow-lg shadow-amber-500/20":"bg-gray-700 text-gray-300"}
                    `,children:a.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:`text-sm font-bold ${a.outcome==="win"?"text-amber-200":"text-gray-300"}`,children:a.username}),s.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:a.deck||"Unknown Deck"})]})]}),a.outcome==="win"&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-500/20 rounded text-amber-400 text-[10px] font-bold uppercase border border-amber-500/30",children:[s.jsx(bx,{size:12})," Winner"]})]},a.userId))})]},i.id))})},XXe=()=>{const[t,e]=y.useState([]),[r,n]=y.useState(!0);y.useEffect(()=>{(async()=>{try{const o=await Ge.get("/api/social/leaderboard");e(o)}catch(o){console.error(o)}finally{n(!1)}})()},[]);const i=a=>a===0?{icon:s.jsx(Ro,{size:20,className:"text-yellow-400"}),bg:"bg-yellow-500/10",border:"border-yellow-500/30"}:a===1?{icon:s.jsx(gB,{size:20,className:"text-gray-300"}),bg:"bg-gray-400/10",border:"border-gray-400/30"}:a===2?{icon:s.jsx(gB,{size:20,className:"text-amber-700"}),bg:"bg-orange-900/10",border:"border-orange-700/30"}:{icon:s.jsxs("span",{className:"text-gray-500 font-bold ml-1.5",children:["#",a+1]}),bg:"bg-transparent",border:"border-transparent"};return s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Ro,{className:"text-yellow-500",size:24}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"Weekly Top Players"})]}),s.jsx("div",{className:"bg-gray-900/60 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-900/80 text-gray-400 text-xs uppercase tracking-wider border-b border-gray-800",children:[s.jsx("th",{className:"p-4 w-20 text-center",children:"Rank"}),s.jsx("th",{className:"p-4",children:"Player"}),s.jsx("th",{className:"p-4 text-center",children:"Wins"}),s.jsx("th",{className:"p-4 text-center",children:"Games"}),s.jsx("th",{className:"p-4 text-center",children:"Win Rate"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:r?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Loading leaderboard..."})}):t.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No games played this week yet. Get out there!"})}):t.map((a,o)=>{const l=i(o),c=a.games_played>0?Math.round(a.wins/a.games_played*100):0;return s.jsxs("tr",{className:`hover:bg-gray-800/30 transition-colors ${o<3?"bg-gray-800/10":""}`,children:[s.jsx("td",{className:"p-4 text-center",children:s.jsx("div",{className:"flex justify-center items-center",children:l.icon})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs bg-gray-700 text-gray-200 border border-gray-600",children:a.username?a.username[0].toUpperCase():"?"}),s.jsx("span",{className:`font-bold ${o===0?"text-yellow-400":"text-gray-200"}`,children:a.username}),o===0&&s.jsx(bx,{size:14,className:"text-yellow-500"})]})}),s.jsx("td",{className:"p-4 text-center font-bold text-green-400 text-lg",children:a.wins}),s.jsx("td",{className:"p-4 text-center text-gray-400",children:a.games_played}),s.jsx("td",{className:"p-4 text-center",children:s.jsxs("span",{className:`
                                        inline-block px-2 py-1 rounded text-xs font-bold
                                        ${c>=50?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-gray-800 text-gray-400 border border-gray-700"}
                                    `,children:[c,"%"]})})]},a.user_id)})})]})})]})},Uae=({tournaments:t,emptyMessage:e="No tournaments found."})=>{const r=xn();return!t||t.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(Ro,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments"}),s.jsx("p",{className:"text-gray-500 mb-6",children:e})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(n=>s.jsxs("div",{onClick:()=>r(`/tournaments/${n.id}`),className:"group bg-gray-800/50 hover:bg-gray-800 border border-gray-700 hover:border-yellow-500/50 rounded-xl p-5 cursor-pointer transition-all hover:shadow-lg hover:shadow-yellow-500/10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-yellow-400 transition-colors",children:n.name}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase tracking-wider ${n.status==="active"?"bg-green-500/20 text-green-400":n.status==="completed"?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-400"}`,children:n.status})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-400 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(AQ,{className:"w-4 h-4"}),new Date(n.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ro,{className:"w-4 h-4"}),n.format.toUpperCase()]})]}),s.jsxs("div",{className:"flex items-center text-yellow-500 text-sm font-medium group-hover:translate-x-1 transition-transform",children:["Manage Tournament ",s.jsx(A1e,{className:"w-4 h-4 ml-1"})]})]},n.id))})},zae=({isOpen:t,onClose:e,onCreated:r})=>{const n=xn(),[i,a]=y.useState(""),[o,l]=y.useState("swiss"),[c,u]=y.useState(""),[h,p]=y.useState(!1),m=async g=>{g.preventDefault(),p(!0);try{const b={name:i||"New Tournament",format:o,settings:{total_rounds:o==="elimination"&&c?parseInt(c,10):null,target_points:o==="swiss"&&c?parseInt(c,10):null}},v=await Ge.post("/api/tournaments",b);a(""),l("swiss"),u(""),p(!1),r?r(v):(e(),n(`/tournaments/${v.id}`))}catch(b){console.error("Failed to create tournament",b),p(!1),alert("Failed to create tournament. Please try again.")}};return t?s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md p-6 shadow-2xl",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Create Tournament"}),s.jsxs("form",{onSubmit:m,children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Event Name"}),s.jsx("input",{autoFocus:!0,type:"text",value:i,onChange:g=>a(g.target.value),placeholder:"e.g. Friday Night Magic",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none mb-4",required:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Format"}),s.jsxs("select",{value:o,onChange:g=>l(g.target.value),className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none",children:[s.jsx("option",{value:"swiss",children:"Swiss (Points)"}),s.jsx("option",{value:"elimination",children:"Single Elimination"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:o==="swiss"?"Target Points (Optional)":"Round Limit (Optional)"}),s.jsx("input",{type:"number",min:"1",value:c,onChange:g=>u(g.target.value),placeholder:o==="swiss"?"e.g. 12":"Auto",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none"})]})]}),o==="swiss"&&s.jsxs("div",{className:"text-xs text-gray-500 mb-6 bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[s.jsx("span",{className:"font-bold text-yellow-500",children:"Note:"})," Wins are 3 points, Draws are 1 point. Setting a target will end the tournament once a player reaches this score."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 hover:bg-gray-800 rounded-lg text-gray-400 font-medium transition-colors",disabled:h,children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-6 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors disabled:opacity-50",disabled:h,children:h?"Creating...":"Create Event"})]})]})]})}):null},QXe=()=>{const{user:t,userProfile:e,refreshUserProfile:r}=Or(),[n,i]=v4(),[a,o]=y.useState(n.get("tab")||"feed"),[l,c]=y.useState(!1),[u,h]=y.useState([]),[p,m]=y.useState(!1),[g,b]=y.useState(!1),[v,w]=y.useState(!1);y.useEffect(()=>{const O=()=>w(!0);return window.addEventListener("start-tour",O),localStorage.getItem("tour_seen_social_tour_v1")||setTimeout(()=>w(!0),1e3),()=>window.removeEventListener("start-tour",O)},[]);const j=[{target:"h1",title:"Social Hub",content:"Connect with friends and the community."},{target:"#social-lfg-toggle",title:"Looking for Game",content:"Toggle this on to let your friends know you are ready to play."},{target:"#social-tabs",title:"Navigation",content:"Switch between Activity Feed, Friends, Leaderboards, and Tournaments."}];y.useEffect(()=>{e?.lfg_status!==void 0&&c(e.lfg_status)},[e]),y.useEffect(()=>{a==="tournaments"&&_(),i({tab:a},{replace:!0})},[a,i]);const _=async()=>{try{m(!0);const O=await Ge.get("/api/tournaments");h(O||[])}catch(O){console.error("Failed to fetch tournaments",O)}finally{m(!1)}},E=async()=>{const O=!l;c(O);try{e?.id&&(await Ge.updateUser(e.id,{lfg_status:O}),r&&await r())}catch(B){console.error("Failed to update LFG status",B),c(!O)}},I=[{id:"feed",label:"Activity Feed",icon:EA},{id:"friends",label:"Friends",icon:cm},{id:"leaderboard",label:"Leaderboard",icon:Ro},{id:"tournaments",label:"Tournaments",icon:Wv}];return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[s.jsx(GXe,{title:"Social Hub",subtitle:"Connect with friends and track the meta.",icon:cm}),s.jsx("div",{className:`p-4 rounded-xl border transition-colors ${l?"bg-green-500/10 border-green-500/30":"bg-gray-900 border-gray-800"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{id:"social-lfg-toggle",onClick:E,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900 ${l?"bg-green-500":"bg-gray-700"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l?"translate-x-6":"translate-x-1"}`})}),s.jsxs("div",{children:[s.jsx("div",{className:`text-sm font-bold ${l?"text-green-400":"text-gray-400"}`,children:"Looking for Game"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Signal your friends you're ready to play"})]})]})})]}),s.jsxs("div",{className:"bg-gray-900/40 border border-white/5 rounded-2xl overflow-hidden backdrop-blur-sm",children:[s.jsx("div",{className:"border-b border-white/5",children:s.jsx("div",{className:"flex overflow-x-auto",id:"social-tabs",children:I.map(O=>{const B=O.icon,S=a===O.id;return s.jsxs("button",{onClick:()=>o(O.id),className:`flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${S?"border-indigo-500 text-indigo-400 bg-indigo-500/5":"border-transparent text-gray-400 hover:text-gray-200 hover:bg-white/5"}`,children:[s.jsx(B,{size:18}),O.label]},O.id)})})}),s.jsxs("div",{className:"p-6",children:[a==="feed"&&s.jsx(YXe,{}),a==="friends"&&s.jsx(KXe,{}),a==="leaderboard"&&s.jsx(XXe,{}),a==="tournaments"&&(p?s.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading Tournaments..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg text-sm transition-colors",children:[s.jsx(Wv,{className:"w-4 h-4"}),"Create Tournament"]})}),s.jsx(Uae,{tournaments:u,emptyMessage:"No active tournaments found based on filters."})]}))]})]}),s.jsx(zae,{isOpen:g,onClose:()=>b(!1)}),s.jsx(pf,{steps:j,isOpen:v,onClose:()=>w(!1),tourId:"social_tour_v1"})]})},JXe=()=>{const{currentUser:t,userProfile:e}=Or(),[r,n]=y.useState([]),[i,a]=y.useState(!0),[o,l]=y.useState(null);return y.useEffect(()=>{if(!e?.id)return;(async()=>{a(!0);try{const u=await ZJ.findMatches(e.id);n(u)}catch(u){console.error("Trade fetch error:",u),l("Failed to load trade matches.")}finally{a(!1)}})()},[e]),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-xl",children:s.jsx("span",{className:"text-3xl",children:""})}),"The Armory"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Automated Trade Matches with your Pod"})]}),s.jsx("div",{className:"flex gap-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl px-4 py-2 border border-gray-700 text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Matches"}),s.jsx("div",{className:"text-xl font-bold text-white",children:r.length})]})})]}),i?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((c,u)=>s.jsx("div",{className:"h-32 bg-gray-800 rounded-xl animate-pulse"},u))}):o?s.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 p-6 rounded-xl text-center text-red-300",children:[s.jsx("p",{children:o}),s.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-900/50 hover:bg-red-800 rounded-lg text-white text-sm",children:"Retry"})]}):r.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-900/50 rounded-2xl border border-gray-800",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Matches Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"We couldn't find anyone in your Pod who has cards from your Wishlist in their Public Binders."}),s.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[s.jsx(Er,{to:"/binders",className:"px-5 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-bold",children:"Update Binders"}),s.jsx(Er,{to:"/wishlist",className:"px-5 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold",children:"Update Wishlist"})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((c,u)=>s.jsxs("div",{className:"bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-indigo-500/50 rounded-xl p-4 flex gap-4 transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-indigo-500/5 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none"}),s.jsx("div",{className:"relative w-24 min-w-[6rem] aspect-[2.5/3.5] rounded-lg overflow-hidden shadow-lg border border-black/50",children:c.image?s.jsx("img",{src:c.image,alt:c.cardName,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center text-xs text-gray-500",children:"No Img"})}),s.jsxs("div",{className:"flex flex-col justify-between flex-1 min-w-0 z-10",children:[s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx("h3",{className:"text-lg font-bold text-white truncate",children:c.cardName})}),s.jsxs("div",{className:"text-xs text-indigo-400 font-mono mt-1",children:[c.set?.toUpperCase(),"  ",c.finish]}),s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsx("div",{className:"text-xs text-gray-400",children:"Available from:"}),s.jsx(Er,{to:`/profile/${c.friendId}`,className:"px-2 py-0.5 bg-indigo-900/30 text-indigo-300 rounded text-xs font-bold border border-indigo-500/20 hover:bg-indigo-500 hover:text-white transition-colors cursor-pointer",children:c.friendName})]}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Quantity: ",c.quantity]})]}),s.jsxs("button",{onClick:()=>alert(`Requesting ${c.cardName} from ${c.friendName}... (Feature Coming Soon)`),className:"mt-3 w-full py-2 bg-gray-700 hover:bg-indigo-600 text-white text-xs font-bold uppercase rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Request Trade"]})]})]},`${c.cardId}-${u}`))})]})},ZXe=()=>{const{id:t}=yl(),e=xn(),{userProfile:r}=Or(),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState(!0),[u,h]=y.useState(null),[p,m]=y.useState(!1),g=async()=>{try{c(!0);const v=await Ge.get(`/users/public/${t}`);if(i(v.data),v.data.is_public_library||v.data.relationship?.status==="accepted"){const w=await Ge.get(`/api/decks?userId=${t}`);o(w.data)}}catch(v){console.error("Failed to fetch profile",v),v.response?.status===403?h("This profile is private."):v.response?.status===404?h("User not found."):h("Failed to load profile.")}finally{c(!1)}};y.useEffect(()=>{t&&g()},[t]);const b=async v=>{if(n){m(!0);try{v==="request"?await ia.sendRequest({targetId:n.id},"friend"):v==="cancel"||v==="unfriend"?n.relationship?.id&&await ia.deleteRelationship(n.relationship.id):v==="accept"&&n.relationship?.id&&await ia.respondToRequest(n.relationship.id,"accepted"),await g()}catch(w){console.error("Friend action failed",w),alert("Action failed: "+(w.response?.data?.error||"Unknown error"))}finally{m(!1)}}};return l?s.jsxs("div",{className:"flex items-center justify-center h-screen text-slate-400",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500 mr-3"}),"Loading Profile..."]}):u?s.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center px-4",children:[s.jsx("div",{className:"bg-red-500/10 p-4 rounded-full mb-4",children:s.jsx(lm,{className:"w-12 h-12 text-red-500"})}),s.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-slate-400 mb-6 max-w-md",children:u}),s.jsx("button",{onClick:()=>e("/dashboard"),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors",children:"Return to Dashboard"})]}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[s.jsxs("div",{className:"relative bg-slate-800 rounded-2xl p-8 border border-slate-700/50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-5 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-primary-500 via-slate-900 to-slate-900 pointer-events-none"}),s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center md:items-start md:space-x-8",children:[s.jsx("div",{className:"w-32 h-32 rounded-full bg-slate-700 flex items-center justify-center border-4 border-slate-800 shadow-xl mb-4 md:mb-0",children:n.avatar?s.jsx("img",{src:n.avatar,alt:n.username,className:"w-full h-full rounded-full object-cover"}):s.jsx(OA,{className:"w-16 h-16 text-slate-500"})}),s.jsxs("div",{className:"flex-1 text-center md:text-left space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-3",children:[s.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:n.username}),n.is_friend&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",children:"Friend"}),r?.id===n.id&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"You"})]}),n.bio&&s.jsx("p",{className:"text-slate-300 max-w-2xl",children:n.bio}),s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-6 text-sm text-slate-400 pt-2",children:[s.jsxs("span",{children:["Joined ",new Date(n.joined_at).toLocaleDateString()]}),n.is_public_library&&s.jsxs("span",{className:"flex items-center text-amber-400",children:[s.jsx(PQ,{className:"w-3 h-3 mr-1.5"}),"Public Library"]})]})]}),s.jsxs("div",{className:"mt-6 md:mt-0 flex flex-wrap gap-3 justify-center md:justify-end",children:[r?.id!==n.id&&s.jsxs(s.Fragment,{children:[(!n.relationship||!n.relationship.status)&&s.jsxs("button",{onClick:()=>b("request"),disabled:p,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-indigo-900/20 transition-all flex items-center disabled:opacity-50",children:[s.jsx(OA,{className:"w-4 h-4 mr-2"}),"Add Friend"]}),n.relationship?.status==="pending"&&n.relationship.direction==="outgoing"&&s.jsx("button",{onClick:()=>b("cancel"),disabled:p,className:"bg-slate-700 hover:bg-slate-600 text-slate-200 px-5 py-2.5 rounded-lg font-medium transition-all flex items-center disabled:opacity-50",children:"Cancel Request"}),n.relationship?.status==="pending"&&n.relationship.direction==="incoming"&&s.jsx("button",{onClick:()=>b("accept"),disabled:p,className:"bg-emerald-600 hover:bg-emerald-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-emerald-900/20 transition-all flex items-center disabled:opacity-50",children:"Accept Request"}),n.relationship?.status==="accepted"&&s.jsx("button",{onClick:()=>{window.confirm(`Unfriend ${n.username}?`)&&b("unfriend")},disabled:p,className:"bg-slate-700 hover:bg-red-900/40 hover:text-red-400 text-slate-300 px-5 py-2.5 rounded-lg font-medium transition-all flex items-center disabled:opacity-50 border border-transparent hover:border-red-900/50",children:"Unfriend"})]}),s.jsx("button",{onClick:()=>e(`/collection?userId=${n.id}&public=true`),className:"bg-primary-600 hover:bg-primary-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-primary-900/20 transition-all flex items-center",children:"View Collection"})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("h2",{className:"text-xl font-bold text-white",children:"Public Library"})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{onClick:()=>e(`/collection?userId=${n.id}&public=true`),className:"group cursor-pointer bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-primary-500/50 rounded-xl p-6 transition-all h-full flex flex-col justify-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-1 group-hover:text-primary-400 transition-colors uppercase tracking-tight",children:"Browse Collection"}),s.jsx("p",{className:"text-slate-400 text-sm",children:"View all cards available for trade or display."})]}),a.map(v=>s.jsxs("div",{onClick:()=>e(`/decks/${v.id}`),className:"group cursor-pointer bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-indigo-500/50 rounded-xl p-6 transition-all",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-white group-hover:text-indigo-400 transition-colors truncate pr-2",children:v.name}),s.jsx("span",{className:"text-[10px] bg-indigo-500/20 text-indigo-400 px-2 py-0.5 rounded uppercase font-bold tracking-wider border border-indigo-500/30",children:v.format})]}),s.jsxs("p",{className:"text-slate-400 text-sm",children:[v.card_count," Cards"]})]},v.id)),a.length===0&&s.jsx("div",{className:"bg-slate-900/50 border border-dashed border-slate-800 rounded-xl p-6 flex items-center justify-center",children:s.jsx("p",{className:"text-slate-600 text-sm italic",children:"No public decks shared."})})]})]})]})},eQe=({tournamentId:t,round:e,initialPairings:r,participants:n,onUpdate:i,isPending:a,isOrganizer:o})=>{const{user:l}=Or(),[c,u]=Pe.useState(!1),{addToast:h}=jn();if(a)return s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(lm,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"Tournament Pending"}),s.jsx("p",{className:"text-gray-500",children:"Add players and click Start to generate pairings."})]});if(!r||r.length===0)return s.jsx("div",{className:"p-4 text-center text-gray-400",children:"No pairings for this round."});const p=n.reduce((b,v)=>(b[v.id]=v,b),{}),m=async(b,v,w)=>{try{await Ge.post(`/api/tournaments/${t}/matches`,{matchId:b,winnerId:w?null:v,isDraw:w}),i()}catch(j){console.error("Failed to report result",j),h("Failed to save result","error")}},g=async(b,v)=>{try{await Ge.put(`/api/tournaments/${t}/pairings/${b}`,v),h("Pairing updated","success"),setTimeout(i,500)}catch(w){console.error("Failed to edit pairing",w),h("Failed to update pairing","error")}};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-white",children:["Round ",e," Pairings"]}),o&&s.jsx("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-lg border font-bold transition-all ${c?"bg-indigo-600 text-white border-indigo-500":"bg-gray-800 text-gray-400 border-gray-700 hover:text-white"}`,children:c?"Done Editing":"Edit Pairings"})]}),r.map(b=>{const v=p[b.player1_id],w=p[b.player2_id],j=b.winner_id===b.player1_id&&!b.is_draw,_=b.winner_id===b.player2_id&&!b.is_draw,E=b.is_draw,I=n.find(B=>B.user_id===l?.id),O=I&&(b.player1_id===I.id||b.player2_id===I.id);return s.jsxs("div",{className:`p-4 rounded-xl border flex flex-col md:flex-row items-center justify-between gap-4 transition-all ${O&&!c?"bg-blue-900/20 border-blue-500/50":"bg-gray-800 border-gray-700"}`,children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1 w-full md:w-auto",children:[s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsxs("span",{className:"text-gray-500 font-mono text-sm",children:["Table ",b.table_number]}),O&&!b.winner_id&&!b.is_draw&&!c&&s.jsxs("button",{onClick:()=>window.open(`/play/room/pair-${b.id}`,"_blank"),className:"px-2 py-1 bg-green-600 hover:bg-green-500 text-white text-[10px] font-bold rounded flex items-center gap-1 shadow-lg",children:[s.jsx(V1e,{className:"w-3 h-3"})," JOIN"]})]}),s.jsx("div",{className:`flex-1 text-right font-bold ${j?"text-green-400":"text-white"}`,children:c?s.jsx("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full text-right",value:b.player1_id||"",onChange:B=>g(b.id,{player1Id:B.target.value}),children:n.map(B=>s.jsx("option",{value:B.id,children:B.username||B.guest_name},B.id))}):v?v.username||v.guest_name:"Unknown"}),s.jsx("div",{className:"text-gray-500 font-bold text-xs",children:"VS"}),s.jsx("div",{className:`flex-1 text-left font-bold ${_?"text-green-400":"text-white"}`,children:c?s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full",value:b.player2_id||"",onChange:B=>g(b.id,{player2Id:B.target.value||null}),children:[s.jsx("option",{value:"",children:"(Bye)"}),n.map(B=>s.jsx("option",{value:B.id,children:B.username||B.guest_name},B.id))]}):w?w.username||w.guest_name:b.player2_id===null?"BYE":"Unknown"})]}),!c&&(b.player2_id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>m(b.id,b.player1_id,!1),className:`p-2 rounded-lg transition-colors ${j?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 1 Wins",children:s.jsx(Ro,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>m(b.id,null,!0),className:`p-2 rounded-lg transition-colors ${E?"bg-yellow-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Draw",children:s.jsx(N2e,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>m(b.id,b.player2_id,!1),className:`p-2 rounded-lg transition-colors ${_?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 2 Wins",children:s.jsx(Ro,{className:"w-4 h-4"})})]}):s.jsx("div",{className:"px-4 py-2 bg-gray-700/50 rounded-lg text-gray-400 text-sm",children:"Automatic Win"}))]},b.id)})]})},tQe=({participants:t,tournamentId:e,currentUserId:r,isOrganizer:n,onUpdate:i})=>{if(!t||t.length===0)return s.jsx("div",{className:"p-4 text-center text-gray-400",children:"No participants yet."});const{addToast:a}=jn(),o=[...t].sort((c,u)=>u.score!==c.score?u.score-c.score:u.wins!==c.wins?u.wins-c.wins:c.losses-u.losses),l=async c=>{if(confirm("Are you sure you want to drop this player? They will be removed from future pairings."))try{await Ge.post(`/api/tournaments/${e}/drop`,{participantId:c}),a("Player dropped successfully","success"),i()}catch(u){console.error(u),a("Failed to drop player","error")}};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-gray-400 border-b border-gray-700",children:[s.jsx("th",{className:"p-4 font-medium uppercase text-xs",children:"Rank"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs w-full",children:"Player"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Pts"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"W"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"L"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"D"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:o.map((c,u)=>s.jsxs("tr",{className:`transition-colors ${c.is_active===!1?"bg-red-900/10 opacity-60":"hover:bg-gray-800/50"}`,children:[s.jsx("td",{className:"p-4",children:s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${u===0?"bg-yellow-500/20 text-yellow-500":u===1?"bg-gray-400/20 text-gray-400":u===2?"bg-orange-700/20 text-orange-700":"text-gray-500"}`,children:u+1})}),s.jsx("td",{className:"p-4 font-bold text-white",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:c.username||c.guest_name}),c.deck_snapshot&&s.jsx("span",{className:"text-xs text-blue-400 font-normal",children:c.deck_snapshot.name})]})}),s.jsx("td",{className:"p-4 text-center font-bold text-yellow-500 text-lg",children:c.score}),s.jsx("td",{className:"p-4 text-center text-green-400 font-medium",children:c.wins}),s.jsx("td",{className:"p-4 text-center text-red-400 font-medium",children:c.losses}),s.jsx("td",{className:"p-4 text-center text-gray-400 font-medium",children:c.draws}),s.jsx("td",{className:"p-4 text-center",children:c.is_active===!1?s.jsx("span",{className:"text-xs bg-red-900 text-red-300 px-2 py-1 rounded",children:"Dropped"}):(n||c.user_id===r)&&s.jsx("button",{onClick:()=>l(c.id),className:"text-xs bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-300 px-2 py-1 rounded border border-gray-600 hover:border-red-800 transition-colors",children:"Drop"})})]},c.id))})]})})},rQe=({pairings:t,participants:e})=>{const r=y.useMemo(()=>{if(!t||t.length===0)return[];const i={};let a=0;t.forEach(l=>{i[l.round_number]||(i[l.round_number]=[]),i[l.round_number].push(l),l.round_number>a&&(a=l.round_number)});const o=[];for(let l=1;l<=a;l++)i[l]&&o.push(i[l].sort((c,u)=>c.table_number-u.table_number));return o},[t]),n=i=>{if(!i)return"Bye";const a=e.find(o=>o.id===i);return a?a.username||a.guest_name:"Unknown"};return r.length===0?s.jsx("div",{className:"text-center py-12 text-gray-500",children:"No bracket data available yet. Start the tournament to generate the bracket."}):s.jsx("div",{className:"overflow-x-auto pb-6 custom-scrollbar",children:s.jsx("div",{className:"flex gap-8 min-w-max px-4",children:r.map((i,a)=>s.jsxs("div",{className:"flex flex-col justify-around gap-8",children:[s.jsxs("div",{className:"text-center text-gray-500 font-bold uppercase text-xs mb-2 tracking-wider",children:["Round ",a+1]}),s.jsx("div",{className:"flex flex-col justify-around flex-grow gap-4",children:i.map(o=>s.jsx(nQe,{match:o,getPlayerName:n},o.id))})]},a))})})},nQe=({match:t,getPlayerName:e})=>{const r=t.winner_id===t.player1_id,n=t.winner_id===t.player2_id;return s.jsxs("div",{className:"w-48 bg-gray-800 border border-gray-700 rounded-lg overflow-hidden flex flex-col shadow-lg relative",children:[s.jsxs("div",{className:`p-2 flex justify-between items-center ${r?"bg-green-900/20":""} border-b border-gray-700/50`,children:[s.jsx("span",{className:`text-sm truncate ${r?"text-green-400 font-bold":"text-gray-300"}`,children:e(t.player1_id)}),r&&s.jsx(Ro,{className:"w-3 h-3 text-yellow-500"})]}),s.jsxs("div",{className:`p-2 flex justify-between items-center ${n?"bg-green-900/20":""}`,children:[s.jsx("span",{className:`text-sm truncate ${n?"text-green-400 font-bold":"text-gray-300"}`,children:t.player2_id?e(t.player2_id):s.jsx("span",{className:"text-gray-600 italic",children:"Bye"})}),n&&s.jsx(Ro,{className:"w-3 h-3 text-yellow-500"})]})]})},sQe=({isOpen:t,onClose:e,tournamentName:r,winnerName:n,stats:i})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fade-in",children:s.jsxs("div",{className:"relative bg-gradient-to-b from-gray-900 to-black border border-yellow-500/30 rounded-2xl max-w-md w-full p-8 shadow-2xl shadow-yellow-900/20 text-center overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-yellow-500 to-transparent opacity-50"}),s.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-yellow-500/10 rounded-full blur-3xl"}),s.jsx("div",{className:"absolute -bottom-10 -left-10 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl"}),s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:s.jsx(Fd,{className:"w-5 h-5"})}),s.jsxs("div",{className:"mb-6 relative",children:[s.jsx("div",{className:"mx-auto w-20 h-20 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg shadow-yellow-500/30 mb-4 animate-bounce-slow",children:s.jsx(Ro,{className:"w-10 h-10 text-black fill-current"})}),s.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-300 uppercase tracking-widest mb-1 filter drop-shadow-sm",children:"Champion"}),s.jsx("p",{className:"text-yellow-500/80 text-xs font-bold uppercase tracking-widest",children:r})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50 mb-8 backdrop-blur-sm",children:[s.jsx("div",{className:"text-4xl font-bold text-white mb-2 tracking-tight",children:n||"Unknown Winner"}),s.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Score"}),s.jsx("div",{className:"text-xl font-mono text-yellow-500 font-bold",children:i?.score||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Wins"}),s.jsx("div",{className:"text-xl font-mono text-green-400 font-bold",children:i?.wins||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Losses"}),s.jsx("div",{className:"text-xl font-mono text-red-400 font-bold",children:i?.losses||0})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{className:"w-full py-3 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 shadow-lg",onClick:()=>alert("Sharing implemented soon!"),children:[s.jsx(PQ,{className:"w-4 h-4"})," Share Victory"]}),s.jsx("button",{onClick:e,className:"w-full py-3 bg-gray-800 text-gray-400 font-bold rounded-xl hover:bg-gray-700 hover:text-white transition-colors",children:"Close"})]})]})}):null,iQe=()=>{const{id:t}=yl(),e=xn(),{user:r,userProfile:n}=Or(),[i,a]=y.useState(null),[o,l]=y.useState("pairings"),[c,u]=y.useState(!0),[h,p]=y.useState(null),[m,g]=y.useState(""),[b,v]=y.useState(""),[w,j]=y.useState([]),[_,E]=y.useState(!1),[I,O]=y.useState(null),[B,S]=y.useState({isOpen:!1,type:null,title:"",message:""}),[T,M]=y.useState(!1);y.useEffect(()=>{t&&($(),k())},[t]);const $=async()=>{try{u(!0);const q=await Ge.get(`/api/tournaments/${t}`);a(q)}catch(q){p(q.message)}finally{u(!1)}},k=async()=>{try{const q=await Ge.get("/api/friends");j(q.friends||[])}catch(q){console.error("Failed to load friends",q)}},L=async q=>{q.preventDefault();try{await Ge.post(`/api/tournaments/${t}/participants`,{userId:m||null,guestName:b||null}),g(""),v(""),$()}catch{alert("Failed to add participant")}},R=()=>{S({isOpen:!0,type:"START",title:"Start Tournament?",message:"This will generate Round 1 pairings. Ensure all players are added."})},V=async()=>{try{await Ge.post(`/api/tournaments/${t}/start`),$(),S({isOpen:!1})}catch{alert("Failed to start tournament")}},Y=()=>{S({isOpen:!0,type:"NEXT_ROUND",title:"Generate Next Round?",message:"This will lock current round results and generate new pairings."})},X=async()=>{try{const q=await Ge.post(`/api/tournaments/${t}/next-round`);if($(),S({isOpen:!1}),q.completed){const U=await Ge.get(`/api/tournaments/${t}`),W=U.participants&&U.participants[0];W&&(O(W),E(!0))}}catch{alert("Failed to generate next round. Make sure all matches are finished.")}},J=()=>{B.type==="START"&&V(),B.type==="NEXT_ROUND"&&X()},re=i&&i.status==="active"&&i.currentPairings&&i.currentPairings.every(q=>q.winner_id||q.is_draw);console.log("[TournamentDetail] Auth Debug:",{userId:n?.id,organizerId:i?.organizer_id,match:String(n?.id)===String(i?.organizer_id)});const se=n?.id&&i?.organizer_id&&String(n.id)===String(i.organizer_id);if(c)return s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Tournament..."});if(h)return s.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",h]});if(!i)return null;const ee=`${window.location.origin}/tournaments/${t}/join`;return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("button",{onClick:()=>e("/social?tab=tournaments"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[s.jsx(EQ,{className:"w-4 h-4 mr-2"})," Back to Arena"]}),s.jsx("div",{className:"bg-gray-800 rounded-xl p-6 mb-6 border border-gray-700 shadow-lg",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h1",{className:"text-3xl font-bold text-white",children:i.name}),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${i.status==="active"?"bg-green-500/20 text-green-400 border border-green-500/50":i.status==="completed"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-gray-600/50 text-gray-400 border border-gray-600"}`,children:i.status})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ro,{className:"w-4 h-4 text-yellow-500"}),i.format.toUpperCase()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(TQ,{className:"w-4 h-4 text-blue-400"}),"Round ",i.current_round]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(cm,{className:"w-4 h-4 text-purple-400"}),i.participants?.length||0," Players"]})]}),i.status==="pending"&&s.jsxs("button",{onClick:()=>M(!0),className:"mt-4 text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2",children:[s.jsx(cm,{className:"w-4 h-4"})," Show Join QR Code"]})]}),i.status==="pending"&&se&&s.jsxs("button",{onClick:R,disabled:i.participants?.length<2,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-green-500/20",children:[s.jsx(TA,{className:"w-5 h-5 fill-current"}),"Start Tournament"]}),i.status==="active"&&se&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("button",{onClick:Y,disabled:!re,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-blue-500/20",children:[s.jsx(tj,{className:"w-5 h-5"}),"Next Round"]})}),se&&s.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to DELETE this tournament? This cannot be undone."))try{await Ge.delete(`/api/tournaments/${t}`),e("/tournaments")}catch{alert("Failed to delete tournament")}},className:"flex items-center gap-2 px-4 py-3 bg-red-900/30 hover:bg-red-900/50 text-red-400 border border-red-900/50 rounded-lg transition-all ml-2",title:"Delete Tournament",children:[s.jsx(X2e,{className:"w-5 h-5"}),s.jsx("span",{className:"hidden md:inline",children:"Delete"})]})]})}),i.settings?.total_rounds&&s.jsxs("div",{className:"mb-4 text-xs text-gray-500 text-right",children:["Playing best of ",i.settings.total_rounds," Rounds"]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"lg:col-span-3",children:[s.jsxs("div",{className:"flex border-b border-gray-700 mb-6",children:[s.jsx("button",{onClick:()=>l("pairings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="pairings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Pairings"}),s.jsx("button",{onClick:()=>l("standings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="standings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Standings"}),(i.format==="elimination"||i.settings?.mode==="elimination")&&s.jsx("button",{onClick:()=>l("bracket"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="bracket"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Bracket"})]}),o==="pairings"&&s.jsx(eQe,{tournamentId:t,round:i.current_round,initialPairings:i.currentPairings,participants:i.participants,onUpdate:$,isPending:i.status==="pending",isOrganizer:se}),o==="standings"&&s.jsx(tQe,{participants:i.participants,tournamentId:t,currentUserId:r?.id,isOrganizer:se,onUpdate:$}),o==="bracket"&&s.jsx(rQe,{pairings:i.allPairings,participants:i.participants})]}),s.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[i.status==="pending"&&s.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx(aQe,{})," Add Player"]}),s.jsxs("form",{onSubmit:L,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"From Friends"}),s.jsxs("select",{value:m,onChange:q=>{g(q.target.value),v("")},className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none",children:[s.jsx("option",{value:"",children:"Select Friend..."}),w.map(q=>s.jsx("option",{value:q.id,children:q.username},q.id))]})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs font-bold",children:"- OR -"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"Guest Name"}),s.jsx("input",{type:"text",value:b,onChange:q=>{v(q.target.value),g("")},placeholder:"Enter Name...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none"})]}),s.jsx("button",{type:"submit",disabled:!m&&!b,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 text-white font-bold rounded-lg text-sm transition-colors disabled:opacity-50",children:"Add Participant"})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Players"}),s.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:i.participants&&i.participants.length>0?i.participants.map((q,U)=>s.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400 flex-shrink-0",children:U+1}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-300 truncate",children:q.username||q.guest_name}),q.deck_snapshot&&s.jsx("span",{className:"text-xs text-blue-400 truncate",children:q.deck_snapshot.name})]})]}),s.jsxs("div",{className:"text-xs font-mono text-gray-500",children:[q.score,"pts"]})]},q.id)):s.jsx("div",{className:"text-center text-gray-500 text-sm py-4 italic",children:"No players yet."})})]})]})]}),s.jsx(Yee,{isOpen:B.isOpen,onClose:()=>S({...B,isOpen:!1}),onConfirm:J,title:B.title,message:B.message}),s.jsx(sQe,{isOpen:_,onClose:()=>E(!1),tournamentName:i.name,winnerName:I?.username||I?.guest_name,stats:I}),T&&s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl max-w-sm w-full p-6 border border-gray-700 relative shadow-2xl",children:[s.jsx("button",{onClick:()=>M(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2 text-center",children:"Join Tournament"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6 text-center",children:"Scan to join on your device"}),s.jsx("div",{className:"bg-white p-4 rounded-lg mx-auto w-fit mb-6",children:s.jsx(ik,{value:ee,size:200})}),s.jsxs("div",{className:"bg-gray-900 rounded p-3 flex items-center gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:ee,className:"bg-transparent text-gray-400 text-xs w-full outline-none"}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(ee),className:"text-blue-400 hover:text-white text-xs font-bold",children:"COPY"})]})]})})]})},aQe=()=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),s.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),s.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]}),UW=()=>{const{id:t}=yl(),[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(!1);xn(),y.useEffect(()=>{t||l()},[t]);const l=async()=>{try{const c=await Ge.get("/api/tournaments");r(c||[])}catch(c){console.error("Failed to fetch tournaments",c)}finally{i(!1)}};return t?s.jsx(iQe,{}):n?s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Arena..."}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Ro,{className:"w-8 h-8 text-yellow-500"}),"The Arena"]}),s.jsx("p",{className:"text-gray-400 mt-1",children:"Organize tournaments and track competitive standings."})]}),s.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors",children:[s.jsx(C2e,{className:"w-5 h-5"}),"New Tournament"]})]}),e.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(Ro,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments Yet"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"Create your first event to start tracking games!"}),s.jsx("button",{onClick:()=>o(!0),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Create Event"})]}):s.jsx(Uae,{tournaments:e}),s.jsx(zae,{isOpen:a,onClose:()=>o(!1)})]})},oQe=()=>{const{id:t}=yl(),e=xn(),{user:r}=Or(),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState(""),[u,h]=y.useState(!0),[p,m]=y.useState(!1),[g,b]=y.useState(null);y.useEffect(()=>{v()},[t]);const v=async()=>{try{const[j,_]=await Promise.all([Ge.get(`/api/tournaments/${t}`),Ge.get("/api/decks")]);i(j.data),o(_.data)}catch{b("Failed to load tournament info.")}finally{h(!1)}},w=async()=>{m(!0);try{await Ge.post(`/api/tournaments/${t}/join`,{deckId:l||null}),e(`/tournaments/${t}`)}catch(j){alert(j.response?.data?.error||"Failed to join tournament"),m(!1)}};return u?s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading..."}):g?s.jsx("div",{className:"p-8 text-center text-red-500",children:g}):s.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-gray-800 rounded-xl border border-gray-700 shadow-2xl",children:[s.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:n.name}),s.jsxs("p",{className:"text-gray-400 mb-6",children:["Format: ",s.jsx("span",{className:"capitalize text-blue-400",children:n.format})]}),n.status!=="pending"?s.jsxs("div",{className:"text-center py-6 bg-gray-900/50 rounded-lg border border-red-500/30",children:[s.jsx("p",{className:"text-red-400",children:"This tournament is already active or completed."}),s.jsx("button",{onClick:()=>e(`/tournaments/${t}`),className:"mt-4 text-blue-400 hover:text-blue-300",children:"View Tournament"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Deck (Optional)"}),s.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"No Deck / Decide Later"}),a.map(j=>s.jsxs("option",{value:j.id,children:[j.name," (",j.format||"Standard",")"]},j.id))]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Selecting a deck locks in your list for this tournament."})]}),s.jsx("button",{onClick:w,disabled:p,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all flex items-center justify-center gap-2",children:p?"Joining...":"Join Tournament"})]})]})},_o=[];for(let t=0;t<256;++t)_o.push((t+256).toString(16).slice(1));function lQe(t,e=0){return(_o[t[e+0]]+_o[t[e+1]]+_o[t[e+2]]+_o[t[e+3]]+"-"+_o[t[e+4]]+_o[t[e+5]]+"-"+_o[t[e+6]]+_o[t[e+7]]+"-"+_o[t[e+8]]+_o[t[e+9]]+"-"+_o[t[e+10]]+_o[t[e+11]]+_o[t[e+12]]+_o[t[e+13]]+_o[t[e+14]]+_o[t[e+15]]).toLowerCase()}let N6;const cQe=new Uint8Array(16);function uQe(){if(!N6){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");N6=crypto.getRandomValues.bind(crypto)}return N6(cQe)}const dQe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),zW={randomUUID:dQe};function qy(t,e,r){if(zW.randomUUID&&!t)return zW.randomUUID();t=t||{};const n=t.random??t.rng?.()??uQe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lQe(n)}function qae(t){if(!t)return{};const e={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},r=t.match(/\{([^}]+)\}/g);return r&&r.forEach(n=>{const i=n.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(i)?e[i]++:isNaN(i)||(e.generic+=parseInt(i))}),e}function hQe(t,e){if(!e)return!0;const r=qae(e),n={...t};for(const a of["w","u","b","r","g","c"]){if(n[a]<r[a])return!1;n[a]-=r[a]}return Object.values(n).reduce((a,o)=>a+o,0)>=r.generic}function fQe(t,e){const r=qae(e),n={...t};["w","u","b","r","g","c"].forEach(o=>{n[o]-=r[o]});let i=r.generic;const a=["c","w","u","b","r","g"];for(const o of a){const l=Math.min(n[o],i);if(n[o]-=l,i-=l,i<=0)break}return n}const sv={zones:{library:[],hand:[],battlefield:[],graveyard:[],exile:[],command:[]},counters:{life:40,poison:0,commanderDamage:{},energy:0},turn:{count:1,phase:"Untap",landsPlayed:0},manaPool:{w:0,u:0,b:0,r:0,g:0,c:0},commanderTax:{},ui:{selectedIds:[],draggingId:null,error:null},past:[]},j6=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function Hl(t,e){const r=[...t.past||[],{...t,past:[]}].slice(-20);return{...e,past:r}}function pQe(t,e){return!e||e.includes("Instant")||e.includes("Creature")&&e.includes("Flash")?!0:t==="Main 1"||t==="Main 2"}function mQe(t,e){switch(e.type){case"UNDO":return!t.past||t.past.length===0?t:{...t.past[t.past.length-1],past:t.past.slice(0,-1)};case"LOAD_DECK":{const{mainboard:r,commander:n}=e.payload,i=r.map(o=>({...o,id:qy(),instanceId:qy(),tapped:!1,faceDown:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})),a=n?n.map(o=>({...o,id:qy(),instanceId:qy(),tapped:!1,faceDown:!1,isCommander:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})):[];return{...sv,zones:{...sv.zones,library:O5(i),command:a},commanderTax:a.reduce((o,l)=>({...o,[l.instanceId]:0}),{})}}case"DRAW_CARD":{const{count:r=1}=e.payload||{},n=[...t.zones.library],i=[...t.zones.hand];let a=null;for(let o=0;o<r;o++)if(n.length>0){const l=n.pop();l.faceDown=!1,i.push(l)}else a="Library is empty! You lose the game (if this were a real game).";return Hl(t,{...t,ui:{...t.ui,error:a},zones:{...t.zones,library:n,hand:i}})}case"MOVE_CARD":{const{cardId:r,fromZone:n,toZone:i,index:a,position:o}=e.payload,l=[...t.zones[n]],c=[...t.zones[i]],u=l.findIndex(v=>v.instanceId===r);if(u===-1)return t;const[h]=l.splice(u,1);let p=t.manaPool,m=t.turn.landsPlayed,g={...t.commanderTax};if((n==="hand"||n==="command")&&i==="battlefield"){const v=h.type_line&&h.type_line.includes("Land");if(!pQe(t.turn.phase,h.type_line))return{...t,ui:{...t.ui,error:`Can only play ${h.name} during your Main phase.`}};if(v){if(m>=1)return{...t,ui:{...t.ui,error:"Only one land per turn allowed."}};m++}else{let w=h.mana_cost;if(h.isCommander&&n==="command"){const j=g[h.instanceId]||0;j>0&&(w=`${w}{${j*2}}`)}if(!hQe(t.manaPool,w))return{...t,ui:{...t.ui,error:`Cannot afford ${h.name}. Cost: ${w}`}};p=fQe(t.manaPool,w),h.isCommander&&n==="command"&&(g[h.instanceId]=(g[h.instanceId]||0)+1)}}const b={...h,faceDown:i==="library",position:o||(i==="battlefield"?h.position:null),summoningSickness:i==="battlefield"&&h.type_line?.includes("Creature")?!0:h.summoningSickness};return typeof a=="number"?c.splice(a,0,b):c.push(b),Hl(t,{...t,manaPool:p,turn:{...t.turn,landsPlayed:m},commanderTax:g,ui:{...t.ui,error:null},zones:{...t.zones,[n]:l,[i]:c}})}case"TAP_CARD":{const{cardId:r,zone:n}=e.payload;let i=[];const a=t.zones[n].map(l=>{if(l.instanceId===r){if(l.summoningSickness&&l.type_line?.includes("Creature"))return l;const c=!l.tapped;if(c){if(l.produced_mana&&l.produced_mana.length>0)i.push(l.produced_mana[0].toLowerCase());else if(l.type_line&&l.type_line.includes("Land")){const u={Plains:"w",Island:"u",Swamp:"b",Mountain:"r",Forest:"g",Wastes:"c"};for(const[h,p]of Object.entries(u))if(l.type_line.includes(h)){i.push(p);break}}}return{...l,tapped:c}}return l}),o={...t.manaPool};return i.forEach(l=>{o[l]!==void 0&&o[l]++}),Hl(t,{...t,ui:{...t.ui,error:null},zones:{...t.zones,[n]:a},manaPool:o})}case"NEXT_PHASE":{let n=j6.indexOf(t.turn.phase)+1,i=t.turn.count,a=!1,o=t.turn.landsPlayed;n>=j6.length&&(n=0,i++,a=!0,o=0);const l=j6[n],c={w:0,u:0,b:0,r:0,g:0,c:0};let u=t.zones.battlefield;return(a||l==="Untap")&&(u=t.zones.battlefield.map(h=>({...h,tapped:!1,summoningSickness:!1}))),Hl(t,{...t,turn:{count:i,phase:l,landsPlayed:o},manaPool:c,ui:{...t.ui,error:null},zones:{...t.zones,battlefield:u}})}case"ADD_MANA":{const{color:r}=e.payload;return Hl(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]+1}})}case"SPEND_MANA":{const{color:r}=e.payload;return t.manaPool[r]<=0?t:Hl(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]-1}})}case"UNTAP_ALL":{const r=t.zones.battlefield.map(n=>({...n,tapped:!1}));return Hl(t,{...t,zones:{...t.zones,battlefield:r}})}case"SHUFFLE_LIBRARY":return Hl(t,{...t,zones:{...t.zones,library:O5([...t.zones.library])}});case"SET_LIFE":return Hl(t,{...t,counters:{...t.counters,life:e.payload}});case"MULLIGAN":{const r=t.zones.hand.map(o=>({...o,faceDown:!0,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}})),n=[...t.zones.library,...r],i=O5(n),a=[];for(let o=0;o<7;o++)if(i.length>0){const l=i.pop();l.faceDown=!1,a.push(l)}return Hl(t,{...t,turn:{...t.turn,landsPlayed:0},ui:{...t.ui,error:null},zones:{...t.zones,hand:a,library:i}})}case"RESTART_GAME":{const r=[...t.zones.hand,...t.zones.battlefield,...t.zones.graveyard,...t.zones.exile].map(a=>({...a,tapped:!1,faceDown:!0,counters:{p1p1:0,loyalty:0,other:0}})),n=O5([...t.zones.library,...r]),i=[];for(let a=0;a<7;a++)if(n.length>0){const o=n.pop();o.faceDown=!1,i.push(o)}return{...sv,zones:{...sv.zones,library:n,hand:i,battlefield:[],graveyard:[],exile:[],command:t.zones.command.map(a=>({...a,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}}))},commanderTax:t.zones.command.reduce((a,o)=>({...a,[o.instanceId]:0}),{})}}case"ADD_COUNTER":{const{cardId:r,zone:n,counterType:i,amount:a=1}=e.payload;return Hl(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[i]:(o.counters[i]||0)+a}}:o)}})}case"REMOVE_COUNTER":{const{cardId:r,zone:n,counterType:i,amount:a=1}=e.payload;return Hl(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[i]:Math.max(0,(o.counters[i]||0)-a)}}:o)}})}case"CREATE_TOKEN":{const{tokenData:r}=e.payload,n={...r,instanceId:qy(),tapped:!1,faceDown:!1,isToken:!0,counters:{p1p1:0,loyalty:0,other:0}};return Hl(t,{...t,zones:{...t.zones,battlefield:[...t.zones.battlefield,n]}})}case"SET_LIFE":return Hl(t,{...t,counters:{...t.counters,life:e.payload}});default:return t}}function O5(t){let e=t.length,r;for(;e!==0;)r=Math.floor(Math.random()*e),e--,[t[e],t[r]]=[t[r],t[e]];return t}function gQe(){const[t,e]=y.useReducer(mQe,sv),r=y.useCallback(E=>e({type:"LOAD_DECK",payload:E}),[]),n=y.useCallback((E=1)=>e({type:"DRAW_CARD",payload:{count:E}}),[]),i=y.useCallback((E,I,O,B,S)=>e({type:"MOVE_CARD",payload:{cardId:E,fromZone:I,toZone:O,index:B,position:S}}),[]),a=y.useCallback((E,I)=>e({type:"TAP_CARD",payload:{cardId:E,zone:I}}),[]),o=y.useCallback(()=>e({type:"UNTAP_ALL"}),[]),l=y.useCallback(()=>e({type:"SHUFFLE_LIBRARY"}),[]),c=y.useCallback(E=>e({type:"SET_LIFE",payload:E}),[]),u=y.useCallback(()=>e({type:"UNDO"}),[]),h=y.useCallback(()=>e({type:"MULLIGAN"}),[]),p=y.useCallback(()=>e({type:"RESTART_GAME"}),[]),m=y.useCallback(()=>e({type:"NEXT_PHASE"}),[]),g=y.useCallback(E=>e({type:"ADD_MANA",payload:{color:E}}),[]),b=y.useCallback(E=>e({type:"SPEND_MANA",payload:{color:E}}),[]),v=y.useCallback((E,I,O,B)=>e({type:"ADD_COUNTER",payload:{cardId:E,zone:I,counterType:O,amount:B}}),[]),w=y.useCallback((E,I,O,B)=>e({type:"REMOVE_COUNTER",payload:{cardId:E,zone:I,counterType:O,amount:B}}),[]),j=y.useCallback(E=>e({type:"CREATE_TOKEN",payload:{tokenData:E}}),[]),_=y.useMemo(()=>({loadDeck:r,drawCard:n,moveCard:i,tapCard:a,untapAll:o,shuffleLibrary:l,setLife:c,undo:u,mulligan:h,restartGame:p,nextPhase:m,addMana:g,spendMana:b,addCounter:v,removeCounter:w,createToken:j}),[r,n,i,a,o,l,c,u,h,p,m,g,b,v,w,j]);return{state:t,actions:_}}const Vae=y.createContext(null);function xQe({children:t}){const e=gQe();return s.jsx(Vae.Provider,{value:e,children:t})}function C_(){const t=y.useContext(Vae);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function bQe({x:t,y:e,onClose:r,actions:n,card:i,zoneId:a}){const o=y.useRef(null);y.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&r()};return window.addEventListener("mousedown",c),()=>window.removeEventListener("mousedown",c)},[r]);const l=c=>{c(),r()};return s.jsxs("div",{ref:o,className:"fixed z-[100] bg-gray-900/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl py-2 min-w-[180px] overflow-hidden",style:{left:t,top:e},children:[s.jsxs("div",{className:"px-4 py-1.5 border-b border-white/5 mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest leading-none",children:"Card Actions"}),s.jsx("div",{className:"text-white text-xs font-bold truncate",children:i.name})]}),s.jsx(Vy,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"graveyard")),label:"Destroy / Discard",icon:s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),s.jsx(Vy,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"exile")),label:"Exile",icon:s.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx(Vy,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"library",0)),label:"Put on Top",icon:s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 11l7-7 7 7M5 19l7-7 7 7"})})}),s.jsx(Vy,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"hand")),label:"Return to Hand",icon:s.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),s.jsx("div",{className:"h-px bg-white/5 my-1"}),s.jsx("div",{className:"px-4 py-1 text-[8px] font-bold text-gray-500 uppercase tracking-widest",children:"Counters"}),s.jsxs("div",{className:"flex px-2 pb-1 gap-1",children:[s.jsx(qW,{label:"+1/+1",onAdd:()=>n.addCounter(i.instanceId,a,"p1p1",1),onSub:()=>n.removeCounter(i.instanceId,a,"p1p1",1)}),s.jsx(qW,{label:"Loyalty",onAdd:()=>n.addCounter(i.instanceId,a,"loyalty",1),onSub:()=>n.removeCounter(i.instanceId,a,"loyalty",1)})]}),s.jsx("div",{className:"h-px bg-white/5 my-1"}),s.jsx(Vy,{onClick:()=>l(()=>n.tapCard(i.instanceId,a)),label:i.tapped?"Untap":"Tap",icon:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}function Vy({onClick:t,label:e,icon:r}){return s.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-2 text-xs font-bold text-gray-400 hover:text-white hover:bg-white/5 transition-all text-left group",children:[s.jsx("span",{className:"opacity-70 group-hover:opacity-100 transition-opacity",children:r}),s.jsx("span",{children:e})]})}function qW({label:t,onAdd:e,onSub:r}){return s.jsxs("div",{className:"flex-1 flex flex-col items-center bg-white/5 rounded-lg py-1 px-2 border border-white/5",children:[s.jsx("span",{className:"text-[8px] text-gray-500 mb-1",children:t}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-red-500 text-[10px] p-1 font-black",children:""}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-emerald-500 text-[10px] p-1 font-black",children:""})]})]})}function yQe(t,e){if(!e)return!0;const r={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},n=e.match(/\{([^}]+)\}/g);if(!n)return!0;n.forEach(o=>{const l=o.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(l)?r[l]++:isNaN(l)||(r.generic+=parseInt(l))});const i={...t};for(const o of["w","u","b","r","g","c"]){if(i[o]<r[o])return!1;i[o]-=r[o]}return Object.values(i).reduce((o,l)=>o+l,0)>=r.generic}const ux=y.memo(function({card:e,zoneId:r,isOverlay:n=!1,size:i="md"}){const{state:a,actions:o}=C_(),[l,c]=y.useState(null),u=r==="hand"||n&&e.fromZone==="hand",h=e.type_line&&e.type_line.includes("Land"),p=y.useMemo(()=>u&&!h&&yQe(a.manaPool,e.mana_cost),[u,h,a.manaPool,e.mana_cost]),m=y.useMemo(()=>u&&h&&a.turn.landsPlayed<1,[u,h,a.turn.landsPlayed]),{attributes:g,listeners:b,setNodeRef:v,transform:w,isDragging:j}=DJ({id:e.instanceId,data:{card:e,fromZone:r},disabled:n}),_=w?{transform:`translate3d(${w.x}px, ${w.y}px, 0)`,zIndex:1e3,willChange:"transform"}:{willChange:"transform"},E=T=>{T.preventDefault(),c({x:T.clientX,y:T.clientY})},I=T=>{j||o.tapCard(e.instanceId,r)},O={sm:"w-32 h-44 rounded-xl",md:"w-40 h-56 rounded-[1.5rem]",lg:"w-48 h-64 rounded-[2rem]",tactical:"w-44 h-60 rounded-2xl"},B=i||(r==="battlefield"?"tactical":r==="hand"?"md":"sm"),S=e.tapped?"rotate-90 translate-x-8":"";return s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:n?null:v,style:_,...n?{}:b,...n?{}:g,onClick:n?void 0:I,onContextMenu:n?void 0:E,className:`
                    relative ${O[B]} bg-gray-900 border-2 transition-all duration-300
                    ${n?"border-indigo-500 shadow-2xl scale-110":"border-white/10 shadow-lg"}
                    ${e.isToken?"border-dashed border-emerald-500/50":""}
                    ${(p||m)&&!j?"ring-4 ring-emerald-500/30":""}
                    hover:border-indigo-500/50 hover:shadow-indigo-500/40 hover:scale-[1.05] 
                    cursor-grab active:cursor-grabbing group z-[10] hover:z-[50]
                    ${S}
                    ${j?"opacity-0":"opacity-100"}
                `,children:[s.jsx(vQe,{card:e,isOverlay:n,size:B,zoneId:r}),(p||m)&&!j&&s.jsx("div",{className:"absolute inset-0 rounded-inherit bg-emerald-500/5 animate-pulse pointer-events-none"})]}),l&&s.jsx(bQe,{x:l.x,y:l.y,onClose:()=>c(null),actions:o,card:e,zoneId:r})]})}),vQe=y.memo(function({card:e,isOverlay:r,size:n,zoneId:i}){const{state:a}=C_(),o=e.counters?.p1p1||0,l=e.counters?.loyalty||0;e.counters?.other;const c=e.power!==void 0&&e.toughness!==void 0,{currentPower:u,currentToughness:h}=y.useMemo(()=>{const m=parseInt(e.power),g=parseInt(e.toughness);return{currentPower:c?isNaN(m)?e.power:m+o:null,currentToughness:c?isNaN(g)?e.toughness:g+o:null}},[e.power,e.toughness,c,o]),p=n==="lg"||n==="tactical"||n==="md";return s.jsxs("div",{className:"w-full h-full relative pointer-events-none select-none overflow-hidden rounded-inherit",children:[e.faceDown?s.jsxs("div",{className:"w-full h-full bg-indigo-950 rounded-inherit flex items-center justify-center border-4 border-white/5 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20"}),s.jsx("div",{className:`${p?"w-24 h-24":"w-16 h-16"} rounded-full border-2 border-white/20 bg-indigo-900/30 backdrop-blur-md flex items-center justify-center shadow-2xl`,children:s.jsx("div",{className:`${p?"w-16 h-16":"w-10 h-10"} rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 opacity-50 blur-sm animate-pulse`})})]}):s.jsxs("div",{className:"w-full h-full overflow-hidden rounded-inherit relative bg-gray-950 flex flex-col",children:[e.image_uri?s.jsx("img",{src:e.image_uri,alt:e.name,loading:"lazy",onError:m=>{m.target.onerror=null,m.target.src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/card-back.svg",m.target.style.opacity=.5},className:"w-full h-full object-cover select-none pointer-events-none"}):s.jsxs("div",{className:"p-4 text-xs text-gray-400 font-bold uppercase tracking-tighter bg-gray-900 h-full flex flex-col items-center justify-center text-center",children:[s.jsx("span",{className:"text-white text-sm mb-1",children:e.name}),e.type_line&&s.jsx("span",{className:"opacity-50 text-[10px] leading-tight",children:e.type_line})]}),e.isToken&&s.jsx("div",{className:`absolute top-0 right-0 bg-emerald-600 ${p?"text-[10px] px-3 py-1":"text-[8px] px-2 py-0.5"} font-black text-white rounded-bl-xl shadow-md uppercase tracking-widest z-20 border-l border-b border-white/10`,children:"Token"}),s.jsxs("div",{className:"absolute bottom-2 right-2 flex flex-col gap-2 z-30",children:[e.tapped&&s.jsx("div",{className:`${p?"w-8 h-8":"w-6 h-6"} rounded-full bg-amber-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:s.jsx("svg",{className:`${p?"w-5 h-5":"w-4 h-4"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M4.555 13.791L14.17 9.852l-1.474-3.56L3.081 10.23l1.474 3.561z"})})}),e.summoningSickness&&e.type_line?.includes("Creature")&&s.jsx("div",{className:`${p?"w-8 h-8":"w-6 h-6"} rounded-full bg-indigo-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:s.jsx("span",{className:`${p?"text-sm":"text-xs"} font-black text-white italic`,children:"zZz"})})]}),c&&s.jsx("div",{className:`absolute ${p?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:s.jsxs("div",{className:`bg-black/80 backdrop-blur-xl border-2 border-white/20 rounded-xl ${p?"px-3 py-1.5 gap-2":"px-2 py-1 gap-1"} flex items-center shadow-2xl transition-transform group-hover:scale-110`,children:[s.jsx("span",{className:`${p?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:u}),s.jsx("span",{className:"text-gray-500 font-black",children:"/"}),s.jsx("span",{className:`${p?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:h})]})}),e.type_line?.includes("Planeswalker")&&s.jsx("div",{className:`absolute ${p?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:s.jsxs("div",{className:`bg-orange-600/90 backdrop-blur-xl border-2 border-white/20 rounded-xl ${p?"px-3 py-1 gap-2":"px-2 py-0.5 gap-1"} flex items-center shadow-2xl`,children:[s.jsx("svg",{className:`${p?"w-5 h-5":"w-3 h-3"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M10 2l-7 7 7 7 7-7-7-7z"})}),s.jsx("span",{className:`${p?"text-xl":"text-base"} font-black text-white italic tracking-tighter`,children:l||e.loyalty})]})}),s.jsxs("div",{className:`absolute ${p?"top-2 left-2 gap-2":"top-1 left-1 gap-1"} flex flex-col z-30 pointer-events-none`,children:[o!==0&&s.jsxs("div",{className:`bg-indigo-600 text-white rounded-xl ${p?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2 animate-in slide-in-from-left-4 duration-300`,children:[s.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Counters"}),s.jsx("span",{className:p?"text-sm":"text-xs",children:o>0?`+${o}`:o})]}),e.isCommander&&i==="command"&&s.jsxs("div",{className:`bg-red-600 text-white rounded-xl ${p?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2`,children:[s.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Tax"}),s.jsxs("span",{className:p?"text-sm":"text-xs",children:["+",(a.commanderTax?.[e.instanceId]||0)*2]})]})]})]}),!r&&!e.faceDown&&s.jsx("div",{className:"absolute inset-0 bg-indigo-500/0 group-hover:bg-indigo-500/5 transition-colors pointer-events-none rounded-inherit"})]})}),Hg=y.memo(function({id:e,cards:r,title:n,className:i="",layout:a="grid",onCardClick:o}){const{isOver:l,setNodeRef:c}=$J({id:e}),u={opacity:l?.9:1};return s.jsxs("div",{ref:c,className:`relative rounded-2xl transition-all ${i} ${l?"ring-2 ring-emerald-500/50 bg-emerald-500/5":""}`,style:u,children:[s.jsx("div",{className:"absolute -top-3 left-4 bg-gray-950 px-2 text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] z-10 border border-white/5 rounded-full",children:n}),s.jsxs("div",{className:`w-full h-full p-4 ${a==="spread"?"flex items-center gap-[-4rem]":""} ${a==="stacked"?"relative flex items-center justify-center":""}`,children:[a==="stacked"&&s.jsxs("div",{className:"relative w-36 h-52",children:[r.slice(-3).map((h,p)=>s.jsx("div",{className:"absolute inset-0 transition-transform",style:{transform:`translate(${p*2}px, ${p*2}px)`,zIndex:p},children:s.jsx(ux,{card:h,zoneId:e})},h.instanceId)),r.length===0&&s.jsx("div",{className:"w-full h-full border-2 border-dashed border-white/5 rounded-xl flex items-center justify-center text-[10px] font-black text-gray-800 uppercase tracking-widest",children:"Empty"})]}),a==="spread"&&s.jsx("div",{className:"flex -space-x-24 hover:-space-x-12 transition-all duration-500 py-8 px-12 overflow-x-auto no-scrollbar",children:r.map(h=>s.jsx("div",{className:"shrink-0 first:ml-0 transition-transform hover:-translate-y-8 hover:z-50",children:s.jsx(ux,{card:h,zoneId:e})},h.instanceId))}),(a==="grid"||a==="free")&&s.jsx("div",{className:`w-full h-full ${a==="free"?"relative":"flex flex-wrap gap-12"}`,children:r.map((h,p)=>a==="free"&&h.position?s.jsx("div",{className:"absolute transition-shadow active:z-[1000]",style:{left:h.position.x,top:h.position.y,zIndex:10+p},children:s.jsx(ux,{card:h,zoneId:e})},h.instanceId):s.jsx("div",{className:a==="free"?"absolute":"",style:a==="free"?{left:p%4*200,top:Math.floor(p/4)*280}:{},children:s.jsx(ux,{card:h,zoneId:e})},h.instanceId))}),r.length===0&&a!=="stacked"&&s.jsxs("div",{className:"w-full h-full flex items-center justify-center text-gray-800 text-xs font-black uppercase tracking-[0.3em] select-none opacity-20",children:[n," Void"]})]})]})}),wQe=y.memo(function({state:e,onCardClick:r}){const{zones:n}=e;return s.jsxs("div",{className:"flex flex-col h-full gap-4 p-4 bg-[radial-gradient(circle_at_50%_-20%,_#1e1b4b_0%,_#020617_100%)] rounded-3xl border border-white/5 shadow-inner relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10 pointer-events-none"}),s.jsxs("div",{className:"flex h-56 gap-6 shrink-0 z-10",children:[s.jsx(Hg,{id:"command",cards:n.command,title:"Command Zone",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r}),s.jsx(Hg,{id:"exile",cards:n.exile,title:"Exile",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r})]}),s.jsxs("div",{className:"flex-grow bg-emerald-500/5 rounded-3xl border-2 border-dashed border-emerald-500/10 p-6 relative min-h-[400px] shadow-inner group",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none group-hover:opacity-[0.05] transition-opacity",children:s.jsx("span",{className:"text-[200px] font-black uppercase tracking-tighter rotate-[-15deg]",children:"Battlefield"})}),s.jsx(Hg,{id:"battlefield",cards:n.battlefield,title:"Battlefield",className:"h-full w-full border-none",layout:"free",onCardClick:r})]}),s.jsxs("div",{className:"h-72 flex gap-6 shrink-0 z-10",children:[s.jsx("div",{className:"flex-grow bg-white/5 backdrop-blur-md rounded-2xl border border-white/10 p-4 shadow-xl",children:s.jsx(Hg,{id:"hand",cards:n.hand,title:"Hand",layout:"spread",className:"h-full w-full border-none",onCardClick:r})}),s.jsxs("div",{className:"w-80 flex gap-4",children:[s.jsx(Hg,{id:"library",cards:n.library,title:`Library (${n.library.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r}),s.jsx(Hg,{id:"graveyard",cards:n.graveyard,title:`Graveyard (${n.graveyard.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r})]})]})]})}),VW=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function NQe({currentPhase:t,turnCount:e,landsPlayed:r,onNextPhase:n}){return s.jsxs("div",{className:"flex items-center bg-gray-900/80 backdrop-blur-md rounded-2xl border border-white/10 px-4 py-2 shadow-2xl relative overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500/5 via-purple-500/5 to-pink-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),s.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[s.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Turn"}),s.jsx("span",{className:"text-xl font-black text-white italic leading-none",children:e})]}),s.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Lands"}),s.jsxs("span",{className:`text-xl font-black italic leading-none ${r>=1?"text-amber-500":"text-emerald-400"}`,children:[r,"/1"]})]}),s.jsx("div",{className:"flex items-center gap-1 md:gap-2",children:VW.map((i,a)=>{const o=t===i,l=VW.indexOf(t)>a;return s.jsxs("div",{className:`flex flex-col items-center transition-all duration-300 ${o?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`h-1.5 w-8 md:w-12 rounded-full mb-2 transition-all duration-500 ${o?"bg-gradient-to-r from-indigo-500 to-purple-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]":l?"bg-indigo-900/40":"bg-gray-800"}`}),s.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest ${o?"text-indigo-400":"text-gray-500"}`,children:i})]},i)})}),s.jsx("button",{onClick:n,className:"ml-2 w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/20 transition-all hover:scale-110 active:scale-95 group/btn",title:"Next Phase (Space)",children:s.jsx("svg",{className:"w-5 h-5 transition-transform group-hover/btn:translate-x-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 5l7 7-7 7"})})})]})]})}const jQe=[{name:"Soldier",power:1,toughness:1,color:"W",type:"Token Creature  Soldier"},{name:"Zombie",power:2,toughness:2,color:"B",type:"Token Creature  Zombie"},{name:"Knight",power:2,toughness:2,color:"W",type:"Token Creature  Knight",keywords:["Vigilance"]},{name:"Spirit",power:1,toughness:1,color:"U",type:"Token Creature  Spirit",keywords:["Flying"]},{name:"Goblin",power:1,toughness:1,color:"R",type:"Token Creature  Goblin"},{name:"Beast",power:3,toughness:3,color:"G",type:"Token Creature  Beast"},{name:"Treasure",power:0,toughness:0,color:"C",type:"Token Artifact  Treasure",text:"T, Sacrifice this artifact: Add one mana of any color."},{name:"Clue",power:0,toughness:0,color:"C",type:"Token Artifact  Clue",text:"2, Sacrifice this artifact: Draw a card."},{name:"Food",power:0,toughness:0,color:"C",type:"Token Artifact  Food",text:"2, T, Sacrifice this artifact: You gain 3 life."}];function kQe({isOpen:t,onClose:e,onCreateToken:r}){const[n,i]=y.useState({name:"",power:0,toughness:0,type:"Token Creature",color:"C"});return t?s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-white/5",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Generator Engine"}),s.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-widest",children:"Create Tokens & Emblems"})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl text-gray-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Common Presets"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:jQe.map(a=>s.jsxs("button",{onClick:()=>r(a),className:"flex flex-col items-start p-4 bg-white/5 border border-white/5 hover:border-indigo-500/50 hover:bg-indigo-500/5 rounded-2xl transition-all group",children:[s.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-black/40 border border-white/10 flex items-center justify-center text-[10px] font-black group-hover:scale-110 transition-transform",children:a.color}),a.power>0&&s.jsxs("span",{className:"text-xs font-black text-gray-400 group-hover:text-white transition-colors",children:[a.power,"/",a.toughness]})]}),s.jsx("span",{className:"text-sm font-bold text-white mb-1",children:a.name}),s.jsx("span",{className:"text-[10px] text-gray-500 truncate w-full text-left italic",children:a.type})]},a.name))})]}),s.jsxs("section",{className:"bg-white/5 p-6 rounded-3xl border border-white/5",children:[s.jsx("h3",{className:"text-xs font-black text-emerald-400 uppercase tracking-widest mb-4",children:"Manual Synthesis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Identifier"}),s.jsx("input",{type:"text",value:n.name,onChange:a=>i({...n,name:a.target.value}),placeholder:"Token Name...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Power"}),s.jsx("input",{type:"number",value:n.power,onChange:a=>i({...n,power:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Toughness"}),s.jsx("input",{type:"number",value:n.toughness,onChange:a=>i({...n,toughness:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Type Line"}),s.jsx("input",{type:"text",value:n.type,onChange:a=>i({...n,type:a.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsx("button",{onClick:()=>r(n),disabled:!n.name,className:"w-full bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 text-white font-black uppercase tracking-widest py-3 rounded-2xl shadow-xl shadow-emerald-900/20 transition-all active:scale-95",children:"Synthesize Token"})]})]})]})]})]})]}):null}function _Qe({isOpen:t,zoneId:e,onClose:r}){const{state:n,actions:i}=C_();if(!t||!e)return null;const a=n.zones[e]||[];return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:r}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-[3rem] shadow-2xl w-full max-w-6xl overflow-hidden flex flex-col max-h-[85vh]",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 flex items-center justify-between bg-white/5",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-2xl bg-indigo-600 flex items-center justify-center text-white shadow-lg",children:s.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic",children:["Inspecting ",e]}),s.jsxs("p",{className:"text-gray-500 text-xs font-black uppercase tracking-widest",children:[a.length," Objects Detected"]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[e==="library"&&s.jsx("button",{onClick:()=>i.shuffleLibrary(),className:"px-6 py-3 bg-white/5 hover:bg-white/10 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all border border-white/10",children:"Shuffle Library"}),s.jsx("button",{onClick:r,className:"p-3 hover:bg-white/10 rounded-2xl text-gray-400 transition-colors",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-grow overflow-y-auto p-12 bg-black/20",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-x-8 gap-y-12",children:a.map((o,l)=>s.jsxs("div",{className:"flex flex-col items-center gap-4 group",children:[s.jsx("div",{className:"transform transition-all group-hover:scale-110 group-hover:-translate-y-2",children:s.jsx(ux,{card:{...o,faceDown:!1},zoneId:e})}),s.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0",children:[s.jsx("button",{onClick:()=>i.moveCard(o.instanceId,e,"hand"),className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Move to Hand",children:"Hand"}),s.jsx("button",{onClick:()=>i.moveCard(o.instanceId,e,"battlefield"),className:"bg-emerald-600 hover:bg-emerald-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Play Directly",children:"Play"})]})]},o.instanceId))})})]})]})}function SQe(){return s.jsx(xQe,{children:s.jsx(CQe,{})})}function CQe(){const{deckId:t}=yl();xn();const{state:e,actions:r}=C_(),{deck:n,cards:i,loading:a}=HL(t),[o,l]=y.useState(!1),[c,u]=y.useState(null),[h,p]=y.useState(!1),[m,g]=y.useState(null),[b,v]=y.useState({x:32,y:120,isMinimized:!1,isVisible:!0}),[w,j]=y.useState({x:window.innerWidth-240,y:window.innerHeight-300,isMinimized:!1,isVisible:!0}),[_,E]=y.useState({x:window.innerWidth/2-250,y:20,isMinimized:!1,isVisible:!0}),I=Gx(TJ,{activationConstraint:{distance:8}}),O=Gx(IJ,{activationConstraint:{delay:250,tolerance:5}}),B=sL(I,O);y.useEffect(()=>{!a&&n&&i&&!o&&(r.loadDeck({mainboard:i,commander:i.filter(k=>{const L=n.commander&&k.scryfall_id===(n.commander.id||n.commander.scryfall_id),R=n.commander_partner&&k.scryfall_id===(n.commander_partner.id||n.commander_partner.scryfall_id);return L||R})}),l(!0))},[a,n,i,o,r]);const S=a||!o;y.useEffect(()=>{const k=L=>{if(!(L.target.tagName==="INPUT"||L.target.tagName==="TEXTAREA"))switch(L.key.toLowerCase()){case"d":r.drawCard();break;case" ":L.preventDefault(),r.nextPhase();break;case"u":r.untapAll();break;case"m":window.confirm("Mulligan hand?")&&r.mulligan();break;case"r":(L.ctrlKey||L.metaKey||window.confirm("Restart game?"))&&r.restartGame();break;case"s":r.shuffleLibrary();break}};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[r]);const T=y.useCallback(k=>{const{active:L}=k;u(L.data.current?.card)},[]),M=y.useCallback(k=>{const{active:L,over:R}=k;if(u(null),!R)return;const V=L.id,Y=L.data.current?.fromZone,X=R.id;let J=null;if(X==="battlefield"){const re=R.rect,se=L.rect.current.translated;re&&se&&(J={x:se.left-re.left,y:se.top-re.top})}(Y!==X||J)&&r.moveCard(V,Y,X,0,J)},[r]),$=y.useCallback(k=>r.tapCard(k.instanceId,k.zoneId),[r]);return s.jsxs("div",{className:"h-screen bg-gray-950 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center px-6 justify-between bg-black/40 backdrop-blur-xl shrink-0 z-40 relative",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs font-black text-indigo-500 uppercase tracking-widest",children:"Solitaire"}),s.jsx("span",{className:"text-sm font-bold text-white truncate max-w-[200px]",children:n?.name||"Loading..."})]}),s.jsx("div",{className:"h-8 w-px bg-white/10"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(k6,{active:_.isVisible,onClick:()=>E(k=>({...k,isVisible:!k.isVisible})),label:"Phase"}),s.jsx(k6,{active:b.isVisible,onClick:()=>v(k=>({...k,isVisible:!k.isVisible})),label:"Mana"}),s.jsx(k6,{active:w.isVisible,onClick:()=>j(k=>({...k,isVisible:!k.isVisible})),label:"Vitality"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})}),"Token"]}),s.jsx("button",{onClick:()=>g("library"),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Library"}),s.jsx("button",{onClick:()=>g("graveyard"),className:"px-4 py-2 bg-gray-500/10 hover:bg-gray-500/20 text-gray-400 border border-gray-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Graveyard"}),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("button",{onClick:()=>r.untapAll(),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Untap (U)"}),s.jsx("button",{onClick:()=>r.drawCard(),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Draw (D)"}),s.jsx("button",{onClick:()=>{window.confirm("Restart game?")&&r.restartGame()},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Restart"})]})]}),s.jsxs("div",{className:"flex-grow p-4 overflow-hidden relative select-none",children:[S?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-indigo-400 font-black uppercase tracking-widest animate-pulse",children:"Initializing Board..."})]})}):s.jsxs(lL,{sensors:B,onDragStart:T,onDragEnd:M,children:[s.jsx(wQe,{state:e,onCardClick:$}),Vn.createPortal(s.jsx(cL,{dropAnimation:null,children:c?s.jsx("div",{className:"scale-110 rotate-3 transition-transform",children:s.jsx(ux,{card:c,zoneId:"overlay",isOverlay:!0})}):null}),document.body)]}),s.jsx(_6,{title:"Phase Bar",pos:_,setPos:E,isVisible:_.isVisible,children:s.jsx(NQe,{currentPhase:e.turn.phase,turnCount:e.turn.count,landsPlayed:e.turn.landsPlayed,onNextPhase:()=>r.nextPhase()})}),s.jsx(_6,{title:"Mana Pool",pos:b,setPos:v,isVisible:b.isVisible,icon:s.jsxs("div",{className:"flex gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse delay-75"})]}),children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.manaPool).map(([k,L])=>s.jsxs("div",{className:"flex flex-col items-center group",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 border-white/5 bg-black/40 shadow-xl overflow-hidden transition-transform group-hover:scale-110 mb-2",children:s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${k.toUpperCase()}.svg`,alt:k,className:"w-8 h-8 object-contain active:scale-95 transition-transform cursor-pointer",onClick:()=>r.addMana(k)})}),s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 rounded-full bg-indigo-600 border-2 border-gray-950 flex items-center justify-center text-[10px] font-black text-white shadow-lg",children:L})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx("button",{onClick:()=>r.spendMana(k),className:"text-gray-600 hover:text-red-500 p-1",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})})})]},k))})}),s.jsx(_6,{title:"Vitality",pos:w,setPos:j,isVisible:w.isVisible,children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("div",{className:"text-6xl font-black text-white italic tracking-tighter drop-shadow-2xl",children:e.counters.life}),s.jsxs("div",{className:"flex gap-4 mt-2",children:[s.jsx("button",{onClick:()=>r.setLife(e.counters.life-1),className:"w-10 h-10 rounded-xl bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 flex items-center justify-center transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})}),s.jsx("button",{onClick:()=>r.setLife(e.counters.life+1),className:"w-10 h-10 rounded-xl bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 flex items-center justify-center transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})})]})]})}),e.ui.error&&s.jsx("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-top-4 duration-300",children:s.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border-2 border-white/20",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:e.ui.error})]})})]}),s.jsxs("div",{className:"h-10 bg-black/60 text-[10px] font-black uppercase tracking-[0.2em] text-gray-600 flex items-center px-8 border-t border-white/5 shrink-0 gap-6 z-40",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>r.undo(),disabled:e.past.length===0,className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${e.past.length>0?"bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/20":"bg-gray-800 text-gray-600 border border-gray-700 cursor-not-allowed opacity-50"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),s.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Undo"})]}),s.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-md px-6 py-2 rounded-xl border border-white/5 flex items-center gap-8 text-[10px] font-black uppercase tracking-[0.2em] text-gray-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"})," [1-7] Draw X"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"})," Space: Next Phase"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-pink-500"})," U: Untap All"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"})," S: Shuffle"]})]})]}),s.jsx("div",{className:"flex-grow"}),s.jsx("span",{className:"text-indigo-500/50",children:"Antigravity Solitaire Engine v2.0"})]}),s.jsx(kQe,{isOpen:h,onClose:()=>p(!1),onCreateToken:k=>{r.createToken(k),p(!1)}}),s.jsx(_Qe,{isOpen:!!m,zoneId:m,onClose:()=>g(null)})]})}function k6({active:t,onClick:e,label:r}){return s.jsx("button",{onClick:e,className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border transition-all ${t?"bg-indigo-500/20 text-indigo-400 border-indigo-500/50":"bg-gray-800/40 text-gray-600 border-white/5"}`,children:r})}function _6({title:t,pos:e,setPos:r,children:n,icon:i,isVisible:a}){const o=y.useRef(!1),l=y.useRef({x:0,y:0}),c=u=>{u.target.closest("button")||(o.current=!0,l.current={x:u.clientX-e.x,y:u.clientY-e.y},u.preventDefault())};return y.useEffect(()=>{const u=p=>{o.current&&r(m=>({...m,x:p.clientX-l.current.x,y:p.clientY-l.current.y}))},h=()=>o.current=!1;return window.addEventListener("mousemove",u),window.addEventListener("mouseup",h),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",h)}},[r]),a?s.jsxs("div",{className:`absolute bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl p-6 flex flex-col shadow-[0_32px_64px_-16px_rgba(0,0,0,0.5)] z-50 transition-all duration-300 ${e.isMinimized?"w-16 h-16 p-2 rounded-2xl items-center justify-center":""}`,style:{transform:`translate3d(${e.x}px, ${e.y}px, 0)`,top:0,left:0,cursor:o.current?"grabbing":"grab"},onMouseDown:c,children:[s.jsxs("div",{className:`flex items-center justify-between mb-4 select-none ${e.isMinimized?"hidden":""}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em]",children:t}),i]}),s.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!u.isMinimized})),className:"p-1 hover:bg-white/10 rounded-lg text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})})]}),e.isMinimized?s.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!1})),className:"w-12 h-12 flex items-center justify-center bg-indigo-600/20 text-indigo-400 rounded-xl hover:bg-indigo-600/40 transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}):n]}):null}const EQe=()=>{const{userProfile:t}=Or(),[e,r]=y.useState(!1),[n,i]=y.useState(!1),a=t?.settings?.helper,o=a?.name||"MTG Forge",[l,c]=y.useState([]),[u,h]=y.useState(""),[p,m]=y.useState(!1),[g,b]=y.useState(!1),v=y.useRef(null),w=()=>{v.current?.scrollIntoView({behavior:"smooth"})};y.useEffect(()=>{w()},[l]),y.useEffect(()=>{const T=()=>{r(!0)};return window.addEventListener("open-chat-widget",T),()=>window.removeEventListener("open-chat-widget",T)},[]),y.useEffect(()=>{if(!e)return;(async()=>{const M=t?.settings?.geminiApiKey;if(!M||g){!M&&l.length===0&&c([{role:"model",content:'<p class="text-gray-300">Please add your Gemini API Key in Settings to enable the chat.</p>'}]);return}if(b(!0),!(l.length>0))try{const $=`
                    You are about to have a conversation with a user.
                    your name is ${o}.
                    Your personality is: ${a?.personality||"Knowledgeable and friendly"}.
                    It is not their first time working with you, interact with them appropriately.
                    Use emojis. 
                `,k=await ul.sendMessage(M,[],$,"",a);c([{role:"model",content:k}])}catch($){console.error("Intro fetch failed",$),c([{role:"model",content:`<p>Greetings. I am ${o}. How may I assist?</p>`}])}})()},[e,t?.settings?.geminiApiKey,o,g]);const j=Mo(),_=t?.settings?.playstyle,E=_?`
User's Playstyle Profile:
- Archetypes: ${_.archetypes?.join(", ")||"Unknown"}
- Summary: ${_.summary||"Unknown"}
- Combat Preference: ${_.scores?.aggression>50?"Aggressive":"Defensive"}
- Interaction Level: ${_.scores?.interaction>50?"High":"Low"}
    `.trim():"",O=`
${H9?H9(j.pathname):""}

${E}
    `.trim(),B=async T=>{if(T.preventDefault(),!u.trim()||p)return;const M=u.trim();h(""),c($=>[...$,{role:"user",content:M}]),m(!0);try{const $=t?.settings?.geminiApiKey;if(!$){c(R=>[...R,{role:"model",content:'<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Please add your Gemini API Key in <a href="/settings" class="underline font-bold">Settings</a> to use the chat.</div>'}]);return}const k=l.map(R=>({role:R.role,content:R.content})),L=await ul.sendMessage($,k,M,O,a);c(R=>[...R,{role:"model",content:L}])}catch($){console.error($),c(k=>[...k,{role:"model",content:`<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Error: ${$.message}</div>`}])}finally{m(!1)}},S=n?"fixed inset-0 top-16 z-40":`fixed bottom-0 right-0 z-[60] transition-all duration-300 ${e?"":"w-16 h-16 mb-20 mr-4 md:mb-6 md:mr-6"}`;return s.jsxs("div",{className:`${S} ${!n&&e?"w-full md:w-96 h-[600px] mb-16 md:mb-0 mr-0":""}`,children:[!e&&s.jsx("button",{onClick:()=>r(!0),className:"w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full shadow-lg shadow-purple-500/30 flex items-center justify-center hover:scale-110 transition-transform animate-bounce-slow",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e&&s.jsxs("div",{className:`flex flex-col h-full bg-gray-800 border-t border-l border-gray-700 shadow-2xl overflow-hidden ${n?"w-full h-full":"rounded-tl-2xl md:rounded-tr-2xl md:border-r"}`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),s.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:o})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>i(!n),className:"text-gray-400 hover:text-white p-1 hover:bg-gray-800 rounded transition-colors",title:n?"Collapse":"Expand",children:n?s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6m-6 0v6M20 10h-6m6 0V4"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),s.jsx("button",{onClick:()=>{r(!1),i(!1)},className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-800/95 backdrop-blur",children:[l.length===0&&!p?s.jsxs("div",{className:"flex justify-center items-center h-full text-gray-500 italic",children:["Summoning ",o,"..."]}):l.map((T,M)=>s.jsx("div",{className:`flex ${T.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl ${T.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"} shadow-md`,children:T.role==="user"?T.content:s.jsx("div",{dangerouslySetInnerHTML:{__html:T.content}})})},M)),p&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-700 rounded-2xl rounded-bl-none p-3 flex gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-75"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"})]})}),s.jsx("div",{ref:v})]}),s.jsx("form",{onSubmit:B,className:"p-4 bg-gray-900 border-t border-gray-700",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:T=>h(T.target.value),placeholder:`Ask ${o}...`,className:"flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"}),s.jsx("button",{type:"submit",disabled:p,className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg hover:shadow-indigo-500/20 transition-all disabled:opacity-50",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})};var AQe=["added","removed","updated"];function HW(t){return AQe.includes(t)}async function TQe({queryClient:t,persister:e,maxAge:r=1e3*60*60*24,buster:n="",hydrateOptions:i}){try{const a=await e.restoreClient();if(a)if(a.timestamp){const o=Date.now()-a.timestamp>r,l=a.buster!==n;if(o||l)return e.removeClient();Yge(t,a.clientState,i)}else return e.removeClient()}catch(a){throw await e.removeClient(),a}}async function WW({queryClient:t,persister:e,buster:r="",dehydrateOptions:n}){const i={buster:r,timestamp:Date.now(),clientState:Kge(t,n)};await e.persistClient(i)}function IQe(t){const e=t.queryClient.getQueryCache().subscribe(n=>{HW(n.type)&&WW(t)}),r=t.queryClient.getMutationCache().subscribe(n=>{HW(n.type)&&WW(t)});return()=>{e(),r()}}var LQe=({children:t,persistOptions:e,onSuccess:r,onError:n,...i})=>{const[a,o]=y.useState(!0),l=y.useRef({persistOptions:e,onSuccess:r,onError:n}),c=y.useRef(!1);return y.useEffect(()=>{l.current={persistOptions:e,onSuccess:r,onError:n}}),y.useEffect(()=>{const u={...l.current.persistOptions,queryClient:i.client};return c.current||(c.current=!0,TQe(u).then(()=>l.current.onSuccess?.()).catch(()=>l.current.onError?.()).finally(()=>{o(!1)})),a?void 0:IQe(u)},[i.client,a]),s.jsx(uxe,{...i,children:s.jsx(hxe,{value:a,children:t})})};function I8(){}function PQe(t,{interval:e=1e3,onError:r=I8}={}){if(typeof t!="function")throw new Error("argument is not function.");let n=0,i=null,a=!1,o=!1;return async(...l)=>{if(i=l,!o){for(o=!0;a;)await new Promise(c=>Rh.setTimeout(c,e));for(;Date.now()<n;)await new Promise(c=>Rh.setTimeout(c,n-Date.now()));o=!1,a=!0;try{await t(...i)}catch(c){try{r(c)}catch{}}n=Date.now()+e,a=!1}}}var OQe=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:r=1e3,serialize:n=JSON.stringify,deserialize:i=JSON.parse,retry:a})=>{if(t){const o=async l=>{try{const c=await n(l);await t.setItem(e,c);return}catch(c){return c}};return{persistClient:PQe(async l=>{let c=l,u=await o(c),h=0;for(;u&&c;)h++,c=await a?.({persistedClient:c,error:u,errorCount:h}),c&&(u=await o(c))},{interval:r}),restoreClient:async()=>{const l=await t.getItem(e);if(l)return await i(l)},removeClient:()=>t.removeItem(e)}}return{persistClient:I8,restoreClient:()=>Promise.resolve(void 0),removeClient:I8}};function E_(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function RQe(t,e){let r;const n=()=>{if(r)return r;const i=indexedDB.open(t);return i.onupgradeneeded=()=>i.result.createObjectStore(e),r=E_(i),r.then(a=>{a.onclose=()=>r=void 0},()=>{}),r};return(i,a)=>n().then(o=>a(o.transaction(e,i).objectStore(e)))}let S6;function VO(){return S6||(S6=RQe("keyval-store","keyval")),S6}function MQe(t,e=VO()){return e("readonly",r=>E_(r.get(t)))}function DQe(t,e,r=VO()){return r("readwrite",n=>(n.put(e,t),E_(n.transaction)))}function BQe(t,e=VO()){return e("readwrite",r=>(r.delete(t),E_(r.transaction)))}const $Qe=new cxe({defaultOptions:{queries:{staleTime:1e3*60*5,cacheTime:1e3*60*60*24,retry:(t,e)=>e?.response?.status===403||e?.response?.status===404||!navigator.onLine?!1:t<2,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),FQe=OQe({storage:{getItem:async t=>await MQe(t),setItem:async(t,e)=>await DQe(t,e),removeItem:async t=>await BQe(t)},key:"REACT_QUERY_OFFLINE_CACHE",throttleTime:1e3});var UQe=function(){return null};const zQe=()=>{const{isOpen:t,selectedCard:e,closeCardModal:r}=z1(),{cards:n,removeCard:i,updateCard:a}=vl(),{addToast:o}=jn(),[l,c]=y.useState(!1),[u,h]=y.useState(!1),[p,m]=y.useState({quantity:1,finish:"nonfoil",deckId:"",price_bought:"",tags:[],currentTag:""}),[g,b]=y.useState([]);if(y.useEffect(()=>{t&&e&&(c(!1),h(!1),m({quantity:e.count||e.quantity||1,finish:e.finish||"nonfoil",deckId:e.deckId||e.deck_id||"",price_bought:e.price_bought||"",tags:typeof e.tags=="string"?JSON.parse(e.tags):e.tags||[],currentTag:""}),Ge.get("/api/decks").then(b).catch(se=>console.error("Failed to load decks",se)))},[t,e]),!t||!e)return null;const v=e.data||e,w=v.card_faces,j=w&&w.length>1&&!!w[1].image_uris,I=(se=>j?v.card_faces[se]:v)(l?1:0),O=se=>se.image_uris?.normal||se.image_uris?.large||null,B=se=>se.image_uris?.art_crop||se.image_uris?.large||se.image_uris?.normal||null,S=j?O(v.card_faces[0]):v.image_uris?.normal||v.image_uris?.large||e.image_uri,T=j?O(v.card_faces[1]):null,M=j?B(v.card_faces[0]):v.image_uris?.art_crop||v.image_uris?.large||e.image_uri,$=j?B(v.card_faces[1]):null,k=l?T:S,L=(l?$:M)||"https://placehold.co/1000x800?text=No+Art",R=se=>se?se.replace(/\{/g,"").replace(/\}/g," "):"",V=(se,ee)=>{const q={legal:"bg-green-600 text-white border-green-700",not_legal:"bg-gray-700 text-gray-400 border-gray-600",banned:"bg-red-600 text-white border-red-700",restricted:"bg-yellow-600 text-white border-yellow-700"},U=q[ee]||q.not_legal;return s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border ${U} flex justify-center items-center shadow-sm`,children:s.jsx("span",{children:se})},se)},Y=async()=>{if(window.confirm(`Are you sure you want to delete ${e.name} from your collection?`))try{e.onDelete?await e.onDelete(e.id||e.firestoreId,e.name):(await i(e.id||e.firestoreId),o("Card deleted","success")),r()}catch(se){console.error(se),o("Failed to delete card","error")}},X=async()=>{try{const se={count:parseInt(p.quantity),finish:p.finish,deck_id:p.deckId?parseInt(p.deckId):null,price_bought:p.price_bought?parseFloat(p.price_bought):null,tags:p.tags};await a(e.id||e.firestoreId,se),o("Card details updated","success"),h(!1)}catch(se){console.error(se),o("Failed to update details","error")}},J=se=>{se.key==="Enter"&&p.currentTag.trim()&&(se.preventDefault(),p.tags.includes(p.currentTag.trim())||m(ee=>({...ee,tags:[...ee.tags,ee.currentTag.trim()],currentTag:""})))},re=se=>{m(ee=>({...ee,tags:ee.tags.filter(q=>q!==se)}))};return s.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center overflow-hidden animate-fade-in",role:"dialog",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:r}),s.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full md:h-[90vh] max-h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-y-auto md:overflow-hidden bg-gray-900/50 border border-gray-700",children:[s.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-2xl",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-700 ease-in-out transform scale-110 opacity-100",style:{backgroundImage:`url('${L}')`}}),s.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),s.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-50 p-2 bg-black/30 hover:bg-black/60 rounded-full text-white/70 hover:text-white transition-colors backdrop-blur-md",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"w-full md:w-1/2 lg:w-5/12 p-8 flex flex-col items-center justify-center relative shrink-0 z-10",children:[s.jsxs("div",{className:"relative w-full max-w-xs md:max-w-md aspect-[2.5/3.5] perspective-1000 transition-transform duration-500",children:[s.jsx("img",{src:k||"https://placehold.co/250x350?text=No+Image",alt:e.name,className:"w-full h-full object-contain drop-shadow-2xl rounded-xl shadow-black/50"}),j&&s.jsx("button",{onClick:()=>c(!l),className:"absolute top-4 right-4 bg-black/60 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg border border-white/20 hover:border-indigo-400 transition-all group backdrop-blur-md",title:"Flip Card",children:s.jsx("svg",{className:`w-6 h-6 transform transition-transform duration-500 ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),v.artist&&s.jsxs("div",{className:"mt-4 text-white/80 text-xs flex items-center gap-1 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Illustrated by ",s.jsx("span",{className:"font-medium",children:v.artist})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col md:h-full bg-gray-900/60 backdrop-blur-xl min-h-0 z-10 border-l border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 shrink-0 relative group",children:[s.jsx("button",{onClick:()=>h(!u),className:`absolute top-6 right-16 p-2 rounded-full transition-all ${u?"text-indigo-400 bg-indigo-500/20":"text-gray-500 hover:text-white hover:bg-gray-700"}`,title:u?"Cancel Editing":"Edit Card Details",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-1 pr-10",children:v.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-400 text-sm mt-2",children:[s.jsx("span",{className:"font-medium text-gray-300",children:I.type_line}),I.mana_cost&&s.jsx("span",{className:"bg-gray-800 px-2 py-0.5 rounded border border-gray-700 text-gray-200 font-mono tracking-wider",children:R(I.mana_cost)}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-indigo-400 font-bold",children:v.set_name||v.set?.toUpperCase()}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"capitalize",children:v.rarity}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsxs("span",{children:["#",v.collector_number]})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-visible md:overflow-y-auto p-6 space-y-8 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Gameplay & Rules"]}),s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-5 border border-gray-700/50 shadow-inner",children:[I.oracle_text?s.jsx("div",{className:"text-gray-200 whitespace-pre-wrap font-serif leading-relaxed text-lg",children:I.oracle_text.split(`
`).map((se,ee)=>s.jsx("p",{className:"mb-2 last:mb-0",children:se},ee))}):s.jsx("span",{className:"text-gray-500 italic",children:"No rules text."}),I.flavor_text&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-gray-400 italic font-serif text-sm",children:['"',I.flavor_text,'"']})]}),(I.power||I.loyalty)&&s.jsx("div",{className:"flex justify-end",children:s.jsx("div",{className:"bg-gray-800 border border-gray-600 px-4 py-2 rounded-lg text-xl font-bold text-white shadow-lg",children:I.power?`${I.power} / ${I.toughness}`:`Loyalty: ${I.loyalty}`})})]}),v.legalities&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Legalities"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[V("Commander",v.legalities.commander),V("Standard",v.legalities.standard),V("Modern",v.legalities.modern),V("Pauper",v.legalities.pauper),V("Legacy",v.legalities.legacy),V("Vintage",v.legalities.vintage)]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Status & Ownership ",u&&s.jsx("span",{className:"text-indigo-400 text-[10px] ml-2 font-normal animate-pulse",children:"(Editing)"})]}),e.is_wishlist&&!u&&s.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3 animate-pulse space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-orange-500 rounded-full text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-orange-400 font-black text-xs uppercase tracking-wider",children:"In Wishlist"}),s.jsx("div",{className:"text-gray-400 text-[10px]",children:"This card is on your want list."})]})]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${e.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center py-2 bg-gray-900/50 hover:bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded border border-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"Find on TCGPlayer"]})]}),(()=>{const se=v.id,ee=n.filter(Z=>Z.scryfall_id===se||Z.scryfallId===se||Z.id===se),q=ee.filter(Z=>!Z.is_wishlist&&Z.finish==="nonfoil").reduce((Z,de)=>Z+(de.count||1),0),U=ee.filter(Z=>!Z.is_wishlist&&Z.finish==="foil").reduce((Z,de)=>Z+(de.count||1),0),W=ee.filter(Z=>Z.is_wishlist).reduce((Z,de)=>Z+(de.count||1),0);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${q>0?"bg-indigo-500/10 border-indigo-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Normal"}),s.jsx("div",{className:"text-xl font-black text-white",children:q}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${U>0?"bg-purple-500/10 border-purple-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Foil"}),s.jsx("div",{className:"text-xl font-black text-indigo-400",children:U}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${W>0?"bg-orange-500/10 border-orange-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Wishlist"}),s.jsx("div",{className:"text-xl font-black text-orange-400",children:W}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Wanted"})]})]}),(u||e.firestoreId||e.firestore_id)&&s.jsxs("div",{className:"bg-gray-950/40 rounded-xl overflow-hidden border border-gray-700/50",children:[s.jsxs("div",{className:"px-3 py-2 bg-gray-800/40 border-b border-gray-700/50 flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-400",children:[s.jsx("span",{children:"Selected Item Details"}),e.is_wishlist&&s.jsx("span",{className:"text-orange-500",children:"Wishlist Copy"})]}),s.jsxs("table",{className:"w-full text-xs text-left",children:[s.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Location"}),s.jsx("th",{className:"px-3 py-2 text-center",children:"Foil"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Added"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700/30 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:u?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:p.deckId,onChange:Z=>m({...p,deckId:Z.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full",children:[s.jsx("option",{value:"",children:"Binder"}),g.map(Z=>s.jsxs("option",{value:Z.id,children:["Deck: ",Z.name]},Z.id))]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-500 text-[9px]",children:"PAID $"}),s.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:p.price_bought,onChange:Z=>m({...p,price_bought:Z.target.value}),className:"bg-gray-800 border-none rounded px-2 py-0.5 text-[10px] text-white w-20 focus:ring-1 focus:ring-indigo-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:p.tags&&p.tags.map(Z=>s.jsxs("span",{className:"bg-indigo-600/50 text-white px-1.5 rounded text-[9px] flex items-center gap-1 border border-indigo-500/30",children:[Z,s.jsx("button",{onClick:()=>re(Z),className:"hover:text-red-300",children:""})]},Z))}),s.jsx("input",{type:"text",placeholder:"+ Tag...",value:p.currentTag,onChange:Z=>m({...p,currentTag:Z.target.value}),onKeyDown:J,className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full focus:ring-1 focus:ring-indigo-500"})]})]}):s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{children:e.deckId?`Deck #${e.deckId}`:"Binder"}),e.tags&&(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).map(Z=>s.jsx("span",{className:"text-[9px] bg-gray-700 px-1 rounded text-gray-300",children:Z},Z))})]})}),s.jsx("td",{className:"px-3 py-2 text-center align-top",children:u?s.jsx("input",{type:"checkbox",checked:p.finish==="foil",onChange:Z=>m({...p,finish:Z.target.checked?"foil":"nonfoil"}),className:"rounded bg-gray-700 border-gray-600 text-indigo-600",title:"Is Foil?"}):e.finish==="foil"?"Yes":"-"}),s.jsx("td",{className:"px-3 py-2 text-right font-black align-top",children:u?s.jsx("input",{type:"number",min:"1",value:p.quantity,onChange:Z=>m({...p,quantity:Z.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-[10px] text-white w-12 text-center"}):e.count||e.quantity||1}),s.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 font-mono text-[10px] align-top",children:[s.jsx("div",{children:e.added_at?new Date(e.added_at).toLocaleDateString():"N/A"}),e.price_bought&&s.jsxs("div",{className:"text-green-500/70 mt-1",title:"Price Paid",children:["$",parseFloat(e.price_bought).toFixed(2)]})]})]})})]})]}),e.is_wishlist&&!u&&s.jsxs("button",{onClick:async()=>{try{await a(e.id||e.firestoreId,{is_wishlist:!1}),o("Card moved to collection!","success")}catch{o("Failed to move card","error")}},className:"w-full py-2.5 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-lg shadow-lg shadow-orange-900/30 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})}),"I Got This Copy!"]})]})})()]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Art & Aesthetics"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Artist"}),s.jsx("span",{className:"text-white font-medium",children:v.artist||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Frame"}),s.jsx("span",{className:"text-white",children:v.frame||"2015"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Border Color"}),s.jsx("span",{className:"text-white capitalize",children:v.border_color||"Black"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Finishes"}),s.jsx("span",{className:"text-white capitalize",children:v.finishes?.join(", ")})]}),v.watermark&&s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Watermark"}),s.jsx("span",{className:"text-white capitalize",children:v.watermark})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Illustration ID"}),s.jsxs("span",{className:"text-gray-400 font-mono text-xs",children:[v.illustration_id?.slice(0,8),"..."]})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Developer / Metadata"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 space-y-2 text-sm font-mono",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"External Links"}),s.jsx("a",{href:v.scryfall_uri,target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"View on Scryfall"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Scryfall ID"}),s.jsx("span",{className:"text-gray-400",children:v.id})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Oracle ID"}),s.jsx("span",{className:"text-gray-400",children:v.oracle_id})]}),e.firestoreId&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Database ID"}),s.jsx("span",{className:"text-gray-400",children:e.firestoreId})]}),s.jsxs("div",{className:"border-t border-gray-800 pt-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Released At"}),s.jsx("span",{className:"text-gray-300",children:v.released_at})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Reserved List"}),s.jsx("span",{className:v.reserved?"text-red-400":"text-gray-400",children:v.reserved?"true":"false"})]})]})]})]}),u&&s.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-700 flex gap-4 animate-fade-in-up",children:[s.jsx("button",{onClick:()=>h(!1),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg border border-gray-500 transition-all font-bold tracking-wide uppercase text-sm",children:"Cancel"}),s.jsx("button",{onClick:Y,className:"flex-1 bg-red-600/80 hover:bg-red-600 text-white py-3 rounded-lg shadow-md transition-all font-bold tracking-wide uppercase text-sm",children:"Delete Card"}),s.jsx("button",{onClick:X,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg shadow-lg shadow-green-900/20 transition-all font-bold tracking-wide uppercase text-sm",children:"Save Changes"})]})]})]})]})]})},qQe=({children:t})=>{const{currentUser:e,userProfile:r,loading:n}=Or(),i=Mo(),a=xn(),[o,l]=y.useState(!1);return y.useEffect(()=>{if(!e&&!n){l(!1);return}if(!(n||o)&&e&&r){const u=["/","/login","/about"].includes(i.pathname)||i.pathname.startsWith("/share/"),h=i.pathname==="/onboarding";!r.settings?.onboarding_complete&&!h&&!u&&a("/onboarding"),l(!0)}},[e,r,n,i,a,o]),n?s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-indigo-500",children:"Loading..."}):t},VQe=()=>{const{addToast:t}=jn();return y.useEffect(()=>(C9(t),()=>C9(null)),[t]),null},HQe=()=>{const t=Mo();return y.useEffect(()=>{const r=new URLSearchParams(t.search).get("ref");r&&(console.log("[ReferralTracker] Capturing referral code:",r),localStorage.setItem("mtg_forge_ref",r))},[t]),null},WQe=()=>{const{addToast:t}=jn();return y.useEffect(()=>{const e=()=>t("You are back online!","success"),r=()=>t("You are offline. Accessing cached data.","warning");return window.addEventListener("online",e),window.addEventListener("offline",r),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}},[t]),null};function GQe(){return eJ([{key:"Escape",action:()=>{window.dispatchEvent(new CustomEvent("close-modals"))}}]),s.jsxs(LQe,{client:$Qe,persistOptions:{persister:FQe,maxAge:1e3*60*60*24*7},onSuccess:()=>console.log("Query cache restored successfully"),loadingComponent:s.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center text-indigo-500 font-bold tracking-widest animate-pulse",children:"LOADING MAGIC..."}),children:[s.jsxs(Cxe,{children:[s.jsx(WQe,{}),s.jsx(_xe,{children:s.jsx(Axe,{children:s.jsxs("div",{className:"bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col",children:[s.jsx(Uce,{}),s.jsx(HQe,{}),s.jsx(w5e,{}),s.jsx(qQe,{children:s.jsx("div",{className:"flex-grow pb-24 md:pb-0",children:s.jsxs(ace,{children:[s.jsx(wn,{path:"/",element:s.jsx(P5e,{})}),s.jsx(wn,{path:"/about",element:s.jsx(TXe,{})}),s.jsx(wn,{path:"/dashboard",element:s.jsx(VAe,{})}),s.jsx(wn,{path:"/login",element:s.jsx(GAe,{})}),s.jsx(wn,{path:"/onboarding",element:s.jsx(AXe,{})}),s.jsx(wn,{path:"/collection",element:s.jsx(E8e,{})}),s.jsx(wn,{path:"/pricing",element:s.jsx(WAe,{})}),s.jsx(wn,{path:"/decks",element:s.jsx(R8e,{})}),s.jsx(wn,{path:"/binders",element:s.jsx(M8e,{})}),s.jsx(wn,{path:"/precons",element:s.jsx(HC,{})}),s.jsx(wn,{path:"/precons/type/:type",element:s.jsx(HC,{})}),s.jsx(wn,{path:"/precons/set/:set",element:s.jsx(HC,{})}),s.jsx(wn,{path:"/precons/deck/:id",element:s.jsx(vXe,{})}),s.jsx(wn,{path:"/decks/new",element:s.jsx($8e,{})}),s.jsx(wn,{path:"/decks/:deckId",element:s.jsx(DPe,{})}),s.jsx(wn,{path:"/share/:slug",element:s.jsx(IXe,{})}),s.jsx(wn,{path:"/decks/:deckId/build",element:s.jsx(wXe,{})}),s.jsx(wn,{path:"/sets",element:s.jsx($Pe,{})}),s.jsx(wn,{path:"/sets/:setCode",element:s.jsx(FPe,{})}),s.jsx(wn,{path:"/wishlist",element:s.jsx(eOe,{})}),s.jsx(wn,{path:"/settings/:tab?",element:s.jsx(ZPe,{})}),s.jsx(wn,{path:"/audit",element:s.jsx(FW,{})}),s.jsx(wn,{path:"/audit/:id",element:s.jsx(FW,{})}),s.jsx(wn,{path:"/audit/:auditId/wizard",element:s.jsx(FXe,{})}),s.jsx(wn,{path:"/remote/:sessionId",element:s.jsx(PXe,{})}),s.jsx(wn,{path:"/strategy",element:s.jsx(OXe,{})}),s.jsx(wn,{path:"/play",element:s.jsx(sce,{to:"/play/lobby",replace:!0})}),s.jsx(wn,{path:"/play/lobby",element:s.jsx(UXe,{})}),s.jsx(wn,{path:"/play/room/:id",element:s.jsx(WXe,{})}),s.jsx(wn,{path:"/social",element:s.jsx(QXe,{})}),s.jsx(wn,{path:"/profile/:id",element:s.jsx(ZXe,{})}),s.jsx(wn,{path:"/armory",element:s.jsx(JXe,{})}),s.jsx(wn,{path:"/tournaments",element:s.jsx(UW,{})}),s.jsx(wn,{path:"/tournaments/:id",element:s.jsx(UW,{})}),s.jsx(wn,{path:"/tournaments/:id/join",element:s.jsx(oQe,{})}),s.jsx(wn,{path:"/solitaire/:deckId",element:s.jsx(SQe,{})})]})})}),s.jsx(VQe,{}),s.jsx(EQe,{}),s.jsx(zQe,{})]})})})]}),s.jsx(UQe,{initialIsOpen:!1})]})}function KQe(t={}){const{immediate:e=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=t;let l,c;const u=async(p=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(l=await dN(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{o?.(p)}),!l)return;l.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),l.addEventListener("installed",p=>{p.isUpdate||n?.()}),l.register({immediate:e}).then(p=>{a?a("/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return c=h(),u}const YQe=KQe({immediate:!0,onNeedRefresh(){confirm("New content available. Reload?")&&YQe(!0)},onOfflineReady(){console.log("App is ready for offline usage")}});lle.createRoot(document.getElementById("root")).render(s.jsx(Pe.StrictMode,{children:s.jsx(Ice,{children:s.jsx(GQe,{})})}));export{ms as _,m0 as c,bl as g};
