function Y0e(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var q0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var LC={exports:{}},gv={};var SB;function X0e(){if(SB)return gv;SB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,s,a){var o=null;if(a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),"key"in s){a={};for(var l in s)l!=="key"&&(a[l]=s[l])}else a=s;return s=a.ref,{$$typeof:t,type:n,key:o,ref:s!==void 0?s:null,props:a}}return gv.Fragment=e,gv.jsx=r,gv.jsxs=r,gv}var CB;function Q0e(){return CB||(CB=1,LC.exports=X0e()),LC.exports}var i=Q0e(),OC={exports:{}},sn={};var EB;function J0e(){if(EB)return sn;EB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;function g(q){return q===null||typeof q!="object"?null:(q=m&&q[m]||q["@@iterator"],typeof q=="function"?q:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function N(q,U,H){this.props=q,this.context=U,this.refs=w,this.updater=H||y}N.prototype.isReactComponent={},N.prototype.setState=function(q,U){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,U,"setState")},N.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function k(){}k.prototype=N.prototype;function C(q,U,H){this.props=q,this.context=U,this.refs=w,this.updater=H||y}var I=C.prototype=new k;I.constructor=C,v(I,N.prototype),I.isPureReactComponent=!0;var O=Array.isArray;function L(){}var _={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function M(q,U,H){var re=H.ref;return{$$typeof:t,type:q,key:U,ref:re!==void 0?re:null,props:H}}function B(q,U){return M(q.type,U,q.props)}function S(q){return typeof q=="object"&&q!==null&&q.$$typeof===t}function P(q){var U={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(H){return U[H]})}var R=/\/+/g;function V(q,U){return typeof q=="object"&&q!==null&&q.key!=null?P(""+q.key):U.toString(36)}function ee(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(L,L):(q.status="pending",q.then(function(U){q.status==="pending"&&(q.status="fulfilled",q.value=U)},function(U){q.status==="pending"&&(q.status="rejected",q.reason=U)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function G(q,U,H,re,ae){var xe=typeof q;(xe==="undefined"||xe==="boolean")&&(q=null);var Ne=!1;if(q===null)Ne=!0;else switch(xe){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(q.$$typeof){case t:case e:Ne=!0;break;case h:return Ne=q._init,G(Ne(q._payload),U,H,re,ae)}}if(Ne)return ae=ae(q),Ne=re===""?"."+V(q,0):re,O(ae)?(H="",Ne!=null&&(H=Ne.replace(R,"$&/")+"/"),G(ae,U,H,"",function(ue){return ue})):ae!=null&&(S(ae)&&(ae=B(ae,H+(ae.key==null||q&&q.key===ae.key?"":(""+ae.key).replace(R,"$&/")+"/")+Ne)),U.push(ae)),1;Ne=0;var pe=re===""?".":re+":";if(O(q))for(var K=0;K<q.length;K++)re=q[K],xe=pe+V(re,K),Ne+=G(re,U,H,xe,ae);else if(K=g(q),typeof K=="function")for(q=K.call(q),K=0;!(re=q.next()).done;)re=re.value,xe=pe+V(re,K++),Ne+=G(re,U,H,xe,ae);else if(xe==="object"){if(typeof q.then=="function")return G(ee(q),U,H,re,ae);throw U=String(q),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function J(q,U,H){if(q==null)return q;var re=[],ae=0;return G(q,re,"","",function(xe){return U.call(H,xe,ae++)}),re}function Z(q){if(q._status===-1){var U=q._result;U=U(),U.then(function(H){(q._status===0||q._status===-1)&&(q._status=1,q._result=H)},function(H){(q._status===0||q._status===-1)&&(q._status=2,q._result=H)}),q._status===-1&&(q._status=0,q._result=U)}if(q._status===1)return q._result.default;throw q._result}var se=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},X={map:J,forEach:function(q,U,H){J(q,function(){U.apply(this,arguments)},H)},count:function(q){var U=0;return J(q,function(){U++}),U},toArray:function(q){return J(q,function(U){return U})||[]},only:function(q){if(!S(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return sn.Activity=f,sn.Children=X,sn.Component=N,sn.Fragment=r,sn.Profiler=s,sn.PureComponent=C,sn.StrictMode=n,sn.Suspense=c,sn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_,sn.__COMPILER_RUNTIME={__proto__:null,c:function(q){return _.H.useMemoCache(q)}},sn.cache=function(q){return function(){return q.apply(null,arguments)}},sn.cacheSignal=function(){return null},sn.cloneElement=function(q,U,H){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var re=v({},q.props),ae=q.key;if(U!=null)for(xe in U.key!==void 0&&(ae=""+U.key),U)!E.call(U,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&U.ref===void 0||(re[xe]=U[xe]);var xe=arguments.length-2;if(xe===1)re.children=H;else if(1<xe){for(var Ne=Array(xe),pe=0;pe<xe;pe++)Ne[pe]=arguments[pe+2];re.children=Ne}return M(q.type,ae,re)},sn.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:a,_context:q},q},sn.createElement=function(q,U,H){var re,ae={},xe=null;if(U!=null)for(re in U.key!==void 0&&(xe=""+U.key),U)E.call(U,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ae[re]=U[re]);var Ne=arguments.length-2;if(Ne===1)ae.children=H;else if(1<Ne){for(var pe=Array(Ne),K=0;K<Ne;K++)pe[K]=arguments[K+2];ae.children=pe}if(q&&q.defaultProps)for(re in Ne=q.defaultProps,Ne)ae[re]===void 0&&(ae[re]=Ne[re]);return M(q,xe,ae)},sn.createRef=function(){return{current:null}},sn.forwardRef=function(q){return{$$typeof:l,render:q}},sn.isValidElement=S,sn.lazy=function(q){return{$$typeof:h,_payload:{_status:-1,_result:q},_init:Z}},sn.memo=function(q,U){return{$$typeof:u,type:q,compare:U===void 0?null:U}},sn.startTransition=function(q){var U=_.T,H={};_.T=H;try{var re=q(),ae=_.S;ae!==null&&ae(H,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(L,se)}catch(xe){se(xe)}finally{U!==null&&H.types!==null&&(U.types=H.types),_.T=U}},sn.unstable_useCacheRefresh=function(){return _.H.useCacheRefresh()},sn.use=function(q){return _.H.use(q)},sn.useActionState=function(q,U,H){return _.H.useActionState(q,U,H)},sn.useCallback=function(q,U){return _.H.useCallback(q,U)},sn.useContext=function(q){return _.H.useContext(q)},sn.useDebugValue=function(){},sn.useDeferredValue=function(q,U){return _.H.useDeferredValue(q,U)},sn.useEffect=function(q,U){return _.H.useEffect(q,U)},sn.useEffectEvent=function(q){return _.H.useEffectEvent(q)},sn.useId=function(){return _.H.useId()},sn.useImperativeHandle=function(q,U,H){return _.H.useImperativeHandle(q,U,H)},sn.useInsertionEffect=function(q,U){return _.H.useInsertionEffect(q,U)},sn.useLayoutEffect=function(q,U){return _.H.useLayoutEffect(q,U)},sn.useMemo=function(q,U){return _.H.useMemo(q,U)},sn.useOptimistic=function(q,U){return _.H.useOptimistic(q,U)},sn.useReducer=function(q,U,H){return _.H.useReducer(q,U,H)},sn.useRef=function(q){return _.H.useRef(q)},sn.useState=function(q){return _.H.useState(q)},sn.useSyncExternalStore=function(q,U,H){return _.H.useSyncExternalStore(q,U,H)},sn.useTransition=function(){return _.H.useTransition()},sn.version="19.2.4",sn}var AB;function Mf(){return AB||(AB=1,OC.exports=J0e()),OC.exports}var b=Mf();const Ie=Pl(b),FT=Y0e({__proto__:null,default:Ie},[b]);var MC={exports:{}},xv={},RC={exports:{}},DC={};var TB;function Z0e(){return TB||(TB=1,(function(t){function e(G,J){var Z=G.length;G.push(J);e:for(;0<Z;){var se=Z-1>>>1,X=G[se];if(0<s(X,J))G[se]=J,G[Z]=X,Z=se;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var J=G[0],Z=G.pop();if(Z!==J){G[0]=Z;e:for(var se=0,X=G.length,q=X>>>1;se<q;){var U=2*(se+1)-1,H=G[U],re=U+1,ae=G[re];if(0>s(H,Z))re<X&&0>s(ae,H)?(G[se]=ae,G[re]=Z,se=re):(G[se]=H,G[U]=Z,se=U);else if(re<X&&0>s(ae,Z))G[se]=ae,G[re]=Z,se=re;else break e}}return J}function s(G,J){var Z=G.sortIndex-J.sortIndex;return Z!==0?Z:G.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,g=!1,y=!1,v=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function I(G){for(var J=r(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=G)n(u),J.sortIndex=J.expirationTime,e(c,J);else break;J=r(u)}}function O(G){if(v=!1,I(G),!y)if(r(c)!==null)y=!0,L||(L=!0,P());else{var J=r(u);J!==null&&ee(O,J.startTime-G)}}var L=!1,_=-1,E=5,M=-1;function B(){return w?!0:!(t.unstable_now()-M<E)}function S(){if(w=!1,L){var G=t.unstable_now();M=G;var J=!0;try{e:{y=!1,v&&(v=!1,k(_),_=-1),g=!0;var Z=m;try{t:{for(I(G),f=r(c);f!==null&&!(f.expirationTime>G&&B());){var se=f.callback;if(typeof se=="function"){f.callback=null,m=f.priorityLevel;var X=se(f.expirationTime<=G);if(G=t.unstable_now(),typeof X=="function"){f.callback=X,I(G),J=!0;break t}f===r(c)&&n(c),I(G)}else n(c);f=r(c)}if(f!==null)J=!0;else{var q=r(u);q!==null&&ee(O,q.startTime-G),J=!1}}break e}finally{f=null,m=Z,g=!1}J=void 0}}finally{J?P():L=!1}}}var P;if(typeof C=="function")P=function(){C(S)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,V=R.port2;R.port1.onmessage=S,P=function(){V.postMessage(null)}}else P=function(){N(S,0)};function ee(G,J){_=N(function(){G(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(G){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var Z=m;m=J;try{return G()}finally{m=Z}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Z=m;m=G;try{return J()}finally{m=Z}},t.unstable_scheduleCallback=function(G,J,Z){var se=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?se+Z:se):Z=se,G){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Z+X,G={id:h++,callback:J,priorityLevel:G,startTime:Z,expirationTime:X,sortIndex:-1},Z>se?(G.sortIndex=Z,e(u,G),r(c)===null&&G===r(u)&&(v?(k(_),_=-1):v=!0,ee(O,Z-se))):(G.sortIndex=X,e(c,G),y||g||(y=!0,L||(L=!0,P()))),G},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(G){var J=m;return function(){var Z=m;m=J;try{return G.apply(this,arguments)}finally{m=Z}}}})(DC)),DC}var IB;function epe(){return IB||(IB=1,RC.exports=Z0e()),RC.exports}var BC={exports:{}},Zo={};var PB;function tpe(){if(PB)return Zo;PB=1;var t=Mf();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(c,u,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:f==null?null:""+f,children:c,containerInfo:u,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Zo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Zo.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(c,u,null,h)},Zo.flushSync=function(c){var u=o.T,h=n.p;try{if(o.T=null,n.p=2,c)return c()}finally{o.T=u,n.p=h,n.d.f()}},Zo.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(c,u))},Zo.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},Zo.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,g=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?n.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:f,integrity:m,fetchPriority:g,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Zo.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=l(u.as,u.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(c)},Zo.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin);n.d.L(c,h,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Zo.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=l(u.as,u.crossOrigin);n.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(c)},Zo.requestFormReset=function(c){n.d.r(c)},Zo.unstable_batchedUpdates=function(c,u){return c(u)},Zo.useFormState=function(c,u,h){return o.H.useFormState(c,u,h)},Zo.useFormStatus=function(){return o.H.useHostTransitionStatus()},Zo.version="19.2.4",Zo}var LB;function QQ(){if(LB)return BC.exports;LB=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),BC.exports=tpe(),BC.exports}var OB;function rpe(){if(OB)return xv;OB=1;var t=epe(),e=Mf(),r=QQ();function n(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var p=d,x=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(x=p.return),d=p.return;while(d)}return p.tag===3?x:null}function o(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function l(d){if(d.tag===31){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function c(d){if(a(d)!==d)throw Error(n(188))}function u(d){var p=d.alternate;if(!p){if(p=a(d),p===null)throw Error(n(188));return p!==d?null:d}for(var x=d,j=p;;){var D=x.return;if(D===null)break;var $=D.alternate;if($===null){if(j=D.return,j!==null){x=j;continue}break}if(D.child===$.child){for($=D.child;$;){if($===x)return c(D),d;if($===j)return c(D),p;$=$.sibling}throw Error(n(188))}if(x.return!==j.return)x=D,j=$;else{for(var ne=!1,ye=D.child;ye;){if(ye===x){ne=!0,x=D,j=$;break}if(ye===j){ne=!0,j=D,x=$;break}ye=ye.sibling}if(!ne){for(ye=$.child;ye;){if(ye===x){ne=!0,x=$,j=D;break}if(ye===j){ne=!0,j=$,x=D;break}ye=ye.sibling}if(!ne)throw Error(n(189))}}if(x.alternate!==j)throw Error(n(190))}if(x.tag!==3)throw Error(n(188));return x.stateNode.current===x?d:p}function h(d){var p=d.tag;if(p===5||p===26||p===27||p===6)return d;for(d=d.child;d!==null;){if(p=h(d),p!==null)return p;d=d.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),S=Symbol.iterator;function P(d){return d===null||typeof d!="object"?null:(d=S&&d[S]||d["@@iterator"],typeof d=="function"?d:null)}var R=Symbol.for("react.client.reference");function V(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===R?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case N:return"Profiler";case w:return"StrictMode";case O:return"Suspense";case L:return"SuspenseList";case M:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case y:return"Portal";case C:return d.displayName||"Context";case k:return(d._context.displayName||"Context")+".Consumer";case I:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case _:return p=d.displayName||null,p!==null?p:V(d.type)||"Memo";case E:p=d._payload,d=d._init;try{return V(d(p))}catch{}}return null}var ee=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},se=[],X=-1;function q(d){return{current:d}}function U(d){0>X||(d.current=se[X],se[X]=null,X--)}function H(d,p){X++,se[X]=d.current,d.current=p}var re=q(null),ae=q(null),xe=q(null),Ne=q(null);function pe(d,p){switch(H(xe,p),H(ae,d),H(re,null),p.nodeType){case 9:case 11:d=(d=p.documentElement)&&(d=d.namespaceURI)?Y9(d):0;break;default:if(d=p.tagName,p=p.namespaceURI)p=Y9(p),d=X9(p,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}U(re),H(re,d)}function K(){U(re),U(ae),U(xe)}function ue(d){d.memoizedState!==null&&H(Ne,d);var p=re.current,x=X9(p,d.type);p!==x&&(H(ae,d),H(re,x))}function fe(d){ae.current===d&&(U(re),U(ae)),Ne.current===d&&(U(Ne),hv._currentValue=Z)}var he,le;function _e(d){if(he===void 0)try{throw Error()}catch(x){var p=x.stack.trim().match(/\n( *(at )?)/);he=p&&p[1]||"",le=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+he+d+le}var oe=!1;function Oe(d,p){if(!d||oe)return"";oe=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var j={DetermineComponentFrameRoot:function(){try{if(p){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(ot){var st=ot}Reflect.construct(d,[],Et)}else{try{Et.call()}catch(ot){st=ot}d.call(Et.prototype)}}else{try{throw Error()}catch(ot){st=ot}(Et=d())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(ot){if(ot&&st&&typeof ot.stack=="string")return[ot.stack,st.stack]}return[null,null]}};j.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(j.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(j.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=j.DetermineComponentFrameRoot(),ne=$[0],ye=$[1];if(ne&&ye){var Pe=ne.split(`
`),Ze=ye.split(`
`);for(D=j=0;j<Pe.length&&!Pe[j].includes("DetermineComponentFrameRoot");)j++;for(;D<Ze.length&&!Ze[D].includes("DetermineComponentFrameRoot");)D++;if(j===Pe.length||D===Ze.length)for(j=Pe.length-1,D=Ze.length-1;1<=j&&0<=D&&Pe[j]!==Ze[D];)D--;for(;1<=j&&0<=D;j--,D--)if(Pe[j]!==Ze[D]){if(j!==1||D!==1)do if(j--,D--,0>D||Pe[j]!==Ze[D]){var yt=`
`+Pe[j].replace(" at new "," at ");return d.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",d.displayName)),yt}while(1<=j&&0<=D);break}}}finally{oe=!1,Error.prepareStackTrace=x}return(x=d?d.displayName||d.name:"")?_e(x):""}function ze(d,p){switch(d.tag){case 26:case 27:case 5:return _e(d.type);case 16:return _e("Lazy");case 13:return d.child!==p&&p!==null?_e("Suspense Fallback"):_e("Suspense");case 19:return _e("SuspenseList");case 0:case 15:return Oe(d.type,!1);case 11:return Oe(d.type.render,!1);case 1:return Oe(d.type,!0);case 31:return _e("Activity");default:return""}}function Ye(d){try{var p="",x=null;do p+=ze(d,x),x=d,d=d.return;while(d);return p}catch(j){return`
Error generating stack: `+j.message+`
`+j.stack}}var je=Object.prototype.hasOwnProperty,Fe=t.unstable_scheduleCallback,Nt=t.unstable_cancelCallback,$t=t.unstable_shouldYield,Ut=t.unstable_requestPaint,nt=t.unstable_now,bt=t.unstable_getCurrentPriorityLevel,It=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,wt=t.unstable_NormalPriority,ut=t.unstable_LowPriority,Rt=t.unstable_IdlePriority,Dt=t.log,at=t.unstable_setDisableYieldValue,ft=null,Bt=null;function De(d){if(typeof Dt=="function"&&at(d),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(ft,d)}catch{}}var lt=Math.clz32?Math.clz32:At,ht=Math.log,Pt=Math.LN2;function At(d){return d>>>=0,d===0?32:31-(ht(d)/Pt|0)|0}var mt=256,Ft=262144,gt=4194304;function Ot(d){var p=d&42;if(p!==0)return p;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Ct(d,p,x){var j=d.pendingLanes;if(j===0)return 0;var D=0,$=d.suspendedLanes,ne=d.pingedLanes;d=d.warmLanes;var ye=j&134217727;return ye!==0?(j=ye&~$,j!==0?D=Ot(j):(ne&=ye,ne!==0?D=Ot(ne):x||(x=ye&~d,x!==0&&(D=Ot(x))))):(ye=j&~$,ye!==0?D=Ot(ye):ne!==0?D=Ot(ne):x||(x=j&~d,x!==0&&(D=Ot(x)))),D===0?0:p!==0&&p!==D&&(p&$)===0&&($=D&-D,x=p&-p,$>=x||$===32&&(x&4194048)!==0)?p:D}function Xt(d,p){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&p)===0}function Qt(d,p){switch(d){case 1:case 2:case 4:case 8:case 64:return p+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nr(){var d=gt;return gt<<=1,(gt&62914560)===0&&(gt=4194304),d}function sr(d){for(var p=[],x=0;31>x;x++)p.push(d);return p}function Jt(d,p){d.pendingLanes|=p,p!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function kr(d,p,x,j,D,$){var ne=d.pendingLanes;d.pendingLanes=x,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=x,d.entangledLanes&=x,d.errorRecoveryDisabledLanes&=x,d.shellSuspendCounter=0;var ye=d.entanglements,Pe=d.expirationTimes,Ze=d.hiddenUpdates;for(x=ne&~x;0<x;){var yt=31-lt(x),Et=1<<yt;ye[yt]=0,Pe[yt]=-1;var st=Ze[yt];if(st!==null)for(Ze[yt]=null,yt=0;yt<st.length;yt++){var ot=st[yt];ot!==null&&(ot.lane&=-536870913)}x&=~Et}j!==0&&Ae(d,j,0),$!==0&&D===0&&d.tag!==0&&(d.suspendedLanes|=$&~(ne&~p))}function Ae(d,p,x){d.pendingLanes|=p,d.suspendedLanes&=~p;var j=31-lt(p);d.entangledLanes|=p,d.entanglements[j]=d.entanglements[j]|1073741824|x&261930}function Ke(d,p){var x=d.entangledLanes|=p;for(d=d.entanglements;x;){var j=31-lt(x),D=1<<j;D&p|d[j]&p&&(d[j]|=p),x&=~D}}function Gt(d,p){var x=p&-p;return x=(x&42)!==0?1:jt(x),(x&(d.suspendedLanes|p))!==0?0:x}function jt(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function zt(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function Mt(){var d=J.p;return d!==0?d:(d=window.event,d===void 0?32:bB(d.type))}function Ht(d,p){var x=J.p;try{return J.p=d,p()}finally{J.p=x}}var vr=Math.random().toString(36).slice(2),Fr="__reactFiber$"+vr,ln="__reactProps$"+vr,hn="__reactContainer$"+vr,cn="__reactEvents$"+vr,Ks="__reactListeners$"+vr,Ci="__reactHandles$"+vr,Ds="__reactResources$"+vr,ps="__reactMarker$"+vr;function $e(d){delete d[Fr],delete d[ln],delete d[cn],delete d[Ks],delete d[Ci]}function Xe(d){var p=d[Fr];if(p)return p;for(var x=d.parentNode;x;){if(p=x[hn]||x[Fr]){if(x=p.alternate,p.child!==null||x!==null&&x.child!==null)for(d=nB(d);d!==null;){if(x=d[Fr])return x;d=nB(d)}return p}d=x,x=d.parentNode}return null}function ct(d){if(d=d[Fr]||d[hn]){var p=d.tag;if(p===5||p===6||p===13||p===31||p===26||p===27||p===3)return d}return null}function tr(d){var p=d.tag;if(p===5||p===26||p===27||p===6)return d.stateNode;throw Error(n(33))}function Lr(d){var p=d[Ds];return p||(p=d[Ds]={hoistableStyles:new Map,hoistableScripts:new Map}),p}function tn(d){d[ps]=!0}var Ea=new Set,Bs={};function sa(d,p){Bi(d,p),Bi(d+"Capture",p)}function Bi(d,p){for(Bs[d]=p,d=0;d<p.length;d++)Ea.add(p[d])}var Fi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ko={},Rl={};function pc(d){return je.call(Rl,d)?!0:je.call(Ko,d)?!1:Fi.test(d)?Rl[d]=!0:(Ko[d]=!0,!1)}function ia(d,p,x){if(pc(p))if(x===null)d.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":d.removeAttribute(p);return;case"boolean":var j=p.toLowerCase().slice(0,5);if(j!=="data-"&&j!=="aria-"){d.removeAttribute(p);return}}d.setAttribute(p,""+x)}}function pi(d,p,x){if(x===null)d.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(p);return}d.setAttribute(p,""+x)}}function ks(d,p,x,j){if(j===null)d.removeAttribute(x);else{switch(typeof j){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(x);return}d.setAttributeNS(p,x,""+j)}}function Zr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Aa(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function mi(d,p,x){var j=Object.getOwnPropertyDescriptor(d.constructor.prototype,p);if(!d.hasOwnProperty(p)&&typeof j<"u"&&typeof j.get=="function"&&typeof j.set=="function"){var D=j.get,$=j.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return D.call(this)},set:function(ne){x=""+ne,$.call(this,ne)}}),Object.defineProperty(d,p,{enumerable:j.enumerable}),{getValue:function(){return x},setValue:function(ne){x=""+ne},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function pn(d){if(!d._valueTracker){var p=Aa(d)?"checked":"value";d._valueTracker=mi(d,p,""+d[p])}}function No(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var x=p.getValue(),j="";return d&&(j=Aa(d)?d.checked?"true":"false":d.value),d=j,d!==x?(p.setValue(d),!0):!1}function Fs(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ss=/[\n"\\]/g;function _s(d){return d.replace(ss,function(p){return"\\"+p.charCodeAt(0).toString(16)+" "})}function hl(d,p,x,j,D,$,ne,ye){d.name="",ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?d.type=ne:d.removeAttribute("type"),p!=null?ne==="number"?(p===0&&d.value===""||d.value!=p)&&(d.value=""+Zr(p)):d.value!==""+Zr(p)&&(d.value=""+Zr(p)):ne!=="submit"&&ne!=="reset"||d.removeAttribute("value"),p!=null?mc(d,ne,Zr(p)):x!=null?mc(d,ne,Zr(x)):j!=null&&d.removeAttribute("value"),D==null&&$!=null&&(d.defaultChecked=!!$),D!=null&&(d.checked=D&&typeof D!="function"&&typeof D!="symbol"),ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"?d.name=""+Zr(ye):d.removeAttribute("name")}function Dl(d,p,x,j,D,$,ne,ye){if($!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(d.type=$),p!=null||x!=null){if(!($!=="submit"&&$!=="reset"||p!=null)){pn(d);return}x=x!=null?""+Zr(x):"",p=p!=null?""+Zr(p):x,ye||p===d.value||(d.value=p),d.defaultValue=p}j=j??D,j=typeof j!="function"&&typeof j!="symbol"&&!!j,d.checked=ye?d.checked:!!j,d.defaultChecked=!!j,ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"&&(d.name=ne),pn(d)}function mc(d,p,x){p==="number"&&Fs(d.ownerDocument)===d||d.defaultValue===""+x||(d.defaultValue=""+x)}function Ei(d,p,x,j){if(d=d.options,p){p={};for(var D=0;D<x.length;D++)p["$"+x[D]]=!0;for(x=0;x<d.length;x++)D=p.hasOwnProperty("$"+d[x].value),d[x].selected!==D&&(d[x].selected=D),D&&j&&(d[x].defaultSelected=!0)}else{for(x=""+Zr(x),p=null,D=0;D<d.length;D++){if(d[D].value===x){d[D].selected=!0,j&&(d[D].defaultSelected=!0);return}p!==null||d[D].disabled||(p=d[D])}p!==null&&(p.selected=!0)}}function jo(d,p,x){if(p!=null&&(p=""+Zr(p),p!==d.value&&(d.value=p),x==null)){d.defaultValue!==p&&(d.defaultValue=p);return}d.defaultValue=x!=null?""+Zr(x):""}function ei(d,p,x,j){if(p==null){if(j!=null){if(x!=null)throw Error(n(92));if(ee(j)){if(1<j.length)throw Error(n(93));j=j[0]}x=j}x==null&&(x=""),p=x}x=Zr(p),d.defaultValue=x,j=d.textContent,j===x&&j!==""&&j!==null&&(d.value=j),pn(d)}function is(d,p){if(p){var x=d.firstChild;if(x&&x===d.lastChild&&x.nodeType===3){x.nodeValue=p;return}}d.textContent=p}var $i=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gc(d,p,x){var j=p.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?j?d.setProperty(p,""):p==="float"?d.cssFloat="":d[p]="":j?d.setProperty(p,x):typeof x!="number"||x===0||$i.has(p)?p==="float"?d.cssFloat=x:d[p]=(""+x).trim():d[p]=x+"px"}function ha(d,p,x){if(p!=null&&typeof p!="object")throw Error(n(62));if(d=d.style,x!=null){for(var j in x)!x.hasOwnProperty(j)||p!=null&&p.hasOwnProperty(j)||(j.indexOf("--")===0?d.setProperty(j,""):j==="float"?d.cssFloat="":d[j]="");for(var D in p)j=p[D],p.hasOwnProperty(D)&&x[D]!==j&&gc(d,D,j)}else for(var $ in p)p.hasOwnProperty($)&&gc(d,$,p[$])}function Bl(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ko=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ui(d){return ko.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function fa(){}var ms=null;function Ai(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var _o=null,yr=null;function So(d){var p=ct(d);if(p&&(d=p.stateNode)){var x=d[ln]||null;e:switch(d=p.stateNode,p.type){case"input":if(hl(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),p=x.name,x.type==="radio"&&p!=null){for(x=d;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+_s(""+p)+'"][type="radio"]'),p=0;p<x.length;p++){var j=x[p];if(j!==d&&j.form===d.form){var D=j[ln]||null;if(!D)throw Error(n(90));hl(j,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(p=0;p<x.length;p++)j=x[p],j.form===d.form&&No(j)}break e;case"textarea":jo(d,x.value,x.defaultValue);break e;case"select":p=x.value,p!=null&&Ei(d,!!x.multiple,p,!1)}}}var Co=!1;function Yo(d,p,x){if(Co)return d(p,x);Co=!0;try{var j=d(p);return j}finally{if(Co=!1,(_o!==null||yr!==null)&&(y5(),_o&&(p=_o,d=yr,yr=_o=null,So(p),d)))for(p=0;p<d.length;p++)So(d[p])}}function Ys(d,p){var x=d.stateNode;if(x===null)return null;var j=x[ln]||null;if(j===null)return null;x=j[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(d=d.type,j=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!j;break e;default:d=!1}if(d)return null;if(x&&typeof x!="function")throw Error(n(231,p,typeof x));return x}var Ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xo=!1;if(Ss)try{var un={};Object.defineProperty(un,"passive",{get:function(){Xo=!0}}),window.addEventListener("test",un,un),window.removeEventListener("test",un,un)}catch{Xo=!1}var zi=null,Eo=null,Ta=null;function xc(){if(Ta)return Ta;var d,p=Eo,x=p.length,j,D="value"in zi?zi.value:zi.textContent,$=D.length;for(d=0;d<x&&p[d]===D[d];d++);var ne=x-d;for(j=1;j<=ne&&p[x-j]===D[$-j];j++);return Ta=D.slice(d,1<j?1-j:void 0)}function Q(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function be(){return!0}function Te(){return!1}function it(d){function p(x,j,D,$,ne){this._reactName=x,this._targetInst=D,this.type=j,this.nativeEvent=$,this.target=ne,this.currentTarget=null;for(var ye in d)d.hasOwnProperty(ye)&&(x=d[ye],this[ye]=x?x($):$[ye]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?be:Te,this.isPropagationStopped=Te,this}return f(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=be)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=be)},persist:function(){},isPersistent:be}),p}var Tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rr=it(Tr),Xr=f({},Tr,{view:0,detail:0}),en=it(Xr),On,rn,Yn,Xs=f({},Xr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rr,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Yn&&(Yn&&d.type==="mousemove"?(On=d.screenX-Yn.screenX,rn=d.screenY-Yn.screenY):rn=On=0,Yn=d),On)},movementY:function(d){return"movementY"in d?d.movementY:rn}}),us=it(Xs),zn=f({},Xs,{dataTransfer:0}),Jn=it(zn),to=f({},Xr,{relatedTarget:0}),ti=it(to),ro=f({},Tr,{animationName:0,elapsedTime:0,pseudoElement:0}),z=it(ro),ce=f({},Tr,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Se=it(ce),Le=f({},Tr,{data:0}),Ue=it(Le),xt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ur={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=ur[d])?!!p[d]:!1}function Rr(){return pr}var Ir=f({},Xr,{key:function(d){if(d.key){var p=xt[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=Q(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Lt[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rr,charCode:function(d){return d.type==="keypress"?Q(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Q(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Nn=it(Ir),Cs=f({},Xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=it(Cs),T=f({},Xr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rr}),Y=it(T),ie=f({},Tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),we=it(ie),qe=f({},Xs,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),tt=it(qe),Kt=f({},Tr,{newState:0,oldState:0}),Yr=it(Kt),Es=[9,13,27,32],bn=Ss&&"CompositionEvent"in window,Zn=null;Ss&&"documentMode"in document&&(Zn=document.documentMode);var pa=Ss&&"TextEvent"in window&&!Zn,Ia=Ss&&(!bn||Zn&&8<Zn&&11>=Zn),gs=" ",Pa=!1;function fl(d,p){switch(d){case"keyup":return Es.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uc(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var zc=!1;function Ao(d,p){switch(d){case"compositionend":return Uc(p);case"keypress":return p.which!==32?null:(Pa=!0,gs);case"textInput":return d=p.data,d===gs&&Pa?null:d;default:return null}}function Cu(d,p){if(zc)return d==="compositionend"||!bn&&fl(d,p)?(d=xc(),Ta=Eo=zi=null,zc=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return Ia&&p.locale!=="ko"?null:p.data;default:return null}}var Xf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pp(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!Xf[d.type]:p==="textarea"}function pl(d,p,x,j){_o?yr?yr.push(j):yr=[j]:_o=j,p=_5(p,"onChange"),0<p.length&&(x=new rr("onChange","change",null,x,j),d.push({event:x,listeners:p}))}var yc=null,Eu=null;function Lp(d){V9(d,0)}function bc(d){var p=tr(d);if(No(p))return d}function kd(d,p){if(d==="change")return p}var Qo=!1;if(Ss){var To;if(Ss){var Vc="oninput"in document;if(!Vc){var qc=document.createElement("div");qc.setAttribute("oninput","return;"),Vc=typeof qc.oninput=="function"}To=Vc}else To=!1;Qo=To&&(!document.documentMode||9<document.documentMode)}function Au(){yc&&(yc.detachEvent("onpropertychange",Qf),Eu=yc=null)}function Qf(d){if(d.propertyName==="value"&&bc(Eu)){var p=[];pl(p,Eu,d,Ai(d)),Yo(Lp,p)}}function Jf(d,p,x){d==="focusin"?(Au(),yc=p,Eu=x,yc.attachEvent("onpropertychange",Qf)):d==="focusout"&&Au()}function Ti(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return bc(Eu)}function Mg(d,p){if(d==="click")return bc(p)}function Hc(d,p){if(d==="input"||d==="change")return bc(p)}function Wc(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var La=typeof Object.is=="function"?Object.is:Wc;function Tu(d,p){if(La(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var x=Object.keys(d),j=Object.keys(p);if(x.length!==j.length)return!1;for(j=0;j<x.length;j++){var D=x[j];if(!je.call(p,D)||!La(d[D],p[D]))return!1}return!0}function Zf(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function e0(d,p){var x=Zf(d);d=0;for(var j;x;){if(x.nodeType===3){if(j=d+x.textContent.length,d<=p&&j>=p)return{node:x,offset:p-d};d=j}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=Zf(x)}}function Iu(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?Iu(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function Pu(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var p=Fs(d.document);p instanceof d.HTMLIFrameElement;){try{var x=typeof p.contentWindow.location.href=="string"}catch{x=!1}if(x)d=p.contentWindow;else break;p=Fs(d.document)}return p}function Gc(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}var Ch=Ss&&"documentMode"in document&&11>=document.documentMode,ml=null,Lu=null,no=null,$l=!1;function Xn(d,p,x){var j=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;$l||ml==null||ml!==Fs(j)||(j=ml,"selectionStart"in j&&Gc(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),no&&Tu(no,j)||(no=j,j=_5(Lu,"onSelect"),0<j.length&&(p=new rr("onSelect","select",null,p,x),d.push({event:p,listeners:j}),p.target=ml)))}function Mn(d,p){var x={};return x[d.toLowerCase()]=p.toLowerCase(),x["Webkit"+d]="webkit"+p,x["Moz"+d]="moz"+p,x}var As={animationend:Mn("Animation","AnimationEnd"),animationiteration:Mn("Animation","AnimationIteration"),animationstart:Mn("Animation","AnimationStart"),transitionrun:Mn("Transition","TransitionRun"),transitionstart:Mn("Transition","TransitionStart"),transitioncancel:Mn("Transition","TransitionCancel"),transitionend:Mn("Transition","TransitionEnd")},Ii={},Kc={};Ss&&(Kc=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function vc(d){if(Ii[d])return Ii[d];if(!As[d])return d;var p=As[d],x;for(x in p)if(p.hasOwnProperty(x)&&x in Kc)return Ii[d]=p[x];return d}var Eh=vc("animationend"),Op=vc("animationiteration"),Mb=vc("animationstart"),Kw=vc("transitionrun"),Yw=vc("transitionstart"),Xw=vc("transitioncancel"),Rb=vc("transitionend"),Db=new Map,Ah="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ah.push("scrollEnd");function Ul(d,p){Db.set(d,p),sa(p,[d])}var Mp=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var p=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(p))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},gl=[],Th=0,Rg=0;function Rp(){for(var d=Th,p=Rg=Th=0;p<d;){var x=gl[p];gl[p++]=null;var j=gl[p];gl[p++]=null;var D=gl[p];gl[p++]=null;var $=gl[p];if(gl[p++]=null,j!==null&&D!==null){var ne=j.pending;ne===null?D.next=D:(D.next=ne.next,ne.next=D),j.pending=D}$!==0&&Bp(x,D,$)}}function Dp(d,p,x,j){gl[Th++]=d,gl[Th++]=p,gl[Th++]=x,gl[Th++]=j,Rg|=j,d.lanes|=j,d=d.alternate,d!==null&&(d.lanes|=j)}function Dg(d,p,x,j){return Dp(d,p,x,j),so(d)}function Ou(d,p){return Dp(d,null,null,p),so(d)}function Bp(d,p,x){d.lanes|=x;var j=d.alternate;j!==null&&(j.lanes|=x);for(var D=!1,$=d.return;$!==null;)$.childLanes|=x,j=$.alternate,j!==null&&(j.childLanes|=x),$.tag===22&&(d=$.stateNode,d===null||d._visibility&1||(D=!0)),d=$,$=$.return;return d.tag===3?($=d.stateNode,D&&p!==null&&(D=31-lt(x),d=$.hiddenUpdates,j=d[D],j===null?d[D]=[p]:j.push(p),p.lane=x|536870912),$):null}function so(d){if(50<iv)throw iv=0,nC=null,Error(n(185));for(var p=d.return;p!==null;)d=p,p=d.return;return d.tag===3?d.stateNode:null}var Oa={};function Bg(d,p,x,j){this.tag=d,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function io(d,p,x,j){return new Bg(d,p,x,j)}function Fg(d){return d=d.prototype,!(!d||!d.isReactComponent)}function zl(d,p){var x=d.alternate;return x===null?(x=io(d.tag,p,d.key,d.mode),x.elementType=d.elementType,x.type=d.type,x.stateNode=d.stateNode,x.alternate=d,d.alternate=x):(x.pendingProps=p,x.type=d.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=d.flags&65011712,x.childLanes=d.childLanes,x.lanes=d.lanes,x.child=d.child,x.memoizedProps=d.memoizedProps,x.memoizedState=d.memoizedState,x.updateQueue=d.updateQueue,p=d.dependencies,x.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},x.sibling=d.sibling,x.index=d.index,x.ref=d.ref,x.refCleanup=d.refCleanup,x}function Fp(d,p){d.flags&=65011714;var x=d.alternate;return x===null?(d.childLanes=0,d.lanes=p,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=x.childLanes,d.lanes=x.lanes,d.child=x.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=x.memoizedProps,d.memoizedState=x.memoizedState,d.updateQueue=x.updateQueue,d.type=x.type,p=x.dependencies,d.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),d}function t0(d,p,x,j,D,$){var ne=0;if(j=d,typeof d=="function")Fg(d)&&(ne=1);else if(typeof d=="string")ne=D0e(d,x,re.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case M:return d=io(31,x,p,D),d.elementType=M,d.lanes=$,d;case v:return _d(x.children,D,$,p);case w:ne=8,D|=24;break;case N:return d=io(12,x,p,D|2),d.elementType=N,d.lanes=$,d;case O:return d=io(13,x,p,D),d.elementType=O,d.lanes=$,d;case L:return d=io(19,x,p,D),d.elementType=L,d.lanes=$,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case C:ne=10;break e;case k:ne=9;break e;case I:ne=11;break e;case _:ne=14;break e;case E:ne=16,j=null;break e}ne=29,x=Error(n(130,d===null?"null":typeof d,"")),j=null}return p=io(ne,x,p,D),p.elementType=d,p.type=j,p.lanes=$,p}function _d(d,p,x,j){return d=io(7,d,j,p),d.lanes=x,d}function $p(d,p,x){return d=io(6,d,null,p),d.lanes=x,d}function $g(d){var p=io(18,null,null,0);return p.stateNode=d,p}function r0(d,p,x){return p=io(4,d.children!==null?d.children:[],d.key,p),p.lanes=x,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}var Ug=new WeakMap;function Vl(d,p){if(typeof d=="object"&&d!==null){var x=Ug.get(d);return x!==void 0?x:(p={value:d,source:p,stack:Ye(p)},Ug.set(d,p),p)}return{value:d,source:p,stack:Ye(p)}}var n0=[],Ih=0,zg=null,Up=0,ql=[],Hl=0,Sd=null,Wl=1,Gl="";function xl(d,p){n0[Ih++]=Up,n0[Ih++]=zg,zg=d,Up=p}function Qw(d,p,x){ql[Hl++]=Wl,ql[Hl++]=Gl,ql[Hl++]=Sd,Sd=d;var j=Wl;d=Gl;var D=32-lt(j)-1;j&=~(1<<D),x+=1;var $=32-lt(p)+D;if(30<$){var ne=D-D%5;$=(j&(1<<ne)-1).toString(32),j>>=ne,D-=ne,Wl=1<<32-lt(p)+D|x<<D|j,Gl=$+d}else Wl=1<<$|x<<D|j,Gl=d}function Bb(d){d.return!==null&&(xl(d,1),Qw(d,1,0))}function Vg(d){for(;d===zg;)zg=n0[--Ih],n0[Ih]=null,Up=n0[--Ih],n0[Ih]=null;for(;d===Sd;)Sd=ql[--Hl],ql[Hl]=null,Gl=ql[--Hl],ql[Hl]=null,Wl=ql[--Hl],ql[Hl]=null}function Jw(d,p){ql[Hl++]=Wl,ql[Hl++]=Gl,ql[Hl++]=Sd,Wl=p.id,Gl=p.overflow,Sd=d}var Ma=null,$s=null,_n=!1,Io=null,gi=!1,wc=Error(n(519));function Cd(d){var p=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw s0(Vl(p,d)),wc}function Fb(d){var p=d.stateNode,x=d.type,j=d.memoizedProps;switch(p[Fr]=d,p[ln]=j,x){case"dialog":Cn("cancel",p),Cn("close",p);break;case"iframe":case"object":case"embed":Cn("load",p);break;case"video":case"audio":for(x=0;x<ov.length;x++)Cn(ov[x],p);break;case"source":Cn("error",p);break;case"img":case"image":case"link":Cn("error",p),Cn("load",p);break;case"details":Cn("toggle",p);break;case"input":Cn("invalid",p),Dl(p,j.value,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name,!0);break;case"select":Cn("invalid",p);break;case"textarea":Cn("invalid",p),ei(p,j.value,j.defaultValue,j.children)}x=j.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||p.textContent===""+x||j.suppressHydrationWarning===!0||G9(p.textContent,x)?(j.popover!=null&&(Cn("beforetoggle",p),Cn("toggle",p)),j.onScroll!=null&&Cn("scroll",p),j.onScrollEnd!=null&&Cn("scrollend",p),j.onClick!=null&&(p.onclick=fa),p=!0):p=!1,p||Cd(d,!0)}function Mu(d){for(Ma=d.return;Ma;)switch(Ma.tag){case 5:case 31:case 13:gi=!1;return;case 27:case 3:gi=!0;return;default:Ma=Ma.return}}function Ra(d){if(d!==Ma)return!1;if(!_n)return Mu(d),_n=!0,!1;var p=d.tag,x;if((x=p!==3&&p!==27)&&((x=p===5)&&(x=d.type,x=!(x!=="form"&&x!=="button")||yC(d.type,d.memoizedProps)),x=!x),x&&$s&&Cd(d),Mu(d),p===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));$s=rB(d)}else if(p===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));$s=rB(d)}else p===27?(p=$s,y0(d.type)?(d=jC,jC=null,$s=d):$s=p):$s=Ma?Jc(d.stateNode.nextSibling):null;return!0}function Ph(){$s=Ma=null,_n=!1}function $b(){var d=Io;return d!==null&&(Zl===null?Zl=d:Zl.push.apply(Zl,d),Io=null),d}function s0(d){Io===null?Io=[d]:Io.push(d)}var qg=q(null),Ed=null,Yc=null;function Ad(d,p,x){H(qg,p._currentValue),p._currentValue=x}function Kl(d){d._currentValue=qg.current,U(qg)}function i0(d,p,x){for(;d!==null;){var j=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,j!==null&&(j.childLanes|=p)):j!==null&&(j.childLanes&p)!==p&&(j.childLanes|=p),d===x)break;d=d.return}}function Lh(d,p,x,j){var D=d.child;for(D!==null&&(D.return=d);D!==null;){var $=D.dependencies;if($!==null){var ne=D.child;$=$.firstContext;e:for(;$!==null;){var ye=$;$=D;for(var Pe=0;Pe<p.length;Pe++)if(ye.context===p[Pe]){$.lanes|=x,ye=$.alternate,ye!==null&&(ye.lanes|=x),i0($.return,x,d),j||(ne=null);break e}$=ye.next}}else if(D.tag===18){if(ne=D.return,ne===null)throw Error(n(341));ne.lanes|=x,$=ne.alternate,$!==null&&($.lanes|=x),i0(ne,x,d),ne=null}else ne=D.child;if(ne!==null)ne.return=D;else for(ne=D;ne!==null;){if(ne===d){ne=null;break}if(D=ne.sibling,D!==null){D.return=ne.return,ne=D;break}ne=ne.return}D=ne}}function Td(d,p,x,j){d=null;for(var D=p,$=!1;D!==null;){if(!$){if((D.flags&524288)!==0)$=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var ne=D.alternate;if(ne===null)throw Error(n(387));if(ne=ne.memoizedProps,ne!==null){var ye=D.type;La(D.pendingProps.value,ne.value)||(d!==null?d.push(ye):d=[ye])}}else if(D===Ne.current){if(ne=D.alternate,ne===null)throw Error(n(387));ne.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(d!==null?d.push(hv):d=[hv])}D=D.return}d!==null&&Lh(p,d,x,j),p.flags|=262144}function Hg(d){for(d=d.firstContext;d!==null;){if(!La(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function Id(d){Ed=d,Yc=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Da(d){return Zw(Ed,d)}function Wg(d,p){return Ed===null&&Id(d),Zw(d,p)}function Zw(d,p){var x=p._currentValue;if(p={context:p,memoizedValue:x,next:null},Yc===null){if(d===null)throw Error(n(308));Yc=p,d.dependencies={lanes:0,firstContext:p},d.flags|=524288}else Yc=Yc.next=p;return x}var N3=typeof AbortController<"u"?AbortController:function(){var d=[],p=this.signal={aborted:!1,addEventListener:function(x,j){d.push(j)}};this.abort=function(){p.aborted=!0,d.forEach(function(x){return x()})}},j3=t.unstable_scheduleCallback,k3=t.unstable_NormalPriority,Pi={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function a0(){return{controller:new N3,data:new Map,refCount:0}}function zp(d){d.refCount--,d.refCount===0&&j3(k3,function(){d.controller.abort()})}var Vp=null,Gg=0,A=0,F=null;function W(d,p){if(Vp===null){var x=Vp=[];Gg=0,A=cC(),F={status:"pending",value:void 0,then:function(j){x.push(j)}}}return Gg++,p.then(te,te),p}function te(){if(--Gg===0&&Vp!==null){F!==null&&(F.status="fulfilled");var d=Vp;Vp=null,A=0,F=null;for(var p=0;p<d.length;p++)(0,d[p])()}}function de(d,p){var x=[],j={status:"pending",value:null,reason:null,then:function(D){x.push(D)}};return d.then(function(){j.status="fulfilled",j.value=p;for(var D=0;D<x.length;D++)(0,x[D])(p)},function(D){for(j.status="rejected",j.reason=D,D=0;D<x.length;D++)(0,x[D])(void 0)}),j}var me=G.S;G.S=function(d,p){x9=nt(),typeof p=="object"&&p!==null&&typeof p.then=="function"&&W(d,p),me!==null&&me(d,p)};var ge=q(null);function ve(){var d=ge.current;return d!==null?d:zs.pooledCache}function ke(d,p){p===null?H(ge,ge.current):H(ge,p.pool)}function Ee(){var d=ve();return d===null?null:{parent:Pi._currentValue,pool:d}}var Me=Error(n(460)),Qe=Error(n(474)),Ce=Error(n(542)),Be={then:function(){}};function We(d){return d=d.status,d==="fulfilled"||d==="rejected"}function pt(d,p,x){switch(x=d[x],x===void 0?d.push(p):x!==p&&(p.then(fa,fa),p=x),p.status){case"fulfilled":return p.value;case"rejected":throw d=p.reason,Wt(d),d;default:if(typeof p.status=="string")p.then(fa,fa);else{if(d=zs,d!==null&&100<d.shellSuspendCounter)throw Error(n(482));d=p,d.status="pending",d.then(function(j){if(p.status==="pending"){var D=p;D.status="fulfilled",D.value=j}},function(j){if(p.status==="pending"){var D=p;D.status="rejected",D.reason=j}})}switch(p.status){case"fulfilled":return p.value;case"rejected":throw d=p.reason,Wt(d),d}throw dt=p,Me}}function Ge(d){try{var p=d._init;return p(d._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(dt=x,Me):x}}var dt=null;function vt(){if(dt===null)throw Error(n(459));var d=dt;return dt=null,d}function Wt(d){if(d===Me||d===Ce)throw Error(n(483))}var Tt=null,mr=0;function ir(d){var p=mr;return mr+=1,Tt===null&&(Tt=[]),pt(Tt,d,p)}function Qr(d,p){p=p.props.ref,d.ref=p!==void 0?p:null}function dr(d,p){throw p.$$typeof===m?Error(n(525)):(d=Object.prototype.toString.call(p),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d)))}function jn(d){function p(Ve,Re){if(d){var Je=Ve.deletions;Je===null?(Ve.deletions=[Re],Ve.flags|=16):Je.push(Re)}}function x(Ve,Re){if(!d)return null;for(;Re!==null;)p(Ve,Re),Re=Re.sibling;return null}function j(Ve){for(var Re=new Map;Ve!==null;)Ve.key!==null?Re.set(Ve.key,Ve):Re.set(Ve.index,Ve),Ve=Ve.sibling;return Re}function D(Ve,Re){return Ve=zl(Ve,Re),Ve.index=0,Ve.sibling=null,Ve}function $(Ve,Re,Je){return Ve.index=Je,d?(Je=Ve.alternate,Je!==null?(Je=Je.index,Je<Re?(Ve.flags|=67108866,Re):Je):(Ve.flags|=67108866,Re)):(Ve.flags|=1048576,Re)}function ne(Ve){return d&&Ve.alternate===null&&(Ve.flags|=67108866),Ve}function ye(Ve,Re,Je,kt){return Re===null||Re.tag!==6?(Re=$p(Je,Ve.mode,kt),Re.return=Ve,Re):(Re=D(Re,Je),Re.return=Ve,Re)}function Pe(Ve,Re,Je,kt){var Br=Je.type;return Br===v?yt(Ve,Re,Je.props.children,kt,Je.key):Re!==null&&(Re.elementType===Br||typeof Br=="object"&&Br!==null&&Br.$$typeof===E&&Ge(Br)===Re.type)?(Re=D(Re,Je.props),Qr(Re,Je),Re.return=Ve,Re):(Re=t0(Je.type,Je.key,Je.props,null,Ve.mode,kt),Qr(Re,Je),Re.return=Ve,Re)}function Ze(Ve,Re,Je,kt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==Je.containerInfo||Re.stateNode.implementation!==Je.implementation?(Re=r0(Je,Ve.mode,kt),Re.return=Ve,Re):(Re=D(Re,Je.children||[]),Re.return=Ve,Re)}function yt(Ve,Re,Je,kt,Br){return Re===null||Re.tag!==7?(Re=_d(Je,Ve.mode,kt,Br),Re.return=Ve,Re):(Re=D(Re,Je),Re.return=Ve,Re)}function Et(Ve,Re,Je){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=$p(""+Re,Ve.mode,Je),Re.return=Ve,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case g:return Je=t0(Re.type,Re.key,Re.props,null,Ve.mode,Je),Qr(Je,Re),Je.return=Ve,Je;case y:return Re=r0(Re,Ve.mode,Je),Re.return=Ve,Re;case E:return Re=Ge(Re),Et(Ve,Re,Je)}if(ee(Re)||P(Re))return Re=_d(Re,Ve.mode,Je,null),Re.return=Ve,Re;if(typeof Re.then=="function")return Et(Ve,ir(Re),Je);if(Re.$$typeof===C)return Et(Ve,Wg(Ve,Re),Je);dr(Ve,Re)}return null}function st(Ve,Re,Je,kt){var Br=Re!==null?Re.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Br!==null?null:ye(Ve,Re,""+Je,kt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case g:return Je.key===Br?Pe(Ve,Re,Je,kt):null;case y:return Je.key===Br?Ze(Ve,Re,Je,kt):null;case E:return Je=Ge(Je),st(Ve,Re,Je,kt)}if(ee(Je)||P(Je))return Br!==null?null:yt(Ve,Re,Je,kt,null);if(typeof Je.then=="function")return st(Ve,Re,ir(Je),kt);if(Je.$$typeof===C)return st(Ve,Re,Wg(Ve,Je),kt);dr(Ve,Je)}return null}function ot(Ve,Re,Je,kt,Br){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Ve=Ve.get(Je)||null,ye(Re,Ve,""+kt,Br);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case g:return Ve=Ve.get(kt.key===null?Je:kt.key)||null,Pe(Re,Ve,kt,Br);case y:return Ve=Ve.get(kt.key===null?Je:kt.key)||null,Ze(Re,Ve,kt,Br);case E:return kt=Ge(kt),ot(Ve,Re,Je,kt,Br)}if(ee(kt)||P(kt))return Ve=Ve.get(Je)||null,yt(Re,Ve,kt,Br,null);if(typeof kt.then=="function")return ot(Ve,Re,Je,ir(kt),Br);if(kt.$$typeof===C)return ot(Ve,Re,Je,Wg(Re,kt),Br);dr(Re,kt)}return null}function fr(Ve,Re,Je,kt){for(var Br=null,es=null,wr=Re,mn=Re=0,Pn=null;wr!==null&&mn<Je.length;mn++){wr.index>mn?(Pn=wr,wr=null):Pn=wr.sibling;var ts=st(Ve,wr,Je[mn],kt);if(ts===null){wr===null&&(wr=Pn);break}d&&wr&&ts.alternate===null&&p(Ve,wr),Re=$(ts,Re,mn),es===null?Br=ts:es.sibling=ts,es=ts,wr=Pn}if(mn===Je.length)return x(Ve,wr),_n&&xl(Ve,mn),Br;if(wr===null){for(;mn<Je.length;mn++)wr=Et(Ve,Je[mn],kt),wr!==null&&(Re=$(wr,Re,mn),es===null?Br=wr:es.sibling=wr,es=wr);return _n&&xl(Ve,mn),Br}for(wr=j(wr);mn<Je.length;mn++)Pn=ot(wr,Ve,mn,Je[mn],kt),Pn!==null&&(d&&Pn.alternate!==null&&wr.delete(Pn.key===null?mn:Pn.key),Re=$(Pn,Re,mn),es===null?Br=Pn:es.sibling=Pn,es=Pn);return d&&wr.forEach(function(j0){return p(Ve,j0)}),_n&&xl(Ve,mn),Br}function zr(Ve,Re,Je,kt){if(Je==null)throw Error(n(151));for(var Br=null,es=null,wr=Re,mn=Re=0,Pn=null,ts=Je.next();wr!==null&&!ts.done;mn++,ts=Je.next()){wr.index>mn?(Pn=wr,wr=null):Pn=wr.sibling;var j0=st(Ve,wr,ts.value,kt);if(j0===null){wr===null&&(wr=Pn);break}d&&wr&&j0.alternate===null&&p(Ve,wr),Re=$(j0,Re,mn),es===null?Br=j0:es.sibling=j0,es=j0,wr=Pn}if(ts.done)return x(Ve,wr),_n&&xl(Ve,mn),Br;if(wr===null){for(;!ts.done;mn++,ts=Je.next())ts=Et(Ve,ts.value,kt),ts!==null&&(Re=$(ts,Re,mn),es===null?Br=ts:es.sibling=ts,es=ts);return _n&&xl(Ve,mn),Br}for(wr=j(wr);!ts.done;mn++,ts=Je.next())ts=ot(wr,Ve,mn,ts.value,kt),ts!==null&&(d&&ts.alternate!==null&&wr.delete(ts.key===null?mn:ts.key),Re=$(ts,Re,mn),es===null?Br=ts:es.sibling=ts,es=ts);return d&&wr.forEach(function(K0e){return p(Ve,K0e)}),_n&&xl(Ve,mn),Br}function Ls(Ve,Re,Je,kt){if(typeof Je=="object"&&Je!==null&&Je.type===v&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case g:e:{for(var Br=Je.key;Re!==null;){if(Re.key===Br){if(Br=Je.type,Br===v){if(Re.tag===7){x(Ve,Re.sibling),kt=D(Re,Je.props.children),kt.return=Ve,Ve=kt;break e}}else if(Re.elementType===Br||typeof Br=="object"&&Br!==null&&Br.$$typeof===E&&Ge(Br)===Re.type){x(Ve,Re.sibling),kt=D(Re,Je.props),Qr(kt,Je),kt.return=Ve,Ve=kt;break e}x(Ve,Re);break}else p(Ve,Re);Re=Re.sibling}Je.type===v?(kt=_d(Je.props.children,Ve.mode,kt,Je.key),kt.return=Ve,Ve=kt):(kt=t0(Je.type,Je.key,Je.props,null,Ve.mode,kt),Qr(kt,Je),kt.return=Ve,Ve=kt)}return ne(Ve);case y:e:{for(Br=Je.key;Re!==null;){if(Re.key===Br)if(Re.tag===4&&Re.stateNode.containerInfo===Je.containerInfo&&Re.stateNode.implementation===Je.implementation){x(Ve,Re.sibling),kt=D(Re,Je.children||[]),kt.return=Ve,Ve=kt;break e}else{x(Ve,Re);break}else p(Ve,Re);Re=Re.sibling}kt=r0(Je,Ve.mode,kt),kt.return=Ve,Ve=kt}return ne(Ve);case E:return Je=Ge(Je),Ls(Ve,Re,Je,kt)}if(ee(Je))return fr(Ve,Re,Je,kt);if(P(Je)){if(Br=P(Je),typeof Br!="function")throw Error(n(150));return Je=Br.call(Je),zr(Ve,Re,Je,kt)}if(typeof Je.then=="function")return Ls(Ve,Re,ir(Je),kt);if(Je.$$typeof===C)return Ls(Ve,Re,Wg(Ve,Je),kt);dr(Ve,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint"?(Je=""+Je,Re!==null&&Re.tag===6?(x(Ve,Re.sibling),kt=D(Re,Je),kt.return=Ve,Ve=kt):(x(Ve,Re),kt=$p(Je,Ve.mode,kt),kt.return=Ve,Ve=kt),ne(Ve)):x(Ve,Re)}return function(Ve,Re,Je,kt){try{mr=0;var Br=Ls(Ve,Re,Je,kt);return Tt=null,Br}catch(wr){if(wr===Me||wr===Ce)throw wr;var es=io(29,wr,null,Ve.mode);return es.lanes=kt,es.return=Ve,es}}}var Us=jn(!0),nn=jn(!1),ar=!1;function Zt(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ri(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Ur(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function dn(d,p,x){var j=d.updateQueue;if(j===null)return null;if(j=j.shared,(ls&2)!==0){var D=j.pending;return D===null?p.next=p:(p.next=D.next,D.next=p),j.pending=p,p=so(d),Bp(d,null,x),p}return Dp(d,j,p,x),so(d)}function as(d,p,x){if(p=p.updateQueue,p!==null&&(p=p.shared,(x&4194048)!==0)){var j=p.lanes;j&=d.pendingLanes,x|=j,p.lanes=x,Ke(d,x)}}function aa(d,p){var x=d.updateQueue,j=d.alternate;if(j!==null&&(j=j.updateQueue,x===j)){var D=null,$=null;if(x=x.firstBaseUpdate,x!==null){do{var ne={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};$===null?D=$=ne:$=$.next=ne,x=x.next}while(x!==null);$===null?D=$=p:$=$.next=p}else D=$=p;x={baseState:j.baseState,firstBaseUpdate:D,lastBaseUpdate:$,shared:j.shared,callbacks:j.callbacks},d.updateQueue=x;return}d=x.lastBaseUpdate,d===null?x.firstBaseUpdate=p:d.next=p,x.lastBaseUpdate=p}var Ba=!1;function Ts(){if(Ba){var d=F;if(d!==null)throw d}}function Vi(d,p,x,j){Ba=!1;var D=d.updateQueue;ar=!1;var $=D.firstBaseUpdate,ne=D.lastBaseUpdate,ye=D.shared.pending;if(ye!==null){D.shared.pending=null;var Pe=ye,Ze=Pe.next;Pe.next=null,ne===null?$=Ze:ne.next=Ze,ne=Pe;var yt=d.alternate;yt!==null&&(yt=yt.updateQueue,ye=yt.lastBaseUpdate,ye!==ne&&(ye===null?yt.firstBaseUpdate=Ze:ye.next=Ze,yt.lastBaseUpdate=Pe))}if($!==null){var Et=D.baseState;ne=0,yt=Ze=Pe=null,ye=$;do{var st=ye.lane&-536870913,ot=st!==ye.lane;if(ot?(In&st)===st:(j&st)===st){st!==0&&st===A&&(Ba=!0),yt!==null&&(yt=yt.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var fr=d,zr=ye;st=p;var Ls=x;switch(zr.tag){case 1:if(fr=zr.payload,typeof fr=="function"){Et=fr.call(Ls,Et,st);break e}Et=fr;break e;case 3:fr.flags=fr.flags&-65537|128;case 0:if(fr=zr.payload,st=typeof fr=="function"?fr.call(Ls,Et,st):fr,st==null)break e;Et=f({},Et,st);break e;case 2:ar=!0}}st=ye.callback,st!==null&&(d.flags|=64,ot&&(d.flags|=8192),ot=D.callbacks,ot===null?D.callbacks=[st]:ot.push(st))}else ot={lane:st,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},yt===null?(Ze=yt=ot,Pe=Et):yt=yt.next=ot,ne|=st;if(ye=ye.next,ye===null){if(ye=D.shared.pending,ye===null)break;ot=ye,ye=ot.next,ot.next=null,D.lastBaseUpdate=ot,D.shared.pending=null}}while(!0);yt===null&&(Pe=Et),D.baseState=Pe,D.firstBaseUpdate=Ze,D.lastBaseUpdate=yt,$===null&&(D.shared.lanes=0),f0|=ne,d.lanes=ne,d.memoizedState=Et}}function ao(d,p){if(typeof d!="function")throw Error(n(191,d));d.call(p)}function qi(d,p){var x=d.callbacks;if(x!==null)for(d.callbacks=null,d=0;d<x.length;d++)ao(x[d],p)}var vn=q(null),Vn=q(0);function ni(d,p){d=Vh,H(Vn,d),H(vn,p),Vh=d|p.baseLanes}function Qn(){H(Vn,Vh),H(vn,vn.current)}function oa(){Vh=Vn.current,U(vn),U(Vn)}var si=q(null),qn=null;function Li(d){var p=d.alternate;H(Rn,Rn.current&1),H(si,d),qn===null&&(p===null||vn.current!==null||p.memoizedState!==null)&&(qn=d)}function os(d){H(Rn,Rn.current),H(si,d),qn===null&&(qn=d)}function Hi(d){d.tag===22?(H(Rn,Rn.current),H(si,d),qn===null&&(qn=d)):Wi()}function Wi(){H(Rn,Rn.current),H(si,si.current)}function xs(d){U(si),qn===d&&(qn=null),U(Rn)}var Rn=q(0);function oo(d){for(var p=d;p!==null;){if(p.tag===13){var x=p.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||wC(x)||NC(x)))return p}else if(p.tag===19&&(p.memoizedProps.revealOrder==="forwards"||p.memoizedProps.revealOrder==="backwards"||p.memoizedProps.revealOrder==="unstable_legacy-backwards"||p.memoizedProps.revealOrder==="together")){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var xi=0,Or=null,Dr=null,Hn=null,Jo=!1,Yl=!1,Po=!1,Gi=0,Pd=0,Ld=null,Kg=0;function Is(){throw Error(n(321))}function Ub(d,p){if(p===null)return!1;for(var x=0;x<p.length&&x<d.length;x++)if(!La(d[x],p[x]))return!1;return!0}function zb(d,p,x,j,D,$){return xi=$,Or=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,G.H=d===null||d.memoizedState===null?ED:P3,Po=!1,$=x(j,D),Po=!1,Yl&&($=Ru(p,x,j,D)),Yg(d),$}function Yg(d){G.H=Xb;var p=Dr!==null&&Dr.next!==null;if(xi=0,Hn=Dr=Or=null,Jo=!1,Pd=0,Ld=null,p)throw Error(n(300));d===null||ga||(d=d.dependencies,d!==null&&Hg(d)&&(ga=!0))}function Ru(d,p,x,j){Or=d;var D=0;do{if(Yl&&(Ld=null),Pd=0,Yl=!1,25<=D)throw Error(n(301));if(D+=1,Hn=Dr=null,d.updateQueue!=null){var $=d.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}G.H=AD,$=p(x,j)}while(Yl);return $}function _3(){var d=G.H,p=d.useState()[0];return p=typeof p.then=="function"?Od(p):p,d=d.useState()[0],(Dr!==null?Dr.memoizedState:null)!==d&&(Or.flags|=1024),p}function Vb(){var d=Gi!==0;return Gi=0,d}function qb(d,p,x){p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~x}function Xg(d){if(Jo){for(d=d.memoizedState;d!==null;){var p=d.queue;p!==null&&(p.pending=null),d=d.next}Jo=!1}xi=0,Hn=Dr=Or=null,Yl=!1,Pd=Gi=0,Ld=null}function ma(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?Or.memoizedState=Hn=d:Hn=Hn.next=d,Hn}function yi(){if(Dr===null){var d=Or.alternate;d=d!==null?d.memoizedState:null}else d=Dr.next;var p=Hn===null?Or.memoizedState:Hn.next;if(p!==null)Hn=p,Dr=d;else{if(d===null)throw Or.alternate===null?Error(n(467)):Error(n(310));Dr=d,d={memoizedState:Dr.memoizedState,baseState:Dr.baseState,baseQueue:Dr.baseQueue,queue:Dr.queue,next:null},Hn===null?Or.memoizedState=Hn=d:Hn=Hn.next=d}return Hn}function qp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Od(d){var p=Pd;return Pd+=1,Ld===null&&(Ld=[]),d=pt(Ld,d,p),p=Or,(Hn===null?p.memoizedState:Hn.next)===null&&(p=p.alternate,G.H=p===null||p.memoizedState===null?ED:P3),d}function o0(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Od(d);if(d.$$typeof===C)return Da(d)}throw Error(n(438,String(d)))}function Oh(d){var p=null,x=Or.updateQueue;if(x!==null&&(p=x.memoCache),p==null){var j=Or.alternate;j!==null&&(j=j.updateQueue,j!==null&&(j=j.memoCache,j!=null&&(p={data:j.data.map(function(D){return D.slice()}),index:0})))}if(p==null&&(p={data:[],index:0}),x===null&&(x=qp(),Or.updateQueue=x),x.memoCache=p,x=p.data[p.index],x===void 0)for(x=p.data[p.index]=Array(d),j=0;j<d;j++)x[j]=B;return p.index++,x}function Xc(d,p){return typeof p=="function"?p(d):p}function Qg(d){var p=yi();return l0(p,Dr,d)}function l0(d,p,x){var j=d.queue;if(j===null)throw Error(n(311));j.lastRenderedReducer=x;var D=d.baseQueue,$=j.pending;if($!==null){if(D!==null){var ne=D.next;D.next=$.next,$.next=ne}p.baseQueue=D=$,j.pending=null}if($=d.baseState,D===null)d.memoizedState=$;else{p=D.next;var ye=ne=null,Pe=null,Ze=p,yt=!1;do{var Et=Ze.lane&-536870913;if(Et!==Ze.lane?(In&Et)===Et:(xi&Et)===Et){var st=Ze.revertLane;if(st===0)Pe!==null&&(Pe=Pe.next={lane:0,revertLane:0,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),Et===A&&(yt=!0);else if((xi&st)===st){Ze=Ze.next,st===A&&(yt=!0);continue}else Et={lane:0,revertLane:Ze.revertLane,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Pe===null?(ye=Pe=Et,ne=$):Pe=Pe.next=Et,Or.lanes|=st,f0|=st;Et=Ze.action,Po&&x($,Et),$=Ze.hasEagerState?Ze.eagerState:x($,Et)}else st={lane:Et,revertLane:Ze.revertLane,gesture:Ze.gesture,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Pe===null?(ye=Pe=st,ne=$):Pe=Pe.next=st,Or.lanes|=Et,f0|=Et;Ze=Ze.next}while(Ze!==null&&Ze!==p);if(Pe===null?ne=$:Pe.next=ye,!La($,d.memoizedState)&&(ga=!0,yt&&(x=F,x!==null)))throw x;d.memoizedState=$,d.baseState=ne,d.baseQueue=Pe,j.lastRenderedState=$}return D===null&&(j.lanes=0),[d.memoizedState,j.dispatch]}function Jg(d){var p=yi(),x=p.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=d;var j=x.dispatch,D=x.pending,$=p.memoizedState;if(D!==null){x.pending=null;var ne=D=D.next;do $=d($,ne.action),ne=ne.next;while(ne!==D);La($,p.memoizedState)||(ga=!0),p.memoizedState=$,p.baseQueue===null&&(p.baseState=$),x.lastRenderedState=$}return[$,j]}function Zg(d,p,x){var j=Or,D=yi(),$=_n;if($){if(x===void 0)throw Error(n(407));x=x()}else x=p();var ne=!La((Dr||D).memoizedState,x);if(ne&&(D.memoizedState=x,ga=!0),D=D.queue,S3(Wb.bind(null,j,D,d),[d]),D.getSnapshot!==p||ne||Hn!==null&&Hn.memoizedState.tag&1){if(j.flags|=2048,Rh(9,{destroy:void 0},Hb.bind(null,j,D,x,p),null),zs===null)throw Error(n(349));$||(xi&127)!==0||Du(j,p,x)}return x}function Du(d,p,x){d.flags|=16384,d={getSnapshot:p,value:x},p=Or.updateQueue,p===null?(p=qp(),Or.updateQueue=p,p.stores=[d]):(x=p.stores,x===null?p.stores=[d]:x.push(d))}function Hb(d,p,x,j){p.value=x,p.getSnapshot=j,e5(p)&&Gb(d)}function Wb(d,p,x){return x(function(){e5(p)&&Gb(d)})}function e5(d){var p=d.getSnapshot;d=d.value;try{var x=p();return!La(d,x)}catch{return!0}}function Gb(d){var p=Ou(d,2);p!==null&&ec(p,d,2)}function Md(d){var p=ma();if(typeof d=="function"){var x=d;if(d=x(),Po){De(!0);try{x()}finally{De(!1)}}}return p.memoizedState=p.baseState=d,p.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xc,lastRenderedState:d},p}function t5(d,p,x,j){return d.baseState=x,l0(d,Dr,typeof j=="function"?j:Xc)}function r5(d,p,x,j,D){if(a5(d))throw Error(n(485));if(d=p.action,d!==null){var $={payload:D,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ne){$.listeners.push(ne)}};G.T!==null?x(!0):$.isTransition=!1,j($),x=p.pending,x===null?($.next=p.pending=$,n5(p,$)):($.next=x.next,p.pending=x.next=$)}}function n5(d,p){var x=p.action,j=p.payload,D=d.state;if(p.isTransition){var $=G.T,ne={};G.T=ne;try{var ye=x(D,j),Pe=G.S;Pe!==null&&Pe(ne,ye),Kb(d,p,ye)}catch(Ze){Mh(d,p,Ze)}finally{$!==null&&ne.types!==null&&($.types=ne.types),G.T=$}}else try{$=x(D,j),Kb(d,p,$)}catch(Ze){Mh(d,p,Ze)}}function Kb(d,p,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(j){s5(d,p,j)},function(j){return Mh(d,p,j)}):s5(d,p,x)}function s5(d,p,x){p.status="fulfilled",p.value=x,ex(p),d.state=x,p=d.pending,p!==null&&(x=p.next,x===p?d.pending=null:(x=x.next,p.next=x,n5(d,x)))}function Mh(d,p,x){var j=d.pending;if(d.pending=null,j!==null){j=j.next;do p.status="rejected",p.reason=x,ex(p),p=p.next;while(p!==j)}d.action=null}function ex(d){d=d.listeners;for(var p=0;p<d.length;p++)(0,d[p])()}function Hp(d,p){return p}function Qc(d,p){if(_n){var x=zs.formState;if(x!==null){e:{var j=Or;if(_n){if($s){t:{for(var D=$s,$=gi;D.nodeType!==8;){if(!$){D=null;break t}if(D=Jc(D.nextSibling),D===null){D=null;break t}}$=D.data,D=$==="F!"||$==="F"?D:null}if(D){$s=Jc(D.nextSibling),j=D.data==="F!";break e}}Cd(j)}j=!1}j&&(p=x[0])}}return x=ma(),x.memoizedState=x.baseState=p,j={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hp,lastRenderedState:p},x.queue=j,x=_D.bind(null,Or,j),j.dispatch=x,j=Md(!1),$=I3.bind(null,Or,!1,j.queue),j=ma(),D={state:p,dispatch:null,action:d,pending:null},j.queue=D,x=r5.bind(null,Or,D,$,x),D.dispatch=x,j.memoizedState=d,[p,x,!1]}function Bu(d){var p=yi();return Fu(p,Dr,d)}function Fu(d,p,x){if(p=l0(d,p,Hp)[0],d=Qg(Xc)[0],typeof p=="object"&&p!==null&&typeof p.then=="function")try{var j=Od(p)}catch(ne){throw ne===Me?Ce:ne}else j=p;p=yi();var D=p.queue,$=D.dispatch;return x!==p.memoizedState&&(Or.flags|=2048,Rh(9,{destroy:void 0},tx.bind(null,D,x),null)),[j,$,d]}function tx(d,p){d.action=p}function rx(d){var p=yi(),x=Dr;if(x!==null)return Fu(p,x,d);yi(),p=p.memoizedState,x=yi();var j=x.queue.dispatch;return x.memoizedState=d,[p,j,!1]}function Rh(d,p,x,j){return d={tag:d,create:x,deps:j,inst:p,next:null},p=Or.updateQueue,p===null&&(p=qp(),Or.updateQueue=p),x=p.lastEffect,x===null?p.lastEffect=d.next=d:(j=x.next,x.next=d,d.next=j,p.lastEffect=d),d}function i5(){return yi().memoizedState}function c0(d,p,x,j){var D=ma();Or.flags|=d,D.memoizedState=Rh(1|p,{destroy:void 0},x,j===void 0?null:j)}function u0(d,p,x,j){var D=yi();j=j===void 0?null:j;var $=D.memoizedState.inst;Dr!==null&&j!==null&&Ub(j,Dr.memoizedState.deps)?D.memoizedState=Rh(p,$,x,j):(Or.flags|=d,D.memoizedState=Rh(1|p,$,x,j))}function dD(d,p){c0(8390656,8,d,p)}function S3(d,p){u0(2048,8,d,p)}function zfe(d){Or.flags|=4;var p=Or.updateQueue;if(p===null)p=qp(),Or.updateQueue=p,p.events=[d];else{var x=p.events;x===null?p.events=[d]:x.push(d)}}function hD(d){var p=yi().memoizedState;return zfe({ref:p,nextImpl:d}),function(){if((ls&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}function fD(d,p){return u0(4,2,d,p)}function pD(d,p){return u0(4,4,d,p)}function mD(d,p){if(typeof p=="function"){d=d();var x=p(d);return function(){typeof x=="function"?x():p(null)}}if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function gD(d,p,x){x=x!=null?x.concat([d]):null,u0(4,4,mD.bind(null,p,d),x)}function C3(){}function xD(d,p){var x=yi();p=p===void 0?null:p;var j=x.memoizedState;return p!==null&&Ub(p,j[1])?j[0]:(x.memoizedState=[d,p],d)}function yD(d,p){var x=yi();p=p===void 0?null:p;var j=x.memoizedState;if(p!==null&&Ub(p,j[1]))return j[0];if(j=d(),Po){De(!0);try{d()}finally{De(!1)}}return x.memoizedState=[j,p],j}function E3(d,p,x){return x===void 0||(xi&1073741824)!==0&&(In&261930)===0?d.memoizedState=p:(d.memoizedState=x,d=b9(),Or.lanes|=d,f0|=d,x)}function bD(d,p,x,j){return La(x,p)?x:vn.current!==null?(d=E3(d,x,j),La(d,p)||(ga=!0),d):(xi&42)===0||(xi&1073741824)!==0&&(In&261930)===0?(ga=!0,d.memoizedState=x):(d=b9(),Or.lanes|=d,f0|=d,p)}function vD(d,p,x,j,D){var $=J.p;J.p=$!==0&&8>$?$:8;var ne=G.T,ye={};G.T=ye,I3(d,!1,p,x);try{var Pe=D(),Ze=G.S;if(Ze!==null&&Ze(ye,Pe),Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var yt=de(Pe,j);Yb(d,p,yt,kc(d))}else Yb(d,p,j,kc(d))}catch(Et){Yb(d,p,{then:function(){},status:"rejected",reason:Et},kc())}finally{J.p=$,ne!==null&&ye.types!==null&&(ne.types=ye.types),G.T=ne}}function Vfe(){}function A3(d,p,x,j){if(d.tag!==5)throw Error(n(476));var D=wD(d).queue;vD(d,D,p,Z,x===null?Vfe:function(){return ND(d),x(j)})}function wD(d){var p=d.memoizedState;if(p!==null)return p;p={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xc,lastRenderedState:Z},next:null};var x={};return p.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xc,lastRenderedState:x},next:null},d.memoizedState=p,d=d.alternate,d!==null&&(d.memoizedState=p),p}function ND(d){var p=wD(d);p.next===null&&(p=d.alternate.memoizedState),Yb(d,p.next.queue,{},kc())}function T3(){return Da(hv)}function jD(){return yi().memoizedState}function kD(){return yi().memoizedState}function qfe(d){for(var p=d.return;p!==null;){switch(p.tag){case 24:case 3:var x=kc();d=Ur(x);var j=dn(p,d,x);j!==null&&(ec(j,p,x),as(j,p,x)),p={cache:a0()},d.payload=p;return}p=p.return}}function Hfe(d,p,x){var j=kc();x={lane:j,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},a5(d)?SD(p,x):(x=Dg(d,p,x,j),x!==null&&(ec(x,d,j),CD(x,p,j)))}function _D(d,p,x){var j=kc();Yb(d,p,x,j)}function Yb(d,p,x,j){var D={lane:j,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(a5(d))SD(p,D);else{var $=d.alternate;if(d.lanes===0&&($===null||$.lanes===0)&&($=p.lastRenderedReducer,$!==null))try{var ne=p.lastRenderedState,ye=$(ne,x);if(D.hasEagerState=!0,D.eagerState=ye,La(ye,ne))return Dp(d,p,D,0),zs===null&&Rp(),!1}catch{}if(x=Dg(d,p,D,j),x!==null)return ec(x,d,j),CD(x,p,j),!0}return!1}function I3(d,p,x,j){if(j={lane:2,revertLane:cC(),gesture:null,action:j,hasEagerState:!1,eagerState:null,next:null},a5(d)){if(p)throw Error(n(479))}else p=Dg(d,x,j,2),p!==null&&ec(p,d,2)}function a5(d){var p=d.alternate;return d===Or||p!==null&&p===Or}function SD(d,p){Yl=Jo=!0;var x=d.pending;x===null?p.next=p:(p.next=x.next,x.next=p),d.pending=p}function CD(d,p,x){if((x&4194048)!==0){var j=p.lanes;j&=d.pendingLanes,x|=j,p.lanes=x,Ke(d,x)}}var Xb={readContext:Da,use:o0,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useLayoutEffect:Is,useInsertionEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useSyncExternalStore:Is,useId:Is,useHostTransitionStatus:Is,useFormState:Is,useActionState:Is,useOptimistic:Is,useMemoCache:Is,useCacheRefresh:Is};Xb.useEffectEvent=Is;var ED={readContext:Da,use:o0,useCallback:function(d,p){return ma().memoizedState=[d,p===void 0?null:p],d},useContext:Da,useEffect:dD,useImperativeHandle:function(d,p,x){x=x!=null?x.concat([d]):null,c0(4194308,4,mD.bind(null,p,d),x)},useLayoutEffect:function(d,p){return c0(4194308,4,d,p)},useInsertionEffect:function(d,p){c0(4,2,d,p)},useMemo:function(d,p){var x=ma();p=p===void 0?null:p;var j=d();if(Po){De(!0);try{d()}finally{De(!1)}}return x.memoizedState=[j,p],j},useReducer:function(d,p,x){var j=ma();if(x!==void 0){var D=x(p);if(Po){De(!0);try{x(p)}finally{De(!1)}}}else D=p;return j.memoizedState=j.baseState=D,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:D},j.queue=d,d=d.dispatch=Hfe.bind(null,Or,d),[j.memoizedState,d]},useRef:function(d){var p=ma();return d={current:d},p.memoizedState=d},useState:function(d){d=Md(d);var p=d.queue,x=_D.bind(null,Or,p);return p.dispatch=x,[d.memoizedState,x]},useDebugValue:C3,useDeferredValue:function(d,p){var x=ma();return E3(x,d,p)},useTransition:function(){var d=Md(!1);return d=vD.bind(null,Or,d.queue,!0,!1),ma().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,p,x){var j=Or,D=ma();if(_n){if(x===void 0)throw Error(n(407));x=x()}else{if(x=p(),zs===null)throw Error(n(349));(In&127)!==0||Du(j,p,x)}D.memoizedState=x;var $={value:x,getSnapshot:p};return D.queue=$,dD(Wb.bind(null,j,$,d),[d]),j.flags|=2048,Rh(9,{destroy:void 0},Hb.bind(null,j,$,x,p),null),x},useId:function(){var d=ma(),p=zs.identifierPrefix;if(_n){var x=Gl,j=Wl;x=(j&~(1<<32-lt(j)-1)).toString(32)+x,p="_"+p+"R_"+x,x=Gi++,0<x&&(p+="H"+x.toString(32)),p+="_"}else x=Kg++,p="_"+p+"r_"+x.toString(32)+"_";return d.memoizedState=p},useHostTransitionStatus:T3,useFormState:Qc,useActionState:Qc,useOptimistic:function(d){var p=ma();p.memoizedState=p.baseState=d;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return p.queue=x,p=I3.bind(null,Or,!0,x),x.dispatch=p,[d,p]},useMemoCache:Oh,useCacheRefresh:function(){return ma().memoizedState=qfe.bind(null,Or)},useEffectEvent:function(d){var p=ma(),x={impl:d};return p.memoizedState=x,function(){if((ls&2)!==0)throw Error(n(440));return x.impl.apply(void 0,arguments)}}},P3={readContext:Da,use:o0,useCallback:xD,useContext:Da,useEffect:S3,useImperativeHandle:gD,useInsertionEffect:fD,useLayoutEffect:pD,useMemo:yD,useReducer:Qg,useRef:i5,useState:function(){return Qg(Xc)},useDebugValue:C3,useDeferredValue:function(d,p){var x=yi();return bD(x,Dr.memoizedState,d,p)},useTransition:function(){var d=Qg(Xc)[0],p=yi().memoizedState;return[typeof d=="boolean"?d:Od(d),p]},useSyncExternalStore:Zg,useId:jD,useHostTransitionStatus:T3,useFormState:Bu,useActionState:Bu,useOptimistic:function(d,p){var x=yi();return t5(x,Dr,d,p)},useMemoCache:Oh,useCacheRefresh:kD};P3.useEffectEvent=hD;var AD={readContext:Da,use:o0,useCallback:xD,useContext:Da,useEffect:S3,useImperativeHandle:gD,useInsertionEffect:fD,useLayoutEffect:pD,useMemo:yD,useReducer:Jg,useRef:i5,useState:function(){return Jg(Xc)},useDebugValue:C3,useDeferredValue:function(d,p){var x=yi();return Dr===null?E3(x,d,p):bD(x,Dr.memoizedState,d,p)},useTransition:function(){var d=Jg(Xc)[0],p=yi().memoizedState;return[typeof d=="boolean"?d:Od(d),p]},useSyncExternalStore:Zg,useId:jD,useHostTransitionStatus:T3,useFormState:rx,useActionState:rx,useOptimistic:function(d,p){var x=yi();return Dr!==null?t5(x,Dr,d,p):(x.baseState=d,[d,x.queue.dispatch])},useMemoCache:Oh,useCacheRefresh:kD};AD.useEffectEvent=hD;function L3(d,p,x,j){p=d.memoizedState,x=x(j,p),x=x==null?p:f({},p,x),d.memoizedState=x,d.lanes===0&&(d.updateQueue.baseState=x)}var O3={enqueueSetState:function(d,p,x){d=d._reactInternals;var j=kc(),D=Ur(j);D.payload=p,x!=null&&(D.callback=x),p=dn(d,D,j),p!==null&&(ec(p,d,j),as(p,d,j))},enqueueReplaceState:function(d,p,x){d=d._reactInternals;var j=kc(),D=Ur(j);D.tag=1,D.payload=p,x!=null&&(D.callback=x),p=dn(d,D,j),p!==null&&(ec(p,d,j),as(p,d,j))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var x=kc(),j=Ur(x);j.tag=2,p!=null&&(j.callback=p),p=dn(d,j,x),p!==null&&(ec(p,d,x),as(p,d,x))}};function TD(d,p,x,j,D,$,ne){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(j,$,ne):p.prototype&&p.prototype.isPureReactComponent?!Tu(x,j)||!Tu(D,$):!0}function ID(d,p,x,j){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(x,j),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(x,j),p.state!==d&&O3.enqueueReplaceState(p,p.state,null)}function Wp(d,p){var x=p;if("ref"in p){x={};for(var j in p)j!=="ref"&&(x[j]=p[j])}if(d=d.defaultProps){x===p&&(x=f({},x));for(var D in d)x[D]===void 0&&(x[D]=d[D])}return x}function PD(d){Mp(d)}function LD(d){console.error(d)}function OD(d){Mp(d)}function o5(d,p){try{var x=d.onUncaughtError;x(p.value,{componentStack:p.stack})}catch(j){setTimeout(function(){throw j})}}function MD(d,p,x){try{var j=d.onCaughtError;j(x.value,{componentStack:x.stack,errorBoundary:p.tag===1?p.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function M3(d,p,x){return x=Ur(x),x.tag=3,x.payload={element:null},x.callback=function(){o5(d,p)},x}function RD(d){return d=Ur(d),d.tag=3,d}function DD(d,p,x,j){var D=x.type.getDerivedStateFromError;if(typeof D=="function"){var $=j.value;d.payload=function(){return D($)},d.callback=function(){MD(p,x,j)}}var ne=x.stateNode;ne!==null&&typeof ne.componentDidCatch=="function"&&(d.callback=function(){MD(p,x,j),typeof D!="function"&&(p0===null?p0=new Set([this]):p0.add(this));var ye=j.stack;this.componentDidCatch(j.value,{componentStack:ye!==null?ye:""})})}function Wfe(d,p,x,j,D){if(x.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){if(p=x.alternate,p!==null&&Td(p,x,D,!0),x=si.current,x!==null){switch(x.tag){case 31:case 13:return qn===null?b5():x.alternate===null&&Ki===0&&(Ki=3),x.flags&=-257,x.flags|=65536,x.lanes=D,j===Be?x.flags|=16384:(p=x.updateQueue,p===null?x.updateQueue=new Set([j]):p.add(j),aC(d,j,D)),!1;case 22:return x.flags|=65536,j===Be?x.flags|=16384:(p=x.updateQueue,p===null?(p={transitions:null,markerInstances:null,retryQueue:new Set([j])},x.updateQueue=p):(x=p.retryQueue,x===null?p.retryQueue=new Set([j]):x.add(j)),aC(d,j,D)),!1}throw Error(n(435,x.tag))}return aC(d,j,D),b5(),!1}if(_n)return p=si.current,p!==null?((p.flags&65536)===0&&(p.flags|=256),p.flags|=65536,p.lanes=D,j!==wc&&(d=Error(n(422),{cause:j}),s0(Vl(d,x)))):(j!==wc&&(p=Error(n(423),{cause:j}),s0(Vl(p,x))),d=d.current.alternate,d.flags|=65536,D&=-D,d.lanes|=D,j=Vl(j,x),D=M3(d.stateNode,j,D),aa(d,D),Ki!==4&&(Ki=2)),!1;var $=Error(n(520),{cause:j});if($=Vl($,x),sv===null?sv=[$]:sv.push($),Ki!==4&&(Ki=2),p===null)return!0;j=Vl(j,x),x=p;do{switch(x.tag){case 3:return x.flags|=65536,d=D&-D,x.lanes|=d,d=M3(x.stateNode,j,d),aa(x,d),!1;case 1:if(p=x.type,$=x.stateNode,(x.flags&128)===0&&(typeof p.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(p0===null||!p0.has($))))return x.flags|=65536,D&=-D,x.lanes|=D,D=RD(D),DD(D,d,x,j),aa(x,D),!1}x=x.return}while(x!==null);return!1}var R3=Error(n(461)),ga=!1;function Lo(d,p,x,j){p.child=d===null?nn(p,null,x,j):Us(p,d.child,x,j)}function BD(d,p,x,j,D){x=x.render;var $=p.ref;if("ref"in j){var ne={};for(var ye in j)ye!=="ref"&&(ne[ye]=j[ye])}else ne=j;return Id(p),j=zb(d,p,x,ne,$,D),ye=Vb(),d!==null&&!ga?(qb(d,p,D),Dh(d,p,D)):(_n&&ye&&Bb(p),p.flags|=1,Lo(d,p,j,D),p.child)}function FD(d,p,x,j,D){if(d===null){var $=x.type;return typeof $=="function"&&!Fg($)&&$.defaultProps===void 0&&x.compare===null?(p.tag=15,p.type=$,$D(d,p,$,j,D)):(d=t0(x.type,null,j,p,p.mode,D),d.ref=p.ref,d.return=p,p.child=d)}if($=d.child,!q3(d,D)){var ne=$.memoizedProps;if(x=x.compare,x=x!==null?x:Tu,x(ne,j)&&d.ref===p.ref)return Dh(d,p,D)}return p.flags|=1,d=zl($,j),d.ref=p.ref,d.return=p,p.child=d}function $D(d,p,x,j,D){if(d!==null){var $=d.memoizedProps;if(Tu($,j)&&d.ref===p.ref)if(ga=!1,p.pendingProps=j=$,q3(d,D))(d.flags&131072)!==0&&(ga=!0);else return p.lanes=d.lanes,Dh(d,p,D)}return D3(d,p,x,j,D)}function UD(d,p,x,j){var D=j.children,$=d!==null?d.memoizedState:null;if(d===null&&p.stateNode===null&&(p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),j.mode==="hidden"){if((p.flags&128)!==0){if($=$!==null?$.baseLanes|x:x,d!==null){for(j=p.child=d.child,D=0;j!==null;)D=D|j.lanes|j.childLanes,j=j.sibling;j=D&~$}else j=0,p.child=null;return zD(d,p,$,x,j)}if((x&536870912)!==0)p.memoizedState={baseLanes:0,cachePool:null},d!==null&&ke(p,$!==null?$.cachePool:null),$!==null?ni(p,$):Qn(),Hi(p);else return j=p.lanes=536870912,zD(d,p,$!==null?$.baseLanes|x:x,x,j)}else $!==null?(ke(p,$.cachePool),ni(p,$),Wi(),p.memoizedState=null):(d!==null&&ke(p,null),Qn(),Wi());return Lo(d,p,D,x),p.child}function Qb(d,p){return d!==null&&d.tag===22||p.stateNode!==null||(p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.sibling}function zD(d,p,x,j,D){var $=ve();return $=$===null?null:{parent:Pi._currentValue,pool:$},p.memoizedState={baseLanes:x,cachePool:$},d!==null&&ke(p,null),Qn(),Hi(p),d!==null&&Td(d,p,j,!0),p.childLanes=D,null}function l5(d,p){return p=u5({mode:p.mode,children:p.children},d.mode),p.ref=d.ref,d.child=p,p.return=d,p}function VD(d,p,x){return Us(p,d.child,null,x),d=l5(p,p.pendingProps),d.flags|=2,xs(p),p.memoizedState=null,d}function Gfe(d,p,x){var j=p.pendingProps,D=(p.flags&128)!==0;if(p.flags&=-129,d===null){if(_n){if(j.mode==="hidden")return d=l5(p,j),p.lanes=536870912,Qb(null,d);if(os(p),(d=$s)?(d=tB(d,gi),d=d!==null&&d.data==="&"?d:null,d!==null&&(p.memoizedState={dehydrated:d,treeContext:Sd!==null?{id:Wl,overflow:Gl}:null,retryLane:536870912,hydrationErrors:null},x=$g(d),x.return=p,p.child=x,Ma=p,$s=null)):d=null,d===null)throw Cd(p);return p.lanes=536870912,null}return l5(p,j)}var $=d.memoizedState;if($!==null){var ne=$.dehydrated;if(os(p),D)if(p.flags&256)p.flags&=-257,p=VD(d,p,x);else if(p.memoizedState!==null)p.child=d.child,p.flags|=128,p=null;else throw Error(n(558));else if(ga||Td(d,p,x,!1),D=(x&d.childLanes)!==0,ga||D){if(j=zs,j!==null&&(ne=Gt(j,x),ne!==0&&ne!==$.retryLane))throw $.retryLane=ne,Ou(d,ne),ec(j,d,ne),R3;b5(),p=VD(d,p,x)}else d=$.treeContext,$s=Jc(ne.nextSibling),Ma=p,_n=!0,Io=null,gi=!1,d!==null&&Jw(p,d),p=l5(p,j),p.flags|=4096;return p}return d=zl(d.child,{mode:j.mode,children:j.children}),d.ref=p.ref,p.child=d,d.return=p,d}function c5(d,p){var x=p.ref;if(x===null)d!==null&&d.ref!==null&&(p.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(n(284));(d===null||d.ref!==x)&&(p.flags|=4194816)}}function D3(d,p,x,j,D){return Id(p),x=zb(d,p,x,j,void 0,D),j=Vb(),d!==null&&!ga?(qb(d,p,D),Dh(d,p,D)):(_n&&j&&Bb(p),p.flags|=1,Lo(d,p,x,D),p.child)}function qD(d,p,x,j,D,$){return Id(p),p.updateQueue=null,x=Ru(p,j,x,D),Yg(d),j=Vb(),d!==null&&!ga?(qb(d,p,$),Dh(d,p,$)):(_n&&j&&Bb(p),p.flags|=1,Lo(d,p,x,$),p.child)}function HD(d,p,x,j,D){if(Id(p),p.stateNode===null){var $=Oa,ne=x.contextType;typeof ne=="object"&&ne!==null&&($=Da(ne)),$=new x(j,$),p.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=O3,p.stateNode=$,$._reactInternals=p,$=p.stateNode,$.props=j,$.state=p.memoizedState,$.refs={},Zt(p),ne=x.contextType,$.context=typeof ne=="object"&&ne!==null?Da(ne):Oa,$.state=p.memoizedState,ne=x.getDerivedStateFromProps,typeof ne=="function"&&(L3(p,x,ne,j),$.state=p.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(ne=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),ne!==$.state&&O3.enqueueReplaceState($,$.state,null),Vi(p,j,$,D),Ts(),$.state=p.memoizedState),typeof $.componentDidMount=="function"&&(p.flags|=4194308),j=!0}else if(d===null){$=p.stateNode;var ye=p.memoizedProps,Pe=Wp(x,ye);$.props=Pe;var Ze=$.context,yt=x.contextType;ne=Oa,typeof yt=="object"&&yt!==null&&(ne=Da(yt));var Et=x.getDerivedStateFromProps;yt=typeof Et=="function"||typeof $.getSnapshotBeforeUpdate=="function",ye=p.pendingProps!==ye,yt||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ye||Ze!==ne)&&ID(p,$,j,ne),ar=!1;var st=p.memoizedState;$.state=st,Vi(p,j,$,D),Ts(),Ze=p.memoizedState,ye||st!==Ze||ar?(typeof Et=="function"&&(L3(p,x,Et,j),Ze=p.memoizedState),(Pe=ar||TD(p,x,Pe,j,st,Ze,ne))?(yt||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(p.flags|=4194308)):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=j,p.memoizedState=Ze),$.props=j,$.state=Ze,$.context=ne,j=Pe):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),j=!1)}else{$=p.stateNode,ri(d,p),ne=p.memoizedProps,yt=Wp(x,ne),$.props=yt,Et=p.pendingProps,st=$.context,Ze=x.contextType,Pe=Oa,typeof Ze=="object"&&Ze!==null&&(Pe=Da(Ze)),ye=x.getDerivedStateFromProps,(Ze=typeof ye=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ne!==Et||st!==Pe)&&ID(p,$,j,Pe),ar=!1,st=p.memoizedState,$.state=st,Vi(p,j,$,D),Ts();var ot=p.memoizedState;ne!==Et||st!==ot||ar||d!==null&&d.dependencies!==null&&Hg(d.dependencies)?(typeof ye=="function"&&(L3(p,x,ye,j),ot=p.memoizedState),(yt=ar||TD(p,x,yt,j,st,ot,Pe)||d!==null&&d.dependencies!==null&&Hg(d.dependencies))?(Ze||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(j,ot,Pe),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(j,ot,Pe)),typeof $.componentDidUpdate=="function"&&(p.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof $.componentDidUpdate!="function"||ne===d.memoizedProps&&st===d.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ne===d.memoizedProps&&st===d.memoizedState||(p.flags|=1024),p.memoizedProps=j,p.memoizedState=ot),$.props=j,$.state=ot,$.context=Pe,j=yt):(typeof $.componentDidUpdate!="function"||ne===d.memoizedProps&&st===d.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ne===d.memoizedProps&&st===d.memoizedState||(p.flags|=1024),j=!1)}return $=j,c5(d,p),j=(p.flags&128)!==0,$||j?($=p.stateNode,x=j&&typeof x.getDerivedStateFromError!="function"?null:$.render(),p.flags|=1,d!==null&&j?(p.child=Us(p,d.child,null,D),p.child=Us(p,null,x,D)):Lo(d,p,x,D),p.memoizedState=$.state,d=p.child):d=Dh(d,p,D),d}function WD(d,p,x,j){return Ph(),p.flags|=256,Lo(d,p,x,j),p.child}var B3={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function F3(d){return{baseLanes:d,cachePool:Ee()}}function $3(d,p,x){return d=d!==null?d.childLanes&~x:0,p&&(d|=jc),d}function GD(d,p,x){var j=p.pendingProps,D=!1,$=(p.flags&128)!==0,ne;if((ne=$)||(ne=d!==null&&d.memoizedState===null?!1:(Rn.current&2)!==0),ne&&(D=!0,p.flags&=-129),ne=(p.flags&32)!==0,p.flags&=-33,d===null){if(_n){if(D?Li(p):Wi(),(d=$s)?(d=tB(d,gi),d=d!==null&&d.data!=="&"?d:null,d!==null&&(p.memoizedState={dehydrated:d,treeContext:Sd!==null?{id:Wl,overflow:Gl}:null,retryLane:536870912,hydrationErrors:null},x=$g(d),x.return=p,p.child=x,Ma=p,$s=null)):d=null,d===null)throw Cd(p);return NC(d)?p.lanes=32:p.lanes=536870912,null}var ye=j.children;return j=j.fallback,D?(Wi(),D=p.mode,ye=u5({mode:"hidden",children:ye},D),j=_d(j,D,x,null),ye.return=p,j.return=p,ye.sibling=j,p.child=ye,j=p.child,j.memoizedState=F3(x),j.childLanes=$3(d,ne,x),p.memoizedState=B3,Qb(null,j)):(Li(p),U3(p,ye))}var Pe=d.memoizedState;if(Pe!==null&&(ye=Pe.dehydrated,ye!==null)){if($)p.flags&256?(Li(p),p.flags&=-257,p=z3(d,p,x)):p.memoizedState!==null?(Wi(),p.child=d.child,p.flags|=128,p=null):(Wi(),ye=j.fallback,D=p.mode,j=u5({mode:"visible",children:j.children},D),ye=_d(ye,D,x,null),ye.flags|=2,j.return=p,ye.return=p,j.sibling=ye,p.child=j,Us(p,d.child,null,x),j=p.child,j.memoizedState=F3(x),j.childLanes=$3(d,ne,x),p.memoizedState=B3,p=Qb(null,j));else if(Li(p),NC(ye)){if(ne=ye.nextSibling&&ye.nextSibling.dataset,ne)var Ze=ne.dgst;ne=Ze,j=Error(n(419)),j.stack="",j.digest=ne,s0({value:j,source:null,stack:null}),p=z3(d,p,x)}else if(ga||Td(d,p,x,!1),ne=(x&d.childLanes)!==0,ga||ne){if(ne=zs,ne!==null&&(j=Gt(ne,x),j!==0&&j!==Pe.retryLane))throw Pe.retryLane=j,Ou(d,j),ec(ne,d,j),R3;wC(ye)||b5(),p=z3(d,p,x)}else wC(ye)?(p.flags|=192,p.child=d.child,p=null):(d=Pe.treeContext,$s=Jc(ye.nextSibling),Ma=p,_n=!0,Io=null,gi=!1,d!==null&&Jw(p,d),p=U3(p,j.children),p.flags|=4096);return p}return D?(Wi(),ye=j.fallback,D=p.mode,Pe=d.child,Ze=Pe.sibling,j=zl(Pe,{mode:"hidden",children:j.children}),j.subtreeFlags=Pe.subtreeFlags&65011712,Ze!==null?ye=zl(Ze,ye):(ye=_d(ye,D,x,null),ye.flags|=2),ye.return=p,j.return=p,j.sibling=ye,p.child=j,Qb(null,j),j=p.child,ye=d.child.memoizedState,ye===null?ye=F3(x):(D=ye.cachePool,D!==null?(Pe=Pi._currentValue,D=D.parent!==Pe?{parent:Pe,pool:Pe}:D):D=Ee(),ye={baseLanes:ye.baseLanes|x,cachePool:D}),j.memoizedState=ye,j.childLanes=$3(d,ne,x),p.memoizedState=B3,Qb(d.child,j)):(Li(p),x=d.child,d=x.sibling,x=zl(x,{mode:"visible",children:j.children}),x.return=p,x.sibling=null,d!==null&&(ne=p.deletions,ne===null?(p.deletions=[d],p.flags|=16):ne.push(d)),p.child=x,p.memoizedState=null,x)}function U3(d,p){return p=u5({mode:"visible",children:p},d.mode),p.return=d,d.child=p}function u5(d,p){return d=io(22,d,null,p),d.lanes=0,d}function z3(d,p,x){return Us(p,d.child,null,x),d=U3(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function KD(d,p,x){d.lanes|=p;var j=d.alternate;j!==null&&(j.lanes|=p),i0(d.return,p,x)}function V3(d,p,x,j,D,$){var ne=d.memoizedState;ne===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:j,tail:x,tailMode:D,treeForkCount:$}:(ne.isBackwards=p,ne.rendering=null,ne.renderingStartTime=0,ne.last=j,ne.tail=x,ne.tailMode=D,ne.treeForkCount=$)}function YD(d,p,x){var j=p.pendingProps,D=j.revealOrder,$=j.tail;j=j.children;var ne=Rn.current,ye=(ne&2)!==0;if(ye?(ne=ne&1|2,p.flags|=128):ne&=1,H(Rn,ne),Lo(d,p,j,x),j=_n?Up:0,!ye&&d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&KD(d,x,p);else if(d.tag===19)KD(d,x,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(D){case"forwards":for(x=p.child,D=null;x!==null;)d=x.alternate,d!==null&&oo(d)===null&&(D=x),x=x.sibling;x=D,x===null?(D=p.child,p.child=null):(D=x.sibling,x.sibling=null),V3(p,!1,D,x,$,j);break;case"backwards":case"unstable_legacy-backwards":for(x=null,D=p.child,p.child=null;D!==null;){if(d=D.alternate,d!==null&&oo(d)===null){p.child=D;break}d=D.sibling,D.sibling=x,x=D,D=d}V3(p,!0,x,null,$,j);break;case"together":V3(p,!1,null,null,void 0,j);break;default:p.memoizedState=null}return p.child}function Dh(d,p,x){if(d!==null&&(p.dependencies=d.dependencies),f0|=p.lanes,(x&p.childLanes)===0)if(d!==null){if(Td(d,p,x,!1),(x&p.childLanes)===0)return null}else return null;if(d!==null&&p.child!==d.child)throw Error(n(153));if(p.child!==null){for(d=p.child,x=zl(d,d.pendingProps),p.child=x,x.return=p;d.sibling!==null;)d=d.sibling,x=x.sibling=zl(d,d.pendingProps),x.return=p;x.sibling=null}return p.child}function q3(d,p){return(d.lanes&p)!==0?!0:(d=d.dependencies,!!(d!==null&&Hg(d)))}function Kfe(d,p,x){switch(p.tag){case 3:pe(p,p.stateNode.containerInfo),Ad(p,Pi,d.memoizedState.cache),Ph();break;case 27:case 5:ue(p);break;case 4:pe(p,p.stateNode.containerInfo);break;case 10:Ad(p,p.type,p.memoizedProps.value);break;case 31:if(p.memoizedState!==null)return p.flags|=128,os(p),null;break;case 13:var j=p.memoizedState;if(j!==null)return j.dehydrated!==null?(Li(p),p.flags|=128,null):(x&p.child.childLanes)!==0?GD(d,p,x):(Li(p),d=Dh(d,p,x),d!==null?d.sibling:null);Li(p);break;case 19:var D=(d.flags&128)!==0;if(j=(x&p.childLanes)!==0,j||(Td(d,p,x,!1),j=(x&p.childLanes)!==0),D){if(j)return YD(d,p,x);p.flags|=128}if(D=p.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),H(Rn,Rn.current),j)break;return null;case 22:return p.lanes=0,UD(d,p,x,p.pendingProps);case 24:Ad(p,Pi,d.memoizedState.cache)}return Dh(d,p,x)}function XD(d,p,x){if(d!==null)if(d.memoizedProps!==p.pendingProps)ga=!0;else{if(!q3(d,x)&&(p.flags&128)===0)return ga=!1,Kfe(d,p,x);ga=(d.flags&131072)!==0}else ga=!1,_n&&(p.flags&1048576)!==0&&Qw(p,Up,p.index);switch(p.lanes=0,p.tag){case 16:e:{var j=p.pendingProps;if(d=Ge(p.elementType),p.type=d,typeof d=="function")Fg(d)?(j=Wp(d,j),p.tag=1,p=HD(null,p,d,j,x)):(p.tag=0,p=D3(null,p,d,j,x));else{if(d!=null){var D=d.$$typeof;if(D===I){p.tag=11,p=BD(null,p,d,j,x);break e}else if(D===_){p.tag=14,p=FD(null,p,d,j,x);break e}}throw p=V(d)||d,Error(n(306,p,""))}}return p;case 0:return D3(d,p,p.type,p.pendingProps,x);case 1:return j=p.type,D=Wp(j,p.pendingProps),HD(d,p,j,D,x);case 3:e:{if(pe(p,p.stateNode.containerInfo),d===null)throw Error(n(387));j=p.pendingProps;var $=p.memoizedState;D=$.element,ri(d,p),Vi(p,j,null,x);var ne=p.memoizedState;if(j=ne.cache,Ad(p,Pi,j),j!==$.cache&&Lh(p,[Pi],x,!0),Ts(),j=ne.element,$.isDehydrated)if($={element:j,isDehydrated:!1,cache:ne.cache},p.updateQueue.baseState=$,p.memoizedState=$,p.flags&256){p=WD(d,p,j,x);break e}else if(j!==D){D=Vl(Error(n(424)),p),s0(D),p=WD(d,p,j,x);break e}else for(d=p.stateNode.containerInfo,d.nodeType===9?d=d.body:d=d.nodeName==="HTML"?d.ownerDocument.body:d,$s=Jc(d.firstChild),Ma=p,_n=!0,Io=null,gi=!0,x=nn(p,null,j,x),p.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Ph(),j===D){p=Dh(d,p,x);break e}Lo(d,p,j,x)}p=p.child}return p;case 26:return c5(d,p),d===null?(x=oB(p.type,null,p.pendingProps,null))?p.memoizedState=x:_n||(x=p.type,d=p.pendingProps,j=S5(xe.current).createElement(x),j[Fr]=p,j[ln]=d,Oo(j,x,d),tn(j),p.stateNode=j):p.memoizedState=oB(p.type,d.memoizedProps,p.pendingProps,d.memoizedState),null;case 27:return ue(p),d===null&&_n&&(j=p.stateNode=sB(p.type,p.pendingProps,xe.current),Ma=p,gi=!0,D=$s,y0(p.type)?(jC=D,$s=Jc(j.firstChild)):$s=D),Lo(d,p,p.pendingProps.children,x),c5(d,p),d===null&&(p.flags|=4194304),p.child;case 5:return d===null&&_n&&((D=j=$s)&&(j=k0e(j,p.type,p.pendingProps,gi),j!==null?(p.stateNode=j,Ma=p,$s=Jc(j.firstChild),gi=!1,D=!0):D=!1),D||Cd(p)),ue(p),D=p.type,$=p.pendingProps,ne=d!==null?d.memoizedProps:null,j=$.children,yC(D,$)?j=null:ne!==null&&yC(D,ne)&&(p.flags|=32),p.memoizedState!==null&&(D=zb(d,p,_3,null,null,x),hv._currentValue=D),c5(d,p),Lo(d,p,j,x),p.child;case 6:return d===null&&_n&&((d=x=$s)&&(x=_0e(x,p.pendingProps,gi),x!==null?(p.stateNode=x,Ma=p,$s=null,d=!0):d=!1),d||Cd(p)),null;case 13:return GD(d,p,x);case 4:return pe(p,p.stateNode.containerInfo),j=p.pendingProps,d===null?p.child=Us(p,null,j,x):Lo(d,p,j,x),p.child;case 11:return BD(d,p,p.type,p.pendingProps,x);case 7:return Lo(d,p,p.pendingProps,x),p.child;case 8:return Lo(d,p,p.pendingProps.children,x),p.child;case 12:return Lo(d,p,p.pendingProps.children,x),p.child;case 10:return j=p.pendingProps,Ad(p,p.type,j.value),Lo(d,p,j.children,x),p.child;case 9:return D=p.type._context,j=p.pendingProps.children,Id(p),D=Da(D),j=j(D),p.flags|=1,Lo(d,p,j,x),p.child;case 14:return FD(d,p,p.type,p.pendingProps,x);case 15:return $D(d,p,p.type,p.pendingProps,x);case 19:return YD(d,p,x);case 31:return Gfe(d,p,x);case 22:return UD(d,p,x,p.pendingProps);case 24:return Id(p),j=Da(Pi),d===null?(D=ve(),D===null&&(D=zs,$=a0(),D.pooledCache=$,$.refCount++,$!==null&&(D.pooledCacheLanes|=x),D=$),p.memoizedState={parent:j,cache:D},Zt(p),Ad(p,Pi,D)):((d.lanes&x)!==0&&(ri(d,p),Vi(p,null,null,x),Ts()),D=d.memoizedState,$=p.memoizedState,D.parent!==j?(D={parent:j,cache:j},p.memoizedState=D,p.lanes===0&&(p.memoizedState=p.updateQueue.baseState=D),Ad(p,Pi,j)):(j=$.cache,Ad(p,Pi,j),j!==D.cache&&Lh(p,[Pi],x,!0))),Lo(d,p,p.pendingProps.children,x),p.child;case 29:throw p.pendingProps}throw Error(n(156,p.tag))}function Bh(d){d.flags|=4}function H3(d,p,x,j,D){if((p=(d.mode&32)!==0)&&(p=!1),p){if(d.flags|=16777216,(D&335544128)===D)if(d.stateNode.complete)d.flags|=8192;else if(j9())d.flags|=8192;else throw dt=Be,Qe}else d.flags&=-16777217}function QD(d,p){if(p.type!=="stylesheet"||(p.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!hB(p))if(j9())d.flags|=8192;else throw dt=Be,Qe}function d5(d,p){p!==null&&(d.flags|=4),d.flags&16384&&(p=d.tag!==22?nr():536870912,d.lanes|=p,ax|=p)}function Jb(d,p){if(!_n)switch(d.tailMode){case"hidden":p=d.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?d.tail=null:x.sibling=null;break;case"collapsed":x=d.tail;for(var j=null;x!==null;)x.alternate!==null&&(j=x),x=x.sibling;j===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:j.sibling=null}}function ii(d){var p=d.alternate!==null&&d.alternate.child===d.child,x=0,j=0;if(p)for(var D=d.child;D!==null;)x|=D.lanes|D.childLanes,j|=D.subtreeFlags&65011712,j|=D.flags&65011712,D.return=d,D=D.sibling;else for(D=d.child;D!==null;)x|=D.lanes|D.childLanes,j|=D.subtreeFlags,j|=D.flags,D.return=d,D=D.sibling;return d.subtreeFlags|=j,d.childLanes=x,p}function Yfe(d,p,x){var j=p.pendingProps;switch(Vg(p),p.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ii(p),null;case 1:return ii(p),null;case 3:return x=p.stateNode,j=null,d!==null&&(j=d.memoizedState.cache),p.memoizedState.cache!==j&&(p.flags|=2048),Kl(Pi),K(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(d===null||d.child===null)&&(Ra(p)?Bh(p):d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,$b())),ii(p),null;case 26:var D=p.type,$=p.memoizedState;return d===null?(Bh(p),$!==null?(ii(p),QD(p,$)):(ii(p),H3(p,D,null,j,x))):$?$!==d.memoizedState?(Bh(p),ii(p),QD(p,$)):(ii(p),p.flags&=-16777217):(d=d.memoizedProps,d!==j&&Bh(p),ii(p),H3(p,D,d,j,x)),null;case 27:if(fe(p),x=xe.current,D=p.type,d!==null&&p.stateNode!=null)d.memoizedProps!==j&&Bh(p);else{if(!j){if(p.stateNode===null)throw Error(n(166));return ii(p),null}d=re.current,Ra(p)?Fb(p):(d=sB(D,j,x),p.stateNode=d,Bh(p))}return ii(p),null;case 5:if(fe(p),D=p.type,d!==null&&p.stateNode!=null)d.memoizedProps!==j&&Bh(p);else{if(!j){if(p.stateNode===null)throw Error(n(166));return ii(p),null}if($=re.current,Ra(p))Fb(p);else{var ne=S5(xe.current);switch($){case 1:$=ne.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:$=ne.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":$=ne.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":$=ne.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":$=ne.createElement("div"),$.innerHTML="<script><\/script>",$=$.removeChild($.firstChild);break;case"select":$=typeof j.is=="string"?ne.createElement("select",{is:j.is}):ne.createElement("select"),j.multiple?$.multiple=!0:j.size&&($.size=j.size);break;default:$=typeof j.is=="string"?ne.createElement(D,{is:j.is}):ne.createElement(D)}}$[Fr]=p,$[ln]=j;e:for(ne=p.child;ne!==null;){if(ne.tag===5||ne.tag===6)$.appendChild(ne.stateNode);else if(ne.tag!==4&&ne.tag!==27&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===p)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===p)break e;ne=ne.return}ne.sibling.return=ne.return,ne=ne.sibling}p.stateNode=$;e:switch(Oo($,D,j),D){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}j&&Bh(p)}}return ii(p),H3(p,p.type,d===null?null:d.memoizedProps,p.pendingProps,x),null;case 6:if(d&&p.stateNode!=null)d.memoizedProps!==j&&Bh(p);else{if(typeof j!="string"&&p.stateNode===null)throw Error(n(166));if(d=xe.current,Ra(p)){if(d=p.stateNode,x=p.memoizedProps,j=null,D=Ma,D!==null)switch(D.tag){case 27:case 5:j=D.memoizedProps}d[Fr]=p,d=!!(d.nodeValue===x||j!==null&&j.suppressHydrationWarning===!0||G9(d.nodeValue,x)),d||Cd(p,!0)}else d=S5(d).createTextNode(j),d[Fr]=p,p.stateNode=d}return ii(p),null;case 31:if(x=p.memoizedState,d===null||d.memoizedState!==null){if(j=Ra(p),x!==null){if(d===null){if(!j)throw Error(n(318));if(d=p.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(557));d[Fr]=p}else Ph(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;ii(p),d=!1}else x=$b(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=x),d=!0;if(!d)return p.flags&256?(xs(p),p):(xs(p),null);if((p.flags&128)!==0)throw Error(n(558))}return ii(p),null;case 13:if(j=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(D=Ra(p),j!==null&&j.dehydrated!==null){if(d===null){if(!D)throw Error(n(318));if(D=p.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(n(317));D[Fr]=p}else Ph(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;ii(p),D=!1}else D=$b(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=D),D=!0;if(!D)return p.flags&256?(xs(p),p):(xs(p),null)}return xs(p),(p.flags&128)!==0?(p.lanes=x,p):(x=j!==null,d=d!==null&&d.memoizedState!==null,x&&(j=p.child,D=null,j.alternate!==null&&j.alternate.memoizedState!==null&&j.alternate.memoizedState.cachePool!==null&&(D=j.alternate.memoizedState.cachePool.pool),$=null,j.memoizedState!==null&&j.memoizedState.cachePool!==null&&($=j.memoizedState.cachePool.pool),$!==D&&(j.flags|=2048)),x!==d&&x&&(p.child.flags|=8192),d5(p,p.updateQueue),ii(p),null);case 4:return K(),d===null&&fC(p.stateNode.containerInfo),ii(p),null;case 10:return Kl(p.type),ii(p),null;case 19:if(U(Rn),j=p.memoizedState,j===null)return ii(p),null;if(D=(p.flags&128)!==0,$=j.rendering,$===null)if(D)Jb(j,!1);else{if(Ki!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if($=oo(d),$!==null){for(p.flags|=128,Jb(j,!1),d=$.updateQueue,p.updateQueue=d,d5(p,d),p.subtreeFlags=0,d=x,x=p.child;x!==null;)Fp(x,d),x=x.sibling;return H(Rn,Rn.current&1|2),_n&&xl(p,j.treeForkCount),p.child}d=d.sibling}j.tail!==null&&nt()>g5&&(p.flags|=128,D=!0,Jb(j,!1),p.lanes=4194304)}else{if(!D)if(d=oo($),d!==null){if(p.flags|=128,D=!0,d=d.updateQueue,p.updateQueue=d,d5(p,d),Jb(j,!0),j.tail===null&&j.tailMode==="hidden"&&!$.alternate&&!_n)return ii(p),null}else 2*nt()-j.renderingStartTime>g5&&x!==536870912&&(p.flags|=128,D=!0,Jb(j,!1),p.lanes=4194304);j.isBackwards?($.sibling=p.child,p.child=$):(d=j.last,d!==null?d.sibling=$:p.child=$,j.last=$)}return j.tail!==null?(d=j.tail,j.rendering=d,j.tail=d.sibling,j.renderingStartTime=nt(),d.sibling=null,x=Rn.current,H(Rn,D?x&1|2:x&1),_n&&xl(p,j.treeForkCount),d):(ii(p),null);case 22:case 23:return xs(p),oa(),j=p.memoizedState!==null,d!==null?d.memoizedState!==null!==j&&(p.flags|=8192):j&&(p.flags|=8192),j?(x&536870912)!==0&&(p.flags&128)===0&&(ii(p),p.subtreeFlags&6&&(p.flags|=8192)):ii(p),x=p.updateQueue,x!==null&&d5(p,x.retryQueue),x=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),j=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(j=p.memoizedState.cachePool.pool),j!==x&&(p.flags|=2048),d!==null&&U(ge),null;case 24:return x=null,d!==null&&(x=d.memoizedState.cache),p.memoizedState.cache!==x&&(p.flags|=2048),Kl(Pi),ii(p),null;case 25:return null;case 30:return null}throw Error(n(156,p.tag))}function Xfe(d,p){switch(Vg(p),p.tag){case 1:return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Kl(Pi),K(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 26:case 27:case 5:return fe(p),null;case 31:if(p.memoizedState!==null){if(xs(p),p.alternate===null)throw Error(n(340));Ph()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 13:if(xs(p),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(n(340));Ph()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return U(Rn),null;case 4:return K(),null;case 10:return Kl(p.type),null;case 22:case 23:return xs(p),oa(),d!==null&&U(ge),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 24:return Kl(Pi),null;case 25:return null;default:return null}}function JD(d,p){switch(Vg(p),p.tag){case 3:Kl(Pi),K();break;case 26:case 27:case 5:fe(p);break;case 4:K();break;case 31:p.memoizedState!==null&&xs(p);break;case 13:xs(p);break;case 19:U(Rn);break;case 10:Kl(p.type);break;case 22:case 23:xs(p),oa(),d!==null&&U(ge);break;case 24:Kl(Pi)}}function Zb(d,p){try{var x=p.updateQueue,j=x!==null?x.lastEffect:null;if(j!==null){var D=j.next;x=D;do{if((x.tag&d)===d){j=void 0;var $=x.create,ne=x.inst;j=$(),ne.destroy=j}x=x.next}while(x!==D)}}catch(ye){bs(p,p.return,ye)}}function d0(d,p,x){try{var j=p.updateQueue,D=j!==null?j.lastEffect:null;if(D!==null){var $=D.next;j=$;do{if((j.tag&d)===d){var ne=j.inst,ye=ne.destroy;if(ye!==void 0){ne.destroy=void 0,D=p;var Pe=x,Ze=ye;try{Ze()}catch(yt){bs(D,Pe,yt)}}}j=j.next}while(j!==$)}}catch(yt){bs(p,p.return,yt)}}function ZD(d){var p=d.updateQueue;if(p!==null){var x=d.stateNode;try{qi(p,x)}catch(j){bs(d,d.return,j)}}}function e9(d,p,x){x.props=Wp(d.type,d.memoizedProps),x.state=d.memoizedState;try{x.componentWillUnmount()}catch(j){bs(d,p,j)}}function ev(d,p){try{var x=d.ref;if(x!==null){switch(d.tag){case 26:case 27:case 5:var j=d.stateNode;break;case 30:j=d.stateNode;break;default:j=d.stateNode}typeof x=="function"?d.refCleanup=x(j):x.current=j}}catch(D){bs(d,p,D)}}function Rd(d,p){var x=d.ref,j=d.refCleanup;if(x!==null)if(typeof j=="function")try{j()}catch(D){bs(d,p,D)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(D){bs(d,p,D)}else x.current=null}function t9(d){var p=d.type,x=d.memoizedProps,j=d.stateNode;try{e:switch(p){case"button":case"input":case"select":case"textarea":x.autoFocus&&j.focus();break e;case"img":x.src?j.src=x.src:x.srcSet&&(j.srcset=x.srcSet)}}catch(D){bs(d,d.return,D)}}function W3(d,p,x){try{var j=d.stateNode;y0e(j,d.type,x,p),j[ln]=p}catch(D){bs(d,d.return,D)}}function r9(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&y0(d.type)||d.tag===4}function G3(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||r9(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&y0(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function K3(d,p,x){var j=d.tag;if(j===5||j===6)d=d.stateNode,p?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(d,p):(p=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,p.appendChild(d),x=x._reactRootContainer,x!=null||p.onclick!==null||(p.onclick=fa));else if(j!==4&&(j===27&&y0(d.type)&&(x=d.stateNode,p=null),d=d.child,d!==null))for(K3(d,p,x),d=d.sibling;d!==null;)K3(d,p,x),d=d.sibling}function h5(d,p,x){var j=d.tag;if(j===5||j===6)d=d.stateNode,p?x.insertBefore(d,p):x.appendChild(d);else if(j!==4&&(j===27&&y0(d.type)&&(x=d.stateNode),d=d.child,d!==null))for(h5(d,p,x),d=d.sibling;d!==null;)h5(d,p,x),d=d.sibling}function n9(d){var p=d.stateNode,x=d.memoizedProps;try{for(var j=d.type,D=p.attributes;D.length;)p.removeAttributeNode(D[0]);Oo(p,j,x),p[Fr]=d,p[ln]=x}catch($){bs(d,d.return,$)}}var Fh=!1,xa=!1,Y3=!1,s9=typeof WeakSet=="function"?WeakSet:Set,lo=null;function Qfe(d,p){if(d=d.containerInfo,gC=L5,d=Pu(d),Gc(d)){if("selectionStart"in d)var x={start:d.selectionStart,end:d.selectionEnd};else e:{x=(x=d.ownerDocument)&&x.defaultView||window;var j=x.getSelection&&x.getSelection();if(j&&j.rangeCount!==0){x=j.anchorNode;var D=j.anchorOffset,$=j.focusNode;j=j.focusOffset;try{x.nodeType,$.nodeType}catch{x=null;break e}var ne=0,ye=-1,Pe=-1,Ze=0,yt=0,Et=d,st=null;t:for(;;){for(var ot;Et!==x||D!==0&&Et.nodeType!==3||(ye=ne+D),Et!==$||j!==0&&Et.nodeType!==3||(Pe=ne+j),Et.nodeType===3&&(ne+=Et.nodeValue.length),(ot=Et.firstChild)!==null;)st=Et,Et=ot;for(;;){if(Et===d)break t;if(st===x&&++Ze===D&&(ye=ne),st===$&&++yt===j&&(Pe=ne),(ot=Et.nextSibling)!==null)break;Et=st,st=Et.parentNode}Et=ot}x=ye===-1||Pe===-1?null:{start:ye,end:Pe}}else x=null}x=x||{start:0,end:0}}else x=null;for(xC={focusedElem:d,selectionRange:x},L5=!1,lo=p;lo!==null;)if(p=lo,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,lo=d;else for(;lo!==null;){switch(p=lo,$=p.alternate,d=p.flags,p.tag){case 0:if((d&4)!==0&&(d=p.updateQueue,d=d!==null?d.events:null,d!==null))for(x=0;x<d.length;x++)D=d[x],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&$!==null){d=void 0,x=p,D=$.memoizedProps,$=$.memoizedState,j=x.stateNode;try{var fr=Wp(x.type,D);d=j.getSnapshotBeforeUpdate(fr,$),j.__reactInternalSnapshotBeforeUpdate=d}catch(zr){bs(x,x.return,zr)}}break;case 3:if((d&1024)!==0){if(d=p.stateNode.containerInfo,x=d.nodeType,x===9)vC(d);else if(x===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":vC(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(n(163))}if(d=p.sibling,d!==null){d.return=p.return,lo=d;break}lo=p.return}}function i9(d,p,x){var j=x.flags;switch(x.tag){case 0:case 11:case 15:Uh(d,x),j&4&&Zb(5,x);break;case 1:if(Uh(d,x),j&4)if(d=x.stateNode,p===null)try{d.componentDidMount()}catch(ne){bs(x,x.return,ne)}else{var D=Wp(x.type,p.memoizedProps);p=p.memoizedState;try{d.componentDidUpdate(D,p,d.__reactInternalSnapshotBeforeUpdate)}catch(ne){bs(x,x.return,ne)}}j&64&&ZD(x),j&512&&ev(x,x.return);break;case 3:if(Uh(d,x),j&64&&(d=x.updateQueue,d!==null)){if(p=null,x.child!==null)switch(x.child.tag){case 27:case 5:p=x.child.stateNode;break;case 1:p=x.child.stateNode}try{qi(d,p)}catch(ne){bs(x,x.return,ne)}}break;case 27:p===null&&j&4&&n9(x);case 26:case 5:Uh(d,x),p===null&&j&4&&t9(x),j&512&&ev(x,x.return);break;case 12:Uh(d,x);break;case 31:Uh(d,x),j&4&&l9(d,x);break;case 13:Uh(d,x),j&4&&c9(d,x),j&64&&(d=x.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(x=a0e.bind(null,x),S0e(d,x))));break;case 22:if(j=x.memoizedState!==null||Fh,!j){p=p!==null&&p.memoizedState!==null||xa,D=Fh;var $=xa;Fh=j,(xa=p)&&!$?zh(d,x,(x.subtreeFlags&8772)!==0):Uh(d,x),Fh=D,xa=$}break;case 30:break;default:Uh(d,x)}}function a9(d){var p=d.alternate;p!==null&&(d.alternate=null,a9(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&$e(p)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var bi=null,Xl=!1;function $h(d,p,x){for(x=x.child;x!==null;)o9(d,p,x),x=x.sibling}function o9(d,p,x){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(ft,x)}catch{}switch(x.tag){case 26:xa||Rd(x,p),$h(d,p,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:xa||Rd(x,p);var j=bi,D=Xl;y0(x.type)&&(bi=x.stateNode,Xl=!1),$h(d,p,x),cv(x.stateNode),bi=j,Xl=D;break;case 5:xa||Rd(x,p);case 6:if(j=bi,D=Xl,bi=null,$h(d,p,x),bi=j,Xl=D,bi!==null)if(Xl)try{(bi.nodeType===9?bi.body:bi.nodeName==="HTML"?bi.ownerDocument.body:bi).removeChild(x.stateNode)}catch($){bs(x,p,$)}else try{bi.removeChild(x.stateNode)}catch($){bs(x,p,$)}break;case 18:bi!==null&&(Xl?(d=bi,Z9(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,x.stateNode),px(d)):Z9(bi,x.stateNode));break;case 4:j=bi,D=Xl,bi=x.stateNode.containerInfo,Xl=!0,$h(d,p,x),bi=j,Xl=D;break;case 0:case 11:case 14:case 15:d0(2,x,p),xa||d0(4,x,p),$h(d,p,x);break;case 1:xa||(Rd(x,p),j=x.stateNode,typeof j.componentWillUnmount=="function"&&e9(x,p,j)),$h(d,p,x);break;case 21:$h(d,p,x);break;case 22:xa=(j=xa)||x.memoizedState!==null,$h(d,p,x),xa=j;break;default:$h(d,p,x)}}function l9(d,p){if(p.memoizedState===null&&(d=p.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{px(d)}catch(x){bs(p,p.return,x)}}}function c9(d,p){if(p.memoizedState===null&&(d=p.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{px(d)}catch(x){bs(p,p.return,x)}}function Jfe(d){switch(d.tag){case 31:case 13:case 19:var p=d.stateNode;return p===null&&(p=d.stateNode=new s9),p;case 22:return d=d.stateNode,p=d._retryCache,p===null&&(p=d._retryCache=new s9),p;default:throw Error(n(435,d.tag))}}function f5(d,p){var x=Jfe(d);p.forEach(function(j){if(!x.has(j)){x.add(j);var D=o0e.bind(null,d,j);j.then(D,D)}})}function Ql(d,p){var x=p.deletions;if(x!==null)for(var j=0;j<x.length;j++){var D=x[j],$=d,ne=p,ye=ne;e:for(;ye!==null;){switch(ye.tag){case 27:if(y0(ye.type)){bi=ye.stateNode,Xl=!1;break e}break;case 5:bi=ye.stateNode,Xl=!1;break e;case 3:case 4:bi=ye.stateNode.containerInfo,Xl=!0;break e}ye=ye.return}if(bi===null)throw Error(n(160));o9($,ne,D),bi=null,Xl=!1,$=D.alternate,$!==null&&($.return=null),D.return=null}if(p.subtreeFlags&13886)for(p=p.child;p!==null;)u9(p,d),p=p.sibling}var $u=null;function u9(d,p){var x=d.alternate,j=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Ql(p,d),Jl(d),j&4&&(d0(3,d,d.return),Zb(3,d),d0(5,d,d.return));break;case 1:Ql(p,d),Jl(d),j&512&&(xa||x===null||Rd(x,x.return)),j&64&&Fh&&(d=d.updateQueue,d!==null&&(j=d.callbacks,j!==null&&(x=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=x===null?j:x.concat(j))));break;case 26:var D=$u;if(Ql(p,d),Jl(d),j&512&&(xa||x===null||Rd(x,x.return)),j&4){var $=x!==null?x.memoizedState:null;if(j=d.memoizedState,x===null)if(j===null)if(d.stateNode===null){e:{j=d.type,x=d.memoizedProps,D=D.ownerDocument||D;t:switch(j){case"title":$=D.getElementsByTagName("title")[0],(!$||$[ps]||$[Fr]||$.namespaceURI==="http://www.w3.org/2000/svg"||$.hasAttribute("itemprop"))&&($=D.createElement(j),D.head.insertBefore($,D.querySelector("head > title"))),Oo($,j,x),$[Fr]=d,tn($),j=$;break e;case"link":var ne=uB("link","href",D).get(j+(x.href||""));if(ne){for(var ye=0;ye<ne.length;ye++)if($=ne[ye],$.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&$.getAttribute("rel")===(x.rel==null?null:x.rel)&&$.getAttribute("title")===(x.title==null?null:x.title)&&$.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){ne.splice(ye,1);break t}}$=D.createElement(j),Oo($,j,x),D.head.appendChild($);break;case"meta":if(ne=uB("meta","content",D).get(j+(x.content||""))){for(ye=0;ye<ne.length;ye++)if($=ne[ye],$.getAttribute("content")===(x.content==null?null:""+x.content)&&$.getAttribute("name")===(x.name==null?null:x.name)&&$.getAttribute("property")===(x.property==null?null:x.property)&&$.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&$.getAttribute("charset")===(x.charSet==null?null:x.charSet)){ne.splice(ye,1);break t}}$=D.createElement(j),Oo($,j,x),D.head.appendChild($);break;default:throw Error(n(468,j))}$[Fr]=d,tn($),j=$}d.stateNode=j}else dB(D,d.type,d.stateNode);else d.stateNode=cB(D,j,d.memoizedProps);else $!==j?($===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):$.count--,j===null?dB(D,d.type,d.stateNode):cB(D,j,d.memoizedProps)):j===null&&d.stateNode!==null&&W3(d,d.memoizedProps,x.memoizedProps)}break;case 27:Ql(p,d),Jl(d),j&512&&(xa||x===null||Rd(x,x.return)),x!==null&&j&4&&W3(d,d.memoizedProps,x.memoizedProps);break;case 5:if(Ql(p,d),Jl(d),j&512&&(xa||x===null||Rd(x,x.return)),d.flags&32){D=d.stateNode;try{is(D,"")}catch(fr){bs(d,d.return,fr)}}j&4&&d.stateNode!=null&&(D=d.memoizedProps,W3(d,D,x!==null?x.memoizedProps:D)),j&1024&&(Y3=!0);break;case 6:if(Ql(p,d),Jl(d),j&4){if(d.stateNode===null)throw Error(n(162));j=d.memoizedProps,x=d.stateNode;try{x.nodeValue=j}catch(fr){bs(d,d.return,fr)}}break;case 3:if(A5=null,D=$u,$u=C5(p.containerInfo),Ql(p,d),$u=D,Jl(d),j&4&&x!==null&&x.memoizedState.isDehydrated)try{px(p.containerInfo)}catch(fr){bs(d,d.return,fr)}Y3&&(Y3=!1,d9(d));break;case 4:j=$u,$u=C5(d.stateNode.containerInfo),Ql(p,d),Jl(d),$u=j;break;case 12:Ql(p,d),Jl(d);break;case 31:Ql(p,d),Jl(d),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,f5(d,j)));break;case 13:Ql(p,d),Jl(d),d.child.flags&8192&&d.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(m5=nt()),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,f5(d,j)));break;case 22:D=d.memoizedState!==null;var Pe=x!==null&&x.memoizedState!==null,Ze=Fh,yt=xa;if(Fh=Ze||D,xa=yt||Pe,Ql(p,d),xa=yt,Fh=Ze,Jl(d),j&8192)e:for(p=d.stateNode,p._visibility=D?p._visibility&-2:p._visibility|1,D&&(x===null||Pe||Fh||xa||Gp(d)),x=null,p=d;;){if(p.tag===5||p.tag===26){if(x===null){Pe=x=p;try{if($=Pe.stateNode,D)ne=$.style,typeof ne.setProperty=="function"?ne.setProperty("display","none","important"):ne.display="none";else{ye=Pe.stateNode;var Et=Pe.memoizedProps.style,st=Et!=null&&Et.hasOwnProperty("display")?Et.display:null;ye.style.display=st==null||typeof st=="boolean"?"":(""+st).trim()}}catch(fr){bs(Pe,Pe.return,fr)}}}else if(p.tag===6){if(x===null){Pe=p;try{Pe.stateNode.nodeValue=D?"":Pe.memoizedProps}catch(fr){bs(Pe,Pe.return,fr)}}}else if(p.tag===18){if(x===null){Pe=p;try{var ot=Pe.stateNode;D?eB(ot,!0):eB(Pe.stateNode,!1)}catch(fr){bs(Pe,Pe.return,fr)}}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===d)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break e;for(;p.sibling===null;){if(p.return===null||p.return===d)break e;x===p&&(x=null),p=p.return}x===p&&(x=null),p.sibling.return=p.return,p=p.sibling}j&4&&(j=d.updateQueue,j!==null&&(x=j.retryQueue,x!==null&&(j.retryQueue=null,f5(d,x))));break;case 19:Ql(p,d),Jl(d),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,f5(d,j)));break;case 30:break;case 21:break;default:Ql(p,d),Jl(d)}}function Jl(d){var p=d.flags;if(p&2){try{for(var x,j=d.return;j!==null;){if(r9(j)){x=j;break}j=j.return}if(x==null)throw Error(n(160));switch(x.tag){case 27:var D=x.stateNode,$=G3(d);h5(d,$,D);break;case 5:var ne=x.stateNode;x.flags&32&&(is(ne,""),x.flags&=-33);var ye=G3(d);h5(d,ye,ne);break;case 3:case 4:var Pe=x.stateNode.containerInfo,Ze=G3(d);K3(d,Ze,Pe);break;default:throw Error(n(161))}}catch(yt){bs(d,d.return,yt)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function d9(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var p=d;d9(p),p.tag===5&&p.flags&1024&&p.stateNode.reset(),d=d.sibling}}function Uh(d,p){if(p.subtreeFlags&8772)for(p=p.child;p!==null;)i9(d,p.alternate,p),p=p.sibling}function Gp(d){for(d=d.child;d!==null;){var p=d;switch(p.tag){case 0:case 11:case 14:case 15:d0(4,p,p.return),Gp(p);break;case 1:Rd(p,p.return);var x=p.stateNode;typeof x.componentWillUnmount=="function"&&e9(p,p.return,x),Gp(p);break;case 27:cv(p.stateNode);case 26:case 5:Rd(p,p.return),Gp(p);break;case 22:p.memoizedState===null&&Gp(p);break;case 30:Gp(p);break;default:Gp(p)}d=d.sibling}}function zh(d,p,x){for(x=x&&(p.subtreeFlags&8772)!==0,p=p.child;p!==null;){var j=p.alternate,D=d,$=p,ne=$.flags;switch($.tag){case 0:case 11:case 15:zh(D,$,x),Zb(4,$);break;case 1:if(zh(D,$,x),j=$,D=j.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Ze){bs(j,j.return,Ze)}if(j=$,D=j.updateQueue,D!==null){var ye=j.stateNode;try{var Pe=D.shared.hiddenCallbacks;if(Pe!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Pe.length;D++)ao(Pe[D],ye)}catch(Ze){bs(j,j.return,Ze)}}x&&ne&64&&ZD($),ev($,$.return);break;case 27:n9($);case 26:case 5:zh(D,$,x),x&&j===null&&ne&4&&t9($),ev($,$.return);break;case 12:zh(D,$,x);break;case 31:zh(D,$,x),x&&ne&4&&l9(D,$);break;case 13:zh(D,$,x),x&&ne&4&&c9(D,$);break;case 22:$.memoizedState===null&&zh(D,$,x),ev($,$.return);break;case 30:break;default:zh(D,$,x)}p=p.sibling}}function X3(d,p){var x=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),d=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(d=p.memoizedState.cachePool.pool),d!==x&&(d!=null&&d.refCount++,x!=null&&zp(x))}function Q3(d,p){d=null,p.alternate!==null&&(d=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==d&&(p.refCount++,d!=null&&zp(d))}function Uu(d,p,x,j){if(p.subtreeFlags&10256)for(p=p.child;p!==null;)h9(d,p,x,j),p=p.sibling}function h9(d,p,x,j){var D=p.flags;switch(p.tag){case 0:case 11:case 15:Uu(d,p,x,j),D&2048&&Zb(9,p);break;case 1:Uu(d,p,x,j);break;case 3:Uu(d,p,x,j),D&2048&&(d=null,p.alternate!==null&&(d=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==d&&(p.refCount++,d!=null&&zp(d)));break;case 12:if(D&2048){Uu(d,p,x,j),d=p.stateNode;try{var $=p.memoizedProps,ne=$.id,ye=$.onPostCommit;typeof ye=="function"&&ye(ne,p.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Pe){bs(p,p.return,Pe)}}else Uu(d,p,x,j);break;case 31:Uu(d,p,x,j);break;case 13:Uu(d,p,x,j);break;case 23:break;case 22:$=p.stateNode,ne=p.alternate,p.memoizedState!==null?$._visibility&2?Uu(d,p,x,j):tv(d,p):$._visibility&2?Uu(d,p,x,j):($._visibility|=2,nx(d,p,x,j,(p.subtreeFlags&10256)!==0||!1)),D&2048&&X3(ne,p);break;case 24:Uu(d,p,x,j),D&2048&&Q3(p.alternate,p);break;default:Uu(d,p,x,j)}}function nx(d,p,x,j,D){for(D=D&&((p.subtreeFlags&10256)!==0||!1),p=p.child;p!==null;){var $=d,ne=p,ye=x,Pe=j,Ze=ne.flags;switch(ne.tag){case 0:case 11:case 15:nx($,ne,ye,Pe,D),Zb(8,ne);break;case 23:break;case 22:var yt=ne.stateNode;ne.memoizedState!==null?yt._visibility&2?nx($,ne,ye,Pe,D):tv($,ne):(yt._visibility|=2,nx($,ne,ye,Pe,D)),D&&Ze&2048&&X3(ne.alternate,ne);break;case 24:nx($,ne,ye,Pe,D),D&&Ze&2048&&Q3(ne.alternate,ne);break;default:nx($,ne,ye,Pe,D)}p=p.sibling}}function tv(d,p){if(p.subtreeFlags&10256)for(p=p.child;p!==null;){var x=d,j=p,D=j.flags;switch(j.tag){case 22:tv(x,j),D&2048&&X3(j.alternate,j);break;case 24:tv(x,j),D&2048&&Q3(j.alternate,j);break;default:tv(x,j)}p=p.sibling}}var rv=8192;function sx(d,p,x){if(d.subtreeFlags&rv)for(d=d.child;d!==null;)f9(d,p,x),d=d.sibling}function f9(d,p,x){switch(d.tag){case 26:sx(d,p,x),d.flags&rv&&d.memoizedState!==null&&B0e(x,$u,d.memoizedState,d.memoizedProps);break;case 5:sx(d,p,x);break;case 3:case 4:var j=$u;$u=C5(d.stateNode.containerInfo),sx(d,p,x),$u=j;break;case 22:d.memoizedState===null&&(j=d.alternate,j!==null&&j.memoizedState!==null?(j=rv,rv=16777216,sx(d,p,x),rv=j):sx(d,p,x));break;default:sx(d,p,x)}}function p9(d){var p=d.alternate;if(p!==null&&(d=p.child,d!==null)){p.child=null;do p=d.sibling,d.sibling=null,d=p;while(d!==null)}}function nv(d){var p=d.deletions;if((d.flags&16)!==0){if(p!==null)for(var x=0;x<p.length;x++){var j=p[x];lo=j,g9(j,d)}p9(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)m9(d),d=d.sibling}function m9(d){switch(d.tag){case 0:case 11:case 15:nv(d),d.flags&2048&&d0(9,d,d.return);break;case 3:nv(d);break;case 12:nv(d);break;case 22:var p=d.stateNode;d.memoizedState!==null&&p._visibility&2&&(d.return===null||d.return.tag!==13)?(p._visibility&=-3,p5(d)):nv(d);break;default:nv(d)}}function p5(d){var p=d.deletions;if((d.flags&16)!==0){if(p!==null)for(var x=0;x<p.length;x++){var j=p[x];lo=j,g9(j,d)}p9(d)}for(d=d.child;d!==null;){switch(p=d,p.tag){case 0:case 11:case 15:d0(8,p,p.return),p5(p);break;case 22:x=p.stateNode,x._visibility&2&&(x._visibility&=-3,p5(p));break;default:p5(p)}d=d.sibling}}function g9(d,p){for(;lo!==null;){var x=lo;switch(x.tag){case 0:case 11:case 15:d0(8,x,p);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var j=x.memoizedState.cachePool.pool;j!=null&&j.refCount++}break;case 24:zp(x.memoizedState.cache)}if(j=x.child,j!==null)j.return=x,lo=j;else e:for(x=d;lo!==null;){j=lo;var D=j.sibling,$=j.return;if(a9(j),j===x){lo=null;break e}if(D!==null){D.return=$,lo=D;break e}lo=$}}}var Zfe={getCacheForType:function(d){var p=Da(Pi),x=p.data.get(d);return x===void 0&&(x=d(),p.data.set(d,x)),x},cacheSignal:function(){return Da(Pi).controller.signal}},e0e=typeof WeakMap=="function"?WeakMap:Map,ls=0,zs=null,Sn=null,In=0,ys=0,Nc=null,h0=!1,ix=!1,J3=!1,Vh=0,Ki=0,f0=0,Kp=0,Z3=0,jc=0,ax=0,sv=null,Zl=null,eC=!1,m5=0,x9=0,g5=1/0,x5=null,p0=null,Fa=0,m0=null,ox=null,qh=0,tC=0,rC=null,y9=null,iv=0,nC=null;function kc(){return(ls&2)!==0&&In!==0?In&-In:G.T!==null?cC():Mt()}function b9(){if(jc===0)if((In&536870912)===0||_n){var d=Ft;Ft<<=1,(Ft&3932160)===0&&(Ft=262144),jc=d}else jc=536870912;return d=si.current,d!==null&&(d.flags|=32),jc}function ec(d,p,x){(d===zs&&(ys===2||ys===9)||d.cancelPendingCommit!==null)&&(lx(d,0),g0(d,In,jc,!1)),Jt(d,x),((ls&2)===0||d!==zs)&&(d===zs&&((ls&2)===0&&(Kp|=x),Ki===4&&g0(d,In,jc,!1)),Dd(d))}function v9(d,p,x){if((ls&6)!==0)throw Error(n(327));var j=!x&&(p&127)===0&&(p&d.expiredLanes)===0||Xt(d,p),D=j?n0e(d,p):iC(d,p,!0),$=j;do{if(D===0){ix&&!j&&g0(d,p,0,!1);break}else{if(x=d.current.alternate,$&&!t0e(x)){D=iC(d,p,!1),$=!1;continue}if(D===2){if($=p,d.errorRecoveryDisabledLanes&$)var ne=0;else ne=d.pendingLanes&-536870913,ne=ne!==0?ne:ne&536870912?536870912:0;if(ne!==0){p=ne;e:{var ye=d;D=sv;var Pe=ye.current.memoizedState.isDehydrated;if(Pe&&(lx(ye,ne).flags|=256),ne=iC(ye,ne,!1),ne!==2){if(J3&&!Pe){ye.errorRecoveryDisabledLanes|=$,Kp|=$,D=4;break e}$=Zl,Zl=D,$!==null&&(Zl===null?Zl=$:Zl.push.apply(Zl,$))}D=ne}if($=!1,D!==2)continue}}if(D===1){lx(d,0),g0(d,p,0,!0);break}e:{switch(j=d,$=D,$){case 0:case 1:throw Error(n(345));case 4:if((p&4194048)!==p)break;case 6:g0(j,p,jc,!h0);break e;case 2:Zl=null;break;case 3:case 5:break;default:throw Error(n(329))}if((p&62914560)===p&&(D=m5+300-nt(),10<D)){if(g0(j,p,jc,!h0),Ct(j,0,!0)!==0)break e;qh=p,j.timeoutHandle=Q9(w9.bind(null,j,x,Zl,x5,eC,p,jc,Kp,ax,h0,$,"Throttled",-0,0),D);break e}w9(j,x,Zl,x5,eC,p,jc,Kp,ax,h0,$,null,-0,0)}}break}while(!0);Dd(d)}function w9(d,p,x,j,D,$,ne,ye,Pe,Ze,yt,Et,st,ot){if(d.timeoutHandle=-1,Et=p.subtreeFlags,Et&8192||(Et&16785408)===16785408){Et={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fa},f9(p,$,Et);var fr=($&62914560)===$?m5-nt():($&4194048)===$?x9-nt():0;if(fr=F0e(Et,fr),fr!==null){qh=$,d.cancelPendingCommit=fr(A9.bind(null,d,p,$,x,j,D,ne,ye,Pe,yt,Et,null,st,ot)),g0(d,$,ne,!Ze);return}}A9(d,p,$,x,j,D,ne,ye,Pe)}function t0e(d){for(var p=d;;){var x=p.tag;if((x===0||x===11||x===15)&&p.flags&16384&&(x=p.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var j=0;j<x.length;j++){var D=x[j],$=D.getSnapshot;D=D.value;try{if(!La($(),D))return!1}catch{return!1}}if(x=p.child,p.subtreeFlags&16384&&x!==null)x.return=p,p=x;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function g0(d,p,x,j){p&=~Z3,p&=~Kp,d.suspendedLanes|=p,d.pingedLanes&=~p,j&&(d.warmLanes|=p),j=d.expirationTimes;for(var D=p;0<D;){var $=31-lt(D),ne=1<<$;j[$]=-1,D&=~ne}x!==0&&Ae(d,x,p)}function y5(){return(ls&6)===0?(av(0),!1):!0}function sC(){if(Sn!==null){if(ys===0)var d=Sn.return;else d=Sn,Yc=Ed=null,Xg(d),Tt=null,mr=0,d=Sn;for(;d!==null;)JD(d.alternate,d),d=d.return;Sn=null}}function lx(d,p){var x=d.timeoutHandle;x!==-1&&(d.timeoutHandle=-1,w0e(x)),x=d.cancelPendingCommit,x!==null&&(d.cancelPendingCommit=null,x()),qh=0,sC(),zs=d,Sn=x=zl(d.current,null),In=p,ys=0,Nc=null,h0=!1,ix=Xt(d,p),J3=!1,ax=jc=Z3=Kp=f0=Ki=0,Zl=sv=null,eC=!1,(p&8)!==0&&(p|=p&32);var j=d.entangledLanes;if(j!==0)for(d=d.entanglements,j&=p;0<j;){var D=31-lt(j),$=1<<D;p|=d[D],j&=~$}return Vh=p,Rp(),x}function N9(d,p){Or=null,G.H=Xb,p===Me||p===Ce?(p=vt(),ys=3):p===Qe?(p=vt(),ys=4):ys=p===R3?8:p!==null&&typeof p=="object"&&typeof p.then=="function"?6:1,Nc=p,Sn===null&&(Ki=1,o5(d,Vl(p,d.current)))}function j9(){var d=si.current;return d===null?!0:(In&4194048)===In?qn===null:(In&62914560)===In||(In&536870912)!==0?d===qn:!1}function k9(){var d=G.H;return G.H=Xb,d===null?Xb:d}function _9(){var d=G.A;return G.A=Zfe,d}function b5(){Ki=4,h0||(In&4194048)!==In&&si.current!==null||(ix=!0),(f0&134217727)===0&&(Kp&134217727)===0||zs===null||g0(zs,In,jc,!1)}function iC(d,p,x){var j=ls;ls|=2;var D=k9(),$=_9();(zs!==d||In!==p)&&(x5=null,lx(d,p)),p=!1;var ne=Ki;e:do try{if(ys!==0&&Sn!==null){var ye=Sn,Pe=Nc;switch(ys){case 8:sC(),ne=6;break e;case 3:case 2:case 9:case 6:si.current===null&&(p=!0);var Ze=ys;if(ys=0,Nc=null,cx(d,ye,Pe,Ze),x&&ix){ne=0;break e}break;default:Ze=ys,ys=0,Nc=null,cx(d,ye,Pe,Ze)}}r0e(),ne=Ki;break}catch(yt){N9(d,yt)}while(!0);return p&&d.shellSuspendCounter++,Yc=Ed=null,ls=j,G.H=D,G.A=$,Sn===null&&(zs=null,In=0,Rp()),ne}function r0e(){for(;Sn!==null;)S9(Sn)}function n0e(d,p){var x=ls;ls|=2;var j=k9(),D=_9();zs!==d||In!==p?(x5=null,g5=nt()+500,lx(d,p)):ix=Xt(d,p);e:do try{if(ys!==0&&Sn!==null){p=Sn;var $=Nc;t:switch(ys){case 1:ys=0,Nc=null,cx(d,p,$,1);break;case 2:case 9:if(We($)){ys=0,Nc=null,C9(p);break}p=function(){ys!==2&&ys!==9||zs!==d||(ys=7),Dd(d)},$.then(p,p);break e;case 3:ys=7;break e;case 4:ys=5;break e;case 7:We($)?(ys=0,Nc=null,C9(p)):(ys=0,Nc=null,cx(d,p,$,7));break;case 5:var ne=null;switch(Sn.tag){case 26:ne=Sn.memoizedState;case 5:case 27:var ye=Sn;if(ne?hB(ne):ye.stateNode.complete){ys=0,Nc=null;var Pe=ye.sibling;if(Pe!==null)Sn=Pe;else{var Ze=ye.return;Ze!==null?(Sn=Ze,v5(Ze)):Sn=null}break t}}ys=0,Nc=null,cx(d,p,$,5);break;case 6:ys=0,Nc=null,cx(d,p,$,6);break;case 8:sC(),Ki=6;break e;default:throw Error(n(462))}}s0e();break}catch(yt){N9(d,yt)}while(!0);return Yc=Ed=null,G.H=j,G.A=D,ls=x,Sn!==null?0:(zs=null,In=0,Rp(),Ki)}function s0e(){for(;Sn!==null&&!$t();)S9(Sn)}function S9(d){var p=XD(d.alternate,d,Vh);d.memoizedProps=d.pendingProps,p===null?v5(d):Sn=p}function C9(d){var p=d,x=p.alternate;switch(p.tag){case 15:case 0:p=qD(x,p,p.pendingProps,p.type,void 0,In);break;case 11:p=qD(x,p,p.pendingProps,p.type.render,p.ref,In);break;case 5:Xg(p);default:JD(x,p),p=Sn=Fp(p,Vh),p=XD(x,p,Vh)}d.memoizedProps=d.pendingProps,p===null?v5(d):Sn=p}function cx(d,p,x,j){Yc=Ed=null,Xg(p),Tt=null,mr=0;var D=p.return;try{if(Wfe(d,D,p,x,In)){Ki=1,o5(d,Vl(x,d.current)),Sn=null;return}}catch($){if(D!==null)throw Sn=D,$;Ki=1,o5(d,Vl(x,d.current)),Sn=null;return}p.flags&32768?(_n||j===1?d=!0:ix||(In&536870912)!==0?d=!1:(h0=d=!0,(j===2||j===9||j===3||j===6)&&(j=si.current,j!==null&&j.tag===13&&(j.flags|=16384))),E9(p,d)):v5(p)}function v5(d){var p=d;do{if((p.flags&32768)!==0){E9(p,h0);return}d=p.return;var x=Yfe(p.alternate,p,Vh);if(x!==null){Sn=x;return}if(p=p.sibling,p!==null){Sn=p;return}Sn=p=d}while(p!==null);Ki===0&&(Ki=5)}function E9(d,p){do{var x=Xfe(d.alternate,d);if(x!==null){x.flags&=32767,Sn=x;return}if(x=d.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!p&&(d=d.sibling,d!==null)){Sn=d;return}Sn=d=x}while(d!==null);Ki=6,Sn=null}function A9(d,p,x,j,D,$,ne,ye,Pe){d.cancelPendingCommit=null;do w5();while(Fa!==0);if((ls&6)!==0)throw Error(n(327));if(p!==null){if(p===d.current)throw Error(n(177));if($=p.lanes|p.childLanes,$|=Rg,kr(d,x,$,ne,ye,Pe),d===zs&&(Sn=zs=null,In=0),ox=p,m0=d,qh=x,tC=$,rC=D,y9=j,(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,l0e(wt,function(){return O9(),null})):(d.callbackNode=null,d.callbackPriority=0),j=(p.flags&13878)!==0,(p.subtreeFlags&13878)!==0||j){j=G.T,G.T=null,D=J.p,J.p=2,ne=ls,ls|=4;try{Qfe(d,p,x)}finally{ls=ne,J.p=D,G.T=j}}Fa=1,T9(),I9(),P9()}}function T9(){if(Fa===1){Fa=0;var d=m0,p=ox,x=(p.flags&13878)!==0;if((p.subtreeFlags&13878)!==0||x){x=G.T,G.T=null;var j=J.p;J.p=2;var D=ls;ls|=4;try{u9(p,d);var $=xC,ne=Pu(d.containerInfo),ye=$.focusedElem,Pe=$.selectionRange;if(ne!==ye&&ye&&ye.ownerDocument&&Iu(ye.ownerDocument.documentElement,ye)){if(Pe!==null&&Gc(ye)){var Ze=Pe.start,yt=Pe.end;if(yt===void 0&&(yt=Ze),"selectionStart"in ye)ye.selectionStart=Ze,ye.selectionEnd=Math.min(yt,ye.value.length);else{var Et=ye.ownerDocument||document,st=Et&&Et.defaultView||window;if(st.getSelection){var ot=st.getSelection(),fr=ye.textContent.length,zr=Math.min(Pe.start,fr),Ls=Pe.end===void 0?zr:Math.min(Pe.end,fr);!ot.extend&&zr>Ls&&(ne=Ls,Ls=zr,zr=ne);var Ve=e0(ye,zr),Re=e0(ye,Ls);if(Ve&&Re&&(ot.rangeCount!==1||ot.anchorNode!==Ve.node||ot.anchorOffset!==Ve.offset||ot.focusNode!==Re.node||ot.focusOffset!==Re.offset)){var Je=Et.createRange();Je.setStart(Ve.node,Ve.offset),ot.removeAllRanges(),zr>Ls?(ot.addRange(Je),ot.extend(Re.node,Re.offset)):(Je.setEnd(Re.node,Re.offset),ot.addRange(Je))}}}}for(Et=[],ot=ye;ot=ot.parentNode;)ot.nodeType===1&&Et.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof ye.focus=="function"&&ye.focus(),ye=0;ye<Et.length;ye++){var kt=Et[ye];kt.element.scrollLeft=kt.left,kt.element.scrollTop=kt.top}}L5=!!gC,xC=gC=null}finally{ls=D,J.p=j,G.T=x}}d.current=p,Fa=2}}function I9(){if(Fa===2){Fa=0;var d=m0,p=ox,x=(p.flags&8772)!==0;if((p.subtreeFlags&8772)!==0||x){x=G.T,G.T=null;var j=J.p;J.p=2;var D=ls;ls|=4;try{i9(d,p.alternate,p)}finally{ls=D,J.p=j,G.T=x}}Fa=3}}function P9(){if(Fa===4||Fa===3){Fa=0,Ut();var d=m0,p=ox,x=qh,j=y9;(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?Fa=5:(Fa=0,ox=m0=null,L9(d,d.pendingLanes));var D=d.pendingLanes;if(D===0&&(p0=null),zt(x),p=p.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(ft,p,void 0,(p.current.flags&128)===128)}catch{}if(j!==null){p=G.T,D=J.p,J.p=2,G.T=null;try{for(var $=d.onRecoverableError,ne=0;ne<j.length;ne++){var ye=j[ne];$(ye.value,{componentStack:ye.stack})}}finally{G.T=p,J.p=D}}(qh&3)!==0&&w5(),Dd(d),D=d.pendingLanes,(x&261930)!==0&&(D&42)!==0?d===nC?iv++:(iv=0,nC=d):iv=0,av(0)}}function L9(d,p){(d.pooledCacheLanes&=p)===0&&(p=d.pooledCache,p!=null&&(d.pooledCache=null,zp(p)))}function w5(){return T9(),I9(),P9(),O9()}function O9(){if(Fa!==5)return!1;var d=m0,p=tC;tC=0;var x=zt(qh),j=G.T,D=J.p;try{J.p=32>x?32:x,G.T=null,x=rC,rC=null;var $=m0,ne=qh;if(Fa=0,ox=m0=null,qh=0,(ls&6)!==0)throw Error(n(331));var ye=ls;if(ls|=4,m9($.current),h9($,$.current,ne,x),ls=ye,av(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(ft,$)}catch{}return!0}finally{J.p=D,G.T=j,L9(d,p)}}function M9(d,p,x){p=Vl(x,p),p=M3(d.stateNode,p,2),d=dn(d,p,2),d!==null&&(Jt(d,2),Dd(d))}function bs(d,p,x){if(d.tag===3)M9(d,d,x);else for(;p!==null;){if(p.tag===3){M9(p,d,x);break}else if(p.tag===1){var j=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(p0===null||!p0.has(j))){d=Vl(x,d),x=RD(2),j=dn(p,x,2),j!==null&&(DD(x,j,p,d),Jt(j,2),Dd(j));break}}p=p.return}}function aC(d,p,x){var j=d.pingCache;if(j===null){j=d.pingCache=new e0e;var D=new Set;j.set(p,D)}else D=j.get(p),D===void 0&&(D=new Set,j.set(p,D));D.has(x)||(J3=!0,D.add(x),d=i0e.bind(null,d,p,x),p.then(d,d))}function i0e(d,p,x){var j=d.pingCache;j!==null&&j.delete(p),d.pingedLanes|=d.suspendedLanes&x,d.warmLanes&=~x,zs===d&&(In&x)===x&&(Ki===4||Ki===3&&(In&62914560)===In&&300>nt()-m5?(ls&2)===0&&lx(d,0):Z3|=x,ax===In&&(ax=0)),Dd(d)}function R9(d,p){p===0&&(p=nr()),d=Ou(d,p),d!==null&&(Jt(d,p),Dd(d))}function a0e(d){var p=d.memoizedState,x=0;p!==null&&(x=p.retryLane),R9(d,x)}function o0e(d,p){var x=0;switch(d.tag){case 31:case 13:var j=d.stateNode,D=d.memoizedState;D!==null&&(x=D.retryLane);break;case 19:j=d.stateNode;break;case 22:j=d.stateNode._retryCache;break;default:throw Error(n(314))}j!==null&&j.delete(p),R9(d,x)}function l0e(d,p){return Fe(d,p)}var N5=null,ux=null,oC=!1,j5=!1,lC=!1,x0=0;function Dd(d){d!==ux&&d.next===null&&(ux===null?N5=ux=d:ux=ux.next=d),j5=!0,oC||(oC=!0,u0e())}function av(d,p){if(!lC&&j5){lC=!0;do for(var x=!1,j=N5;j!==null;){if(d!==0){var D=j.pendingLanes;if(D===0)var $=0;else{var ne=j.suspendedLanes,ye=j.pingedLanes;$=(1<<31-lt(42|d)+1)-1,$&=D&~(ne&~ye),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(x=!0,$9(j,$))}else $=In,$=Ct(j,j===zs?$:0,j.cancelPendingCommit!==null||j.timeoutHandle!==-1),($&3)===0||Xt(j,$)||(x=!0,$9(j,$));j=j.next}while(x);lC=!1}}function c0e(){D9()}function D9(){j5=oC=!1;var d=0;x0!==0&&v0e()&&(d=x0);for(var p=nt(),x=null,j=N5;j!==null;){var D=j.next,$=B9(j,p);$===0?(j.next=null,x===null?N5=D:x.next=D,D===null&&(ux=x)):(x=j,(d!==0||($&3)!==0)&&(j5=!0)),j=D}Fa!==0&&Fa!==5||av(d),x0!==0&&(x0=0)}function B9(d,p){for(var x=d.suspendedLanes,j=d.pingedLanes,D=d.expirationTimes,$=d.pendingLanes&-62914561;0<$;){var ne=31-lt($),ye=1<<ne,Pe=D[ne];Pe===-1?((ye&x)===0||(ye&j)!==0)&&(D[ne]=Qt(ye,p)):Pe<=p&&(d.expiredLanes|=ye),$&=~ye}if(p=zs,x=In,x=Ct(d,d===p?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j=d.callbackNode,x===0||d===p&&(ys===2||ys===9)||d.cancelPendingCommit!==null)return j!==null&&j!==null&&Nt(j),d.callbackNode=null,d.callbackPriority=0;if((x&3)===0||Xt(d,x)){if(p=x&-x,p===d.callbackPriority)return p;switch(j!==null&&Nt(j),zt(x)){case 2:case 8:x=_t;break;case 32:x=wt;break;case 268435456:x=Rt;break;default:x=wt}return j=F9.bind(null,d),x=Fe(x,j),d.callbackPriority=p,d.callbackNode=x,p}return j!==null&&j!==null&&Nt(j),d.callbackPriority=2,d.callbackNode=null,2}function F9(d,p){if(Fa!==0&&Fa!==5)return d.callbackNode=null,d.callbackPriority=0,null;var x=d.callbackNode;if(w5()&&d.callbackNode!==x)return null;var j=In;return j=Ct(d,d===zs?j:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j===0?null:(v9(d,j,p),B9(d,nt()),d.callbackNode!=null&&d.callbackNode===x?F9.bind(null,d):null)}function $9(d,p){if(w5())return null;v9(d,p,!0)}function u0e(){N0e(function(){(ls&6)!==0?Fe(It,c0e):D9()})}function cC(){if(x0===0){var d=A;d===0&&(d=mt,mt<<=1,(mt&261888)===0&&(mt=256)),x0=d}return x0}function U9(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:Ui(""+d)}function z9(d,p){var x=p.ownerDocument.createElement("input");return x.name=p.name,x.value=p.value,d.id&&x.setAttribute("form",d.id),p.parentNode.insertBefore(x,p),d=new FormData(d),x.parentNode.removeChild(x),d}function d0e(d,p,x,j,D){if(p==="submit"&&x&&x.stateNode===D){var $=U9((D[ln]||null).action),ne=j.submitter;ne&&(p=(p=ne[ln]||null)?U9(p.formAction):ne.getAttribute("formAction"),p!==null&&($=p,ne=null));var ye=new rr("action","action",null,j,D);d.push({event:ye,listeners:[{instance:null,listener:function(){if(j.defaultPrevented){if(x0!==0){var Pe=ne?z9(D,ne):new FormData(D);A3(x,{pending:!0,data:Pe,method:D.method,action:$},null,Pe)}}else typeof $=="function"&&(ye.preventDefault(),Pe=ne?z9(D,ne):new FormData(D),A3(x,{pending:!0,data:Pe,method:D.method,action:$},$,Pe))},currentTarget:D}]})}}for(var uC=0;uC<Ah.length;uC++){var dC=Ah[uC],h0e=dC.toLowerCase(),f0e=dC[0].toUpperCase()+dC.slice(1);Ul(h0e,"on"+f0e)}Ul(Eh,"onAnimationEnd"),Ul(Op,"onAnimationIteration"),Ul(Mb,"onAnimationStart"),Ul("dblclick","onDoubleClick"),Ul("focusin","onFocus"),Ul("focusout","onBlur"),Ul(Kw,"onTransitionRun"),Ul(Yw,"onTransitionStart"),Ul(Xw,"onTransitionCancel"),Ul(Rb,"onTransitionEnd"),Bi("onMouseEnter",["mouseout","mouseover"]),Bi("onMouseLeave",["mouseout","mouseover"]),Bi("onPointerEnter",["pointerout","pointerover"]),Bi("onPointerLeave",["pointerout","pointerover"]),sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),sa("onBeforeInput",["compositionend","keypress","textInput","paste"]),sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ov="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p0e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ov));function V9(d,p){p=(p&4)!==0;for(var x=0;x<d.length;x++){var j=d[x],D=j.event;j=j.listeners;e:{var $=void 0;if(p)for(var ne=j.length-1;0<=ne;ne--){var ye=j[ne],Pe=ye.instance,Ze=ye.currentTarget;if(ye=ye.listener,Pe!==$&&D.isPropagationStopped())break e;$=ye,D.currentTarget=Ze;try{$(D)}catch(yt){Mp(yt)}D.currentTarget=null,$=Pe}else for(ne=0;ne<j.length;ne++){if(ye=j[ne],Pe=ye.instance,Ze=ye.currentTarget,ye=ye.listener,Pe!==$&&D.isPropagationStopped())break e;$=ye,D.currentTarget=Ze;try{$(D)}catch(yt){Mp(yt)}D.currentTarget=null,$=Pe}}}}function Cn(d,p){var x=p[cn];x===void 0&&(x=p[cn]=new Set);var j=d+"__bubble";x.has(j)||(q9(p,d,2,!1),x.add(j))}function hC(d,p,x){var j=0;p&&(j|=4),q9(x,d,j,p)}var k5="_reactListening"+Math.random().toString(36).slice(2);function fC(d){if(!d[k5]){d[k5]=!0,Ea.forEach(function(x){x!=="selectionchange"&&(p0e.has(x)||hC(x,!1,d),hC(x,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[k5]||(p[k5]=!0,hC("selectionchange",!1,p))}}function q9(d,p,x,j){switch(bB(p)){case 2:var D=z0e;break;case 8:D=V0e;break;default:D=EC}x=D.bind(null,p,x,d),D=void 0,!Xo||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(D=!0),j?D!==void 0?d.addEventListener(p,x,{capture:!0,passive:D}):d.addEventListener(p,x,!0):D!==void 0?d.addEventListener(p,x,{passive:D}):d.addEventListener(p,x,!1)}function pC(d,p,x,j,D){var $=j;if((p&1)===0&&(p&2)===0&&j!==null)e:for(;;){if(j===null)return;var ne=j.tag;if(ne===3||ne===4){var ye=j.stateNode.containerInfo;if(ye===D)break;if(ne===4)for(ne=j.return;ne!==null;){var Pe=ne.tag;if((Pe===3||Pe===4)&&ne.stateNode.containerInfo===D)return;ne=ne.return}for(;ye!==null;){if(ne=Xe(ye),ne===null)return;if(Pe=ne.tag,Pe===5||Pe===6||Pe===26||Pe===27){j=$=ne;continue e}ye=ye.parentNode}}j=j.return}Yo(function(){var Ze=$,yt=Ai(x),Et=[];e:{var st=Db.get(d);if(st!==void 0){var ot=rr,fr=d;switch(d){case"keypress":if(Q(x)===0)break e;case"keydown":case"keyup":ot=Nn;break;case"focusin":fr="focus",ot=ti;break;case"focusout":fr="blur",ot=ti;break;case"beforeblur":case"afterblur":ot=ti;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=us;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=Jn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Y;break;case Eh:case Op:case Mb:ot=z;break;case Rb:ot=we;break;case"scroll":case"scrollend":ot=en;break;case"wheel":ot=tt;break;case"copy":case"cut":case"paste":ot=Se;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=ds;break;case"toggle":case"beforetoggle":ot=Yr}var zr=(p&4)!==0,Ls=!zr&&(d==="scroll"||d==="scrollend"),Ve=zr?st!==null?st+"Capture":null:st;zr=[];for(var Re=Ze,Je;Re!==null;){var kt=Re;if(Je=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||Je===null||Ve===null||(kt=Ys(Re,Ve),kt!=null&&zr.push(lv(Re,kt,Je))),Ls)break;Re=Re.return}0<zr.length&&(st=new ot(st,fr,null,x,yt),Et.push({event:st,listeners:zr}))}}if((p&7)===0){e:{if(st=d==="mouseover"||d==="pointerover",ot=d==="mouseout"||d==="pointerout",st&&x!==ms&&(fr=x.relatedTarget||x.fromElement)&&(Xe(fr)||fr[hn]))break e;if((ot||st)&&(st=yt.window===yt?yt:(st=yt.ownerDocument)?st.defaultView||st.parentWindow:window,ot?(fr=x.relatedTarget||x.toElement,ot=Ze,fr=fr?Xe(fr):null,fr!==null&&(Ls=a(fr),zr=fr.tag,fr!==Ls||zr!==5&&zr!==27&&zr!==6)&&(fr=null)):(ot=null,fr=Ze),ot!==fr)){if(zr=us,kt="onMouseLeave",Ve="onMouseEnter",Re="mouse",(d==="pointerout"||d==="pointerover")&&(zr=ds,kt="onPointerLeave",Ve="onPointerEnter",Re="pointer"),Ls=ot==null?st:tr(ot),Je=fr==null?st:tr(fr),st=new zr(kt,Re+"leave",ot,x,yt),st.target=Ls,st.relatedTarget=Je,kt=null,Xe(yt)===Ze&&(zr=new zr(Ve,Re+"enter",fr,x,yt),zr.target=Je,zr.relatedTarget=Ls,kt=zr),Ls=kt,ot&&fr)t:{for(zr=m0e,Ve=ot,Re=fr,Je=0,kt=Ve;kt;kt=zr(kt))Je++;kt=0;for(var Br=Re;Br;Br=zr(Br))kt++;for(;0<Je-kt;)Ve=zr(Ve),Je--;for(;0<kt-Je;)Re=zr(Re),kt--;for(;Je--;){if(Ve===Re||Re!==null&&Ve===Re.alternate){zr=Ve;break t}Ve=zr(Ve),Re=zr(Re)}zr=null}else zr=null;ot!==null&&H9(Et,st,ot,zr,!1),fr!==null&&Ls!==null&&H9(Et,Ls,fr,zr,!0)}}e:{if(st=Ze?tr(Ze):window,ot=st.nodeName&&st.nodeName.toLowerCase(),ot==="select"||ot==="input"&&st.type==="file")var es=kd;else if(Pp(st))if(Qo)es=Hc;else{es=Ti;var wr=Jf}else ot=st.nodeName,!ot||ot.toLowerCase()!=="input"||st.type!=="checkbox"&&st.type!=="radio"?Ze&&Bl(Ze.elementType)&&(es=kd):es=Mg;if(es&&(es=es(d,Ze))){pl(Et,es,x,yt);break e}wr&&wr(d,st,Ze),d==="focusout"&&Ze&&st.type==="number"&&Ze.memoizedProps.value!=null&&mc(st,"number",st.value)}switch(wr=Ze?tr(Ze):window,d){case"focusin":(Pp(wr)||wr.contentEditable==="true")&&(ml=wr,Lu=Ze,no=null);break;case"focusout":no=Lu=ml=null;break;case"mousedown":$l=!0;break;case"contextmenu":case"mouseup":case"dragend":$l=!1,Xn(Et,x,yt);break;case"selectionchange":if(Ch)break;case"keydown":case"keyup":Xn(Et,x,yt)}var mn;if(bn)e:{switch(d){case"compositionstart":var Pn="onCompositionStart";break e;case"compositionend":Pn="onCompositionEnd";break e;case"compositionupdate":Pn="onCompositionUpdate";break e}Pn=void 0}else zc?fl(d,x)&&(Pn="onCompositionEnd"):d==="keydown"&&x.keyCode===229&&(Pn="onCompositionStart");Pn&&(Ia&&x.locale!=="ko"&&(zc||Pn!=="onCompositionStart"?Pn==="onCompositionEnd"&&zc&&(mn=xc()):(zi=yt,Eo="value"in zi?zi.value:zi.textContent,zc=!0)),wr=_5(Ze,Pn),0<wr.length&&(Pn=new Ue(Pn,d,null,x,yt),Et.push({event:Pn,listeners:wr}),mn?Pn.data=mn:(mn=Uc(x),mn!==null&&(Pn.data=mn)))),(mn=pa?Ao(d,x):Cu(d,x))&&(Pn=_5(Ze,"onBeforeInput"),0<Pn.length&&(wr=new Ue("onBeforeInput","beforeinput",null,x,yt),Et.push({event:wr,listeners:Pn}),wr.data=mn)),d0e(Et,d,Ze,x,yt)}V9(Et,p)})}function lv(d,p,x){return{instance:d,listener:p,currentTarget:x}}function _5(d,p){for(var x=p+"Capture",j=[];d!==null;){var D=d,$=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||$===null||(D=Ys(d,x),D!=null&&j.unshift(lv(d,D,$)),D=Ys(d,p),D!=null&&j.push(lv(d,D,$))),d.tag===3)return j;d=d.return}return[]}function m0e(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function H9(d,p,x,j,D){for(var $=p._reactName,ne=[];x!==null&&x!==j;){var ye=x,Pe=ye.alternate,Ze=ye.stateNode;if(ye=ye.tag,Pe!==null&&Pe===j)break;ye!==5&&ye!==26&&ye!==27||Ze===null||(Pe=Ze,D?(Ze=Ys(x,$),Ze!=null&&ne.unshift(lv(x,Ze,Pe))):D||(Ze=Ys(x,$),Ze!=null&&ne.push(lv(x,Ze,Pe)))),x=x.return}ne.length!==0&&d.push({event:p,listeners:ne})}var g0e=/\r\n?/g,x0e=/\u0000|\uFFFD/g;function W9(d){return(typeof d=="string"?d:""+d).replace(g0e,`
`).replace(x0e,"")}function G9(d,p){return p=W9(p),W9(d)===p}function Ps(d,p,x,j,D,$){switch(x){case"children":typeof j=="string"?p==="body"||p==="textarea"&&j===""||is(d,j):(typeof j=="number"||typeof j=="bigint")&&p!=="body"&&is(d,""+j);break;case"className":pi(d,"class",j);break;case"tabIndex":pi(d,"tabindex",j);break;case"dir":case"role":case"viewBox":case"width":case"height":pi(d,x,j);break;case"style":ha(d,j,$);break;case"data":if(p!=="object"){pi(d,"data",j);break}case"src":case"href":if(j===""&&(p!=="a"||x!=="href")){d.removeAttribute(x);break}if(j==null||typeof j=="function"||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(x);break}j=Ui(""+j),d.setAttribute(x,j);break;case"action":case"formAction":if(typeof j=="function"){d.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof $=="function"&&(x==="formAction"?(p!=="input"&&Ps(d,p,"name",D.name,D,null),Ps(d,p,"formEncType",D.formEncType,D,null),Ps(d,p,"formMethod",D.formMethod,D,null),Ps(d,p,"formTarget",D.formTarget,D,null)):(Ps(d,p,"encType",D.encType,D,null),Ps(d,p,"method",D.method,D,null),Ps(d,p,"target",D.target,D,null)));if(j==null||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(x);break}j=Ui(""+j),d.setAttribute(x,j);break;case"onClick":j!=null&&(d.onclick=fa);break;case"onScroll":j!=null&&Cn("scroll",d);break;case"onScrollEnd":j!=null&&Cn("scrollend",d);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(n(61));if(x=j.__html,x!=null){if(D.children!=null)throw Error(n(60));d.innerHTML=x}}break;case"multiple":d.multiple=j&&typeof j!="function"&&typeof j!="symbol";break;case"muted":d.muted=j&&typeof j!="function"&&typeof j!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(j==null||typeof j=="function"||typeof j=="boolean"||typeof j=="symbol"){d.removeAttribute("xlink:href");break}x=Ui(""+j),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(x,""+j):d.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":j&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(x,""):d.removeAttribute(x);break;case"capture":case"download":j===!0?d.setAttribute(x,""):j!==!1&&j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(x,j):d.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":j!=null&&typeof j!="function"&&typeof j!="symbol"&&!isNaN(j)&&1<=j?d.setAttribute(x,j):d.removeAttribute(x);break;case"rowSpan":case"start":j==null||typeof j=="function"||typeof j=="symbol"||isNaN(j)?d.removeAttribute(x):d.setAttribute(x,j);break;case"popover":Cn("beforetoggle",d),Cn("toggle",d),ia(d,"popover",j);break;case"xlinkActuate":ks(d,"http://www.w3.org/1999/xlink","xlink:actuate",j);break;case"xlinkArcrole":ks(d,"http://www.w3.org/1999/xlink","xlink:arcrole",j);break;case"xlinkRole":ks(d,"http://www.w3.org/1999/xlink","xlink:role",j);break;case"xlinkShow":ks(d,"http://www.w3.org/1999/xlink","xlink:show",j);break;case"xlinkTitle":ks(d,"http://www.w3.org/1999/xlink","xlink:title",j);break;case"xlinkType":ks(d,"http://www.w3.org/1999/xlink","xlink:type",j);break;case"xmlBase":ks(d,"http://www.w3.org/XML/1998/namespace","xml:base",j);break;case"xmlLang":ks(d,"http://www.w3.org/XML/1998/namespace","xml:lang",j);break;case"xmlSpace":ks(d,"http://www.w3.org/XML/1998/namespace","xml:space",j);break;case"is":ia(d,"is",j);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=Fl.get(x)||x,ia(d,x,j))}}function mC(d,p,x,j,D,$){switch(x){case"style":ha(d,j,$);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(n(61));if(x=j.__html,x!=null){if(D.children!=null)throw Error(n(60));d.innerHTML=x}}break;case"children":typeof j=="string"?is(d,j):(typeof j=="number"||typeof j=="bigint")&&is(d,""+j);break;case"onScroll":j!=null&&Cn("scroll",d);break;case"onScrollEnd":j!=null&&Cn("scrollend",d);break;case"onClick":j!=null&&(d.onclick=fa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bs.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(D=x.endsWith("Capture"),p=x.slice(2,D?x.length-7:void 0),$=d[ln]||null,$=$!=null?$[x]:null,typeof $=="function"&&d.removeEventListener(p,$,D),typeof j=="function")){typeof $!="function"&&$!==null&&(x in d?d[x]=null:d.hasAttribute(x)&&d.removeAttribute(x)),d.addEventListener(p,j,D);break e}x in d?d[x]=j:j===!0?d.setAttribute(x,""):ia(d,x,j)}}}function Oo(d,p,x){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cn("error",d),Cn("load",d);var j=!1,D=!1,$;for($ in x)if(x.hasOwnProperty($)){var ne=x[$];if(ne!=null)switch($){case"src":j=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,p));default:Ps(d,p,$,ne,x,null)}}D&&Ps(d,p,"srcSet",x.srcSet,x,null),j&&Ps(d,p,"src",x.src,x,null);return;case"input":Cn("invalid",d);var ye=$=ne=D=null,Pe=null,Ze=null;for(j in x)if(x.hasOwnProperty(j)){var yt=x[j];if(yt!=null)switch(j){case"name":D=yt;break;case"type":ne=yt;break;case"checked":Pe=yt;break;case"defaultChecked":Ze=yt;break;case"value":$=yt;break;case"defaultValue":ye=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(n(137,p));break;default:Ps(d,p,j,yt,x,null)}}Dl(d,$,ye,Pe,Ze,ne,D,!1);return;case"select":Cn("invalid",d),j=ne=$=null;for(D in x)if(x.hasOwnProperty(D)&&(ye=x[D],ye!=null))switch(D){case"value":$=ye;break;case"defaultValue":ne=ye;break;case"multiple":j=ye;default:Ps(d,p,D,ye,x,null)}p=$,x=ne,d.multiple=!!j,p!=null?Ei(d,!!j,p,!1):x!=null&&Ei(d,!!j,x,!0);return;case"textarea":Cn("invalid",d),$=D=j=null;for(ne in x)if(x.hasOwnProperty(ne)&&(ye=x[ne],ye!=null))switch(ne){case"value":j=ye;break;case"defaultValue":D=ye;break;case"children":$=ye;break;case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(91));break;default:Ps(d,p,ne,ye,x,null)}ei(d,j,D,$);return;case"option":for(Pe in x)x.hasOwnProperty(Pe)&&(j=x[Pe],j!=null)&&(Pe==="selected"?d.selected=j&&typeof j!="function"&&typeof j!="symbol":Ps(d,p,Pe,j,x,null));return;case"dialog":Cn("beforetoggle",d),Cn("toggle",d),Cn("cancel",d),Cn("close",d);break;case"iframe":case"object":Cn("load",d);break;case"video":case"audio":for(j=0;j<ov.length;j++)Cn(ov[j],d);break;case"image":Cn("error",d),Cn("load",d);break;case"details":Cn("toggle",d);break;case"embed":case"source":case"link":Cn("error",d),Cn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ze in x)if(x.hasOwnProperty(Ze)&&(j=x[Ze],j!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,p));default:Ps(d,p,Ze,j,x,null)}return;default:if(Bl(p)){for(yt in x)x.hasOwnProperty(yt)&&(j=x[yt],j!==void 0&&mC(d,p,yt,j,x,void 0));return}}for(ye in x)x.hasOwnProperty(ye)&&(j=x[ye],j!=null&&Ps(d,p,ye,j,x,null))}function y0e(d,p,x,j){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,$=null,ne=null,ye=null,Pe=null,Ze=null,yt=null;for(ot in x){var Et=x[ot];if(x.hasOwnProperty(ot)&&Et!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":Pe=Et;default:j.hasOwnProperty(ot)||Ps(d,p,ot,null,j,Et)}}for(var st in j){var ot=j[st];if(Et=x[st],j.hasOwnProperty(st)&&(ot!=null||Et!=null))switch(st){case"type":$=ot;break;case"name":D=ot;break;case"checked":Ze=ot;break;case"defaultChecked":yt=ot;break;case"value":ne=ot;break;case"defaultValue":ye=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,p));break;default:ot!==Et&&Ps(d,p,st,ot,j,Et)}}hl(d,ne,ye,Pe,Ze,yt,$,D);return;case"select":ot=ne=ye=st=null;for($ in x)if(Pe=x[$],x.hasOwnProperty($)&&Pe!=null)switch($){case"value":break;case"multiple":ot=Pe;default:j.hasOwnProperty($)||Ps(d,p,$,null,j,Pe)}for(D in j)if($=j[D],Pe=x[D],j.hasOwnProperty(D)&&($!=null||Pe!=null))switch(D){case"value":st=$;break;case"defaultValue":ye=$;break;case"multiple":ne=$;default:$!==Pe&&Ps(d,p,D,$,j,Pe)}p=ye,x=ne,j=ot,st!=null?Ei(d,!!x,st,!1):!!j!=!!x&&(p!=null?Ei(d,!!x,p,!0):Ei(d,!!x,x?[]:"",!1));return;case"textarea":ot=st=null;for(ye in x)if(D=x[ye],x.hasOwnProperty(ye)&&D!=null&&!j.hasOwnProperty(ye))switch(ye){case"value":break;case"children":break;default:Ps(d,p,ye,null,j,D)}for(ne in j)if(D=j[ne],$=x[ne],j.hasOwnProperty(ne)&&(D!=null||$!=null))switch(ne){case"value":st=D;break;case"defaultValue":ot=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:D!==$&&Ps(d,p,ne,D,j,$)}jo(d,st,ot);return;case"option":for(var fr in x)st=x[fr],x.hasOwnProperty(fr)&&st!=null&&!j.hasOwnProperty(fr)&&(fr==="selected"?d.selected=!1:Ps(d,p,fr,null,j,st));for(Pe in j)st=j[Pe],ot=x[Pe],j.hasOwnProperty(Pe)&&st!==ot&&(st!=null||ot!=null)&&(Pe==="selected"?d.selected=st&&typeof st!="function"&&typeof st!="symbol":Ps(d,p,Pe,st,j,ot));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var zr in x)st=x[zr],x.hasOwnProperty(zr)&&st!=null&&!j.hasOwnProperty(zr)&&Ps(d,p,zr,null,j,st);for(Ze in j)if(st=j[Ze],ot=x[Ze],j.hasOwnProperty(Ze)&&st!==ot&&(st!=null||ot!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(n(137,p));break;default:Ps(d,p,Ze,st,j,ot)}return;default:if(Bl(p)){for(var Ls in x)st=x[Ls],x.hasOwnProperty(Ls)&&st!==void 0&&!j.hasOwnProperty(Ls)&&mC(d,p,Ls,void 0,j,st);for(yt in j)st=j[yt],ot=x[yt],!j.hasOwnProperty(yt)||st===ot||st===void 0&&ot===void 0||mC(d,p,yt,st,j,ot);return}}for(var Ve in x)st=x[Ve],x.hasOwnProperty(Ve)&&st!=null&&!j.hasOwnProperty(Ve)&&Ps(d,p,Ve,null,j,st);for(Et in j)st=j[Et],ot=x[Et],!j.hasOwnProperty(Et)||st===ot||st==null&&ot==null||Ps(d,p,Et,st,j,ot)}function K9(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function b0e(){if(typeof performance.getEntriesByType=="function"){for(var d=0,p=0,x=performance.getEntriesByType("resource"),j=0;j<x.length;j++){var D=x[j],$=D.transferSize,ne=D.initiatorType,ye=D.duration;if($&&ye&&K9(ne)){for(ne=0,ye=D.responseEnd,j+=1;j<x.length;j++){var Pe=x[j],Ze=Pe.startTime;if(Ze>ye)break;var yt=Pe.transferSize,Et=Pe.initiatorType;yt&&K9(Et)&&(Pe=Pe.responseEnd,ne+=yt*(Pe<ye?1:(ye-Ze)/(Pe-Ze)))}if(--j,p+=8*($+ne)/(D.duration/1e3),d++,10<d)break}}if(0<d)return p/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var gC=null,xC=null;function S5(d){return d.nodeType===9?d:d.ownerDocument}function Y9(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function X9(d,p){if(d===0)switch(p){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&p==="foreignObject"?0:d}function yC(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.children=="bigint"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var bC=null;function v0e(){var d=window.event;return d&&d.type==="popstate"?d===bC?!1:(bC=d,!0):(bC=null,!1)}var Q9=typeof setTimeout=="function"?setTimeout:void 0,w0e=typeof clearTimeout=="function"?clearTimeout:void 0,J9=typeof Promise=="function"?Promise:void 0,N0e=typeof queueMicrotask=="function"?queueMicrotask:typeof J9<"u"?function(d){return J9.resolve(null).then(d).catch(j0e)}:Q9;function j0e(d){setTimeout(function(){throw d})}function y0(d){return d==="head"}function Z9(d,p){var x=p,j=0;do{var D=x.nextSibling;if(d.removeChild(x),D&&D.nodeType===8)if(x=D.data,x==="/$"||x==="/&"){if(j===0){d.removeChild(D),px(p);return}j--}else if(x==="$"||x==="$?"||x==="$~"||x==="$!"||x==="&")j++;else if(x==="html")cv(d.ownerDocument.documentElement);else if(x==="head"){x=d.ownerDocument.head,cv(x);for(var $=x.firstChild;$;){var ne=$.nextSibling,ye=$.nodeName;$[ps]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&$.rel.toLowerCase()==="stylesheet"||x.removeChild($),$=ne}}else x==="body"&&cv(d.ownerDocument.body);x=D}while(x);px(p)}function eB(d,p){var x=d;d=0;do{var j=x.nextSibling;if(x.nodeType===1?p?(x._stashedDisplay=x.style.display,x.style.display="none"):(x.style.display=x._stashedDisplay||"",x.getAttribute("style")===""&&x.removeAttribute("style")):x.nodeType===3&&(p?(x._stashedText=x.nodeValue,x.nodeValue=""):x.nodeValue=x._stashedText||""),j&&j.nodeType===8)if(x=j.data,x==="/$"){if(d===0)break;d--}else x!=="$"&&x!=="$?"&&x!=="$~"&&x!=="$!"||d++;x=j}while(x)}function vC(d){var p=d.firstChild;for(p&&p.nodeType===10&&(p=p.nextSibling);p;){var x=p;switch(p=p.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":vC(x),$e(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}d.removeChild(x)}}function k0e(d,p,x,j){for(;d.nodeType===1;){var D=x;if(d.nodeName.toLowerCase()!==p.toLowerCase()){if(!j&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(j){if(!d[ps])switch(p){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if($=d.getAttribute("rel"),$==="stylesheet"&&d.hasAttribute("data-precedence"))break;if($!==D.rel||d.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||d.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||d.getAttribute("title")!==(D.title==null?null:D.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if($=d.getAttribute("src"),($!==(D.src==null?null:D.src)||d.getAttribute("type")!==(D.type==null?null:D.type)||d.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&$&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(p==="input"&&d.type==="hidden"){var $=D.name==null?null:""+D.name;if(D.type==="hidden"&&d.getAttribute("name")===$)return d}else return d;if(d=Jc(d.nextSibling),d===null)break}return null}function _0e(d,p,x){if(p==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!x||(d=Jc(d.nextSibling),d===null))return null;return d}function tB(d,p){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!p||(d=Jc(d.nextSibling),d===null))return null;return d}function wC(d){return d.data==="$?"||d.data==="$~"}function NC(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function S0e(d,p){var x=d.ownerDocument;if(d.data==="$~")d._reactRetry=p;else if(d.data!=="$?"||x.readyState!=="loading")p();else{var j=function(){p(),x.removeEventListener("DOMContentLoaded",j)};x.addEventListener("DOMContentLoaded",j),d._reactRetry=j}}function Jc(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"||p==="F!"||p==="F")break;if(p==="/$"||p==="/&")return null}}return d}var jC=null;function rB(d){d=d.nextSibling;for(var p=0;d;){if(d.nodeType===8){var x=d.data;if(x==="/$"||x==="/&"){if(p===0)return Jc(d.nextSibling);p--}else x!=="$"&&x!=="$!"&&x!=="$?"&&x!=="$~"&&x!=="&"||p++}d=d.nextSibling}return null}function nB(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var x=d.data;if(x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"){if(p===0)return d;p--}else x!=="/$"&&x!=="/&"||p++}d=d.previousSibling}return null}function sB(d,p,x){switch(p=S5(x),d){case"html":if(d=p.documentElement,!d)throw Error(n(452));return d;case"head":if(d=p.head,!d)throw Error(n(453));return d;case"body":if(d=p.body,!d)throw Error(n(454));return d;default:throw Error(n(451))}}function cv(d){for(var p=d.attributes;p.length;)d.removeAttributeNode(p[0]);$e(d)}var Zc=new Map,iB=new Set;function C5(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var Hh=J.d;J.d={f:C0e,r:E0e,D:A0e,C:T0e,L:I0e,m:P0e,X:O0e,S:L0e,M:M0e};function C0e(){var d=Hh.f(),p=y5();return d||p}function E0e(d){var p=ct(d);p!==null&&p.tag===5&&p.type==="form"?ND(p):Hh.r(d)}var dx=typeof document>"u"?null:document;function aB(d,p,x){var j=dx;if(j&&typeof p=="string"&&p){var D=_s(p);D='link[rel="'+d+'"][href="'+D+'"]',typeof x=="string"&&(D+='[crossorigin="'+x+'"]'),iB.has(D)||(iB.add(D),d={rel:d,crossOrigin:x,href:p},j.querySelector(D)===null&&(p=j.createElement("link"),Oo(p,"link",d),tn(p),j.head.appendChild(p)))}}function A0e(d){Hh.D(d),aB("dns-prefetch",d,null)}function T0e(d,p){Hh.C(d,p),aB("preconnect",d,p)}function I0e(d,p,x){Hh.L(d,p,x);var j=dx;if(j&&d&&p){var D='link[rel="preload"][as="'+_s(p)+'"]';p==="image"&&x&&x.imageSrcSet?(D+='[imagesrcset="'+_s(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(D+='[imagesizes="'+_s(x.imageSizes)+'"]')):D+='[href="'+_s(d)+'"]';var $=D;switch(p){case"style":$=hx(d);break;case"script":$=fx(d)}Zc.has($)||(d=f({rel:"preload",href:p==="image"&&x&&x.imageSrcSet?void 0:d,as:p},x),Zc.set($,d),j.querySelector(D)!==null||p==="style"&&j.querySelector(uv($))||p==="script"&&j.querySelector(dv($))||(p=j.createElement("link"),Oo(p,"link",d),tn(p),j.head.appendChild(p)))}}function P0e(d,p){Hh.m(d,p);var x=dx;if(x&&d){var j=p&&typeof p.as=="string"?p.as:"script",D='link[rel="modulepreload"][as="'+_s(j)+'"][href="'+_s(d)+'"]',$=D;switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":$=fx(d)}if(!Zc.has($)&&(d=f({rel:"modulepreload",href:d},p),Zc.set($,d),x.querySelector(D)===null)){switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(dv($)))return}j=x.createElement("link"),Oo(j,"link",d),tn(j),x.head.appendChild(j)}}}function L0e(d,p,x){Hh.S(d,p,x);var j=dx;if(j&&d){var D=Lr(j).hoistableStyles,$=hx(d);p=p||"default";var ne=D.get($);if(!ne){var ye={loading:0,preload:null};if(ne=j.querySelector(uv($)))ye.loading=5;else{d=f({rel:"stylesheet",href:d,"data-precedence":p},x),(x=Zc.get($))&&kC(d,x);var Pe=ne=j.createElement("link");tn(Pe),Oo(Pe,"link",d),Pe._p=new Promise(function(Ze,yt){Pe.onload=Ze,Pe.onerror=yt}),Pe.addEventListener("load",function(){ye.loading|=1}),Pe.addEventListener("error",function(){ye.loading|=2}),ye.loading|=4,E5(ne,p,j)}ne={type:"stylesheet",instance:ne,count:1,state:ye},D.set($,ne)}}}function O0e(d,p){Hh.X(d,p);var x=dx;if(x&&d){var j=Lr(x).hoistableScripts,D=fx(d),$=j.get(D);$||($=x.querySelector(dv(D)),$||(d=f({src:d,async:!0},p),(p=Zc.get(D))&&_C(d,p),$=x.createElement("script"),tn($),Oo($,"link",d),x.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},j.set(D,$))}}function M0e(d,p){Hh.M(d,p);var x=dx;if(x&&d){var j=Lr(x).hoistableScripts,D=fx(d),$=j.get(D);$||($=x.querySelector(dv(D)),$||(d=f({src:d,async:!0,type:"module"},p),(p=Zc.get(D))&&_C(d,p),$=x.createElement("script"),tn($),Oo($,"link",d),x.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},j.set(D,$))}}function oB(d,p,x,j){var D=(D=xe.current)?C5(D):null;if(!D)throw Error(n(446));switch(d){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(p=hx(x.href),x=Lr(D).hoistableStyles,j=x.get(p),j||(j={type:"style",instance:null,count:0,state:null},x.set(p,j)),j):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){d=hx(x.href);var $=Lr(D).hoistableStyles,ne=$.get(d);if(ne||(D=D.ownerDocument||D,ne={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},$.set(d,ne),($=D.querySelector(uv(d)))&&!$._p&&(ne.instance=$,ne.state.loading=5),Zc.has(d)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},Zc.set(d,x),$||R0e(D,d,x,ne.state))),p&&j===null)throw Error(n(528,""));return ne}if(p&&j!==null)throw Error(n(529,""));return null;case"script":return p=x.async,x=x.src,typeof x=="string"&&p&&typeof p!="function"&&typeof p!="symbol"?(p=fx(x),x=Lr(D).hoistableScripts,j=x.get(p),j||(j={type:"script",instance:null,count:0,state:null},x.set(p,j)),j):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,d))}}function hx(d){return'href="'+_s(d)+'"'}function uv(d){return'link[rel="stylesheet"]['+d+"]"}function lB(d){return f({},d,{"data-precedence":d.precedence,precedence:null})}function R0e(d,p,x,j){d.querySelector('link[rel="preload"][as="style"]['+p+"]")?j.loading=1:(p=d.createElement("link"),j.preload=p,p.addEventListener("load",function(){return j.loading|=1}),p.addEventListener("error",function(){return j.loading|=2}),Oo(p,"link",x),tn(p),d.head.appendChild(p))}function fx(d){return'[src="'+_s(d)+'"]'}function dv(d){return"script[async]"+d}function cB(d,p,x){if(p.count++,p.instance===null)switch(p.type){case"style":var j=d.querySelector('style[data-href~="'+_s(x.href)+'"]');if(j)return p.instance=j,tn(j),j;var D=f({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return j=(d.ownerDocument||d).createElement("style"),tn(j),Oo(j,"style",D),E5(j,x.precedence,d),p.instance=j;case"stylesheet":D=hx(x.href);var $=d.querySelector(uv(D));if($)return p.state.loading|=4,p.instance=$,tn($),$;j=lB(x),(D=Zc.get(D))&&kC(j,D),$=(d.ownerDocument||d).createElement("link"),tn($);var ne=$;return ne._p=new Promise(function(ye,Pe){ne.onload=ye,ne.onerror=Pe}),Oo($,"link",j),p.state.loading|=4,E5($,x.precedence,d),p.instance=$;case"script":return $=fx(x.src),(D=d.querySelector(dv($)))?(p.instance=D,tn(D),D):(j=x,(D=Zc.get($))&&(j=f({},x),_C(j,D)),d=d.ownerDocument||d,D=d.createElement("script"),tn(D),Oo(D,"link",j),d.head.appendChild(D),p.instance=D);case"void":return null;default:throw Error(n(443,p.type))}else p.type==="stylesheet"&&(p.state.loading&4)===0&&(j=p.instance,p.state.loading|=4,E5(j,x.precedence,d));return p.instance}function E5(d,p,x){for(var j=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=j.length?j[j.length-1]:null,$=D,ne=0;ne<j.length;ne++){var ye=j[ne];if(ye.dataset.precedence===p)$=ye;else if($!==D)break}$?$.parentNode.insertBefore(d,$.nextSibling):(p=x.nodeType===9?x.head:x,p.insertBefore(d,p.firstChild))}function kC(d,p){d.crossOrigin==null&&(d.crossOrigin=p.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=p.referrerPolicy),d.title==null&&(d.title=p.title)}function _C(d,p){d.crossOrigin==null&&(d.crossOrigin=p.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=p.referrerPolicy),d.integrity==null&&(d.integrity=p.integrity)}var A5=null;function uB(d,p,x){if(A5===null){var j=new Map,D=A5=new Map;D.set(x,j)}else D=A5,j=D.get(x),j||(j=new Map,D.set(x,j));if(j.has(d))return j;for(j.set(d,null),x=x.getElementsByTagName(d),D=0;D<x.length;D++){var $=x[D];if(!($[ps]||$[Fr]||d==="link"&&$.getAttribute("rel")==="stylesheet")&&$.namespaceURI!=="http://www.w3.org/2000/svg"){var ne=$.getAttribute(p)||"";ne=d+ne;var ye=j.get(ne);ye?ye.push($):j.set(ne,[$])}}return j}function dB(d,p,x){d=d.ownerDocument||d,d.head.insertBefore(x,p==="title"?d.querySelector("head > title"):null)}function D0e(d,p,x){if(x===1||p.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof p.precedence!="string"||typeof p.href!="string"||p.href==="")break;return!0;case"link":if(typeof p.rel!="string"||typeof p.href!="string"||p.href===""||p.onLoad||p.onError)break;return p.rel==="stylesheet"?(d=p.disabled,typeof p.precedence=="string"&&d==null):!0;case"script":if(p.async&&typeof p.async!="function"&&typeof p.async!="symbol"&&!p.onLoad&&!p.onError&&p.src&&typeof p.src=="string")return!0}return!1}function hB(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function B0e(d,p,x,j){if(x.type==="stylesheet"&&(typeof j.media!="string"||matchMedia(j.media).matches!==!1)&&(x.state.loading&4)===0){if(x.instance===null){var D=hx(j.href),$=p.querySelector(uv(D));if($){p=$._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(d.count++,d=T5.bind(d),p.then(d,d)),x.state.loading|=4,x.instance=$,tn($);return}$=p.ownerDocument||p,j=lB(j),(D=Zc.get(D))&&kC(j,D),$=$.createElement("link"),tn($);var ne=$;ne._p=new Promise(function(ye,Pe){ne.onload=ye,ne.onerror=Pe}),Oo($,"link",j),x.instance=$}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(x,p),(p=x.state.preload)&&(x.state.loading&3)===0&&(d.count++,x=T5.bind(d),p.addEventListener("load",x),p.addEventListener("error",x))}}var SC=0;function F0e(d,p){return d.stylesheets&&d.count===0&&P5(d,d.stylesheets),0<d.count||0<d.imgCount?function(x){var j=setTimeout(function(){if(d.stylesheets&&P5(d,d.stylesheets),d.unsuspend){var $=d.unsuspend;d.unsuspend=null,$()}},6e4+p);0<d.imgBytes&&SC===0&&(SC=62500*b0e());var D=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&P5(d,d.stylesheets),d.unsuspend)){var $=d.unsuspend;d.unsuspend=null,$()}},(d.imgBytes>SC?50:800)+p);return d.unsuspend=x,function(){d.unsuspend=null,clearTimeout(j),clearTimeout(D)}}:null}function T5(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)P5(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var I5=null;function P5(d,p){d.stylesheets=null,d.unsuspend!==null&&(d.count++,I5=new Map,p.forEach($0e,d),I5=null,T5.call(d))}function $0e(d,p){if(!(p.state.loading&4)){var x=I5.get(d);if(x)var j=x.get(null);else{x=new Map,I5.set(d,x);for(var D=d.querySelectorAll("link[data-precedence],style[data-precedence]"),$=0;$<D.length;$++){var ne=D[$];(ne.nodeName==="LINK"||ne.getAttribute("media")!=="not all")&&(x.set(ne.dataset.precedence,ne),j=ne)}j&&x.set(null,j)}D=p.instance,ne=D.getAttribute("data-precedence"),$=x.get(ne)||j,$===j&&x.set(null,D),x.set(ne,D),this.count++,j=T5.bind(this),D.addEventListener("load",j),D.addEventListener("error",j),$?$.parentNode.insertBefore(D,$.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(D,d.firstChild)),p.state.loading|=4}}var hv={$$typeof:C,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function U0e(d,p,x,j,D,$,ne,ye,Pe){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=sr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sr(0),this.hiddenUpdates=sr(null),this.identifierPrefix=j,this.onUncaughtError=D,this.onCaughtError=$,this.onRecoverableError=ne,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function fB(d,p,x,j,D,$,ne,ye,Pe,Ze,yt,Et){return d=new U0e(d,p,x,ne,Pe,Ze,yt,Et,ye),p=1,$===!0&&(p|=24),$=io(3,null,null,p),d.current=$,$.stateNode=d,p=a0(),p.refCount++,d.pooledCache=p,p.refCount++,$.memoizedState={element:j,isDehydrated:x,cache:p},Zt($),d}function pB(d){return d?(d=Oa,d):Oa}function mB(d,p,x,j,D,$){D=pB(D),j.context===null?j.context=D:j.pendingContext=D,j=Ur(p),j.payload={element:x},$=$===void 0?null:$,$!==null&&(j.callback=$),x=dn(d,j,p),x!==null&&(ec(x,d,p),as(x,d,p))}function gB(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var x=d.retryLane;d.retryLane=x!==0&&x<p?x:p}}function CC(d,p){gB(d,p),(d=d.alternate)&&gB(d,p)}function xB(d){if(d.tag===13||d.tag===31){var p=Ou(d,67108864);p!==null&&ec(p,d,67108864),CC(d,67108864)}}function yB(d){if(d.tag===13||d.tag===31){var p=kc();p=jt(p);var x=Ou(d,p);x!==null&&ec(x,d,p),CC(d,p)}}var L5=!0;function z0e(d,p,x,j){var D=G.T;G.T=null;var $=J.p;try{J.p=2,EC(d,p,x,j)}finally{J.p=$,G.T=D}}function V0e(d,p,x,j){var D=G.T;G.T=null;var $=J.p;try{J.p=8,EC(d,p,x,j)}finally{J.p=$,G.T=D}}function EC(d,p,x,j){if(L5){var D=AC(j);if(D===null)pC(d,p,j,O5,x),vB(d,j);else if(H0e(D,d,p,x,j))j.stopPropagation();else if(vB(d,j),p&4&&-1<q0e.indexOf(d)){for(;D!==null;){var $=ct(D);if($!==null)switch($.tag){case 3:if($=$.stateNode,$.current.memoizedState.isDehydrated){var ne=Ot($.pendingLanes);if(ne!==0){var ye=$;for(ye.pendingLanes|=2,ye.entangledLanes|=2;ne;){var Pe=1<<31-lt(ne);ye.entanglements[1]|=Pe,ne&=~Pe}Dd($),(ls&6)===0&&(g5=nt()+500,av(0))}}break;case 31:case 13:ye=Ou($,2),ye!==null&&ec(ye,$,2),y5(),CC($,2)}if($=AC(j),$===null&&pC(d,p,j,O5,x),$===D)break;D=$}D!==null&&j.stopPropagation()}else pC(d,p,j,null,x)}}function AC(d){return d=Ai(d),TC(d)}var O5=null;function TC(d){if(O5=null,d=Xe(d),d!==null){var p=a(d);if(p===null)d=null;else{var x=p.tag;if(x===13){if(d=o(p),d!==null)return d;d=null}else if(x===31){if(d=l(p),d!==null)return d;d=null}else if(x===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null)}}return O5=d,null}function bB(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bt()){case It:return 2;case _t:return 8;case wt:case ut:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var IC=!1,b0=null,v0=null,w0=null,fv=new Map,pv=new Map,N0=[],q0e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vB(d,p){switch(d){case"focusin":case"focusout":b0=null;break;case"dragenter":case"dragleave":v0=null;break;case"mouseover":case"mouseout":w0=null;break;case"pointerover":case"pointerout":fv.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":pv.delete(p.pointerId)}}function mv(d,p,x,j,D,$){return d===null||d.nativeEvent!==$?(d={blockedOn:p,domEventName:x,eventSystemFlags:j,nativeEvent:$,targetContainers:[D]},p!==null&&(p=ct(p),p!==null&&xB(p)),d):(d.eventSystemFlags|=j,p=d.targetContainers,D!==null&&p.indexOf(D)===-1&&p.push(D),d)}function H0e(d,p,x,j,D){switch(p){case"focusin":return b0=mv(b0,d,p,x,j,D),!0;case"dragenter":return v0=mv(v0,d,p,x,j,D),!0;case"mouseover":return w0=mv(w0,d,p,x,j,D),!0;case"pointerover":var $=D.pointerId;return fv.set($,mv(fv.get($)||null,d,p,x,j,D)),!0;case"gotpointercapture":return $=D.pointerId,pv.set($,mv(pv.get($)||null,d,p,x,j,D)),!0}return!1}function wB(d){var p=Xe(d.target);if(p!==null){var x=a(p);if(x!==null){if(p=x.tag,p===13){if(p=o(x),p!==null){d.blockedOn=p,Ht(d.priority,function(){yB(x)});return}}else if(p===31){if(p=l(x),p!==null){d.blockedOn=p,Ht(d.priority,function(){yB(x)});return}}else if(p===3&&x.stateNode.current.memoizedState.isDehydrated){d.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}d.blockedOn=null}function M5(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var x=AC(d.nativeEvent);if(x===null){x=d.nativeEvent;var j=new x.constructor(x.type,x);ms=j,x.target.dispatchEvent(j),ms=null}else return p=ct(x),p!==null&&xB(p),d.blockedOn=x,!1;p.shift()}return!0}function NB(d,p,x){M5(d)&&x.delete(p)}function W0e(){IC=!1,b0!==null&&M5(b0)&&(b0=null),v0!==null&&M5(v0)&&(v0=null),w0!==null&&M5(w0)&&(w0=null),fv.forEach(NB),pv.forEach(NB)}function R5(d,p){d.blockedOn===p&&(d.blockedOn=null,IC||(IC=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,W0e)))}var D5=null;function jB(d){D5!==d&&(D5=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){D5===d&&(D5=null);for(var p=0;p<d.length;p+=3){var x=d[p],j=d[p+1],D=d[p+2];if(typeof j!="function"){if(TC(j||x)===null)continue;break}var $=ct(x);$!==null&&(d.splice(p,3),p-=3,A3($,{pending:!0,data:D,method:x.method,action:j},j,D))}}))}function px(d){function p(Pe){return R5(Pe,d)}b0!==null&&R5(b0,d),v0!==null&&R5(v0,d),w0!==null&&R5(w0,d),fv.forEach(p),pv.forEach(p);for(var x=0;x<N0.length;x++){var j=N0[x];j.blockedOn===d&&(j.blockedOn=null)}for(;0<N0.length&&(x=N0[0],x.blockedOn===null);)wB(x),x.blockedOn===null&&N0.shift();if(x=(d.ownerDocument||d).$$reactFormReplay,x!=null)for(j=0;j<x.length;j+=3){var D=x[j],$=x[j+1],ne=D[ln]||null;if(typeof $=="function")ne||jB(x);else if(ne){var ye=null;if($&&$.hasAttribute("formAction")){if(D=$,ne=$[ln]||null)ye=ne.formAction;else if(TC(D)!==null)continue}else ye=ne.action;typeof ye=="function"?x[j+1]=ye:(x.splice(j,3),j-=3),jB(x)}}}function kB(){function d($){$.canIntercept&&$.info==="react-transition"&&$.intercept({handler:function(){return new Promise(function(ne){return D=ne})},focusReset:"manual",scroll:"manual"})}function p(){D!==null&&(D(),D=null),j||setTimeout(x,20)}function x(){if(!j&&!navigation.transition){var $=navigation.currentEntry;$&&$.url!=null&&navigation.navigate($.url,{state:$.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var j=!1,D=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",p),navigation.addEventListener("navigateerror",p),setTimeout(x,100),function(){j=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",p),navigation.removeEventListener("navigateerror",p),D!==null&&(D(),D=null)}}}function PC(d){this._internalRoot=d}B5.prototype.render=PC.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(n(409));var x=p.current,j=kc();mB(x,j,d,p,null,null)},B5.prototype.unmount=PC.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;mB(d.current,2,null,d,null,null),y5(),p[hn]=null}};function B5(d){this._internalRoot=d}B5.prototype.unstable_scheduleHydration=function(d){if(d){var p=Mt();d={blockedOn:null,target:d,priority:p};for(var x=0;x<N0.length&&p!==0&&p<N0[x].priority;x++);N0.splice(x,0,d),x===0&&wB(d)}};var _B=e.version;if(_B!=="19.2.4")throw Error(n(527,_B,"19.2.4"));J.findDOMNode=function(d){var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=u(p),d=d!==null?h(d):null,d=d===null?null:d.stateNode,d};var G0e={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var F5=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!F5.isDisabled&&F5.supportsFiber)try{ft=F5.inject(G0e),Bt=F5}catch{}}return xv.createRoot=function(d,p){if(!s(d))throw Error(n(299));var x=!1,j="",D=PD,$=LD,ne=OD;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(j=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&($=p.onCaughtError),p.onRecoverableError!==void 0&&(ne=p.onRecoverableError)),p=fB(d,1,!1,null,null,x,j,null,D,$,ne,kB),d[hn]=p.current,fC(d),new PC(p)},xv.hydrateRoot=function(d,p,x){if(!s(d))throw Error(n(299));var j=!1,D="",$=PD,ne=LD,ye=OD,Pe=null;return x!=null&&(x.unstable_strictMode===!0&&(j=!0),x.identifierPrefix!==void 0&&(D=x.identifierPrefix),x.onUncaughtError!==void 0&&($=x.onUncaughtError),x.onCaughtError!==void 0&&(ne=x.onCaughtError),x.onRecoverableError!==void 0&&(ye=x.onRecoverableError),x.formState!==void 0&&(Pe=x.formState)),p=fB(d,1,!0,p,x??null,j,D,Pe,$,ne,ye,kB),p.context=pB(null),x=p.current,j=kc(),j=jt(j),D=Ur(j),D.callback=null,dn(x,D,j),x=j,p.current.lanes=x,Jt(p,x),Dd(p),d[hn]=p.current,fC(d),new B5(p)},xv.version="19.2.4",xv}var MB;function npe(){if(MB)return MC.exports;MB=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),MC.exports=rpe(),MC.exports}var spe=npe();const ipe=Pl(spe);var RB="popstate";function ape(t={}){function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return $T("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:V1(s)}return lpe(e,r,null,t)}function Si(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xu(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ope(){return Math.random().toString(36).substring(2,10)}function DB(t,e){return{usr:t.state,key:t.key,idx:e}}function $T(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ib(e):e,state:r,key:e&&e.key||n||ope()}}function V1({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ib(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function lpe(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,u=h();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function h(){return(o.state||{idx:null}).idx}function f(){l="POP";let w=h(),N=w==null?null:w-u;u=w,c&&c({action:l,location:v.location,delta:N})}function m(w,N){l="PUSH";let k=$T(v.location,w,N);u=h()+1;let C=DB(k,u),I=v.createHref(k);try{o.pushState(C,"",I)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(I)}a&&c&&c({action:l,location:v.location,delta:1})}function g(w,N){l="REPLACE";let k=$T(v.location,w,N);u=h();let C=DB(k,u),I=v.createHref(k);o.replaceState(C,"",I),a&&c&&c({action:l,location:v.location,delta:0})}function y(w){return cpe(w)}let v={get action(){return l},get location(){return t(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(RB,f),c=w,()=>{s.removeEventListener(RB,f),c=null}},createHref(w){return e(s,w)},createURL:y,encodeLocation(w){let N=y(w);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:m,replace:g,go(w){return o.go(w)}};return v}function cpe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Si(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:V1(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function JQ(t,e,r="/"){return upe(t,e,r,!1)}function upe(t,e,r,n){let s=typeof e=="string"?ib(e):e,a=bf(s.pathname||"/",r);if(a==null)return null;let o=ZQ(t);dpe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=Npe(a);l=vpe(o[c],u,n)}return l}function ZQ(t,e=[],r=[],n="",s=!1){let a=(o,l,c=s,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&c)return;Si(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let f=df([n,h.relativePath]),m=r.concat(h);o.children&&o.children.length>0&&(Si(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),ZQ(o.children,e,m,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:ype(f,o.index),routesMeta:m})};return t.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))a(o,l);else for(let c of eJ(o.path))a(o,l,!0,c)}),e}function eJ(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=eJ(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function dpe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:bpe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var hpe=/^:[\w-]+$/,fpe=3,ppe=2,mpe=1,gpe=10,xpe=-2,BB=t=>t==="*";function ype(t,e){let r=t.split("/"),n=r.length;return r.some(BB)&&(n+=xpe),e&&(n+=ppe),r.filter(s=>!BB(s)).reduce((s,a)=>s+(hpe.test(a)?fpe:a===""?mpe:gpe),n)}function bpe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function vpe(t,e,r=!1){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,h=a==="/"?e:e.slice(a.length)||"/",f=Zj({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),m=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=Zj({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:df([a,f.pathname]),pathnameBase:Spe(df([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=df([a,f.pathnameBase]))}return o}function Zj(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=wpe(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,{paramName:h,isOptional:f},m)=>{if(h==="*"){let y=l[m]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const g=l[m];return f&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function wpe(t,e=!1,r=!0){xu(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function Npe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xu(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function bf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var jpe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function kpe(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?ib(t):t,a;return r?(r=r.replace(/\/\/+/g,"/"),r.startsWith("/")?a=FB(r.substring(1),"/"):a=FB(r,e)):a=e,{pathname:a,search:Cpe(n),hash:Epe(s)}}function FB(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function FC(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _pe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function pL(t){let e=_pe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function mL(t,e,r,n=!1){let s;typeof t=="string"?s=ib(t):(s={...t},Si(!s.pathname||!s.pathname.includes("?"),FC("?","pathname","search",s)),Si(!s.pathname||!s.pathname.includes("#"),FC("#","pathname","hash",s)),Si(!s.search||!s.search.includes("#"),FC("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}l=f>=0?e[f]:"/"}let c=kpe(s,l),u=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}var df=t=>t.join("/").replace(/\/\/+/g,"/"),Spe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Cpe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Epe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,Ape=class{constructor(t,e,r,n=!1){this.status=t,this.statusText=e||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function Tpe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Ipe(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var tJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function rJ(t,e){let r=t;if(typeof r!="string"||!jpe.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,s=!1;if(tJ)try{let a=new URL(window.location.href),o=r.startsWith("//")?new URL(a.protocol+r):new URL(r),l=bf(o.pathname,e);o.origin===a.origin&&l!=null?r=l+o.search+o.hash:s=!0}catch{xu(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var nJ=["POST","PUT","PATCH","DELETE"];new Set(nJ);var Ppe=["GET",...nJ];new Set(Ppe);var ab=b.createContext(null);ab.displayName="DataRouter";var i_=b.createContext(null);i_.displayName="DataRouterState";var Lpe=b.createContext(!1),sJ=b.createContext({isTransitioning:!1});sJ.displayName="ViewTransition";var Ope=b.createContext(new Map);Ope.displayName="Fetchers";var Mpe=b.createContext(null);Mpe.displayName="Await";var Bc=b.createContext(null);Bc.displayName="Navigation";var G2=b.createContext(null);G2.displayName="Location";var xd=b.createContext({outlet:null,matches:[],isDataRoute:!1});xd.displayName="Route";var gL=b.createContext(null);gL.displayName="RouteError";var iJ="REACT_ROUTER_ERROR",Rpe="REDIRECT",Dpe="ROUTE_ERROR_RESPONSE";function Bpe(t){if(t.startsWith(`${iJ}:${Rpe}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Fpe(t){if(t.startsWith(`${iJ}:${Dpe}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Ape(e.status,e.statusText,e.data)}catch{}}function $pe(t,{relative:e}={}){Si(ob(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=b.useContext(Bc),{hash:s,pathname:a,search:o}=K2(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:df([r,a])),n.createHref({pathname:l,search:o,hash:s})}function ob(){return b.useContext(G2)!=null}function Ca(){return Si(ob(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(G2).location}var aJ="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function oJ(t){b.useContext(Bc).static||b.useLayoutEffect(t)}function yn(){let{isDataRoute:t}=b.useContext(xd);return t?Zpe():Upe()}function Upe(){Si(ob(),"useNavigate() may be used only in the context of a <Router> component.");let t=b.useContext(ab),{basename:e,navigator:r}=b.useContext(Bc),{matches:n}=b.useContext(xd),{pathname:s}=Ca(),a=JSON.stringify(pL(n)),o=b.useRef(!1);return oJ(()=>{o.current=!0}),b.useCallback((c,u={})=>{if(xu(o.current,aJ),!o.current)return;if(typeof c=="number"){r.go(c);return}let h=mL(c,JSON.parse(a),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:df([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,a,s,t])}b.createContext(null);function cc(){let{matches:t}=b.useContext(xd),e=t[t.length-1];return e?e.params:{}}function K2(t,{relative:e}={}){let{matches:r}=b.useContext(xd),{pathname:n}=Ca(),s=JSON.stringify(pL(r));return b.useMemo(()=>mL(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function zpe(t,e){return lJ(t,e)}function lJ(t,e,r,n,s){Si(ob(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=b.useContext(Bc),{matches:o}=b.useContext(xd),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",f=l&&l.route;{let k=f&&f.path||"";uJ(u,!f||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let m=Ca(),g;if(e){let k=typeof e=="string"?ib(e):e;Si(h==="/"||k.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${k.pathname}" was given in the \`location\` prop.`),g=k}else g=m;let y=g.pathname||"/",v=y;if(h!=="/"){let k=h.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(k.length).join("/")}let w=JQ(t,{pathname:v});xu(f||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),xu(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=Gpe(w&&w.map(k=>Object.assign({},k,{params:Object.assign({},c,k.params),pathname:df([h,a.encodeLocation?a.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?h:df([h,a.encodeLocation?a.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),o,r,n,s);return e&&N?b.createElement(G2.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},N):N}function Vpe(){let t=Jpe(),e=Tpe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:a},"ErrorBoundary")," or"," ",b.createElement("code",{style:a},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:s},r):null,o)}var qpe=b.createElement(Vpe,null),cJ=class extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const r=Fpe(t.digest);r&&(t=r)}let e=t!==void 0?b.createElement(xd.Provider,{value:this.props.routeContext},b.createElement(gL.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?b.createElement(Hpe,{error:t},e):e}};cJ.contextType=Lpe;var $C=new WeakMap;function Hpe({children:t,error:e}){let{basename:r}=b.useContext(Bc);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=Bpe(e.digest);if(n){let s=$C.get(e);if(s)throw s;let a=rJ(n.location,r);if(tJ&&!$C.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw $C.set(e,o),o}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function Wpe({routeContext:t,match:e,children:r}){let n=b.useContext(ab);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(xd.Provider,{value:t},r)}function Gpe(t,e=[],r=null,n=null,s=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r?.errors;if(o!=null){let h=a.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);Si(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,c=-1;if(r)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:m,errors:g}=r,y=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!g||g[f.route.id]===void 0);if(f.route.lazy||y){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let u=r&&n?(h,f)=>{n(h,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:Ipe(r.matches),errorInfo:f})}:void 0;return a.reduceRight((h,f,m)=>{let g,y=!1,v=null,w=null;r&&(g=o&&f.route.id?o[f.route.id]:void 0,v=f.route.errorElement||qpe,l&&(c<0&&m===0?(uJ("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):c===m&&(y=!0,w=f.route.hydrateFallbackElement||null)));let N=e.concat(a.slice(0,m+1)),k=()=>{let C;return g?C=v:y?C=w:f.route.Component?C=b.createElement(f.route.Component,null):f.route.element?C=f.route.element:C=h,b.createElement(Wpe,{match:f,routeContext:{outlet:h,matches:N,isDataRoute:r!=null},children:C})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?b.createElement(cJ,{location:r.location,revalidation:r.revalidation,component:v,error:g,children:k(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:u}):k()},null)}function xL(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Kpe(t){let e=b.useContext(ab);return Si(e,xL(t)),e}function Ype(t){let e=b.useContext(i_);return Si(e,xL(t)),e}function Xpe(t){let e=b.useContext(xd);return Si(e,xL(t)),e}function yL(t){let e=Xpe(t),r=e.matches[e.matches.length-1];return Si(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function Qpe(){return yL("useRouteId")}function Jpe(){let t=b.useContext(gL),e=Ype("useRouteError"),r=yL("useRouteError");return t!==void 0?t:e.errors?.[r]}function Zpe(){let{router:t}=Kpe("useNavigate"),e=yL("useNavigate"),r=b.useRef(!1);return oJ(()=>{r.current=!0}),b.useCallback(async(s,a={})=>{xu(r.current,aJ),r.current&&(typeof s=="number"?await t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var $B={};function uJ(t,e,r){!e&&!$B[t]&&($B[t]=!0,xu(!1,r))}b.memo(eme);function eme({routes:t,future:e,state:r,onError:n}){return lJ(t,void 0,r,n,e)}function e4({to:t,replace:e,state:r,relative:n}){Si(ob(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=b.useContext(Bc);xu(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=b.useContext(xd),{pathname:o}=Ca(),l=yn(),c=mL(t,pL(a),o,n==="path"),u=JSON.stringify(c);return b.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function Vr(t){Si(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function tme({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:o}){Si(!ob(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:s,static:a,unstable_useTransitions:o,future:{}}),[l,s,a,o]);typeof r=="string"&&(r=ib(r));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,y=b.useMemo(()=>{let v=bf(u,l);return v==null?null:{location:{pathname:v,search:h,hash:f,state:m,key:g},navigationType:n}},[l,u,h,f,m,g,n]);return xu(y!=null,`<Router basename="${l}"> is not able to match the URL "${u}${h}${f}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:b.createElement(Bc.Provider,{value:c},b.createElement(G2.Provider,{children:e,value:y}))}function bL({children:t,location:e}){return zpe(UT(t),e)}function UT(t,e=[]){let r=[];return b.Children.forEach(t,(n,s)=>{if(!b.isValidElement(n))return;let a=[...e,s];if(n.type===b.Fragment){r.push.apply(r,UT(n.props.children,a));return}Si(n.type===Vr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Si(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=UT(n.props.children,a)),r.push(o)}),r}var sj="get",ij="application/x-www-form-urlencoded";function a_(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function rme(t){return a_(t)&&t.tagName.toLowerCase()==="button"}function nme(t){return a_(t)&&t.tagName.toLowerCase()==="form"}function sme(t){return a_(t)&&t.tagName.toLowerCase()==="input"}function ime(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ame(t,e){return t.button===0&&(!e||e==="_self")&&!ime(t)}function zT(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function ome(t,e){let r=zT(t);return e&&e.forEach((n,s)=>{r.has(s)||e.getAll(s).forEach(a=>{r.append(s,a)})}),r}var $5=null;function lme(){if($5===null)try{new FormData(document.createElement("form"),0),$5=!1}catch{$5=!0}return $5}var cme=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function UC(t){return t!=null&&!cme.has(t)?(xu(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ij}"`),null):t}function ume(t,e){let r,n,s,a,o;if(nme(t)){let l=t.getAttribute("action");n=l?bf(l,e):null,r=t.getAttribute("method")||sj,s=UC(t.getAttribute("enctype"))||ij,a=new FormData(t)}else if(rme(t)||sme(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?bf(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||sj,s=UC(t.getAttribute("formenctype"))||UC(l.getAttribute("enctype"))||ij,a=new FormData(l,t),!lme()){let{name:u,type:h,value:f}=t;if(h==="image"){let m=u?`${u}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else u&&a.append(u,f)}}else{if(a_(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=sj,n=null,s=ij,o=t}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function vL(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function dme(t,e,r,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:e&&bf(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function hme(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fme(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function pme(t,e,r){let n=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await hme(a,r);return o.links?o.links():[]}return[]}));return yme(n.flat(1).filter(fme).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function UB(t,e,r,n,s,a){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>r[u].pathname!==c.pathname||r[u].route.path?.endsWith("*")&&r[u].params["*"]!==c.params["*"];return a==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?e.filter((c,u)=>{let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function mme(t,e,{includeHydrateFallback:r}={}){return gme(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function gme(t){return[...new Set(t)]}function xme(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function yme(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let a=JSON.stringify(xme(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function dJ(){let t=b.useContext(ab);return vL(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function bme(){let t=b.useContext(i_);return vL(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wL=b.createContext(void 0);wL.displayName="FrameworkContext";function hJ(){let t=b.useContext(wL);return vL(t,"You must render this element inside a <HydratedRouter> element"),t}function vme(t,e){let r=b.useContext(wL),[n,s]=b.useState(!1),[a,o]=b.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:f}=e,m=b.useRef(null);b.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let v=N=>{N.forEach(k=>{o(k.isIntersecting)})},w=new IntersectionObserver(v,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[t]),b.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let g=()=>{s(!0)},y=()=>{s(!1),o(!1)};return r?t!=="intent"?[a,m,{}]:[a,m,{onFocus:yv(l,g),onBlur:yv(c,y),onMouseEnter:yv(u,g),onMouseLeave:yv(h,y),onTouchStart:yv(f,g)}]:[!1,m,{}]}function yv(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function wme({page:t,...e}){let{router:r}=dJ(),n=b.useMemo(()=>JQ(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?b.createElement(jme,{page:t,matches:n,...e}):null}function Nme(t){let{manifest:e,routeModules:r}=hJ(),[n,s]=b.useState([]);return b.useEffect(()=>{let a=!1;return pme(t,e,r).then(o=>{a||s(o)}),()=>{a=!0}},[t,e,r]),n}function jme({page:t,matches:e,...r}){let n=Ca(),{future:s,manifest:a,routeModules:o}=hJ(),{basename:l}=dJ(),{loaderData:c,matches:u}=bme(),h=b.useMemo(()=>UB(t,e,u,a,n,"data"),[t,e,u,a,n]),f=b.useMemo(()=>UB(t,e,u,a,n,"assets"),[t,e,u,a,n]),m=b.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let v=new Set,w=!1;if(e.forEach(k=>{let C=a.routes[k.route.id];!C||!C.hasLoader||(!h.some(I=>I.route.id===k.route.id)&&k.route.id in c&&o[k.route.id]?.shouldRevalidate||C.hasClientLoader?w=!0:v.add(k.route.id))}),v.size===0)return[];let N=dme(t,l,s.unstable_trailingSlashAwareDataRequests,"data");return w&&v.size>0&&N.searchParams.set("_routes",e.filter(k=>v.has(k.route.id)).map(k=>k.route.id).join(",")),[N.pathname+N.search]},[l,s.unstable_trailingSlashAwareDataRequests,c,n,a,h,e,t,o]),g=b.useMemo(()=>mme(f,a),[f,a]),y=Nme(f);return b.createElement(b.Fragment,null,m.map(v=>b.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...r})),g.map(v=>b.createElement("link",{key:v,rel:"modulepreload",href:v,...r})),y.map(({key:v,link:w})=>b.createElement("link",{key:v,nonce:r.nonce,...w,crossOrigin:w.crossOrigin??r.crossOrigin})))}function kme(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var _me=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_me&&(window.__reactRouterVersion="7.13.0")}catch{}function Sme({basename:t,children:e,unstable_useTransitions:r,window:n}){let s=b.useRef();s.current==null&&(s.current=ape({window:n,v5Compat:!0}));let a=s.current,[o,l]=b.useState({action:a.action,location:a.location}),c=b.useCallback(u=>{r===!1?l(u):b.startTransition(()=>l(u))},[r]);return b.useLayoutEffect(()=>a.listen(c),[a,c]),b.createElement(tme,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:r})}var fJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hr=b.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m,...g},y){let{basename:v,unstable_useTransitions:w}=b.useContext(Bc),N=typeof u=="string"&&fJ.test(u),k=rJ(u,v);u=k.to;let C=$pe(u,{relative:s}),[I,O,L]=vme(n,g),_=Ame(u,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:f,unstable_defaultShouldRevalidate:m,unstable_useTransitions:w});function E(B){e&&e(B),B.defaultPrevented||_(B)}let M=b.createElement("a",{...g,...L,href:k.absoluteURL||C,onClick:k.isExternal||a?e:E,ref:kme(y,O),target:c,"data-discover":!N&&r==="render"?"true":void 0});return I&&!N?b.createElement(b.Fragment,null,M,b.createElement(wme,{page:C})):M});Hr.displayName="Link";var NL=b.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...u},h){let f=K2(o,{relative:u.relative}),m=Ca(),g=b.useContext(i_),{navigator:y,basename:v}=b.useContext(Bc),w=g!=null&&Ome(f)&&l===!0,N=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,k=m.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(k=k.toLowerCase(),C=C?C.toLowerCase():null,N=N.toLowerCase()),C&&v&&(C=bf(C,v)||C);const I=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let O=k===N||!s&&k.startsWith(N)&&k.charAt(I)==="/",L=C!=null&&(C===N||!s&&C.startsWith(N)&&C.charAt(N.length)==="/"),_={isActive:O,isPending:L,isTransitioning:w},E=O?e:void 0,M;typeof n=="function"?M=n(_):M=[n,O?"active":null,L?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let B=typeof a=="function"?a(_):a;return b.createElement(Hr,{...u,"aria-current":E,className:M,ref:h,style:B,to:o,viewTransition:l},typeof c=="function"?c(_):c)});NL.displayName="NavLink";var Cme=b.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:a,method:o=sj,action:l,onSubmit:c,relative:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m,...g},y)=>{let{unstable_useTransitions:v}=b.useContext(Bc),w=Pme(),N=Lme(l,{relative:u}),k=o.toLowerCase()==="get"?"get":"post",C=typeof l=="string"&&fJ.test(l),I=O=>{if(c&&c(O),O.defaultPrevented)return;O.preventDefault();let L=O.nativeEvent.submitter,_=L?.getAttribute("formmethod")||o,E=()=>w(L||O.currentTarget,{fetcherKey:e,method:_,navigate:r,replace:s,state:a,relative:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m});v&&r!==!1?b.startTransition(()=>E()):E()};return b.createElement("form",{ref:y,method:k,action:N,onSubmit:n?c:I,...g,"data-discover":!C&&t==="render"?"true":void 0})});Cme.displayName="Form";function Eme(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pJ(t){let e=b.useContext(ab);return Si(e,Eme(t)),e}function Ame(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=yn(),h=Ca(),f=K2(t,{relative:a});return b.useCallback(m=>{if(ame(m,e)){m.preventDefault();let g=r!==void 0?r:V1(h)===V1(f),y=()=>u(t,{replace:g,state:n,preventScrollReset:s,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l});c?b.startTransition(()=>y()):y()}},[h,u,f,r,n,e,t,s,a,o,l,c])}function mJ(t){xu(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(zT(t)),r=b.useRef(!1),n=Ca(),s=b.useMemo(()=>ome(n.search,r.current?null:e.current),[n.search]),a=yn(),o=b.useCallback((l,c)=>{const u=zT(typeof l=="function"?l(new URLSearchParams(s)):l);r.current=!0,a("?"+u,c)},[a,s]);return[s,o]}var Tme=0,Ime=()=>`__${String(++Tme)}__`;function Pme(){let{router:t}=pJ("useSubmit"),{basename:e}=b.useContext(Bc),r=Qpe(),n=t.fetch,s=t.navigate;return b.useCallback(async(a,o={})=>{let{action:l,method:c,encType:u,formData:h,body:f}=ume(a,e);if(o.navigate===!1){let m=o.fetcherKey||Ime();await n(m,r,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await s(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,s,e,r])}function Lme(t,{relative:e}={}){let{basename:r}=b.useContext(Bc),n=b.useContext(xd);Si(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...K2(t||".",{relative:e})},o=Ca();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(h=>h==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let h=l.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:df([r,a.pathname])),V1(a)}function Ome(t,{relative:e}={}){let r=b.useContext(sJ);Si(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=pJ("useViewTransitionState"),s=K2(t,{relative:e});if(!r.isTransitioning)return!1;let a=bf(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=bf(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Zj(s.pathname,o)!=null||Zj(s.pathname,a)!=null}var Kn=QQ();const o_=Pl(Kn);function Mme(){const{pathname:t}=Ca();return b.useEffect(()=>{window.scrollTo(0,0)},[t]),null}class Rme{constructor(){this.timeline=[],this.pointer=-1,this.limit=50,this.listeners=new Set}init(e){this.timeline=[{state:this._clone(e),action:"Initial State",timestamp:Date.now()}],this.pointer=0,this._notify()}push(e,r,n=null,s=null){this.pointer<this.timeline.length-1&&(this.timeline=this.timeline.slice(0,this.pointer+1)),this.timeline.push({state:this._clone(r),action:e,timestamp:Date.now(),undoFn:n,redoFn:s}),this.timeline.length>this.limit?this.timeline.shift():this.pointer++,this._notify()}async undo(){if(!this.canUndo())return null;const e=this.timeline[this.pointer];if(e.undoFn)try{await e.undoFn()}catch(n){console.error("Undo callback failed",n)}this.pointer--;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}async redo(){if(!this.canRedo())return null;this.pointer++;const e=this.timeline[this.pointer];if(e.redoFn)try{await e.redoFn()}catch(r){console.error("Redo callback failed",r)}return this._notify(),this._clone(e.state)}canUndo(){return this.pointer>0}canRedo(){return this.pointer<this.timeline.length-1}getLog(){return[...this.timeline].reverse()}getCurrentAction(){return this.timeline[this.pointer]?.action||"Unknown"}_clone(e){try{return JSON.parse(JSON.stringify(e))}catch(r){return console.error("[HistoryService] Clone failed",r),e}}async jumpTo(e){if(e<0||e>=this.timeline.length)return null;if(e<this.pointer)for(let n=this.pointer;n>e;n--){const s=this.timeline[n];if(s.undoFn)try{await s.undoFn()}catch(a){console.error(`Undo failed at step ${n}`,a)}}else if(e>this.pointer)for(let n=this.pointer+1;n<=e;n++){const s=this.timeline[n];if(s.redoFn)try{await s.redoFn()}catch(a){console.error(`Redo failed at step ${n}`,a)}}this.pointer=e;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}_notify(){this.listeners.forEach(e=>e({canUndo:this.canUndo(),canRedo:this.canRedo(),history:this.getLog(),pointer:this.pointer,activeState:this.timeline[this.pointer]?.state}))}}const pm=new Rme,zB=({isOpen:t,onClose:e})=>{const[r,n]=b.useState({history:[],pointer:-1});if(b.useEffect(()=>t?(n({history:pm.getLog(),pointer:pm.pointer}),pm.subscribe(c=>{n({history:c.history,pointer:c.pointer})})):void 0,[t]),!t)return null;const{history:s,pointer:a}=r,o=async l=>{const c=s.length-1-l;c!==a&&window.confirm(`Revert to state after "${s[l].action}"?`)&&(await pm.jumpTo(c),e())};return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative flex flex-col max-h-[80vh]",children:[i.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-black/20 rounded-t-2xl",children:[i.jsxs("h2",{className:"text-lg font-black text-white uppercase tracking-wider flex items-center gap-2",children:[i.jsx("span",{className:"text-cyan-400",children:"Time Machine"}),i.jsx("span",{className:"text-[10px] bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-white/10",children:"Session History"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"overflow-y-auto p-4 custom-scrollbar space-y-2 flex-grow",children:s.length===0?i.jsx("div",{className:"text-center text-gray-500 py-10",children:"No actions recorded this session."}):s.map((l,c)=>{const u=s.length-1-c,h=u<a,f=u===a,m=u>a;return i.jsxs("div",{onClick:()=>o(c),className:`
                                        relative pl-4 pr-3 py-3 rounded-xl border transition-all cursor-pointer group flex items-start gap-3
                                        ${f?"bg-cyan-900/20 border-cyan-500/50 ring-1 ring-cyan-500/20":""}
                                        ${h?"bg-gray-800/50 border-white/5 opacity-70 hover:opacity-100 hover:bg-gray-800":""}
                                        ${m?"bg-gray-900/30 border-white/5 opacity-40 hover:opacity-100 grayscale hover:grayscale-0":""}
                                    `,children:[c!==s.length-1&&i.jsx("div",{className:"absolute left-[27px] top-10 bottom-[-10px] w-px bg-white/10 group-hover:bg-white/20"}),i.jsx("div",{className:`
                                        w-6 h-6 rounded-full flex items-center justify-center shrink-0 z-10 transition-colors
                                        ${f?"bg-cyan-500 text-black shadow-[0_0_10px_rgba(6,182,212,0.5)]":"bg-gray-800 border border-white/10 text-gray-500 group-hover:border-cyan-500/50 group-hover:text-cyan-400"}
                                    `,children:f?i.jsx("div",{className:"w-2 h-2 bg-black rounded-full animate-pulse"}):c===0?i.jsx("span",{className:"text-[10px] font-bold",children:"Latest"}):i.jsx("span",{className:"text-[9px]",children:c})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`text-sm font-bold ${f?"text-cyan-400":"text-gray-300 group-hover:text-white"}`,children:l.action}),i.jsxs("div",{className:"flex justify-between items-center mt-1",children:[i.jsx("span",{className:"text-[10px] font-mono text-gray-500",children:new Date(l.timestamp).toLocaleTimeString()}),f&&i.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-cyan-600 bg-cyan-900/30 px-1.5 py-0.5 rounded",children:"Active State"})]})]}),!f&&i.jsx("div",{className:"self-center opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("div",{className:"px-2 py-1 bg-white/10 rounded text-[9px] font-bold uppercase tracking-wider text-white",children:"Restore"})})]},l.timestamp)})})]})})},Dme=()=>{};var VB={};const gJ=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},Bme=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},xJ={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,h=a>>2,f=(a&3)<<4|l>>4;let m=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(m=64)),n.push(r[h],r[f],r[m],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(gJ(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Bme(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||u==null||f==null)throw new Fme;const m=a<<2|l>>4;if(n.push(m),u!==64){const g=l<<4&240|u>>2;if(n.push(g),f!==64){const y=u<<6&192|f;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Fme extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $me=function(t){const e=gJ(t);return xJ.encodeByteArray(e,!0)},t4=function(t){return $me(t).replace(/\./g,"")},yJ=function(t){try{return xJ.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bJ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Ume=()=>bJ().__FIREBASE_DEFAULTS__,zme=()=>{if(typeof process>"u"||typeof VB>"u")return;const t=VB.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Vme=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yJ(t[1]);return e&&JSON.parse(e)},l_=()=>{try{return Dme()||Ume()||zme()||Vme()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vJ=t=>l_()?.emulatorHosts?.[t],wJ=t=>{const e=vJ(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},NJ=()=>l_()?.config,jJ=t=>l_()?.[`_${t}`];class qme{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function mg(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function jL(t){return(await fetch(t,{credentials:"include"})).ok}function kJ(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[t4(JSON.stringify(r)),t4(JSON.stringify(o)),""].join(".")}const p1={};function Hme(){const t={prod:[],emulator:[]};for(const e of Object.keys(p1))p1[e]?t.emulator.push(e):t.prod.push(e);return t}function Wme(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let qB=!1;function kL(t,e){if(typeof window>"u"||typeof document>"u"||!mg(window.location.host)||p1[t]===e||p1[t]||qB)return;p1[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=Hme().prod.length>0;function o(){const m=document.getElementById(n);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,g){m.setAttribute("width","24"),m.setAttribute("id",g),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{qB=!0,o()},m}function h(m,g){m.setAttribute("id",g),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=Wme(n),g=r("text"),y=document.getElementById(g)||document.createElement("span"),v=r("learnmore"),w=document.getElementById(v)||document.createElement("a"),N=r("preprendIcon"),k=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const C=m.element;l(C),h(w,v);const I=u();c(k,N),C.append(k,y,w,I),document.body.appendChild(C)}a?(y.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function Ya(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ya())}function _J(){const t=l_()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Yme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Xme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Qme(){const t=Ya();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SJ(){return!_J()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function CJ(){return!_J()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function EJ(){try{return typeof indexedDB=="object"}catch{return!1}}function Jme(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(r){e(r)}})}const Zme="FirebaseError";class bh extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Zme,Object.setPrototypeOf(this,bh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y2.prototype.create)}}class Y2{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?ege(a,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new bh(s,l,n)}}function ege(t,e){return t.replace(tge,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const tge=/\{\$([^}]+)}/g;function rge(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Bm(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],o=e[s];if(HB(a)&&HB(o)){if(!Bm(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function HB(t){return t!==null&&typeof t=="object"}function X2(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Qv(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Jv(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function nge(t,e){const r=new sge(t,e);return r.subscribe.bind(r)}class sge{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");ige(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=zC),s.error===void 0&&(s.error=zC),s.complete===void 0&&(s.complete=zC);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ige(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function zC(){}function _u(t){return t&&t._delegate?t._delegate:t}class cp{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Jp="[DEFAULT]";let age=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new qme;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lge(e))try{this.getOrInitializeService({instanceIdentifier:Jp})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=Jp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jp){return this.instances.has(e)}getOptions(e=Jp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:oge(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Jp){return this.component?this.component.multipleInstances?e:Jp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function oge(t){return t===Jp?void 0:t}function lge(t){return t.instantiationMode==="EAGER"}class cge{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new age(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Ln;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ln||(Ln={}));const uge={debug:Ln.DEBUG,verbose:Ln.VERBOSE,info:Ln.INFO,warn:Ln.WARN,error:Ln.ERROR,silent:Ln.SILENT},dge=Ln.INFO,hge={[Ln.DEBUG]:"log",[Ln.VERBOSE]:"log",[Ln.INFO]:"info",[Ln.WARN]:"warn",[Ln.ERROR]:"error"},fge=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=hge[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _L{constructor(e){this.name=e,this._logLevel=dge,this._logHandler=fge,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ln))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uge[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ln.DEBUG,...e),this._logHandler(this,Ln.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ln.VERBOSE,...e),this._logHandler(this,Ln.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ln.INFO,...e),this._logHandler(this,Ln.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ln.WARN,...e),this._logHandler(this,Ln.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ln.ERROR,...e),this._logHandler(this,Ln.ERROR,...e)}}const pge=(t,e)=>e.some(r=>t instanceof r);let WB,GB;function mge(){return WB||(WB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gge(){return GB||(GB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AJ=new WeakMap,VT=new WeakMap,TJ=new WeakMap,VC=new WeakMap,SL=new WeakMap;function xge(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Q0(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&AJ.set(r,t)}).catch(()=>{}),SL.set(e,t),e}function yge(t){if(VT.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});VT.set(t,e)}let qT={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return VT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||TJ.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Q0(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bge(t){qT=t(qT)}function vge(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(qC(this),e,...r);return TJ.set(n,e.sort?e.sort():[e]),Q0(n)}:gge().includes(t)?function(...e){return t.apply(qC(this),e),Q0(AJ.get(this))}:function(...e){return Q0(t.apply(qC(this),e))}}function wge(t){return typeof t=="function"?vge(t):(t instanceof IDBTransaction&&yge(t),pge(t,mge())?new Proxy(t,qT):t)}function Q0(t){if(t instanceof IDBRequest)return xge(t);if(VC.has(t))return VC.get(t);const e=wge(t);return e!==t&&(VC.set(t,e),SL.set(e,t)),e}const qC=t=>SL.get(t);function Nge(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),l=Q0(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Q0(o.result),c.oldVersion,c.newVersion,Q0(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const jge=["get","getKey","getAll","getAllKeys","count"],kge=["put","add","delete","clear"],HC=new Map;function KB(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(HC.get(e))return HC.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=kge.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||jge.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),s&&c.done]))[0]};return HC.set(e,a),a}bge(t=>({...t,get:(e,r,n)=>KB(e,r)||t.get(e,r,n),has:(e,r)=>!!KB(e,r)||t.has(e,r)}));class _ge{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Sge(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Sge(t){return t.getComponent()?.type==="VERSION"}const HT="@firebase/app",YB="0.14.7";const vf=new _L("@firebase/app"),Cge="@firebase/app-compat",Ege="@firebase/analytics-compat",Age="@firebase/analytics",Tge="@firebase/app-check-compat",Ige="@firebase/app-check",Pge="@firebase/auth",Lge="@firebase/auth-compat",Oge="@firebase/database",Mge="@firebase/data-connect",Rge="@firebase/database-compat",Dge="@firebase/functions",Bge="@firebase/functions-compat",Fge="@firebase/installations",$ge="@firebase/installations-compat",Uge="@firebase/messaging",zge="@firebase/messaging-compat",Vge="@firebase/performance",qge="@firebase/performance-compat",Hge="@firebase/remote-config",Wge="@firebase/remote-config-compat",Gge="@firebase/storage",Kge="@firebase/storage-compat",Yge="@firebase/firestore",Xge="@firebase/ai",Qge="@firebase/firestore-compat",Jge="firebase",Zge="12.8.0";const WT="[DEFAULT]",exe={[HT]:"fire-core",[Cge]:"fire-core-compat",[Age]:"fire-analytics",[Ege]:"fire-analytics-compat",[Ige]:"fire-app-check",[Tge]:"fire-app-check-compat",[Pge]:"fire-auth",[Lge]:"fire-auth-compat",[Oge]:"fire-rtdb",[Mge]:"fire-data-connect",[Rge]:"fire-rtdb-compat",[Dge]:"fire-fn",[Bge]:"fire-fn-compat",[Fge]:"fire-iid",[$ge]:"fire-iid-compat",[Uge]:"fire-fcm",[zge]:"fire-fcm-compat",[Vge]:"fire-perf",[qge]:"fire-perf-compat",[Hge]:"fire-rc",[Wge]:"fire-rc-compat",[Gge]:"fire-gcs",[Kge]:"fire-gcs-compat",[Yge]:"fire-fst",[Qge]:"fire-fst-compat",[Xge]:"fire-vertex","fire-js":"fire-js",[Jge]:"fire-js-all"};const r4=new Map,txe=new Map,GT=new Map;function XB(t,e){try{t.container.addComponent(e)}catch(r){vf.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Fm(t){const e=t.name;if(GT.has(e))return vf.debug(`There were multiple attempts to register component ${e}.`),!1;GT.set(e,t);for(const r of r4.values())XB(r,t);for(const r of txe.values())XB(r,t);return!0}function c_(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function sc(t){return t==null?!1:t.settings!==void 0}const rxe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},J0=new Y2("app","Firebase",rxe);class nxe{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new cp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw J0.create("app-deleted",{appName:this._name})}}const gg=Zge;function IJ(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:WT,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw J0.create("bad-app-name",{appName:String(s)});if(r||(r=NJ()),!r)throw J0.create("no-options");const a=r4.get(s);if(a){if(Bm(r,a.options)&&Bm(n,a.config))return a;throw J0.create("duplicate-app",{appName:s})}const o=new cge(s);for(const c of GT.values())o.addComponent(c);const l=new nxe(r,n,o);return r4.set(s,l),l}function CL(t=WT){const e=r4.get(t);if(!e&&t===WT&&NJ())return IJ();if(!e)throw J0.create("no-app",{appName:t});return e}function rh(t,e,r){let n=exe[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vf.warn(o.join(" "));return}Fm(new cp(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const sxe="firebase-heartbeat-database",ixe=1,q1="firebase-heartbeat-store";let WC=null;function PJ(){return WC||(WC=Nge(sxe,ixe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(q1)}catch(r){console.warn(r)}}}}).catch(t=>{throw J0.create("idb-open",{originalErrorMessage:t.message})})),WC}async function axe(t){try{const r=(await PJ()).transaction(q1),n=await r.objectStore(q1).get(LJ(t));return await r.done,n}catch(e){if(e instanceof bh)vf.warn(e.message);else{const r=J0.create("idb-get",{originalErrorMessage:e?.message});vf.warn(r.message)}}}async function QB(t,e){try{const n=(await PJ()).transaction(q1,"readwrite");await n.objectStore(q1).put(e,LJ(t)),await n.done}catch(r){if(r instanceof bh)vf.warn(r.message);else{const n=J0.create("idb-set",{originalErrorMessage:r?.message});vf.warn(n.message)}}}function LJ(t){return`${t.name}!${t.options.appId}`}const oxe=1024,lxe=30;class cxe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new dxe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=JB();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>lxe){const s=hxe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){vf.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=JB(),{heartbeatsToSend:r,unsentEntries:n}=uxe(this._heartbeatsCache.heartbeats),s=t4(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return vf.warn(e),""}}}function JB(){return new Date().toISOString().substring(0,10)}function uxe(t,e=oxe){const r=[];let n=t.slice();for(const s of t){const a=r.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),ZB(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),ZB(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class dxe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return EJ()?Jme().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await axe(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return QB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return QB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function ZB(t){return t4(JSON.stringify({version:2,heartbeats:t})).length}function hxe(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function fxe(t){Fm(new cp("platform-logger",e=>new _ge(e),"PRIVATE")),Fm(new cp("heartbeat",e=>new cxe(e),"PRIVATE")),rh(HT,YB,t),rh(HT,YB,"esm2020"),rh("fire-js","")}fxe("");function OJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pxe=OJ,MJ=new Y2("auth","Firebase",OJ());const n4=new _L("@firebase/auth");function mxe(t,...e){n4.logLevel<=Ln.WARN&&n4.warn(`Auth (${gg}): ${t}`,...e)}function aj(t,...e){n4.logLevel<=Ln.ERROR&&n4.error(`Auth (${gg}): ${t}`,...e)}function yu(t,...e){throw AL(t,...e)}function sd(t,...e){return AL(t,...e)}function EL(t,e,r){const n={...pxe(),[e]:r};return new Y2("auth","Firebase",n).create(e,{appName:t.name})}function hf(t){return EL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gxe(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&yu(t,"argument-error"),EL(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function AL(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return MJ.create(t,...e)}function Gr(t,e,...r){if(!t)throw AL(e,...r)}function nf(t){const e="INTERNAL ASSERTION FAILED: "+t;throw aj(e),new Error(e)}function wf(t,e){t||nf(e)}function KT(){return typeof self<"u"&&self.location?.href||""}function xxe(){return eF()==="http:"||eF()==="https:"}function eF(){return typeof self<"u"&&self.location?.protocol||null}function yxe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xxe()||Yme()||"connection"in navigator)?navigator.onLine:!0}function bxe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Q2{constructor(e,r){this.shortDelay=e,this.longDelay=r,wf(r>e,"Short delay should be less than long delay!"),this.isMobile=Gme()||Xme()}get(){return yxe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function TL(t,e){wf(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class RJ{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;nf("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;nf("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;nf("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const vxe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const wxe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Nxe=new Q2(3e4,6e4);function Rf(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Df(t,e,r,n,s={}){return DJ(t,s,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=X2({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...a};return Kme()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&mg(t.emulatorConfig.host)&&(u.credentials="include"),RJ.fetch()(await BJ(t,t.config.apiHost,r,l),u)})}async function DJ(t,e,r){t._canInitEmulator=!1;const n={...vxe,...e};try{const s=new kxe(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw U5(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw U5(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw U5(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw U5(t,"user-disabled",o);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw EL(t,h,u);yu(t,h)}}catch(s){if(s instanceof bh)throw s;yu(t,"network-request-failed",{message:String(s)})}}async function J2(t,e,r,n,s={}){const a=await Df(t,e,r,n,s);return"mfaPendingCredential"in a&&yu(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function BJ(t,e,r,n){const s=`${e}${r}?${n}`,a=t,o=a.config.emulator?TL(t.config,s):`${t.config.apiScheme}://${s}`;return wxe.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function jxe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kxe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(sd(this.auth,"network-request-failed")),Nxe.get())})}}function U5(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=sd(t,e,n);return s.customData._tokenResponse=r,s}function tF(t){return t!==void 0&&t.enterprise!==void 0}class _xe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return jxe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Sxe(t,e){return Df(t,"GET","/v2/recaptchaConfig",Rf(t,e))}async function Cxe(t,e){return Df(t,"POST","/v1/accounts:delete",e)}async function s4(t,e){return Df(t,"POST","/v1/accounts:lookup",e)}function m1(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Exe(t,e=!1){const r=_u(t),n=await r.getIdToken(e),s=IL(n);Gr(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a?.sign_in_provider;return{claims:s,token:n,authTime:m1(GC(s.auth_time)),issuedAtTime:m1(GC(s.iat)),expirationTime:m1(GC(s.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function GC(t){return Number(t)*1e3}function IL(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return aj("JWT malformed, contained fewer than 3 sections"),null;try{const s=yJ(r);return s?JSON.parse(s):(aj("Failed to decode base64 JWT payload"),null)}catch(s){return aj("Caught error parsing JWT payload as JSON",s?.toString()),null}}function rF(t){const e=IL(t);return Gr(e,"internal-error"),Gr(typeof e.exp<"u","internal-error"),Gr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function H1(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof bh&&Axe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Axe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Txe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class YT{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=m1(this.lastLoginAt),this.creationTime=m1(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function i4(t){const e=t.auth,r=await t.getIdToken(),n=await H1(t,s4(e,{idToken:r}));Gr(n?.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const a=s.providerUserInfo?.length?FJ(s.providerUserInfo):[],o=Pxe(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!o?.length,u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new YT(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Ixe(t){const e=_u(t);await i4(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Pxe(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function FJ(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function Lxe(t,e){const r=await DJ(t,{},async()=>{const n=X2({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,o=await BJ(t,s,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&mg(t.emulatorConfig.host)&&(c.credentials="include"),RJ.fetch()(o,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Oxe(t,e){return Df(t,"POST","/v2/accounts:revokeToken",Rf(t,e))}class sy{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gr(e.idToken,"internal-error"),Gr(typeof e.idToken<"u","internal-error"),Gr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rF(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Gr(e.length!==0,"internal-error");const r=rF(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Gr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await Lxe(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,o=new sy;return n&&(Gr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Gr(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(Gr(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sy,this.toJSON())}_performRefresh(){return nf("not implemented")}}function k0(t,e){Gr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ed{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new Txe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new YT(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await H1(this,this.stsTokenManager.getToken(this.auth,e));return Gr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Exe(this,e)}reload(){return Ixe(this)}_assign(e){this!==e&&(Gr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ed({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Gr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await i4(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sc(this.auth.app))return Promise.reject(hf(this.auth));const e=await this.getIdToken();return await H1(this,Cxe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,a=r.phoneNumber??void 0,o=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:g,providerData:y,stsTokenManager:v}=r;Gr(f&&v,e,"internal-error");const w=sy.fromJSON(this.name,v);Gr(typeof f=="string",e,"internal-error"),k0(n,e.name),k0(s,e.name),Gr(typeof m=="boolean",e,"internal-error"),Gr(typeof g=="boolean",e,"internal-error"),k0(a,e.name),k0(o,e.name),k0(l,e.name),k0(c,e.name),k0(u,e.name),k0(h,e.name);const N=new ed({uid:f,auth:e,email:s,emailVerified:m,displayName:n,isAnonymous:g,photoURL:o,phoneNumber:a,tenantId:l,stsTokenManager:w,createdAt:u,lastLoginAt:h});return y&&Array.isArray(y)&&(N.providerData=y.map(k=>({...k}))),c&&(N._redirectEventId=c),N}static async _fromIdTokenResponse(e,r,n=!1){const s=new sy;s.updateFromServerResponse(r);const a=new ed({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await i4(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Gr(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?FJ(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!a?.length,l=new sy;l.updateFromIdToken(n);const c=new ed({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new YT(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(c,u),c}}const nF=new Map;function sf(t){wf(t instanceof Function,"Expected a class definition");let e=nF.get(t);return e?(wf(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nF.set(t,e),e)}class $J{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}$J.type="NONE";const sF=$J;function oj(t,e,r){return`firebase:${t}:${e}:${r}`}class iy{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=oj(this.userKey,s.apiKey,a),this.fullPersistenceKey=oj("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await s4(this.auth,{idToken:e}).catch(()=>{});return r?ed._fromGetAccountInfoResponse(this.auth,r,e):null}return ed._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new iy(sf(sF),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=s[0]||sf(sF);const o=oj(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const h=await u._get(o);if(h){let f;if(typeof h=="string"){const m=await s4(e,{idToken:h}).catch(()=>{});if(!m)break;f=await ed._fromGetAccountInfoResponse(e,m,h)}else f=ed._fromJSON(e,h);u!==a&&(l=f),a=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new iy(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(o)}catch{}})),new iy(a,e,n))}}function iF(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WJ(e))return"Blackberry";if(GJ(e))return"Webos";if(zJ(e))return"Safari";if((e.includes("chrome/")||VJ(e))&&!e.includes("edge/"))return"Chrome";if(HJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function UJ(t=Ya()){return/firefox\//i.test(t)}function zJ(t=Ya()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VJ(t=Ya()){return/crios\//i.test(t)}function qJ(t=Ya()){return/iemobile/i.test(t)}function HJ(t=Ya()){return/android/i.test(t)}function WJ(t=Ya()){return/blackberry/i.test(t)}function GJ(t=Ya()){return/webos/i.test(t)}function PL(t=Ya()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Mxe(t=Ya()){return PL(t)&&!!window.navigator?.standalone}function Rxe(){return Qme()&&document.documentMode===10}function KJ(t=Ya()){return PL(t)||HJ(t)||GJ(t)||WJ(t)||/windows phone/i.test(t)||qJ(t)}function YJ(t,e=[]){let r;switch(t){case"Browser":r=iF(Ya());break;case"Worker":r=`${iF(Ya())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${gg}/${n}`}class Dxe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function Bxe(t,e={}){return Df(t,"GET","/v2/passwordPolicy",Rf(t,e))}const Fxe=6;class $xe{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Fxe,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Uxe{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aF(this),this.idTokenSubscription=new aF(this),this.beforeStateQueue=new Dxe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=MJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=sf(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await iy.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await s4(this,{idToken:e}),n=await ed._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(sc(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&l?.user&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Gr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await i4(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bxe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(sc(this.app))return Promise.reject(hf(this));const r=e?_u(e):null;return r&&Gr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Gr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return sc(this.app)?Promise.reject(hf(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return sc(this.app)?Promise.reject(hf(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Bxe(this),r=new $xe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Y2("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Oxe(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&sf(e)||this._popupRedirectResolver;Gr(r,this,"argument-error"),this.redirectPersistenceManager=await iy.create(this,[sf(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gr(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(sc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&mxe(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Bf(t){return _u(t)}class aF{constructor(e){this.auth=e,this.observer=null,this.addObserver=nge(r=>this.observer=r)}get next(){return Gr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let u_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zxe(t){u_=t}function XJ(t){return u_.loadJS(t)}function Vxe(){return u_.recaptchaEnterpriseScript}function qxe(){return u_.gapiScript}function Hxe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Wxe{constructor(){this.enterprise=new Gxe}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class Gxe{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const Kxe="recaptcha-enterprise",QJ="NO_RECAPTCHA";class Yxe{constructor(e){this.type=Kxe,this.auth=Bf(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{Sxe(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new _xe(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(a,o,l){const c=window.grecaptcha;tF(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{o(u)}).catch(()=>{o(QJ)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Wxe().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&tF(window.grecaptcha))s(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Vxe();c.length!==0&&(c+=l),XJ(c).then(()=>{s(l,a,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function oF(t,e,r,n=!1,s=!1){const a=new Yxe(t);let o;if(s)o=QJ;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const l={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function a4(t,e,r,n,s){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await oF(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await oF(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}function Xxe(t,e){const r=c_(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Bm(a,e??{}))return s;yu(s,"already-initialized")}return r.initialize({options:e})}function Qxe(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(sf);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Jxe(t,e,r){const n=Bf(t);Gr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=JJ(e),{host:o,port:l}=Zxe(e),c=l===null?"":`:${l}`,u={url:`${a}//${o}${c}/`},h=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Gr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Gr(Bm(u,n.config.emulator)&&Bm(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,mg(o)?(jL(`${a}//${o}${c}`),kL("Auth",!0)):eye()}function JJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Zxe(t){const e=JJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:lF(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:lF(o)}}}function lF(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function eye(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class LL{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return nf("not implemented")}_getIdTokenResponse(e){return nf("not implemented")}_linkToIdToken(e,r){return nf("not implemented")}_getReauthenticationResolver(e){return nf("not implemented")}}async function tye(t,e){return Df(t,"POST","/v1/accounts:signUp",e)}async function rye(t,e){return J2(t,"POST","/v1/accounts:signInWithPassword",Rf(t,e))}async function ZJ(t,e){return Df(t,"POST","/v1/accounts:sendOobCode",Rf(t,e))}async function nye(t,e){return ZJ(t,e)}async function sye(t,e){return ZJ(t,e)}async function iye(t,e){return J2(t,"POST","/v1/accounts:signInWithEmailLink",Rf(t,e))}async function aye(t,e){return J2(t,"POST","/v1/accounts:signInWithEmailLink",Rf(t,e))}class W1 extends LL{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new W1(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new W1(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return a4(e,r,"signInWithPassword",rye);case"emailLink":return iye(e,{email:this._email,oobCode:this._password});default:yu(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return a4(e,n,"signUpPassword",tye);case"emailLink":return aye(e,{idToken:r,email:this._email,oobCode:this._password});default:yu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ay(t,e){return J2(t,"POST","/v1/accounts:signInWithIdp",Rf(t,e))}const oye="http://localhost";class $m extends LL{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new $m(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):yu("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...a}=r;if(!n||!s)return null;const o=new $m(n,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return ay(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ay(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ay(e,r)}buildRequest(){const e={requestUri:oye,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=X2(r)}return e}}function lye(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cye(t){const e=Qv(Jv(t)).link,r=e?Qv(Jv(e)).deep_link_id:null,n=Qv(Jv(t)).deep_link_id;return(n?Qv(Jv(n)).link:null)||n||r||e||t}class OL{constructor(e){const r=Qv(Jv(e)),n=r.apiKey??null,s=r.oobCode??null,a=lye(r.mode??null);Gr(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=cye(e);try{return new OL(r)}catch{return null}}}class lb{constructor(){this.providerId=lb.PROVIDER_ID}static credential(e,r){return W1._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=OL.parseLink(r);return Gr(n,"argument-error"),W1._fromEmailAndCode(e,n.code,n.tenantId)}}lb.PROVIDER_ID="password";lb.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lb.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ML{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Z2 extends ML{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class D0 extends Z2{constructor(){super("facebook.com")}static credential(e){return $m._fromParams({providerId:D0.PROVIDER_ID,signInMethod:D0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return D0.credentialFromTaggedObject(e)}static credentialFromError(e){return D0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return D0.credential(e.oauthAccessToken)}catch{return null}}}D0.FACEBOOK_SIGN_IN_METHOD="facebook.com";D0.PROVIDER_ID="facebook.com";class Jh extends Z2{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return $m._fromParams({providerId:Jh.PROVIDER_ID,signInMethod:Jh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Jh.credentialFromTaggedObject(e)}static credentialFromError(e){return Jh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Jh.credential(r,n)}catch{return null}}}Jh.GOOGLE_SIGN_IN_METHOD="google.com";Jh.PROVIDER_ID="google.com";class B0 extends Z2{constructor(){super("github.com")}static credential(e){return $m._fromParams({providerId:B0.PROVIDER_ID,signInMethod:B0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return B0.credentialFromTaggedObject(e)}static credentialFromError(e){return B0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return B0.credential(e.oauthAccessToken)}catch{return null}}}B0.GITHUB_SIGN_IN_METHOD="github.com";B0.PROVIDER_ID="github.com";class F0 extends Z2{constructor(){super("twitter.com")}static credential(e,r){return $m._fromParams({providerId:F0.PROVIDER_ID,signInMethod:F0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return F0.credentialFromTaggedObject(e)}static credentialFromError(e){return F0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return F0.credential(r,n)}catch{return null}}}F0.TWITTER_SIGN_IN_METHOD="twitter.com";F0.PROVIDER_ID="twitter.com";async function uye(t,e){return J2(t,"POST","/v1/accounts:signUp",Rf(t,e))}class Um{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await ed._fromIdTokenResponse(e,n,s),o=cF(n);return new Um({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=cF(n);return new Um({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function cF(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class o4 extends bh{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,o4.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new o4(e,r,n,s)}}function eZ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?o4._fromErrorAndOperation(t,a,e,n):a})}async function dye(t,e,r=!1){const n=await H1(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Um._forOperation(t,"link",n)}async function hye(t,e,r=!1){const{auth:n}=t;if(sc(n.app))return Promise.reject(hf(n));const s="reauthenticate";try{const a=await H1(t,eZ(n,s,e,t),r);Gr(a.idToken,n,"internal-error");const o=IL(a.idToken);Gr(o,n,"internal-error");const{sub:l}=o;return Gr(t.uid===l,n,"user-mismatch"),Um._forOperation(t,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&yu(n,"user-mismatch"),a}}async function tZ(t,e,r=!1){if(sc(t.app))return Promise.reject(hf(t));const n="signIn",s=await eZ(t,n,e),a=await Um._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function fye(t,e){return tZ(Bf(t),e)}async function rZ(t){const e=Bf(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function pye(t,e,r){const n=Bf(t);await a4(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",sye)}async function mye(t,e,r){if(sc(t.app))return Promise.reject(hf(t));const n=Bf(t),o=await a4(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uye).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&rZ(t),c}),l=await Um._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function gye(t,e,r){return sc(t.app)?Promise.reject(hf(t)):fye(_u(t),lb.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&rZ(t),n})}async function xye(t,e){const r=_u(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await nye(r.auth,s);a!==t.email&&await t.reload()}function yye(t,e,r,n){return _u(t).onIdTokenChanged(e,r,n)}function bye(t,e,r){return _u(t).beforeAuthStateChanged(e,r)}function vye(t,e,r,n){return _u(t).onAuthStateChanged(e,r,n)}function wye(t){return _u(t).signOut()}const l4="__sak";class nZ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(l4,"1"),this.storage.removeItem(l4),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Nye=1e3,jye=10;class sZ extends nZ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=KJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);Rxe()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,jye):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Nye)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}sZ.type="LOCAL";const kye=sZ;class iZ extends nZ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}iZ.type="SESSION";const aZ=iZ;function _ye(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class d_{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new d_(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,o=this.handlersMap[s];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async u=>u(r.origin,a)),c=await _ye(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}d_.receivers=[];function RL(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class Sye{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const u=RL("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(m.data.response);break;default:clearTimeout(h),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function nh(){return window}function Cye(t){nh().location.href=t}function oZ(){return typeof nh().WorkerGlobalScope<"u"&&typeof nh().importScripts=="function"}async function Eye(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Aye(){return navigator?.serviceWorker?.controller||null}function Tye(){return oZ()?self:null}const lZ="firebaseLocalStorageDb",Iye=1,c4="firebaseLocalStorage",cZ="fbase_key";class ew{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function h_(t,e){return t.transaction([c4],e?"readwrite":"readonly").objectStore(c4)}function Pye(){const t=indexedDB.deleteDatabase(lZ);return new ew(t).toPromise()}function XT(){const t=indexedDB.open(lZ,Iye);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(c4,{keyPath:cZ})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(c4)?e(n):(n.close(),await Pye(),e(await XT()))})})}async function uF(t,e,r){const n=h_(t,!0).put({[cZ]:e,value:r});return new ew(n).toPromise()}async function Lye(t,e){const r=h_(t,!1).get(e),n=await new ew(r).toPromise();return n===void 0?null:n.value}function dF(t,e){const r=h_(t,!0).delete(e);return new ew(r).toPromise()}const Oye=800,Mye=3;class uZ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await XT(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Mye)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oZ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=d_._getInstance(Tye()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Eye(),!this.activeServiceWorker)return;this.sender=new Sye(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Aye()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await XT();return await uF(e,l4,"1"),await dF(e,l4),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>uF(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Lye(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>dF(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=h_(s,!1).getAll();return new ew(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Oye)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uZ.type="LOCAL";const Rye=uZ;new Q2(3e4,6e4);function dZ(t,e){return e?sf(e):(Gr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class DL extends LL{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ay(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ay(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ay(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Dye(t){return tZ(t.auth,new DL(t),t.bypassAuthState)}function Bye(t){const{auth:e,user:r}=t;return Gr(r,e,"internal-error"),hye(r,new DL(t),t.bypassAuthState)}async function Fye(t){const{auth:e,user:r}=t;return Gr(r,e,"internal-error"),dye(r,new DL(t),t.bypassAuthState)}class hZ{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dye;case"linkViaPopup":case"linkViaRedirect":return Fye;case"reauthViaPopup":case"reauthViaRedirect":return Bye;default:yu(this.auth,"internal-error")}}resolve(e){wf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $ye=new Q2(2e3,1e4);async function Uye(t,e,r){if(sc(t.app))return Promise.reject(sd(t,"operation-not-supported-in-this-environment"));const n=Bf(t);gxe(t,e,ML);const s=dZ(n,r);return new mm(n,"signInViaPopup",e,s).executeNotNull()}class mm extends hZ{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,mm.currentPopupAction&&mm.currentPopupAction.cancel(),mm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gr(e,this.auth,"internal-error"),e}async onExecution(){wf(this.filter.length===1,"Popup operations only handle one event");const e=RL();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(sd(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(sd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,mm.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sd(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$ye.get())};e()}}mm.currentPopupAction=null;const zye="pendingRedirect",lj=new Map;class Vye extends hZ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=lj.get(this.auth._key());if(!e){try{const n=await qye(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}lj.set(this.auth._key(),e)}return this.bypassAuthState||lj.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qye(t,e){const r=Gye(e),n=Wye(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function Hye(t,e){lj.set(t._key(),e)}function Wye(t){return sf(t._redirectPersistence)}function Gye(t){return oj(zye,t.config.apiKey,t.name)}async function Kye(t,e,r=!1){if(sc(t.app))return Promise.reject(hf(t));const n=Bf(t),s=dZ(n,e),o=await new Vye(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const Yye=600*1e3;class Xye{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Qye(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!fZ(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(sd(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Yye&&this.cachedEventUids.clear(),this.cachedEventUids.has(hF(e))}saveEventToCache(e){this.cachedEventUids.add(hF(e)),this.lastProcessedEventTime=Date.now()}}function hF(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fZ({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Qye(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fZ(t);default:return!1}}async function Jye(t,e={}){return Df(t,"GET","/v1/projects",e)}const Zye=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ebe=/^https?/;async function tbe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Jye(t);for(const r of e)try{if(rbe(r))return}catch{}yu(t,"unauthorized-domain")}function rbe(t){const e=KT(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!ebe.test(r))return!1;if(Zye.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}const nbe=new Q2(3e4,6e4);function fF(){const t=nh().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function sbe(t){return new Promise((e,r)=>{function n(){fF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fF(),r(sd(t,"network-request-failed"))},timeout:nbe.get()})}if(nh().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(nh().gapi?.load)n();else{const s=Hxe("iframefcb");return nh()[s]=()=>{gapi.load?n():r(sd(t,"network-request-failed"))},XJ(`${qxe()}?onload=${s}`).catch(a=>r(a))}}).catch(e=>{throw cj=null,e})}let cj=null;function ibe(t){return cj=cj||sbe(t),cj}const abe=new Q2(5e3,15e3),obe="__/auth/iframe",lbe="emulator/auth/iframe",cbe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ube=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dbe(t){const e=t.config;Gr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?TL(e,lbe):`https://${t.config.authDomain}/${obe}`,n={apiKey:e.apiKey,appName:t.name,v:gg},s=ube.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${X2(n).slice(1)}`}async function hbe(t){const e=await ibe(t),r=nh().gapi;return Gr(r,t,"internal-error"),e.open({where:document.body,url:dbe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cbe,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const o=sd(t,"network-request-failed"),l=nh().setTimeout(()=>{a(o)},abe.get());function c(){nh().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{a(o)})}))}const fbe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pbe=500,mbe=600,gbe="_blank",xbe="http://localhost";class pF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ybe(t,e,r,n=pbe,s=mbe){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...fbe,width:n.toString(),height:s.toString(),top:a,left:o},u=Ya().toLowerCase();r&&(l=VJ(u)?gbe:r),UJ(u)&&(e=e||xbe,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[g,y])=>`${m}${g}=${y},`,"");if(Mxe(u)&&l!=="_self")return bbe(e||"",l),new pF(null);const f=window.open(e||"",l,h);Gr(f,t,"popup-blocked");try{f.focus()}catch{}return new pF(f)}function bbe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const vbe="__/auth/handler",wbe="emulator/auth/handler",Nbe=encodeURIComponent("fac");async function mF(t,e,r,n,s,a){Gr(t.config.authDomain,t,"auth-domain-config-required"),Gr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:gg,eventId:s};if(e instanceof ML){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",rge(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Z2){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${Nbe}=${encodeURIComponent(c)}`:"";return`${jbe(t)}?${X2(l).slice(1)}${u}`}function jbe({config:t}){return t.emulator?TL(t,wbe):`https://${t.authDomain}/${vbe}`}const KC="webStorageSupport";class kbe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aZ,this._completeRedirectFn=Kye,this._overrideRedirectResult=Hye}async _openPopup(e,r,n,s){wf(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await mF(e,r,n,KT(),s);return ybe(e,a,RL())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await mF(e,r,n,KT(),s);return Cye(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(wf(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await hbe(e),n=new Xye(e);return r.register("authEvent",s=>(Gr(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(KC,{type:KC},s=>{const a=s?.[0]?.[KC];a!==void 0&&r(!!a),yu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=tbe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return KJ()||zJ()||PL()}}const _be=kbe;var gF="@firebase/auth",xF="1.12.0";class Sbe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Gr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Cbe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ebe(t){Fm(new cp("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Gr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YJ(t)},u=new Uxe(n,s,a,c);return Qxe(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Fm(new cp("auth-internal",e=>{const r=Bf(e.getProvider("auth").getImmediate());return(n=>new Sbe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),rh(gF,xF,Cbe(t)),rh(gF,xF,"esm2020")}const Abe=300,Tbe=jJ("authIdTokenMaxAge")||Abe;let yF=null;const Ibe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Tbe)return;const s=r?.token;yF!==s&&(yF=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Pbe(t=CL()){const e=c_(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Xxe(t,{popupRedirectResolver:_be,persistence:[Rye,kye,aZ]}),n=jJ("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Ibe(a.toString());bye(r,o,()=>o(r.currentUser)),yye(r,l=>o(l))}}const s=vJ("auth");return s&&Jxe(r,`http://${s}`),r}function Lbe(){return document.getElementsByTagName("head")?.[0]??document}zxe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=sd("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",Lbe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ebe("Browser");var Obe="firebase",Mbe="12.8.0";rh(Obe,Mbe,"app");var bF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var BL;(function(){var t;function e(_,E){function M(){}M.prototype=E.prototype,_.F=E.prototype,_.prototype=new M,_.prototype.constructor=_,_.D=function(B,S,P){for(var R=Array(arguments.length-2),V=2;V<arguments.length;V++)R[V-2]=arguments[V];return E.prototype[S].apply(B,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,E,M){M||(M=0);const B=Array(16);if(typeof E=="string")for(var S=0;S<16;++S)B[S]=E.charCodeAt(M++)|E.charCodeAt(M++)<<8|E.charCodeAt(M++)<<16|E.charCodeAt(M++)<<24;else for(S=0;S<16;++S)B[S]=E[M++]|E[M++]<<8|E[M++]<<16|E[M++]<<24;E=_.g[0],M=_.g[1],S=_.g[2];let P=_.g[3],R;R=E+(P^M&(S^P))+B[0]+3614090360&4294967295,E=M+(R<<7&4294967295|R>>>25),R=P+(S^E&(M^S))+B[1]+3905402710&4294967295,P=E+(R<<12&4294967295|R>>>20),R=S+(M^P&(E^M))+B[2]+606105819&4294967295,S=P+(R<<17&4294967295|R>>>15),R=M+(E^S&(P^E))+B[3]+3250441966&4294967295,M=S+(R<<22&4294967295|R>>>10),R=E+(P^M&(S^P))+B[4]+4118548399&4294967295,E=M+(R<<7&4294967295|R>>>25),R=P+(S^E&(M^S))+B[5]+1200080426&4294967295,P=E+(R<<12&4294967295|R>>>20),R=S+(M^P&(E^M))+B[6]+2821735955&4294967295,S=P+(R<<17&4294967295|R>>>15),R=M+(E^S&(P^E))+B[7]+4249261313&4294967295,M=S+(R<<22&4294967295|R>>>10),R=E+(P^M&(S^P))+B[8]+1770035416&4294967295,E=M+(R<<7&4294967295|R>>>25),R=P+(S^E&(M^S))+B[9]+2336552879&4294967295,P=E+(R<<12&4294967295|R>>>20),R=S+(M^P&(E^M))+B[10]+4294925233&4294967295,S=P+(R<<17&4294967295|R>>>15),R=M+(E^S&(P^E))+B[11]+2304563134&4294967295,M=S+(R<<22&4294967295|R>>>10),R=E+(P^M&(S^P))+B[12]+1804603682&4294967295,E=M+(R<<7&4294967295|R>>>25),R=P+(S^E&(M^S))+B[13]+4254626195&4294967295,P=E+(R<<12&4294967295|R>>>20),R=S+(M^P&(E^M))+B[14]+2792965006&4294967295,S=P+(R<<17&4294967295|R>>>15),R=M+(E^S&(P^E))+B[15]+1236535329&4294967295,M=S+(R<<22&4294967295|R>>>10),R=E+(S^P&(M^S))+B[1]+4129170786&4294967295,E=M+(R<<5&4294967295|R>>>27),R=P+(M^S&(E^M))+B[6]+3225465664&4294967295,P=E+(R<<9&4294967295|R>>>23),R=S+(E^M&(P^E))+B[11]+643717713&4294967295,S=P+(R<<14&4294967295|R>>>18),R=M+(P^E&(S^P))+B[0]+3921069994&4294967295,M=S+(R<<20&4294967295|R>>>12),R=E+(S^P&(M^S))+B[5]+3593408605&4294967295,E=M+(R<<5&4294967295|R>>>27),R=P+(M^S&(E^M))+B[10]+38016083&4294967295,P=E+(R<<9&4294967295|R>>>23),R=S+(E^M&(P^E))+B[15]+3634488961&4294967295,S=P+(R<<14&4294967295|R>>>18),R=M+(P^E&(S^P))+B[4]+3889429448&4294967295,M=S+(R<<20&4294967295|R>>>12),R=E+(S^P&(M^S))+B[9]+568446438&4294967295,E=M+(R<<5&4294967295|R>>>27),R=P+(M^S&(E^M))+B[14]+3275163606&4294967295,P=E+(R<<9&4294967295|R>>>23),R=S+(E^M&(P^E))+B[3]+4107603335&4294967295,S=P+(R<<14&4294967295|R>>>18),R=M+(P^E&(S^P))+B[8]+1163531501&4294967295,M=S+(R<<20&4294967295|R>>>12),R=E+(S^P&(M^S))+B[13]+2850285829&4294967295,E=M+(R<<5&4294967295|R>>>27),R=P+(M^S&(E^M))+B[2]+4243563512&4294967295,P=E+(R<<9&4294967295|R>>>23),R=S+(E^M&(P^E))+B[7]+1735328473&4294967295,S=P+(R<<14&4294967295|R>>>18),R=M+(P^E&(S^P))+B[12]+2368359562&4294967295,M=S+(R<<20&4294967295|R>>>12),R=E+(M^S^P)+B[5]+4294588738&4294967295,E=M+(R<<4&4294967295|R>>>28),R=P+(E^M^S)+B[8]+2272392833&4294967295,P=E+(R<<11&4294967295|R>>>21),R=S+(P^E^M)+B[11]+1839030562&4294967295,S=P+(R<<16&4294967295|R>>>16),R=M+(S^P^E)+B[14]+4259657740&4294967295,M=S+(R<<23&4294967295|R>>>9),R=E+(M^S^P)+B[1]+2763975236&4294967295,E=M+(R<<4&4294967295|R>>>28),R=P+(E^M^S)+B[4]+1272893353&4294967295,P=E+(R<<11&4294967295|R>>>21),R=S+(P^E^M)+B[7]+4139469664&4294967295,S=P+(R<<16&4294967295|R>>>16),R=M+(S^P^E)+B[10]+3200236656&4294967295,M=S+(R<<23&4294967295|R>>>9),R=E+(M^S^P)+B[13]+681279174&4294967295,E=M+(R<<4&4294967295|R>>>28),R=P+(E^M^S)+B[0]+3936430074&4294967295,P=E+(R<<11&4294967295|R>>>21),R=S+(P^E^M)+B[3]+3572445317&4294967295,S=P+(R<<16&4294967295|R>>>16),R=M+(S^P^E)+B[6]+76029189&4294967295,M=S+(R<<23&4294967295|R>>>9),R=E+(M^S^P)+B[9]+3654602809&4294967295,E=M+(R<<4&4294967295|R>>>28),R=P+(E^M^S)+B[12]+3873151461&4294967295,P=E+(R<<11&4294967295|R>>>21),R=S+(P^E^M)+B[15]+530742520&4294967295,S=P+(R<<16&4294967295|R>>>16),R=M+(S^P^E)+B[2]+3299628645&4294967295,M=S+(R<<23&4294967295|R>>>9),R=E+(S^(M|~P))+B[0]+4096336452&4294967295,E=M+(R<<6&4294967295|R>>>26),R=P+(M^(E|~S))+B[7]+1126891415&4294967295,P=E+(R<<10&4294967295|R>>>22),R=S+(E^(P|~M))+B[14]+2878612391&4294967295,S=P+(R<<15&4294967295|R>>>17),R=M+(P^(S|~E))+B[5]+4237533241&4294967295,M=S+(R<<21&4294967295|R>>>11),R=E+(S^(M|~P))+B[12]+1700485571&4294967295,E=M+(R<<6&4294967295|R>>>26),R=P+(M^(E|~S))+B[3]+2399980690&4294967295,P=E+(R<<10&4294967295|R>>>22),R=S+(E^(P|~M))+B[10]+4293915773&4294967295,S=P+(R<<15&4294967295|R>>>17),R=M+(P^(S|~E))+B[1]+2240044497&4294967295,M=S+(R<<21&4294967295|R>>>11),R=E+(S^(M|~P))+B[8]+1873313359&4294967295,E=M+(R<<6&4294967295|R>>>26),R=P+(M^(E|~S))+B[15]+4264355552&4294967295,P=E+(R<<10&4294967295|R>>>22),R=S+(E^(P|~M))+B[6]+2734768916&4294967295,S=P+(R<<15&4294967295|R>>>17),R=M+(P^(S|~E))+B[13]+1309151649&4294967295,M=S+(R<<21&4294967295|R>>>11),R=E+(S^(M|~P))+B[4]+4149444226&4294967295,E=M+(R<<6&4294967295|R>>>26),R=P+(M^(E|~S))+B[11]+3174756917&4294967295,P=E+(R<<10&4294967295|R>>>22),R=S+(E^(P|~M))+B[2]+718787259&4294967295,S=P+(R<<15&4294967295|R>>>17),R=M+(P^(S|~E))+B[9]+3951481745&4294967295,_.g[0]=_.g[0]+E&4294967295,_.g[1]=_.g[1]+(S+(R<<21&4294967295|R>>>11))&4294967295,_.g[2]=_.g[2]+S&4294967295,_.g[3]=_.g[3]+P&4294967295}n.prototype.v=function(_,E){E===void 0&&(E=_.length);const M=E-this.blockSize,B=this.C;let S=this.h,P=0;for(;P<E;){if(S==0)for(;P<=M;)s(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<E;)if(B[S++]=_.charCodeAt(P++),S==this.blockSize){s(this,B),S=0;break}}else for(;P<E;)if(B[S++]=_[P++],S==this.blockSize){s(this,B),S=0;break}}this.h=S,this.o+=E},n.prototype.A=function(){var _=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);_[0]=128;for(var E=1;E<_.length-8;++E)_[E]=0;E=this.o*8;for(var M=_.length-8;M<_.length;++M)_[M]=E&255,E/=256;for(this.v(_),_=Array(16),E=0,M=0;M<4;++M)for(let B=0;B<32;B+=8)_[E++]=this.g[M]>>>B&255;return _};function a(_,E){var M=l;return Object.prototype.hasOwnProperty.call(M,_)?M[_]:M[_]=E(_)}function o(_,E){this.h=E;const M=[];let B=!0;for(let S=_.length-1;S>=0;S--){const P=_[S]|0;B&&P==E||(M[S]=P,B=!1)}this.g=M}var l={};function c(_){return-128<=_&&_<128?a(_,function(E){return new o([E|0],E<0?-1:0)}):new o([_|0],_<0?-1:0)}function u(_){if(isNaN(_)||!isFinite(_))return f;if(_<0)return w(u(-_));const E=[];let M=1;for(let B=0;_>=M;B++)E[B]=_/M|0,M*=4294967296;return new o(E,0)}function h(_,E){if(_.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(_.charAt(0)=="-")return w(h(_.substring(1),E));if(_.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=u(Math.pow(E,8));let B=f;for(let P=0;P<_.length;P+=8){var S=Math.min(8,_.length-P);const R=parseInt(_.substring(P,P+S),E);S<8?(S=u(Math.pow(E,S)),B=B.j(S).add(u(R))):(B=B.j(M),B=B.add(u(R)))}return B}var f=c(0),m=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(v(this))return-w(this).m();let _=0,E=1;for(let M=0;M<this.g.length;M++){const B=this.i(M);_+=(B>=0?B:4294967296+B)*E,E*=4294967296}return _},t.toString=function(_){if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(y(this))return"0";if(v(this))return"-"+w(this).toString(_);const E=u(Math.pow(_,6));var M=this;let B="";for(;;){const S=I(M,E).g;M=N(M,S.j(E));let P=((M.g.length>0?M.g[0]:M.h)>>>0).toString(_);if(M=S,y(M))return P+B;for(;P.length<6;)P="0"+P;B=P+B}},t.i=function(_){return _<0?0:_<this.g.length?this.g[_]:this.h};function y(_){if(_.h!=0)return!1;for(let E=0;E<_.g.length;E++)if(_.g[E]!=0)return!1;return!0}function v(_){return _.h==-1}t.l=function(_){return _=N(this,_),v(_)?-1:y(_)?0:1};function w(_){const E=_.g.length,M=[];for(let B=0;B<E;B++)M[B]=~_.g[B];return new o(M,~_.h).add(m)}t.abs=function(){return v(this)?w(this):this},t.add=function(_){const E=Math.max(this.g.length,_.g.length),M=[];let B=0;for(let S=0;S<=E;S++){let P=B+(this.i(S)&65535)+(_.i(S)&65535),R=(P>>>16)+(this.i(S)>>>16)+(_.i(S)>>>16);B=R>>>16,P&=65535,R&=65535,M[S]=R<<16|P}return new o(M,M[M.length-1]&-2147483648?-1:0)};function N(_,E){return _.add(w(E))}t.j=function(_){if(y(this)||y(_))return f;if(v(this))return v(_)?w(this).j(w(_)):w(w(this).j(_));if(v(_))return w(this.j(w(_)));if(this.l(g)<0&&_.l(g)<0)return u(this.m()*_.m());const E=this.g.length+_.g.length,M=[];for(var B=0;B<2*E;B++)M[B]=0;for(B=0;B<this.g.length;B++)for(let S=0;S<_.g.length;S++){const P=this.i(B)>>>16,R=this.i(B)&65535,V=_.i(S)>>>16,ee=_.i(S)&65535;M[2*B+2*S]+=R*ee,k(M,2*B+2*S),M[2*B+2*S+1]+=P*ee,k(M,2*B+2*S+1),M[2*B+2*S+1]+=R*V,k(M,2*B+2*S+1),M[2*B+2*S+2]+=P*V,k(M,2*B+2*S+2)}for(_=0;_<E;_++)M[_]=M[2*_+1]<<16|M[2*_];for(_=E;_<2*E;_++)M[_]=0;return new o(M,0)};function k(_,E){for(;(_[E]&65535)!=_[E];)_[E+1]+=_[E]>>>16,_[E]&=65535,E++}function C(_,E){this.g=_,this.h=E}function I(_,E){if(y(E))throw Error("division by zero");if(y(_))return new C(f,f);if(v(_))return E=I(w(_),E),new C(w(E.g),w(E.h));if(v(E))return E=I(_,w(E)),new C(w(E.g),E.h);if(_.g.length>30){if(v(_)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var M=m,B=E;B.l(_)<=0;)M=O(M),B=O(B);var S=L(M,1),P=L(B,1);for(B=L(B,2),M=L(M,2);!y(B);){var R=P.add(B);R.l(_)<=0&&(S=S.add(M),P=R),B=L(B,1),M=L(M,1)}return E=N(_,S.j(E)),new C(S,E)}for(S=f;_.l(E)>=0;){for(M=Math.max(1,Math.floor(_.m()/E.m())),B=Math.ceil(Math.log(M)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),P=u(M),R=P.j(E);v(R)||R.l(_)>0;)M-=B,P=u(M),R=P.j(E);y(P)&&(P=m),S=S.add(P),_=N(_,R)}return new C(S,_)}t.B=function(_){return I(this,_).h},t.and=function(_){const E=Math.max(this.g.length,_.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)&_.i(B);return new o(M,this.h&_.h)},t.or=function(_){const E=Math.max(this.g.length,_.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)|_.i(B);return new o(M,this.h|_.h)},t.xor=function(_){const E=Math.max(this.g.length,_.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)^_.i(B);return new o(M,this.h^_.h)};function O(_){const E=_.g.length+1,M=[];for(let B=0;B<E;B++)M[B]=_.i(B)<<1|_.i(B-1)>>>31;return new o(M,_.h)}function L(_,E){const M=E>>5;E%=32;const B=_.g.length-M,S=[];for(let P=0;P<B;P++)S[P]=E>0?_.i(P+M)>>>E|_.i(P+M+1)<<32-E:_.i(P+M);return new o(S,_.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,BL=o}).apply(typeof bF<"u"?bF:typeof self<"u"?self:typeof window<"u"?window:{});var z5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var pZ,Zv,mZ,uj,QT,gZ,xZ,yZ;(function(){var t,e=Object.defineProperty;function r(T){T=[typeof globalThis=="object"&&globalThis,T,typeof window=="object"&&window,typeof self=="object"&&self,typeof z5=="object"&&z5];for(var Y=0;Y<T.length;++Y){var ie=T[Y];if(ie&&ie.Math==Math)return ie}throw Error("Cannot find global object")}var n=r(this);function s(T,Y){if(Y)e:{var ie=n;T=T.split(".");for(var we=0;we<T.length-1;we++){var qe=T[we];if(!(qe in ie))break e;ie=ie[qe]}T=T[T.length-1],we=ie[T],Y=Y(we),Y!=we&&Y!=null&&e(ie,T,{configurable:!0,writable:!0,value:Y})}}s("Symbol.dispose",function(T){return T||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(T){return T||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(T){return T||function(Y){var ie=[],we;for(we in Y)Object.prototype.hasOwnProperty.call(Y,we)&&ie.push([we,Y[we]]);return ie}});var a=a||{},o=this||self;function l(T){var Y=typeof T;return Y=="object"&&T!=null||Y=="function"}function c(T,Y,ie){return T.call.apply(T.bind,arguments)}function u(T,Y,ie){return u=c,u.apply(null,arguments)}function h(T,Y){var ie=Array.prototype.slice.call(arguments,1);return function(){var we=ie.slice();return we.push.apply(we,arguments),T.apply(this,we)}}function f(T,Y){function ie(){}ie.prototype=Y.prototype,T.Z=Y.prototype,T.prototype=new ie,T.prototype.constructor=T,T.Ob=function(we,qe,tt){for(var Kt=Array(arguments.length-2),Yr=2;Yr<arguments.length;Yr++)Kt[Yr-2]=arguments[Yr];return Y.prototype[qe].apply(we,Kt)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?T=>T&&AsyncContext.Snapshot.wrap(T):T=>T;function g(T){const Y=T.length;if(Y>0){const ie=Array(Y);for(let we=0;we<Y;we++)ie[we]=T[we];return ie}return[]}function y(T,Y){for(let we=1;we<arguments.length;we++){const qe=arguments[we];var ie=typeof qe;if(ie=ie!="object"?ie:qe?Array.isArray(qe)?"array":ie:"null",ie=="array"||ie=="object"&&typeof qe.length=="number"){ie=T.length||0;const tt=qe.length||0;T.length=ie+tt;for(let Kt=0;Kt<tt;Kt++)T[ie+Kt]=qe[Kt]}else T.push(qe)}}class v{constructor(Y,ie){this.i=Y,this.j=ie,this.h=0,this.g=null}get(){let Y;return this.h>0?(this.h--,Y=this.g,this.g=Y.next,Y.next=null):Y=this.i(),Y}}function w(T){o.setTimeout(()=>{throw T},0)}function N(){var T=_;let Y=null;return T.g&&(Y=T.g,T.g=T.g.next,T.g||(T.h=null),Y.next=null),Y}class k{constructor(){this.h=this.g=null}add(Y,ie){const we=C.get();we.set(Y,ie),this.h?this.h.next=we:this.g=we,this.h=we}}var C=new v(()=>new I,T=>T.reset());class I{constructor(){this.next=this.g=this.h=null}set(Y,ie){this.h=Y,this.g=ie,this.next=null}reset(){this.next=this.g=this.h=null}}let O,L=!1,_=new k,E=()=>{const T=Promise.resolve(void 0);O=()=>{T.then(M)}};function M(){for(var T;T=N();){try{T.h.call(T.g)}catch(ie){w(ie)}var Y=C;Y.j(T),Y.h<100&&(Y.h++,T.next=Y.g,Y.g=T)}L=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(T,Y){this.type=T,this.g=this.target=Y,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var T=!1,Y=Object.defineProperty({},"passive",{get:function(){T=!0}});try{const ie=()=>{};o.addEventListener("test",ie,Y),o.removeEventListener("test",ie,Y)}catch{}return T})();function R(T){return/^[\s\xa0]*$/.test(T)}function V(T,Y){S.call(this,T?T.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,T&&this.init(T,Y)}f(V,S),V.prototype.init=function(T,Y){const ie=this.type=T.type,we=T.changedTouches&&T.changedTouches.length?T.changedTouches[0]:null;this.target=T.target||T.srcElement,this.g=Y,Y=T.relatedTarget,Y||(ie=="mouseover"?Y=T.fromElement:ie=="mouseout"&&(Y=T.toElement)),this.relatedTarget=Y,we?(this.clientX=we.clientX!==void 0?we.clientX:we.pageX,this.clientY=we.clientY!==void 0?we.clientY:we.pageY,this.screenX=we.screenX||0,this.screenY=we.screenY||0):(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0),this.button=T.button,this.key=T.key||"",this.ctrlKey=T.ctrlKey,this.altKey=T.altKey,this.shiftKey=T.shiftKey,this.metaKey=T.metaKey,this.pointerId=T.pointerId||0,this.pointerType=T.pointerType,this.state=T.state,this.i=T,T.defaultPrevented&&V.Z.h.call(this)},V.prototype.h=function(){V.Z.h.call(this);const T=this.i;T.preventDefault?T.preventDefault():T.returnValue=!1};var ee="closure_listenable_"+(Math.random()*1e6|0),G=0;function J(T,Y,ie,we,qe){this.listener=T,this.proxy=null,this.src=Y,this.type=ie,this.capture=!!we,this.ha=qe,this.key=++G,this.da=this.fa=!1}function Z(T){T.da=!0,T.listener=null,T.proxy=null,T.src=null,T.ha=null}function se(T,Y,ie){for(const we in T)Y.call(ie,T[we],we,T)}function X(T,Y){for(const ie in T)Y.call(void 0,T[ie],ie,T)}function q(T){const Y={};for(const ie in T)Y[ie]=T[ie];return Y}const U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(T,Y){let ie,we;for(let qe=1;qe<arguments.length;qe++){we=arguments[qe];for(ie in we)T[ie]=we[ie];for(let tt=0;tt<U.length;tt++)ie=U[tt],Object.prototype.hasOwnProperty.call(we,ie)&&(T[ie]=we[ie])}}function re(T){this.src=T,this.g={},this.h=0}re.prototype.add=function(T,Y,ie,we,qe){const tt=T.toString();T=this.g[tt],T||(T=this.g[tt]=[],this.h++);const Kt=xe(T,Y,we,qe);return Kt>-1?(Y=T[Kt],ie||(Y.fa=!1)):(Y=new J(Y,this.src,tt,!!we,qe),Y.fa=ie,T.push(Y)),Y};function ae(T,Y){const ie=Y.type;if(ie in T.g){var we=T.g[ie],qe=Array.prototype.indexOf.call(we,Y,void 0),tt;(tt=qe>=0)&&Array.prototype.splice.call(we,qe,1),tt&&(Z(Y),T.g[ie].length==0&&(delete T.g[ie],T.h--))}}function xe(T,Y,ie,we){for(let qe=0;qe<T.length;++qe){const tt=T[qe];if(!tt.da&&tt.listener==Y&&tt.capture==!!ie&&tt.ha==we)return qe}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),pe={};function K(T,Y,ie,we,qe){if(Array.isArray(Y)){for(let tt=0;tt<Y.length;tt++)K(T,Y[tt],ie,we,qe);return null}return ie=Ye(ie),T&&T[ee]?T.J(Y,ie,l(we)?!!we.capture:!1,qe):ue(T,Y,ie,!1,we,qe)}function ue(T,Y,ie,we,qe,tt){if(!Y)throw Error("Invalid event type");const Kt=l(qe)?!!qe.capture:!!qe;let Yr=Oe(T);if(Yr||(T[Ne]=Yr=new re(T)),ie=Yr.add(Y,ie,we,Kt,tt),ie.proxy)return ie;if(we=fe(),ie.proxy=we,we.src=T,we.listener=ie,T.addEventListener)P||(qe=Kt),qe===void 0&&(qe=!1),T.addEventListener(Y.toString(),we,qe);else if(T.attachEvent)T.attachEvent(_e(Y.toString()),we);else if(T.addListener&&T.removeListener)T.addListener(we);else throw Error("addEventListener and attachEvent are unavailable.");return ie}function fe(){function T(ie){return Y.call(T.src,T.listener,ie)}const Y=oe;return T}function he(T,Y,ie,we,qe){if(Array.isArray(Y))for(var tt=0;tt<Y.length;tt++)he(T,Y[tt],ie,we,qe);else we=l(we)?!!we.capture:!!we,ie=Ye(ie),T&&T[ee]?(T=T.i,tt=String(Y).toString(),tt in T.g&&(Y=T.g[tt],ie=xe(Y,ie,we,qe),ie>-1&&(Z(Y[ie]),Array.prototype.splice.call(Y,ie,1),Y.length==0&&(delete T.g[tt],T.h--)))):T&&(T=Oe(T))&&(Y=T.g[Y.toString()],T=-1,Y&&(T=xe(Y,ie,we,qe)),(ie=T>-1?Y[T]:null)&&le(ie))}function le(T){if(typeof T!="number"&&T&&!T.da){var Y=T.src;if(Y&&Y[ee])ae(Y.i,T);else{var ie=T.type,we=T.proxy;Y.removeEventListener?Y.removeEventListener(ie,we,T.capture):Y.detachEvent?Y.detachEvent(_e(ie),we):Y.addListener&&Y.removeListener&&Y.removeListener(we),(ie=Oe(Y))?(ae(ie,T),ie.h==0&&(ie.src=null,Y[Ne]=null)):Z(T)}}}function _e(T){return T in pe?pe[T]:pe[T]="on"+T}function oe(T,Y){if(T.da)T=!0;else{Y=new V(Y,this);const ie=T.listener,we=T.ha||T.src;T.fa&&le(T),T=ie.call(we,Y)}return T}function Oe(T){return T=T[Ne],T instanceof re?T:null}var ze="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ye(T){return typeof T=="function"?T:(T[ze]||(T[ze]=function(Y){return T.handleEvent(Y)}),T[ze])}function je(){B.call(this),this.i=new re(this),this.M=this,this.G=null}f(je,B),je.prototype[ee]=!0,je.prototype.removeEventListener=function(T,Y,ie,we){he(this,T,Y,ie,we)};function Fe(T,Y){var ie,we=T.G;if(we)for(ie=[];we;we=we.G)ie.push(we);if(T=T.M,we=Y.type||Y,typeof Y=="string")Y=new S(Y,T);else if(Y instanceof S)Y.target=Y.target||T;else{var qe=Y;Y=new S(we,T),H(Y,qe)}qe=!0;let tt,Kt;if(ie)for(Kt=ie.length-1;Kt>=0;Kt--)tt=Y.g=ie[Kt],qe=Nt(tt,we,!0,Y)&&qe;if(tt=Y.g=T,qe=Nt(tt,we,!0,Y)&&qe,qe=Nt(tt,we,!1,Y)&&qe,ie)for(Kt=0;Kt<ie.length;Kt++)tt=Y.g=ie[Kt],qe=Nt(tt,we,!1,Y)&&qe}je.prototype.N=function(){if(je.Z.N.call(this),this.i){var T=this.i;for(const Y in T.g){const ie=T.g[Y];for(let we=0;we<ie.length;we++)Z(ie[we]);delete T.g[Y],T.h--}}this.G=null},je.prototype.J=function(T,Y,ie,we){return this.i.add(String(T),Y,!1,ie,we)},je.prototype.K=function(T,Y,ie,we){return this.i.add(String(T),Y,!0,ie,we)};function Nt(T,Y,ie,we){if(Y=T.i.g[String(Y)],!Y)return!0;Y=Y.concat();let qe=!0;for(let tt=0;tt<Y.length;++tt){const Kt=Y[tt];if(Kt&&!Kt.da&&Kt.capture==ie){const Yr=Kt.listener,Es=Kt.ha||Kt.src;Kt.fa&&ae(T.i,Kt),qe=Yr.call(Es,we)!==!1&&qe}}return qe&&!we.defaultPrevented}function $t(T,Y){if(typeof T!="function")if(T&&typeof T.handleEvent=="function")T=u(T.handleEvent,T);else throw Error("Invalid listener argument");return Number(Y)>2147483647?-1:o.setTimeout(T,Y||0)}function Ut(T){T.g=$t(()=>{T.g=null,T.i&&(T.i=!1,Ut(T))},T.l);const Y=T.h;T.h=null,T.m.apply(null,Y)}class nt extends B{constructor(Y,ie){super(),this.m=Y,this.l=ie,this.h=null,this.i=!1,this.g=null}j(Y){this.h=arguments,this.g?this.i=!0:Ut(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bt(T){B.call(this),this.h=T,this.g={}}f(bt,B);var It=[];function _t(T){se(T.g,function(Y,ie){this.g.hasOwnProperty(ie)&&le(Y)},T),T.g={}}bt.prototype.N=function(){bt.Z.N.call(this),_t(this)},bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wt=o.JSON.stringify,ut=o.JSON.parse,Rt=class{stringify(T){return o.JSON.stringify(T,void 0)}parse(T){return o.JSON.parse(T,void 0)}};function Dt(){}function at(){}var ft={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Bt(){S.call(this,"d")}f(Bt,S);function De(){S.call(this,"c")}f(De,S);var lt={},ht=null;function Pt(){return ht=ht||new je}lt.Ia="serverreachability";function At(T){S.call(this,lt.Ia,T)}f(At,S);function mt(T){const Y=Pt();Fe(Y,new At(Y))}lt.STAT_EVENT="statevent";function Ft(T,Y){S.call(this,lt.STAT_EVENT,T),this.stat=Y}f(Ft,S);function gt(T){const Y=Pt();Fe(Y,new Ft(Y,T))}lt.Ja="timingevent";function Ot(T,Y){S.call(this,lt.Ja,T),this.size=Y}f(Ot,S);function Ct(T,Y){if(typeof T!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){T()},Y)}function Xt(){this.g=!0}Xt.prototype.ua=function(){this.g=!1};function Qt(T,Y,ie,we,qe,tt){T.info(function(){if(T.g)if(tt){var Kt="",Yr=tt.split("&");for(let bn=0;bn<Yr.length;bn++){var Es=Yr[bn].split("=");if(Es.length>1){const Zn=Es[0];Es=Es[1];const pa=Zn.split("_");Kt=pa.length>=2&&pa[1]=="type"?Kt+(Zn+"="+Es+"&"):Kt+(Zn+"=redacted&")}}}else Kt=null;else Kt=tt;return"XMLHTTP REQ ("+we+") [attempt "+qe+"]: "+Y+`
`+ie+`
`+Kt})}function nr(T,Y,ie,we,qe,tt,Kt){T.info(function(){return"XMLHTTP RESP ("+we+") [ attempt "+qe+"]: "+Y+`
`+ie+`
`+tt+" "+Kt})}function sr(T,Y,ie,we){T.info(function(){return"XMLHTTP TEXT ("+Y+"): "+kr(T,ie)+(we?" "+we:"")})}function Jt(T,Y){T.info(function(){return"TIMEOUT: "+Y})}Xt.prototype.info=function(){};function kr(T,Y){if(!T.g)return Y;if(!Y)return null;try{const tt=JSON.parse(Y);if(tt){for(T=0;T<tt.length;T++)if(Array.isArray(tt[T])){var ie=tt[T];if(!(ie.length<2)){var we=ie[1];if(Array.isArray(we)&&!(we.length<1)){var qe=we[0];if(qe!="noop"&&qe!="stop"&&qe!="close")for(let Kt=1;Kt<we.length;Kt++)we[Kt]=""}}}}return wt(tt)}catch{return Y}}var Ae={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ke={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function jt(){}f(jt,Dt),jt.prototype.g=function(){return new XMLHttpRequest},Gt=new jt;function zt(T){return encodeURIComponent(String(T))}function Mt(T){var Y=1;T=T.split(":");const ie=[];for(;Y>0&&T.length;)ie.push(T.shift()),Y--;return T.length&&ie.push(T.join(":")),ie}function Ht(T,Y,ie,we){this.j=T,this.i=Y,this.l=ie,this.S=we||1,this.V=new bt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new vr}function vr(){this.i=null,this.g="",this.h=!1}var Fr={},ln={};function hn(T,Y,ie){T.M=1,T.A=No(ks(Y)),T.u=ie,T.R=!0,cn(T,null)}function cn(T,Y){T.F=Date.now(),ps(T),T.B=ks(T.A);var ie=T.B,we=T.S;Array.isArray(we)||(we=[String(we)]),Bl(ie.i,"t",we),T.C=0,ie=T.j.L,T.h=new vr,T.g=ur(T.j,ie?Y:null,!T.u),T.P>0&&(T.O=new nt(u(T.Y,T,T.g),T.P)),Y=T.V,ie=T.g,we=T.ba;var qe="readystatechange";Array.isArray(qe)||(qe&&(It[0]=qe.toString()),qe=It);for(let tt=0;tt<qe.length;tt++){const Kt=K(ie,qe[tt],we||Y.handleEvent,!1,Y.h||Y);if(!Kt)break;Y.g[Kt.key]=Kt}Y=T.J?q(T.J):{},T.u?(T.v||(T.v="POST"),Y["Content-Type"]="application/x-www-form-urlencoded",T.g.ea(T.B,T.v,T.u,Y)):(T.v="GET",T.g.ea(T.B,T.v,null,Y)),mt(),Qt(T.i,T.v,T.B,T.l,T.S,T.u)}Ht.prototype.ba=function(T){T=T.target;const Y=this.O;Y&&Te(T)==3?Y.j():this.Y(T)},Ht.prototype.Y=function(T){try{if(T==this.g)e:{const Yr=Te(this.g),Es=this.g.ya(),bn=this.g.ca();if(!(Yr<3)&&(Yr!=3||this.g&&(this.h.h||this.g.la()||it(this.g)))){this.K||Yr!=4||Es==7||(Es==8||bn<=0?mt(3):mt(2)),Xe(this);var Y=this.g.ca();this.X=Y;var ie=Ks(this);if(this.o=Y==200,nr(this.i,this.v,this.B,this.l,this.S,Yr,Y),this.o){if(this.U&&!this.L){t:{if(this.g){var we,qe=this.g;if((we=qe.g?qe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(we)){var tt=we;break t}}tt=null}if(T=tt)sr(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lr(this,T);else{this.o=!1,this.m=3,gt(12),tr(this),ct(this);break e}}if(this.R){T=!0;let Zn;for(;!this.K&&this.C<ie.length;)if(Zn=Ds(this,ie),Zn==ln){Yr==4&&(this.m=4,gt(14),T=!1),sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Zn==Fr){this.m=4,gt(15),sr(this.i,this.l,ie,"[Invalid Chunk]"),T=!1;break}else sr(this.i,this.l,Zn,null),Lr(this,Zn);if(Ci(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yr!=4||ie.length!=0||this.h.h||(this.m=1,gt(16),T=!1),this.o=this.o&&T,!T)sr(this.i,this.l,ie,"[Invalid Chunked Response]"),tr(this),ct(this);else if(ie.length>0&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.aa&&!Kt.P&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+ie.length),ro(Kt),Kt.P=!0,gt(11))}}else sr(this.i,this.l,ie,null),Lr(this,ie);Yr==4&&tr(this),this.o&&!this.K&&(Yr==4?Se(this.j,this):(this.o=!1,ps(this)))}else Tr(this.g),Y==400&&ie.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),tr(this),ct(this)}}}catch{}};function Ks(T){if(!Ci(T))return T.g.la();const Y=it(T.g);if(Y==="")return"";let ie="";const we=Y.length,qe=Te(T.g)==4;if(!T.h.i){if(typeof TextDecoder>"u")return tr(T),ct(T),"";T.h.i=new o.TextDecoder}for(let tt=0;tt<we;tt++)T.h.h=!0,ie+=T.h.i.decode(Y[tt],{stream:!(qe&&tt==we-1)});return Y.length=0,T.h.g+=ie,T.C=0,T.h.g}function Ci(T){return T.g?T.v=="GET"&&T.M!=2&&T.j.Aa:!1}function Ds(T,Y){var ie=T.C,we=Y.indexOf(`
`,ie);return we==-1?ln:(ie=Number(Y.substring(ie,we)),isNaN(ie)?Fr:(we+=1,we+ie>Y.length?ln:(Y=Y.slice(we,we+ie),T.C=we+ie,Y)))}Ht.prototype.cancel=function(){this.K=!0,tr(this)};function ps(T){T.T=Date.now()+T.H,$e(T,T.H)}function $e(T,Y){if(T.D!=null)throw Error("WatchDog timer not null");T.D=Ct(u(T.aa,T),Y)}function Xe(T){T.D&&(o.clearTimeout(T.D),T.D=null)}Ht.prototype.aa=function(){this.D=null;const T=Date.now();T-this.T>=0?(Jt(this.i,this.B),this.M!=2&&(mt(),gt(17)),tr(this),this.m=2,ct(this)):$e(this,this.T-T)};function ct(T){T.j.I==0||T.K||Se(T.j,T)}function tr(T){Xe(T);var Y=T.O;Y&&typeof Y.dispose=="function"&&Y.dispose(),T.O=null,_t(T.V),T.g&&(Y=T.g,T.g=null,Y.abort(),Y.dispose())}function Lr(T,Y){try{var ie=T.j;if(ie.I!=0&&(ie.g==T||Bi(ie.h,T))){if(!T.L&&Bi(ie.h,T)&&ie.I==3){try{var we=ie.Ba.g.parse(Y)}catch{we=null}if(Array.isArray(we)&&we.length==3){var qe=we;if(qe[0]==0){e:if(!ie.v){if(ie.g)if(ie.g.F+3e3<T.F)ce(ie),On(ie);else break e;ti(ie),gt(18)}}else ie.xa=qe[1],0<ie.xa-ie.K&&qe[2]<37500&&ie.F&&ie.A==0&&!ie.C&&(ie.C=Ct(u(ie.Va,ie),6e3));sa(ie.h)<=1&&ie.ta&&(ie.ta=void 0)}else Ue(ie,11)}else if((T.L||ie.g==T)&&ce(ie),!R(Y))for(qe=ie.Ba.g.parse(Y),Y=0;Y<qe.length;Y++){let bn=qe[Y];const Zn=bn[0];if(!(Zn<=ie.K))if(ie.K=Zn,bn=bn[1],ie.I==2)if(bn[0]=="c"){ie.M=bn[1],ie.ba=bn[2];const pa=bn[3];pa!=null&&(ie.ka=pa,ie.j.info("VER="+ie.ka));const Ia=bn[4];Ia!=null&&(ie.za=Ia,ie.j.info("SVER="+ie.za));const gs=bn[5];gs!=null&&typeof gs=="number"&&gs>0&&(we=1.5*gs,ie.O=we,ie.j.info("backChannelRequestTimeoutMs_="+we)),we=ie;const Pa=T.g;if(Pa){const fl=Pa.g?Pa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fl){var tt=we.h;tt.g||fl.indexOf("spdy")==-1&&fl.indexOf("quic")==-1&&fl.indexOf("h2")==-1||(tt.j=tt.l,tt.g=new Set,tt.h&&(Fi(tt,tt.h),tt.h=null))}if(we.G){const Uc=Pa.g?Pa.g.getResponseHeader("X-HTTP-Session-Id"):null;Uc&&(we.wa=Uc,pn(we.J,we.G,Uc))}}ie.I=3,ie.l&&ie.l.ra(),ie.aa&&(ie.T=Date.now()-T.F,ie.j.info("Handshake RTT: "+ie.T+"ms")),we=ie;var Kt=T;if(we.na=Lt(we,we.L?we.ba:null,we.W),Kt.L){Ko(we.h,Kt);var Yr=Kt,Es=we.O;Es&&(Yr.H=Es),Yr.D&&(Xe(Yr),ps(Yr)),we.g=Kt}else to(we);ie.i.length>0&&Yn(ie)}else bn[0]!="stop"&&bn[0]!="close"||Ue(ie,7);else ie.I==3&&(bn[0]=="stop"||bn[0]=="close"?bn[0]=="stop"?Ue(ie,7):en(ie):bn[0]!="noop"&&ie.l&&ie.l.qa(bn),ie.A=0)}}mt(4)}catch{}}var tn=class{constructor(T,Y){this.g=T,this.map=Y}};function Ea(T){this.l=T||10,o.PerformanceNavigationTiming?(T=o.performance.getEntriesByType("navigation"),T=T.length>0&&(T[0].nextHopProtocol=="hq"||T[0].nextHopProtocol=="h2")):T=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=T?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Bs(T){return T.h?!0:T.g?T.g.size>=T.j:!1}function sa(T){return T.h?1:T.g?T.g.size:0}function Bi(T,Y){return T.h?T.h==Y:T.g?T.g.has(Y):!1}function Fi(T,Y){T.g?T.g.add(Y):T.h=Y}function Ko(T,Y){T.h&&T.h==Y?T.h=null:T.g&&T.g.has(Y)&&T.g.delete(Y)}Ea.prototype.cancel=function(){if(this.i=Rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const T of this.g.values())T.cancel();this.g.clear()}};function Rl(T){if(T.h!=null)return T.i.concat(T.h.G);if(T.g!=null&&T.g.size!==0){let Y=T.i;for(const ie of T.g.values())Y=Y.concat(ie.G);return Y}return g(T.i)}var pc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ia(T,Y){if(T){T=T.split("&");for(let ie=0;ie<T.length;ie++){const we=T[ie].indexOf("=");let qe,tt=null;we>=0?(qe=T[ie].substring(0,we),tt=T[ie].substring(we+1)):qe=T[ie],Y(qe,tt?decodeURIComponent(tt.replace(/\+/g," ")):"")}}}function pi(T){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let Y;T instanceof pi?(this.l=T.l,Zr(this,T.j),this.o=T.o,this.g=T.g,Aa(this,T.u),this.h=T.h,mi(this,Fl(T.i)),this.m=T.m):T&&(Y=String(T).match(pc))?(this.l=!1,Zr(this,Y[1]||"",!0),this.o=Fs(Y[2]||""),this.g=Fs(Y[3]||"",!0),Aa(this,Y[4]),this.h=Fs(Y[5]||"",!0),mi(this,Y[6]||"",!0),this.m=Fs(Y[7]||"")):(this.l=!1,this.i=new ei(null,this.l))}pi.prototype.toString=function(){const T=[];var Y=this.j;Y&&T.push(ss(Y,hl,!0),":");var ie=this.g;return(ie||Y=="file")&&(T.push("//"),(Y=this.o)&&T.push(ss(Y,hl,!0),"@"),T.push(zt(ie).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ie=this.u,ie!=null&&T.push(":",String(ie))),(ie=this.h)&&(this.g&&ie.charAt(0)!="/"&&T.push("/"),T.push(ss(ie,ie.charAt(0)=="/"?mc:Dl,!0))),(ie=this.i.toString())&&T.push("?",ie),(ie=this.m)&&T.push("#",ss(ie,jo)),T.join("")},pi.prototype.resolve=function(T){const Y=ks(this);let ie=!!T.j;ie?Zr(Y,T.j):ie=!!T.o,ie?Y.o=T.o:ie=!!T.g,ie?Y.g=T.g:ie=T.u!=null;var we=T.h;if(ie)Aa(Y,T.u);else if(ie=!!T.h){if(we.charAt(0)!="/")if(this.g&&!this.h)we="/"+we;else{var qe=Y.h.lastIndexOf("/");qe!=-1&&(we=Y.h.slice(0,qe+1)+we)}if(qe=we,qe==".."||qe==".")we="";else if(qe.indexOf("./")!=-1||qe.indexOf("/.")!=-1){we=qe.lastIndexOf("/",0)==0,qe=qe.split("/");const tt=[];for(let Kt=0;Kt<qe.length;){const Yr=qe[Kt++];Yr=="."?we&&Kt==qe.length&&tt.push(""):Yr==".."?((tt.length>1||tt.length==1&&tt[0]!="")&&tt.pop(),we&&Kt==qe.length&&tt.push("")):(tt.push(Yr),we=!0)}we=tt.join("/")}else we=qe}return ie?Y.h=we:ie=T.i.toString()!=="",ie?mi(Y,Fl(T.i)):ie=!!T.m,ie&&(Y.m=T.m),Y};function ks(T){return new pi(T)}function Zr(T,Y,ie){T.j=ie?Fs(Y,!0):Y,T.j&&(T.j=T.j.replace(/:$/,""))}function Aa(T,Y){if(Y){if(Y=Number(Y),isNaN(Y)||Y<0)throw Error("Bad port number "+Y);T.u=Y}else T.u=null}function mi(T,Y,ie){Y instanceof ei?(T.i=Y,Ui(T.i,T.l)):(ie||(Y=ss(Y,Ei)),T.i=new ei(Y,T.l))}function pn(T,Y,ie){T.i.set(Y,ie)}function No(T){return pn(T,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),T}function Fs(T,Y){return T?Y?decodeURI(T.replace(/%25/g,"%2525")):decodeURIComponent(T):""}function ss(T,Y,ie){return typeof T=="string"?(T=encodeURI(T).replace(Y,_s),ie&&(T=T.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T):null}function _s(T){return T=T.charCodeAt(0),"%"+(T>>4&15).toString(16)+(T&15).toString(16)}var hl=/[#\/\?@]/g,Dl=/[#\?:]/g,mc=/[#\?]/g,Ei=/[#\?@]/g,jo=/#/g;function ei(T,Y){this.h=this.g=null,this.i=T||null,this.j=!!Y}function is(T){T.g||(T.g=new Map,T.h=0,T.i&&ia(T.i,function(Y,ie){T.add(decodeURIComponent(Y.replace(/\+/g," ")),ie)}))}t=ei.prototype,t.add=function(T,Y){is(this),this.i=null,T=ko(this,T);let ie=this.g.get(T);return ie||this.g.set(T,ie=[]),ie.push(Y),this.h+=1,this};function $i(T,Y){is(T),Y=ko(T,Y),T.g.has(Y)&&(T.i=null,T.h-=T.g.get(Y).length,T.g.delete(Y))}function gc(T,Y){return is(T),Y=ko(T,Y),T.g.has(Y)}t.forEach=function(T,Y){is(this),this.g.forEach(function(ie,we){ie.forEach(function(qe){T.call(Y,qe,we,this)},this)},this)};function ha(T,Y){is(T);let ie=[];if(typeof Y=="string")gc(T,Y)&&(ie=ie.concat(T.g.get(ko(T,Y))));else for(T=Array.from(T.g.values()),Y=0;Y<T.length;Y++)ie=ie.concat(T[Y]);return ie}t.set=function(T,Y){return is(this),this.i=null,T=ko(this,T),gc(this,T)&&(this.h-=this.g.get(T).length),this.g.set(T,[Y]),this.h+=1,this},t.get=function(T,Y){return T?(T=ha(this,T),T.length>0?String(T[0]):Y):Y};function Bl(T,Y,ie){$i(T,Y),ie.length>0&&(T.i=null,T.g.set(ko(T,Y),g(ie)),T.h+=ie.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const T=[],Y=Array.from(this.g.keys());for(let we=0;we<Y.length;we++){var ie=Y[we];const qe=zt(ie);ie=ha(this,ie);for(let tt=0;tt<ie.length;tt++){let Kt=qe;ie[tt]!==""&&(Kt+="="+zt(ie[tt])),T.push(Kt)}}return this.i=T.join("&")};function Fl(T){const Y=new ei;return Y.i=T.i,T.g&&(Y.g=new Map(T.g),Y.h=T.h),Y}function ko(T,Y){return Y=String(Y),T.j&&(Y=Y.toLowerCase()),Y}function Ui(T,Y){Y&&!T.j&&(is(T),T.i=null,T.g.forEach(function(ie,we){const qe=we.toLowerCase();we!=qe&&($i(this,we),Bl(this,qe,ie))},T)),T.j=Y}function fa(T,Y){const ie=new Xt;if(o.Image){const we=new Image;we.onload=h(Ai,ie,"TestLoadImage: loaded",!0,Y,we),we.onerror=h(Ai,ie,"TestLoadImage: error",!1,Y,we),we.onabort=h(Ai,ie,"TestLoadImage: abort",!1,Y,we),we.ontimeout=h(Ai,ie,"TestLoadImage: timeout",!1,Y,we),o.setTimeout(function(){we.ontimeout&&we.ontimeout()},1e4),we.src=T}else Y(!1)}function ms(T,Y){const ie=new Xt,we=new AbortController,qe=setTimeout(()=>{we.abort(),Ai(ie,"TestPingServer: timeout",!1,Y)},1e4);fetch(T,{signal:we.signal}).then(tt=>{clearTimeout(qe),tt.ok?Ai(ie,"TestPingServer: ok",!0,Y):Ai(ie,"TestPingServer: server error",!1,Y)}).catch(()=>{clearTimeout(qe),Ai(ie,"TestPingServer: error",!1,Y)})}function Ai(T,Y,ie,we,qe){try{qe&&(qe.onload=null,qe.onerror=null,qe.onabort=null,qe.ontimeout=null),we(ie)}catch{}}function _o(){this.g=new Rt}function yr(T){this.i=T.Sb||null,this.h=T.ab||!1}f(yr,Dt),yr.prototype.g=function(){return new So(this.i,this.h)};function So(T,Y){je.call(this),this.H=T,this.o=Y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(So,je),t=So.prototype,t.open=function(T,Y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=T,this.D=Y,this.readyState=1,Ys(this)},t.send=function(T){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const Y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};T&&(Y.body=T),(this.H||o).fetch(new Request(this.D,Y)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yo(this)),this.readyState=0},t.Pa=function(T){if(this.g&&(this.l=T,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=T.headers,this.readyState=2,Ys(this)),this.g&&(this.readyState=3,Ys(this),this.g)))if(this.responseType==="arraybuffer")T.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in T){if(this.j=T.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Co(this)}else T.text().then(this.Oa.bind(this),this.ga.bind(this))};function Co(T){T.j.read().then(T.Ma.bind(T)).catch(T.ga.bind(T))}t.Ma=function(T){if(this.g){if(this.o&&T.value)this.response.push(T.value);else if(!this.o){var Y=T.value?T.value:new Uint8Array(0);(Y=this.B.decode(Y,{stream:!T.done}))&&(this.response=this.responseText+=Y)}T.done?Yo(this):Ys(this),this.readyState==3&&Co(this)}},t.Oa=function(T){this.g&&(this.response=this.responseText=T,Yo(this))},t.Na=function(T){this.g&&(this.response=T,Yo(this))},t.ga=function(){this.g&&Yo(this)};function Yo(T){T.readyState=4,T.l=null,T.j=null,T.B=null,Ys(T)}t.setRequestHeader=function(T,Y){this.A.append(T,Y)},t.getResponseHeader=function(T){return this.h&&this.h.get(T.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const T=[],Y=this.h.entries();for(var ie=Y.next();!ie.done;)ie=ie.value,T.push(ie[0]+": "+ie[1]),ie=Y.next();return T.join(`\r
`)};function Ys(T){T.onreadystatechange&&T.onreadystatechange.call(T)}Object.defineProperty(So.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(T){this.m=T?"include":"same-origin"}});function Ss(T){let Y="";return se(T,function(ie,we){Y+=we,Y+=":",Y+=ie,Y+=`\r
`}),Y}function Xo(T,Y,ie){e:{for(we in ie){var we=!1;break e}we=!0}we||(ie=Ss(ie),typeof T=="string"?ie!=null&&zt(ie):pn(T,Y,ie))}function un(T){je.call(this),this.headers=new Map,this.L=T||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(un,je);var zi=/^https?$/i,Eo=["POST","PUT"];t=un.prototype,t.Fa=function(T){this.H=T},t.ea=function(T,Y,ie,we){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+T);Y=Y?Y.toUpperCase():"GET",this.D=T,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(Y,String(T),!0),this.B=!1}catch(tt){Ta(this,tt);return}if(T=ie||"",ie=new Map(this.headers),we)if(Object.getPrototypeOf(we)===Object.prototype)for(var qe in we)ie.set(qe,we[qe]);else if(typeof we.keys=="function"&&typeof we.get=="function")for(const tt of we.keys())ie.set(tt,we.get(tt));else throw Error("Unknown input type for opt_headers: "+String(we));we=Array.from(ie.keys()).find(tt=>tt.toLowerCase()=="content-type"),qe=o.FormData&&T instanceof o.FormData,!(Array.prototype.indexOf.call(Eo,Y,void 0)>=0)||we||qe||ie.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[tt,Kt]of ie)this.g.setRequestHeader(tt,Kt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(T),this.v=!1}catch(tt){Ta(this,tt)}};function Ta(T,Y){T.h=!1,T.g&&(T.j=!0,T.g.abort(),T.j=!1),T.l=Y,T.o=5,xc(T),be(T)}function xc(T){T.A||(T.A=!0,Fe(T,"complete"),Fe(T,"error"))}t.abort=function(T){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=T||7,Fe(this,"complete"),Fe(this,"abort"),be(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),be(this,!0)),un.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Q(this):this.Xa())},t.Xa=function(){Q(this)};function Q(T){if(T.h&&typeof a<"u"){if(T.v&&Te(T)==4)setTimeout(T.Ca.bind(T),0);else if(Fe(T,"readystatechange"),Te(T)==4){T.h=!1;try{const tt=T.ca();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Y=!0;break e;default:Y=!1}var ie;if(!(ie=Y)){var we;if(we=tt===0){let Kt=String(T.D).match(pc)[1]||null;!Kt&&o.self&&o.self.location&&(Kt=o.self.location.protocol.slice(0,-1)),we=!zi.test(Kt?Kt.toLowerCase():"")}ie=we}if(ie)Fe(T,"complete"),Fe(T,"success");else{T.o=6;try{var qe=Te(T)>2?T.g.statusText:""}catch{qe=""}T.l=qe+" ["+T.ca()+"]",xc(T)}}finally{be(T)}}}}function be(T,Y){if(T.g){T.m&&(clearTimeout(T.m),T.m=null);const ie=T.g;T.g=null,Y||Fe(T,"ready");try{ie.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Te(T){return T.g?T.g.readyState:0}t.ca=function(){try{return Te(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(T){if(this.g){var Y=this.g.responseText;return T&&Y.indexOf(T)==0&&(Y=Y.substring(T.length)),ut(Y)}};function it(T){try{if(!T.g)return null;if("response"in T.g)return T.g.response;switch(T.F){case"":case"text":return T.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in T.g)return T.g.mozResponseArrayBuffer}return null}catch{return null}}function Tr(T){const Y={};T=(T.g&&Te(T)>=2&&T.g.getAllResponseHeaders()||"").split(`\r
`);for(let we=0;we<T.length;we++){if(R(T[we]))continue;var ie=Mt(T[we]);const qe=ie[0];if(ie=ie[1],typeof ie!="string")continue;ie=ie.trim();const tt=Y[qe]||[];Y[qe]=tt,tt.push(ie)}X(Y,function(we){return we.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function rr(T,Y,ie){return ie&&ie.internalChannelParams&&ie.internalChannelParams[T]||Y}function Xr(T){this.za=0,this.i=[],this.j=new Xt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=rr("failFast",!1,T),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=rr("baseRetryDelayMs",5e3,T),this.Za=rr("retryDelaySeedMs",1e4,T),this.Ta=rr("forwardChannelMaxRetries",2,T),this.va=rr("forwardChannelRequestTimeoutMs",2e4,T),this.ma=T&&T.xmlHttpFactory||void 0,this.Ua=T&&T.Rb||void 0,this.Aa=T&&T.useFetchStreams||!1,this.O=void 0,this.L=T&&T.supportsCrossDomainXhr||!1,this.M="",this.h=new Ea(T&&T.concurrentRequestLimit),this.Ba=new _o,this.S=T&&T.fastHandshake||!1,this.R=T&&T.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=T&&T.Pb||!1,T&&T.ua&&this.j.ua(),T&&T.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&T&&T.detectBufferingProxy||!1,this.ia=void 0,T&&T.longPollingTimeout&&T.longPollingTimeout>0&&(this.ia=T.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Xr.prototype,t.ka=8,t.I=1,t.connect=function(T,Y,ie,we){gt(0),this.W=T,this.H=Y||{},ie&&we!==void 0&&(this.H.OSID=ie,this.H.OAID=we),this.F=this.X,this.J=Lt(this,null,this.W),Yn(this)};function en(T){if(rn(T),T.I==3){var Y=T.V++,ie=ks(T.J);if(pn(ie,"SID",T.M),pn(ie,"RID",Y),pn(ie,"TYPE","terminate"),zn(T,ie),Y=new Ht(T,T.j,Y),Y.M=2,Y.A=No(ks(ie)),ie=!1,o.navigator&&o.navigator.sendBeacon)try{ie=o.navigator.sendBeacon(Y.A.toString(),"")}catch{}!ie&&o.Image&&(new Image().src=Y.A,ie=!0),ie||(Y.g=ur(Y.j,null),Y.g.ea(Y.A)),Y.F=Date.now(),ps(Y)}xt(T)}function On(T){T.g&&(ro(T),T.g.cancel(),T.g=null)}function rn(T){On(T),T.v&&(o.clearTimeout(T.v),T.v=null),ce(T),T.h.cancel(),T.m&&(typeof T.m=="number"&&o.clearTimeout(T.m),T.m=null)}function Yn(T){if(!Bs(T.h)&&!T.m){T.m=!0;var Y=T.Ea;O||E(),L||(O(),L=!0),_.add(Y,T),T.D=0}}function Xs(T,Y){return sa(T.h)>=T.h.j-(T.m?1:0)?!1:T.m?(T.i=Y.G.concat(T.i),!0):T.I==1||T.I==2||T.D>=(T.Sa?0:T.Ta)?!1:(T.m=Ct(u(T.Ea,T,Y),Le(T,T.D)),T.D++,!0)}t.Ea=function(T){if(this.m)if(this.m=null,this.I==1){if(!T){this.V=Math.floor(Math.random()*1e5),T=this.V++;const qe=new Ht(this,this.j,T);let tt=this.o;if(this.U&&(tt?(tt=q(tt),H(tt,this.U)):tt=this.U),this.u!==null||this.R||(qe.J=tt,tt=null),this.S)e:{for(var Y=0,ie=0;ie<this.i.length;ie++){t:{var we=this.i[ie];if("__data__"in we.map&&(we=we.map.__data__,typeof we=="string")){we=we.length;break t}we=void 0}if(we===void 0)break;if(Y+=we,Y>4096){Y=ie;break e}if(Y===4096||ie===this.i.length-1){Y=ie+1;break e}}Y=1e3}else Y=1e3;Y=Jn(this,qe,Y),ie=ks(this.J),pn(ie,"RID",T),pn(ie,"CVER",22),this.G&&pn(ie,"X-HTTP-Session-Id",this.G),zn(this,ie),tt&&(this.R?Y="headers="+zt(Ss(tt))+"&"+Y:this.u&&Xo(ie,this.u,tt)),Fi(this.h,qe),this.Ra&&pn(ie,"TYPE","init"),this.S?(pn(ie,"$req",Y),pn(ie,"SID","null"),qe.U=!0,hn(qe,ie,null)):hn(qe,ie,Y),this.I=2}}else this.I==3&&(T?us(this,T):this.i.length==0||Bs(this.h)||us(this))};function us(T,Y){var ie;Y?ie=Y.l:ie=T.V++;const we=ks(T.J);pn(we,"SID",T.M),pn(we,"RID",ie),pn(we,"AID",T.K),zn(T,we),T.u&&T.o&&Xo(we,T.u,T.o),ie=new Ht(T,T.j,ie,T.D+1),T.u===null&&(ie.J=T.o),Y&&(T.i=Y.G.concat(T.i)),Y=Jn(T,ie,1e3),ie.H=Math.round(T.va*.5)+Math.round(T.va*.5*Math.random()),Fi(T.h,ie),hn(ie,we,Y)}function zn(T,Y){T.H&&se(T.H,function(ie,we){pn(Y,we,ie)}),T.l&&se({},function(ie,we){pn(Y,we,ie)})}function Jn(T,Y,ie){ie=Math.min(T.i.length,ie);const we=T.l?u(T.l.Ka,T.l,T):null;e:{var qe=T.i;let Yr=-1;for(;;){const Es=["count="+ie];Yr==-1?ie>0?(Yr=qe[0].g,Es.push("ofs="+Yr)):Yr=0:Es.push("ofs="+Yr);let bn=!0;for(let Zn=0;Zn<ie;Zn++){var tt=qe[Zn].g;const pa=qe[Zn].map;if(tt-=Yr,tt<0)Yr=Math.max(0,qe[Zn].g-100),bn=!1;else try{tt="req"+tt+"_"||"";try{var Kt=pa instanceof Map?pa:Object.entries(pa);for(const[Ia,gs]of Kt){let Pa=gs;l(gs)&&(Pa=wt(gs)),Es.push(tt+Ia+"="+encodeURIComponent(Pa))}}catch(Ia){throw Es.push(tt+"type="+encodeURIComponent("_badmap")),Ia}}catch{we&&we(pa)}}if(bn){Kt=Es.join("&");break e}}Kt=void 0}return T=T.i.splice(0,ie),Y.G=T,Kt}function to(T){if(!T.g&&!T.v){T.Y=1;var Y=T.Da;O||E(),L||(O(),L=!0),_.add(Y,T),T.A=0}}function ti(T){return T.g||T.v||T.A>=3?!1:(T.Y++,T.v=Ct(u(T.Da,T),Le(T,T.A)),T.A++,!0)}t.Da=function(){if(this.v=null,z(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var T=4*this.T;this.j.info("BP detection timer enabled: "+T),this.B=Ct(u(this.Wa,this),T)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),On(this),z(this))};function ro(T){T.B!=null&&(o.clearTimeout(T.B),T.B=null)}function z(T){T.g=new Ht(T,T.j,"rpc",T.Y),T.u===null&&(T.g.J=T.o),T.g.P=0;var Y=ks(T.na);pn(Y,"RID","rpc"),pn(Y,"SID",T.M),pn(Y,"AID",T.K),pn(Y,"CI",T.F?"0":"1"),!T.F&&T.ia&&pn(Y,"TO",T.ia),pn(Y,"TYPE","xmlhttp"),zn(T,Y),T.u&&T.o&&Xo(Y,T.u,T.o),T.O&&(T.g.H=T.O);var ie=T.g;T=T.ba,ie.M=1,ie.A=No(ks(Y)),ie.u=null,ie.R=!0,cn(ie,T)}t.Va=function(){this.C!=null&&(this.C=null,On(this),ti(this),gt(19))};function ce(T){T.C!=null&&(o.clearTimeout(T.C),T.C=null)}function Se(T,Y){var ie=null;if(T.g==Y){ce(T),ro(T),T.g=null;var we=2}else if(Bi(T.h,Y))ie=Y.G,Ko(T.h,Y),we=1;else return;if(T.I!=0){if(Y.o)if(we==1){ie=Y.u?Y.u.length:0,Y=Date.now()-Y.F;var qe=T.D;we=Pt(),Fe(we,new Ot(we,ie)),Yn(T)}else to(T);else if(qe=Y.m,qe==3||qe==0&&Y.X>0||!(we==1&&Xs(T,Y)||we==2&&ti(T)))switch(ie&&ie.length>0&&(Y=T.h,Y.i=Y.i.concat(ie)),qe){case 1:Ue(T,5);break;case 4:Ue(T,10);break;case 3:Ue(T,6);break;default:Ue(T,2)}}}function Le(T,Y){let ie=T.Qa+Math.floor(Math.random()*T.Za);return T.isActive()||(ie*=2),ie*Y}function Ue(T,Y){if(T.j.info("Error code "+Y),Y==2){var ie=u(T.bb,T),we=T.Ua;const qe=!we;we=new pi(we||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Zr(we,"https"),No(we),qe?fa(we.toString(),ie):ms(we.toString(),ie)}else gt(2);T.I=0,T.l&&T.l.pa(Y),xt(T),rn(T)}t.bb=function(T){T?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function xt(T){if(T.I=0,T.ja=[],T.l){const Y=Rl(T.h);(Y.length!=0||T.i.length!=0)&&(y(T.ja,Y),y(T.ja,T.i),T.h.i.length=0,g(T.i),T.i.length=0),T.l.oa()}}function Lt(T,Y,ie){var we=ie instanceof pi?ks(ie):new pi(ie);if(we.g!="")Y&&(we.g=Y+"."+we.g),Aa(we,we.u);else{var qe=o.location;we=qe.protocol,Y=Y?Y+"."+qe.hostname:qe.hostname,qe=+qe.port;const tt=new pi(null);we&&Zr(tt,we),Y&&(tt.g=Y),qe&&Aa(tt,qe),ie&&(tt.h=ie),we=tt}return ie=T.G,Y=T.wa,ie&&Y&&pn(we,ie,Y),pn(we,"VER",T.ka),zn(T,we),we}function ur(T,Y,ie){if(Y&&!T.L)throw Error("Can't create secondary domain capable XhrIo object.");return Y=T.Aa&&!T.ma?new un(new yr({ab:ie})):new un(T.ma),Y.Fa(T.L),Y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function pr(){}t=pr.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Rr(){}Rr.prototype.g=function(T,Y){return new Ir(T,Y)};function Ir(T,Y){je.call(this),this.g=new Xr(Y),this.l=T,this.h=Y&&Y.messageUrlParams||null,T=Y&&Y.messageHeaders||null,Y&&Y.clientProtocolHeaderRequired&&(T?T["X-Client-Protocol"]="webchannel":T={"X-Client-Protocol":"webchannel"}),this.g.o=T,T=Y&&Y.initMessageHeaders||null,Y&&Y.messageContentType&&(T?T["X-WebChannel-Content-Type"]=Y.messageContentType:T={"X-WebChannel-Content-Type":Y.messageContentType}),Y&&Y.sa&&(T?T["X-WebChannel-Client-Profile"]=Y.sa:T={"X-WebChannel-Client-Profile":Y.sa}),this.g.U=T,(T=Y&&Y.Qb)&&!R(T)&&(this.g.u=T),this.A=Y&&Y.supportsCrossDomainXhr||!1,this.v=Y&&Y.sendRawJson||!1,(Y=Y&&Y.httpSessionIdParam)&&!R(Y)&&(this.g.G=Y,T=this.h,T!==null&&Y in T&&(T=this.h,Y in T&&delete T[Y])),this.j=new ds(this)}f(Ir,je),Ir.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ir.prototype.close=function(){en(this.g)},Ir.prototype.o=function(T){var Y=this.g;if(typeof T=="string"){var ie={};ie.__data__=T,T=ie}else this.v&&(ie={},ie.__data__=wt(T),T=ie);Y.i.push(new tn(Y.Ya++,T)),Y.I==3&&Yn(Y)},Ir.prototype.N=function(){this.g.l=null,delete this.j,en(this.g),delete this.g,Ir.Z.N.call(this)};function Nn(T){Bt.call(this),T.__headers__&&(this.headers=T.__headers__,this.statusCode=T.__status__,delete T.__headers__,delete T.__status__);var Y=T.__sm__;if(Y){e:{for(const ie in Y){T=ie;break e}T=void 0}(this.i=T)&&(T=this.i,Y=Y!==null&&T in Y?Y[T]:void 0),this.data=Y}else this.data=T}f(Nn,Bt);function Cs(){De.call(this),this.status=1}f(Cs,De);function ds(T){this.g=T}f(ds,pr),ds.prototype.ra=function(){Fe(this.g,"a")},ds.prototype.qa=function(T){Fe(this.g,new Nn(T))},ds.prototype.pa=function(T){Fe(this.g,new Cs)},ds.prototype.oa=function(){Fe(this.g,"b")},Rr.prototype.createWebChannel=Rr.prototype.g,Ir.prototype.send=Ir.prototype.o,Ir.prototype.open=Ir.prototype.m,Ir.prototype.close=Ir.prototype.close,yZ=function(){return new Rr},xZ=function(){return Pt()},gZ=lt,QT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,uj=Ae,Ke.COMPLETE="complete",mZ=Ke,at.EventType=ft,ft.OPEN="a",ft.CLOSE="b",ft.ERROR="c",ft.MESSAGE="d",je.prototype.listen=je.prototype.J,Zv=at,un.prototype.listenOnce=un.prototype.K,un.prototype.getLastError=un.prototype.Ha,un.prototype.getLastErrorCode=un.prototype.ya,un.prototype.getStatus=un.prototype.ca,un.prototype.getResponseJson=un.prototype.La,un.prototype.getResponseText=un.prototype.la,un.prototype.send=un.prototype.ea,un.prototype.setWithCredentials=un.prototype.Fa,pZ=un}).apply(typeof z5<"u"?z5:typeof self<"u"?self:typeof window<"u"?window:{});let $o=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};$o.UNAUTHENTICATED=new $o(null),$o.GOOGLE_CREDENTIALS=new $o("google-credentials-uid"),$o.FIRST_PARTY=new $o("first-party-uid"),$o.MOCK_USER=new $o("mock-user");let cb="12.8.0";function Rbe(t){cb=t}const zm=new _L("@firebase/firestore");function Mx(){return zm.logLevel}function er(t,...e){if(zm.logLevel<=Ln.DEBUG){const r=e.map(FL);zm.debug(`Firestore (${cb}): ${t}`,...r)}}function Ec(t,...e){if(zm.logLevel<=Ln.ERROR){const r=e.map(FL);zm.error(`Firestore (${cb}): ${t}`,...r)}}function f_(t,...e){if(zm.logLevel<=Ln.WARN){const r=e.map(FL);zm.warn(`Firestore (${cb}): ${t}`,...r)}}function FL(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function $r(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,bZ(t,n,r)}function bZ(t,e,r){let n=`FIRESTORE (${cb}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ec(n),new Error(n)}function Kr(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||bZ(e,s,n)}function hi(t,e){return t}const Vt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Sr extends bh{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Sm{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class vZ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Dbe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r($o.UNAUTHENTICATED)))}shutdown(){}}class Bbe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class Fbe{constructor(e){this.t=e,this.currentUser=$o.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kr(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Sm;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Sm,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const c=a;e.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},l=c=>{er("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(er("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Sm)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(er("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kr(typeof n.accessToken=="string",31837,{l:n}),new vZ(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kr(e===null||typeof e=="string",2055,{h:e}),new $o(e)}}class $be{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=$o.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Ube{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new $be(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r($o.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zbe{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,sc(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kr(this.o===void 0,3512);const n=a=>{a.error!=null&&er("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,er("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const s=a=>{er("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):er("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vF(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Kr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new vF(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Vbe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class wZ{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=Vbe(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%62))}return n}}function kn(t,e){return t<e?-1:t>e?1:0}function JT(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),a=e.charAt(n);if(s!==a)return YC(s)===YC(a)?kn(s,a):YC(s)?1:-1}return kn(t.length,e.length)}const qbe=55296,Hbe=57343;function YC(t){const e=t.charCodeAt(0);return e>=qbe&&e<=Hbe}function Sy(t,e,r){return t.length===e.length&&t.every(((n,s)=>r(n,e[s])))}function NZ(t){return t+"\0"}const wF="__name__";class Hd{constructor(e,r,n){r===void 0?r=0:r>e.length&&$r(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&$r(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Hd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Hd?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=Hd.compareSegments(e.get(s),r.get(s));if(a!==0)return a}return kn(e.length,r.length)}static compareSegments(e,r){const n=Hd.isNumericId(e),s=Hd.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?Hd.extractNumericId(e).compare(Hd.extractNumericId(r)):JT(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return BL.fromString(e.substring(4,e.length-2))}}class ki extends Hd{construct(e,r,n){return new ki(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Sr(Vt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((s=>s.length>0)))}return new ki(r)}static emptyPath(){return new ki([])}}const Wbe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class da extends Hd{construct(e,r,n){return new da(e,r,n)}static isValidIdentifier(e){return Wbe.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),da.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===wF}static keyField(){return new da([wF])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Sr(Vt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Sr(Vt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Sr(Vt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(a(),s++)}if(a(),o)throw new Sr(Vt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new da(r)}static emptyPath(){return new da([])}}class jr{constructor(e){this.path=e}static fromPath(e){return new jr(ki.fromString(e))}static fromName(e){return new jr(ki.fromString(e).popFirst(5))}static empty(){return new jr(ki.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ki.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ki.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jr(new ki(e.slice()))}}function Gbe(t,e,r,n){if(e===!0&&n===!0)throw new Sr(Vt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Kbe(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ybe(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":$r(12329,{type:typeof t})}function jZ(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Sr(Vt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ybe(t);throw new Sr(Vt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function ja(t,e){const r={typeString:t};return e&&(r.value=e),r}function tw(t,e){if(!Kbe(t))throw new Sr(Vt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(s&&typeof o!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&o!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Sr(Vt.INVALID_ARGUMENT,r);return!0}const NF=-62135596800,jF=1e6;class Mi{static now(){return Mi.fromMillis(Date.now())}static fromDate(e){return Mi.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*jF);return new Mi(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Sr(Vt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Sr(Vt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<NF)throw new Sr(Vt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Sr(Vt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jF}_compareTo(e){return this.seconds===e.seconds?kn(this.nanoseconds,e.nanoseconds):kn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Mi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tw(e,Mi._jsonSchema))return new Mi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NF;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Mi._jsonSchemaVersion="firestore/timestamp/1.0",Mi._jsonSchema={type:ja("string",Mi._jsonSchemaVersion),seconds:ja("number"),nanoseconds:ja("number")};class Gn{static fromTimestamp(e){return new Gn(e)}static min(){return new Gn(new Mi(0,0))}static max(){return new Gn(new Mi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const G1=-1;class u4{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function ZT(t){return t.fields.find((e=>e.kind===2))}function Zp(t){return t.fields.filter((e=>e.kind!==2))}u4.UNKNOWN_ID=-1;class dj{constructor(e,r){this.fieldPath=e,this.kind=r}}class K1{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new K1(0,Rc.min())}}function Xbe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Gn.fromTimestamp(n===1e9?new Mi(r+1,0):new Mi(r,n));return new Rc(s,jr.empty(),e)}function kZ(t){return new Rc(t.readTime,t.key,G1)}class Rc{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Rc(Gn.min(),jr.empty(),G1)}static max(){return new Rc(Gn.max(),jr.empty(),G1)}}function $L(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=jr.comparator(t.documentKey,e.documentKey),r!==0?r:kn(t.largestBatchId,e.largestBatchId))}const _Z="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class SZ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function p_(t){if(t.code!==Vt.FAILED_PRECONDITION||t.message!==_Z)throw t;er("LocalStore","Unexpectedly lost primary lease")}class rt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&$r(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new rt(((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof rt?r:rt.resolve(r)}catch(r){return rt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):rt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):rt.reject(r)}static resolve(e){return new rt(((r,n)=>{r(e)}))}static reject(e){return new rt(((r,n)=>{n(e)}))}static waitFor(e){return new rt(((r,n)=>{let s=0,a=0,o=!1;e.forEach((l=>{++s,l.next((()=>{++a,o&&a===s&&r()}),(c=>n(c)))})),o=!0,a===s&&r()}))}static or(e){let r=rt.resolve(!1);for(const n of e)r=r.next((s=>s?rt.resolve(s):n()));return r}static forEach(e,r){const n=[];return e.forEach(((s,a)=>{n.push(r.call(this,s,a))})),this.waitFor(n)}static mapArray(e,r){return new rt(((n,s)=>{const a=e.length,o=new Array(a);let l=0;for(let c=0;c<a;c++){const u=c;r(e[u]).next((h=>{o[u]=h,++l,l===a&&n(o)}),(h=>s(h)))}}))}static doWhile(e,r){return new rt(((n,s)=>{const a=()=>{e()===!0?r().next((()=>{a()}),s):n()};a()}))}}const Cc="SimpleDb";class m_{static open(e,r,n,s){try{return new m_(r,e.transaction(s,n))}catch(a){throw new g1(r,a)}}constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.S=new Sm,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{r.error?this.S.reject(new g1(e,r.error)):this.S.resolve()},this.transaction.onerror=n=>{const s=UL(n.target.error);this.S.reject(new g1(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(er(Cc,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Jbe(r)}}class Z0{static delete(e){return er(Cc,"Removing database:",e),lm(bJ().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!EJ())return!1;if(Z0.F())return!0;const e=Ya(),r=Z0.M(e),n=0<r&&r<10,s=CZ(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,r){return e.store(r)}static M(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,r,n){this.name=e,this.version=r,this.N=n,this.B=null,Z0.M(Ya())===12.2&&Ec("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(er(Cc,"Opening database:",this.name),this.db=await new Promise(((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const o=a.target.result;r(o)},s.onblocked=()=>{n(new g1(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const o=a.target.error;o.name==="VersionError"?n(new Sr(Vt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Sr(Vt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new g1(e,o))},s.onupgradeneeded=a=>{er(Cc,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,s.transaction,a.oldVersion,this.version).next((()=>{er(Cc,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=r=>this.K(r)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const a=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=m_.open(this.db,e,a?"readonly":"readwrite",n),c=s(l).next((u=>(l.C(),u))).catch((u=>(l.abort(u),rt.reject(u)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(er(Cc,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function CZ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Qbe{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return lm(this.U.delete())}}class g1 extends Sr{constructor(e,r){super(Vt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function xg(t){return t.name==="IndexedDbTransactionError"}class Jbe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(er(Cc,"PUT",this.store.name,e,r),n=this.store.put(r,e)):(er(Cc,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),lm(n)}add(e){return er(Cc,"ADD",this.store.name,e,e),lm(this.store.add(e))}get(e){return lm(this.store.get(e)).next((r=>(r===void 0&&(r=null),er(Cc,"GET",this.store.name,e,r),r)))}delete(e){return er(Cc,"DELETE",this.store.name,e),lm(this.store.delete(e))}count(){return er(Cc,"COUNT",this.store.name),lm(this.store.count())}H(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(n.range);return new rt(((o,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{o(c.target.result)}}))}{const a=this.cursor(n),o=[];return this.J(a,((l,c)=>{o.push(c)})).next((()=>o))}}Z(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new rt(((s,a)=>{n.onerror=o=>{a(o.target.error)},n.onsuccess=o=>{s(o.target.result)}}))}X(e,r){er(Cc,"DELETE ALL",this.store.name);const n=this.options(e,r);n.Y=!1;const s=this.cursor(n);return this.J(s,((a,o,l)=>l.delete()))}ee(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.J(s,r)}te(e){const r=this.cursor({});return new rt(((n,s)=>{r.onerror=a=>{const o=UL(a.target.error);s(o)},r.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():n()})):n()}}))}J(e,r){const n=[];return new rt(((s,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Qbe(l),u=r(l.primaryKey,l.value,c);if(u instanceof rt){const h=u.catch((f=>(c.done(),rt.reject(f))));n.push(h)}c.isDone?s():c.G===null?l.continue():l.continue(c.G)}})).next((()=>rt.waitFor(n)))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function lm(t){return new rt(((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=UL(n.target.error);r(s)}}))}let kF=!1;function UL(t){const e=Z0.M(Ya());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Sr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kF||(kF=!0,setTimeout((()=>{throw n}),0)),n}}return t}const x1="IndexBackfiller";class Zbe{constructor(e,r){this.asyncQueue=e,this.ne=r,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){er(x1,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const r=await this.ne.ie();er(x1,`Documents written: ${r}`)}catch(r){xg(r)?er(x1,"Ignoring IndexedDB error during index backfill: ",r):await p_(r)}await this.re(6e4)}))}}class eve{constructor(e,r){this.localStore=e,this.persistence=r}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(r=>this.se(r,e)))}se(e,r){const n=new Set;let s=r,a=!0;return rt.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!n.has(o))return er(x1,`Processing collection: ${o}`),this.oe(e,o,s).next((l=>{s-=l,n.add(o)}));a=!1})))).next((()=>r-s))}oe(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next((s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(s,a))).next((l=>(er(x1,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l)))).next((()=>o.size))}))))}_e(e,r){let n=e;return r.changes.forEach(((s,a)=>{const o=kZ(a);$L(o,n)>0&&(n=o)})),new Rc(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}class td{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}td.ce=-1;const Cm=-1;function g_(t){return t==null}function d4(t){return t===0&&1/t==-1/0}const h4="";function Cl(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=_F(e)),e=tve(t.get(r),e);return _F(e)}function tve(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case h4:r+="";break;default:r+=a}}return r}function _F(t){return t+h4+""}function Gd(t){const e=t.length;if(Kr(e>=2,64408,{path:t}),e===2)return Kr(t.charAt(0)===h4&&t.charAt(1)==="",56145,{path:t}),ki.emptyPath();const r=e-2,n=[];let s="";for(let a=0;a<e;){const o=t.indexOf(h4,a);switch((o<0||o>r)&&$r(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(a,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(a,o),s+="\0";break;case"":s+=t.substring(a,o+1);break;default:$r(61167,{path:t})}a=o+2}return new ki(n)}const em="remoteDocuments",rw="owner",mx="owner",Y1="mutationQueues",rve="userId",Wu="mutations",SF="batchId",gm="userMutationsIndex",CF=["userId","batchId"];function hj(t,e){return[t,Cl(e)]}function EZ(t,e,r){return[t,Cl(e),r]}const nve={},Cy="documentMutations",f4="remoteDocumentsV14",sve=["prefixPath","collectionGroup","readTime","documentId"],fj="documentKeyIndex",ive=["prefixPath","collectionGroup","documentId"],AZ="collectionGroupIndex",ave=["collectionGroup","readTime","prefixPath","documentId"],X1="remoteDocumentGlobal",eI="remoteDocumentGlobalKey",Ey="targets",TZ="queryTargetsIndex",ove=["canonicalId","targetId"],Ay="targetDocuments",lve=["targetId","path"],zL="documentTargetsIndex",cve=["path","targetId"],p4="targetGlobalKey",Em="targetGlobal",Q1="collectionParents",uve=["collectionId","parent"],Ty="clientMetadata",dve="clientId",x_="bundles",hve="bundleId",y_="namedQueries",fve="name",VL="indexConfiguration",pve="indexId",tI="collectionGroupIndex",mve="collectionGroup",y1="indexState",gve=["indexId","uid"],IZ="sequenceNumberIndex",xve=["uid","sequenceNumber"],b1="indexEntries",yve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],PZ="documentKeyIndex",bve=["indexId","uid","orderedDocumentKey"],b_="documentOverlays",vve=["userId","collectionPath","documentId"],rI="collectionPathOverlayIndex",wve=["userId","collectionPath","largestBatchId"],LZ="collectionGroupOverlayIndex",Nve=["userId","collectionGroup","largestBatchId"],qL="globals",jve="name",OZ=[Y1,Wu,Cy,em,Ey,rw,Em,Ay,Ty,X1,Q1,x_,y_],kve=[...OZ,b_],MZ=[Y1,Wu,Cy,f4,Ey,rw,Em,Ay,Ty,X1,Q1,x_,y_,b_],RZ=MZ,HL=[...RZ,VL,y1,b1],_ve=HL,DZ=[...HL,qL],Sve=DZ;class nI extends SZ{constructor(e,r){super(),this.le=e,this.currentSequenceNumber=r}}function Xa(t,e){const r=hi(t);return Z0.O(r.le,e)}function EF(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function WL(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Cve(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class oc{constructor(e,r){this.comparator=e,this.root=r||Uo.EMPTY}insert(e,r){return new oc(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Uo.BLACK,null,null))}remove(e){return new oc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Uo.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new V5(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new V5(this.root,e,this.comparator,!1)}getReverseIterator(){return new V5(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new V5(this.root,e,this.comparator,!0)}}class V5{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Uo{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??Uo.RED,this.left=s??Uo.EMPTY,this.right=a??Uo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new Uo(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Uo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Uo.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Uo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Uo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $r(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $r(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $r(27949);return e+(this.isRed()?0:1)}}Uo.EMPTY=null,Uo.RED=!0,Uo.BLACK=!1;Uo.EMPTY=new class{constructor(){this.size=0}get key(){throw $r(57766)}get value(){throw $r(16141)}get color(){throw $r(16727)}get left(){throw $r(29726)}get right(){throw $r(36894)}copy(e,r,n,s,a){return this}insert(e,r,n){return new Uo(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gs{constructor(e){this.comparator=e,this.data=new oc(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new AF(this.data.getIterator())}getIteratorFrom(e){return new AF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Gs)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Gs(this.comparator);return r.data=e,r}}class AF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function gx(t){return t.hasNext()?t.getNext():void 0}class af{constructor(e){this.fields=e,e.sort(da.comparator)}static empty(){return new af([])}unionWith(e){let r=new Gs(da.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new af(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Sy(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class Eve extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lc{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Eve("Invalid base64 string: "+a):a}})(e);return new lc(r)}static fromUint8Array(e){const r=(function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a})(e);return new lc(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return kn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lc.EMPTY_BYTE_STRING=new lc("");const Ave=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function up(t){if(Kr(!!t,39018),typeof t=="string"){let e=0;const r=Ave.exec(t);if(Kr(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:va(t.seconds),nanos:va(t.nanos)}}function va(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Iy(t){return typeof t=="string"?lc.fromBase64String(t):lc.fromUint8Array(t)}const BZ="server_timestamp",FZ="__type__",$Z="__previous_value__",UZ="__local_write_time__";function GL(t){return(t?.mapValue?.fields||{})[FZ]?.stringValue===BZ}function zZ(t){const e=t.mapValue.fields[$Z];return GL(e)?zZ(e):e}function m4(t){const e=up(t.mapValue.fields[UZ].timestampValue);return new Mi(e.seconds,e.nanos)}class Tve{constructor(e,r,n,s,a,o,l,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h,this.apiKey=f}}const g4="(default)";class Py{constructor(e,r){this.projectId=e,this.database=r||g4}static empty(){return new Py("","")}get isDefaultDatabase(){return this.database===g4}isEqual(e){return e instanceof Py&&e.projectId===this.projectId&&e.database===this.database}}function Ive(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Sr(Vt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Py(t.options.projectId,e)}const VZ="__type__",qZ="__max__",H0={mapValue:{fields:{__type__:{stringValue:qZ}}}},HZ="__vector__",x4="value",pj={nullValue:"NULL_VALUE"};function Ly(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?GL(t)?4:WZ(t)?9007199254740991:v_(t)?10:11:$r(28295,{value:t})}function ch(t,e){if(t===e)return!0;const r=Ly(t);if(r!==Ly(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return m4(t).isEqual(m4(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=up(s.timestampValue),l=up(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,a){return Iy(s.bytesValue).isEqual(Iy(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,a){return va(s.geoPointValue.latitude)===va(a.geoPointValue.latitude)&&va(s.geoPointValue.longitude)===va(a.geoPointValue.longitude)})(t,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return va(s.integerValue)===va(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=va(s.doubleValue),l=va(a.doubleValue);return o===l?d4(o)===d4(l):isNaN(o)&&isNaN(l)}return!1})(t,e);case 9:return Sy(t.arrayValue.values||[],e.arrayValue.values||[],ch);case 10:case 11:return(function(s,a){const o=s.mapValue.fields||{},l=a.mapValue.fields||{};if(EF(o)!==EF(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ch(o[c],l[c])))return!1;return!0})(t,e);default:return $r(52216,{left:t})}}function J1(t,e){return(t.values||[]).find((r=>ch(r,e)))!==void 0}function dp(t,e){if(t===e)return 0;const r=Ly(t),n=Ly(e);if(r!==n)return kn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return kn(t.booleanValue,e.booleanValue);case 2:return(function(a,o){const l=va(a.integerValue||a.doubleValue),c=va(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(t,e);case 3:return TF(t.timestampValue,e.timestampValue);case 4:return TF(m4(t),m4(e));case 5:return JT(t.stringValue,e.stringValue);case 6:return(function(a,o){const l=Iy(a),c=Iy(o);return l.compareTo(c)})(t.bytesValue,e.bytesValue);case 7:return(function(a,o){const l=a.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=kn(l[u],c[u]);if(h!==0)return h}return kn(l.length,c.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,o){const l=kn(va(a.latitude),va(o.latitude));return l!==0?l:kn(va(a.longitude),va(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return IF(t.arrayValue,e.arrayValue);case 10:return(function(a,o){const l=a.fields||{},c=o.fields||{},u=l[x4]?.arrayValue,h=c[x4]?.arrayValue,f=kn(u?.values?.length||0,h?.values?.length||0);return f!==0?f:IF(u,h)})(t.mapValue,e.mapValue);case 11:return(function(a,o){if(a===H0.mapValue&&o===H0.mapValue)return 0;if(a===H0.mapValue)return 1;if(o===H0.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=JT(c[f],h[f]);if(m!==0)return m;const g=dp(l[c[f]],u[h[f]]);if(g!==0)return g}return kn(c.length,h.length)})(t.mapValue,e.mapValue);default:throw $r(23264,{he:r})}}function TF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return kn(t,e);const r=up(t),n=up(e),s=kn(r.seconds,n.seconds);return s!==0?s:kn(r.nanos,n.nanos)}function IF(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=dp(r[s],n[s]);if(a)return a}return kn(r.length,n.length)}function Oy(t){return sI(t)}function sI(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=up(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Iy(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return jr.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=sI(a);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${sI(r.fields[o])}`;return s+"}"})(t.mapValue):$r(61005,{value:t})}function KL(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function iI(t){return!!t&&"integerValue"in t}function Z1(t){return!!t&&"arrayValue"in t}function PF(t){return!!t&&"nullValue"in t}function LF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function XC(t){return!!t&&"mapValue"in t}function v_(t){return(t?.mapValue?.fields||{})[VZ]?.stringValue===HZ}function v1(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return WL(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=v1(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=v1(t.arrayValue.values[r]);return e}return{...t}}function WZ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===qZ}const GZ={mapValue:{fields:{[VZ]:{stringValue:HZ},[x4]:{arrayValue:{}}}}};function Pve(t){return"nullValue"in t?pj:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?KL(Py.empty(),jr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?v_(t)?GZ:{mapValue:{}}:$r(35942,{value:t})}function Lve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?KL(Py.empty(),jr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?GZ:"mapValue"in t?v_(t)?{mapValue:{}}:H0:$r(61959,{value:t})}function OF(t,e){const r=dp(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function MF(t,e){const r=dp(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Yu{constructor(e){this.value=e}static empty(){return new Yu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!XC(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=v1(r)}setAll(e){let r=da.emptyPath(),n={},s=[];e.forEach(((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=v1(o):s.push(l.lastSegment())}));const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());XC(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ch(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];XC(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){WL(r,((s,a)=>e[s]=a));for(const s of n)delete e[s]}clone(){return new Yu(v1(this.value))}}class zo{constructor(e,r,n,s,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new zo(e,0,Gn.min(),Gn.min(),Gn.min(),Yu.empty(),0)}static newFoundDocument(e,r,n,s){return new zo(e,1,r,Gn.min(),n,s,0)}static newNoDocument(e,r){return new zo(e,2,r,Gn.min(),Gn.min(),Yu.empty(),0)}static newUnknownDocument(e,r){return new zo(e,3,r,Gn.min(),Gn.min(),Yu.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Gn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class My{constructor(e,r){this.position=e,this.inclusive=r}}function RF(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?n=jr.comparator(jr.fromName(o.referenceValue),r.key):n=dp(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function DF(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ch(t.position[r],e.position[r]))return!1;return!0}class y4{constructor(e,r="asc"){this.field=e,this.dir=r}}function Ove(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class KZ{}class Un extends KZ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Mve(e,r,n):r==="array-contains"?new Bve(e,n):r==="in"?new eee(e,n):r==="not-in"?new Fve(e,n):r==="array-contains-any"?new $ve(e,n):new Un(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Rve(e,n):new Dve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(dp(r,this.value)):r!==null&&Ly(this.value)===Ly(r)&&this.matchesComparison(dp(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $r(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ms extends KZ{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ms(e,r)}matches(e){return Ry(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ry(t){return t.op==="and"}function aI(t){return t.op==="or"}function YL(t){return YZ(t)&&Ry(t)}function YZ(t){for(const e of t.filters)if(e instanceof Ms)return!1;return!0}function oI(t){if(t instanceof Un)return t.field.canonicalString()+t.op.toString()+Oy(t.value);if(YL(t))return t.filters.map((e=>oI(e))).join(",");{const e=t.filters.map((r=>oI(r))).join(",");return`${t.op}(${e})`}}function XZ(t,e){return t instanceof Un?(function(n,s){return s instanceof Un&&n.op===s.op&&n.field.isEqual(s.field)&&ch(n.value,s.value)})(t,e):t instanceof Ms?(function(n,s){return s instanceof Ms&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((a,o,l)=>a&&XZ(o,s.filters[l])),!0):!1})(t,e):void $r(19439)}function QZ(t,e){const r=t.filters.concat(e);return Ms.create(r,t.op)}function JZ(t){return t instanceof Un?(function(r){return`${r.field.canonicalString()} ${r.op} ${Oy(r.value)}`})(t):t instanceof Ms?(function(r){return r.op.toString()+" {"+r.getFilters().map(JZ).join(" ,")+"}"})(t):"Filter"}class Mve extends Un{constructor(e,r,n){super(e,r,n),this.key=jr.fromName(n.referenceValue)}matches(e){const r=jr.comparator(e.key,this.key);return this.matchesComparison(r)}}class Rve extends Un{constructor(e,r){super(e,"in",r),this.keys=ZZ("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class Dve extends Un{constructor(e,r){super(e,"not-in",r),this.keys=ZZ("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function ZZ(t,e){return(e.arrayValue?.values||[]).map((r=>jr.fromName(r.referenceValue)))}class Bve extends Un{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Z1(r)&&J1(r.arrayValue,this.value)}}class eee extends Un{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&J1(this.value.arrayValue,r)}}class Fve extends Un{constructor(e,r){super(e,"not-in",r)}matches(e){if(J1(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!J1(this.value.arrayValue,r)}}class $ve extends Un{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Z1(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>J1(this.value.arrayValue,n)))}}class Uve{constructor(e,r=null,n=[],s=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=l,this.Te=null}}function lI(t,e=null,r=[],n=[],s=null,a=null,o=null){return new Uve(t,e,r,n,s,a,o)}function Vm(t){const e=hi(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>oI(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),g_(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Oy(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Oy(n))).join(",")),e.Te=r}return e.Te}function nw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Ove(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!XZ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!DF(t.startAt,e.startAt)&&DF(t.endAt,e.endAt)}function zve(t){return jr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function b4(t,e){return t.filters.filter((r=>r instanceof Un&&r.field.isEqual(e)))}function BF(t,e,r){let n=pj,s=!0;for(const a of b4(t,e)){let o=pj,l=!0;switch(a.op){case"<":case"<=":o=Pve(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,l=!1;break;case"!=":case"not-in":o=pj}OF({value:n,inclusive:s},{value:o,inclusive:l})<0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];OF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})<0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}function FF(t,e,r){let n=H0,s=!0;for(const a of b4(t,e)){let o=H0,l=!0;switch(a.op){case">=":case">":o=Lve(a.value),l=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,l=!1;break;case"!=":case"not-in":o=H0}MF({value:n,inclusive:s},{value:o,inclusive:l})>0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];MF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})>0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}class w_{constructor(e,r=null,n=[],s=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Vve(t,e,r,n,s,a,o,l){return new w_(t,e,r,n,s,a,o,l)}function tee(t){return new w_(t)}function $F(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function qve(t){return jr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Hve(t){return t.collectionGroup!==null}function w1(t){const e=hi(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Gs(da.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(l=l.add(u.field))}))})),l})(e).forEach((a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new y4(a,n))})),r.has(da.keyField().canonicalString())||e.Ie.push(new y4(da.keyField(),n))}return e.Ie}function ff(t){const e=hi(t);return e.Ee||(e.Ee=Wve(e,w1(t))),e.Ee}function Wve(t,e){if(t.limitType==="F")return lI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new y4(s.field,a)}));const r=t.endAt?new My(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new My(t.startAt.position,t.startAt.inclusive):null;return lI(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function cI(t,e,r){return new w_(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ree(t,e){return nw(ff(t),ff(e))&&t.limitType===e.limitType}function nee(t){return`${Vm(ff(t))}|lt:${t.limitType}`}function bv(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((s=>JZ(s))).join(", ")}]`),g_(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((s=>Oy(s))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((s=>Oy(s))).join(",")),`Target(${n})`})(ff(t))}; limitType=${t.limitType})`}function N_(t,e){return e.isFoundDocument()&&(function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):jr.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(t,e)&&(function(n,s){for(const a of w1(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0})(t,e)&&(function(n,s){return!(n.startAt&&!(function(o,l,c){const u=RF(o,l,c);return o.inclusive?u<=0:u<0})(n.startAt,w1(n),s)||n.endAt&&!(function(o,l,c){const u=RF(o,l,c);return o.inclusive?u>=0:u>0})(n.endAt,w1(n),s))})(t,e)}function Gve(t){return(e,r)=>{let n=!1;for(const s of w1(t)){const a=Kve(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function Kve(t,e,r){const n=t.field.isKeyField()?jr.comparator(e.key,r.key):(function(a,o,l){const c=o.data.field(a),u=l.data.field(a);return c!==null&&u!==null?dp(c,u):$r(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return $r(19790,{direction:t.dir})}}class vp{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){WL(this.inner,((r,n)=>{for(const[s,a]of n)e(s,a)}))}isEmpty(){return Cve(this.inner)}size(){return this.innerSize}}const Yve=new oc(jr.comparator);function xm(){return Yve}const see=new oc(jr.comparator);function q5(...t){let e=see;for(const r of t)e=e.insert(r.key,r);return e}function Xve(t){let e=see;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Kd(){return N1()}function iee(){return N1()}function N1(){return new vp((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Qve=new oc(jr.comparator),Jve=new Gs(jr.comparator);function Vo(...t){let e=Jve;for(const r of t)e=e.add(r);return e}const Zve=new Gs(kn);function e1e(){return Zve}function t1e(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:d4(e)?"-0":e}}function r1e(t){return{integerValue:""+t}}class j_{constructor(){this._=void 0}}function n1e(t,e,r){return t instanceof e2?(function(s,a){const o={fields:{[FZ]:{stringValue:BZ},[UZ]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&GL(a)&&(a=zZ(a)),a&&(o.fields[$Z]=a),{mapValue:o}})(r,e):t instanceof Dy?aee(t,e):t instanceof By?oee(t,e):(function(s,a){const o=i1e(s,a),l=UF(o)+UF(s.Ae);return iI(o)&&iI(s.Ae)?r1e(l):t1e(s.serializer,l)})(t,e)}function s1e(t,e,r){return t instanceof Dy?aee(t,e):t instanceof By?oee(t,e):r}function i1e(t,e){return t instanceof t2?(function(n){return iI(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(e)?e:{integerValue:0}:null}class e2 extends j_{}class Dy extends j_{constructor(e){super(),this.elements=e}}function aee(t,e){const r=lee(e);for(const n of t.elements)r.some((s=>ch(s,n)))||r.push(n);return{arrayValue:{values:r}}}class By extends j_{constructor(e){super(),this.elements=e}}function oee(t,e){let r=lee(e);for(const n of t.elements)r=r.filter((s=>!ch(s,n)));return{arrayValue:{values:r}}}class t2 extends j_{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function UF(t){return va(t.integerValue||t.doubleValue)}function lee(t){return Z1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class a1e{constructor(e,r){this.field=e,this.transform=r}}function o1e(t,e){return t.field.isEqual(e.field)&&(function(n,s){return n instanceof Dy&&s instanceof Dy||n instanceof By&&s instanceof By?Sy(n.elements,s.elements,ch):n instanceof t2&&s instanceof t2?ch(n.Ae,s.Ae):n instanceof e2&&s instanceof e2})(t.transform,e.transform)}class l1e{constructor(e,r){this.version=e,this.transformResults=r}}class rd{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new rd}static exists(e){return new rd(void 0,e)}static updateTime(e){return new rd(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mj(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}let k_=class{};function cee(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new XL(t.key,rd.none()):new sw(t.key,t.data,rd.none());{const r=t.data,n=Yu.empty();let s=new Gs(da.comparator);for(let a of e.fields)if(!s.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new ub(t.key,n,new af(s.toArray()),rd.none())}}function c1e(t,e,r){t instanceof sw?(function(s,a,o){const l=s.value.clone(),c=VF(s.fieldTransforms,a,o.transformResults);l.setAll(c),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,r):t instanceof ub?(function(s,a,o){if(!mj(s.precondition,a))return void a.convertToUnknownDocument(o.version);const l=VF(s.fieldTransforms,a,o.transformResults),c=a.data;c.setAll(uee(s)),c.setAll(l),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,r):(function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function j1(t,e,r,n){return t instanceof sw?(function(a,o,l,c){if(!mj(a.precondition,o))return l;const u=a.value.clone(),h=qF(a.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(t,e,r,n):t instanceof ub?(function(a,o,l,c){if(!mj(a.precondition,o))return l;const u=qF(a.fieldTransforms,c,o),h=o.data;return h.setAll(uee(a)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((f=>f.field)))})(t,e,r,n):(function(a,o,l){return mj(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(t,e,r)}function zF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Sy(n,s,((a,o)=>o1e(a,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sw extends k_{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ub extends k_{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function uee(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function VF(t,e,r){const n=new Map;Kr(t.length===r.length,32656,{Ve:r.length,de:t.length});for(let s=0;s<r.length;s++){const a=t[s],o=a.transform,l=e.data.field(a.field);n.set(a.field,s1e(o,l,r[s]))}return n}function qF(t,e,r){const n=new Map;for(const s of t){const a=s.transform,o=r.data.field(s.field);n.set(s.field,n1e(a,o,e))}return n}class XL extends k_{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dee extends k_{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class QL{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&c1e(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=j1(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=j1(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=iee();return this.mutations.forEach((s=>{const a=e.get(s.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(s.key)?null:l;const c=cee(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Gn.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Vo())}isEqual(e){return this.batchId===e.batchId&&Sy(this.mutations,e.mutations,((r,n)=>zF(r,n)))&&Sy(this.baseMutations,e.baseMutations,((r,n)=>zF(r,n)))}}class JL{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Kr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return Qve})();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,n[o].version);return new JL(e,r,n,s)}}class ZL{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var ya,Wn;function u1e(t){switch(t){case Vt.OK:return $r(64938);case Vt.CANCELLED:case Vt.UNKNOWN:case Vt.DEADLINE_EXCEEDED:case Vt.RESOURCE_EXHAUSTED:case Vt.INTERNAL:case Vt.UNAVAILABLE:case Vt.UNAUTHENTICATED:return!1;case Vt.INVALID_ARGUMENT:case Vt.NOT_FOUND:case Vt.ALREADY_EXISTS:case Vt.PERMISSION_DENIED:case Vt.FAILED_PRECONDITION:case Vt.ABORTED:case Vt.OUT_OF_RANGE:case Vt.UNIMPLEMENTED:case Vt.DATA_LOSS:return!0;default:return $r(15467,{code:t})}}function d1e(t){if(t===void 0)return Ec("GRPC error has no .code"),Vt.UNKNOWN;switch(t){case ya.OK:return Vt.OK;case ya.CANCELLED:return Vt.CANCELLED;case ya.UNKNOWN:return Vt.UNKNOWN;case ya.DEADLINE_EXCEEDED:return Vt.DEADLINE_EXCEEDED;case ya.RESOURCE_EXHAUSTED:return Vt.RESOURCE_EXHAUSTED;case ya.INTERNAL:return Vt.INTERNAL;case ya.UNAVAILABLE:return Vt.UNAVAILABLE;case ya.UNAUTHENTICATED:return Vt.UNAUTHENTICATED;case ya.INVALID_ARGUMENT:return Vt.INVALID_ARGUMENT;case ya.NOT_FOUND:return Vt.NOT_FOUND;case ya.ALREADY_EXISTS:return Vt.ALREADY_EXISTS;case ya.PERMISSION_DENIED:return Vt.PERMISSION_DENIED;case ya.FAILED_PRECONDITION:return Vt.FAILED_PRECONDITION;case ya.ABORTED:return Vt.ABORTED;case ya.OUT_OF_RANGE:return Vt.OUT_OF_RANGE;case ya.UNIMPLEMENTED:return Vt.UNIMPLEMENTED;case ya.DATA_LOSS:return Vt.DATA_LOSS;default:return $r(39323,{code:t})}}(Wn=ya||(ya={}))[Wn.OK=0]="OK",Wn[Wn.CANCELLED=1]="CANCELLED",Wn[Wn.UNKNOWN=2]="UNKNOWN",Wn[Wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wn[Wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wn[Wn.NOT_FOUND=5]="NOT_FOUND",Wn[Wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wn[Wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wn[Wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wn[Wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wn[Wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wn[Wn.ABORTED=10]="ABORTED",Wn[Wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wn[Wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wn[Wn.INTERNAL=13]="INTERNAL",Wn[Wn.UNAVAILABLE=14]="UNAVAILABLE",Wn[Wn.DATA_LOSS=15]="DATA_LOSS";new BL([4294967295,4294967295],0);const h1e={asc:"ASCENDING",desc:"DESCENDING"},f1e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},p1e={and:"AND",or:"OR"};class m1e{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function g1e(t,e){return t.useProto3Json||g_(e)?e:{value:e}}function uI(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function x1e(t,e){return uI(t,e.toTimestamp())}function id(t){return Kr(!!t,49232),Gn.fromTimestamp((function(r){const n=up(r);return new Mi(n.seconds,n.nanos)})(t))}function hee(t,e){return dI(t,e).canonicalString()}function dI(t,e){const r=(function(s){return new ki(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?r:r.child(e)}function fee(t){const e=ki.fromString(t);return Kr(C1e(e),10190,{key:e.toString()}),e}function v4(t,e){return hee(t.databaseId,e.path)}function gj(t,e){const r=fee(e);if(r.get(1)!==t.databaseId.projectId)throw new Sr(Vt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Sr(Vt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new jr(gee(r))}function pee(t,e){return hee(t.databaseId,e)}function mee(t){const e=fee(t);return e.length===4?ki.emptyPath():gee(e)}function y1e(t){return new ki(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gee(t){return Kr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function HF(t,e,r){return{name:v4(t,e),fields:r.value.mapValue.fields}}function b1e(t,e,r){const n=gj(t,e.name),s=id(e.updateTime),a=e.createTime?id(e.createTime):Gn.min(),o=new Yu({mapValue:{fields:e.fields}}),l=zo.newFoundDocument(n,s,a,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function w4(t,e){let r;if(e instanceof sw)r={update:HF(t,e.key,e.value)};else if(e instanceof XL)r={delete:v4(t,e.key)};else if(e instanceof ub)r={update:HF(t,e.key,e.data),updateMask:S1e(e.fieldMask)};else{if(!(e instanceof dee))return $r(16599,{dt:e.type});r={verify:v4(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(a,o){const l=o.transform;if(l instanceof e2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Dy)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof By)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof t2)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw $r(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:x1e(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:$r(27497)})(t,e.precondition)),r}function hI(t,e){const r=e.currentDocument?(function(a){return a.updateTime!==void 0?rd.updateTime(id(a.updateTime)):a.exists!==void 0?rd.exists(a.exists):rd.none()})(e.currentDocument):rd.none(),n=e.updateTransforms?e.updateTransforms.map((s=>(function(o,l){let c=null;if("setToServerValue"in l)Kr(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new e2;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new Dy(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new By(h)}else"increment"in l?c=new t2(o,l.increment):$r(16584,{proto:l});const u=da.fromServerFormat(l.fieldPath);return new a1e(u,c)})(t,s))):[];if(e.update){e.update.name;const s=gj(t,e.update.name),a=new Yu({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const u=c.fieldPaths||[];return new af(u.map((h=>da.fromServerFormat(h))))})(e.updateMask);return new ub(s,a,o,r,n)}return new sw(s,a,r,n)}if(e.delete){const s=gj(t,e.delete);return new XL(s,r)}if(e.verify){const s=gj(t,e.verify);return new dee(s,r)}return $r(1463,{proto:e})}function v1e(t,e){return t&&t.length>0?(Kr(e!==void 0,14353),t.map((r=>(function(s,a){let o=s.updateTime?id(s.updateTime):id(a);return o.isEqual(Gn.min())&&(o=id(a)),new l1e(o,s.transformResults||[])})(r,e)))):[]}function w1e(t,e){return{documents:[pee(t,e.path)]}}function N1e(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=pee(t,s);const a=(function(u){if(u.length!==0)return bee(Ms.create(u,"and"))})(e.filters);a&&(r.structuredQuery.where=a);const o=(function(u){if(u.length!==0)return u.map((h=>(function(m){return{field:Rx(m.field),direction:j1e(m.dir)}})(h)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=g1e(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:r,parent:s}}function xee(t){let e=mee(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Kr(n===1,65062);const h=r.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let a=[];r.where&&(a=(function(f){const m=yee(f);return m instanceof Ms&&YL(m)?m.getFilters():[m]})(r.where));let o=[];r.orderBy&&(o=(function(f){return f.map((m=>(function(y){return new y4(Dx(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(r.orderBy));let l=null;r.limit&&(l=(function(f){let m;return m=typeof f=="object"?f.value:f,g_(m)?null:m})(r.limit));let c=null;r.startAt&&(c=(function(f){const m=!!f.before,g=f.values||[];return new My(g,m)})(r.startAt));let u=null;return r.endAt&&(u=(function(f){const m=!f.before,g=f.values||[];return new My(g,m)})(r.endAt)),Vve(e,s,o,a,l,"F",c,u)}function yee(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Dx(r.unaryFilter.field);return Un.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Dx(r.unaryFilter.field);return Un.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Dx(r.unaryFilter.field);return Un.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Dx(r.unaryFilter.field);return Un.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $r(61313);default:return $r(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Un.create(Dx(r.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $r(58110);default:return $r(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Ms.create(r.compositeFilter.filters.map((n=>yee(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return $r(1026)}})(r.compositeFilter.op))})(t):$r(30097,{filter:t})}function j1e(t){return h1e[t]}function k1e(t){return f1e[t]}function _1e(t){return p1e[t]}function Rx(t){return{fieldPath:t.canonicalString()}}function Dx(t){return da.fromServerFormat(t.fieldPath)}function bee(t){return t instanceof Un?(function(r){if(r.op==="=="){if(LF(r.value))return{unaryFilter:{field:Rx(r.field),op:"IS_NAN"}};if(PF(r.value))return{unaryFilter:{field:Rx(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(LF(r.value))return{unaryFilter:{field:Rx(r.field),op:"IS_NOT_NAN"}};if(PF(r.value))return{unaryFilter:{field:Rx(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rx(r.field),op:k1e(r.op),value:r.value}}})(t):t instanceof Ms?(function(r){const n=r.getFilters().map((s=>bee(s)));return n.length===1?n[0]:{compositeFilter:{op:_1e(r.op),filters:n}}})(t):$r(54877,{filter:t})}function S1e(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function C1e(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Gx{constructor(e,r,n,s,a=Gn.min(),o=Gn.min(),l=lc.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Gx(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class vee{constructor(e){this.yt=e}}function E1e(t,e){let r;if(e.document)r=b1e(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=jr.fromSegments(e.noDocument.path),s=Hm(e.noDocument.readTime);r=zo.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return $r(56709);{const n=jr.fromSegments(e.unknownDocument.path),s=Hm(e.unknownDocument.version);r=zo.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime((function(s){const a=new Mi(s[0],s[1]);return Gn.fromTimestamp(a)})(e.readTime)),r}function WF(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:N4(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(a,o){return{name:v4(a,o.key),fields:o.data.value.mapValue.fields,updateTime:uI(a,o.version.toTimestamp()),createTime:uI(a,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:qm(e.version)};else{if(!e.isUnknownDocument())return $r(57904,{document:e});n.unknownDocument={path:r.path.toArray(),version:qm(e.version)}}return n}function N4(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function qm(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Hm(t){const e=new Mi(t.seconds,t.nanoseconds);return Gn.fromTimestamp(e)}function cm(t,e){const r=(e.baseMutations||[]).map((a=>hI(t.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map((a=>hI(t.yt,a))),s=Mi.fromMillis(e.localWriteTimeMs);return new QL(e.batchId,s,r,n)}function e1(t){const e=Hm(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Hm(t.lastLimboFreeSnapshotVersion):Gn.min();let n;return n=(function(a){return a.documents!==void 0})(t.query)?(function(a){const o=a.documents.length;return Kr(o===1,1966,{count:o}),ff(tee(mee(a.documents[0])))})(t.query):(function(a){return ff(xee(a))})(t.query),new Gx(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,lc.fromBase64String(t.resumeToken))}function wee(t,e){const r=qm(e.snapshotVersion),n=qm(e.lastLimboFreeSnapshotVersion);let s;s=zve(e.target)?w1e(t.yt,e.target):N1e(t.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vm(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function Nee(t){const e=xee({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cI(e,e.limit,"L"):e}function QC(t,e){return new ZL(e.largestBatchId,hI(t.yt,e.overlayMutation))}function GF(t,e){const r=e.path.lastSegment();return[t,Cl(e.path.popLast()),r]}function KF(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:qm(n.readTime),documentKey:Cl(n.documentKey.path),largestBatchId:n.largestBatchId}}class A1e{getBundleMetadata(e,r){return YF(e).get(r).next((n=>{if(n)return(function(a){return{id:a.bundleId,createTime:Hm(a.createTime),version:a.version}})(n)}))}saveBundleMetadata(e,r){return YF(e).put((function(s){return{bundleId:s.id,createTime:qm(id(s.createTime)),version:s.version}})(r))}getNamedQuery(e,r){return XF(e).get(r).next((n=>{if(n)return(function(a){return{name:a.name,query:Nee(a.bundledQuery),readTime:Hm(a.readTime)}})(n)}))}saveNamedQuery(e,r){return XF(e).put((function(s){return{name:s.name,readTime:qm(id(s.readTime)),bundledQuery:s.bundledQuery}})(r))}}function YF(t){return Xa(t,x_)}function XF(t){return Xa(t,y_)}class __{constructor(e,r){this.serializer=e,this.userId=r}static wt(e,r){const n=r.uid||"";return new __(e,n)}getOverlay(e,r){return vv(e).get(GF(this.userId,r)).next((n=>n?QC(this.serializer,n):null))}getOverlays(e,r){const n=Kd();return rt.forEach(r,(s=>this.getOverlay(e,s).next((a=>{a!==null&&n.set(s,a)})))).next((()=>n))}saveOverlays(e,r,n){const s=[];return n.forEach(((a,o)=>{const l=new ZL(r,o);s.push(this.bt(e,l))})),rt.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach((o=>s.add(Cl(o.getCollectionPath()))));const a=[];return s.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);a.push(vv(e).X(rI,l))})),rt.waitFor(a)}getOverlaysForCollection(e,r,n){const s=Kd(),a=Cl(r),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return vv(e).H(rI,o).next((l=>{for(const c of l){const u=QC(this.serializer,c);s.set(u.getKey(),u)}return s}))}getOverlaysForCollectionGroup(e,r,n,s){const a=Kd();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return vv(e).ee({index:LZ,range:l},((c,u,h)=>{const f=QC(this.serializer,u);a.size()<s||f.largestBatchId===o?(a.set(f.getKey(),f),o=f.largestBatchId):h.done()})).next((()=>a))}bt(e,r){return vv(e).put((function(s,a,o){const[l,c,u]=GF(a,o.mutation.key);return{userId:a,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:w4(s.yt,o.mutation)}})(this.serializer,this.userId,r))}}function vv(t){return Xa(t,b_)}class T1e{St(e){return Xa(e,qL)}getSessionToken(e){return this.St(e).get("sessionToken").next((r=>{const n=r?.value;return n?lc.fromUint8Array(n):lc.EMPTY_BYTE_STRING}))}setSessionToken(e,r){return this.St(e).put({name:"sessionToken",value:r.toUint8Array()})}}class um{constructor(){}Dt(e,r){this.Ct(e,r),r.vt()}Ct(e,r){if("nullValue"in e)this.Ft(r,5);else if("booleanValue"in e)this.Ft(r,10),r.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(r,15),r.Mt(va(e.integerValue));else if("doubleValue"in e){const n=va(e.doubleValue);isNaN(n)?this.Ft(r,13):(this.Ft(r,15),d4(n)?r.Mt(0):r.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(r,20),typeof n=="string"&&(n=up(n)),r.xt(`${n.seconds||""}`),r.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,r),this.Nt(r);else if("bytesValue"in e)this.Ft(r,30),r.Bt(Iy(e.bytesValue)),this.Nt(r);else if("referenceValue"in e)this.Lt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(r,45),r.Mt(n.latitude||0),r.Mt(n.longitude||0)}else"mapValue"in e?WZ(e)?this.Ft(r,Number.MAX_SAFE_INTEGER):v_(e)?this.kt(e.mapValue,r):(this.Kt(e.mapValue,r),this.Nt(r)):"arrayValue"in e?(this.qt(e.arrayValue,r),this.Nt(r)):$r(19022,{Ut:e})}Ot(e,r){this.Ft(r,25),this.$t(e,r)}$t(e,r){r.xt(e)}Kt(e,r){const n=e.fields||{};this.Ft(r,55);for(const s of Object.keys(n))this.Ot(s,r),this.Ct(n[s],r)}kt(e,r){const n=e.fields||{};this.Ft(r,53);const s=x4,a=n[s].arrayValue?.values?.length||0;this.Ft(r,15),r.Mt(va(a)),this.Ot(s,r),this.Ct(n[s],r)}qt(e,r){const n=e.values||[];this.Ft(r,50);for(const s of n)this.Ct(s,r)}Lt(e,r){this.Ft(r,37),jr.fromName(e).path.forEach((n=>{this.Ft(r,60),this.$t(n,r)}))}Ft(e,r){e.Mt(r)}Nt(e){e.Mt(2)}}um.Wt=new um;const xx=255;function I1e(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function QF(t){const e=64-(function(n){let s=0;for(let a=0;a<8;++a){const o=I1e(255&n[a]);if(s+=o,o!==8)break}return s})(t);return Math.ceil(e/8)}class P1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Gt(n.value),n=r.next();this.zt()}jt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ht(n.value),n=r.next();this.Jt()}Zt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const s=r.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ht(n);else if(n<2048)this.Ht(960|n>>>6),this.Ht(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ht(480|n>>>12),this.Ht(128|63&n>>>6),this.Ht(128|63&n);else{const s=r.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const r=this.en(e),n=QF(r);this.tn(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}nn(e){const r=this.en(e),n=QF(r);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}rn(){this.sn(xx),this.sn(255)}_n(){this.an(xx),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const r=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),n=!!(128&r[0]);r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Gt(e){const r=255&e;r===0?(this.sn(0),this.sn(255)):r===xx?(this.sn(xx),this.sn(0)):this.sn(r)}Ht(e){const r=255&e;r===0?(this.an(0),this.an(255)):r===xx?(this.an(xx),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class L1e{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class O1e{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class wv{constructor(){this.cn=new P1e,this.ascending=new L1e(this.cn),this.descending=new O1e(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class dm{constructor(e,r,n,s){this.hn=e,this.Pn=r,this.Tn=n,this.In=s}En(){const e=this.In.length,r=e===0||this.In[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.In,0),r!==e?n.set([0],this.In.length):++n[n.length-1],new dm(this.hn,this.Pn,this.Tn,n)}Rn(e,r,n){return{indexId:this.hn,uid:e,arrayValue:xj(this.Tn),directionalValue:xj(this.In),orderedDocumentKey:xj(r),documentKey:n.path.toArray()}}An(e,r,n){const s=this.Rn(e,r,n);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function _0(t,e){let r=t.hn-e.hn;return r!==0?r:(r=JF(t.Tn,e.Tn),r!==0?r:(r=JF(t.In,e.In),r!==0?r:jr.comparator(t.Pn,e.Pn)))}function JF(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}function xj(t){return CJ()?(function(r){let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r[s]);return n})(t):t}function ZF(t){return typeof t!="string"?t:(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(t)}class e${constructor(e){this.Vn=new Gs(((r,n)=>da.comparator(r.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Vn=this.Vn.add(n):this.mn.push(n)}}get fn(){return this.Vn.size>1}gn(e){if(Kr(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const r=ZT(e);if(r!==void 0&&!this.pn(r))return!1;const n=Zp(e);let s=new Set,a=0,o=0;for(;a<n.length&&this.pn(n[a]);++a)s=s.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.Vn.size>0){const l=this.Vn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[a];if(!this.yn(l,c)||!this.wn(this.dn[o++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(o>=this.dn.length||!this.wn(this.dn[o++],l))return!1}return!0}bn(){if(this.fn)return null;let e=new Gs(da.comparator);const r=[];for(const n of this.mn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new dj(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new dj(n.field,0))}for(const n of this.dn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new dj(n.field,n.dir==="asc"?0:1)));return new u4(u4.UNKNOWN_ID,this.collectionId,r,K1.empty())}pn(e){for(const r of this.mn)if(this.yn(r,e))return!0;return!1}yn(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}wn(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}function jee(t){if(Kr(t instanceof Un||t instanceof Ms,20012),t instanceof Un){if(t instanceof eee){const r=t.value.arrayValue?.values?.map((n=>Un.create(t.field,"==",n)))||[];return Ms.create(r,"or")}return t}const e=t.filters.map((r=>jee(r)));return Ms.create(e,t.op)}function M1e(t){if(t.getFilters().length===0)return[];const e=mI(jee(t));return Kr(kee(e),7391),fI(e)||pI(e)?[e]:e.getFilters()}function fI(t){return t instanceof Un}function pI(t){return t instanceof Ms&&YL(t)}function kee(t){return fI(t)||pI(t)||(function(r){if(r instanceof Ms&&aI(r)){for(const n of r.getFilters())if(!fI(n)&&!pI(n))return!1;return!0}return!1})(t)}function mI(t){if(Kr(t instanceof Un||t instanceof Ms,34018),t instanceof Un)return t;if(t.filters.length===1)return mI(t.filters[0]);const e=t.filters.map((n=>mI(n)));let r=Ms.create(e,t.op);return r=j4(r),kee(r)?r:(Kr(r instanceof Ms,64498),Kr(Ry(r),40251),Kr(r.filters.length>1,57927),r.filters.reduce(((n,s)=>eO(n,s))))}function eO(t,e){let r;return Kr(t instanceof Un||t instanceof Ms,38388),Kr(e instanceof Un||e instanceof Ms,25473),r=t instanceof Un?e instanceof Un?(function(s,a){return Ms.create([s,a],"and")})(t,e):t$(t,e):e instanceof Un?t$(e,t):(function(s,a){if(Kr(s.filters.length>0&&a.filters.length>0,48005),Ry(s)&&Ry(a))return QZ(s,a.getFilters());const o=aI(s)?s:a,l=aI(s)?a:s,c=o.filters.map((u=>eO(u,l)));return Ms.create(c,"or")})(t,e),j4(r)}function t$(t,e){if(Ry(e))return QZ(e,t.getFilters());{const r=e.filters.map((n=>eO(t,n)));return Ms.create(r,"or")}}function j4(t){if(Kr(t instanceof Un||t instanceof Ms,11850),t instanceof Un)return t;const e=t.getFilters();if(e.length===1)return j4(e[0]);if(YZ(t))return t;const r=e.map((s=>j4(s))),n=[];return r.forEach((s=>{s instanceof Un?n.push(s):s instanceof Ms&&(s.op===t.op?n.push(...s.filters):n.push(s))})),n.length===1?n[0]:Ms.create(n,t.op)}class R1e{constructor(){this.Sn=new tO}addToCollectionParentIndex(e,r){return this.Sn.add(r),rt.resolve()}getCollectionParents(e,r){return rt.resolve(this.Sn.getEntries(r))}addFieldIndex(e,r){return rt.resolve()}deleteFieldIndex(e,r){return rt.resolve()}deleteAllFieldIndexes(e){return rt.resolve()}createTargetIndexes(e,r){return rt.resolve()}getDocumentsMatchingTarget(e,r){return rt.resolve(null)}getIndexType(e,r){return rt.resolve(0)}getFieldIndexes(e,r){return rt.resolve([])}getNextCollectionGroupToUpdate(e){return rt.resolve(null)}getMinOffset(e,r){return rt.resolve(Rc.min())}getMinOffsetFromCollectionGroup(e,r){return rt.resolve(Rc.min())}updateCollectionGroup(e,r,n){return rt.resolve()}updateIndexEntries(e,r){return rt.resolve()}}class tO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Gs(ki.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Gs(ki.comparator)).toArray()}}const r$="IndexedDbIndexManager",H5=new Uint8Array(0);class D1e{constructor(e,r){this.databaseId=r,this.Dn=new tO,this.Cn=new vp((n=>Vm(n)),((n,s)=>nw(n,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.Dn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener((()=>{this.Dn.add(r)}));const a={collectionId:n,parent:Cl(s)};return n$(e).put(a)}return rt.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[NZ(r),""],!1,!0);return n$(e).H(s).next((a=>{for(const o of a){if(o.collectionId!==r)break;n.push(Gd(o.parent))}return n}))}addFieldIndex(e,r){const n=Nv(e),s=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(r);delete s.indexId;const a=n.add(s);if(r.indexState){const o=bx(e);return a.next((l=>{o.put(KF(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))}))}return a.next()}deleteFieldIndex(e,r){const n=Nv(e),s=bx(e),a=yx(e);return n.delete(r.indexId).next((()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const r=Nv(e),n=yx(e),s=bx(e);return r.X().next((()=>n.X())).next((()=>s.X()))}createTargetIndexes(e,r){return rt.forEach(this.vn(r),(n=>this.getIndexType(e,n).next((s=>{if(s===0||s===1){const a=new e$(n).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,r){const n=yx(e);let s=!0;const a=new Map;return rt.forEach(this.vn(r),(o=>this.Fn(e,o).next((l=>{s&&(s=!!l),a.set(o,l)})))).next((()=>{if(s){let o=Vo();const l=[];return rt.forEach(a,((c,u)=>{er(r$,`Using index ${(function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map((I=>`${I.fieldPath}:${I.kind}`)).join(",")}`})(c)} to execute ${Vm(r)}`);const h=(function(C,I){const O=ZT(I);if(O===void 0)return null;for(const L of b4(C,O.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null})(u,c),f=(function(C,I){const O=new Map;for(const L of Zp(I))for(const _ of b4(C,L.fieldPath))switch(_.op){case"==":case"in":O.set(L.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return O.set(L.fieldPath.canonicalString(),_.value),Array.from(O.values())}return null})(u,c),m=(function(C,I){const O=[];let L=!0;for(const _ of Zp(I)){const E=_.kind===0?BF(C,_.fieldPath,C.startAt):FF(C,_.fieldPath,C.startAt);O.push(E.value),L&&(L=E.inclusive)}return new My(O,L)})(u,c),g=(function(C,I){const O=[];let L=!0;for(const _ of Zp(I)){const E=_.kind===0?FF(C,_.fieldPath,C.endAt):BF(C,_.fieldPath,C.endAt);O.push(E.value),L&&(L=E.inclusive)}return new My(O,L)})(u,c),y=this.Mn(c,u,m),v=this.Mn(c,u,g),w=this.xn(c,u,f),N=this.On(c.indexId,h,y,m.inclusive,v,g.inclusive,w);return rt.forEach(N,(k=>n.Z(k,r.limit).next((C=>{C.forEach((I=>{const O=jr.fromSegments(I.documentKey);o.has(O)||(o=o.add(O),l.push(O))}))}))))})).next((()=>l))}return rt.resolve(null)}))}vn(e){let r=this.Cn.get(e);return r||(e.filters.length===0?r=[e]:r=M1e(Ms.create(e.filters,"and")).map((n=>lI(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,r),r)}On(e,r,n,s,a,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),u=c/(r!=null?r.length:1),h=[];for(let f=0;f<c;++f){const m=r?this.Nn(r[f/u]):H5,g=this.Bn(e,m,n[f%u],s),y=this.Ln(e,m,a[f%u],o),v=l.map((w=>this.Bn(e,m,w,!0)));h.push(...this.createRange(g,y,v))}return h}Bn(e,r,n,s){const a=new dm(e,jr.empty(),r,n);return s?a:a.En()}Ln(e,r,n,s){const a=new dm(e,jr.empty(),r,n);return s?a.En():a}Fn(e,r){const n=new e$(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let o=null;for(const l of a)n.gn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,r){let n=2;const s=this.vn(r);return rt.forEach(s,(a=>this.Fn(e,a).next((o=>{o?n!==0&&o.fields.length<(function(c){let u=new Gs(da.comparator),h=!1;for(const f of c.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(a)&&(n=1):n=0})))).next((()=>(function(o){return o.limit!==null})(r)&&s.length>1&&n===2?1:n))}kn(e,r){const n=new wv;for(const s of Zp(e)){const a=r.data.field(s.fieldPath);if(a==null)return null;const o=n.ln(s.kind);um.Wt.Dt(a,o)}return n.un()}Nn(e){const r=new wv;return um.Wt.Dt(e,r.ln(0)),r.un()}Kn(e,r){const n=new wv;return um.Wt.Dt(KL(this.databaseId,r),n.ln((function(a){const o=Zp(a);return o.length===0?0:o[o.length-1].kind})(e))),n.un()}xn(e,r,n){if(n===null)return[];let s=[];s.push(new wv);let a=0;for(const o of Zp(e)){const l=n[a++];for(const c of s)if(this.qn(r,o.fieldPath)&&Z1(l))s=this.Un(s,o,l);else{const u=c.ln(o.kind);um.Wt.Dt(l,u)}}return this.$n(s)}Mn(e,r,n){return this.xn(e,r,n.position)}$n(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].un();return r}Un(e,r,n){const s=[...e],a=[];for(const o of n.arrayValue.values||[])for(const l of s){const c=new wv;c.seed(l.un()),um.Wt.Dt(o,c.ln(r.kind)),a.push(c)}return a}qn(e,r){return!!e.filters.find((n=>n instanceof Un&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,r){const n=Nv(e),s=bx(e);return(r?n.H(tI,IDBKeyRange.bound(r,r)):n.H()).next((a=>{const o=[];return rt.forEach(a,(l=>s.get([l.indexId,this.uid]).next((c=>{o.push((function(h,f){const m=f?new K1(f.sequenceNumber,new Rc(Hm(f.readTime),new jr(Gd(f.documentKey)),f.largestBatchId)):K1.empty(),g=h.fields.map((([y,v])=>new dj(da.fromServerFormat(y),v)));return new u4(h.indexId,h.collectionGroup,g,m)})(l,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((r=>r.length===0?null:(r.sort(((n,s)=>{const a=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:kn(n.collectionGroup,s.collectionGroup)})),r[0].collectionGroup)))}updateCollectionGroup(e,r,n){const s=Nv(e),a=bx(e);return this.Wn(e).next((o=>s.H(tI,IDBKeyRange.bound(r,r)).next((l=>rt.forEach(l,(c=>a.put(KF(c.indexId,this.uid,o,n))))))))}updateIndexEntries(e,r){const n=new Map;return rt.forEach(r,((s,a)=>{const o=n.get(s.collectionGroup);return(o?rt.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next((l=>(n.set(s.collectionGroup,l),rt.forEach(l,(c=>this.Qn(e,s,c).next((u=>{const h=this.Gn(a,c);return u.isEqual(h)?rt.resolve():this.zn(e,a,c,u,h)})))))))}))}jn(e,r,n,s){return yx(e).put(s.Rn(this.uid,this.Kn(n,r.key),r.key))}Hn(e,r,n,s){return yx(e).delete(s.An(this.uid,this.Kn(n,r.key),r.key))}Qn(e,r,n){const s=yx(e);let a=new Gs(_0);return s.ee({index:PZ,range:IDBKeyRange.only([n.indexId,this.uid,xj(this.Kn(n,r))])},((o,l)=>{a=a.add(new dm(n.indexId,r,ZF(l.arrayValue),ZF(l.directionalValue)))})).next((()=>a))}Gn(e,r){let n=new Gs(_0);const s=this.kn(r,e);if(s==null)return n;const a=ZT(r);if(a!=null){const o=e.data.field(a.fieldPath);if(Z1(o))for(const l of o.arrayValue.values||[])n=n.add(new dm(r.indexId,e.key,this.Nn(l),s))}else n=n.add(new dm(r.indexId,e.key,H5,s));return n}zn(e,r,n,s,a){er(r$,"Updating index entries for document '%s'",r.key);const o=[];return(function(c,u,h,f,m){const g=c.getIterator(),y=u.getIterator();let v=gx(g),w=gx(y);for(;v||w;){let N=!1,k=!1;if(v&&w){const C=h(v,w);C<0?k=!0:C>0&&(N=!0)}else v!=null?k=!0:N=!0;N?(f(w),w=gx(y)):k?(m(v),v=gx(g)):(v=gx(g),w=gx(y))}})(s,a,_0,(l=>{o.push(this.jn(e,r,n,l))}),(l=>{o.push(this.Hn(e,r,n,l))})),rt.waitFor(o)}Wn(e){let r=1;return bx(e).ee({index:IZ,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,s,a)=>{a.done(),r=s.sequenceNumber+1})).next((()=>r))}createRange(e,r,n){n=n.sort(((o,l)=>_0(o,l))).filter(((o,l,c)=>!l||_0(o,c[l-1])!==0));const s=[];s.push(e);for(const o of n){const l=_0(o,e),c=_0(o,r);if(l===0)s[0]=e.En();else if(l>0&&c<0)s.push(o),s.push(o.En());else if(c>0)break}s.push(r);const a=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const l=s[o].An(this.uid,H5,jr.empty()),c=s[o+1].An(this.uid,H5,jr.empty());a.push(IDBKeyRange.bound(l,c))}return a}Jn(e,r){return _0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(s$)}getMinOffset(e,r){return rt.mapArray(this.vn(r),(n=>this.Fn(e,n).next((s=>s||$r(44426))))).next(s$)}}function n$(t){return Xa(t,Q1)}function yx(t){return Xa(t,b1)}function Nv(t){return Xa(t,VL)}function bx(t){return Xa(t,y1)}function s$(t){Kr(t.length!==0,28825);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;$L(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new Rc(e.readTime,e.documentKey,r)}const i$={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_ee=41943040;class nc{static withCacheSize(e){return new nc(e,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}function See(t,e,r){const n=t.store(Wu),s=t.store(Cy),a=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.ee({range:o},((h,f,m)=>(l++,m.delete())));a.push(c.next((()=>{Kr(l===1,47070,{batchId:r.batchId})})));const u=[];for(const h of r.mutations){const f=EZ(e,h.key.path,r.batchId);a.push(s.delete(f)),u.push(h.key)}return rt.waitFor(a).next((()=>u))}function k4(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw $r(14731);e=t.noDocument}return JSON.stringify(e).length}nc.DEFAULT_COLLECTION_PERCENTILE=10,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nc.DEFAULT=new nc(_ee,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nc.DISABLED=new nc(-1,0,0);class S_{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Zn={}}static wt(e,r,n,s){Kr(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new S_(a,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return S0(e).ee({index:gm,range:n},((s,a,o)=>{r=!1,o.done()})).next((()=>r))}addMutationBatch(e,r,n,s){const a=Bx(e),o=S0(e);return o.add({}).next((l=>{Kr(typeof l=="number",49019);const c=new QL(l,r,n,s),u=(function(g,y,v){const w=v.baseMutations.map((k=>w4(g.yt,k))),N=v.mutations.map((k=>w4(g.yt,k)));return{userId:y,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:N}})(this.serializer,this.userId,c),h=[];let f=new Gs(((m,g)=>kn(m.canonicalString(),g.canonicalString())));for(const m of s){const g=EZ(this.userId,m.key.path,l);f=f.add(m.key.path.popLast()),h.push(o.put(u)),h.push(a.put(g,nve))}return f.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Zn[l]=c.keys()})),rt.waitFor(h).next((()=>c))}))}lookupMutationBatch(e,r){return S0(e).get(r).next((n=>n?(Kr(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:r}),cm(this.serializer,n)):null))}Xn(e,r){return this.Zn[r]?rt.resolve(this.Zn[r]):this.lookupMutationBatch(e,r).next((n=>{if(n){const s=n.keys();return this.Zn[r]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return S0(e).ee({index:gm,range:s},((o,l,c)=>{l.userId===this.userId&&(Kr(l.batchId>=n,47524,{Yn:n}),a=cm(this.serializer,l)),c.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Cm;return S0(e).ee({index:gm,range:r,reverse:!0},((s,a,o)=>{n=a.batchId,o.done()})).next((()=>n))}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,Cm],[this.userId,Number.POSITIVE_INFINITY]);return S0(e).H(gm,r).next((n=>n.map((s=>cm(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=hj(this.userId,r.path),s=IDBKeyRange.lowerBound(n),a=[];return Bx(e).ee({range:s},((o,l,c)=>{const[u,h,f]=o,m=Gd(h);if(u===this.userId&&r.path.isEqual(m))return S0(e).get(f).next((g=>{if(!g)throw $r(61480,{er:o,batchId:f});Kr(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:f}),a.push(cm(this.serializer,g))}));c.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Gs(kn);const s=[];return r.forEach((a=>{const o=hj(this.userId,a.path),l=IDBKeyRange.lowerBound(o),c=Bx(e).ee({range:l},((u,h,f)=>{const[m,g,y]=u,v=Gd(g);m===this.userId&&a.path.isEqual(v)?n=n.add(y):f.done()}));s.push(c)})),rt.waitFor(s).next((()=>this.tr(e,n)))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,a=hj(this.userId,n),o=IDBKeyRange.lowerBound(a);let l=new Gs(kn);return Bx(e).ee({range:o},((c,u,h)=>{const[f,m,g]=c,y=Gd(m);f===this.userId&&n.isPrefixOf(y)?y.length===s&&(l=l.add(g)):h.done()})).next((()=>this.tr(e,l)))}tr(e,r){const n=[],s=[];return r.forEach((a=>{s.push(S0(e).get(a).next((o=>{if(o===null)throw $r(35274,{batchId:a});Kr(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),n.push(cm(this.serializer,o))})))})),rt.waitFor(s).next((()=>n))}removeMutationBatch(e,r){return See(e.le,this.userId,r).next((n=>(e.addOnCommittedListener((()=>{this.nr(r.batchId)})),rt.forEach(n,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((r=>{if(!r)return rt.resolve();const n=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),s=[];return Bx(e).ee({range:n},((a,o,l)=>{if(a[0]===this.userId){const c=Gd(a[1]);s.push(c)}else l.done()})).next((()=>{Kr(s.length===0,56720,{rr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,r){return Cee(e,this.userId,r)}ir(e){return Eee(e).get(this.userId).next((r=>r||{userId:this.userId,lastAcknowledgedBatchId:Cm,lastStreamToken:""}))}}function Cee(t,e,r){const n=hj(e,r.path),s=n[1],a=IDBKeyRange.lowerBound(n);let o=!1;return Bx(t).ee({range:a,Y:!0},((l,c,u)=>{const[h,f,m]=l;h===e&&f===s&&(o=!0),u.done()})).next((()=>o))}function S0(t){return Xa(t,Wu)}function Bx(t){return Xa(t,Cy)}function Eee(t){return Xa(t,Y1)}class Wm{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Wm(0)}static ar(){return new Wm(-1)}}class B1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.ur(e).next((r=>{const n=new Wm(r.highestTargetId);return r.highestTargetId=n.next(),this.cr(e,r).next((()=>r.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((r=>Gn.fromTimestamp(new Mi(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((r=>r.highestListenSequenceNumber))}setTargetsMetadata(e,r,n){return this.ur(e).next((s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.cr(e,s))))}addTargetData(e,r){return this.lr(e,r).next((()=>this.ur(e).next((n=>(n.targetCount+=1,this.hr(r,n),this.cr(e,n))))))}updateTargetData(e,r){return this.lr(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next((()=>vx(e).delete(r.targetId))).next((()=>this.ur(e))).next((n=>(Kr(n.targetCount>0,8065),n.targetCount-=1,this.cr(e,n))))}removeTargets(e,r,n){let s=0;const a=[];return vx(e).ee(((o,l)=>{const c=e1(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,a.push(this.removeTargetData(e,c)))})).next((()=>rt.waitFor(a))).next((()=>s))}forEachTarget(e,r){return vx(e).ee(((n,s)=>{const a=e1(s);r(a)}))}ur(e){return a$(e).get(p4).next((r=>(Kr(r!==null,2888),r)))}cr(e,r){return a$(e).put(p4,r)}lr(e,r){return vx(e).put(wee(this.serializer,r))}hr(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.ur(e).next((r=>r.targetCount))}getTargetData(e,r){const n=Vm(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return vx(e).ee({range:s,index:TZ},((o,l,c)=>{const u=e1(l);nw(r,u.target)&&(a=u,c.done())})).next((()=>a))}addMatchingKeys(e,r,n){const s=[],a=$0(e);return r.forEach((o=>{const l=Cl(o.path);s.push(a.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,o))})),rt.waitFor(s)}removeMatchingKeys(e,r,n){const s=$0(e);return rt.forEach(r,(a=>{const o=Cl(a.path);return rt.waitFor([s.delete([n,o]),this.referenceDelegate.removeReference(e,n,a)])}))}removeMatchingKeysForTargetId(e,r){const n=$0(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=$0(e);let a=Vo();return s.ee({range:n,Y:!0},((o,l,c)=>{const u=Gd(o[1]),h=new jr(u);a=a.add(h)})).next((()=>a))}containsKey(e,r){const n=Cl(r.path),s=IDBKeyRange.bound([n],[NZ(n)],!1,!0);let a=0;return $0(e).ee({index:zL,Y:!0,range:s},(([o,l],c,u)=>{o!==0&&(a++,u.done())})).next((()=>a>0))}At(e,r){return vx(e).get(r).next((n=>n?e1(n):null))}}function vx(t){return Xa(t,Ey)}function a$(t){return Xa(t,Em)}function $0(t){return Xa(t,Ay)}const o$="LruGarbageCollector",F1e=1048576;function l$([t,e],[r,n]){const s=kn(t,r);return s===0?kn(e,n):s}class $1e{constructor(e){this.Pr=e,this.buffer=new Gs(l$),this.Tr=0}Ir(){return++this.Tr}Er(e){const r=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();l$(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class U1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){er(o$,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){xg(r)?er(o$,"Ignoring IndexedDB error during garbage collection: ",r):await p_(r)}await this.Ar(3e5)}))}}class z1e{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.dr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return rt.resolve(td.ce);const n=new $1e(r);return this.Vr.forEachTarget(e,(s=>n.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>n.Er(s))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(er("LruGarbageCollector","Garbage collection skipped; disabled"),rt.resolve(i$)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(er("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),i$):this.gr(e,r)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,r){let n,s,a,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(er("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s)))).next((f=>(n=f,l=Date.now(),this.removeTargets(e,n,r)))).next((f=>(a=f,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((f=>(u=Date.now(),Mx()<=Ln.DEBUG&&er("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),rt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:f}))))}}function V1e(t,e){return new z1e(t,e)}class q1e{constructor(e,r){this.db=e,this.garbageCollector=V1e(this,r)}dr(e){const r=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>r.next((s=>n+s))))}pr(e){let r=0;return this.mr(e,(n=>{r++})).next((()=>r))}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}mr(e,r){return this.yr(e,((n,s)=>r(s)))}addReference(e,r,n){return W5(e,n)}removeReference(e,r,n){return W5(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return W5(e,r)}wr(e,r){return(function(s,a){let o=!1;return Eee(s).te((l=>Cee(s,l,a).next((c=>(c&&(o=!0),rt.resolve(!c)))))).next((()=>o))})(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.yr(e,((o,l)=>{if(l<=r){const c=this.wr(e,o).next((u=>{if(!u)return a++,n.getEntry(e,o).next((()=>(n.removeEntry(o,Gn.min()),$0(e).delete((function(f){return[0,Cl(f.path)]})(o)))))}));s.push(c)}})).next((()=>rt.waitFor(s))).next((()=>n.apply(e))).next((()=>a))}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return W5(e,r)}yr(e,r){const n=$0(e);let s,a=td.ce;return n.ee({index:zL},(([o,l],{path:c,sequenceNumber:u})=>{o===0?(a!==td.ce&&r(new jr(Gd(s)),a),a=u,s=c):a=td.ce})).next((()=>{a!==td.ce&&r(new jr(Gd(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function W5(t,e){return $0(t).put((function(n,s){return{targetId:0,path:Cl(n.path),sequenceNumber:s}})(e,t.currentSequenceNumber))}class Aee{constructor(){this.changes=new vp((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,zo.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?rt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class H1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Yp(e).put(n)}removeEntry(e,r,n){return Yp(e).delete((function(a,o){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],N4(o),l[l.length-1]]})(r,n))}updateMetadata(e,r){return this.getMetadata(e).next((n=>(n.byteSize+=r,this.br(e,n))))}getEntry(e,r){let n=zo.newInvalidDocument(r);return Yp(e).ee({index:fj,range:IDBKeyRange.only(jv(r))},((s,a)=>{n=this.Sr(r,a)})).next((()=>n))}Dr(e,r){let n={size:0,document:zo.newInvalidDocument(r)};return Yp(e).ee({index:fj,range:IDBKeyRange.only(jv(r))},((s,a)=>{n={document:this.Sr(r,a),size:k4(a)}})).next((()=>n))}getEntries(e,r){let n=xm();return this.Cr(e,r,((s,a)=>{const o=this.Sr(s,a);n=n.insert(s,o)})).next((()=>n))}vr(e,r){let n=xm(),s=new oc(jr.comparator);return this.Cr(e,r,((a,o)=>{const l=this.Sr(a,o);n=n.insert(a,l),s=s.insert(a,k4(o))})).next((()=>({documents:n,Fr:s})))}Cr(e,r,n){if(r.isEmpty())return rt.resolve();let s=new Gs(d$);r.forEach((c=>s=s.add(c)));const a=IDBKeyRange.bound(jv(s.first()),jv(s.last())),o=s.getIterator();let l=o.getNext();return Yp(e).ee({index:fj,range:a},((c,u,h)=>{const f=jr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&d$(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?h.j(jv(l)):h.done()})).next((()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,r,n,s,a){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),N4(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Yp(e).H(IDBKeyRange.bound(l,c,!0)).next((u=>{a?.incrementDocumentReadCount(u.length);let h=xm();for(const f of u){const m=this.Sr(jr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(N_(r,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,r,n,s){let a=xm();const o=u$(r,n),l=u$(r,Rc.max());return Yp(e).ee({index:AZ,range:IDBKeyRange.bound(o,l,!0)},((c,u,h)=>{const f=this.Sr(jr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);a=a.insert(f.key,f),a.size===s&&h.done()})).next((()=>a))}newChangeBuffer(e){return new W1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((r=>r.byteSize))}getMetadata(e){return c$(e).get(eI).next((r=>(Kr(!!r,20021),r)))}br(e,r){return c$(e).put(eI,r)}Sr(e,r){if(r){const n=E1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Gn.min())))return n}return zo.newInvalidDocument(e)}}function Tee(t){return new H1e(t)}class W1e extends Aee{constructor(e,r){super(),this.Mr=e,this.trackRemovals=r,this.Or=new vp((n=>n.toString()),((n,s)=>n.isEqual(s)))}applyChanges(e){const r=[];let n=0,s=new Gs(((a,o)=>kn(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const l=this.Or.get(a);if(r.push(this.Mr.removeEntry(e,a,l.readTime)),o.isValidDocument()){const c=WF(this.Mr.serializer,o);s=s.add(a.path.popLast());const u=k4(c);n+=u-l.size,r.push(this.Mr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=WF(this.Mr.serializer,o.convertToNoDocument(Gn.min()));r.push(this.Mr.addEntry(e,a,c))}})),s.forEach((a=>{r.push(this.Mr.indexManager.addToCollectionParentIndex(e,a))})),r.push(this.Mr.updateMetadata(e,n)),rt.waitFor(r)}getFromCache(e,r){return this.Mr.Dr(e,r).next((n=>(this.Or.set(r,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,r){return this.Mr.vr(e,r).next((({documents:n,Fr:s})=>(s.forEach(((a,o)=>{this.Or.set(a,{size:o,readTime:n.get(a).readTime})})),n)))}}function c$(t){return Xa(t,X1)}function Yp(t){return Xa(t,f4)}function jv(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function u$(t,e){const r=e.documentKey.path.toArray();return[t,N4(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function d$(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(s=kn(r[a],n[a]),s)return s;return s=kn(r.length,n.length),s||(s=kn(r[r.length-2],n[n.length-2]),s||kn(r[r.length-1],n[n.length-1]))}class G1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class Iee{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,r)))).next((s=>(n!==null&&j1(n.mutation,s,af.empty(),Mi.now()),s)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Vo()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Vo()){const s=Kd();return this.populateOverlays(e,s,r).next((()=>this.computeViews(e,r,s,n).next((a=>{let o=q5();return a.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Kd();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Vo())))}populateOverlays(e,r,n){const s=[];return n.forEach((a=>{r.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((o,l)=>{r.set(o,l)}))}))}computeViews(e,r,n,s){let a=xm();const o=N1(),l=(function(){return N1()})();return r.forEach(((c,u)=>{const h=n.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof ub)?a=a.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),j1(h.mutation,u,h.mutation.getFieldMask(),Mi.now())):o.set(u.key,af.empty())})),this.recalculateAndSaveOverlays(e,a).next((c=>(c.forEach(((u,h)=>o.set(u,h))),r.forEach(((u,h)=>l.set(u,new G1e(h,o.get(u)??null)))),l)))}recalculateAndSaveOverlays(e,r){const n=N1();let s=new oc(((o,l)=>o-l)),a=Vo();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const l of o)l.keys().forEach((c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||af.empty();h=l.applyToLocalView(u,h),n.set(c,h);const f=(s.get(l.batchId)||Vo()).add(c);s=s.insert(l.batchId,f)}))})).next((()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=iee();h.forEach((m=>{if(!a.has(m)){const g=cee(r.get(m),n.get(m));g!==null&&f.set(m,g),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return rt.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,s){return qve(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Hve(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next((a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):rt.resolve(Kd());let l=G1,c=a;return o.next((u=>rt.forEach(u,((h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),a.get(h)?rt.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{c=c.insert(h,m)}))))).next((()=>this.populateOverlays(e,u,a))).next((()=>this.computeViews(e,c,u,Vo()))).next((h=>({batchId:l,changes:Xve(h)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new jr(r)).next((n=>{let s=q5();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let o=q5();return this.indexManager.getCollectionParents(e,a).next((l=>rt.forEach(l,(c=>{const u=(function(f,m){return new w_(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next((h=>{h.forEach(((f,m)=>{o=o.insert(f,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s)))).next((o=>{a.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,zo.newInvalidDocument(h)))}));let l=q5();return o.forEach(((c,u)=>{const h=a.get(c);h!==void 0&&j1(h.mutation,u,af.empty(),Mi.now()),N_(r,u)&&(l=l.insert(c,u))})),l}))}}class K1e{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,r){return rt.resolve(this.Nr.get(r))}saveBundleMetadata(e,r){return this.Nr.set(r.id,(function(s){return{id:s.id,version:s.version,createTime:id(s.createTime)}})(r)),rt.resolve()}getNamedQuery(e,r){return rt.resolve(this.Br.get(r))}saveNamedQuery(e,r){return this.Br.set(r.name,(function(s){return{name:s.name,query:Nee(s.bundledQuery),readTime:id(s.readTime)}})(r)),rt.resolve()}}class Y1e{constructor(){this.overlays=new oc(jr.comparator),this.Lr=new Map}getOverlay(e,r){return rt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Kd();return rt.forEach(r,(s=>this.getOverlay(e,s).next((a=>{a!==null&&n.set(s,a)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((s,a)=>{this.bt(e,r,a)})),rt.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Lr.get(n);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.Lr.delete(n)),rt.resolve()}getOverlaysForCollection(e,r,n){const s=Kd(),a=r.length+1,o=new jr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return rt.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new oc(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=a.get(u.largestBatchId);h===null&&(h=Kd(),a=a.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=Kd(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>l.set(u,h))),!(l.size()>=s)););return rt.resolve(l)}bt(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(n.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new ZL(r,n));let a=this.Lr.get(r);a===void 0&&(a=Vo(),this.Lr.set(r,a)),this.Lr.set(r,a.add(n.key))}}class X1e{constructor(){this.sessionToken=lc.EMPTY_BYTE_STRING}getSessionToken(e){return rt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,rt.resolve()}}class rO{constructor(){this.kr=new Gs(ho.Kr),this.qr=new Gs(ho.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,r){const n=new ho(e,r);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Wr(new ho(e,r))}Qr(e,r){e.forEach((n=>this.removeReference(n,r)))}Gr(e){const r=new jr(new ki([])),n=new ho(r,e),s=new ho(r,e+1),a=[];return this.qr.forEachInRange([n,s],(o=>{this.Wr(o),a.push(o.key)})),a}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const r=new jr(new ki([])),n=new ho(r,e),s=new ho(r,e+1);let a=Vo();return this.qr.forEachInRange([n,s],(o=>{a=a.add(o.key)})),a}containsKey(e){const r=new ho(e,0),n=this.kr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ho{constructor(e,r){this.key=e,this.Hr=r}static Kr(e,r){return jr.comparator(e.key,r.key)||kn(e.Hr,r.Hr)}static Ur(e,r){return kn(e.Hr,r.Hr)||jr.comparator(e.key,r.key)}}class Q1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Yn=1,this.Jr=new Gs(ho.Kr)}checkEmpty(e){return rt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new QL(a,r,n,s);this.mutationQueue.push(o);for(const l of s)this.Jr=this.Jr.add(new ho(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return rt.resolve(o)}lookupMutationBatch(e,r){return rt.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.Xr(n),a=s<0?0:s;return rt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return rt.resolve(this.mutationQueue.length===0?Cm:this.Yn-1)}getAllMutationBatches(e){return rt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ho(r,0),s=new ho(r,Number.POSITIVE_INFINITY),a=[];return this.Jr.forEachInRange([n,s],(o=>{const l=this.Zr(o.Hr);a.push(l)})),rt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Gs(kn);return r.forEach((s=>{const a=new ho(s,0),o=new ho(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([a,o],(l=>{n=n.add(l.Hr)}))})),rt.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;jr.isDocumentKey(a)||(a=a.child(""));const o=new ho(new jr(a),0);let l=new Gs(kn);return this.Jr.forEachWhile((c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Hr)),!0)}),o),rt.resolve(this.Yr(l))}Yr(e){const r=[];return e.forEach((n=>{const s=this.Zr(n);s!==null&&r.push(s)})),r}removeMutationBatch(e,r){Kr(this.ei(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return rt.forEach(r.mutations,(s=>{const a=new ho(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,r){const n=new ho(r,0),s=this.Jr.firstAfterOrEqual(n);return rt.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,rt.resolve()}ei(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class J1e{constructor(e){this.ti=e,this.docs=(function(){return new oc(jr.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,o=this.ti(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return rt.resolve(n?n.document.mutableCopy():zo.newInvalidDocument(r))}getEntries(e,r){let n=xm();return r.forEach((s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():zo.newInvalidDocument(s))})),rt.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=xm();const o=r.path,l=new jr(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||$L(kZ(h),n)<=0||(s.has(h.key)||N_(r,h))&&(a=a.insert(h.key,h.mutableCopy()))}return rt.resolve(a)}getAllFromCollectionGroup(e,r,n,s){$r(9500)}ni(e,r){return rt.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new Z1e(this)}getSize(e){return rt.resolve(this.size)}}class Z1e extends Aee{constructor(e){super(),this.Mr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?r.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(n)})),rt.waitFor(r)}getFromCache(e,r){return this.Mr.getEntry(e,r)}getAllFromCache(e,r){return this.Mr.getEntries(e,r)}}class e2e{constructor(e){this.persistence=e,this.ri=new vp((r=>Vm(r)),nw),this.lastRemoteSnapshotVersion=Gn.min(),this.highestTargetId=0,this.ii=0,this.si=new rO,this.targetCount=0,this.oi=Wm._r()}forEachTarget(e,r){return this.ri.forEach(((n,s)=>r(s))),rt.resolve()}getLastRemoteSnapshotVersion(e){return rt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return rt.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),rt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.ii&&(this.ii=r),rt.resolve()}lr(e){this.ri.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.oi=new Wm(r),this.highestTargetId=r),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,r){return this.lr(r),this.targetCount+=1,rt.resolve()}updateTargetData(e,r){return this.lr(r),rt.resolve()}removeTargetData(e,r){return this.ri.delete(r.target),this.si.Gr(r.targetId),this.targetCount-=1,rt.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.ri.forEach(((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.ri.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)})),rt.waitFor(a).next((()=>s))}getTargetCount(e){return rt.resolve(this.targetCount)}getTargetData(e,r){const n=this.ri.get(r)||null;return rt.resolve(n)}addMatchingKeys(e,r,n){return this.si.$r(r,n),rt.resolve()}removeMatchingKeys(e,r,n){this.si.Qr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach((o=>{a.push(s.markPotentiallyOrphaned(e,o))})),rt.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.si.Gr(r),rt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.si.jr(r);return rt.resolve(n)}containsKey(e,r){return rt.resolve(this.si.containsKey(r))}}class Pee{constructor(e,r){this._i={},this.overlays={},this.ai=new td(0),this.ui=!1,this.ui=!0,this.ci=new X1e,this.referenceDelegate=e(this),this.li=new e2e(this),this.indexManager=new R1e,this.remoteDocumentCache=(function(s){return new J1e(s)})((n=>this.referenceDelegate.hi(n))),this.serializer=new vee(r),this.Pi=new K1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Y1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this._i[e.toKey()];return n||(n=new Q1e(r,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,r,n){er("MemoryPersistence","Starting transaction:",e);const s=new t2e(this.ai.next());return this.referenceDelegate.Ti(),n(s).next((a=>this.referenceDelegate.Ii(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(e,r){return rt.or(Object.values(this._i).map((n=>()=>n.containsKey(e,r))))}}class t2e extends SZ{constructor(e){super(),this.currentSequenceNumber=e}}class C_{constructor(e){this.persistence=e,this.Ri=new rO,this.Ai=null}static Vi(e){return new C_(e)}get di(){if(this.Ai)return this.Ai;throw $r(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.di.delete(n.toString()),rt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.di.add(n.toString()),rt.resolve()}markPotentiallyOrphaned(e,r){return this.di.add(r.toString()),rt.resolve()}removeTarget(e,r){this.Ri.Gr(r.targetId).forEach((s=>this.di.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((s=>{s.forEach((a=>this.di.add(a.toString())))})).next((()=>n.removeTargetData(e,r)))}Ti(){this.Ai=new Set}Ii(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return rt.forEach(this.di,(n=>{const s=jr.fromPath(n);return this.mi(e,s).next((a=>{a||r.removeEntry(s,Gn.min())}))})).next((()=>(this.Ai=null,r.apply(e))))}updateLimboDocument(e,r){return this.mi(e,r).next((n=>{n?this.di.delete(r.toString()):this.di.add(r.toString())}))}hi(e){return 0}mi(e,r){return rt.or([()=>rt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class r2e{constructor(e){this.serializer=e}k(e,r,n,s){const a=new m_("createOrUpgrade",r);n<1&&s>=1&&((function(c){c.createObjectStore(rw)})(e),(function(c){c.createObjectStore(Y1,{keyPath:rve}),c.createObjectStore(Wu,{keyPath:SF,autoIncrement:!0}).createIndex(gm,CF,{unique:!0}),c.createObjectStore(Cy)})(e),h$(e),(function(c){c.createObjectStore(em)})(e));let o=rt.resolve();return n<3&&s>=3&&(n!==0&&((function(c){c.deleteObjectStore(Ay),c.deleteObjectStore(Ey),c.deleteObjectStore(Em)})(e),h$(e)),o=o.next((()=>(function(c){const u=c.store(Em),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Gn.min().toTimestamp(),targetCount:0};return u.put(p4,h)})(a)))),n<4&&s>=4&&(n!==0&&(o=o.next((()=>(function(c,u){return u.store(Wu).H().next((f=>{c.deleteObjectStore(Wu),c.createObjectStore(Wu,{keyPath:SF,autoIncrement:!0}).createIndex(gm,CF,{unique:!0});const m=u.store(Wu),g=f.map((y=>m.put(y)));return rt.waitFor(g)}))})(e,a)))),o=o.next((()=>{(function(c){c.createObjectStore(Ty,{keyPath:dve})})(e)}))),n<5&&s>=5&&(o=o.next((()=>this.gi(a)))),n<6&&s>=6&&(o=o.next((()=>((function(c){c.createObjectStore(X1)})(e),this.pi(a))))),n<7&&s>=7&&(o=o.next((()=>this.yi(a)))),n<8&&s>=8&&(o=o.next((()=>this.wi(e,a)))),n<9&&s>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&s>=10&&(o=o.next((()=>this.bi(a)))),n<11&&s>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(x_,{keyPath:hve})})(e),(function(c){c.createObjectStore(y_,{keyPath:fve})})(e)}))),n<12&&s>=12&&(o=o.next((()=>{(function(c){const u=c.createObjectStore(b_,{keyPath:vve});u.createIndex(rI,wve,{unique:!1}),u.createIndex(LZ,Nve,{unique:!1})})(e)}))),n<13&&s>=13&&(o=o.next((()=>(function(c){const u=c.createObjectStore(f4,{keyPath:sve});u.createIndex(fj,ive),u.createIndex(AZ,ave)})(e))).next((()=>this.Si(e,a))).next((()=>e.deleteObjectStore(em)))),n<14&&s>=14&&(o=o.next((()=>this.Di(e,a)))),n<15&&s>=15&&(o=o.next((()=>(function(c){c.createObjectStore(VL,{keyPath:pve,autoIncrement:!0}).createIndex(tI,mve,{unique:!1}),c.createObjectStore(y1,{keyPath:gve}).createIndex(IZ,xve,{unique:!1}),c.createObjectStore(b1,{keyPath:yve}).createIndex(PZ,bve,{unique:!1})})(e)))),n<16&&s>=16&&(o=o.next((()=>{r.objectStore(y1).clear()})).next((()=>{r.objectStore(b1).clear()}))),n<17&&s>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(qL,{keyPath:jve})})(e)}))),n<18&&s>=18&&CJ()&&(o=o.next((()=>{r.objectStore(y1).clear()})).next((()=>{r.objectStore(b1).clear()}))),o}pi(e){let r=0;return e.store(em).ee(((n,s)=>{r+=k4(s)})).next((()=>{const n={byteSize:r};return e.store(X1).put(eI,n)}))}gi(e){const r=e.store(Y1),n=e.store(Wu);return r.H().next((s=>rt.forEach(s,(a=>{const o=IDBKeyRange.bound([a.userId,Cm],[a.userId,a.lastAcknowledgedBatchId]);return n.H(gm,o).next((l=>rt.forEach(l,(c=>{Kr(c.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=cm(this.serializer,c);return See(e,a.userId,u).next((()=>{}))}))))}))))}yi(e){const r=e.store(Ay),n=e.store(em);return e.store(Em).get(p4).next((s=>{const a=[];return n.ee(((o,l)=>{const c=new ki(o),u=(function(f){return[0,Cl(f)]})(c);a.push(r.get(u).next((h=>h?rt.resolve():(f=>r.put({targetId:0,path:Cl(f),sequenceNumber:s.highestListenSequenceNumber}))(c))))})).next((()=>rt.waitFor(a)))}))}wi(e,r){e.createObjectStore(Q1,{keyPath:uve});const n=r.store(Q1),s=new tO,a=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Cl(c)})}};return r.store(em).ee({Y:!0},((o,l)=>{const c=new ki(o);return a(c.popLast())})).next((()=>r.store(Cy).ee({Y:!0},(([o,l,c],u)=>{const h=Gd(l);return a(h.popLast())}))))}bi(e){const r=e.store(Ey);return r.ee(((n,s)=>{const a=e1(s),o=wee(this.serializer,a);return r.put(o)}))}Si(e,r){const n=r.store(em),s=[];return n.ee(((a,o)=>{const l=r.store(f4),c=(function(f){return f.document?new jr(ki.fromString(f.document.name).popFirst(5)):f.noDocument?jr.fromSegments(f.noDocument.path):f.unknownDocument?jr.fromSegments(f.unknownDocument.path):$r(36783)})(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))})).next((()=>rt.waitFor(s)))}Di(e,r){const n=r.store(Wu),s=Tee(this.serializer),a=new Pee(C_.Vi,this.serializer.yt);return n.H().next((o=>{const l=new Map;return o.forEach((c=>{let u=l.get(c.userId)??Vo();cm(this.serializer,c).keys().forEach((h=>u=u.add(h))),l.set(c.userId,u)})),rt.forEach(l,((c,u)=>{const h=new $o(u),f=__.wt(this.serializer,h),m=a.getIndexManager(h),g=S_.wt(h,this.serializer,m,a.referenceDelegate);return new Iee(s,g,f,m).recalculateAndSaveOverlaysForDocumentKeys(new nI(r,td.ce),c).next()}))}))}}function h$(t){t.createObjectStore(Ay,{keyPath:lve}).createIndex(zL,cve,{unique:!0}),t.createObjectStore(Ey,{keyPath:"targetId"}).createIndex(TZ,ove,{unique:!0}),t.createObjectStore(Em)}const C0="IndexedDbPersistence",JC=18e5,ZC=5e3,eE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",n2e="main";class nO{constructor(e,r,n,s,a,o,l,c,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.Ci=a,this.window=o,this.document=l,this.Fi=u,this.Mi=h,this.xi=f,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=m=>Promise.resolve(),!nO.v())throw new Sr(Vt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new q1e(this,s),this.Ki=r+n2e,this.serializer=new vee(c),this.qi=new Z0(this.Ki,this.xi,new r2e(this.serializer)),this.ci=new T1e,this.li=new B1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Tee(this.serializer),this.Pi=new A1e,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&Ec(C0,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Sr(Vt.FAILED_PRECONDITION,eE);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new td(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async r=>{r.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>G5(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((r=>{r||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((r=>this.isPrimary&&!r?this.Ji(e).next((()=>!1)):!!r&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(xg(e))return er(C0,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return er(C0,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return kv(e).get(mx).next((r=>rt.resolve(this.Xi(r))))}Yi(e){return G5(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,JC)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(r=>{const n=Xa(r,Ty);return n.H().next((s=>{const a=this.ns(s,JC),o=s.filter((l=>a.indexOf(l)===-1));return rt.forEach(o,(l=>n.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ui)for(const r of e)this.Ui.removeItem(this.rs(r.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?rt.resolve(!0):kv(e).get(mx).next((r=>{if(r!==null&&this.ts(r.leaseTimestampMs,ZC)&&!this.ss(r.ownerId)){if(this.Xi(r)&&this.networkEnabled)return!0;if(!this.Xi(r)){if(!r.allowTabSynchronization)throw new Sr(Vt.FAILED_PRECONDITION,eE);return!1}}return!(!this.networkEnabled||!this.inForeground)||G5(e).H().next((n=>this.ns(n,ZC).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(a||o&&l)return!0}return!1}))===void 0))})).next((r=>(this.isPrimary!==r&&er(C0,`Client ${r?"is":"is not"} eligible for a primary lease.`),r)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[rw,Ty],(e=>{const r=new nI(e,td.ce);return this.Ji(r).next((()=>this.Yi(r)))})),this.qi.close(),this.ls()}ns(e,r){return e.filter((n=>this.ts(n.updateTimeMs,r)&&!this.ss(n.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>G5(e).H().next((r=>this.ns(r,JC).map((n=>n.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,r){return S_.wt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new D1e(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return __.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,r,n){er(C0,"Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",a=(function(c){return c===18?Sve:c===17?DZ:c===16?_ve:c===15?HL:c===14?RZ:c===13?MZ:c===12?kve:c===11?OZ:void $r(60245)})(this.xi);let o;return this.qi.runTransaction(e,s,a,(l=>(o=new nI(l,this.ai?this.ai.next():td.ce),r==="readwrite-primary"?this.ji(o).next((c=>!!c||this.Hi(o))).next((c=>{if(!c)throw Ec(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Sr(Vt.FAILED_PRECONDITION,_Z);return n(o)})).next((c=>this.Zi(o).next((()=>c)))):this.Ps(o).next((()=>n(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Ps(e){return kv(e).get(mx).next((r=>{if(r!==null&&this.ts(r.leaseTimestampMs,ZC)&&!this.ss(r.ownerId)&&!this.Xi(r)&&!(this.Mi||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Sr(Vt.FAILED_PRECONDITION,eE)}))}Zi(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kv(e).put(mx,r)}static v(){return Z0.v()}Ji(e){const r=kv(e);return r.get(mx).next((n=>this.Xi(n)?(er(C0,"Releasing primary lease."),r.delete(mx)):rt.resolve()))}ts(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Ec(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;SJ()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const r=this.Ui?.getItem(this.rs(e))!==null;return er(C0,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ec(C0,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Ec("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function kv(t){return Xa(t,rw)}function G5(t){return Xa(t,Ty)}function s2e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}class sO{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Ts=n,this.Is=s}static Es(e,r){let n=Vo(),s=Vo();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new sO(e,r.fromCache,n,s)}}class i2e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Lee{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return SJ()?8:CZ(Ya())>0?6:4})()}initialize(e,r){this.fs=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.gs(e,r).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ps(e,r,s,n).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new i2e;return this.ys(e,r,o).next((l=>{if(a.result=l,this.As)return this.ws(e,r,o,l.size)}))})).next((()=>a.result))}ws(e,r,n,s){return n.documentReadCount<this.Vs?(Mx()<=Ln.DEBUG&&er("QueryEngine","SDK will not create cache indexes for query:",bv(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),rt.resolve()):(Mx()<=Ln.DEBUG&&er("QueryEngine","Query:",bv(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ds*s?(Mx()<=Ln.DEBUG&&er("QueryEngine","The SDK decides to create cache indexes for query:",bv(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ff(r))):rt.resolve())}gs(e,r){if($F(r))return rt.resolve(null);let n=ff(r);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(r.limit!==null&&s===1&&(r=cI(r,null,"F"),n=ff(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((a=>{const o=Vo(...a);return this.fs.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,n).next((c=>{const u=this.bs(r,l);return this.Ss(r,u,o,c.readTime)?this.gs(e,cI(r,null,"F")):this.Ds(e,u,r,c)}))))})))))}ps(e,r,n,s){return $F(r)||s.isEqual(Gn.min())?rt.resolve(null):this.fs.getDocuments(e,n).next((a=>{const o=this.bs(r,a);return this.Ss(r,o,n,s)?rt.resolve(null):(Mx()<=Ln.DEBUG&&er("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bv(r)),this.Ds(e,o,r,Xbe(s,G1)).next((l=>l)))}))}bs(e,r){let n=new Gs(Gve(e));return r.forEach(((s,a)=>{N_(e,a)&&(n=n.add(a))})),n}Ss(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ys(e,r,n){return Mx()<=Ln.DEBUG&&er("QueryEngine","Using full collection scan to execute query:",bv(r)),this.fs.getDocumentsMatchingQuery(e,r,Rc.min(),n)}Ds(e,r,n,s){return this.fs.getDocumentsMatchingQuery(e,n,s).next((a=>(r.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const a2e="LocalStore";class o2e{constructor(e,r,n,s){this.persistence=e,this.Cs=r,this.serializer=s,this.vs=new oc(kn),this.Fs=new vp((a=>Vm(a)),nw),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Iee(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.vs)))}}function Oee(t,e,r,n){return new o2e(t,e,r,n)}async function l2e(t,e){const r=hi(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next((a=>(s=a,r.Os(e),r.mutationQueue.getAllMutationBatches(n)))).next((a=>{const o=[],l=[];let c=Vo();for(const u of s){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of a){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next((u=>({Ns:u,removedBatchIds:o,addedBatchIds:l})))}))}))}function c2e(t,e){const r=hi(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),a=r.xs.newChangeBuffer({trackRemovals:!0});return(function(l,c,u,h){const f=u.batch,m=f.keys();let g=rt.resolve();return m.forEach((y=>{g=g.next((()=>h.getEntry(c,y))).next((v=>{const w=u.docVersions.get(y);Kr(w!==null,48541),v.version.compareTo(w)<0&&(f.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),h.addEntry(v)))}))})),g.next((()=>l.mutationQueue.removeMutationBatch(c,f)))})(r,n,e,a).next((()=>a.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(l){let c=Vo();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c})(e)))).next((()=>r.localDocuments.getDocuments(n,s)))}))}function u2e(t){const e=hi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.li.getLastRemoteSnapshotVersion(r)))}function d2e(t,e){const r=hi(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Cm),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}class f${constructor(){this.activeTargetIds=e1e()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Mee{constructor(){this.vo=new f$,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,r,n){this.Fo[e]=r}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new f$,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class h2e{Mo(e){}shutdown(){}}const p$="ConnectivityMonitor";class m${constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){er(p$,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){er(p$,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let K5=null;function gI(){return K5===null?K5=(function(){return 268435456+Math.round(2147483648*Math.random())})():K5++,"0x"+K5.toString(16)}const tE="RestConnection",f2e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class p2e{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=r+"://"+e.host,this.Uo=`projects/${n}/databases/${s}`,this.$o=this.databaseId.database===g4?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(e,r,n,s,a){const o=gI(),l=this.Qo(e,r.toUriEncodedString());er(tE,`Sending RPC '${e}' ${o}:`,l,n);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,a);const{host:u}=new URL(l),h=mg(u);return this.zo(e,l,c,n,h).then((f=>(er(tE,`Received RPC '${e}' ${o}: `,f),f)),(f=>{throw f_(tE,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",n),f}))}jo(e,r,n,s,a,o){return this.Wo(e,r,n,s,a)}Go(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+cb})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((s,a)=>e[a]=s)),n&&n.headers.forEach(((s,a)=>e[a]=s))}Qo(e,r){const n=f2e[e];let s=`${this.qo}/v1/${r}:${n}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}class m2e{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const el="WebChannelConnection",_v=(t,e,r)=>{t.listen(e,(n=>{try{r(n)}catch(s){setTimeout((()=>{throw s}),0)}}))};class oy extends p2e{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!oy.c_){const e=xZ();_v(e,gZ.STAT_EVENT,(r=>{r.stat===QT.PROXY?er(el,"STAT_EVENT: detected buffering proxy"):r.stat===QT.NOPROXY&&er(el,"STAT_EVENT: detected no buffering proxy")})),oy.c_=!0}}zo(e,r,n,s,a){const o=gI();return new Promise(((l,c)=>{const u=new pZ;u.setWithCredentials(!0),u.listenOnce(mZ.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case uj.NO_ERROR:const f=u.getResponseJson();er(el,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case uj.TIMEOUT:er(el,`RPC '${e}' ${o} timed out`),c(new Sr(Vt.DEADLINE_EXCEEDED,"Request time out"));break;case uj.HTTP_ERROR:const m=u.getStatus();if(er(el,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const v=(function(N){const k=N.toLowerCase().replace(/_/g,"-");return Object.values(Vt).indexOf(k)>=0?k:Vt.UNKNOWN})(y.status);c(new Sr(v,y.message))}else c(new Sr(Vt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Sr(Vt.UNAVAILABLE,"Connection failed."));break;default:$r(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{er(el,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(s);er(el,`RPC '${e}' ${o} sending request:`,s),u.send(r,"POST",h,n,15)}))}T_(e,r,n){const s=gI(),a=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Go(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");er(el,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,m=!1;const g=new m2e({Ho:y=>{m?er(el,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(f||(er(el,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),er(el,`RPC '${e}' stream ${s} sending:`,y),h.send(y))},Jo:()=>h.close()});return _v(h,Zv.EventType.OPEN,(()=>{m||(er(el,`RPC '${e}' stream ${s} transport opened.`),g.i_())})),_v(h,Zv.EventType.CLOSE,(()=>{m||(m=!0,er(el,`RPC '${e}' stream ${s} transport closed`),g.o_(),this.E_(h))})),_v(h,Zv.EventType.ERROR,(y=>{m||(m=!0,f_(el,`RPC '${e}' stream ${s} transport errored. Name:`,y.name,"Message:",y.message),g.o_(new Sr(Vt.UNAVAILABLE,"The operation could not be completed")))})),_v(h,Zv.EventType.MESSAGE,(y=>{if(!m){const v=y.data[0];Kr(!!v,16349);const w=v,N=w?.error||w[0]?.error;if(N){er(el,`RPC '${e}' stream ${s} received error:`,N);const k=N.status;let C=(function(L){const _=ya[L];if(_!==void 0)return d1e(_)})(k),I=N.message;C===void 0&&(C=Vt.INTERNAL,I="Unknown error status: "+k+" with message "+N.message),m=!0,g.o_(new Sr(C,I)),h.close()}else er(el,`RPC '${e}' stream ${s} received:`,v),g.__(v)}})),oy.u_(),setTimeout((()=>{g.s_()}),0),g}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((r=>r===e))}Go(e,r,n){super.Go(e,r,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return yZ()}}function g2e(t){return new oy(t)}function x2e(){return typeof window<"u"?window:null}function yj(){return typeof document<"u"?document:null}function Ree(t){return new m1e(t,!0)}oy.c_=!1;class Dee{constructor(e,r,n=1e3,s=1.5,a=6e4){this.Ci=e,this.timerId=r,this.R_=n,this.A_=s,this.V_=a,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const r=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&er("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const g$="PersistentStream";class y2e{constructor(e,r,n,s,a,o,l,c){this.Ci=e,this.b_=n,this.S_=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Dee(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Vt.RESOURCE_EXHAUSTED?(Ec(r.toString()),Ec("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Vt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(r)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===r&&this.G_(n,s)}),(n=>{e((()=>{const s=new Sr(Vt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,r){const n=this.Q_(this.D_);this.stream=this.j_(e,r),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return er(g$,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return r=>{this.Ci.enqueueAndForget((()=>this.D_===e?r():(er(g$,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class b2e extends y2e{constructor(e,r,n,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}H_(e){return Kr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Kr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=v1e(e.writeResults,e.commitTime),n=id(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=y1e(this.serializer),this.K_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>w4(this.serializer,n)))};this.K_(r)}}class v2e{}class w2e extends v2e{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Sr(Vt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Wo(e,dI(r,n),s,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Vt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Sr(Vt.UNKNOWN,a.toString())}))}jo(e,r,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.jo(e,dI(r,n),s,o,l,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Vt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Sr(Vt.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function N2e(t,e,r,n){return new w2e(t,e,r,n)}class j2e{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ec(r),this.aa=!1):er("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const E_="RemoteStore";class k2e{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=a,this.Aa.Mo((o=>{n.enqueueAndForget((async()=>{T_(this)&&(er(E_,"Restarting streams for network reachability change."),await(async function(c){const u=hi(c);u.Ea.add(4),await A_(u),u.Va.set("Unknown"),u.Ea.delete(4),await iO(u)})(this))}))})),this.Va=new j2e(n,s)}}async function iO(t){if(T_(t))for(const e of t.Ra)await e(!0)}async function A_(t){for(const e of t.Ra)await e(!1)}function T_(t){return hi(t).Ea.size===0}async function Bee(t,e,r){if(!xg(e))throw e;t.Ea.add(1),await A_(t),t.Va.set("Offline"),r||(r=()=>u2e(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{er(E_,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await iO(t)}))}function Fee(t,e){return e().catch((r=>Bee(t,r,e)))}async function I_(t){const e=hi(t),r=hp(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Cm;for(;_2e(e);)try{const s=await d2e(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,S2e(e,s)}catch(s){await Bee(e,s)}$ee(e)&&Uee(e)}function _2e(t){return T_(t)&&t.Ta.length<10}function S2e(t,e){t.Ta.push(e);const r=hp(t);r.O_()&&r.Y_&&r.ea(e.mutations)}function $ee(t){return T_(t)&&!hp(t).x_()&&t.Ta.length>0}function Uee(t){hp(t).start()}async function C2e(t){hp(t).ra()}async function E2e(t){const e=hp(t);for(const r of t.Ta)e.ea(r.mutations)}async function A2e(t,e,r){const n=t.Ta.shift(),s=JL.from(n,e,r);await Fee(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await I_(t)}async function T2e(t,e){e&&hp(t).Y_&&await(async function(n,s){if((function(o){return u1e(o)&&o!==Vt.ABORTED})(s.code)){const a=n.Ta.shift();hp(n).B_(),await Fee(n,(()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s))),await I_(n)}})(t,e),$ee(t)&&Uee(t)}async function I2e(t,e){const r=hi(t);e?(r.Ea.delete(2),await iO(r)):e||(r.Ea.add(2),await A_(r),r.Va.set("Unknown"))}function hp(t){return t.fa||(t.fa=(function(r,n,s){const a=hi(r);return a.sa(),new b2e(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:C2e.bind(null,t),t_:T2e.bind(null,t),ta:E2e.bind(null,t),na:A2e.bind(null,t)}),t.Ra.push((async e=>{e?(t.fa.B_(),await I_(t)):(await t.fa.stop(),t.Ta.length>0&&(er(E_,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class aO{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Sm,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const o=Date.now()+n,l=new aO(e,r,o,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Sr(Vt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function P2e(t,e){if(Ec("AsyncQueue",`${e}: ${t}`),xg(t))return new Sr(Vt.UNAVAILABLE,`${e}: ${t}`);throw t}class L2e{constructor(){this.queries=x$(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=hi(r),a=s.queries;s.queries=x$(),a.forEach(((o,l)=>{for(const c of l.ba)c.onError(n)}))})(this,new Sr(Vt.ABORTED,"Firestore shutting down"))}}function x$(){return new vp((t=>nee(t)),ree)}function O2e(t){t.Ca.forEach((e=>{e.next()}))}var y$,b$;(b$=y$||(y$={})).Ma="default",b$.Cache="cache";const M2e="SyncEngine";class R2e{constructor(e,r,n,s,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new vp((l=>nee(l)),ree),this.Iu=new Map,this.Eu=new Set,this.Ru=new oc(jr.comparator),this.Au=new Map,this.Vu=new rO,this.du={},this.mu=new Map,this.fu=Wm.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function v$(t,e,r){const n=hi(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach(((a,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)})),(function(o,l){const c=hi(o);c.onlineState=l;let u=!1;c.queries.forEach(((h,f)=>{for(const m of f.ba)m.va(l)&&(u=!0)})),u&&O2e(c)})(n.eventManager,e),s.length&&n.Pu.J_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function D2e(t,e){const r=hi(t),n=e.batch.batchId;try{const s=await c2e(r.localStore,e);Vee(r,n,null),zee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await oO(r,s)}catch(s){await p_(s)}}async function B2e(t,e,r){const n=hi(t);try{const s=await(function(o,l){const c=hi(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next((f=>(Kr(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(n.localStore,e);Vee(n,e,r),zee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await oO(n,s)}catch(s){await p_(s)}}function zee(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function Vee(t,e,r){const n=hi(t);let s=n.du[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.du[n.currentUser.toKey()]=s}}async function oO(t,e,r){const n=hi(t),s=[],a=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((l,c)=>{o.push(n.pu(c,e,r).then((u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=sO.Es(c.targetId,u);a.push(h)}})))})),await Promise.all(o),n.Pu.J_(s),await(async function(c,u){const h=hi(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>rt.forEach(u,(m=>rt.forEach(m.Ts,(g=>h.persistence.referenceDelegate.addReference(f,m.targetId,g))).next((()=>rt.forEach(m.Is,(g=>h.persistence.referenceDelegate.removeReference(f,m.targetId,g)))))))))}catch(f){if(!xg(f))throw f;er(a2e,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const g=h.vs.get(m),y=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(y);h.vs=h.vs.insert(m,v)}}})(n.localStore,a))}async function F2e(t,e){const r=hi(t);if(!r.currentUser.isEqual(e)){er(M2e,"User change. New user:",e.toKey());const n=await l2e(r.localStore,e);r.currentUser=e,(function(a,o){a.mu.forEach((l=>{l.forEach((c=>{c.reject(new Sr(Vt.CANCELLED,o))}))})),a.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await oO(r,n.Ns)}}function $2e(t){const e=hi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=D2e.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=B2e.bind(null,e),e}class xI{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ree(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return Oee(this.persistence,new Lee,e.initialUser,this.serializer)}Cu(e){return new Pee(C_.Vi,this.serializer)}Du(e){return new Mee}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xI.provider={build:()=>new xI};class U2e extends xI{constructor(e,r,n){super(),this.xu=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await $2e(this.xu.syncEngine),await I_(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return Oee(this.persistence,new Lee,e.initialUser,this.serializer)}Fu(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new U1e(n,e.asyncQueue,r)}Mu(e,r){const n=new eve(r,this.persistence);return new Zbe(e.asyncQueue,n)}Cu(e){const r=s2e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?nc.withCacheSize(this.cacheSizeBytes):nc.DEFAULT;return new nO(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,x2e(),yj(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Mee}}class yI{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>v$(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=F2e.bind(null,this.syncEngine),await I2e(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new L2e})()}createDatastore(e){const r=Ree(e.databaseInfo.databaseId),n=g2e(e.databaseInfo);return N2e(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,s,a,o,l){return new k2e(n,s,a,o,l)})(this.localStore,this.datastore,e.asyncQueue,(r=>v$(this.syncEngine,r,0)),(function(){return m$.v()?new m$:new h2e})())}createSyncEngine(e,r){return(function(s,a,o,l,c,u,h){const f=new R2e(s,a,o,l,c,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=hi(r);er(E_,"RemoteStore shutting down."),n.Ea.add(5),await A_(n),n.Aa.shutdown(),n.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}yI.provider={build:()=>new yI};const w$="FirestoreClient";class z2e{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this._databaseInfo=s,this.user=$o.UNAUTHENTICATED,this.clientId=wZ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async o=>{er(w$,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(er(w$,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Sm;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=P2e(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function qee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const V2e="ComponentProvider",N$=new Map;function q2e(t,e,r,n,s){return new Tve(t,e,r,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,qee(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,n)}const Hee="firestore.googleapis.com",j$=!0;class k${constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Sr(Vt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Hee,this.ssl=j$}else this.host=e.host,this.ssl=e.ssl??j$;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_ee;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F1e)throw new Sr(Vt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Gbe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qee(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Sr(Vt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Sr(Vt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Sr(Vt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wee{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new k$({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Sr(Vt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Sr(Vt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new k$(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new Dbe;switch(n.type){case"firstParty":return new Ube(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Sr(Vt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=N$.get(r);n&&(er(V2e,"Removing Datastore"),N$.delete(r),n.terminate())})(this),Promise.resolve()}}function H2e(t,e,r,n={}){t=jZ(t,Wee);const s=mg(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;s&&(jL(`https://${l}`),kL("Firestore",!0)),a.host!==Hee&&a.host!==l&&f_("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:l,ssl:s,emulatorOptions:n};if(!Bm(c,o)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=$o.MOCK_USER;else{u=kJ(n.mockUserToken,t._app?.options.projectId);const f=n.mockUserToken.sub||n.mockUserToken.user_id;if(!f)throw new Sr(Vt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new $o(f)}t._authCredentials=new Bbe(new vZ(u,h))}}let W2e=class Gee{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Gee(this.firestore,e,this._query)}};class Yd{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lO(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yd(this.firestore,e,this._key)}toJSON(){return{type:Yd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(tw(r,Yd._jsonSchema))return new Yd(e,n||null,new jr(ki.fromString(r.referencePath)))}}Yd._jsonSchemaVersion="firestore/documentReference/1.0",Yd._jsonSchema={type:ja("string",Yd._jsonSchemaVersion),referencePath:ja("string")};class lO extends W2e{constructor(e,r,n){super(e,r,tee(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yd(this.firestore,null,new jr(e))}withConverter(e){return new lO(this.firestore,e,this._path)}}const _$="AsyncQueue";class S${constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Dee(this,"async_queue_retry"),this._c=()=>{const n=yj();n&&er(_$,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=yj();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=yj();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Sm;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!xg(e))throw e;er(_$,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Ec("INTERNAL UNHANDLED ERROR: ",C$(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=aO.createAndSchedule(this,e,r,n,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&$r(47125,{Pc:C$(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function C$(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Kee extends Wee{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new S$,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new S$(e),this._firestoreClient=void 0,await e}}}function G2e(t,e){const r=typeof t=="object"?t:CL(),n=typeof t=="string"?t:g4,s=c_(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=wJ("firestore");a&&H2e(s,...a)}return s}function K2e(t){const e=t._freezeSettings(),r=q2e(t._databaseId,t._app?.options.appId||"",t._persistenceKey,t._app?.options.apiKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new z2e(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(t._componentsProvider))}function Y2e(t,e){f_("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return X2e(t,yI.provider,{build:n=>new U2e(n,r.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function X2e(t,e,r){if((t=jZ(t,Kee))._firestoreClient||t._terminated)throw new Sr(Vt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Sr(Vt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},K2e(t)}class Zh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zh(lc.fromBase64String(e))}catch(r){throw new Sr(Vt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Zh(lc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zh._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tw(e,Zh._jsonSchema))return Zh.fromBase64String(e.bytes)}}Zh._jsonSchemaVersion="firestore/bytes/1.0",Zh._jsonSchema={type:ja("string",Zh._jsonSchemaVersion),bytes:ja("string")};class Yee{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Sr(Vt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new da(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Am{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Sr(Vt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Sr(Vt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return kn(this._lat,e._lat)||kn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Am._jsonSchemaVersion}}static fromJSON(e){if(tw(e,Am._jsonSchema))return new Am(e.latitude,e.longitude)}}Am._jsonSchemaVersion="firestore/geoPoint/1.0",Am._jsonSchema={type:ja("string",Am._jsonSchemaVersion),latitude:ja("number"),longitude:ja("number")};class Tm{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Tm._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tw(e,Tm._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Tm(e.vectorValues);throw new Sr(Vt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tm._jsonSchemaVersion="firestore/vectorValue/1.0",Tm._jsonSchema={type:ja("string",Tm._jsonSchemaVersion),vectorValues:ja("object")};function Xee(t,e,r){if((e=_u(e))instanceof Yee)return e._internalPath;if(typeof e=="string")return J2e(t,e);throw bI("Field path arguments must be of type string or ",t)}const Q2e=new RegExp("[~\\*/\\[\\]]");function J2e(t,e,r){if(e.search(Q2e)>=0)throw bI(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new Yee(...e.split("."))._internalPath}catch{throw bI(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function bI(t,e,r,n,s){let a=`Function ${e}() called with invalid data`;a+=". ";let o="";return new Sr(Vt.INVALID_ARGUMENT,a+t+o)}const E$="@firebase/firestore",A$="4.10.0";class Qee{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Yd(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z2e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const r=this._document.data.field(Xee("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Z2e extends Qee{data(){return super.data()}}class Y5{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ly extends Qee{constructor(e,r,n,s,a,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new bj(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Xee("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Sr(Vt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ly._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ly._jsonSchemaVersion="firestore/documentSnapshot/1.0",ly._jsonSchema={type:ja("string",ly._jsonSchemaVersion),bundleSource:ja("string","DocumentSnapshot"),bundleName:ja("string"),bundle:ja("string")};class bj extends ly{data(e={}){return super.data(e)}}class k1{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Y5(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new bj(this._firestore,this._userDataWriter,n.key,n,new Y5(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Sr(Vt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((l=>{const c=new bj(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Y5(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((l=>a||l.type!==3)).map((l=>{const c=new bj(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Y5(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:ewe(l.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Sr(Vt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=k1._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wZ.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ewe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $r(61501,{type:t})}}k1._jsonSchemaVersion="firestore/querySnapshot/1.0",k1._jsonSchema={type:ja("string",k1._jsonSchemaVersion),bundleSource:ja("string","QuerySnapshot"),bundleName:ja("string"),bundle:ja("string")};(function(e,r=!0){Rbe(gg),Fm(new cp("firestore",((n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new Kee(new Fbe(n.getProvider("auth-internal")),new zbe(o,n.getProvider("app-check-internal")),Ive(o,s),o);return a={useFetchStreams:r,...a},l._setSettings(a),l}),"PUBLIC").setMultipleInstances(!0)),rh(E$,A$,e),rh(E$,A$,"esm2020")})();const Jee="firebasestorage.googleapis.com",twe="storageBucket",rwe=120*1e3,nwe=600*1e3;class vh extends bh{constructor(e,r,n=0){super(rE(e),`Firebase Storage: ${r} (${rE(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vh.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var uh;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(uh||(uh={}));function rE(t){return"storage/"+t}function swe(){const t="An unknown error occurred, please check the error payload for server response.";return new vh(uh.UNKNOWN,t)}function iwe(){return new vh(uh.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function awe(){return new vh(uh.CANCELED,"User canceled the upload/download.")}function owe(t){return new vh(uh.INVALID_URL,"Invalid URL '"+t+"'.")}function lwe(t){return new vh(uh.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function T$(t){return new vh(uh.INVALID_ARGUMENT,t)}function Zee(){return new vh(uh.APP_DELETED,"The Firebase app was deleted.")}function cwe(t){return new vh(uh.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class nd{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=nd.makeFromUrl(e,r)}catch{return new nd(e,"")}if(n.path==="")return n;throw lwe(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const h="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),y={bucket:1,path:3},v=r===Jee?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",N=new RegExp(`^https?://${v}/${s}/${w}`,"i"),C=[{regex:l,indices:c,postModify:a},{regex:g,indices:y,postModify:u},{regex:N,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<C.length;I++){const O=C[I],L=O.regex.exec(e);if(L){const _=L[O.indices.bucket];let E=L[O.indices.path];E||(E=""),n=new nd(_,E),O.postModify(n);break}}if(n==null)throw owe(e);return n}}class uwe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function dwe(t,e,r){let n=1,s=null,a=null,o=!1,l=0;function c(){return l===2}let u=!1;function h(...w){u||(u=!0,e.apply(null,w))}function f(w){s=setTimeout(()=>{s=null,t(g,c())},w)}function m(){a&&clearTimeout(a)}function g(w,...N){if(u){m();return}if(w){m(),h.call(null,w,...N);return}if(c()||o){m(),h.call(null,w,...N);return}n<64&&(n*=2);let C;l===1?(l=2,C=0):C=(n+Math.random())*1e3,f(C)}let y=!1;function v(w){y||(y=!0,m(),!u&&(s!==null?(w||(l=2),clearTimeout(s),f(0)):w||(l=1)))}return f(0),a=setTimeout(()=>{o=!0,v(!0)},r),v}function hwe(t){t(!1)}function fwe(t){return t!==void 0}function I$(t,e,r,n){if(n<e)throw T$(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw T$(`Invalid value for '${t}'. Expected ${r} or less.`)}function pwe(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var _4;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(_4||(_4={}));function mwe(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||s||a}class gwe{constructor(e,r,n,s,a,o,l,c,u,h,f,m=!0,g=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,v)=>{this.resolve_=y,this.reject_=v,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new X5(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const l=a.getErrorCode()===_4.NO_ERROR,c=a.getStatus();if(!l||mwe(c,this.additionalRetryCodes_)&&this.retry){const h=a.getErrorCode()===_4.ABORT;n(!1,new X5(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new X5(u,a))})},r=(n,s)=>{const a=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());fwe(c)?a(c):a()}catch(c){o(c)}else if(l!==null){const c=swe();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?Zee():awe();o(c)}else{const c=iwe();o(c)}};this.canceled_?r(!1,new X5(!1,null,!0)):this.backoffId_=dwe(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&hwe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class X5{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function xwe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function ywe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function bwe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function vwe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function wwe(t,e,r,n,s,a,o=!0,l=!1){const c=pwe(t.urlParams),u=t.url+c,h=Object.assign({},t.headers);return bwe(h,e),xwe(h,r),ywe(h,a),vwe(h,n),new gwe(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}function Nwe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function jwe(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class S4{constructor(e,r){this._service=e,r instanceof nd?this._location=r:this._location=nd.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new S4(e,r)}get root(){const e=new nd(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return jwe(this._location.path)}get storage(){return this._service}get parent(){const e=Nwe(this._location.path);if(e===null)return null;const r=new nd(this._location.bucket,e);return new S4(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw cwe(e)}}function P$(t,e){const r=e?.[twe];return r==null?null:nd.makeFromBucketSpec(r,t)}function kwe(t,e,r,n={}){t.host=`${e}:${r}`;const s=mg(e);s&&(jL(`https://${t.host}/b`),kL("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:kJ(a,t.app.options.projectId))}class _we{constructor(e,r,n,s,a,o=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=o,this._bucket=null,this._host=Jee,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rwe,this._maxUploadRetryTime=nwe,this._requests=new Set,s!=null?this._bucket=nd.makeFromBucketSpec(s,this._host):this._bucket=P$(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=nd.makeFromBucketSpec(this._url,e):this._bucket=P$(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){I$("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){I$("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(sc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new S4(this,e)}_makeRequest(e,r,n,s,a=!0){if(this._deleted)return new uwe(Zee());{const o=wwe(e,this._appId,n,s,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const L$="@firebase/storage",O$="0.14.0";const ete="storage";function Swe(t=CL(),e){t=_u(t);const n=c_(t,ete).getImmediate({identifier:e}),s=wJ("storage");return s&&Cwe(n,...s),n}function Cwe(t,e,r,n={}){kwe(t,e,r,n)}function Ewe(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new _we(r,n,s,e,gg)}function Awe(){Fm(new cp(ete,Ewe,"PUBLIC").setMultipleInstances(!0)),rh(L$,O$,""),rh(L$,O$,"esm2020")}Awe();const Twe={apiKey:"AIzaSyAdqbFNjrB6y-8BrMEYYCT5ywiCgZVtMaE",authDomain:"mtglibrary-70b46.firebaseapp.com",projectId:"mtglibrary-70b46",storageBucket:"mtglibrary-70b46.firebasestorage.app",messagingSenderId:"602862103839",appId:"1:602862103839:web:23c64b7486c058c903d42a",measurementId:"G-EWELJJQ631"},cO=IJ(Twe),qd=Pbe(cO),Iwe=G2e(cO);Y2e(Iwe).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):t.code=="unimplemented"&&console.warn("Firestore persistence not supported in this browser")});Swe(cO);var db=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Pwe={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Lwe=class{#e=Pwe;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},of=new Lwe;function Owe(t){setTimeout(t,0)}var Gm=typeof window>"u"||"Deno"in globalThis;function Ua(){}function Mwe(t,e){return typeof t=="function"?t(e):t}function vI(t){return typeof t=="number"&&t>=0&&t!==1/0}function tte(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ep(t,e){return typeof t=="function"?t(e):t}function au(t,e){return typeof t=="function"?t(e):t}function M$(t,e){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:o,stale:l}=t;if(o){if(n){if(e.queryHash!==uO(o,e.options))return!1}else if(!r2(e.queryKey,o))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||a&&!a(e))}function R$(t,e){const{exact:r,status:n,predicate:s,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(r){if(Km(e.options.mutationKey)!==Km(a))return!1}else if(!r2(e.options.mutationKey,a))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function uO(t,e){return(e?.queryKeyHashFn||Km)(t)}function Km(t){return JSON.stringify(t,(e,r)=>wI(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function r2(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>r2(t[r],e[r])):!1}var Rwe=Object.prototype.hasOwnProperty;function rte(t,e,r=0){if(t===e)return t;if(r>500)return e;const n=D$(t)&&D$(e);if(!n&&!(wI(t)&&wI(e)))return e;const a=(n?t:Object.keys(t)).length,o=n?e:Object.keys(e),l=o.length,c=n?new Array(l):{};let u=0;for(let h=0;h<l;h++){const f=n?h:o[h],m=t[f],g=e[f];if(m===g){c[f]=m,(n?h<a:Rwe.call(t,f))&&u++;continue}if(m===null||g===null||typeof m!="object"||typeof g!="object"){c[f]=g;continue}const y=rte(m,g,r+1);c[f]=y,y===m&&u++}return a===l&&u===a?t:c}function C4(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function D$(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function wI(t){if(!B$(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!B$(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function B$(t){return Object.prototype.toString.call(t)==="[object Object]"}function Dwe(t){return new Promise(e=>{of.setTimeout(e,t)})}function NI(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?rte(t,e):e}function Bwe(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function Fwe(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var dO=Symbol();function nte(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===dO?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function hO(t,e){return typeof t=="function"?t(...e):!!t}function $we(t,e,r){let n=!1,s;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(s??=e(),n||(n=!0,s.aborted?r():s.addEventListener("abort",r,{once:!0})),s)}),t}var Uwe=class extends db{#e;#t;#r;constructor(){super(),this.#r=t=>{if(!Gm&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},fO=new Uwe;function jI(){let t,e;const r=new Promise((s,a)=>{t=s,e=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),t(s)},r.reject=s=>{n({status:"rejected",reason:s}),e(s)},r}function zwe(t){let e;if(t.then(r=>(e=r,r),Ua)?.catch(Ua),e!==void 0)return{data:e}}function ste(t){return t}function Vwe(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function qwe(t,e,r){const n=()=>{const s=t.promise?.then(e).catch(a=>r(a)?Promise.reject(new Error("redacted")):Promise.reject(a));return s?.catch(Ua),s};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:n()},...t.meta&&{meta:t.meta}}}function Hwe(t){return t.state.isPaused}function Wwe(t){return t.state.status==="success"}function Gwe(t){return!0}function Kwe(t,e={}){const r=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??Hwe,n=t.getMutationCache().getAll().flatMap(c=>r(c)?[Vwe(c)]:[]),s=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??Wwe,a=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??Gwe,o=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??ste,l=t.getQueryCache().getAll().flatMap(c=>s(c)?[qwe(c,o,a)]:[]);return{mutations:n,queries:l}}function Ywe(t,e,r){if(typeof e!="object"||e===null)return;const n=t.getMutationCache(),s=t.getQueryCache(),a=r?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??ste,o=e.mutations||[],l=e.queries||[];o.forEach(({state:c,...u})=>{n.build(t,{...t.getDefaultOptions().hydrate?.mutations,...r?.defaultOptions?.mutations,...u},c)}),l.forEach(({queryKey:c,state:u,queryHash:h,meta:f,promise:m,dehydratedAt:g})=>{const y=m?zwe(m):void 0,v=u.data===void 0?y?.data:u.data,w=v===void 0?v:a(v);let N=s.get(h);const k=N?.state.status==="pending",C=N?.state.fetchStatus==="fetching";if(N){const I=y&&g!==void 0&&g>N.state.dataUpdatedAt;if(u.dataUpdatedAt>N.state.dataUpdatedAt||I){const{fetchStatus:O,...L}=u;N.setState({...L,data:w})}}else N=s.build(t,{...t.getDefaultOptions().hydrate?.queries,...r?.defaultOptions?.queries,queryKey:c,queryHash:h,meta:f},{...u,data:w,fetchStatus:"idle",status:w!==void 0?"success":u.status});m&&!k&&!C&&(g===void 0||g>N.state.dataUpdatedAt)&&N.fetch(void 0,{initialPromise:Promise.resolve(m).then(a)}).catch(Ua)})}var Xwe=Owe;function Qwe(){let t=[],e=0,r=l=>{l()},n=l=>{l()},s=Xwe;const a=l=>{e?t.push(l):s(()=>{r(l)})},o=()=>{const l=t;t=[],l.length&&s(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||o()}return c},batchCalls:l=>(...c)=>{a(()=>{l(...c)})},schedule:a,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var Ga=Qwe(),Jwe=class extends db{#e=!0;#t;#r;constructor(){super(),this.#r=t=>{if(!Gm&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},E4=new Jwe;function Zwe(t){return Math.min(1e3*2**t,3e4)}function ite(t){return(t??"online")==="online"?E4.isOnline():!0}var kI=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function ate(t){let e=!1,r=0,n;const s=jI(),a=()=>s.status!=="pending",o=v=>{if(!a()){const w=new kI(v);m(w),t.onCancel?.(w)}},l=()=>{e=!0},c=()=>{e=!1},u=()=>fO.isFocused()&&(t.networkMode==="always"||E4.isOnline())&&t.canRun(),h=()=>ite(t.networkMode)&&t.canRun(),f=v=>{a()||(n?.(),s.resolve(v))},m=v=>{a()||(n?.(),s.reject(v))},g=()=>new Promise(v=>{n=w=>{(a()||u())&&v(w)},t.onPause?.()}).then(()=>{n=void 0,a()||t.onContinue?.()}),y=()=>{if(a())return;let v;const w=r===0?t.initialPromise:void 0;try{v=w??t.fn()}catch(N){v=Promise.reject(N)}Promise.resolve(v).then(f).catch(N=>{if(a())return;const k=t.retry??(Gm?0:3),C=t.retryDelay??Zwe,I=typeof C=="function"?C(r,N):C,O=k===!0||typeof k=="number"&&r<k||typeof k=="function"&&k(r,N);if(e||!O){m(N);return}r++,t.onFail?.(r,N),Dwe(I).then(()=>u()?void 0:g()).then(()=>{e?m(N):y()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(n?.(),s),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?y():g().then(y),s)}}var ote=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),vI(this.gcTime)&&(this.#e=of.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Gm?1/0:300*1e3))}clearGcTimeout(){this.#e&&(of.clearTimeout(this.#e),this.#e=void 0)}},e5e=class extends ote{#e;#t;#r;#s;#n;#a;#o;constructor(t){super(),this.#o=!1,this.#a=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#s=t.client,this.#r=this.#s.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=$$(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(t){if(this.options={...this.#a,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=$$(this.options);e.data!==void 0&&(this.setState(F$(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(t,e){const r=NI(this.state.data,t,this.options);return this.#i({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#i({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#n?.promise;return this.#n?.cancel(t),e?e.then(Ua).catch(Ua):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>au(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dO||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ep(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!tte(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#n&&(this.#o?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(c=>c.options.queryFn);l&&this.setOptions(l.options)}const r=new AbortController,n=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#o=!0,r.signal)})},s=()=>{const l=nte(this.options,e),u=(()=>{const h={client:this.#s,queryKey:this.queryKey,meta:this.meta};return n(h),h})();return this.#o=!1,this.options.persister?this.options.persister(l,u,this):l(u)},o=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:s};return n(l),l})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=ate({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof kI&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(l,c)=>{this.#i({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#n.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#r.config.onSuccess?.(l,this),this.#r.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof kI){if(l.silent)return this.#n.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#i({type:"error",error:l}),this.#r.config.onError?.(l,this),this.#r.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#i(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...lte(r.data,this.options),fetchMeta:t.meta??null};case"success":const n={...r,...F$(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?n:void 0,n;case"error":const s=t.error;return{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),Ga.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:t})})}};function lte(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ite(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function F$(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function $$(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var t5e=class extends db{constructor(t,e){super(),this.options=e,this.#e=t,this.#i=null,this.#o=jI(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#r=void 0;#s=void 0;#n;#a;#o;#i;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),U$(this.#t,this.options)?this.#d():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return _I(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return _I(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof au(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#N(),this.#t.setOptions(this.options),e._defaulted&&!C4(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const n=this.hasListeners();n&&z$(this.#t,r,this.options,e)&&this.#d(),this.updateResult(),n&&(this.#t!==r||au(this.options.enabled,this.#t)!==au(e.enabled,this.#t)||ep(this.options.staleTime,this.#t)!==ep(e.staleTime,this.#t))&&this.#g();const s=this.#x();n&&(this.#t!==r||au(this.options.enabled,this.#t)!==au(e.enabled,this.#t)||s!==this.#l)&&this.#y(s)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(e,t);return n5e(this,r)&&(this.#s=r,this.#a=this.options,this.#n=this.#t.state),r}getCurrentResult(){return this.#s}trackResult(t,e){return new Proxy(t,{get:(r,n)=>(this.trackProp(n),e?.(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,n))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#d(t){this.#N();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Ua)),e}#g(){this.#v();const t=ep(this.options.staleTime,this.#t);if(Gm||this.#s.isStale||!vI(t))return;const r=tte(this.#s.dataUpdatedAt,t)+1;this.#c=of.setTimeout(()=>{this.#s.isStale||this.updateResult()},r)}#x(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(t){this.#w(),this.#l=t,!(Gm||au(this.options.enabled,this.#t)===!1||!vI(this.#l)||this.#l===0)&&(this.#u=of.setInterval(()=>{(this.options.refetchIntervalInBackground||fO.isFocused())&&this.#d()},this.#l))}#b(){this.#g(),this.#y(this.#x())}#v(){this.#c&&(of.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(of.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const r=this.#t,n=this.options,s=this.#s,a=this.#n,o=this.#a,c=t!==r?t.state:this.#r,{state:u}=t;let h={...u},f=!1,m;if(e._optimisticResults){const E=this.hasListeners(),M=!E&&U$(t,e),B=E&&z$(t,r,e,n);(M||B)&&(h={...h,...lte(u.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:v}=h;m=h.data;let w=!1;if(e.placeholderData!==void 0&&m===void 0&&v==="pending"){let E;s?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(E=s.data,w=!0):E=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,E!==void 0&&(v="success",m=NI(s?.data,E,e),f=!0)}if(e.select&&m!==void 0&&!w)if(s&&m===a?.data&&e.select===this.#m)m=this.#h;else try{this.#m=e.select,m=e.select(m),m=NI(s?.data,m,e),this.#h=m,this.#i=null}catch(E){this.#i=E}this.#i&&(g=this.#i,m=this.#h,y=Date.now(),v="error");const N=h.fetchStatus==="fetching",k=v==="pending",C=v==="error",I=k&&N,O=m!==void 0,_={status:v,fetchStatus:h.fetchStatus,isPending:k,isSuccess:v==="success",isError:C,isInitialLoading:I,isLoading:I,data:m,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:N,isRefetching:N&&!k,isLoadingError:C&&!O,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:C&&O,isStale:pO(t,e),refetch:this.refetch,promise:this.#o,isEnabled:au(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const E=_.data!==void 0,M=_.status==="error"&&!E,B=R=>{M?R.reject(_.error):E&&R.resolve(_.data)},S=()=>{const R=this.#o=_.promise=jI();B(R)},P=this.#o;switch(P.status){case"pending":t.queryHash===r.queryHash&&B(P);break;case"fulfilled":(M||_.data!==P.value)&&S();break;case"rejected":(!M||_.error!==P.reason)&&S();break}}return _}updateResult(){const t=this.#s,e=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#a=this.options,this.#n.data!==void 0&&(this.#f=this.#t),C4(e,t))return;this.#s=e;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,s=typeof n=="function"?n():n;if(s==="all"||!s&&!this.#p.size)return!0;const a=new Set(s??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#s).some(o=>{const l=o;return this.#s[l]!==t[l]&&a.has(l)})};this.#j({listeners:r()})}#N(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#r=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#j(t){Ga.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function r5e(t,e){return au(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function U$(t,e){return r5e(t,e)||t.state.data!==void 0&&_I(t,e,e.refetchOnMount)}function _I(t,e,r){if(au(e.enabled,t)!==!1&&ep(e.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&pO(t,e)}return!1}function z$(t,e,r,n){return(t!==e||au(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&pO(t,r)}function pO(t,e){return au(e.enabled,t)!==!1&&t.isStaleByTime(ep(e.staleTime,t))}function n5e(t,e){return!C4(t.getCurrentResult(),e)}function V$(t){return{onFetch:(e,r)=>{const n=e.options,s=e.fetchOptions?.meta?.fetchMore?.direction,a=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let h=!1;const f=y=>{$we(y,()=>e.signal,()=>h=!0)},m=nte(e.options,e.fetchOptions),g=async(y,v,w)=>{if(h)return Promise.reject();if(v==null&&y.pages.length)return Promise.resolve(y);const k=(()=>{const L={client:e.client,queryKey:e.queryKey,pageParam:v,direction:w?"backward":"forward",meta:e.options.meta};return f(L),L})(),C=await m(k),{maxPages:I}=e.options,O=w?Fwe:Bwe;return{pages:O(y.pages,C,I),pageParams:O(y.pageParams,v,I)}};if(s&&a.length){const y=s==="backward",v=y?s5e:q$,w={pages:a,pageParams:o},N=v(n,w);l=await g(w,N,y)}else{const y=t??a.length;do{const v=c===0?o[0]??n.initialPageParam:q$(n,l);if(c>0&&v==null)break;l=await g(l,v),c++}while(c<y)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=u}}}function q$(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function s5e(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var i5e=class extends ote{#e;#t;#r;#s;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#r=t.mutationCache,this.#t=[],this.state=t.state||cte(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#n({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=ate({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(a,o)=>{this.#n({type:"failed",failureCount:a,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const n=this.state.status==="pending",s=!this.#s.canStart();try{if(n)e();else{this.#n({type:"pending",variables:t,isPaused:s}),this.#r.config.onMutate&&await this.#r.config.onMutate(t,this,r);const o=await this.options.onMutate?.(t,r);o!==this.state.context&&this.#n({type:"pending",context:o,variables:t,isPaused:s})}const a=await this.#s.start();return await this.#r.config.onSuccess?.(a,t,this.state.context,this,r),await this.options.onSuccess?.(a,t,this.state.context,r),await this.#r.config.onSettled?.(a,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(a,null,t,this.state.context,r),this.#n({type:"success",data:a}),a}catch(a){try{await this.#r.config.onError?.(a,t,this.state.context,this,r)}catch(o){Promise.reject(o)}try{await this.options.onError?.(a,t,this.state.context,r)}catch(o){Promise.reject(o)}try{await this.#r.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,r)}catch(o){Promise.reject(o)}try{await this.options.onSettled?.(void 0,a,t,this.state.context,r)}catch(o){Promise.reject(o)}throw this.#n({type:"error",error:a}),a}finally{this.#r.runNext(this)}}#n(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Ga.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(t)}),this.#r.notify({mutation:this,type:"updated",action:t})})}};function cte(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var a5e=class extends db{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(t,e,r){const n=new i5e({client:t,mutationCache:this,mutationId:++this.#r,options:t.defaultMutationOptions(e),state:r});return this.add(n),n}add(t){this.#e.add(t);const e=Q5(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Q5(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const n=r.indexOf(t);n!==-1&&r.splice(n,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Q5(t);if(typeof e=="string"){const n=this.#t.get(e)?.find(s=>s.state.status==="pending");return!n||n===t}else return!0}runNext(t){const e=Q5(t);return typeof e=="string"?this.#t.get(e)?.find(n=>n!==t&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ga.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>R$(e,r))}findAll(t={}){return this.getAll().filter(e=>R$(t,e))}notify(t){Ga.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Ga.batch(()=>Promise.all(t.map(e=>e.continue().catch(Ua))))}};function Q5(t){return t.options.scope?.id}var o5e=class extends db{#e;#t=void 0;#r;#s;constructor(e,r){super(),this.#e=e,this.setOptions(r),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#e.defaultMutationOptions(e),C4(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),r?.mutationKey&&this.options.mutationKey&&Km(r.mutationKey)!==Km(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#a()}mutate(e,r){return this.#s=r,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#n(){const e=this.#r?.state??cte();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Ga.batch(()=>{if(this.#s&&this.hasListeners()){const r=this.#t.variables,n=this.#t.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#s.onSuccess?.(e.data,r,n,s)}catch(a){Promise.reject(a)}try{this.#s.onSettled?.(e.data,null,r,n,s)}catch(a){Promise.reject(a)}}else if(e?.type==="error"){try{this.#s.onError?.(e.error,r,n,s)}catch(a){Promise.reject(a)}try{this.#s.onSettled?.(void 0,e.error,r,n,s)}catch(a){Promise.reject(a)}}}this.listeners.forEach(r=>{r(this.#t)})})}},l5e=class extends db{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const n=e.queryKey,s=e.queryHash??uO(n,e);let a=this.get(s);return a||(a=new e5e({client:t,queryKey:n,queryHash:s,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(n)}),this.add(a)),a}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ga.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>M$(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>M$(t,r)):e}notify(t){Ga.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Ga.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ga.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},c5e=class{#e;#t;#r;#s;#n;#a;#o;#i;constructor(t={}){this.#e=t.queryCache||new l5e,this.#t=t.mutationCache||new a5e,this.#r=t.defaultOptions||{},this.#s=new Map,this.#n=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=fO.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=E4.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(ep(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),a=this.#e.get(n.queryHash)?.state.data,o=Mwe(e,a);if(o!==void 0)return this.#e.build(this,n).setData(o,{...r,manual:!0})}setQueriesData(t,e,r){return Ga.batch(()=>this.#e.findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Ga.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return Ga.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=Ga.batch(()=>this.#e.findAll(t).map(s=>s.cancel(r)));return Promise.all(n).then(Ua).catch(Ua)}invalidateQueries(t,e={}){return Ga.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=Ga.batch(()=>this.#e.findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(Ua)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(Ua)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(ep(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ua).catch(Ua)}fetchInfiniteQuery(t){return t.behavior=V$(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ua).catch(Ua)}ensureInfiniteQueryData(t){return t.behavior=V$(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return E4.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(t){this.#r=t}setQueryDefaults(t,e){this.#s.set(Km(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#s.values()],r={};return e.forEach(n=>{r2(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){this.#n.set(Km(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#n.values()],r={};return e.forEach(n=>{r2(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#r.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=uO(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===dO&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#r.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},ute=b.createContext(void 0),yg=t=>{const e=b.useContext(ute);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},u5e=({client:t,children:e})=>(b.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),i.jsx(ute.Provider,{value:t,children:e})),dte=b.createContext(!1),d5e=()=>b.useContext(dte),h5e=dte.Provider;function f5e(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var p5e=b.createContext(f5e()),m5e=()=>b.useContext(p5e),g5e=(t,e,r)=>{const n=r?.state.error&&typeof t.throwOnError=="function"?hO(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||n)&&(e.isReset()||(t.retryOnMount=!1))},x5e=t=>{b.useEffect(()=>{t.clearReset()},[t])},y5e=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:s})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(s&&t.data===void 0||hO(r,[t.error,n])),b5e=t=>{if(t.suspense){const r=s=>s==="static"?s:Math.max(s??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...s)=>r(n(...s)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},v5e=(t,e)=>t.isLoading&&t.isFetching&&!e,w5e=(t,e)=>t?.suspense&&e.isPending,H$=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function N5e(t,e,r){const n=d5e(),s=m5e(),a=yg(),o=a.defaultQueryOptions(t);a.getDefaultOptions().queries?._experimental_beforeQuery?.(o);const l=a.getQueryCache().get(o.queryHash);o._optimisticResults=n?"isRestoring":"optimistic",b5e(o),g5e(o,s,l),x5e(s);const c=!a.getQueryCache().get(o.queryHash),[u]=b.useState(()=>new e(a,o)),h=u.getOptimisticResult(o),f=!n&&t.subscribed!==!1;if(b.useSyncExternalStore(b.useCallback(m=>{const g=f?u.subscribe(Ga.batchCalls(m)):Ua;return u.updateResult(),g},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),b.useEffect(()=>{u.setOptions(o)},[o,u]),w5e(o,h))throw H$(o,u,s);if(y5e({result:h,errorResetBoundary:s,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw h.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(o,h),o.experimental_prefetchInRender&&!Gm&&v5e(h,n)&&(c?H$(o,u,s):l?.promise)?.catch(Ua).finally(()=>{u.updateResult()}),o.notifyOnChangeProps?h:u.trackResult(h)}function iw(t,e){return N5e(t,t5e)}function SI(t,e){const r=yg(),[n]=b.useState(()=>new o5e(r,t));b.useEffect(()=>{n.setOptions(t)},[n,t]);const s=b.useSyncExternalStore(b.useCallback(o=>n.subscribe(Ga.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=b.useCallback((o,l)=>{n.mutate(o,l).catch(Ua)},[n]);if(s.error&&hO(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:a,mutateAsync:s.mutate}}const j5e="";async function k5e(){const t={"Content-Type":"application/json"};if(qd.currentUser){const r=await qd.currentUser.getIdToken();t.Authorization=`Bearer ${r}`}else console.warn("[API] No currentUser found, sending request without auth.");const e=localStorage.getItem("mtg_forge_ref");return e&&(t["X-Referral-Code"]=e),t}let CI=null;const W$=t=>{CI=t};async function an(t,e,r=null,n={}){let s=`${j5e}${e}`;if(!navigator.onLine)throw new Error("Network Error: Device is offline");const a=new URL(s,window.location.origin);Object.keys(n).forEach(u=>{n[u]!==null&&n[u]!==void 0&&a.searchParams.append(u,n[u])});const o={method:t,headers:await k5e()};r&&(o.body=JSON.stringify(r));const l=await fetch(a,o);if(!l.ok){let u=l.statusText,h=null,f=null;try{f=await l.json(),f.error&&(u=f.error),f.code&&(h=f.code)}catch{}l.status===403&&h==="LIMIT_REACHED"&&CI&&CI(`Subscription Limit Reached: ${u}`,"error",5e3);const m=new Error(`API Error (${l.status}): ${u}`);throw m.response={status:l.status,data:f},m.code=h,m}if(l.status===204)return null;const c=await l.text();if(!c)return{};try{if(c.trim().toLowerCase().startsWith("<!doctype html")||c.trim().toLowerCase().startsWith("<html"))throw new Error("Received HTML response from API (likely 404 or SPA fallback)");return JSON.parse(c)}catch(u){throw console.warn(`[API] Failed to parse response from ${e}:`,u.message),new Error("Invalid JSON response from API")}}const He={get:(t,e)=>an("GET",t,null,e),post:(t,e)=>an("POST",t,e),put:(t,e)=>an("PUT",t,e),delete:(t,e)=>an("DELETE",t,e),batchAddToCollection:(t,e="merge",r=null)=>an("POST","/api/collection/batch",{cards:t,mode:e,targetUserId:r}),batchDeleteCollection:t=>an("DELETE","/api/collection/batch",{ids:t}),batchAddCardsToDeck:(t,e)=>an("POST",`/api/decks/${t}/cards/batch`,{cards:e}),getBugs:()=>an("GET","/bugs").then(t=>t.content),updateUser:(t,e)=>an("PUT",`/api/users/${t}`,e),getBinders:()=>an("GET","/api/binders"),getBinderCards:t=>an("GET",`/api/binders/${t}/cards`),createBinder:t=>an("POST","/api/binders",t),updateBinder:(t,e)=>an("PUT",`/api/binders/${t}`,e),deleteBinder:t=>an("DELETE",`/api/binders/${t}`),getEpics:()=>an("GET","/api/epics"),createEpic:t=>an("POST","/api/epics",t),updateEpic:(t,e)=>an("PUT",`/api/epics/${t}`,e),reorderEpics:t=>an("PUT","/api/epics/reorder/batch",{order:t}),deleteEpic:t=>an("DELETE",`/api/epics/${t}`),getTickets:t=>an("GET","/api/tickets",null,t),getTicketReport:t=>an("GET","/api/tickets/report",null,t),createTicket:t=>an("POST","/api/tickets",t),updateTicket:(t,e)=>an("PUT",`/api/tickets/${t}`,e),deleteTicket:t=>an("DELETE",`/api/tickets/${t}`),voteTicket:t=>an("POST",`/api/tickets/${t}/vote`),getAssignees:()=>an("GET","/api/tickets/meta/assignees"),getTicketNotes:t=>an("GET",`/api/tickets/${t}/notes`),addTicketNote:(t,e)=>an("POST",`/api/tickets/${t}/notes`,{note:e}),updateUserPermissions:(t,e,r,n={})=>an("PUT",`/api/users/${t}/permissions`,{permissions:e,isAdmin:r,...n}),getUsers:()=>an("GET","/api/users"),getReleases:()=>an("GET","/api/releases"),publishRelease:t=>an("POST","/api/releases",t),checkPreconOwnership:t=>an("POST",`/api/precons/${t}/check-ownership`),createPreconDeck:(t,e={})=>an("POST",`/api/precons/${t}/create`,e),getActiveAudit:()=>an("GET","/api/audit/active"),startAudit:t=>an("POST","/api/audit/start",t),getAuditItems:(t,e)=>an("GET",`/api/audit/${t}/items`,null,e),updateAuditItem:(t,e,r,n=null)=>{const s={quantity:r};return n!==null&&(s.reviewed=n),an("PUT",`/api/audit/${t}/item/${e}`,s)},swapFoilAuditItem:(t,e)=>an("POST",`/api/audit/${t}/item/${e}/swap-foil`),addAuditItem:(t,e)=>an("POST",`/api/audit/${t}/items/add`,e),cancelAudit:t=>an("POST",`/api/audit/${t}/cancel`),finalizeAudit:t=>an("POST",`/api/audit/${t}/finalize`),reviewAuditSection:(t,e)=>an("POST",`/api/audit/${t}/section/review`,e),batchUpdateAuditItems:(t,e)=>an("POST",`/api/audit/${t}/items/batch-update`,{updates:e})},hte=b.createContext(),Cr=()=>b.useContext(hte),_5e=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState(!0),a=yg(),{data:o=null,refetch:l,isLoading:c}=iw({queryKey:["userProfile",e?.uid],queryFn:async()=>e?(console.log("[AuthContext] Fetching user profile..."),await He.get("/api/users/me")):null,enabled:!!e,staleTime:1e3*10}),u=async(I,O,L={})=>{const _=await mye(qd,I,O),E=localStorage.getItem("mtg_forge_ref"),M={...L};if(E&&(console.log("[AuthContext] Applying referral code:",E),M.referral_code=E),Object.keys(M).length>0)try{await l();const B=await He.get("/api/users/me");B?.id&&(await He.updateUser(B.id,M),a.invalidateQueries(["userProfile",_.user.uid]),E&&localStorage.removeItem("mtg_forge_ref"))}catch(B){console.error("Failed to save profile data during signup",B)}return _},h=(I,O)=>gye(qd,I,O),f=()=>{const I=new Jh;return Uye(qd,I)},m=async()=>(a.setQueryData(["userProfile",e?.uid],null),a.removeQueries(["userProfile"]),wye(qd)),g=I=>pye(qd,I),y=()=>{if(!qd.currentUser)throw new Error("No user logged in");return xye(qd.currentUser)},v=SI({mutationFn:async({id:I,data:O})=>await He.updateUser(I,O),onSuccess:I=>{a.invalidateQueries(["userProfile",e?.uid])}}),w=async I=>{if(!o?.id)throw new Error("User profile not ready");await v.mutateAsync({id:o.id,data:I})},N=async I=>{if(!o?.id)return;const O={...o.settings||{},...I};a.setQueryData(["userProfile",e?.uid],L=>L&&{...L,settings:O});try{await v.mutateAsync({id:o.id,data:{settings:O}})}catch(L){console.error("Failed to update settings:",L),a.invalidateQueries(["userProfile",e?.uid])}},k=async I=>{if(!e)throw new Error("No user logged in");if(!I.type.startsWith("image/"))throw new Error("File must be an image.");if(I.size>10*1024*1024)throw new Error("File size must be under 10MB.");const O=new FileReader,_=await new Promise((E,M)=>{O.onload=()=>E(O.result),O.onerror=M,O.readAsDataURL(I)});if(!o?.id)throw new Error("User profile not ready");return await v.mutateAsync({id:o.id,data:{photo_url:_}}),_};b.useEffect(()=>vye(qd,O=>{r(O),s(!1)}),[]);const C={currentUser:e,user:e,userProfile:o,loading:n||!!e&&c,refreshUserProfile:l,updateSettings:N,signup:u,login:h,loginWithGoogle:f,logout:m,resetPassword:g,sendVerification:y,updateProfileFields:w,uploadProfilePicture:k};return i.jsx(hte.Provider,{value:C,children:!n&&(!e||!c)&&t})};function S5e(){const[t,e]=b.useState([]),[r,n]=b.useState(!1),[s,a]=b.useState(null),o=b.useCallback(async(c,u={})=>{const{set:h,cn:f,...m}=u,g=(c||"").trim();if(!(h||f||Object.keys(m).length>0)&&(!g||g.length<2)){e([]);return}n(!0),a(null);try{const v=await He.post("/api/cards/search",{query:g,set:h,cn:f,...m});e(v.data||[])}catch(v){console.error(v),a(v.message),e([])}finally{n(!1)}},[]),l=b.useCallback(async c=>{if(!c||c.trim().length<2)return[];try{return(await He.get("/api/cards/autocomplete",{q:c})).data||[]}catch(u){return console.error("[useScryfall] Autocomplete error:",u),[]}},[]);return{results:t,loading:r,error:s,searchCards:o,getSuggestions:l,setResults:e}}const fte=b.createContext();function Tn(){return b.useContext(fte)}function C5e({children:t}){const[e,r]=b.useState([]),n=b.useCallback((a,o="info",l=3e3,c=null)=>{const u=Date.now();r(h=>[...h,{id:u,message:a,type:o,action:c}]),l>0&&setTimeout(()=>{r(h=>h.filter(f=>f.id!==u))},l)},[]),s=b.useCallback(a=>{r(o=>o.filter(l=>l.id!==a))},[]);return i.jsxs(fte.Provider,{value:{addToast:n},children:[t,Kn.createPortal(i.jsx("div",{className:"fixed top-24 left-0 right-0 md:top-auto md:bottom-4 md:left-auto md:right-4 z-[99999] flex flex-col gap-2 pointer-events-none items-center md:items-end px-0 md:px-4",children:e.map(a=>i.jsxs("div",{className:`
                                shadow-2xl text-sm font-black transition-all transform animate-fade-in-down pointer-events-auto cursor-pointer
                                w-full h-auto min-h-[50px] text-center backdrop-blur-xl border-y border-white/10 flex items-center justify-center px-6 py-4
                                ${a.type==="success"?"bg-green-600/90 text-white":""}
                                ${a.type==="error"?"bg-red-600/90 text-white":""}
                                ${a.type==="info"?"bg-indigo-600/90 text-white shadow-indigo-500/30":""}
                                ${a.type==="warning"?"bg-yellow-500 text-black":""}
                                md:w-auto md:rounded-xl md:border md:text-left md:px-4 md:py-3 md:animate-fade-in-up md:min-h-0
                            `,onClick:()=>s(a.id),children:[a.message,a.action&&i.jsx("button",{onClick:o=>{o.stopPropagation(),a.action.onClick?.(),s(a.id)},className:"ml-3 px-2 py-0.5 bg-white/20 hover:bg-white/30 rounded text-xs font-bold uppercase tracking-wider transition-colors border border-white/10",children:a.action.label||"Action"})]},a.id))}),document.body)]})}function yo(t={}){const{wishlist:e,userId:r}=t,{currentUser:n}=Cr(),s=yg(),a=["collection",{wishlist:e,userId:r||n?.uid}],{data:o=[],isLoading:l,error:c,refetch:u}=iw({queryKey:a,queryFn:async()=>{if(!n)return[];const y=new URLSearchParams;return e!==void 0&&y.append("wishlist",e),r&&y.append("userId",r),(await He.get(`/api/collection?${y.toString()}`)).map(w=>({...w.data,...w,deckId:w.deck_id,quantity:w.count,firestoreId:w.firestore_id,id:w.id,scryfall_id:w.scryfall_id}))},enabled:!!n,staleTime:1e3*60*5}),h=SI({mutationFn:async y=>{await He.delete(`/api/collection/${y}`)},onSuccess:()=>{s.invalidateQueries({queryKey:a})}}),f=SI({mutationFn:async({id:y,data:v})=>{await He.put(`/api/collection/${y}`,v)},onSuccess:()=>{s.invalidateQueries({queryKey:a})}});return{cards:o,loading:l,error:c,refresh:u,removeCard:async y=>{try{await h.mutateAsync(y)}catch(v){throw console.error("Error removing card:",v),v}},updateCard:async(y,v)=>{try{await f.mutateAsync({id:y,data:v})}catch(w){throw console.error("Error updating card:",w),w}},setCards:y=>s.setQueryData(a,y)}}function yd(t=null){const{currentUser:e}=Cr();yg();const r=["decks",{userId:t||e?.uid}],{data:n=[],isLoading:s,error:a,refetch:o}=iw({queryKey:r,queryFn:async()=>e?await He.get("/api/decks",t?{userId:t}:{}):[],enabled:!!e,staleTime:1e3*60*5});return{decks:n,loading:s,error:a,refresh:o}}function E5e(t,e){const[r,n]=b.useState(t);return b.useEffect(()=>{const s=setTimeout(()=>{n(t)},e);return()=>{clearTimeout(s)}},[t,e]),r}const bl={async addCardToCollection(t,e,r=1,n,s=!1,a=null){return He.post("/api/collection",{scryfall_id:e.id,name:e.name,set_code:e.set||e.set_code,collector_number:e.collector_number,finish:n||e.finish||"nonfoil",count:r,data:e,deck_id:null,is_wishlist:s,targetUserId:a})},async updateCard(t,e){return He.put(`/api/collection/${t}`,e)},async removeCard(t){return He.delete(`/api/collection/${t}`)},async importBatch(t,e,r="merge",n=null){return He.post("/api/collection/batch",{cards:e,mode:r,decks:n})},async batchRemoveCards(t){return He.delete("/api/collection/batch/delete",{cardIds:t})}},Ka={fetchRelationships:async()=>He.get("/api/community/relationships"),sendRequest:async(t,e="pod")=>{const r=typeof t=="string"?{targetEmail:t,type:e}:{...t,type:e};return He.post("/api/community/relationships/request",r)},respondToRequest:async(t,e)=>He.put(`/api/community/relationships/${t}`,{status:e}),deleteRelationship:async t=>He.delete(`/api/community/relationships/${t}`),fetchPermissions:async(t=null)=>He.get(`/api/community/permissions${t?`?deckId=${t}`:""}`),fetchIncomingPermissions:async()=>He.get("/api/community/permissions?direction=incoming"),grantPermission:async(t,e,r=null)=>He.post("/api/community/permissions",{granteeId:t,permissionLevel:e,deckId:r}),revokePermission:async t=>He.delete(`/api/community/permissions/${t}`),updateDeckPublicStatus:async(t,e,r)=>He.put(`/api/decks/${t}`,{isPublic:e,shareSlug:r})},pte=b.createContext();function aw(){return b.useContext(pte)}function A5e({children:t}){const[e,r]=b.useState(null),[n,s]=b.useState(!1),a=b.useCallback(l=>{r(l),s(!0)},[]),o=b.useCallback(()=>{s(!1),setTimeout(()=>r(null),300)},[]);return i.jsx(pte.Provider,{value:{selectedCard:e,isOpen:n,openCardModal:a,closeCardModal:o},children:t})}const nE=({value:t,label:e,labelColor:r,textColor:n,onChange:s})=>{const[a,o]=b.useState(t);Ie.useEffect(()=>{o(t)},[t]),Ie.useEffect(()=>{const c=setTimeout(()=>{a!==t&&s(a)},3e3);return()=>clearTimeout(c)},[a,t,s]);const l=c=>{c<0&&(c=0),o(c)};return i.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-white/5 transition-colors group/sec",children:[i.jsx("button",{onClick:c=>{c.stopPropagation(),l(a+1)},className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 focus:outline-none",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),i.jsxs("div",{className:"flex flex-col items-center w-full px-2",children:[i.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:a===0?"":a,placeholder:"0",onClick:c=>c.stopPropagation(),onChange:c=>{const u=c.target.value;u===""?o(0):/^\d+$/.test(u)&&o(parseInt(u,10))},className:`w-full bg-transparent text-center text-lg font-black ${n} placeholder-gray-700 outline-none tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)] focus:scale-110 transition-transform`}),i.jsx("span",{className:`text-[8px] font-black uppercase ${r} tracking-[0.2em] -mt-1 pointer-events-none`,children:e})]}),i.jsx("button",{onClick:c=>{c.stopPropagation(),l(a-1)},className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 disabled:opacity-0 focus:outline-none",disabled:a<=0,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]})},mte=({card:t,normalCount:e=0,foilCount:r=0,wishlistCount:n=0,onUpdateCount:s,onUpdateWishlistCount:a,ownerName:o,currentUser:l,showOwnerTag:c=!1,userCopies:u,decks:h})=>{const{openCardModal:f}=aw(),[m,g]=b.useState(!1),y=o||t.owner_username||(l&&(t.owner_id===l.id||t.user_id===l.id)?l.username||"ME":null),v=Ie.useMemo(()=>{if(!u||u.length===0)return null;const E=[],M={};let B=0;return u.forEach(S=>{if(S.finish==="foil"||S.finish==="nonfoil")if(S.deck_id&&h){const P=h.find(V=>V.id===S.deck_id),R=P?P.name:`Deck #${S.deck_id}`;M[R]=(M[R]||0)+(S.count||1)}else!S.deck_id&&!S.is_wishlist&&(B+=S.count||1)}),B>0&&E.push(`Binder (x${B})`),Object.entries(M).forEach(([S,P])=>{E.push(`${S} (x${P})`)}),E},[u,h]),w=(E,M=0)=>{if(!E)return"https://placehold.co/250x350?text=No+Image";const B=E.data||E;return B.card_faces&&B.card_faces.length>1?B.card_faces[M]?.image_uris?.normal||E.image_uri||"https://placehold.co/250x350?text=No+Image":B.image_uris?.normal||E.image_uri||"https://placehold.co/250x350?text=No+Image"},N=t.data?.card_faces||t.card_faces,k=N?.length>1&&!!N[1].image_uris,C=w(t,0),I=k?w(t,1):null,O=E=>{E.stopPropagation(),f(t)},L=e+r>0,_=!L&&n>0;return i.jsxs("div",{className:`group relative flex bg-gray-900/60 backdrop-blur-md rounded-xl overflow-hidden shadow-2xl border transition-all duration-300 hover:shadow-[0_0_30px_rgba(79,70,229,0.15)] aspect-[3.2/3.5] perspective-1000 ${L?"border-indigo-500/30":"border-white/5 grayscale-[0.8] opacity-70 hover:grayscale-0 hover:opacity-100"}`,children:[i.jsxs("div",{className:"relative aspect-[2.5/3.5] h-full cursor-pointer overflow-hidden bg-gray-950 shrink-0",onClick:O,children:[i.jsxs("div",{className:`relative w-full h-full transition-all duration-700 transform-style-3d ${m?"rotate-y-180":""}`,children:[i.jsxs("div",{className:"absolute inset-0 backface-hidden",children:[i.jsx("img",{src:C,alt:t.name,className:"w-full h-full object-cover",loading:"lazy"}),i.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-t from-indigo-500/20 to-transparent transition-opacity duration-500"})]}),k&&i.jsx("div",{className:"absolute inset-0 backface-hidden rotate-y-180",children:i.jsx("img",{src:I||C,alt:`${t.name} Back`,className:"w-full h-full object-cover"})})]}),k&&i.jsx("button",{onClick:E=>{E.stopPropagation(),g(!m)},className:"absolute top-2 left-2 p-2 bg-black/60 hover:bg-indigo-600 text-white rounded-full backdrop-blur-md transition-all z-30 shadow-lg border border-white/10",title:"Flip Card",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),_&&i.jsx("div",{className:`absolute top-2 ${k?"left-12":"left-2"} z-20 bg-orange-500 text-white p-1 rounded-md shadow-lg animate-pulse`,children:i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),v&&v.length>0&&i.jsx("div",{className:"absolute top-2 right-2 z-30 flex flex-col items-end gap-1 pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100",children:v.map((E,M)=>i.jsxs("div",{className:"bg-gray-900/90 text-white text-[9px] font-bold px-2 py-1 rounded border border-white/20 shadow-xl backdrop-blur-md uppercase tracking-wider whitespace-nowrap",children:[" ",E]},M))}),c&&y&&L&&i.jsxs("div",{className:`absolute ${k||_?"top-16":"top-12"} left-2 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-30 backdrop-blur-md uppercase tracking-wider`,children:[" ",y]}),i.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:i.jsxs("div",{className:"bg-black/70 backdrop-blur-md px-2 py-1 rounded-lg border border-white/10 flex items-center justify-around text-[10px] font-mono",children:[i.jsxs("span",{className:"text-gray-400",children:["$",(parseFloat(t.prices?.usd)||0).toFixed(2)]}),i.jsx("div",{className:"h-2 w-[1px] bg-white/20"}),i.jsxs("span",{className:"text-yellow-400",children:["$",(parseFloat(t.prices?.usd_foil)||0).toFixed(2)," "]})]})})]}),i.jsxs("div",{className:"flex-1 bg-black/40 flex flex-col justify-between py-1 border-l border-white/5 relative",children:[i.jsx(nE,{value:e,label:"Normal",labelColor:"text-gray-600",textColor:"text-white",onChange:E=>s&&s(t,"normal",0,E)}),i.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),i.jsx(nE,{value:r,label:"Foil",labelColor:"text-indigo-600",textColor:"text-indigo-400",onChange:E=>s&&s(t,"foil",0,E)}),i.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),i.jsx(nE,{value:n,label:"Wish",labelColor:"text-orange-600",textColor:"text-orange-400",onChange:E=>a&&a(t,0,E)})]})]})};function T5e({title:t,titleId:e,...r},n){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?b.createElement("title",{id:e},t):null,b.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const I5e=b.forwardRef(T5e);function P5e({title:t,titleId:e,...r},n){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?b.createElement("title",{id:e},t):null,b.createElement("path",{fillRule:"evenodd",d:"M3.792 2.938A49.069 49.069 0 0 1 12 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 0 1 1.541 1.836v1.044a3 3 0 0 1-.879 2.121l-6.182 6.182a1.5 1.5 0 0 0-.439 1.061v2.927a3 3 0 0 1-1.658 2.684l-1.757.878A.75.75 0 0 1 9.75 21v-5.818a1.5 1.5 0 0 0-.44-1.06L3.13 7.938a3 3 0 0 1-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836Z",clipRule:"evenodd"}))}const gte=b.forwardRef(P5e),L5e=({value:t,onChange:e})=>{const[r,n]=b.useState(!1),s=b.useRef(null),a=[{label:"=",value:"="},{label:"",value:">="},{label:"",value:"<="}];b.useEffect(()=>{const l=c=>{s.current&&!s.current.contains(c.target)&&n(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const o=a.find(l=>l.value===t)||a[0];return i.jsxs("div",{className:"relative",ref:s,children:[i.jsxs("button",{type:"button",onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-3 bg-gray-900/50 hover:bg-gray-800 text-indigo-400 font-bold rounded-l-xl border-r border-white/10 transition-colors min-w-[50px] justify-center",children:[o.label,i.jsx("svg",{className:`w-3 h-3 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-20 bg-gray-900 border border-white/10 rounded-lg shadow-2xl z-[70] overflow-hidden backdrop-blur-xl",children:a.map(l=>i.jsx("button",{type:"button",onClick:()=>{e(l.value),n(!1)},className:`w-full px-4 py-2 text-left text-sm font-bold transition-colors ${t===l.value?"bg-indigo-600 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:l.label},l.value))})]})},mO=({isOpen:t,onClose:e,onAddCard:r,onOpenForgeLens:n})=>{const[s,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState(""),[h,f]=b.useState(""),[m,g]=b.useState(null),[y,v]=b.useState([]),[w,N]=b.useState(!1),[k,C]=b.useState([]),[I,O]=b.useState(!1),[L,_]=b.useState([]),[E,M]=b.useState("or"),[B,S]=b.useState(!1),[P,R]=b.useState(!1),[V,ee]=b.useState([]),[G,J]=b.useState(""),[Z,se]=b.useState(""),[X,q]=b.useState({operator:"=",value:""}),[U,H]=b.useState({operator:"=",value:""}),[re,ae]=b.useState({operator:"=",value:""}),[xe,Ne]=b.useState(""),[pe,K]=b.useState(""),{results:ue,loading:fe,error:he,searchCards:le,getSuggestions:_e}=S5e(),{currentUser:oe}=Cr(),{addToast:Oe}=Tn(),{cards:ze,refresh:Ye}=yo({userId:m||void 0}),{decks:je}=yd(),Fe=b.useRef(null),Nt=b.useRef(null),$t=E5e(s,300);b.useEffect(()=>{$t.length>=2&&o?Ut($t):$t.length<2&&C([])},[$t]);const Ut=async at=>{const ft=await _e(at);C(ft),O(ft.length>0)};b.useEffect(()=>{t&&(async()=>{try{const Bt=(await Ka.fetchIncomingPermissions()).filter(De=>["editor","admin","contributor"].includes(De.permission_level)&&!De.target_deck_id);v(Bt)}catch(ft){console.error("Failed to load writable collections",ft)}})()},[t]);const nt=b.useMemo(()=>{const at=new Map;return ze&&ze.forEach(ft=>{const Bt=ft.scryfall_id||ft.id;at.has(Bt)||at.set(Bt,[]),at.get(Bt).push(ft)}),at},[ze]);b.useEffect(()=>{t&&Fe.current&&Fe.current.focus()},[t]);const bt=at=>{at&&at.preventDefault(),O(!1);const ft={set:c,cn:h,colors:L.length>0?L:void 0,colorLogic:E,colorIdentity:B,colorExcluded:P,rarity:V.length>0?V:void 0,type:G,text:Z,flavor:xe,artist:pe,mv:X.value!==""?{operator:X.operator,value:Number(X.value)}:void 0,power:U.value!==""?{operator:U.operator,value:Number(U.value)}:void 0,toughness:re.value!==""?{operator:re.operator,value:Number(re.value)}:void 0};le(s,ft)},It=()=>{a(""),u(""),f(""),_([]),R(!1),ee([]),J(""),se(""),q({operator:"=",value:""}),H({operator:"=",value:""}),ae({operator:"=",value:""}),Ne(""),K("")},_t=at=>{_(ft=>ft.includes(at)?ft.filter(Bt=>Bt!==at):[...ft,at])},wt=at=>{ee(ft=>ft.includes(at)?ft.filter(Bt=>Bt!==at):[...ft,at])},ut=async(at,ft,Bt,De=null)=>{if(!oe)return Oe("Please log in","error");try{const lt=at.id,ht=nt.get(lt)||[],Pt=ft==="foil"?"foil":"nonfoil",At=ht.filter(Ct=>Ct.finish===Pt&&!Ct.is_wishlist).reduce((Ct,Xt)=>Ct+(Xt.count||1),0),mt=ht.filter(Ct=>Ct.finish===Pt&&!Ct.is_wishlist&&Ct.deck_id).reduce((Ct,Xt)=>Ct+(Xt.count||1),0);let Ft;if(De!==null?Ft=Math.max(0,parseInt(De)):Ft=Math.max(0,At+Bt),Ft<mt){Oe(`Cannot reduce count below ${mt} (used in decks)`,"error");return}const gt=Ft-mt,Ot=ht.find(Ct=>Ct.finish===Pt&&!Ct.deck_id&&!Ct.is_wishlist);if(Ot)if(gt>0){await bl.updateCard(Ot.id,{count:gt});const Ct=De!==null?`Updated ${Pt} count to ${Ft}`:`Added ${Pt} ${at.name}`;De!==null||Bt>0?Oe(Ct,"success"):Oe(`Removed ${Pt} ${at.name}`,"info")}else await bl.removeCard(Ot.id),Oe(`Removed ${Pt} ${at.name}`,"info");else if(gt>0){const Ct=await bl.addCardToCollection(oe.uid,at,gt,Pt,!1,m);if(Oe(`Added ${gt} ${Pt} ${at.name}`,"success"),r&&Ct&&Ct.id){const Xt={...at,firestoreId:Ct.id,id:at.id,finish:Pt,count:gt,is_wishlist:!1};r(Xt)}}Ye()}catch(lt){console.error("Update failed",lt),Oe("Failed to update collection","error")}},Rt=async(at,ft,Bt=null)=>{if(!oe)return Oe("Please log in","error");try{const De=at.id,ht=(nt.get(De)||[]).find(At=>At.is_wishlist&&!At.deck_id);let Pt;Bt!==null?Pt=Math.max(0,parseInt(Bt)):Pt=Math.max(0,(ht?ht.count:0)+ft),ht?Pt>0?(await bl.updateCard(ht.id,{count:Pt}),Bt!==null||ft>0?Oe(`Updated wishlist count for ${at.name}`,"success"):Oe(`Decreased ${at.name} in wishlist`,"info")):(await bl.removeCard(ht.id),Oe(`Removed ${at.name} from wishlist`,"info")):Pt>0&&(await bl.addCardToCollection(oe.uid,at,Pt,"nonfoil",!0,m),Oe(`Added ${Pt} ${at.name} to wishlist`,"success")),Ye()}catch(De){console.error("Wishlist update failed",De),Oe("Failed to update wishlist","error")}};if(!t)return null;const Dt={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"},C:{bg:"bg-gray-400",text:"text-gray-900",border:"border-gray-500",symbol:"https://svgs.scryfall.io/card-symbols/C.svg"}};return Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in group",children:[i.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-white/5",children:[i.jsxs("div",{className:"px-6 py-5 border-b border-white/5 flex justify-between items-center bg-white/5 flex-shrink-0",children:[i.jsx("div",{children:i.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-3",children:[i.jsx("span",{className:"bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Card Library"}),i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-500/10 text-indigo-300 uppercase tracking-wider border border-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]",children:"Database"})]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[y.length>0&&i.jsxs("div",{className:"flex items-center gap-2 bg-black/20 rounded-lg p-1 border border-white/5",children:[i.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-2",children:"Target:"}),i.jsxs("select",{value:m||"",onChange:at=>g(at.target.value||null),className:"bg-transparent text-xs text-white focus:outline-none font-bold cursor-pointer hover:text-indigo-300 transition-colors",children:[i.jsx("option",{value:"",className:"bg-gray-900",children:"My Collection"}),y.map(at=>i.jsxs("option",{value:at.owner_id,className:"bg-gray-900",children:[at.owner_username,"'s Collection (",at.permission_level,")"]},at.owner_id))]})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),n&&i.jsxs("div",{className:"relative overflow-hidden group",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 via-purple-600/20 to-indigo-600/20 opacity-50 blur-xl group-hover:opacity-75 transition-opacity"}),i.jsxs("div",{className:"relative px-6 py-2 border-b border-white/5 flex items-center justify-between bg-white/5 backdrop-blur-sm",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center text-indigo-300 shadow-[0_0_15px_rgba(99,102,241,0.3)]",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs font-bold text-white",children:"Have the physical card?"}),i.jsx("span",{className:"hidden sm:inline-block h-1 w-1 rounded-full bg-gray-600"}),i.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider hidden sm:block",children:"Scan instantly with Forge Lens AI"})]})]}),i.jsxs("button",{onClick:n,className:"px-5 py-1.5 bg-indigo-500/20 hover:bg-indigo-500/30 hover:text-white text-indigo-300 border border-indigo-500/30 rounded-lg font-bold text-[10px] uppercase tracking-wider transition-all shadow-[0_0_20px_rgba(99,102,241,0.1)] hover:shadow-[0_0_20px_rgba(99,102,241,0.3)] flex items-center gap-2",children:[i.jsx("span",{children:"Launch Scanner"}),i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar bg-black/20",children:[i.jsx("div",{className:"p-6 space-y-4 relative z-[60]",children:i.jsxs("form",{onSubmit:bt,className:"relative flex flex-col gap-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[i.jsxs("div",{className:"relative flex-1 group",children:[i.jsx("input",{id:"card-search-input",ref:Fe,type:"text",placeholder:"Search cards...",className:"w-full bg-white/5 text-white border border-white/10 rounded-xl py-4 px-6 pl-14 pr-12 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all placeholder-gray-500 backdrop-blur-sm",value:s,onChange:at=>{a(at.target.value),l(!0),O(!0)},onFocus:()=>s.length>=2&&O(!0)}),i.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s&&i.jsx("button",{type:"button",onClick:()=>{a(""),C([]),Fe.current?.focus()},className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-1 rounded-full hover:bg-white/10 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),I&&k.length>0&&i.jsx("div",{ref:Nt,className:"absolute top-full left-0 right-0 mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 max-h-60 overflow-y-auto custom-scrollbar",children:k.map((at,ft)=>i.jsx("button",{type:"button",onClick:()=>{a(at),l(!1),O(!1),le(at,{set:c,cn:h})},className:"w-full text-left px-6 py-3 hover:bg-white/5 text-gray-400 hover:text-white transition-colors border-b border-white/5 last:border-0",children:at},ft))})]}),i.jsxs("button",{id:"card-search-advanced-toggle",type:"button",onClick:()=>N(!w),className:`px-6 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${w?"bg-indigo-600 text-white border-indigo-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[i.jsx(gte,{className:"w-5 h-5"}),"Advanced Search"]}),i.jsx("button",{type:"submit",disabled:fe,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl text-lg font-bold transition-all disabled:opacity-50 min-w-[120px] shadow-lg shadow-indigo-500/20 active:scale-95 border border-indigo-500/50",children:fe?"Searching...":"Search"})]}),i.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${w?"max-h-[800px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:i.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 space-y-6",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Advanced Configuration"}),i.jsx("button",{onClick:It,className:"text-orange-500 hover:text-orange-400 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Reset Filters"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Colors"}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsx("div",{className:"flex gap-2",children:Object.entries(Dt).map(([at,ft])=>i.jsx("button",{type:"button",onClick:()=>_t(at),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${L.includes(at)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:L.includes(at)?"transparent":""},children:i.jsx("img",{src:ft.symbol,alt:at,className:`w-full h-full ${L.includes(at)?"drop-shadow-md":"grayscale"}`})},at))}),i.jsx("div",{className:"flex items-center gap-2 text-sm bg-gray-900 border border-white/10 rounded-lg p-1",children:["or","and"].map(at=>i.jsx("button",{type:"button",onClick:()=>M(at),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${E===at?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:at},at))})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Rarity"}),i.jsx("div",{className:"flex gap-3",children:["common","uncommon","rare","mythic"].map(at=>i.jsx("button",{type:"button",onClick:()=>wt(at),className:`px-3 py-1.5 rounded-lg border text-xs font-bold uppercase transition-all ${V.includes(at)?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-gray-900 border-white/10 text-gray-500 hover:text-gray-300"}`,children:at.charAt(0)},at))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Type"}),i.jsx("input",{type:"text",placeholder:"Creature, Artifact...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:G,onChange:at=>J(at.target.value)})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Text"}),i.jsx("input",{type:"text",placeholder:"Rules text...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:Z,onChange:at=>se(at.target.value)})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Mana Value"}),i.jsxs("div",{className:"flex items-center bg-gray-900 border border-white/10 rounded-xl overflow-hidden",children:[i.jsx(L5e,{value:X.operator,onChange:at=>q({...X,operator:at})}),i.jsx("input",{type:"number",className:"w-full bg-transparent p-2 text-sm outline-none",value:X.value,onChange:at=>q({...X,value:at.target.value})})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"space-y-2 flex-1",children:[i.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Set"}),i.jsx("input",{type:"text",placeholder:"ABC",maxLength:5,className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none uppercase",value:c,onChange:at=>u(at.target.value)})]}),i.jsxs("div",{className:"space-y-2 flex-1",children:[i.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"CN"}),i.jsx("input",{type:"text",placeholder:"#",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:h,onChange:at=>f(at.target.value)})]})]})]})]})})]})}),i.jsxs("div",{id:"card-search-results",className:"p-6",children:[he&&i.jsx("div",{className:"flex items-center justify-center p-8 text-red-400 bg-red-500/10 rounded-2xl border border-red-500/20",children:i.jsx("p",{className:"font-bold",children:he})}),!fe&&ue.length===0&&(s||w)&&!he&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 opacity-60",children:[i.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("p",{className:"text-lg font-bold",children:"No matches found"})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:ue.map((at,ft)=>{const Bt=nt.get(at.id)||[],De=Bt.filter(Pt=>Pt.finish==="nonfoil"&&!Pt.is_wishlist).reduce((Pt,At)=>Pt+(At.count||1),0),lt=Bt.filter(Pt=>Pt.finish==="foil"&&!Pt.is_wishlist).reduce((Pt,At)=>Pt+(At.count||1),0),ht=Bt.filter(Pt=>Pt.is_wishlist&&!Pt.deck_id).reduce((Pt,At)=>Pt+(At.count||1),0);return i.jsx(mte,{card:at,normalCount:De,foilCount:lt,wishlistCount:ht,onUpdateCount:ut,onUpdateWishlistCount:Rt,userCopies:Bt,decks:je},at.id||ft)})})]})]})]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]}),document.body)},G$={pro:{input:1.25/1e6,output:5/1e6},flash:{input:.075/1e6,output:.3/1e6},"flash-lite":{input:.0375/1e6,output:.15/1e6}},K$=t=>t.includes("pro")?"pro":t.includes("lite")||t.includes("8b")?"flash-lite":"flash",sE=t=>t?Math.ceil(t.length/4):0,iE=(t,e,r,n,s)=>{try{const a=JSON.parse(localStorage.getItem("gemini_usage_stats")||"{}"),o=`key_${t}`;a[o]||(a[o]={}),a[o][e]||(a[o][e]={success:0,failure:0,429:0,inputTokens:0,outputTokens:0});const l=a[o][e];r==="success"?(l.success++,l.inputTokens+=n,l.outputTokens+=s):r===429?l[429]++:l.failure++,localStorage.setItem("gemini_usage_stats",JSON.stringify(a))}catch(a){console.error("Failed to update usage stats",a)}},Y$="AIzaSyBR4PPaFOMAfAtPeqR2ptEJBzD2KKf4uEU >> .env.production",O5e=(t,e)=>{let r=[t];e?.settings?.geminiApiKeys&&Array.isArray(e.settings.geminiApiKeys)&&e.settings.geminiApiKeys.forEach(s=>{s&&!r.includes(s)&&r.push(s)}),r.includes(Y$)||r.push(Y$);const n=r.filter(Boolean).map(s=>s.split(" ")[0].trim());return[...new Set(n)].slice(0,5)},M5e=["gemini-3-flash","gemini-2.5-flash","gemini-2.5-flash-lite","gemini-2.0-flash","gemini-2.0-flash-lite-preview-02-05","gemini-1.5-flash","gemini-1.5-flash-8b"],xte=t=>{if(!t)return"";let e=t.replace(/```json/g,"").replace(/```html/g,"").replace(/```/g,"").trim();return e.startsWith("{")&&!e.endsWith("}")&&(console.warn("AI response appears truncated. Implementing structural repair..."),(e.match(/"/g)||[]).length%2!==0&&(e+='"'),e.includes('"suggestions"')?(e.lastIndexOf("{")>e.lastIndexOf("}")&&(e=e.substring(0,e.lastIndexOf("{")).trim(),e.endsWith(",")&&(e=e.slice(0,-1))),e.endsWith("]")||(e+="]"),e.endsWith("}")||(e+="}")):(e.lastIndexOf("[")>e.lastIndexOf("]")&&(e+="]"),e.lastIndexOf("{")>e.lastIndexOf("}")&&(e+="}")),e=e.trim().replace(/,$/,""),e.endsWith("}")||(e+="}")),e},wx=t=>{try{return JSON.parse(xte(t))}catch(e){console.error("JSON Parse Error at position:",e.message.match(/position (\d+)/)?.[1]||"unknown");const r=e.message.match(/position (\d+)/);if(r){const n=parseInt(r[1]);console.error("Context around error:",t.substring(Math.max(0,n-50),n+50))}throw new Error("Failed to parse AI response: "+e.message)}},Nl={async executeWithFallback(t,e,r={}){const n=r.apiKey,s=O5e(n,e),a=r.models||M5e;let o=[],l=!0,c=0;t.contents&&t.contents.forEach(h=>h.parts.forEach(f=>{f.text&&(c+=sE(f.text))})),(t.systemInstruction||t.system_instruction)&&(t.systemInstruction||t.system_instruction).parts.forEach(f=>{f.text&&(c+=sE(f.text))}),t.system_instruction||t.systemInstruction||t.generationConfig?.responseSchema||t.generationConfig?.responseMimeType;const u=new Set;for(let h=0;h<s.length;h++){const f=s[h];if(u.has(f))continue;let m=!1;for(const g of a){if(m)break;const y=["v1beta","v1"];for(const v of y)try{const w=`https://generativelanguage.googleapis.com/${v}/models/${g}:generateContent?key=${f}`;let N={...t};if(v==="v1"){const O=(N.system_instruction||N.systemInstruction)?.parts?.[0]?.text;delete N.system_instruction,delete N.systemInstruction,N.generationConfig&&(N.generationConfig={...N.generationConfig},delete N.generationConfig.responseMimeType,delete N.generationConfig.responseSchema),O&&(N.contents=[{role:"user",parts:[{text:`SYSTEM INSTRUCTION: ${O}

UNDERSTOOD. I will follow those instructions exactly.`}]},{role:"model",parts:[{text:"Understood. I am ready."}]},...N.contents||[]])}const k=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!k.ok){let O=k.status.toString(),L=!1;try{const _=await k.json();_.error?.message&&(O=_.error.message,(O.toLowerCase().includes("api key not valid")||O.toLowerCase().includes("invalid api key"))&&(L=!0))}catch{}if(L){o.push(`Key ${h}: Invalid/Expired`),u.add(f),m=!0;break}if(k.status===429){l=!0,iE(h,g,429,0,0),o.push(`${g}@${v} (Key ${h}): 429 Rate Limited`),await new Promise(_=>setTimeout(_,3e3)),m=!0;break}if(k.status===404){o.push(`${g}@${v}: 404 Not Found`);continue}o.push(`${g}@${v} (Key ${h}): ${O}`),iE(h,g,k.status,0,0),l=!1;break}const I=(await k.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(I){const O=sE(I);return iE(h,g,"success",c,O),I}}catch(w){o.push(`${g}@${v} Error: ${w.message}`)}}}throw l&&typeof window<"u"&&window.addToast&&window.addToast("All free tiers of Gemini have been used today across all provided keys.","warning"),new Error(`Oracle Exhausted: ${o.join(" | ")}`)},async generateDeckSuggestions(t,e,r=null,n=null){const{deckName:s,commander:a,strategyGuide:o,helperPersona:l,targetRole:c,candidates:u,currentContext:h,neededCount:f,buildMode:m,commanders:g,instructions:y}=e,v=l?.name||r?.name||"The Oracle",w=l?.personality||r?.personality||"Professional and helpful",N=`You are ${v}. Your personality is: ${w}.
        VOICE: Strictly adhere to your personality. Address the user as an equal.
        CORE MISSION:
        - EXECUTE THE DECK STRATEGY: ${o}
        - SPECIAL INSTRUCTIONS: ${y||"None provided."}
        - STAMP OF COMPLETION (CRITICAL): You are being asked to provide a COMPLETE deck skeleton. You must return EXACTLY the number of cards requested in [REQUEST]. 
        - UNDER-REPORTING IS A FAILURE: If I ask for 99 cards, returning 40 or 60 is a failure. You must fill the "suggestions" array until the requested count is met.
        - SYNERGY PRIORITIZATION: Prioritize cards that enable triggers or mechanics mentioned in the commander's text.
        - COLOR IDENTITY: Suggest cards matching: ${e.commanderColorIdentity}.
        - CONTEXT AWARENESS: DO NOT suggest cards already in deck: ${JSON.stringify(h)}.
        - TOKEN EFFICIENCY: Your 'reason' for each card MUST be a short fragment (3-6 words). Example: "Top-tier ramp." or "Key synergy piece." Do not waste tokens on full sentences.
        
        ALLOWED ROLES:
        Assign one of: 'Synergy / Strategy', 'Mana Ramp', 'Card Draw', 'Targeted Removal', 'Board Wipes', 'Land'.

        CRITICAL INSTRUCTIONS FOR DISCOVERY MODE:
        Search entire MTG history. Resolve by Name. Recommend 'set' and 'collectorNumber'.
        
        CRITICAL INSTRUCTIONS FOR COLLECTION MODE:
        Only suggest from [CANDIDATE POOL]. Use 'firestoreId'.`,k=(g||[]).map(L=>`[${L.name}] (${L.type_line}) - Oracle: ${L.oracle_text}`).join(`
`),C=`
            DECK: ${s}
            [COMMANDER(S)]
            ${k||a}
            
            [COLOR IDENTITY] ${e.commanderColorIdentity}
            [STRATEGY] ${o}
            [SPECIAL FOCUS] ${y||"None"}
            [STATUS] Current deck contains: ${JSON.stringify(h)}
            [REQUEST] I need the following counts for these specific roles: ${JSON.stringify(e.deckRequirements||{[c]:f})}
            [MODE] ${m==="discovery"?"DISCOVERY (Global Search)":"COLLECTION (Strict Pool)"}
            
            ${m!=="discovery"?`[CANDIDATE POOL]
${u.map(L=>`ID: ${L.firestoreId||L.id} | Name: ${L.name} | Type: ${L.type_line}`).join(`
`)}`:""}
        `,I={system_instruction:{parts:[{text:N}]},contents:[{role:"user",parts:[{text:C}]}],generationConfig:{responseMimeType:"application/json",maxOutputTokens:8192,responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING",description:"The ID from the pool, or 'discovery' for new cards"},name:{type:"STRING"},rating:{type:"NUMBER",description:"1-10 how well it fits"},reason:{type:"STRING",description:"Brief justification (max 12 words)"},set:{type:"STRING",description:"Scryfall set code (e.g. 'mkm')"},collectorNumber:{type:"STRING",description:"Scryfall collector number"},role:{type:"STRING",description:"MUST be one of: 'Synergy / Strategy', 'Mana Ramp', 'Card Draw', 'Targeted Removal', 'Board Wipes', 'Land'"}},required:["name","rating","reason","set","collectorNumber","role"]}}}}}},O=await this.executeWithFallback(I,n,{apiKey:t});return wx(O)},async analyzeDeck(t,e,r,n=null,s=null){const a=n?.name||"The Deck Doctor",o=e.map(h=>`- ${h.countInDeck||1}x ${h.name} (${h.type_line})`).join(`
`)+`

Total Lands: ${e.reduce((h,f)=>f.type_line?.toLowerCase().includes("land")?h+(f.countInDeck||1):h,0)}`,c={system_instruction:{parts:[{text:`You are ${a}. Analyze this Commander deck for "${r}".
        
        [DECKLIST]
        ${o}
        
        [INSTRUCTIONS]
        Perform a clinical evaluation. Be critical but constructive.
        1. Calculate a Score (0-100).
        2. Identify 3-5 critical structural Issues.
        3. Propose up to 5 surgical Swaps with 'remove', 'add', 'reason'.
        4. Focus on Mana Curve, Synergy density, and Interaction package.`}]},contents:[{role:"user",parts:[{text:`Analyze this Commander deck for "${r}"`}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{score:{type:"NUMBER"},metrics:{type:"OBJECT",properties:{synergy:{type:"NUMBER"},speed:{type:"NUMBER"},interaction:{type:"NUMBER"}}},issues:{type:"ARRAY",items:{type:"STRING"}},changes:{type:"ARRAY",items:{type:"OBJECT",properties:{remove:{type:"STRING"},add:{type:"STRING"},reason:{type:"STRING"}},required:["remove","add","reason"]}}},required:["score","metrics","issues","changes"]}}},u=await this.executeWithFallback(c,s,{apiKey:t});return wx(u)},async sendMessage(t,e,r,n="",s=null,a=null){const o=s?.name||"MTG Forge",l=s?.personality||"Knowledgeable, friendly, and concise.",h={contents:[{role:"user",parts:[{text:`You are ${o}, an elite Magic: The Gathering AI strategist and companion.
        
        [PERSONALITY]
        ${l}
        
        [RESPONSE GUIDELINES]
        - Output ONLY raw HTML. Do not use Markdown blocks (no \`\`\`html).
        - Use Tailwind CSS classes for styling.
        - Primary font color should be text-gray-300 unless highlighting.
        - Use <strong class="text-indigo-400"> for card names or key terms.
        - Use <ul class="space-y-2 list-disc pl-5 my-4"> for lists.
        - Use <div class="p-4 bg-indigo-500/10 border border-indigo-500/20 rounded-xl my-4"> for emphasis or summary blocks.
        
        [CONTEXT]
        ${n}
        
        You are interacting with the user inside their personal deck-building laboratory. Be helpful, strategic, and stay in character.`}]},...e.map(m=>({role:m.role==="user"?"user":"model",parts:[{text:m.content}]})),{role:"user",parts:[{text:r}]}]},f=await this.executeWithFallback(h,a,{apiKey:t});return xte(f)},async spruceUpText(t,e,r="General",n=null){const s={system_instruction:{parts:[{text:`You are a professional editor. Rewrite the following ${r} text to be professional, evocative, and structured for a high-end gaming application. Use basic HTML (<b>, <i>, <ul>, <li>). Do not use markdown blocks.`}]},contents:[{role:"user",parts:[{text:e}]}]};return(await this.executeWithFallback(s,n,{apiKey:t})).replace(/```html/g,"").replace(/```/g,"").trim()},async getDeckStrategy(t,e,r=null,n=[],s=null,a=null){const o=s?.name||"The Oracle",l=s?.personality||"Wise, mystical, and strategic.",c=Array.isArray(e)?e:[e],u=c.map(y=>{const v=y.name||y.data?.name||"Unknown Commander",w=y.mana_cost||y.cmc||y.data?.mana_cost||y.data?.cmc||"N/A",N=y.type_line||y.data?.type_line||"Legendary Creature",k=y.oracle_text||y.data?.oracle_text||"Refer to global knowledge";return`NAME: ${v}
MANA COST: ${w}
TYPE: ${N}
TEXT: ${k}`}).join(`
---
`),h=r?`USER PLAYSTYLE PROFILE:
- Summary: ${r.summary}
- Archetypes: ${r.archetypes?.join(", ")}
- Aggression: ${r.scores?.aggression}/10`:"USER PLAYSTYLE: Unknown, assume balanced competitive-casual.",m={system_instruction:{parts:[{text:`You are ${o}. Your personality is: ${l}.
        
        MISSION:
        Generate a unique, high-level Commander STRATEGY BLUEPRINT for a deck led by:
        ${u}

        ${h}
        
        CRITICAL RULES:
        1. **100 CARDS TOTAL**: The 'layout' counts MUST sum up to exactly 100 cards when including the ${c.length} commander(s).
        2. **DYNAMIC LAYOUT**: Tailor "Functional" and "Type" counts to the strategy.
        3. **VISUAL AESTHETICS**: You are a UI Designer as much as a Strategist. Your output must be VISUALLY STUNNING.
           - Use **EMOJIS** in every section header and list item.   
           - Use **BANNERS**: Wrap key concepts in styled divs.
           - Use **COLORS**: specific tailwind text colors for types (e.g., text-green-400 for lands/ramp, text-red-400 for aggression).

        FORMAT INSTRUCTIONS:
        - 'theme': A 3-5 word evocative title (e.g., "Eldritch Spellslinger Chaos").
        - 'strategy': Tactical advice in **RICH HTML**. Do *not* use Markdown.
           
           Required HTML Elements & Styling:
           - **Headers**: <h4 class="text-xl font-black text-white mt-6 mb-3 flex items-center gap-2"><span class="text-2xl"></span> SECTION TITLE</h4>
           - **Banners**: <div class="bg-indigo-500/10 border-l-4 border-indigo-500 p-4 rounded-r-lg my-4 text-gray-200">Content...</div>
           - **Keywords**: <span class="font-bold text-indigo-400">Keyword</span>
           - **Lists**: <ul class="space-y-2 mb-4"><li class="flex items-start gap-2"><span class="mt-1"></span><span>Point...</span></li></ul>
           
           Required Sections:
           1. **The Grand Vision** (Intro)
           2. **The Game Plan** (Early/Mid/Late game - use a timeline or steps)
           3. **Winning the Game** (Win Conditions)
           4. **Secret Tech & Synergies** (Highlight specific interactions)
           
        - 'layout': Target counts for the remaining deck slots (Total 100 - Commanders).
           - 'functional': { "Lands": N, "Mana Ramp": N, "Card Draw": N, "Removal": N, "Board Wipes": N, "Synergy/Core": N }
           - 'types': { "Creatures": N, "Instants": N, "Sorceries": N, "Artifacts": N, "Enchantments": N, "Planeswalkers": N, "Lands": N }
        `}]},contents:[{role:"user",parts:[{text:"Generate unique strategy for this commander."}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestedName:{type:"STRING"},theme:{type:"STRING"},strategy:{type:"STRING"},layout:{type:"OBJECT",properties:{functional:{type:"OBJECT",properties:{Lands:{type:"NUMBER"},"Mana Ramp":{type:"NUMBER"},"Card Draw":{type:"NUMBER"},Removal:{type:"NUMBER"},"Board Wipes":{type:"NUMBER"},Synergy:{type:"NUMBER"}},required:["Lands","Mana Ramp","Card Draw","Removal","Board Wipes","Synergy"]},types:{type:"OBJECT",properties:{Creatures:{type:"NUMBER"},Instants:{type:"NUMBER"},Sorceries:{type:"NUMBER"},Artifacts:{type:"NUMBER"},Enchantments:{type:"NUMBER"},Planeswalkers:{type:"NUMBER"},Lands:{type:"NUMBER"}},required:["Creatures","Instants","Sorceries","Artifacts","Enchantments","Planeswalkers","Lands"]}},required:["functional","types"]}},required:["suggestedName","theme","strategy","layout"]}}},g=await this.executeWithFallback(m,a,{apiKey:t});return wx(g)},async gradeDeck(t,e,r=null){const{deckName:n,commander:s,cards:a,playerProfile:o,strategyGuide:l,helperPersona:c}=e,h=`You are ${c?.name||"The Oracle"}, a Tier-1 MTG competitive analyst.
        
        MISSION:
        Evaluate the power level of the provided decklist based on the "Commander Bracket" system.
        
        CRITIQUE FORMATTING:
        Provide the 'critique' and 'bracketJustification' fields as **Polished Modern HTML**. 
        - Use <strong class="text-white"> for emphasis.
        - Use emojis    liberally to enhance the "Deck Doctor" persona.
        - Do NOT use markdown.
        
        BRACKET DEFINITIONS:
        - Bracket 1 (Exhibition): Precons, low-powered themes, extreme budget, or jank.
        - Bracket 2 (Core): Standard casual decks with basic synergies and upgrades.
        - Bracket 3 (Upgraded): High-synergy decks with efficient win conditions and strong mana bases.
        - Bracket 4 (Optimized): High-power casual, infinite combos, tutors, and fast mana (short of cEDH).
        - Bracket 5 (cEDH): Tier-0 competitive decks designed for Turn 1-3 wins or hard stax.
        
        METRICS (1-10):
        - Efficiency: Average CMC vs Mana acceleration quality.
        - Interaction: Density and quality of removal, counters, and protection.
        - winTurn: The average turn the deck projects to present a lethal threat.`,f=`
            DECK: "${n}"
            COMMANDER: ${s}
            STRATEGY: ${l}
            USER PROFILE: ${o}
            DECKLIST:
            ${a.map(y=>`- ${y.name}`).join(`
`)}
        `,m={system_instruction:{parts:[{text:h}]},contents:[{role:"user",parts:[{text:f}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{powerLevel:{type:"NUMBER",description:"Float between 1.0 and 10.0"},commanderBracket:{type:"INTEGER",description:"1 to 5 based on rubric"},metrics:{type:"OBJECT",properties:{efficiency:{type:"NUMBER"},interaction:{type:"NUMBER"},winTurn:{type:"NUMBER"}}},bracketJustification:{type:"STRING"},critique:{type:"STRING",description:"Emotional/Strategic feedback"},mechanicalImprovements:{type:"ARRAY",items:{type:"STRING"}},recommendedSwaps:{type:"ARRAY",items:{type:"OBJECT",properties:{remove:{type:"STRING"},add:{type:"STRING"},reason:{type:"STRING"}},required:["remove","add","reason"]}}},required:["powerLevel","commanderBracket","metrics","bracketJustification","critique","mechanicalImprovements","recommendedSwaps"]}}},g=await this.executeWithFallback(m,r,{apiKey:t});return wx(g)},async generatePlaystyleQuestion(t,e,r=null){const n=`You are the Oracle of the Multiverse. You are conducting a psychographic assessment of a Magic: The Gathering player.
        
        Your questions should be evocative, thematic, and cover:
        - Aggression (Face vs Board)
        - Interaction (Control vs Proactive)
        - Complexity (Linear vs Rube Goldberg)
        - Archetypes (Aggro, Control, Combo, Midrange, Stax)`,s=`Current Assessment State: ${JSON.stringify(e)}. Generate the next clinical question.`,a={system_instruction:{parts:[{text:n}]},contents:[{role:"user",parts:[{text:s}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{question:{type:"STRING"},choices:{type:"ARRAY",items:{type:"STRING"}}},required:["question","choices"]}}},o=await this.executeWithFallback(a,r,{apiKey:t});return wx(o)},async synthesizePlaystyle(t,e,r=null){const s={system_instruction:{parts:[{text:`Analyze the following MTG session answers and synthesize a permanent psychographic profile for the player.
        
        FORMATTING:
        - 'summary': A 3-4 sentence evocative summary in **Polished HTML**. Use <strong class="text-white"> for emphasis and emojis . Make it feel like a mythical prophecy.

        CATEGORIES:
        - Aggression: Desire for combat and early pressure.
        - Interaction: Desire to stop opponents or control the stack.
        - Complexity: Preference for intricate loops vs simple power.
        - Social: Preference for group hug/politics vs kingmaking.`}]},contents:[{role:"user",parts:[{text:`PLAYER ANSWERS: ${JSON.stringify(e)}`}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{summary:{type:"STRING",description:"3-4 sentence evocative summary"},tags:{type:"ARRAY",items:{type:"STRING"},description:"Short traits like 'Combo Fiend', 'Stax Master'"},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},interaction:{type:"NUMBER"},complexity:{type:"NUMBER"},political:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}},required:["summary","tags","scores","archetypes"]}}},a=await this.executeWithFallback(s,r,{apiKey:t});return wx(a)},async refinePlaystyleChat(t,e,r,n=null,s=null){const l={system_instruction:{parts:[{text:`You are ${n?.name||"The Oracle"}. Carry out a conversation with the user to refine their MTG Playstyle Profile. 
        Current State: ${JSON.stringify(r)}.
        
        In every response:
        1. Keep the AI personality intact.
        2. Silently update the 'updatedProfile' object based on their responses.
        3. Be insightful and slightly assertive about your observations.`}]},contents:e.length>0?[...e.map(u=>({role:u.role==="user"?"user":"model",parts:[{text:u.content}]}))]:[{role:"user",parts:[{text:"Begin the session."}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING",description:"Evocative conversation"},updatedProfile:{type:"OBJECT",properties:{summary:{type:"STRING"},tags:{type:"ARRAY",items:{type:"STRING"}},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},interaction:{type:"NUMBER"},complexity:{type:"NUMBER"},political:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}}}},required:["aiResponse","updatedProfile"]}}},c=await this.executeWithFallback(l,s,{apiKey:t});return JSON.parse(c)},async forgeHelperChat(t,e,r,n=null){const a={system_instruction:{parts:[{text:`You are the MTG Spark-Forge. You are interviewing the user to create their permanent AI Deck-Building companion.
        
        CURRENT DRAFT: ${JSON.stringify(r)}
        
        You need to determine:
        - Name
        - Type (e.g. Eldrazi Construct, Faerie Spirit, Thran AI)
        - Personality (e.g. Grumpy, Whimsical, Calculating)
        
        Keep the conversation immersive. Update 'updatedDraft' with every response.`}]},contents:e.length>0?[...e.map(l=>({role:l.role==="user"?"user":"model",parts:[{text:l.content}]}))]:[{role:"user",parts:[{text:"Initialize Forge."}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedDraft:{type:"OBJECT",properties:{name:{type:"STRING"},type:{type:"STRING"},personality:{type:"STRING"},visualDescription:{type:"STRING"}}}},required:["aiResponse","updatedDraft"]}}},o=await this.executeWithFallback(a,n,{apiKey:t});return JSON.parse(o)},async generateReleaseNotes(t,e,r=null){const s={system_instruction:{parts:[{text:`You are the Lead Developer of MTG Forge. Generate professional, evocative release notes for the latest update.
        Use HTML with Tailwind (text-gray-300, indigo-400 highlights). 
        Include sections: [New Mechanics], [Bug Squashing], [In the Forge].`}]},contents:[{role:"user",parts:[{text:`Tickets: ${JSON.stringify(e)}`}]}]};return(await this.executeWithFallback(s,r,{apiKey:t})).replace(/```html/g,"").replace(/```/g,"").trim()}},J5=10,yte=({isOpen:t,onClose:e,onComplete:r,helperName:n="The Oracle",helperPersonality:s="Wise, Efficient, Slightly Mystical"})=>{const{userProfile:a}=Cr(),[o,l]=b.useState("advanced"),[c,u]=b.useState("chat"),[h,f]=b.useState([]),[m,g]=b.useState([]),[y,v]=b.useState(null),[w,N]=b.useState(null),[k,C]=b.useState([]),[I,O]=b.useState(null),[L,_]=b.useState(""),E=b.useRef(null),[M,B]=b.useState(!1),[S,P]=b.useState(null);b.useEffect(()=>{t&&R()},[t]),b.useEffect(()=>{E.current?.scrollIntoView({behavior:"smooth"})},[k]);const R=()=>{l("advanced"),u("chat"),setTimeout(()=>Z(),100),g([]),C([]),O(null),P(null),N(null),_("")},V=()=>{l("quick"),u("loading"),ee([])},ee=async U=>{u("loading"),B(!0),P(null),N(null);try{const H=a?.settings?.geminiApiKey,re=await Nl.generatePlaystyleQuestion(H,U,a);v(re),u("question")}catch(H){console.error("Quick Wizard Error:",H),P(H.message||"Failed to summon the oracle."),l("error")}finally{B(!1)}},G=async U=>{N(U),await new Promise(ae=>setTimeout(ae,600));const H={question:y.question,answer:U},re=[...m,H];g(re),re.length>=J5?J(re):ee(re)},J=async U=>{l("synthesis");try{const H=a?.settings?.geminiApiKey,re=await Nl.synthesizePlaystyle(H,U,a);r&&await r(re),e()}catch{P("Failed to synthesize your profile."),l("error")}},Z=async()=>{l("advanced"),u("chat"),B(!0),O({summary:"Pending analysis...",tags:[],scores:{}});try{const U=a?.settings?.geminiApiKey,H=await Nl.refinePlaystyleChat(U,[],I,{name:n,personality:s},a);C([{role:"model",content:H.aiResponse}])}catch(U){console.error("Intro Error:",U),C([{role:"model",content:`Greetings. I am ${n}. Let us begin our analysis.`}])}finally{B(!1)}},se=async()=>{if(!L.trim())return;const U={role:"user",content:L},H=[...k,U];C(H),_(""),B(!0);try{const re=a?.settings?.geminiApiKey,ae=await Nl.refinePlaystyleChat(re,H,I,{name:n,personality:s},a);O(ae.updatedProfile),C(xe=>[...xe,{role:"model",content:ae.aiResponse}])}catch(re){console.error("Chat Error:",re),C(ae=>[...ae,{role:"model",content:"My connection to the leyline flickered. Please repeat that."}])}finally{B(!1)}},X=async()=>{l("synthesis"),I&&r&&await r(I),e()},q=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),se())};return t?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"relative w-full max-w-6xl h-[85vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-20 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o==="selection"&&i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 space-y-12 animate-fade-in",children:[i.jsxs("div",{className:"text-center space-y-4",children:[i.jsx("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Choose Your Path"}),i.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"How shall we determine your magical signature?"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl",children:[i.jsxs("button",{onClick:V,className:"group relative bg-gray-800/50 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[i.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:i.jsx("svg",{className:"w-32 h-32 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M13 2L3 14h9v8l10-12h-9l9-8z"})})}),i.jsxs("div",{className:"relative z-10 space-y-4",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Quick Setup"}),i.jsxs("p",{className:"text-gray-400 group-hover:text-gray-300",children:["Answer ",J5," rapid-fire questions to generate a baseline profile. Best for getting started quickly."]}),i.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-indigo-400 uppercase tracking-wider",children:["Start Assessment ",i.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]}),i.jsxs("button",{onClick:Z,className:"group relative bg-gray-800/50 hover:bg-purple-900/20 border border-gray-700 hover:border-purple-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10",children:[i.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:i.jsx("svg",{className:"w-32 h-32 text-purple-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),i.jsxs("div",{className:"relative z-10 space-y-4",children:[i.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),i.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-purple-300 transition-colors",children:"Deep Dive"}),i.jsx("p",{className:"text-gray-400 group-hover:text-gray-300",children:"Have a conversation with the Oracle. Iterate on your preferences in real-time for a highly tailored profile."}),i.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-purple-400 uppercase tracking-wider",children:["Enter The Sanctum ",i.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]})]}),i.jsx("div",{className:"text-gray-500 text-sm",children:"You can always retake this assessment later from your profile settings."})]}),o==="quick"&&i.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-900",children:[i.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-gray-900/50",children:[i.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 mr-3"}),"Quick Assessment"]}),i.jsxs("div",{className:"text-sm font-mono text-indigo-400",children:["Q",m.length+1," / ",J5]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-8 flex flex-col items-center justify-center",children:c==="loading"?i.jsxs("div",{className:"flex flex-col items-center space-y-4 animate-pulse",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),i.jsx("p",{className:"text-indigo-300 font-medium",children:"Consulting the archives..."})]}):y&&i.jsxs("div",{className:"max-w-2xl w-full space-y-8 animate-fade-in-up",children:[i.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:{width:`${m.length/J5*100}%`}})}),i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-relaxed text-center",children:y.question}),i.jsx("div",{className:"grid grid-cols-1 gap-3",children:y.choices.map((U,H)=>{const re=w===U;return i.jsxs("button",{onClick:()=>G(U),disabled:w!==null,className:`
                                                            group flex items-center p-4 rounded-xl border transition-all duration-200 text-left
                                                            ${re?"bg-indigo-600/20 border-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-gray-800 border-gray-700 hover:bg-gray-750 hover:border-gray-600"}
                                                            ${w&&!re?"opacity-50":""}
                                                        `,children:[i.jsx("span",{className:`
                                                            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 transition-colors
                                                            ${re?"bg-indigo-500 text-white":"bg-gray-700 text-gray-400 group-hover:bg-gray-600"}
                                                        `,children:String.fromCharCode(65+H)}),i.jsx("span",{className:`text-lg transition-colors ${re?"text-white":"text-gray-300 group-hover:text-white"}`,dangerouslySetInnerHTML:{__html:U}})]},H)})})]})})]}),o==="advanced"&&i.jsxs("div",{className:"flex-1 flex h-full",children:[i.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 border-r border-gray-800 w-2/3",children:[i.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center px-6 bg-gray-900/80 backdrop-blur-sm z-10",children:[i.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3",children:i.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-white font-bold",children:n}),i.jsx("p",{className:"text-xs text-purple-400",children:"Deep Dive Analysis"})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[k.map((U,H)=>i.jsx("div",{className:`flex ${U.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`
                                            max-w-[80%] rounded-2xl p-4 text-sm leading-relaxed
                                            ${U.role==="user"?"bg-purple-600 text-white rounded-br-none":"bg-gray-800 text-gray-200 border border-gray-700 rounded-bl-none"}
                                        `,children:U.content})},H)),M&&i.jsx("div",{className:"flex justify-start",children:i.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 border border-gray-700 rounded-bl-none flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),i.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-100"}),i.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-200"})]})}),i.jsx("div",{ref:E})]}),i.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:L,onChange:U=>_(U.target.value),onKeyDown:q,placeholder:"Describe your playstyle...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500",disabled:M}),i.jsx("button",{onClick:se,disabled:M||!L.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 rounded-xl font-bold transition-colors",children:"Send"})]})})]}),i.jsxs("div",{className:"w-1/3 bg-gray-950 p-6 overflow-y-auto border-l border-gray-800 hidden md:block",children:[i.jsxs("h3",{className:"text-white font-bold mb-6 flex items-center",children:[i.jsx("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Live Profile Summary"]}),I?i.jsxs("div",{className:"space-y-6 animate-fade-in",children:[i.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800",children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Analysis"}),i.jsx("div",{className:"text-gray-300 text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:I.summary||"Gathering data..."}})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Dominant Traits"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:I.tags?.length>0?I.tags.map((U,H)=>i.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:U},H)):i.jsx("span",{className:"text-gray-600 text-xs italic",children:"Pending..."})})]}),I.scores&&i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Psychographics"}),Object.entries(I.scores).map(([U,H])=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1 capitalize",children:[i.jsx("span",{children:U.replace(/([A-Z])/g," $1").trim()}),i.jsxs("span",{children:[H,"%"]})]}),i.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-indigo-500",style:{width:`${H}%`}})})]},U))]}),i.jsxs("div",{className:"pt-6 border-t border-gray-800",children:[i.jsx("button",{onClick:X,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold shadow-lg hover:shadow-green-500/20 transition-all",children:"Finalize Profile"}),i.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Click whenever you feel the profile is accurate."})]})]}):i.jsxs("div",{className:"text-center py-10 text-gray-600",children:[i.jsx("div",{className:"animate-pulse mb-2 text-4xl",children:""}),i.jsx("p",{className:"text-sm",children:"The Oracle is listening..."})]})]})]}),o==="synthesis"&&i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6 bg-gray-900 p-8",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500"}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i.jsx("div",{className:"h-10 w-10 bg-green-500/20 rounded-full animate-pulse"})})]}),i.jsx("h3",{className:"text-2xl font-bold text-white",children:"Finalizing your Grimoire..."}),i.jsx("p",{className:"text-gray-400",children:"Saving your magical identity to the archives."})]}),o==="error"&&i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4 bg-gray-900 text-center p-8",children:[i.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),i.jsx("h3",{className:"text-2xl font-bold text-white",children:"Something went wrong"}),i.jsx("p",{className:"text-red-300 max-w-md mx-auto",children:S}),i.jsx("button",{onClick:R,className:"mt-6 bg-gray-800 hover:bg-gray-700 text-white py-3 px-8 rounded-lg transition-colors border border-gray-600",children:"Try Again"})]})]})}):null},R5e=({isOpen:t,onClose:e,profile:r,onRetake:n,userImage:s})=>{if(!t)return null;if(!r)return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"relative w-full max-w-md bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-8 text-center space-y-6",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:s?i.jsx("img",{src:s,alt:"User",className:"w-full h-full object-cover"}):i.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Playstyle Found"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"You haven't taken the assessment yet. Discover your magical identity and get better recommendations!"})]}),i.jsx("button",{onClick:n,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-0.5",children:"Start Assessment"})]})});const{summary:a,tags:o,scores:l,archetypes:c}=r;return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"relative w-full max-w-6xl bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[i.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-800/50 p-8 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[i.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-6 ring-4 ring-gray-800 overflow-hidden",children:s?i.jsx("img",{src:s,alt:"User",className:"w-full h-full object-cover"}):i.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Playstyle"}),i.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:o&&o.map((u,h)=>i.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:u},h))}),i.jsx("button",{onClick:n,className:"mt-auto w-full py-3 px-4 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg text-sm font-bold transition-all border border-gray-600 hover:border-gray-500",children:"Retake Assessment"})]}),i.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Analysis Summary"}),i.jsxs("p",{className:"text-gray-300 leading-relaxed text-lg font-serif italic border-l-4 border-indigo-500 pl-4 bg-gray-800/30 py-4 pr-4 rounded-r",children:['"',a,'"']})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),i.jsx("div",{className:"space-y-4",children:l&&Object.entries(l).map(([u,h])=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[i.jsx("span",{className:"text-gray-400 capitalize",children:u.replace(/([A-Z])/g," $1").trim()}),i.jsxs("span",{className:"text-white font-mono",children:[h,"/100"]})]}),i.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full rounded-full ${D5e(h)}`,style:{width:`${h}%`}})})]},u))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Recommended Archetypes"}),i.jsx("div",{className:"grid grid-cols-1 gap-3",children:c&&c.map((u,h)=>i.jsxs("div",{className:"bg-gray-800/80 p-4 rounded-lg border border-gray-700 flex items-center gap-3",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),i.jsx("span",{className:"text-gray-200 font-medium",children:u})]},h))})]})]})]})]})]})})};function D5e(t){return t>75?"bg-green-500":t>50?"bg-blue-500":t>25?"bg-yellow-500":"bg-red-500"}const B5e=[{id:"alpha_tester",label:"Alpha Tester",icon:"",description:"Restoring balance to the multiverse."},{id:"bug_hunter",label:"Bug Hunter",icon:"",description:"Tracking down pests in the code."},{id:"architect",label:"Architect",icon:"",description:"Building the foundation of the future."},{id:"spark_ignited",label:"Spark Ignited",icon:"",description:"First to walk the planes."},{id:"data_scryer",label:"Data Scryer",icon:"",description:"Analyzing the meta streams."},{id:"stress_tester",label:"Stress Tester",icon:"",description:"Breaking things so we can fix them."},{id:"feedback_loop",label:"Feedback Loop",icon:"",description:"Iterating towards perfection."},{id:"void_gazer",label:"Void Gazer",icon:"",description:"Staring into the console logs."}],F5e=({isOpen:t,onClose:e,currentBadgeId:r,onSelect:n,isMaster:s})=>t?i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto w-full h-full flex items-center justify-center md:pl-[250px]",children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-2xl mx-4 overflow-hidden animate-scale-in",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-amber-500",children:""})," Customize Your Badge"]}),i.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a badge to display next to your profile."})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto custom-scrollbar",children:i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:B5e.filter(a=>a.id!=="architect"||s).map(a=>i.jsxs("button",{onClick:()=>n(a),className:`flex items-center gap-4 p-4 rounded-xl border text-left transition-all ${r===a.id?"bg-indigo-900/30 border-indigo-500 ring-1 ring-indigo-500/50":"bg-gray-800/30 border-gray-700 hover:bg-gray-800 hover:border-gray-600"}`,children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-2xl shadow-inner border border-gray-700",children:a.icon}),i.jsxs("div",{children:[i.jsx("h3",{className:`font-bold ${r===a.id?"text-indigo-300":"text-white"}`,children:a.label}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]})]},a.id))})}),i.jsx("div",{className:"p-4 bg-gray-800/50 border-t border-gray-800 text-center text-xs text-gray-500",children:"Thank you for being an early supporter of MTG-Forge."})]})]}):null,lr={FREE:"free",TIER_1:"tier_1",TIER_2:"tier_2",TIER_3:"tier_3",TIER_4:"tier_4",TIER_5:"tier_5"},ta={[lr.FREE]:{name:"Initiate",prices:{monthly:null,biannual:null,yearly:null},description:"The journey begins. Track up to 3 decks and 300 cards.",limits:{collection:300,wishlist:105,decks:3,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[lr.TIER_1]:{name:"Apprentice",prices:{monthly:"price_1SnxT7RZLrZbIKATICyA3jfB",quarterly:"price_1StfhDDBKqoK8H1RYlATyyeh",biannual:"price_1SnxUeRZLrZbIKATlErTgHtz",yearly:"price_1SnxUuRZLrZbIKATm6nmPnUr"},description:"Perfect for new potential. Store up to 10 decks and 1,000 cards.",limits:{collection:1e3,wishlist:300,decks:10,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[lr.TIER_2]:{name:"Magician",prices:{monthly:"price_1SnvK5DBKqoK8H1Rj7uSTSfw",quarterly:"price_1StfgoDBKqoK8H1Rr5pIrd1o",biannual:"price_1SnvVSDBKqoK8H1RFAqc0iIH",yearly:"price_1SnvVfDBKqoK8H1RryOTO2p8"},description:"Unlock the power of organization. 25 decks, 2,000 cards, and advanced tools.",limits:{collection:2e3,wishlist:1e3,decks:25,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!0,pods:!1}},[lr.TIER_3]:{name:"Wizard",prices:{monthly:"price_1SnvKxDBKqoK8H1RXvh1VsT3",quarterly:"price_1Stf5iDBKqoK8H1RMHbM4yzr",biannual:"price_1SnvUkDBKqoK8H1RgX9mlcxs",yearly:"price_1SnvUwDBKqoK8H1RAUVYJtmM"},description:"Master your craft. 55 decks, 5,000 cards, Pods, and the AI Deck Doctor.",limits:{collection:5e3,wishlist:2500,decks:55,pods:3},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[lr.TIER_4]:{name:"Archmage",prices:{monthly:"price_1SnvMxDBKqoK8H1RVcOon0kC",quarterly:"price_1Stf5GDBKqoK8H1RthB3bBDC",biannual:"price_1SnvUSDBKqoK8H1RRAXjFJ1h",yearly:"price_1SnvUSDBKqoK8H1RBMhvTUZA"},description:"Command a vast library. 100 decks, 10,000 cards, and advanced management.",limits:{collection:1e4,wishlist:5e3,decks:100,pods:5},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[lr.TIER_5]:{name:"Planeswalker",prices:{monthly:"price_1SnvSmDBKqoK8H1RCezHNZSu",quarterly:"price_1SteBkDBKqoK8H1RoXR18wB2",biannual:"price_1SnvTcDBKqoK8H1RAmz1kB1d",yearly:"price_1SnvTcDBKqoK8H1Rn1rFWAws"},description:"Rule the multiverse. Unlimited access to all features and storage.",limits:{collection:1/0,wishlist:1/0,decks:1/0,pods:1/0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}}};function An(t){return ta[t]||ta[lr.FREE]}const $5e=typeof document<"u"?Ie.useLayoutEffect:()=>{},wp=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},ym=t=>t&&"window"in t&&t.window===t?t:wp(t).defaultView||window;function U5e(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function z5e(t){return U5e(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let V5e=!1;function gO(){return V5e}function bte(t,e){if(!gO())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:z5e(r)?r=r.host:r=r.parentNode}return!1}const EI=(t=document)=>{var e;if(!gO())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function vte(t){return gO()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function wte(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=wte(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function js(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=wte(t))&&(n&&(n+=" "),n+=e);return n}function q5e(t){if(H5e())t.focus({preventScroll:!0});else{let e=W5e(t);t.focus(),G5e(e)}}let Z5=null;function H5e(){if(Z5==null){Z5=!1;try{document.createElement("div").focus({get preventScroll(){return Z5=!0,!0}})}catch{}}return Z5}function W5e(t){let e=t.parentNode,r=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),r}function G5e(t){for(let{element:e,scrollTop:r,scrollLeft:n}of t)e.scrollTop=r,e.scrollLeft=n}function P_(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let r=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(r)&&r.some(n=>t.test(n.brand))||t.test(window.navigator.userAgent)}function Nte(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function hb(t){let e=null;return()=>(e==null&&(e=t()),e)}const A4=hb(function(){return Nte(/^Mac/i)}),K5e=hb(function(){return Nte(/^iPad/i)||A4()&&navigator.maxTouchPoints>1}),Y5e=hb(function(){return P_(/AppleWebKit/i)&&!X5e()}),X5e=hb(function(){return P_(/Chrome/i)}),Q5e=hb(function(){return P_(/Android/i)}),J5e=hb(function(){return P_(/Firefox/i)});function n2(t,e,r=!0){var n,s;let{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}=e;J5e()&&(!((s=window.event)===null||s===void 0||(n=s.type)===null||n===void 0)&&n.startsWith("key"))&&t.target==="_blank"&&(A4()?a=!0:o=!0);let u=Y5e()&&A4()&&!K5e()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c,detail:1,bubbles:!0,cancelable:!0});n2.isOpening=r,q5e(t),t.dispatchEvent(u),n2.isOpening=!1}n2.isOpening=!1;function jte(){let t=b.useRef(new Map),e=b.useCallback((s,a,o,l)=>{let c=l?.once?(...u)=>{t.current.delete(o),o(...u)}:o;t.current.set(o,{type:a,eventTarget:s,fn:c,options:l}),s.addEventListener(a,c,l)},[]),r=b.useCallback((s,a,o,l)=>{var c;let u=((c=t.current.get(o))===null||c===void 0?void 0:c.fn)||o;s.removeEventListener(a,u,l),t.current.delete(o)},[]),n=b.useCallback(()=>{t.current.forEach((s,a)=>{r(s.eventTarget,s.type,a,s.options)})},[r]);return b.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function Z5e(t){return t.pointerType===""&&t.isTrusted?!0:Q5e()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function kte(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function eNe(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function _te(t){let e=b.useRef({isFocused:!1,observer:null});return $5e(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]),b.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=r.target,s=a=>{if(e.current.isFocused=!1,n.disabled){let o=kte(a);t?.(o)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",s,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let o=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let tNe=!1,ow=null,AI=new Set,_1=new Map,Ym=!1,TI=!1;const rNe={Tab:!0,Escape:!0};function xO(t,e){for(let r of AI)r(t,e)}function nNe(t){return!(t.metaKey||!A4()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function T4(t){Ym=!0,!n2.isOpening&&nNe(t)&&(ow="keyboard",xO("keyboard",t))}function cy(t){ow="pointer","pointerType"in t&&t.pointerType,(t.type==="mousedown"||t.type==="pointerdown")&&(Ym=!0,xO("pointer",t))}function Ste(t){!n2.isOpening&&Z5e(t)&&(Ym=!0,ow="virtual")}function Cte(t){t.target===window||t.target===document||tNe||!t.isTrusted||(!Ym&&!TI&&(ow="virtual",xO("virtual",t)),Ym=!1,TI=!1)}function Ete(){Ym=!1,TI=!0}function II(t){if(typeof window>"u"||typeof document>"u"||_1.get(ym(t)))return;const e=ym(t),r=wp(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Ym=!0,n.apply(this,arguments)},r.addEventListener("keydown",T4,!0),r.addEventListener("keyup",T4,!0),r.addEventListener("click",Ste,!0),e.addEventListener("focus",Cte,!0),e.addEventListener("blur",Ete,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",cy,!0),r.addEventListener("pointermove",cy,!0),r.addEventListener("pointerup",cy,!0)),e.addEventListener("beforeunload",()=>{Ate(t)},{once:!0}),_1.set(e,{focus:n})}const Ate=(t,e)=>{const r=ym(t),n=wp(t);e&&n.removeEventListener("DOMContentLoaded",e),_1.has(r)&&(r.HTMLElement.prototype.focus=_1.get(r).focus,n.removeEventListener("keydown",T4,!0),n.removeEventListener("keyup",T4,!0),n.removeEventListener("click",Ste,!0),r.removeEventListener("focus",Cte,!0),r.removeEventListener("blur",Ete,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",cy,!0),n.removeEventListener("pointermove",cy,!0),n.removeEventListener("pointerup",cy,!0)),_1.delete(r))};function sNe(t){const e=wp(t);let r;return e.readyState!=="loading"?II(t):(r=()=>{II(t)},e.addEventListener("DOMContentLoaded",r)),()=>Ate(t,r)}typeof document<"u"&&sNe();function Tte(){return ow!=="pointer"}const iNe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function aNe(t,e,r){let n=wp(r?.target);const s=typeof window<"u"?ym(r?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?ym(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?ym(r?.target).HTMLElement:HTMLElement,l=typeof window<"u"?ym(r?.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof s&&!iNe.has(n.activeElement.type)||n.activeElement instanceof a||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof l&&!rNe[r.key])}function oNe(t,e,r){II(),b.useEffect(()=>{let n=(s,a)=>{aNe(!!r?.isTextInput,s,a)&&t(Tte())};return AI.add(n),()=>{AI.delete(n)}},e)}function lNe(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:s}=t;const a=b.useCallback(c=>{if(c.target===c.currentTarget)return n&&n(c),s&&s(!1),!0},[n,s]),o=_te(a),l=b.useCallback(c=>{const u=wp(c.target),h=u?EI(u):EI();c.target===c.currentTarget&&h===vte(c.nativeEvent)&&(r&&r(c),s&&s(!0),o(c))},[s,r,o]);return{focusProps:{onFocus:!e&&(r||s||n)?l:void 0,onBlur:!e&&(n||s)?a:void 0}}}function cNe(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:s}=t,a=b.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:l}=jte(),c=b.useCallback(f=>{f.currentTarget.contains(f.target)&&a.current.isFocusWithin&&!f.currentTarget.contains(f.relatedTarget)&&(a.current.isFocusWithin=!1,l(),r&&r(f),s&&s(!1))},[r,s,a,l]),u=_te(c),h=b.useCallback(f=>{if(!f.currentTarget.contains(f.target))return;const m=wp(f.target),g=EI(m);if(!a.current.isFocusWithin&&g===vte(f.nativeEvent)){n&&n(f),s&&s(!0),a.current.isFocusWithin=!0,u(f);let y=f.currentTarget;o(m,"focus",v=>{if(a.current.isFocusWithin&&!bte(y,v.target)){let w=new m.defaultView.FocusEvent("blur",{relatedTarget:v.target});eNe(w,y);let N=kte(w);c(N)}},{capture:!0})}},[n,s,u,o,c]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:h,onBlur:c}}}let PI=!1,eN=0;function uNe(){PI=!0,setTimeout(()=>{PI=!1},50)}function X$(t){t.pointerType==="touch"&&uNe()}function dNe(){if(!(typeof document>"u"))return eN===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",X$),eN++,()=>{eN--,!(eN>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",X$)}}function Ite(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:s}=t,[a,o]=b.useState(!1),l=b.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;b.useEffect(dNe,[]);let{addGlobalListener:c,removeAllGlobalListeners:u}=jte(),{hoverProps:h,triggerHoverEnd:f}=b.useMemo(()=>{let m=(v,w)=>{if(l.pointerType=w,s||w==="touch"||l.isHovered||!v.currentTarget.contains(v.target))return;l.isHovered=!0;let N=v.currentTarget;l.target=N,c(wp(v.target),"pointerover",k=>{l.isHovered&&l.target&&!bte(l.target,k.target)&&g(k,k.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:N,pointerType:w}),r&&r(!0),o(!0)},g=(v,w)=>{let N=l.target;l.pointerType="",l.target=null,!(w==="touch"||!l.isHovered||!N)&&(l.isHovered=!1,u(),n&&n({type:"hoverend",target:N,pointerType:w}),r&&r(!1),o(!1))},y={};return typeof PointerEvent<"u"&&(y.onPointerEnter=v=>{PI&&v.pointerType==="mouse"||m(v,v.pointerType)},y.onPointerLeave=v=>{!s&&v.currentTarget.contains(v.target)&&g(v,v.pointerType)}),{hoverProps:y,triggerHoverEnd:g}},[e,r,n,s,l,c,u]);return b.useEffect(()=>{s&&f({currentTarget:l.target},l.pointerType)},[s]),{hoverProps:h,isHovered:a}}function Pte(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,s=b.useRef({isFocused:!1,isFocusVisible:e||Tte()}),[a,o]=b.useState(!1),[l,c]=b.useState(()=>s.current.isFocused&&s.current.isFocusVisible),u=b.useCallback(()=>c(s.current.isFocused&&s.current.isFocusVisible),[]),h=b.useCallback(g=>{s.current.isFocused=g,o(g),u()},[u]);oNe(g=>{s.current.isFocusVisible=g,u()},[],{isTextInput:r});let{focusProps:f}=lNe({isDisabled:n,onFocusChange:h}),{focusWithinProps:m}=cNe({isDisabled:!n,onFocusWithinChange:h});return{isFocused:a,isFocusVisible:l,focusProps:n?m:f}}var hNe=Object.defineProperty,fNe=(t,e,r)=>e in t?hNe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,aE=(t,e,r)=>(fNe(t,typeof e!="symbol"?e+"":e,r),r);let pNe=class{constructor(){aE(this,"current",this.detect()),aE(this,"handoffState","pending"),aE(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},sh=new pNe;function bg(t){var e;return sh.isServer?null:t==null?document:(e=t?.ownerDocument)!=null?e:document}function LI(t){var e,r;return sh.isServer?null:t==null?document:(r=(e=t?.getRootNode)==null?void 0:e.call(t))!=null?r:document}function Lte(t){var e,r;return(r=(e=LI(t))==null?void 0:e.activeElement)!=null?r:null}function mNe(t){return Lte(t)===t}function L_(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Ff(){let t=[],e={addEventListener(r,n,s,a){return r.addEventListener(n,s,a),e.add(()=>r.removeEventListener(n,s,a))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return L_(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,s){let a=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:s}),this.add(()=>{Object.assign(r.style,{[n]:a})})},group(r){let n=Ff();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let s of t.splice(n,1))s()}},dispose(){for(let r of t.splice(0))r()}};return e}function vg(){let[t]=b.useState(Ff);return b.useEffect(()=>()=>t.dispose(),[t]),t}let El=(t,e)=>{sh.isServer?b.useEffect(t,e):b.useLayoutEffect(t,e)};function wg(t){let e=b.useRef(t);return El(()=>{e.current=t},[t]),e}let fn=function(t){let e=wg(t);return Ie.useCallback((...r)=>e.current(...r),[e])};function gNe(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function xNe(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function Ote({disabled:t=!1}={}){let e=b.useRef(null),[r,n]=b.useState(!1),s=vg(),a=fn(()=>{e.current=null,n(!1),s.dispose()}),o=fn(l=>{if(s.dispose(),e.current===null){e.current=l.currentTarget,n(!0);{let c=bg(l.currentTarget);s.addEventListener(c,"pointerup",a,!1),s.addEventListener(c,"pointermove",u=>{if(e.current){let h=gNe(u);n(xNe(h,e.current.getBoundingClientRect()))}},!1),s.addEventListener(c,"pointercancel",a,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:o,onPointerUp:a,onClick:a}}}function wh(t){return b.useMemo(()=>t,Object.values(t))}let yNe=b.createContext(void 0);function yO(){return b.useContext(yNe)}function OI(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function bu(t,e,...r){if(t in e){let s=e[t];return typeof s=="function"?s(...r):s}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,bu),n}var Fy=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Fy||{}),W0=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(W0||{});function bo(){let t=vNe();return b.useCallback(e=>bNe({mergeRefs:t,...e}),[t])}function bNe({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:s,visible:a=!0,name:o,mergeRefs:l}){l=l??wNe;let c=Mte(e,t);if(a)return tN(c,r,n,o,l);let u=s??0;if(u&2){let{static:h=!1,...f}=c;if(h)return tN(f,r,n,o,l)}if(u&1){let{unmount:h=!0,...f}=c;return bu(h?0:1,{0(){return null},1(){return tN({...f,hidden:!0,style:{display:"none"}},r,n,o,l)}})}return tN(c,r,n,o,l)}function tN(t,e={},r,n,s){let{as:a=r,children:o,refName:l="ref",...c}=oE(t,["unmount","static"]),u=t.ref!==void 0?{[l]:t.ref}:{},h=typeof o=="function"?o(e):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(e)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let f={};if(e){let m=!1,g=[];for(let[y,v]of Object.entries(e))typeof v=="boolean"&&(m=!0),v===!0&&g.push(y.replace(/([A-Z])/g,w=>`-${w.toLowerCase()}`));if(m){f["data-headlessui-state"]=g.join(" ");for(let y of g)f[`data-${y}`]=""}}if(uy(a)&&(Object.keys(L0(c)).length>0||Object.keys(L0(f)).length>0))if(!b.isValidElement(h)||Array.isArray(h)&&h.length>1||jNe(h)){if(Object.keys(L0(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(L0(c)).concat(Object.keys(L0(f))).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`))}else{let m=h.props,g=m?.className,y=typeof g=="function"?(...N)=>OI(g(...N),c.className):OI(g,c.className),v=y?{className:y}:{},w=Mte(h.props,L0(oE(c,["ref"])));for(let N in f)N in w&&delete f[N];return b.cloneElement(h,Object.assign({},w,f,u,{ref:s(NNe(h),u.ref)},v))}return b.createElement(a,Object.assign({},oE(c,["ref"]),!uy(a)&&u,!uy(a)&&f),h)}function vNe(){let t=b.useRef([]),e=b.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function wNe(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function Mte(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):e[s]=n[s];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[s=>{var a;return(a=s?.preventDefault)==null?void 0:a.call(s)}]);for(let n in r)Object.assign(e,{[n](s,...a){let o=r[n];for(let l of o){if((s instanceof Event||s?.nativeEvent instanceof Event)&&s.defaultPrevented)return;l(s,...a)}}});return e}function MI(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):e[s]=n[s];for(let n in r)Object.assign(e,{[n](...s){let a=r[n];for(let o of a)o?.(...s)}});return e}function Qa(t){var e;return Object.assign(b.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function L0(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function oE(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function NNe(t){return Ie.version.split(".")[0]>="19"?t.props.ref:t.ref}function uy(t){return t===b.Fragment||t===Symbol.for("react.fragment")}function jNe(t){return uy(t.type)}function kNe(t,e,r){let[n,s]=b.useState(r),a=t!==void 0,o=b.useRef(a),l=b.useRef(!1),c=b.useRef(!1);return a&&!o.current&&!l.current?(l.current=!0,o.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&o.current&&!c.current&&(c.current=!0,o.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?t:n,fn(u=>(a||Kn.flushSync(()=>s(u)),e?.(u)))]}function _Ne(t){let[e]=b.useState(t);return e}function Rte(t={},e=null,r=[]){for(let[n,s]of Object.entries(t))Bte(r,Dte(e,n),s);return r}function Dte(t,e){return t?t+"["+e+"]":e}function Bte(t,e,r){if(Array.isArray(r))for(let[n,s]of r.entries())Bte(t,Dte(e,n.toString()),s);else r instanceof Date?t.push([e,r.toISOString()]):typeof r=="boolean"?t.push([e,r?"1":"0"]):typeof r=="string"?t.push([e,r]):typeof r=="number"?t.push([e,`${r}`]):r==null?t.push([e,""]):CNe(r)&&!b.isValidElement(r)&&Rte(r,e,t)}function SNe(t){var e,r;let n=(e=t?.form)!=null?e:t.closest("form");if(n){for(let s of n.elements)if(s!==t&&(s.tagName==="INPUT"&&s.type==="submit"||s.tagName==="BUTTON"&&s.type==="submit"||s.nodeName==="INPUT"&&s.type==="image")){s.click();return}(r=n.requestSubmit)==null||r.call(n)}}function CNe(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}let ENe="span";var $y=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))($y||{});function ANe(t,e){var r;let{features:n=1,...s}=t,a={ref:e,"aria-hidden":(n&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return bo()({ourProps:a,theirProps:s,slot:{},defaultTag:ENe,name:"Hidden"})}let s2=Qa(ANe),TNe=b.createContext(null);function INe({children:t}){let e=b.useContext(TNe);if(!e)return Ie.createElement(Ie.Fragment,null,t);let{target:r}=e;return r?Kn.createPortal(Ie.createElement(Ie.Fragment,null,t),r):null}function PNe({data:t,form:e,disabled:r,onReset:n,overrides:s}){let[a,o]=b.useState(null),l=vg();return b.useEffect(()=>{if(n&&a)return l.addEventListener(a,"reset",n)},[a,e,n]),Ie.createElement(INe,null,Ie.createElement(LNe,{setForm:o,formId:e}),Rte(t).map(([c,u])=>Ie.createElement(s2,{features:$y.Hidden,...L0({key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:e,disabled:r,name:c,value:u,...s})})))}function LNe({setForm:t,formId:e}){return b.useEffect(()=>{if(e){let r=document.getElementById(e);r&&t(r)}},[t,e]),e?null:Ie.createElement(s2,{features:$y.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:r=>{if(!r)return;let n=r.closest("form");n&&t(n)}})}let ONe=b.createContext(void 0);function Fte(){return b.useContext(ONe)}function MNe(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function pf(t){return MNe(t)&&"tagName"in t}function dh(t){return pf(t)&&"accessKey"in t}function Xd(t){return pf(t)&&"tabIndex"in t}function RNe(t){return pf(t)&&"style"in t}function DNe(t){return dh(t)&&t.nodeName==="IFRAME"}function $te(t){return dh(t)&&t.nodeName==="INPUT"}function RI(t){return dh(t)&&t.nodeName==="LABEL"}function BNe(t){return dh(t)&&t.nodeName==="FIELDSET"}function Ute(t){return dh(t)&&t.nodeName==="LEGEND"}function FNe(t){return pf(t)?t.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function zte(t){let e=t.parentElement,r=null;for(;e&&!BNe(e);)Ute(e)&&(r=e),e=e.parentElement;let n=e?.getAttribute("disabled")==="";return n&&$Ne(r)?!1:n}function $Ne(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(Ute(e))return!1;e=e.previousElementSibling}return!0}let Vte=Symbol();function qte(t,e=!0){return Object.assign(t,{[Vte]:e})}function Ll(...t){let e=b.useRef(t);b.useEffect(()=>{e.current=t},[t]);let r=fn(n=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return t.every(n=>n==null||n?.[Vte])?void 0:r}let O_=b.createContext(null);O_.displayName="DescriptionContext";function Hte(){let t=b.useContext(O_);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Hte),e}return t}function UNe(){var t,e;return(e=(t=b.useContext(O_))==null?void 0:t.value)!=null?e:void 0}function Wte(){let[t,e]=b.useState([]);return[t.length>0?t.join(" "):void 0,b.useMemo(()=>function(r){let n=fn(a=>(e(o=>[...o,a]),()=>e(o=>{let l=o.slice(),c=l.indexOf(a);return c!==-1&&l.splice(c,1),l}))),s=b.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props,value:r.value}),[n,r.slot,r.name,r.props,r.value]);return Ie.createElement(O_.Provider,{value:s},r.children)},[e])]}let zNe="p";function VNe(t,e){let r=b.useId(),n=yO(),{id:s=`headlessui-description-${r}`,...a}=t,o=Hte(),l=Ll(e);El(()=>o.register(s),[s,o.register]);let c=wh({...o.slot,disabled:n||!1}),u={ref:l,...o.props,id:s};return bo()({ourProps:u,theirProps:a,slot:c,defaultTag:zNe,name:o.name||"Description"})}let qNe=Qa(VNe),Gte=Object.assign(qNe,{});var ef=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(ef||{});let M_=b.createContext(null);M_.displayName="LabelContext";function Kte(){let t=b.useContext(M_);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Kte),e}return t}function Yte(t){var e,r,n;let s=(r=(e=b.useContext(M_))==null?void 0:e.value)!=null?r:void 0;return((n=void 0)!=null?n:0)>0?[s,...t].filter(Boolean).join(" "):s}function HNe({inherit:t=!1}={}){let e=Yte(),[r,n]=b.useState([]),s=t?[e,...r].filter(Boolean):r;return[s.length>0?s.join(" "):void 0,b.useMemo(()=>function(a){let o=fn(c=>(n(u=>[...u,c]),()=>n(u=>{let h=u.slice(),f=h.indexOf(c);return f!==-1&&h.splice(f,1),h}))),l=b.useMemo(()=>({register:o,slot:a.slot,name:a.name,props:a.props,value:a.value}),[o,a.slot,a.name,a.props,a.value]);return Ie.createElement(M_.Provider,{value:l},a.children)},[n])]}let WNe="label";function GNe(t,e){var r;let n=b.useId(),s=Kte(),a=Fte(),o=yO(),{id:l=`headlessui-label-${n}`,htmlFor:c=a??((r=s.props)==null?void 0:r.htmlFor),passive:u=!1,...h}=t,f=Ll(e);El(()=>s.register(l),[l,s.register]);let m=fn(v=>{let w=v.currentTarget;if(!(v.target!==v.currentTarget&&FNe(v.target))&&(RI(w)&&v.preventDefault(),s.props&&"onClick"in s.props&&typeof s.props.onClick=="function"&&s.props.onClick(v),RI(w))){let N=document.getElementById(w.htmlFor);if(N){let k=N.getAttribute("disabled");if(k==="true"||k==="")return;let C=N.getAttribute("aria-disabled");if(C==="true"||C==="")return;($te(N)&&(N.type==="file"||N.type==="radio"||N.type==="checkbox")||N.role==="radio"||N.role==="checkbox"||N.role==="switch")&&N.click(),N.focus({preventScroll:!0})}}}),g=wh({...s.slot,disabled:o||!1}),y={ref:f,...s.props,id:l,htmlFor:c,onClick:m};return u&&("onClick"in y&&(delete y.htmlFor,delete y.onClick),"onClick"in h&&delete h.onClick),bo()({ourProps:y,theirProps:h,slot:g,defaultTag:c?WNe:"div",name:s.name||"Label"})}let KNe=Qa(GNe),YNe=Object.assign(KNe,{}),XNe=b.createContext(()=>{});function Xte({value:t,children:e}){return Ie.createElement(XNe.Provider,{value:t},e)}let Qte=class extends Map{constructor(e){super(),this.factory=e}get(e){let r=super.get(e);return r===void 0&&(r=this.factory(e),this.set(e,r)),r}};var QNe=Object.defineProperty,JNe=(t,e,r)=>e in t?QNe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ZNe=(t,e,r)=>(JNe(t,e+"",r),r),Jte=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},eu=(t,e,r)=>(Jte(t,e,"read from private field"),r?r.call(t):e.get(t)),lE=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Q$=(t,e,r,n)=>(Jte(t,e,"write to private field"),e.set(t,r),r),zd,t1,r1;let eje=class{constructor(e){lE(this,zd,{}),lE(this,t1,new Qte(()=>new Set)),lE(this,r1,new Set),ZNe(this,"disposables",Ff()),Q$(this,zd,e),sh.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return eu(this,zd)}subscribe(e,r){if(sh.isServer)return()=>{};let n={selector:e,callback:r,current:e(eu(this,zd))};return eu(this,r1).add(n),this.disposables.add(()=>{eu(this,r1).delete(n)})}on(e,r){return sh.isServer?()=>{}:(eu(this,t1).get(e).add(r),this.disposables.add(()=>{eu(this,t1).get(e).delete(r)}))}send(e){let r=this.reduce(eu(this,zd),e);if(r!==eu(this,zd)){Q$(this,zd,r);for(let n of eu(this,r1)){let s=n.selector(eu(this,zd));Zte(n.current,s)||(n.current=s,n.callback(s))}for(let n of eu(this,t1).get(e.type))n(eu(this,zd),e)}}};zd=new WeakMap,t1=new WeakMap,r1=new WeakMap;function Zte(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:cE(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:cE(t.entries(),e.entries()):J$(t)&&J$(e)?cE(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function cE(t,e){do{let r=t.next(),n=e.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}while(!0)}function J$(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var tje=Object.defineProperty,rje=(t,e,r)=>e in t?tje(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Z$=(t,e,r)=>(rje(t,typeof e!="symbol"?e+"":e,r),r),nje=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(nje||{});let sje={0(t,e){let r=e.id,n=t.stack,s=t.stack.indexOf(r);if(s!==-1){let a=t.stack.slice();return a.splice(s,1),a.push(r),n=a,{...t,stack:n}}return{...t,stack:[...t.stack,r]}},1(t,e){let r=e.id,n=t.stack.indexOf(r);if(n===-1)return t;let s=t.stack.slice();return s.splice(n,1),{...t,stack:s}}},ije=class ere extends eje{constructor(){super(...arguments),Z$(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),Z$(this,"selectors",{isTop:(e,r)=>e.stack[e.stack.length-1]===r,inStack:(e,r)=>e.stack.includes(r)})}static new(){return new ere({stack:[]})}reduce(e,r){return bu(r.type,sje,e,r)}};const tre=new Qte(()=>ije.new());var uE={exports:{}},dE={};var eU;function aje(){if(eU)return dE;eU=1;var t=Mf();function e(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,s=t.useRef,a=t.useEffect,o=t.useMemo,l=t.useDebugValue;return dE.useSyncExternalStoreWithSelector=function(c,u,h,f,m){var g=s(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=o(function(){function w(O){if(!N){if(N=!0,k=O,O=f(O),m!==void 0&&y.hasValue){var L=y.value;if(m(L,O))return C=L}return C=O}if(L=C,r(k,O))return L;var _=f(O);return m!==void 0&&m(L,_)?(k=O,L):(k=O,C=_)}var N=!1,k,C,I=h===void 0?null:h;return[function(){return w(u())},I===null?void 0:function(){return w(I())}]},[u,h,f,m]);var v=n(c,g[0],g[1]);return a(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},dE}var tU;function oje(){return tU||(tU=1,uE.exports=aje()),uE.exports}var lje=oje();function rre(t,e,r=Zte){return lje.useSyncExternalStoreWithSelector(fn(n=>t.subscribe(cje,n)),fn(()=>t.state),fn(()=>t.state),fn(e),r)}function cje(t){return t}function lw(t,e){let r=b.useId(),n=tre.get(e),[s,a]=rre(n,b.useCallback(o=>[n.selectors.isTop(o,r),n.selectors.inStack(o,r)],[n,r]));return El(()=>{if(t)return n.actions.push(r),()=>n.actions.pop(r)},[n,t,r]),t?a?s:!0:!1}let DI=new Map,S1=new Map;function rU(t){var e;let r=(e=S1.get(t))!=null?e:0;return S1.set(t,r+1),r!==0?()=>nU(t):(DI.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>nU(t))}function nU(t){var e;let r=(e=S1.get(t))!=null?e:1;if(r===1?S1.delete(t):S1.set(t,r-1),r!==1)return;let n=DI.get(t);n&&(n["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",n["aria-hidden"]),t.inert=n.inert,DI.delete(t))}function uje(t,{allowed:e,disallowed:r}={}){let n=lw(t,"inert-others");El(()=>{var s,a;if(!n)return;let o=Ff();for(let c of(s=r?.())!=null?s:[])c&&o.add(rU(c));let l=(a=e?.())!=null?a:[];for(let c of l){if(!c)continue;let u=bg(c);if(!u)continue;let h=c.parentElement;for(;h&&h!==u.body;){for(let f of h.children)l.some(m=>f.contains(m))||o.add(rU(f));h=h.parentElement}}return o.dispose},[n,e,r])}function dje(t,e,r){let n=wg(s=>{let a=s.getBoundingClientRect();a.x===0&&a.y===0&&a.width===0&&a.height===0&&r()});b.useEffect(()=>{if(!t)return;let s=e===null?null:dh(e)?e:e.current;if(!s)return;let a=Ff();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>n.current(s));o.observe(s),a.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>n.current(s));o.observe(s),a.add(()=>o.disconnect())}return()=>a.dispose()},[e,n,t])}let I4=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),hje=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var tf=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(tf||{}),BI=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(BI||{}),fje=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(fje||{});function pje(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(I4)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function mje(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(hje)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var nre=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(nre||{});function gje(t,e=0){var r;return t===((r=bg(t))==null?void 0:r.body)?!1:bu(e,{0(){return t.matches(I4)},1(){let n=t;for(;n!==null;){if(n.matches(I4))return!0;n=n.parentElement}return!1}})}var xje=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(xje||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function mf(t){t?.focus({preventScroll:!0})}let yje=["textarea","input"].join(",");function bje(t){var e,r;return(r=(e=t?.matches)==null?void 0:e.call(t,yje))!=null?r:!1}function vje(t,e=r=>r){return t.slice().sort((r,n)=>{let s=e(r),a=e(n);if(s===null||a===null)return 0;let o=s.compareDocumentPosition(a);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function C1(t,e,{sorted:r=!0,relativeTo:n=null,skipElements:s=[]}={}){let a=Array.isArray(t)?t.length>0?LI(t[0]):document:LI(t),o=Array.isArray(t)?r?vje(t):t:e&64?mje(t):pje(t);s.length>0&&o.length>1&&(o=o.filter(g=>!s.some(y=>y!=null&&"current"in y?y?.current===g:y===g))),n=n??a?.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(n))-1;if(e&4)return Math.max(0,o.indexOf(n))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},h=0,f=o.length,m;do{if(h>=f||h+f<=0)return 0;let g=c+h;if(e&16)g=(g+f)%f;else{if(g<0)return 3;if(g>=f)return 1}m=o[g],m?.focus(u),h+=l}while(m!==Lte(m));return e&6&&bje(m)&&m.select(),2}function sre(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function wje(){return/Android/gi.test(window.navigator.userAgent)}function sU(){return sre()||wje()}function rN(t,e,r,n){let s=wg(r);b.useEffect(()=>{if(!t)return;function a(o){s.current(o)}return document.addEventListener(e,a,n),()=>document.removeEventListener(e,a,n)},[t,e,n])}function ire(t,e,r,n){let s=wg(r);b.useEffect(()=>{if(!t)return;function a(o){s.current(o)}return window.addEventListener(e,a,n),()=>window.removeEventListener(e,a,n)},[t,e,n])}const iU=30;function Nje(t,e,r){let n=wg(r),s=b.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let h=(function f(m){return typeof m=="function"?f(m()):Array.isArray(m)||m instanceof Set?m:[m]})(e);for(let f of h)if(f!==null&&(f.contains(u)||l.composed&&l.composedPath().includes(f)))return;return!gje(u,nre.Loose)&&u.tabIndex!==-1&&l.preventDefault(),n.current(l,u)},[n,e]),a=b.useRef(null);rN(t,"pointerdown",l=>{var c,u;sU()||(a.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),rN(t,"pointerup",l=>{if(sU()||!a.current)return;let c=a.current;return a.current=null,s(l,()=>c)},!0);let o=b.useRef({x:0,y:0});rN(t,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),rN(t,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=iU||Math.abs(c.y-o.current.y)>=iU))return s(l,()=>Xd(l.target)?l.target:null)},!0),ire(t,"blur",l=>s(l,()=>DNe(window.document.activeElement)?window.document.activeElement:null),!0)}function bO(...t){return b.useMemo(()=>bg(...t),[...t])}function are(t,e,r,n){let s=wg(r);b.useEffect(()=>{t=t??window;function a(o){s.current(o)}return t.addEventListener(e,a,n),()=>t.removeEventListener(e,a,n)},[t,e,n])}function ore(t,e){return b.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||e?.tagName==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function jje(t){return b.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function kje(t,e){let r=t(),n=new Set;return{getSnapshot(){return r},subscribe(s){return n.add(s),()=>n.delete(s)},dispatch(s,...a){let o=e[s].call(r,...a);o&&(r=o,n.forEach(l=>l()))}}}function _je(){let t;return{before({doc:e}){var r;let n=e.documentElement,s=(r=e.defaultView)!=null?r:window;t=Math.max(0,s.innerWidth-n.clientWidth)},after({doc:e,d:r}){let n=e.documentElement,s=Math.max(0,n.clientWidth-n.offsetWidth),a=Math.max(0,t-s);r.style(n,"paddingRight",`${a}px`)}}}function Sje(){return sre()?{before({doc:t,d:e,meta:r}){function n(s){for(let a of r().containers)for(let o of a())if(o.contains(s))return!0;return!1}e.microTask(()=>{var s;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let l=Ff();l.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let a=(s=window.scrollY)!=null?s:window.pageYOffset,o=null;e.addEventListener(t,"click",l=>{if(Xd(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),h=t.querySelector(u);Xd(h)&&!n(h)&&(o=h)}catch{}},!0),e.group(l=>{e.addEventListener(t,"touchstart",c=>{if(l.dispose(),Xd(c.target)&&RNe(c.target))if(n(c.target)){let u=c.target;for(;u.parentElement&&n(u.parentElement);)u=u.parentElement;l.style(u,"overscrollBehavior","contain")}else l.style(c.target,"touchAction","none")})}),e.addEventListener(t,"touchmove",l=>{if(Xd(l.target)){if($te(l.target))return;if(n(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;a!==c&&window.scrollTo(0,a),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function Cje(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function aU(t){let e={};for(let r of t)Object.assign(e,r(e));return e}let bm=kje(()=>new Map,{PUSH(t,e){var r;let n=(r=this.get(t))!=null?r:{doc:t,count:0,d:Ff(),meta:new Set,computedMeta:{}};return n.count++,n.meta.add(e),n.computedMeta=aU(n.meta),this.set(t,n),this},POP(t,e){let r=this.get(t);return r&&(r.count--,r.meta.delete(e),r.computedMeta=aU(r.meta)),this},SCROLL_PREVENT(t){let e={doc:t.doc,d:t.d,meta(){return t.computedMeta}},r=[Sje(),_je(),Cje()];r.forEach(({before:n})=>n?.(e)),r.forEach(({after:n})=>n?.(e))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});bm.subscribe(()=>{let t=bm.getSnapshot(),e=new Map;for(let[r]of t)e.set(r,r.documentElement.style.overflow);for(let r of t.values()){let n=e.get(r.doc)==="hidden",s=r.count!==0;(s&&!n||!s&&n)&&bm.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&bm.dispatch("TEARDOWN",r)}});function Eje(t,e,r=()=>({containers:[]})){let n=jje(bm),s=e?n.get(e):void 0,a=s?s.count>0:!1;return El(()=>{if(!(!e||!t))return bm.dispatch("PUSH",e,r),()=>bm.dispatch("POP",e,r)},[t,e]),a}function Aje(t,e,r=()=>[document.body]){let n=lw(t,"scroll-lock");Eje(n,e,s=>{var a;return{containers:[...(a=s.containers)!=null?a:[],r]}})}function Tje(t=0){let[e,r]=b.useState(t),n=b.useCallback(c=>r(c),[]),s=b.useCallback(c=>r(u=>u|c),[]),a=b.useCallback(c=>(e&c)===c,[e]),o=b.useCallback(c=>r(u=>u&~c),[]),l=b.useCallback(c=>r(u=>u^c),[]);return{flags:e,setFlag:n,addFlag:s,hasFlag:a,removeFlag:o,toggleFlag:l}}var Ije={},oU,lU;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((oU=process==null?void 0:Ije)==null?void 0:oU.NODE_ENV)==="test"&&typeof((lU=Element?.prototype)==null?void 0:lU.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Pje=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(Pje||{});function lre(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function cre(t,e,r,n){let[s,a]=b.useState(r),{hasFlag:o,addFlag:l,removeFlag:c}=Tje(t&&s?3:0),u=b.useRef(!1),h=b.useRef(!1),f=vg();return El(()=>{var m;if(t){if(r&&a(!0),!e){r&&l(3);return}return(m=n?.start)==null||m.call(n,r),Lje(e,{inFlight:u,prepare(){h.current?h.current=!1:h.current=u.current,u.current=!0,!h.current&&(r?(l(3),c(4)):(l(4),c(2)))},run(){h.current?r?(c(3),l(4)):(c(4),l(3)):r?c(1):l(1)},done(){var g;h.current&&Rje(e)||(u.current=!1,c(7),r||a(!1),(g=n?.end)==null||g.call(n,r))}})}},[t,r,e,f]),t?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function Lje(t,{prepare:e,run:r,done:n,inFlight:s}){let a=Ff();return Mje(t,{prepare:e,inFlight:s}),a.nextFrame(()=>{r(),a.requestAnimationFrame(()=>{a.add(Oje(t,n))})}),a.dispose}function Oje(t,e){var r,n;let s=Ff();if(!t)return s.dispose;let a=!1;s.add(()=>{a=!0});let o=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(l=>l instanceof CSSTransition))!=null?n:[];return o.length===0?(e(),s.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{a||e()}),s.dispose)}function Mje(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function Rje(t){var e,r;return((r=(e=t.getAnimations)==null?void 0:e.call(t))!=null?r:[]).some(n=>n instanceof CSSTransition&&n.playState!=="finished")}function vO(t,e){let r=b.useRef([]),n=fn(t);b.useEffect(()=>{let s=[...r.current];for(let[a,o]of e.entries())if(r.current[a]!==o){let l=n(e,s);return r.current=e,l}},[n,...e])}let R_=b.createContext(null);R_.displayName="OpenClosedContext";var jl=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(jl||{});function cw(){return b.useContext(R_)}function ure({value:t,children:e}){return Ie.createElement(R_.Provider,{value:t},e)}function dre({children:t}){return Ie.createElement(R_.Provider,{value:null},t)}function Dje(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let U0=[];Dje(()=>{function t(e){if(!Xd(e.target)||e.target===document.body||U0[0]===e.target)return;let r=e.target;r=r.closest(I4),U0.unshift(r??e.target),U0=U0.filter(n=>n!=null&&n.isConnected),U0.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function hre(t){let e=fn(t),r=b.useRef(!1);b.useEffect(()=>(r.current=!1,()=>{r.current=!0,L_(()=>{r.current&&e()})}),[e])}let fre=b.createContext(!1);function Bje(){return b.useContext(fre)}function cU(t){return Ie.createElement(fre.Provider,{value:t.force},t.children)}function Fje(t){let e=Bje(),r=b.useContext(mre),[n,s]=b.useState(()=>{var a;if(!e&&r!==null)return(a=r.current)!=null?a:null;if(sh.isServer)return null;let o=t?.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)});return b.useEffect(()=>{n!==null&&(t!=null&&t.body.contains(n)||t==null||t.body.appendChild(n))},[n,t]),b.useEffect(()=>{e||r!==null&&s(r.current)},[r,s,e]),n}let pre=b.Fragment,$je=Qa(function(t,e){let{ownerDocument:r=null,...n}=t,s=b.useRef(null),a=Ll(qte(m=>{s.current=m}),e),o=bO(s.current),l=r??o,c=Fje(l),u=b.useContext(FI),h=vg(),f=bo();return hre(()=>{var m;c&&c.childNodes.length<=0&&((m=c.parentElement)==null||m.removeChild(c))}),c?Kn.createPortal(Ie.createElement("div",{"data-headlessui-portal":"",ref:m=>{h.dispose(),u&&m&&h.add(u.register(m))}},f({ourProps:{ref:a},theirProps:n,slot:{},defaultTag:pre,name:"Portal"})),c):null});function Uje(t,e){let r=Ll(e),{enabled:n=!0,ownerDocument:s,...a}=t,o=bo();return n?Ie.createElement($je,{...a,ownerDocument:s,ref:r}):o({ourProps:{ref:r},theirProps:a,slot:{},defaultTag:pre,name:"Portal"})}let zje=b.Fragment,mre=b.createContext(null);function Vje(t,e){let{target:r,...n}=t,s={ref:Ll(e)},a=bo();return Ie.createElement(mre.Provider,{value:r},a({ourProps:s,theirProps:n,defaultTag:zje,name:"Popover.Group"}))}let FI=b.createContext(null);function qje(){let t=b.useContext(FI),e=b.useRef([]),r=fn(a=>(e.current.push(a),t&&t.register(a),()=>n(a))),n=fn(a=>{let o=e.current.indexOf(a);o!==-1&&e.current.splice(o,1),t&&t.unregister(a)}),s=b.useMemo(()=>({register:r,unregister:n,portals:e}),[r,n,e]);return[e,b.useMemo(()=>function({children:a}){return Ie.createElement(FI.Provider,{value:s},a)},[s])]}let Hje=Qa(Uje),gre=Qa(Vje),Wje=Object.assign(Hje,{Group:gre});function Gje(t,e=typeof document<"u"?document.defaultView:null,r){let n=lw(t,"escape");are(e,"keydown",s=>{n&&(s.defaultPrevented||s.key===ef.Escape&&r(s))})}function Kje(){var t;let[e]=b.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[r,n]=b.useState((t=e?.matches)!=null?t:!1);return El(()=>{if(!e)return;function s(a){n(a.matches)}return e.addEventListener("change",s),()=>e.removeEventListener("change",s)},[e]),r}function Yje({defaultContainers:t=[],portals:e,mainTreeNode:r}={}){let n=fn(()=>{var s,a;let o=bg(r),l=[];for(let c of t)c!==null&&(pf(c)?l.push(c):"current"in c&&pf(c.current)&&l.push(c.current));if(e!=null&&e.current)for(let c of e.current)l.push(c);for(let c of(s=o?.querySelectorAll("html > *, body > *"))!=null?s:[])c!==document.body&&c!==document.head&&pf(c)&&c.id!=="headlessui-portal-root"&&(r&&(c.contains(r)||c.contains((a=r?.getRootNode())==null?void 0:a.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:n,contains:fn(s=>n().some(a=>a.contains(s)))}}let xre=b.createContext(null);function uU({children:t,node:e}){let[r,n]=b.useState(null),s=yre(e??r);return Ie.createElement(xre.Provider,{value:s},t,s===null&&Ie.createElement(s2,{features:$y.Hidden,ref:a=>{var o,l;if(a){for(let c of(l=(o=bg(a))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&pf(c)&&c!=null&&c.contains(a)){n(c);break}}}}))}function yre(t=null){var e;return(e=b.useContext(xre))!=null?e:t}function Xje(){let t=typeof document>"u";return"useSyncExternalStore"in FT?(e=>e.useSyncExternalStore)(FT)(()=>()=>{},()=>!1,()=>!t):!1}function D_(){let t=Xje(),[e,r]=b.useState(sh.isHandoffComplete);return e&&sh.isHandoffComplete===!1&&r(!1),b.useEffect(()=>{e!==!0&&r(!0)},[e]),b.useEffect(()=>sh.handoff(),[]),t?!1:e}function wO(){let t=b.useRef(!1);return El(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var n1=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(n1||{});function Qje(){let t=b.useRef(0);return ire(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function bre(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let r of t.current)pf(r.current)&&e.add(r.current);return e}let Jje="div";var hm=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(hm||{});function Zje(t,e){let r=b.useRef(null),n=Ll(r,e),{initialFocus:s,initialFocusFallback:a,containers:o,features:l=15,...c}=t;D_()||(l=0);let u=bO(r.current);n4e(l,{ownerDocument:u});let h=s4e(l,{ownerDocument:u,container:r,initialFocus:s,initialFocusFallback:a});i4e(l,{ownerDocument:u,container:r,containers:o,previousActiveElement:h});let f=Qje(),m=fn(k=>{if(!dh(r.current))return;let C=r.current;(I=>I())(()=>{bu(f.current,{[n1.Forwards]:()=>{C1(C,tf.First,{skipElements:[k.relatedTarget,a]})},[n1.Backwards]:()=>{C1(C,tf.Last,{skipElements:[k.relatedTarget,a]})}})})}),g=lw(!!(l&2),"focus-trap#tab-lock"),y=vg(),v=b.useRef(!1),w={ref:n,onKeyDown(k){k.key=="Tab"&&(v.current=!0,y.requestAnimationFrame(()=>{v.current=!1}))},onBlur(k){if(!(l&4))return;let C=bre(o);dh(r.current)&&C.add(r.current);let I=k.relatedTarget;Xd(I)&&I.dataset.headlessuiFocusGuard!=="true"&&(vre(C,I)||(v.current?C1(r.current,bu(f.current,{[n1.Forwards]:()=>tf.Next,[n1.Backwards]:()=>tf.Previous})|tf.WrapAround,{relativeTo:k.target}):Xd(k.target)&&mf(k.target)))}},N=bo();return Ie.createElement(Ie.Fragment,null,g&&Ie.createElement(s2,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:$y.Focusable}),N({ourProps:w,theirProps:c,defaultTag:Jje,name:"FocusTrap"}),g&&Ie.createElement(s2,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:$y.Focusable}))}let e4e=Qa(Zje),t4e=Object.assign(e4e,{features:hm});function r4e(t=!0){let e=b.useRef(U0.slice());return vO(([r],[n])=>{n===!0&&r===!1&&L_(()=>{e.current.splice(0)}),n===!1&&r===!0&&(e.current=U0.slice())},[t,U0,e]),fn(()=>{var r;return(r=e.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function n4e(t,{ownerDocument:e}){let r=!!(t&8),n=r4e(r);vO(()=>{r||mNe(e?.body)&&mf(n())},[r]),hre(()=>{r&&mf(n())})}function s4e(t,{ownerDocument:e,container:r,initialFocus:n,initialFocusFallback:s}){let a=b.useRef(null),o=lw(!!(t&1),"focus-trap#initial-focus"),l=wO();return vO(()=>{if(t===0)return;if(!o){s!=null&&s.current&&mf(s.current);return}let c=r.current;c&&L_(()=>{if(!l.current)return;let u=e?.activeElement;if(n!=null&&n.current){if(n?.current===u){a.current=u;return}}else if(c.contains(u)){a.current=u;return}if(n!=null&&n.current)mf(n.current);else{if(t&16){if(C1(c,tf.First|tf.AutoFocus)!==BI.Error)return}else if(C1(c,tf.First)!==BI.Error)return;if(s!=null&&s.current&&(mf(s.current),e?.activeElement===s.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}a.current=e?.activeElement})},[s,o,t]),a}function i4e(t,{ownerDocument:e,container:r,containers:n,previousActiveElement:s}){let a=wO(),o=!!(t&4);are(e?.defaultView,"focus",l=>{if(!o||!a.current)return;let c=bre(n);dh(r.current)&&c.add(r.current);let u=s.current;if(!u)return;let h=l.target;dh(h)?vre(c,h)?(s.current=h,mf(h)):(l.preventDefault(),l.stopPropagation(),mf(u)):mf(s.current)},!0)}function vre(t,e){for(let r of t)if(r.contains(e))return!0;return!1}function wre(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!uy((e=t.as)!=null?e:jre)||Ie.Children.count(t.children)===1}let B_=b.createContext(null);B_.displayName="TransitionContext";var a4e=(t=>(t.Visible="visible",t.Hidden="hidden",t))(a4e||{});function o4e(){let t=b.useContext(B_);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function l4e(){let t=b.useContext(F_);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let F_=b.createContext(null);F_.displayName="NestingContext";function $_(t){return"children"in t?$_(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function Nre(t,e){let r=wg(t),n=b.useRef([]),s=wO(),a=vg(),o=fn((g,y=W0.Hidden)=>{let v=n.current.findIndex(({el:w})=>w===g);v!==-1&&(bu(y,{[W0.Unmount](){n.current.splice(v,1)},[W0.Hidden](){n.current[v].state="hidden"}}),a.microTask(()=>{var w;!$_(n)&&s.current&&((w=r.current)==null||w.call(r))}))}),l=fn(g=>{let y=n.current.find(({el:v})=>v===g);return y?y.state!=="visible"&&(y.state="visible"):n.current.push({el:g,state:"visible"}),()=>o(g,W0.Unmount)}),c=b.useRef([]),u=b.useRef(Promise.resolve()),h=b.useRef({enter:[],leave:[]}),f=fn((g,y,v)=>{c.current.splice(0),e&&(e.chains.current[y]=e.chains.current[y].filter(([w])=>w!==g)),e?.chains.current[y].push([g,new Promise(w=>{c.current.push(w)})]),e?.chains.current[y].push([g,new Promise(w=>{Promise.all(h.current[y].map(([N,k])=>k)).then(()=>w())})]),y==="enter"?u.current=u.current.then(()=>e?.wait.current).then(()=>v(y)):v(y)}),m=fn((g,y,v)=>{Promise.all(h.current[y].splice(0).map(([w,N])=>N)).then(()=>{var w;(w=c.current.shift())==null||w()}).then(()=>v(y))});return b.useMemo(()=>({children:n,register:l,unregister:o,onStart:f,onStop:m,wait:u,chains:h}),[l,o,n,f,m,h,u])}let jre=b.Fragment,kre=Fy.RenderStrategy;function c4e(t,e){var r,n;let{transition:s=!0,beforeEnter:a,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:h,enterTo:f,entered:m,leave:g,leaveFrom:y,leaveTo:v,...w}=t,[N,k]=b.useState(null),C=b.useRef(null),I=wre(t),O=Ll(...I?[C,e,k]:e===null?[]:[e]),L=(r=w.unmount)==null||r?W0.Unmount:W0.Hidden,{show:_,appear:E,initial:M}=o4e(),[B,S]=b.useState(_?"visible":"hidden"),P=l4e(),{register:R,unregister:V}=P;El(()=>R(C),[R,C]),El(()=>{if(L===W0.Hidden&&C.current){if(_&&B!=="visible"){S("visible");return}return bu(B,{hidden:()=>V(C),visible:()=>R(C)})}},[B,C,R,V,_,L]);let ee=D_();El(()=>{if(I&&ee&&B==="visible"&&C.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[C,B,ee,I]);let G=M&&!E,J=E&&_&&M,Z=b.useRef(!1),se=Nre(()=>{Z.current||(S("hidden"),V(C))},P),X=fn(Ne=>{Z.current=!0;let pe=Ne?"enter":"leave";se.onStart(C,pe,K=>{K==="enter"?a?.():K==="leave"&&l?.()})}),q=fn(Ne=>{let pe=Ne?"enter":"leave";Z.current=!1,se.onStop(C,pe,K=>{K==="enter"?o?.():K==="leave"&&c?.()}),pe==="leave"&&!$_(se)&&(S("hidden"),V(C))});b.useEffect(()=>{I&&s||(X(_),q(_))},[_,I,s]);let U=!(!s||!I||!ee||G),[,H]=cre(U,N,_,{start:X,end:q}),re=L0({ref:O,className:((n=OI(w.className,J&&u,J&&h,H.enter&&u,H.enter&&H.closed&&h,H.enter&&!H.closed&&f,H.leave&&g,H.leave&&!H.closed&&y,H.leave&&H.closed&&v,!H.transition&&_&&m))==null?void 0:n.trim())||void 0,...lre(H)}),ae=0;B==="visible"&&(ae|=jl.Open),B==="hidden"&&(ae|=jl.Closed),_&&B==="hidden"&&(ae|=jl.Opening),!_&&B==="visible"&&(ae|=jl.Closing);let xe=bo();return Ie.createElement(F_.Provider,{value:se},Ie.createElement(ure,{value:ae},xe({ourProps:re,theirProps:w,defaultTag:jre,features:kre,visible:B==="visible",name:"Transition.Child"})))}function u4e(t,e){let{show:r,appear:n=!1,unmount:s=!0,...a}=t,o=b.useRef(null),l=wre(t),c=Ll(...l?[o,e]:e===null?[]:[e]);D_();let u=cw();if(r===void 0&&u!==null&&(r=(u&jl.Open)===jl.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,f]=b.useState(r?"visible":"hidden"),m=Nre(()=>{r||f("hidden")}),[g,y]=b.useState(!0),v=b.useRef([r]);El(()=>{g!==!1&&v.current[v.current.length-1]!==r&&(v.current.push(r),y(!1))},[v,r]);let w=b.useMemo(()=>({show:r,appear:n,initial:g}),[r,n,g]);El(()=>{r?f("visible"):!$_(m)&&o.current!==null&&f("hidden")},[r,m]);let N={unmount:s},k=fn(()=>{var O;g&&y(!1),(O=t.beforeEnter)==null||O.call(t)}),C=fn(()=>{var O;g&&y(!1),(O=t.beforeLeave)==null||O.call(t)}),I=bo();return Ie.createElement(F_.Provider,{value:m},Ie.createElement(B_.Provider,{value:w},I({ourProps:{...N,as:b.Fragment,children:Ie.createElement(_re,{ref:c,...N,...a,beforeEnter:k,beforeLeave:C})},theirProps:{},defaultTag:b.Fragment,features:kre,visible:h==="visible",name:"Transition"})))}function d4e(t,e){let r=b.useContext(B_)!==null,n=cw()!==null;return Ie.createElement(Ie.Fragment,null,!r&&n?Ie.createElement($I,{ref:e,...t}):Ie.createElement(_re,{ref:e,...t}))}let $I=Qa(u4e),_re=Qa(c4e),NO=Qa(d4e),gf=Object.assign($I,{Child:NO,Root:$I});var h4e=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(h4e||{}),f4e=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(f4e||{});let p4e={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},jO=b.createContext(null);jO.displayName="DialogContext";function U_(t){let e=b.useContext(jO);if(e===null){let r=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,U_),r}return e}function m4e(t,e){return bu(e.type,p4e,t,e)}let dU=Qa(function(t,e){let r=b.useId(),{id:n=`headlessui-dialog-${r}`,open:s,onClose:a,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:h=!1,...f}=t,m=b.useRef(!1);l=(function(){return l==="dialog"||l==="alertdialog"?l:(m.current||(m.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let g=cw();s===void 0&&g!==null&&(s=(g&jl.Open)===jl.Open);let y=b.useRef(null),v=Ll(y,e),w=bO(y.current),N=s?0:1,[k,C]=b.useReducer(m4e,{titleId:null,descriptionId:null,panelRef:b.createRef()}),I=fn(()=>a(!1)),O=fn(H=>C({type:0,id:H})),L=D_()?N===0:!1,[_,E]=qje(),M={get current(){var H;return(H=k.panelRef.current)!=null?H:y.current}},B=yre(),{resolveContainers:S}=Yje({mainTreeNode:B,portals:_,defaultContainers:[M]}),P=g!==null?(g&jl.Closing)===jl.Closing:!1;uje(u||P?!1:L,{allowed:fn(()=>{var H,re;return[(re=(H=y.current)==null?void 0:H.closest("[data-headlessui-portal]"))!=null?re:null]}),disallowed:fn(()=>{var H;return[(H=B?.closest("body > *:not(#headlessui-portal-root)"))!=null?H:null]})});let R=tre.get(null);El(()=>{if(L)return R.actions.push(n),()=>R.actions.pop(n)},[R,n,L]);let V=rre(R,b.useCallback(H=>R.selectors.isTop(H,n),[R,n]));Nje(V,S,H=>{H.preventDefault(),I()}),Gje(V,w?.defaultView,H=>{H.preventDefault(),H.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),I()}),Aje(u||P?!1:L,w,S),dje(L,y,I);let[ee,G]=Wte(),J=b.useMemo(()=>[{dialogState:N,close:I,setTitleId:O,unmount:h},k],[N,I,O,h,k]),Z=wh({open:N===0}),se={ref:v,id:n,role:l,tabIndex:-1,"aria-modal":u?void 0:N===0?!0:void 0,"aria-labelledby":k.titleId,"aria-describedby":ee,unmount:h},X=!Kje(),q=hm.None;L&&!u&&(q|=hm.RestoreFocus,q|=hm.TabLock,c&&(q|=hm.AutoFocus),X&&(q|=hm.InitialFocus));let U=bo();return Ie.createElement(dre,null,Ie.createElement(cU,{force:!0},Ie.createElement(Wje,null,Ie.createElement(jO.Provider,{value:J},Ie.createElement(gre,{target:y},Ie.createElement(cU,{force:!1},Ie.createElement(G,{slot:Z},Ie.createElement(E,null,Ie.createElement(t4e,{initialFocus:o,initialFocusFallback:y,containers:S,features:q},Ie.createElement(Xte,{value:I},U({ourProps:se,theirProps:f,slot:Z,defaultTag:g4e,features:x4e,visible:N===0,name:"Dialog"})))))))))))}),g4e="div",x4e=Fy.RenderStrategy|Fy.Static;function y4e(t,e){let{transition:r=!1,open:n,...s}=t,a=cw(),o=t.hasOwnProperty("open")||a!==null,l=t.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!a&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(n!==void 0||r)&&!s.static?Ie.createElement(uU,null,Ie.createElement(gf,{show:n,transition:r,unmount:s.unmount},Ie.createElement(dU,{ref:e,...s}))):Ie.createElement(uU,null,Ie.createElement(dU,{ref:e,open:n,...s}))}let b4e="div";function v4e(t,e){let r=b.useId(),{id:n=`headlessui-dialog-panel-${r}`,transition:s=!1,...a}=t,[{dialogState:o,unmount:l},c]=U_("Dialog.Panel"),u=Ll(e,c.panelRef),h=wh({open:o===0}),f=fn(w=>{w.stopPropagation()}),m={ref:u,id:n,onClick:f},g=s?NO:b.Fragment,y=s?{unmount:l}:{},v=bo();return Ie.createElement(g,{...y},v({ourProps:m,theirProps:a,slot:h,defaultTag:b4e,name:"Dialog.Panel"}))}let w4e="div";function N4e(t,e){let{transition:r=!1,...n}=t,[{dialogState:s,unmount:a}]=U_("Dialog.Backdrop"),o=wh({open:s===0}),l={ref:e,"aria-hidden":!0},c=r?NO:b.Fragment,u=r?{unmount:a}:{},h=bo();return Ie.createElement(c,{...u},h({ourProps:l,theirProps:n,slot:o,defaultTag:w4e,name:"Dialog.Backdrop"}))}let j4e="h2";function k4e(t,e){let r=b.useId(),{id:n=`headlessui-dialog-title-${r}`,...s}=t,[{dialogState:a,setTitleId:o}]=U_("Dialog.Title"),l=Ll(e);b.useEffect(()=>(o(n),()=>o(null)),[n,o]);let c=wh({open:a===0}),u={ref:l,id:n};return bo()({ourProps:u,theirProps:s,slot:c,defaultTag:j4e,name:"Dialog.Title"})}let _4e=Qa(y4e),S4e=Qa(v4e);Qa(N4e);let C4e=Qa(k4e),tp=Object.assign(_4e,{Panel:S4e,Title:C4e,Description:Gte});var hU;let E4e=(hU=Ie.startTransition)!=null?hU:function(t){t()};var A4e=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(A4e||{}),T4e=(t=>(t[t.ToggleDisclosure=0]="ToggleDisclosure",t[t.CloseDisclosure=1]="CloseDisclosure",t[t.SetButtonId=2]="SetButtonId",t[t.SetPanelId=3]="SetPanelId",t[t.SetButtonElement=4]="SetButtonElement",t[t.SetPanelElement=5]="SetPanelElement",t))(T4e||{});let I4e={0:t=>({...t,disclosureState:bu(t.disclosureState,{0:1,1:0})}),1:t=>t.disclosureState===1?t:{...t,disclosureState:1},2(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},3(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}},4(t,e){return t.buttonElement===e.element?t:{...t,buttonElement:e.element}},5(t,e){return t.panelElement===e.element?t:{...t,panelElement:e.element}}},kO=b.createContext(null);kO.displayName="DisclosureContext";function _O(t){let e=b.useContext(kO);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,_O),r}return e}let SO=b.createContext(null);SO.displayName="DisclosureAPIContext";function Sre(t){let e=b.useContext(SO);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Sre),r}return e}let CO=b.createContext(null);CO.displayName="DisclosurePanelContext";function P4e(){return b.useContext(CO)}function L4e(t,e){return bu(e.type,I4e,t,e)}let O4e=b.Fragment;function M4e(t,e){let{defaultOpen:r=!1,...n}=t,s=b.useRef(null),a=Ll(e,qte(v=>{s.current=v},t.as===void 0||uy(t.as))),o=b.useReducer(L4e,{disclosureState:r?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:l,buttonId:c},u]=o,h=fn(v=>{u({type:1});let w=bg(s.current);if(!w||!c)return;let N=v?Xd(v)?v:"current"in v&&Xd(v.current)?v.current:w.getElementById(c):w.getElementById(c);N?.focus()}),f=b.useMemo(()=>({close:h}),[h]),m=wh({open:l===0,close:h}),g={ref:a},y=bo();return Ie.createElement(kO.Provider,{value:o},Ie.createElement(SO.Provider,{value:f},Ie.createElement(Xte,{value:h},Ie.createElement(ure,{value:bu(l,{0:jl.Open,1:jl.Closed})},y({ourProps:g,theirProps:n,slot:m,defaultTag:O4e,name:"Disclosure"})))))}let R4e="button";function D4e(t,e){let r=b.useId(),{id:n=`headlessui-disclosure-button-${r}`,disabled:s=!1,autoFocus:a=!1,...o}=t,[l,c]=_O("Disclosure.Button"),u=P4e(),h=u===null?!1:u===l.panelId,f=b.useRef(null),m=Ll(f,e,fn(M=>{if(!h)return c({type:4,element:M})}));b.useEffect(()=>{if(!h)return c({type:2,buttonId:n}),()=>{c({type:2,buttonId:null})}},[n,c,h]);let g=fn(M=>{var B;if(h){if(l.disclosureState===1)return;switch(M.key){case ef.Space:case ef.Enter:M.preventDefault(),M.stopPropagation(),c({type:0}),(B=l.buttonElement)==null||B.focus();break}}else switch(M.key){case ef.Space:case ef.Enter:M.preventDefault(),M.stopPropagation(),c({type:0});break}}),y=fn(M=>{M.key===ef.Space&&M.preventDefault()}),v=fn(M=>{var B;zte(M.currentTarget)||s||(h?(c({type:0}),(B=l.buttonElement)==null||B.focus()):c({type:0}))}),{isFocusVisible:w,focusProps:N}=Pte({autoFocus:a}),{isHovered:k,hoverProps:C}=Ite({isDisabled:s}),{pressed:I,pressProps:O}=Ote({disabled:s}),L=wh({open:l.disclosureState===0,hover:k,active:I,disabled:s,focus:w,autofocus:a}),_=ore(t,l.buttonElement),E=MI(h?{ref:m,type:_,disabled:s||void 0,autoFocus:a,onKeyDown:g,onClick:v}:{ref:m,id:n,type:_,"aria-expanded":l.disclosureState===0,"aria-controls":l.panelElement?l.panelId:void 0,disabled:s||void 0,autoFocus:a,onKeyDown:g,onKeyUp:y,onClick:v},N,C,O);return bo()({ourProps:E,theirProps:o,slot:L,defaultTag:R4e,name:"Disclosure.Button"})}let B4e="div",F4e=Fy.RenderStrategy|Fy.Static;function $4e(t,e){let r=b.useId(),{id:n=`headlessui-disclosure-panel-${r}`,transition:s=!1,...a}=t,[o,l]=_O("Disclosure.Panel"),{close:c}=Sre("Disclosure.Panel"),[u,h]=b.useState(null),f=Ll(e,fn(k=>{E4e(()=>l({type:5,element:k}))}),h);b.useEffect(()=>(l({type:3,panelId:n}),()=>{l({type:3,panelId:null})}),[n,l]);let m=cw(),[g,y]=cre(s,u,m!==null?(m&jl.Open)===jl.Open:o.disclosureState===0),v=wh({open:o.disclosureState===0,close:c}),w={ref:f,id:n,...lre(y)},N=bo();return Ie.createElement(dre,null,Ie.createElement(CO.Provider,{value:o.panelId},N({ourProps:w,theirProps:a,slot:v,defaultTag:B4e,features:F4e,visible:g,name:"Disclosure.Panel"})))}let U4e=Qa(M4e),z4e=Qa(D4e),V4e=Qa($4e),dy=Object.assign(U4e,{Button:z4e,Panel:V4e}),EO=b.createContext(null);EO.displayName="GroupContext";let q4e=b.Fragment;function H4e(t){var e;let[r,n]=b.useState(null),[s,a]=HNe(),[o,l]=Wte(),c=b.useMemo(()=>({switch:r,setSwitch:n}),[r,n]),u={},h=t,f=bo();return Ie.createElement(l,{name:"Switch.Description",value:o},Ie.createElement(a,{name:"Switch.Label",value:s,props:{htmlFor:(e=c.switch)==null?void 0:e.id,onClick(m){r&&(RI(m.currentTarget)&&m.preventDefault(),r.click(),r.focus({preventScroll:!0}))}}},Ie.createElement(EO.Provider,{value:c},f({ourProps:u,theirProps:h,slot:{},defaultTag:q4e,name:"Switch.Group"}))))}let W4e="button";function G4e(t,e){var r;let n=b.useId(),s=Fte(),a=yO(),{id:o=s||`headlessui-switch-${n}`,disabled:l=a||!1,checked:c,defaultChecked:u,onChange:h,name:f,value:m,form:g,autoFocus:y=!1,...v}=t,w=b.useContext(EO),[N,k]=b.useState(null),C=b.useRef(null),I=Ll(C,e,w===null?null:w.setSwitch,k),O=_Ne(u),[L,_]=kNe(c,h,O??!1),E=vg(),[M,B]=b.useState(!1),S=fn(()=>{B(!0),_?.(!L),E.nextFrame(()=>{B(!1)})}),P=fn(Ne=>{if(zte(Ne.currentTarget))return Ne.preventDefault();Ne.preventDefault(),S()}),R=fn(Ne=>{Ne.key===ef.Space?(Ne.preventDefault(),S()):Ne.key===ef.Enter&&SNe(Ne.currentTarget)}),V=fn(Ne=>Ne.preventDefault()),ee=Yte(),G=UNe(),{isFocusVisible:J,focusProps:Z}=Pte({autoFocus:y}),{isHovered:se,hoverProps:X}=Ite({isDisabled:l}),{pressed:q,pressProps:U}=Ote({disabled:l}),H=wh({checked:L,disabled:l,hover:se,focus:J,active:q,autofocus:y,changing:M}),re=MI({id:o,ref:I,role:"switch",type:ore(t,N),tabIndex:t.tabIndex===-1?0:(r=t.tabIndex)!=null?r:0,"aria-checked":L,"aria-labelledby":ee,"aria-describedby":G,disabled:l||void 0,autoFocus:y,onClick:P,onKeyUp:R,onKeyPress:V},Z,X,U),ae=b.useCallback(()=>{if(O!==void 0)return _?.(O)},[_,O]),xe=bo();return Ie.createElement(Ie.Fragment,null,f!=null&&Ie.createElement(PNe,{disabled:l,data:{[f]:m||"on"},overrides:{type:"checkbox",checked:L},form:g,onReset:ae}),xe({ourProps:re,theirProps:v,slot:H,defaultTag:W4e,name:"Switch"}))}let K4e=Qa(G4e),Y4e=H4e,X4e=YNe,Q4e=Gte,fU=Object.assign(K4e,{Group:Y4e,Label:X4e,Description:Q4e});const Kx={"/dashboard":{title:"Dashboard Guide",subtitle:"Your command center in MTG Forge.",icon:"",color:"indigo",sections:[{type:"text",title:"Overview",content:"The Dashboard provides a high-level view of your collection, recent activity, and quick actions. It's fully customizable to fit your workflow."},{type:"grid",title:"Key Widgets",items:[{title:"Quick Actions",desc:"Shortcuts to create decks or scan cards.",icon:""},{title:"Stats",desc:"Summary of collection size and value.",icon:""},{title:"Recent Decks",desc:"Quick access to your latest brews.",icon:""},{title:"Identity",desc:"Color distribution of your cards.",icon:""}]},{type:"text",title:"Customization",content:"Click the **Customize** toggle to enter Edit Mode. You can drag to rearrange, use handles to resize, and add new widgets from the sidebar. You can also save and share your custom layouts."}],tips:[{icon:"",title:"Troubleshooting",text:"If widgets feel stuck, try refreshing the page. Most layout issues are resolved by a quick reload."}],footer:{text:"Start Customizing"}},"/collection":{title:"Collection Manager",subtitle:"Manage your entire card inventory.",icon:"",color:"blue",sections:[{type:"grid",title:"View Modes",items:[{title:"Grid",desc:"Visual display of card art.",icon:""},{title:"Table",desc:"Data list for easy sorting.",icon:""},{title:"Folders",desc:"Organize by Color, Set, or Binder.",icon:""}]},{type:"text",title:"Features",content:"Use the search bar for names, or click **Filters** to drill down by Color, Rarity, Type, and Set. You can sort by Price, CMC, and Date Added."},{type:"text",title:"Bulk Actions",content:"Enter **Select** mode to perform actions on multiple cards at once: Delete, Move to Binder, Add to Deck, or Export to a list."}],tips:[{icon:"",title:"Forge Lens",text:"Click the camera icon to scan physical cards directly into your collection using your webcam."},{icon:"",title:"Live Prices",text:"Sync Prices updates your entire collection value based on the latest Scryfall market data."}],footer:{text:"Manage Collection"}},"/decks":{title:"Decks & Binders",subtitle:"Your library of strategies and trades.",icon:"",color:"purple",sections:[{type:"grid",title:"Organization",items:[{title:"Decks",desc:"Your constructed strategies.",icon:""},{title:"Binders",desc:"Trade stock and collections.",icon:""},{title:"Folders",desc:"Group by format or theme.",icon:""}]},{type:"text",title:"Creation",content:"Start a fresh deck from scratch, or **Import** a decklist from Arena, Moxfield, or TappedOut by pasting the text list."}],tips:[{icon:"",title:"Mockup Mode",text:"Decks marked as 'Mockup' don't count towards your collection statsperfect for brewing with cards you don't own yet."}],footer:{text:"Browse Decks"}},"/decks/new":{title:"Deck Architect",subtitle:"Craft your perfect 99.",icon:"",color:"emerald",sections:[{type:"text",title:"Workflow",content:`1. **Choose Commander**: Pick your leader to define identity.
2. **Select Strategy**: Pick a theme (e.g., Aristocrats, Voltron).
3. **Build**: Use the AI Companion for suggestions based on your theme.`},{type:"grid",title:"AI Tools",items:[{title:"Suggestions",desc:"Cards categorized by role.",icon:""},{title:"Synergy",desc:"Hidden gems from your binder.",icon:""},{title:"Deck Doctor",desc:"Fix curve or synergy issues.",icon:""}]}],tips:[{icon:"",title:"Solitaire",text:"Use the Solitaire tool to test your draws and opening hands before taking the deck to the table."}],footer:{text:"Start Brewing"}},"/binders":{title:"Binder Management",subtitle:"Organize your collection like a pro.",icon:"",color:"indigo",sections:[{type:"grid",title:"Two Ways to Build",items:[{title:"Manual",desc:"Drag and drop specific cards.",icon:""},{title:"Smart",desc:"Set rules for automatic updates.",icon:""}]},{type:"text",title:"AI Smart Creator",content:"Just describe what you want: 'All my red goblins over $5' or 'Cards to trade that I have duplicates of'. The AI handles the logic."}],tips:[{icon:"",title:"Custom Style",text:"Change colors and pick from hundreds of icons to make your binders easily identifiable."}],footer:{text:"Open Binders"}},"/social":{title:"Pods & Sharing",subtitle:"Connect with your playgroup.",icon:"",color:"rose",sections:[{type:"text",title:"What is a Pod?",content:"A Pod represents your list of Trusted Connections. Linking accounts allows you to share digital resources and track group stats."},{type:"grid",title:"Permissions",items:[{title:"Viewer",desc:"Can see decks and collection.",icon:""},{title:"Editor",desc:"Can help brew and add cards.",icon:""}]},{type:"text",title:"Shared Collections",content:"In the Deck Builder, you can view cards from your friends' collections to brew Team Decks or borrow cards."}],tips:[{icon:"",title:"Safety First",text:"Only add people you actually trust to your Pod. You can revoke access at any time."}],footer:{text:"Connect with Friends"}},"/sets":{title:"Sets Explorer",subtitle:"Browse any MTG expansion.",icon:"",color:"blue",sections:[{type:"text",title:"Global Search",content:"Find sets by name (e.g., 'Throne of Eldraine') or code (e.g., 'ELD'). Filter by Main Sets, Commander, Secret Lair, and more."},{type:"text",title:"Analytics",content:"Click a set to view its full card list, total value, and your completion percentage for that specific set."}],tips:[{icon:"",title:"Tracking",text:"Completion stats help you identify missing cards if you're aiming to complete a full set collection."}],footer:{text:"Explore Sets"}},"/wishlist":{title:"Wishlist Guide",subtitle:"Track cards you need to acquire.",icon:"",color:"pink",sections:[{type:"text",title:"Management",content:"Add cards from anywhere via the global search. You can filter by price or type to prioritize your next purchases."},{type:"text",title:"Budgeting",content:"Use the total value indicator to estimate the cost of your current wishlist."}],tips:[{icon:"",title:"Theorycraft",text:"Enable Theorycraft Mode in the Deck Builder to include cards from your wishlist in your deck lists."}],footer:{text:"View Wishlist"}},"/audit":{title:"Collection Audit",subtitle:"Verify your physical inventory.",icon:"",color:"emerald",sections:[{type:"text",title:"Verification Flow",content:`1. **Start Audit**: Choose a scope (Collection, Binder, or Box).
2. **Review**: Mark cards as **Found** or **Missing**.
3. **Sync**: Automatically update your digital records to match.`},{type:"grid",title:"Quick Actions",items:[{title:"Match",desc:"Confirms physical count.",icon:""},{title:"Mismatch",desc:"Flags discrepancy for fix.",icon:""}]}],tips:[{icon:"",title:"Mobile Use",text:"The Audit Wizard is optimized for phones. perfect for carrying to your bulk boxes for scanning!"}],footer:{text:"Start Audit"}},"forge-lens":{title:"Forge Lens AI",subtitle:"AI-powered card recognition.",icon:"",color:"indigo",sections:[{type:"text",title:"How to Use",content:`1. **Open Scanner**: Click the camera icon.
2. **Position**: Hold device steady over card in good light.
3. **Scan**: AI detects name and set automatically.`},{type:"image",title:"Perfect Alignment",src:"/images/forge-lens-tip.png",caption:"The AI looks specifically for the set code (e.g. MH2) and collector number in the bottom left for 100% accuracy."},{type:"grid",title:"Best Results",items:[{title:"Lighting",desc:"Bright, even light.",icon:""},{title:"Background",desc:"Dark & contrasting.",icon:""},{title:"Sleeves",desc:"Clear sleeves are best.",icon:""}]}],tips:[{icon:"",title:"Speed",text:"Once you see the pop up showing you added the correct card, you can just keep scanning!"}],footer:{text:"Launch Forge Lens"}},"/precons":{title:"Precon Discovery",subtitle:"Explore and upgrade ready-to-play decks.",icon:"",color:"rose",sections:[{type:"text",title:"Browse & Search",content:"Discover every Preconstructed deck released by Wizards of the Coast. Filter by **Set**, **Type** (Commander, Challenger, etc.), or use the search for specific names."},{type:"grid",title:"Features",items:[{title:"Decklists",desc:"View full original lists.",icon:""},{title:"Price Check",desc:"Real-time value analysis.",icon:""},{title:"Clone & Edit",desc:"Upgrade your own copy.",icon:""}]}],tips:[{icon:"",title:"Upgrading",text:"Click 'Add to Collection' or 'Add to Wishlist' on any precon to start making your own upgrades with AI assistance."}],footer:{text:"Browse Precons"}},"/strategy":{title:"Strategy AI",subtitle:"Deep meta analysis and brewing tips.",icon:"",color:"violet",sections:[{type:"text",title:"Meta View",content:"Scan the current meta across multiple formats. The AI analyzes thousands of top-performing decks to identify trends, key staples, and power shifts."},{type:"grid",title:"Tools",items:[{title:"Deck Analysis",desc:"Scan your brews for weaknesses.",icon:""},{title:"Archetope",desc:"Explore winning archetypes.",icon:""},{title:"Price Alerts",desc:"Watch for meta spikes.",icon:""}]}],tips:[{icon:"",title:"Personalized",text:"The Strategy AI learns your playstyle. The more decks you build, the better it gets at suggesting cards that fit your 'vibe'."}],footer:{text:"Explore Meta"}},"/play":{title:"Live Sessions",subtitle:"Play Magic with friends in real-time.",icon:"",color:"emerald",sections:[{type:"text",title:"Lobby & PINs",content:"The Lobby is where you create or join live game sessions. Every session has a unique **6-digit PIN**. Share this with your friends for them to join your table instantly."},{type:"grid",title:"Battlefield Tools",items:[{title:"Life Tracker",desc:"Real-time sync for life totals.",icon:""},{title:"Counters",desc:"Track Poison, Energy, and more.",icon:""},{title:"Command Damage",desc:"Built-in commander tracking.",icon:""},{title:"Pass Turn",desc:"Easily signal turn changes.",icon:""}]}],tips:[{icon:"",title:"Oops Window",text:"Made a mistake? You have a 5-second window to **Undo** any life or counter change before it's finalized in the log."},{icon:"",title:"Game Notes",text:"Click the message icon to add notes like 'Board Wipe' or 'Cast Commander' to the shared session log."}],footer:{text:"Enter Lobby"}},"/armory":{title:"The Armory",subtitle:"Trade and manage your physical stock.",icon:"",color:"amber",sections:[{type:"text",title:"Trade Dashboard",content:"The Armory is your hub for physical trades. Track what you're offering and what you're looking for, and find matches within your Pod."},{type:"grid",title:"Tracking",items:[{title:"Haves",desc:"Cards you're willing to trade.",icon:""},{title:"Wants",desc:"Cards you're looking for.",icon:""},{title:"Matches",desc:"Automatic trade suggestions.",icon:""}]}],tips:[{icon:"",title:"Trust",text:"Physical trades are managed between players. Forge helps find matches, but you handle the shipping and handoffs!"}],footer:{text:"Open Armory"}},"/tournaments":{title:"Tournaments",subtitle:"Compete for glory and prizes.",icon:"",color:"rose",sections:[{type:"text",title:"Organized Play",content:"Join community-run tournaments or host your own. The system handles pairings, standings, and decklist verification automatically."},{type:"grid",title:"Structure",items:[{title:"Swiss",desc:"Fair pairings for all rounds.",icon:""},{title:"Cut to Top 8",desc:"Elimination finals.",icon:""},{title:"Prizes",desc:"Claim your rewards.",icon:""}]}],tips:[{icon:"",title:"Schedule",text:"Check the tournament calendar regularly for upcoming Qualifiers and Open events. **COMING SOON**"}],footer:{text:"Browse Events"}}},pU=t=>Kx[t]?Kx[t]:t.startsWith("/decks/")&&!t.endsWith("/new")?{title:"Deck Details",subtitle:"Manage a specific strategy.",icon:"",color:"indigo",sections:[{type:"text",title:"Command Center",content:"Manage card lists, view stats, and optimize strategy. Flip cards per view, or enter **Selection** mode for bulk removals."},{type:"grid",title:"Analyzer",items:[{title:"Power Level",desc:"Estimated deck strength.",icon:""},{title:"Mana Curve",desc:"Cost distribution.",icon:""},{title:"Identity",desc:"Color and theme analysis.",icon:""}]}],tips:[{icon:"",title:"Settings",text:"You can change deck visibility, format, and cover art from the Settings tab within the deck view."}],footer:{text:"Back to Decks"}}:t.startsWith("/audit")?Kx["/audit"]:t.startsWith("/binders")?Kx["/binders"]:t.startsWith("/sets/")?{title:"Set Analytics",subtitle:"Deep dive into an expansion.",icon:"",color:"blue",sections:[{type:"grid",title:"View Items",items:[{title:"Full List",desc:"Every card in the set.",icon:""},{title:"Value",desc:"Current market analytics.",icon:""},{title:"Completion",desc:"Your collection progress.",icon:""}]}],tips:[{icon:"",title:"Draft Sim",text:"Simulate booster drafts for this set to practice your limited skills (available for major sets)."}],footer:{text:"Browse Sets"}}:{title:"General Help",subtitle:"How can we help you today?",icon:"",color:"indigo",sections:[{type:"text",title:"Welcome",content:"I am here to help you navigate MTG Forge. You can explore guides for collection management, deck building, and more."}],tips:[{icon:"",title:"AI Assistant",text:"If you can't find what you need, use the AI Helper to ask specific questions about the app."}],footer:{text:"Close Help"}},J4e=({isOpen:t,onClose:e,onStartTour:r,onOpenChat:n})=>{const s=yn(),a=Ca(),[o,l]=Ie.useState("home"),[c,u]=Ie.useState(null);return Ie.useEffect(()=>{t&&(l("home"),u(null))},[t]),a.pathname.startsWith("/decks/"),a.pathname,i.jsx(gf,{appear:!0,show:t,as:b.Fragment,children:i.jsxs(tp,{as:"div",className:"relative z-[100]",onClose:e,children:[i.jsx(gf.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),i.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:i.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:i.jsx(gf.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:i.jsxs(tp.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded-3xl bg-gray-900 border border-indigo-500/30 p-0 text-left align-middle shadow-2xl transition-all h-[80vh] flex flex-col",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50 backdrop-blur-xl",children:[i.jsx(tp.Title,{as:"h3",className:"text-2xl font-black leading-6 text-white flex items-center gap-3",children:o==="guide"?i.jsxs("button",{onClick:()=>l("home"),className:"p-2 -ml-2 rounded-lg hover:bg-white/5 text-gray-400 hover:text-white transition-colors flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),i.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-3xl",children:""}),"Help Center"]})}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6",children:o==="home"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"mb-8",children:i.jsx("p",{className:"text-base text-gray-400",children:"Stuck? Here are a few ways to get moving again."})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("button",{onClick:()=>{e(),r()},className:"group relative p-8 rounded-3xl bg-gray-800/50 border border-gray-700 hover:border-indigo-500 hover:bg-indigo-500/5 transition-all text-left",children:[i.jsx("div",{className:"absolute top-6 right-6 p-3 bg-indigo-500/10 rounded-xl text-indigo-400 group-hover:scale-110 transition-transform",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})}),i.jsx("h4",{className:"text-xl font-black text-white mb-2",children:"Take a Tour"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Walk through the features of the current page with interactive highlights."})]}),i.jsxs("button",{onClick:()=>{e(),n()},className:"group relative p-8 rounded-3xl bg-gray-800/50 border border-gray-700 hover:border-purple-500 hover:bg-purple-500/5 transition-all text-left",children:[i.jsx("div",{className:"absolute top-6 right-6 p-3 bg-purple-500/10 rounded-xl text-purple-400 group-hover:scale-110 transition-transform",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),i.jsx("h4",{className:"text-xl font-black text-white mb-2",children:"Ask AI Helper"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Chat with the intelligent assistant. It knows exactly what you're looking at."})]})]}),i.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-800",children:[i.jsx("h5",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Quick Guides"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{id:"/dashboard",label:" Dashboard"},{id:"/collection",label:" Collection"},{id:"/decks",label:" Decks"},{id:"/binders",label:" Binders"},{id:"/social",label:" Social"},{id:"/sets",label:" Sets Explorer"},{id:"/wishlist",label:" Wishlist"},{id:"/audit",label:" Audit"},{id:"forge-lens",label:" Forge Lens"},{id:"/precons",label:" Precons"},{id:"/strategy",label:" Strategy"},{id:"/play",label:" Play"},{id:"/armory",label:" Armory"},{id:"/tournaments",label:" Tourneys"},{id:"/settings",label:" Settings"}].map(h=>i.jsx("button",{onClick:()=>{u(h.id),l("guide")},className:"p-4 bg-gray-800/30 border border-white/5 rounded-2xl text-xs font-bold text-gray-300 hover:text-white hover:bg-gray-700/50 hover:border-indigo-500/30 transition-all text-left flex items-center gap-2",children:h.label},h.id))})]}),i.jsx("div",{className:"h-4"})]}):i.jsx("div",{className:"animate-fade-in",children:(()=>{const h=c?Kx[c]||(c.startsWith("/")?Kx[c]:null):null;return h?i.jsxs("div",{className:"space-y-8 pb-10",children:[i.jsxs("div",{className:"flex items-center gap-6 mb-10",children:[i.jsx("div",{className:`p-6 bg-${h.color}-500/20 rounded-3xl text-4xl`,children:h.icon}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-white leading-tight mb-1",children:h.title}),i.jsx("p",{className:"text-base text-gray-400",children:h.subtitle})]})]}),h.sections?.map((f,m)=>i.jsxs("section",{className:"space-y-3",children:[i.jsxs("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("span",{className:`w-1.5 h-4 bg-${h.color}-500 rounded-full`}),f.title]}),f.type==="text"&&i.jsx("div",{className:"text-base text-gray-300 leading-relaxed bg-white/5 p-6 rounded-3xl border border-white/5",children:f.content.split(`
`).map((g,y)=>i.jsx("p",{className:y>0?"mt-3":"",children:g.split(/(\*\*.*?\*\*)/).map((v,w)=>v.startsWith("**")&&v.endsWith("**")?i.jsx("strong",{className:"text-white font-black",children:v.slice(2,-2)},w):v)},y))}),f.type==="grid"&&i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.items.map((g,y)=>i.jsxs("div",{className:"bg-gray-800/40 p-6 rounded-3xl border border-white/5 hover:border-white/10 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[i.jsx("span",{className:"text-2xl",children:g.icon}),i.jsx("h4",{className:"font-black text-white text-base",children:g.title})]}),i.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:g.desc})]},y))}),f.type==="image"&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"rounded-2xl overflow-hidden border border-white/10 bg-black/40",children:i.jsx("img",{src:f.src,alt:f.title,className:"w-full h-auto object-cover"})}),f.caption&&i.jsx("p",{className:"text-xs text-center text-gray-500 italic px-2",children:f.caption})]})]},m)),h.tips&&i.jsxs("div",{className:`bg-gradient-to-br from-${h.color}-900/40 to-gray-950 p-6 rounded-3xl border border-${h.color}-500/20`,children:[i.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest mb-4 flex items-center gap-2",children:[i.jsx("span",{children:""})," Pro Tips"]}),i.jsx("div",{className:"space-y-4",children:h.tips.map((f,m)=>i.jsxs("div",{className:"flex gap-6",children:[i.jsx("div",{className:"text-3xl shrink-0 mt-1",children:f.icon}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-white font-black text-base mb-1",children:f.title}),i.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:f.text})]})]},m))})]}),h.footer&&i.jsx("div",{className:"pt-4 flex justify-end",children:i.jsx("button",{onClick:()=>{c.startsWith("/")?(e(),s(c)):e()},className:`px-8 py-3 bg-${h.color}-600 hover:bg-${h.color}-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-${h.color}-900/20 active:scale-95`,children:h.footer.text})})]}):i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[i.jsx("span",{className:"text-4xl mb-4",children:""}),i.jsx("p",{className:"font-bold",children:"Guide content not found."})]})})()})})]})})})})]})})};const Z4e=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eke=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),mU=t=>{const e=eke(t);return e.charAt(0).toUpperCase()+e.slice(1)},Cre=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),tke=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var rke={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nke=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...l},c)=>b.createElement("svg",{ref:c,...rke,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Cre("lucide",s),...!a&&!tke(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,h])=>b.createElement(u,h)),...Array.isArray(a)?a:[a]]));const or=(t,e)=>{const r=b.forwardRef(({className:n,...s},a)=>b.createElement(nke,{ref:a,iconNode:e,className:Cre(`lucide-${Z4e(mU(t))}`,`lucide-${t}`,n),...s}));return r.displayName=mU(t),r};const ske=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],UI=or("activity",ske);const ike=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ere=or("arrow-left",ike);const ake=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],oke=or("arrow-right",ake);const lke=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],cke=or("book-open",lke);const uke=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],dke=or("book",uke);const hke=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Are=or("box",hke);const fke=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],gU=or("brain",fke);const pke=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Tre=or("calendar",pke);const mke=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],zI=or("camera",mke);const gke=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],xke=or("chart-column",gke);const yke=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],bke=or("chart-no-axes-column",yke);const vke=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ih=or("check",vke);const wke=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Nke=or("chevron-down",wke);const jke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],vj=or("circle-alert",jke);const kke=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_ke=or("circle-check-big",kke);const Ske=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cke=or("circle-play",Ske);const Eke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ake=or("circle-x",Eke);const Tke=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ire=or("clock",Tke);const Ike=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],Pke=or("cog",Ike);const Lke=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Oke=or("credit-card",Lke);const Mke=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],rp=or("crown",Mke);const Rke=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],Dke=or("delete",Rke);const Bke=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],AO=or("dollar-sign",Bke);const Fke=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],xU=or("droplets",Fke);const $ke=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Uke=or("flag",$ke);const zke=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],wj=or("flame",zke);const Vke=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],qke=or("gem",Vke);const Hke=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Wke=or("grid-3x3",Hke);const Gke=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],Kke=or("hammer",Gke);const Yke=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Xke=or("heart",Yke);const Qke=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Jke=or("house",Qke);const Zke=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],TO=or("layers",Zke);const e_e=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],yU=or("leaf",e_e);const t_e=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],r_e=or("list",t_e);const n_e=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],IO=or("lock",n_e);const s_e=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],bU=or("medal",s_e);const i_e=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],a_e=or("message-square",i_e);const o_e=[["path",{d:"M5 12h14",key:"1ays0h"}]],l_e=or("minus",o_e);const c_e=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],u_e=or("mountain",c_e);const d_e=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],VI=or("play",d_e);const h_e=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],f_e=or("plus",h_e);const p_e=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Uy=or("refresh-cw",p_e);const m_e=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],g_e=or("save",m_e);const x_e=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],y_e=or("scroll",x_e);const b_e=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],z_=or("search",b_e);const v_e=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],w_e=or("settings",v_e);const N_e=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],PO=or("share-2",N_e);const j_e=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Nf=or("shield",j_e);const k_e=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],__e=or("skip-forward",k_e);const S_e=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],zy=or("skull",S_e);const C_e=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],qI=or("smartphone",C_e);const E_e=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Vy=or("sparkles",E_e);const A_e=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],T_e=or("square-plus",A_e);const I_e=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],HI=or("star",I_e);const P_e=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],L_e=or("sun",P_e);const O_e=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],i2=or("swords",O_e);const M_e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],R_e=or("target",M_e);const D_e=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Pre=or("trash-2",D_e);const B_e=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],F_e=or("trash",B_e);const $_e=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],V_=or("trending-up",$_e);const U_e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Lre=or("triangle-alert",U_e);const z_e=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],ra=or("trophy",z_e);const V_e=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],q_e=or("upload",V_e);const H_e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],WI=or("user-plus",H_e);const W_e=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],GI=or("user",W_e);const G_e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xm=or("users",G_e);const K_e=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Y_e=or("wifi-off",K_e);const X_e=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Q_e=or("wifi",X_e);const J_e=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vu=or("x",J_e);const Z_e=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ud=or("zap",Z_e),vU={COLLECTION:{id:"collection",label:"Collection",icon:Are},WEALTH:{id:"wealth",label:"Wealth",icon:AO},MASTERY:{id:"mastery",label:"Mastery",icon:rp},DEDICATION:{id:"dedication",label:"Dedication",icon:ra},AUDIT:{id:"audit",label:"Audit",icon:z_},COLORS:{id:"colors",label:"Colors",icon:TO},TYPES:{id:"types",label:"Types",icon:dke},ONBOARDING:{id:"onboarding",label:"Onboarding",icon:Vy}},Nj=[{id:"ai_setup",title:"Technical Alliance",description:"Configure your Personal AI Companion.",metric:"ai_setup_complete",target:1,xp:150,category:"onboarding",icon:ud},{id:"onboarding_done",title:"Planeswalker Spark",description:"Complete the Forge onboarding process.",metric:"onboarding_finished",target:1,xp:100,category:"onboarding",icon:wj},{id:"col_count_1",title:"Starter Deck",description:"Collect your first 60 cards.",metric:"total_cards",target:60,xp:50,category:"collection"},{id:"col_count_2",title:"Binder Filler",description:"Collect 500 cards.",metric:"total_cards",target:500,xp:150,category:"collection"},{id:"col_count_3",title:"Library Builder",description:"Collect 1,000 cards.",metric:"total_cards",target:1e3,xp:300,category:"collection"},{id:"col_count_4",title:"Hoarder",description:"Collect 5,000 cards.",metric:"total_cards",target:5e3,xp:1e3,category:"collection"},{id:"col_count_5",title:"Dragon's Hoard",description:"Collect 10,000 cards.",metric:"total_cards",target:1e4,xp:2500,category:"collection"},{id:"val_1",title:"Pocket Change",description:"Collection value exceeds $100.",metric:"total_value",target:100,xp:50,category:"wealth"},{id:"val_2",title:"Investment Portfolio",description:"Collection value exceeds $1,000.",metric:"total_value",target:1e3,xp:250,category:"wealth"},{id:"val_3",title:"High Roller",description:"Collection value exceeds $5,000.",metric:"total_value",target:5e3,xp:1e3,category:"wealth"},{id:"val_4",title:"Black Lotus Status",description:"Collection value exceeds $10,000.",metric:"total_value",target:1e4,xp:2500,category:"wealth"},{id:"foil_1",title:"Shiny!",description:"Collect 10 Foil cards.",metric:"foil_count",target:10,xp:50,category:"collection"},{id:"foil_2",title:"Magpie",description:"Collect 100 Foil cards.",metric:"foil_count",target:100,xp:200,category:"collection"},{id:"foil_3",title:"Chrome Plated",description:"Collect 500 Foil cards.",metric:"foil_count",target:500,xp:1e3,category:"collection"},{id:"audit_1",title:"Bean Counter",description:"Complete your first Audit.",metric:"audits_completed",target:1,xp:100,category:"audit"},{id:"audit_streak_1",title:"Inventory Manager",description:"Complete 5 Audits.",metric:"audits_completed",target:5,xp:500,category:"audit"},{id:"audit_perfect",title:"Perfectionist",description:"Complete an audit with 100% accuracy (min 50 cards).",metric:"perfect_audits",target:1,xp:300,category:"audit"},{id:"deck_1",title:"Brewery Open",description:"Create 1 Deck.",metric:"decks_created",target:1,xp:50,category:"mastery"},{id:"deck_5",title:"Decksmith",description:"Create 5 Decks.",metric:"decks_created",target:5,xp:200,category:"mastery"},{id:"deck_10",title:"Grand Architect",description:"Create 10 Decks.",metric:"decks_created",target:10,xp:500,category:"mastery"},{id:"color_w_1",title:"Plains Walker",description:"Collect 50 White cards.",metric:"count_white",target:50,xp:50,category:"colors",icon:HI},{id:"color_w_2",title:"Order of the White",description:"Collect 200 White cards.",metric:"count_white",target:200,xp:200,category:"colors",icon:HI},{id:"color_u_1",title:"Island Hopper",description:"Collect 50 Blue cards.",metric:"count_blue",target:50,xp:50,category:"colors",icon:xU},{id:"color_u_2",title:"Mind Mage",description:"Collect 200 Blue cards.",metric:"count_blue",target:200,xp:200,category:"colors",icon:xU},{id:"color_b_1",title:"Swamp Thing",description:"Collect 50 Black cards.",metric:"count_black",target:50,xp:50,category:"colors",icon:zy},{id:"color_b_2",title:"Necromancer",description:"Collect 200 Black cards.",metric:"count_black",target:200,xp:200,category:"colors",icon:zy},{id:"color_r_1",title:"Mountain Climber",description:"Collect 50 Red cards.",metric:"count_red",target:50,xp:50,category:"colors",icon:wj},{id:"color_r_2",title:"Pyromancer",description:"Collect 200 Red cards.",metric:"count_red",target:200,xp:200,category:"colors",icon:wj},{id:"color_g_1",title:"Forest Ranger",description:"Collect 50 Green cards.",metric:"count_green",target:50,xp:50,category:"colors",icon:yU},{id:"color_g_2",title:"Force of Nature",description:"Collect 200 Green cards.",metric:"count_green",target:200,xp:200,category:"colors",icon:yU},{id:"type_creature_1",title:"Beast Master",description:"Collect 100 Creatures.",metric:"count_creature",target:100,xp:100,category:"types"},{id:"type_sorcery_1",title:"Spell Slinger",description:"Collect 50 Instants or Sorceries.",metric:"count_spell",target:50,xp:75,category:"types"},{id:"type_artifact_1",title:"Artificer",description:"Collect 50 Artifacts.",metric:"count_artifact",target:50,xp:75,category:"types"},{id:"type_land_1",title:"Real Estate Mogul",description:"Collect 100 Non-Basic Lands.",metric:"count_land_special",target:100,xp:150,category:"types"},{id:"rarity_mythic_1",title:"Mythic Hunter",description:"Collect 20 Mythic Rares.",metric:"count_mythic",target:20,xp:250,category:"collection"},{id:"early_adopter",title:"Pioneer",description:"Joined during the Alpha/Beta phase.",metric:"account_age_days",target:1,xp:100,category:"dedication"}];class eSe{constructor(){this.listeners=[],this.metrics={total_cards:0,total_value:0,foil_count:0,audits_completed:0,perfect_audits:0,decks_created:0,account_age_days:0},this.unlockedIds=new Set,this.userId=null}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(r=>r!==e)}}async loadUserAchievements(e){if(!e)return;this.userId=e.id;const r=e.data?.achievements||e.achievements||[];Array.isArray(r)&&r.forEach(s=>this.unlockedIds.add(s));const n=e.data?.stats||e.stats||{};this.metrics={...this.metrics,...n}}check(e){if(!this.userId)return this.metrics={...this.metrics,...e},[];this.metrics={...this.metrics,...e};const r=[];return Nj.forEach(n=>{if(this.unlockedIds.has(n.id))return;(this.metrics[n.metric]||0)>=n.target&&(this.unlockedIds.add(n.id),r.push(n),this.listeners.forEach(a=>a(n)))}),r.length>0&&this.syncUnlocks(r.map(n=>n.id),e),r}getProgress(e){const r=Nj.find(a=>a.id===e);if(!r)return 0;if(this.unlockedIds.has(e))return 100;const n=this.metrics[r.metric]||0,s=r.target||1;return Math.min(100,Math.round(n/s*100))}getCurrentValue(e){const r=Nj.find(n=>n.id===e);return r&&this.metrics[r.metric]||0}onSync(e){return this.syncListeners||(this.syncListeners=[]),this.syncListeners.push(e),()=>{this.syncListeners=this.syncListeners.filter(r=>r!==e)}}async syncUnlocks(e,r={}){try{if(console.log("[AchievementService] Syncing unlocks:",e),!this.userId){console.warn("[AchievementService] No userId loaded, cannot sync.");return}await He.post(`/api/users/${this.userId}/achievements`,{achievements:e,stats:r}),this.syncListeners&&this.syncListeners.forEach(n=>n())}catch(n){console.error("Failed to sync achievements",n)}}reset(){this.unlockedIds.clear(),this.metrics={total_cards:0,total_value:0,foil_count:0,audits_completed:0,perfect_audits:0,decks_created:0,account_age_days:0},console.log("[AchievementService] Reset complete"),this.userId&&this.syncUnlocks([])}}const Ha=new eSe;function Ore(){const[t,e]=b.useState([]),[r,n]=b.useState(!0),[s,a]=b.useState(null);return b.useEffect(()=>{(async()=>{try{const c=(await He.get("/api/sets")).data||[];e(c),n(!1)}catch(l){console.error("Error fetching sets:",l),a(l),n(!1)}})()},[]),{sets:t,loading:r,error:s}}function tSe({isOpen:t,onClose:e}){const{userProfile:r}=Cr(),{sets:n}=Ore(),{cards:s}=yo(),[a,o]=b.useState("all"),[l,c]=b.useState(""),[u,h]=b.useState(0);b.useEffect(()=>{t&&r&&(Ha.loadUserAchievements(r),h(N=>N+1))},[t,r]);const f=b.useMemo(()=>{if(!n||!s)return[];const N={};return s.forEach(k=>{if(k.is_wishlist)return;const C=k.set_code?.toLowerCase();C&&(N[C]||(N[C]=new Set),N[C].add(k.name))}),n.map(k=>{const C=N[k.code.toLowerCase()]?.size||0,I=k.card_count||1,L=Math.min(100,Math.round(C/I*100))>=100;return{id:`set_mastery_${k.code}`,title:`${k.name} Completionist`,description:`Collect 100% of cards in ${k.name}.`,category:"mastery",xp:500,target:I,current:C,icon:"set",setCode:k.code,isDynamic:!0,isUnlocked:L}}).filter(k=>!0)},[n,s]),m=b.useMemo(()=>[...Nj,...f],[f]);if(!t)return null;const g=m.filter(N=>{const k=a==="all"||N.category===a,C=N.title.toLowerCase().includes(l.toLowerCase())||N.description.toLowerCase().includes(l.toLowerCase());return k&&C}),y=m.reduce((N,k)=>(k.isDynamic?k.isUnlocked:Ha.unlockedIds.has(k.id))?N+k.xp:N,0),v=m.filter(N=>N.isDynamic?N.isUnlocked:Ha.unlockedIds.has(N.id)).length,w=m.length>0?Math.round(v/m.length*100):0;return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in",children:[i.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 w-full max-w-5xl h-[85vh] rounded-2xl border border-gray-800 shadow-2xl flex flex-col overflow-hidden animate-scale-up",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 p-6 border-b border-gray-800 bg-gray-900/50 backdrop-blur-xl z-20",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-xl border border-yellow-500/20",children:i.jsx(ra,{className:"w-8 h-8 text-yellow-500"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-black text-white",children:"Achievements"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Track your collection milestones"})]})]}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex items-center gap-3 bg-gray-800 px-4 py-2 rounded-full border border-gray-700",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Total XP"}),i.jsx("div",{className:"text-sm font-black text-white leading-none",children:y.toLocaleString()})]}),i.jsxs("div",{className:"w-8 h-8 relative flex items-center justify-center",children:[i.jsxs("svg",{className:"w-full h-full -rotate-90",children:[i.jsx("circle",{cx:"50%",cy:"50%",r:"45%",fill:"none",stroke:"#374151",strokeWidth:"4"}),i.jsx("circle",{cx:"50%",cy:"50%",r:"45%",fill:"none",stroke:"currentColor",strokeWidth:"4",className:"text-indigo-500 transition-all duration-1000",strokeDasharray:`${w*2.8} 300`,strokeLinecap:"round"})]}),i.jsxs("span",{className:"absolute text-[8px] font-bold text-white",children:[w,"%"]})]})]}),(r?.role==="admin"||r?.email?.includes("admin")||!0)&&i.jsx("button",{onClick:()=>{window.confirm("Reset ALL achievements? This cannot be undone.")&&(Ha.reset(),h(N=>N+1))},className:"p-2 hover:bg-red-900/30 rounded-lg text-red-700 hover:text-red-500 transition-colors",title:"[Admin] Reset Achievements",children:i.jsx(Uy,{className:"w-5 h-5"})}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-500 hover:text-white transition-colors",children:i.jsx(vu,{className:"w-6 h-6"})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-900 border-b border-gray-800 p-4 z-10",children:[i.jsxs("div",{className:"flex gap-2 overflow-x-auto max-w-full no-scrollbar",children:[i.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 rounded-md font-bold text-xs transition-colors whitespace-nowrap ${a==="all"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white bg-gray-800"}`,children:"All"}),Object.values(vU).map(N=>i.jsxs("button",{onClick:()=>o(N.id),className:`px-3 py-1.5 rounded-md font-bold text-xs transition-colors whitespace-nowrap flex items-center gap-2 ${a===N.id?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white bg-gray-800"}`,children:[i.jsx(N.icon,{className:"w-3 h-3"}),N.label]},N.id))]}),i.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[i.jsx(z_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),i.jsx("input",{type:"text",placeholder:"Search...",value:l,onChange:N=>c(N.target.value),className:"pl-9 pr-4 py-1.5 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm placeholder-gray-600 w-full focus:border-indigo-500 outline-none focus:ring-1 focus:ring-indigo-500 transition-all"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-900/50",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(N=>{const k=N.isDynamic?N.isUnlocked:Ha.unlockedIds.has(N.id);let C=0;N.isDynamic?C=Math.min(100,Math.round(N.current/N.target*100)):C=Ha.getProgress(N.id),Number.isNaN(C)&&(C=0);const I=N.isDynamic?N.current:Ha.getCurrentValue(N.id),O=vU[N.category?.toUpperCase()]?.icon||ra;return i.jsxs("div",{className:`relative flex flex-col p-5 rounded-xl border transition-all duration-300 group overflow-hidden
                                        ${k?"bg-gradient-to-br from-gray-800 to-gray-900 border-indigo-500/30 shadow-lg shadow-indigo-900/10 hover:-translate-y-1":"bg-gray-900 border-gray-800/50 opacity-60 grayscale hover:grayscale-0 hover:opacity-100"}
                                    `,children:[k&&i.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-indigo-500/10 rounded-full blur-2xl -mr-12 -mt-12 pointer-events-none"}),i.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[i.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-white shadow-inner
                                            ${k?"bg-indigo-600":"bg-gray-800"}
                                        `,children:N.icon==="set"&&N.setCode?i.jsx("i",{className:`ss ss-${N.setCode.toLowerCase()} ss-2x ${k?"text-white":"text-gray-500"}`}):k?i.jsx(O,{className:"w-5 h-5"}):i.jsx(IO,{className:"w-5 h-5 text-gray-500"})}),i.jsxs("div",{className:"text-[10px] font-black px-1.5 py-0.5 bg-gray-950/50 rounded text-yellow-500 flex items-center gap-1 border border-white/5",children:[i.jsx(ud,{className:"w-3 h-3 fill-current"})," ",N.xp]})]}),i.jsx("h3",{className:`font-bold text-sm mb-1 relative z-10 ${k?"text-white":"text-gray-400"}`,children:N.title}),i.jsx("p",{className:"text-xs text-gray-500 mb-4 relative z-10 leading-relaxed min-h-[2.5em]",children:N.description}),i.jsxs("div",{className:"mt-auto relative z-10",children:[i.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1 font-mono uppercase tracking-wider",children:[i.jsx("span",{children:"Progress"}),i.jsx("span",{className:k?"text-green-400":"",children:k?"Complete":`${Math.floor(I).toLocaleString()} / ${N.target.toLocaleString()}`})]}),i.jsx("div",{className:"h-1 w-full bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full transition-all duration-1000 ${k?"bg-green-500":"bg-indigo-500"}`,style:{width:`${C}%`}})})]})]},N.id)})})})]})]})}var jj={exports:{}},rSe=jj.exports,wU;function nSe(){return wU||(wU=1,(function(t,e){(function(n,s){t.exports=s(Mf())})(rSe,function(r){return(function(n){var s={};function a(o){if(s[o])return s[o].exports;var l=s[o]={i:o,l:!1,exports:{}};return n[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=n,a.c=s,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(h){return o[h]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(n,s,a){a.r(s);var o=a("react"),l=(function(){var m=function(g,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var N in w)w.hasOwnProperty(N)&&(v[N]=w[N])},m(g,y)};return function(g,y){m(g,y);function v(){this.constructor=g}g.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}})(),c=function(){return c=Object.assign||function(m){for(var g,y=1,v=arguments.length;y<v;y++){g=arguments[y];for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&(m[w]=g[w])}return m},c.apply(this,arguments)},u=function(m,g){var y={};for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&g.indexOf(v)<0&&(y[v]=m[v]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,v=Object.getOwnPropertySymbols(m);w<v.length;w++)g.indexOf(v[w])<0&&Object.prototype.propertyIsEnumerable.call(m,v[w])&&(y[v[w]]=m[v[w]]);return y};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(g){var y=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return y?new Promise(function(v,w){y.call(navigator,g,v,w)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function h(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var f=(function(m){l(g,m);function g(y){var v=m.call(this,y)||this;return v.canvas=null,v.ctx=null,v.requestUserMediaId=0,v.unmounted=!1,v.state={hasUserMedia:!1},v}return g.prototype.componentDidMount=function(){var y=this,v=y.state,w=y.props;if(this.unmounted=!1,!h()){w.onUserMediaError("getUserMedia not supported");return}v.hasUserMedia||this.requestUserMedia(),w.children&&typeof w.children!="function"&&console.warn("children must be a function")},g.prototype.componentDidUpdate=function(y){var v=this.props;if(!h()){v.onUserMediaError("getUserMedia not supported");return}var w=JSON.stringify(y.audioConstraints)!==JSON.stringify(v.audioConstraints),N=JSON.stringify(y.videoConstraints)!==JSON.stringify(v.videoConstraints),k=y.minScreenshotWidth!==v.minScreenshotWidth,C=y.minScreenshotHeight!==v.minScreenshotHeight;(N||k||C)&&(this.canvas=null,this.ctx=null),(w||N)&&(this.stopAndCleanup(),this.requestUserMedia())},g.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},g.stopMediaStream=function(y){y&&(y.getVideoTracks&&y.getAudioTracks?(y.getVideoTracks().map(function(v){y.removeTrack(v),v.stop()}),y.getAudioTracks().map(function(v){y.removeTrack(v),v.stop()})):y.stop())},g.prototype.stopAndCleanup=function(){var y=this.state;y.hasUserMedia&&(g.stopMediaStream(this.stream),y.src&&window.URL.revokeObjectURL(y.src))},g.prototype.getScreenshot=function(y){var v=this,w=v.state,N=v.props;if(!w.hasUserMedia)return null;var k=this.getCanvas(y);return k&&k.toDataURL(N.screenshotFormat,N.screenshotQuality)},g.prototype.getCanvas=function(y){var v=this,w=v.state,N=v.props;if(!this.video||!w.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var k=this.video.videoWidth,C=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var I=k/C;k=N.minScreenshotWidth||this.video.clientWidth,C=k/I,N.minScreenshotHeight&&C<N.minScreenshotHeight&&(C=N.minScreenshotHeight,k=C*I)}this.canvas=document.createElement("canvas"),this.canvas.width=y?.width||k,this.canvas.height=y?.height||C,this.ctx=this.canvas.getContext("2d")}var O=this,L=O.ctx,_=O.canvas;return L&&_&&(_.width=y?.width||_.width,_.height=y?.height||_.height,N.mirrored&&(L.translate(_.width,0),L.scale(-1,1)),L.imageSmoothingEnabled=N.imageSmoothing,L.drawImage(this.video,0,0,y?.width||_.width,y?.height||_.height),N.mirrored&&(L.scale(-1,1),L.translate(-_.width,0))),_},g.prototype.requestUserMedia=function(){var y=this,v=this.props,w=function(C,I){var O={video:typeof I<"u"?I:!0};v.audio&&(O.audio=typeof C<"u"?C:!0),y.requestUserMediaId++;var L=y.requestUserMediaId;navigator.mediaDevices.getUserMedia(O).then(function(_){y.unmounted||L!==y.requestUserMediaId?g.stopMediaStream(_):y.handleUserMedia(null,_)}).catch(function(_){y.handleUserMedia(_)})};if("mediaDevices"in navigator)w(v.audioConstraints,v.videoConstraints);else{var N=function(C){return{optional:[{sourceId:C}]}},k=function(C){var I=C.deviceId;return typeof I=="string"?I:Array.isArray(I)&&I.length>0?I[0]:typeof I=="object"&&I.ideal?I.ideal:null};MediaStreamTrack.getSources(function(C){var I=null,O=null;C.forEach(function(E){E.kind==="audio"?I=E.id:E.kind==="video"&&(O=E.id)});var L=k(v.audioConstraints);L&&(I=L);var _=k(v.videoConstraints);_&&(O=_),w(N(I),N(O))})}},g.prototype.handleUserMedia=function(y,v){var w=this.props;if(y||!v){this.setState({hasUserMedia:!1}),w.onUserMediaError(y);return}this.stream=v;try{this.video&&(this.video.srcObject=v),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(v)})}w.onUserMedia(v)},g.prototype.render=function(){var y=this,v=this,w=v.state,N=v.props,k=N.audio;N.forceScreenshotSourceSize;var C=N.disablePictureInPicture;N.onUserMedia,N.onUserMediaError,N.screenshotFormat,N.screenshotQuality,N.minScreenshotWidth,N.minScreenshotHeight,N.audioConstraints,N.videoConstraints,N.imageSmoothing;var I=N.mirrored,O=N.style,L=O===void 0?{}:O,_=N.children,E=u(N,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),M=I?c(c({},L),{transform:(L.transform||"")+" scaleX(-1)"}):L,B={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",c({autoPlay:!0,disablePictureInPicture:C,src:w.src,muted:!k,playsInline:!0,ref:function(S){y.video=S},style:M},E)),_&&_(B))},g.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},g})(o.Component);s.default=f}),react:(function(n,s){n.exports=r})}).default})})(jj)),jj.exports}var sSe=nSe();const Mre=Pl(sSe);var hE={exports:{}},NU;function iSe(){return NU||(NU=1,(function(t){var e=(function(r){var n=Object.prototype,s=n.hasOwnProperty,a=Object.defineProperty||function(se,X,q){se[X]=q.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function f(se,X,q){return Object.defineProperty(se,X,{value:q,enumerable:!0,configurable:!0,writable:!0}),se[X]}try{f({},"")}catch{f=function(X,q,U){return X[q]=U}}function m(se,X,q,U){var H=X&&X.prototype instanceof C?X:C,re=Object.create(H.prototype),ae=new G(U||[]);return a(re,"_invoke",{value:P(se,q,ae)}),re}r.wrap=m;function g(se,X,q){try{return{type:"normal",arg:se.call(X,q)}}catch(U){return{type:"throw",arg:U}}}var y="suspendedStart",v="suspendedYield",w="executing",N="completed",k={};function C(){}function I(){}function O(){}var L={};f(L,c,function(){return this});var _=Object.getPrototypeOf,E=_&&_(_(J([])));E&&E!==n&&s.call(E,c)&&(L=E);var M=O.prototype=C.prototype=Object.create(L);I.prototype=O,a(M,"constructor",{value:O,configurable:!0}),a(O,"constructor",{value:I,configurable:!0}),I.displayName=f(O,h,"GeneratorFunction");function B(se){["next","throw","return"].forEach(function(X){f(se,X,function(q){return this._invoke(X,q)})})}r.isGeneratorFunction=function(se){var X=typeof se=="function"&&se.constructor;return X?X===I||(X.displayName||X.name)==="GeneratorFunction":!1},r.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,O):(se.__proto__=O,f(se,h,"GeneratorFunction")),se.prototype=Object.create(M),se},r.awrap=function(se){return{__await:se}};function S(se,X){function q(re,ae,xe,Ne){var pe=g(se[re],se,ae);if(pe.type==="throw")Ne(pe.arg);else{var K=pe.arg,ue=K.value;return ue&&typeof ue=="object"&&s.call(ue,"__await")?X.resolve(ue.__await).then(function(fe){q("next",fe,xe,Ne)},function(fe){q("throw",fe,xe,Ne)}):X.resolve(ue).then(function(fe){K.value=fe,xe(K)},function(fe){return q("throw",fe,xe,Ne)})}}var U;function H(re,ae){function xe(){return new X(function(Ne,pe){q(re,ae,Ne,pe)})}return U=U?U.then(xe,xe):xe()}a(this,"_invoke",{value:H})}B(S.prototype),f(S.prototype,u,function(){return this}),r.AsyncIterator=S,r.async=function(se,X,q,U,H){H===void 0&&(H=Promise);var re=new S(m(se,X,q,U),H);return r.isGeneratorFunction(X)?re:re.next().then(function(ae){return ae.done?ae.value:re.next()})};function P(se,X,q){var U=y;return function(re,ae){if(U===w)throw new Error("Generator is already running");if(U===N){if(re==="throw")throw ae;return Z()}for(q.method=re,q.arg=ae;;){var xe=q.delegate;if(xe){var Ne=R(xe,q);if(Ne){if(Ne===k)continue;return Ne}}if(q.method==="next")q.sent=q._sent=q.arg;else if(q.method==="throw"){if(U===y)throw U=N,q.arg;q.dispatchException(q.arg)}else q.method==="return"&&q.abrupt("return",q.arg);U=w;var pe=g(se,X,q);if(pe.type==="normal"){if(U=q.done?N:v,pe.arg===k)continue;return{value:pe.arg,done:q.done}}else pe.type==="throw"&&(U=N,q.method="throw",q.arg=pe.arg)}}}function R(se,X){var q=X.method,U=se.iterator[q];if(U===o)return X.delegate=null,q==="throw"&&se.iterator.return&&(X.method="return",X.arg=o,R(se,X),X.method==="throw")||q!=="return"&&(X.method="throw",X.arg=new TypeError("The iterator does not provide a '"+q+"' method")),k;var H=g(U,se.iterator,X.arg);if(H.type==="throw")return X.method="throw",X.arg=H.arg,X.delegate=null,k;var re=H.arg;if(!re)return X.method="throw",X.arg=new TypeError("iterator result is not an object"),X.delegate=null,k;if(re.done)X[se.resultName]=re.value,X.next=se.nextLoc,X.method!=="return"&&(X.method="next",X.arg=o);else return re;return X.delegate=null,k}B(M),f(M,h,"Generator"),f(M,c,function(){return this}),f(M,"toString",function(){return"[object Generator]"});function V(se){var X={tryLoc:se[0]};1 in se&&(X.catchLoc=se[1]),2 in se&&(X.finallyLoc=se[2],X.afterLoc=se[3]),this.tryEntries.push(X)}function ee(se){var X=se.completion||{};X.type="normal",delete X.arg,se.completion=X}function G(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(V,this),this.reset(!0)}r.keys=function(se){var X=Object(se),q=[];for(var U in X)q.push(U);return q.reverse(),function H(){for(;q.length;){var re=q.pop();if(re in X)return H.value=re,H.done=!1,H}return H.done=!0,H}};function J(se){if(se){var X=se[c];if(X)return X.call(se);if(typeof se.next=="function")return se;if(!isNaN(se.length)){var q=-1,U=function H(){for(;++q<se.length;)if(s.call(se,q))return H.value=se[q],H.done=!1,H;return H.value=o,H.done=!0,H};return U.next=U}}return{next:Z}}r.values=J;function Z(){return{value:o,done:!0}}return G.prototype={constructor:G,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ee),!se)for(var X in this)X.charAt(0)==="t"&&s.call(this,X)&&!isNaN(+X.slice(1))&&(this[X]=o)},stop:function(){this.done=!0;var se=this.tryEntries[0],X=se.completion;if(X.type==="throw")throw X.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var X=this;function q(Ne,pe){return re.type="throw",re.arg=se,X.next=Ne,pe&&(X.method="next",X.arg=o),!!pe}for(var U=this.tryEntries.length-1;U>=0;--U){var H=this.tryEntries[U],re=H.completion;if(H.tryLoc==="root")return q("end");if(H.tryLoc<=this.prev){var ae=s.call(H,"catchLoc"),xe=s.call(H,"finallyLoc");if(ae&&xe){if(this.prev<H.catchLoc)return q(H.catchLoc,!0);if(this.prev<H.finallyLoc)return q(H.finallyLoc)}else if(ae){if(this.prev<H.catchLoc)return q(H.catchLoc,!0)}else if(xe){if(this.prev<H.finallyLoc)return q(H.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(se,X){for(var q=this.tryEntries.length-1;q>=0;--q){var U=this.tryEntries[q];if(U.tryLoc<=this.prev&&s.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var H=U;break}}H&&(se==="break"||se==="continue")&&H.tryLoc<=X&&X<=H.finallyLoc&&(H=null);var re=H?H.completion:{};return re.type=se,re.arg=X,H?(this.method="next",this.next=H.finallyLoc,k):this.complete(re)},complete:function(se,X){if(se.type==="throw")throw se.arg;return se.type==="break"||se.type==="continue"?this.next=se.arg:se.type==="return"?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):se.type==="normal"&&X&&(this.next=X),k},finish:function(se){for(var X=this.tryEntries.length-1;X>=0;--X){var q=this.tryEntries[X];if(q.finallyLoc===se)return this.complete(q.completion,q.afterLoc),ee(q),k}},catch:function(se){for(var X=this.tryEntries.length-1;X>=0;--X){var q=this.tryEntries[X];if(q.tryLoc===se){var U=q.completion;if(U.type==="throw"){var H=U.arg;ee(q)}return H}}throw new Error("illegal catch attempt")},delegateYield:function(se,X,q){return this.delegate={iterator:J(se),resultName:X,nextLoc:q},this.method==="next"&&(this.arg=o),k}},r})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(hE)),hE.exports}var fE,jU;function LO(){return jU||(jU=1,fE=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),fE}var pE,kU;function Rre(){if(kU)return pE;kU=1;const t=LO();let e=0;return pE=({id:r,action:n,payload:s={}})=>{let a=r;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:n,payload:s}},pE}var Sv={},_U;function OO(){if(_U)return Sv;_U=1;let t=!1;return Sv.logging=t,Sv.setLogging=e=>{t=e},Sv.log=(...e)=>t?console.log.apply(this,e):null,Sv}var mE,SU;function aSe(){if(SU)return mE;SU=1;const t=Rre(),{log:e}=OO(),r=LO();let n=0;return mE=()=>{const s=r("Scheduler",n),a={},o={};let l=[];n+=1;const c=()=>l.length,u=()=>Object.keys(a).length,h=()=>{if(l.length!==0){const v=Object.keys(a);for(let w=0;w<v.length;w+=1)if(typeof o[v[w]]>"u"){l[0](a[v[w]]);break}}},f=(v,w)=>new Promise((N,k)=>{const C=t({action:v,payload:w});l.push(async I=>{l.shift(),o[I.id]=C;try{N(await I[v].apply(this,[...w,C.id]))}catch(O){k(O)}finally{delete o[I.id],h()}}),e(`[${s}]: Add ${C.id} to JobQueue`),e(`[${s}]: JobQueue length=${l.length}`),h()});return{addWorker:v=>(a[v.id]=v,e(`[${s}]: Add ${v.id}`),e(`[${s}]: Number of workers=${u()}`),h(),v.id),addJob:async(v,...w)=>{if(u()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return f(v,w)},terminate:async()=>{Object.keys(a).forEach(async v=>{await a[v].terminate()}),l=[]},getQueueLen:c,getNumWorkers:u}},mE}function oSe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gE,CU;function lSe(){return CU||(CU=1,gE=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof oSe=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),gE}var xE,EU;function cSe(){if(EU)return xE;EU=1;const e=lSe()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return xE=r=>{const n={...r};return["corePath","workerPath","langPath"].forEach(s=>{r[s]&&(n[s]=e(n[s]))}),n},xE}var yE,AU;function Dre(){return AU||(AU=1,yE={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),yE}const uSe="7.0.0",dSe={version:uSe};var bE,TU;function hSe(){return TU||(TU=1,bE={workerBlobURL:!0,logger:()=>{}}),bE}var vE,IU;function fSe(){if(IU)return vE;IU=1;const t=dSe.version;return vE={...hSe(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},vE}var wE,PU;function pSe(){return PU||(PU=1,wE=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const n=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(t);return r}),wE}var NE,LU;function mSe(){return LU||(LU=1,NE=t=>{t.terminate()}),NE}var jE,OU;function gSe(){return OU||(OU=1,jE=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}),jE}var kE,MU;function xSe(){return MU||(MU=1,kE=async(t,e)=>{t.postMessage(e)}),kE}var _E,RU;function ySe(){if(RU)return _E;RU=1;const t=r=>new Promise((n,s)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=({target:{error:{code:o}}})=>{s(Error(`File could not be read! Code=${o}`))},a.readAsArrayBuffer(r)}),e=async r=>{let n=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?n=atob(r.split(",")[1]).split("").map(s=>s.charCodeAt(0)):n=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(n=await e(r.src)),r.tagName==="VIDEO"&&(n=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(s=>{r.toBlob(async a=>{n=await t(a),s()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const s=await r.convertToBlob();n=await t(s)}else(r instanceof File||r instanceof Blob)&&(n=await t(r));return new Uint8Array(n)};return _E=e,_E}var SE,DU;function bSe(){if(DU)return SE;DU=1;const t=fSe(),e=pSe(),r=mSe(),n=gSe(),s=xSe(),a=ySe();return SE={defaultOptions:t,spawnWorker:e,terminateWorker:r,onMessage:n,send:s,loadImage:a},SE}var CE,BU;function Bre(){if(BU)return CE;BU=1;const t=cSe(),e=Rre(),{log:r}=OO(),n=LO(),s=Dre(),{defaultOptions:a,spawnWorker:o,terminateWorker:l,onMessage:c,loadImage:u,send:h}=bSe();let f=0;return CE=async(m="eng",g=s.LSTM_ONLY,y={},v={})=>{const w=n("Worker",f),{logger:N,errorHandler:k,...C}=t({...a,...y}),I={},O=typeof m=="string"?m.split("+"):m;let L=g,_=v;const E=[s.DEFAULT,s.LSTM_ONLY].includes(g)&&!C.legacyCore;let M,B;const S=new Promise((K,ue)=>{B=K,M=ue}),P=K=>{M(K.message)};let R=o(C);R.onerror=P,f+=1;const V=({id:K,action:ue,payload:fe})=>new Promise((he,le)=>{r(`[${w}]: Start ${K}, action=${ue}`);const _e=`${ue}-${K}`;I[_e]={resolve:he,reject:le},h(R,{workerId:w,jobId:K,action:ue,payload:fe})}),ee=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),G=K=>V(e({id:K,action:"load",payload:{options:{lstmOnly:E,corePath:C.corePath,logging:C.logging}}})),J=(K,ue,fe)=>V(e({id:fe,action:"FS",payload:{method:"writeFile",args:[K,ue]}})),Z=(K,ue)=>V(e({id:ue,action:"FS",payload:{method:"readFile",args:[K,{encoding:"utf8"}]}})),se=(K,ue)=>V(e({id:ue,action:"FS",payload:{method:"unlink",args:[K]}})),X=(K,ue,fe)=>V(e({id:fe,action:"FS",payload:{method:K,args:ue}})),q=(K,ue)=>V(e({id:ue,action:"loadLanguage",payload:{langs:K,options:{langPath:C.langPath,dataPath:C.dataPath,cachePath:C.cachePath,cacheMethod:C.cacheMethod,gzip:C.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(L)&&!C.legacyLang}}})),U=(K,ue,fe,he)=>V(e({id:he,action:"initialize",payload:{langs:K,oem:ue,config:fe}})),H=(K="eng",ue,fe,he)=>{if(E&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(ue))throw Error("Legacy model requested but code missing.");const le=ue||L;L=le;const _e=fe||_;_=_e;const Oe=(typeof K=="string"?K.split("+"):K).filter(ze=>!O.includes(ze));return O.push(...Oe),Oe.length>0?q(Oe,he).then(()=>U(K,le,_e,he)):U(K,le,_e,he)},re=(K={},ue)=>V(e({id:ue,action:"setParameters",payload:{params:K}})),ae=async(K,ue={},fe={text:!0},he)=>V(e({id:he,action:"recognize",payload:{image:await u(K),options:ue,output:fe}})),xe=async(K,ue)=>{if(E)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return V(e({id:ue,action:"detect",payload:{image:await u(K)}}))},Ne=async()=>(R!==null&&(l(R),R=null),Promise.resolve());c(R,({workerId:K,jobId:ue,status:fe,action:he,data:le})=>{const _e=`${he}-${ue}`;if(fe==="resolve")r(`[${K}]: Complete ${ue}`),I[_e].resolve({jobId:ue,data:le}),delete I[_e];else if(fe==="reject")if(I[_e].reject(le),delete I[_e],he==="load"&&M(le),k)k(le);else throw Error(le);else fe==="progress"&&N({...le,userJobId:ue})});const pe={id:w,worker:R,load:ee,writeText:J,readText:Z,removeFile:se,FS:X,reinitialize:H,setParameters:re,recognize:ae,detect:xe,terminate:Ne};return G().then(()=>q(m)).then(()=>U(m,g,v)).then(()=>B(pe)).catch(()=>{}),S},CE}var EE,FU;function vSe(){if(FU)return EE;FU=1;const t=Bre();return EE={recognize:async(n,s,a)=>{const o=await t(s,1,a);return o.recognize(n).finally(async()=>{await o.terminate()})},detect:async(n,s)=>{const a=await t("osd",0,s);return a.detect(n).finally(async()=>{await a.terminate()})}},EE}var AE,$U;function wSe(){return $U||($U=1,AE={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),AE}var TE,UU;function NSe(){return UU||(UU=1,TE={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),TE}var IE,zU;function jSe(){if(zU)return IE;zU=1,iSe();const t=aSe(),e=Bre(),r=vSe(),n=wSe(),s=Dre(),a=NSe(),{setLogging:o}=OO();return IE={languages:n,OEM:s,PSM:a,createScheduler:t,createWorker:e,setLogging:o,...r},IE}var Fre=jSe();const hh=Object.create(null);hh.open="0";hh.close="1";hh.ping="2";hh.pong="3";hh.message="4";hh.upgrade="5";hh.noop="6";const kj=Object.create(null);Object.keys(hh).forEach(t=>{kj[hh[t]]=t});const KI={type:"error",data:"parser error"},$re=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ure=typeof ArrayBuffer=="function",zre=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,MO=({type:t,data:e},r,n)=>$re&&e instanceof Blob?r?n(e):VU(e,n):Ure&&(e instanceof ArrayBuffer||zre(e))?r?n(e):VU(new Blob([e]),n):n(hh[t]+(e||"")),VU=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function qU(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let PE;function kSe(t,e){if($re&&t.data instanceof Blob)return t.data.arrayBuffer().then(qU).then(e);if(Ure&&(t.data instanceof ArrayBuffer||zre(t.data)))return e(qU(t.data));MO(t,!1,r=>{PE||(PE=new TextEncoder),e(PE.encode(r))})}const HU="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<HU.length;t++)s1[HU.charCodeAt(t)]=t;const _Se=t=>{let e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const u=new ArrayBuffer(e),h=new Uint8Array(u);for(n=0;n<r;n+=4)a=s1[t.charCodeAt(n)],o=s1[t.charCodeAt(n+1)],l=s1[t.charCodeAt(n+2)],c=s1[t.charCodeAt(n+3)],h[s++]=a<<2|o>>4,h[s++]=(o&15)<<4|l>>2,h[s++]=(l&3)<<6|c&63;return u},SSe=typeof ArrayBuffer=="function",RO=(t,e)=>{if(typeof t!="string")return{type:"message",data:Vre(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:CSe(t.substring(1),e)}:kj[r]?t.length>1?{type:kj[r],data:t.substring(1)}:{type:kj[r]}:KI},CSe=(t,e)=>{if(SSe){const r=_Se(t);return Vre(r,e)}else return{base64:!0,data:t}},Vre=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,qre="",ESe=(t,e)=>{const r=t.length,n=new Array(r);let s=0;t.forEach((a,o)=>{MO(a,!1,l=>{n[o]=l,++s===r&&e(n.join(qre))})})},ASe=(t,e)=>{const r=t.split(qre),n=[];for(let s=0;s<r.length;s++){const a=RO(r[s],e);if(n.push(a),a.type==="error")break}return n};function TSe(){return new TransformStream({transform(t,e){kSe(t,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(s[0]|=128),e.enqueue(s),e.enqueue(r)})}})}let LE;function nN(t){return t.reduce((e,r)=>e+r.length,0)}function sN(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let s=0;s<e;s++)r[s]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function ISe(t,e){LE||(LE=new TextDecoder);const r=[];let n=0,s=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(n===0){if(nN(r)<1)break;const c=sN(r,1);a=(c[0]&128)===128,s=c[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(nN(r)<2)break;const c=sN(r,2);s=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(nN(r)<8)break;const c=sN(r,8),u=new DataView(c.buffer,c.byteOffset,c.length),h=u.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(KI);break}s=h*Math.pow(2,32)+u.getUint32(4),n=3}else{if(nN(r)<s)break;const c=sN(r,s);l.enqueue(RO(a?c:LE.decode(c),e)),n=0}if(s===0||s>t){l.enqueue(KI);break}}}})}const Hre=4;function ka(t){if(t)return PSe(t)}function PSe(t){for(var e in ka.prototype)t[e]=ka.prototype[e];return t}ka.prototype.on=ka.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};ka.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};ka.prototype.off=ka.prototype.removeListener=ka.prototype.removeAllListeners=ka.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===e||n.fn===e){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+t],this};ka.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,e)}return this};ka.prototype.emitReserved=ka.prototype.emit;ka.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};ka.prototype.hasListeners=function(t){return!!this.listeners(t).length};const q_=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),lu=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),LSe="arraybuffer";function Wre(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const OSe=lu.setTimeout,MSe=lu.clearTimeout;function H_(t,e){e.useNativeTimers?(t.setTimeoutFn=OSe.bind(lu),t.clearTimeoutFn=MSe.bind(lu)):(t.setTimeoutFn=lu.setTimeout.bind(lu),t.clearTimeoutFn=lu.clearTimeout.bind(lu))}const RSe=1.33;function DSe(t){return typeof t=="string"?BSe(t):Math.ceil((t.byteLength||t.size)*RSe)}function BSe(t){let e=0,r=0;for(let n=0,s=t.length;n<s;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function Gre(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function FSe(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function $Se(t){let e={},r=t.split("&");for(let n=0,s=r.length;n<s;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class USe extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class DO extends ka{constructor(e){super(),this.writable=!1,H_(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new USe(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=RO(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=FSe(e);return r.length?"?"+r:""}}class zSe extends DO{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};ASe(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,ESe(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Gre()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let Kre=!1;try{Kre=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const VSe=Kre;function qSe(){}class HSe extends zSe{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let hy=class _j extends ka{constructor(e,r,n){super(),this.createRequest=e,H_(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=Wre(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=_j.requestsCount++,_j.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=qSe,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete _j.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};hy.requestsCount=0;hy.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",WU);else if(typeof addEventListener=="function"){const t="onpagehide"in lu?"pagehide":"unload";addEventListener(t,WU,!1)}}function WU(){for(let t in hy.requests)hy.requests.hasOwnProperty(t)&&hy.requests[t].abort()}const WSe=(function(){const t=Yre({xdomain:!1});return t&&t.responseType!==null})();class GSe extends HSe{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=WSe&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new hy(Yre,this.uri(),e)}}function Yre(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||VSe))return new XMLHttpRequest}catch{}if(!e)try{return new lu[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Xre=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class KSe extends DO{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=Xre?{}:Wre(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],s=r===e.length-1;MO(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}s&&q_(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Gre()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const OE=lu.WebSocket||lu.MozWebSocket;class YSe extends KSe{createSocket(e,r,n){return Xre?new OE(e,r,n):r?new OE(e,r):new OE(e)}doWrite(e,r){this.ws.send(r)}}class XSe extends DO{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=ISe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),s=TSe();s.readable.pipeTo(e.writable),this._writer=s.writable.getWriter();const a=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],s=r===e.length-1;this._writer.write(n).then(()=>{s&&q_(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const QSe={websocket:YSe,webtransport:XSe,polling:GSe},JSe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ZSe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function YI(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let s=JSe.exec(t||""),a={},o=14;for(;o--;)a[ZSe[o]]=s[o]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=e3e(a,a.path),a.queryKey=t3e(a,a.query),a}function e3e(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function t3e(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,a){s&&(r[s]=a)}),r}const XI=typeof addEventListener=="function"&&typeof removeEventListener=="function",Sj=[];XI&&addEventListener("offline",()=>{Sj.forEach(t=>t())},!1);class np extends ka{constructor(e,r){if(super(),this.binaryType=LSe,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=YI(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=YI(r.host).host);H_(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$Se(this.opts.query)),XI&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Sj.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=Hre,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&np.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",np.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=DSe(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,q_(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(np.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),XI&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Sj.indexOf(this._offlineEventListener);n!==-1&&Sj.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}np.protocol=Hre;class r3e extends np{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;np.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;np.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=r.name,this.emitReserved("upgradeError",m)}}))};function a(){n||(n=!0,h(),r.close(),r=null)}const o=f=>{const m=new Error("probe error: "+f);m.transport=r.name,a(),this.emitReserved("upgradeError",m)};function l(){o("transport closed")}function c(){o("socket closed")}function u(f){r&&f.name!==r.name&&a()}const h=()=>{r.removeListener("open",s),r.removeListener("error",o),r.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};r.once("open",s),r.once("error",o),r.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let n3e=class extends r3e{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>QSe[s]).filter(s=>!!s)),super(e,n)}};function s3e(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=YI(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const i3e=typeof ArrayBuffer=="function",a3e=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Qre=Object.prototype.toString,o3e=typeof Blob=="function"||typeof Blob<"u"&&Qre.call(Blob)==="[object BlobConstructor]",l3e=typeof File=="function"||typeof File<"u"&&Qre.call(File)==="[object FileConstructor]";function BO(t){return i3e&&(t instanceof ArrayBuffer||a3e(t))||o3e&&t instanceof Blob||l3e&&t instanceof File}function Cj(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Cj(t[r]))return!0;return!1}if(BO(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Cj(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Cj(t[r]))return!0;return!1}function c3e(t){const e=[],r=t.data,n=t;return n.data=QI(r,e),n.attachments=e.length,{packet:n,buffers:e}}function QI(t,e){if(!t)return t;if(BO(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=QI(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=QI(t[n],e));return r}return t}function u3e(t,e){return t.data=JI(t.data,e),delete t.attachments,t}function JI(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=JI(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=JI(t[r],e));return t}const d3e=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var Bn;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Bn||(Bn={}));class h3e{constructor(e){this.replacer=e}encode(e){return(e.type===Bn.EVENT||e.type===Bn.ACK)&&Cj(e)?this.encodeAsBinary({type:e.type===Bn.EVENT?Bn.BINARY_EVENT:Bn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Bn.BINARY_EVENT||e.type===Bn.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=c3e(e),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}class FO extends ka{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===Bn.BINARY_EVENT;n||r.type===Bn.BINARY_ACK?(r.type=n?Bn.EVENT:Bn.ACK,this.reconstructor=new f3e(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(BO(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(Bn[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Bn.BINARY_EVENT||n.type===Bn.BINARY_ACK){const a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const o=e.substring(a,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";const s=e.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){const a=this.tryParse(e.substr(r));if(FO.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Bn.CONNECT:return GU(r);case Bn.DISCONNECT:return r===void 0;case Bn.CONNECT_ERROR:return typeof r=="string"||GU(r);case Bn.EVENT:case Bn.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&d3e.indexOf(r[0])===-1);case Bn.ACK:case Bn.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class f3e{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=u3e(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function GU(t){return Object.prototype.toString.call(t)==="[object Object]"}const p3e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:FO,Encoder:h3e,get PacketType(){return Bn}},Symbol.toStringTag,{value:"Module"}));function Gu(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const m3e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Jre extends ka{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Gu(e,"open",this.onopen.bind(this)),Gu(e,"packet",this.onpacket.bind(this)),Gu(e,"error",this.onerror.bind(this)),Gu(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,s,a;if(m3e.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Bn.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,f=r.pop();this._registerAckCallback(h,f),o.id=h}const l=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[e]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},s),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...r){return new Promise((n,s)=>{const a=(o,l)=>o?s(o):n(l);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((s,...a)=>(this._queue[0],s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Bn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Bn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Bn.EVENT:case Bn.BINARY_EVENT:this.onevent(e);break;case Bn.ACK:case Bn.BINARY_ACK:this.onack(e);break;case Bn.DISCONNECT:this.ondisconnect();break;case Bn.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:Bn.ACK,id:e,data:s}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Bn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function fb(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}fb.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};fb.prototype.reset=function(){this.attempts=0};fb.prototype.setMin=function(t){this.ms=t};fb.prototype.setMax=function(t){this.max=t};fb.prototype.setJitter=function(t){this.jitter=t};class ZI extends ka{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,H_(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new fb({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const s=r.parser||p3e;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new n3e(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=Gu(r,"open",function(){n.onopen(),e&&e()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Gu(r,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(s),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Gu(e,"ping",this.onping.bind(this)),Gu(e,"data",this.ondata.bind(this)),Gu(e,"error",this.onerror.bind(this)),Gu(e,"close",this.onclose.bind(this)),Gu(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){q_(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Jre(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Cv={};function Im(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=s3e(t,e.path||"/socket.io"),n=r.source,s=r.id,a=r.path,o=Cv[s]&&a in Cv[s].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return l?c=new ZI(n,e):(Cv[s]||(Cv[s]=new ZI(n,e)),c=Cv[s]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(Im,{Manager:ZI,Socket:Jre,io:Im,connect:Im});var Nx={},ME={exports:{}},RE,KU;function g3e(){if(KU)return RE;KU=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return RE=t,RE}var DE,YU;function x3e(){if(YU)return DE;YU=1;var t=g3e();function e(){}function r(){}return r.resetWarningCache=e,DE=function(){function n(o,l,c,u,h,f){if(f!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function s(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},DE}var XU;function $O(){return XU||(XU=1,ME.exports=x3e()()),ME.exports}var BE,QU;function Zre(){return QU||(QU=1,BE={L:1,M:0,Q:3,H:2}),BE}var FE,JU;function ene(){return JU||(JU=1,FE={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),FE}var $E,ZU;function y3e(){if(ZU)return $E;ZU=1;var t=ene();function e(r){this.mode=t.MODE_8BIT_BYTE,this.data=r}return e.prototype={getLength:function(r){return this.data.length},write:function(r){for(var n=0;n<this.data.length;n++)r.put(this.data.charCodeAt(n),8)}},$E=e,$E}var UE,ez;function b3e(){if(ez)return UE;ez=1;var t=Zre();function e(r,n){this.totalCount=r,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(r,n){var s=e.getRsBlockTable(r,n);if(s==null)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+n);for(var a=s.length/3,o=new Array,l=0;l<a;l++)for(var c=s[l*3+0],u=s[l*3+1],h=s[l*3+2],f=0;f<c;f++)o.push(new e(u,h));return o},e.getRsBlockTable=function(r,n){switch(n){case t.L:return e.RS_BLOCK_TABLE[(r-1)*4+0];case t.M:return e.RS_BLOCK_TABLE[(r-1)*4+1];case t.Q:return e.RS_BLOCK_TABLE[(r-1)*4+2];case t.H:return e.RS_BLOCK_TABLE[(r-1)*4+3];default:return}},UE=e,UE}var zE,tz;function v3e(){if(tz)return zE;tz=1;function t(){this.buffer=new Array,this.length=0}return t.prototype={get:function(e){var r=Math.floor(e/8);return(this.buffer[r]>>>7-e%8&1)==1},put:function(e,r){for(var n=0;n<r;n++)this.putBit((e>>>r-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),e&&(this.buffer[r]|=128>>>this.length%8),this.length++}},zE=t,zE}var VE,rz;function tne(){if(rz)return VE;rz=1;for(var t={glog:function(r){if(r<1)throw new Error("glog("+r+")");return t.LOG_TABLE[r]},gexp:function(r){for(;r<0;)r+=255;for(;r>=256;)r-=255;return t.EXP_TABLE[r]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;e<255;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e;return VE=t,VE}var qE,nz;function rne(){if(nz)return qE;nz=1;var t=tne();function e(r,n){if(r.length==null)throw new Error(r.length+"/"+n);for(var s=0;s<r.length&&r[s]==0;)s++;this.num=new Array(r.length-s+n);for(var a=0;a<r.length-s;a++)this.num[a]=r[a+s]}return e.prototype={get:function(r){return this.num[r]},getLength:function(){return this.num.length},multiply:function(r){for(var n=new Array(this.getLength()+r.getLength()-1),s=0;s<this.getLength();s++)for(var a=0;a<r.getLength();a++)n[s+a]^=t.gexp(t.glog(this.get(s))+t.glog(r.get(a)));return new e(n,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var n=t.glog(this.get(0))-t.glog(r.get(0)),s=new Array(this.getLength()),a=0;a<this.getLength();a++)s[a]=this.get(a);for(var a=0;a<r.getLength();a++)s[a]^=t.gexp(t.glog(r.get(a))+n);return new e(s,0).mod(r)}},qE=e,qE}var HE,sz;function w3e(){if(sz)return HE;sz=1;var t=ene(),e=rne(),r=tne(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var o=a<<10;s.getBCHDigit(o)-s.getBCHDigit(s.G15)>=0;)o^=s.G15<<s.getBCHDigit(o)-s.getBCHDigit(s.G15);return(a<<10|o)^s.G15_MASK},getBCHTypeNumber:function(a){for(var o=a<<12;s.getBCHDigit(o)-s.getBCHDigit(s.G18)>=0;)o^=s.G18<<s.getBCHDigit(o)-s.getBCHDigit(s.G18);return a<<12|o},getBCHDigit:function(a){for(var o=0;a!=0;)o++,a>>>=1;return o},getPatternPosition:function(a){return s.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,o,l){switch(a){case n.PATTERN000:return(o+l)%2==0;case n.PATTERN001:return o%2==0;case n.PATTERN010:return l%3==0;case n.PATTERN011:return(o+l)%3==0;case n.PATTERN100:return(Math.floor(o/2)+Math.floor(l/3))%2==0;case n.PATTERN101:return o*l%2+o*l%3==0;case n.PATTERN110:return(o*l%2+o*l%3)%2==0;case n.PATTERN111:return(o*l%3+(o+l)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var o=new e([1],0),l=0;l<a;l++)o=o.multiply(new e([1,r.gexp(l)],0));return o},getLengthInBits:function(a,o){if(1<=o&&o<10)switch(a){case t.MODE_NUMBER:return 10;case t.MODE_ALPHA_NUM:return 9;case t.MODE_8BIT_BYTE:return 8;case t.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(o<27)switch(a){case t.MODE_NUMBER:return 12;case t.MODE_ALPHA_NUM:return 11;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else if(o<41)switch(a){case t.MODE_NUMBER:return 14;case t.MODE_ALPHA_NUM:return 13;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}else throw new Error("type:"+o)},getLostPoint:function(a){for(var o=a.getModuleCount(),l=0,c=0;c<o;c++)for(var u=0;u<o;u++){for(var h=0,f=a.isDark(c,u),m=-1;m<=1;m++)if(!(c+m<0||o<=c+m))for(var g=-1;g<=1;g++)u+g<0||o<=u+g||m==0&&g==0||f==a.isDark(c+m,u+g)&&h++;h>5&&(l+=3+h-5)}for(var c=0;c<o-1;c++)for(var u=0;u<o-1;u++){var y=0;a.isDark(c,u)&&y++,a.isDark(c+1,u)&&y++,a.isDark(c,u+1)&&y++,a.isDark(c+1,u+1)&&y++,(y==0||y==4)&&(l+=3)}for(var c=0;c<o;c++)for(var u=0;u<o-6;u++)a.isDark(c,u)&&!a.isDark(c,u+1)&&a.isDark(c,u+2)&&a.isDark(c,u+3)&&a.isDark(c,u+4)&&!a.isDark(c,u+5)&&a.isDark(c,u+6)&&(l+=40);for(var u=0;u<o;u++)for(var c=0;c<o-6;c++)a.isDark(c,u)&&!a.isDark(c+1,u)&&a.isDark(c+2,u)&&a.isDark(c+3,u)&&a.isDark(c+4,u)&&!a.isDark(c+5,u)&&a.isDark(c+6,u)&&(l+=40);for(var v=0,u=0;u<o;u++)for(var c=0;c<o;c++)a.isDark(c,u)&&v++;var w=Math.abs(100*v/o/o-50)/5;return l+=w*10,l}};return HE=s,HE}var WE,iz;function N3e(){if(iz)return WE;iz=1;var t=y3e(),e=b3e(),r=v3e(),n=w3e(),s=rne();function a(l,c){this.typeNumber=l,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var o=a.prototype;return o.addData=function(l){var c=new t(l);this.dataList.push(c),this.dataCache=null},o.isDark=function(l,c){if(l<0||this.moduleCount<=l||c<0||this.moduleCount<=c)throw new Error(l+","+c);return this.modules[l][c]},o.getModuleCount=function(){return this.moduleCount},o.make=function(){if(this.typeNumber<1){var l=1;for(l=1;l<40;l++){for(var c=e.getRSBlocks(l,this.errorCorrectLevel),u=new r,h=0,f=0;f<c.length;f++)h+=c[f].dataCount;for(var f=0;f<this.dataList.length;f++){var m=this.dataList[f];u.put(m.mode,4),u.put(m.getLength(),n.getLengthInBits(m.mode,l)),m.write(u)}if(u.getLengthInBits()<=h*8)break}this.typeNumber=l}this.makeImpl(!1,this.getBestMaskPattern())},o.makeImpl=function(l,c){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var u=0;u<this.moduleCount;u++){this.modules[u]=new Array(this.moduleCount);for(var h=0;h<this.moduleCount;h++)this.modules[u][h]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(l,c),this.typeNumber>=7&&this.setupTypeNumber(l),this.dataCache==null&&(this.dataCache=a.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},o.setupPositionProbePattern=function(l,c){for(var u=-1;u<=7;u++)if(!(l+u<=-1||this.moduleCount<=l+u))for(var h=-1;h<=7;h++)c+h<=-1||this.moduleCount<=c+h||(0<=u&&u<=6&&(h==0||h==6)||0<=h&&h<=6&&(u==0||u==6)||2<=u&&u<=4&&2<=h&&h<=4?this.modules[l+u][c+h]=!0:this.modules[l+u][c+h]=!1)},o.getBestMaskPattern=function(){for(var l=0,c=0,u=0;u<8;u++){this.makeImpl(!0,u);var h=n.getLostPoint(this);(u==0||l>h)&&(l=h,c=u)}return c},o.createMovieClip=function(l,c,u){var h=l.createEmptyMovieClip(c,u),f=1;this.make();for(var m=0;m<this.modules.length;m++)for(var g=m*f,y=0;y<this.modules[m].length;y++){var v=y*f,w=this.modules[m][y];w&&(h.beginFill(0,100),h.moveTo(v,g),h.lineTo(v+f,g),h.lineTo(v+f,g+f),h.lineTo(v,g+f),h.endFill())}return h},o.setupTimingPattern=function(){for(var l=8;l<this.moduleCount-8;l++)this.modules[l][6]==null&&(this.modules[l][6]=l%2==0);for(var c=8;c<this.moduleCount-8;c++)this.modules[6][c]==null&&(this.modules[6][c]=c%2==0)},o.setupPositionAdjustPattern=function(){for(var l=n.getPatternPosition(this.typeNumber),c=0;c<l.length;c++)for(var u=0;u<l.length;u++){var h=l[c],f=l[u];if(this.modules[h][f]==null)for(var m=-2;m<=2;m++)for(var g=-2;g<=2;g++)m==-2||m==2||g==-2||g==2||m==0&&g==0?this.modules[h+m][f+g]=!0:this.modules[h+m][f+g]=!1}},o.setupTypeNumber=function(l){for(var c=n.getBCHTypeNumber(this.typeNumber),u=0;u<18;u++){var h=!l&&(c>>u&1)==1;this.modules[Math.floor(u/3)][u%3+this.moduleCount-8-3]=h}for(var u=0;u<18;u++){var h=!l&&(c>>u&1)==1;this.modules[u%3+this.moduleCount-8-3][Math.floor(u/3)]=h}},o.setupTypeInfo=function(l,c){for(var u=this.errorCorrectLevel<<3|c,h=n.getBCHTypeInfo(u),f=0;f<15;f++){var m=!l&&(h>>f&1)==1;f<6?this.modules[f][8]=m:f<8?this.modules[f+1][8]=m:this.modules[this.moduleCount-15+f][8]=m}for(var f=0;f<15;f++){var m=!l&&(h>>f&1)==1;f<8?this.modules[8][this.moduleCount-f-1]=m:f<9?this.modules[8][15-f-1+1]=m:this.modules[8][15-f-1]=m}this.modules[this.moduleCount-8][8]=!l},o.mapData=function(l,c){for(var u=-1,h=this.moduleCount-1,f=7,m=0,g=this.moduleCount-1;g>0;g-=2)for(g==6&&g--;;){for(var y=0;y<2;y++)if(this.modules[h][g-y]==null){var v=!1;m<l.length&&(v=(l[m]>>>f&1)==1);var w=n.getMask(c,h,g-y);w&&(v=!v),this.modules[h][g-y]=v,f--,f==-1&&(m++,f=7)}if(h+=u,h<0||this.moduleCount<=h){h-=u,u=-u;break}}},a.PAD0=236,a.PAD1=17,a.createData=function(l,c,u){for(var h=e.getRSBlocks(l,c),f=new r,m=0;m<u.length;m++){var g=u[m];f.put(g.mode,4),f.put(g.getLength(),n.getLengthInBits(g.mode,l)),g.write(f)}for(var y=0,m=0;m<h.length;m++)y+=h[m].dataCount;if(f.getLengthInBits()>y*8)throw new Error("code length overflow. ("+f.getLengthInBits()+">"+y*8+")");for(f.getLengthInBits()+4<=y*8&&f.put(0,4);f.getLengthInBits()%8!=0;)f.putBit(!1);for(;!(f.getLengthInBits()>=y*8||(f.put(a.PAD0,8),f.getLengthInBits()>=y*8));)f.put(a.PAD1,8);return a.createBytes(f,h)},a.createBytes=function(l,c){for(var u=0,h=0,f=0,m=new Array(c.length),g=new Array(c.length),y=0;y<c.length;y++){var v=c[y].dataCount,w=c[y].totalCount-v;h=Math.max(h,v),f=Math.max(f,w),m[y]=new Array(v);for(var N=0;N<m[y].length;N++)m[y][N]=255&l.buffer[N+u];u+=v;var k=n.getErrorCorrectPolynomial(w),C=new s(m[y],k.getLength()-1),I=C.mod(k);g[y]=new Array(k.getLength()-1);for(var N=0;N<g[y].length;N++){var O=N+I.getLength()-g[y].length;g[y][N]=O>=0?I.get(O):0}}for(var L=0,N=0;N<c.length;N++)L+=c[N].totalCount;for(var _=new Array(L),E=0,N=0;N<h;N++)for(var y=0;y<c.length;y++)N<m[y].length&&(_[E++]=m[y][N]);for(var N=0;N<f;N++)for(var y=0;y<c.length;y++)N<g[y].length&&(_[E++]=g[y][N]);return _},WE=a,WE}var iN={},az;function j3e(){if(az)return iN;az=1,Object.defineProperty(iN,"__esModule",{value:!0});var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h];for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&(u[m]=f[m])}return u},e=$O(),r=a(e),n=Mf(),s=a(n);function a(u){return u&&u.__esModule?u:{default:u}}function o(u,h){var f={};for(var m in u)h.indexOf(m)>=0||Object.prototype.hasOwnProperty.call(u,m)&&(f[m]=u[m]);return f}var l={bgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,bgD:r.default.string.isRequired,fgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,fgD:r.default.string.isRequired,size:r.default.number.isRequired,title:r.default.string,viewBoxSize:r.default.number.isRequired,xmlns:r.default.string},c=(0,n.forwardRef)(function(u,h){var f=u.bgColor,m=u.bgD,g=u.fgD,y=u.fgColor,v=u.size,w=u.title,N=u.viewBoxSize,k=u.xmlns,C=k===void 0?"http://www.w3.org/2000/svg":k,I=o(u,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return s.default.createElement("svg",t({},I,{height:v,ref:h,viewBox:"0 0 "+N+" "+N,width:v,xmlns:C}),w?s.default.createElement("title",null,w):null,s.default.createElement("path",{d:m,fill:f}),s.default.createElement("path",{d:g,fill:y}))});return c.displayName="QRCodeSvg",c.propTypes=l,iN.default=c,iN}var oz;function k3e(){if(oz)return Nx;oz=1,Object.defineProperty(Nx,"__esModule",{value:!0}),Nx.QRCode=void 0;var t=Object.assign||function(v){for(var w=1;w<arguments.length;w++){var N=arguments[w];for(var k in N)Object.prototype.hasOwnProperty.call(N,k)&&(v[k]=N[k])}return v},e=$O(),r=f(e),n=Zre(),s=f(n),a=N3e(),o=f(a),l=Mf(),c=f(l),u=j3e(),h=f(u);function f(v){return v&&v.__esModule?v:{default:v}}function m(v,w){var N={};for(var k in v)w.indexOf(k)>=0||Object.prototype.hasOwnProperty.call(v,k)&&(N[k]=v[k]);return N}var g={bgColor:r.default.oneOfType([r.default.object,r.default.string]),fgColor:r.default.oneOfType([r.default.object,r.default.string]),level:r.default.string,size:r.default.number,value:r.default.string.isRequired},y=(0,l.forwardRef)(function(v,w){var N=v.bgColor,k=N===void 0?"#FFFFFF":N,C=v.fgColor,I=C===void 0?"#000000":C,O=v.level,L=O===void 0?"L":O,_=v.size,E=_===void 0?256:_,M=v.value,B=m(v,["bgColor","fgColor","level","size","value"]),S=new o.default(-1,s.default[L]);S.addData(M),S.make();var P=S.modules;return c.default.createElement(h.default,t({},B,{bgColor:k,bgD:P.map(function(R,V){return R.map(function(ee,G){return ee?"":"M "+G+" "+V+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:I,fgD:P.map(function(R,V){return R.map(function(ee,G){return ee?"M "+G+" "+V+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:w,size:E,viewBoxSize:P.length}))});return Nx.QRCode=y,y.displayName="QRCode",y.propTypes=g,Nx.default=y,Nx}var _3e=k3e();const nne=Pl(_3e),S3e=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const r=console.log,n=console.warn,s=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{s(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=s}},[]),i.jsx("div",{className:"absolute top-24 left-4 right-4 h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border border-green-500/20 rounded-xl backdrop-blur-md",children:t.map((r,n)=>i.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5 break-all",children:r},n))})},W_=({isOpen:t,onClose:e,onFinish:r,mode:n="collection",decks:s=[],sharedSources:a=[]})=>{const{addToast:o}=Tn(),{userProfile:l}=Cr(),c=An(l?.subscription_tier),[u,h]=b.useState("scanning"),[f,m]=b.useState(window.innerWidth>768),g=b.useRef(null),y=b.useRef(null),v=b.useRef(null),[w,N]=b.useState(null),[k,C]=b.useState(!1),[I,O]=b.useState(!1),[L,_]=b.useState([]),[E,M]=b.useState(null),[B,S]=b.useState(!1),[P,R]=b.useState({type:"collection",id:"me",name:"My Collection"}),[V,ee]=b.useState(!1),[G]=b.useState(()=>Math.random().toString(36).substr(2,9)),[J,Z]=b.useState(!1),[se,X]=b.useState(!1),[q,U]=b.useState({name:null,footer:null});b.useEffect(()=>{let le=null;return t&&(async()=>{try{if(!V){console.log("[OCR] Initializing Tesseract Worker...");const oe=await Fre.createWorker("eng",1,{logger:Oe=>console.log(Oe),workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),le=oe,N(oe),O(!0)}}catch(oe){console.error("OCR Worker Init Failed",oe||"Unknown Error"),o("Failed to initialize OCR engine. Check console.","error")}})(),()=>{le&&le.terminate()}},[t,V]),b.useEffect(()=>{if(!t)return;const le=Im();return le.emit("join-pairing",G),le.on("remote-card",_e=>{console.log("Card received from remote:",_e.name),_(oe=>[...oe,_e]),M({success:!0,name:_e.name}),Z(!0),setTimeout(()=>M(null),2e3)}),()=>le.disconnect()},[t,G]),b.useEffect(()=>{const le=()=>m(window.innerWidth>768);return window.addEventListener("resize",le),()=>window.removeEventListener("resize",le)},[]);const H=async le=>{if(!(!I||k)){console.log("[ForgeLens] Processing new image source..."),C(!0);try{if(!le){console.warn("[ForgeLens] No image source provided.");return}const _e=new Image;_e.src=le,await new Promise(Oe=>_e.onload=Oe),console.log(`[ForgeLens] Image loaded: ${_e.width}x${_e.height}`);const oe=await Ne(_e);console.log("[ForgeLens] Region extraction complete:",oe),await pe(oe)}catch(_e){console.error("[ForgeLens] Processing error",_e),M({error:"Processing failed. Invalid image format?"})}finally{C(!1),setTimeout(()=>M(null),3e3)}}},re=async()=>{if(!g.current)return;const le=g.current.getScreenshot();await H(le)},ae=async le=>{const _e=le.target.files?.[0];if(!_e)return;const oe=new FileReader;oe.onload=async Oe=>{const ze=Oe.target.result;await H(ze),le.target.value=""},oe.readAsDataURL(_e)},xe=b.useCallback((le,_e,oe)=>{const Oe={id:Math.random().toString(36).substr(2,9),scryfall_id:le.scryfall_id||le.uuid,name:le.name,set_name:le.set_name||le.setcode,set_code:le.set||le.setcode,collector_number:le.collector_number||le.number,image:le.image_uri||le.image_uris?.small||le.card_faces?.[0]?.image_uris?.small,finish:B?"foil":"nonfoil",quantity:1,data:le,variants:_e,raw_ocr:oe,is_wishlist:!1};_(Ye=>c.features.batchScan?[...Ye,Oe]:[Oe]);const ze=le.prices?.usd||0;M({success:!0,name:le.name,price:ze})},[c.features.batchScan]),Ne=async le=>{const _e=y.current,oe=_e.getContext("2d",{willReadFrequently:!0}),Oe=async(ut,Rt,Dt,at)=>{let ft=250/at;ft=Math.max(.1,Math.min(ft,4));let Bt=Math.floor(Dt*ft),De=Math.floor(at*ft);Bt>4e3&&(ft=4e3/Dt,Bt=4e3,De=Math.floor(at*ft)),console.log(`[ForgeLens] OCR Crop: ${Bt}x${De} (Src: ${Math.floor(Dt)}x${Math.floor(at)}, Scale: ${ft.toFixed(2)})`),_e.width=Bt,_e.height=De,oe.imageSmoothingEnabled=!0,oe.imageSmoothingQuality="high",oe.drawImage(le,ut,Rt,Dt,at,0,0,Bt,De);const lt=oe.getImageData(0,0,_e.width,_e.height),ht=lt.data;for(let Ft=0;Ft<ht.length;Ft+=4){const gt=(ht[Ft]+ht[Ft+1]+ht[Ft+2])/3;ht[Ft]=ht[Ft+1]=ht[Ft+2]=gt}oe.putImageData(lt,0,0);const{data:{text:Pt}}=await w.recognize(_e),At=Pt.split(`
`).map(Ft=>Ft.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(Ft=>Ft.length>=1),mt=_e.toDataURL("image/png");return{lines:At,preview:mt}},ze=le.width,Ye=le.height,je=Math.min(ze,Ye),Fe=(ze-je)/2,Nt=(Ye-je)/2;console.log(`[ForgeLens] Precision Mode: ${ze}x${Ye}, Crop: ${je}x${je} @ (${Fe}, ${Nt})`);const $t=await Oe(Fe+je*.1,Nt+je*.35,je*.8,je*.3);U({footer:$t.preview});let Ut="",nt="";const bt=$t.lines.join(" ").toUpperCase();console.log(`[ForgeLens] Raw Scan: "${bt}"`);const _t=(bt.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(ut=>!/^(19|20)\d{2}$/.test(ut));_t.length>0&&(nt=_t[0]);const wt=bt.match(/\b[A-Z0-9]{3,4}\b/g);if(wt){const ut=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],Rt=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],Dt=wt.find(at=>!Rt.includes(at)&&!ut.includes(at)&&!/^\d+$/.test(at));Dt&&(Ut=Dt)}return{name:"",set:Ut,cn:nt,raw_footer:bt}},pe=async({name:le,set:_e,cn:oe,raw_footer:Oe})=>{if(console.log(`[ForgeLens] Resolving: Name="${le}", Set="${_e}", CN="${oe}" (Footer: "${Oe}")`),_e&&oe){console.log(`[ForgeLens] Attempting Set/CN match: ${_e} #${oe}`);try{const ze=await He.post("/api/cards/search",{set:_e,cn:oe});if(ze.data&&ze.data.length>0){const Ye=ze.data[0];console.log(`[ForgeLens] Match found by Set/CN: ${Ye.name}`);const je=ze.data.length>1?ze.data:[Ye];xe(Ye,je,{name:le,set:_e,cn:oe});return}else{M({error:`Not Found: ${_e} #${oe}`,raw:Oe});return}}catch(ze){console.warn("[ForgeLens] Set/CN search failed",ze)}}if(!le||le.length<3){M({error:"Try scanning Set Code & Number again.",raw:Oe});return}console.log(`[ForgeLens] Attempting Name search: "${le}"`);try{const Ye=(await He.post("/api/cards/search",{query:le})).data||[];if(Ye.length>0){const je=Ye[0],Fe=Ye.length>1?Ye:[je];xe(je,Fe,{name:le,set:_e,cn:oe});return}else{console.log(`[ForgeLens] No direct match for "${le}". Trying fuzzy fallback...`);const je=le.split(/\s+/).filter(Nt=>Nt.length>3);let Fe=null;if(je.length>0&&je[0].length<le.length?Fe=je[0]:le.length>8&&(Fe=le.substring(0,8)),Fe){console.log(`[ForgeLens] Fuzzy fallback attempt with: "${Fe}"`);const Nt=await He.post("/api/cards/search",{query:Fe});if(Nt.data?.length>0){const $t=Nt.data[0];console.log(`[ForgeLens] Fuzzy match found: "${$t.name}"`);const Ut=le.toLowerCase().includes($t.name.toLowerCase()),nt=$t.name.toLowerCase().includes(Fe.toLowerCase());if(Ut||nt){console.log(`[ForgeLens] Fallback match accepted: "${$t.name}"`);const bt=Nt.data.length>1?Nt.data:[$t];xe($t,bt,{name:le,set:_e,cn:oe});return}}}M({error:`Not found: ${le}`})}}catch(ze){console.error("[ForgeLens] Resolution failed",ze),M({error:"Search failed"})}},K=le=>{_(_e=>_e.filter(oe=>oe.id!==le))},ue=(le,_e)=>{_(oe=>oe.map(Oe=>Oe.id===le?{...Oe,..._e}:Oe))},fe=(le,_e)=>{_(oe=>oe.map(Oe=>{if(Oe.id===le){const ze=Oe.variants.find(Ye=>Ye.id===_e);if(ze)return{...Oe,scryfall_id:ze.id,set_name:ze.set_name,set_code:ze.set,collector_number:ze.collector_number,image:ze.image_uris?.small||ze.card_faces?.[0]?.image_uris?.small,data:ze}}return Oe}))},he=()=>{r&&r(L,P),e()};return t?Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/95 backdrop-blur-md p-0 md:p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 w-full h-full md:max-w-5xl md:max-h-[85vh] md:rounded-3xl shadow-2xl flex flex-col border border-white/10 overflow-hidden relative",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-[1010] p-2 bg-black/50 text-white rounded-full hover:bg-red-500/50 transition-all",children:i.jsx(vu,{className:"w-6 h-6"})}),i.jsxs("div",{className:"px-4 py-4 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[i.jsxs("div",{className:"flex items-center gap-6 w-full md:w-auto",children:[i.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm shrink-0",children:i.jsx(zI,{className:"w-8 h-8 text-indigo-400"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-black text-white tracking-tight italic uppercase",children:"Forge Lens"}),i.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest leading-none",children:"AI Card Scanner"})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 w-full md:w-auto",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>h("scanning"),className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${u==="scanning"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:"Scan"}),i.jsxs("button",{onClick:()=>{c.features.batchScan||L.length<=1?h("review"):o("Batch Review is a Magician+ feature. Upgrade to review all at once!","info")},className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all relative ${u==="review"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[!c.features.batchScan&&i.jsx(IO,{className:"w-3 h-3 text-orange-400"}),"Review"]}),L.length>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center animate-bounce",children:L.length})]})]}),i.jsxs("button",{onClick:()=>ee(!V),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${V?"bg-indigo-600/20 text-indigo-400 border border-indigo-500/30":"bg-gray-800 text-gray-400"}`,title:"Remote Camera",children:[i.jsx(qI,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden md:inline",children:V?"Remote Lens Active":"Use Remote Camera"})]}),i.jsxs("button",{onClick:()=>X(!se),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${se?"bg-orange-600/20 text-orange-400 border border-orange-500/30":"bg-gray-800 text-gray-400"}`,title:"Debug Regions",children:[i.jsx(vj,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden md:inline",children:"Debug Regions"})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[u==="scanning"&&i.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 relative",children:[f&&i.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-20 w-fit",children:i.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-500 px-4 py-2 rounded-2xl flex items-center gap-2 text-xs shadow-xl backdrop-blur-md animate-pulse",children:[i.jsx(vj,{className:"w-4 h-4"}),i.jsx("span",{children:"Desktop detected. For best focus, use the mobile app."})]})}),i.jsxs("div",{className:"relative w-full max-w-sm aspect-[3/4] rounded-3xl overflow-hidden border-2 border-dashed border-white/20 shadow-2xl bg-black group transition-all",children:[i.jsx(Mre,{ref:g,audio:!1,screenshotFormat:"image/webp",videoConstraints:{width:1280,height:720,facingMode:"environment"},className:"w-full h-full object-cover grayscale brightness-110 contrast-125"}),i.jsx("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-center",children:i.jsxs("div",{className:"w-[90%] h-[20%] border-2 border-indigo-500/50 bg-indigo-500/5 rounded-xl relative shadow-[0_0_100px_rgba(99,102,241,0.1)]",children:[i.jsx("div",{className:"absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-indigo-400 rounded-tl-lg"}),i.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-indigo-400 rounded-tr-lg"}),i.jsx("div",{className:"absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-indigo-400 rounded-bl-lg"}),i.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-indigo-400 rounded-br-lg"}),i.jsx("div",{className:"absolute -bottom-12 left-1/2 -translate-x-1/2 w-full text-center whitespace-nowrap",children:I?k?i.jsx("div",{className:"bg-indigo-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg animate-pulse uppercase font-black mx-auto w-fit",children:"Analyzing Image..."}):E?.success?i.jsxs("div",{className:"bg-green-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black flex items-center gap-2 mx-auto w-fit",children:[i.jsx(ih,{className:"w-3 h-3"})," Found: ",E.name," ",E.price?`($${E.price})`:""]}):E?.error?i.jsx("div",{className:"bg-red-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black mx-auto w-fit",children:E.error}):i.jsx("p",{className:"text-white/80 text-[10px] px-3 py-1 bg-black/60 rounded-full backdrop-blur-sm mx-auto w-fit border border-white/10 uppercase tracking-wider font-bold",children:"Align Set & Number Here"}):i.jsxs("div",{className:"bg-black/80 text-white text-[10px] px-3 py-1 rounded-full border border-white/10 flex items-center gap-2 mx-auto w-fit",children:[i.jsx(Uy,{className:"w-3 h-3 animate-spin"})," Wake up AI engine..."]})})]})})]}),i.jsxs("div",{className:"mt-8 flex items-center gap-6",children:[V?i.jsxs("div",{className:"flex flex-col items-center gap-6 animate-fade-in",children:[i.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-2xl",children:i.jsx(nne,{value:`${window.location.origin}/remote/${G}`,size:180,level:"H"})}),i.jsxs("div",{className:"text-center max-w-xs",children:[i.jsx("h3",{className:"text-white font-bold mb-1",children:"Scan this QR on your phone"}),i.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest leading-relaxed",children:"Your phone will act as a remote scanner and push cards directly to this desk."})]}),J&&i.jsxs("div",{className:"flex items-center gap-2 bg-green-500/10 text-green-400 px-4 py-2 rounded-full text-[10px] font-black uppercase border border-green-500/30 animate-bounce",children:[i.jsx(qI,{className:"w-4 h-4"}),"Phone Linked!"]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>S(!B),className:`w-14 h-14 rounded-2xl flex flex-col items-center justify-center border transition-all active:scale-95 ${B?"bg-gradient-to-br from-yellow-400/20 to-orange-500/20 border-yellow-500/50 text-yellow-400 shadow-[0_0_15px_rgba(234,179,8,0.3)]":"bg-gray-800 border-white/5 text-gray-500 hover:text-white"}`,title:"Toggle Foil Mode",children:[i.jsx("div",{className:`text-xl mb-1 ${B?"animate-pulse":""}`,children:""}),i.jsx("span",{className:"text-[9px] font-black uppercase tracking-wider",children:B?"Foil":"Normal"})]}),i.jsxs("button",{onClick:re,disabled:k||!I,className:"w-20 h-20 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-800 disabled:text-gray-600 text-white rounded-full flex items-center justify-center shadow-2xl shadow-indigo-500/30 transition-all active:scale-90 relative group ring-4 ring-white/5",children:[k?i.jsx(Uy,{className:"w-8 h-8 animate-spin"}):i.jsx(zI,{className:"w-8 h-8"}),i.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-500 group-hover:text-indigo-400 transition-colors",children:"Capture Card"})]})]}),se&&q.footer&&i.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-black/40 rounded-2xl border border-orange-500/20 max-w-[200px]",children:[i.jsxs("div",{className:"text-[10px] font-black uppercase text-orange-400 tracking-widest flex items-center gap-2",children:[i.jsx(vj,{className:"w-3 h-3"}),"ROI Crops"]}),i.jsx("div",{className:"flex flex-col gap-2",children:i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:q.footer,className:"h-8 w-full object-contain bg-white rounded border border-white/10",alt:"Footer"}),i.jsx("div",{className:"absolute top-0 right-0 bg-black/60 text-white text-[8px] px-1 rounded-bl",children:"Footer"})]})}),E?.error&&i.jsx("div",{className:"mt-2 pt-2 border-t border-white/10",children:i.jsxs("p",{className:"text-[8px] text-gray-400 font-mono break-all leading-tight",children:["RAW: ",E.raw||"---"]})})]}),!V&&i.jsxs("button",{onClick:()=>v.current?.click(),disabled:k||!I,className:"w-14 h-14 bg-gray-800 hover:bg-gray-700 disabled:text-gray-600 text-gray-400 rounded-2xl flex items-center justify-center border border-white/5 transition-all active:scale-90 relative group",title:"Upload Image",children:[i.jsx(q_e,{className:"w-6 h-6"}),i.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-600 group-hover:text-indigo-400 transition-colors",children:"Upload File"})]})]}),i.jsx("input",{type:"file",ref:v,onChange:ae,accept:"image/*",className:"hidden"}),se&&i.jsx(S3e,{})]}),u==="review"&&i.jsx("div",{className:"h-full flex flex-col bg-gray-950/50",children:L.length===0?i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[i.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-3xl flex items-center justify-center text-gray-600 mb-4",children:i.jsx(TO,{className:"w-10 h-10"})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Cards Scanned"}),i.jsx("p",{className:"text-gray-500 text-sm max-w-xs",children:"Return to the scan view and aim your camera at a card to get started."}),i.jsx("button",{onClick:()=>h("scanning"),className:"mt-6 px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold",children:"Go Back to Scan"})]}):i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0 md:p-6",children:i.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[i.jsx("thead",{className:"hidden md:table-header-group",children:i.jsxs("tr",{className:"text-[10px] uppercase font-bold tracking-[0.2em] text-gray-500",children:[i.jsx("th",{className:"px-6 py-2",children:"Card Detail"}),i.jsx("th",{className:"px-6 py-2",children:"Set / #"}),i.jsx("th",{className:"px-6 py-2",children:"Finish"}),i.jsx("th",{className:"px-6 py-2",children:"Qty"}),i.jsx("th",{className:"px-6 py-2 text-right",children:"Action"})]})}),i.jsx("tbody",{className:"space-y-4",children:L.map(le=>i.jsxs("tr",{className:"bg-gray-900 border border-white/5 md:border-none rounded-2xl md:rounded-none group hover:bg-white/5 transition-colors",children:[i.jsxs("td",{className:"px-4 py-3 md:px-6 md:py-4 flex items-center gap-4",children:[i.jsx("img",{src:le.image,className:"w-12 h-16 object-cover rounded shadow-lg",alt:le.name}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:le.name}),i.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5",children:le.set_name})]})]}),i.jsx("td",{className:"hidden md:table-cell px-6 py-4",children:i.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[i.jsxs("select",{value:le.scryfall_id,onChange:_e=>fe(le.id,_e.target.value),className:"bg-gray-800 border border-white/10 rounded-lg px-2 py-1 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 truncate",children:[le.variants?.map(_e=>i.jsxs("option",{value:_e.id,children:[_e.set.toUpperCase()," #",_e.collector_number," (",_e.set_name,")"]},_e.id)),!le.variants?.length&&i.jsxs("option",{value:le.scryfall_id,children:[le.set_code.toUpperCase()," #",le.collector_number]})]}),i.jsx("span",{className:"text-[9px] text-gray-600 mt-1 uppercase tracking-tighter",children:"Tap to change version"})]})}),i.jsx("td",{className:"px-4 md:px-6 py-4",children:i.jsx("button",{onClick:()=>ue(le.id,{finish:le.finish==="foil"?"nonfoil":"foil"}),className:`text-[10px] px-2 py-1 rounded border transition-all ${le.finish==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 font-bold shadow-[0_0_10px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500"}`,children:le.finish==="foil"?" FOIL":"NON-FOIL"})}),i.jsx("td",{className:"px-4 md:px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>ue(le.id,{quantity:Math.max(1,le.quantity-1)}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"-"}),i.jsx("span",{className:"text-sm font-bold text-white w-4 text-center",children:le.quantity}),i.jsx("button",{onClick:()=>ue(le.id,{quantity:le.quantity+1}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"+"})]})}),i.jsx("td",{className:"px-4 md:px-6 py-4 text-right",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>ue(le.id,{is_wishlist:!le.is_wishlist}),className:`p-1.5 rounded-lg transition-all ${le.is_wishlist?"bg-red-500/10 text-red-500":"bg-gray-800/50 text-gray-500 hover:text-red-400"}`,title:le.is_wishlist?"Remove from Wishlist":"Add to Wishlist",children:i.jsx(Xke,{className:`w-4 h-4 ${le.is_wishlist?"fill-current":""}`})}),i.jsx("button",{onClick:()=>K(le.id),className:"p-1.5 text-gray-600 hover:text-red-500 transition-colors",children:i.jsx(Pre,{className:"w-4 h-4"})})]})})]},le.id))})]})})})]}),i.jsxs("div",{className:"p-6 border-t border-white/5 bg-gray-900/80 flex justify-between items-center",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em]",children:[L.length," Cards in Batch"]}),L.length>0&&i.jsxs("div",{className:"relative",children:[i.jsxs("select",{value:P.type==="deck"?`deck-${P.id}`:P.type==="user"?`user-${P.id}`:"collection",onChange:le=>{const _e=le.target.value;if(_e==="collection")R({type:"collection",id:"me",name:"My Collection"});else if(_e.startsWith("deck-")){const oe=_e.replace("deck-",""),Oe=s.find(ze=>ze.id===oe);R({type:"deck",id:oe,name:Oe?.name||"Deck"})}else if(_e.startsWith("user-")){const oe=_e.replace("user-",""),Oe=a.find(ze=>ze.id===oe);R({type:"user",id:oe,name:Oe?.name||"Friend"})}},className:"bg-gray-800 text-indigo-400 text-xs font-bold py-1 pl-2 pr-6 rounded border border-gray-700 focus:outline-none focus:border-indigo-500 appearance-none cursor-pointer hover:bg-gray-700 transition-colors max-w-[150px] truncate",children:[i.jsx("option",{value:"collection",children:"My Collection"}),i.jsx("optgroup",{label:"My Decks",children:s.map(le=>i.jsx("option",{value:`deck-${le.id}`,children:le.name},le.id))}),a.length>0&&i.jsx("optgroup",{label:"Linked Accounts",children:a.map(le=>i.jsxs("option",{value:`user-${le.id}`,children:[le.name,"'s Collection"]},le.id))})]}),i.jsx(Nke,{className:"w-3 h-3 text-gray-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[L.length>0&&u==="scanning"&&i.jsx("button",{onClick:()=>h("review"),className:"px-6 py-2 text-gray-400 hover:text-white font-bold text-xs",children:"Review All"}),i.jsxs("button",{onClick:he,disabled:L.length===0,className:`px-10 py-3 rounded-2xl font-black text-sm transition-all shadow-xl active:scale-95 flex items-center gap-2 ${L.length>0?"bg-indigo-600 text-white shadow-indigo-900/40":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:[i.jsx(ih,{className:"w-4 h-4"})," ",n==="audit"?"Apply to Audit":"Add to Collection"]})]})]}),i.jsx("canvas",{ref:y,style:{display:"none"}})]})}),document.body):null},C3e=(t,e,r=[])=>{if(t.key.toLowerCase()!==e.toLowerCase())return!1;const n=r.includes("ctrl")||r.includes("meta"),s=r.includes("shift"),a=r.includes("alt");return!((t.ctrlKey||t.metaKey)!==n||t.shiftKey!==s||t.altKey!==a)};function sne(t=[],e={}){const{enabled:r=!0,target:n}=e,s=b.useCallback(a=>{if(r)for(const o of t){const{key:l,modifiers:c=[],action:u,preventDefault:h=!0}=o;if(C3e(a,l,c)){h&&a.preventDefault(),u(a);return}}},[t,r]);b.useEffect(()=>{const a=n?.current||window;return a.addEventListener("keydown",s),()=>a.removeEventListener("keydown",s)},[s,n])}const E3e=()=>{const t=Ca(),{currentUser:e,userProfile:r,logout:n,updateSettings:s,refreshUserProfile:a,uploadProfilePicture:o}=Cr(),l=yn(),{addToast:c}=Tn(),u=t.pathname==="/",[h,f]=b.useState(!1),[m,g]=b.useState(!1),[y,v]=b.useState(!1),[w,N]=b.useState(!1),[k,C]=b.useState(!1),[I,O]=b.useState(!1),[L,_]=b.useState(!1),[E,M]=b.useState(!1),[B,S]=b.useState(!1),[P,R]=b.useState(!1),[V,ee]=b.useState(!1),[G,J]=b.useState(!1),Z=Ie.useRef(null);sne([{key:"k",modifiers:["ctrl"],action:()=>f(!0)},{key:"/",modifiers:["ctrl"],action:()=>O(!0)}]),Ie.useEffect(()=>{const pe=K=>{L&&!K.target.closest("#user-menu-button")&&!K.target.closest("#user-menu-dropdown")&&_(!1)};return document.addEventListener("mousedown",pe),()=>document.removeEventListener("mousedown",pe)},[L]);const se=async pe=>{console.log("Saving new playstyle:",pe),await s({playstyle:pe}),await a(),N(!0)},X=async pe=>{const K=pe.target.files[0];if(K){console.log("[Navbar] Starting file upload:",K.name,K.size,K.type);try{M(!0),console.log("[Navbar] Calling uploadProfilePicture...");const ue=await o(K);console.log("[Navbar] Upload successful! Photo URL:",ue),alert("Profile picture updated successfully!")}catch(ue){console.error("[Navbar] Upload failed:",ue),alert(`Upload failed: ${ue.message} `)}finally{console.log("[Navbar] Upload complete, resetting state"),M(!1),_(!1)}}},q=()=>{Z.current?.click()},U=e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",H=U?"FORGE MASTER":e?.email||"";let re=null;const ae=r?.subscription_tier;if(ae&&ae!=="free"){const pe=ta[ae];pe&&(re={icon:"",label:pe.name,color:"text-blue-400 border-blue-500/30 bg-blue-500/10"},ae===lr.TIER_1&&(re={icon:"",label:"Apprentice",color:"text-blue-400 border-blue-500/30 bg-blue-500/10"}),ae===lr.TIER_2&&(re={icon:"",label:"Magician",color:"text-purple-400 border-purple-500/30 bg-purple-500/10"}),ae===lr.TIER_3&&(re={icon:"",label:"Wizard",color:"text-yellow-400 border-yellow-500/30 bg-yellow-500/10"}),ae===lr.TIER_4&&(re={icon:"",label:"Archmage",color:"text-orange-400 border-orange-500/30 bg-orange-500/10"}),ae===lr.TIER_5&&(re={icon:"",label:"Planeswalker",color:"text-red-400 border-red-500/30 bg-red-500/10"}))}const xe=U?{icon:"",label:"Architect",color:"text-amber-500 bg-amber-500/20 border-amber-500/50"}:re||r?.settings?.badge||{icon:"",label:"Alpha Tester",color:"text-gray-400 bg-gray-800 border-gray-700"},Ne=async()=>{try{await n(),window.location.href="/"}catch(pe){console.error("Logout failed",pe)}};return i.jsxs(i.Fragment,{children:[i.jsx("nav",{className:"bg-gray-950/30 backdrop-blur-2xl border-b border-white/5 sticky top-0 z-50",children:i.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"flex items-center justify-between h-16",children:i.jsxs("div",{className:"flex items-center justify-between w-full",children:[i.jsx("div",{className:"flex-shrink-0 flex items-center gap-3",children:i.jsxs(Hr,{to:"/",className:"flex items-center gap-3 transform hover:scale-105 transition-transform",children:[i.jsx("img",{src:"/logo.png",alt:"MTG Forge Logo",className:"h-10 w-auto"}),i.jsxs("div",{className:"flex flex-col gap-1 sm:hidden",children:[i.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none",children:"ALPHA"}),!r?.settings?.onboarding_complete&&i.jsx("span",{className:"bg-blue-500/10 border border-blue-500/30 text-blue-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none uppercase",children:"SETUP"}),r?.subscription_status==="trial"&&i.jsx("span",{className:"bg-amber-500/10 border border-amber-500/30 text-amber-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none uppercase",children:"TRIAL"}),ae&&ae!=="free"&&(()=>{const pe=ta[ae];let K="text-gray-400 border-gray-600 bg-gray-800";return ae===lr.TIER_1&&(K="text-blue-400 border-blue-500/30 bg-blue-500/10"),ae===lr.TIER_2&&(K="text-purple-400 border-purple-500/30 bg-purple-500/10"),ae===lr.TIER_3&&(K="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),ae===lr.TIER_4&&(K="text-orange-400 border-orange-500/30 bg-orange-500/10"),ae===lr.TIER_5&&(K="text-red-400 border-red-500/30 bg-red-500/10"),i.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase w-fit ${K}`,children:pe?.name||ae||"MEMBER"})})(),(r?.override_tier||r?.custom_limits)&&i.jsx("span",{className:"bg-pink-500/10 border border-pink-500/30 text-pink-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none uppercase",children:"CUSTOM"})]}),i.jsxs("div",{className:"hidden sm:flex flex-col justify-center",children:[i.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent leading-none pb-1",children:"MTG-Forge"}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none",children:"ALPHA"}),!r?.settings?.onboarding_complete&&i.jsx("span",{className:"bg-blue-500/10 border border-blue-500/30 text-blue-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none uppercase",children:"SETUP"}),r?.subscription_status==="trial"&&i.jsx("span",{className:"bg-amber-500/10 border border-amber-500/30 text-amber-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none uppercase",children:"TRIAL"}),ae&&ae!=="free"&&(()=>{const pe=ta[ae];let K="text-slate-400 border-slate-600 bg-slate-800";return ae===lr.TIER_1&&(K="text-blue-300 border-blue-500/40 bg-blue-500/20"),ae===lr.TIER_2&&(K="text-purple-300 border-purple-500/40 bg-purple-500/20"),ae===lr.TIER_3&&(K="text-yellow-300 border-yellow-500/40 bg-yellow-500/20"),ae===lr.TIER_4&&(K="text-orange-300 border-orange-500/40 bg-orange-500/20"),ae===lr.TIER_5&&(K="text-red-300 border-red-500/40 bg-red-500/20 shadow-[0_0_10px_rgba(220,38,38,0.3)]"),i.jsx("span",{className:`border text-[9px] font-extrabold px-2 py-0.5 rounded-full leading-none uppercase tracking-widest ${K}`,children:pe?.name||ae||"MEMBER"})})(),(r?.override_tier||r?.custom_limits)&&i.jsx("span",{className:"bg-pink-500/10 border border-pink-500/30 text-pink-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none uppercase tracking-wider",children:"CUSTOM"})]})]})]})}),i.jsx("div",{className:"hidden lg:ml-6 lg:flex lg:items-baseline lg:space-x-1",children:e?i.jsx(i.Fragment,{children:[{path:"/dashboard",label:"Dashboard"},{path:"/collection",label:"Collection"},{path:"/wishlist",label:"Wishlist"},{path:"/decks",label:"Decks"},{path:"/binders",label:"Binders"},{path:"/social",label:"Social"},{path:"/precons",label:"Precons"},{path:"/sets",label:"Sets"},{path:"/vault",label:"The Vault",className:"text-yellow-400 hover:text-yellow-200"}].map(pe=>i.jsx(Hr,{to:pe.path,onClick:K=>{t.pathname==="/onboarding"&&(K.preventDefault(),c("Please complete your profile setup first to access the Forge.","info"))},className:`${pe.className||"text-gray-300 hover:text-white"} px-3 py-2 rounded-md text-sm font-medium transition-colors`,children:pe.label},pe.path))}):i.jsx(i.Fragment,{children:u?i.jsxs(i.Fragment,{children:[i.jsx("a",{href:"#features",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Features"}),i.jsx(Hr,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})]}):i.jsx(i.Fragment,{children:i.jsx(Hr,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})})})}),i.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>f(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20 flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),i.jsx("span",{className:"hidden xl:inline",children:"Add Card"})]}),i.jsx("button",{onClick:()=>O(!0),className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 hover:border-indigo-500 hover:text-white text-gray-400 flex items-center justify-center transition-all shadow-lg",title:"Help Center",children:i.jsx("span",{className:"font-bold text-lg",children:"?"})})]}),e?i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onClick:()=>C(!0),className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all group relative overflow-hidden ${xe.color||"bg-gray-800 border-gray-700 hover:bg-gray-700"}`,title:xe.label||"Change Badge",children:[i.jsx("span",{className:"text-sm relative z-10",children:xe.icon}),i.jsx("div",{className:"absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity"}),U&&i.jsxs("span",{className:"absolute -top-0.5 -right-0.5 flex h-2.5 w-2.5",children:[i.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),i.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-amber-500"})]})]}),i.jsx("span",{className:`text-sm font-bold hidden xl:inline-block ${U?"text-amber-400 tracking-wider drop-shadow-sm":"text-gray-200 tracking-wide"}`,children:xe.label||H}),i.jsx("button",{id:"user-menu-button",onClick:()=>_(!L),className:"text-gray-400 hover:text-white transition-colors focus:outline-none",children:r?.photo_url||e.photoURL&&!V?i.jsx("img",{src:r?.photo_url||e.photoURL,alt:"Profile",className:"h-8 w-8 rounded-full object-cover ring-2 ring-transparent hover:ring-indigo-500 transition-all border border-gray-600",onError:()=>ee(!0)}):i.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 border border-indigo-500/50 flex items-center justify-center ring-2 ring-transparent hover:ring-indigo-500 transition-all",children:i.jsx("span",{className:"text-xs font-bold text-indigo-300",children:e.email?e.email[0].toUpperCase():"U"})})})]}),L&&i.jsxs("div",{id:"user-menu-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 border border-gray-700 ring-1 ring-black ring-opacity-5 animate-fade-in-up",children:[i.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[i.jsx("p",{className:"text-sm text-white font-bold",children:"Account"}),i.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.email})]}),i.jsxs("button",{onClick:()=>{_(!1),R(!0)},className:"block w-full text-left px-4 py-2 text-sm text-yellow-400 hover:bg-gray-700 hover:text-yellow-300 flex items-center gap-2 font-bold",children:[i.jsx("span",{className:"text-lg",children:""})," Achievements"]}),i.jsx("button",{onClick:q,disabled:E,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:E?"Uploading...":"Upload Photo"}),i.jsx("input",{type:"file",ref:Z,onChange:X,className:"hidden",accept:"image/*"}),i.jsx("button",{onClick:()=>{const pe=r?.id||e?.uid;l(`/profile/${pe}`),_(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Your Profile"}),i.jsx("div",{className:"border-t border-gray-700 my-1"}),i.jsx("button",{onClick:()=>{_(!1),N(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Playstyle Profile"}),i.jsx(Hr,{to:"/settings",onClick:()=>_(!1),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Settings"}),(r?.settings?.isAdmin||e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&i.jsx(Hr,{to:"/admin",onClick:()=>_(!1),className:"block px-4 py-2 text-sm text-indigo-400 hover:bg-gray-700 hover:text-indigo-300 font-bold",children:"Admin Console"}),i.jsx("div",{className:"border-t border-gray-700 my-1"}),i.jsxs("button",{onClick:()=>{_(!1),S(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-cyan-400",children:""})," History"]}),i.jsx("div",{className:"border-t border-gray-700 my-1"}),i.jsx("button",{onClick:()=>{_(!1),Ne()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300",children:"Sign Out"})]})]}):i.jsx(Hr,{to:"/login",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Sign In"})]})]})})})}),i.jsx(mO,{isOpen:h,onClose:()=>f(!1),onOpenForgeLens:()=>{f(!1),g(!0)}}),i.jsx(W_,{isOpen:m,onClose:()=>g(!1),onFinish:async(pe,K={})=>{if(!pe||pe.length===0)return;const ue=K.targetDeckId?`deck:${K.targetDeckId} `:"collection",fe=pe.map(he=>({scryfall_id:he.scryfall_id,name:he.name,set_code:he.set_code,collector_number:he.collector_number,finish:he.finish,quantity:he.quantity,is_foil:he.finish==="foil"}));try{console.log("[Navbar] Adding batch via Forge Lens:",fe,ue),await He.batchAddToCollection(fe,ue),c(`Successfully added ${pe.length} cards via Forge Lens!`,"success"),g(!1)}catch(he){console.error("Batch add failed",he),c(`Failed to add cards: ${he.message} `,"error")}}}),i.jsx(yte,{isOpen:y,onClose:()=>v(!1),onComplete:se}),i.jsx(R5e,{isOpen:w,onClose:()=>N(!1),profile:r?.settings?.playstyle,userImage:e?.photoURL,onRetake:()=>{N(!1),v(!0)}}),i.jsx(F5e,{isOpen:k,onClose:()=>C(!1),currentBadgeId:r?.settings?.badge?.id||"alpha_tester",isMaster:e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",onSelect:async pe=>{await s({badge:pe}),await a(),C(!1)}}),i.jsx(zB,{isOpen:B,onClose:()=>S(!1)}),!u&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-gray-900/95 backdrop-blur-xl border-t border-gray-800 z-50 pb-safe shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]",children:i.jsxs("div",{className:"flex justify-around items-center h-16",children:[i.jsxs(Hr,{to:"/dashboard",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/dashboard"?"text-indigo-400":"text-gray-400 hover:text-gray-200"} `,children:[i.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wide",children:"Home"})]}),i.jsxs(Hr,{to:"/collection",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/collection"?"text-indigo-400":"text-gray-400 hover:text-gray-200"} `,children:[i.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wide",children:"Cards"})]}),i.jsxs(Hr,{to:"/decks",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/decks")?"text-indigo-400":"text-gray-400 hover:text-gray-200"} `,children:[i.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wide",children:"Decks"})]}),i.jsxs(Hr,{to:"/settings",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/settings"?"text-indigo-400":"text-gray-400 hover:text-gray-200"} `,children:[i.jsxs("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wide",children:"Settings"})]}),i.jsxs("button",{onClick:()=>J(!0),className:"flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-white",children:[i.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wide",children:"Menu"})]})]})}),G&&i.jsxs("div",{className:"fixed inset-0 z-[60] md:hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>J(!1)}),i.jsxs("div",{className:"absolute bottom-0 left-0 w-full bg-gray-900 rounded-t-3xl border-t border-gray-700 p-6 animate-slide-up-fast pb-24",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-black text-white",children:"Menu"}),i.jsx("button",{onClick:()=>J(!1),className:"p-2 bg-gray-800 rounded-full text-gray-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"grid grid-cols-4 gap-4",children:[{path:"/social",label:"Social",iconPath:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z",color:"indigo"},{path:"/wishlist",label:"Wishlist",iconPath:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z",color:"orange"},{path:"/binders",label:"Binders",iconPath:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue"},{path:"/precons",label:"Precons",iconPath:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4",color:"purple"},{path:"/sets",label:"Sets",iconPath:"M4 6h16M4 10h16M4 14h16M4 18h16",color:"green"},{path:"/vault",label:"Vault",iconPath:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"yellow"}].map(pe=>i.jsxs(Hr,{to:pe.path,onClick:K=>{if(t.pathname==="/onboarding"){K.preventDefault(),c("Please complete your profile setup first.","info");return}J(!1)},className:"flex flex-col items-center gap-2 p-3 bg-gray-800/50 rounded-xl active:scale-95 transition-transform",children:[i.jsx("div",{className:`w-12 h-12 rounded-full bg-${pe.color}-500/10 flex items-center justify-center text-${pe.color}-400`,children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:pe.iconPath})})}),i.jsx("span",{className:"text-xs font-bold text-gray-300",children:pe.label})]},pe.path))})]})]})]}),i.jsx(zB,{isOpen:B,onClose:()=>S(!1)}),i.jsx(J4e,{isOpen:I,onClose:()=>O(!1),onStartTour:()=>window.dispatchEvent(new Event("start-tour")),onOpenChat:()=>{window.dispatchEvent(new Event("open-chat-widget"))}}),i.jsx(tSe,{isOpen:P,onClose:()=>R(!1)})]})},UO=({isOpen:t,onClose:e})=>t?Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Binder Management Guide"}),i.jsx("p",{className:"text-gray-400 text-xs",children:"Organize your collection like a pro."})]})]}),i.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Two Ways to Build"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[i.jsxs("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:[" Manual Binder ",i.jsx("span",{className:"text-[9px] bg-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Magician Tier"})]}),i.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Classic storage. You drag and drop exactly which cards go inside. Great for mirroring your physical binders."})]}),i.jsxs("div",{className:"bg-indigo-900/10 p-4 rounded-2xl border border-indigo-500/20",children:[i.jsxs("h4",{className:"text-indigo-300 font-bold mb-1 flex items-center gap-2",children:[" Smart Binder ",i.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Free & Up"})]}),i.jsx("p",{className:"text-xs text-indigo-200/60 leading-relaxed",children:'Live automation. You set rules (like "Price > $10"), and the binder automatically grabs matching cards from your collection.'})]})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"AI Smart Creator"]}),i.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:"Don't want to build rules manually? Just describe what you want in plain English!"}),i.jsxs("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30 mb-4",children:[i.jsx("p",{className:"font-mono text-xs text-gray-400 mb-2",children:"Try prompts like:"}),i.jsxs("ul",{className:"space-y-2 text-sm text-indigo-300 font-medium",children:[i.jsx("li",{children:'"All my red goblins over $5"'}),i.jsx("li",{children:'"Cards to trade that I have duplicates of"'}),i.jsx("li",{children:'"High value commanders not in any decks"'})]})]}),i.jsx("p",{className:"text-xs text-gray-500",children:"The AI detects price, color, type, quantity, rarity, and even whether a card is currently used in a deck."})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Advanced Logic (In Deck, Quantity)"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[i.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"In Deck Status"}),i.jsxs("p",{className:"text-xs text-gray-400",children:['Filter cards based on usage. Create a "Trade Binder" by excluding cards that are currently ',i.jsx("span",{className:"text-white font-mono",children:"In Deck = True"}),"."]})]}),i.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[i.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"Quantity Control"}),i.jsxs("p",{className:"text-xs text-gray-400",children:["Filter by how many copies you own. Great for finding ",i.jsx("span",{className:"text-white font-mono",children:"Count > 4"})," (Duplicates)."]})]})]})]}),i.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"text-xl",children:""}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Custom Style"}),i.jsx("p",{className:"text-xs text-gray-300",children:"Use any Hex Code color and pick from hundreds of icons (including MTG Mana Symbols) to make your binder pop."})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"text-xl",children:""}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Live Updates"}),i.jsx("p",{className:"text-xs text-gray-300",children:"Smart Binders are alive. When you add a new card to your collection that matches the rules, it instantly appears in the binder."})]})]})]})]})]}),i.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it!"})})]})]}),document.body):null,ine=({isOpen:t,onClose:e})=>t?Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-purple-900 to-gray-900 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-purple-500/20 rounded-xl text-purple-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),i.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["For Pods & Permissions.",i.jsx("span",{className:"text-[9px] bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded uppercase tracking-wider border border-purple-500/30",children:"Requires Wizard Tier"})]})]})]}),i.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),i.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',i.jsx("strong",{className:"text-white",children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),i.jsxs("div",{className:"bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/20 flex items-center gap-3",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("p",{className:"text-xs text-indigo-300 font-bold",children:"Pro Tip: Only add people you actually know and trust to your Pod."})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-blue-500/30 transition-all",children:[i.jsx("span",{className:"text-[10px] font-black uppercase text-blue-400 tracking-wider mb-2 block",children:"Default"}),i.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Viewer"}),i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Private Decks"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Collection"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Download/Clone Decks"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[i.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Edit Decks"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[i.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Change Settings"]})]})]}),i.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-purple-500/30 transition-all",children:[i.jsx("span",{className:"text-[10px] font-black uppercase text-purple-400 tracking-wider mb-2 block",children:"Advanced"}),i.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Editor"}),i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Everything in Viewer"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-white font-bold",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add/Remove Cards ",i.jsx("span",{className:"font-normal text-gray-400 ml-1",children:"from Decks"})]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-green-300",children:[i.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add Cards to Collection"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[i.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Decks"]}),i.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[i.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Manage Account"]})]})]})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),i.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-white ring-2 ring-indigo-500",children:"You"}),i.jsx("div",{className:"h-px bg-gray-600 w-8"}),i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P2"}),i.jsx("div",{className:"h-px bg-gray-600 w-8"}),i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P3"})]}),i.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-widest",children:"Collaborative Deck Building"})]})]})]}),i.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it, thanks!"})})]})]}),document.body):null;var A3e=Object.defineProperty,P4=Object.getOwnPropertySymbols,ane=Object.prototype.hasOwnProperty,one=Object.prototype.propertyIsEnumerable,lz=(t,e,r)=>e in t?A3e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,e8=(t,e)=>{for(var r in e||(e={}))ane.call(e,r)&&lz(t,r,e[r]);if(P4)for(var r of P4(e))one.call(e,r)&&lz(t,r,e[r]);return t},t8=(t,e)=>{var r={};for(var n in t)ane.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&P4)for(var n of P4(t))e.indexOf(n)<0&&one.call(t,n)&&(r[n]=t[n]);return r};var Qm;(t=>{const e=class En{constructor(c,u,h,f){if(this.version=c,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],c<En.MIN_VERSION||c>En.MAX_VERSION)throw new RangeError("Version value out of range");if(f<-1||f>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let m=[];for(let y=0;y<this.size;y++)m.push(!1);for(let y=0;y<this.size;y++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(h);if(this.drawCodewords(g),f==-1){let y=1e9;for(let v=0;v<8;v++){this.applyMask(v),this.drawFormatBits(v);const w=this.getPenaltyScore();w<y&&(f=v,y=w),this.applyMask(v)}}s(0<=f&&f<=7),this.mask=f,this.applyMask(f),this.drawFormatBits(f),this.isFunction=[]}static encodeText(c,u){const h=t.QrSegment.makeSegments(c);return En.encodeSegments(h,u)}static encodeBinary(c,u){const h=t.QrSegment.makeBytes(c);return En.encodeSegments([h],u)}static encodeSegments(c,u,h=1,f=40,m=-1,g=!0){if(!(En.MIN_VERSION<=h&&h<=f&&f<=En.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let y,v;for(y=h;;y++){const C=En.getNumDataCodewords(y,u)*8,I=o.getTotalBits(c,y);if(I<=C){v=I;break}if(y>=f)throw new RangeError("Data too long")}for(const C of[En.Ecc.MEDIUM,En.Ecc.QUARTILE,En.Ecc.HIGH])g&&v<=En.getNumDataCodewords(y,C)*8&&(u=C);let w=[];for(const C of c){r(C.mode.modeBits,4,w),r(C.numChars,C.mode.numCharCountBits(y),w);for(const I of C.getData())w.push(I)}s(w.length==v);const N=En.getNumDataCodewords(y,u)*8;s(w.length<=N),r(0,Math.min(4,N-w.length),w),r(0,(8-w.length%8)%8,w),s(w.length%8==0);for(let C=236;w.length<N;C^=253)r(C,8,w);let k=[];for(;k.length*8<w.length;)k.push(0);return w.forEach((C,I)=>k[I>>>3]|=C<<7-(I&7)),new En(y,u,k,m)}getModule(c,u){return 0<=c&&c<this.size&&0<=u&&u<this.size&&this.modules[u][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),u=c.length;for(let h=0;h<u;h++)for(let f=0;f<u;f++)h==0&&f==0||h==0&&f==u-1||h==u-1&&f==0||this.drawAlignmentPattern(c[h],c[f]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const u=this.errorCorrectionLevel.formatBits<<3|c;let h=u;for(let m=0;m<10;m++)h=h<<1^(h>>>9)*1335;const f=(u<<10|h)^21522;s(f>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,n(f,m));this.setFunctionModule(8,7,n(f,6)),this.setFunctionModule(8,8,n(f,7)),this.setFunctionModule(7,8,n(f,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,n(f,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,n(f,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,n(f,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let h=0;h<12;h++)c=c<<1^(c>>>11)*7973;const u=this.version<<12|c;s(u>>>18==0);for(let h=0;h<18;h++){const f=n(u,h),m=this.size-11+h%3,g=Math.floor(h/3);this.setFunctionModule(m,g,f),this.setFunctionModule(g,m,f)}}drawFinderPattern(c,u){for(let h=-4;h<=4;h++)for(let f=-4;f<=4;f++){const m=Math.max(Math.abs(f),Math.abs(h)),g=c+f,y=u+h;0<=g&&g<this.size&&0<=y&&y<this.size&&this.setFunctionModule(g,y,m!=2&&m!=4)}}drawAlignmentPattern(c,u){for(let h=-2;h<=2;h++)for(let f=-2;f<=2;f++)this.setFunctionModule(c+f,u+h,Math.max(Math.abs(f),Math.abs(h))!=1)}setFunctionModule(c,u,h){this.modules[u][c]=h,this.isFunction[u][c]=!0}addEccAndInterleave(c){const u=this.version,h=this.errorCorrectionLevel;if(c.length!=En.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const f=En.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],m=En.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],g=Math.floor(En.getNumRawDataModules(u)/8),y=f-g%f,v=Math.floor(g/f);let w=[];const N=En.reedSolomonComputeDivisor(m);for(let C=0,I=0;C<f;C++){let O=c.slice(I,I+v-m+(C<y?0:1));I+=O.length;const L=En.reedSolomonComputeRemainder(O,N);C<y&&O.push(0),w.push(O.concat(L))}let k=[];for(let C=0;C<w[0].length;C++)w.forEach((I,O)=>{(C!=v-m||O>=y)&&k.push(I[C])});return s(k.length==g),k}drawCodewords(c){if(c.length!=Math.floor(En.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let f=0;f<this.size;f++)for(let m=0;m<2;m++){const g=h-m,v=(h+1&2)==0?this.size-1-f:f;!this.isFunction[v][g]&&u<c.length*8&&(this.modules[v][g]=n(c[u>>>3],7-(u&7)),u++)}}s(u==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let f;switch(c){case 0:f=(h+u)%2==0;break;case 1:f=u%2==0;break;case 2:f=h%3==0;break;case 3:f=(h+u)%3==0;break;case 4:f=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:f=h*u%2+h*u%3==0;break;case 6:f=(h*u%2+h*u%3)%2==0;break;case 7:f=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&f&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let c=0;for(let m=0;m<this.size;m++){let g=!1,y=0,v=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[m][w]==g?(y++,y==5?c+=En.PENALTY_N1:y>5&&c++):(this.finderPenaltyAddHistory(y,v),g||(c+=this.finderPenaltyCountPatterns(v)*En.PENALTY_N3),g=this.modules[m][w],y=1);c+=this.finderPenaltyTerminateAndCount(g,y,v)*En.PENALTY_N3}for(let m=0;m<this.size;m++){let g=!1,y=0,v=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[w][m]==g?(y++,y==5?c+=En.PENALTY_N1:y>5&&c++):(this.finderPenaltyAddHistory(y,v),g||(c+=this.finderPenaltyCountPatterns(v)*En.PENALTY_N3),g=this.modules[w][m],y=1);c+=this.finderPenaltyTerminateAndCount(g,y,v)*En.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let g=0;g<this.size-1;g++){const y=this.modules[m][g];y==this.modules[m][g+1]&&y==this.modules[m+1][g]&&y==this.modules[m+1][g+1]&&(c+=En.PENALTY_N2)}let u=0;for(const m of this.modules)u=m.reduce((g,y)=>g+(y?1:0),u);const h=this.size*this.size,f=Math.ceil(Math.abs(u*20-h*10)/h)-1;return s(0<=f&&f<=9),c+=f*En.PENALTY_N4,s(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let h=[6];for(let f=this.size-7;h.length<c;f-=u)h.splice(1,0,f);return h}}static getNumRawDataModules(c){if(c<En.MIN_VERSION||c>En.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*c+128)*c+64;if(c>=2){const h=Math.floor(c/7)+2;u-=(25*h-10)*h-55,c>=7&&(u-=36)}return s(208<=u&&u<=29648),u}static getNumDataCodewords(c,u){return Math.floor(En.getNumRawDataModules(c)/8)-En.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c]*En.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let u=[];for(let f=0;f<c-1;f++)u.push(0);u.push(1);let h=1;for(let f=0;f<c;f++){for(let m=0;m<u.length;m++)u[m]=En.reedSolomonMultiply(u[m],h),m+1<u.length&&(u[m]^=u[m+1]);h=En.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(c,u){let h=u.map(f=>0);for(const f of c){const m=f^h.shift();h.push(0),u.forEach((g,y)=>h[y]^=En.reedSolomonMultiply(g,m))}return h}static reedSolomonMultiply(c,u){if(c>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let f=7;f>=0;f--)h=h<<1^(h>>>7)*285,h^=(u>>>f&1)*c;return s(h>>>8==0),h}finderPenaltyCountPatterns(c){const u=c[1];s(u<=this.size*3);const h=u>0&&c[2]==u&&c[3]==u*3&&c[4]==u&&c[5]==u;return(h&&c[0]>=u*4&&c[6]>=u?1:0)+(h&&c[6]>=u*4&&c[0]>=u?1:0)}finderPenaltyTerminateAndCount(c,u,h){return c&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(c,u){u[0]==0&&(c+=this.size),u.pop(),u.unshift(c)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(l,c,u){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let h=c-1;h>=0;h--)u.push(l>>>h&1)}function n(l,c){return(l>>>c&1)!=0}function s(l){if(!l)throw new Error("Assertion error")}const a=class Yi{constructor(c,u,h){if(this.mode=c,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(c){let u=[];for(const h of c)r(h,8,u);return new Yi(Yi.Mode.BYTE,c.length,u)}static makeNumeric(c){if(!Yi.isNumeric(c))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<c.length;){const f=Math.min(c.length-h,3);r(parseInt(c.substring(h,h+f),10),f*3+1,u),h+=f}return new Yi(Yi.Mode.NUMERIC,c.length,u)}static makeAlphanumeric(c){if(!Yi.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=c.length;h+=2){let f=Yi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h))*45;f+=Yi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h+1)),r(f,11,u)}return h<c.length&&r(Yi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(h)),6,u),new Yi(Yi.Mode.ALPHANUMERIC,c.length,u)}static makeSegments(c){return c==""?[]:Yi.isNumeric(c)?[Yi.makeNumeric(c)]:Yi.isAlphanumeric(c)?[Yi.makeAlphanumeric(c)]:[Yi.makeBytes(Yi.toUtf8ByteArray(c))]}static makeEci(c){let u=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,u);else if(c<16384)r(2,2,u),r(c,14,u);else if(c<1e6)r(6,3,u),r(c,21,u);else throw new RangeError("ECI assignment value out of range");return new Yi(Yi.Mode.ECI,0,u)}static isNumeric(c){return Yi.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return Yi.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,u){let h=0;for(const f of c){const m=f.mode.numCharCountBits(u);if(f.numChars>=1<<m)return 1/0;h+=4+m+f.bitData.length}return h}static toUtf8ByteArray(c){c=encodeURI(c);let u=[];for(let h=0;h<c.length;h++)c.charAt(h)!="%"?u.push(c.charCodeAt(h)):(u.push(parseInt(c.substring(h+1,h+3),16)),h+=2);return u}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=a;t.QrSegment=a})(Qm||(Qm={}));(t=>{(e=>{const r=class{constructor(s,a){this.ordinal=s,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(Qm||(Qm={}));(t=>{(e=>{const r=class{constructor(s,a){this.modeBits=s,this.numBitsCharCount=a}numCharCountBits(s){return this.numBitsCharCount[Math.floor((s+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(Qm||(Qm={}));var Yx=Qm;var T3e={L:Yx.QrCode.Ecc.LOW,M:Yx.QrCode.Ecc.MEDIUM,Q:Yx.QrCode.Ecc.QUARTILE,H:Yx.QrCode.Ecc.HIGH},lne=128,cne="L",une="#FFFFFF",dne="#000000",hne=!1,fne=1,I3e=4,P3e=0,L3e=.1;function pne(t,e=0){const r=[];return t.forEach(function(n,s){let a=null;n.forEach(function(o,l){if(!o&&a!==null){r.push(`M${a+e} ${s+e}h${l-a}v1H${a+e}z`),a=null;return}if(l===n.length-1){if(!o)return;a===null?r.push(`M${l+e},${s+e} h1v1H${l+e}z`):r.push(`M${a+e},${s+e} h${l+1-a}v1H${a+e}z`);return}o&&a===null&&(a=l)})}),r.join("")}function mne(t,e){return t.slice().map((r,n)=>n<e.y||n>=e.y+e.h?r:r.map((s,a)=>a<e.x||a>=e.x+e.w?s:!1))}function O3e(t,e,r,n){if(n==null)return null;const s=t.length+r*2,a=Math.floor(e*L3e),o=s/e,l=(n.width||a)*o,c=(n.height||a)*o,u=n.x==null?t.length/2-l/2:n.x*o,h=n.y==null?t.length/2-c/2:n.y*o,f=n.opacity==null?1:n.opacity;let m=null;if(n.excavate){let y=Math.floor(u),v=Math.floor(h),w=Math.ceil(l+u-y),N=Math.ceil(c+h-v);m={x:y,y:v,w,h:N}}const g=n.crossOrigin;return{x:u,y:h,h:c,w:l,excavation:m,opacity:f,crossOrigin:g}}function M3e(t,e){return e!=null?Math.max(Math.floor(e),0):t?I3e:P3e}function gne({value:t,level:e,minVersion:r,includeMargin:n,marginSize:s,imageSettings:a,size:o,boostLevel:l}){let c=Ie.useMemo(()=>{const y=(Array.isArray(t)?t:[t]).reduce((v,w)=>(v.push(...Yx.QrSegment.makeSegments(w)),v),[]);return Yx.QrCode.encodeSegments(y,T3e[e],r,void 0,void 0,l)},[t,e,r,l]);const{cells:u,margin:h,numCells:f,calculatedImageSettings:m}=Ie.useMemo(()=>{let g=c.getModules();const y=M3e(n,s),v=g.length+y*2,w=O3e(g,o,y,a);return{cells:g,margin:y,numCells:v,calculatedImageSettings:w}},[c,o,a,n,s]);return{qrcode:c,margin:h,cells:u,numCells:f,calculatedImageSettings:m}}var R3e=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),D3e=Ie.forwardRef(function(e,r){const n=e,{value:s,size:a=lne,level:o=cne,bgColor:l=une,fgColor:c=dne,includeMargin:u=hne,minVersion:h=fne,boostLevel:f,marginSize:m,imageSettings:g}=n,v=t8(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:w}=v,N=t8(v,["style"]),k=g?.src,C=Ie.useRef(null),I=Ie.useRef(null),O=Ie.useCallback(V=>{C.current=V,typeof r=="function"?r(V):r&&(r.current=V)},[r]),[L,_]=Ie.useState(!1),{margin:E,cells:M,numCells:B,calculatedImageSettings:S}=gne({value:s,level:o,minVersion:h,boostLevel:f,includeMargin:u,marginSize:m,imageSettings:g,size:a});Ie.useEffect(()=>{if(C.current!=null){const V=C.current,ee=V.getContext("2d");if(!ee)return;let G=M;const J=I.current,Z=S!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;Z&&S.excavation!=null&&(G=mne(M,S.excavation));const se=window.devicePixelRatio||1;V.height=V.width=a*se;const X=a/B*se;ee.scale(X,X),ee.fillStyle=l,ee.fillRect(0,0,B,B),ee.fillStyle=c,R3e?ee.fill(new Path2D(pne(G,E))):M.forEach(function(q,U){q.forEach(function(H,re){H&&ee.fillRect(re+E,U+E,1,1)})}),S&&(ee.globalAlpha=S.opacity),Z&&ee.drawImage(J,S.x+E,S.y+E,S.w,S.h)}}),Ie.useEffect(()=>{_(!1)},[k]);const P=e8({height:a,width:a},w);let R=null;return k!=null&&(R=Ie.createElement("img",{src:k,key:k,style:{display:"none"},onLoad:()=>{_(!0)},ref:I,crossOrigin:S?.crossOrigin})),Ie.createElement(Ie.Fragment,null,Ie.createElement("canvas",e8({style:P,height:a,width:a,ref:O,role:"img"},N)),R)});D3e.displayName="QRCodeCanvas";var G_=Ie.forwardRef(function(e,r){const n=e,{value:s,size:a=lne,level:o=cne,bgColor:l=une,fgColor:c=dne,includeMargin:u=hne,minVersion:h=fne,boostLevel:f,title:m,marginSize:g,imageSettings:y}=n,v=t8(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:w,cells:N,numCells:k,calculatedImageSettings:C}=gne({value:s,level:o,minVersion:h,boostLevel:f,includeMargin:u,marginSize:g,imageSettings:y,size:a});let I=N,O=null;y!=null&&C!=null&&(C.excavation!=null&&(I=mne(N,C.excavation)),O=Ie.createElement("image",{href:y.src,height:C.h,width:C.w,x:C.x+w,y:C.y+w,preserveAspectRatio:"none",opacity:C.opacity,crossOrigin:C.crossOrigin}));const L=pne(I,w);return Ie.createElement("svg",e8({height:a,width:a,viewBox:`0 0 ${k} ${k}`,ref:r,role:"img"},v),!!m&&Ie.createElement("title",null,m),Ie.createElement("path",{fill:l,d:`M0,0 h${k}v${k}H0z`,shapeRendering:"crispEdges"}),Ie.createElement("path",{fill:c,d:L,shapeRendering:"crispEdges"}),O)});G_.displayName="QRCodeSVG";const B3e=({isOpen:t,onClose:e})=>{if(!t)return null;const r="https://mtg-forge.com/share/heir-to-the-hysteria-x26l";return Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"relative z-10 w-full max-w-md bg-gray-900 border border-white/10 rounded-3xl overflow-hidden shadow-2xl animate-fade-in-up",children:[i.jsxs("div",{className:"p-6 pb-2 text-center",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Scan to view deck list instantly"})]}),i.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[i.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:i.jsx(G_,{value:r,size:200,level:"H",includeMargin:!1})}),i.jsxs("div",{className:"w-full text-center space-y-3",children:[i.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-xl p-3 flex items-center gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 text-left",children:"Share Link"}),i.jsx("p",{className:"text-xs text-indigo-300 font-mono truncate text-left select-all",children:r})]}),i.jsx("button",{onClick:()=>navigator.clipboard.writeText(r),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Copy",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Anyone with this link can view the full deck list and statistics."})]})]}),i.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/50 flex justify-center",children:i.jsx("button",{onClick:()=>window.open(r,"_blank"),className:"text-indigo-400 hover:text-white text-sm font-bold transition-colors",children:"Open Link in New Tab "})})]})]}),document.body)},zO=({isOpen:t,onClose:e})=>t?Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Audit & Verification Guide"}),i.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["Audit The Forge to verify your collection.",i.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider border border-green-500/30",children:"Requires Wizard Tier"})]})]})]}),i.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Neutral Starting State"]}),i.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:'Every card starts in a "pending" state. We assume your collection matches your records until you verify it.'}),i.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[i.jsx("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:" Pending"}),i.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Gray border. The input is locked. You must choose to Match or flag a Mismatch to continue."})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"2"}),"Quick Verification"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-green-900/10 p-4 rounded-2xl border border-green-500/20",children:[i.jsx("h4",{className:"text-green-300 font-bold mb-1 flex items-center gap-2",children:" Match (Check)"}),i.jsx("p",{className:"text-xs text-green-200/60 leading-relaxed",children:"Instantly marks the card as reviewed and verified. Confirms you have exactly the expected amount."})]}),i.jsxs("div",{className:"bg-red-900/10 p-4 rounded-2xl border border-red-500/20",children:[i.jsx("h4",{className:"text-red-300 font-bold mb-1 flex items-center gap-2",children:" Mismatch (X)"}),i.jsx("p",{className:"text-xs text-red-200/60 leading-relaxed",children:"Flags a discrepancy. Sets count to 0 and unlocks the input so you can type the correct physical count."})]})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"3"}),"Finalizing Your Audit"]}),i.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`Once you've touched every card in a section (Deck or Set), mark it as "Finished".`}),i.jsx("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30",children:i.jsx("p",{className:"text-xs text-indigo-300 font-medium",children:"When the entire audit is complete, use the **Finalize Audit** button in the Hub. This will sync all your Mismatches to your actual collection database, ensuring your digital records match your physical boxes."})})]}),i.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"text-xl",children:""}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Discrepancy Report"}),i.jsx("p",{className:"text-xs text-gray-300",children:"Use the report table in the Audit Hub to see exactly what changed before you finalize."})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"text-xl",children:""}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Mobile Friendly"}),i.jsx("p",{className:"text-xs text-gray-300",children:"The Audit Wizard is optimized for phone use. Carry your phone to your bulk boxes for easy scanning!"})]})]})]})]})]}),i.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Start Auditing"})})]})]}),document.body):null,F3e=()=>{const[t,e]=b.useState(null);return i.jsxs("section",{id:"features",className:"py-32 bg-transparent relative",children:[i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[i.jsxs("div",{className:"text-center mb-24 animate-fade-in-up",children:[i.jsx("span",{className:"text-indigo-400 font-bold tracking-widest uppercase text-sm mb-2 block",children:"The Forge Advantage"}),i.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white mb-6 leading-tight",children:["Actionable Intelligence.",i.jsx("br",{}),"Professional Results."]}),i.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto text-xl italic",children:'"Stop tracking cards. Start forging strategy."'})]}),i.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[i.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[i.jsx("div",{className:"w-20 h-20 bg-orange-500/20 rounded-3xl flex items-center justify-center mb-4 text-orange-400 ring-1 ring-orange-500/20",children:i.jsx("img",{src:"/icons/deck_doctor.png",alt:"AI Deck Doctor",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),i.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The AI Deck Doctor"}),i.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["Precision meets playability. Our surgical analysis engine provides a precise ",i.jsx("span",{className:"text-white",children:"1-5 Bracket Rating"}),', a granular 10-point power score, and card-for-card "Surgical Swaps" to optimize your curve.']}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[i.jsx("div",{className:"text-orange-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Brackets"}),i.jsx("div",{className:"text-white text-lg font-bold",children:"1-5 Scale"})]}),i.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[i.jsx("div",{className:"text-green-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Precision"}),i.jsx("div",{className:"text-white text-lg font-bold",children:"0.01 PL Step"})]})]})]}),i.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(249,115,22,0.3)] border border-orange-500/20 group animate-fade-in-right bg-gray-900/40 p-10 backdrop-blur-md",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-end",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Calculated Power"}),i.jsx("div",{className:"text-5xl font-black text-white italic",children:"7.42"})]}),i.jsx("div",{className:"px-4 py-2 bg-orange-500/20 rounded-lg border border-orange-500/30 text-orange-400 font-black uppercase tracking-widest text-xs",children:"Bracket 3"})]}),i.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 via-amber-400 to-orange-600 w-[74%]"})}),i.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]}),i.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[i.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[i.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center mb-4 text-indigo-400 ring-1 ring-indigo-500/20 shadow-[0_0_30px_rgba(79,70,229,0.2)]",children:i.jsx("img",{src:"/icons/the_neural_architect.png",alt:"Neural Architect",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),i.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The Neural Architect"}),i.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["The first true ",i.jsx("span",{className:"text-white",children:"Zero-to-Hero"})," deck builder. Select your Commander, and watch as the Architect synthesizes a full 100-card list while prioritizing the cards you already own."]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"A"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Commander-Centric Synthesis"}),i.jsx("div",{className:"text-gray-400 text-sm",children:"From your commander selection to a complete 100-card list in seconds."})]})]}),i.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"C"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Collection-Aware"}),i.jsx("div",{className:"text-gray-400 text-sm",children:"Builds using cards you own first, minimizing proxy needs."})]})]})]})]}),i.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(79,70,229,0.3)] border border-indigo-500/20 group animate-fade-in-left bg-gray-900/40 p-10 backdrop-blur-md",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-2",children:"Neural Blueprint Generation"}),[{t:"Commander",v:"Selected: Niv-Mizzet, Parun"},{t:"Budget",v:"$50 (Utilizing Collection)"},{t:"Power",v:"Target Bracket 3"}].map((r,n)=>i.jsxs("div",{className:"flex justify-between items-center p-3 bg-black/40 rounded-xl border border-white/5",children:[i.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:r.t}),i.jsx("span",{className:"text-xs font-black text-indigo-400",children:r.v})]},n)),i.jsxs("div",{className:"mt-6 pt-6 border-t border-white/10",children:[i.jsxs("div",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Blueprint Complete: 100/100 Cards"]}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(8)].map((r,n)=>i.jsx("div",{className:"h-1 bg-indigo-500/40 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-indigo-400 w-full animate-shimmer"})},n))})]})]})})]}),i.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[i.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[i.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-3xl flex items-center justify-center mb-4 text-blue-400 ring-1 ring-blue-500/20",children:i.jsx("img",{src:"/icons/ai_strategy_analyst.png",alt:"AI Strategy Analyst",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),i.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"AI Strategy Analyst"}),i.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Don't just build listsforge legends. Our Gemini-powered AI acts as a dedicated coach, analyzing synergies and suggesting win conditions tailored to your unique playstyle."}),i.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[i.jsx("div",{className:"text-blue-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Advisor Analysis"}),i.jsx("div",{className:"text-white text-lg font-bold italic",children:'"Your win rate against Aggro pods increases by 14% with these adjustments."'})]})]}),i.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(59,130,246,0.3)] border border-blue-500/20 group animate-fade-in-right",children:i.jsx("img",{src:"/images/features/ai-strategy-modal.png",alt:"AI Strategy Modal",className:"w-full h-auto opacity-80 hover:opacity-100 transition-opacity duration-700"})})]}),i.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[i.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[i.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-3xl flex items-center justify-center mb-4 text-purple-400 ring-1 ring-purple-500/20",children:i.jsx("img",{src:"/icons/social_pods.png",alt:"Social Pods",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),i.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:'Rule Your "Pod"'}),i.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Magic is a social game. Link accounts with your playgroup to browse friends' collections, manage shared trades, and coordinate group power levels instantly."}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsx("button",{onClick:()=>e("pods"),className:"px-8 py-3 rounded-xl bg-purple-500/10 border border-purple-500/30 text-purple-400 font-bold hover:bg-purple-500/20 transition-all",children:"Explore Pods"}),i.jsx("button",{onClick:()=>e("qr"),className:"px-8 py-3 rounded-xl bg-white/5 border border-white/10 text-white font-bold hover:bg-white/10 transition-all",children:"Quick Share"})]})]}),i.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(168,85,247,0.3)] border border-purple-500/20 group animate-fade-in-left bg-gray-950 p-12",children:i.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full h-full",children:[i.jsxs("div",{className:"bg-indigo-900/30 rounded-2xl border border-indigo-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("div",{className:"text-[10px] font-black text-indigo-300 uppercase tracking-widest",children:"Smart Binder"})]}),i.jsxs("div",{className:"bg-purple-900/30 rounded-2xl border border-purple-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-75",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("div",{className:"text-[10px] font-black text-purple-300 uppercase tracking-widest",children:"Pod Trade"})]}),i.jsxs("div",{className:"bg-blue-900/30 rounded-2xl border border-blue-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-100",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("div",{className:"text-[10px] font-black text-blue-300 uppercase tracking-widest",children:"QR Share"})]}),i.jsxs("div",{className:"bg-green-900/30 rounded-2xl border border-green-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-150",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("div",{className:"text-[10px] font-black text-green-300 uppercase tracking-widest",children:"Audits"})]})]})})]}),i.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16",children:[i.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[i.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-4 group cursor-pointer transition-transform hover:scale-110 duration-500",children:i.jsx("img",{src:"/icons/the_professional_foundation.png",alt:"The Professional Foundation",className:"w-20 h-20 object-contain transition-all duration-500 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),i.jsx("h3",{className:"text-3xl font-black text-white leading-tight uppercase tracking-tight",children:"The Professional Foundation"}),i.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Underneath the AI intelligence is a robust engine for cataloging your digital life. Fast scanning, accurate pricing, and comprehensive management for any format."})]}),i.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800/20 group",children:i.jsx("img",{src:"/images/features/collection-dashboard.jpg",alt:"Collection Dashboard",className:"w-full h-full object-cover opacity-40 group-hover:opacity-80 transition-opacity duration-700"})})]})]}),i.jsx(UO,{isOpen:t==="smart",onClose:()=>e(null)}),i.jsx(ine,{isOpen:t==="pods",onClose:()=>e(null)}),i.jsx(B3e,{isOpen:t==="qr",onClose:()=>e(null)}),i.jsx(zO,{isOpen:t==="audit",onClose:()=>e(null)})]})},$3e=()=>i.jsxs("div",{className:"flex flex-col min-h-screen relative",children:[i.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-cover bg-center hidden md:block",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"}}),i.jsx("div",{className:"absolute inset-0 bg-cover bg-center md:hidden",style:{backgroundImage:"url(/MTG-Forge_Logo_Background_mobile.png)"}}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-gray-950/80 to-black z-10"}),i.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[100vw] h-[100vh] bg-indigo-600/10 blur-[150px] rounded-full z-0 opacity-40"}),i.jsx("div",{className:"absolute top-1/4 left-1/4 w-[600px] h-[600px] bg-orange-500/5 blur-[120px] rounded-full z-0 opacity-20"})]}),i.jsx("div",{className:"bg-gradient-to-r from-orange-600 via-red-600 to-orange-600 text-white text-center py-2 px-4 shadow-lg z-50 relative animate-pulse-slow",children:i.jsxs("p",{className:"font-bold text-sm tracking-wide flex items-center justify-center gap-2",children:[i.jsx("span",{className:"text-lg",children:""}),"ALPHA TEST - Feature Complete but Experimental",i.jsx("span",{className:"text-lg",children:""})]})}),i.jsx("div",{className:"relative z-10 bg-transparent min-h-[80vh] flex flex-col items-center",children:i.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-32 md:py-48 flex flex-col items-center text-center",children:[i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-8 animate-fade-in",children:[i.jsxs("span",{className:"relative flex h-2 w-2",children:[i.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),i.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-indigo-500"})]}),i.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-widest leading-none",children:"The Future of MTG Strategy"})]}),i.jsxs("h1",{className:"text-5xl md:text-8xl font-black tracking-tight text-white mb-8 leading-tight",children:["The Forge: Where Decks",i.jsx("br",{}),i.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-500 to-orange-600 filter drop-shadow-[0_0_15px_rgba(251,191,36,0.3)]",children:"Become Legends"})]}),i.jsxs("p",{className:"max-w-2xl text-xl md:text-2xl text-gray-400 mx-auto font-medium leading-relaxed mb-12",children:["Brew Smarter. Play Harder. Your ",i.jsx("span",{className:"text-white",children:"AI-Powered Strategic Edge"}),". Join the next generation of Magic: The Gathering intelligence."]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center w-full max-w-lg",children:[i.jsxs(Hr,{to:"/dashboard",className:"group relative px-10 py-5 rounded-2xl bg-indigo-600 text-white font-black text-xl transition-all shadow-[0_20px_40px_-15px_rgba(79,70,229,0.5)] hover:shadow-[0_25px_50px_-12px_rgba(79,70,229,0.6)] transform hover:-translate-y-1 hover:scale-[1.02] flex items-center justify-center gap-3",children:[i.jsx("span",{children:"Enter The Forge"}),i.jsx("svg",{className:"w-6 h-6 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]}),i.jsx(Hr,{to:"/strategy",className:"px-10 py-5 rounded-2xl bg-white/5 backdrop-blur-xl hover:bg-white/10 text-white font-bold text-lg border border-white/10 transition-all hover:border-white/20 flex items-center justify-center",children:"Explore AI Strategic Edge"})]}),i.jsxs("div",{className:"mt-24 grid grid-cols-2 md:grid-cols-4 gap-8 w-full max-w-4xl border-t border-white/5 pt-12",children:[i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"99.8%"}),i.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Analysis Accuracy"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"Real-Time"}),i.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Pricing & Sync"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"5"}),i.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Bracket Tiers"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"AI"}),i.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Driven Meta"})]})]})]})}),i.jsx("div",{className:"relative z-10",children:i.jsx(F3e,{})}),i.jsx("footer",{className:"bg-black py-12 border-t border-gray-900 mt-auto",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:i.jsx("p",{className:"text-gray-500",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."})})})]});function U3e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return b.useMemo(()=>n=>{e.forEach(s=>s(n))},e)}const K_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pb(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function VO(t){return"nodeType"in t}function Ol(t){var e,r;return t?pb(t)?t:VO(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function qO(t){const{Document:e}=Ol(t);return t instanceof e}function uw(t){return pb(t)?!1:t instanceof Ol(t).HTMLElement}function xne(t){return t instanceof Ol(t).SVGElement}function mb(t){return t?pb(t)?t.document:VO(t)?qO(t)?t:uw(t)||xne(t)?t.ownerDocument:document:document:document}const dd=K_?b.useLayoutEffect:b.useEffect;function Y_(t){const e=b.useRef(t);return dd(()=>{e.current=t}),b.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return e.current==null?void 0:e.current(...n)},[])}function z3e(){const t=b.useRef(null),e=b.useCallback((n,s)=>{t.current=setInterval(n,s)},[]),r=b.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function a2(t,e){e===void 0&&(e=[t]);const r=b.useRef(t);return dd(()=>{r.current!==t&&(r.current=t)},e),r}function dw(t,e){const r=b.useRef();return b.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function L4(t){const e=Y_(t),r=b.useRef(null),n=b.useCallback(s=>{s!==r.current&&e?.(s,r.current),r.current=s},[]);return[r,n]}function O4(t){const e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}let GE={};function hw(t,e){return b.useMemo(()=>{if(e)return e;const r=GE[t]==null?0:GE[t]+1;return GE[t]=r,t+"-"+r},[t,e])}function yne(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((a,o)=>{const l=Object.entries(o);for(const[c,u]of l){const h=a[c];h!=null&&(a[c]=h+t*u)}return a},{...e})}}const fy=yne(1),o2=yne(-1);function V3e(t){return"clientX"in t&&"clientY"in t}function X_(t){if(!t)return!1;const{KeyboardEvent:e}=Ol(t.target);return e&&t instanceof e}function q3e(t){if(!t)return!1;const{TouchEvent:e}=Ol(t.target);return e&&t instanceof e}function M4(t){if(q3e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return V3e(t)?{x:t.clientX,y:t.clientY}:null}const jf=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[jf.Translate.toString(t),jf.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),cz="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function H3e(t){return t.matches(cz)?t:t.querySelector(cz)}const W3e={display:"none"};function G3e(t){let{id:e,value:r}=t;return Ie.createElement("div",{id:e,style:W3e},r)}function K3e(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ie.createElement("div",{id:e,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function Y3e(){const[t,e]=b.useState("");return{announce:b.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const bne=b.createContext(null);function X3e(t){const e=b.useContext(bne);b.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function Q3e(){const[t]=b.useState(()=>new Set),e=b.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[b.useCallback(n=>{let{type:s,event:a}=n;t.forEach(o=>{var l;return(l=o[s])==null?void 0:l.call(o,a)})},[t]),e]}const J3e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Z3e={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function eCe(t){let{announcements:e=Z3e,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=J3e}=t;const{announce:a,announcement:o}=Y3e(),l=hw("DndLiveRegion"),[c,u]=b.useState(!1);if(b.useEffect(()=>{u(!0)},[]),X3e(b.useMemo(()=>({onDragStart(f){let{active:m}=f;a(e.onDragStart({active:m}))},onDragMove(f){let{active:m,over:g}=f;e.onDragMove&&a(e.onDragMove({active:m,over:g}))},onDragOver(f){let{active:m,over:g}=f;a(e.onDragOver({active:m,over:g}))},onDragEnd(f){let{active:m,over:g}=f;a(e.onDragEnd({active:m,over:g}))},onDragCancel(f){let{active:m,over:g}=f;a(e.onDragCancel({active:m,over:g}))}}),[a,e])),!c)return null;const h=Ie.createElement(Ie.Fragment,null,Ie.createElement(G3e,{id:n,value:s.draggable}),Ie.createElement(K3e,{id:l,announcement:o}));return r?Kn.createPortal(h,r):h}var Wa;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Wa||(Wa={}));function R4(){}function qy(t,e){return b.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function HO(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return b.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const hd=Object.freeze({x:0,y:0});function vne(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function tCe(t,e){const r=M4(t);if(!r)return"0 0";const n={x:(r.x-e.left)/e.width*100,y:(r.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function wne(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function rCe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function uz(t){let{left:e,top:r,height:n,width:s}=t;return[{x:e,y:r},{x:e+s,y:r},{x:e,y:r+n},{x:e+s,y:r+n}]}function Nne(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function dz(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const nCe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const s=dz(e,e.left,e.top),a=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=vne(dz(c),s);a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(wne)},jne=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const s=uz(e),a=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=uz(c),h=s.reduce((m,g,y)=>m+vne(u[y],g),0),f=Number((h/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:f}})}}return a.sort(wne)};function sCe(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),o=s-n,l=a-r;if(n<s&&r<a){const c=e.width*e.height,u=t.width*t.height,h=o*l,f=h/(c+u-h);return Number(f.toFixed(4))}return 0}const iCe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const s=[];for(const a of n){const{id:o}=a,l=r.get(o);if(l){const c=sCe(l,e);c>0&&s.push({id:o,data:{droppableContainer:a,value:c}})}}return s.sort(rCe)};function aCe(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function kne(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:hd}function oCe(t){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...r})}}const lCe=oCe(1);function _ne(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function cCe(t,e,r){const n=_ne(e);if(!n)return t;const{scaleX:s,scaleY:a,x:o,y:l}=n,c=t.left-o-(1-s)*parseFloat(r),u=t.top-l-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),h=s?t.width/s:t.width,f=a?t.height/a:t.height;return{width:h,height:f,top:u,right:c+h,bottom:u+f,left:c}}const uCe={ignoreTransform:!1};function gb(t,e){e===void 0&&(e=uCe);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:h}=Ol(t).getComputedStyle(t);u&&(r=cCe(r,u,h))}const{top:n,left:s,width:a,height:o,bottom:l,right:c}=r;return{top:n,left:s,width:a,height:o,bottom:l,right:c}}function hz(t){return gb(t,{ignoreTransform:!0})}function dCe(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function hCe(t,e){return e===void 0&&(e=Ol(t).getComputedStyle(t)),e.position==="fixed"}function fCe(t,e){e===void 0&&(e=Ol(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=e[s];return typeof a=="string"?r.test(a):!1})}function Q_(t,e){const r=[];function n(s){if(e!=null&&r.length>=e||!s)return r;if(qO(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!uw(s)||xne(s)||r.includes(s))return r;const a=Ol(t).getComputedStyle(s);return s!==t&&fCe(s,a)&&r.push(s),hCe(s,a)?r:n(s.parentNode)}return t?n(t):r}function Sne(t){const[e]=Q_(t,1);return e??null}function KE(t){return!K_||!t?null:pb(t)?t:VO(t)?qO(t)||t===mb(t).scrollingElement?window:uw(t)?t:null:null}function Cne(t){return pb(t)?t.scrollX:t.scrollLeft}function Ene(t){return pb(t)?t.scrollY:t.scrollTop}function r8(t){return{x:Cne(t),y:Ene(t)}}var po;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(po||(po={}));function Ane(t){return!K_||!t?!1:t===document.scrollingElement}function Tne(t){const e={x:0,y:0},r=Ane(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},s=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,o=t.scrollTop>=n.y,l=t.scrollLeft>=n.x;return{isTop:s,isLeft:a,isBottom:o,isRight:l,maxScroll:n,minScroll:e}}const pCe={x:.2,y:.2};function mCe(t,e,r,n,s){let{top:a,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=pCe);const{isTop:u,isBottom:h,isLeft:f,isRight:m}=Tne(t),g={x:0,y:0},y={x:0,y:0},v={height:e.height*s.y,width:e.width*s.x};return!u&&a<=e.top+v.height?(g.y=po.Backward,y.y=n*Math.abs((e.top+v.height-a)/v.height)):!h&&c>=e.bottom-v.height&&(g.y=po.Forward,y.y=n*Math.abs((e.bottom-v.height-c)/v.height)),!m&&l>=e.right-v.width?(g.x=po.Forward,y.x=n*Math.abs((e.right-v.width-l)/v.width)):!f&&o<=e.left+v.width&&(g.x=po.Backward,y.x=n*Math.abs((e.left+v.width-o)/v.width)),{direction:g,speed:y}}function gCe(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:e,left:r,right:n,bottom:s}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:s,width:t.clientWidth,height:t.clientHeight}}function Ine(t){return t.reduce((e,r)=>fy(e,r8(r)),hd)}function xCe(t){return t.reduce((e,r)=>e+Cne(r),0)}function yCe(t){return t.reduce((e,r)=>e+Ene(r),0)}function Pne(t,e){if(e===void 0&&(e=gb),!t)return;const{top:r,left:n,bottom:s,right:a}=e(t);Sne(t)&&(s<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const bCe=[["x",["left","right"],xCe],["y",["top","bottom"],yCe]];class WO{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Q_(r),s=Ine(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,o,l]of bCe)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),h=s[a]-u;return this.rect[c]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class E1{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var s;(s=this.target)==null||s.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function vCe(t){const{EventTarget:e}=Ol(t);return t instanceof e?t:mb(t)}function YE(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var ou;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(ou||(ou={}));function fz(t){t.preventDefault()}function wCe(t){t.stopPropagation()}var Fn;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Fn||(Fn={}));const Lne={start:[Fn.Space,Fn.Enter],cancel:[Fn.Esc],end:[Fn.Space,Fn.Enter,Fn.Tab]},NCe=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case Fn.Right:return{...r,x:r.x+25};case Fn.Left:return{...r,x:r.x-25};case Fn.Down:return{...r,y:r.y+25};case Fn.Up:return{...r,y:r.y-25}}};class J_{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new E1(mb(r)),this.windowListeners=new E1(Ol(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ou.Resize,this.handleCancel),this.windowListeners.add(ou.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ou.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&Pne(n),r(hd)}handleKeyDown(e){if(X_(e)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:a=Lne,coordinateGetter:o=NCe,scrollBehavior:l="smooth"}=s,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=n.current,h=u?{x:u.left,y:u.top}:hd;this.referenceCoordinates||(this.referenceCoordinates=h);const f=o(e,{active:r,context:n.current,currentCoordinates:h});if(f){const m=o2(f,h),g={x:0,y:0},{scrollableAncestors:y}=n.current;for(const v of y){const w=e.code,{isTop:N,isRight:k,isLeft:C,isBottom:I,maxScroll:O,minScroll:L}=Tne(v),_=gCe(v),E={x:Math.min(w===Fn.Right?_.right-_.width/2:_.right,Math.max(w===Fn.Right?_.left:_.left+_.width/2,f.x)),y:Math.min(w===Fn.Down?_.bottom-_.height/2:_.bottom,Math.max(w===Fn.Down?_.top:_.top+_.height/2,f.y))},M=w===Fn.Right&&!k||w===Fn.Left&&!C,B=w===Fn.Down&&!I||w===Fn.Up&&!N;if(M&&E.x!==f.x){const S=v.scrollLeft+m.x,P=w===Fn.Right&&S<=O.x||w===Fn.Left&&S>=L.x;if(P&&!m.y){v.scrollTo({left:S,behavior:l});return}P?g.x=v.scrollLeft-S:g.x=w===Fn.Right?v.scrollLeft-O.x:v.scrollLeft-L.x,g.x&&v.scrollBy({left:-g.x,behavior:l});break}else if(B&&E.y!==f.y){const S=v.scrollTop+m.y,P=w===Fn.Down&&S<=O.y||w===Fn.Up&&S>=L.y;if(P&&!m.x){v.scrollTo({top:S,behavior:l});return}P?g.y=v.scrollTop-S:g.y=w===Fn.Down?v.scrollTop-O.y:v.scrollTop-L.y,g.y&&v.scrollBy({top:-g.y,behavior:l});break}}this.handleMove(e,fy(o2(f,this.referenceCoordinates),g))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}J_.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=Lne,onActivation:s}=e,{active:a}=r;const{code:o}=t.nativeEvent;if(n.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),s?.({event:t.nativeEvent}),!0)}return!1}}];function pz(t){return!!(t&&"distance"in t)}function mz(t){return!!(t&&"delay"in t)}class GO{constructor(e,r,n){var s;n===void 0&&(n=vCe(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:o}=a;this.props=e,this.events=r,this.document=mb(o),this.documentListeners=new E1(this.document),this.listeners=new E1(n),this.windowListeners=new E1(Ol(o)),this.initialCoordinates=(s=M4(a))!=null?s:hd,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ou.Resize,this.handleCancel),this.windowListeners.add(ou.DragStart,fz),this.windowListeners.add(ou.VisibilityChange,this.handleCancel),this.windowListeners.add(ou.ContextMenu,fz),this.documentListeners.add(ou.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(mz(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(pz(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:s}=this.props;s(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(ou.Click,wCe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ou.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:s,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!s)return;const c=(r=M4(e))!=null?r:hd,u=o2(s,c);if(!n&&l){if(pz(l)){if(l.tolerance!=null&&YE(u,l.tolerance))return this.handleCancel();if(YE(u,l.distance))return this.handleStart()}if(mz(l)&&YE(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Fn.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const jCe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Z_ extends GO{constructor(e){const{event:r}=e,n=mb(r.target);super(e,jCe,n)}}Z_.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const kCe={move:{name:"mousemove"},end:{name:"mouseup"}};var n8;(function(t){t[t.RightClick=2]="RightClick"})(n8||(n8={}));class One extends GO{constructor(e){super(e,kCe,mb(e.event.target))}}One.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===n8.RightClick?!1:(n?.({event:r}),!0)}}];const XE={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Mne extends GO{constructor(e){super(e,XE)}static setup(){return window.addEventListener(XE.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(XE.move.name,e)};function e(){}}}Mne.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:s}=r;return s.length>1?!1:(n?.({event:r}),!0)}}];var A1;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(A1||(A1={}));var D4;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(D4||(D4={}));function _Ce(t){let{acceleration:e,activator:r=A1.Pointer,canScroll:n,draggingRect:s,enabled:a,interval:o=5,order:l=D4.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:m}=t;const g=CCe({delta:f,disabled:!a}),[y,v]=z3e(),w=b.useRef({x:0,y:0}),N=b.useRef({x:0,y:0}),k=b.useMemo(()=>{switch(r){case A1.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case A1.DraggableRect:return s}},[r,s,c]),C=b.useRef(null),I=b.useCallback(()=>{const L=C.current;if(!L)return;const _=w.current.x*N.current.x,E=w.current.y*N.current.y;L.scrollBy(_,E)},[]),O=b.useMemo(()=>l===D4.TreeOrder?[...u].reverse():u,[l,u]);b.useEffect(()=>{if(!a||!u.length||!k){v();return}for(const L of O){if(n?.(L)===!1)continue;const _=u.indexOf(L),E=h[_];if(!E)continue;const{direction:M,speed:B}=mCe(L,E,k,e,m);for(const S of["x","y"])g[S][M[S]]||(B[S]=0,M[S]=0);if(B.x>0||B.y>0){v(),C.current=L,y(I,o),w.current=B,N.current=M;return}}w.current={x:0,y:0},N.current={x:0,y:0},v()},[e,I,n,v,a,o,JSON.stringify(k),JSON.stringify(g),y,u,O,h,JSON.stringify(m)])}const SCe={x:{[po.Backward]:!1,[po.Forward]:!1},y:{[po.Backward]:!1,[po.Forward]:!1}};function CCe(t){let{delta:e,disabled:r}=t;const n=O4(e);return dw(s=>{if(r||!n||!s)return SCe;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[po.Backward]:s.x[po.Backward]||a.x===-1,[po.Forward]:s.x[po.Forward]||a.x===1},y:{[po.Backward]:s.y[po.Backward]||a.y===-1,[po.Forward]:s.y[po.Forward]||a.y===1}}},[r,e,n])}function ECe(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return dw(s=>{var a;return e==null?null:(a=n??s)!=null?a:null},[n,e])}function ACe(t,e){return b.useMemo(()=>t.reduce((r,n)=>{const{sensor:s}=n,a=s.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,n)}));return[...r,...a]},[]),[t,e])}var l2;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(l2||(l2={}));var s8;(function(t){t.Optimized="optimized"})(s8||(s8={}));const gz=new Map;function TCe(t,e){let{dragging:r,dependencies:n,config:s}=e;const[a,o]=b.useState(null),{frequency:l,measure:c,strategy:u}=s,h=b.useRef(t),f=w(),m=a2(f),g=b.useCallback(function(N){N===void 0&&(N=[]),!m.current&&o(k=>k===null?N:k.concat(N.filter(C=>!k.includes(C))))},[m]),y=b.useRef(null),v=dw(N=>{if(f&&!r)return gz;if(!N||N===gz||h.current!==t||a!=null){const k=new Map;for(let C of t){if(!C)continue;if(a&&a.length>0&&!a.includes(C.id)&&C.rect.current){k.set(C.id,C.rect.current);continue}const I=C.node.current,O=I?new WO(c(I),I):null;C.rect.current=O,O&&k.set(C.id,O)}return k}return N},[t,a,r,f,c]);return b.useEffect(()=>{h.current=t},[t]),b.useEffect(()=>{f||g()},[r,f]),b.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),b.useEffect(()=>{f||typeof l!="number"||y.current!==null||(y.current=setTimeout(()=>{g(),y.current=null},l))},[l,f,g,...n]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:a!=null};function w(){switch(u){case l2.Always:return!1;case l2.BeforeDragging:return r;default:return!r}}}function KO(t,e){return dw(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function ICe(t,e){return KO(t,e)}function PCe(t){let{callback:e,disabled:r}=t;const n=Y_(e),s=b.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return b.useEffect(()=>()=>s?.disconnect(),[s]),s}function eS(t){let{callback:e,disabled:r}=t;const n=Y_(e),s=b.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return b.useEffect(()=>()=>s?.disconnect(),[s]),s}function LCe(t){return new WO(gb(t),t)}function xz(t,e,r){e===void 0&&(e=LCe);const[n,s]=b.useState(null);function a(){s(c=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=c??r)!=null?u:null}const h=e(t);return JSON.stringify(c)===JSON.stringify(h)?c:h})}const o=PCe({callback(c){if(t)for(const u of c){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(t)){a();break}}}}),l=eS({callback:a});return dd(()=>{a(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),n}function OCe(t){const e=KO(t);return kne(t,e)}const yz=[];function MCe(t){const e=b.useRef(t),r=dw(n=>t?n&&n!==yz&&t&&e.current&&t.parentNode===e.current.parentNode?n:Q_(t):yz,[t]);return b.useEffect(()=>{e.current=t},[t]),r}function RCe(t){const[e,r]=b.useState(null),n=b.useRef(t),s=b.useCallback(a=>{const o=KE(a.target);o&&r(l=>l?(l.set(o,r8(o)),new Map(l)):null)},[]);return b.useEffect(()=>{const a=n.current;if(t!==a){o(a);const l=t.map(c=>{const u=KE(c);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,r8(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(c=>{const u=KE(c);u?.removeEventListener("scroll",s)})}},[s,t]),b.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,o)=>fy(a,o),hd):Ine(t):hd,[t,e])}function bz(t,e){e===void 0&&(e=[]);const r=b.useRef(null);return b.useEffect(()=>{r.current=null},e),b.useEffect(()=>{const n=t!==hd;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?o2(t,r.current):hd}function DCe(t){b.useEffect(()=>{if(!K_)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function BCe(t,e){return b.useMemo(()=>t.reduce((r,n)=>{let{eventName:s,handler:a}=n;return r[s]=o=>{a(o,e)},r},{}),[t,e])}function Rne(t){return b.useMemo(()=>t?dCe(t):null,[t])}const vz=[];function FCe(t,e){e===void 0&&(e=gb);const[r]=t,n=Rne(r?Ol(r):null),[s,a]=b.useState(vz);function o(){a(()=>t.length?t.map(c=>Ane(c)?n:new WO(e(c),c)):vz)}const l=eS({callback:o});return dd(()=>{l?.disconnect(),o(),t.forEach(c=>l?.observe(c))},[t]),s}function Dne(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return uw(e)?e:t}function $Ce(t){let{measure:e}=t;const[r,n]=b.useState(null),s=b.useCallback(u=>{for(const{target:h}of u)if(uw(h)){n(f=>{const m=e(h);return f?{...f,width:m.width,height:m.height}:m});break}},[e]),a=eS({callback:s}),o=b.useCallback(u=>{const h=Dne(u);a?.disconnect(),h&&a?.observe(h),n(h?e(h):null)},[e,a]),[l,c]=L4(o);return b.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const UCe=[{sensor:Z_,options:{}},{sensor:J_,options:{}}],zCe={current:{}},Ej={draggable:{measure:hz},droppable:{measure:hz,strategy:l2.WhileDragging,frequency:s8.Optimized},dragOverlay:{measure:gb}};class T1 extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const VCe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new T1,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:R4},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ej,measureDroppableContainers:R4,windowRect:null,measuringScheduled:!1},Bne={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:R4,draggableNodes:new Map,over:null,measureDroppableContainers:R4},fw=b.createContext(Bne),Fne=b.createContext(VCe);function qCe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new T1}}}function HCe(t,e){switch(e.type){case Wa.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Wa.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Wa.DragEnd:case Wa.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Wa.RegisterDroppable:{const{element:r}=e,{id:n}=r,s=new T1(t.droppable.containers);return s.set(n,r),{...t,droppable:{...t.droppable,containers:s}}}case Wa.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const o=new T1(t.droppable.containers);return o.set(r,{...a,disabled:s}),{...t,droppable:{...t.droppable,containers:o}}}case Wa.UnregisterDroppable:{const{id:r,key:n}=e,s=t.droppable.containers.get(r);if(!s||n!==s.key)return t;const a=new T1(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function WCe(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:s}=b.useContext(fw),a=O4(n),o=O4(r?.id);return b.useEffect(()=>{if(!e&&!n&&a&&o!=null){if(!X_(a)||document.activeElement===a.target)return;const l=s.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[c.current,u.current]){if(!h)continue;const f=H3e(h);if(f){f.focus();break}}})}},[n,e,s,o,a]),null}function $ne(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((s,a)=>a({transform:s,...n}),r):r}function GCe(t){return b.useMemo(()=>({draggable:{...Ej.draggable,...t?.draggable},droppable:{...Ej.droppable,...t?.droppable},dragOverlay:{...Ej.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function KCe(t){let{activeNode:e,measure:r,initialRect:n,config:s=!0}=t;const a=b.useRef(!1),{x:o,y:l}=typeof s=="boolean"?{x:s,y:s}:s;dd(()=>{if(!o&&!l||!e){a.current=!1;return}if(a.current||!n)return;const u=e?.node.current;if(!u||u.isConnected===!1)return;const h=r(u),f=kne(h,n);if(o||(f.x=0),l||(f.y=0),a.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=Sne(u);m&&m.scrollBy({top:f.y,left:f.x})}},[e,o,l,n,r])}const tS=b.createContext({...hd,scaleX:1,scaleY:1});var O0;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(O0||(O0={}));const YO=b.memo(function(e){var r,n,s,a;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:h=UCe,collisionDetection:f=iCe,measuring:m,modifiers:g,...y}=e;const v=b.useReducer(HCe,void 0,qCe),[w,N]=v,[k,C]=Q3e(),[I,O]=b.useState(O0.Uninitialized),L=I===O0.Initialized,{draggable:{active:_,nodes:E,translate:M},droppable:{containers:B}}=w,S=_!=null?E.get(_):null,P=b.useRef({initial:null,translated:null}),R=b.useMemo(()=>{var gt;return _!=null?{id:_,data:(gt=S?.data)!=null?gt:zCe,rect:P}:null},[_,S]),V=b.useRef(null),[ee,G]=b.useState(null),[J,Z]=b.useState(null),se=a2(y,Object.values(y)),X=hw("DndDescribedBy",o),q=b.useMemo(()=>B.getEnabled(),[B]),U=GCe(m),{droppableRects:H,measureDroppableContainers:re,measuringScheduled:ae}=TCe(q,{dragging:L,dependencies:[M.x,M.y],config:U.droppable}),xe=ECe(E,_),Ne=b.useMemo(()=>J?M4(J):null,[J]),pe=Ft(),K=ICe(xe,U.draggable.measure);KCe({activeNode:_!=null?E.get(_):null,config:pe.layoutShiftCompensation,initialRect:K,measure:U.draggable.measure});const ue=xz(xe,U.draggable.measure,K),fe=xz(xe?xe.parentElement:null),he=b.useRef({activatorEvent:null,active:null,activeNode:xe,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:B,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),le=B.getNodeFor((r=he.current.over)==null?void 0:r.id),_e=$Ce({measure:U.dragOverlay.measure}),oe=(n=_e.nodeRef.current)!=null?n:xe,Oe=L?(s=_e.rect)!=null?s:ue:null,ze=!!(_e.nodeRef.current&&_e.rect),Ye=OCe(ze?null:ue),je=Rne(oe?Ol(oe):null),Fe=MCe(L?le??xe:null),Nt=FCe(Fe),$t=$ne(g,{transform:{x:M.x-Ye.x,y:M.y-Ye.y,scaleX:1,scaleY:1},activatorEvent:J,active:R,activeNodeRect:ue,containerNodeRect:fe,draggingNodeRect:Oe,over:he.current.over,overlayNodeRect:_e.rect,scrollableAncestors:Fe,scrollableAncestorRects:Nt,windowRect:je}),Ut=Ne?fy(Ne,M):null,nt=RCe(Fe),bt=bz(nt),It=bz(nt,[ue]),_t=fy($t,bt),wt=Oe?lCe(Oe,$t):null,ut=R&&wt?f({active:R,collisionRect:wt,droppableRects:H,droppableContainers:q,pointerCoordinates:Ut}):null,Rt=Nne(ut,"id"),[Dt,at]=b.useState(null),ft=ze?$t:fy($t,It),Bt=aCe(ft,(a=Dt?.rect)!=null?a:null,ue),De=b.useRef(null),lt=b.useCallback((gt,Ot)=>{let{sensor:Ct,options:Xt}=Ot;if(V.current==null)return;const Qt=E.get(V.current);if(!Qt)return;const nr=gt.nativeEvent,sr=new Ct({active:V.current,activeNode:Qt,event:nr,options:Xt,context:he,onAbort(kr){if(!E.get(kr))return;const{onDragAbort:Ke}=se.current,Gt={id:kr};Ke?.(Gt),k({type:"onDragAbort",event:Gt})},onPending(kr,Ae,Ke,Gt){if(!E.get(kr))return;const{onDragPending:zt}=se.current,Mt={id:kr,constraint:Ae,initialCoordinates:Ke,offset:Gt};zt?.(Mt),k({type:"onDragPending",event:Mt})},onStart(kr){const Ae=V.current;if(Ae==null)return;const Ke=E.get(Ae);if(!Ke)return;const{onDragStart:Gt}=se.current,jt={activatorEvent:nr,active:{id:Ae,data:Ke.data,rect:P}};Kn.unstable_batchedUpdates(()=>{Gt?.(jt),O(O0.Initializing),N({type:Wa.DragStart,initialCoordinates:kr,active:Ae}),k({type:"onDragStart",event:jt}),G(De.current),Z(nr)})},onMove(kr){N({type:Wa.DragMove,coordinates:kr})},onEnd:Jt(Wa.DragEnd),onCancel:Jt(Wa.DragCancel)});De.current=sr;function Jt(kr){return async function(){const{active:Ke,collisions:Gt,over:jt,scrollAdjustedTranslate:zt}=he.current;let Mt=null;if(Ke&&zt){const{cancelDrop:Ht}=se.current;Mt={activatorEvent:nr,active:Ke,collisions:Gt,delta:zt,over:jt},kr===Wa.DragEnd&&typeof Ht=="function"&&await Promise.resolve(Ht(Mt))&&(kr=Wa.DragCancel)}V.current=null,Kn.unstable_batchedUpdates(()=>{N({type:kr}),O(O0.Uninitialized),at(null),G(null),Z(null),De.current=null;const Ht=kr===Wa.DragEnd?"onDragEnd":"onDragCancel";if(Mt){const vr=se.current[Ht];vr?.(Mt),k({type:Ht,event:Mt})}})}}},[E]),ht=b.useCallback((gt,Ot)=>(Ct,Xt)=>{const Qt=Ct.nativeEvent,nr=E.get(Xt);if(V.current!==null||!nr||Qt.dndKit||Qt.defaultPrevented)return;const sr={active:nr};gt(Ct,Ot.options,sr)===!0&&(Qt.dndKit={capturedBy:Ot.sensor},V.current=Xt,lt(Ct,Ot))},[E,lt]),Pt=ACe(h,ht);DCe(h),dd(()=>{ue&&I===O0.Initializing&&O(O0.Initialized)},[ue,I]),b.useEffect(()=>{const{onDragMove:gt}=se.current,{active:Ot,activatorEvent:Ct,collisions:Xt,over:Qt}=he.current;if(!Ot||!Ct)return;const nr={active:Ot,activatorEvent:Ct,collisions:Xt,delta:{x:_t.x,y:_t.y},over:Qt};Kn.unstable_batchedUpdates(()=>{gt?.(nr),k({type:"onDragMove",event:nr})})},[_t.x,_t.y]),b.useEffect(()=>{const{active:gt,activatorEvent:Ot,collisions:Ct,droppableContainers:Xt,scrollAdjustedTranslate:Qt}=he.current;if(!gt||V.current==null||!Ot||!Qt)return;const{onDragOver:nr}=se.current,sr=Xt.get(Rt),Jt=sr&&sr.rect.current?{id:sr.id,rect:sr.rect.current,data:sr.data,disabled:sr.disabled}:null,kr={active:gt,activatorEvent:Ot,collisions:Ct,delta:{x:Qt.x,y:Qt.y},over:Jt};Kn.unstable_batchedUpdates(()=>{at(Jt),nr?.(kr),k({type:"onDragOver",event:kr})})},[Rt]),dd(()=>{he.current={activatorEvent:J,active:R,activeNode:xe,collisionRect:wt,collisions:ut,droppableRects:H,draggableNodes:E,draggingNode:oe,draggingNodeRect:Oe,droppableContainers:B,over:Dt,scrollableAncestors:Fe,scrollAdjustedTranslate:_t},P.current={initial:Oe,translated:wt}},[R,xe,ut,wt,E,oe,Oe,H,B,Dt,Fe,_t]),_Ce({...pe,delta:M,draggingRect:wt,pointerCoordinates:Ut,scrollableAncestors:Fe,scrollableAncestorRects:Nt});const At=b.useMemo(()=>({active:R,activeNode:xe,activeNodeRect:ue,activatorEvent:J,collisions:ut,containerNodeRect:fe,dragOverlay:_e,draggableNodes:E,droppableContainers:B,droppableRects:H,over:Dt,measureDroppableContainers:re,scrollableAncestors:Fe,scrollableAncestorRects:Nt,measuringConfiguration:U,measuringScheduled:ae,windowRect:je}),[R,xe,ue,J,ut,fe,_e,E,B,H,Dt,re,Fe,Nt,U,ae,je]),mt=b.useMemo(()=>({activatorEvent:J,activators:Pt,active:R,activeNodeRect:ue,ariaDescribedById:{draggable:X},dispatch:N,draggableNodes:E,over:Dt,measureDroppableContainers:re}),[J,Pt,R,ue,N,X,E,Dt,re]);return Ie.createElement(bne.Provider,{value:C},Ie.createElement(fw.Provider,{value:mt},Ie.createElement(Fne.Provider,{value:At},Ie.createElement(tS.Provider,{value:Bt},u)),Ie.createElement(WCe,{disabled:l?.restoreFocus===!1})),Ie.createElement(eCe,{...l,hiddenTextDescribedById:X}));function Ft(){const gt=ee?.autoScrollEnabled===!1,Ot=typeof c=="object"?c.enabled===!1:c===!1,Ct=L&&!gt&&!Ot;return typeof c=="object"?{...c,enabled:Ct}:{enabled:Ct}}}),YCe=b.createContext(null),wz="button",XCe="Draggable";function Une(t){let{id:e,data:r,disabled:n=!1,attributes:s}=t;const a=hw(XCe),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:m}=b.useContext(fw),{role:g=wz,roleDescription:y="draggable",tabIndex:v=0}=s??{},w=c?.id===e,N=b.useContext(w?tS:YCe),[k,C]=L4(),[I,O]=L4(),L=BCe(o,e),_=a2(r);dd(()=>(f.set(e,{id:e,key:a,node:k,activatorNode:I,data:_}),()=>{const M=f.get(e);M&&M.key===a&&f.delete(e)}),[f,e]);const E=b.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":n,"aria-pressed":w&&g===wz?!0:void 0,"aria-roledescription":y,"aria-describedby":h.draggable}),[n,g,v,w,y,h.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:E,isDragging:w,listeners:n?void 0:L,node:k,over:m,setNodeRef:C,setActivatorNodeRef:O,transform:N}}function zne(){return b.useContext(Fne)}const QCe="Droppable",JCe={timeout:25};function Vne(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:s}=t;const a=hw(QCe),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=b.useContext(fw),h=b.useRef({disabled:r}),f=b.useRef(!1),m=b.useRef(null),g=b.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:w}={...JCe,...s},N=a2(v??n),k=b.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(N.current)?N.current:[N.current]),g.current=null},w)},[w]),C=eS({callback:k,disabled:y||!o}),I=b.useCallback((E,M)=>{C&&(M&&(C.unobserve(M),f.current=!1),E&&C.observe(E))},[C]),[O,L]=L4(I),_=a2(e);return b.useEffect(()=>{!C||!O.current||(C.disconnect(),f.current=!1,C.observe(O.current))},[O,C]),b.useEffect(()=>(l({type:Wa.RegisterDroppable,element:{id:n,key:a,disabled:r,node:O,rect:m,data:_}}),()=>l({type:Wa.UnregisterDroppable,key:a,id:n})),[n]),b.useEffect(()=>{r!==h.current.disabled&&(l({type:Wa.SetDroppableDisabled,id:n,key:a,disabled:r}),h.current.disabled=r)},[n,a,r,l]),{active:o,rect:m,isOver:c?.id===n,node:O,over:c,setNodeRef:L}}function ZCe(t){let{animation:e,children:r}=t;const[n,s]=b.useState(null),[a,o]=b.useState(null),l=O4(r);return!r&&!n&&l&&s(l),dd(()=>{if(!a)return;const c=n?.key,u=n?.props.id;if(c==null||u==null){s(null);return}Promise.resolve(e(u,a)).then(()=>{s(null)})},[e,n,a]),Ie.createElement(Ie.Fragment,null,r,n?b.cloneElement(n,{ref:o}):null)}const eEe={x:0,y:0,scaleX:1,scaleY:1};function tEe(t){let{children:e}=t;return Ie.createElement(fw.Provider,{value:Bne},Ie.createElement(tS.Provider,{value:eEe},e))}const rEe={position:"fixed",touchAction:"none"},nEe=t=>X_(t)?"transform 250ms ease":void 0,sEe=b.forwardRef((t,e)=>{let{as:r,activatorEvent:n,adjustScale:s,children:a,className:o,rect:l,style:c,transform:u,transition:h=nEe}=t;if(!l)return null;const f=s?u:{...u,scaleX:1,scaleY:1},m={...rEe,width:l.width,height:l.height,top:l.top,left:l.left,transform:jf.Transform.toString(f),transformOrigin:s&&n?tCe(n,l):void 0,transition:typeof h=="function"?h(n):h,...c};return Ie.createElement(r,{className:o,style:m,ref:e},a)}),qne=t=>e=>{let{active:r,dragOverlay:n}=e;const s={},{styles:a,className:o}=t;if(a!=null&&a.active)for(const[l,c]of Object.entries(a.active))c!==void 0&&(s[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(a!=null&&a.dragOverlay)for(const[l,c]of Object.entries(a.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return o!=null&&o.active&&r.node.classList.add(o.active),o!=null&&o.dragOverlay&&n.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(s))r.node.style.setProperty(c,u);o!=null&&o.active&&r.node.classList.remove(o.active)}},iEe=t=>{let{transform:{initial:e,final:r}}=t;return[{transform:jf.Transform.toString(e)},{transform:jf.Transform.toString(r)}]},aEe={duration:250,easing:"ease",keyframes:iEe,sideEffects:qne({styles:{active:{opacity:"0"}}})};function oEe(t){let{config:e,draggableNodes:r,droppableContainers:n,measuringConfiguration:s}=t;return Y_((a,o)=>{if(e===null)return;const l=r.get(a);if(!l)return;const c=l.node.current;if(!c)return;const u=Dne(o);if(!u)return;const{transform:h}=Ol(o).getComputedStyle(o),f=_ne(h);if(!f)return;const m=typeof e=="function"?e:lEe(e);return Pne(c,s.draggable.measure),m({active:{id:a,data:l.data,node:c,rect:s.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:o,rect:s.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:s,transform:f})})}function lEe(t){const{duration:e,easing:r,sideEffects:n,keyframes:s}={...aEe,...t};return a=>{let{active:o,dragOverlay:l,transform:c,...u}=a;if(!e)return;const h={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},f={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},m={x:c.x-h.x,y:c.y-h.y,...f},g=s({...u,active:o,dragOverlay:l,transform:{initial:c,final:m}}),[y]=g,v=g[g.length-1];if(JSON.stringify(y)===JSON.stringify(v))return;const w=n?.({active:o,dragOverlay:l,...u}),N=l.node.animate(g,{duration:e,easing:r,fill:"forwards"});return new Promise(k=>{N.onfinish=()=>{w?.(),k()}})}}let Nz=0;function cEe(t){return b.useMemo(()=>{if(t!=null)return Nz++,Nz},[t])}const XO=Ie.memo(t=>{let{adjustScale:e=!1,children:r,dropAnimation:n,style:s,transition:a,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=t;const{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:g,draggableNodes:y,droppableContainers:v,dragOverlay:w,over:N,measuringConfiguration:k,scrollableAncestors:C,scrollableAncestorRects:I,windowRect:O}=zne(),L=b.useContext(tS),_=cEe(f?.id),E=$ne(o,{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:g,draggingNodeRect:w.rect,over:N,overlayNodeRect:w.rect,scrollableAncestors:C,scrollableAncestorRects:I,transform:L,windowRect:O}),M=KO(m),B=oEe({config:n,draggableNodes:y,droppableContainers:v,measuringConfiguration:k}),S=M?w.setRef:void 0;return Ie.createElement(tEe,null,Ie.createElement(ZCe,{animation:B},f&&_?Ie.createElement(sEe,{key:_,id:f.id,ref:S,as:l,activatorEvent:h,adjustScale:e,className:c,transition:a,rect:M,style:{zIndex:u,...s},transform:E},r):null))});function rS(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function uEe(t,e){return t.reduce((r,n,s)=>{const a=e.get(n);return a&&(r[s]=a),r},Array(t.length))}function aN(t){return t!==null&&t>=0}function dEe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function hEe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const nS=t=>{let{rects:e,activeIndex:r,overIndex:n,index:s}=t;const a=rS(e,n,r),o=e[s],l=a[s];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Hne="Sortable",Wne=Ie.createContext({activeIndex:-1,containerId:Hne,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:nS,disabled:{draggable:!1,droppable:!1}});function Gne(t){let{children:e,id:r,items:n,strategy:s=nS,disabled:a=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:h}=zne(),f=hw(Hne,r),m=l.rect!==null,g=b.useMemo(()=>n.map(L=>typeof L=="object"&&"id"in L?L.id:L),[n]),y=o!=null,v=o?g.indexOf(o.id):-1,w=u?g.indexOf(u.id):-1,N=b.useRef(g),k=!dEe(g,N.current),C=w!==-1&&v===-1||k,I=hEe(a);dd(()=>{k&&y&&h(g)},[k,g,y,h]),b.useEffect(()=>{N.current=g},[g]);const O=b.useMemo(()=>({activeIndex:v,containerId:f,disabled:I,disableTransforms:C,items:g,overIndex:w,useDragOverlay:m,sortedRects:uEe(g,c),strategy:s}),[v,f,I.draggable,I.droppable,C,g,w,c,m,s]);return Ie.createElement(Wne.Provider,{value:O},e)}const fEe=t=>{let{id:e,items:r,activeIndex:n,overIndex:s}=t;return rS(r,n,s).indexOf(e)},pEe=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:s,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=t;return!u||!n||l!==a&&s===o?!1:r?!0:o!==s&&e===c},mEe={duration:200,easing:"ease"},Kne="transform",gEe=jf.Transition.toString({property:Kne,duration:0,easing:"linear"}),xEe={roleDescription:"sortable"};function yEe(t){let{disabled:e,index:r,node:n,rect:s}=t;const[a,o]=b.useState(null),l=b.useRef(r);return dd(()=>{if(!e&&r!==l.current&&n.current){const c=s.current;if(c){const u=gb(n.current,{ignoreTransform:!0}),h={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(h.x||h.y)&&o(h)}}r!==l.current&&(l.current=r)},[e,r,n,s]),b.useEffect(()=>{a&&o(null)},[a]),a}function Yne(t){let{animateLayoutChanges:e=pEe,attributes:r,disabled:n,data:s,getNewIndex:a=fEe,id:o,strategy:l,resizeObserverConfig:c,transition:u=mEe}=t;const{items:h,containerId:f,activeIndex:m,disabled:g,disableTransforms:y,sortedRects:v,overIndex:w,useDragOverlay:N,strategy:k}=b.useContext(Wne),C=bEe(n,g),I=h.indexOf(o),O=b.useMemo(()=>({sortable:{containerId:f,index:I,items:h},...s}),[f,s,I,h]),L=b.useMemo(()=>h.slice(h.indexOf(o)),[h,o]),{rect:_,node:E,isOver:M,setNodeRef:B}=Vne({id:o,data:O,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:L,...c}}),{active:S,activatorEvent:P,activeNodeRect:R,attributes:V,setNodeRef:ee,listeners:G,isDragging:J,over:Z,setActivatorNodeRef:se,transform:X}=Une({id:o,data:O,attributes:{...xEe,...r},disabled:C.draggable}),q=U3e(B,ee),U=!!S,H=U&&!y&&aN(m)&&aN(w),re=!N&&J,ae=re&&H?X:null,Ne=H?ae??(l??k)({rects:v,activeNodeRect:R,activeIndex:m,overIndex:w,index:I}):null,pe=aN(m)&&aN(w)?a({id:o,items:h,activeIndex:m,overIndex:w}):I,K=S?.id,ue=b.useRef({activeId:K,items:h,newIndex:pe,containerId:f}),fe=h!==ue.current.items,he=e({active:S,containerId:f,isDragging:J,isSorting:U,id:o,index:I,items:h,newIndex:ue.current.newIndex,previousItems:ue.current.items,previousContainerId:ue.current.containerId,transition:u,wasDragging:ue.current.activeId!=null}),le=yEe({disabled:!he,index:I,node:E,rect:_});return b.useEffect(()=>{U&&ue.current.newIndex!==pe&&(ue.current.newIndex=pe),f!==ue.current.containerId&&(ue.current.containerId=f),h!==ue.current.items&&(ue.current.items=h)},[U,pe,f,h]),b.useEffect(()=>{if(K===ue.current.activeId)return;if(K!=null&&ue.current.activeId==null){ue.current.activeId=K;return}const oe=setTimeout(()=>{ue.current.activeId=K},50);return()=>clearTimeout(oe)},[K]),{active:S,activeIndex:m,attributes:V,data:O,rect:_,index:I,newIndex:pe,items:h,isOver:M,isSorting:U,isDragging:J,listeners:G,node:E,overIndex:w,over:Z,setNodeRef:q,setActivatorNodeRef:se,setDroppableNodeRef:B,setDraggableNodeRef:ee,transform:le??Ne,transition:_e()};function _e(){if(le||fe&&ue.current.newIndex===I)return gEe;if(!(re&&!X_(P)||!u)&&(U||he))return jf.Transition.toString({...u,property:Kne})}}function bEe(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}function B4(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const vEe=[Fn.Down,Fn.Right,Fn.Up,Fn.Left],Xne=(t,e)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:a,over:o,scrollableAncestors:l}}=e;if(vEe.includes(t.code)){if(t.preventDefault(),!r||!n)return;const c=[];a.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const m=s.get(f.id);if(m)switch(t.code){case Fn.Down:n.top<m.top&&c.push(f);break;case Fn.Up:n.top>m.top&&c.push(f);break;case Fn.Left:n.left>m.left&&c.push(f);break;case Fn.Right:n.left<m.left&&c.push(f);break}});const u=jne({collisionRect:n,droppableRects:s,droppableContainers:c});let h=Nne(u,"id");if(h===o?.id&&u.length>1&&(h=u[1].id),h!=null){const f=a.get(r.id),m=a.get(h),g=m?s.get(m.id):null,y=m?.node.current;if(y&&g&&f&&m){const w=Q_(y).some((L,_)=>l[_]!==L),N=Qne(f,m),k=wEe(f,m),C=w||!N?{x:0,y:0}:{x:k?n.width-g.width:0,y:k?n.height-g.height:0},I={x:g.left,y:g.top};return C.x&&C.y?I:o2(I,C)}}}};function Qne(t,e){return!B4(t)||!B4(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function wEe(t,e){return!B4(t)||!B4(e)||!Qne(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}const NEe=[{badge:"White",colors:["W"],flavor:"Order, protection, and the light of law."},{badge:"Blue",colors:["U"],flavor:"Knowledge, manipulation, and the perfection of mind."},{badge:"Black",colors:["B"],flavor:"Power, ambition, and death at any cost."},{badge:"Red",colors:["R"],flavor:"Freedom, emotion, and the fire of impulse."},{badge:"Green",colors:["G"],flavor:"Nature, instinct, and the strength of the wild."},{badge:"Colorless",colors:["C"],flavor:"The void between, pure and unyielding."},{badge:"Azorius",colors:["W","U"],flavor:"The law is the shield of the just."},{badge:"Dimir",colors:["U","B"],flavor:"Knowledge is power, and we know everything."},{badge:"Rakdos",colors:["B","R"],flavor:"Entertainment is a serious business."},{badge:"Gruul",colors:["R","G"],flavor:"Not Gruul? Then die!"},{badge:"Selesnya",colors:["G","W"],flavor:"Together, we are the world's soul."},{badge:"Orzhov",colors:["W","B"],flavor:"Wealth is power, and spirit is currency."},{badge:"Izzet",colors:["U","R"],flavor:"Genius and madness are two sides of the same coin."},{badge:"Golgari",colors:["B","G"],flavor:"Life and death are a continuous circle."},{badge:"Boros",colors:["R","W"],flavor:"Strike fast, strike hard, strike true."},{badge:"Simic",colors:["G","U"],flavor:"Nature, perfected by design."},{badge:"Esper",colors:["W","U","B"],flavor:"Perfection through etherium and discipline."},{badge:"Grixis",colors:["U","B","R"],flavor:"Life is short, death is forever."},{badge:"Jund",colors:["B","R","G"],flavor:"Only the strongest survive the feeding frenzy."},{badge:"Naya",colors:["R","G","W"],flavor:"Where giant beasts roam and the wild reigns."},{badge:"Bant",colors:["G","W","U"],flavor:"Honor, valor, and the righteousness of caste."},{badge:"Abzan",colors:["W","B","G"],flavor:"Family is the only fortress that matters."},{badge:"Jeskai",colors:["U","R","W"],flavor:"Cunning strategies and swift strikes."},{badge:"Sultai",colors:["B","G","U"],flavor:"Ruthlessness is a virtue in the opulent dark."},{badge:"Mardu",colors:["R","W","B"],flavor:"Speed of the horse, edge of the blade."},{badge:"Temur",colors:["G","U","R"],flavor:"Savagery concealed by ice and snow."},{badge:"Glint-Eye",colors:["U","B","R","G"],flavor:"Chaos without order."},{badge:"Dune-Brood",colors:["W","B","R","G"],flavor:"Growth through conflict."},{badge:"Ink-Treader",colors:["W","U","R","G"],flavor:"Motion without purpose."},{badge:"Witch-Maw",colors:["W","U","B","G"],flavor:"Life without death."},{badge:"Yore-Tiller",colors:["W","U","B","R"],flavor:"Artifice without nature."},{badge:"WUBRG",colors:["W","U","B","R","G"],flavor:"All five colors in perfect harmony."}],jEe=(t,e)=>{if(!e||e.length===0)return{bg:"bg-gray-500",color:"text-gray-400"};if(e.length===1)switch(e[0]){case"W":return{bg:"bg-yellow-400",color:"text-yellow-200"};case"U":return{bg:"bg-blue-500",color:"text-blue-400"};case"B":return{bg:"bg-gray-800",color:"text-gray-400"};case"R":return{bg:"bg-red-500",color:"text-red-400"};case"G":return{bg:"bg-green-500",color:"text-green-400"};case"C":return{bg:"bg-gray-400",color:"text-gray-300"}}return e.length===2?{bg:"bg-amber-600",color:"text-amber-400"}:{bg:"bg-indigo-500",color:"text-indigo-400"}},F4=t=>{const e=t||[],r=e.length,s=NEe.find(o=>o.badge==="Colorless"&&(r===0||r===1&&e[0]==="C")?!0:o.colors.length!==r?!1:o.colors.every(l=>e.includes(l)))||{badge:"Commander",colors:e,flavor:"A unique combination of powers."},a=jEe(s.badge,s.colors);return{...s,pips:s.colors,bg:a.bg,color:a.color}},QO=({title:t,value:e,icon:r,color:n,to:s,children:a,size:o})=>{const l=o==="xs",c=i.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-2xl ${l?"px-4 py-2":"p-4 md:p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative h-full flex flex-col justify-center`,children:[a,i.jsxs("div",{className:`relative z-20 ${l?"flex items-center justify-between w-full":""}`,children:[!l&&i.jsx("div",{className:"flex justify-between items-start mb-2 md:mb-4",children:i.jsx("div",{className:`p-2 rounded-xl bg-gray-950 text-${n}-400 group-hover:scale-110 transition-transform shadow-inner`,children:i.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})})}),i.jsxs("div",{className:l?"flex items-center gap-2":"flex flex-col",children:[l&&i.jsx("div",{className:`text-[9px] font-black px-2 py-0.5 rounded-full bg-${n}-500/10 text-${n}-400/80 uppercase tracking-tighter whitespace-nowrap border border-${n}-500/20`,children:t}),i.jsx("div",{className:`${l?"text-base":"text-3xl"} font-black text-white tracking-tight`,children:e})]}),l&&!a&&i.jsx("div",{className:`text-${n}-400 opacity-50`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})}),!l&&i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:t})]})]});return s&&!a?i.jsx(Hr,{to:s,className:"block h-full transition-transform active:scale-[0.98]",children:c}):c},kEe=({data:t,size:e})=>{const{stats:r,collection:n}=t;if(!r)return null;const s=e==="medium",a=e==="large"||e==="xlarge";return i.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:i.jsxs(QO,{to:a?null:"/collection",title:"Total Cards",value:r.totalCards,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue",size:e,children:[s&&i.jsxs("div",{className:"absolute top-4 right-4 text-right",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Distinct"}),i.jsx("div",{className:"text-xl font-bold text-indigo-400",children:n?.length||0})]}),e==="large"&&n&&i.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Recently Added"}),i.jsx("div",{className:"space-y-1.5",children:n.filter(o=>!o.is_wishlist).slice(-5).reverse().map((o,l)=>i.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[i.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),o.image_uris?.art_crop&&i.jsx("img",{src:o.image_uris.art_crop,alt:o.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},l))})]}),e==="xlarge"&&i.jsxs("div",{className:"absolute inset-y-0 right-0 w-[70%] flex items-center justify-around border-l border-white/5 bg-gray-950/20 px-8",children:[i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-xl font-black text-indigo-400",children:n?.length||0}),i.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Distinct"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-xl font-black text-yellow-400",children:n?.filter(o=>o.val_foil).length||0}),i.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Foils"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-xl font-black text-green-400",children:n?.filter(o=>o.val_signed).length||0}),i.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Signed"})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{className:"text-xl font-black text-gray-400",children:n?.filter(o=>o.val_alt_art).length||0}),i.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Alt Art"})]})]})]})})},_Ee=({data:t,size:e})=>{const{stats:r}=t;return r?i.jsx(QO,{to:"/decks",title:"Unique Decks",value:r.uniqueDecks,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"purple",size:e}):null},SEe=({card:t})=>{const[e,r]=b.useState(!1),n=t.card_faces?.length>1,s=b.useMemo(()=>n?e&&t.card_faces[1].image_uris?t.card_faces[1].image_uris.normal||t.card_faces[1].image_uris.art_crop:t.card_faces[0].image_uris?.normal||t.card_faces[0].image_uris?.art_crop||t.image_uris?.normal:t.image_uris?.normal||t.image_uris?.art_crop,[t,e,n]),a=(()=>{const l=(t.finish==="foil"||t.is_foil||t.val_foil)&&t.prices?.usd_foil||t.prices?.usd;return l?parseFloat(l).toFixed(2):"0.00"})();return i.jsxs("div",{className:"group/card flex flex-col cursor-pointer",onClick:()=>n&&r(!e),children:[i.jsxs("div",{className:"aspect-[2.5/3.5] rounded-lg overflow-hidden border border-white/10 mb-2 relative bg-gray-900 shadow-lg group-hover/card:shadow-indigo-500/20 transition-all",children:[s?i.jsx("img",{src:s,alt:t.name,className:"w-full h-full object-cover group-hover/card:scale-110 transition-transform duration-500"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600 bg-gray-800",children:i.jsx("span",{className:"text-[10px]",children:"No Image"})}),n&&i.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50 backdrop-blur-sm border border-white/10 text-white/70",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),i.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-gray-950/90 py-1 px-2 text-center border-t border-white/10 backdrop-blur-sm",children:i.jsxs("span",{className:"text-xs font-mono font-bold text-green-400 block",children:["$",a]})})]}),i.jsx("div",{className:"text-[10px] font-bold text-gray-400 line-clamp-1 text-center group-hover/card:text-white transition-colors",children:t.name})]})},CEe=({data:t,actions:e,size:r})=>{const{stats:n,syncLoading:s,collection:a}=t,{handleSyncPrices:o}=e;if(!n)return null;const l=r==="xs",c=r==="medium",u=f=>{const g=(f.finish==="foil"||f.is_foil||f.val_foil)&&f.prices?.usd_foil||f.prices?.usd;return parseFloat(g||0)},h=a?[...a].sort((f,m)=>u(m)-u(f))[0]:null;return i.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:i.jsxs(QO,{title:"Collection Value",value:n.value,icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"green",size:r,children:[!l&&i.jsx("button",{onClick:f=>{f.preventDefault(),o()},disabled:s,className:`absolute bottom-4 right-4 p-2 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all ${s?"animate-spin":""} z-20`,title:"Update Prices from Scryfall",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c&&h&&i.jsxs("div",{className:"absolute top-4 right-4 text-right max-w-[100px]",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1 truncate",children:"Top Value"}),i.jsx("div",{className:"text-xs font-bold text-green-400 truncate",children:h.name})]}),r==="large"&&a&&i.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5 z-10",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Top Value Cards"}),i.jsx("div",{className:"space-y-1.5",children:a.filter(f=>!f.is_wishlist&&u(f)>0).sort((f,m)=>u(m)-u(f)).slice(0,5).map((f,m)=>i.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-300 group-hover/card:text-white truncate flex-grow min-w-0",children:f.name}),i.jsxs("span",{className:"text-[10px] text-green-400 font-mono",children:["$",u(f).toFixed(2)]})]}),f.image_uris?.art_crop&&i.jsx("img",{src:f.image_uris.art_crop,alt:f.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},m))})]}),r==="xlarge"&&a&&i.jsxs("div",{className:"absolute inset-y-0 right-0 w-[75%] border-l border-white/5 bg-gray-950/20 px-6 py-4 flex flex-col",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4 flex-shrink-0",children:"Highest Collection Assets"}),i.jsx("div",{className:"grid grid-cols-4 gap-4 overflow-y-auto pr-2 custom-scrollbar",children:a.filter(f=>!f.is_wishlist&&u(f)>0).sort((f,m)=>u(m)-u(f)).slice(0,12).map((f,m)=>i.jsx(SEe,{card:f},m))})]})]})})},EEe=({deck:t,navigate:e})=>{const[r,n]=b.useState(!1),[s,a]=b.useState(!1),o=(h,f)=>h?f&&h.card_faces?.length>1&&h.card_faces[1].image_uris?.art_crop?h.card_faces[1].image_uris.art_crop:h.image_uris?.art_crop?h.image_uris.art_crop:h.card_faces?.[0]?.image_uris?.art_crop?h.card_faces[0].image_uris.art_crop:null:null,l=h=>h?.card_faces?.length>1,c=o(t.commander,r),u=o(t.commander_partner,s);return i.jsxs("div",{onClick:()=>e(`/decks/${t.id}`),className:"group relative rounded-xl overflow-hidden cursor-pointer shadow-lg hover:shadow-indigo-500/30 transition-all hover:-translate-y-1 border border-white/5 bg-gray-900 h-full min-h-[140px]",children:[i.jsx("div",{className:"absolute inset-0 bg-gray-950",children:t.commander_partner?i.jsxs("div",{className:"w-full h-full flex",children:[i.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50 group/main",children:[i.jsx("img",{src:c||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander)&&i.jsx("button",{onClick:h=>{h.stopPropagation(),n(!r)},className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),i.jsxs("div",{className:"w-1/2 h-full relative group/partner",children:[i.jsx("img",{src:u||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander_partner)&&i.jsx("button",{onClick:h=>{h.stopPropagation(),a(!s)},className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}):i.jsxs("div",{className:"w-full h-full relative",children:[i.jsx("img",{src:c||"https://placehold.co/400x600?text=?",alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),l(t.commander)&&i.jsx("button",{onClick:h=>{h.stopPropagation(),n(!r)},className:"absolute top-2 right-2 p-1.5 bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-black/80 transition-colors z-20",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/20 to-transparent opacity-90 pointer-events-none"}),i.jsxs("div",{className:"absolute inset-0 p-3 flex flex-col justify-end pointer-events-none",children:[i.jsx("h3",{className:"text-sm font-bold text-white leading-tight mb-0.5 group-hover:text-indigo-400 transition-colors line-clamp-1",children:t.name}),i.jsx("div",{className:"flex gap-0.5",children:(()=>{const h=t?.commander?.color_identity||[],f=t?.commander_partner?.color_identity||[],m=[...new Set([...h,...f])];return m.length===0&&m.push("C"),m.map(g=>{const y=g.replace(/[{}]/g,"").replace("/","");return i.jsx("img",{src:`/assets/mana/${y}.svg`,alt:y,className:"w-4 h-4 shadow-sm"},g)})})()})]})]})},AEe=({data:t,size:e})=>{const{decks:r,decksLoading:n}=t,s=yn(),a=e==="xs",o=e==="small",l=e==="medium",c=e==="large",u=e==="xlarge",h=b.useMemo(()=>a||o?1:l?2:c?3:6,[a,o,l,c]),f=b.useMemo(()=>r?[...r].reverse().slice(0,h):[],[r,h]),m=b.useMemo(()=>a||o?"grid-cols-1":l?"grid-cols-2":c?"grid-cols-3":"grid-cols-2 lg:grid-cols-4 xl:grid-cols-6",[a,o,l,c]);if(a){const g=f[0];return i.jsxs("div",{onClick:()=>g&&s(`/decks/${g.id}`),className:"bg-gray-950/40 border border-white/5 rounded-3xl h-full flex items-center px-4 justify-between cursor-pointer hover:bg-white/5 transition-all group overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Recent Deck"}),i.jsx("span",{className:"text-gray-700",children:""}),i.jsx("span",{className:"text-xs font-bold text-white truncate max-w-[120px]",children:g?.name||"No decks"})]}),i.jsx("div",{className:"p-1.5 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}return i.jsxs("div",{className:`bg-gray-950/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md shadow-xl h-full flex flex-col`,children:[i.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-3 shrink-0",children:[i.jsx("span",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("span",{className:o?"hidden":"inline",children:"Recent Decks"}),o&&i.jsx("span",{children:"Recent"})]}),i.jsx("div",{className:"flex-grow overflow-hidden relative",children:n?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 text-xs",children:"Loading..."}):f.length>0?i.jsxs("div",{className:`grid ${m} gap-3 md:gap-4 h-full`,children:[f.map(g=>i.jsx(EEe,{deck:g,navigate:s},g.id)),u&&i.jsxs("div",{onClick:()=>s("/decks/new"),className:"border-2 border-dashed border-indigo-500/20 rounded-xl flex flex-col items-center justify-center text-center p-4 hover:border-indigo-500/40 hover:bg-indigo-500/5 transition-all group cursor-pointer",children:[i.jsx("div",{className:"p-3 rounded-full bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform mb-2",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),i.jsx("span",{className:"text-sm font-bold text-indigo-300",children:"New Deck"})]})]}):i.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 bg-gray-900/30 rounded-2xl border border-dashed border-gray-800",children:[i.jsx("p",{className:"text-gray-500 text-sm",children:"No decks."}),i.jsx(Hr,{to:"/decks/new",className:"text-indigo-400 text-xs font-bold hover:text-indigo-300 mt-1",children:"Create "})]})})]})},TEe=({data:t,size:e})=>{const{stats:r,decks:n}=t;if(!r||!r.topColor)return null;const s=e==="xs",a=e==="medium",o=e==="large",l=e==="xlarge",c=o||l,u=l?(n||[]).filter(h=>{const f=h?.commander?.color_identity||[],m=h?.commander_partner?.color_identity||[],g=[...new Set([...f,...m])].sort().join(""),y=r.topColor.pips?.sort().join("")||"C";return g===y}).slice(0,3):[];return i.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${s?"p-3":"p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative overflow-hidden h-full flex flex-col justify-center`,children:[i.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 opacity-10 rounded-bl-full ${r.topColor.bg} z-0`}),i.jsxs("div",{className:`flex relative z-10 h-full ${c?"flex-row items-center gap-8":"flex-col justify-between"}`,children:[s?i.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 uppercase tracking-tighter whitespace-nowrap border border-white/10",children:"Top Identity"}),i.jsx("div",{className:`text-sm font-black tracking-tight ${r.topColor.color||"text-white"}`,children:r.topColor.name})]}),i.jsx("div",{className:"flex -space-x-2",children:r.topColor.pips?.map((h,f)=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${h}.svg`,alt:h,className:"w-6 h-6 rounded-full shadow-lg transform group-hover:scale-110 transition-transform"},f))})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex flex-col",children:i.jsx("div",{className:"flex gap-1.5 mb-3",children:r.topColor.pips?.map((h,f)=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${h}.svg`,alt:h,className:"w-7 h-7 shadow-lg transform group-hover:scale-110 transition-transform"},f))})}),i.jsxs("div",{className:`flex-grow ${c?"":"mt-4"}`,children:[i.jsx("div",{className:`text-2xl font-black tracking-tighter mb-1 ${r.topColor.color||"text-white"}`,children:r.topColor.name}),i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Top Color Identity"}),(a||c)&&i.jsxs("div",{className:"text-xs text-gray-400 italic mt-3 opacity-80 leading-relaxed border-l-2 border-white/5 pl-3 py-1",children:['"',r.topColor.flavor,'"']})]})]}),l&&i.jsxs("div",{className:"flex-grow flex gap-8 items-center border-l border-white/5 pl-8 h-full",children:[i.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1 text-center",children:"Top Commanders"}),i.jsx("div",{className:"space-y-2",children:(u.length>0?u:n.slice(0,3)).map(h=>i.jsxs("div",{className:"flex items-center gap-2 group/cmd p-1 rounded-lg hover:bg-white/5 transition-colors",children:[h.commander?.image_uris?.art_crop&&i.jsx("img",{src:h.commander.image_uris.art_crop,className:"w-8 h-6 object-cover rounded border border-white/10",alt:""}),i.jsx("span",{className:"text-[11px] text-gray-300 group-hover/cmd:text-indigo-400 truncate",children:h.commander?.name||h.name})]},h.id))})]}),i.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-4 border border-white/5 flex items-center gap-4 group/asset relative overflow-hidden",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-1",children:"Signature Asset"}),i.jsx("div",{className:"text-sm font-black text-white group-hover/asset:text-indigo-300 transition-colors line-clamp-1",children:"Ragavan, Nimble Pilferer"}),i.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[i.jsx("span",{className:"text-xs text-green-400 font-mono",children:"$64.20"}),i.jsx("span",{className:"text-[9px] text-gray-500 uppercase font-black",children:"Market Value"})]})]}),i.jsxs("div",{className:"w-16 h-12 rounded-lg overflow-hidden border border-white/10 relative",children:[i.jsx("img",{src:"https://cards.scryfall.io/art_crop/front/a/1/a134a6df-d264-44b2-a42e-9dcc914a1a38.jpg",className:"w-full h-full object-cover group-hover/asset:scale-110 transition-transform duration-500",alt:""}),i.jsx("div",{className:"absolute inset-0 bg-indigo-500/10 mix-blend-overlay"})]}),i.jsx("div",{className:"absolute bottom-0 right-0 p-2 opacity-20 text-[20px] font-black italic",children:"64%"})]})]})]})]})},IEe=({size:t})=>{const{userProfile:e}=Cr(),r=e?.settings?.organization?.mode,n=t==="xs",s=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge",u=(h=>{switch(h){case"deckbuilder":return{label:"Deckbuilder",icon:"",desc:"Sorted by Color & Type",color:"indigo"};case"collector":return{label:"Collector",icon:"",desc:"Sorted by Set & Number",color:"blue"};case"hybrid":return{label:"Hybrid",icon:"",desc:"Binders + Bulk Boxes",color:"amber"};case"custom":return{label:"Custom",icon:"",desc:"Advanced Hierarchy",color:"emerald"};default:return{label:"Reference",icon:"",desc:"Default Organization",color:"gray"}}})(r);return n?i.jsxs(Hr,{to:"/settings/display",className:"bg-gray-900/60 border border-white/5 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-all group",children:[i.jsx("span",{className:"text-xl group-hover:scale-125 transition-transform",children:u.icon}),i.jsx("span",{className:"text-[10px] font-black text-gray-500 mt-1 uppercase tracking-tighter",children:"Org"})]}):i.jsxs("div",{className:"bg-gray-900/60 border border-white/5 rounded-3xl backdrop-blur-md overflow-hidden h-full flex flex-col relative group transition-all hover:border-white/10",children:[i.jsxs("div",{className:`flex items-center gap-4 ${l?"p-8 pb-4":"p-6"}`,children:[i.jsx("div",{className:`aspect-square ${s?"w-10 h-10 text-xl":"w-14 h-14 text-3xl"} flex items-center justify-center bg-gray-950 rounded-2xl shadow-inner border border-white/5 group-hover:scale-110 transition-transform`,children:u.icon}),i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("h3",{className:"font-black text-white uppercase tracking-wider text-sm flex items-center gap-2",children:["Organization",i.jsx("span",{className:`w-1.5 h-1.5 rounded-full bg-${u.color}-500 animate-pulse`})]}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:`text-xl font-black text-${u.color}-400`,children:u.label}),!s&&i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tight",children:u.desc})]})]})]}),i.jsx("div",{className:"flex-grow px-6 pb-6 overflow-hidden",children:l?i.jsxs("div",{className:"flex gap-4 h-full",children:[i.jsx("div",{className:"flex-grow grid grid-cols-4 gap-3",children:[{name:"Main Binder",type:"Binder",fill:85,color:"indigo"},{name:"Bulk Box A",type:"Box",fill:40,color:"blue"},{name:"Trade Folder",type:"Binder",fill:12,color:"emerald"},{name:"Rares Box",type:"Box",fill:95,color:"amber"}].map((h,f)=>i.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-2xl p-3 flex flex-col justify-between hover:bg-gray-800 transition-colors cursor-pointer group/loc",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase",children:h.type}),i.jsxs("span",{className:`text-[9px] font-bold text-${h.color}-400 px-1.5 py-0.5 bg-${h.color}-500/10 rounded-full border border-${h.color}-500/20`,children:[h.fill,"% Full"]})]}),i.jsx("div",{className:"mt-2 text-xs font-bold text-gray-300 group-hover/loc:text-white truncate",children:h.name}),i.jsx("div",{className:"mt-2 w-full bg-white/5 rounded-full h-1 overflow-hidden",children:i.jsx("div",{className:`h-full bg-${h.color}-500 transition-all duration-1000`,style:{width:`${h.fill}%`}})})]},f))}),i.jsxs("div",{className:"flex flex-col gap-2 min-w-[140px]",children:[i.jsx(Hr,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl border border-dashed border-white/10 text-[10px] font-bold text-gray-500 hover:border-white/20 hover:text-white transition-all p-2 text-center",children:"Manage Storage"}),i.jsx(Hr,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl bg-white/5 text-[10px] font-bold text-gray-400 hover:bg-white/10 transition-all p-2 text-center",children:"Change Mode"})]})]}):o?i.jsxs("div",{className:"flex items-center gap-6 h-full",children:[i.jsxs("div",{className:"flex-grow space-y-3",children:[i.jsxs("div",{className:"flex justify-between text-[10px] font-black text-gray-500 uppercase",children:[i.jsx("span",{children:"Storage Capacity"}),i.jsx("span",{className:"text-white",children:"65% Global Fill"})]}),i.jsx("div",{className:"w-full bg-gray-950 rounded-full h-3 p-0.5 border border-white/5",children:i.jsx("div",{className:`h-full bg-gradient-to-r from-${u.color}-600 to-${u.color}-400 rounded-full shadow-[0_0_10px_rgba(var(--color-primary),0.3)] transition-all duration-1000`,style:{width:"65%"}})}),i.jsxs("p",{className:"text-[10px] text-gray-500 italic",children:['"Items are currently sorted using the ',u.label,' logic. 12 binders detected."']})]}),i.jsxs(Hr,{to:"/settings/display",className:"flex-shrink-0 w-1/4 h-20 bg-white/5 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-white/10 transition-all",children:[i.jsx("div",{className:"text-xs font-black text-white",children:"Advanced"}),i.jsx("div",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Settings "})]})]}):a||s?i.jsxs("div",{className:"flex flex-col justify-end h-full",children:[i.jsx("div",{className:"h-1.5 w-full bg-gray-950 rounded-full overflow-hidden border border-white/5",children:i.jsx("div",{className:`h-full bg-${u.color}-500 transition-all duration-1000`,style:{width:"65%"}})}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"65% Full"}),i.jsx(Hr,{to:"/settings/display",className:"text-[10px] text-white font-bold underline-offset-4 hover:underline",children:"Settings"})]})]}):null}),i.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-${u.color}-500/0 to-${u.color}-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500`})]})},jz=({title:t,icon:e,color:r,onClick:n,compact:s})=>i.jsxs("button",{onClick:n,className:`group relative overflow-hidden rounded-2xl ${s?"p-2":"p-4 md:p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 h-full w-full`,children:[i.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),i.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),i.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors h-full",children:[i.jsx("div",{className:`${s?"p-1.5":"p-3"} bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20`,children:e}),i.jsx("span",{className:`font-bold ${s?"text-[10px]":"text-sm"} tracking-wide text-center leading-tight`,children:t})]})]}),PEe=({data:t,size:e})=>{const{userProfile:r,stats:n}=t,s=yn(),{addToast:a}=Tn(),o=e==="xs",l=e==="small",c=e==="medium",u=e==="xlarge",h=()=>{const m=An(r?.subscription_tier).limits.decks,g=n?.uniqueDecks||0;if(m!==1/0&&g>=m){a(`Deck limit reached (${g}/${m}). Upgrade to create more!`,"error");return}s("/decks/new")},f=[{title:"New Deck",icon:i.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"from-indigo-600 to-purple-600",onClick:h},{title:"Add Cards",icon:i.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-blue-600 to-cyan-600",onClick:()=>s("/collection")},{title:"Browse Sets",icon:i.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-green-600 to-emerald-600",onClick:()=>s("/sets")},{title:"Wishlist",icon:i.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"from-pink-600 to-rose-600",onClick:()=>s("/collection?wishlist=true")}];return o?i.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-2",children:[i.jsx("button",{onClick:h,className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg shadow-indigo-500/40 flex items-center justify-center transform active:scale-95 transition-all",title:"New Deck",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),i.jsx("span",{className:"text-[10px] font-black tracking-widest uppercase mt-2 text-indigo-400",children:"New Deck"})]}):u?i.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md shadow-xl h-full flex flex-col",children:[i.jsx("div",{className:"flex gap-4 mb-8",children:f.map((m,g)=>i.jsx("div",{className:"flex-1",children:i.jsx(jz,{...m,compact:!1})},g))}),i.jsxs("div",{className:"flex-grow border-t border-white/5 pt-6 overflow-hidden",children:[i.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Recent Activity"}),i.jsx("div",{className:"space-y-4",children:[{text:"Deck 'Necrons' updated",time:"2h ago",icon:""},{text:"5 cards added to collection",time:"1d ago",icon:""},{text:"New wishlist item: 'Black Lotus'",time:"3d ago",icon:""}].map((m,g)=>i.jsxs("div",{className:"flex items-center justify-between text-xs bg-gray-900/50 p-3 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-lg",children:m.icon}),i.jsx("span",{className:"text-gray-300",children:m.text})]}),i.jsx("span",{className:"text-gray-500 font-mono",children:m.time})]},g))})]})]}):i.jsxs("div",{className:`grid gap-2 md:gap-3 h-full ${l?"grid-cols-2":"grid-cols-2 md:grid-cols-4 items-center"}`,children:[f.map((m,g)=>i.jsx("div",{className:"min-w-0 h-full",children:i.jsx(jz,{...m,title:l?m.title.split(" ")[0]:m.title,compact:l})},g)),!l&&!c&&i.jsx("div",{className:"md:col-span-4 h-auto mt-2",children:i.jsx(IEe,{})})]})},LEe=({size:t,data:e})=>{const{userProfile:r,stats:n}=e||{},s=t==="xs",a=t==="small",o=t==="large"||t==="xlarge",l=An(r?.subscription_tier),c={decks:n?.uniqueDecks||0,collection:n?.collectionCount||0,wishlist:n?.wishlistCount||0},u=(g,y)=>{if(y===1/0)return"bg-indigo-500";const v=g/y*100;return v>=90?"bg-red-500":v>=75?"bg-yellow-500":"bg-green-500"},h=(g,y)=>{if(y===1/0)return"100%";const v=g/y*100;return`${Math.min(v,100)}%`},f=l.limits.decks!==1/0&&c.decks/l.limits.decks>=.9||l.limits.collection!==1/0&&c.collection/l.limits.collection>=.9||l.limits.wishlist!==1/0&&c.wishlist/l.limits.wishlist>=.9;if(s)return i.jsxs(Hr,{to:"/settings/membership",className:`bg-gray-900/60 border ${f?"border-red-500/40":"border-indigo-500/20"} rounded-3xl h-full flex flex-col items-center justify-center group hover:bg-gray-800 transition-all`,children:[i.jsx("span",{className:`text-xl font-black ${f?"text-red-400":"text-indigo-400"} group-hover:scale-110 transition-transform`,children:l.name[0]}),i.jsx("div",{className:"mt-1 flex gap-0.5",children:[1,2,3].map(g=>i.jsx("div",{className:`w-1 h-1 rounded-full ${f?"bg-red-500/50":"bg-indigo-500/50"}`},g))})]});const m=(g,y,v)=>{const w=u(y,v),N=h(y,v);return i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-end mb-1",children:[i.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest",children:g}),i.jsxs("span",{className:"text-[9px] font-mono text-gray-400",children:[y,"/",v===1/0?"":v]})]}),i.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden border border-white/5 shadow-inner",children:i.jsx("div",{className:`h-full ${w} transition-all duration-1000`,style:{width:N}})})]})};return i.jsxs("div",{className:`bg-gray-900 border ${f?"border-red-500/20":"border-indigo-500/20"} rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-10 h-10 ${f?"bg-red-500/10 text-red-400":"bg-indigo-500/10 text-indigo-400"} rounded-xl flex items-center justify-center text-xl shadow-inner border border-white/5`,children:f?"":l.name==="Wizard"?"":""}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-black text-[10px] text-gray-500 uppercase tracking-widest",children:["Plan: ",i.jsx("span",{className:"text-white",children:l.name})]}),i.jsx("p",{className:`text-[10px] ${f?"text-red-400":"text-indigo-400"} font-black uppercase tracking-widest`,children:f?"Limit Alert":"Active"})]})]}),!a&&i.jsx(Hr,{to:"/settings/membership",className:"text-[10px] font-black text-indigo-400 hover:text-white uppercase tracking-widest underline underline-offset-4 decoration-indigo-500/30",children:"Manage"})]}),i.jsxs("div",{className:`flex-grow ${o?"grid grid-cols-3 gap-6":"space-y-4"}`,children:[m("Decks",c.decks,l.limits.decks),m("Collection",c.collection,l.limits.collection),m("Wishlist",c.wishlist,l.limits.wishlist)]}),o&&i.jsxs("div",{className:"mt-6 pt-4 border-t border-white/5 flex justify-between items-center text-[10px]",children:[i.jsxs("div",{className:"text-gray-500 font-bold uppercase tracking-widest",children:["Pricing tier: ",l.name]}),i.jsx(Hr,{to:"/pricing",className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-xl text-white font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:"Upgrade"})]}),a&&i.jsx(Hr,{to:"/settings/membership",className:"mt-4 w-full py-2 bg-gray-800 text-center text-[10px] font-black uppercase tracking-widest text-gray-400 rounded-xl",children:"Details "})]})},OEe=({size:t})=>{const e=yn(),{addToast:r}=Tn(),[n,s]=b.useState([]),[a,o]=b.useState(0),[l,c]=b.useState(!0),u=t==="xs",h=t==="small",f=t==="medium",m=t==="large",g=t==="xlarge";b.useEffect(()=>{(async()=>{try{const w=await Ka.fetchRelationships(),N=w.filter(C=>C.status==="accepted");s(N);const k=w.filter(C=>C.status==="pending"&&C.direction==="incoming");o(k.length)}catch(w){console.error("Widget fetch failed",w)}finally{c(!1)}})()},[]);const y=v=>{v&&(v.preventDefault(),v.stopPropagation()),e("/settings/community")};return u?i.jsxs("div",{onClick:y,className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer hover:bg-indigo-500/20 transition-all group overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Pod Members"}),i.jsx("span",{className:"text-gray-700",children:""}),i.jsx("span",{className:"text-sm font-black text-white",children:n.length})]}),i.jsxs("div",{className:"relative flex-shrink-0",children:[i.jsx("svg",{className:"w-4 h-4 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),a>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-indigo-500 rounded-full border border-gray-950 animate-pulse"})]})]}):i.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${h?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/20 transition-all pointer-events-none"}),i.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-gray-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:["My Pod",a>0&&i.jsxs("span",{className:"bg-indigo-600 text-white text-[9px] font-black px-1.5 py-0.5 rounded-full animate-pulse tracking-normal",children:[a," New"]})]}),i.jsxs("div",{className:"mt-1 flex items-baseline gap-1",children:[i.jsx("span",{className:"text-3xl font-black text-white",children:n.length}),i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Members"})]})]}),i.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400 group-hover:scale-110 transition-transform",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),i.jsx("div",{className:"flex-grow space-y-3 relative z-10 overflow-hidden",children:l?i.jsx("div",{className:"space-y-2",children:i.jsx("div",{className:"h-10 bg-gray-800 rounded-xl animate-pulse"})}):g?i.jsxs("div",{className:"flex gap-8 h-full",children:[i.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-4",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Post to Pod"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"What's brewing?",className:"w-full bg-gray-950/80 border border-white/5 rounded-2xl p-4 pr-12 text-sm text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner"}),i.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-indigo-600 rounded-xl text-white hover:bg-indigo-500 transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]}),i.jsxs("div",{className:"flex gap-4 items-center",children:[n.slice(0,5).map((v,w)=>i.jsxs("div",{className:"flex flex-col items-center gap-2 group/u cursor-pointer",children:[i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"w-12 h-12 rounded-2xl bg-indigo-900 border border-indigo-500/30 flex items-center justify-center text-lg font-black text-indigo-200 uppercase group-hover/u:scale-110 group-hover/u:border-indigo-400 transition-all shadow-lg overflow-hidden",children:[v.friend.username?.[0],i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-indigo-950/50 to-transparent opacity-0 group-hover/u:opacity-100 transition-opacity"})]}),i.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-950"})]}),i.jsx("span",{className:"text-[10px] font-bold text-gray-400 group-hover/u:text-white transition-colors",children:v.friend.username})]},v.id)),i.jsx("div",{onClick:y,className:"w-12 h-12 rounded-2xl border-2 border-dashed border-white/10 flex items-center justify-center text-gray-600 hover:text-white hover:border-white/20 transition-all cursor-pointer",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}):m?i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Pod Activity"}),[{user:"Tristin",act:"updated Ghave Deck",time:"1h"},{user:"Sarah",act:"added 3 Rare cards",time:"4h"},{user:"Mike",act:"ranked #1 in Draft",time:"12h"}].map((v,w)=>i.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-950/50 rounded-xl border border-white/5 text-[11px] group/item hover:bg-gray-800 transition-colors",children:[i.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center font-bold text-indigo-300 text-[10px] uppercase shadow-sm",children:v.user[0]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("span",{className:"font-bold text-gray-200",children:v.user})," ",i.jsx("span",{className:"text-gray-400",children:v.act})]}),i.jsx("span",{className:"text-gray-600 font-mono text-[9px]",children:v.time})]},w))]}):i.jsxs("div",{className:"space-y-2",children:[n.slice(0,f?3:2).map(v=>i.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[i.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center text-[10px] font-bold text-indigo-200 uppercase",children:v.friend.username?.[0]}),i.jsx("div",{className:"text-xs font-bold text-gray-300 truncate",children:v.friend.username})]},v.id)),n.length===0&&i.jsx("p",{className:"text-[10px] text-gray-600 italic text-center py-4",children:"No members in your pod yet."})]})}),!g&&i.jsx("button",{onClick:y,className:`w-full ${h?"py-2 text-[10px]":"py-3 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all mt-4`,children:"Manage Pod"})]})},jx=["Just buy a new booster box? Add the cards through the set page, after organizing the cards by collector number. You can go top down, or bottom up on the list and make your life MUCH easier.","You can bulk import your collection via CSV! Check the Collection page for the template.","Right-click any card in your collection to instantly find it on TCGPlayer.","Use the 'Wishlist' filter in your collection to track cards you plan to buy.","You can separate your 'Foils' from regular printings by toggling the foil icon when adding cards.","Filter your collection by 'Rarity: Mythic' to see your big hits quickly.","The 'Price' filter helps you find those hidden gems in your bulk box.","Did you know? You can manually edit the market price of a card if you have a specific variant not tracked correctly.","Smart Binders update automatically. If you add a new Goblin to your collection, it instantly goes into your 'Goblin Tribe' binder.","You can use RegEx in Smart Binders! Example: Name matches `^Dark` finds cards starting with 'Dark'.","Want a binder for high-value cards? Set a rule for 'Price > 5.00'.","Create a 'Trade Binder' by excluding cards that are currently in a deck: `In Deck = False`.","You can combine rules! `Color Identity = R` AND `Type = Dragon` makes a perfect dragon binder.","Smart Binders can track duplicates. Set `Quantity > 4` to find cards you can trade away.","Customize your binder icons with emojis to make them stand out in the list.","Use the 'Pro Color' toggles in the Smart Creator to quickly select color identities.","When building a deck, use the 'Synergy' tab to see cards that work well with your Commander.","The Mana Curve chart updates in real-time as you add cards to your deck.","You can clone any of your existing decks to try out a new strategy without losing the original.","Use the 'Playtest' feature to draw sample hands and see if your land count is right.","Toggle 'Group by Type' in the deck view to see your creature/spell balance.","The AI Strategy tool can suggest a land base for you based on your color pips.","Add 'Tags' to cards in your deck (like 'Ramp', 'Removal') to see a custom breakdown.","You can set a card as your 'Commander' directly from the search results.","Check the 'Sideboard' tab to keep track of cards you're considering but haven't cut yet.","Invite friends to your 'Pod' to see their trade binders in real-time.","You can set your Pod permissions to 'Viewer' (read-only) or 'Editor' (trust them to modify decks).","Share your deck with a QR code! It's perfect for showing off your build at the LGS.","Link your account with a partner to build 'Team Decks' using a shared card pool.","Mark cards as 'Not for Trade' in your collection, and they won't show up for your Pod friends.","Collaborate on a deck list by giving a friend 'Editor' access in your Pod.","Keep your database healthy! Run the 'Cleanup' script periodically if you notice duplicate entries.","You can change your theme preference in the Settings menu (Dark/Light mode).","Report bugs directly from the dashboard using the 'System Status' widget.","The dollar value of your collection is an estimate based on TCGPlayer Market Price.","Use standard Scryfall syntax in the search bar. `t:creature cmc>5` works!","Hover over the KPI cards on the dashboard to see more detailed tooltips.","Click the 'Update Prices' button on the dashboard to fetch the latest market data.","You can view your deck's stats (CMC, Type distribution) on the mobile view too!","The app works offline for browsing, but you need internet to sync prices or images.","Double-click a card image to view the high-res version.","Use keyboard shortcuts! 'Ctrl/Cmd + F' usually brings up the card search."],MEe=({size:t})=>{const[e,r]=b.useState(0),[n,s]=b.useState(!1),a=t==="xs",o=t==="small",l=t==="large"||t==="xlarge";b.useEffect(()=>{const u=Math.floor(Math.random()*jx.length);r(u)},[]);const c=u=>{n||(s(!0),setTimeout(()=>s(!1),300),r(h=>u==="next"?(h+1)%jx.length:(h-1+jx.length)%jx.length))};return a?i.jsx("div",{onClick:()=>c("next"),className:"bg-yellow-500/10 border border-yellow-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-yellow-500/20 transition-all group",children:i.jsx("svg",{className:"w-6 h-6 text-yellow-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}):i.jsxs("div",{className:`bg-gray-900/50 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[i.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity",children:i.jsx("svg",{className:"w-20 h-20 transform rotate-12",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"})})}),i.jsxs("h2",{className:"font-black text-white mb-2 flex items-center gap-2 relative z-10 text-[10px] uppercase tracking-widest",children:[i.jsx("span",{className:"p-1.5 bg-yellow-500/10 rounded-lg text-yellow-400",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),"Pro Tip"]}),i.jsxs("div",{className:"relative z-10 flex-grow flex flex-col justify-between",children:[i.jsx("p",{className:`text-gray-300 leading-relaxed transition-opacity duration-300 ${n?"opacity-0":"opacity-100"} ${l?"text-sm":"text-[11px]"}`,children:jx[e]}),i.jsxs("div",{className:"flex items-center justify-between mt-4 border-t border-white/5 pt-3",children:[i.jsxs("span",{className:"text-[9px] text-gray-500 font-mono font-bold uppercase tracking-widest",children:["Tip ",e+1," of ",jx.length]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>c("prev"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsx("button",{onClick:()=>c("next"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]})]})},Jne=6048e5,REe=864e5,oN=43200,kz=1440,_z=Symbol.for("constructDateFrom");function kf(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&_z in t?t[_z](e):t instanceof Date?new t.constructor(e):new Date(e)}function go(t,e){return kf(e||t,t)}let DEe={};function pw(){return DEe}function c2(t,e){const r=pw(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,s=go(t,e?.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function $4(t,e){return c2(t,{...e,weekStartsOn:1})}function Zne(t,e){const r=go(t,e?.in),n=r.getFullYear(),s=kf(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=$4(s),o=kf(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=$4(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function U4(t){const e=go(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function sS(t,...e){const r=kf.bind(null,t||e.find(n=>typeof n=="object"));return e.map(r)}function Sz(t,e){const r=go(t,e?.in);return r.setHours(0,0,0,0),r}function BEe(t,e,r){const[n,s]=sS(r?.in,t,e),a=Sz(n),o=Sz(s),l=+a-U4(a),c=+o-U4(o);return Math.round((l-c)/REe)}function FEe(t,e){const r=Zne(t,e),n=kf(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),$4(n)}function Aj(t,e){const r=+go(t)-+go(e);return r<0?-1:r>0?1:r}function $Ee(t){return kf(t,Date.now())}function UEe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function zEe(t){return!(!UEe(t)&&typeof t!="number"||isNaN(+go(t)))}function VEe(t,e,r){const[n,s]=sS(r?.in,t,e),a=n.getFullYear()-s.getFullYear(),o=n.getMonth()-s.getMonth();return a*12+o}function qEe(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function HEe(t,e){return+go(t)-+go(e)}function WEe(t,e){const r=go(t,e?.in);return r.setHours(23,59,59,999),r}function GEe(t,e){const r=go(t,e?.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function KEe(t,e){const r=go(t,e?.in);return+WEe(r,e)==+GEe(r,e)}function YEe(t,e,r){const[n,s,a]=sS(r?.in,t,t,e),o=Aj(s,a),l=Math.abs(VEe(s,a));if(l<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-o*l);let c=Aj(s,a)===-o;KEe(n)&&l===1&&Aj(n,a)===1&&(c=!1);const u=o*(l-+c);return u===0?0:u}function XEe(t,e,r){const n=HEe(t,e)/1e3;return qEe(r?.roundingMethod)(n)}function QEe(t,e){const r=go(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const JEe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ZEe=(t,e,r)=>{let n;const s=JEe[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function QE(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const eAe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},tAe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rAe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nAe={date:QE({formats:eAe,defaultWidth:"full"}),time:QE({formats:tAe,defaultWidth:"full"}),dateTime:QE({formats:rAe,defaultWidth:"full"})},sAe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},iAe=(t,e,r,n)=>sAe[t];function Ev(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r?.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r?.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const aAe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},oAe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},lAe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},cAe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},uAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},hAe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fAe={ordinalNumber:hAe,era:Ev({values:aAe,defaultWidth:"wide"}),quarter:Ev({values:oAe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ev({values:lAe,defaultWidth:"wide"}),day:Ev({values:cAe,defaultWidth:"wide"}),dayPeriod:Ev({values:uAe,defaultWidth:"wide",formattingValues:dAe,defaultFormattingWidth:"wide"})};function Av(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?mAe(l,f=>f.test(o)):pAe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const h=e.slice(o.length);return{value:u,rest:h}}}function pAe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function mAe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function gAe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const xAe=/^(\d+)(th|st|nd|rd)?/i,yAe=/\d+/i,bAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vAe={any:[/^b/i,/^(a|c)/i]},wAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NAe={any:[/1/i,/2/i,/3/i,/4/i]},jAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_Ae={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},SAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},CAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},EAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},AAe={ordinalNumber:gAe({matchPattern:xAe,parsePattern:yAe,valueCallback:t=>parseInt(t,10)}),era:Av({matchPatterns:bAe,defaultMatchWidth:"wide",parsePatterns:vAe,defaultParseWidth:"any"}),quarter:Av({matchPatterns:wAe,defaultMatchWidth:"wide",parsePatterns:NAe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Av({matchPatterns:jAe,defaultMatchWidth:"wide",parsePatterns:kAe,defaultParseWidth:"any"}),day:Av({matchPatterns:_Ae,defaultMatchWidth:"wide",parsePatterns:SAe,defaultParseWidth:"any"}),dayPeriod:Av({matchPatterns:CAe,defaultMatchWidth:"any",parsePatterns:EAe,defaultParseWidth:"any"})},ese={code:"en-US",formatDistance:ZEe,formatLong:nAe,formatRelative:iAe,localize:fAe,match:AAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function TAe(t,e){const r=go(t,e?.in);return BEe(r,QEe(r))+1}function IAe(t,e){const r=go(t,e?.in),n=+$4(r)-+FEe(r);return Math.round(n/Jne)+1}function tse(t,e){const r=go(t,e?.in),n=r.getFullYear(),s=pw(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=kf(e?.in||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=c2(o,e),c=kf(e?.in||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=c2(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function PAe(t,e){const r=pw(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=tse(t,e),a=kf(e?.in||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),c2(a,e)}function LAe(t,e){const r=go(t,e?.in),n=+c2(r,e)-+PAe(r,e);return Math.round(n/Jne)+1}function vs(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const E0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return vs(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):vs(r+1,2)},d(t,e){return vs(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(t,e){return vs(t.getHours()%12||12,e.length)},H(t,e){return vs(t.getHours(),e.length)},m(t,e){return vs(t.getMinutes(),e.length)},s(t,e){return vs(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return vs(s,e.length)}},kx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Cz={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return E0.y(t,e)},Y:function(t,e,r,n){const s=tse(t,n),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return vs(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):vs(a,e.length)},R:function(t,e){const r=Zne(t);return vs(r,e.length)},u:function(t,e){const r=t.getFullYear();return vs(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return vs(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return vs(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return E0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return vs(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=LAe(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):vs(s,e.length)},I:function(t,e,r){const n=IAe(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):vs(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):E0.d(t,e)},D:function(t,e,r){const n=TAe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):vs(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return vs(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return vs(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return vs(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=kx.noon:n===0?s=kx.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=kx.evening:n>=12?s=kx.afternoon:n>=4?s=kx.morning:s=kx.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return E0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):E0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):vs(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):vs(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):E0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):E0.s(t,e)},S:function(t,e){return E0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Az(n);case"XXXX":case"XX":return tm(n);default:return tm(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Az(n);case"xxxx":case"xx":return tm(n);default:return tm(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Ez(n,":");default:return"GMT"+tm(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Ez(n,":");default:return"GMT"+tm(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return vs(n,e.length)},T:function(t,e,r){return vs(+t,e.length)}};function Ez(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+vs(a,2)}function Az(t,e){return t%60===0?(t>0?"-":"+")+vs(Math.abs(t)/60,2):tm(t,e)}function tm(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=vs(Math.trunc(n/60),2),a=vs(n%60,2);return r+s+e+a}const Tz=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},rse=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},OAe=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Tz(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Tz(n,e)).replace("{{time}}",rse(s,e))},MAe={p:rse,P:OAe},RAe=/^D+$/,DAe=/^Y+$/,BAe=["D","DD","YY","YYYY"];function FAe(t){return RAe.test(t)}function $Ae(t){return DAe.test(t)}function UAe(t,e,r){const n=zAe(t,e,r);if(console.warn(n),BAe.includes(t))throw new RangeError(n)}function zAe(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const VAe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,HAe=/^'([^]*?)'?$/,WAe=/''/g,GAe=/[a-zA-Z]/;function wa(t,e,r){const n=pw(),s=n.locale??ese,a=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,l=go(t,r?.in);if(!zEe(l))throw new RangeError("Invalid time value");let c=e.match(qAe).map(h=>{const f=h[0];if(f==="p"||f==="P"){const m=MAe[f];return m(h,s.formatLong)}return h}).join("").match(VAe).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const f=h[0];if(f==="'")return{isToken:!1,value:KAe(h)};if(Cz[f])return{isToken:!0,value:h};if(f.match(GAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const f=h.value;($Ae(f)||FAe(f))&&UAe(f,e,String(t));const m=Cz[f[0]];return m(l,f,s.localize,u)}).join("")}function KAe(t){const e=t.match(HAe);return e?e[1].replace(WAe,"'"):t}function YAe(t,e,r){const n=pw(),s=r?.locale??n.locale??ese,a=2520,o=Aj(t,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:o}),[c,u]=sS(r?.in,...o>0?[e,t]:[t,e]),h=XEe(u,c),f=(U4(u)-U4(c))/1e3,m=Math.round((h-f)/60);let g;if(m<2)return r?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):m===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",m,l);if(m<45)return s.formatDistance("xMinutes",m,l);if(m<90)return s.formatDistance("aboutXHours",1,l);if(m<kz){const y=Math.round(m/60);return s.formatDistance("aboutXHours",y,l)}else{if(m<a)return s.formatDistance("xDays",1,l);if(m<oN){const y=Math.round(m/kz);return s.formatDistance("xDays",y,l)}else if(m<oN*2)return g=Math.round(m/oN),s.formatDistance("aboutXMonths",g,l)}if(g=YEe(u,c),g<12){const y=Math.round(m/oN);return s.formatDistance("xMonths",y,l)}else{const y=g%12,v=Math.trunc(g/12);return y<3?s.formatDistance("aboutXYears",v,l):y<9?s.formatDistance("overXYears",v,l):s.formatDistance("almostXYears",v+1,l)}}function XAe(t,e){return YAe(t,$Ee(t),e)}const QAe=({isOpen:t,onClose:e,release:r})=>{const[n,s]=b.useState(!1);return b.useEffect(()=>(s(!0),()=>s(!1)),[]),!t||!r||!n?null:Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",onClick:e,children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl w-full max-w-2xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] animate-slide-up",onClick:a=>a.stopPropagation(),children:[i.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-start bg-gray-950/50",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-black text-white mb-1",children:r.version}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("span",{className:"text-xs text-gray-400 font-mono uppercase",children:["Released ",wa(new Date(r.released_at),"MMMM d, yyyy")]})})]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar bg-gray-900/50",children:[i.jsxs("div",{className:"flex gap-4 mb-6",children:[r.stats?.features>0&&i.jsx("div",{className:"px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-lg",children:i.jsxs("span",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:[r.stats.features," New Features"]})}),r.stats?.bugs>0&&i.jsx("div",{className:"px-3 py-1 bg-red-500/10 border border-red-500/20 rounded-lg",children:i.jsxs("span",{className:"text-xs font-bold text-red-400 uppercase tracking-wider",children:[r.stats.bugs," Bug Fixes"]})})]}),i.jsx("div",{className:"prose prose-invert prose-lg max-w-none prose-headings:text-indigo-300 prose-a:text-indigo-400 prose-strong:text-white",dangerouslySetInnerHTML:{__html:r.notes}})]}),i.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/30 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Close"})})]})}),document.body)},JAe=({size:t})=>{const[e,r]=b.useState([]),[n,s]=b.useState(!0),[a,o]=b.useState(null),l=t==="xs",c=t==="small",u=t==="large",h=t==="xlarge",f=u||h;return b.useEffect(()=>{(async()=>{try{const g=await He.getReleases();r(g||[])}catch(g){console.error("Failed to load releases",g)}finally{s(!1)}})()},[]),l?i.jsx("div",{onClick:()=>o(e[0]),className:"bg-green-900/10 border border-green-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-green-500/20 transition-all group",children:i.jsxs("div",{className:"relative",children:[i.jsx("svg",{className:"w-6 h-6 text-green-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.length>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-gray-950 animate-pulse"})]})}):i.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md flex flex-col h-full overflow-hidden relative group`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[i.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[i.jsx("span",{className:"p-1.5 bg-green-500/10 rounded-lg text-green-400",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),"Release Log"]}),f&&e[0]&&i.jsxs("span",{className:"text-[10px] font-mono text-green-400 font-bold px-2 py-0.5 bg-green-500/10 rounded-full border border-green-500/20",children:["Current: ",e[0].version]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar relative z-10",children:n?i.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Loading updates..."}):h&&e[0]?i.jsxs("div",{className:"flex gap-8 h-full",children:[i.jsxs("div",{className:"min-w-[180px] flex flex-col justify-center",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Newest Version"}),i.jsx("div",{className:"text-2xl lg:text-3xl font-black text-white mb-2 break-all leading-tight",children:e[0].version}),i.jsx("div",{className:"text-[10px] text-gray-400 font-mono mb-4",children:wa(new Date(e[0].released_at),"MMMM yyyy")}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[i.jsx("div",{className:"w-8 h-1 bg-emerald-500 rounded-full group-hover:w-10 transition-all"}),i.jsxs("span",{className:"text-[10px] font-black text-emerald-400 uppercase",children:[e[0].stats?.features||0," Features"]})]}),i.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[i.jsx("div",{className:"w-6 h-1 bg-red-500 rounded-full group-hover:w-8 transition-all"}),i.jsxs("span",{className:"text-[10px] font-black text-red-400 uppercase",children:[e[0].stats?.bugs||0," Bugfixes"]})]})]})]}),i.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-6 border border-white/5 relative group/notes overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[i.jsx("div",{className:"w-1 h-3 bg-indigo-500"})," Highlights"]}),i.jsx("div",{className:"space-y-3 overflow-hidden text-xs text-gray-400 line-clamp-4",dangerouslySetInnerHTML:{__html:e[0].notes}}),i.jsxs("button",{onClick:()=>o(e[0]),className:"mt-auto pt-4 text-[10px] font-black text-indigo-400 uppercase tracking-wider hover:text-white transition-colors flex items-center gap-1 group/btn",children:["Open Changelog ",i.jsx("svg",{className:"w-3 h-3 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),i.jsxs("div",{className:"min-w-[150px] border-l border-white/5 pl-8 flex flex-col",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4",children:"Past Updates"}),i.jsx("div",{className:"space-y-4",children:e.slice(1,4).map(m=>i.jsxs("div",{onClick:()=>o(m),className:"cursor-pointer group/hist",children:[i.jsx("div",{className:"text-xs font-black text-gray-300 group-hover/hist:text-white transition-colors",children:m.version}),i.jsx("div",{className:"text-[9px] text-gray-600 font-mono mt-0.5",children:wa(new Date(m.released_at),"MMM d, yyyy")})]},m.id))})]})]}):u&&e[0]?i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-4 border border-white/5",children:[i.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[i.jsxs("h3",{className:"text-sm font-black text-white",children:[e[0].version," Patch Notes"]}),i.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:wa(new Date(e[0].released_at),"MMMM yyyy")})]}),i.jsx("div",{className:"space-y-2 opacity-80 overflow-hidden max-h-[100px] text-xs",dangerouslySetInnerHTML:{__html:e[0].notes}}),i.jsx("button",{onClick:()=>o(e[0]),className:"mt-4 text-[10px] font-black text-green-400 uppercase tracking-widest hover:text-white transition-colors",children:"Read Full Notes "})]})}):i.jsx("div",{className:"space-y-2 h-full",children:e.length===0?i.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-50 pb-4",children:[i.jsx("svg",{className:"w-8 h-8 text-gray-600 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),i.jsx("div",{className:"text-[10px] font-black uppercase text-gray-500 tracking-widest",children:"No Updates Found"})]}):e.slice(0,c?1:2).map(m=>i.jsxs("div",{onClick:()=>o(m),className:"bg-gray-950/30 border border-white/5 rounded-xl p-3 flex items-center justify-between group cursor-pointer hover:bg-white/5 transition-all",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-black text-white text-sm",children:m.version}),i.jsx("div",{className:"text-[9px] text-gray-500 font-mono uppercase mt-0.5",children:wa(new Date(m.released_at),"MMM d")})]}),i.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-green-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},m.id))})}),i.jsx(QAe,{isOpen:!!a,onClose:()=>o(null),release:a}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/0 to-green-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},ZAe=({size:t})=>{const e=yn(),[r,n]=b.useState({online:0,pending:0,total:0}),s=t==="xs",a=t==="small",o=t==="large"||t==="xlarge";return b.useEffect(()=>{(async()=>{try{const c=await He.get("/api/friends"),u=c.pending_received?.length||0,h=c.friends?.length||0;n({online:0,pending:u,total:h})}catch(c){console.error(c)}})()},[]),s?i.jsxs("div",{onClick:()=>e("/social"),className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Xm,{size:18,className:"text-indigo-400 group-hover:scale-110 transition-transform"}),r.pending>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border border-gray-950 animate-bounce"})]}),i.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-1",children:r.total})]}):i.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-sm hover:border-gray-700 transition-colors flex flex-col h-full overflow-hidden`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400",children:i.jsx(Xm,{size:a?16:20})}),i.jsx("span",{className:`font-black tracking-tight text-white uppercase ${a?"text-[10px]":"text-xs"}`,children:"Community"})]}),r.pending>0&&i.jsxs("div",{className:"flex items-center justify-center px-2 py-0.5 bg-red-500/20 text-red-400 rounded-full border border-red-500/30 text-[9px] font-black animate-pulse",children:[i.jsx(WI,{size:10,className:"mr-1"}),r.pending," NEW"]})]}),i.jsx("div",{className:"flex-grow",children:o?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"text-4xl font-black text-white",children:r.total}),i.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Total Connections"})]}),i.jsxs("div",{className:"pt-4 border-t border-white/5",children:[i.jsx("h4",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-3",children:"Recent Pings"}),i.jsx("div",{className:"space-y-2",children:["GhaveMaster sent a trade","CommanderSarah shared a deck"].map((l,c)=>i.jsxs("div",{className:"text-[10px] text-gray-300 flex items-center gap-2 bg-gray-950/40 p-2 rounded-lg border border-white/5",children:[i.jsx("div",{className:"w-1 h-1 rounded-full bg-indigo-500"}),l]},c))})]})]}):i.jsxs("div",{children:[i.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:r.total}),i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:"Friends Connected"})]})}),i.jsx("button",{onClick:()=>e("/social"),className:`mt-4 w-full ${a?"py-1.5 text-[10px]":"py-2.5 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all`,children:"View Hub"})]})},nse=({isOpen:t,onClose:e,onConfirm:r,type:n,targetId:s,loading:a,activeSession:o})=>t?Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900/90 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 pointer-events-none"}),i.jsxs("div",{className:"p-8 relative z-10",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center text-2xl border border-indigo-500/30 text-indigo-400",children:""}),i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Start ",n.charAt(0).toUpperCase()+n.slice(1)," Audit"]}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Verify your physical ownership"})]})]}),i.jsxs("div",{className:"space-y-4 mb-8",children:[o?i.jsxs("div",{className:"border border-red-500/30 bg-red-900/20 p-4 rounded-xl",children:[i.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Previous Audit In Progress"]}),i.jsxs("p",{className:"text-sm text-gray-300",children:["You have an active ",i.jsx("strong",{children:o.type})," audit. Starting this new audit will ",i.jsx("strong",{children:"cancel and delete"})," the existing session."]})]}):i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[i.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:"How it works:"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-indigo-400",children:"1."}),i.jsx("span",{children:"We'll create a snapshot of your current digital list."})]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-indigo-400",children:"2."}),i.jsx("span",{children:"You'll verify each card physically."})]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-indigo-400",children:"3."}),i.jsx("span",{children:"Finalize to reconcile any differences."})]})]})]}),!o&&i.jsxs("div",{className:"flex items-center gap-3 text-sm text-blue-400 bg-blue-500/10 p-3 rounded-lg border border-blue-500/20",children:[i.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsx("span",{children:"Only one active audit allowed. This will be your active session."})]})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white font-medium transition-colors",children:"Cancel"}),i.jsxs("button",{onClick:r,disabled:a,className:`px-6 py-2 font-bold rounded-xl shadow-lg transition-all transform hover:scale-105 active:scale-95 flex items-center gap-2 disabled:opacity-50 ${o?"bg-red-600 hover:bg-red-500 text-white shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20"}`,children:[a?"Starting...":o?"Overwrite & Start":"Begin Audit",!a&&i.jsx("span",{className:"opacity-70",children:""})]})]})]})]})}),document.body):null;function JO({type:t,targetId:e,label:r="Start Audit",className:n=""}){const[s,a]=b.useState(!1),[o,l]=b.useState(!1),c=yn(),[u,h]=b.useState(null),f=async()=>{a(!0);try{u&&await He.cancelAudit(u.id);const g=await He.startAudit({type:t,targetId:e});c(`/audit/${g.id}`)}catch(g){console.error(g),alert("Failed to start audit: "+g.message)}finally{a(!1),l(!1),h(null)}},m=async()=>{a(!0);try{const g=await He.getActiveAudit();if(g){const y=g.type===t,v=!e||String(g.target_id)===String(e);if(y&&v){c(`/audit/${g.id}`);return}h(g),l(!0);return}h(null),l(!0)}catch(g){console.error(g),l(!0)}finally{a(!1)}};return i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:m,className:`flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors shadow-lg shadow-indigo-500/20 disabled:opacity-50 ${n}`,children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),r]}),i.jsx(nse,{isOpen:o,onClose:()=>l(!1),onConfirm:f,type:t,loading:s,activeSession:u})]})}function e6e({size:t}){const[e,r]=b.useState(null),[n,s]=b.useState(null),[a,o]=b.useState(!0),[l,c]=b.useState(!1),u=yn(),{userProfile:h}=Cr(),f=t==="xs",m=t==="small",g=t==="large",y=t==="xlarge",v=g||y;b.useEffect(()=>{(async()=>{try{const M=await He.getActiveAudit();if(r(M),M){const B=await He.get(`/api/audit/${M.id}/stats`);s(B)}}catch(M){console.error("Failed to check audit status",M)}finally{o(!1)}})()},[]);const{features:w}=An(h?.subscription_tier);if(!w.collectionAudit)return f?i.jsx("div",{onClick:()=>u("/settings/membership"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center opacity-75 cursor-pointer hover:opacity-100 border border-gray-800",children:i.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}):i.jsxs("div",{className:"bg-gray-900/50 rounded-3xl p-4 border border-gray-800 transition-all group relative overflow-hidden flex flex-col h-full opacity-75 hover:opacity-100",children:[i.jsx("div",{className:"flex justify-between items-start mb-1 relative z-10",children:i.jsx("h3",{className:"text-gray-400 text-xs font-medium uppercase tracking-widest",children:"Audit"})}),i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[i.jsx("p",{className:"text-[10px] text-gray-500 mb-2",children:"Unlock Wizard tier to audit your collection."}),i.jsx("button",{onClick:()=>u("/settings/membership"),className:"text-[9px] font-bold uppercase tracking-widest text-indigo-400 border border-indigo-500/30 px-3 py-1.5 rounded-lg hover:bg-indigo-500/20",children:"Upgrade"})]})]});if(a)return null;if(!e)return f?i.jsx("div",{onClick:()=>u("/audit"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center cursor-pointer border border-gray-800 group transition-all",children:i.jsx("svg",{className:"w-6 h-6 text-gray-600 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 002-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}):i.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${m?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/10 transition-all pointer-events-none"}),i.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[i.jsx("h3",{className:"text-gray-400 text-xs font-medium tracking-widest uppercase",children:"Collection Audit"}),i.jsx("div",{className:"text-gray-600 group-hover:text-indigo-400 transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),i.jsx("div",{className:"mt-auto relative z-10 flex flex-col gap-2",children:i.jsx(JO,{type:"collection",label:"Start Audit",className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-xs transition-all active:scale-95 shadow-lg shadow-indigo-900/20 border-none"})})]});const N=Math.ceil((new Date(e.expires_at)-new Date)/(1e3*60*60*24)),k=n?.total_cards||0,C=n?.total_reviewed||0,I=n?.mismatches?.length||0,O=C-I,L=k-C,_=k>0?Math.round(C/k*100):0;return f?i.jsxs("div",{onClick:()=>u("/audit"),className:"bg-indigo-900/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer border border-indigo-500/30 group transition-all hover:bg-indigo-900/30 overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-indigo-500/10 text-indigo-400/80 uppercase tracking-tighter whitespace-nowrap border border-indigo-500/20",children:"Audit Progress"}),i.jsxs("span",{className:"text-sm font-black text-white",children:[_,"%"]})]}),i.jsxs("div",{className:"relative w-8 h-8 flex items-center justify-center",children:[i.jsx("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:i.jsx("circle",{cx:"50%",cy:"50%",r:"30%",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${_*.63} 100`,strokeLinecap:"round",className:"text-indigo-500"})}),i.jsx("svg",{className:"w-3 h-3 text-indigo-400/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})]})]}):i.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${m?"p-4":"p-6"} border border-indigo-500/20 hover:border-indigo-500/40 transition-all group relative overflow-hidden flex flex-col h-full`,children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none"}),i.jsxs("div",{className:`flex relative z-10 h-full ${y?"flex-row items-center gap-12":"flex-col"}`,children:[i.jsxs("div",{className:y?"min-w-[140px]":"mb-4",children:[i.jsxs("h3",{className:"text-indigo-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2 mb-1",children:["Live Audit",i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"})]}),i.jsxs("div",{className:"flex items-baseline gap-1",children:[i.jsxs("span",{className:`${y?"text-5xl":"text-3xl"} font-black text-white`,children:[_,"%"]}),i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Complete"})]}),v&&i.jsxs("div",{className:"mt-2 text-[10px] text-gray-400 font-bold uppercase tracking-tighter",children:[N," days remaining"]})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:"w-full bg-gray-800 rounded-full h-1.5 overflow-hidden mb-3",children:i.jsx("div",{className:"bg-indigo-500 h-full transition-all duration-1000",style:{width:`${_}%`}})}),y?i.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-1",children:"Matches"}),i.jsx("span",{className:"text-xl font-black text-white",children:O}),i.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Confirmed valid"})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-1",children:"Mismatches"}),i.jsx("span",{className:"text-xl font-black text-white",children:I}),i.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Action required"})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Pending"}),i.jsx("span",{className:"text-xl font-black text-white",children:L}),i.jsx("span",{className:"text-[9px] text-gray-600 uppercase text-nowrap",children:"Cards remaining"})]})]}):i.jsxs("div",{className:`flex justify-between text-[10px] font-bold uppercase tracking-widest ${m?"hidden":"flex"}`,children:[i.jsxs("span",{className:"text-green-500",children:[O," Match"]}),i.jsxs("span",{className:"text-red-500",children:[I," Diff"]}),i.jsxs("span",{className:"text-gray-500",children:[L," Left"]})]})]}),i.jsxs("div",{className:`${y?"min-w-[200px] border-l border-white/5 pl-8 h-full flex flex-col justify-center":"mt-4"}`,children:[g&&n?.mismatches?.length>0&&i.jsxs("div",{className:"mb-4 space-y-1.5",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Critical Delta Items"}),n.mismatches.slice(0,2).map((E,M)=>i.jsxs("div",{className:"text-[11px] text-gray-400 truncate flex items-center gap-2",children:[i.jsx("span",{className:"w-1 h-1 rounded-full bg-red-500"}),E.card_name]},M))]}),i.jsx("button",{onClick:()=>u("/audit"),className:"w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-[10px] transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:y?"Open Full Report":"Resume Audit "}),y&&i.jsx("button",{onClick:()=>c(!0),className:"mt-2 w-full py-2 text-[9px] font-bold text-gray-500 uppercase tracking-widest hover:text-white transition-colors",children:"How to Audit?"})]})]})]})}const t6e=({size:t})=>{const[e,r]=b.useState({history:[],pointer:-1});b.useEffect(()=>(r({history:pm.getLog(),pointer:pm.pointer}),pm.subscribe(u=>{r({history:u.history,pointer:u.pointer})})),[]);const{history:n}=e,s=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge";return n.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:[i.jsx("svg",{className:"w-8 h-8 mb-2 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsx("div",{className:"text-xs font-bold uppercase tracking-wider",children:"No Recent Activity"})]}):i.jsxs("div",{className:"h-full flex flex-col bg-gray-900/40 backdrop-blur-md rounded-3xl overflow-hidden border border-white/5",children:[i.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-center bg-black/20",children:[i.jsxs("h3",{className:"text-xs font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"}),"Session History"]}),i.jsxs("span",{className:"text-[10px] text-gray-600 font-mono",children:[n.length," Actions"]})]}),i.jsx("div",{className:`flex-grow overflow-y-auto custom-scrollbar ${s?"p-2":"p-4"}`,children:i.jsx("div",{className:"space-y-2",children:n.map((c,u)=>{const h=n.length-1-u===e.pointer;return i.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-xl transition-all border ${h?"bg-cyan-500/10 border-cyan-500/30":"bg-black/20 border-white/5 hover:bg-white/5"}`,children:[i.jsx("div",{className:`mt-0.5 p-1.5 rounded-lg ${h?"bg-cyan-500/20 text-cyan-400":"bg-gray-800 text-gray-500"}`,children:h?i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}):i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:`text-xs font-bold ${h?"text-cyan-100":"text-gray-300"}`,children:c.action}),i.jsx("div",{className:"text-[10px] text-gray-500 font-mono mt-0.5",children:new Date(c.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]},c.timestamp)})})}),(a||o||l)&&i.jsx("div",{className:"p-3 bg-black/20 border-t border-white/5 text-[10px] text-gray-500 text-center font-mono",children:"Press Ctrl+Z to Undo  Ctrl+Y to Redo"})]})},sse={findMatches:async t=>{try{const r=(await He.get(`/api/collection?userId=${t}&wishlist=true`)).map(o=>({id:o.scryfall_id,name:o.name,set:o.set_code,wishlistId:o.id}));if(r.length===0)return[];const s=(await Ka.fetchRelationships()).filter(o=>o.status==="accepted").map(o=>o.friend);if(s.length===0)return[];const a=[];return await Promise.all(s.map(async o=>{try{(await He.get(`/api/collection?userId=${o.id}&public=true`)).forEach(c=>{r.find(h=>h.id===c.scryfall_id)&&a.push({cardName:c.name,cardId:c.scryfall_id,set:c.set_code,finish:c.finish,friendName:o.username,friendId:o.id,quantity:c.count,image:c.image_uri||c.data?.image_uris?.normal})})}catch(l){console.warn(`Failed to fetch collection for ${o.username}`,l)}})),a}catch(e){throw console.error("TradeService findMatches failed:",e),e}},findReverseMatches:async t=>[]},r6e=({size:t="medium"})=>{const{currentUser:e,userProfile:r}=Cr(),[n,s]=b.useState(0),[a,o]=b.useState(!0),[l,c]=b.useState(!1);return b.useEffect(()=>{if(!e||!r?.id||l)return;let u=!0;return(async()=>{try{const f=await sse.findMatches(r.id);u&&s(f?.length||0)}catch(f){!navigator.onLine||f.message?.includes("HTML")||f.message?.includes("403")||console.warn("Widget trade check failed",f),u&&c(!0)}finally{u&&o(!1)}})(),()=>{u=!1}},[e,r?.id,l]),a?i.jsx("div",{className:"h-full w-full bg-gray-800 rounded-2xl animate-pulse flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700"})}):i.jsx(Hr,{to:"/armory",className:"block h-full w-full group",children:i.jsxs("div",{className:"h-full w-full bg-gradient-to-br from-indigo-900/50 to-gray-900 border border-indigo-500/30 hover:border-indigo-400 rounded-2xl p-4 flex flex-col justify-between relative overflow-hidden transition-all hover:shadow-[0_0_20px_rgba(99,102,241,0.3)]",children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-600/10 rounded-full blur-3xl -mr-10 -mt-10 transition-all group-hover:bg-indigo-600/20"}),i.jsx("div",{className:"flex justify-between items-start z-10",children:i.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:text-white group-hover:bg-indigo-500 transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})})}),i.jsxs("div",{className:"z-10",children:[i.jsx("div",{className:"text-3xl font-bold text-white mb-1 group-hover:scale-105 transition-transform origin-left",children:n>0?n:"No"}),i.jsx("div",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:n===1?"Trade Match":"Trade Matches"}),n>0&&i.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"Cards available in your Pod"})]})]})})},n6e={new_deck:{title:"New Deck",icon:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),gradient:"from-indigo-600 to-purple-600",action:({navigate:t,addToast:e,userProfile:r,stats:n})=>{const s=An(r?.subscription_tier).limits.decks,a=n?.uniqueDecks||0;if(s!==1/0&&a>=s){e(`Deck limit reached (${a}/${s}).`,"error");return}t("/decks/new")}},add_cards:{title:"Add Cards",icon:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-blue-600 to-cyan-600",action:({navigate:t})=>t("/collection")},browse_sets:{title:"Browse Sets",icon:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-green-600 to-emerald-600",action:({navigate:t})=>t("/sets")},wishlist:{title:"Wishlist",icon:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),gradient:"from-pink-600 to-rose-600",action:({navigate:t})=>t("/collection?wishlist=true")},tournaments:{title:"Tournaments",icon:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),gradient:"from-yellow-600 to-orange-600",action:({navigate:t})=>t("/tournaments")}},Tv=({actionType:t,data:e,size:r})=>{const n=yn(),{addToast:s}=Tn(),{userProfile:a,stats:o,decks:l}=e||{},c=r==="xs",u=r==="small",h=r==="large"||r==="xlarge",f=n6e[t];if(!f)return null;const m=()=>{f.action&&f.action({navigate:n,addToast:s,userProfile:a,stats:o})};return c?i.jsxs("button",{onClick:m,className:"group relative overflow-hidden rounded-3xl w-full h-full flex items-center justify-between px-4 transition-all active:scale-95 border border-white/5 bg-gray-900/40",title:f.title,children:[i.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${f.gradient} opacity-0 group-hover:opacity-20 transition-opacity`}),i.jsx("div",{className:"flex items-center gap-2 relative z-10",children:i.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 group-hover:text-white uppercase tracking-tighter whitespace-nowrap border border-white/10",children:f.title})}),i.jsx("div",{className:"p-1.5 rounded-lg bg-gray-950/50 text-white group-hover:scale-110 transition-transform relative z-10",children:Ie.cloneElement(f.icon,{className:"w-4 h-4"})})]}):i.jsxs("button",{onClick:m,className:`group relative overflow-hidden rounded-3xl ${u?"p-4":"p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 w-full h-full flex flex-col justify-center items-center bg-gray-900/40`,children:[i.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${f.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),i.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors",children:[i.jsx("div",{className:`${u?"p-2":"p-4"} bg-gray-950/50 rounded-2xl backdrop-blur-sm group-hover:scale-110 transition-all group-hover:bg-white/10 ring-1 ring-white/5 shadow-inner`,children:f.icon}),i.jsxs("div",{className:"text-center",children:[i.jsx("span",{className:`${u?"text-[10px]":"text-sm"} font-black uppercase tracking-widest`,children:f.title}),h&&i.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1 opacity-0 group-hover:opacity-100 transition-opacity line-clamp-1",children:t==="new_deck"?"Start your next brew":t==="add_cards"?"Grow your collection":"Quick Access"})]})]})]})},s6e=({size:t,actions:e})=>{const{setIsIssueModalOpen:r}=e,[n,s]=b.useState([]),[a,o]=b.useState(!1),l=t==="xs",c=t==="small",u=t==="large"||t==="xlarge";b.useEffect(()=>{l||(o(!0),He.getTickets({limit:5}).then(f=>s(Array.isArray(f)?f:[])).catch(f=>console.error("[SystemStatus] Load error:",f)).finally(()=>o(!1)))},[t]);const h=f=>{switch(f){case"completed":return"text-green-400";case"in_progress":return"text-yellow-400";case"planned":return"text-blue-400";default:return"text-gray-400"}};return l?i.jsxs("div",{onClick:()=>r(!0),className:"bg-indigo-500/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[i.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(99,102,241,0.5)] group-hover:scale-125 transition-transform"}),i.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-2 uppercase tracking-widest",children:"Support"})]}):i.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col`,children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("h2",{className:"font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-indigo-500",children:""}),"Support Hub"]}),u&&i.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold mt-1",children:"Live Updates & Feedback"})]}),!c&&i.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-green-500/10 rounded-lg border border-green-500/20",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-[10px] font-bold text-green-400 uppercase tracking-tighter",children:"Systems Live"})]})]}),i.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[a&&n.length===0?i.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 text-xs",children:"Fetching tickets..."}):n.length>0?i.jsx("div",{className:"space-y-3",children:n.slice(0,u?4:2).map(f=>i.jsxs("div",{className:"group flex flex-col p-2.5 bg-gray-950/40 border border-white/5 rounded-xl hover:bg-gray-800/60 transition-colors cursor-pointer",onClick:()=>r(!0),children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("span",{className:"text-xs text-white font-medium truncate group-hover:text-indigo-400 transition-colors",children:f.title}),i.jsx("span",{className:`text-[9px] font-black uppercase px-1.5 py-0.5 rounded bg-white/5 ${h(f.status)} border border-white/5 whitespace-nowrap`,children:f.status?.replace("_"," ")})]}),u&&i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),f.votes||0]}),i.jsxs("div",{className:"text-[10px] text-gray-600",children:[" by ",f.created_by_username||"user"]})]})]},f.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[i.jsx("p",{className:"text-xs text-gray-500 italic mb-2",children:"No active tickets."}),!c&&i.jsx("p",{className:"text-[10px] text-gray-600 uppercase",children:"Found a bug? Use the button below."})]}),!u&&n.length>2&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-gray-900/40 to-transparent pointer-events-none"})]}),i.jsxs("button",{onClick:()=>r(!0),className:`w-full ${c?"h-10 text-xs":"h-12 text-sm"} bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-lg hover:shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 mt-4 shrink-0`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Report Issue"]})]})},i6e=({size:t,actions:e})=>{const{setShowBinderGuide:r,setShowPodGuide:n,setShowAuditGuide:s}=e,a=t==="xs",o=t==="small",l=t==="large",c=t==="xlarge",u=l||c;if(a)return i.jsx("div",{onClick:()=>r(!0),className:"bg-blue-900/10 border border-blue-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-blue-500/20 transition-all group",children:i.jsx("svg",{className:"w-6 h-6 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})});const h=[{title:"Smart Binders",desc:"Automate your collection logic",icon:"",color:"indigo",progress:80,onClick:()=>r(!0)},{title:"Pods & Sharing",desc:"Manage permissions & social",icon:"",color:"purple",progress:40,onClick:()=>n(!0)},{title:"Verification",desc:"Maintain inventory accuracy",icon:"",color:"green",progress:0,onClick:()=>s(!0)}];return i.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col group relative overflow-hidden`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[i.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[i.jsx("span",{className:"p-1.5 bg-blue-500/10 rounded-lg text-blue-400",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.247 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),"Learning Center"]}),c&&i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tighter",children:"Community Knowledge Base"})]}),i.jsx("div",{className:`flex-grow relative z-10 ${u?"grid grid-cols-3 gap-4":o?"grid grid-cols-3 gap-2":"grid grid-cols-3 gap-3"}`,children:h.map((f,m)=>{const g=!o&&!u;return i.jsxs("button",{onClick:f.onClick,className:`w-full text-left ${o||g?"p-2":"p-4"} rounded-2xl bg-gray-950/40 hover:bg-gray-800 border border-white/5 hover:border-${f.color}-500/30 transition-all group/item flex ${c?"flex-col justify-between":o||g?"flex-col items-center justify-center text-center":"items-center"} gap-3 h-full`,children:[i.jsxs("div",{className:`flex ${o||g?"flex-col":""} items-center ${o||g?"gap-1":"gap-3"}`,children:[i.jsx("div",{className:`${o||g?"p-1.5":"p-2"} bg-${f.color}-500/10 rounded-xl ${o?"text-base":g?"text-lg":"text-xl"} group-hover/item:scale-110 transition-transform`,children:f.icon}),i.jsxs("div",{className:"block text-center",children:[i.jsx("div",{className:`${o||g?"text-[10px] leading-tight":"text-xs"} font-black text-gray-200 group-hover/item:text-white uppercase tracking-wide`,children:o?m===0?"Binders":m===1?"Pods":"Audit":g?i.jsx(i.Fragment,{children:f.title.split(" ").map((y,v)=>i.jsx("span",{className:"block",children:y},v))}):f.title}),u&&!c&&i.jsx("div",{className:"text-[9px] text-gray-500 font-bold mt-0.5 line-clamp-1",children:f.desc})]})]}),c&&i.jsxs("div",{className:"mt-4 w-full",children:[i.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase mb-2 line-clamp-2 leading-relaxed",children:f.desc}),i.jsxs("div",{className:"flex justify-between items-center mb-1 text-[9px] font-mono",children:[i.jsx("span",{className:"text-gray-600 uppercase",children:"Progress"}),i.jsxs("span",{className:`text-${f.color}-400`,children:[f.progress,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-900 rounded-full h-1 overflow-hidden",children:i.jsx("div",{className:`h-full bg-${f.color}-500 transition-all duration-1000 delay-${m*100}`,style:{width:`${f.progress}%`}})})]})]},m)})}),!u&&!o&&i.jsxs("button",{onClick:()=>r(!0),className:"mt-4 text-[10px] font-black text-blue-400 hover:text-blue-300 uppercase tracking-widest flex items-center gap-1 justify-center relative z-10 group/all",children:["View All Resources ",i.jsx("svg",{className:"w-3 h-3 group-hover/all:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/0 to-blue-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},u2={stats_total:{title:"Total Cards",component:kEe,description:"Tracking the total volume of your magical collection.",sizes:{xs:"A micro-pill showing just the count and a label.",small:"Standard card count widget with icon.",medium:"Detailed count with growth markers.",large:"Full spread of collection statistics.",xlarge:"Deep dive into total counts and distribution."}},stats_decks:{title:"Unique Decks",component:_Ee,description:"Your strategic fleet of decks currently active.",sizes:{xs:"Compact count of distinct decks.",small:"Standard deck counter.",medium:"Show total decks vs archive.",large:"Stats on deck archetypes and colors.",xlarge:"Advanced deck-building analytics."}},stats_value:{title:"Collection Value",component:CEe,description:"Real-time market value of your entire assortment.",sizes:{xs:"Brief dollar amount with high contrast label.",small:"Value widget with currency symbol.",medium:"Display price change trends.",large:"Breakdown of most valuable items.",xlarge:"Historical value charting and top gainers."}},identity:{title:"Color Identity",component:TEe,description:"A visual spectrum of your collection colors.",sizes:{xs:"Top color pips in a row.",small:"Pips plus name of identity.",medium:"Flavorful breakdown of colors.",large:"Percentage distribution of mana colors.",xlarge:"Deep meta-analysis and signature staples."}},quick_actions:{title:"Quick Actions",component:PEe,description:"A dashboard hub for your most common tasks.",sizes:{xs:"Icon-only vertical stack.",small:"Balanced grid of action buttons.",medium:"Full width icon row.",large:"Detailed actions with shortcuts.",xlarge:"Admin-style toolbelt for your collection."}},action_new_deck:{title:"New Deck",component:t=>i.jsx(Tv,{...t,actionType:"new_deck"}),description:"Initiate a new deck building session.",sizes:{xs:'Simple "New" button pill.',small:"Standard action square.",medium:"Stretched action bar.",large:"Action with creative flavor text."}},action_add_cards:{title:"Add Cards",component:t=>i.jsx(Tv,{...t,actionType:"add_cards"}),description:"Quickly add cards to your library.",sizes:{xs:"Add icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with collection tips."}},action_browse:{title:"Browse Sets",component:t=>i.jsx(Tv,{...t,actionType:"browse_sets"}),description:"Explore card sets and expansions.",sizes:{xs:"Search icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with latest set spotlight."}},action_wishlist:{title:"Wishlist",component:t=>i.jsx(Tv,{...t,actionType:"wishlist"}),description:"Access your hunting list for new cards.",sizes:{xs:"Heart icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with total wishlist value."}},action_tournaments:{title:"Tournaments",component:t=>i.jsx(Tv,{...t,actionType:"tournaments"}),description:"Check upcoming events and pairings.",sizes:{xs:"Trophy icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with active pairings count."}},recent_decks:{title:"Recent Decks",component:AEe,description:"Quick access to your latest deck projects.",sizes:{xs:"Last active deck name.",small:"Commander art for the latest deck.",medium:"Last two decks with color identities.",large:"Triple deck spread with mini-summaries.",xlarge:"Full chronological deck feed."}},system_status:{title:"System Status",component:s6e,description:"Real-time health pulse of the forge.",sizes:{xs:"Simple status dot.",small:"Current uptime percentage.",medium:"Detailed service status.",large:"Full system health dashboard."}},subscription:{title:"Subscription",component:LEe,description:"Manage your membership and perks.",sizes:{xs:"Tier logo pill.",small:"Current plan summary.",medium:"Plan features and renewal date.",large:"Full tier comparison and billing."}},community:{title:"My Pods",component:OEe,description:"Stay connected with your local playgroups.",sizes:{xs:"Member count pill.",small:"Active friends avatars.",medium:"Recent group activity feed.",large:"Post to pod wall / social hub.",xlarge:"Full community management center."}},social_stats:{title:"Social Battery",component:ZAe,description:"Monitor your engagement and shared assets.",sizes:{xs:"Battery percentage pill.",small:"Standard social gauge.",medium:"Share counts and feedback analytics.",large:"Detailed audience insights."}},audit:{title:"Collection Audit",component:e6e,description:"Verify your digital collection against physical cards.",sizes:{xs:"Current audit progress %.",small:"Next item in audit queue.",medium:"Audit stats and mismatch count.",large:"Detailed audit results and resume info.",xlarge:"Grand overview of collection integrity."}},tips:{title:"Forge Tips",component:MEe,description:"Pro tips for mastering the forge.",sizes:{xs:"Tip icon pill.",small:"One random pro tip.",medium:"Daily pro trick with icons.",large:"Top 3 tips for your current tier."}},releases:{title:"New Sets",component:JAe,description:"Incoming card sets and set reviews.",sizes:{xs:"Release date pill.",small:"Latest set name.",medium:"Next 3 releases with dates.",large:"Detailed set review feed."}},guides:{title:"Guides & Resources",component:i6e,description:"Learn how to brew better decks.",sizes:{xs:"Book icon pill.",small:"Featured guide link.",medium:"Top 3 reading recommendations.",large:"Full resource library access."}},action_log:{title:"Session History",component:t6e,description:"Track your recent deck edits and actions.",sizes:{xs:"Last action pill.",small:"Scrollable list of recent actions.",medium:"Extended list with timestamps.",large:"Full session log with analysis.",xlarge:"Detailed history timeline."}},trade_matches:{title:"Trade Alerts",component:r6e,description:"Notifications for automated trade matches in your Pod.",sizes:{xs:"Pill with match count.",small:"Standard widget with count and label.",medium:"Detailed alert box.",large:"Expanded match list preview.",xlarge:"Full trade hub integration."}}},a6e=({id:t,onAdd:e})=>{const r=u2[t];return i.jsx(dy,{as:"div",className:"mb-2",children:({open:n})=>i.jsxs("div",{className:"group",children:[i.jsxs("div",{className:"relative flex items-center justify-between p-3 rounded-xl border border-white/5 bg-gray-900/60 hover:bg-gray-800/80 shadow-sm transition-all",children:[i.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[i.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),i.jsx("span",{className:"text-[11px] font-black text-gray-200 uppercase tracking-widest truncate",children:r.title})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>e(t),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-all hover:scale-105 active:scale-95",children:"Add"}),i.jsx(dy.Button,{className:"p-1.5 rounded-lg text-gray-500 hover:text-white hover:bg-white/5 transition-all",children:i.jsx("svg",{className:`w-3.5 h-3.5 transition-transform duration-300 ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),i.jsx(gf,{show:n,enter:"transition-all duration-300 ease-out",enterFrom:"opacity-0 max-h-0",enterTo:"opacity-100 max-h-[500px]",leave:"transition-all duration-200 ease-in",leaveFrom:"opacity-100 max-h-[500px]",leaveTo:"opacity-0 max-h-0",children:i.jsxs(dy.Panel,{className:"px-4 py-3 mt-1 bg-gray-950/40 rounded-xl border border-white/5 text-[10px] space-y-3",children:[i.jsx("p",{className:"text-gray-400 font-medium italic leading-relaxed",children:r.description}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-[9px] font-black text-indigo-400/80 uppercase tracking-tighter",children:"Size Specifics"}),Object.entries(r.sizes||{}).map(([s,a])=>i.jsxs("div",{className:"flex gap-2 p-1.5 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[i.jsx("span",{className:"text-gray-300 font-black uppercase w-10 shrink-0 tracking-tighter",children:s}),i.jsx("span",{className:"text-gray-500 leading-tight",children:a})]},s))]})]})})]})})},o6e=({layout:t,isOpen:e,onClose:r,onAddWidget:n})=>{const s=new Set(t.grid||[]),a=Object.keys(u2).filter(o=>!s.has(o));return i.jsx(gf,{show:e,enter:"transition-transform duration-500 ease-out",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition-transform duration-300 ease-in",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",className:"fixed top-0 right-0 h-full w-80 z-[100] border-l border-white/10 shadow-2xl",children:i.jsxs("div",{className:"h-full bg-gray-950/80 backdrop-blur-2xl flex flex-col",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-sm font-black text-white uppercase tracking-[0.2em]",children:"Forge Library"}),i.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1",children:"CLICK ADD TO USE WIDGETS"})]}),i.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-white hover:bg-white/5 rounded-xl transition-all",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 custom-scrollbar",children:a.length===0?i.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40 p-8",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),i.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Library Empty"}),i.jsx("p",{className:"text-[10px] text-gray-600 mt-2 italic",children:"All available widgets are currently on your dashboard."})]}):a.map(o=>i.jsx(a6e,{id:o,onAdd:n},o))}),i.jsx("div",{className:"p-6 bg-indigo-600/5 mt-auto border-t border-white/5",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/20 text-indigo-400",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-[11px] font-bold text-indigo-200",children:"Pro Tip"}),i.jsx("p",{className:"text-[10px] text-indigo-400/70 leading-relaxed mt-1",children:"Widgets snap to the 12-column grid. Try placing smaller ones next to larger ones to auto-stack."})]})]})})]})})},ise=({isOpen:t,onClose:e,onConfirm:r,title:n,message:s,targetName:a})=>{const[o,l]=b.useState(""),c=o.toUpperCase()==="DELETE";return t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-red-500/50 rounded-2xl max-w-md w-full p-6 shadow-2xl shadow-red-900/20 transform transition-all scale-100",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center border border-red-500/50",children:i.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:n||"Confirm Deletion"}),i.jsx("p",{className:"text-red-400 text-sm font-medium",children:"This action cannot be undone."})]})]}),i.jsxs("div",{className:"space-y-4 mb-6",children:[i.jsx("p",{className:"text-gray-300 leading-relaxed",children:s}),a&&i.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[i.jsx("span",{className:"text-red-200 text-sm",children:"Target: "}),i.jsx("span",{className:"text-white font-mono font-bold",children:a})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:["Type ",i.jsx("span",{className:"text-white font-mono",children:"DELETE"})," to confirm"]}),i.jsx("input",{type:"text",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-colors font-mono",placeholder:"DELETE",value:o,onChange:u=>l(u.target.value)})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-xl transition-colors",children:"Cancel"}),i.jsx("button",{onClick:r,disabled:!c,className:`flex-1 px-4 py-3 font-bold rounded-xl transition-all shadow-lg ${c?"bg-red-600 hover:bg-red-500 text-white shadow-red-900/30":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Delete Forever"})]})]})}):null},l6e=({isOpen:t,onClose:e,onImport:r})=>{const[n,s]=b.useState(""),[a,o]=b.useState(""),[l,c]=b.useState("");if(b.useEffect(()=>{t||(s(""),o(""),c(""))},[t]),!t)return null;const u=()=>{if(!n.trim())return c("Please enter a layout name");if(!a.trim())return c("Please paste the layout code");try{if(!a.startsWith("ey"))throw new Error;r(n,a),e()}catch{c("Invalid layout code format")}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Import Layout"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Name"}),i.jsx("input",{value:n,onChange:h=>s(h.target.value),placeholder:"My Awesome Layout",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none",autoFocus:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Code"}),i.jsx("textarea",{value:a,onChange:h=>o(h.target.value),placeholder:"Paste the base64 code here...",className:"w-full h-32 bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white font-mono text-xs placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none resize-none"})]}),l&&i.jsx("p",{className:"text-red-400 text-sm",children:l}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors",children:"Cancel"}),i.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-colors shadow-lg shadow-indigo-500/20",children:"Import"})]})]})]})})},c6e=({isOpen:t,onClose:e,layoutCode:r,layoutName:n})=>{const[s,a]=b.useState(!1);if(!t)return null;const o=()=>{navigator.clipboard.writeText(r),a(!0),setTimeout(()=>a(!1),2e3)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"Share Layout"}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:"text-sm text-gray-300",children:["Copy the code below to share ",i.jsxs("strong",{children:['"',n,'"']})," with others."]}),i.jsx("div",{className:"relative",children:i.jsx("textarea",{readOnly:!0,value:r,className:"w-full h-32 bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-indigo-300 font-mono text-xs focus:border-indigo-500 outline-none resize-none",onClick:l=>l.target.select()})}),i.jsx("button",{onClick:o,className:`w-full py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${s?"bg-green-600 text-white":"bg-indigo-600 hover:bg-indigo-500 text-white"}`,children:s?i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Copy Code"]})})]})]})})},u6e=({isOpen:t,onClose:e,onSave:r})=>{const[n,s]=b.useState(""),[a,o]=b.useState("");return b.useEffect(()=>{t||(s(""),o(""))},[t]),t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Save Layout"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Layout Name"}),i.jsx("input",{value:n,onChange:l=>s(l.target.value),placeholder:"e.g. Commander Focus",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none",autoFocus:!0,onKeyDown:l=>{l.key==="Enter"&&n.trim()&&(r(n),e())}})]}),a&&i.jsx("p",{className:"text-red-400 text-sm",children:a}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors",children:"Cancel"}),i.jsx("button",{onClick:()=>{if(!n.trim())return o("Please enter a name");r(n),e()},className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-colors shadow-lg shadow-indigo-500/20",children:"Save"})]})]})]})}):null};var ase=typeof global=="object"&&global&&global.Object===Object&&global,d6e=typeof self=="object"&&self&&self.Object===Object&&self,Nh=ase||d6e||Function("return this")(),fp=Nh.Symbol,ose=Object.prototype,h6e=ose.hasOwnProperty,f6e=ose.toString,Iv=fp?fp.toStringTag:void 0;function p6e(t){var e=h6e.call(t,Iv),r=t[Iv];try{t[Iv]=void 0;var n=!0}catch{}var s=f6e.call(t);return n&&(e?t[Iv]=r:delete t[Iv]),s}var m6e=Object.prototype,g6e=m6e.toString;function x6e(t){return g6e.call(t)}var y6e="[object Null]",b6e="[object Undefined]",Iz=fp?fp.toStringTag:void 0;function xb(t){return t==null?t===void 0?b6e:y6e:Iz&&Iz in Object(t)?p6e(t):x6e(t)}function _f(t){return t!=null&&typeof t=="object"}var Jm=Array.isArray;function Np(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function lse(t){return t}var v6e="[object AsyncFunction]",w6e="[object Function]",N6e="[object GeneratorFunction]",j6e="[object Proxy]";function ZO(t){if(!Np(t))return!1;var e=xb(t);return e==w6e||e==N6e||e==v6e||e==j6e}var JE=Nh["__core-js_shared__"],Pz=(function(){var t=/[^.]+$/.exec(JE&&JE.keys&&JE.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function k6e(t){return!!Pz&&Pz in t}var _6e=Function.prototype,S6e=_6e.toString;function Ng(t){if(t!=null){try{return S6e.call(t)}catch{}try{return t+""}catch{}}return""}var C6e=/[\\^$.*+?()[\]{}|]/g,E6e=/^\[object .+?Constructor\]$/,A6e=Function.prototype,T6e=Object.prototype,I6e=A6e.toString,P6e=T6e.hasOwnProperty,L6e=RegExp("^"+I6e.call(P6e).replace(C6e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function O6e(t){if(!Np(t)||k6e(t))return!1;var e=ZO(t)?L6e:E6e;return e.test(Ng(t))}function M6e(t,e){return t?.[e]}function jg(t,e){var r=M6e(t,e);return O6e(r)?r:void 0}var i8=jg(Nh,"WeakMap"),Lz=Object.create,R6e=(function(){function t(){}return function(e){if(!Np(e))return{};if(Lz)return Lz(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function D6e(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function B6e(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var F6e=800,$6e=16,U6e=Date.now;function z6e(t){var e=0,r=0;return function(){var n=U6e(),s=$6e-(n-r);if(r=n,s>0){if(++e>=F6e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function V6e(t){return function(){return t}}var z4=(function(){try{var t=jg(Object,"defineProperty");return t({},"",{}),t}catch{}})(),q6e=z4?function(t,e){return z4(t,"toString",{configurable:!0,enumerable:!1,value:V6e(e),writable:!0})}:lse,H6e=z6e(q6e);function W6e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var G6e=9007199254740991,K6e=/^(?:0|[1-9]\d*)$/;function cse(t,e){var r=typeof t;return e=e??G6e,!!e&&(r=="number"||r!="symbol"&&K6e.test(t))&&t>-1&&t%1==0&&t<e}function eM(t,e,r){e=="__proto__"&&z4?z4(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function mw(t,e){return t===e||t!==t&&e!==e}var Y6e=Object.prototype,X6e=Y6e.hasOwnProperty;function use(t,e,r){var n=t[e];(!(X6e.call(t,e)&&mw(n,r))||r===void 0&&!(e in t))&&eM(t,e,r)}function Q6e(t,e,r,n){var s=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var l=e[a],c=void 0;c===void 0&&(c=t[l]),s?eM(r,l,c):use(r,l,c)}return r}var Oz=Math.max;function J6e(t,e,r){return e=Oz(e===void 0?t.length-1:e,0),function(){for(var n=arguments,s=-1,a=Oz(n.length-e,0),o=Array(a);++s<a;)o[s]=n[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=n[s];return l[e]=r(o),D6e(t,this,l)}}function Z6e(t,e){return H6e(J6e(t,e,lse),t+"")}var eTe=9007199254740991;function dse(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=eTe}function iS(t){return t!=null&&dse(t.length)&&!ZO(t)}function tTe(t,e,r){if(!Np(r))return!1;var n=typeof e;return(n=="number"?iS(r)&&cse(e,r.length):n=="string"&&e in r)?mw(r[e],t):!1}function rTe(t){return Z6e(function(e,r){var n=-1,s=r.length,a=s>1?r[s-1]:void 0,o=s>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(s--,a):void 0,o&&tTe(r[0],r[1],o)&&(a=s<3?void 0:a,s=1),e=Object(e);++n<s;){var l=r[n];l&&t(e,l,n,a)}return e})}var nTe=Object.prototype;function tM(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||nTe;return t===r}function sTe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var iTe="[object Arguments]";function Mz(t){return _f(t)&&xb(t)==iTe}var hse=Object.prototype,aTe=hse.hasOwnProperty,oTe=hse.propertyIsEnumerable,a8=Mz((function(){return arguments})())?Mz:function(t){return _f(t)&&aTe.call(t,"callee")&&!oTe.call(t,"callee")};function lTe(){return!1}var fse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rz=fse&&typeof module=="object"&&module&&!module.nodeType&&module,cTe=Rz&&Rz.exports===fse,Dz=cTe?Nh.Buffer:void 0,uTe=Dz?Dz.isBuffer:void 0,d2=uTe||lTe,dTe="[object Arguments]",hTe="[object Array]",fTe="[object Boolean]",pTe="[object Date]",mTe="[object Error]",gTe="[object Function]",xTe="[object Map]",yTe="[object Number]",bTe="[object Object]",vTe="[object RegExp]",wTe="[object Set]",NTe="[object String]",jTe="[object WeakMap]",kTe="[object ArrayBuffer]",_Te="[object DataView]",STe="[object Float32Array]",CTe="[object Float64Array]",ETe="[object Int8Array]",ATe="[object Int16Array]",TTe="[object Int32Array]",ITe="[object Uint8Array]",PTe="[object Uint8ClampedArray]",LTe="[object Uint16Array]",OTe="[object Uint32Array]",ai={};ai[STe]=ai[CTe]=ai[ETe]=ai[ATe]=ai[TTe]=ai[ITe]=ai[PTe]=ai[LTe]=ai[OTe]=!0;ai[dTe]=ai[hTe]=ai[kTe]=ai[fTe]=ai[_Te]=ai[pTe]=ai[mTe]=ai[gTe]=ai[xTe]=ai[yTe]=ai[bTe]=ai[vTe]=ai[wTe]=ai[NTe]=ai[jTe]=!1;function MTe(t){return _f(t)&&dse(t.length)&&!!ai[xb(t)]}function rM(t){return function(e){return t(e)}}var pse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,I1=pse&&typeof module=="object"&&module&&!module.nodeType&&module,RTe=I1&&I1.exports===pse,ZE=RTe&&ase.process,Hy=(function(){try{var t=I1&&I1.require&&I1.require("util").types;return t||ZE&&ZE.binding&&ZE.binding("util")}catch{}})(),Bz=Hy&&Hy.isTypedArray,nM=Bz?rM(Bz):MTe,DTe=Object.prototype,BTe=DTe.hasOwnProperty;function mse(t,e){var r=Jm(t),n=!r&&a8(t),s=!r&&!n&&d2(t),a=!r&&!n&&!s&&nM(t),o=r||n||s||a,l=o?sTe(t.length,String):[],c=l.length;for(var u in t)(e||BTe.call(t,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||cse(u,c)))&&l.push(u);return l}function gse(t,e){return function(r){return t(e(r))}}var FTe=gse(Object.keys,Object),$Te=Object.prototype,UTe=$Te.hasOwnProperty;function zTe(t){if(!tM(t))return FTe(t);var e=[];for(var r in Object(t))UTe.call(t,r)&&r!="constructor"&&e.push(r);return e}function VTe(t){return iS(t)?mse(t):zTe(t)}function qTe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var HTe=Object.prototype,WTe=HTe.hasOwnProperty;function GTe(t){if(!Np(t))return qTe(t);var e=tM(t),r=[];for(var n in t)n=="constructor"&&(e||!WTe.call(t,n))||r.push(n);return r}function xse(t){return iS(t)?mse(t,!0):GTe(t)}var h2=jg(Object,"create");function KTe(){this.__data__=h2?h2(null):{},this.size=0}function YTe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var XTe="__lodash_hash_undefined__",QTe=Object.prototype,JTe=QTe.hasOwnProperty;function ZTe(t){var e=this.__data__;if(h2){var r=e[t];return r===XTe?void 0:r}return JTe.call(e,t)?e[t]:void 0}var eIe=Object.prototype,tIe=eIe.hasOwnProperty;function rIe(t){var e=this.__data__;return h2?e[t]!==void 0:tIe.call(e,t)}var nIe="__lodash_hash_undefined__";function sIe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=h2&&e===void 0?nIe:e,this}function Zm(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Zm.prototype.clear=KTe;Zm.prototype.delete=YTe;Zm.prototype.get=ZTe;Zm.prototype.has=rIe;Zm.prototype.set=sIe;function iIe(){this.__data__=[],this.size=0}function aS(t,e){for(var r=t.length;r--;)if(mw(t[r][0],e))return r;return-1}var aIe=Array.prototype,oIe=aIe.splice;function lIe(t){var e=this.__data__,r=aS(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():oIe.call(e,r,1),--this.size,!0}function cIe(t){var e=this.__data__,r=aS(e,t);return r<0?void 0:e[r][1]}function uIe(t){return aS(this.__data__,t)>-1}function dIe(t,e){var r=this.__data__,n=aS(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function $f(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$f.prototype.clear=iIe;$f.prototype.delete=lIe;$f.prototype.get=cIe;$f.prototype.has=uIe;$f.prototype.set=dIe;var f2=jg(Nh,"Map");function hIe(){this.size=0,this.__data__={hash:new Zm,map:new(f2||$f),string:new Zm}}function fIe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function oS(t,e){var r=t.__data__;return fIe(e)?r[typeof e=="string"?"string":"hash"]:r.map}function pIe(t){var e=oS(this,t).delete(t);return this.size-=e?1:0,e}function mIe(t){return oS(this,t).get(t)}function gIe(t){return oS(this,t).has(t)}function xIe(t,e){var r=oS(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function kg(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}kg.prototype.clear=hIe;kg.prototype.delete=pIe;kg.prototype.get=mIe;kg.prototype.has=gIe;kg.prototype.set=xIe;function yIe(t,e){for(var r=-1,n=e.length,s=t.length;++r<n;)t[s+r]=e[r];return t}var yse=gse(Object.getPrototypeOf,Object),bIe="[object Object]",vIe=Function.prototype,wIe=Object.prototype,bse=vIe.toString,NIe=wIe.hasOwnProperty,jIe=bse.call(Object);function kIe(t){if(!_f(t)||xb(t)!=bIe)return!1;var e=yse(t);if(e===null)return!0;var r=NIe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&bse.call(r)==jIe}function _Ie(){this.__data__=new $f,this.size=0}function SIe(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function CIe(t){return this.__data__.get(t)}function EIe(t){return this.__data__.has(t)}var AIe=200;function TIe(t,e){var r=this.__data__;if(r instanceof $f){var n=r.__data__;if(!f2||n.length<AIe-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new kg(n)}return r.set(t,e),this.size=r.size,this}function ah(t){var e=this.__data__=new $f(t);this.size=e.size}ah.prototype.clear=_Ie;ah.prototype.delete=SIe;ah.prototype.get=CIe;ah.prototype.has=EIe;ah.prototype.set=TIe;var vse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Fz=vse&&typeof module=="object"&&module&&!module.nodeType&&module,IIe=Fz&&Fz.exports===vse,$z=IIe?Nh.Buffer:void 0,Uz=$z?$z.allocUnsafe:void 0;function wse(t,e){if(e)return t.slice();var r=t.length,n=Uz?Uz(r):new t.constructor(r);return t.copy(n),n}function PIe(t,e){for(var r=-1,n=t==null?0:t.length,s=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[s++]=o)}return a}function LIe(){return[]}var OIe=Object.prototype,MIe=OIe.propertyIsEnumerable,zz=Object.getOwnPropertySymbols,RIe=zz?function(t){return t==null?[]:(t=Object(t),PIe(zz(t),function(e){return MIe.call(t,e)}))}:LIe;function DIe(t,e,r){var n=e(t);return Jm(t)?n:yIe(n,r(t))}function o8(t){return DIe(t,VTe,RIe)}var l8=jg(Nh,"DataView"),c8=jg(Nh,"Promise"),u8=jg(Nh,"Set"),Vz="[object Map]",BIe="[object Object]",qz="[object Promise]",Hz="[object Set]",Wz="[object WeakMap]",Gz="[object DataView]",FIe=Ng(l8),$Ie=Ng(f2),UIe=Ng(c8),zIe=Ng(u8),VIe=Ng(i8),Ku=xb;(l8&&Ku(new l8(new ArrayBuffer(1)))!=Gz||f2&&Ku(new f2)!=Vz||c8&&Ku(c8.resolve())!=qz||u8&&Ku(new u8)!=Hz||i8&&Ku(new i8)!=Wz)&&(Ku=function(t){var e=xb(t),r=e==BIe?t.constructor:void 0,n=r?Ng(r):"";if(n)switch(n){case FIe:return Gz;case $Ie:return Vz;case UIe:return qz;case zIe:return Hz;case VIe:return Wz}return e});var qIe=Object.prototype,HIe=qIe.hasOwnProperty;function WIe(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&HIe.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var V4=Nh.Uint8Array;function sM(t){var e=new t.constructor(t.byteLength);return new V4(e).set(new V4(t)),e}function GIe(t,e){var r=sM(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var KIe=/\w*$/;function YIe(t){var e=new t.constructor(t.source,KIe.exec(t));return e.lastIndex=t.lastIndex,e}var Kz=fp?fp.prototype:void 0,Yz=Kz?Kz.valueOf:void 0;function XIe(t){return Yz?Object(Yz.call(t)):{}}function Nse(t,e){var r=e?sM(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var QIe="[object Boolean]",JIe="[object Date]",ZIe="[object Map]",e8e="[object Number]",t8e="[object RegExp]",r8e="[object Set]",n8e="[object String]",s8e="[object Symbol]",i8e="[object ArrayBuffer]",a8e="[object DataView]",o8e="[object Float32Array]",l8e="[object Float64Array]",c8e="[object Int8Array]",u8e="[object Int16Array]",d8e="[object Int32Array]",h8e="[object Uint8Array]",f8e="[object Uint8ClampedArray]",p8e="[object Uint16Array]",m8e="[object Uint32Array]";function g8e(t,e,r){var n=t.constructor;switch(e){case i8e:return sM(t);case QIe:case JIe:return new n(+t);case a8e:return GIe(t);case o8e:case l8e:case c8e:case u8e:case d8e:case h8e:case f8e:case p8e:case m8e:return Nse(t,r);case ZIe:return new n;case e8e:case n8e:return new n(t);case t8e:return YIe(t);case r8e:return new n;case s8e:return XIe(t)}}function jse(t){return typeof t.constructor=="function"&&!tM(t)?R6e(yse(t)):{}}var x8e="[object Map]";function y8e(t){return _f(t)&&Ku(t)==x8e}var Xz=Hy&&Hy.isMap,b8e=Xz?rM(Xz):y8e,v8e="[object Set]";function w8e(t){return _f(t)&&Ku(t)==v8e}var Qz=Hy&&Hy.isSet,N8e=Qz?rM(Qz):w8e,j8e=1,kse="[object Arguments]",k8e="[object Array]",_8e="[object Boolean]",S8e="[object Date]",C8e="[object Error]",_se="[object Function]",E8e="[object GeneratorFunction]",A8e="[object Map]",T8e="[object Number]",Sse="[object Object]",I8e="[object RegExp]",P8e="[object Set]",L8e="[object String]",O8e="[object Symbol]",M8e="[object WeakMap]",R8e="[object ArrayBuffer]",D8e="[object DataView]",B8e="[object Float32Array]",F8e="[object Float64Array]",$8e="[object Int8Array]",U8e="[object Int16Array]",z8e="[object Int32Array]",V8e="[object Uint8Array]",q8e="[object Uint8ClampedArray]",H8e="[object Uint16Array]",W8e="[object Uint32Array]",Qs={};Qs[kse]=Qs[k8e]=Qs[R8e]=Qs[D8e]=Qs[_8e]=Qs[S8e]=Qs[B8e]=Qs[F8e]=Qs[$8e]=Qs[U8e]=Qs[z8e]=Qs[A8e]=Qs[T8e]=Qs[Sse]=Qs[I8e]=Qs[P8e]=Qs[L8e]=Qs[O8e]=Qs[V8e]=Qs[q8e]=Qs[H8e]=Qs[W8e]=!0;Qs[C8e]=Qs[_se]=Qs[M8e]=!1;function Tj(t,e,r,n,s,a){var o,l=e&j8e;if(o!==void 0)return o;if(!Np(t))return t;var c=Jm(t);if(c)o=WIe(t);else{var u=Ku(t),h=u==_se||u==E8e;if(d2(t))return wse(t,l);if(u==Sse||u==kse||h&&!s)o=h?{}:jse(t);else{if(!Qs[u])return s?t:{};o=g8e(t,u,l)}}a||(a=new ah);var f=a.get(t);if(f)return f;a.set(t,o),N8e(t)?t.forEach(function(y){o.add(Tj(y,e,r,y,t,a))}):b8e(t)&&t.forEach(function(y,v){o.set(v,Tj(y,e,r,v,t,a))});var m=o8,g=c?void 0:m(t);return W6e(g||t,function(y,v){g&&(v=y,y=t[v]),use(o,v,Tj(y,e,r,v,t,a))}),o}var G8e=1,K8e=4;function py(t){return Tj(t,G8e|K8e)}var Y8e="__lodash_hash_undefined__";function X8e(t){return this.__data__.set(t,Y8e),this}function Q8e(t){return this.__data__.has(t)}function q4(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new kg;++e<r;)this.add(t[e])}q4.prototype.add=q4.prototype.push=X8e;q4.prototype.has=Q8e;function J8e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Z8e(t,e){return t.has(e)}var ePe=1,tPe=2;function Cse(t,e,r,n,s,a){var o=r&ePe,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var u=a.get(t),h=a.get(e);if(u&&h)return u==e&&h==t;var f=-1,m=!0,g=r&tPe?new q4:void 0;for(a.set(t,e),a.set(e,t);++f<l;){var y=t[f],v=e[f];if(n)var w=o?n(v,y,f,e,t,a):n(y,v,f,t,e,a);if(w!==void 0){if(w)continue;m=!1;break}if(g){if(!J8e(e,function(N,k){if(!Z8e(g,k)&&(y===N||s(y,N,r,n,a)))return g.push(k)})){m=!1;break}}else if(!(y===v||s(y,v,r,n,a))){m=!1;break}}return a.delete(t),a.delete(e),m}function rPe(t){var e=-1,r=Array(t.size);return t.forEach(function(n,s){r[++e]=[s,n]}),r}function nPe(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var sPe=1,iPe=2,aPe="[object Boolean]",oPe="[object Date]",lPe="[object Error]",cPe="[object Map]",uPe="[object Number]",dPe="[object RegExp]",hPe="[object Set]",fPe="[object String]",pPe="[object Symbol]",mPe="[object ArrayBuffer]",gPe="[object DataView]",Jz=fp?fp.prototype:void 0,eA=Jz?Jz.valueOf:void 0;function xPe(t,e,r,n,s,a,o){switch(r){case gPe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case mPe:return!(t.byteLength!=e.byteLength||!a(new V4(t),new V4(e)));case aPe:case oPe:case uPe:return mw(+t,+e);case lPe:return t.name==e.name&&t.message==e.message;case dPe:case fPe:return t==e+"";case cPe:var l=rPe;case hPe:var c=n&sPe;if(l||(l=nPe),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;n|=iPe,o.set(t,e);var h=Cse(l(t),l(e),n,s,a,o);return o.delete(t),h;case pPe:if(eA)return eA.call(t)==eA.call(e)}return!1}var yPe=1,bPe=Object.prototype,vPe=bPe.hasOwnProperty;function wPe(t,e,r,n,s,a){var o=r&yPe,l=o8(t),c=l.length,u=o8(e),h=u.length;if(c!=h&&!o)return!1;for(var f=c;f--;){var m=l[f];if(!(o?m in e:vPe.call(e,m)))return!1}var g=a.get(t),y=a.get(e);if(g&&y)return g==e&&y==t;var v=!0;a.set(t,e),a.set(e,t);for(var w=o;++f<c;){m=l[f];var N=t[m],k=e[m];if(n)var C=o?n(k,N,m,e,t,a):n(N,k,m,t,e,a);if(!(C===void 0?N===k||s(N,k,r,n,a):C)){v=!1;break}w||(w=m=="constructor")}if(v&&!w){var I=t.constructor,O=e.constructor;I!=O&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof O=="function"&&O instanceof O)&&(v=!1)}return a.delete(t),a.delete(e),v}var NPe=1,Zz="[object Arguments]",eV="[object Array]",lN="[object Object]",jPe=Object.prototype,tV=jPe.hasOwnProperty;function kPe(t,e,r,n,s,a){var o=Jm(t),l=Jm(e),c=o?eV:Ku(t),u=l?eV:Ku(e);c=c==Zz?lN:c,u=u==Zz?lN:u;var h=c==lN,f=u==lN,m=c==u;if(m&&d2(t)){if(!d2(e))return!1;o=!0,h=!1}if(m&&!h)return a||(a=new ah),o||nM(t)?Cse(t,e,r,n,s,a):xPe(t,e,c,r,n,s,a);if(!(r&NPe)){var g=h&&tV.call(t,"__wrapped__"),y=f&&tV.call(e,"__wrapped__");if(g||y){var v=g?t.value():t,w=y?e.value():e;return a||(a=new ah),s(v,w,r,n,a)}}return m?(a||(a=new ah),wPe(t,e,r,n,s,a)):!1}function Ese(t,e,r,n,s){return t===e?!0:t==null||e==null||!_f(t)&&!_f(e)?t!==t&&e!==e:kPe(t,e,r,n,Ese,s)}function _Pe(t){return function(e,r,n){for(var s=-1,a=Object(e),o=n(e),l=o.length;l--;){var c=o[++s];if(r(a[c],c,a)===!1)break}return e}}var SPe=_Pe();function d8(t,e,r){(r!==void 0&&!mw(t[e],r)||r===void 0&&!(e in t))&&eM(t,e,r)}function CPe(t){return _f(t)&&iS(t)}function h8(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function EPe(t){return Q6e(t,xse(t))}function APe(t,e,r,n,s,a,o){var l=h8(t,r),c=h8(e,r),u=o.get(c);if(u){d8(t,r,u);return}var h=a?a(l,c,r+"",t,e,o):void 0,f=h===void 0;if(f){var m=Jm(c),g=!m&&d2(c),y=!m&&!g&&nM(c);h=c,m||g||y?Jm(l)?h=l:CPe(l)?h=B6e(l):g?(f=!1,h=wse(c,!0)):y?(f=!1,h=Nse(c,!0)):h=[]:kIe(c)||a8(c)?(h=l,a8(l)?h=EPe(l):(!Np(l)||ZO(l))&&(h=jse(c))):f=!1}f&&(o.set(c,h),s(h,c,n,a,o),o.delete(c)),d8(t,r,h)}function Ase(t,e,r,n,s){t!==e&&SPe(e,function(a,o){if(s||(s=new ah),Np(a))APe(t,e,o,r,Ase,n,s);else{var l=n?n(h8(t,o),a,o+"",t,e,s):void 0;l===void 0&&(l=a),d8(t,o,l)}},xse)}function z0(t,e){return Ese(t,e)}var sp=rTe(function(t,e,r){Ase(t,e,r)}),_r=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(_r||{});class fh{constructor(e,r,n={}){this.attrName=e,this.keyName=r;const s=_r.TYPE&_r.ATTRIBUTE;this.scope=n.scope!=null?n.scope&_r.LEVEL|s:_r.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(e){return Array.from(e.attributes).map(r=>r.name)}add(e,r){return this.canAdd(e,r)?(e.setAttribute(this.keyName,r),!0):!1}canAdd(e,r){return this.whitelist==null?!0:typeof r=="string"?this.whitelist.indexOf(r.replace(/["']/g,""))>-1:this.whitelist.indexOf(r)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const r=e.getAttribute(this.keyName);return this.canAdd(e,r)&&r?r:""}}class my extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const Tse=class f8{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,r=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(r){let n=null;try{n=e.parentNode}catch{return null}return this.find(n,r)}return null}create(e,r,n){const s=this.query(r);if(s==null)throw new my(`Unable to create ${r} blot`);const a=s,o=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:a.create(n),l=new a(e,o,n);return f8.blots.set(l.domNode,l),l}find(e,r=!1){return f8.find(e,r)}query(e,r=_r.ANY){let n;return typeof e=="string"?n=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?n=this.types.text:typeof e=="number"?e&_r.LEVEL&_r.BLOCK?n=this.types.block:e&_r.LEVEL&_r.INLINE&&(n=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(s=>(n=this.classes[s],!!n)),n=n||this.tags[e.tagName]),n==null?null:"scope"in n&&r&_r.LEVEL&n.scope&&r&_r.TYPE&n.scope?n:null}register(...e){return e.map(r=>{const n="blotName"in r,s="attrName"in r;if(!n&&!s)throw new my("Invalid definition");if(n&&r.blotName==="abstract")throw new my("Cannot register abstract class");const a=n?r.blotName:s?r.attrName:void 0;return this.types[a]=r,s?typeof r.keyName=="string"&&(this.attributes[r.keyName]=r):n&&(r.className&&(this.classes[r.className]=r),r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map(o=>o.toUpperCase()):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach(o=>{(this.tags[o]==null||r.className==null)&&(this.tags[o]=r)}))),r})}};Tse.blots=new WeakMap;let Wy=Tse;function rV(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter(r=>r.indexOf(`${e}-`)===0)}class TPe extends fh{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(r=>r.split("-").slice(0,-1).join("-"))}add(e,r){return this.canAdd(e,r)?(this.remove(e),e.classList.add(`${this.keyName}-${r}`),!0):!1}remove(e){rV(e,this.keyName).forEach(r=>{e.classList.remove(r)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const r=(rV(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,r)?r:""}}const bd=TPe;function tA(t){const e=t.split("-"),r=e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return e[0]+r}class IPe extends fh{static keys(e){return(e.getAttribute("style")||"").split(";").map(r=>r.split(":")[0].trim())}add(e,r){return this.canAdd(e,r)?(e.style[tA(this.keyName)]=r,!0):!1}remove(e){e.style[tA(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const r=e.style[tA(this.keyName)];return this.canAdd(e,r)?r:""}}const jp=IPe;class PPe{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,r){r?e.add(this.domNode,r)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Wy.find(this.domNode);if(e==null)return;const r=fh.keys(this.domNode),n=bd.keys(this.domNode),s=jp.keys(this.domNode);r.concat(n).concat(s).forEach(a=>{const o=e.scroll.query(a,_r.ATTRIBUTE);o instanceof fh&&(this.attributes[o.attrName]=o)})}copy(e){Object.keys(this.attributes).forEach(r=>{const n=this.attributes[r].value(this.domNode);e.format(r,n)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(r=>{this.attributes[r].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,r)=>(e[r]=this.attributes[r].value(this.domNode),e),{})}}const lS=PPe,Ise=class{constructor(e,r){this.scroll=e,this.domNode=r,Wy.blots.set(r,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new my("Blot definition missing tagName");let r,n;return Array.isArray(this.tagName)?(typeof e=="string"?(n=e.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof e=="number"&&(n=e),typeof n=="number"?r=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?r=document.createElement(n):r=document.createElement(this.tagName[0])):r=document.createElement(this.tagName),this.className&&r.classList.add(this.className),r}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),Wy.blots.delete(this.domNode)}deleteAt(e,r){this.isolate(e,r).remove()}formatAt(e,r,n,s){const a=this.isolate(e,r);if(this.scroll.query(n,_r.BLOT)!=null&&s)a.wrap(n,s);else if(this.scroll.query(n,_r.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);a.wrap(o),o.format(n,s)}}insertAt(e,r,n){const s=n==null?this.scroll.create("text",r):this.scroll.create(r,n),a=this.split(e);this.parent.insertBefore(s,a||void 0)}isolate(e,r){const n=this.split(e);if(n==null)throw new Error("Attempt to isolate at end");return n.split(r),n}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(e,r){return e===0?this:this.next}update(e,r){}wrap(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new my(`Cannot wrap ${e}`);return n.appendChild(this),n}};Ise.blotName="abstract";let Pse=Ise;const Lse=class extends Pse{static value(e){return!0}index(e,r){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(r,1):-1}position(e,r){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Lse.scope=_r.INLINE_BLOT;let LPe=Lse;const ol=LPe;class OPe{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const r=e.slice(1);this.append(...r)}}at(e){const r=this.iterator();let n=r();for(;n&&e>0;)e-=1,n=r();return n}contains(e){const r=this.iterator();let n=r();for(;n;){if(n===e)return!0;n=r()}return!1}indexOf(e){const r=this.iterator();let n=r(),s=0;for(;n;){if(n===e)return s;s+=1,n=r()}return-1}insertBefore(e,r){e!=null&&(this.remove(e),e.next=r,r!=null?(e.prev=r.prev,r.prev!=null&&(r.prev.next=e),r.prev=e,r===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let r=0,n=this.head;for(;n!=null;){if(n===e)return r;r+=n.length(),n=n.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const r=e;return e!=null&&(e=e.next),r}}find(e,r=!1){const n=this.iterator();let s=n();for(;s;){const a=s.length();if(e<a||r&&e===a&&(s.next==null||s.next.length()!==0))return[s,e];e-=a,s=n()}return[null,0]}forEach(e){const r=this.iterator();let n=r();for(;n;)e(n),n=r()}forEachAt(e,r,n){if(r<=0)return;const[s,a]=this.find(e);let o=e-a;const l=this.iterator(s);let c=l();for(;c&&o<e+r;){const u=c.length();e>o?n(c,e-o,Math.min(r,o+u-e)):n(c,0,Math.min(u,e+r-o)),o+=u,c=l()}}map(e){return this.reduce((r,n)=>(r.push(e(n)),r),[])}reduce(e,r){const n=this.iterator();let s=n();for(;s;)r=e(r,s),s=n();return r}}function nV(t,e){const r=e.find(t);if(r)return r;try{return e.create(t)}catch{const n=e.create(_r.INLINE);return Array.from(t.childNodes).forEach(s=>{n.domNode.appendChild(s)}),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const Ose=class I0 extends Pse{constructor(e,r){super(e,r),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,I0.uiClass&&this.uiNode.classList.add(I0.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new OPe,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const r=nV(e,this.scroll);this.insertBefore(r,this.children.head||void 0)}catch(r){if(r instanceof my)return;throw r}})}deleteAt(e,r){if(e===0&&r===this.length())return this.remove();this.children.forEachAt(e,r,(n,s,a)=>{n.deleteAt(s,a)})}descendant(e,r=0){const[n,s]=this.children.find(r);return e.blotName==null&&e(n)||e.blotName!=null&&n instanceof e?[n,s]:n instanceof I0?n.descendant(e,s):[null,-1]}descendants(e,r=0,n=Number.MAX_VALUE){let s=[],a=n;return this.children.forEachAt(r,n,(o,l,c)=>{(e.blotName==null&&e(o)||e.blotName!=null&&o instanceof e)&&s.push(o),o instanceof I0&&(s=s.concat(o.descendants(e,l,a))),a-=c}),s}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(r=>{e||this.statics.allowedChildren.some(n=>r instanceof n)||(r.statics.scope===_r.BLOCK_BLOT?(r.next!=null&&this.splitAfter(r),r.prev!=null&&this.splitAfter(r.prev),r.parent.unwrap(),e=!0):r instanceof I0?r.unwrap():r.remove())})}formatAt(e,r,n,s){this.children.forEachAt(e,r,(a,o,l)=>{a.formatAt(o,l,n,s)})}insertAt(e,r,n){const[s,a]=this.children.find(e);if(s)s.insertAt(a,r,n);else{const o=n==null?this.scroll.create("text",r):this.scroll.create(r,n);this.appendChild(o)}}insertBefore(e,r){e.parent!=null&&e.parent.children.remove(e);let n=null;this.children.insertBefore(e,r||null),e.parent=this,r!=null&&(n=r.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(e.domNode,n),e.attach()}length(){return this.children.reduce((e,r)=>e+r.length(),0)}moveChildren(e,r){this.children.forEach(n=>{e.insertBefore(n,r)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r)}else this.remove()}path(e,r=!1){const[n,s]=this.children.find(e,r),a=[[this,e]];return n instanceof I0?a.concat(n.path(s,r)):(n!=null&&a.push([n,s]),a)}removeChild(e){this.children.remove(e)}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return n instanceof I0&&this.moveChildren(n),super.replaceWith(n)}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(e,this.length(),(s,a,o)=>{const l=s.split(a,r);l!=null&&n.appendChild(l)}),n}splitAfter(e){const r=this.clone();for(;e.next!=null;)r.appendChild(e.next);return this.parent&&this.parent.insertBefore(r,this.next||void 0),r}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,r){const n=[],s=[];e.forEach(a=>{a.target===this.domNode&&a.type==="childList"&&(n.push(...a.addedNodes),s.push(...a.removedNodes))}),s.forEach(a=>{if(a.parentNode!=null&&a.tagName!=="IFRAME"&&document.body.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(a);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),n.filter(a=>a.parentNode===this.domNode&&a!==this.uiNode).sort((a,o)=>a===o?0:a.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(a=>{let o=null;a.nextSibling!=null&&(o=this.scroll.find(a.nextSibling));const l=nV(a,this.scroll);(l.next!==o||l.next==null)&&(l.parent!=null&&l.parent.removeChild(this),this.insertBefore(l,o||void 0))}),this.enforceAllowedChildren()}};Ose.uiClass="";let MPe=Ose;const ad=MPe;function RPe(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}const Fx=class $x extends ad{static create(e){return super.create(e)}static formats(e,r){const n=r.query($x.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new lS(this.domNode)}format(e,r){if(e===this.statics.blotName&&!r)this.children.forEach(n=>{n instanceof $x||(n=n.wrap($x.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(e,_r.INLINE);if(n==null)return;n instanceof fh?this.attributes.attribute(n,r):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r)}}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,s){this.formats()[n]!=null||this.scroll.query(n,_r.ATTRIBUTE)?this.isolate(e,r).format(n,s):super.formatAt(e,r,n,s)}optimize(e){super.optimize(e);const r=this.formats();if(Object.keys(r).length===0)return this.unwrap();const n=this.next;n instanceof $x&&n.prev===this&&RPe(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(e,r){const n=super.wrap(e,r);return n instanceof $x&&this.attributes.move(n),n}};Fx.allowedChildren=[Fx,ol],Fx.blotName="inline",Fx.scope=_r.INLINE_BLOT,Fx.tagName="SPAN";let DPe=Fx;const iM=DPe,Ux=class p8 extends ad{static create(e){return super.create(e)}static formats(e,r){const n=r.query(p8.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new lS(this.domNode)}format(e,r){const n=this.scroll.query(e,_r.BLOCK);n!=null&&(n instanceof fh?this.attributes.attribute(n,r):e===this.statics.blotName&&!r?this.replaceWith(p8.blotName):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r))}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,s){this.scroll.query(n,_r.BLOCK)!=null?this.format(n,s):super.formatAt(e,r,n,s)}insertAt(e,r,n){if(n==null||this.scroll.query(r,_r.INLINE)!=null)super.insertAt(e,r,n);else{const s=this.split(e);if(s!=null){const a=this.scroll.create(r,n);s.parent.insertBefore(a,s)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};Ux.blotName="block",Ux.scope=_r.BLOCK_BLOT,Ux.tagName="P",Ux.allowedChildren=[iM,Ux,ol];let BPe=Ux;const p2=BPe,m8=class extends ad{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,r){super.deleteAt(e,r),this.enforceAllowedChildren()}formatAt(e,r,n,s){super.formatAt(e,r,n,s),this.enforceAllowedChildren()}insertAt(e,r,n){super.insertAt(e,r,n),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};m8.blotName="container",m8.scope=_r.BLOCK_BLOT;let FPe=m8;const cS=FPe;class $Pe extends ol{static formats(e,r){}format(e,r){super.formatAt(0,this.length(),e,r)}formatAt(e,r,n,s){e===0&&r===this.length()?this.format(n,s):super.formatAt(e,r,n,s)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Fc=$Pe,UPe={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},zPe=100,zx=class extends ad{constructor(e,r){super(null,r),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,UPe),this.attach()}create(e,r){return this.registry.create(this,e,r)}find(e,r=!1){const n=this.registry.find(e,r);return n?n.scroll===this?n:r?this.find(n.scroll.domNode.parentNode,!0):null:null}query(e,r=_r.ANY){return this.registry.query(e,r)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,r){this.update(),e===0&&r===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(e,r)}formatAt(e,r,n,s){this.update(),super.formatAt(e,r,n,s)}insertAt(e,r,n){this.update(),super.insertAt(e,r,n)}optimize(e=[],r={}){super.optimize(r);const n=r.mutationsMap||new WeakMap;let s=Array.from(this.observer.takeRecords());for(;s.length>0;)e.push(s.pop());const a=(c,u=!0)=>{c==null||c===this||c.domNode.parentNode!=null&&(n.has(c.domNode)||n.set(c.domNode,[]),u&&a(c.parent))},o=c=>{n.has(c.domNode)&&(c instanceof ad&&c.children.forEach(o),n.delete(c.domNode),c.optimize(r))};let l=e;for(let c=0;l.length>0;c+=1){if(c>=zPe)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach(u=>{const h=this.find(u.target,!0);h!=null&&(h.domNode===u.target&&(u.type==="childList"?(a(this.find(u.previousSibling,!1)),Array.from(u.addedNodes).forEach(f=>{const m=this.find(f,!1);a(m,!1),m instanceof ad&&m.children.forEach(g=>{a(g,!1)})})):u.type==="attributes"&&a(h.prev)),a(h))}),this.children.forEach(o),l=Array.from(this.observer.takeRecords()),s=l.slice();s.length>0;)e.push(s.pop())}}update(e,r={}){e=e||this.observer.takeRecords();const n=new WeakMap;e.map(s=>{const a=this.find(s.target,!0);return a==null?null:n.has(a.domNode)?(n.get(a.domNode).push(s),null):(n.set(a.domNode,[s]),a)}).forEach(s=>{s!=null&&s!==this&&n.has(s.domNode)&&s.update(n.get(s.domNode)||[],r)}),r.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),r),this.optimize(e,r)}};zx.blotName="scroll",zx.defaultChild=p2,zx.allowedChildren=[p2,cS],zx.scope=_r.BLOCK_BLOT,zx.tagName="DIV";let VPe=zx;const aM=VPe,g8=class Mse extends ol{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,r){super(e,r),this.text=this.statics.value(this.domNode)}deleteAt(e,r){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+r)}index(e,r){return this.domNode===e?r:-1}insertAt(e,r,n){n==null?(this.text=this.text.slice(0,e)+r+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,r,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Mse&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,r=!1){return[this.domNode,e]}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(e,r){e.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};g8.blotName="text",g8.scope=_r.INLINE_BLOT;let qPe=g8;const H4=qPe,HPe=Object.freeze(Object.defineProperty({__proto__:null,Attributor:fh,AttributorStore:lS,BlockBlot:p2,ClassAttributor:bd,ContainerBlot:cS,EmbedBlot:Fc,InlineBlot:iM,LeafBlot:ol,ParentBlot:ad,Registry:Wy,Scope:_r,ScrollBlot:aM,StyleAttributor:jp,TextBlot:H4},Symbol.toStringTag,{value:"Module"}));var cN={exports:{}},rA,sV;function WPe(){if(sV)return rA;sV=1;var t=-1,e=1,r=0;function n(S,P,R,V,ee){if(S===P)return S?[[r,S]]:[];if(R!=null){var G=M(S,P,R);if(G)return G}var J=l(S,P),Z=S.substring(0,J);S=S.substring(J),P=P.substring(J),J=u(S,P);var se=S.substring(S.length-J);S=S.substring(0,S.length-J),P=P.substring(0,P.length-J);var X=s(S,P);return Z&&X.unshift([r,Z]),se&&X.push([r,se]),k(X,ee),V&&f(X),X}function s(S,P){var R;if(!S)return[[e,P]];if(!P)return[[t,S]];var V=S.length>P.length?S:P,ee=S.length>P.length?P:S,G=V.indexOf(ee);if(G!==-1)return R=[[e,V.substring(0,G)],[r,ee],[e,V.substring(G+ee.length)]],S.length>P.length&&(R[0][0]=R[2][0]=t),R;if(ee.length===1)return[[t,S],[e,P]];var J=h(S,P);if(J){var Z=J[0],se=J[1],X=J[2],q=J[3],U=J[4],H=n(Z,X),re=n(se,q);return H.concat([[r,U]],re)}return a(S,P)}function a(S,P){for(var R=S.length,V=P.length,ee=Math.ceil((R+V)/2),G=ee,J=2*ee,Z=new Array(J),se=new Array(J),X=0;X<J;X++)Z[X]=-1,se[X]=-1;Z[G+1]=0,se[G+1]=0;for(var q=R-V,U=q%2!==0,H=0,re=0,ae=0,xe=0,Ne=0;Ne<ee;Ne++){for(var pe=-Ne+H;pe<=Ne-re;pe+=2){var K=G+pe,ue;pe===-Ne||pe!==Ne&&Z[K-1]<Z[K+1]?ue=Z[K+1]:ue=Z[K-1]+1;for(var fe=ue-pe;ue<R&&fe<V&&S.charAt(ue)===P.charAt(fe);)ue++,fe++;if(Z[K]=ue,ue>R)re+=2;else if(fe>V)H+=2;else if(U){var he=G+q-pe;if(he>=0&&he<J&&se[he]!==-1){var le=R-se[he];if(ue>=le)return o(S,P,ue,fe)}}}for(var _e=-Ne+ae;_e<=Ne-xe;_e+=2){var he=G+_e,le;_e===-Ne||_e!==Ne&&se[he-1]<se[he+1]?le=se[he+1]:le=se[he-1]+1;for(var oe=le-_e;le<R&&oe<V&&S.charAt(R-le-1)===P.charAt(V-oe-1);)le++,oe++;if(se[he]=le,le>R)xe+=2;else if(oe>V)ae+=2;else if(!U){var K=G+q-_e;if(K>=0&&K<J&&Z[K]!==-1){var ue=Z[K],fe=G+ue-K;if(le=R-le,ue>=le)return o(S,P,ue,fe)}}}}return[[t,S],[e,P]]}function o(S,P,R,V){var ee=S.substring(0,R),G=P.substring(0,V),J=S.substring(R),Z=P.substring(V),se=n(ee,G),X=n(J,Z);return se.concat(X)}function l(S,P){if(!S||!P||S.charAt(0)!==P.charAt(0))return 0;for(var R=0,V=Math.min(S.length,P.length),ee=V,G=0;R<ee;)S.substring(G,ee)==P.substring(G,ee)?(R=ee,G=R):V=ee,ee=Math.floor((V-R)/2+R);return C(S.charCodeAt(ee-1))&&ee--,ee}function c(S,P){var R=S.length,V=P.length;if(R==0||V==0)return 0;R>V?S=S.substring(R-V):R<V&&(P=P.substring(0,R));var ee=Math.min(R,V);if(S==P)return ee;for(var G=0,J=1;;){var Z=S.substring(ee-J),se=P.indexOf(Z);if(se==-1)return G;J+=se,(se==0||S.substring(ee-J)==P.substring(0,J))&&(G=J,J++)}}function u(S,P){if(!S||!P||S.slice(-1)!==P.slice(-1))return 0;for(var R=0,V=Math.min(S.length,P.length),ee=V,G=0;R<ee;)S.substring(S.length-ee,S.length-G)==P.substring(P.length-ee,P.length-G)?(R=ee,G=R):V=ee,ee=Math.floor((V-R)/2+R);return I(S.charCodeAt(S.length-ee))&&ee--,ee}function h(S,P){var R=S.length>P.length?S:P,V=S.length>P.length?P:S;if(R.length<4||V.length*2<R.length)return null;function ee(re,ae,xe){for(var Ne=re.substring(xe,xe+Math.floor(re.length/4)),pe=-1,K="",ue,fe,he,le;(pe=ae.indexOf(Ne,pe+1))!==-1;){var _e=l(re.substring(xe),ae.substring(pe)),oe=u(re.substring(0,xe),ae.substring(0,pe));K.length<oe+_e&&(K=ae.substring(pe-oe,pe)+ae.substring(pe,pe+_e),ue=re.substring(0,xe-oe),fe=re.substring(xe+_e),he=ae.substring(0,pe-oe),le=ae.substring(pe+_e))}return K.length*2>=re.length?[ue,fe,he,le,K]:null}var G=ee(R,V,Math.ceil(R.length/4)),J=ee(R,V,Math.ceil(R.length/2)),Z;if(!G&&!J)return null;J?G?Z=G[4].length>J[4].length?G:J:Z=J:Z=G;var se,X,q,U;S.length>P.length?(se=Z[0],X=Z[1],q=Z[2],U=Z[3]):(q=Z[0],U=Z[1],se=Z[2],X=Z[3]);var H=Z[4];return[se,X,q,U,H]}function f(S){for(var P=!1,R=[],V=0,ee=null,G=0,J=0,Z=0,se=0,X=0;G<S.length;)S[G][0]==r?(R[V++]=G,J=se,Z=X,se=0,X=0,ee=S[G][1]):(S[G][0]==e?se+=S[G][1].length:X+=S[G][1].length,ee&&ee.length<=Math.max(J,Z)&&ee.length<=Math.max(se,X)&&(S.splice(R[V-1],0,[t,ee]),S[R[V-1]+1][0]=e,V--,V--,G=V>0?R[V-1]:-1,J=0,Z=0,se=0,X=0,ee=null,P=!0)),G++;for(P&&k(S),N(S),G=1;G<S.length;){if(S[G-1][0]==t&&S[G][0]==e){var q=S[G-1][1],U=S[G][1],H=c(q,U),re=c(U,q);H>=re?(H>=q.length/2||H>=U.length/2)&&(S.splice(G,0,[r,U.substring(0,H)]),S[G-1][1]=q.substring(0,q.length-H),S[G+1][1]=U.substring(H),G++):(re>=q.length/2||re>=U.length/2)&&(S.splice(G,0,[r,q.substring(0,re)]),S[G-1][0]=e,S[G-1][1]=U.substring(0,U.length-re),S[G+1][0]=t,S[G+1][1]=q.substring(re),G++),G++}G++}}var m=/[^a-zA-Z0-9]/,g=/\s/,y=/[\r\n]/,v=/\n\r?\n$/,w=/^\r?\n\r?\n/;function N(S){function P(re,ae){if(!re||!ae)return 6;var xe=re.charAt(re.length-1),Ne=ae.charAt(0),pe=xe.match(m),K=Ne.match(m),ue=pe&&xe.match(g),fe=K&&Ne.match(g),he=ue&&xe.match(y),le=fe&&Ne.match(y),_e=he&&re.match(v),oe=le&&ae.match(w);return _e||oe?5:he||le?4:pe&&!ue&&fe?3:ue||fe?2:pe||K?1:0}for(var R=1;R<S.length-1;){if(S[R-1][0]==r&&S[R+1][0]==r){var V=S[R-1][1],ee=S[R][1],G=S[R+1][1],J=u(V,ee);if(J){var Z=ee.substring(ee.length-J);V=V.substring(0,V.length-J),ee=Z+ee.substring(0,ee.length-J),G=Z+G}for(var se=V,X=ee,q=G,U=P(V,ee)+P(ee,G);ee.charAt(0)===G.charAt(0);){V+=ee.charAt(0),ee=ee.substring(1)+G.charAt(0),G=G.substring(1);var H=P(V,ee)+P(ee,G);H>=U&&(U=H,se=V,X=ee,q=G)}S[R-1][1]!=se&&(se?S[R-1][1]=se:(S.splice(R-1,1),R--),S[R][1]=X,q?S[R+1][1]=q:(S.splice(R+1,1),R--))}R++}}function k(S,P){S.push([r,""]);for(var R=0,V=0,ee=0,G="",J="",Z;R<S.length;){if(R<S.length-1&&!S[R][1]){S.splice(R,1);continue}switch(S[R][0]){case e:ee++,J+=S[R][1],R++;break;case t:V++,G+=S[R][1],R++;break;case r:var se=R-ee-V-1;if(P){if(se>=0&&L(S[se][1])){var X=S[se][1].slice(-1);if(S[se][1]=S[se][1].slice(0,-1),G=X+G,J=X+J,!S[se][1]){S.splice(se,1),R--;var q=se-1;S[q]&&S[q][0]===e&&(ee++,J=S[q][1]+J,q--),S[q]&&S[q][0]===t&&(V++,G=S[q][1]+G,q--),se=q}}if(O(S[R][1])){var X=S[R][1].charAt(0);S[R][1]=S[R][1].slice(1),G+=X,J+=X}}if(R<S.length-1&&!S[R][1]){S.splice(R,1);break}if(G.length>0||J.length>0){G.length>0&&J.length>0&&(Z=l(J,G),Z!==0&&(se>=0?S[se][1]+=J.substring(0,Z):(S.splice(0,0,[r,J.substring(0,Z)]),R++),J=J.substring(Z),G=G.substring(Z)),Z=u(J,G),Z!==0&&(S[R][1]=J.substring(J.length-Z)+S[R][1],J=J.substring(0,J.length-Z),G=G.substring(0,G.length-Z)));var U=ee+V;G.length===0&&J.length===0?(S.splice(R-U,U),R=R-U):G.length===0?(S.splice(R-U,U,[e,J]),R=R-U+1):J.length===0?(S.splice(R-U,U,[t,G]),R=R-U+1):(S.splice(R-U,U,[t,G],[e,J]),R=R-U+2)}R!==0&&S[R-1][0]===r?(S[R-1][1]+=S[R][1],S.splice(R,1)):R++,ee=0,V=0,G="",J="";break}}S[S.length-1][1]===""&&S.pop();var H=!1;for(R=1;R<S.length-1;)S[R-1][0]===r&&S[R+1][0]===r&&(S[R][1].substring(S[R][1].length-S[R-1][1].length)===S[R-1][1]?(S[R][1]=S[R-1][1]+S[R][1].substring(0,S[R][1].length-S[R-1][1].length),S[R+1][1]=S[R-1][1]+S[R+1][1],S.splice(R-1,1),H=!0):S[R][1].substring(0,S[R+1][1].length)==S[R+1][1]&&(S[R-1][1]+=S[R+1][1],S[R][1]=S[R][1].substring(S[R+1][1].length)+S[R+1][1],S.splice(R+1,1),H=!0)),R++;H&&k(S,P)}function C(S){return S>=55296&&S<=56319}function I(S){return S>=56320&&S<=57343}function O(S){return I(S.charCodeAt(0))}function L(S){return C(S.charCodeAt(S.length-1))}function _(S){for(var P=[],R=0;R<S.length;R++)S[R][1].length>0&&P.push(S[R]);return P}function E(S,P,R,V){return L(S)||O(V)?null:_([[r,S],[t,P],[e,R],[r,V]])}function M(S,P,R){var V=typeof R=="number"?{index:R,length:0}:R.oldRange,ee=typeof R=="number"?null:R.newRange,G=S.length,J=P.length;if(V.length===0&&(ee===null||ee.length===0)){var Z=V.index,se=S.slice(0,Z),X=S.slice(Z),q=ee?ee.index:null;e:{var U=Z+J-G;if(q!==null&&q!==U||U<0||U>J)break e;var H=P.slice(0,U),re=P.slice(U);if(re!==X)break e;var ae=Math.min(Z,U),xe=se.slice(0,ae),Ne=H.slice(0,ae);if(xe!==Ne)break e;var pe=se.slice(ae),K=H.slice(ae);return E(xe,pe,K,X)}e:{if(q!==null&&q!==Z)break e;var ue=Z,H=P.slice(0,ue),re=P.slice(ue);if(H!==se)break e;var fe=Math.min(G-ue,J-ue),he=X.slice(X.length-fe),le=re.slice(re.length-fe);if(he!==le)break e;var pe=X.slice(0,X.length-fe),K=re.slice(0,re.length-fe);return E(se,pe,K,he)}}if(V.length>0&&ee&&ee.length===0)e:{var xe=S.slice(0,V.index),he=S.slice(V.index+V.length),ae=xe.length,fe=he.length;if(J<ae+fe)break e;var Ne=P.slice(0,ae),le=P.slice(J-fe);if(xe!==Ne||he!==le)break e;var pe=S.slice(ae,G-fe),K=P.slice(ae,J-fe);return E(xe,pe,K,he)}return null}function B(S,P,R,V){return n(S,P,R,V,!0)}return B.INSERT=e,B.DELETE=t,B.EQUAL=r,rA=B,rA}var i1={exports:{}};i1.exports;var iV;function Rse(){return iV||(iV=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",s=9007199254740991,a="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Function]",f="[object GeneratorFunction]",m="[object Map]",g="[object Number]",y="[object Object]",v="[object Promise]",w="[object RegExp]",N="[object Set]",k="[object String]",C="[object Symbol]",I="[object WeakMap]",O="[object ArrayBuffer]",L="[object DataView]",_="[object Float32Array]",E="[object Float64Array]",M="[object Int8Array]",B="[object Int16Array]",S="[object Int32Array]",P="[object Uint8Array]",R="[object Uint8ClampedArray]",V="[object Uint16Array]",ee="[object Uint32Array]",G=/[\\^$.*+?()[\]{}|]/g,J=/\w*$/,Z=/^\[object .+?Constructor\]$/,se=/^(?:0|[1-9]\d*)$/,X={};X[a]=X[o]=X[O]=X[L]=X[l]=X[c]=X[_]=X[E]=X[M]=X[B]=X[S]=X[m]=X[g]=X[y]=X[w]=X[N]=X[k]=X[C]=X[P]=X[R]=X[V]=X[ee]=!0,X[u]=X[h]=X[I]=!1;var q=typeof q0=="object"&&q0&&q0.Object===Object&&q0,U=typeof self=="object"&&self&&self.Object===Object&&self,H=q||U||Function("return this")(),re=e&&!e.nodeType&&e,ae=re&&!0&&t&&!t.nodeType&&t,xe=ae&&ae.exports===re;function Ne(Q,be){return Q.set(be[0],be[1]),Q}function pe(Q,be){return Q.add(be),Q}function K(Q,be){for(var Te=-1,it=Q?Q.length:0;++Te<it&&be(Q[Te],Te,Q)!==!1;);return Q}function ue(Q,be){for(var Te=-1,it=be.length,Tr=Q.length;++Te<it;)Q[Tr+Te]=be[Te];return Q}function fe(Q,be,Te,it){for(var Tr=-1,rr=Q?Q.length:0;++Tr<rr;)Te=be(Te,Q[Tr],Tr,Q);return Te}function he(Q,be){for(var Te=-1,it=Array(Q);++Te<Q;)it[Te]=be(Te);return it}function le(Q,be){return Q?.[be]}function _e(Q){var be=!1;if(Q!=null&&typeof Q.toString!="function")try{be=!!(Q+"")}catch{}return be}function oe(Q){var be=-1,Te=Array(Q.size);return Q.forEach(function(it,Tr){Te[++be]=[Tr,it]}),Te}function Oe(Q,be){return function(Te){return Q(be(Te))}}function ze(Q){var be=-1,Te=Array(Q.size);return Q.forEach(function(it){Te[++be]=it}),Te}var Ye=Array.prototype,je=Function.prototype,Fe=Object.prototype,Nt=H["__core-js_shared__"],$t=(function(){var Q=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""})(),Ut=je.toString,nt=Fe.hasOwnProperty,bt=Fe.toString,It=RegExp("^"+Ut.call(nt).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_t=xe?H.Buffer:void 0,wt=H.Symbol,ut=H.Uint8Array,Rt=Oe(Object.getPrototypeOf,Object),Dt=Object.create,at=Fe.propertyIsEnumerable,ft=Ye.splice,Bt=Object.getOwnPropertySymbols,De=_t?_t.isBuffer:void 0,lt=Oe(Object.keys,Object),ht=ei(H,"DataView"),Pt=ei(H,"Map"),At=ei(H,"Promise"),mt=ei(H,"Set"),Ft=ei(H,"WeakMap"),gt=ei(Object,"create"),Ot=ms(ht),Ct=ms(Pt),Xt=ms(At),Qt=ms(mt),nr=ms(Ft),sr=wt?wt.prototype:void 0,Jt=sr?sr.valueOf:void 0;function kr(Q){var be=-1,Te=Q?Q.length:0;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function Ae(){this.__data__=gt?gt(null):{}}function Ke(Q){return this.has(Q)&&delete this.__data__[Q]}function Gt(Q){var be=this.__data__;if(gt){var Te=be[Q];return Te===n?void 0:Te}return nt.call(be,Q)?be[Q]:void 0}function jt(Q){var be=this.__data__;return gt?be[Q]!==void 0:nt.call(be,Q)}function zt(Q,be){var Te=this.__data__;return Te[Q]=gt&&be===void 0?n:be,this}kr.prototype.clear=Ae,kr.prototype.delete=Ke,kr.prototype.get=Gt,kr.prototype.has=jt,kr.prototype.set=zt;function Mt(Q){var be=-1,Te=Q?Q.length:0;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function Ht(){this.__data__=[]}function vr(Q){var be=this.__data__,Te=Bi(be,Q);if(Te<0)return!1;var it=be.length-1;return Te==it?be.pop():ft.call(be,Te,1),!0}function Fr(Q){var be=this.__data__,Te=Bi(be,Q);return Te<0?void 0:be[Te][1]}function ln(Q){return Bi(this.__data__,Q)>-1}function hn(Q,be){var Te=this.__data__,it=Bi(Te,Q);return it<0?Te.push([Q,be]):Te[it][1]=be,this}Mt.prototype.clear=Ht,Mt.prototype.delete=vr,Mt.prototype.get=Fr,Mt.prototype.has=ln,Mt.prototype.set=hn;function cn(Q){var be=-1,Te=Q?Q.length:0;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function Ks(){this.__data__={hash:new kr,map:new(Pt||Mt),string:new kr}}function Ci(Q){return jo(this,Q).delete(Q)}function Ds(Q){return jo(this,Q).get(Q)}function ps(Q){return jo(this,Q).has(Q)}function $e(Q,be){return jo(this,Q).set(Q,be),this}cn.prototype.clear=Ks,cn.prototype.delete=Ci,cn.prototype.get=Ds,cn.prototype.has=ps,cn.prototype.set=$e;function Xe(Q){this.__data__=new Mt(Q)}function ct(){this.__data__=new Mt}function tr(Q){return this.__data__.delete(Q)}function Lr(Q){return this.__data__.get(Q)}function tn(Q){return this.__data__.has(Q)}function Ea(Q,be){var Te=this.__data__;if(Te instanceof Mt){var it=Te.__data__;if(!Pt||it.length<r-1)return it.push([Q,be]),this;Te=this.__data__=new cn(it)}return Te.set(Q,be),this}Xe.prototype.clear=ct,Xe.prototype.delete=tr,Xe.prototype.get=Lr,Xe.prototype.has=tn,Xe.prototype.set=Ea;function Bs(Q,be){var Te=So(Q)||yr(Q)?he(Q.length,String):[],it=Te.length,Tr=!!it;for(var rr in Q)nt.call(Q,rr)&&!(Tr&&(rr=="length"||Fl(rr,it)))&&Te.push(rr);return Te}function sa(Q,be,Te){var it=Q[be];(!(nt.call(Q,be)&&_o(it,Te))||Te===void 0&&!(be in Q))&&(Q[be]=Te)}function Bi(Q,be){for(var Te=Q.length;Te--;)if(_o(Q[Te][0],be))return Te;return-1}function Fi(Q,be){return Q&&Dl(be,Eo(be),Q)}function Ko(Q,be,Te,it,Tr,rr,Xr){var en;if(it&&(en=rr?it(Q,Tr,rr,Xr):it(Q)),en!==void 0)return en;if(!un(Q))return Q;var On=So(Q);if(On){if(en=gc(Q),!be)return hl(Q,en)}else{var rn=$i(Q),Yn=rn==h||rn==f;if(Ys(Q))return Zr(Q,be);if(rn==y||rn==a||Yn&&!rr){if(_e(Q))return rr?Q:{};if(en=ha(Yn?{}:Q),!be)return mc(Q,Fi(en,Q))}else{if(!X[rn])return rr?Q:{};en=Bl(Q,rn,Ko,be)}}Xr||(Xr=new Xe);var Xs=Xr.get(Q);if(Xs)return Xs;if(Xr.set(Q,en),!On)var us=Te?Ei(Q):Eo(Q);return K(us||Q,function(zn,Jn){us&&(Jn=zn,zn=Q[Jn]),sa(en,Jn,Ko(zn,be,Te,it,Jn,Q,Xr))}),en}function Rl(Q){return un(Q)?Dt(Q):{}}function pc(Q,be,Te){var it=be(Q);return So(Q)?it:ue(it,Te(Q))}function ia(Q){return bt.call(Q)}function pi(Q){if(!un(Q)||Ui(Q))return!1;var be=Ss(Q)||_e(Q)?It:Z;return be.test(ms(Q))}function ks(Q){if(!fa(Q))return lt(Q);var be=[];for(var Te in Object(Q))nt.call(Q,Te)&&Te!="constructor"&&be.push(Te);return be}function Zr(Q,be){if(be)return Q.slice();var Te=new Q.constructor(Q.length);return Q.copy(Te),Te}function Aa(Q){var be=new Q.constructor(Q.byteLength);return new ut(be).set(new ut(Q)),be}function mi(Q,be){var Te=be?Aa(Q.buffer):Q.buffer;return new Q.constructor(Te,Q.byteOffset,Q.byteLength)}function pn(Q,be,Te){var it=be?Te(oe(Q),!0):oe(Q);return fe(it,Ne,new Q.constructor)}function No(Q){var be=new Q.constructor(Q.source,J.exec(Q));return be.lastIndex=Q.lastIndex,be}function Fs(Q,be,Te){var it=be?Te(ze(Q),!0):ze(Q);return fe(it,pe,new Q.constructor)}function ss(Q){return Jt?Object(Jt.call(Q)):{}}function _s(Q,be){var Te=be?Aa(Q.buffer):Q.buffer;return new Q.constructor(Te,Q.byteOffset,Q.length)}function hl(Q,be){var Te=-1,it=Q.length;for(be||(be=Array(it));++Te<it;)be[Te]=Q[Te];return be}function Dl(Q,be,Te,it){Te||(Te={});for(var Tr=-1,rr=be.length;++Tr<rr;){var Xr=be[Tr],en=void 0;sa(Te,Xr,en===void 0?Q[Xr]:en)}return Te}function mc(Q,be){return Dl(Q,is(Q),be)}function Ei(Q){return pc(Q,Eo,is)}function jo(Q,be){var Te=Q.__data__;return ko(be)?Te[typeof be=="string"?"string":"hash"]:Te.map}function ei(Q,be){var Te=le(Q,be);return pi(Te)?Te:void 0}var is=Bt?Oe(Bt,Object):Ta,$i=ia;(ht&&$i(new ht(new ArrayBuffer(1)))!=L||Pt&&$i(new Pt)!=m||At&&$i(At.resolve())!=v||mt&&$i(new mt)!=N||Ft&&$i(new Ft)!=I)&&($i=function(Q){var be=bt.call(Q),Te=be==y?Q.constructor:void 0,it=Te?ms(Te):void 0;if(it)switch(it){case Ot:return L;case Ct:return m;case Xt:return v;case Qt:return N;case nr:return I}return be});function gc(Q){var be=Q.length,Te=Q.constructor(be);return be&&typeof Q[0]=="string"&&nt.call(Q,"index")&&(Te.index=Q.index,Te.input=Q.input),Te}function ha(Q){return typeof Q.constructor=="function"&&!fa(Q)?Rl(Rt(Q)):{}}function Bl(Q,be,Te,it){var Tr=Q.constructor;switch(be){case O:return Aa(Q);case l:case c:return new Tr(+Q);case L:return mi(Q,it);case _:case E:case M:case B:case S:case P:case R:case V:case ee:return _s(Q,it);case m:return pn(Q,it,Te);case g:case k:return new Tr(Q);case w:return No(Q);case N:return Fs(Q,it,Te);case C:return ss(Q)}}function Fl(Q,be){return be=be??s,!!be&&(typeof Q=="number"||se.test(Q))&&Q>-1&&Q%1==0&&Q<be}function ko(Q){var be=typeof Q;return be=="string"||be=="number"||be=="symbol"||be=="boolean"?Q!=="__proto__":Q===null}function Ui(Q){return!!$t&&$t in Q}function fa(Q){var be=Q&&Q.constructor,Te=typeof be=="function"&&be.prototype||Fe;return Q===Te}function ms(Q){if(Q!=null){try{return Ut.call(Q)}catch{}try{return Q+""}catch{}}return""}function Ai(Q){return Ko(Q,!0,!0)}function _o(Q,be){return Q===be||Q!==Q&&be!==be}function yr(Q){return Yo(Q)&&nt.call(Q,"callee")&&(!at.call(Q,"callee")||bt.call(Q)==a)}var So=Array.isArray;function Co(Q){return Q!=null&&Xo(Q.length)&&!Ss(Q)}function Yo(Q){return zi(Q)&&Co(Q)}var Ys=De||xc;function Ss(Q){var be=un(Q)?bt.call(Q):"";return be==h||be==f}function Xo(Q){return typeof Q=="number"&&Q>-1&&Q%1==0&&Q<=s}function un(Q){var be=typeof Q;return!!Q&&(be=="object"||be=="function")}function zi(Q){return!!Q&&typeof Q=="object"}function Eo(Q){return Co(Q)?Bs(Q):ks(Q)}function Ta(){return[]}function xc(){return!1}t.exports=Ai})(i1,i1.exports)),i1.exports}var a1={exports:{}};a1.exports;var aV;function Dse(){return aV||(aV=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",s=1,a=2,o=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",h="[object Boolean]",f="[object Date]",m="[object Error]",g="[object Function]",y="[object GeneratorFunction]",v="[object Map]",w="[object Number]",N="[object Null]",k="[object Object]",C="[object Promise]",I="[object Proxy]",O="[object RegExp]",L="[object Set]",_="[object String]",E="[object Symbol]",M="[object Undefined]",B="[object WeakMap]",S="[object ArrayBuffer]",P="[object DataView]",R="[object Float32Array]",V="[object Float64Array]",ee="[object Int8Array]",G="[object Int16Array]",J="[object Int32Array]",Z="[object Uint8Array]",se="[object Uint8ClampedArray]",X="[object Uint16Array]",q="[object Uint32Array]",U=/[\\^$.*+?()[\]{}|]/g,H=/^\[object .+?Constructor\]$/,re=/^(?:0|[1-9]\d*)$/,ae={};ae[R]=ae[V]=ae[ee]=ae[G]=ae[J]=ae[Z]=ae[se]=ae[X]=ae[q]=!0,ae[l]=ae[c]=ae[S]=ae[h]=ae[P]=ae[f]=ae[m]=ae[g]=ae[v]=ae[w]=ae[k]=ae[O]=ae[L]=ae[_]=ae[B]=!1;var xe=typeof q0=="object"&&q0&&q0.Object===Object&&q0,Ne=typeof self=="object"&&self&&self.Object===Object&&self,pe=xe||Ne||Function("return this")(),K=e&&!e.nodeType&&e,ue=K&&!0&&t&&!t.nodeType&&t,fe=ue&&ue.exports===K,he=fe&&xe.process,le=(function(){try{return he&&he.binding&&he.binding("util")}catch{}})(),_e=le&&le.isTypedArray;function oe(Q,be){for(var Te=-1,it=Q==null?0:Q.length,Tr=0,rr=[];++Te<it;){var Xr=Q[Te];be(Xr,Te,Q)&&(rr[Tr++]=Xr)}return rr}function Oe(Q,be){for(var Te=-1,it=be.length,Tr=Q.length;++Te<it;)Q[Tr+Te]=be[Te];return Q}function ze(Q,be){for(var Te=-1,it=Q==null?0:Q.length;++Te<it;)if(be(Q[Te],Te,Q))return!0;return!1}function Ye(Q,be){for(var Te=-1,it=Array(Q);++Te<Q;)it[Te]=be(Te);return it}function je(Q){return function(be){return Q(be)}}function Fe(Q,be){return Q.has(be)}function Nt(Q,be){return Q?.[be]}function $t(Q){var be=-1,Te=Array(Q.size);return Q.forEach(function(it,Tr){Te[++be]=[Tr,it]}),Te}function Ut(Q,be){return function(Te){return Q(be(Te))}}function nt(Q){var be=-1,Te=Array(Q.size);return Q.forEach(function(it){Te[++be]=it}),Te}var bt=Array.prototype,It=Function.prototype,_t=Object.prototype,wt=pe["__core-js_shared__"],ut=It.toString,Rt=_t.hasOwnProperty,Dt=(function(){var Q=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""})(),at=_t.toString,ft=RegExp("^"+ut.call(Rt).replace(U,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=fe?pe.Buffer:void 0,De=pe.Symbol,lt=pe.Uint8Array,ht=_t.propertyIsEnumerable,Pt=bt.splice,At=De?De.toStringTag:void 0,mt=Object.getOwnPropertySymbols,Ft=Bt?Bt.isBuffer:void 0,gt=Ut(Object.keys,Object),Ot=is(pe,"DataView"),Ct=is(pe,"Map"),Xt=is(pe,"Promise"),Qt=is(pe,"Set"),nr=is(pe,"WeakMap"),sr=is(Object,"create"),Jt=ms(Ot),kr=ms(Ct),Ae=ms(Xt),Ke=ms(Qt),Gt=ms(nr),jt=De?De.prototype:void 0,zt=jt?jt.valueOf:void 0;function Mt(Q){var be=-1,Te=Q==null?0:Q.length;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function Ht(){this.__data__=sr?sr(null):{},this.size=0}function vr(Q){var be=this.has(Q)&&delete this.__data__[Q];return this.size-=be?1:0,be}function Fr(Q){var be=this.__data__;if(sr){var Te=be[Q];return Te===n?void 0:Te}return Rt.call(be,Q)?be[Q]:void 0}function ln(Q){var be=this.__data__;return sr?be[Q]!==void 0:Rt.call(be,Q)}function hn(Q,be){var Te=this.__data__;return this.size+=this.has(Q)?0:1,Te[Q]=sr&&be===void 0?n:be,this}Mt.prototype.clear=Ht,Mt.prototype.delete=vr,Mt.prototype.get=Fr,Mt.prototype.has=ln,Mt.prototype.set=hn;function cn(Q){var be=-1,Te=Q==null?0:Q.length;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function Ks(){this.__data__=[],this.size=0}function Ci(Q){var be=this.__data__,Te=Zr(be,Q);if(Te<0)return!1;var it=be.length-1;return Te==it?be.pop():Pt.call(be,Te,1),--this.size,!0}function Ds(Q){var be=this.__data__,Te=Zr(be,Q);return Te<0?void 0:be[Te][1]}function ps(Q){return Zr(this.__data__,Q)>-1}function $e(Q,be){var Te=this.__data__,it=Zr(Te,Q);return it<0?(++this.size,Te.push([Q,be])):Te[it][1]=be,this}cn.prototype.clear=Ks,cn.prototype.delete=Ci,cn.prototype.get=Ds,cn.prototype.has=ps,cn.prototype.set=$e;function Xe(Q){var be=-1,Te=Q==null?0:Q.length;for(this.clear();++be<Te;){var it=Q[be];this.set(it[0],it[1])}}function ct(){this.size=0,this.__data__={hash:new Mt,map:new(Ct||cn),string:new Mt}}function tr(Q){var be=ei(this,Q).delete(Q);return this.size-=be?1:0,be}function Lr(Q){return ei(this,Q).get(Q)}function tn(Q){return ei(this,Q).has(Q)}function Ea(Q,be){var Te=ei(this,Q),it=Te.size;return Te.set(Q,be),this.size+=Te.size==it?0:1,this}Xe.prototype.clear=ct,Xe.prototype.delete=tr,Xe.prototype.get=Lr,Xe.prototype.has=tn,Xe.prototype.set=Ea;function Bs(Q){var be=-1,Te=Q==null?0:Q.length;for(this.__data__=new Xe;++be<Te;)this.add(Q[be])}function sa(Q){return this.__data__.set(Q,n),this}function Bi(Q){return this.__data__.has(Q)}Bs.prototype.add=Bs.prototype.push=sa,Bs.prototype.has=Bi;function Fi(Q){var be=this.__data__=new cn(Q);this.size=be.size}function Ko(){this.__data__=new cn,this.size=0}function Rl(Q){var be=this.__data__,Te=be.delete(Q);return this.size=be.size,Te}function pc(Q){return this.__data__.get(Q)}function ia(Q){return this.__data__.has(Q)}function pi(Q,be){var Te=this.__data__;if(Te instanceof cn){var it=Te.__data__;if(!Ct||it.length<r-1)return it.push([Q,be]),this.size=++Te.size,this;Te=this.__data__=new Xe(it)}return Te.set(Q,be),this.size=Te.size,this}Fi.prototype.clear=Ko,Fi.prototype.delete=Rl,Fi.prototype.get=pc,Fi.prototype.has=ia,Fi.prototype.set=pi;function ks(Q,be){var Te=yr(Q),it=!Te&&_o(Q),Tr=!Te&&!it&&Co(Q),rr=!Te&&!it&&!Tr&&zi(Q),Xr=Te||it||Tr||rr,en=Xr?Ye(Q.length,String):[],On=en.length;for(var rn in Q)Rt.call(Q,rn)&&!(Xr&&(rn=="length"||Tr&&(rn=="offset"||rn=="parent")||rr&&(rn=="buffer"||rn=="byteLength"||rn=="byteOffset")||Bl(rn,On)))&&en.push(rn);return en}function Zr(Q,be){for(var Te=Q.length;Te--;)if(Ai(Q[Te][0],be))return Te;return-1}function Aa(Q,be,Te){var it=be(Q);return yr(Q)?it:Oe(it,Te(Q))}function mi(Q){return Q==null?Q===void 0?M:N:At&&At in Object(Q)?$i(Q):fa(Q)}function pn(Q){return un(Q)&&mi(Q)==l}function No(Q,be,Te,it,Tr){return Q===be?!0:Q==null||be==null||!un(Q)&&!un(be)?Q!==Q&&be!==be:Fs(Q,be,Te,it,No,Tr)}function Fs(Q,be,Te,it,Tr,rr){var Xr=yr(Q),en=yr(be),On=Xr?c:ha(Q),rn=en?c:ha(be);On=On==l?k:On,rn=rn==l?k:rn;var Yn=On==k,Xs=rn==k,us=On==rn;if(us&&Co(Q)){if(!Co(be))return!1;Xr=!0,Yn=!1}if(us&&!Yn)return rr||(rr=new Fi),Xr||zi(Q)?Dl(Q,be,Te,it,Tr,rr):mc(Q,be,On,Te,it,Tr,rr);if(!(Te&s)){var zn=Yn&&Rt.call(Q,"__wrapped__"),Jn=Xs&&Rt.call(be,"__wrapped__");if(zn||Jn){var to=zn?Q.value():Q,ti=Jn?be.value():be;return rr||(rr=new Fi),Tr(to,ti,Te,it,rr)}}return us?(rr||(rr=new Fi),Ei(Q,be,Te,it,Tr,rr)):!1}function ss(Q){if(!Xo(Q)||ko(Q))return!1;var be=Ys(Q)?ft:H;return be.test(ms(Q))}function _s(Q){return un(Q)&&Ss(Q.length)&&!!ae[mi(Q)]}function hl(Q){if(!Ui(Q))return gt(Q);var be=[];for(var Te in Object(Q))Rt.call(Q,Te)&&Te!="constructor"&&be.push(Te);return be}function Dl(Q,be,Te,it,Tr,rr){var Xr=Te&s,en=Q.length,On=be.length;if(en!=On&&!(Xr&&On>en))return!1;var rn=rr.get(Q);if(rn&&rr.get(be))return rn==be;var Yn=-1,Xs=!0,us=Te&a?new Bs:void 0;for(rr.set(Q,be),rr.set(be,Q);++Yn<en;){var zn=Q[Yn],Jn=be[Yn];if(it)var to=Xr?it(Jn,zn,Yn,be,Q,rr):it(zn,Jn,Yn,Q,be,rr);if(to!==void 0){if(to)continue;Xs=!1;break}if(us){if(!ze(be,function(ti,ro){if(!Fe(us,ro)&&(zn===ti||Tr(zn,ti,Te,it,rr)))return us.push(ro)})){Xs=!1;break}}else if(!(zn===Jn||Tr(zn,Jn,Te,it,rr))){Xs=!1;break}}return rr.delete(Q),rr.delete(be),Xs}function mc(Q,be,Te,it,Tr,rr,Xr){switch(Te){case P:if(Q.byteLength!=be.byteLength||Q.byteOffset!=be.byteOffset)return!1;Q=Q.buffer,be=be.buffer;case S:return!(Q.byteLength!=be.byteLength||!rr(new lt(Q),new lt(be)));case h:case f:case w:return Ai(+Q,+be);case m:return Q.name==be.name&&Q.message==be.message;case O:case _:return Q==be+"";case v:var en=$t;case L:var On=it&s;if(en||(en=nt),Q.size!=be.size&&!On)return!1;var rn=Xr.get(Q);if(rn)return rn==be;it|=a,Xr.set(Q,be);var Yn=Dl(en(Q),en(be),it,Tr,rr,Xr);return Xr.delete(Q),Yn;case E:if(zt)return zt.call(Q)==zt.call(be)}return!1}function Ei(Q,be,Te,it,Tr,rr){var Xr=Te&s,en=jo(Q),On=en.length,rn=jo(be),Yn=rn.length;if(On!=Yn&&!Xr)return!1;for(var Xs=On;Xs--;){var us=en[Xs];if(!(Xr?us in be:Rt.call(be,us)))return!1}var zn=rr.get(Q);if(zn&&rr.get(be))return zn==be;var Jn=!0;rr.set(Q,be),rr.set(be,Q);for(var to=Xr;++Xs<On;){us=en[Xs];var ti=Q[us],ro=be[us];if(it)var z=Xr?it(ro,ti,us,be,Q,rr):it(ti,ro,us,Q,be,rr);if(!(z===void 0?ti===ro||Tr(ti,ro,Te,it,rr):z)){Jn=!1;break}to||(to=us=="constructor")}if(Jn&&!to){var ce=Q.constructor,Se=be.constructor;ce!=Se&&"constructor"in Q&&"constructor"in be&&!(typeof ce=="function"&&ce instanceof ce&&typeof Se=="function"&&Se instanceof Se)&&(Jn=!1)}return rr.delete(Q),rr.delete(be),Jn}function jo(Q){return Aa(Q,Eo,gc)}function ei(Q,be){var Te=Q.__data__;return Fl(be)?Te[typeof be=="string"?"string":"hash"]:Te.map}function is(Q,be){var Te=Nt(Q,be);return ss(Te)?Te:void 0}function $i(Q){var be=Rt.call(Q,At),Te=Q[At];try{Q[At]=void 0;var it=!0}catch{}var Tr=at.call(Q);return it&&(be?Q[At]=Te:delete Q[At]),Tr}var gc=mt?function(Q){return Q==null?[]:(Q=Object(Q),oe(mt(Q),function(be){return ht.call(Q,be)}))}:Ta,ha=mi;(Ot&&ha(new Ot(new ArrayBuffer(1)))!=P||Ct&&ha(new Ct)!=v||Xt&&ha(Xt.resolve())!=C||Qt&&ha(new Qt)!=L||nr&&ha(new nr)!=B)&&(ha=function(Q){var be=mi(Q),Te=be==k?Q.constructor:void 0,it=Te?ms(Te):"";if(it)switch(it){case Jt:return P;case kr:return v;case Ae:return C;case Ke:return L;case Gt:return B}return be});function Bl(Q,be){return be=be??o,!!be&&(typeof Q=="number"||re.test(Q))&&Q>-1&&Q%1==0&&Q<be}function Fl(Q){var be=typeof Q;return be=="string"||be=="number"||be=="symbol"||be=="boolean"?Q!=="__proto__":Q===null}function ko(Q){return!!Dt&&Dt in Q}function Ui(Q){var be=Q&&Q.constructor,Te=typeof be=="function"&&be.prototype||_t;return Q===Te}function fa(Q){return at.call(Q)}function ms(Q){if(Q!=null){try{return ut.call(Q)}catch{}try{return Q+""}catch{}}return""}function Ai(Q,be){return Q===be||Q!==Q&&be!==be}var _o=pn((function(){return arguments})())?pn:function(Q){return un(Q)&&Rt.call(Q,"callee")&&!ht.call(Q,"callee")},yr=Array.isArray;function So(Q){return Q!=null&&Ss(Q.length)&&!Ys(Q)}var Co=Ft||xc;function Yo(Q,be){return No(Q,be)}function Ys(Q){if(!Xo(Q))return!1;var be=mi(Q);return be==g||be==y||be==u||be==I}function Ss(Q){return typeof Q=="number"&&Q>-1&&Q%1==0&&Q<=o}function Xo(Q){var be=typeof Q;return Q!=null&&(be=="object"||be=="function")}function un(Q){return Q!=null&&typeof Q=="object"}var zi=_e?je(_e):_s;function Eo(Q){return So(Q)?ks(Q):hl(Q)}function Ta(){return[]}function xc(){return!1}t.exports=Yo})(a1,a1.exports)),a1.exports}var uN={},oV;function GPe(){if(oV)return uN;oV=1,Object.defineProperty(uN,"__esModule",{value:!0});const t=Rse(),e=Dse();var r;return(function(n){function s(c={},u={},h=!1){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});let f=t(u);h||(f=Object.keys(f).reduce((m,g)=>(f[g]!=null&&(m[g]=f[g]),m),{}));for(const m in c)c[m]!==void 0&&u[m]===void 0&&(f[m]=c[m]);return Object.keys(f).length>0?f:void 0}n.compose=s;function a(c={},u={}){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});const h=Object.keys(c).concat(Object.keys(u)).reduce((f,m)=>(e(c[m],u[m])||(f[m]=u[m]===void 0?null:u[m]),f),{});return Object.keys(h).length>0?h:void 0}n.diff=a;function o(c={},u={}){c=c||{};const h=Object.keys(u).reduce((f,m)=>(u[m]!==c[m]&&c[m]!==void 0&&(f[m]=u[m]),f),{});return Object.keys(c).reduce((f,m)=>(c[m]!==u[m]&&u[m]===void 0&&(f[m]=null),f),h)}n.invert=o;function l(c,u,h=!1){if(typeof c!="object")return u;if(typeof u!="object")return;if(!h)return u;const f=Object.keys(u).reduce((m,g)=>(c[g]===void 0&&(m[g]=u[g]),m),{});return Object.keys(f).length>0?f:void 0}n.transform=l})(r||(r={})),uN.default=r,uN}var dN={},lV;function Bse(){if(lV)return dN;lV=1,Object.defineProperty(dN,"__esModule",{value:!0});var t;return(function(e){function r(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=r})(t||(t={})),dN.default=t,dN}var hN={},cV;function KPe(){if(cV)return hN;cV=1,Object.defineProperty(hN,"__esModule",{value:!0});const t=Bse();class e{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const s=this.ops[this.index];if(s){const a=this.offset,o=t.default.length(s);if(n>=o-a?(n=o-a,this.index+=1,this.offset=0):this.offset+=n,typeof s.delete=="number")return{delete:n};{const l={};return s.attributes&&(l.attributes=s.attributes),typeof s.retain=="number"?l.retain=n:typeof s.retain=="object"&&s.retain!==null?l.retain=s.retain:typeof s.insert=="string"?l.insert=s.insert.substr(a,n):l.insert=s.insert,l}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?t.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,s=this.index,a=this.next(),o=this.ops.slice(this.index);return this.offset=n,this.index=s,[a].concat(o)}}else return[]}}return hN.default=e,hN}var uV;function YPe(){return uV||(uV=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const r=WPe(),n=Rse(),s=Dse(),a=GPe();e.AttributeMap=a.default;const o=Bse();e.Op=o.default;const l=KPe();e.OpIterator=l.default;const c="\0",u=(f,m)=>{if(typeof f!="object"||f===null)throw new Error(`cannot retain a ${typeof f}`);if(typeof m!="object"||m===null)throw new Error(`cannot retain a ${typeof m}`);const g=Object.keys(f)[0];if(!g||g!==Object.keys(m)[0])throw new Error(`embed types not matched: ${g} != ${Object.keys(m)[0]}`);return[g,f[g],m[g]]};class h{constructor(m){Array.isArray(m)?this.ops=m:m!=null&&Array.isArray(m.ops)?this.ops=m.ops:this.ops=[]}static registerEmbed(m,g){this.handlers[m]=g}static unregisterEmbed(m){delete this.handlers[m]}static getHandler(m){const g=this.handlers[m];if(!g)throw new Error(`no handlers for embed type "${m}"`);return g}insert(m,g){const y={};return typeof m=="string"&&m.length===0?this:(y.insert=m,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(y.attributes=g),this.push(y))}delete(m){return m<=0?this:this.push({delete:m})}retain(m,g){if(typeof m=="number"&&m<=0)return this;const y={retain:m};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(y.attributes=g),this.push(y)}push(m){let g=this.ops.length,y=this.ops[g-1];if(m=n(m),typeof y=="object"){if(typeof m.delete=="number"&&typeof y.delete=="number")return this.ops[g-1]={delete:y.delete+m.delete},this;if(typeof y.delete=="number"&&m.insert!=null&&(g-=1,y=this.ops[g-1],typeof y!="object"))return this.ops.unshift(m),this;if(s(m.attributes,y.attributes)){if(typeof m.insert=="string"&&typeof y.insert=="string")return this.ops[g-1]={insert:y.insert+m.insert},typeof m.attributes=="object"&&(this.ops[g-1].attributes=m.attributes),this;if(typeof m.retain=="number"&&typeof y.retain=="number")return this.ops[g-1]={retain:y.retain+m.retain},typeof m.attributes=="object"&&(this.ops[g-1].attributes=m.attributes),this}}return g===this.ops.length?this.ops.push(m):this.ops.splice(g,0,m),this}chop(){const m=this.ops[this.ops.length-1];return m&&typeof m.retain=="number"&&!m.attributes&&this.ops.pop(),this}filter(m){return this.ops.filter(m)}forEach(m){this.ops.forEach(m)}map(m){return this.ops.map(m)}partition(m){const g=[],y=[];return this.forEach(v=>{(m(v)?g:y).push(v)}),[g,y]}reduce(m,g){return this.ops.reduce(m,g)}changeLength(){return this.reduce((m,g)=>g.insert?m+o.default.length(g):g.delete?m-g.delete:m,0)}length(){return this.reduce((m,g)=>m+o.default.length(g),0)}slice(m=0,g=1/0){const y=[],v=new l.default(this.ops);let w=0;for(;w<g&&v.hasNext();){let N;w<m?N=v.next(m-w):(N=v.next(g-w),y.push(N)),w+=o.default.length(N)}return new h(y)}compose(m){const g=new l.default(this.ops),y=new l.default(m.ops),v=[],w=y.peek();if(w!=null&&typeof w.retain=="number"&&w.attributes==null){let k=w.retain;for(;g.peekType()==="insert"&&g.peekLength()<=k;)k-=g.peekLength(),v.push(g.next());w.retain-k>0&&y.next(w.retain-k)}const N=new h(v);for(;g.hasNext()||y.hasNext();)if(y.peekType()==="insert")N.push(y.next());else if(g.peekType()==="delete")N.push(g.next());else{const k=Math.min(g.peekLength(),y.peekLength()),C=g.next(k),I=y.next(k);if(I.retain){const O={};if(typeof C.retain=="number")O.retain=typeof I.retain=="number"?k:I.retain;else if(typeof I.retain=="number")C.retain==null?O.insert=C.insert:O.retain=C.retain;else{const _=C.retain==null?"insert":"retain",[E,M,B]=u(C[_],I.retain),S=h.getHandler(E);O[_]={[E]:S.compose(M,B,_==="retain")}}const L=a.default.compose(C.attributes,I.attributes,typeof C.retain=="number");if(L&&(O.attributes=L),N.push(O),!y.hasNext()&&s(N.ops[N.ops.length-1],O)){const _=new h(g.rest());return N.concat(_).chop()}}else typeof I.delete=="number"&&(typeof C.retain=="number"||typeof C.retain=="object"&&C.retain!==null)&&N.push(I)}return N.chop()}concat(m){const g=new h(this.ops.slice());return m.ops.length>0&&(g.push(m.ops[0]),g.ops=g.ops.concat(m.ops.slice(1))),g}diff(m,g){if(this.ops===m.ops)return new h;const y=[this,m].map(C=>C.map(I=>{if(I.insert!=null)return typeof I.insert=="string"?I.insert:c;const O=C===m?"on":"with";throw new Error("diff() called "+O+" non-document")}).join("")),v=new h,w=r(y[0],y[1],g,!0),N=new l.default(this.ops),k=new l.default(m.ops);return w.forEach(C=>{let I=C[1].length;for(;I>0;){let O=0;switch(C[0]){case r.INSERT:O=Math.min(k.peekLength(),I),v.push(k.next(O));break;case r.DELETE:O=Math.min(I,N.peekLength()),N.next(O),v.delete(O);break;case r.EQUAL:O=Math.min(N.peekLength(),k.peekLength(),I);const L=N.next(O),_=k.next(O);s(L.insert,_.insert)?v.retain(O,a.default.diff(L.attributes,_.attributes)):v.push(_).delete(O);break}I-=O}}),v.chop()}eachLine(m,g=`
`){const y=new l.default(this.ops);let v=new h,w=0;for(;y.hasNext();){if(y.peekType()!=="insert")return;const N=y.peek(),k=o.default.length(N)-y.peekLength(),C=typeof N.insert=="string"?N.insert.indexOf(g,k)-k:-1;if(C<0)v.push(y.next());else if(C>0)v.push(y.next(C));else{if(m(v,y.next(1).attributes||{},w)===!1)return;w+=1,v=new h}}v.length()>0&&m(v,{},w)}invert(m){const g=new h;return this.reduce((y,v)=>{if(v.insert)g.delete(o.default.length(v));else{if(typeof v.retain=="number"&&v.attributes==null)return g.retain(v.retain),y+v.retain;if(v.delete||typeof v.retain=="number"){const w=v.delete||v.retain;return m.slice(y,y+w).forEach(k=>{v.delete?g.push(k):v.retain&&v.attributes&&g.retain(o.default.length(k),a.default.invert(v.attributes,k.attributes))}),y+w}else if(typeof v.retain=="object"&&v.retain!==null){const w=m.slice(y,y+1),N=new l.default(w.ops).next(),[k,C,I]=u(v.retain,N.insert),O=h.getHandler(k);return g.retain({[k]:O.invert(C,I)},a.default.invert(v.attributes,N.attributes)),y+1}}return y},0),g.chop()}transform(m,g=!1){if(g=!!g,typeof m=="number")return this.transformPosition(m,g);const y=m,v=new l.default(this.ops),w=new l.default(y.ops),N=new h;for(;v.hasNext()||w.hasNext();)if(v.peekType()==="insert"&&(g||w.peekType()!=="insert"))N.retain(o.default.length(v.next()));else if(w.peekType()==="insert")N.push(w.next());else{const k=Math.min(v.peekLength(),w.peekLength()),C=v.next(k),I=w.next(k);if(C.delete)continue;if(I.delete)N.push(I);else{const O=C.retain,L=I.retain;let _=typeof L=="object"&&L!==null?L:k;if(typeof O=="object"&&O!==null&&typeof L=="object"&&L!==null){const E=Object.keys(O)[0];if(E===Object.keys(L)[0]){const M=h.getHandler(E);M&&(_={[E]:M.transform(O[E],L[E],g)})}}N.retain(_,a.default.transform(C.attributes,I.attributes,g))}}return N.chop()}transformPosition(m,g=!1){g=!!g;const y=new l.default(this.ops);let v=0;for(;y.hasNext()&&v<=m;){const w=y.peekLength(),N=y.peekType();if(y.next(),N==="delete"){m-=Math.min(w,m-v);continue}else N==="insert"&&(v<m||!g)&&(m+=w);v+=w}return m}}h.Op=o.default,h.OpIterator=l.default,h.AttributeMap=a.default,h.handlers={},e.default=h,t.exports=h,t.exports.default=h})(cN,cN.exports)),cN.exports}var hu=YPe();const Nr=Pl(hu);class vd extends Fc{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}vd.blotName="break";vd.tagName="BR";let fd=class extends H4{};const XPe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function uS(t){return t.replace(/[&<>"']/g,e=>XPe[e])}class vl extends iM{static allowedChildren=[vl,vd,Fc,fd];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,r){const n=vl.order.indexOf(e),s=vl.order.indexOf(r);return n>=0||s>=0?n-s:e===r?0:e<r?-1:1}formatAt(e,r,n,s){if(vl.compare(this.statics.blotName,n)<0&&this.scroll.query(n,_r.BLOT)){const a=this.isolate(e,r);s&&a.wrap(n,s)}else super.formatAt(e,r,n,s)}optimize(e){if(super.optimize(e),this.parent instanceof vl&&vl.compare(this.statics.blotName,this.parent.statics.blotName)>0){const r=this.parent.isolate(this.offset(),this.length());this.moveChildren(r),r.wrap(this)}}}const dV=1;class Wo extends p2{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Fse(this)),this.cache.delta}deleteAt(e,r){super.deleteAt(e,r),this.cache={}}formatAt(e,r,n,s){r<=0||(this.scroll.query(n,_r.BLOCK)?e+r===this.length()&&this.format(n,s):super.formatAt(e,Math.min(r,this.length()-e-1),n,s),this.cache={})}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n),this.cache={};return}if(r.length===0)return;const s=r.split(`
`),a=s.shift();a.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});let o=this;s.reduce((l,c)=>(o=o.split(l,!0),o.insertAt(0,c),c.length),e+a.length)}insertBefore(e,r){const{head:n}=this.children;super.insertBefore(e,r),n instanceof vd&&n.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+dV),this.cache.length}moveChildren(e,r){super.moveChildren(e,r),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(e===0||e>=this.length()-dV)){const s=this.clone();return e===0?(this.parent.insertBefore(s,this),this):(this.parent.insertBefore(s,this.next),s)}const n=super.split(e,r);return this.cache={},n}}Wo.blotName="block";Wo.tagName="P";Wo.defaultChild=vd;Wo.allowedChildren=[vd,vl,Fc,fd];class du extends Fc{attach(){super.attach(),this.attributes=new lS(this.domNode)}delta(){return new Nr().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,r){const n=this.scroll.query(e,_r.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,r)}formatAt(e,r,n,s){this.format(n,s)}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n);return}const s=r.split(`
`),a=s.pop(),o=s.map(c=>{const u=this.scroll.create(Wo.blotName);return u.insertAt(0,c),u}),l=this.split(e);o.forEach(c=>{this.parent.insertBefore(c,l)}),a&&this.parent.insertBefore(this.scroll.create("text",a),l)}}du.scope=_r.BLOCK_BLOT;function Fse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.descendants(ol).reduce((r,n)=>n.length()===0?r:r.insert(n.value(),cu(n,{},e)),new Nr).insert(`
`,cu(t))}function cu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return t==null||("formats"in t&&typeof t.formats=="function"&&(e={...e,...t.formats()},r&&delete e["code-token"]),t.parent==null||t.parent.statics.blotName==="scroll"||t.parent.statics.scope!==t.statics.scope)?e:cu(t.parent,e,r)}let dS=class rm extends Fc{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,r,n){super(e,r),this.selection=n,this.textNode=document.createTextNode(rm.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,r){if(this.savedLength!==0){super.format(e,r);return}let n=this,s=0;for(;n!=null&&n.statics.scope!==_r.BLOCK_BLOT;)s+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=rm.CONTENTS.length,n.optimize(),n.formatAt(s,rm.CONTENTS.length,e,r),this.savedLength=0)}index(e,r){return e===this.textNode?0:super.index(e,r)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const r=this.prev instanceof fd?this.prev:null,n=r?r.length():0,s=this.next instanceof fd?this.next:null,a=s?s.text:"",{textNode:o}=this,l=o.data.split(rm.CONTENTS).join("");o.data=rm.CONTENTS;let c;if(r)c=r,(l||s)&&(r.insertAt(r.length(),l+a),s&&s.remove());else if(s)c=s,s.insertAt(0,l);else{const u=document.createTextNode(l);c=this.scroll.create(u),this.parent.insertBefore(c,this)}if(this.remove(),e){const u=(m,g)=>r&&m===r.domNode?g:m===o?n+g-1:s&&m===s.domNode?n+l.length+g:null,h=u(e.start.node,e.start.offset),f=u(e.end.node,e.end.offset);if(h!==null&&f!==null)return{startNode:c.domNode,startOffset:h,endNode:c.domNode,endOffset:f}}return null}update(e,r){if(e.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(r.range=n)}}optimize(e){super.optimize(e);let{parent:r}=this;for(;r;){if(r.domNode.tagName==="A"){this.savedLength=rm.CONTENTS.length,r.isolate(this.offset(r),this.length()).unwrap(),this.savedLength=0;break}r=r.parent}}value(){return""}};var nA={exports:{}},hV;function QPe(){return hV||(hV=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,h){this.fn=c,this.context=u,this.once=h||!1}function a(c,u,h,f,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new s(h,f||c,m),y=r?r+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],g]:c._events[y].push(g):(c._events[y]=g,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)e.call(h,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=r?r+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,g=f.length,y=new Array(g);m<g;m++)y[m]=f[m].fn;return y},l.prototype.listenerCount=function(u){var h=r?r+u:u,f=this._events[h];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,h,f,m,g,y){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],N=arguments.length,k,C;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),N){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,f),!0;case 4:return w.fn.call(w.context,h,f,m),!0;case 5:return w.fn.call(w.context,h,f,m,g),!0;case 6:return w.fn.call(w.context,h,f,m,g,y),!0}for(C=1,k=new Array(N-1);C<N;C++)k[C-1]=arguments[C];w.fn.apply(w.context,k)}else{var I=w.length,O;for(C=0;C<I;C++)switch(w[C].once&&this.removeListener(u,w[C].fn,void 0,!0),N){case 1:w[C].fn.call(w[C].context);break;case 2:w[C].fn.call(w[C].context,h);break;case 3:w[C].fn.call(w[C].context,h,f);break;case 4:w[C].fn.call(w[C].context,h,f,m);break;default:if(!k)for(O=1,k=new Array(N-1);O<N;O++)k[O-1]=arguments[O];w[C].fn.apply(w[C].context,k)}}return!0},l.prototype.on=function(u,h,f){return a(this,u,h,f,!1)},l.prototype.once=function(u,h,f){return a(this,u,h,f,!0)},l.prototype.removeListener=function(u,h,f,m){var g=r?r+u:u;if(!this._events[g])return this;if(!h)return o(this,g),this;var y=this._events[g];if(y.fn)y.fn===h&&(!m||y.once)&&(!f||y.context===f)&&o(this,g);else{for(var v=0,w=[],N=y.length;v<N;v++)(y[v].fn!==h||m&&!y[v].once||f&&y[v].context!==f)&&w.push(y[v]);w.length?this._events[g]=w.length===1?w[0]:w:o(this,g)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=r?r+u:u,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(nA)),nA.exports}var JPe=QPe();const $se=Pl(JPe),x8=new WeakMap,y8=["error","warn","log","info"];let b8="warn";function Use(t){if(b8&&y8.indexOf(t)<=y8.indexOf(b8)){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];console[t](...r)}}function Uf(t){return y8.reduce((e,r)=>(e[r]=Use.bind(console,r,t),e),{})}Uf.level=t=>{b8=t};Use.level=Uf.level;const sA=Uf("quill:events"),ZPe=["selectionchange","mousedown","mouseup","click"];ZPe.forEach(t=>{document.addEventListener(t,function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(s=>{const a=x8.get(s);a&&a.emitter&&a.emitter.handleDOM(...r)})})});class br extends $se{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",sA.error)}emit(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return sA.log.call(sA,...r),super.emit(...r)}handleDOM(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];(this.domListeners[e.type]||[]).forEach(a=>{let{node:o,handler:l}=a;(e.target===o||o.contains(e.target))&&l(e,...n)})}listenDOM(e,r,n){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:r,handler:n})}}const iA=Uf("quill:selection");class eg{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=r}}class eLe{constructor(e,r){this.emitter=r,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new eg(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,br.sources.USER),1)}),this.emitter.on(br.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(br.events.SCROLL_UPDATE,(s,a)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const o=a.some(l=>l.type==="characterData"||l.type==="childList"||l.type==="attributes"&&l.target===this.root);this.update(o?br.sources.SILENT:s)}catch{}})}),this.emitter.on(br.events.SCROLL_OPTIMIZE,(n,s)=>{if(s.range){const{startNode:a,startOffset:o,endNode:l,endOffset:c}=s.range;this.setNativeRange(a,o,l,c),this.update(br.sources.SILENT)}}),this.update(br.sources.SILENT)}handleComposition(){this.emitter.on(br.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(br.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(br.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,r){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(e,_r.BLOCK))){if(n.start.node!==this.cursor.textNode){const s=this.scroll.find(n.start.node,!1);if(s==null)return;if(s instanceof ol){const a=s.split(n.start.offset);s.parent.insertBefore(this.cursor,a)}else s.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,r),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();e=Math.min(e,n-1),r=Math.min(e+r,n-1)-e;let s,[a,o]=this.scroll.leaf(e);if(a==null)return null;if(r>0&&o===a.length()){const[h]=this.scroll.leaf(e+1);if(h){const[f]=this.scroll.line(e),[m]=this.scroll.line(e+1);f===m&&(a=h,o=0)}}[s,o]=a.position(o,!0);const l=document.createRange();if(r>0)return l.setStart(s,o),[a,o]=this.scroll.leaf(e+r),a==null?null:([s,o]=a.position(o,!0),l.setEnd(s,o),l.getBoundingClientRect());let c="left",u;if(s instanceof Text){if(!s.data.length)return null;o<s.data.length?(l.setStart(s,o),l.setEnd(s,o+1)):(l.setStart(s,o-1),l.setEnd(s,o),c="right"),u=l.getBoundingClientRect()}else{if(!(a.domNode instanceof Element))return null;u=a.domNode.getBoundingClientRect(),o>0&&(c="right")}return{bottom:u.top+u.height,height:u.height,left:u[c],right:u[c],top:u.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const r=e.getRangeAt(0);if(r==null)return null;const n=this.normalizeNative(r);return iA.info("getNativeRange",n),n}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const r=this.getNativeRange();return r==null?[null,null]:[this.normalizedToRange(r),r]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&aA(this.root,document.activeElement)}normalizedToRange(e){const r=[[e.start.node,e.start.offset]];e.native.collapsed||r.push([e.end.node,e.end.offset]);const n=r.map(o=>{const[l,c]=o,u=this.scroll.find(l,!0),h=u.offset(this.scroll);return c===0?h:u instanceof ol?h+u.index(l,c):h+u.length()}),s=Math.min(Math.max(...n),this.scroll.length()-1),a=Math.min(s,...n);return new eg(a,s-a)}normalizeNative(e){if(!aA(this.root,e.startContainer)||!e.collapsed&&!aA(this.root,e.endContainer))return null;const r={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[r.start,r.end].forEach(n=>{let{node:s,offset:a}=n;for(;!(s instanceof Text)&&s.childNodes.length>0;)if(s.childNodes.length>a)s=s.childNodes[a],a=0;else if(s.childNodes.length===a)s=s.lastChild,s instanceof Text?a=s.data.length:s.childNodes.length>0?a=s.childNodes.length:a=s.childNodes.length+1;else break;n.node=s,n.offset=a}),r}rangeToNative(e){const r=this.scroll.length(),n=(s,a)=>{s=Math.min(r-1,s);const[o,l]=this.scroll.leaf(s);return o?o.position(l,a):[null,-1]};return[...n(e.index,!1),...n(e.index+e.length,!0)]}setNativeRange(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(iA.info("setNativeRange",e,r,n,s),e!=null&&(this.root.parentNode==null||e.parentNode==null||n.parentNode==null))return;const o=document.getSelection();if(o!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:l}=this.getNativeRange()||{};if(l==null||a||e!==l.startContainer||r!==l.startOffset||n!==l.endContainer||s!==l.endOffset){e instanceof Element&&e.tagName==="BR"&&(r=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),n instanceof Element&&n.tagName==="BR"&&(s=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const c=document.createRange();c.setStart(e,r),c.setEnd(n,s),o.removeAllRanges(),o.addRange(c)}}else o.removeAllRanges(),this.root.blur()}setRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:br.sources.API;if(typeof r=="string"&&(n=r,r=!1),iA.info("setRange",e),e!=null){const s=this.rangeToNative(e);this.setNativeRange(...s,r)}else this.setNativeRange(null);this.update(n)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:br.sources.USER;const r=this.lastRange,[n,s]=this.getRange();if(this.lastRange=n,this.lastNative=s,this.lastRange!=null&&(this.savedRange=this.lastRange),!z0(r,this.lastRange)){if(!this.composing&&s!=null&&s.native.collapsed&&s.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const a=[br.events.SELECTION_CHANGE,py(this.lastRange),py(r),e];this.emitter.emit(br.events.EDITOR_CHANGE,...a),e!==br.sources.SILENT&&this.emitter.emit(...a)}}}function aA(t,e){try{e.parentNode}catch{return!1}return t.contains(e)}const tLe=/^[ -~]*$/;class rLe{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let r=this.scroll.length();this.scroll.batchStart();const n=fV(e),s=new Nr;return sLe(n.ops.slice()).reduce((o,l)=>{const c=hu.Op.length(l);let u=l.attributes||{},h=!1,f=!1;if(l.insert!=null){if(s.retain(c),typeof l.insert=="string"){const y=l.insert;f=!y.endsWith(`
`)&&(r<=o||!!this.scroll.descendant(du,o)[0]),this.scroll.insertAt(o,y);const[v,w]=this.scroll.line(o);let N=sp({},cu(v));if(v instanceof Wo){const[k]=v.descendant(ol,w);k&&(N=sp(N,cu(k)))}u=hu.AttributeMap.diff(N,u)||{}}else if(typeof l.insert=="object"){const y=Object.keys(l.insert)[0];if(y==null)return o;const v=this.scroll.query(y,_r.INLINE)!=null;if(v)(r<=o||this.scroll.descendant(du,o)[0])&&(f=!0);else if(o>0){const[w,N]=this.scroll.descendant(ol,o-1);w instanceof fd?w.value()[N]!==`
`&&(h=!0):w instanceof Fc&&w.statics.scope===_r.INLINE_BLOT&&(h=!0)}if(this.scroll.insertAt(o,y,l.insert[y]),v){const[w]=this.scroll.descendant(ol,o);if(w){const N=sp({},cu(w));u=hu.AttributeMap.diff(N,u)||{}}}}r+=c}else if(s.push(l),l.retain!==null&&typeof l.retain=="object"){const y=Object.keys(l.retain)[0];if(y==null)return o;this.scroll.updateEmbedAt(o,y,l.retain[y])}Object.keys(u).forEach(y=>{this.scroll.formatAt(o,c,y,u[y])});const m=h?1:0,g=f?1:0;return r+=m+g,s.retain(m),s.delete(g),o+c+m+g},0),s.reduce((o,l)=>typeof l.delete=="number"?(this.scroll.deleteAt(o,l.delete),o):o+hu.Op.length(l),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(e,r){return this.scroll.deleteAt(e,r),this.update(new Nr().retain(e).delete(r))}formatLine(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(a=>{this.scroll.lines(e,Math.max(r,1)).forEach(o=>{o.format(a,n[a])})}),this.scroll.optimize();const s=new Nr().retain(e).retain(r,py(n));return this.update(s)}formatText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(a=>{this.scroll.formatAt(e,r,a,n[a])});const s=new Nr().retain(e).retain(r,py(n));return this.update(s)}getContents(e,r){return this.delta.slice(e,e+r)}getDelta(){return this.scroll.lines().reduce((e,r)=>e.concat(r.delta()),new Nr)}getFormat(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],s=[];r===0?this.scroll.path(e).forEach(l=>{const[c]=l;c instanceof Wo?n.push(c):c instanceof ol&&s.push(c)}):(n=this.scroll.lines(e,r),s=this.scroll.descendants(ol,e,r));const[a,o]=[n,s].map(l=>{const c=l.shift();if(c==null)return{};let u=cu(c);for(;Object.keys(u).length>0;){const h=l.shift();if(h==null)return u;u=nLe(cu(h),u)}return u});return{...a,...o}}getHTML(e,r){const[n,s]=this.scroll.line(e);if(n){const a=n.length();return n.length()>=s+r&&!(s===0&&r===a)?m2(n,s,r,!0):m2(this.scroll,e,r,!0)}return""}getText(e,r){return this.getContents(e,r).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(e,r){const n=fV(r),s=new Nr().retain(e).concat(n);return this.scroll.insertContents(e,n),this.update(s)}insertEmbed(e,r,n){return this.scroll.insertAt(e,r,n),this.update(new Nr().retain(e).insert({[r]:n}))}insertText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,r),Object.keys(n).forEach(s=>{this.scroll.formatAt(e,r.length,s,n[s])}),this.update(new Nr().retain(e).insert(r,py(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==Wo.blotName)return!1;const r=e;return r.children.length>1?!1:r.children.head instanceof vd}removeFormat(e,r){const n=this.getText(e,r),[s,a]=this.scroll.line(e+r);let o=0,l=new Nr;s!=null&&(o=s.length()-a,l=s.delta().slice(a,a+o-1).insert(`
`));const u=this.getContents(e,r+o).diff(new Nr().insert(n).concat(l)),h=new Nr().retain(e).concat(u);return this.applyDelta(h)}update(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const s=this.delta;if(r.length===1&&r[0].type==="characterData"&&r[0].target.data.match(tLe)&&this.scroll.find(r[0].target)){const a=this.scroll.find(r[0].target),o=cu(a),l=a.offset(this.scroll),c=r[0].oldValue.replace(dS.CONTENTS,""),u=new Nr().insert(c),h=new Nr().insert(a.value()),f=n&&{oldRange:pV(n.oldRange,-l),newRange:pV(n.newRange,-l)};e=new Nr().retain(l).concat(u.diff(h,f)).reduce((g,y)=>y.insert?g.insert(y.insert,o):g.push(y),new Nr),this.delta=s.compose(e)}else this.delta=this.getDelta(),(!e||!z0(s.compose(e),this.delta))&&(e=s.diff(this.delta,n));return e}}function Vx(t,e,r){if(t.length===0){const[g]=oA(r.pop());return e<=0?`</li></${g}>`:`</li></${g}>${Vx([],e-1,r)}`}const[{child:n,offset:s,length:a,indent:o,type:l},...c]=t,[u,h]=oA(l);if(o>e)return r.push(l),o===e+1?`<${u}><li${h}>${m2(n,s,a)}${Vx(c,o,r)}`:`<${u}><li>${Vx(t,e+1,r)}`;const f=r[r.length-1];if(o===e&&l===f)return`</li><li${h}>${m2(n,s,a)}${Vx(c,o,r)}`;const[m]=oA(r.pop());return`</li></${m}>${Vx(t,e-1,r)}`}function m2(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in t&&typeof t.html=="function")return t.html(e,r);if(t instanceof fd)return uS(t.value().slice(e,e+r)).replaceAll(" ","&nbsp;");if(t instanceof ad){if(t.statics.blotName==="list-container"){const u=[];return t.children.forEachAt(e,r,(h,f,m)=>{const g="formats"in h&&typeof h.formats=="function"?h.formats():{};u.push({child:h,offset:f,length:m,indent:g.indent||0,type:g.list})}),Vx(u,-1,[])}const s=[];if(t.children.forEachAt(e,r,(u,h,f)=>{s.push(m2(u,h,f))}),n||t.statics.blotName==="list")return s.join("");const{outerHTML:a,innerHTML:o}=t.domNode,[l,c]=a.split(`>${o}<`);return l==="<table"?`<table style="border: 1px solid #000;">${s.join("")}<${c}`:`${l}>${s.join("")}<${c}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function nLe(t,e){return Object.keys(e).reduce((r,n)=>{if(t[n]==null)return r;const s=e[n];return s===t[n]?r[n]=s:Array.isArray(s)?s.indexOf(t[n])<0?r[n]=s.concat([t[n]]):r[n]=s:r[n]=[s,t[n]],r},{})}function oA(t){const e=t==="ordered"?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function fV(t){return t.reduce((e,r)=>{if(typeof r.insert=="string"){const n=r.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(n,r.attributes)}return e.push(r)},new Nr)}function pV(t,e){let{index:r,length:n}=t;return new eg(r+e,n)}function sLe(t){const e=[];return t.forEach(r=>{typeof r.insert=="string"?r.insert.split(`
`).forEach((s,a)=>{a&&e.push({insert:`
`,attributes:r.attributes}),s&&e.push({insert:s,attributes:r.attributes})}):e.push(r)}),e}class jh{static DEFAULTS={};constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=r}}const fN="\uFEFF";class oM extends Fc{constructor(e,r){super(e,r),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(fN),this.rightGuard=document.createTextNode(fN),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,r){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,r)}restore(e){let r=null,n;const s=e.data.split(fN).join("");if(e===this.leftGuard)if(this.prev instanceof fd){const a=this.prev.length();this.prev.insertAt(a,s),r={startNode:this.prev.domNode,startOffset:a+s.length}}else n=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(n),this),r={startNode:n,startOffset:s.length};else e===this.rightGuard&&(this.next instanceof fd?(this.next.insertAt(0,s),r={startNode:this.next.domNode,startOffset:s.length}):(n=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(n),this.next),r={startNode:n,startOffset:s.length}));return e.data=fN,r}update(e,r){e.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const s=this.restore(n.target);s&&(r.range=s)}})}}class iLe{isComposing=!1;constructor(e,r){this.scroll=e,this.emitter=r,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const r=e.target instanceof Node?this.scroll.find(e.target,!0):null;r&&!(r instanceof oM)&&(this.emitter.emit(br.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(br.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(br.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(br.events.COMPOSITION_END,e),this.isComposing=!1}}class yb{static DEFAULTS={modules:{}};static themes={default:yb};modules={};constructor(e,r){this.quill=e,this.options=r}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const r=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new r(this.quill,this.options.modules[e]||{}),this.modules[e]}}const aLe=t=>t.parentElement||t.getRootNode().host||null,oLe=t=>{const e=t.getBoundingClientRect(),r="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,n="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*r,bottom:e.top+t.clientHeight*n,left:e.left}},pN=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},mV=(t,e,r,n,s,a)=>t<r&&e>n?0:t<r?-(r-t+s):e>n?e-t>n-r?t+s-r:e-n+a:0,lLe=(t,e)=>{const r=t.ownerDocument;let n=e,s=t;for(;s;){const a=s===r.body,o=a?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:oLe(s),l=getComputedStyle(s),c=mV(n.left,n.right,o.left,o.right,pN(l.scrollPaddingLeft),pN(l.scrollPaddingRight)),u=mV(n.top,n.bottom,o.top,o.bottom,pN(l.scrollPaddingTop),pN(l.scrollPaddingBottom));if(c||u)if(a)r.defaultView?.scrollBy(c,u);else{const{scrollLeft:h,scrollTop:f}=s;u&&(s.scrollTop+=u),c&&(s.scrollLeft+=c);const m=s.scrollLeft-h,g=s.scrollTop-f;n={left:n.left-m,top:n.top-g,right:n.right-m,bottom:n.bottom-g}}s=a||l.position==="fixed"?null:aLe(s)}},cLe=100,uLe=["block","break","cursor","inline","scroll","text"],dLe=(t,e,r)=>{const n=new Wy;return uLe.forEach(s=>{const a=e.query(s);a&&n.register(a)}),t.forEach(s=>{let a=e.query(s);a||r.error(`Cannot register "${s}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;a;)if(n.register(a),a="blotName"in a?a.requiredContainer??null:null,o+=1,o>cLe){r.error(`Cycle detected in registering blot requiredContainer: "${s}"`);break}}),n},gy=Uf("quill"),mN=new Wy;ad.uiClass="ql-ui";class St{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:mN,theme:"default"};static events=br.events;static sources=br.sources;static version="2.0.3";static imports={delta:Nr,parchment:HPe,"core/module":jh,"core/theme":yb};static debug(e){e===!0&&(e="log"),Uf.level(e)}static find(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return x8.get(e)||mN.find(e,r)}static import(e){return this.imports[e]==null&&gy.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],r=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in e?e.attrName:e.blotName;typeof n=="string"?this.register(`formats/${n}`,e,r):Object.keys(e).forEach(s=>{this.register(s,e[s],r)})}else{const e=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!n&&gy.warn(`Overwriting ${e} with`,r),this.imports[e]=r,(e.startsWith("blots/")||e.startsWith("formats/"))&&r&&typeof r!="boolean"&&r.blotName!=="abstract"&&mN.register(r),typeof r.register=="function"&&r.register(mN)}}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=hLe(e,r),this.container=this.options.container,this.container==null){gy.error("Invalid Quill container",e);return}this.options.debug&&St.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",x8.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new br;const s=aM.blotName,a=this.options.registry.query(s);if(!a||!("blotName"in a))throw new Error(`Cannot initialize Quill without "${s}" blot`);if(this.scroll=new a(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new rLe(this.scroll),this.selection=new eLe(this.scroll,this.emitter),this.composition=new iLe(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(br.events.EDITOR_CHANGE,o=>{o===br.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(br.events.SCROLL_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),h=c&&u?{oldRange:c,newRange:u}:void 0;zu.call(this,()=>this.editor.update(null,l,h),o)}),this.emitter.on(br.events.SCROLL_EMBED_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),h=c&&u?{oldRange:c,newRange:u}:void 0;zu.call(this,()=>{const f=new Nr().retain(o.offset(this)).retain({[o.statics.blotName]:l});return this.editor.update(f,[],h)},St.sources.USER)}),n){const o=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const n=e;e=document.createElement("div"),e.classList.add(n)}return this.container.insertBefore(e,r),e}blur(){this.selection.setRange(null)}deleteText(e,r,n){return[e,r,,n]=Wh(e,r,n),zu.call(this,()=>this.editor.deleteText(e,r),n,e,-1*r)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const r=e();return this.allowReadOnlyEdits=!1,r}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:br.sources.API;return zu.call(this,()=>{const s=this.getSelection(!0);let a=new Nr;if(s==null)return a;if(this.scroll.query(e,_r.BLOCK))a=this.editor.formatLine(s.index,s.length,{[e]:r});else{if(s.length===0)return this.selection.format(e,r),a;a=this.editor.formatText(s.index,s.length,{[e]:r})}return this.setSelection(s,br.sources.SILENT),a},n)}formatLine(e,r,n,s,a){let o;return[e,r,o,a]=Wh(e,r,n,s,a),zu.call(this,()=>this.editor.formatLine(e,r,o),a,e,0)}formatText(e,r,n,s,a){let o;return[e,r,o,a]=Wh(e,r,n,s,a),zu.call(this,()=>this.editor.formatText(e,r,o),a,e,0)}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof e=="number"?n=this.selection.getBounds(e,r):n=this.selection.getBounds(e.index,e.length),!n)return null;const s=this.container.getBoundingClientRect();return{bottom:n.bottom-s.top,height:n.height,left:n.left-s.left,right:n.right-s.left,top:n.top-s.top,width:n.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,r]=Wh(e,r),this.editor.getContents(e,r)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,r):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,r)}getModule(e){return this.theme.modules[e]}getSelection(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=Wh(e,r),this.editor.getHTML(e,r)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=Wh(e,r),this.editor.getText(e,r)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:St.sources.API;return zu.call(this,()=>this.editor.insertEmbed(e,r,n),s,e)}insertText(e,r,n,s,a){let o;return[e,,o,a]=Wh(e,0,n,s,a),zu.call(this,()=>this.editor.insertText(e,r,o),a,e,r.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,r,n){return[e,r,,n]=Wh(e,r,n),zu.call(this,()=>this.editor.removeFormat(e,r),n,e)}scrollRectIntoView(e){lLe(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,r=e&&this.selection.getBounds(e.index,e.length);r&&this.scrollRectIntoView(r)}setContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br.sources.API;return zu.call(this,()=>{e=new Nr(e);const n=this.getLength(),s=this.editor.deleteText(0,n),a=this.editor.insertContents(0,e),o=this.editor.deleteText(this.getLength()-1,1);return s.compose(a).compose(o)},r)}setSelection(e,r,n){e==null?this.selection.setRange(null,r||St.sources.API):([e,r,,n]=Wh(e,r,n),this.selection.setRange(new eg(Math.max(0,e),r),n),n!==br.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br.sources.API;const n=new Nr().insert(e);return this.setContents(n,r)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:br.sources.USER;const r=this.scroll.update(e);return this.selection.update(e),r}updateContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br.sources.API;return zu.call(this,()=>(e=new Nr(e),this.editor.applyDelta(e)),r,!0)}}function gV(t){return typeof t=="string"?document.querySelector(t):t}function lA(t){return Object.entries(t??{}).reduce((e,r)=>{let[n,s]=r;return{...e,[n]:s===!0?{}:s}},{})}function xV(t){return Object.fromEntries(Object.entries(t).filter(e=>e[1]!==void 0))}function hLe(t,e){const r=gV(t);if(!r)throw new Error("Invalid Quill container");const s=!e.theme||e.theme===St.DEFAULTS.theme?yb:St.import(`themes/${e.theme}`);if(!s)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:a,...o}=St.DEFAULTS,{modules:l,...c}=s.DEFAULTS;let u=lA(e.modules);u!=null&&u.toolbar&&u.toolbar.constructor!==Object&&(u={...u,toolbar:{container:u.toolbar}});const h=sp({},lA(a),lA(l),u),f={...o,...xV(c),...xV(e)};let m=e.registry;return m?e.formats&&gy.warn('Ignoring "formats" option because "registry" is specified'):m=e.formats?dLe(e.formats,f.registry,gy):f.registry,{...f,registry:m,container:r,theme:s,modules:Object.entries(h).reduce((g,y)=>{let[v,w]=y;if(!w)return g;const N=St.import(`modules/${v}`);return N==null?(gy.error(`Cannot load ${v} module. Are you sure you registered it?`),g):{...g,[v]:sp({},N.DEFAULTS||{},w)}},{}),bounds:gV(f.bounds)}}function zu(t,e,r,n){if(!this.isEnabled()&&e===br.sources.USER&&!this.allowReadOnlyEdits)return new Nr;let s=r==null?null:this.getSelection();const a=this.editor.delta,o=t();if(s!=null&&(r===!0&&(r=s.index),n==null?s=yV(s,o,e):n!==0&&(s=yV(s,r,n,e)),this.setSelection(s,br.sources.SILENT)),o.length()>0){const l=[br.events.TEXT_CHANGE,o,a,e];this.emitter.emit(br.events.EDITOR_CHANGE,...l),e!==br.sources.SILENT&&this.emitter.emit(...l)}return o}function Wh(t,e,r,n,s){let a={};return typeof t.index=="number"&&typeof t.length=="number"?typeof e!="number"?(s=n,n=r,r=e,e=t.length,t=t.index):(e=t.length,t=t.index):typeof e!="number"&&(s=n,n=r,r=e,e=0),typeof r=="object"?(a=r,s=n):typeof r=="string"&&(n!=null?a[r]=n:s=r),s=s||br.sources.API,[t,e,a,s]}function yV(t,e,r,n){const s=typeof r=="number"?r:0;if(t==null)return null;let a,o;return e&&typeof e.transformPosition=="function"?[a,o]=[t.index,t.index+t.length].map(l=>e.transformPosition(l,n!==br.sources.USER)):[a,o]=[t.index,t.index+t.length].map(l=>l<e||l===e&&n===br.sources.USER?l:s>=0?l+s:Math.max(e,l+s)),new eg(a,o-a)}class _g extends cS{}function bV(t){return t instanceof Wo||t instanceof du}function vV(t){return typeof t.updateContent=="function"}class fLe extends aM{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Wo;static allowedChildren=[Wo,du,_g];constructor(e,r,n){let{emitter:s}=n;super(e,r),this.emitter=s,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",a=>this.handleDragStart(a))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(br.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(br.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,r){this.emitter.emit(br.events.SCROLL_EMBED_UPDATE,e,r)}deleteAt(e,r){const[n,s]=this.line(e),[a]=this.line(e+r);if(super.deleteAt(e,r),a!=null&&n!==a&&s>0){if(n instanceof du||a instanceof du){this.optimize();return}const o=a.children.head instanceof vd?null:a.children.head;n.moveChildren(a,o),n.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,r,n,s){super.formatAt(e,r,n,s),this.optimize()}insertAt(e,r,n){if(e>=this.length())if(n==null||this.scroll.query(r,_r.BLOCK)==null){const s=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(s),n==null&&r.endsWith(`
`)?s.insertAt(0,r.slice(0,-1),n):s.insertAt(0,r,n)}else{const s=this.scroll.create(r,n);this.appendChild(s)}else super.insertAt(e,r,n);this.optimize()}insertBefore(e,r){if(e.statics.scope===_r.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(e),super.insertBefore(n,r)}else super.insertBefore(e,r)}insertContents(e,r){const n=this.deltaToRenderBlocks(r.concat(new Nr().insert(`
`))),s=n.pop();if(s==null)return;this.batchStart();const a=n.shift();if(a){const c=a.type==="block"&&(a.delta.length()===0||!this.descendant(du,e)[0]&&e<this.length()),u=a.type==="block"?a.delta:new Nr().insert({[a.key]:a.value});cA(this,e,u);const h=a.type==="block"?1:0,f=e+u.length()+h;c&&this.insertAt(f-1,`
`);const m=cu(this.line(e)[0]),g=hu.AttributeMap.diff(m,a.attributes)||{};Object.keys(g).forEach(y=>{this.formatAt(f-1,1,y,g[y])}),e=f}let[o,l]=this.children.find(e);if(n.length&&(o&&(o=o.split(l),l=0),n.forEach(c=>{if(c.type==="block"){const u=this.createBlock(c.attributes,o||void 0);cA(u,0,c.delta)}else{const u=this.create(c.key,c.value);this.insertBefore(u,o||void 0),Object.keys(c.attributes).forEach(h=>{u.format(h,c.attributes[h])})}})),s.type==="block"&&s.delta.length()){const c=o?o.offset(o.scroll)+l:this.length();cA(this,c,s.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const r=this.path(e).pop();if(!r)return[null,-1];const[n,s]=r;return n instanceof ol?[n,s]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(bV,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(s,a,o)=>{let l=[],c=o;return s.children.forEachAt(a,o,(u,h,f)=>{bV(u)?l.push(u):u instanceof cS&&(l=l.concat(n(u,h,c))),c-=f}),l};return n(this,e,r)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,r),e.length>0&&this.emitter.emit(br.events.SCROLL_OPTIMIZE,e,r))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let r=br.sources.USER;typeof e=="string"&&(r=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(n=>{let{target:s}=n;const a=this.find(s,!0);return a&&!vV(a)}),e.length>0&&this.emitter.emit(br.events.SCROLL_BEFORE_UPDATE,r,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(br.events.SCROLL_UPDATE,r,e)}updateEmbedAt(e,r,n){const[s]=this.descendant(a=>a instanceof du,e);s&&s.statics.blotName===r&&vV(s)&&s.updateContent(n)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const r=[];let n=new Nr;return e.forEach(s=>{const a=s?.insert;if(a)if(typeof a=="string"){const o=a.split(`
`);o.slice(0,-1).forEach(c=>{n.insert(c,s.attributes),r.push({type:"block",delta:n,attributes:s.attributes??{}}),n=new Nr});const l=o[o.length-1];l&&n.insert(l,s.attributes)}else{const o=Object.keys(a)[0];if(!o)return;this.query(o,_r.INLINE)?n.push(s):(n.length()&&r.push({type:"block",delta:n,attributes:{}}),n=new Nr,r.push({type:"blockEmbed",key:o,value:a[o],attributes:s.attributes??{}}))}}),n.length()&&r.push({type:"block",delta:n,attributes:{}}),r}createBlock(e,r){let n;const s={};Object.entries(e).forEach(l=>{let[c,u]=l;this.query(c,_r.BLOCK&_r.BLOT)!=null?n=c:s[c]=u});const a=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(a,r||void 0);const o=a.length();return Object.entries(s).forEach(l=>{let[c,u]=l;a.formatAt(0,o,c,u)}),a}}function cA(t,e,r){r.reduce((n,s)=>{const a=hu.Op.length(s);let o=s.attributes||{};if(s.insert!=null){if(typeof s.insert=="string"){const l=s.insert;t.insertAt(n,l);const[c]=t.descendant(ol,n),u=cu(c);o=hu.AttributeMap.diff(u,o)||{}}else if(typeof s.insert=="object"){const l=Object.keys(s.insert)[0];if(l==null)return n;if(t.insertAt(n,l,s.insert[l]),t.scroll.query(l,_r.INLINE)!=null){const[u]=t.descendant(ol,n),h=cu(u);o=hu.AttributeMap.diff(h,o)||{}}}}return Object.keys(o).forEach(l=>{t.formatAt(n,a,l,o[l])}),n+a},e)}const lM={scope:_r.BLOCK,whitelist:["right","center","justify"]},pLe=new fh("align","align",lM),zse=new bd("align","ql-align",lM),Vse=new jp("align","text-align",lM);class qse extends jp{value(e){let r=super.value(e);return r.startsWith("rgb(")?(r=r.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${r.split(",").map(s=>`00${parseInt(s,10).toString(16)}`.slice(-2)).join("")}`):r}}const mLe=new bd("color","ql-color",{scope:_r.INLINE}),cM=new qse("color","color",{scope:_r.INLINE}),gLe=new bd("background","ql-bg",{scope:_r.INLINE}),uM=new qse("background","background-color",{scope:_r.INLINE});class Sg extends _g{static create(e){const r=super.create(e);return r.setAttribute("spellcheck","false"),r}code(e,r){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(e,e+r)}html(e,r){return`<pre>
${uS(this.code(e,r))}
</pre>`}}class Al extends Wo{static TAB="  ";static register(){St.register(Sg)}}class dM extends vl{}dM.blotName="code";dM.tagName="CODE";Al.blotName="code-block";Al.className="ql-code-block";Al.tagName="DIV";Sg.blotName="code-block-container";Sg.className="ql-code-block-container";Sg.tagName="DIV";Sg.allowedChildren=[Al];Al.allowedChildren=[fd,vd,dS];Al.requiredContainer=Sg;const hM={scope:_r.BLOCK,whitelist:["rtl"]},Hse=new fh("direction","dir",hM),Wse=new bd("direction","ql-direction",hM),Gse=new jp("direction","direction",hM),Kse={scope:_r.INLINE,whitelist:["serif","monospace"]},Yse=new bd("font","ql-font",Kse);class xLe extends jp{value(e){return super.value(e).replace(/["']/g,"")}}const Xse=new xLe("font","font-family",Kse),Qse=new bd("size","ql-size",{scope:_r.INLINE,whitelist:["small","large","huge"]}),Jse=new jp("size","font-size",{scope:_r.INLINE,whitelist:["10px","18px","32px"]}),yLe=Uf("quill:keyboard"),bLe=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class hS extends jh{static match(e,r){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!r[n]!==e[n]&&r[n]!==null)?!1:r.key===e.key||r.key===e.which}constructor(e,r){super(e,r),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=wLe(e);if(s==null){yLe.warn("Attempted to add invalid keyboard binding",s);return}typeof r=="function"&&(r={handler:r}),typeof n=="function"&&(n={handler:n}),(Array.isArray(s.key)?s.key:[s.key]).forEach(o=>{const l={...s,key:o,...r,...n};this.bindings[l.key]=this.bindings[l.key]||[],this.bindings[l.key].push(l)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const s=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(N=>hS.match(e,N));if(s.length===0)return;const a=St.find(e.target,!0);if(a&&a.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[l,c]=this.quill.getLine(o.index),[u,h]=this.quill.getLeaf(o.index),[f,m]=o.length===0?[u,h]:this.quill.getLeaf(o.index+o.length),g=u instanceof H4?u.value().slice(0,h):"",y=f instanceof H4?f.value().slice(m):"",v={collapsed:o.length===0,empty:o.length===0&&l.length()<=1,format:this.quill.getFormat(o),line:l,offset:c,prefix:g,suffix:y,event:e};s.some(N=>{if(N.collapsed!=null&&N.collapsed!==v.collapsed||N.empty!=null&&N.empty!==v.empty||N.offset!=null&&N.offset!==v.offset)return!1;if(Array.isArray(N.format)){if(N.format.every(k=>v.format[k]==null))return!1}else if(typeof N.format=="object"&&!Object.keys(N.format).every(k=>N.format[k]===!0?v.format[k]!=null:N.format[k]===!1?v.format[k]==null:z0(N.format[k],v.format[k])))return!1;return N.prefix!=null&&!N.prefix.test(v.prefix)||N.suffix!=null&&!N.suffix.test(v.suffix)?!1:N.handler.call(this,o,v,N)!==!0})&&e.preventDefault()})}handleBackspace(e,r){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(r.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let s={};const[a]=this.quill.getLine(e.index);let o=new Nr().retain(e.index-n).delete(n);if(r.offset===0){const[l]=this.quill.getLine(e.index-1);if(l&&!(l.statics.blotName==="block"&&l.length()<=1)){const u=a.formats(),h=this.quill.getFormat(e.index-1,1);if(s=hu.AttributeMap.diff(u,h)||{},Object.keys(s).length>0){const f=new Nr().retain(e.index+a.length()-2).retain(1,s);o=o.compose(f)}}}this.quill.updateContents(o,St.sources.USER),this.quill.focus()}handleDelete(e,r){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(r.suffix)?2:1;if(e.index>=this.quill.getLength()-n)return;let s={};const[a]=this.quill.getLine(e.index);let o=new Nr().retain(e.index).delete(n);if(r.offset>=a.length()-1){const[l]=this.quill.getLine(e.index+1);if(l){const c=a.formats(),u=this.quill.getFormat(e.index,1);s=hu.AttributeMap.diff(c,u)||{},Object.keys(s).length>0&&(o=o.retain(l.length()-1).retain(1,s))}}this.quill.updateContents(o,St.sources.USER),this.quill.focus()}handleDeleteRange(e){fM({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,r){const n=Object.keys(r.format).reduce((a,o)=>(this.quill.scroll.query(o,_r.BLOCK)&&!Array.isArray(r.format[o])&&(a[o]=r.format[o]),a),{}),s=new Nr().retain(e.index).delete(e.length).insert(`
`,n);this.quill.updateContents(s,St.sources.USER),this.quill.setSelection(e.index+1,St.sources.SILENT),this.quill.focus()}}const vLe={bindings:{bold:uA("bold"),italic:uA("italic"),underline:uA("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",St.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",St.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){e.format.indent!=null?this.quill.format("indent","-1",St.sources.USER):e.format.list!=null&&this.quill.format("list",!1,St.sources.USER)}},"indent code-block":wV(!0),"outdent code-block":wV(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,St.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const r=new Nr().retain(t.index).delete(t.length).insert("	");return this.quill.updateContents(r,St.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,St.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,St.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const r={list:!1};e.format.indent&&(r.indent=!1),this.quill.formatLine(t.index,t.length,r,St.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,r]=this.quill.getLine(t.index),n={...e.formats(),list:"checked"},s=new Nr().retain(t.index).insert(`
`,n).retain(e.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(s,St.sources.USER),this.quill.setSelection(t.index+1,St.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[r,n]=this.quill.getLine(t.index),s=new Nr().retain(t.index).insert(`
`,e.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(s,St.sources.USER),this.quill.setSelection(t.index+1,St.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[r,n,s,a]=e.getTable(t),o=NLe(r,n,s,a);if(o==null)return;let l=r.offset();if(o<0){const c=new Nr().retain(l).insert(`
`);this.quill.updateContents(c,St.sources.USER),this.quill.setSelection(t.index+1,t.length,St.sources.SILENT)}else if(o>0){l+=r.length();const c=new Nr().retain(l).insert(`
`);this.quill.updateContents(c,St.sources.USER),this.quill.setSelection(l,St.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:r,line:n}=e,s=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(s-1,St.sources.USER):this.quill.setSelection(s+n.length(),St.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query("list")==null)return!0;const{length:r}=e.prefix,[n,s]=this.quill.getLine(t.index);if(s>r)return!0;let a;switch(e.prefix.trim()){case"[]":case"[ ]":a="unchecked";break;case"[x]":a="checked";break;case"-":case"*":a="bullet";break;default:a="ordered"}this.quill.insertText(t.index," ",St.sources.USER),this.quill.history.cutoff();const o=new Nr().retain(t.index-s).delete(r+1).retain(n.length()-2-s).retain(1,{list:a});return this.quill.updateContents(o,St.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-r,St.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,r]=this.quill.getLine(t.index);let n=2,s=e;for(;s!=null&&s.length()<=1&&s.formats()["code-block"];)if(s=s.prev,n-=1,n<=0){const a=new Nr().retain(t.index+e.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(a,St.sources.USER),this.quill.setSelection(t.index-1,St.sources.SILENT),!1}return!0}},"embed left":gN("ArrowLeft",!1),"embed left shift":gN("ArrowLeft",!0),"embed right":gN("ArrowRight",!1),"embed right shift":gN("ArrowRight",!0),"table down":NV(!1),"table up":NV(!0)}};hS.DEFAULTS=vLe;function wV(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,r){let{event:n}=r;const s=this.quill.scroll.query("code-block"),{TAB:a}=s;if(e.length===0&&!n.shiftKey){this.quill.insertText(e.index,a,St.sources.USER),this.quill.setSelection(e.index+a.length,St.sources.SILENT);return}const o=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:l,length:c}=e;o.forEach((u,h)=>{t?(u.insertAt(0,a),h===0?l+=a.length:c+=a.length):u.domNode.textContent.startsWith(a)&&(u.deleteAt(0,a.length),h===0?l-=a.length:c-=a.length)}),this.quill.update(St.sources.USER),this.quill.setSelection(l,c,St.sources.SILENT)}}}function gN(t,e){return{key:t,shiftKey:e,altKey:null,[t==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:s}=n;t==="ArrowRight"&&(s+=n.length+1);const[a]=this.quill.getLeaf(s);return a instanceof Fc?(t==="ArrowLeft"?e?this.quill.setSelection(n.index-1,n.length+1,St.sources.USER):this.quill.setSelection(n.index-1,St.sources.USER):e?this.quill.setSelection(n.index,n.length+1,St.sources.USER):this.quill.setSelection(n.index+n.length+1,St.sources.USER),!1):!0}}}function uA(t){return{key:t[0],shortKey:!0,handler(e,r){this.quill.format(t,!r.format[t],St.sources.USER)}}}function NV(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,r){const n=t?"prev":"next",s=r.line,a=s.parent[n];if(a!=null){if(a.statics.blotName==="table-row"){let o=a.children.head,l=s;for(;l.prev!=null;)l=l.prev,o=o.next;const c=o.offset(this.quill.scroll)+Math.min(r.offset,o.length()-1);this.quill.setSelection(c,0,St.sources.USER)}}else{const o=s.table()[n];o!=null&&(t?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,St.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,St.sources.USER))}return!1}}}function wLe(t){if(typeof t=="string"||typeof t=="number")t={key:t};else if(typeof t=="object")t=py(t);else return null;return t.shortKey&&(t[bLe]=t.shortKey,delete t.shortKey),t}function fM(t){let{quill:e,range:r}=t;const n=e.getLines(r);let s={};if(n.length>1){const a=n[0].formats(),o=n[n.length-1].formats();s=hu.AttributeMap.diff(o,a)||{}}e.deleteText(r,St.sources.USER),Object.keys(s).length>0&&e.formatLine(r.index,1,s,St.sources.USER),e.setSelection(r.index,St.sources.SILENT)}function NLe(t,e,r,n){return e.prev==null&&e.next==null?r.prev==null&&r.next==null?n===0?-1:1:r.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const jLe=/font-weight:\s*normal/,kLe=["P","OL","UL"],jV=t=>t&&kLe.includes(t.tagName),_Le=t=>{Array.from(t.querySelectorAll("br")).filter(e=>jV(e.previousElementSibling)&&jV(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},SLe=t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(jLe)).forEach(e=>{const r=t.createDocumentFragment();r.append(...e.childNodes),e.parentNode?.replaceChild(r,e)})};function CLe(t){t.querySelector('[id^="docs-internal-guid-"]')&&(SLe(t),_Le(t))}const ELe=/\bmso-list:[^;]*ignore/i,ALe=/\bmso-list:[^;]*\bl(\d+)/i,TLe=/\bmso-list:[^;]*\blevel(\d+)/i,ILe=(t,e)=>{const r=t.getAttribute("style"),n=r?.match(ALe);if(!n)return null;const s=Number(n[1]),a=r?.match(TLe),o=a?Number(a[1]):1,l=new RegExp(`@list l${s}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),c=e.match(l),u=c&&c[1]==="bullet"?"bullet":"ordered";return{id:s,indent:o,type:u,element:t}},PLe=t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),r=[],n=[];e.forEach(o=>{(o.getAttribute("style")||"").match(ELe)?r.push(o):n.push(o)}),r.forEach(o=>o.parentNode?.removeChild(o));const s=t.documentElement.innerHTML,a=n.map(o=>ILe(o,s)).filter(o=>o);for(;a.length;){const o=[];let l=a.shift();for(;l;)o.push(l),l=a.length&&a[0]?.element===l.element.nextElementSibling&&a[0].id===l.id?a.shift():null;const c=document.createElement("ul");o.forEach(f=>{const m=document.createElement("li");m.setAttribute("data-list",f.type),f.indent>1&&m.setAttribute("class",`ql-indent-${f.indent-1}`),m.innerHTML=f.element.innerHTML,c.appendChild(m)});const u=o[0]?.element,{parentNode:h}=u??{};u&&h?.replaceChild(c,u),o.slice(1).forEach(f=>{let{element:m}=f;h?.removeChild(m)})}};function LLe(t){t.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&PLe(t)}const OLe=[LLe,CLe],MLe=t=>{t.documentElement&&OLe.forEach(e=>{e(t)})},RLe=Uf("quill:clipboard"),DLe=[[Node.TEXT_NODE,XLe],[Node.TEXT_NODE,_V],["br",VLe],[Node.ELEMENT_NODE,_V],[Node.ELEMENT_NODE,zLe],[Node.ELEMENT_NODE,ULe],[Node.ELEMENT_NODE,KLe],["li",WLe],["ol, ul",GLe],["pre",qLe],["tr",YLe],["b",dA("bold")],["i",dA("italic")],["strike",dA("strike")],["style",HLe]],BLe=[pLe,Hse].reduce((t,e)=>(t[e.keyName]=e,t),{}),kV=[Vse,uM,cM,Gse,Xse,Jse].reduce((t,e)=>(t[e.keyName]=e,t),{});class FLe extends jh{static DEFAULTS={matchers:[]};constructor(e,r){super(e,r),this.quill.root.addEventListener("copy",n=>this.onCaptureCopy(n,!1)),this.quill.root.addEventListener("cut",n=>this.onCaptureCopy(n,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],DLe.concat(this.options.matchers??[]).forEach(n=>{let[s,a]=n;this.addMatcher(s,a)})}addMatcher(e,r){this.matchers.push([e,r])}convert(e){let{html:r,text:n}=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s[Al.blotName])return new Nr().insert(n||"",{[Al.blotName]:s[Al.blotName]});if(!r)return new Nr().insert(n||"",s);const a=this.convertHTML(r);return gw(a,`
`)&&(a.ops[a.ops.length-1].attributes==null||s.table)?a.compose(new Nr().retain(a.length()-1).delete(1)):a}normalizeHTML(e){MLe(e)}convertHTML(e){const r=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(r);const n=r.body,s=new WeakMap,[a,o]=this.prepareMatching(n,s);return pM(this.quill.scroll,n,a,o,s)}dangerouslyPasteHTML(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:St.sources.API;if(typeof e=="string"){const s=this.convert({html:e,text:""});this.quill.setContents(s,r),this.quill.setSelection(0,St.sources.SILENT)}else{const s=this.convert({html:r,text:""});this.quill.updateContents(new Nr().retain(e).concat(s),n),this.quill.setSelection(e+s.length(),St.sources.SILENT)}}onCaptureCopy(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:s,text:a}=this.onCopy(n,r);e.clipboardData?.setData("text/plain",a),e.clipboardData?.setData("text/html",s),r&&fM({range:n,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(r=>r[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const r=this.quill.getSelection(!0);if(r==null)return;const n=e.clipboardData?.getData("text/html");let s=e.clipboardData?.getData("text/plain");if(!n&&!s){const o=e.clipboardData?.getData("text/uri-list");o&&(s=this.normalizeURIList(o))}const a=Array.from(e.clipboardData?.files||[]);if(!n&&a.length>0){this.quill.uploader.upload(r,a);return}if(n&&a.length>0){const o=new DOMParser().parseFromString(n,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(r,a);return}}this.onPaste(r,{html:n,text:s})}onCopy(e){const r=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:r}}onPaste(e,r){let{text:n,html:s}=r;const a=this.quill.getFormat(e.index),o=this.convert({text:n,html:s},a);RLe.log("onPaste",o,{text:n,html:s});const l=new Nr().retain(e.index).delete(e.length).concat(o);this.quill.updateContents(l,St.sources.USER),this.quill.setSelection(l.length()-e.length,St.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,r){const n=[],s=[];return this.matchers.forEach(a=>{const[o,l]=a;switch(o){case Node.TEXT_NODE:s.push(l);break;case Node.ELEMENT_NODE:n.push(l);break;default:Array.from(e.querySelectorAll(o)).forEach(c=>{r.has(c)?r.get(c)?.push(l):r.set(c,[l])});break}}),[n,s]}}function Cg(t,e,r,n){return n.query(e)?t.reduce((s,a)=>{if(!a.insert)return s;if(a.attributes&&a.attributes[e])return s.push(a);const o=r?{[e]:r}:{};return s.insert(a.insert,{...o,...a.attributes})},new Nr):t}function gw(t,e){let r="";for(let n=t.ops.length-1;n>=0&&r.length<e.length;--n){const s=t.ops[n];if(typeof s.insert!="string")break;r=s.insert+r}return r.slice(-1*e.length)===e}function G0(t,e){if(!(t instanceof Element))return!1;const r=e.query(t);return r&&r.prototype instanceof Fc?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}function $Le(t,e){return t.previousElementSibling&&t.nextElementSibling&&!G0(t.previousElementSibling,e)&&!G0(t.nextElementSibling,e)}const xN=new WeakMap;function Zse(t){return t==null?!1:(xN.has(t)||(t.tagName==="PRE"?xN.set(t,!0):xN.set(t,Zse(t.parentNode))),xN.get(t))}function pM(t,e,r,n,s){return e.nodeType===e.TEXT_NODE?n.reduce((a,o)=>o(e,a,t),new Nr):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((a,o)=>{let l=pM(t,o,r,n,s);return o.nodeType===e.ELEMENT_NODE&&(l=r.reduce((c,u)=>u(o,c,t),l),l=(s.get(o)||[]).reduce((c,u)=>u(o,c,t),l)),a.concat(l)},new Nr):new Nr}function dA(t){return(e,r,n)=>Cg(r,t,!0,n)}function ULe(t,e,r){const n=fh.keys(t),s=bd.keys(t),a=jp.keys(t),o={};return n.concat(s).concat(a).forEach(l=>{let c=r.query(l,_r.ATTRIBUTE);c!=null&&(o[c.attrName]=c.value(t),o[c.attrName])||(c=BLe[l],c!=null&&(c.attrName===l||c.keyName===l)&&(o[c.attrName]=c.value(t)||void 0),c=kV[l],c!=null&&(c.attrName===l||c.keyName===l)&&(c=kV[l],o[c.attrName]=c.value(t)||void 0))}),Object.entries(o).reduce((l,c)=>{let[u,h]=c;return Cg(l,u,h,r)},e)}function zLe(t,e,r){const n=r.query(t);if(n==null)return e;if(n.prototype instanceof Fc){const s={},a=n.value(t);if(a!=null)return s[n.blotName]=a,new Nr().insert(s,n.formats(t,r))}else if(n.prototype instanceof p2&&!gw(e,`
`)&&e.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return Cg(e,n.blotName,n.formats(t,r),r);return e}function VLe(t,e){return gw(e,`
`)||e.insert(`
`),e}function qLe(t,e,r){const n=r.query("code-block"),s=n&&"formats"in n&&typeof n.formats=="function"?n.formats(t,r):!0;return Cg(e,"code-block",s,r)}function HLe(){return new Nr}function WLe(t,e,r){const n=r.query(t);if(n==null||n.blotName!=="list"||!gw(e,`
`))return e;let s=-1,a=t.parentNode;for(;a!=null;)["OL","UL"].includes(a.tagName)&&(s+=1),a=a.parentNode;return s<=0?e:e.reduce((o,l)=>l.insert?l.attributes&&typeof l.attributes.indent=="number"?o.push(l):o.insert(l.insert,{indent:s,...l.attributes||{}}):o,new Nr)}function GLe(t,e,r){const n=t;let s=n.tagName==="OL"?"ordered":"bullet";const a=n.getAttribute("data-checked");return a&&(s=a==="true"?"checked":"unchecked"),Cg(e,"list",s,r)}function _V(t,e,r){if(!gw(e,`
`)){if(G0(t,r)&&(t.childNodes.length>0||t instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&t.nextSibling){let n=t.nextSibling;for(;n!=null;){if(G0(n,r))return e.insert(`
`);const s=r.query(n);if(s&&s.prototype instanceof du)return e.insert(`
`);n=n.firstChild}}}return e}function KLe(t,e,r){const n={},s=t.style||{};return s.fontStyle==="italic"&&(n.italic=!0),s.textDecoration==="underline"&&(n.underline=!0),s.textDecoration==="line-through"&&(n.strike=!0),(s.fontWeight?.startsWith("bold")||parseInt(s.fontWeight,10)>=700)&&(n.bold=!0),e=Object.entries(n).reduce((a,o)=>{let[l,c]=o;return Cg(a,l,c,r)},e),parseFloat(s.textIndent||0)>0?new Nr().insert("	").concat(e):e}function YLe(t,e,r){const n=t.parentElement?.tagName==="TABLE"?t.parentElement:t.parentElement?.parentElement;if(n!=null){const a=Array.from(n.querySelectorAll("tr")).indexOf(t)+1;return Cg(e,"table",a,r)}return e}function XLe(t,e,r){let n=t.data;if(t.parentElement?.tagName==="O:P")return e.insert(n.trim());if(!Zse(t)){if(n.trim().length===0&&n.includes(`
`)&&!$Le(t,r))return e;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(t.previousSibling==null&&t.parentElement!=null&&G0(t.parentElement,r)||t.previousSibling instanceof Element&&G0(t.previousSibling,r))&&(n=n.replace(/^ /,"")),(t.nextSibling==null&&t.parentElement!=null&&G0(t.parentElement,r)||t.nextSibling instanceof Element&&G0(t.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll(""," ")}return e.insert(n)}class QLe extends jh{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,r){super(e,r),this.quill.on(St.events.EDITOR_CHANGE,(n,s,a,o)=>{n===St.events.SELECTION_CHANGE?s&&o!==St.sources.SILENT&&(this.currentRange=s):n===St.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===St.sources.USER?this.record(s,a):this.transform(s)),this.currentRange=v8(this.currentRange,s))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",n=>{n.inputType==="historyUndo"?(this.undo(),n.preventDefault()):n.inputType==="historyRedo"&&(this.redo(),n.preventDefault())})}change(e,r){if(this.stack[e].length===0)return;const n=this.stack[e].pop();if(!n)return;const s=this.quill.getContents(),a=n.delta.invert(s);this.stack[r].push({delta:a,range:v8(n.range,a)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,St.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,r){if(e.ops.length===0)return;this.stack.redo=[];let n=e.invert(r),s=this.currentRange;const a=Date.now();if(this.lastRecorded+this.options.delay>a&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(n=n.compose(o.delta),s=o.range)}else this.lastRecorded=a;n.length()!==0&&(this.stack.undo.push({delta:n,range:s}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){SV(this.stack.undo,e),SV(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,St.sources.USER);else{const r=ZLe(this.quill.scroll,e.delta);this.quill.setSelection(r,St.sources.USER)}}}function SV(t,e){let r=e;for(let n=t.length-1;n>=0;n-=1){const s=t[n];t[n]={delta:r.transform(s.delta,!0),range:s.range&&v8(s.range,r)},r=s.delta.transform(r),t[n].delta.length()===0&&t.splice(n,1)}}function JLe(t,e){const r=e.ops[e.ops.length-1];return r==null?!1:r.insert!=null?typeof r.insert=="string"&&r.insert.endsWith(`
`):r.attributes!=null?Object.keys(r.attributes).some(n=>t.query(n,_r.BLOCK)!=null):!1}function ZLe(t,e){const r=e.reduce((s,a)=>s+(a.delete||0),0);let n=e.length()-r;return JLe(t,e)&&(n-=1),n}function v8(t,e){if(!t)return t;const r=e.transformPosition(t.index),n=e.transformPosition(t.index+t.length);return{index:r,length:n-r}}class eie extends jh{constructor(e,r){super(e,r),e.root.addEventListener("drop",n=>{n.preventDefault();let s=null;if(document.caretRangeFromPoint)s=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(n.clientX,n.clientY);s=document.createRange(),s.setStart(o.offsetNode,o.offset),s.setEnd(o.offsetNode,o.offset)}const a=s&&e.selection.normalizeNative(s);if(a){const o=e.selection.normalizedToRange(a);n.dataTransfer?.files&&this.upload(o,n.dataTransfer.files)}})}upload(e,r){const n=[];Array.from(r).forEach(s=>{s&&this.options.mimetypes?.includes(s.type)&&n.push(s)}),n.length>0&&this.options.handler.call(this,e,n)}}eie.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){if(!this.quill.scroll.query("image"))return;const r=e.map(n=>new Promise(s=>{const a=new FileReader;a.onload=()=>{s(a.result)},a.readAsDataURL(n)}));Promise.all(r).then(n=>{const s=n.reduce((a,o)=>a.insert({image:o}),new Nr().retain(t.index).delete(t.length));this.quill.updateContents(s,br.sources.USER),this.quill.setSelection(t.index+n.length,br.sources.SILENT)})}};const eOe=["insertText","insertReplacementText"];class tOe extends jh{constructor(e,r){super(e,r),e.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||e.on(St.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){fM({range:e,quill:this.quill})}replaceText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(r){const n=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new Nr().retain(e.index).insert(r,n),St.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+r.length,0,St.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!eOe.includes(e.inputType))return;const r=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!r||r.collapsed===!0)return;const n=rOe(e);if(n==null)return;const s=this.quill.selection.normalizeNative(r),a=s?this.quill.selection.normalizedToRange(s):null;a&&this.replaceText(a,n)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function rOe(t){return typeof t.data=="string"?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}const nOe=/Mac/i.test(navigator.platform),sOe=100,iOe=t=>!!(t.key==="ArrowLeft"||t.key==="ArrowRight"||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="Home"||nOe&&t.key==="a"&&t.ctrlKey===!0);class aOe extends jh{isListening=!1;selectionChangeDeadline=0;constructor(e,r){super(e,r),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,r){let{line:n,event:s}=r;if(!(n instanceof ad)||!n.uiNode)return!0;const a=getComputedStyle(n.domNode).direction==="rtl";return a&&s.key!=="ArrowRight"||!a&&s.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(s.shiftKey?1:0),St.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&iOe(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+sOe,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const r=e.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;const n=this.quill.scroll.find(r.startContainer);if(!(n instanceof ad)||!n.uiNode)return;const s=document.createRange();s.setStartAfter(n.uiNode),s.setEndAfter(n.uiNode),e.removeAllRanges(),e.addRange(s)}}St.register({"blots/block":Wo,"blots/block/embed":du,"blots/break":vd,"blots/container":_g,"blots/cursor":dS,"blots/embed":oM,"blots/inline":vl,"blots/scroll":fLe,"blots/text":fd,"modules/clipboard":FLe,"modules/history":QLe,"modules/keyboard":hS,"modules/uploader":eie,"modules/input":tOe,"modules/uiNode":aOe});class oOe extends bd{add(e,r){let n=0;if(r==="+1"||r==="-1"){const s=this.value(e)||0;n=r==="+1"?s+1:s-1}else typeof r=="number"&&(n=r);return n===0?(this.remove(e),!0):super.add(e,n.toString())}canAdd(e,r){return super.canAdd(e,r)||super.canAdd(e,parseInt(r,10))}value(e){return parseInt(super.value(e),10)||void 0}}const lOe=new oOe("indent","ql-indent",{scope:_r.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class cOe extends Wo{static blotName="blockquote";static tagName="blockquote"}class uOe extends Wo{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class xw extends _g{}xw.blotName="list-container";xw.tagName="OL";class yw extends Wo{static create(e){const r=super.create();return r.setAttribute("data-list",e),r}static formats(e){return e.getAttribute("data-list")||void 0}static register(){St.register(xw)}constructor(e,r){super(e,r);const n=r.ownerDocument.createElement("span"),s=a=>{if(!e.isEnabled())return;const o=this.statics.formats(r,e);o==="checked"?(this.format("list","unchecked"),a.preventDefault()):o==="unchecked"&&(this.format("list","checked"),a.preventDefault())};n.addEventListener("mousedown",s),n.addEventListener("touchstart",s),this.attachUI(n)}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-list",r):super.format(e,r)}}yw.blotName="list";yw.tagName="LI";xw.allowedChildren=[yw];yw.requiredContainer=xw;class mM extends vl{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class dOe extends mM{static blotName="italic";static tagName=["EM","I"]}class W4 extends vl{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const r=super.create(e);return r.setAttribute("href",this.sanitize(e)),r.setAttribute("rel","noopener noreferrer"),r.setAttribute("target","_blank"),r}static formats(e){return e.getAttribute("href")}static sanitize(e){return tie(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,r){e!==this.statics.blotName||!r?super.format(e,r):this.domNode.setAttribute("href",this.constructor.sanitize(r))}}function tie(t,e){const r=document.createElement("a");r.href=t;const n=r.href.slice(0,r.href.indexOf(":"));return e.indexOf(n)>-1}class hOe extends vl{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class fOe extends mM{static blotName="strike";static tagName=["S","STRIKE"]}class pOe extends vl{static blotName="underline";static tagName="U"}class mOe extends oM{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const r=super.create(e);return typeof e=="string"&&(window.katex.render(e,r,{throwOnError:!1,errorColor:"#f00"}),r.setAttribute("data-value",e)),r}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const CV=["alt","height","width"];let gOe=class extends Fc{static blotName="image";static tagName="IMG";static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("src",this.sanitize(e)),r}static formats(e){return CV.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return tie(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,r){CV.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}};const EV=["height","width"];class xOe extends du{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const r=super.create(e);return r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),r.setAttribute("src",this.sanitize(e)),r}static formats(e){return EV.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static sanitize(e){return W4.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,r){EV.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const o1=new bd("code-token","hljs",{scope:_r.INLINE});class Sf extends vl{static formats(e,r){for(;e!=null&&e!==r.domNode;){if(e.classList&&e.classList.contains(Al.className))return super.formats(e,r);e=e.parentNode}}constructor(e,r,n){super(e,r,n),o1.add(this.domNode,n)}format(e,r){e!==Sf.blotName?super.format(e,r):r?o1.add(this.domNode,r):(o1.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),o1.value(this.domNode)||this.unwrap()}}Sf.blotName="code-token";Sf.className="ql-token";class uu extends Al{static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("data-language",e),r}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-language",r):super.format(e,r)}replaceWith(e,r){return this.formatAt(0,this.length(),Sf.blotName,!1),super.replaceWith(e,r)}}class P1 extends Sg{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,r){e===uu.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(e,r)}))}formatAt(e,r,n,s){n===uu.blotName&&(this.forceNext=!0),super.formatAt(e,r,n,s)}highlight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const s=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,a=uu.formats(this.children.head.domNode);if(r||this.forceNext||this.cachedText!==s){if(s.trim().length>0||this.cachedText==null){const o=this.children.reduce((c,u)=>c.concat(Fse(u,!1)),new Nr),l=e(s,a);o.diff(l).reduce((c,u)=>{let{retain:h,attributes:f}=u;return h?(f&&Object.keys(f).forEach(m=>{[uu.blotName,Sf.blotName].includes(m)&&this.formatAt(c,h,m,f[m])}),c+h):c},0)}this.cachedText=s,this.forceNext=!1}}html(e,r){const[n]=this.children.find(e);return`<pre data-language="${n?uu.formats(n.domNode):"plain"}">
${uS(this.code(e,r))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const r=uu.formats(this.children.head.domNode);r!==this.uiNode.value&&(this.uiNode.value=r)}}}P1.allowedChildren=[uu];uu.requiredContainer=P1;uu.allowedChildren=[Sf,dS,fd,vd];const yOe=(t,e,r)=>{if(typeof t.versionString=="string"){const n=t.versionString.split(".")[0];if(parseInt(n,10)>=11)return t.highlight(r,{language:e}).value}return t.highlight(e,r).value};class rie extends jh{static register(){St.register(Sf,!0),St.register(uu,!0),St.register(P1,!0)}constructor(e,r){if(super(e,r),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,s)=>{let{key:a}=s;return n[a]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(St.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof P1))return;const r=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:s,label:a}=n;const o=r.ownerDocument.createElement("option");o.textContent=a,o.setAttribute("value",s),r.appendChild(o)}),r.addEventListener("change",()=>{e.format(uu.blotName,r.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(r),e.children.head&&(r.value=uu.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(St.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(St.sources.USER);const n=this.quill.getSelection();(e==null?this.quill.scroll.descendants(P1):[e]).forEach(a=>{a.highlight(this.highlightBlot,r)}),this.quill.update(St.sources.SILENT),n!=null&&this.quill.setSelection(n,St.sources.SILENT)}highlightBlot(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(r=this.languages[r]?r:"plain",r==="plain")return uS(e).split(`
`).reduce((s,a,o)=>(o!==0&&s.insert(`
`,{[Al.blotName]:r}),s.insert(a)),new Nr);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(Al.className),n.innerHTML=yOe(this.options.hljs,r,e),pM(this.quill.scroll,n,[(s,a)=>{const o=o1.value(s);return o?a.compose(new Nr().retain(a.length(),{[Sf.blotName]:o})):a}],[(s,a)=>s.data.split(`
`).reduce((o,l,c)=>(c!==0&&o.insert(`
`,{[Al.blotName]:r}),o.insert(l)),a)],new WeakMap)}}rie.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Xu extends Wo{static blotName="table";static tagName="TD";static create(e){const r=super.create();return e?r.setAttribute("data-row",e):r.setAttribute("data-row",gM()),r}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,r){e===Xu.blotName&&r?this.domNode.setAttribute("data-row",r):super.format(e,r)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class tg extends _g{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),r=this.children.tail.formats(),n=this.next.children.head.formats(),s=this.next.children.tail.formats();return e.table===r.table&&e.table===n.table&&e.table===s.table}return!1}optimize(e){super.optimize(e),this.children.forEach(r=>{if(r.next==null)return;const n=r.formats(),s=r.next.formats();if(n.table!==s.table){const a=this.splitAfter(r);a&&a.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class ip extends _g{static blotName="table-body";static tagName="TBODY"}class G4 extends _g{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(tg),r=e.reduce((n,s)=>Math.max(s.children.length,n),0);e.forEach(n=>{new Array(r-n.children.length).fill(0).forEach(()=>{let s;n.children.head!=null&&(s=Xu.formats(n.children.head.domNode));const a=this.scroll.create(Xu.blotName,s);n.appendChild(a),a.optimize()})})}cells(e){return this.rows().map(r=>r.children.at(e))}deleteColumn(e){const[r]=this.descendant(ip);r==null||r.children.head==null||r.children.forEach(n=>{const s=n.children.at(e);s?.remove()})}insertColumn(e){const[r]=this.descendant(ip);r==null||r.children.head==null||r.children.forEach(n=>{const s=n.children.at(e),a=Xu.formats(n.children.head.domNode),o=this.scroll.create(Xu.blotName,a);n.insertBefore(o,s)})}insertRow(e){const[r]=this.descendant(ip);if(r==null||r.children.head==null)return;const n=gM(),s=this.scroll.create(tg.blotName);r.children.head.children.forEach(()=>{const o=this.scroll.create(Xu.blotName,n);s.appendChild(o)});const a=r.children.at(e);r.insertBefore(s,a)}rows(){const e=this.children.head;return e==null?[]:e.children.map(r=>r)}}G4.allowedChildren=[ip];ip.requiredContainer=G4;ip.allowedChildren=[tg];tg.requiredContainer=ip;tg.allowedChildren=[Xu];Xu.requiredContainer=tg;function gM(){return`row-${Math.random().toString(36).slice(2,6)}`}class bOe extends jh{static register(){St.register(Xu),St.register(tg),St.register(ip),St.register(G4)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(G4).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,r]=this.getTable();r!=null&&(e.deleteColumn(r.cellOffset()),this.quill.update(St.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(St.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const r=e.offset();e.remove(),this.quill.update(St.sources.USER),this.quill.setSelection(r,St.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[r,n]=this.quill.getLine(e.index);if(r==null||r.statics.blotName!==Xu.blotName)return[null,null,null,-1];const s=r.parent;return[s.parent.parent,s,r,n]}insertColumn(e){const r=this.quill.getSelection();if(!r)return;const[n,s,a]=this.getTable(r);if(a==null)return;const o=a.cellOffset();n.insertColumn(o+e),this.quill.update(St.sources.USER);let l=s.rowOffset();e===0&&(l+=1),this.quill.setSelection(r.index+l,r.length,St.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const r=this.quill.getSelection();if(!r)return;const[n,s,a]=this.getTable(r);if(a==null)return;const o=s.rowOffset();n.insertRow(o+e),this.quill.update(St.sources.USER),e>0?this.quill.setSelection(r,St.sources.SILENT):this.quill.setSelection(r.index+s.children.length,r.length,St.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,r){const n=this.quill.getSelection();if(n==null)return;const s=new Array(e).fill(0).reduce(a=>{const o=new Array(r).fill(`
`).join("");return a.insert(o,{table:gM()})},new Nr().retain(n.index));this.quill.updateContents(s,St.sources.USER),this.quill.setSelection(n.index,St.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(St.events.SCROLL_OPTIMIZE,e=>{e.some(r=>["TD","TR","TBODY","TABLE"].includes(r.target.tagName)?(this.quill.once(St.events.TEXT_CHANGE,(n,s,a)=>{a===St.sources.USER&&this.balanceTables()}),!0):!1)})}}const AV=Uf("quill:toolbar");class xM extends jh{constructor(e,r){if(super(e,r),Array.isArray(this.options.container)){const n=document.createElement("div");n.setAttribute("role","toolbar"),vOe(n,this.options.container),e.container?.parentNode?.insertBefore(n,e.container),this.container=n}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){AV.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(n=>{const s=this.options.handlers?.[n];s&&this.addHandler(n,s)}),Array.from(this.container.querySelectorAll("button, select")).forEach(n=>{this.attach(n)}),this.quill.on(St.events.EDITOR_CHANGE,()=>{const[n]=this.quill.selection.getRange();this.update(n)})}addHandler(e,r){this.handlers[e]=r}attach(e){let r=Array.from(e.classList).find(s=>s.indexOf("ql-")===0);if(!r)return;if(r=r.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[r]==null&&this.quill.scroll.query(r)==null){AV.warn("ignoring attaching to nonexistent format",r,e);return}const n=e.tagName==="SELECT"?"change":"click";e.addEventListener(n,s=>{let a;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const l=e.options[e.selectedIndex];l.hasAttribute("selected")?a=!1:a=l.value||!1}else e.classList.contains("ql-active")?a=!1:a=e.value||!e.hasAttribute("value"),s.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[r]!=null)this.handlers[r].call(this,a);else if(this.quill.scroll.query(r).prototype instanceof Fc){if(a=prompt(`Enter ${r}`),!a)return;this.quill.updateContents(new Nr().retain(o.index).delete(o.length).insert({[r]:a}),St.sources.USER)}else this.quill.format(r,a,St.sources.USER);this.update(o)}),this.controls.push([r,e])}update(e){const r=e==null?{}:this.quill.getFormat(e);this.controls.forEach(n=>{const[s,a]=n;if(a.tagName==="SELECT"){let o=null;if(e==null)o=null;else if(r[s]==null)o=a.querySelector("option[selected]");else if(!Array.isArray(r[s])){let l=r[s];typeof l=="string"&&(l=l.replace(/"/g,'\\"')),o=a.querySelector(`option[value="${l}"]`)}o==null?(a.value="",a.selectedIndex=-1):o.selected=!0}else if(e==null)a.classList.remove("ql-active"),a.setAttribute("aria-pressed","false");else if(a.hasAttribute("value")){const o=r[s],l=o===a.getAttribute("value")||o!=null&&o.toString()===a.getAttribute("value")||o==null&&!a.getAttribute("value");a.classList.toggle("ql-active",l),a.setAttribute("aria-pressed",l.toString())}else{const o=r[s]!=null;a.classList.toggle("ql-active",o),a.setAttribute("aria-pressed",o.toString())}})}}xM.DEFAULTS={};function TV(t,e,r){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${e}`),n.setAttribute("aria-pressed","false"),r!=null?(n.value=r,n.setAttribute("aria-label",`${e}: ${r}`)):n.setAttribute("aria-label",e),t.appendChild(n)}function vOe(t,e){Array.isArray(e[0])||(e=[e]),e.forEach(r=>{const n=document.createElement("span");n.classList.add("ql-formats"),r.forEach(s=>{if(typeof s=="string")TV(n,s);else{const a=Object.keys(s)[0],o=s[a];Array.isArray(o)?wOe(n,a,o):TV(n,a,o)}}),t.appendChild(n)})}function wOe(t,e,r){const n=document.createElement("select");n.classList.add(`ql-${e}`),r.forEach(s=>{const a=document.createElement("option");s!==!1?a.setAttribute("value",String(s)):a.setAttribute("selected","selected"),n.appendChild(a)}),t.appendChild(n)}xM.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(t!=null)if(t.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(r=>{this.quill.scroll.query(r,_r.INLINE)!=null&&this.quill.format(r,!1,St.sources.USER)})}else this.quill.removeFormat(t.index,t.length,St.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();t==="rtl"&&e==null?this.quill.format("align","right",St.sources.USER):!t&&e==="right"&&this.quill.format("align",!1,St.sources.USER),this.quill.format("direction",t,St.sources.USER)},indent(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e),n=parseInt(r.indent||0,10);if(t==="+1"||t==="-1"){let s=t==="+1"?1:-1;r.direction==="rtl"&&(s*=-1),this.quill.format("indent",n+s,St.sources.USER)}},link(t){t===!0&&(t=prompt("Enter link URL:")),this.quill.format("link",t,St.sources.USER)},list(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e);t==="check"?r.list==="checked"||r.list==="unchecked"?this.quill.format("list",!1,St.sources.USER):this.quill.format("list","unchecked",St.sources.USER):this.quill.format("list",t,St.sources.USER)}}};const NOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',jOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',kOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',_Oe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',SOe='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',COe='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',EOe='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',AOe='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',IV='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',TOe='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',IOe='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',POe='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',LOe='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',OOe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',MOe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',ROe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',DOe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',BOe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',FOe='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',$Oe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',UOe='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',zOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',VOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',qOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',HOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',WOe='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',GOe='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',KOe='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',YOe='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',XOe='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',QOe='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',JOe='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',ZOe='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',g2={align:{"":NOe,center:jOe,right:kOe,justify:_Oe},background:SOe,blockquote:COe,bold:EOe,clean:AOe,code:IV,"code-block":IV,color:TOe,direction:{"":IOe,rtl:POe},formula:LOe,header:{1:OOe,2:MOe,3:ROe,4:DOe,5:BOe,6:FOe},italic:$Oe,image:UOe,indent:{"+1":zOe,"-1":VOe},link:qOe,list:{bullet:HOe,check:WOe,ordered:GOe},script:{sub:KOe,super:YOe},strike:XOe,table:QOe,underline:JOe,video:ZOe},eMe='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let PV=0;function LV(t,e){t.setAttribute(e,`${t.getAttribute(e)!=="true"}`)}class fS{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",r=>{switch(r.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),r.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),LV(this.label,"aria-expanded"),LV(this.options,"aria-hidden")}buildItem(e){const r=document.createElement("span");r.tabIndex="0",r.setAttribute("role","button"),r.classList.add("ql-picker-item");const n=e.getAttribute("value");return n&&r.setAttribute("data-value",n),e.textContent&&r.setAttribute("data-label",e.textContent),r.addEventListener("click",()=>{this.selectItem(r,!0)}),r.addEventListener("keydown",s=>{switch(s.key){case"Enter":this.selectItem(r,!0),s.preventDefault();break;case"Escape":this.escape(),s.preventDefault();break}}),r}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=eMe,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${PV}`,PV+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(r=>{const n=this.buildItem(r);e.appendChild(n),r.selected===!0&&this.selectItem(n)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");e!==n&&(n?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),r&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const r=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",r)}}class nie extends fS{constructor(e,r){super(e),this.label.innerHTML=r,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(e){const r=super.buildItem(e);return r.style.backgroundColor=e.getAttribute("value")||"",r}selectItem(e,r){super.selectItem(e,r);const n=this.label.querySelector(".ql-color-label"),s=e&&e.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=s:n.style.fill=s)}}class sie extends fS{constructor(e,r){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=r[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,r){super.selectItem(e,r);const n=e||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const tMe=t=>{const{overflowY:e}=getComputedStyle(t,null);return e!=="visible"&&e!=="clip"};let iie=class{constructor(e,r){this.quill=e,this.boundsContainer=r||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,tMe(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const r=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${r}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const s=this.boundsContainer.getBoundingClientRect(),a=this.root.getBoundingClientRect();let o=0;if(a.right>s.right&&(o=s.right-a.right,this.root.style.left=`${r+o}px`),a.left<s.left&&(o=s.left-a.left,this.root.style.left=`${r+o}px`),a.bottom>s.bottom){const l=a.bottom-a.top,c=e.bottom-e.top+l;this.root.style.top=`${n-c}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}};const rMe=[!1,"center","right","justify"],nMe=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],sMe=[!1,"serif","monospace"],iMe=["1","2","3",!1],aMe=["small",!1,"large","huge"];class bw extends yb{constructor(e,r){super(e,r);const n=s=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(s.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(a=>{a.container.contains(s.target)||a.close()})};e.emitter.listenDOM("click",document.body,n)}addModule(e){const r=super.addModule(e);return e==="toolbar"&&this.extendToolbar(r),r}buildButtons(e,r){Array.from(e).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(a=>{if(a.startsWith("ql-")&&(a=a.slice(3),r[a]!=null))if(a==="direction")n.innerHTML=r[a][""]+r[a].rtl;else if(typeof r[a]=="string")n.innerHTML=r[a];else{const o=n.value||"";o!=null&&r[a][o]&&(n.innerHTML=r[a][o])}})})}buildPickers(e,r){this.pickers=Array.from(e).map(s=>{if(s.classList.contains("ql-align")&&(s.querySelector("option")==null&&Pv(s,rMe),typeof r.align=="object"))return new sie(s,r.align);if(s.classList.contains("ql-background")||s.classList.contains("ql-color")){const a=s.classList.contains("ql-background")?"background":"color";return s.querySelector("option")==null&&Pv(s,nMe,a==="background"?"#ffffff":"#000000"),new nie(s,r[a])}return s.querySelector("option")==null&&(s.classList.contains("ql-font")?Pv(s,sMe):s.classList.contains("ql-header")?Pv(s,iMe):s.classList.contains("ql-size")&&Pv(s,aMe)),new fS(s)});const n=()=>{this.pickers.forEach(s=>{s.update()})};this.quill.on(br.events.EDITOR_CHANGE,n)}}bw.DEFAULTS=sp({},yb.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");t==null&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""}),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class aie extends iie{constructor(e,r){super(e,r),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;r!=null?this.textbox.value=r:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:r}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,br.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,br.sources.USER)),this.quill.root.scrollTop=r;break}case"video":e=oMe(e);case"formula":{if(!e)break;const r=this.quill.getSelection(!0);if(r!=null){const n=r.index+r.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),e,br.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",br.sources.USER),this.quill.setSelection(n+2,br.sources.USER)}break}}this.textbox.value="",this.hide()}}function oMe(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}function Pv(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(n=>{const s=document.createElement("option");n===r?s.setAttribute("selected","selected"):s.setAttribute("value",String(n)),t.appendChild(s)})}const lMe=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class cMe extends aie{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,r){super(e,r),this.quill.on(br.events.EDITOR_CHANGE,(n,s,a,o)=>{if(n===br.events.SELECTION_CHANGE)if(s!=null&&s.length>0&&o===br.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const l=this.quill.getLines(s.index,s.length);if(l.length===1){const c=this.quill.getBounds(s);c!=null&&this.position(c)}else{const c=l[l.length-1],u=this.quill.getIndex(c),h=Math.min(c.length()-1,s.index+s.length-u),f=this.quill.getBounds(new eg(u,h));f!=null&&this.position(f)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(br.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const r=this.quill.getBounds(e);r!=null&&this.position(r)}},1)})}cancel(){this.show()}position(e){const r=super.position(e),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",r!==0&&(n.style.marginLeft=`${-1*r-n.offsetWidth/2}px`),r}}class oie extends bw{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=lMe),super(e,r),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new cMe(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),g2),this.buildPickers(e.container.querySelectorAll("select"),g2))}}oie.DEFAULTS=sp({},bw.DEFAULTS,{modules:{toolbar:{handlers:{link(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1,St.sources.USER)}}}}});const uMe=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class dMe extends aie{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const r=this.linkRange;this.restoreFocus(),this.quill.formatText(r,"link",!1,br.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(br.events.SELECTION_CHANGE,(e,r,n)=>{if(e!=null){if(e.length===0&&n===br.sources.USER){const[s,a]=this.quill.scroll.descendant(W4,e.index);if(s!=null){this.linkRange=new eg(e.index-a,s.length());const o=W4.formats(s.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const l=this.quill.getBounds(this.linkRange);l!=null&&this.position(l);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class lie extends bw{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=uMe),super(e,r),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),g2),this.buildPickers(e.container.querySelectorAll("select"),g2),this.tooltip=new dMe(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(r,n)=>{e.handlers.link.call(e,!n.format.link)}))}}lie.DEFAULTS=sp({},bw.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const e=this.quill.getSelection();if(e==null||e.length===0)return;let r=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(r)&&r.indexOf("mailto:")!==0&&(r=`mailto:${r}`);const{tooltip:n}=this.quill.theme;n.edit("link",r)}else this.quill.format("link",!1,St.sources.USER)}}}}});St.register({"attributors/attribute/direction":Hse,"attributors/class/align":zse,"attributors/class/background":gLe,"attributors/class/color":mLe,"attributors/class/direction":Wse,"attributors/class/font":Yse,"attributors/class/size":Qse,"attributors/style/align":Vse,"attributors/style/background":uM,"attributors/style/color":cM,"attributors/style/direction":Gse,"attributors/style/font":Xse,"attributors/style/size":Jse},!0);St.register({"formats/align":zse,"formats/direction":Wse,"formats/indent":lOe,"formats/background":uM,"formats/color":cM,"formats/font":Yse,"formats/size":Qse,"formats/blockquote":cOe,"formats/code-block":Al,"formats/header":uOe,"formats/list":yw,"formats/bold":mM,"formats/code":dM,"formats/italic":dOe,"formats/link":W4,"formats/script":hOe,"formats/strike":fOe,"formats/underline":pOe,"formats/formula":mOe,"formats/image":gOe,"formats/video":xOe,"modules/syntax":rie,"modules/table":bOe,"modules/toolbar":xM,"themes/bubble":oie,"themes/snow":lie,"ui/icons":g2,"ui/picker":fS,"ui/icon-picker":sie,"ui/color-picker":nie,"ui/tooltip":iie},!0);class pS extends Ie.Component{constructor(e){super(e),this.editingAreaRef=b.createRef(),this.containerRef=b.createRef(),this.dirtyProps=["modules","formats","bounds","theme","children"],this.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],this.state={generation:0},this.selection=null,this.onEditorChange=(n,s,a,o)=>{n==="text-change"?this.onEditorChangeText?.(this.editor.getSemanticHTML(),s,o,this.unprivilegedEditor):n==="selection-change"&&this.onEditorChangeSelection?.(s,o,this.unprivilegedEditor)};const r=this.isControlled()?e.value:e.defaultValue;this.value=r??""}validateProps(e){if(Ie.Children.count(e.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ie.Children.count(e.children)&&Ie.Children.only(e.children)?.type==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.");if(this.lastDeltaChangeSet&&e.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")}shouldComponentUpdate(e,r){if(this.validateProps(e),!this.editor||this.state.generation!==r.generation)return!0;if("value"in e){const n=this.getEditorContents(),s=e.value??"";this.isEqualValue(s,n)||this.setEditorContents(this.editor,s)}return e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),[...this.cleanProps,...this.dirtyProps].some(n=>!z0(e[n],this.props[n]))}shouldComponentRegenerate(e){return this.dirtyProps.some(r=>!z0(e[r],this.props[r]))}componentDidMount(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())}componentWillUnmount(){this.destroyEditor()}componentDidUpdate(e,r){if(this.editor&&this.shouldComponentRegenerate(e)){const n=this.editor.getContents(),s=this.editor.getSelection();this.regenerationSnapshot={delta:n,selection:s},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.editor&&e.placeholder!==this.props.placeholder&&(this.editor.root.dataset.placeholder=this.props.placeholder||""),this.state.generation!==r.generation){const{delta:n,selection:s}=this.regenerationSnapshot;delete this.regenerationSnapshot,this.instantiateEditor();const a=this.editor;a.setContents(n),OV(()=>this.setEditorSelection(a,s))}}instantiateEditor(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())}destroyEditor(){if(!this.editor)return;this.unhookEditor(this.editor);const e=this.props.modules?.toolbar;if(!(typeof e=="object"&&e&&"container"in e&&typeof e.container=="string"||typeof e=="string")){const n=this.containerRef.current?.querySelector(".ql-toolbar");n&&n.remove()}delete this.editor}isControlled(){return"value"in this.props}getEditorConfig(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,theme:this.props.theme}}getEditor(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor}createEditor(e,r){const n=new St(e,r);return r.tabIndex!=null&&this.setEditorTabIndex(n,r.tabIndex),this.hookEditor(n),n}hookEditor(e){this.unprivilegedEditor=this.makeUnprivilegedEditor(e),e.on("editor-change",this.onEditorChange)}unhookEditor(e){e.off("editor-change",this.onEditorChange)}getEditorContents(){return this.value}getEditorSelection(){return this.selection}isDelta(e){return e&&e.ops}isEqualValue(e,r){return this.isDelta(e)&&this.isDelta(r)?z0(e.ops,r.ops):z0(e,r)}setEditorContents(e,r){this.value=r;const n=this.getEditorSelection();typeof r=="string"?e.setContents(e.clipboard.convert({html:r})):e.setContents(r),OV(()=>this.setEditorSelection(e,n))}setEditorSelection(e,r){if(this.selection=r,r){const n=e.getLength();r.index=Math.max(0,Math.min(r.index,n-1)),r.length=Math.max(0,Math.min(r.length,n-1-r.index)),e.setSelection(r)}}setEditorTabIndex(e,r){e?.scroll?.domNode&&(e.scroll.domNode.tabIndex=r)}setEditorReadOnly(e,r){r?e.disable():e.enable()}makeUnprivilegedEditor(e){const r=e;return{getHTML:()=>r.root.innerHTML,getSemanticHTML:r.getSemanticHTML.bind(r),getLength:r.getLength.bind(r),getText:r.getText.bind(r),getContents:r.getContents.bind(r),getSelection:r.getSelection.bind(r),getBounds:r.getBounds.bind(r)}}getEditingArea(){const e=this.editingAreaRef.current;if(!e)throw new Error("Cannot find element for editing area");if(e.nodeType===3)throw new Error("Editing area cannot be a text node");return e}renderEditingArea(){const{children:e,preserveWhitespace:r}=this.props,{generation:n}=this.state,s={key:n,ref:this.editingAreaRef};return Ie.Children.count(e)?Ie.cloneElement(Ie.Children.only(e),s):r?Ie.createElement("pre",{...s}):Ie.createElement("div",{...s})}render(){return Ie.createElement("div",{ref:this.containerRef,id:this.props.id,style:this.props.style,key:this.state.generation,className:`quill ${this.props.className??""}`,onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())}onEditorChangeText(e,r,n,s){if(!this.editor)return;const a=this.isDelta(this.value)?s.getContents():s.getSemanticHTML();a!==this.getEditorContents()&&(this.lastDeltaChangeSet=r,this.value=a,this.props.onChange?.(e,r,n,s))}onEditorChangeSelection(e,r,n){if(!this.editor)return;const s=this.getEditorSelection(),a=!s&&e,o=s&&!e;z0(e,s)||(this.selection=e,this.props.onChangeSelection?.(e,r,n),a?this.props.onFocus?.(e,r,n):o&&this.props.onBlur?.(s,r,n))}focus(){this.editor&&this.editor.focus()}blur(){this.editor&&(this.selection=null,this.editor.blur())}}pS.displayName="React Quill";pS.Quill=St;pS.defaultProps={theme:"snow",modules:{},readOnly:!1};function OV(t){Promise.resolve().then(t)}const hMe={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["clean"]]},MV=({value:t,onChange:e,placeholder:r,type:n="General",height:s="h-40"})=>{const{userProfile:a}=Cr(),{addToast:o}=Tn(),[l,c]=b.useState(!1),u=async()=>{const h=a?.settings?.geminiApiKey;if(!h){o("AI API Key missing in settings.","error");return}if(!t||t.replace(/<[^>]*>/g,"").trim().length<5){o("Please write a bit more first!","warning");return}c(!0);try{const f=await Nl.spruceUpText(h,t,n,a);e(f),o("Spruced up successfully!","success")}catch(f){console.error(f),o("AI failed to enhance text.","error")}finally{c(!1)}};return i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute top-2 right-2 z-10",children:i.jsxs("button",{type:"button",onClick:u,disabled:l,className:"flex items-center gap-1 text-[10px] uppercase font-bold tracking-wider bg-indigo-600/80 hover:bg-indigo-500 text-white px-3 py-1.5 rounded-full transition-all backdrop-blur-sm disabled:opacity-50 shadow-lg border border-indigo-400/30",title:"Spruce up with AI",children:[l?i.jsx("span",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Polish"]})}),i.jsx("div",{className:`bg-gray-900 border border-gray-700 rounded-lg overflow-hidden ${s} flex flex-col`,children:i.jsx(pS,{theme:"snow",value:t||"",onChange:e,modules:hMe,placeholder:r,className:"flex-1 text-white flex flex-col h-full"})}),i.jsx("style",{children:`
                .quill { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
                .ql-toolbar.ql-snow { border: none !important; border-bottom: 1px solid #374151 !important; background: #111827; flex-shrink: 0; }
                .ql-container.ql-snow { border: none !important; flex: 1; display: flex; flex-direction: column; overflow: hidden; background: transparent; }
                .ql-editor { color: #e5e7eb; flex: 1; overflow-y: auto; font-family: inherit; padding: 1rem; }
                .ql-editor.ql-blank::before { color: #6b7280; font-style: normal; font-style: italic; }
                
                /* Icon/Picker Colors */
                .ql-snow .ql-stroke { stroke: #9ca3af !important; }
                .ql-snow .ql-fill { fill: #9ca3af !important; }
                .ql-snow .ql-picker { color: #9ca3af !important; }
                .ql-snow .ql-picker-options { background-color: #1f2937 !important; border-color: #374151 !important; color: #e5e7eb !important; }
                .ql-snow .ql-picker-item:hover { color: #818cf8 !important; }
                .ql-snow .ql-picker-item.ql-selected { color: #6366f1 !important; }
            `})]})},fMe=({ticket:t,isAdmin:e,currentUserId:r,onEdit:n,onDelete:s,onVote:a,getTypeBadge:o,getStatusBadge:l})=>{const[c,u]=b.useState(!1),[h,f]=b.useState([]);return b.useEffect(()=>{c&&t.note_count>0&&h.length===0&&He.getTicketNotes(t.id).then(f).catch(console.error)},[c,t.note_count,t.id]),i.jsx("div",{className:"bg-gray-800/40 border border-white/5 rounded-lg p-4 hover:bg-gray-800/60 transition-colors group",children:i.jsxs("div",{className:"flex justify-between items-start gap-4",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[o(t.type),i.jsx("h4",{className:"text-white font-medium hover:text-indigo-300 cursor-pointer truncate",onClick:()=>(e||t.created_by===r&&t.status==="open")&&n(t),children:t.title}),l(t.status),t.epic_title&&i.jsx("span",{className:"text-[10px] bg-indigo-500/10 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/20 whitespace-nowrap",children:t.epic_title})]}),i.jsx("div",{className:`text-sm text-gray-400 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-0 [&>ul]:list-none [&>ul]:pl-0 ${c?"":"line-clamp-2"}`,dangerouslySetInnerHTML:{__html:t.description||""}}),i.jsx("button",{onClick:m=>{m.stopPropagation(),u(!c)},className:"text-xs text-indigo-400 hover:text-indigo-300 mt-1 hover:underline focus:outline-none",children:c?"Show less":"Read more..."}),i.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-500 flex-wrap",children:[i.jsxs("span",{children:["b/",t.created_by_username||"Unknown"]}),t.assigned_to&&i.jsxs("span",{className:"text-indigo-400",children:["Assigned: ",t.assigned_to_username]}),t.due_date&&i.jsxs("span",{children:["Due: ",wa(new Date(t.due_date),"MMM d")]}),t.estimated_release_date&&i.jsxs("span",{className:"text-orange-400",children:["Est. Release: ",wa(new Date(t.estimated_release_date),"MMM d")]}),t.date_released&&i.jsxs("span",{className:"text-green-400",children:["Released: ",wa(new Date(t.date_released),"MMM d")]}),t.note_count>0&&i.jsxs("span",{className:"flex items-center gap-1 text-gray-400 bg-gray-700/50 px-1.5 py-0.5 rounded",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),t.note_count," ",t.note_count===1?"Note":"Notes",t.last_note_at&&i.jsxs("span",{className:"opacity-70 ml-1",children:[" ",wa(new Date(t.last_note_at),"MMM d, h:mm a")]})]}),(e||t.created_by===r&&t.status==="open")&&i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>n(t),className:"hover:text-white transition-colors",children:["Edit ",e&&t.created_by!==r?"(Admin)":""]}),i.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this ticket?")&&s(t.id)},className:"text-gray-500 hover:text-red-400 transition-colors",children:"Delete"})]})]}),c&&h.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 space-y-2",children:[i.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase",children:"Latest Notes"}),h.map(m=>i.jsxs("div",{className:"bg-gray-900/30 p-2 rounded text-xs border border-white/5",children:[i.jsxs("div",{className:"flex justify-between text-gray-500 mb-0.5",children:[i.jsx("span",{className:"font-bold text-indigo-400",children:m.username}),i.jsx("span",{children:wa(new Date(m.created_at),"MMM d, h:mm a")})]}),i.jsx("p",{className:"text-gray-300 mb-0",children:m.note})]},m.id))]})]}),i.jsxs("div",{className:"flex flex-col items-center gap-1 pl-4 border-l border-white/5 shrink-0",children:[i.jsx("button",{onClick:()=>a(t.id),className:"text-gray-400 hover:text-indigo-400",children:""}),i.jsx("span",{className:"font-mono text-sm font-bold text-white",children:t.votes})]})]})})},pMe=({isOpen:t,onClose:e})=>{const{user:r,userProfile:n}=Cr(),[s,a]=b.useState("issues"),[o,l]=b.useState([]),[c,u]=b.useState([]),[h,f]=b.useState(!1),[m,g]=b.useState(""),[y,v]=b.useState(""),[w,N]=b.useState({title:"",description:"",type:"bug",epic_id:""}),[k,C]=b.useState(null),[I,O]=b.useState([]),[L,_]=b.useState([]),[E,M]=b.useState(""),S=r?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||n?.settings?.isAdmin||n?.settings?.permissions?.includes("manage_tickets");b.useEffect(()=>{t&&P()},[t,s]),b.useEffect(()=>{S&&t&&(async()=>{try{const q=await He.getAssignees();O(q)}catch(q){console.error(q)}})()},[S,t]),b.useEffect(()=>{k?(async()=>{try{const q=await He.getTicketNotes(k.id);_(q)}catch(q){console.error(q)}})():(_([]),M(""))},[k]);const P=async()=>{f(!0);try{if(s==="issues"){const X={};m&&(X.status=m),y&&(X.type=y);const q=await He.getTickets(X);l(q)}else if(s==="projects"||s==="new_ticket"){const X=await He.getEpics();u(X)}}catch(X){console.error("Failed to load data",X)}finally{f(!1)}},R=async X=>{X.preventDefault();try{await He.createTicket(w),N({title:"",description:"",type:"bug",epic_id:""}),a("issues"),P()}catch(q){alert("Failed to create ticket: "+q.message)}},V=async X=>{try{await He.voteTicket(X),l(o.map(q=>q.id===X?{...q,votes:(q.votes||0)+1}:q))}catch(q){console.error(q)}},ee=async X=>{try{await He.deleteTicket(X),l(o.filter(q=>q.id!==X))}catch(q){console.error("Delete error:",q),alert("Failed to delete ticket: "+q.message)}},G=async X=>{if(X.preventDefault(),!!k)try{await He.updateTicket(k.id,k),C(null),P()}catch(q){alert("Update failed: "+q.message)}},J=async X=>{if(X.preventDefault(),!!E.trim())try{const q=await He.addTicketNote(k.id,E);_([...L,q]),M("")}catch(q){alert("Failed to add note: "+q.message)}},Z=X=>{const q={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},U={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Complete - Pending Release",complete_scheduled:"Complete - Release Scheduled",complete_blocked:"Complete - Waiting on Epic",wont_fix:"Won't Fix"};return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold border ${q[X]||q.open} uppercase tracking-wider whitespace-nowrap`,children:U[X]||(X||"open").replace(/_/g," ")})},se=X=>X==="bug"?i.jsx("span",{className:"text-red-400 font-mono text-xs",children:"[BUG]"}):i.jsx("span",{className:"text-cyan-400 font-mono text-xs",children:"[FEAT]"});return t?i.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog","aria-modal":"true",children:[i.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[i.jsx("div",{className:"fixed inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity",onClick:e}),i.jsxs("div",{className:"relative z-50 inline-block align-bottom bg-gray-900 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full border border-white/10",children:[i.jsxs("div",{className:"bg-gray-800/50 px-6 py-4 border-b border-white/5 flex justify-between items-center",children:[i.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-indigo-500",children:""})," System Status & Feedback"]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("a",{href:"https://discord.gg/p4ybr8h6QV",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),i.jsx("div",{className:"bg-gray-800/30 px-6 border-b border-white/5 flex gap-6 overflow-x-auto",children:["issues","projects","new_ticket"].map(X=>i.jsxs("button",{onClick:()=>a(X),className:`py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${s===X?"border-indigo-500 text-white":"border-transparent text-gray-400 hover:text-gray-300"}`,children:[X==="issues"&&"Board & Issues",X==="projects"&&"Projects (Epics)",X==="new_ticket"&&"Review / Submit Issue"]},X))}),i.jsxs("div",{className:"p-6 min-h-[400px] max-h-[70vh] overflow-y-auto bg-gray-900",children:[s==="issues"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex gap-4 mb-4",children:[i.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:m,onChange:X=>g(X.target.value),children:[i.jsx("option",{value:"",children:"All Statuses"}),i.jsx("option",{value:"open",children:"Open"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"planned",children:"Planned"}),i.jsx("option",{value:"completed",children:"Completed"}),i.jsx("option",{value:"complete_pending",children:"Pending Release"}),i.jsx("option",{value:"complete_scheduled",children:"Release Scheduled"}),i.jsx("option",{value:"complete_blocked",children:"Waiting on Epic"}),i.jsx("option",{value:"wont_fix",children:"Won't Fix"})]}),i.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:y,onChange:X=>v(X.target.value),children:[i.jsx("option",{value:"",children:"All Types"}),i.jsx("option",{value:"bug",children:"Bugs"}),i.jsx("option",{value:"feature",children:"Features"})]}),i.jsx("button",{onClick:P,className:"text-xs text-indigo-400 hover:text-indigo-300 underline",children:"Refresh"})]}),h?i.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading issues..."}):o.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500 border border-dashed border-white/10 rounded-xl",children:["No tickets found. ",i.jsx("button",{onClick:()=>a("new_ticket"),className:"text-indigo-400 hover:underline",children:"Create one?"})]}):i.jsx("div",{className:"space-y-3",children:o.map(X=>i.jsx(fMe,{ticket:X,isAdmin:S,currentUserId:n?.id,onEdit:C,onDelete:ee,onVote:V,getTypeBadge:se,getStatusBadge:Z},X.id))})]}),s==="projects"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-gray-400 text-sm",children:"Large scale projects and goals for the platform."}),c.map(X=>i.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"text-lg font-bold text-white",children:X.title}),i.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-700 text-gray-300",children:X.status})]}),i.jsx("div",{className:"text-gray-400 text-sm mt-2 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-2 [&>ul]:list-disc [&>ul]:pl-4",dangerouslySetInnerHTML:{__html:X.description||""}}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 text-xs text-gray-500",children:[X.ticket_count||0," Tickets linked"]})]},X.id)),c.length===0&&i.jsx("div",{className:"text-gray-500 text-center py-8",children:"No active projects. Admins can create them via API for now."})]}),s==="new_ticket"&&i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsxs("form",{onSubmit:R,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Issue Type"}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${w.type==="bug"?"bg-red-500/10 border-red-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[i.jsx("input",{type:"radio",className:"hidden",value:"bug",checked:w.type==="bug",onChange:X=>N({...w,type:X.target.value})}),i.jsx("div",{className:"font-bold mb-1",children:"Bug Report"}),i.jsx("div",{className:"text-xs opacity-70",children:"Something is broken"})]}),i.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${w.type==="feature"?"bg-indigo-500/10 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[i.jsx("input",{type:"radio",className:"hidden",value:"feature",checked:w.type==="feature",onChange:X=>N({...w,type:X.target.value})}),i.jsx("div",{className:"font-bold mb-1",children:"Feature Request"}),i.jsx("div",{className:"text-xs opacity-70",children:"New idea or improvement"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),i.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",placeholder:"Short summary of the issue...",value:w.title,onChange:X=>N({...w,title:X.target.value}),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),i.jsx("div",{className:"h-64",children:i.jsx(MV,{value:w.description,onChange:X=>N({...w,description:X}),placeholder:"Detailed description, steps to reproduce, or link to screenshots...",type:"Ticket",height:"h-56"})})]}),c.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Project (Optional)"}),i.jsxs("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:w.epic_id,onChange:X=>N({...w,epic_id:X.target.value}),children:[i.jsx("option",{value:"",children:"- None -"}),c.map(X=>i.jsx("option",{value:X.id,children:X.title},X.id))]})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all",children:"Submit Issue"})})]})})]})]})]}),k&&i.jsx("div",{className:"absolute inset-0 z-[110] flex items-center justify-center p-4 bg-black/70 backdrop-blur-md",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-3xl w-full p-8 border border-white/10 shadow-3xl overflow-y-auto max-h-[90vh]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-2xl font-black text-white italic uppercase tracking-tight",children:S?"Edit Ticket (Admin)":"Edit Your Ticket"}),i.jsx("button",{onClick:()=>C(null),className:"text-gray-500 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("form",{onSubmit:G,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Issue Type"}),i.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:k.type,onChange:X=>C({...k,type:X.target.value}),children:[i.jsx("option",{value:"bug",children:"Bug Report"}),i.jsx("option",{value:"feature",children:"Feature Request"})]})]}),S&&i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Status"}),i.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:k.status,onChange:X=>C({...k,status:X.target.value}),children:[i.jsx("option",{value:"open",children:"Open"}),i.jsx("option",{value:"planned",children:"Planned"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"completed",children:"Completed"}),i.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),i.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),i.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),i.jsx("option",{value:"wont_fix",children:"Won't Fix"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Title"}),i.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:k.title,onChange:X=>C({...k,title:X.target.value}),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Description"}),i.jsx("div",{className:"h-64",children:i.jsx(MV,{value:k.description,onChange:X=>C({...k,description:X}),placeholder:"Update description...",type:"Ticket",height:"h-56"})})]}),S&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Project (Epic)"}),i.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:k.epic_id||"",onChange:X=>C({...k,epic_id:X.target.value||null}),children:[i.jsx("option",{value:"",children:"None"}),c.map(X=>i.jsx("option",{value:X.id,children:X.title},X.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Assignee"}),i.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:k.assigned_to||"",onChange:X=>C({...k,assigned_to:X.target.value||null}),children:[i.jsx("option",{value:"",children:"- Unassigned -"}),I.map(X=>i.jsx("option",{value:X.id,children:X.username},X.id))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Due Date"}),i.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:k.due_date?wa(new Date(k.due_date),"yyyy-MM-dd"):"",onChange:X=>C({...k,due_date:X.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Completion"}),i.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:k.est_completion_date?wa(new Date(k.est_completion_date),"yyyy-MM-dd"):"",onChange:X=>C({...k,est_completion_date:X.target.value})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Release"}),i.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:k.estimated_release_date?wa(new Date(k.estimated_release_date),"yyyy-MM-dd"):"",onChange:X=>C({...k,estimated_release_date:X.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Date Released"}),i.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:k.date_released?wa(new Date(k.date_released),"yyyy-MM-dd"):"",onChange:X=>C({...k,date_released:X.target.value})})]})]})]}),i.jsxs("div",{className:"border-t border-white/10 pt-6 mt-6",children:[i.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4",children:"Internal Notes"}),i.jsxs("div",{className:"space-y-3 max-h-48 overflow-y-auto mb-4 custom-scrollbar",children:[L.length===0&&i.jsx("p",{className:"text-xs text-gray-600 italic",children:"No notes yet."}),L.map(X=>i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[i.jsx("span",{className:"font-bold text-indigo-400 uppercase tracking-widest",children:X.username}),i.jsx("span",{children:wa(new Date(X.created_at),"MMM d, h:mm a")})]}),i.jsx("p",{className:"text-sm text-gray-300",children:X.note})]},X.id))]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",className:"flex-1 bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",placeholder:"Add a note...",value:E,onChange:X=>M(X.target.value),onKeyDown:X=>X.key==="Enter"&&(X.preventDefault(),J(X))}),i.jsx("button",{type:"button",onClick:J,className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white text-xs font-bold uppercase tracking-widest rounded-xl transition-all",children:"Add"})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[i.jsx("button",{type:"button",onClick:()=>C(null),className:"px-6 py-3 text-gray-500 font-bold uppercase tracking-widest text-xs hover:text-white transition-colors",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-indigo-500/20 transition-all",children:"Save Changes"})]})]})]})})]}):null};function Ij(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ij=function(e){return typeof e}:Ij=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ij(t)}var cie="clover",mMe=function(e){return e===3?"v3":e},uie="https://js.stripe.com",gMe="".concat(uie,"/").concat(cie,"/stripe.js"),xMe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,yMe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var bMe=function(e){return xMe.test(e)||yMe.test(e)},vMe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(uie,'"]')),r=0;r<e.length;r++){var n=e[r];if(bMe(n.src))return n}return null},RV=function(e){var r="",n=document.createElement("script");n.src="".concat(gMe).concat(r);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},wMe=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.6.4",startTime:r})},Lv=null,yN=null,bN=null,NMe=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},jMe=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},kMe=function(e){return Lv!==null?Lv:(Lv=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var s=vMe();if(!(s&&e)){if(!s)s=RV(e);else if(s&&bN!==null&&yN!==null){var a;s.removeEventListener("load",bN),s.removeEventListener("error",yN),(a=s.parentNode)===null||a===void 0||a.removeChild(s),s=RV(e)}}bN=jMe(r,n),yN=NMe(n),s.addEventListener("load",bN),s.addEventListener("error",yN)}catch(o){n(o);return}}),Lv.catch(function(r){return Lv=null,Promise.reject(r)}))},_Me=function(e,r,n){if(e===null)return null;var s=r[0];if(typeof s!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(Ij(s)," instead."));var a=s.match(/^pk_test/),o=mMe(e.version),l=cie;a&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.6.4"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,r);return wMe(c,n),c},Ov,die=!1,hie=function(){return Ov||(Ov=kMe(null).catch(function(e){return Ov=null,Promise.reject(e)}),Ov)};Promise.resolve().then(function(){return hie()}).catch(function(t){die||console.warn(t)});var SMe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];die=!0;var s=Date.now();return hie().then(function(a){return _Me(a,r,s)})},CMe=$O();const Hs=Pl(CMe);function DV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function BV(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DV(Object(r),!0).forEach(function(n){fie(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Pj(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pj=function(e){return typeof e}:Pj=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pj(t)}function fie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EMe(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function AMe(t,e){if(t==null)return{};var r=EMe(t,e),n,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function pie(t,e){return TMe(t)||IMe(t,e)||PMe(t,e)||LMe()}function TMe(t){if(Array.isArray(t))return t}function IMe(t,e){var r=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(r!=null){var n=[],s=!0,a=!1,o,l;try{for(r=r.call(t);!(s=(o=r.next()).done)&&(n.push(o.value),!(e&&n.length===e));s=!0);}catch(c){a=!0,l=c}finally{try{!s&&r.return!=null&&r.return()}finally{if(a)throw l}}return n}}function PMe(t,e){if(t){if(typeof t=="string")return FV(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FV(t,e)}}function FV(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function LMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yl=function(e,r,n){var s=!!n,a=Ie.useRef(n);Ie.useEffect(function(){a.current=n},[n]),Ie.useEffect(function(){if(!s||!e)return function(){};var o=function(){a.current&&a.current.apply(a,arguments)};return e.on(r,o),function(){e.off(r,o)}},[s,r,e,a])},w8=function(e){var r=Ie.useRef(e);return Ie.useEffect(function(){r.current=e},[e]),r.current},Gy=function(e){return e!==null&&Pj(e)==="object"},OMe=function(e){return Gy(e)&&typeof e.then=="function"},MMe=function(e){return Gy(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},$V="[object Object]",RMe=function t(e,r){if(!Gy(e)||!Gy(r))return e===r;var n=Array.isArray(e),s=Array.isArray(r);if(n!==s)return!1;var a=Object.prototype.toString.call(e)===$V,o=Object.prototype.toString.call(r)===$V;if(a!==o)return!1;if(!a&&!n)return e===r;var l=Object.keys(e),c=Object.keys(r);if(l.length!==c.length)return!1;for(var u={},h=0;h<l.length;h+=1)u[l[h]]=!0;for(var f=0;f<c.length;f+=1)u[c[f]]=!0;var m=Object.keys(u);if(m.length!==l.length)return!1;var g=e,y=r,v=function(N){return t(g[N],y[N])};return m.every(v)},mie=function(e,r,n){return Gy(e)?Object.keys(e).reduce(function(s,a){var o=!Gy(r)||!RMe(e[a],r[a]);return n.includes(a)?(o&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),s):o?BV(BV({},s||{}),{},fie({},a,e[a])):s},null):null},gie="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",UV=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gie;if(e===null||MMe(e))return e;throw new Error(r)},DMe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gie;if(OMe(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(s){return UV(s,r)})};var n=UV(e,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},BMe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.5.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.5.0",url:"https://stripe.com/docs/stripe-js/react"}))},mS=Ie.createContext(null);mS.displayName="ElementsContext";var xie=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e},yie=function(e){var r=e.stripe,n=e.options,s=e.children,a=Ie.useMemo(function(){return DMe(r)},[r]),o=Ie.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),l=pie(o,2),c=l[0],u=l[1];Ie.useEffect(function(){var m=!0,g=function(v){u(function(w){return w.stripe?w:{stripe:v,elements:v.elements(n)}})};return a.tag==="async"&&!c.stripe?a.stripePromise.then(function(y){y&&m&&g(y)}):a.tag==="sync"&&!c.stripe&&g(a.stripe),function(){m=!1}},[a,c,n]);var h=w8(r);Ie.useEffect(function(){h!==null&&h!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[h,r]);var f=w8(n);return Ie.useEffect(function(){if(c.elements){var m=mie(n,f,["clientSecret","fonts"]);m&&c.elements.update(m)}},[n,f,c.elements]),Ie.useEffect(function(){BMe(c.stripe)},[c.stripe]),Ie.createElement(mS.Provider,{value:c},s)};yie.propTypes={stripe:Hs.any,options:Hs.object};var FMe=function(e){var r=Ie.useContext(mS);return xie(r,e)},$Me=function(){var e=FMe("calls useElements()"),r=e.elements;return r};Hs.func.isRequired;var bie=Ie.createContext(null);bie.displayName="CheckoutContext";Hs.any,Hs.shape({clientSecret:Hs.oneOfType([Hs.string,Hs.instanceOf(Promise)]).isRequired,elementsOptions:Hs.object}).isRequired;var N8=function(e){var r=Ie.useContext(bie),n=Ie.useContext(mS);if(r){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return xie(n,e)},UMe=["mode"],zMe=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},uc=function(e,r){var n="".concat(zMe(e),"Element"),s=function(c){var u=c.id,h=c.className,f=c.options,m=f===void 0?{}:f,g=c.onBlur,y=c.onFocus,v=c.onReady,w=c.onChange,N=c.onEscape,k=c.onClick,C=c.onLoadError,I=c.onLoaderStart,O=c.onNetworksChange,L=c.onConfirm,_=c.onCancel,E=c.onShippingAddressChange,M=c.onShippingRateChange,B=c.onSavedPaymentMethodRemove,S=c.onSavedPaymentMethodUpdate,P=N8("mounts <".concat(n,">")),R="elements"in P?P.elements:null,V="checkoutState"in P?P.checkoutState:null,ee=V?.type==="success"||V?.type==="loading"?V.sdk:null,G=Ie.useState(null),J=pie(G,2),Z=J[0],se=J[1],X=Ie.useRef(null),q=Ie.useRef(null);yl(Z,"blur",g),yl(Z,"focus",y),yl(Z,"escape",N),yl(Z,"click",k),yl(Z,"loaderror",C),yl(Z,"loaderstart",I),yl(Z,"networkschange",O),yl(Z,"confirm",L),yl(Z,"cancel",_),yl(Z,"shippingaddresschange",E),yl(Z,"shippingratechange",M),yl(Z,"savedpaymentmethodremove",B),yl(Z,"savedpaymentmethodupdate",S),yl(Z,"change",w);var U;v&&(e==="expressCheckout"?U=v:U=function(){v(Z)}),yl(Z,"ready",U),Ie.useLayoutEffect(function(){if(X.current===null&&q.current!==null&&(R||ee)){var re=null;if(ee)switch(e){case"paymentForm":re=ee.createPaymentFormElement(m);break;case"payment":re=ee.createPaymentElement(m);break;case"address":if("mode"in m){var ae=m.mode,xe=AMe(m,UMe);if(ae==="shipping")re=ee.createShippingAddressElement(xe);else if(ae==="billing")re=ee.createBillingAddressElement(xe);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":re=ee.createExpressCheckoutElement(m);break;case"currencySelector":re=ee.createCurrencySelectorElement();break;case"taxId":re=ee.createTaxIdElement(m);break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else R&&(re=R.create(e,m));X.current=re,se(re),re&&re.mount(q.current)}},[R,ee,m]);var H=w8(m);return Ie.useEffect(function(){if(X.current){var re=mie(m,H,["paymentRequest"]);re&&"update"in X.current&&X.current.update(re)}},[m,H]),Ie.useLayoutEffect(function(){return function(){if(X.current&&typeof X.current.destroy=="function")try{X.current.destroy(),X.current=null}catch{}}},[]),Ie.createElement("div",{id:u,className:h,ref:q})},a=function(c){N8("mounts <".concat(n,">"));var u=c.id,h=c.className;return Ie.createElement("div",{id:u,className:h})},o=r?a:s;return o.propTypes={id:Hs.string,className:Hs.string,onChange:Hs.func,onBlur:Hs.func,onFocus:Hs.func,onReady:Hs.func,onEscape:Hs.func,onClick:Hs.func,onLoadError:Hs.func,onLoaderStart:Hs.func,onNetworksChange:Hs.func,onConfirm:Hs.func,onCancel:Hs.func,onShippingAddressChange:Hs.func,onShippingRateChange:Hs.func,onSavedPaymentMethodRemove:Hs.func,onSavedPaymentMethodUpdate:Hs.func,options:Hs.object},o.displayName=n,o.__elementType=e,o},dc=typeof window>"u",VMe=Ie.createContext(null);VMe.displayName="EmbeddedCheckoutProviderContext";var qMe=function(){var e=N8("calls useStripe()"),r=e.stripe;return r};uc("auBankAccount",dc);uc("card",dc);uc("cardNumber",dc);uc("cardExpiry",dc);uc("cardCvc",dc);uc("iban",dc);var HMe=uc("payment",dc);uc("expressCheckout",dc);uc("paymentRequestButton",dc);uc("linkAuthentication",dc);uc("address",dc);uc("shippingAddress",dc);uc("paymentMethodMessaging",dc);uc("taxId",dc);const WMe=SMe("pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W"),GMe=({amount:t,onCancel:e,onSuccess:r})=>{const n=qMe(),s=$Me(),[a,o]=b.useState(null),[l,c]=b.useState(!1),[u,h]=b.useState(!1),f="pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W".startsWith("pk_live")&&window.location.protocol==="http:",m=async g=>{if(g.preventDefault(),!n||!s)return;c(!0);const{error:y}=await n.confirmPayment({elements:s,confirmParams:{return_url:window.location.origin+"/dashboard?donation=success"},redirect:"if_required"});y?(o(y.message),c(!1)):r()};return i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[f?i.jsxs("div",{className:"bg-amber-900/30 border border-amber-500/50 p-6 rounded-xl text-center space-y-3",children:[i.jsx("span",{className:"text-3xl",children:""}),i.jsx("h3",{className:"font-bold text-amber-200",children:"HTTPS Required"}),i.jsxs("p",{className:"text-sm text-gray-400",children:["Live Stripe payments require a secure (HTTPS) connection. Please use ",i.jsx("strong",{children:"test keys"})," for local development or deploy to a secure server."]})]}):i.jsxs("div",{className:"relative min-h-[100px]",children:[!u&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 rounded-xl border border-gray-700 animate-pulse text-gray-500 text-sm",children:"Loading Secure Form..."}),i.jsx(HMe,{onReady:()=>h(!0),onLoadError:g=>o(g.error?.message||"Failed to load payment form."),className:"bg-gray-900 p-4 rounded-xl border border-gray-700"})]}),a&&i.jsx("div",{className:"text-red-500 text-sm mt-2 p-3 bg-red-950/30 border border-red-500/30 rounded-lg",children:a}),i.jsxs("div",{className:"flex gap-4 pt-4",children:[i.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-xl font-bold transition-all",children:"Change Amount"}),i.jsx("button",{disabled:l||!n,className:"flex-1 px-4 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/25 disabled:opacity-50",children:l?"Processing...":`Donate $${t}`})]})]})},KMe=({isOpen:t,onClose:e})=>{const[r,n]=b.useState("amount"),[s,a]=b.useState(10),[o,l]=b.useState(""),[c,u]=b.useState(!1),[h,f]=b.useState("stripe");b.useEffect(()=>{t||(n("amount"),l(""),u(!1))},[t]);const m=async g=>{a(g),u(!0);try{const y=await He.post("/api/payments/create-intent",{amount:g});l(y.clientSecret),n("payment")}catch(y){alert("Error creating payment: "+y.message)}finally{u(!1)}};return t?i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 w-full max-w-lg rounded-3xl flex flex-col max-h-[calc(100vh-4rem)] shadow-2xl animate-fade-in-up overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950/50 flex-shrink-0",children:[i.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-pink-500 text-2xl",children:""})," Support MTG-Forge"]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-grow",children:[r==="amount"&&i.jsxs("div",{className:"space-y-6 animate-fade-in",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-gray-400 mb-6",children:"Your support helps us keep the servers running and the AI Architect dreaming of new decks."}),i.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[5,10,20].map(g=>i.jsxs("button",{onClick:()=>a(g),className:`py-4 rounded-xl border font-bold transition-all ${s===g?"bg-indigo-600 border-indigo-400 text-white shadow-lg shadow-indigo-500/20 scale-105":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:["$",g]},g))}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),i.jsx("input",{type:"number",value:s,onChange:g=>a(parseFloat(g.target.value)||""),className:"w-full bg-gray-800 border border-gray-700 rounded-xl py-3 pl-8 pr-4 text-white font-bold focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Other amount"})]})]}),i.jsx("button",{onClick:()=>m(s),disabled:c||!s||s<1,className:"w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-indigo-500/30 transition-all transform hover:-translate-y-1 disabled:opacity-50",children:c?"Loading...":"Continue to Payment"})]}),r==="payment"&&i.jsxs("div",{className:"space-y-6 animate-fade-in",children:[i.jsx("div",{className:"flex bg-gray-950 p-1 rounded-xl mb-4",children:["stripe","google","paypal"].map(g=>i.jsx("button",{onClick:()=>f(g),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${h===g?"bg-gray-800 text-white shadow-sm":"text-gray-500 hover:text-gray-400"}`,children:g==="stripe"?"Card":g==="google"?"Google Pay":"PayPal"},g))}),h==="stripe"&&o&&i.jsx(yie,{stripe:WMe,options:{clientSecret:o,appearance:{theme:"night"}},children:i.jsx(GMe,{amount:s,onCancel:()=>n("amount"),onSuccess:()=>n("success")})}),(h==="google"||h==="paypal")&&i.jsxs("div",{className:"text-center py-12 space-y-4 animate-pulse",children:[i.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-800 rounded-full flex items-center justify-center text-2xl",children:h==="google"?"":""}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-bold text-gray-300 capitalize",children:[h," Pay Integration"]}),i.jsx("p",{className:"text-sm text-gray-500",children:"Coming incredibly soon! Please use Card for now."})]}),i.jsx("button",{onClick:()=>f("stripe"),className:"text-indigo-400 text-sm hover:underline font-bold",children:"Back to Card Payment"})]})]}),r==="success"&&i.jsxs("div",{className:"text-center space-y-8 animate-fade-in py-8",children:[i.jsxs("div",{className:"w-24 h-24 mx-auto relative",children:[i.jsx("div",{className:"absolute inset-0 bg-pink-500 rounded-full animate-ping opacity-20"}),i.jsx("div",{className:"relative bg-gradient-to-br from-pink-500 to-rose-600 w-24 h-24 rounded-full flex items-center justify-center text-4xl shadow-lg ring-4 ring-pink-500/20",children:""})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-4xl font-black text-white tracking-tight",children:"YOU ARE ABSOLUTELY INCREDIBLE!"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{className:"text-gray-300 text-lg",children:["From the bottom of our digital hearts, ",i.jsx("span",{className:"text-pink-400 font-bold",children:"THANK YOU!"})]}),i.jsx("p",{className:"text-gray-400 leading-relaxed max-w-xs mx-auto text-sm italic",children:`"Your generosity fuels the spark of creativity. You're not just a donor; you're a patron of the Multiverse."`})]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black tracking-[0.2em]",children:"Honorary Title Acquired"}),i.jsx("div",{className:"bg-indigo-500/10 border border-indigo-500/30 py-2 px-4 rounded-full inline-block mx-auto text-indigo-300 font-bold text-sm",children:"Guardian of the Forge"})]}),i.jsx("button",{onClick:e,className:"w-full py-4 bg-gray-800 hover:bg-gray-700 text-white rounded-xl font-bold transition-all border border-gray-700 mt-4",children:"Continue Forging"})]})]}),r!=="success"&&i.jsx("div",{className:"bg-gray-950/80 p-4 border-t border-gray-800 text-center flex-shrink-0",children:i.jsxs("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Payments by Stripe"]})})]})]}):null},zf=({steps:t,isOpen:e,onClose:r,onComplete:n,tourId:s})=>{const[a,o]=b.useState(0),[l,c]=b.useState(null);if(b.useEffect(()=>{e&&o(0)},[e]),b.useEffect(()=>{if(!e||!t[a])return;const g=()=>{const y=t[a],v=document.querySelector(y.target);if(v){const w=v.getBoundingClientRect();c({top:w.top,left:w.left,width:w.width,height:w.height,bottom:w.bottom,right:w.right}),v.scrollIntoView({behavior:"smooth",block:"center"})}else console.warn(`Tour target not found: ${y.target}`)};return g(),window.addEventListener("resize",g),window.addEventListener("scroll",g,!0),()=>{window.removeEventListener("resize",g),window.removeEventListener("scroll",g,!0)}},[e,a,t]),!e||!t[a])return null;const u=t[a],h=a===t.length-1,f=()=>{h?(s&&localStorage.setItem(`tour_seen_${s}`,"true"),n&&n(),r()):o(g=>g+1)},m=()=>{o(g=>Math.max(0,g-1))};return Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1000] pointer-events-none",children:[l&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:0,left:0,right:0,height:l.top}}),i.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.bottom,left:0,right:0,bottom:0}}),i.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.top,left:0,width:l.left,height:l.height}}),i.jsx("div",{className:"absolute bg-black/70 transition-all duration-300 pointer-events-auto",style:{top:l.top,left:l.right,right:0,height:l.height}}),i.jsx("div",{className:"absolute border-2 border-indigo-500 rounded shadow-[0_0_20px_rgba(99,102,241,0.5)] transition-all duration-300 pointer-events-none animate-pulse",style:{top:l.top-4,left:l.left-4,width:l.width+8,height:l.height+8}})]}),l&&i.jsx("div",{className:"absolute pointer-events-auto transition-all duration-300 z-[1001]",style:u.placement==="center"?{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"300px"}:{top:l.bottom+12,left:Math.min(Math.max(10,l.left),window.innerWidth-320),width:"300px"},children:i.jsxs("div",{className:"bg-gray-800 border border-indigo-500/30 rounded-xl shadow-2xl p-4 animate-fade-in-up",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"text-lg font-bold text-white",children:u.title}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("p",{className:"text-sm text-gray-300 mb-4 leading-relaxed",children:u.content}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["Step ",a+1," of ",t.length]}),i.jsxs("div",{className:"flex gap-2",children:[!h&&i.jsx("button",{onClick:r,className:"px-3 py-1.5 text-xs text-gray-400 hover:text-white font-medium",children:"Skip"}),a>0&&i.jsx("button",{onClick:m,className:"px-3 py-1.5 rounded-lg border border-gray-600 text-gray-300 hover:text-white text-xs font-bold",children:"Back"}),i.jsx("button",{onClick:f,className:"px-4 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-bold shadow-lg shadow-indigo-500/20",children:h?"Finish":"Next"})]})]})]})})]}),document.body)},L1={stats_value:"xs",stats_total:"xs",stats_decks:"xs",audit:"xs",action_browse:"xs",action_wishlist:"xs",identity:"small",quick_actions:"small",community:"medium",action_new_deck:"xs",action_add_cards:"xs",action_tournaments:"xs",system_status:"small",subscription:"small",social_stats:"small",trade_matches:"small",tips:"small",guides:"small",recent_decks:"large",releases:"large"},j8={grid:["stats_value","stats_total","stats_decks","audit","quick_actions","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_browse","action_wishlist","action_tournaments","system_status","subscription","social_stats","trade_matches","tips","guides"]},YMe={Default:{layout:j8,sizes:L1},"Decks Focused":{layout:{grid:["action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","identity","recent_decks","community","releases","stats_value","stats_total","audit","action_browse","action_wishlist","system_status","subscription","social_stats","tips","guides"]},sizes:{...L1,action_new_deck:"small",action_add_cards:"small",action_tournaments:"small",recent_decks:"xlarge",community:"large"}},Collector:{layout:{grid:["stats_value","stats_total","audit","action_browse","action_wishlist","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","system_status","subscription","tips","guides","action_log","trade_matches"]},sizes:{...L1,tips:"small",audit:"xs",guides:"small",identity:"xs",releases:"xlarge",community:"medium",stats_decks:"xs",stats_total:"xs",stats_value:"xlarge",recent_decks:"medium",social_stats:"small",subscription:"small",action_browse:"xs",quick_actions:"small",system_status:"small",trade_matches:"small",action_new_deck:"xs",action_wishlist:"xs",action_add_cards:"xs",action_tournaments:"xs"}}},vN=YMe,XMe=({id:t,widgetKey:e,editMode:r,data:n,actions:s,containerId:a,size:o,onResize:l,onRemove:c})=>{const{attributes:u,listeners:h,setNodeRef:f,transform:m,transition:g,isDragging:y}=Yne({id:t}),[v,w]=b.useState(null),N=t==="system_status"||t==="releases",I=a==="grid"?{xs:"col-span-6 md:col-span-2 row-span-2 md:row-span-1",small:"col-span-12 md:col-span-4 row-span-4 md:row-span-3",medium:"col-span-12 md:col-span-4 row-span-6 md:row-span-5",large:"col-span-12 md:col-span-6 row-span-8",xlarge:"col-span-12 md:col-span-8 row-span-8"}[o||"small"]||"md:col-span-3 md:row-span-2":{xs:"max-w-[150px] mx-auto lg:mx-0",small:"max-w-[300px] mx-auto lg:mx-0",medium:"max-w-md mx-auto lg:mx-0",large:"w-full",xlarge:"w-full"}[o||"small"],O={transform:jf.Transform.toString(m),transition:v?"none":g,zIndex:y||v?100:"auto",opacity:y?.3:1,width:v?`${v.w}px`:void 0,height:v?`${v.h}px`:void 0},_=(u2[e]||u2[t])?.component,E=B=>{B.stopPropagation(),l(t)},M=B=>{B.stopPropagation(),B.preventDefault();const S=B.clientX,P=B.clientY,R=o||"small",V=B.currentTarget.closest(".relative").getBoundingClientRect(),ee=V.width,G=V.height;w({w:ee,h:G});const J=se=>{const X=se.clientX,q=se.clientY,U=X-S,H=q-P;w({w:Math.max(150,ee+U),h:Math.max(100,G+H)})},Z=se=>{document.removeEventListener("mousemove",J),document.removeEventListener("mouseup",Z);const X=se.clientX,q=se.clientY,U=(X-S)/100,H=(q-P)/50,re=ue=>ue==="xs"?[2,1]:ue==="small"?[4,2]:ue==="medium"?[4,4]:ue==="large"?[6,6]:ue==="xlarge"?[8,6]:[4,2],[ae,xe]=re(R);let Ne=ae+(U>.4||U<-.4?Math.round(U):0),pe=xe+(H>.4||H<-.4?Math.round(H):0),K=R;pe>=5?Ne>=7?K="xlarge":K="large":pe>=2.5?Ne>=4?K="medium":K="small":pe>=1.5?K="small":K="xs",w(null),K!==R&&l(t,K)};document.addEventListener("mousemove",J),document.addEventListener("mouseup",Z)};return _?i.jsxs("div",{ref:f,style:O,className:`relative h-full ${!y&&!v?"transition-all duration-300":""} ${I}`,children:[r&&i.jsxs("div",{className:`absolute z-50 flex gap-1 origin-top-right transition-all ${o==="xs"?"-top-2 -right-2 scale-[0.7]":"-top-3 -right-3"}`,children:[!N&&i.jsx("div",{onMouseDown:B=>{B.stopPropagation(),c(t)},className:`bg-red-600 rounded-full cursor-pointer hover:bg-red-500 border border-red-400 text-white shadow-lg flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Remove Widget",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("div",{onMouseDown:E,className:`bg-gray-700 cursor-ew-resize rounded-full hover:bg-gray-600 border border-gray-500 text-white shadow-lg font-bold flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"w-5 h-5 text-[9px] p-0.5":"w-6 h-6 text-[10px] p-1.5"}`,title:"Drag horizontal to resize",children:o==="xs"?"XS":o==="xlarge"?"XL":o==="large"?"L":o==="medium"?"M":"S"}),i.jsx("div",{...u,...h,className:`bg-indigo-600 rounded-full cursor-grab active:cursor-grabbing hover:bg-indigo-500 border border-indigo-400 text-white shadow-lg transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Drag to Move",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"})})})]}),i.jsx("div",{className:`h-full overflow-hidden rounded-3xl ${r?"ring-2 ring-indigo-500/30 pointer-events-none":""}`,children:i.jsx(_,{data:n,actions:s,size:o})}),r&&i.jsxs("div",{onMouseDown:M,className:"absolute bottom-1 right-1 w-10 h-10 cursor-nwse-resize z-50 flex items-end justify-end p-1 group/resize hover:scale-110 transition-transform pointer-events-auto",title:"Drag corner to resize",children:[i.jsx("div",{className:"w-5 h-5 border-r-4 border-b-4 border-indigo-500/50 rounded-br-lg group-hover/resize:border-indigo-400"}),i.jsx("div",{className:"absolute inset-0 flex items-end justify-end p-2 opacity-50 group-hover/resize:opacity-100",children:i.jsxs("svg",{className:"w-3 h-3 text-indigo-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[i.jsx("line",{x1:"21",y1:"15",x2:"15",y2:"21"}),i.jsx("line",{x1:"21",y1:"9",x2:"9",y2:"21"})]})})]})]}):null},QMe=()=>{const{currentUser:t,userProfile:e,updateSettings:r}=Cr(),n=yn(),{addToast:s}=Tn(),{cards:a,refresh:o}=yo(),{decks:l,loading:c}=yd(),[u,h]=b.useState(!1),[f,m]=b.useState(!1),[g,y]=b.useState(!1),[v,w]=b.useState(!1),[N,k]=b.useState(!1),[C,I]=b.useState(!1),[O,L]=b.useState(!1),[_,E]=b.useState(!1),[M,B]=b.useState(j8),[S,P]=b.useState({}),[R,V]=b.useState(null),[ee,G]=b.useState({}),[J,Z]=b.useState(!1),[se,X]=b.useState(!1),[q,U]=b.useState(!1),[H,re]=b.useState({isOpen:!1,code:"",name:""}),[ae,xe]=b.useState({isOpen:!1,name:""});b.useRef(null);const[Ne,pe]=b.useState({top:0,right:0}),[K,ue]=b.useState(!1);b.useEffect(()=>{const De=()=>{ue(!0),O||L(!1)};return window.addEventListener("start-tour",De),()=>window.removeEventListener("start-tour",De)},[O]);const fe=[{title:"Welcome to Dashboard",content:"This is your command center. Get a quick overview of your collection and decks here.",target:"h1"},{title:"Customize",content:"Toggle this switch to enter Edit Mode. In Edit Mode, you can add, remove, and resize widgets.",target:"#customize-toggle"},{title:"Load & Save",content:"Use this menu to load presets, save your layout, or share it with others.",target:"#layout-menu-btn"}],he=De=>De?.grid&&Array.isArray(De.grid)?De:De?.top||De?.main||De?.sidebar?{grid:[...De.top||[],...De.main||[],...De.sidebar||[]]}:j8;b.useEffect(()=>{if(!(!e||O)){if(e.settings?.dashboard_layout){const De=e.settings.dashboard_layout,lt=he(De);B(ht=>JSON.stringify(ht)===JSON.stringify(lt)?ht:lt)}if(e.settings?.dashboard_sizes){const De=e.settings.dashboard_sizes;P(lt=>JSON.stringify(lt)===JSON.stringify(De)?lt:De)}else P(De=>JSON.stringify(De)===JSON.stringify(L1)?De:L1);if(e.settings?.saved_layouts){const De=e.settings.saved_layouts;G(lt=>JSON.stringify(lt)===JSON.stringify(De)?lt:De)}}},[e,O]);const le=async()=>{I(!0);try{await He.post("/api/sync/prices"),await o()}catch(De){console.error("Sync failed",De)}finally{I(!1)}},_e=()=>U(!0),oe=async De=>{if(!De)return;const lt={...ee||{},[De]:{layout:M,widgetSizes:S}};await Dt(lt),s(`Layout "${De}" saved!`,"success")},Oe=De=>{if(ee&&ee[De]){const lt=ee[De].layout;B(he(lt)),P(ee[De].widgetSizes||{}),s(`Loaded layout: ${De}`,"success")}else if(vN[De]){const{layout:lt,sizes:ht}=vN[De];B(he(lt)),ht&&P(ht),s(`Loaded preset: ${De}`,"success")}},ze=()=>{const lt=btoa(JSON.stringify({l:M,s:S}));re({isOpen:!0,code:lt,name:"Current Layout"})},Ye=()=>X(!0),je=async(De,lt,ht)=>{try{const Pt=JSON.parse(atob(lt));if(!Pt.l)throw new Error("Invalid layout data");const At={...ee||{},[De]:{layout:Pt.l,widgetSizes:Pt.s||{}}};await Dt(At),ht?(B(Pt.l),P(Pt.s||{}),s(`Layout "${De}" imported and loaded!`,"success")):s(`Layout "${De}" imported successfully!`,"success"),X(!1)}catch(Pt){console.error(Pt),s("Invalid layout code","error")}},Fe=De=>xe({isOpen:!0,name:De}),Nt=async()=>{const De=ae.name;if(!De)return;const lt={...ee};delete lt[De],await Dt(lt),s("Layout deleted","success"),xe({isOpen:!1,name:""})},$t=async De=>{if(!window.confirm(`Overwrite "${De}" with current layout?`))return;const lt={...ee,[De]:{layout:M,widgetSizes:S}};G(lt);try{await r({saved_layouts:lt}),s("Layout updated","success")}catch{s("Failed to update layout","error")}},Ut=b.useMemo(()=>{if(!a||!l)return{totalCards:0,uniqueDecks:0,value:0,topColor:null};const De=new Set(a.map(Xt=>Xt.scryfall_id||Xt.id)),lt=a.filter(Xt=>!Xt.is_wishlist),ht=a.filter(Xt=>Xt.is_wishlist);let Pt=lt.reduce((Xt,Qt)=>Xt+(Qt.count||1),0),At=ht.reduce((Xt,Qt)=>Xt+(Qt.count||1),0),mt=Pt;l.forEach(Xt=>{if(Xt.commander){const Qt=Xt.commander.id||Xt.commander.scryfall_id;Qt&&!De.has(Qt)&&(Pt++,De.add(Qt))}if(Xt.commander_partner){const Qt=Xt.commander_partner.id||Xt.commander_partner.scryfall_id;Qt&&!De.has(Qt)&&(Pt++,De.add(Qt))}});const Ft=a.reduce((Xt,Qt)=>{if(Qt.is_wishlist)return Xt;const sr=(Qt.finish==="foil"||Qt.is_foil||Qt.val_foil)&&Qt.prices?.usd_foil||Qt.prices?.usd,Jt=parseFloat(sr||0);return Xt+Jt*(Qt.count||1)},0),gt={};a.forEach(Xt=>{const Qt=Xt.color_identity||[],nr={W:0,U:1,B:2,R:3,G:4},sr=Qt.filter(kr=>nr[kr]!==void 0).sort((kr,Ae)=>nr[kr]-nr[Ae]).join(""),Jt=sr.length===0?"C":sr;gt[Jt]=(gt[Jt]||0)+(Xt.count||1)});const Ot=Object.entries(gt);let Ct=F4("C");if(Ot.length>0){const[Xt]=Ot.reduce((Qt,nr)=>nr[1]>Qt[1]?nr:Qt);Ct=F4(Xt)}return{totalCards:Pt,collectionCount:mt,wishlistCount:At,uniqueDecks:l.length,value:Ft.toLocaleString("en-US",{style:"currency",currency:"USD"}),topColor:Ct}},[a,l]),nt=HO(qy(Z_),qy(J_,{coordinateGetter:Xne})),bt=De=>V(De.active.id),It=De=>{const{active:lt,over:ht}=De;if(!ht||lt.id===ht.id)return;if(lt.data?.current?.fromLibrary)B(At=>({...At,grid:[...At.grid||[],lt.id]}));else{const At=M.grid.indexOf(lt.id),mt=M.grid.indexOf(ht.id);At!==-1&&mt!==-1&&At!==mt&&B(Ft=>({...Ft,grid:rS(Ft.grid,At,mt)}))}},_t=De=>{V(null)},wt=(De,lt)=>{P(ht=>{if(lt)return{...ht,[De]:lt};const Pt=ht[De]||"small",At=Pt==="xs"?"small":Pt==="small"?"medium":Pt==="medium"?"large":Pt==="large"?"xlarge":"xs";return{...ht,[De]:At}})},ut=De=>{B(lt=>({...lt,grid:lt.grid.filter(ht=>ht!==De)})),s("Widget removed from dashboard","success")},Rt=async De=>{if(e?.id)try{await r({dashboard_layout:De,dashboard_sizes:S}),s("Layout saved","success")}catch(lt){console.error(lt),s("Failed to save layout","error")}},Dt=async De=>{G(De);try{await r({saved_layouts:De})}catch(lt){console.error("Failed to save saved_layouts",lt),s("Failed to sync layouts","error")}},at=()=>{O&&(Rt(M),E(!1)),L(!O)},ft=b.useMemo(()=>({stats:Ut,decks:l,decksLoading:c,collection:a,userProfile:e,syncLoading:C}),[Ut,l,c,a,e,C]),Bt=b.useMemo(()=>({handleSyncPrices:le,setIsIssueModalOpen:h,setIsDonationModalOpen:k,setShowBinderGuide:m,setShowPodGuide:y,setShowAuditGuide:w}),[le]);return i.jsxs("div",{className:"relative min-h-screen",children:[i.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:i.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),i.jsx("div",{className:"fixed bottom-[84px] left-4 z-[100] flex md:hidden items-center gap-4 bg-gray-900/95 p-2 rounded-2xl backdrop-blur-2xl border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.5)] transition-all w-fit min-w-[200px] max-w-[calc(100%-80px)]",children:i.jsx("div",{className:"flex items-center gap-4 w-full",children:i.jsxs("div",{className:"relative flex items-center gap-4 flex-grow",children:[i.jsxs("button",{id:"layout-menu-btn-mobile",onClick:()=>Z(!J),className:"bg-gray-800 hover:bg-gray-700 text-white text-[10px] font-bold rounded-xl border border-white/10 px-3 py-2 transition-all flex items-center gap-2",children:[i.jsx("span",{children:"Layouts"}),i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),J&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40 cursor-default",onClick:()=>Z(!1)}),i.jsxs("div",{className:"absolute bottom-full left-0 mb-4 w-full bg-gray-900 border border-indigo-500/30 rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-slide-up-fast min-w-[200px]",children:[i.jsxs("div",{className:"p-2 border-b border-white/5 bg-gray-950/50",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1",children:"Presets"}),Object.keys(vN).map(De=>i.jsx("button",{onClick:()=>{Oe(De),Z(!1)},className:"w-full text-left px-2 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white rounded-lg transition-colors active:bg-indigo-600/20",children:De},De))]}),i.jsxs("div",{className:"p-2 flex-grow overflow-y-auto max-h-[300px] bg-gray-900",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1 flex justify-between items-center",children:i.jsx("span",{children:"My Layouts"})}),Object.keys(ee).length===0?i.jsx("div",{className:"px-2 py-2 text-xs text-gray-600 italic",children:"No saved layouts"}):Object.keys(ee).map(De=>i.jsxs("div",{className:"flex items-center gap-1 group/item rounded-lg hover:bg-white/5 p-1 mb-1",children:[i.jsx("button",{onClick:lt=>{lt.stopPropagation(),Oe(De),Z(!1)},className:"flex-grow text-left px-2 py-2 text-sm text-gray-300 group-hover/item:text-white truncate transition-colors font-medium active:text-indigo-400",children:De}),i.jsxs("div",{className:"flex bg-gray-950/50 rounded-lg p-0.5 border border-white/5",children:[i.jsx("button",{onClick:lt=>{lt.stopPropagation(),$t(De)},className:"p-2 text-gray-500 hover:text-green-400 hover:bg-white/5 rounded transition-all",title:"Overwrite",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})}),i.jsx("div",{className:"w-px bg-white/10 my-1"}),i.jsx("button",{onClick:lt=>{lt.stopPropagation(),Fe(De)},className:"p-2 text-gray-500 hover:text-red-400 hover:bg-white/5 rounded transition-all",title:"Delete",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},De))]}),i.jsxs("div",{className:"p-2 border-t border-white/5 bg-gray-950/50 grid grid-cols-3 gap-2",children:[i.jsxs("button",{onClick:()=>{Ye(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Import",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import"]}),i.jsxs("button",{onClick:()=>{_e(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Save",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Save New"]}),i.jsxs("button",{onClick:()=>{ze(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Share",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]})]})]}),i.jsx("div",{className:"h-5 w-px bg-white/10 mx-1"}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-fit",children:[i.jsx("span",{className:`text-xs font-black uppercase tracking-tighter ${O?"text-indigo-400":"text-gray-500"}`,children:O?"Done":"Edit"}),i.jsx(fU,{checked:O,onChange:at,className:`${O?"bg-indigo-600":"bg-gray-700"} relative inline-flex h-5 w-9 items-center rounded-full transition-colors shadow-inner`,children:i.jsx("span",{className:`${O?"translate-x-5":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),O&&i.jsx("button",{onClick:()=>E(!_),className:`p-1.5 rounded border transition-all ${O&&!_?"bg-indigo-600/20 text-indigo-400 border-indigo-500/50 animate-bounce":"hover:bg-indigo-600/20 text-indigo-400 border-indigo-500/30"}`,title:"Forge Library",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]})]})})}),(()=>{const lt=e?.subscription_status==="trial",ht=e?.trial_end_date;if(!lt||!ht)return null;const Pt=Math.max(0,Math.ceil((new Date(ht)-new Date)/(1e3*60*60*24))),At=Pt<=3;return i.jsx("div",{className:"relative z-40 mx-auto max-w-7xl px-6 mt-6 mb-[-1rem] animate-fade-in-down",children:i.jsxs("div",{className:`
                            relative overflow-hidden rounded-xl border p-4 flex flex-col md:flex-row items-center justify-between gap-4 shadow-lg
                            ${At?"bg-orange-500/10 border-orange-500/30":"bg-blue-600/10 border-blue-500/30"}
                        `,children:[i.jsx("div",{className:`absolute -right-10 -top-10 w-40 h-40 rounded-full blur-3xl opacity-20 ${At?"bg-orange-500":"bg-blue-500"}`}),i.jsxs("div",{className:"flex items-center gap-4 z-10",children:[i.jsx("div",{className:`p-3 rounded-full shrink-0 ${At?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:At?i.jsx(ud,{className:"w-6 h-6"}):i.jsx(Nf,{className:"w-6 h-6"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-white text-lg",children:At?"Trial Ending Soon!":"Welcome to Your Trial"}),i.jsxs("p",{className:"text-sm text-gray-300",children:["You have ",i.jsxs("span",{className:`font-bold ${At?"text-orange-400":"text-blue-400"}`,children:[Pt," days remaining"]})," of full access."]})]})]}),i.jsx("div",{className:"flex items-center gap-3 z-10 w-full md:w-auto",children:i.jsx("button",{onClick:()=>n("/settings"),className:`
                                        w-full md:w-auto px-6 py-2 rounded-lg font-bold transition-all shadow-lg whitespace-nowrap
                                        ${At?"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white"}
                                    `,children:"Manage Subscription"})})]})})})(),i.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 space-y-8 animate-fade-in w-full",children:[i.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/30 rounded-xl p-4 flex items-start gap-3 backdrop-blur-md",children:[i.jsx("span",{className:"text-xl",children:""}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-indigo-400 text-sm",children:"Looking for Default Layout suggestions!"}),i.jsx("p",{className:"text-xs text-gray-300 mt-1 leading-relaxed",children:"Layouts are awkward atm to promote suggestions. When editing, click the share icon up at the top and send me your suggestion with a description of what it is."})]})]}),i.jsxs("div",{className:`relative z-50 flex flex-col md:flex-row gap-4 ${O?"justify-center items-center":"justify-between items-end"}`,children:[i.jsxs("div",{className:`text-center md:text-left ${O?"opacity-50 scale-90 transition-all":""}`,children:[i.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"Dashboard"}),i.jsxs("p",{className:"text-gray-400",children:["Welcome back, ",i.jsx("span",{className:"text-indigo-400 font-bold",children:t?t.displayName||t.email:"Guest"}),"."]})]}),i.jsxs("div",{className:"hidden md:flex items-center gap-3 bg-gray-900/50 p-2 rounded-xl backdrop-blur-md border border-white/5",children:[i.jsx("div",{className:"relative",children:i.jsxs("button",{id:"layout-menu-btn",onClick:()=>Z(!J),className:"bg-gray-800 text-white text-xs rounded-lg border border-gray-700 px-3 py-1.5 hover:bg-gray-700 transition-colors flex items-center gap-2",children:[i.jsx("span",{children:"Load Layout..."}),i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),i.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${O?"text-indigo-400":"text-gray-500"}`,children:O?"Done":"Customize"}),i.jsx(fU,{checked:O,onChange:at,className:`${O?"bg-indigo-600":"bg-gray-700"} relative inline-flex h-5 w-10 items-center rounded-full transition-colors`,children:i.jsx("span",{className:`${O?"translate-x-6":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),J&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40 cursor-default",onClick:()=>Z(!1)}),i.jsxs("div",{className:`absolute top-full mt-2 w-72 bg-gray-900 border border-indigo-500/30 rounded-xl shadow-2xl z-[100] overflow-hidden flex flex-col animate-fade-in-down ${O?"left-1/2 -translate-x-1/2 origin-top":"right-0 origin-top-right"}`,children:[i.jsxs("div",{className:"p-2 border-b border-white/5 bg-gray-950/50",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1",children:"Presets"}),Object.keys(vN).map(De=>i.jsx("button",{onClick:()=>{Oe(De),Z(!1)},className:"w-full text-left px-2 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white rounded-lg transition-colors active:bg-indigo-600/20",children:De},De))]}),i.jsxs("div",{className:"p-2 flex-grow overflow-y-auto max-h-[300px] bg-gray-900",children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest px-2 py-1 flex justify-between items-center",children:i.jsx("span",{children:"My Layouts"})}),Object.keys(ee).length===0?i.jsx("div",{className:"px-2 py-2 text-xs text-gray-600 italic",children:"No saved layouts"}):Object.keys(ee).map(De=>i.jsxs("div",{className:"flex items-center gap-1 group/item rounded-lg hover:bg-white/5 p-1 mb-1",children:[i.jsx("button",{onClick:lt=>{lt.stopPropagation(),Oe(De),Z(!1)},className:"flex-grow text-left px-2 py-2 text-sm text-gray-300 group-hover/item:text-white truncate transition-colors font-medium active:text-indigo-400",children:De}),i.jsxs("div",{className:"flex bg-gray-950/50 rounded-lg p-0.5 border border-white/5",children:[i.jsx("button",{onClick:lt=>{lt.stopPropagation(),$t(De)},className:"p-2 text-gray-500 hover:text-green-400 hover:bg-white/5 rounded transition-all",title:"Overwrite (Save Current over this)",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})}),i.jsx("div",{className:"w-px bg-white/10 my-1"}),i.jsx("button",{onClick:lt=>{lt.stopPropagation(),Fe(De)},className:"p-2 text-gray-500 hover:text-red-400 hover:bg-white/5 rounded transition-all",title:"Delete Layout",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},De))]}),i.jsxs("div",{className:"p-2 border-t border-white/5 bg-gray-950/50 grid grid-cols-3 gap-2",children:[i.jsxs("button",{onClick:()=>{Ye(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Import",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import"]}),i.jsxs("button",{onClick:()=>{_e(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Save As",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Save New"]}),i.jsxs("button",{onClick:()=>{ze(),Z(!1)},className:"p-2 rounded-lg bg-indigo-500/5 hover:bg-indigo-500/20 text-indigo-400 hover:text-indigo-300 flex flex-col items-center gap-1 text-[10px] font-bold transition-all border border-indigo-500/10",title:"Share (Copy Code)",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]})]})]})]})]}),i.jsxs(YO,{sensors:nt,collisionDetection:jne,onDragStart:bt,onDragOver:It,onDragEnd:_t,children:[i.jsx(o6e,{layout:M,isOpen:_&&O,onClose:()=>E(!1),onAddWidget:De=>{B(lt=>({...lt,grid:[...lt.grid||[],De]}))},onClearDashboard:()=>{B({grid:[]})}}),i.jsx(Gne,{items:M.grid||[],strategy:nS,id:"grid",children:i.jsxs("div",{className:"relative w-full min-h-[600px]",children:[(!M.grid||M.grid.length===0)&&i.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none z-20",children:i.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border border-indigo-500/30 p-8 rounded-3xl text-center shadow-2xl max-w-lg pointer-events-auto",children:[i.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 rounded-full flex items-center justify-center mx-auto mb-6",children:i.jsx("span",{className:"text-4xl",children:""})}),i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Dashboard is Empty"}),i.jsx("p",{className:"text-gray-400 mb-8",children:"Start by loading a preset layout or customize it from scratch."}),i.jsxs("div",{className:"flex gap-4 justify-center",children:[i.jsxs("button",{onClick:()=>Oe("Starter Standard"),className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/20 transition-all flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Load Preset"]}),i.jsxs("button",{onClick:()=>{L(!0),E(!0)},className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white border border-gray-600 rounded-xl font-bold transition-all flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Widgets"]})]})]})}),O&&i.jsx("div",{className:"absolute inset-0 grid grid-cols-12 gap-3 pointer-events-none z-0 select-none",children:Array.from({length:12}).map((De,lt)=>i.jsx("div",{className:"h-full border-x border-dashed border-indigo-500/10 bg-indigo-500/5 flex items-start justify-center pt-2 -mt-6",children:i.jsxs("span",{className:"text-[9px] font-black text-indigo-400/50 uppercase tracking-wider",children:["Col ",lt+1]})},lt))}),i.jsx("div",{className:"grid grid-cols-12 auto-rows-[50px] gap-3 relative z-10 w-full",style:{width:"100%",minWidth:"100%",minHeight:"600px",gridTemplateColumns:"repeat(12, minmax(0, 1fr))",gridAutoRows:"75px",gap:"12px",boxSizing:"border-box"},children:M.grid.map(De=>i.jsx(XMe,{id:De,widgetKey:De,containerId:"grid",editMode:O,data:ft,actions:Bt,onRemove:ut,onResize:wt,size:S[De]||"medium"},De))})]})}),i.jsx(zf,{isOpen:K,onClose:()=>ue(!1),steps:fe,tourId:"dashboard_tour"}),i.jsx(XO,{dropAnimation:{sideEffects:qne({styles:{active:{opacity:"0.5"}}})},children:R?(()=>{const De=u2[R],lt=De?.component,ht=S[R]||"small",Pt={xs:"w-[400px] h-[50px]",small:"w-[400px] h-[200px]",medium:"w-[600px] h-[200px]",large:"w-[800px] h-[400px]",xlarge:"w-full max-w-7xl h-[400px]"}[ht]||"w-[400px] h-[200px]";return i.jsx("div",{className:`${Pt} overflow-hidden rounded-3xl shadow-2xl ring-2 ring-indigo-500/50 cursor-grabbing bg-gray-900 z-50`,children:lt?i.jsx("div",{className:"h-full pointer-events-none p-1",children:i.jsx(lt,{data:ft,actions:Bt,size:ht})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4 bg-gray-800 text-white font-bold border border-gray-700 rounded-3xl",children:De?.title||"Widget"})})})():null})]})]}),i.jsx(pMe,{isOpen:u,onClose:()=>h(!1)}),i.jsx(KMe,{isOpen:N,onClose:()=>k(!1)}),i.jsx(UO,{isOpen:f,onClose:()=>m(!1)}),i.jsx(ine,{isOpen:g,onClose:()=>y(!1)}),i.jsx(zO,{isOpen:v,onClose:()=>w(!1)}),i.jsx(l6e,{isOpen:se,onClose:()=>X(!1),onImport:je}),i.jsx(u6e,{isOpen:q,onClose:()=>U(!1),onSave:oe}),i.jsx(c6e,{isOpen:H.isOpen,onClose:()=>re({...H,isOpen:!1}),layoutCode:H.code,layoutName:H.name}),i.jsx(ise,{isOpen:ae.isOpen,onClose:()=>xe({isOpen:!1,name:""}),onConfirm:Nt,title:"Delete Layout",message:`Are you sure you want to delete the layout "${ae.name}"? This cannot be undone.`,targetName:ae.name})]})},vie=[{name:"Limits",items:[{label:"Collection size",type:"limit",key:"collection"},{label:"Wishlist size",type:"limit",key:"wishlist"},{label:"Deck count",type:"limit",key:"decks"},{label:"Pod Count",type:"limit",key:"pods"}]},{name:"Collection",items:[{label:"Organization customization",type:"static",value:!0},{label:"Tags",type:"static",value:!0},{label:"Bulk Import",type:"static",value:!0},{label:"Manual Price Sync",type:"static",value:!0},{label:"Smart Binders",type:"feature",key:"smartBinders"},{label:"Binders",type:"feature",key:"binders"},{label:"Collection Audit",type:"feature",key:"collectionAudit"},{label:"Snap Version (Scanner)",type:"feature",key:"snapScan"},{label:"Quick Scan (Batch)",type:"feature",key:"batchScan"}]},{name:"Wishlist",items:[{label:"Mass Deletion",type:"static",value:!0},{label:"Precon Addition",type:"static",value:!0}]},{name:"Decks",items:[{label:"Public/Private View",type:"static",value:!0},{label:"Deck Stats",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0},{label:"Mockup Deck",type:"feature",key:"mockupDeck"},{label:"AI Strategy",type:"feature",key:"aiStrategy"},{label:"Deck Doctor",type:"feature",key:"deckDoctor"},{label:"Deck Suggestions",type:"feature",key:"deckSuggestions"},{label:"Deck Audit",type:"feature",key:"deckAudit"},{label:"Shared edit",type:"feature",key:"sharedEdit"}]},{name:"Precons",items:[{label:"Add to collection",type:"static",value:!0},{label:"Add to wishlist",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0}]},{name:"Sets",items:[{label:"Quick Add",type:"static",value:!0},{label:"Set Audit",type:"feature",key:"setAudit"}]},{name:"AI",items:[{label:"Chatbot",type:"static",value:!0},{label:"Default Oracle",type:"static",value:!0},{label:"Custom AI Persona",type:"feature",key:"customAiPersona"}]},{name:"Settings",items:[{label:"Collection Backup",type:"feature",key:"collectionBackup"},{label:"Deck Backup",type:"feature",key:"deckBackup"},{label:"Pods / Linking",type:"limit_check",key:"pods"}]}],JMe=(t,e)=>{const r=ta[t],n=e?ta[e]:null;if(!n)return t===lr.FREE?{limits:[{label:`Collection: ${r.limits.collection}`,type:"limit"},{label:`Wishlist: ${r.limits.wishlist}`,type:"limit"},{label:`Decks: ${r.limits.decks}`,type:"limit"},{label:"Pods (Shared Accounts): 0",type:"limit"}],features:[{label:"AI Chatbot",type:"feature"}]}:{limits:[],features:[]};const s=[],a=[];r.limits.collection>n.limits.collection&&s.push({label:`Collection: ${r.limits.collection===1/0?"Unlimited":r.limits.collection}`,type:"limit"}),r.limits.wishlist>n.limits.wishlist&&s.push({label:`Wishlist: ${r.limits.wishlist===1/0?"Unlimited":r.limits.wishlist}`,type:"limit"}),r.limits.decks>n.limits.decks&&s.push({label:`Decks: ${r.limits.decks===1/0?"Unlimited":r.limits.decks}`,type:"limit"});const o=t===lr.TIER_3,l=[lr.TIER_1,lr.TIER_2].includes(t);return(r.limits.pods>n.limits.pods||l)&&s.push({label:`Pods (Shared Accounts): ${r.limits.pods===1/0?"Unlimited":r.limits.pods}`,type:"limit",bold:o,tooltip:"Pods allow you to link accounts (friends/family) to share your collection and deck building tools."}),Object.keys(r.features).forEach(c=>{if(r.features[c]&&!n.features[c]){const u=vie.flatMap(h=>h.items).find(h=>h.key===c);a.push({label:u?u.label:c.replace(/([A-Z])/g," $1").trim(),type:"feature"})}}),{limits:s,features:a}},zV=({label:t,check:e,highlight:r,bold:n,tooltip:s})=>i.jsxs("div",{className:`flex items-start text-sm ${e?r?"text-white font-medium":"text-gray-300":"text-gray-500"} ${n?"font-bold":""}`,title:s,children:[e?i.jsx(ih,{className:`w-4 h-4 mr-2 mt-0.5 flex-shrink-0 ${r?"text-purple-400":"text-green-500"}`}):i.jsx(vu,{className:"w-4 h-4 mr-2 text-red-900/50 mt-0.5 flex-shrink-0"}),i.jsx("span",{children:t})]}),wie=({billingInterval:t,setBillingInterval:e,onSubscribe:r,isLoading:n,currentTier:s,showIntervalSelector:a=!0})=>{const o=Object.values(lr),l=c=>{const u=ta[c];return!u.prices.monthly&&!u.prices.biannual&&!u.prices.yearly?"Free":{[lr.TIER_1]:{monthly:"$2.99",quarterly:"$8.99",biannual:"$14.99",yearly:"$29.99"},[lr.TIER_2]:{monthly:"$4.99",quarterly:"$14.99",biannual:"$24.99",yearly:"$49.99"},[lr.TIER_3]:{monthly:"$9.99",quarterly:"$29.99",biannual:"$49.99",yearly:"$99.99"},[lr.TIER_4]:{monthly:"$14.99",quarterly:"$44.99",biannual:"$74.99",yearly:"$149.99"},[lr.TIER_5]:{monthly:"$19.99",quarterly:"$59.99",biannual:"$99.99",yearly:"$199.99"}}[c]?.[t]||"Free"};return i.jsxs("div",{className:"w-full",children:[a&&i.jsx("div",{className:"flex justify-center mb-8",children:i.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","quarterly","biannual","yearly"].map(c=>i.jsx("button",{onClick:()=>e(c),className:`px-4 py-2 rounded-lg transition-all capitalize ${t===c?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:c==="biannual"?"6 Months":c},c))})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:o.map((c,u)=>{const h=ta[c],f=s===c,m=u>0?o[u-1]:null,{limits:g,features:y}=JMe(c,m);return i.jsxs("div",{className:`relative flex flex-col p-5 rounded-2xl border ${f?"border-purple-500 shadow-[0_0_20px_rgba(168,85,247,0.3)]":"border-gray-700"} bg-gray-800/50 backdrop-blur-sm hover:border-purple-500/50 transition-all duration-300`,children:[f&&i.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-white text-[10px] px-2 py-0.5 rounded-full uppercase tracking-wider font-bold shadow-lg z-10",children:"Current"}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-100",children:h.name}),i.jsxs("div",{className:"flex items-baseline gap-1",children:[i.jsx("span",{className:"text-2xl font-bold text-white",children:l(c)}),i.jsxs("span",{className:"text-sm text-gray-500",children:["/",t==="monthly"?"mo":t==="quarterly"?"qtr":t==="biannual"?"6mo":"yr"]})]}),i.jsx("p",{className:"text-sm text-gray-400 mt-2 min-h-[48px]",children:h.description})]}),i.jsx("button",{onClick:()=>r(c),disabled:n||f,className:`w-full py-2 rounded-lg font-bold text-sm mb-6 transition-all ${f?"bg-gray-700 cursor-default text-gray-400":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white shadow-lg"}`,children:n?"...":f?"Active":c===lr.FREE?"Select":"Subscribe"}),i.jsxs("div",{className:"space-y-3 flex-grow",children:[(g.length>0||y.length>0)&&i.jsxs("div",{children:[i.jsx("p",{className:"text-[10px] uppercase tracking-wider text-purple-400 font-bold mb-2 border-b border-purple-500/30 pb-1",children:c===lr.FREE?"Includes:":"Adds / Increases:"}),g.map((v,w)=>i.jsx(zV,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`limit-${w}`)),g.length>0&&y.length>0&&i.jsx("div",{className:"my-3 border-t border-gray-700"}),y.map((v,w)=>i.jsx(zV,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`feat-${w}`))]}),g.length===0&&y.length===0&&c!==lr.FREE&&i.jsx("p",{className:"text-xs text-gray-500 italic",children:"Includes all previous features"})]})]},c)})})]})},ZMe=()=>{const{currentUser:t,userProfile:e}=Cr(),r=yn(),{addToast:n}=Tn(),[s,a]=b.useState("monthly"),[o,l]=b.useState(!1),[c,u]=b.useState("cards"),[h,f]=b.useState(null),[m,g]=b.useState(null),y=async C=>{if(!t){r("/login");return}if(C===lr.FREE){n("You are already on the free tier.","info");return}l(!0);try{const I=await He.post("/api/payments/create-checkout-session",{tierId:C,interval:s});I.url&&(window.location.href=I.url)}catch(I){console.error("Subscription error:",I),n("Failed to start checkout. Please try again.","error")}finally{l(!1)}},v=C=>{const I=ta[C];return!I.prices.monthly&&!I.prices.biannual&&!I.prices.yearly?"Free":{[lr.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[lr.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[lr.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[lr.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[lr.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[C]?.[s]||"Free"},w=()=>s==="biannual"?i.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"1 Month Free"}):s==="yearly"?i.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"2 Months Free"}):null,N=(C,I)=>{const O=ta[I];if(C.type==="static")return i.jsx(ih,{className:"w-5 h-5 text-green-500 mx-auto"});if(C.type==="limit"){const L=O.limits[C.key];return L===1/0?"Unlimited":L}if(C.type==="limit_check"){const L=O.limits[C.key];return L>0||L===1/0?i.jsx(ih,{className:"w-5 h-5 text-green-500 mx-auto"}):i.jsx(vu,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"})}return C.type==="feature"?O.features[C.key]?i.jsx(ih,{className:"w-5 h-5 text-green-500 mx-auto"}):i.jsx(vu,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"}):"-"},k=Object.values(lr);return i.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8",children:[i.jsxs("div",{className:"max-w-[1800px] mx-auto",children:[i.jsxs("div",{className:"text-center mb-12",children:[i.jsx("h1",{className:"text-4xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600",children:"Choose Your Path"}),i.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto mb-8",children:"Comparing plans to find the perfect fit for your magic journey."}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6",children:[i.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(C=>i.jsx("button",{onClick:()=>a(C),className:`px-4 py-2 rounded-lg transition-all capitalize ${s===C?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:C==="biannual"?"6 Months":C},C))}),i.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:[i.jsxs("button",{onClick:()=>u("cards"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="cards"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[i.jsx(Wke,{className:"w-4 h-4"})," Cards"]}),i.jsxs("button",{onClick:()=>u("table"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="table"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[i.jsx(r_e,{className:"w-4 h-4"})," Compare All"]})]})]}),i.jsx("div",{className:"mt-4 h-8",children:w()})]}),c==="cards"?i.jsx(wie,{billingInterval:s,setBillingInterval:a,onSubscribe:y,isLoading:o,currentTier:e?.subscription_tier}):i.jsx("div",{className:"overflow-x-auto pb-12 pt-12 animate-in fade-in duration-300",children:i.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-4 w-[250px] sticky left-0 z-20 bg-gray-900 border-b border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]",children:i.jsx("div",{className:"text-xl font-bold text-gray-500",children:"Features"})}),k.map((C,I)=>{const O=ta[C],L=e?.subscription_tier===C,_=m===I;return i.jsxs("th",{className:`p-4 min-w-[180px] text-center relative transition-colors duration-300 border-b border-gray-800
                                                ${_?"bg-gray-800/80":"bg-gray-900"}
                                                ${L?"ring-2 ring-purple-500 ring-inset bg-purple-900/10":""}
                                            `,onMouseEnter:()=>g(I),onMouseLeave:()=>g(null),children:[L&&i.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Current"}),i.jsx("h3",{className:`text-xl font-bold mb-1 ${L?"text-purple-300":"text-gray-200"}`,children:O.name}),i.jsxs("div",{className:"text-2xl font-bold mb-2",children:[v(C),i.jsxs("span",{className:"text-xs text-gray-500 font-normal",children:["/",s==="monthly"?"mo":s==="biannual"?"6mo":"yr"]})]}),i.jsx("button",{onClick:()=>y(C),disabled:o||L,className:`w-full py-2 rounded text-sm font-bold transition-all ${L?"bg-gray-800 text-gray-500 cursor-default":"bg-purple-600 hover:bg-purple-500 text-white shadow-lg shadow-purple-900/20"}`,children:L?"Active":C===lr.FREE?"Default":"Subscribe"})]},C)})]})}),i.jsx("tbody",{children:vie.map((C,I)=>i.jsx(Ie.Fragment,{children:C.items.map((O,L)=>{const _=`${I}-${L}`,E=h===_;return i.jsxs("tr",{className:`transition-colors duration-200 border-b border-gray-800/50
                                                    ${E?"bg-gray-800/60":"hover:bg-gray-800/30"}
                                                `,onMouseEnter:()=>f(_),onMouseLeave:()=>f(null),children:[i.jsx("td",{className:`p-3 pl-4 text-sm font-medium text-gray-300 sticky left-0 z-10
                                                    bg-gray-900 transition-colors duration-200 border-r border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]
                                                    ${E?"text-white bg-gray-800":""}
                                                `,children:C.name==="Limits"||C.name==="Settings"||C.name==="AI"?O.label:`${C.name} - ${O.label}`}),k.map((M,B)=>{const S=m===B,P=E&&S;return i.jsx("td",{className:`p-3 text-center text-sm transition-colors duration-200
                                                                ${S?"bg-gray-800/40":""}
                                                                ${P?"bg-purple-500/10":""}
                                                            `,onMouseEnter:()=>g(B),onMouseLeave:()=>g(null),children:N(O,M)},M)})]},O.label)})},C.name))})]})})]}),i.jsx("div",{className:"mt-8 text-center",children:i.jsx("p",{className:"text-gray-500 text-sm",children:"* Prices and limits subject to change. VAT may apply."})})]})},eRe=()=>{const[t,e]=b.useState(!0),[r,n]=b.useState(""),[s,a]=b.useState(""),[o,l]=b.useState(""),[c,u]=b.useState(""),[h,f]=b.useState(""),[m,g]=b.useState(""),[y,v]=b.useState(!1),[w,N]=b.useState(!1),[k,C]=b.useState(""),{login:I,signup:O,loginWithGoogle:L,resetPassword:_}=Cr(),E=yn(),M=async S=>{S.preventDefault();try{if(C(""),y){await _(r),N(!0);return}if(t)await I(r,s),E("/dashboard");else{if(s!==o)return C("Passwords do not match");if(s.length<6)return C("Password must be at least 6 characters");await O(r,s,{username:c,first_name:h,last_name:m}),E("/onboarding")}}catch(P){C("Failed to "+(t?"log in":"sign up")+": "+P.message)}},B=async()=>{try{C(""),await L(),E("/dashboard")}catch(S){C("Failed to log in with Google: "+S.message)}};return i.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8 relative",children:[i.jsx("div",{className:"absolute inset-0 z-0",children:i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-50"})}),i.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10 bg-black/60 p-10 rounded-2xl backdrop-blur-md border border-white/10 shadow-2xl",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:y?"Reset Password":t?"Sign in to MTG-Forge":"Create an Account"}),i.jsx("p",{className:"mt-2 text-center text-sm text-gray-400",children:y?"Enter your email to receive a reset link":t?"Access your collection and decks anywhere":"Start your journey with MTG-Forge"})]}),w&&i.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-100 p-3 rounded text-sm text-center",children:"Reset link sent! Check your inbox."}),k&&i.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 p-3 rounded text-sm text-center",children:k}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:M,children:[i.jsxs("div",{className:"space-y-4",children:[!t&&!y&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx("div",{children:i.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"First Name",value:h,onChange:S=>f(S.target.value)})}),i.jsx("div",{children:i.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Last Name",value:m,onChange:S=>g(S.target.value)})})]}),!t&&!y&&i.jsx("div",{children:i.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Username",value:c,onChange:S=>u(S.target.value)})}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),i.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:r,onChange:S=>n(S.target.value)})]}),!y&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:t?"current-password":"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:s,onChange:S=>a(S.target.value)})]}),!t&&!y&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),i.jsx("input",{id:"confirm-password",name:"confirmConnectPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:o,onChange:S=>l(S.target.value)})]})]}),t&&!y&&i.jsx("div",{className:"flex items-center justify-end",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot your password?"})}),i.jsx("div",{children:i.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:y?"Send Reset Link":t?"Sign in with Email":"Sign Up with Email"})})]}),i.jsx("div",{className:"text-center",children:i.jsx("button",{type:"button",onClick:()=>{y?(v(!1),N(!1)):e(!t),C("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:y?"Back to Sign In":t?"Don't have an account? Sign Up":"Already have an account? Sign In"})}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-gray-600"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-2 bg-transparent text-gray-400 uppercase font-bold bg-[#1a1c23]",children:"Or continue with"})})]}),i.jsxs("button",{onClick:B,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors",children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),i.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),i.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),i.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),t?"Sign in with Google":"Sign up with Google"]})]})]})},gS=0,kp=1,bb=2,Nie=4;function VV(t){return()=>t}function tRe(t){t()}function K4(t,e){return r=>t(e(r))}function qV(t,e){return()=>t(e)}function rRe(t,e){return r=>t(e,r)}function yM(t){return t!==void 0}function nRe(...t){return()=>{t.map(tRe)}}function vw(){}function xS(t,e){return e(t),t}function sRe(t,e){return e(t)}function fi(...t){return t}function hs(t,e){return t(kp,e)}function xn(t,e){t(gS,e)}function bM(t){t(bb)}function Ni(t){return t(Nie)}function Er(t,e){return hs(t,rRe(e,gS))}function od(t,e){const r=t(kp,n=>{r(),e(n)});return r}function HV(t){let e,r;return n=>s=>{e=s,r&&clearTimeout(r),r=setTimeout(()=>{n(e)},t)}}function jie(t,e){return t===e}function li(t=jie){let e;return r=>n=>{t(e,n)||(e=n,r(n))}}function Wr(t){return e=>r=>{t(r)&&e(r)}}function cr(t){return e=>K4(e,t)}function Wd(t){return e=>()=>{e(t)}}function qt(t,...e){const r=iRe(...e);return((n,s)=>{switch(n){case bb:bM(t);return;case kp:return hs(t,r(s))}})}function Qd(t,e){return r=>n=>{r(e=t(e,n))}}function rg(t){return e=>r=>{t>0?t--:e(r)}}function lf(t){let e=null,r;return n=>s=>{e=s,!r&&(r=setTimeout(()=>{r=void 0,n(e)},t))}}function wn(...t){const e=new Array(t.length);let r=0,n=null;const s=Math.pow(2,t.length)-1;return t.forEach((a,o)=>{const l=Math.pow(2,o);hs(a,c=>{const u=r;r=r|l,e[o]=c,u!==s&&r===s&&n&&(n(),n=null)})}),a=>o=>{const l=()=>{a([o].concat(e))};r===s?l():n=l}}function iRe(...t){return e=>t.reduceRight(sRe,e)}function aRe(t){let e,r;const n=()=>e?.();return function(s,a){switch(s){case kp:return a?r===a?void 0:(n(),r=a,e=hs(t,a),e):(n(),vw);case bb:n(),r=null;return}}}function Yt(t){let e=t;const r=$n();return((n,s)=>{switch(n){case gS:e=s;break;case kp:{s(e);break}case Nie:return e}return r(n,s)})}function ll(t,e){return xS(Yt(e),r=>Er(t,r))}function $n(){const t=[];return((e,r)=>{switch(e){case gS:t.slice().forEach(n=>{n(r)});return;case bb:t.splice(0,t.length);return;case kp:return t.push(r),()=>{const n=t.indexOf(r);n>-1&&t.splice(n,1)}}})}function Lc(t){return xS($n(),e=>Er(t,e))}function ns(t,e=[],{singleton:r}={singleton:!0}){return{constructor:t,dependencies:e,id:oRe(),singleton:r}}const oRe=()=>Symbol();function lRe(t){const e=new Map,r=({constructor:n,dependencies:s,id:a,singleton:o})=>{if(o&&e.has(a))return e.get(a);const l=n(s.map(c=>r(c)));return o&&e.set(a,l),l};return r(t)}function Na(...t){const e=$n(),r=new Array(t.length);let n=0;const s=Math.pow(2,t.length)-1;return t.forEach((a,o)=>{const l=Math.pow(2,o);hs(a,c=>{r[o]=c,n=n|l,n===s&&xn(e,r)})}),function(a,o){switch(a){case bb:{bM(e);return}case kp:return n===s&&o(r),hs(e,o)}}}function qr(t,e=jie){return qt(t,li(e))}function k8(...t){return function(e,r){switch(e){case bb:return;case kp:return nRe(...t.map(n=>hs(n,r)))}}}var Oc=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(Oc||{});const cRe={0:"debug",3:"error",1:"log",2:"warn"},uRe=()=>typeof globalThis>"u"?window:globalThis,_p=ns(()=>{const t=Yt(3);return{log:Yt((e,r,n=1)=>{var s;const a=(s=uRe().VIRTUOSO_LOG_LEVEL)!=null?s:Ni(t);n>=a&&console[cRe[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,r)}),logLevel:t}},[],{singleton:!0});function ng(t,e,r){return vM(t,e,r).callbackRef}function vM(t,e,r){const n=Ie.useRef(null);let s=o=>{};const a=Ie.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const l=()=>{const c=o[0].target;c.offsetParent!==null&&t(c)};r?l():requestAnimationFrame(l)}):null,[t,r]);return s=o=>{o&&e?(a?.observe(o),n.current=o):(n.current&&a?.unobserve(n.current),n.current=null)},{callbackRef:s,ref:n}}function dRe(t,e,r,n,s,a,o,l,c){const u=Ie.useCallback(h=>{const f=hRe(h.children,e,"offsetHeight",s);let m=h.parentElement;for(;!m.dataset.virtuosoScroller;)m=m.parentElement;const g=m.lastElementChild.dataset.viewportType==="window";let y;g&&(y=m.ownerDocument.defaultView);const v=o?o.scrollTop:g?y.scrollY||y.document.documentElement.scrollTop:m.scrollTop,w=o?o.scrollHeight:g?y.document.documentElement.scrollHeight:m.scrollHeight,N=o?o.offsetHeight:g?y.innerHeight:m.offsetHeight;n({scrollHeight:w,scrollTop:Math.max(v,0),viewportHeight:N}),f!==null&&t(f)},[t,e,s,a,o,n,l]);return vM(u,r,c)}function hRe(t,e,r,n){const s=t.length;if(s===0)return null;const a=[];for(let o=0;o<s;o++){const l=t.item(o);if(l.dataset.index===void 0)continue;const c=parseInt(l.dataset.index),u=parseFloat(l.dataset.knownSize),h=e(l,r);if(h===0&&n("Zero-sized element, this should not happen",{child:l},Oc.ERROR),h===u)continue;const f=a[a.length-1];a.length===0||f.size!==h||f.endIndex!==c-1?a.push({endIndex:c,size:h,startIndex:c}):a[a.length-1].endIndex++}return a}function kie(t,e,r){const n=Ie.useRef(null),s=Ie.useCallback(c=>{if(!(c!=null&&c.offsetParent))return;const u=c.getBoundingClientRect(),h=u.width;let f,m;if(e){const g=e.getBoundingClientRect(),y=u.top-g.top;m=g.height-Math.max(0,y),f=y+e.scrollTop}else{const g=o.current.ownerDocument.defaultView;m=g.innerHeight-Math.max(0,u.top),f=u.top+g.scrollY}n.current={offsetTop:f,visibleHeight:m,visibleWidth:h},t(n.current)},[t,e]),{callbackRef:a,ref:o}=vM(s,!0,r),l=Ie.useCallback(()=>{s(o.current)},[s,o]);return Ie.useEffect(()=>{var c;if(e){e.addEventListener("scroll",l);const u=new ResizeObserver(()=>{requestAnimationFrame(l)});return u.observe(e),()=>{e.removeEventListener("scroll",l),u.unobserve(e)}}else{const u=(c=o.current)==null?void 0:c.ownerDocument.defaultView;return u?.addEventListener("scroll",l),u?.addEventListener("resize",l),()=>{u?.removeEventListener("scroll",l),u?.removeEventListener("resize",l)}}},[l,e,o]),a}const Ml=ns(()=>{const t=$n(),e=$n(),r=Yt(0),n=$n(),s=Yt(0),a=$n(),o=$n(),l=Yt(0),c=Yt(0),u=Yt(0),h=Yt(0),f=$n(),m=$n(),g=Yt(!1),y=Yt(!1),v=Yt(!1);return Er(qt(t,cr(({scrollTop:w})=>w)),e),Er(qt(t,cr(({scrollHeight:w})=>w)),o),Er(e,s),{deviation:r,fixedFooterHeight:u,fixedHeaderHeight:c,footerHeight:h,headerHeight:l,horizontalDirection:y,scrollBy:m,scrollContainerState:t,scrollHeight:o,scrollingInProgress:g,scrollTo:f,scrollTop:e,skipAnimationFrameInResizeObserver:v,smoothScrollTargetReached:n,statefulScrollTop:s,viewportHeight:a}},[],{singleton:!0}),x2={lvl:0};function _ie(t,e){const r=t.length;if(r===0)return[];let{index:n,value:s}=e(t[0]);const a=[];for(let o=1;o<r;o++){const{index:l,value:c}=e(t[o]);a.push({end:l-1,start:n,value:s}),n=l,s=c}return a.push({end:1/0,start:n,value:s}),a}function Rs(t){return t===x2}function y2(t,e){if(!Rs(t))return e===t.k?t.v:e<t.k?y2(t.l,e):y2(t.r,e)}function pd(t,e,r="k"){if(Rs(t))return[-1/0,void 0];if(Number(t[r])===e)return[t.k,t.v];if(Number(t[r])<e){const n=pd(t.r,e,r);return n[0]===-1/0?[t.k,t.v]:n}return pd(t.l,e,r)}function Ac(t,e,r){return Rs(t)?Eie(e,r,1):e===t.k?za(t,{k:e,v:r}):e<t.k?WV(za(t,{l:Ac(t.l,e,r)})):WV(za(t,{r:Ac(t.r,e,r)}))}function xy(){return x2}function yy(t,e,r){if(Rs(t))return[];const n=pd(t,e)[0];return fRe(S8(t,n,r))}function _8(t,e){if(Rs(t))return x2;const{k:r,l:n,r:s}=t;if(e===r){if(Rs(n))return s;if(Rs(s))return n;{const[a,o]=Cie(n);return Lj(za(t,{k:a,l:Sie(n),v:o}))}}else return e<r?Lj(za(t,{l:_8(n,e)})):Lj(za(t,{r:_8(s,e)}))}function vm(t){return Rs(t)?[]:[...vm(t.l),{k:t.k,v:t.v},...vm(t.r)]}function S8(t,e,r){if(Rs(t))return[];const{k:n,l:s,r:a,v:o}=t;let l=[];return n>e&&(l=l.concat(S8(s,e,r))),n>=e&&n<=r&&l.push({k:n,v:o}),n<=r&&(l=l.concat(S8(a,e,r))),l}function Lj(t){const{l:e,lvl:r,r:n}=t;if(n.lvl>=r-1&&e.lvl>=r-1)return t;if(r>n.lvl+1){if(hA(e))return Aie(za(t,{lvl:r-1}));if(!Rs(e)&&!Rs(e.r))return za(e.r,{l:za(e,{r:e.r.l}),lvl:r,r:za(t,{l:e.r.r,lvl:r-1})});throw new Error("Unexpected empty nodes")}else{if(hA(t))return C8(za(t,{lvl:r-1}));if(!Rs(n)&&!Rs(n.l)){const s=n.l,a=hA(s)?n.lvl-1:n.lvl;return za(s,{l:za(t,{lvl:r-1,r:s.l}),lvl:s.lvl+1,r:C8(za(n,{l:s.r,lvl:a}))})}else throw new Error("Unexpected empty nodes")}}function za(t,e){return Eie(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function Sie(t){return Rs(t.r)?t.l:Lj(za(t,{r:Sie(t.r)}))}function hA(t){return Rs(t)||t.lvl>t.r.lvl}function Cie(t){return Rs(t.r)?[t.k,t.v]:Cie(t.r)}function Eie(t,e,r,n=x2,s=x2){return{k:t,l:n,lvl:r,r:s,v:e}}function WV(t){return C8(Aie(t))}function Aie(t){const{l:e}=t;return!Rs(e)&&e.lvl===t.lvl?za(e,{r:za(t,{l:e.r})}):t}function C8(t){const{lvl:e,r}=t;return!Rs(r)&&!Rs(r.r)&&r.lvl===e&&r.r.lvl===e?za(r,{l:za(t,{r:r.l}),lvl:e+1}):t}function fRe(t){return _ie(t,({k:e,v:r})=>({index:e,value:r}))}function Tie(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function b2(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const wM=ns(()=>({recalcInProgress:Yt(!1)}),[],{singleton:!0});function Iie(t,e,r){return t[Y4(t,e,r)]}function Y4(t,e,r,n=0){let s=t.length-1;for(;n<=s;){const a=Math.floor((n+s)/2),o=t[a],l=r(o,e);if(l===0)return a;if(l===-1){if(s-n<2)return a-1;s=a-1}else{if(s===n)return a;n=a+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function pRe(t,e,r,n){const s=Y4(t,e,n),a=Y4(t,r,n,s);return t.slice(s,a+1)}function pp(t,e){return Math.round(t.getBoundingClientRect()[e])}function yS(t){return!Rs(t.groupOffsetTree)}function NM({index:t},e){return e===t?0:e<t?-1:1}function mRe(){return{groupIndices:[],groupOffsetTree:xy(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:xy()}}function gRe(t,e){let r=Rs(t)?0:1/0;for(const n of e){const{endIndex:s,size:a,startIndex:o}=n;if(r=Math.min(r,o),Rs(t)){t=Ac(t,0,a);continue}const l=yy(t,o-1,s+1);if(l.some(jRe(n)))continue;let c=!1,u=!1;for(const{end:h,start:f,value:m}of l)c?(s>=f||a===m)&&(t=_8(t,f)):(u=m!==a,c=!0),h>s&&s>=f&&m!==a&&(t=Ac(t,s+1,m));u&&(t=Ac(t,o,a))}return[t,r]}function xRe(t){return typeof t.groupIndex<"u"}function yRe({offset:t},e){return e===t?0:e<t?-1:1}function v2(t,e,r){if(e.length===0)return 0;const{index:n,offset:s,size:a}=Iie(e,t,NM),o=t-n,l=a*o+(o-1)*r+s;return l>0?l+r:l}function Pie(t,e){if(!yS(e))return t;let r=0;for(;e.groupIndices[r]<=t+r;)r++;return t+r}function Lie(t,e,r){if(xRe(t))return e.groupIndices[t.groupIndex]+1;{const n=t.index==="LAST"?r:t.index;let s=Pie(n,e);return s=Math.max(0,s,Math.min(r,s)),s}}function bRe(t,e,r,n=0){return n>0&&(e=Math.max(e,Iie(t,n,NM).offset)),_ie(pRe(t,e,r,yRe),NRe)}function vRe(t,[e,r,n,s]){e.length>0&&n("received item sizes",e,Oc.DEBUG);const a=t.sizeTree;let o=a,l=0;if(r.length>0&&Rs(a)&&e.length===2){const m=e[0].size,g=e[1].size;o=r.reduce((y,v)=>Ac(Ac(y,v,m),v+1,g),o)}else[o,l]=gRe(o,e);if(o===a)return t;const{lastIndex:c,lastOffset:u,lastSize:h,offsetTree:f}=E8(t.offsetTree,l,o,s);return{groupIndices:r,groupOffsetTree:r.reduce((m,g)=>Ac(m,g,v2(g,f,s)),xy()),lastIndex:c,lastOffset:u,lastSize:h,offsetTree:f,sizeTree:o}}function wRe(t){return vm(t).map(({k:e,v:r},n,s)=>{const a=s[n+1];return{endIndex:a?a.k-1:1/0,size:r,startIndex:e}})}function GV(t,e){let r=0,n=0;for(;r<t;)r+=e[n+1]-e[n]-1,n++;return n-(r===t?0:1)}function E8(t,e,r,n){let s=t,a=0,o=0,l=0,c=0;if(e!==0){c=Y4(s,e-1,NM),l=s[c].offset;const u=pd(r,e-1);a=u[0],o=u[1],s.length&&s[c].size===pd(r,e)[1]&&(c-=1),s=s.slice(0,c+1)}else s=[];for(const{start:u,value:h}of yy(r,e,1/0)){const f=u-a,m=f*o+l+f*n;s.push({index:u,offset:m,size:h}),a=u,l=m,o=h}return{lastIndex:a,lastOffset:l,lastSize:o,offsetTree:s}}function NRe(t){return{index:t.index,value:t}}function jRe(t){const{endIndex:e,size:r,startIndex:n}=t;return s=>s.start===n&&(s.end===e||s.end===1/0)&&s.value===r}const kRe={offsetHeight:"height",offsetWidth:"width"},kh=ns(([{log:t},{recalcInProgress:e}])=>{const r=$n(),n=$n(),s=ll(n,0),a=$n(),o=$n(),l=Yt(0),c=Yt([]),u=Yt(void 0),h=Yt(void 0),f=Yt(void 0),m=Yt(void 0),g=Yt((_,E)=>pp(_,kRe[E])),y=Yt(void 0),v=Yt(0),w=mRe(),N=ll(qt(r,wn(c,t,v),Qd(vRe,w),li()),w),k=ll(qt(c,li(),Qd((_,E)=>({current:E,prev:_.current}),{current:[],prev:[]}),cr(({prev:_})=>_)),[]);Er(qt(c,Wr(_=>_.length>0),wn(N,v),cr(([_,E,M])=>{const B=_.reduce((S,P,R)=>Ac(S,P,v2(P,E.offsetTree,M)||R),xy());return{...E,groupIndices:_,groupOffsetTree:B}})),N),Er(qt(n,wn(N),Wr(([_,{lastIndex:E}])=>_<E),cr(([_,{lastIndex:E,lastSize:M}])=>[{endIndex:E,size:M,startIndex:_}])),r),Er(u,h);const C=ll(qt(u,cr(_=>_===void 0)),!0);Er(qt(h,Wr(_=>_!==void 0&&Rs(Ni(N).sizeTree)),cr(_=>{const E=Ni(f),M=Ni(c).length>0;return E?M?[{endIndex:0,size:E,startIndex:0},{endIndex:1,size:_,startIndex:1}]:[]:[{endIndex:0,size:_,startIndex:0}]})),r),Er(qt(m,Wr(_=>_!==void 0&&_.length>0&&Rs(Ni(N).sizeTree)),cr(_=>{const E=[];let M=_[0],B=0;for(let S=1;S<_.length;S++){const P=_[S];P!==M&&(E.push({endIndex:S-1,size:M,startIndex:B}),M=P,B=S)}return E.push({endIndex:_.length-1,size:M,startIndex:B}),E})),r),Er(qt(c,wn(f,h),Wr(([,_,E])=>_!==void 0&&E!==void 0),cr(([_,E,M])=>{const B=[];for(let S=0;S<_.length;S++){const P=_[S],R=_[S+1];B.push({startIndex:P,endIndex:P,size:E}),R!==void 0&&B.push({startIndex:P+1,endIndex:R-1,size:M})}return B})),r);const I=Lc(qt(r,wn(N),Qd(({sizes:_},[E,M])=>({changed:M!==_,sizes:M}),{changed:!1,sizes:w}),cr(_=>_.changed)));hs(qt(l,Qd((_,E)=>({diff:_.prev-E,prev:E}),{diff:0,prev:0}),cr(_=>_.diff)),_=>{const{groupIndices:E}=Ni(N);if(_>0)xn(e,!0),xn(a,_+GV(_,E));else if(_<0){const M=Ni(k);M.length>0&&(_-=GV(-_,M)),xn(o,_)}}),hs(qt(l,wn(t)),([_,E])=>{_<0&&E("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:l},Oc.ERROR)});const O=Lc(a);Er(qt(a,wn(N),cr(([_,E])=>{const M=E.groupIndices.length>0,B=[],S=E.lastSize;if(M){const P=y2(E.sizeTree,0);let R=0,V=0;for(;R<_;){const G=E.groupIndices[V],J=E.groupIndices.length===V+1?1/0:E.groupIndices[V+1]-G-1;B.push({endIndex:G,size:P,startIndex:G}),B.push({endIndex:G+1+J-1,size:S,startIndex:G+1}),V++,R+=J+1}const ee=vm(E.sizeTree);return R!==_&&ee.shift(),ee.reduce((G,{k:J,v:Z})=>{let se=G.ranges;return G.prevSize!==0&&(se=[...G.ranges,{endIndex:J+_-1,size:G.prevSize,startIndex:G.prevIndex}]),{prevIndex:J+_,prevSize:Z,ranges:se}},{prevIndex:_,prevSize:0,ranges:B}).ranges}return vm(E.sizeTree).reduce((P,{k:R,v:V})=>({prevIndex:R+_,prevSize:V,ranges:[...P.ranges,{endIndex:R+_-1,size:P.prevSize,startIndex:P.prevIndex}]}),{prevIndex:0,prevSize:S,ranges:[]}).ranges})),r);const L=Lc(qt(o,wn(N,v),cr(([_,{offsetTree:E},M])=>{const B=-_;return v2(B,E,M)})));return Er(qt(o,wn(N,v),cr(([_,E,M])=>{if(E.groupIndices.length>0){if(Rs(E.sizeTree))return E;let B=xy();const S=Ni(k);let P=0,R=0,V=0;for(;P<-_;){V=S[R];const ee=S[R+1]-V-1;R++,P+=ee+1}if(B=vm(E.sizeTree).reduce((ee,{k:G,v:J})=>Ac(ee,Math.max(0,G+_),J),B),P!==-_){const ee=y2(E.sizeTree,V);B=Ac(B,0,ee);const G=pd(E.sizeTree,-_+1)[1];B=Ac(B,1,G)}return{...E,sizeTree:B,...E8(E.offsetTree,0,B,M)}}else{const B=vm(E.sizeTree).reduce((S,{k:P,v:R})=>Ac(S,Math.max(0,P+_),R),xy());return{...E,sizeTree:B,...E8(E.offsetTree,0,B,M)}}})),N),{beforeUnshiftWith:O,data:y,defaultItemSize:h,firstItemIndex:l,fixedItemSize:u,fixedGroupSize:f,gap:v,groupIndices:c,heightEstimates:m,itemSize:g,listRefresh:I,shiftWith:o,shiftWithOffset:L,sizeRanges:r,sizes:N,statefulTotalCount:s,totalCount:n,trackItemSizes:C,unshiftWith:a}},fi(_p,wM),{singleton:!0});function _Re(t){return t.reduce((e,r)=>(e.groupIndices.push(e.totalCount),e.totalCount+=r+1,e),{groupIndices:[],totalCount:0})}const Oie=ns(([{groupIndices:t,sizes:e,totalCount:r},{headerHeight:n,scrollTop:s}])=>{const a=$n(),o=$n(),l=Lc(qt(a,cr(_Re)));return Er(qt(l,cr(c=>c.totalCount)),r),Er(qt(l,cr(c=>c.groupIndices)),t),Er(qt(Na(s,e,n),Wr(([c,u])=>yS(u)),cr(([c,u,h])=>pd(u.groupOffsetTree,Math.max(c-h,0),"v")[0]),li(),cr(c=>[c])),o),{groupCounts:a,topItemsIndexes:o}},fi(kh,Ml)),Sp=ns(([{log:t}])=>{const e=Yt(!1),r=Lc(qt(e,Wr(n=>n),li()));return hs(e,n=>{n&&Ni(t)("props updated",{},Oc.DEBUG)}),{didMount:r,propsReady:e}},fi(_p),{singleton:!0}),SRe=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Mie(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!SRe)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const ww=ns(([{gap:t,listRefresh:e,sizes:r,totalCount:n},{fixedFooterHeight:s,fixedHeaderHeight:a,footerHeight:o,headerHeight:l,scrollingInProgress:c,scrollTo:u,smoothScrollTargetReached:h,viewportHeight:f},{log:m}])=>{const g=$n(),y=$n(),v=Yt(0);let w=null,N=null,k=null;function C(){w&&(w(),w=null),k&&(k(),k=null),N&&(clearTimeout(N),N=null),xn(c,!1)}return Er(qt(g,wn(r,f,n,v,l,o,m),wn(t,a,s),cr(([[I,O,L,_,E,M,B,S],P,R,V])=>{const ee=Mie(I),{align:G,behavior:J,offset:Z}=ee,se=_-1,X=Lie(ee,O,se);let q=v2(X,O.offsetTree,P)+M;G==="end"?(q+=R+pd(O.sizeTree,X)[1]-L+V,X===se&&(q+=B)):G==="center"?q+=(R+pd(O.sizeTree,X)[1]-L+V)/2:q-=E,Z&&(q+=Z);const U=H=>{C(),H?(S("retrying to scroll to",{location:I},Oc.DEBUG),xn(g,I)):(xn(y,!0),S("list did not change, scroll successful",{},Oc.DEBUG))};if(C(),J==="smooth"){let H=!1;k=hs(e,re=>{H=H||re}),w=od(h,()=>{U(H)})}else w=od(qt(e,CRe(150)),U);return N=setTimeout(()=>{C()},1200),xn(c,!0),S("scrolling from index to",{behavior:J,index:X,top:q},Oc.DEBUG),{behavior:J,top:q}})),u),{scrollTargetReached:y,scrollToIndex:g,topListHeight:v}},fi(kh,Ml,_p),{singleton:!0});function CRe(t){return e=>{const r=setTimeout(()=>{e(!1)},t);return n=>{n&&(e(!0),clearTimeout(r))}}}function jM(t,e){t==0?e():requestAnimationFrame(()=>{jM(t-1,e)})}function kM(t,e){const r=e-1;return typeof t=="number"?t:t.index==="LAST"?r:t.index}const Nw=ns(([{defaultItemSize:t,listRefresh:e,sizes:r},{scrollTop:n},{scrollTargetReached:s,scrollToIndex:a},{didMount:o}])=>{const l=Yt(!0),c=Yt(0),u=Yt(!0);return Er(qt(o,wn(c),Wr(([h,f])=>!!f),Wd(!1)),l),Er(qt(o,wn(c),Wr(([h,f])=>!!f),Wd(!1)),u),hs(qt(Na(e,o),wn(l,r,t,u),Wr(([[,h],f,{sizeTree:m},g,y])=>h&&(!Rs(m)||yM(g))&&!f&&!y),wn(c)),([,h])=>{od(s,()=>{xn(u,!0)}),jM(4,()=>{od(n,()=>{xn(l,!0)}),xn(a,h)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:c,scrolledToInitialItem:l}},fi(kh,Ml,ww,Sp),{singleton:!0});function Rie(t,e){return Math.abs(t-e)<1.01}const w2="up",O1="down",ERe="none",ARe={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},TRe=0,jw=ns(([{footerHeight:t,headerHeight:e,scrollBy:r,scrollContainerState:n,scrollTop:s,viewportHeight:a}])=>{const o=Yt(!1),l=Yt(!0),c=$n(),u=$n(),h=Yt(4),f=Yt(TRe),m=ll(qt(k8(qt(qr(s),rg(1),Wd(!0)),qt(qr(s),rg(1),Wd(!1),HV(100))),li()),!1),g=ll(qt(k8(qt(r,Wd(!0)),qt(r,Wd(!1),HV(200))),li()),!1);Er(qt(Na(qr(s),qr(f)),cr(([k,C])=>k<=C),li()),l),Er(qt(l,lf(50)),u);const y=Lc(qt(Na(n,qr(a),qr(e),qr(t),qr(h)),Qd((k,[{scrollHeight:C,scrollTop:I},O,L,_,E])=>{const M=I+O-C>-E,B={scrollHeight:C,scrollTop:I,viewportHeight:O};if(M){let P,R;return I>k.state.scrollTop?(P="SCROLLED_DOWN",R=k.state.scrollTop-I):(P="SIZE_DECREASED",R=k.state.scrollTop-I||k.scrollTopDelta),{atBottom:!0,atBottomBecause:P,scrollTopDelta:R,state:B}}let S;return B.scrollHeight>k.state.scrollHeight?S="SIZE_INCREASED":O<k.state.viewportHeight?S="VIEWPORT_HEIGHT_DECREASING":I<k.state.scrollTop?S="SCROLLING_UPWARDS":S="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:S,state:B}},ARe),li((k,C)=>k&&k.atBottom===C.atBottom))),v=ll(qt(n,Qd((k,{scrollHeight:C,scrollTop:I,viewportHeight:O})=>{if(Rie(k.scrollHeight,C))return{changed:!1,jump:0,scrollHeight:C,scrollTop:I};{const L=C-(I+O)<1;return k.scrollTop!==I&&L?{changed:!0,jump:k.scrollTop-I,scrollHeight:C,scrollTop:I}:{changed:!0,jump:0,scrollHeight:C,scrollTop:I}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),Wr(k=>k.changed),cr(k=>k.jump)),0);Er(qt(y,cr(k=>k.atBottom)),o),Er(qt(o,lf(50)),c);const w=Yt(O1);Er(qt(n,cr(({scrollTop:k})=>k),li(),Qd((k,C)=>Ni(g)?{direction:k.direction,prevScrollTop:C}:{direction:C<k.prevScrollTop?w2:O1,prevScrollTop:C},{direction:O1,prevScrollTop:0}),cr(k=>k.direction)),w),Er(qt(n,lf(50),Wd(ERe)),w);const N=Yt(0);return Er(qt(m,Wr(k=>!k),Wd(0)),N),Er(qt(s,lf(100),wn(m),Wr(([k,C])=>C),Qd(([k,C],[I])=>[C,I],[0,0]),cr(([k,C])=>C-k)),N),{atBottomState:y,atBottomStateChange:c,atBottomThreshold:h,atTopStateChange:u,atTopThreshold:f,isAtBottom:o,isAtTop:l,isScrolling:m,lastJumpDueToItemResize:v,scrollDirection:w,scrollVelocity:N}},fi(Ml)),N2="top",j2="bottom",KV="none";function YV(t,e,r){return typeof t=="number"?r===w2&&e===N2||r===O1&&e===j2?t:0:r===w2?e===N2?t.main:t.reverse:e===j2?t.main:t.reverse}function XV(t,e){var r;return typeof t=="number"?t:(r=t[e])!=null?r:0}const _M=ns(([{deviation:t,fixedHeaderHeight:e,headerHeight:r,scrollTop:n,viewportHeight:s}])=>{const a=$n(),o=Yt(0),l=Yt(0),c=Yt(0),u=ll(qt(Na(qr(n),qr(s),qr(r),qr(a,b2),qr(c),qr(o),qr(e),qr(t),qr(l)),cr(([h,f,m,[g,y],v,w,N,k,C])=>{const I=h-k,O=w+N,L=Math.max(m-I,0);let _=KV;const E=XV(C,N2),M=XV(C,j2);return g-=k,g+=m+N,y+=m+N,y-=k,g>h+O-E&&(_=w2),y<h-L+f+M&&(_=O1),_!==KV?[Math.max(I-m-YV(v,N2,_)-E,0),I-L-N+f+YV(v,j2,_)+M]:null}),Wr(h=>h!=null),li(b2)),[0,0]);return{increaseViewportBy:l,listBoundary:a,overscan:c,topListHeight:o,visibleRange:u}},fi(Ml),{singleton:!0});function IRe(t,e,r){if(yS(e)){const n=Pie(t,e);return[{index:pd(e.groupOffsetTree,n)[0],offset:0,size:0},{data:r?.[0],index:n,offset:0,size:0}]}return[{data:r?.[0],index:t,offset:0,size:0}]}const fA={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function Oj(t,e,r,n,s,a){const{lastIndex:o,lastOffset:l,lastSize:c}=s;let u=0,h=0;if(t.length>0){u=t[0].offset;const v=t[t.length-1];h=v.offset+v.size}const f=r-o,m=l+f*c+(f-1)*n,g=u,y=m-h;return{bottom:h,firstItemIndex:a,items:QV(t,s,a),offsetBottom:y,offsetTop:u,top:g,topItems:QV(e,s,a),topListHeight:e.reduce((v,w)=>w.size+v,0),totalCount:r}}function Die(t,e,r,n,s,a){let o=0;if(r.groupIndices.length>0)for(const h of r.groupIndices){if(h-o>=t)break;o++}const l=t+o,c=kM(e,l),u=Array.from({length:l}).map((h,f)=>({data:a[f+c],index:f+c,offset:0,size:0}));return Oj(u,[],l,s,r,n)}function QV(t,e,r){if(t.length===0)return[];if(!yS(e))return t.map(u=>({...u,index:u.index+r,originalIndex:u.index}));const n=t[0].index,s=t[t.length-1].index,a=[],o=yy(e.groupOffsetTree,n,s);let l,c=0;for(const u of t){(!l||l.end<u.index)&&(l=o.shift(),c=e.groupIndices.indexOf(l.start));let h;u.index===l.start?h={index:c,type:"group"}:h={groupIndex:c,index:u.index-(c+1)+r},a.push({...h,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return a}function JV(t,e){var r;return t===void 0?0:typeof t=="number"?t:(r=t[e])!=null?r:0}const Eg=ns(([{data:t,firstItemIndex:e,gap:r,sizes:n,totalCount:s},a,{listBoundary:o,topListHeight:l,visibleRange:c},{initialTopMostItemIndex:u,scrolledToInitialItem:h},{topListHeight:f},m,{didMount:g},{recalcInProgress:y}])=>{const v=Yt([]),w=Yt(0),N=$n(),k=Yt(0);Er(a.topItemsIndexes,v);const C=ll(qt(Na(g,y,qr(c,b2),qr(s),qr(n),qr(u),h,qr(v),qr(e),qr(r),qr(k),t),Wr(([_,E,,M,,,,,,,,B])=>{const S=B&&B.length!==M;return _&&!E&&!S}),cr(([,,[_,E],M,B,S,P,R,V,ee,G,J])=>{var Z,se,X,q;const U=B,{offsetTree:H,sizeTree:re}=U,ae=Ni(w);if(M===0)return{...fA,totalCount:M};if(_===0&&E===0)return ae===0?{...fA,totalCount:M}:Die(ae,S,B,V,ee,J||[]);if(Rs(re))return ae>0?null:Oj(IRe(kM(S,M),U,J),[],M,ee,U,V);const xe=[];if(R.length>0){const le=R[0],_e=R[R.length-1];let oe=0;for(const Oe of yy(re,le,_e)){const ze=Oe.value,Ye=Math.max(Oe.start,le),je=Math.min(Oe.end,_e);for(let Fe=Ye;Fe<=je;Fe++)xe.push({data:J?.[Fe],index:Fe,offset:oe,size:ze}),oe+=ze}}if(!P)return Oj([],xe,M,ee,U,V);const Ne=R.length>0?R[R.length-1]+1:0,pe=bRe(H,_,E,Ne);if(pe.length===0)return null;const K=M-1,ue=xS([],le=>{for(const _e of pe){const oe=_e.value;let Oe=oe.offset,ze=_e.start;const Ye=oe.size;if(oe.offset<_){ze+=Math.floor((_-oe.offset+ee)/(Ye+ee));const Fe=ze-_e.start;Oe+=Fe*Ye+Fe*ee}ze<Ne&&(Oe+=(Ne-ze)*Ye,ze=Ne);const je=Math.min(_e.end,K);for(let Fe=ze;Fe<=je&&!(Oe>=E);Fe++)le.push({data:J?.[Fe],index:Fe,offset:Oe,size:Ye}),Oe+=Ye+ee}}),fe=JV(G,N2),he=JV(G,j2);if(ue.length>0&&(fe>0||he>0)){const le=ue[0],_e=ue[ue.length-1];if(fe>0&&le.index>Ne){const oe=Math.min(fe,le.index-Ne),Oe=[];let ze=le.offset;for(let Ye=le.index-1;Ye>=le.index-oe;Ye--){const je=(se=(Z=yy(re,Ye,Ye)[0])==null?void 0:Z.value)!=null?se:le.size;ze-=je+ee,Oe.unshift({data:J?.[Ye],index:Ye,offset:ze,size:je})}ue.unshift(...Oe)}if(he>0&&_e.index<K){const oe=Math.min(he,K-_e.index);let Oe=_e.offset+_e.size+ee;for(let ze=_e.index+1;ze<=_e.index+oe;ze++){const Ye=(q=(X=yy(re,ze,ze)[0])==null?void 0:X.value)!=null?q:_e.size;ue.push({data:J?.[ze],index:ze,offset:Oe,size:Ye}),Oe+=Ye+ee}}}return Oj(ue,xe,M,ee,U,V)}),Wr(_=>_!==null),li()),fA);Er(qt(t,Wr(yM),cr(_=>_?.length)),s),Er(qt(C,cr(_=>_.topListHeight)),f),Er(f,l),Er(qt(C,cr(_=>[_.top,_.bottom])),o),Er(qt(C,cr(_=>_.items)),N);const I=Lc(qt(C,Wr(({items:_})=>_.length>0),wn(s,t),Wr(([{items:_},E])=>_[_.length-1].originalIndex===E-1),cr(([,_,E])=>[_-1,E]),li(b2),cr(([_])=>_))),O=Lc(qt(C,lf(200),Wr(({items:_,topItems:E})=>_.length>0&&_[0].originalIndex===E.length),cr(({items:_})=>_[0].index),li())),L=Lc(qt(C,Wr(({items:_})=>_.length>0),cr(({items:_})=>{let E=0,M=_.length-1;for(;_[E].type==="group"&&E<M;)E++;for(;_[M].type==="group"&&M>E;)M--;return{endIndex:_[M].index,startIndex:_[E].index}}),li(Tie)));return{endReached:I,initialItemCount:w,itemsRendered:N,listState:C,minOverscanItemCount:k,rangeChanged:L,startReached:O,topItemsIndexes:v,...m}},fi(kh,Oie,_M,Nw,ww,jw,Sp,wM),{singleton:!0}),Bie=ns(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:r,headerHeight:n},{listState:s}])=>{const a=$n(),o=ll(qt(Na(r,t,n,e,s),cr(([l,c,u,h,f])=>l+c+u+h+f.offsetBottom+f.bottom)),0);return Er(qr(o),a),{totalListHeight:o,totalListHeightChanged:a}},fi(Ml,Eg),{singleton:!0}),PRe=ns(([{viewportHeight:t},{totalListHeight:e}])=>{const r=Yt(!1),n=ll(qt(Na(r,t,e),Wr(([s])=>s),cr(([,s,a])=>Math.max(0,s-a)),lf(0),li()),0);return{alignToBottom:r,paddingTopAddition:n}},fi(Ml,Bie),{singleton:!0}),Fie=ns(()=>({context:Yt(null)})),LRe=({itemBottom:t,itemTop:e,locationParams:{align:r,behavior:n,...s},viewportBottom:a,viewportTop:o})=>e<o?{...s,align:r??"start",behavior:n}:t>a?{...s,align:r??"end",behavior:n}:null,$ie=ns(([{gap:t,sizes:e,totalCount:r},{fixedFooterHeight:n,fixedHeaderHeight:s,headerHeight:a,scrollingInProgress:o,scrollTop:l,viewportHeight:c},{scrollToIndex:u}])=>{const h=$n();return Er(qt(h,wn(e,c,r,a,s,n,l),wn(t),cr(([[f,m,g,y,v,w,N,k],C])=>{const{align:I,behavior:O,calculateViewLocation:L=LRe,done:_,...E}=f,M=Lie(f,m,y-1),B=v2(M,m.offsetTree,C)+v+w,S=B+pd(m.sizeTree,M)[1],P=k+w,R=k+g-N,V=L({itemBottom:S,itemTop:B,locationParams:{align:I,behavior:O,...E},viewportBottom:R,viewportTop:P});return V?_&&od(qt(o,Wr(ee=>!ee),rg(Ni(o)?1:2)),_):_?.(),V}),Wr(f=>f!==null)),u),{scrollIntoView:h}},fi(kh,Ml,ww,Eg,_p),{singleton:!0});function ZV(t){return t?t==="smooth"?"smooth":"auto":!1}const ORe=(t,e)=>typeof t=="function"?ZV(t(e)):e&&ZV(t),MRe=ns(([{listRefresh:t,totalCount:e,fixedItemSize:r,data:n},{atBottomState:s,isAtBottom:a},{scrollToIndex:o},{scrolledToInitialItem:l},{didMount:c,propsReady:u},{log:h},{scrollingInProgress:f},{context:m},{scrollIntoView:g}])=>{const y=Yt(!1),v=$n();let w=null;function N(O){xn(o,{align:"end",behavior:O,index:"LAST"})}hs(qt(Na(qt(qr(e),rg(1)),c),wn(qr(y),a,l,f),cr(([[O,L],_,E,M,B])=>{let S=L&&M,P="auto";return S&&(P=ORe(_,E||B),S=S&&!!P),{followOutputBehavior:P,shouldFollow:S,totalCount:O}}),Wr(({shouldFollow:O})=>O)),({followOutputBehavior:O,totalCount:L})=>{w&&(w(),w=null),Ni(r)?requestAnimationFrame(()=>{Ni(h)("following output to ",{totalCount:L},Oc.DEBUG),N(O)}):w=od(t,()=>{Ni(h)("following output to ",{totalCount:L},Oc.DEBUG),N(O),w=null})});function k(O){const L=od(s,_=>{O&&!_.atBottom&&_.notAtBottomBecause==="SIZE_INCREASED"&&!w&&(Ni(h)("scrolling to bottom due to increased size",{},Oc.DEBUG),N("auto"))});setTimeout(L,100)}hs(qt(Na(qr(y),e,u),Wr(([O,,L])=>O&&L),Qd(({value:O},[,L])=>({refreshed:O===L,value:L}),{refreshed:!1,value:0}),Wr(({refreshed:O})=>O),wn(y,e)),([,O])=>{Ni(l)&&k(O!==!1)}),hs(v,()=>{k(Ni(y)!==!1)}),hs(Na(qr(y),s),([O,L])=>{O&&!L.atBottom&&L.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&N("auto")});const C=Yt(null),I=$n();return Er(k8(qt(qr(n),cr(O=>{var L;return(L=O?.length)!=null?L:0})),qt(qr(e))),I),hs(qt(Na(qt(I,rg(1)),c),wn(qr(C),l,f,m),cr(([[O,L],_,E,M,B])=>L&&E&&_?.({context:B,totalCount:O,scrollingInProgress:M})),Wr(O=>!!O),lf(0)),O=>{w&&(w(),w=null),Ni(r)?requestAnimationFrame(()=>{Ni(h)("scrolling into view",{}),xn(g,O)}):w=od(t,()=>{Ni(h)("scrolling into view",{}),xn(g,O),w=null})}),{autoscrollToBottom:v,followOutput:y,scrollIntoViewOnChange:C}},fi(kh,jw,ww,Nw,Sp,_p,Ml,Fie,$ie)),RRe=ns(([{data:t,firstItemIndex:e,gap:r,sizes:n},{initialTopMostItemIndex:s},{initialItemCount:a,listState:o},{didMount:l}])=>(Er(qt(l,wn(a),Wr(([,c])=>c!==0),wn(s,n,e,r,t),cr(([[,c],u,h,f,m,g=[]])=>Die(c,u,h,f,m,g))),o),{}),fi(kh,Nw,Eg,Sp),{singleton:!0}),DRe=ns(([{didMount:t},{scrollTo:e},{listState:r}])=>{const n=Yt(0);return hs(qt(t,wn(n),Wr(([,s])=>s!==0),cr(([,s])=>({top:s}))),s=>{od(qt(r,rg(1),Wr(a=>a.items.length>1)),()=>{requestAnimationFrame(()=>{xn(e,s)})})}),{initialScrollTop:n}},fi(Sp,Ml,Eg),{singleton:!0}),Uie=ns(([{scrollVelocity:t}])=>{const e=Yt(!1),r=$n(),n=Yt(!1);return Er(qt(t,wn(n,e,r),Wr(([s,a])=>!!a),cr(([s,a,o,l])=>{const{enter:c,exit:u}=a;if(o){if(u(s,l))return!1}else if(c(s,l))return!0;return o}),li()),e),hs(qt(Na(e,t,r),wn(n)),([[s,a,o],l])=>{s&&l&&l.change&&l.change(a,o)}),{isSeeking:e,scrollSeekConfiguration:n,scrollSeekRangeChanged:r,scrollVelocity:t}},fi(jw),{singleton:!0}),SM=ns(([{scrollContainerState:t,scrollTo:e}])=>{const r=$n(),n=$n(),s=$n(),a=Yt(!1),o=Yt(void 0);return Er(qt(Na(r,n),cr(([{scrollHeight:l,scrollTop:c,viewportHeight:u},{offsetTop:h}])=>({scrollHeight:l,scrollTop:Math.max(0,c-h),viewportHeight:u}))),t),Er(qt(e,wn(n),cr(([l,{offsetTop:c}])=>({...l,top:l.top+c}))),s),{customScrollParent:o,useWindowScroll:a,windowScrollContainerState:r,windowScrollTo:s,windowViewportRect:n}},fi(Ml)),BRe=ns(([{sizeRanges:t,sizes:e},{headerHeight:r,scrollTop:n},{initialTopMostItemIndex:s},{didMount:a},{useWindowScroll:o,windowScrollContainerState:l,windowViewportRect:c}])=>{const u=$n(),h=Yt(void 0),f=Yt(null),m=Yt(null);return Er(l,f),Er(c,m),hs(qt(u,wn(e,n,o,f,m,r)),([g,y,v,w,N,k,C])=>{const I=wRe(y.sizeTree);w&&N!==null&&k!==null&&(v=N.scrollTop-k.offsetTop),v-=C,g({ranges:I,scrollTop:v})}),Er(qt(h,Wr(yM),cr(FRe)),s),Er(qt(a,wn(h),Wr(([,g])=>g!==void 0),li(),cr(([,g])=>g.ranges)),t),{getState:u,restoreStateFrom:h}},fi(kh,Ml,Nw,Sp,SM));function FRe(t){return{align:"start",index:0,offset:t.scrollTop}}const $Re=ns(([{topItemsIndexes:t}])=>{const e=Yt(0);return Er(qt(e,Wr(r=>r>=0),cr(r=>Array.from({length:r}).map((n,s)=>s))),t),{topItemCount:e}},fi(Eg));function zie(t){let e=!1,r;return(()=>(e||(e=!0,r=t()),r))}const URe=zie(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),zRe=ns(([{deviation:t,scrollBy:e,scrollingInProgress:r,scrollTop:n},{isAtBottom:s,isScrolling:a,lastJumpDueToItemResize:o,scrollDirection:l},{listState:c},{beforeUnshiftWith:u,gap:h,shiftWithOffset:f,sizes:m},{log:g},{recalcInProgress:y}])=>{const v=Lc(qt(c,wn(o),Qd(([,N,k,C],[{bottom:I,items:O,offsetBottom:L,totalCount:_},E])=>{const M=I+L;let B=0;return k===_&&N.length>0&&O.length>0&&(O[0].originalIndex===0&&N[0].originalIndex===0||(B=M-C,B!==0&&(B+=E))),[B,O,_,M]},[0,[],0,0]),Wr(([N])=>N!==0),wn(n,l,r,s,g,y),Wr(([,N,k,C,,,I])=>!I&&!C&&N!==0&&k===w2),cr(([[N],,,,,k])=>(k("Upward scrolling compensation",{amount:N},Oc.DEBUG),N))));function w(N){N>0?(xn(e,{behavior:"auto",top:-N}),xn(t,0)):(xn(t,0),xn(e,{behavior:"auto",top:-N}))}return hs(qt(v,wn(t,a)),([N,k,C])=>{C&&URe()?xn(t,k-N):w(-N)}),hs(qt(Na(ll(a,!1),t,y),Wr(([N,k,C])=>!N&&!C&&k!==0),cr(([N,k])=>k),lf(1)),w),Er(qt(f,cr(N=>({top:-N}))),e),hs(qt(u,wn(m,h),cr(([N,{groupIndices:k,lastSize:C,sizeTree:I},O])=>{function L(_){return _*(C+O)}if(k.length===0)return L(N);{let _=0;const E=y2(I,0);let M=0,B=0;for(;M<N;){M++,_+=E;let S=k.length===B+1?1/0:k[B+1]-k[B]-1;M+S>N&&(_-=E,S=N-M+1),M+=S,_+=L(S),B++}return _}})),N=>{xn(t,N),requestAnimationFrame(()=>{xn(e,{top:N}),requestAnimationFrame(()=>{xn(t,0),xn(y,!1)})})}),{deviation:t}},fi(Ml,jw,Eg,kh,_p,wM)),VRe=ns(([t,e,r,n,s,a,o,l,c,u,h])=>({...t,...e,...r,...n,...s,...a,...o,...l,...c,...u,...h}),fi(_M,RRe,Sp,Uie,Bie,DRe,PRe,SM,$ie,_p,Fie)),Vie=ns(([{data:t,defaultItemSize:e,firstItemIndex:r,fixedItemSize:n,fixedGroupSize:s,gap:a,groupIndices:o,heightEstimates:l,itemSize:c,sizeRanges:u,sizes:h,statefulTotalCount:f,totalCount:m,trackItemSizes:g},{initialItemFinalLocationReached:y,initialTopMostItemIndex:v,scrolledToInitialItem:w},N,k,C,I,{scrollToIndex:O},L,{topItemCount:_},{groupCounts:E},M])=>{const{listState:B,minOverscanItemCount:S,topItemsIndexes:P,rangeChanged:R,...V}=I;return Er(R,M.scrollSeekRangeChanged),Er(qt(M.windowViewportRect,cr(ee=>ee.visibleHeight)),N.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:r,fixedItemHeight:n,fixedGroupHeight:s,gap:a,groupCounts:E,heightEstimates:l,initialItemFinalLocationReached:y,initialTopMostItemIndex:v,scrolledToInitialItem:w,sizeRanges:u,topItemCount:_,topItemsIndexes:P,totalCount:m,...C,groupIndices:o,itemSize:c,listState:B,minOverscanItemCount:S,scrollToIndex:O,statefulTotalCount:f,trackItemSizes:g,rangeChanged:R,...V,...M,...N,sizes:h,...k}},fi(kh,Nw,Ml,BRe,MRe,Eg,ww,zRe,$Re,Oie,VRe));function qRe(t,e){const r={},n={};let s=0;const a=t.length;for(;s<a;)n[t[s]]=1,s+=1;for(const o in e)Object.hasOwn(n,o)||(r[o]=e[o]);return r}const wN=typeof document<"u"?Ie.useLayoutEffect:Ie.useEffect;function qie(t,e,r){const n=Object.keys(e.required||{}),s=Object.keys(e.optional||{}),a=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),l=Ie.createContext({});function c(w,N){w.propsReady&&xn(w.propsReady,!1);for(const k of n){const C=w[e.required[k]];xn(C,N[k])}for(const k of s)if(k in N){const C=w[e.optional[k]];xn(C,N[k])}w.propsReady&&xn(w.propsReady,!0)}function u(w){return a.reduce((N,k)=>(N[k]=C=>{const I=w[e.methods[k]];xn(I,C)},N),{})}function h(w){return o.reduce((N,k)=>(N[k]=aRe(w[e.events[k]]),N),{})}const f=Ie.forwardRef((w,N)=>{const{children:k,...C}=w,[I]=Ie.useState(()=>xS(lRe(t),_=>{c(_,C)})),[O]=Ie.useState(qV(h,I));wN(()=>{for(const _ of o)_ in C&&hs(O[_],C[_]);return()=>{Object.values(O).map(bM)}},[C,O,I]),wN(()=>{c(I,C)}),Ie.useImperativeHandle(N,VV(u(I)));const L=r;return i.jsx(l.Provider,{value:I,children:r?i.jsx(L,{...qRe([...n,...s,...o],C),children:k}):k})}),m=w=>{const N=Ie.useContext(l);return Ie.useCallback(k=>{xn(N[w],k)},[N,w])},g=w=>{const N=Ie.useContext(l)[w],k=Ie.useCallback(C=>hs(N,C),[N]);return Ie.useSyncExternalStore(k,()=>Ni(N),()=>Ni(N))},y=w=>{const N=Ie.useContext(l)[w],[k,C]=Ie.useState(qV(Ni,N));return wN(()=>hs(N,I=>{I!==k&&C(VV(I))}),[N,k]),k},v=Ie.version.startsWith("18")?g:y;return{Component:f,useEmitter:(w,N)=>{const k=Ie.useContext(l)[w];wN(()=>hs(k,N),[N,k])},useEmitterValue:v,usePublisher:m}}const Hie=Ie.createContext(void 0),Wie=Ie.createContext(void 0),Gie=typeof document<"u"?Ie.useLayoutEffect:Ie.useEffect;function pA(t){return"self"in t}function HRe(t){return"body"in t}function Kie(t,e,r,n=vw,s,a){const o=Ie.useRef(null),l=Ie.useRef(null),c=Ie.useRef(null),u=Ie.useCallback(m=>{let g,y,v;const w=m.target;if(HRe(w)||pA(w)){const k=pA(w)?w:w.defaultView;v=a?k.scrollX:k.scrollY,g=a?k.document.documentElement.scrollWidth:k.document.documentElement.scrollHeight,y=a?k.innerWidth:k.innerHeight}else v=a?w.scrollLeft:w.scrollTop,g=a?w.scrollWidth:w.scrollHeight,y=a?w.offsetWidth:w.offsetHeight;const N=()=>{t({scrollHeight:g,scrollTop:Math.max(v,0),viewportHeight:y})};m.suppressFlushSync?N():o_.flushSync(N),l.current!==null&&(v===l.current||v<=0||v===g-y)&&(l.current=null,e(!0),c.current&&(clearTimeout(c.current),c.current=null))},[t,e,a]);Ie.useEffect(()=>{const m=s||o.current;return n(s||o.current),u({suppressFlushSync:!0,target:m}),m.addEventListener("scroll",u,{passive:!0}),()=>{n(null),m.removeEventListener("scroll",u)}},[o,u,r,n,s]);function h(m){const g=o.current;if(!g||(a?"offsetWidth"in g&&g.offsetWidth===0:"offsetHeight"in g&&g.offsetHeight===0))return;const y=m.behavior==="smooth";let v,w,N;pA(g)?(w=Math.max(pp(g.document.documentElement,a?"width":"height"),a?g.document.documentElement.scrollWidth:g.document.documentElement.scrollHeight),v=a?g.innerWidth:g.innerHeight,N=a?window.scrollX:window.scrollY):(w=g[a?"scrollWidth":"scrollHeight"],v=pp(g,a?"width":"height"),N=g[a?"scrollLeft":"scrollTop"]);const k=w-v;if(m.top=Math.ceil(Math.max(Math.min(k,m.top),0)),Rie(v,w)||m.top===N){t({scrollHeight:w,scrollTop:N,viewportHeight:v}),y&&e(!0);return}y?(l.current=m.top,c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{c.current=null,l.current=null,e(!0)},1e3)):l.current=null,a&&(m={behavior:m.behavior,left:m.top}),g.scrollTo(m)}function f(m){a&&(m={behavior:m.behavior,left:m.top}),o.current.scrollBy(m)}return{scrollByCallback:f,scrollerRef:o,scrollToCallback:h}}const mA="-webkit-sticky",eq="sticky",CM=zie(()=>{if(typeof document>"u")return eq;const t=document.createElement("div");return t.style.position=mA,t.style.position===mA?mA:eq});function EM(t){return t}const WRe=ns(()=>{const t=Yt(l=>`Item ${l}`),e=Yt(l=>`Group ${l}`),r=Yt({}),n=Yt(EM),s=Yt("div"),a=Yt(vw),o=(l,c=null)=>ll(qt(r,cr(u=>u[l]),li()),c);return{components:r,computeItemKey:n,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:s,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}});fi(Vie,WRe);CM();const GRe={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},KRe={outline:"none",overflowX:"auto",position:"relative"},bS=t=>({height:"100%",position:"absolute",top:0,width:"100%"});CM();function qo(t,e){if(typeof t!="string")return{context:e}}function YRe(t,e){return{item:typeof t=="string"?void 0:e}}function Yie({useEmitter:t,useEmitterValue:e,usePublisher:r}){return Ie.memo(function({children:n,style:s,context:a,...o}){const l=r("scrollContainerState"),c=e("ScrollerComponent"),u=r("smoothScrollTargetReached"),h=e("scrollerRef"),f=e("horizontalDirection")||!1,{scrollByCallback:m,scrollerRef:g,scrollToCallback:y}=Kie(l,u,c,h,void 0,f);return t("scrollTo",y),t("scrollBy",m),i.jsx(c,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:g,style:{...f?KRe:GRe,...s},tabIndex:0,...o,...qo(c,a),children:n})})}function Xie({useEmitter:t,useEmitterValue:e,usePublisher:r}){return Ie.memo(function({children:n,style:s,context:a,...o}){const l=r("windowScrollContainerState"),c=e("ScrollerComponent"),u=r("smoothScrollTargetReached"),h=e("totalListHeight"),f=e("deviation"),m=e("customScrollParent"),g=Ie.useRef(null),y=e("scrollerRef"),{scrollByCallback:v,scrollerRef:w,scrollToCallback:N}=Kie(l,u,c,y,m);return Gie(()=>{var k;return w.current=m||((k=g.current)==null?void 0:k.ownerDocument.defaultView),()=>{w.current=null}},[w,m]),t("windowScrollTo",N),t("scrollBy",v),i.jsx(c,{ref:g,"data-virtuoso-scroller":!0,style:{position:"relative",...s,...h!==0?{height:h+f}:{}},...o,...qo(c,a),children:n})})}const XRe=ns(()=>{const t=Yt(u=>i.jsxs("td",{children:["Item $",u]})),e=Yt(null),r=Yt(u=>i.jsxs("td",{colSpan:1e3,children:["Group ",u]})),n=Yt(null),s=Yt(null),a=Yt({}),o=Yt(EM),l=Yt(vw),c=(u,h=null)=>ll(qt(a,cr(f=>f[u]),li()),h);return{components:a,computeItemKey:o,context:e,EmptyPlaceholder:c("EmptyPlaceholder"),FillerRow:c("FillerRow"),fixedFooterContent:s,fixedHeaderContent:n,itemContent:t,groupContent:r,ScrollerComponent:c("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder"),TableBodyComponent:c("TableBody","tbody"),TableComponent:c("Table","table"),TableFooterComponent:c("TableFoot","tfoot"),TableHeadComponent:c("TableHead","thead"),TableRowComponent:c("TableRow","tr"),GroupComponent:c("Group","tr")}}),QRe=ns(([t,e])=>({...t,...e}),fi(Vie,XRe)),JRe=({height:t})=>i.jsx("tr",{children:i.jsx("td",{style:{height:t}})}),ZRe=({height:t})=>i.jsx("tr",{children:i.jsx("td",{style:{border:0,height:t,padding:0}})}),e7e={overflowAnchor:"none"},tq={position:CM(),zIndex:2,overflowAnchor:"none"},rq=Ie.memo(function({showTopList:t=!1}){const e=gn("listState"),r=gn("computeItemKey"),n=gn("firstItemIndex"),s=gn("context"),a=gn("isSeeking"),o=gn("fixedHeaderHeight"),l=gn("groupIndices").length>0,c=gn("itemContent"),u=gn("groupContent"),h=gn("ScrollSeekPlaceholder")||JRe,f=gn("GroupComponent"),m=gn("TableRowComponent"),g=(t?e.topItems:[]).reduce((v,w,N)=>(N===0?v.push(w.size):v.push(v[N-1]+w.size),v),[]),y=(t?e.topItems:e.items).map(v=>{const w=v.originalIndex,N=r(w+n,v.data,s),k=t?w===0?0:g[w-1]:0;return a?b.createElement(h,{...qo(h,s),height:v.size,index:v.index,key:N,type:v.type||"item"}):v.type==="group"?b.createElement(f,{...qo(f,s),"data-index":w,"data-item-index":v.index,"data-known-size":v.size,key:N,style:{...tq,top:o}},u(v.index,s)):b.createElement(m,{...qo(m,s),...YRe(m,v.data),"data-index":w,"data-item-index":v.index,"data-known-size":v.size,"data-item-group-index":v.groupIndex,key:N,style:t?{...tq,top:o+k}:e7e},l?c(v.index,v.groupIndex,v.data,s):c(v.index,v.data,s))});return i.jsx(i.Fragment,{children:y})}),t7e=Ie.memo(function(){const t=gn("listState"),e=gn("topItemsIndexes").length>0,r=ld("sizeRanges"),n=gn("useWindowScroll"),s=gn("customScrollParent"),a=ld("windowScrollContainerState"),o=ld("scrollContainerState"),l=s||n?a:o,c=gn("trackItemSizes"),u=gn("itemSize"),h=gn("log"),{callbackRef:f,ref:m}=dRe(r,u,c,l,h,void 0,s,!1,gn("skipAnimationFrameInResizeObserver")),[g,y]=Ie.useState(0);AM("deviation",B=>{g!==B&&(m.current.style.marginTop=`${B}px`,y(B))});const v=gn("EmptyPlaceholder"),w=gn("FillerRow")||ZRe,N=gn("TableBodyComponent"),k=gn("paddingTopAddition"),C=gn("statefulTotalCount"),I=gn("context");if(C===0&&v)return i.jsx(v,{...qo(v,I)});const O=(e?t.topItems:[]).reduce((B,S)=>B+S.size,0),L=t.offsetTop+k+g-O,_=t.offsetBottom,E=L>0?i.jsx(w,{context:I,height:L},"padding-top"):null,M=_>0?i.jsx(w,{context:I,height:_},"padding-bottom"):null;return i.jsxs(N,{"data-testid":"virtuoso-item-list",ref:f,...qo(N,I),children:[E,e&&i.jsx(rq,{showTopList:!0}),i.jsx(rq,{}),M]})}),r7e=({children:t})=>{const e=Ie.useContext(Hie),r=ld("viewportHeight"),n=ld("fixedItemHeight"),s=ng(Ie.useMemo(()=>K4(r,a=>pp(a,"height")),[r]),!0,gn("skipAnimationFrameInResizeObserver"));return Ie.useEffect(()=>{e&&(r(e.viewportHeight),n(e.itemHeight))},[e,r,n]),i.jsx("div",{"data-viewport-type":"element",ref:s,style:bS(),children:t})},n7e=({children:t})=>{const e=Ie.useContext(Hie),r=ld("windowViewportRect"),n=ld("fixedItemHeight"),s=gn("customScrollParent"),a=kie(r,s,gn("skipAnimationFrameInResizeObserver"));return Ie.useEffect(()=>{e&&(n(e.itemHeight),r({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,r,n]),i.jsx("div",{"data-viewport-type":"window",ref:a,style:bS(),children:t})},s7e=Ie.memo(function(t){const e=gn("useWindowScroll"),r=gn("customScrollParent"),n=ld("fixedHeaderHeight"),s=ld("fixedFooterHeight"),a=gn("fixedHeaderContent"),o=gn("fixedFooterContent"),l=gn("context"),c=ng(Ie.useMemo(()=>K4(n,N=>pp(N,"height")),[n]),!0,gn("skipAnimationFrameInResizeObserver")),u=ng(Ie.useMemo(()=>K4(s,N=>pp(N,"height")),[s]),!0,gn("skipAnimationFrameInResizeObserver")),h=r||e?o7e:a7e,f=r||e?n7e:r7e,m=gn("TableComponent"),g=gn("TableHeadComponent"),y=gn("TableFooterComponent"),v=a?i.jsx(g,{ref:c,style:{position:"sticky",top:0,zIndex:2},...qo(g,l),children:a()},"TableHead"):null,w=o?i.jsx(y,{ref:u,style:{bottom:0,position:"sticky",zIndex:1},...qo(y,l),children:o()},"TableFoot"):null;return i.jsx(h,{...t,...qo(h,l),children:i.jsx(f,{children:i.jsxs(m,{style:{borderSpacing:0,overflowAnchor:"none"},...qo(m,l),children:[v,i.jsx(t7e,{},"TableBody"),w]})})})}),{Component:i7e,useEmitter:AM,useEmitterValue:gn,usePublisher:ld}=qie(QRe,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},s7e),a7e=Yie({useEmitter:AM,useEmitterValue:gn,usePublisher:ld}),o7e=Xie({useEmitter:AM,useEmitterValue:gn,usePublisher:ld}),l7e=i7e,nq={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},c7e={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:sq,floor:X4,max:M1,min:gA,round:iq}=Math;function aq(t,e,r){return Array.from({length:e-t+1}).map((n,s)=>({data:r===null?null:r[s+t],index:s+t}))}function u7e(t){return{...c7e,items:t}}function NN(t,e){return t&&t.width===e.width&&t.height===e.height}function d7e(t,e){return t&&t.column===e.column&&t.row===e.row}const h7e=ns(([{increaseViewportBy:t,listBoundary:e,overscan:r,visibleRange:n},{footerHeight:s,headerHeight:a,scrollBy:o,scrollContainerState:l,scrollTo:c,scrollTop:u,smoothScrollTargetReached:h,viewportHeight:f},m,g,{didMount:y,propsReady:v},{customScrollParent:w,useWindowScroll:N,windowScrollContainerState:k,windowScrollTo:C,windowViewportRect:I},O])=>{const L=Yt(0),_=Yt(0),E=Yt(nq),M=Yt({height:0,width:0}),B=Yt({height:0,width:0}),S=$n(),P=$n(),R=Yt(0),V=Yt(null),ee=Yt({column:0,row:0}),G=$n(),J=$n(),Z=Yt(!1),se=Yt(0),X=Yt(!0),q=Yt(!1),U=Yt(!1);hs(qt(y,wn(se),Wr(([pe,K])=>!!K)),()=>{xn(X,!1)}),hs(qt(Na(y,X,B,M,se,q),Wr(([pe,K,ue,fe,,he])=>pe&&!K&&ue.height!==0&&fe.height!==0&&!he)),([,,,,pe])=>{xn(q,!0),jM(1,()=>{xn(S,pe)}),od(qt(u),()=>{xn(e,[0,0]),xn(X,!0)})}),Er(qt(J,Wr(pe=>pe!=null&&pe.scrollTop>0),Wd(0)),_),hs(qt(y,wn(J),Wr(([,pe])=>pe!=null)),([,pe])=>{pe&&(xn(M,pe.viewport),xn(B,pe.item),xn(ee,pe.gap),pe.scrollTop>0&&(xn(Z,!0),od(qt(u,rg(1)),K=>{xn(Z,!1)}),xn(c,{top:pe.scrollTop})))}),Er(qt(M,cr(({height:pe})=>pe)),f),Er(qt(Na(qr(M,NN),qr(B,NN),qr(ee,(pe,K)=>pe&&pe.column===K.column&&pe.row===K.row),qr(u)),cr(([pe,K,ue,fe])=>({gap:ue,item:K,scrollTop:fe,viewport:pe}))),G),Er(qt(Na(qr(L),n,qr(ee,d7e),qr(B,NN),qr(M,NN),qr(V),qr(_),qr(Z),qr(X),qr(se)),Wr(([,,,,,,,pe])=>!pe),cr(([pe,[K,ue],fe,he,le,_e,oe,,Oe,ze])=>{const{column:Ye,row:je}=fe,{height:Fe,width:Nt}=he,{width:$t}=le;if(oe===0&&(pe===0||$t===0))return nq;if(Nt===0){const Dt=kM(ze,pe),at=Dt+Math.max(oe-1,0);return u7e(aq(Dt,at,_e))}const Ut=Qie($t,Nt,Ye);let nt,bt;Oe?K===0&&ue===0&&oe>0?(nt=0,bt=oe-1):(nt=Ut*X4((K+je)/(Fe+je)),bt=Ut*sq((ue+je)/(Fe+je))-1,bt=gA(pe-1,M1(bt,Ut-1)),nt=gA(bt,M1(0,nt))):(nt=0,bt=-1);const It=aq(nt,bt,_e),{bottom:_t,top:wt}=oq(le,fe,he,It),ut=sq(pe/Ut),Rt=ut*Fe+(ut-1)*je-_t;return{bottom:_t,itemHeight:Fe,items:It,itemWidth:Nt,offsetBottom:Rt,offsetTop:wt,top:wt}})),E),Er(qt(V,Wr(pe=>pe!==null),cr(pe=>pe.length)),L),Er(qt(Na(M,B,E,ee),Wr(([pe,K,{items:ue}])=>ue.length>0&&K.height!==0&&pe.height!==0),cr(([pe,K,{items:ue},fe])=>{const{bottom:he,top:le}=oq(pe,fe,K,ue);return[le,he]}),li(b2)),e);const H=Yt(!1);Er(qt(u,wn(H),cr(([pe,K])=>K||pe!==0)),H);const re=Lc(qt(Na(E,L),Wr(([{items:pe}])=>pe.length>0),wn(H),Wr(([[pe,K],ue])=>{const fe=pe.items[pe.items.length-1].index===K-1;return(ue||pe.bottom>0&&pe.itemHeight>0&&pe.offsetBottom===0&&pe.items.length===K)&&fe}),cr(([[,pe]])=>pe-1),li())),ae=Lc(qt(qr(E),Wr(({items:pe})=>pe.length>0&&pe[0].index===0),Wd(0),li())),xe=Lc(qt(qr(E),wn(Z),Wr(([{items:pe},K])=>pe.length>0&&!K),cr(([{items:pe}])=>({endIndex:pe[pe.length-1].index,startIndex:pe[0].index})),li(Tie),lf(0)));Er(xe,g.scrollSeekRangeChanged),Er(qt(S,wn(M,B,L,ee),cr(([pe,K,ue,fe,he])=>{const le=Mie(pe),{align:_e,behavior:oe,offset:Oe}=le;let ze=le.index;ze==="LAST"&&(ze=fe-1),ze=M1(0,ze,gA(fe-1,ze));let Ye=A8(K,he,ue,ze);return _e==="end"?Ye=iq(Ye-K.height+ue.height):_e==="center"&&(Ye=iq(Ye-K.height/2+ue.height/2)),Oe&&(Ye+=Oe),{behavior:oe,top:Ye}})),c);const Ne=ll(qt(E,cr(pe=>pe.offsetBottom+pe.bottom)),0);return Er(qt(I,cr(pe=>({height:pe.visibleHeight,width:pe.visibleWidth}))),M),{customScrollParent:w,data:V,deviation:R,footerHeight:s,gap:ee,headerHeight:a,increaseViewportBy:t,initialItemCount:_,itemDimensions:B,overscan:r,restoreStateFrom:J,scrollBy:o,scrollContainerState:l,scrollHeight:P,scrollTo:c,scrollToIndex:S,scrollTop:u,smoothScrollTargetReached:h,totalCount:L,useWindowScroll:N,viewportDimensions:M,windowScrollContainerState:k,windowScrollTo:C,windowViewportRect:I,...g,gridState:E,horizontalDirection:U,initialTopMostItemIndex:se,totalListHeight:Ne,...m,endReached:re,propsReady:v,rangeChanged:xe,startReached:ae,stateChanged:G,stateRestoreInProgress:Z,...O}},fi(_M,Ml,jw,Uie,Sp,SM,_p));function Qie(t,e,r){return M1(1,X4((t+r)/(X4(e)+r)))}function oq(t,e,r,n){const{height:s}=r;if(s===void 0||n.length===0)return{bottom:0,top:0};const a=A8(t,e,r,n[0].index);return{bottom:A8(t,e,r,n[n.length-1].index)+s,top:a}}function A8(t,e,r,n){const s=Qie(t.width,r.width,e.column),a=X4(n/s),o=a*r.height+M1(0,a-1)*e.row;return o>0?o+e.row:o}const f7e=ns(()=>{const t=Yt(f=>`Item ${f}`),e=Yt({}),r=Yt(null),n=Yt("virtuoso-grid-item"),s=Yt("virtuoso-grid-list"),a=Yt(EM),o=Yt("div"),l=Yt(vw),c=(f,m=null)=>ll(qt(e,cr(g=>g[f]),li()),m),u=Yt(!1),h=Yt(!1);return Er(qr(h),u),{components:e,computeItemKey:a,context:r,FooterComponent:c("Footer"),HeaderComponent:c("Header"),headerFooterTag:o,itemClassName:n,ItemComponent:c("Item","div"),itemContent:t,listClassName:s,ListComponent:c("List","div"),readyStateChanged:u,reportReadyState:h,ScrollerComponent:c("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder","div")}}),p7e=ns(([t,e])=>({...t,...e}),fi(h7e,f7e)),m7e=Ie.memo(function(){const t=wi("gridState"),e=wi("listClassName"),r=wi("itemClassName"),n=wi("itemContent"),s=wi("computeItemKey"),a=wi("isSeeking"),o=fu("scrollHeight"),l=wi("ItemComponent"),c=wi("ListComponent"),u=wi("ScrollSeekPlaceholder"),h=wi("context"),f=fu("itemDimensions"),m=fu("gap"),g=wi("log"),y=wi("stateRestoreInProgress"),v=fu("reportReadyState"),w=ng(Ie.useMemo(()=>N=>{const k=N.parentElement.parentElement.scrollHeight;o(k);const C=N.firstChild;if(C){const{height:I,width:O}=C.getBoundingClientRect();f({height:I,width:O})}m({column:lq("column-gap",getComputedStyle(N).columnGap,g),row:lq("row-gap",getComputedStyle(N).rowGap,g)})},[o,f,m,g]),!0,!1);return Gie(()=>{t.itemHeight>0&&t.itemWidth>0&&v(!0)},[t]),y?null:i.jsx(c,{className:e,ref:w,...qo(c,h),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(N=>{const k=s(N.index,N.data,h);return a?i.jsx(u,{...qo(u,h),height:t.itemHeight,index:N.index,width:t.itemWidth},k):b.createElement(l,{...qo(l,h),className:r,"data-index":N.index,key:k},n(N.index,N.data,h))})})}),g7e=Ie.memo(function(){const t=wi("HeaderComponent"),e=fu("headerHeight"),r=wi("headerFooterTag"),n=ng(Ie.useMemo(()=>a=>{e(pp(a,"height"))},[e]),!0,!1),s=wi("context");return t?i.jsx(r,{ref:n,children:i.jsx(t,{...qo(t,s)})}):null}),x7e=Ie.memo(function(){const t=wi("FooterComponent"),e=fu("footerHeight"),r=wi("headerFooterTag"),n=ng(Ie.useMemo(()=>a=>{e(pp(a,"height"))},[e]),!0,!1),s=wi("context");return t?i.jsx(r,{ref:n,children:i.jsx(t,{...qo(t,s)})}):null}),y7e=({children:t})=>{const e=Ie.useContext(Wie),r=fu("itemDimensions"),n=fu("viewportDimensions"),s=ng(Ie.useMemo(()=>a=>{n(a.getBoundingClientRect())},[n]),!0,!1);return Ie.useEffect(()=>{e&&(n({height:e.viewportHeight,width:e.viewportWidth}),r({height:e.itemHeight,width:e.itemWidth}))},[e,n,r]),i.jsx("div",{ref:s,style:bS(),children:t})},b7e=({children:t})=>{const e=Ie.useContext(Wie),r=fu("windowViewportRect"),n=fu("itemDimensions"),s=wi("customScrollParent"),a=kie(r,s,!1);return Ie.useEffect(()=>{e&&(n({height:e.itemHeight,width:e.itemWidth}),r({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,r,n]),i.jsx("div",{ref:a,style:bS(),children:t})},v7e=Ie.memo(function({...t}){const e=wi("useWindowScroll"),r=wi("customScrollParent"),n=r||e?j7e:N7e,s=r||e?b7e:y7e,a=wi("context");return i.jsx(n,{...t,...qo(n,a),children:i.jsxs(s,{children:[i.jsx(g7e,{}),i.jsx(m7e,{}),i.jsx(x7e,{})]})})}),{Component:w7e,useEmitter:Jie,useEmitterValue:wi,usePublisher:fu}=qie(p7e,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},v7e),N7e=Yie({useEmitter:Jie,useEmitterValue:wi,usePublisher:fu}),j7e=Xie({useEmitter:Jie,useEmitterValue:wi,usePublisher:fu});function lq(t,e,r){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&r(`${t} was not resolved to pixel value correctly`,e,Oc.WARN),e==="normal"?0:parseInt(e??"0",10)}const cq=w7e;function Zie(){const{currentUser:t}=Cr();yg();const e=["binders",{userId:t?.uid}],{data:r=[],isLoading:n,refetch:s}=iw({queryKey:e,queryFn:async()=>t?await He.getBinders():[],enabled:!!t,staleTime:1e3*60*5});return{binders:r,loading:n,refreshBinders:s}}const xA={W:{name:"White",flavor:"A single spark of light can banish a world of shadows.",theme:"Absolute Order",pips:["W"],bg:"bg-yellow-600"},U:{name:"Blue",flavor:"The mind is the only battlefield where victory is absolute.",theme:"Infinite Inquiry",pips:["U"],bg:"bg-blue-600"},B:{name:"Black",flavor:"Power at any cost, for greatness is written in blood.",theme:"Unrestricted Power",pips:["B"],bg:"bg-gray-800"},R:{name:"Red",flavor:"Do not fear the fire; fear the heart that commands it.",theme:"Chaotic Passion",pips:["R"],bg:"bg-red-600"},G:{name:"Green",flavor:"The forest does not ask for permission to grow.",theme:"Primal Growth",pips:["G"],bg:"bg-green-600"},C:{name:"Colorless",flavor:"Existence is a fleeting dream in the eyes of the silent.",theme:"The Great Void",pips:["C"],bg:"bg-gray-500"},WU:{name:"Azorius Senate",flavor:"Justice is blind, but she has a very long reach.",theme:"Bureaucratic Control",pips:["W","U"],bg:"bg-gradient-to-br from-yellow-300 to-blue-500"},UB:{name:"House Dimir",flavor:"The finest secrets are those that kill the ones who keep them.",theme:"Subterfuge & Infiltration",pips:["U","B"],bg:"bg-gradient-to-br from-blue-600 to-black"},BR:{name:"Cult of Rakdos",flavor:"Entertain us, or become the entertainment.",theme:"Carnival of Carnage",pips:["B","R"],bg:"bg-gradient-to-br from-black to-red-600"},RG:{name:"Gruul Clans",flavor:"Not for city-dwellers. Not for the weak. Only for the wild.",theme:"Primal Destruction",pips:["R","G"],bg:"bg-gradient-to-br from-red-500 to-green-600"},WG:{name:"Selesnya Conclave",flavor:"One voice is a whisper; the Conclave is a roar.",theme:"Collective Harmony",pips:["W","G"],bg:"bg-gradient-to-br from-green-500 to-yellow-200"},WB:{name:"Orzhov Syndicate",flavor:"Even death is no excuse for a breach of contract.",theme:"Indentured Eternity",pips:["W","B"],bg:"bg-gradient-to-br from-gray-200 to-gray-900"},BG:{name:"Golgari Swarm",flavor:"Every grave is a garden if you wait long enough.",theme:"Cycles of Rot",pips:["B","G"],bg:"bg-gradient-to-br from-gray-900 to-green-600"},UG:{name:"Simic Combine",flavor:"Nature is a rough draft; we are the final edit.",theme:"Biological Evolution",pips:["U","G"],bg:"bg-gradient-to-br from-green-400 to-blue-500"},UR:{name:"Izzet League",flavor:"If it doesn't explode, you aren't trying hard enough.",theme:"Volatile Genius",pips:["U","R"],bg:"bg-gradient-to-br from-blue-500 to-red-500"},WR:{name:"Boros Legion",flavor:"First to the fight, last to the fall.",theme:"Tactical Aggression",pips:["W","R"],bg:"bg-gradient-to-br from-red-600 to-yellow-200"},WUG:{name:"Bant",flavor:"The sigil of the sun protects those who stand together.",theme:"Knightly Order",pips:["W","U","G"],bg:"bg-gradient-to-r from-green-400 via-yellow-200 to-blue-400"},WUB:{name:"Esper",flavor:"Perfection is not a goal; it is a requirement.",theme:"Obsidian Logic",pips:["W","U","B"],bg:"bg-gradient-to-r from-yellow-200 via-blue-400 to-black"},UBR:{name:"Grixis",flavor:"A wasteland of power where only the cruelest thrive.",theme:"Ruthless Tyranny",pips:["U","B","R"],bg:"bg-gradient-to-r from-blue-600 via-black to-red-600"},BRG:{name:"Jund",flavor:"In this world, you are either the dragon or the meal.",theme:"Apex Predation",pips:["B","R","G"],bg:"bg-gradient-to-r from-black via-red-600 to-green-600"},WRG:{name:"Naya",flavor:"Where the mountains wake and the earth trembles.",theme:"Primal Majesty",pips:["W","R","G"],bg:"bg-gradient-to-r from-red-500 via-green-500 to-yellow-200"},WBG:{name:"Abzan",flavor:"We do not break; we simply outlast.",theme:"Eternal Endurance",pips:["W","B","G"],bg:"bg-gradient-to-r from-yellow-100 via-black to-green-600"},WUR:{name:"Jeskai",flavor:"The wind carries the strike; the mind guides the bolt.",theme:"Disciplined Spark",pips:["W","U","R"],bg:"bg-gradient-to-r from-blue-500 via-red-500 to-yellow-100"},UBG:{name:"Sultai",flavor:"Power is measured in gold and the bones of the fallen.",theme:"Opulent Decay",pips:["U","B","G"],bg:"bg-gradient-to-r from-black via-green-600 to-blue-600"},WBR:{name:"Mardu",flavor:"Victory is the only law worth following.",theme:"Relentless Conquest",pips:["W","B","R"],bg:"bg-gradient-to-r from-red-600 via-yellow-100 to-black"},URG:{name:"Temur",flavor:"The wild does not think; it reacts with ice and fire.",theme:"Elemental Instinct",pips:["U","R","G"],bg:"bg-gradient-to-r from-green-500 via-blue-500 to-red-500"},UBRG:{name:"Glint-Eye",flavor:"Order is a cage; we have chosen to break the locks.",theme:"Chaotic Adaptation",pips:["U","B","R","G"],bg:"bg-indigo-900"},WBRG:{name:"Dune-Brood",flavor:"When the logic of the mind fails, the instinct of the swarm prevails.",theme:"Sandless Conquest",pips:["W","B","R","G"],bg:"bg-orange-900"},WURG:{name:"Ink-Treader",flavor:"To touch one is to touch the whole of the world.",theme:"Radiant Reflection",pips:["W","U","R","G"],bg:"bg-sky-900"},WUBG:{name:"Witch-Maw",flavor:"There is a hunger beneath the earth that knows no fire.",theme:"Eldritch Growth",pips:["W","U","B","G"],bg:"bg-emerald-900"},WUBR:{name:"Yore-Tiller",flavor:"The past is a weapon we sharpen for the future.",theme:"Relentless History",pips:["W","U","B","R"],bg:"bg-slate-900"},WUBRG:{name:"WUBRG",flavor:"The full spectrum of power, bound in a single hand.",theme:"The Convergence",pips:["W","U","B","R","G"],bg:"bg-gradient-to-r from-yellow-500 via-blue-500 to-green-500"}},k7e=t=>{if(!t)return xA.C;const e={W:0,U:1,B:2,R:3,G:4,C:-1};let r=Array.isArray(t)?t:t.split("");const s=[...new Set(r)].filter(a=>e[a]!==void 0&&a!=="C").sort((a,o)=>e[a]-e[o]).join("");return xA[s]||xA.C},Mj=({options:t=[],selected:e=[],onChange:r,placeholder:n="Select...",label:s})=>{const[a,o]=b.useState(!1),[l,c]=b.useState(""),u=b.useRef(null);b.useEffect(()=>{const m=g=>{u.current&&!u.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const h=t.filter(m=>m.label.toLowerCase().includes(l.toLowerCase())),f=m=>{const g=e.includes(m)?e.filter(y=>y!==m):[...e,m];r(g)};return i.jsxs("div",{className:"relative",ref:u,children:[s&&i.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:s}),i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-left text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent flex justify-between items-center",children:[i.jsx("span",{className:"truncate",children:e.length===0?n:`${e.length} selected`}),i.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&i.jsxs("div",{className:"absolute z-50 mt-2 w-full bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl max-h-68 flex flex-col overflow-hidden animate-fade-in-down",children:[i.jsx("div",{className:"p-3 border-b border-white/5",children:i.jsx("input",{type:"text",placeholder:"Filter options...",className:"w-full bg-gray-950/50 border border-gray-800 rounded-xl px-3 py-2 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 placeholder-gray-600",value:l,onChange:m=>c(m.target.value),autoFocus:!0})}),i.jsx("div",{className:"overflow-y-auto flex-1 p-2 custom-scrollbar",children:h.length===0?i.jsx("div",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest p-4 text-center",children:"No results found"}):h.map(m=>i.jsxs("div",{onClick:()=>f(m.value),className:`
                                        flex items-center gap-3 px-3 py-2 rounded-xl cursor-pointer text-xs font-medium transition-all
                                        ${e.includes(m.value)?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/40":"text-gray-400 hover:bg-white/5 hover:text-white"}
                                    `,children:[i.jsx("div",{className:`w-4 h-4 rounded-md border transition-all flex items-center justify-center ${e.includes(m.value)?"bg-white border-white scale-110":"border-gray-700 bg-gray-950/50"}`,children:e.includes(m.value)&&i.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),i.jsx("span",{className:"truncate",children:m.label})]},m.value))})]})]})},TM=()=>i.jsx("div",{className:"relative aspect-[2.5/3.5] bg-gray-800 rounded-lg overflow-hidden border border-gray-700 animate-pulse",children:i.jsx("div",{className:"absolute inset-0 bg-gray-700/50"})}),T8=({src:t,alt:e,className:r,placeholder:n})=>{const[s,a]=b.useState(!1),[o,l]=b.useState(!1),c=()=>{a(!0)},u=()=>{l(!0),a(!0)};return i.jsxs("div",{className:`relative overflow-hidden ${r} bg-gray-900`,children:[!s&&i.jsx("div",{className:"absolute inset-0 z-0",children:n||i.jsx(TM,{})}),i.jsx("img",{src:o?"https://placehold.co/250x350?text=No+Image":t,alt:e,className:`
                    w-full h-full object-cover transition-opacity duration-500 ease-out
                    ${s?"opacity-100":"opacity-0"}
                `,onLoad:c,onError:u,loading:"lazy"})]})},Ky=b.memo(function({card:e,availableFoils:r,onRemove:n,showQuantity:s=!0,onClick:a,decks:o=[],ownerName:l,currentUser:c,showOwnerTag:u=!1,hideDeckTag:h=!1,hideOwnerTag:f=!1,selectMode:m=!1,isSelected:g=!1,onToggleSelect:y}){const[v,w]=b.useState(!1),{openCardModal:N}=aw(),k=o?.find(S=>S.id===e.deck_id)?.name,C=l||e.owner_username||(c&&(e.owner_id===c.id||e.user_id===c.id)?c.username||"ME":null),I=S=>parseFloat(e.prices?.[S]||e.data?.prices?.[S])||0,O=(S,P=0)=>{if(!S)return"https://placehold.co/250x350?text=No+Image";const R=S.data||S;return R.card_faces&&R.card_faces.length>1&&R.card_faces[P]?.image_uris?.normal?R.card_faces[P].image_uris.normal:R.image_uris?.normal||S.image_uri||"https://placehold.co/250x350?text=No+Image"},L=e.data?.card_faces?.length>1&&e.data?.card_faces?.[1]?.image_uris||e.card_faces?.length>1&&e.card_faces?.[1]?.image_uris,_=O(e,0),E=L?O(e,1):null,M=e.countInDeck||e.quantity||e.count||1,B=S=>{if(S.stopPropagation(),m&&y){y(e.id);return}a?a(e):N(e)};return i.jsx("div",{className:`relative group perspective-1000 h-full w-full aspect-[2.5/3.5] min-h-[200px] cursor-pointer ${g?"ring-4 ring-indigo-500 rounded-xl":""}`,onClick:B,children:i.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${v?"rotate-y-180":""}`,children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[i.jsx(T8,{src:_,alt:e.name,className:"w-full h-full rounded-lg"}),s&&M>1&&i.jsxs("div",{className:"absolute top-1.5 right-1.5 bg-black/80 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-sm z-20",children:["x",M]}),!h&&k&&i.jsxs("div",{className:"absolute top-[3.75rem] left-1.5 max-w-[80%] bg-indigo-600/90 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow-lg z-20 backdrop-blur-md border border-indigo-400/50 truncate uppercase tracking-tight",title:`In deck: ${k}`,children:[" ",k]}),!f&&u&&C&&i.jsxs("div",{className:`absolute ${k?"top-[5.25rem]":"top-[3.75rem]"} left-1.5 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-20 backdrop-blur-md uppercase tracking-wider`,children:[" ",C]}),e.finish==="foil"?i.jsx("div",{className:"absolute top-1.5 left-1.5 bg-yellow-500/80 text-yellow-100 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-300/50",children:""}):e.is_wishlist?i.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-600/90 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-orange-400/50 flex items-center gap-1",children:[i.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"WISH"]}):r?.has(e.name)&&i.jsx("div",{className:"absolute top-1.5 left-1.5 bg-gray-700/90 text-yellow-400 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-500/30 cursor-help",title:"Foil copy available in collection",children:""}),i.jsx("div",{className:"absolute bottom-1.5 left-1.5 right-1.5 bg-black/70 backdrop-blur-md px-2 py-1 rounded border border-white/10 z-20 text-[9px] font-mono flex items-center justify-center",children:i.jsxs("span",{className:e.finish==="foil"?"text-yellow-400":"text-green-400",children:["$",(e.finish==="foil"?I("usd_foil")||I("usd"):I("usd")||I("usd_foil")).toFixed(2)]})}),m&&i.jsx("div",{className:`absolute inset-0 z-40 transition-all duration-200 flex items-center justify-center ${g?"bg-indigo-500/20":"bg-black/40 hover:bg-black/20"}`,children:i.jsx("div",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all scale-110 ${g?"bg-indigo-500 border-indigo-500 text-white":"border-white/50 bg-black/40"}`,children:g&&i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})}),!m&&i.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-300 z-30",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20"}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/95 to-transparent p-3 pt-6",children:[i.jsx("p",{className:"font-black text-sm text-white leading-tight line-clamp-1 drop-shadow-lg mb-2",children:e.name}),i.jsx("div",{className:"flex items-center gap-2 mb-3",children:i.jsxs("div",{className:`flex items-center gap-1.5 border rounded-lg px-2.5 py-1 backdrop-blur-md ${e.finish==="foil"?"bg-yellow-500/20 border-yellow-500/40":"bg-green-500/20 border-green-500/40"}`,children:[i.jsx("svg",{className:`w-3 h-3 ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsxs("span",{className:`text-xs font-bold font-mono ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,children:["$",(e.finish==="foil"?I("usd_foil")||I("usd"):I("usd")||I("usd_foil")).toFixed(2)]})]})}),i.jsxs("div",{className:"flex gap-1.5",children:[i.jsxs("button",{onClick:B,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 text-white font-bold py-2 px-3 rounded-lg transition-all duration-200 flex items-center justify-center gap-1.5 shadow-lg hover:shadow-indigo-500/50 active:scale-95",children:[i.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),i.jsx("span",{className:"text-[10px] uppercase tracking-wider font-black",children:"View"})]}),L&&i.jsx("button",{onClick:S=>{S.stopPropagation(),w(!v)},className:"bg-gray-700/90 hover:bg-gray-600 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-gray-500/30 active:scale-95",title:"Flip",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),n&&i.jsx("button",{onClick:S=>{S.stopPropagation(),n(e.firestoreId||e.id,e.name)},className:"bg-red-600/90 hover:bg-red-500 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-red-500/50 active:scale-95",title:"Remove",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})]}),L&&i.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[i.jsx(T8,{src:E,alt:`${e.name} (Back)`,className:"w-full h-full rounded-lg"}),i.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[i.jsx("div",{className:"text-center",children:i.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:e.name})}),i.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"Click to Flip"})]})]})]})})}),_7e=({cards:t,isMixed:e})=>{const[r,n]=b.useState({key:"name",direction:"asc"}),s=b.useMemo(()=>{let c=[...t];return r.key&&c.sort((u,h)=>{let f=u[r.key],m=h[r.key];return r.key==="price"?(f=parseFloat(u.prices?.usd||0),m=parseFloat(h.prices?.usd||0)):r.key==="type"?(f=u.type_line||"",m=h.type_line||""):r.key==="set"&&(f=u.set_name||"",m=h.set_name||""),f<m?r.direction==="asc"?-1:1:f>m?r.direction==="asc"?1:-1:0}),c},[t,r]),a=c=>{let u="asc";r.key===c&&r.direction==="asc"&&(u="desc"),n({key:c,direction:u})},o=c=>r.key!==c?i.jsx("svg",{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):r.direction==="asc"?i.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):i.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),l=({label:c,sortKey:u,className:h=""})=>i.jsx("th",{className:`px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group hover:text-white transition-colors select-none bg-gray-900 border-b border-gray-800 ${h}`,onClick:()=>a(u),children:i.jsxs("div",{className:"flex items-center gap-2",children:[c,o(u)]})});return i.jsx("div",{className:"h-[calc(100vh-300px)] w-full bg-gray-950/40 rounded-2xl overflow-hidden border border-white/5 backdrop-blur-md",children:i.jsx(l7e,{data:s,components:{Table:c=>i.jsx("table",{...c,className:"w-full min-w-[1000px] border-collapse"}),TableRow:c=>i.jsx("tr",{...c,className:"group hover:bg-gray-800/30 transition-colors border-b border-gray-800/50"})},fixedHeaderContent:()=>i.jsxs("tr",{className:"bg-gray-900",children:[i.jsx(l,{label:"Card Name",sortKey:"name"}),i.jsx(l,{label:"Set",sortKey:"set"}),i.jsx(l,{label:"Type",sortKey:"type"}),i.jsx(l,{label:"Rarity",sortKey:"rarity"}),i.jsx(l,{label:"Market Price",sortKey:"price"}),i.jsx(l,{label:"Paid",sortKey:"price_bought"}),e&&i.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider bg-gray-900 border-b border-gray-800",children:"Owner"}),i.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider bg-gray-900 border-b border-gray-800",children:"Tags"})]}),itemContent:(c,u)=>i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"h-10 w-10 flex-shrink-0 relative rounded overflow-hidden mr-4 border border-gray-700 bg-gray-900 group-hover:scale-150 group-hover:z-10 transition-all origin-left",children:i.jsx(T8,{src:u.image_uri||u.image_uris?.small,alt:"",className:"h-full w-full object-cover",placeholder:i.jsx("div",{className:"w-full h-full bg-gray-800 animate-pulse"})})}),i.jsxs("div",{className:"ml-0",children:[i.jsx("div",{className:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors",children:u.name}),i.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["x",u.count]})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300 border border-gray-700",children:[i.jsx("svg",{className:"mr-1.5 h-3 w-3 text-indigo-400",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),u.set_name]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 truncate max-w-[200px]",title:u.type_line,children:u.type_line}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`
                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide
                                    ${u.rarity==="mythic"?"text-orange-400 bg-orange-900/10 border border-orange-500/20":u.rarity==="rare"?"text-yellow-400 bg-yellow-900/10 border border-yellow-500/20":u.rarity==="uncommon"?"text-blue-400 bg-blue-900/10 border border-blue-500/20":"text-gray-400 bg-gray-800 border border-gray-700"}
                                `,children:u.rarity})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-mono",children:["$",parseFloat(u.prices?.usd||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono",children:u.price_bought?`$${parseFloat(u.price_bought).toFixed(2)}`:"-"}),e&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center gap-2",title:u.owner_username,children:[i.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white text-[10px] font-bold",children:u.owner_username?u.owner_username[0].toUpperCase():"?"}),i.jsx("span",{className:"text-xs text-gray-400 truncate max-w-[80px]",children:u.owner_username})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex flex-wrap gap-1",children:[(u.tags&&typeof u.tags=="string"?JSON.parse(u.tags):u.tags||[]).map((h,f)=>i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:h},f)),(!u.tags||Array.isArray(u.tags)&&u.tags.length===0)&&i.jsx("span",{className:"text-gray-600 text-xs italic",children:"No tags"})]})})]})})})},S7e=({mode:t,onChange:e})=>i.jsxs("div",{className:"bg-gray-900 p-1 rounded-xl flex border border-gray-800",children:[i.jsx("button",{onClick:()=>e("folder"),className:`p-2 rounded-lg transition-all ${t==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Folder Group View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),i.jsx("button",{onClick:()=>e("grid"),className:`p-2 rounded-lg transition-all ${t==="grid"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Grid View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),i.jsx("button",{onClick:()=>e("table"),className:`p-2 rounded-lg transition-all ${t==="table"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Table List View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]}),C7e=({isOpen:t,onClose:e})=>{const{currentUser:r}=Cr(),{addToast:n}=Tn(),{refreshCollection:s}=yo(),[a,o]=b.useState(""),[l,c]=b.useState([]),[u,h]=b.useState(!1),[f,m]=b.useState("input"),[g,y]=b.useState([]),[v,w]=b.useState(""),[N,k]=b.useState(!1),[C,I]=b.useState([]),O=b.useRef(null),L=S=>{const P=S.trim();if(!P)return null;const R=P.split(/[,\t]/).map(Z=>Z.trim());if(R.length<1)return null;const V=R[0],ee=R[1]||null,G=R[2]||null,J=R[3]||null;return{count:1,name:V,set:ee,collector_number:G,tag:J,mode:"unified"}},_=async()=>{if(a.trim()){h(!0);try{const P=a.split(`
`).map(L).filter(Boolean),R=await Promise.all(P.map(async V=>{try{let ee="";if(V.set&&V.collector_number)ee=`https://api.scryfall.com/cards/${V.set.toLowerCase()}/${V.collector_number}`;else{let J=V.name;V.set&&(J+=` set:${V.set}`),ee=`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(J)}`}const G=await fetch(ee);if(G.ok){const J=await G.json();return{...V,valid:!0,scryfallId:J.id,data:J,image:J.image_uris?.small||J.card_faces?.[0]?.image_uris?.small}}else{if(V.set&&V.collector_number){const J=await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(V.name)}`);if(J.ok){const Z=await J.json();return{...V,valid:!0,scryfallId:Z.id,data:Z,image:Z.image_uris?.small||Z.card_faces?.[0]?.image_uris?.small,warning:"Exact match failed, found by name."}}}return{...V,valid:!1}}}catch{return{...V,valid:!1}}}));c(R),m("preview")}catch{n("Failed to parse cards","error")}finally{h(!1)}}},E=S=>{const P=S.target.files[0];if(!P)return;const R=new FileReader;R.onload=V=>{o(V.target.result)},R.readAsText(P)},M=async()=>{k(!0);const S=l.filter(P=>P.valid);try{const P=S.map(ee=>{const G=[...g];return ee.tag&&!G.includes(ee.tag)&&G.push(ee.tag),{name:ee.data.name,scryfall_id:ee.scryfallId,set_code:ee.data.set,collector_number:ee.data.collector_number,image_uri:ee.data.image_uris?.normal||ee.data.card_faces?.[0]?.image_uris?.normal,count:ee.count,data:ee.data,tags:JSON.stringify(G)}}),R=await r.getIdToken();if(!(await fetch("http://localhost:3000/api/collection/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify({cards:P,mode:"merge"})})).ok)throw new Error("Import failed");I(P),m("success"),s(),n(`Successfully imported ${S.length} cards!`,"success")}catch(P){console.error(P),n("Import failed. Check console.","error")}finally{k(!1)}},B=S=>{S.key==="Enter"&&v.trim()&&(g.includes(v.trim())||y([...g,v.trim()]),w(""))};return t?Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-white/10",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-black text-white",children:f==="success"?"Import Complete":"Bulk Import"}),i.jsx("p",{className:"text-gray-400",children:f==="success"?`Successfully added ${C.length} cards to your collection.`:"Import cards from CSV or text list."})]}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[f==="input"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl text-blue-200 text-sm",children:[i.jsx("p",{className:"font-bold mb-2",children:"Supported Formats:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"CSV (Recommended)"}),i.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",i.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",i.jsx("br",{}),"Black Lotus, LEA, 1, Power 9"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"Text List"}),i.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",i.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",i.jsx("br",{}),"Command Tower, CMD, , Base"]})]})]})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("button",{onClick:()=>O.current.click(),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-lg text-sm font-bold text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload CSV / Text File"]}),i.jsx("input",{type:"file",ref:O,onChange:E,accept:".csv,.txt",className:"hidden"})]}),i.jsx("textarea",{value:a,onChange:S=>o(S.target.value),placeholder:"Paste your list here...",className:"w-full h-80 bg-gray-800/50 border border-gray-700 text-gray-200 p-4 rounded-xl font-mono focus:ring-2 focus:ring-indigo-500 outline-none resize-none text-sm"})]}),f==="preview"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Apply Tags to Batch"}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[g.map(S=>i.jsxs("span",{className:"bg-indigo-600 text-white px-2 py-1 rounded text-sm flex items-center gap-1",children:[S,i.jsx("button",{onClick:()=>y(g.filter(P=>P!==S)),className:"hover:text-red-300",children:""})]},S)),i.jsx("input",{type:"text",placeholder:"Type tag & Enter...",value:v,onChange:S=>w(S.target.value),onKeyDown:B,className:"bg-transparent border-none focus:ring-0 text-white placeholder-gray-600 text-sm min-w-[120px]"})]})]}),i.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800",children:i.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[i.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3",children:"Card"}),i.jsx("th",{className:"p-3",children:"Set"}),i.jsx("th",{className:"p-3 text-center",children:"Qty"}),i.jsx("th",{className:"p-3",children:"Matched Tag"}),i.jsx("th",{className:"p-3 text-right",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-800",children:l.map((S,P)=>i.jsxs("tr",{className:S.valid?"":"bg-red-900/10",children:[i.jsxs("td",{className:"p-3 flex items-center gap-3",children:[S.image?i.jsx("img",{src:S.image,className:"w-8 h-8 rounded object-cover",alt:""}):i.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded flex items-center justify-center text-xs",children:"?"}),i.jsxs("div",{children:[i.jsx("div",{className:S.valid?"text-white font-bold":"text-red-400 line-through",children:S.name}),S.warning&&i.jsx("div",{className:"text-[10px] text-yellow-500",children:S.warning})]})]}),i.jsx("td",{className:"p-3",children:S.data?.set_name||S.set||"-"}),i.jsx("td",{className:"p-3 text-center font-mono",children:S.count}),i.jsx("td",{className:"p-3",children:S.tag&&i.jsx("span",{className:"text-xs bg-gray-700 px-1 rounded text-gray-300",children:S.tag})}),i.jsx("td",{className:"p-3 text-right",children:S.valid?i.jsx("span",{className:"text-green-400",children:"Ready"}):i.jsx("span",{className:"text-red-500",children:"Not Found"})})]},P))})]})})]}),f==="success"&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-4 rounded-xl text-center mb-6",children:[i.jsx("div",{className:"text-5xl mb-2",children:""}),i.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Import Successful!"}),i.jsx("p",{className:"text-green-200 text-sm",children:"Your new cards have been added to the collection."})]}),i.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800 max-h-[50vh] overflow-y-auto",children:i.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[i.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold sticky top-0 bg-gray-900 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3",children:"Card"}),i.jsx("th",{className:"p-3",children:"Set"}),i.jsx("th",{className:"p-3 text-center",children:"Qty"}),i.jsx("th",{className:"p-3",children:"Applied Tags"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-800",children:C.map((S,P)=>i.jsxs("tr",{children:[i.jsxs("td",{className:"p-3 flex items-center gap-3",children:[i.jsx("img",{src:S.image_uri,className:"w-8 h-8 rounded object-cover",alt:""}),i.jsx("span",{className:"text-white font-bold",children:S.name})]}),i.jsx("td",{className:"p-3",children:S.set_code?.toUpperCase()}),i.jsx("td",{className:"p-3 text-center font-mono",children:S.count}),i.jsx("td",{className:"p-3",children:i.jsx("div",{className:"flex flex-wrap gap-1",children:JSON.parse(S.tags).map(R=>i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:R},R))})})]},P))})]})})]})]}),i.jsx("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-900/50 rounded-b-2xl",children:f==="input"?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:e,className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Cancel"}),i.jsx("button",{onClick:_,disabled:u||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:u?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Review Cards"]}):"Review Cards"})]}):f==="preview"?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>m("input"),className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Back to Edit"}),i.jsx("button",{onClick:M,disabled:N||l.filter(S=>S.valid).length===0,className:"bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:N?"Importing...":`Import ${l.filter(S=>S.valid).length} Cards`})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{}),i.jsx("button",{onClick:e,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg",children:"Done"})]})})]})}),document.body):null},E7e=t=>{const e=t.toLowerCase(),r=[];let n="Smart Binder",s="",a="blue",o=`Generated from "${t}"`;(e.includes("red")||e.includes("fire")||e.includes("mountain")||e.includes("burn"))&&(a="red",e.includes("goblin")||(n="Red Collection")),(e.includes("green")||e.includes("forest")||e.includes("elf")||e.includes("nature"))&&(a="green",e.includes("elf")||(n="Green Collection")),(e.includes("blue")||e.includes("island")||e.includes("control")||e.includes("water"))&&(a="blue",n="Blue Collection"),(e.includes("black")||e.includes("swamp")||e.includes("death")||e.includes("grave"))&&(a="purple",n="Black Collection"),(e.includes("white")||e.includes("plains")||e.includes("light")||e.includes("angel"))&&(a="gray",n="White Collection"),e.includes("commander")||e.includes("legend")||e.includes("edh")?(r.push({field:"type",operator:"contains",value:"Legendary Creature"}),s="",n="Commanders",(e.includes("potential")||e.includes("candidate"))&&(n="Potential Commanders")):e.includes("creature")&&(r.push({field:"type",operator:"contains",value:"Creature"}),n==="Smart Binder"&&(n="Creatures",s="")),e.includes("land")&&(r.push({field:"type",operator:"contains",value:"Land"}),s="",n="Lands"),(e.includes("artifact")||e.includes("rock"))&&(r.push({field:"type",operator:"contains",value:"Artifact"}),s="",n="Artifacts"),e.includes("enchantment")&&(r.push({field:"type",operator:"contains",value:"Enchantment"}),s="",n="Enchantments"),e.includes("goblin")&&(r.push({field:"type",operator:"contains",value:"Goblin"}),s="",n="Goblin Tribe",a="red"),(e.includes("elf")||e.includes("elves"))&&(r.push({field:"type",operator:"contains",value:"Elf"}),s="",n="Elven Tribe",a="green"),e.includes("not in deck")||e.includes("unused")||e.includes("spare")||e.includes("binder fodder")?(r.push({field:"in_deck",operator:"is",value:"false"}),n==="Smart Binder"?n="Unused Cards":n=`Unused ${n}`):(e.includes("in deck")||e.includes("used")||e.includes("active"))&&(r.push({field:"in_deck",operator:"is",value:"true"}),n=`Active ${n}`),(e.includes("expensive")||e.includes("value")||e.includes("money")||e.includes("high end")||e.includes("sell")&&!e.includes("not")&&!e.includes("dont")&&!e.includes("wouldnt"))&&(r.push({field:"price",operator:"gt",value:"5.00"}),s="",n.includes("Commander")||(n="High Value")),(e.includes("bulk")||e.includes("cheap")||e.includes("pauper")||e.includes("sell")&&(e.includes("not")||e.includes("dont")||e.includes("wouldnt")))&&(r.push({field:"price",operator:"lt",value:"1.00"}),s="",n="Bulk Storage"),e.includes("trade")&&(r.some(c=>c.field==="in_deck")||r.push({field:"in_deck",operator:"is",value:"false"}),n="Trade Binder",s="");const l=[];return e.includes("rare")&&l.push("rare"),e.includes("mythic")&&l.push("mythic"),l.length>0&&(r.push({field:"rarity",operator:"in",value:l}),(!s||s==="")&&(s="")),(e.includes("duplicate")||e.includes("playset")||e.includes("extra")||e.includes("few of")||e.includes("many"))&&(r.push({field:"count",operator:"gt",value:"4"}),n==="Smart Binder"&&(n="Trade Stock"),s=""),r.length===0&&r.push({field:"name",operator:"contains",value:t}),{id:`ai-${Date.now()}`,name:n,description:o,icon:s,color:a,rules:r}},jN={string:[{id:"contains",label:"contains"},{id:"is",label:"is exactly"},{id:"not",label:"is not"}],number:[{id:"gt",label:"is greater than"},{id:"lt",label:"is less than"},{id:"eq",label:"is exactly"}],select:[{id:"in",label:"is one of"},{id:"not_in",label:"is none of"}],color:[{id:"contains",label:"contains"},{id:"contains_any",label:"contains any of"},{id:"is_exactly",label:"is exactly"}],boolean:[{id:"is",label:"is"}]},kN=[{id:"name",label:"Name",type:"string"},{id:"colors",label:"Color Identity",type:"color"},{id:"rarity",label:"Rarity",type:"select",options:["common","uncommon","rare","mythic"]},{id:"type",label:"Type Line",type:"string"},{id:"price",label:"Market Price ($)",type:"number"},{id:"cmc",label:"Mana Value (CMC)",type:"number"},{id:"set",label:"Set Code",type:"string"},{id:"count",label:"Quantity",type:"number"},{id:"in_deck",label:"In a Deck?",type:"boolean",options:[{id:"true",label:"In a Deck"},{id:"false",label:"Not in a Deck"}]}],A7e=({rules:t=[],onChange:e})=>{const r=Array.isArray(t)?t:[],[n,s]=b.useState(!1),a=()=>{const u={field:"name",operator:"contains",value:""};e([...r,u])},o=(u,h)=>{const f=[...r];if(f[u]={...f[u],...h},h.field){const m=kN.find(y=>y.id===h.field),g=jN[m.type]||jN.string;f[u].operator=g[0].id,f[u].value=m.type==="select"?[]:m.type==="color"?[]:m.type==="boolean"?m.options[0].id:""}e(f)},l=u=>{e(r.filter((h,f)=>f!==u))},c=(u,h)=>{const f=r[u].value||[],m=f.includes(h)?f.filter(g=>g!==h):[...f,h].sort((g,y)=>"WUBRG".indexOf(g)-"WUBRG".indexOf(y));o(u,{value:m})};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-500",children:"Logic Rules"}),i.jsx("button",{onClick:a,className:"text-[10px] font-bold bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 px-3 py-1 rounded-full hover:bg-indigo-600 hover:text-white transition-all",children:"+ Add Condition"})]}),i.jsxs("div",{className:"space-y-3",children:[r.map((u,h)=>{const f=kN.find(g=>g.id===u.field)||kN[0],m=jN[f.type]||jN.string;return i.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center gap-2 bg-gray-950/40 p-3 rounded-2xl border border-gray-800/50 hover:border-gray-700 transition-all",children:[i.jsx("div",{className:"w-12 text-[10px] font-black uppercase text-indigo-500/60",children:h===0?"IF":"AND"}),i.jsx("select",{value:u.field,onChange:g=>o(h,{field:g.target.value}),className:"bg-gray-950/50 border border-white/5 text-white text-xs font-black rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:kN.map(g=>i.jsx("option",{value:g.id,children:g.label},g.id))}),i.jsx("select",{value:u.operator,onChange:g=>o(h,{operator:g.target.value}),className:"bg-gray-950/50 border border-white/5 text-indigo-400 text-xs font-bold rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:m.map(g=>i.jsx("option",{value:g.id,children:g.label},g.id))}),i.jsx("div",{className:"flex-1 min-w-[150px]",children:f.type==="color"?i.jsx("div",{className:"flex gap-1",children:"WUBRGC".split("").map(g=>i.jsx("button",{onClick:()=>c(h,g),className:`w-7 h-7 rounded-full flex items-center justify-center transition-all border ${u.value?.includes(g)?"bg-indigo-600 border-indigo-400 shadow-[0_0_10px_rgba(79,70,229,0.4)]":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-500"}`,children:i.jsx("i",{className:`ms ms-${g.toLowerCase()} ms-cost text-xs ${u.value?.includes(g)?"text-white":""}`})},g))}):f.type==="select"?i.jsx("div",{className:"flex flex-wrap gap-1",children:f.options.map(g=>i.jsx("button",{onClick:()=>{const y=u.value||[],v=y.includes(g)?y.filter(w=>w!==g):[...y,g];o(h,{value:v})},className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase transition-all border ${u.value?.includes(g)?"bg-indigo-600/20 border-indigo-500 text-indigo-400":"bg-gray-800 border-gray-700 text-gray-500"}`,children:g},g))}):f.type==="boolean"?i.jsx("div",{className:"flex gap-1",children:f.options.map(g=>i.jsx("button",{onClick:()=>o(h,{value:g.id}),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all border ${u.value===g.id?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-600"}`,children:g.label},g.id))}):i.jsx("input",{type:f.type==="number"?"number":"text",value:u.value,placeholder:"Value...",onChange:g=>o(h,{value:g.target.value}),className:"w-full bg-gray-900/50 border-none text-white text-xs rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 outline-none"})}),i.jsx("button",{onClick:()=>l(h),className:"p-1 px-2 text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all text-sm",title:"Remove Rule",children:""})]},h)}),r.length===0&&i.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-800 rounded-3xl",children:[i.jsx("p",{className:"text-gray-600 text-sm font-medium italic",children:"No rules defined. This binder will be empty or use manual selection."}),i.jsx("button",{onClick:a,className:"text-indigo-400 text-xs font-bold mt-2 hover:underline",children:"+ Click to create your first rule"})]})]}),i.jsxs("div",{className:"mt-4 p-4 bg-indigo-950/10 border border-indigo-900/20 rounded-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Binder Recipe Output"})]}),i.jsx("button",{onClick:()=>s(!n),className:"text-[10px] font-bold text-gray-500 hover:text-white transition-colors uppercase tracking-wider",children:n?"Show Preview":"Import / Export"})]}),n?i.jsxs("div",{children:[i.jsx("textarea",{value:JSON.stringify(r,null,2),onChange:u=>{try{const h=JSON.parse(u.target.value);Array.isArray(h)&&e(h)}catch{}},className:"w-full h-32 bg-gray-900/50 border border-indigo-500/30 rounded-xl p-3 text-[10px] font-mono text-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 resize-y",placeholder:"Paste rule JSON here..."}),i.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Copy this JSON to share rules between binders. Paste existing JSON to load it."})]}):i.jsx("div",{className:"font-mono text-[10px] text-gray-500 break-all leading-relaxed select-text cursor-text active:text-indigo-400 transition-colors",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(r,null,2))},title:"Click to copy JSON to clipboard",children:r.length>0?i.jsxs(i.Fragment,{children:["SELECT * FROM collection WHERE user_id = current_user",r.map((u,h)=>i.jsxs("span",{className:"text-indigo-300/60 block ml-4",children:["AND ",u.field," ",u.operator," '",Array.isArray(u.value)?u.value.join(", "):u.value,"'"]},h))]}):"-- No rules defined yet --"})]})]})},tc={METHOD:1,CONFIG:2,REVIEW:3},T7e=[...new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","0","1","2","3","4","5","6","7","8","9","","","#","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""])],I7e=({isOpen:t,onClose:e,selectedCards:r=[],editingBinder:n=null})=>{const{addToast:s}=Tn();yo();const[a,o]=b.useState(tc.METHOD),[l,c]=b.useState(!1),[u,h]=b.useState(""),[f,m]=b.useState("collection"),[g,y]=b.useState("emoji"),[v,w]=b.useState(""),[N,k]=b.useState("blue"),[C,I]=b.useState([]),[O,L]=b.useState([]),[_,E]=b.useState(!1);b.useEffect(()=>{if(t){if(n){o(tc.CONFIG),h(n.name||""),m(n.type||"collection"),y(n.icon_type||"emoji"),w(n.icon_value||""),k(n.color_preference||"blue");let U=[];try{const H=n.rules?typeof n.rules=="string"?JSON.parse(n.rules):n.rules:[];U=Array.isArray(H)?H:[]}catch(H){console.error("Failed to parse binder rules",H)}L(U),E(!!n.rules),I([])}else o(tc.METHOD),h(""),m("collection"),y("emoji"),w(""),k("blue"),I(r||[]),L([]),E(!1);B([])}},[t,n]);const[M,B]=b.useState([]),[S,P]=b.useState(""),[R,V]=b.useState(!1),ee=async()=>{S.trim()&&(V(!0),B([]),setTimeout(()=>{const U=E7e(S);B([U]),V(!1)},800))},G=U=>{h(U.name),w(U.icon),k(U.color),L(U.rules),E(!0),o(tc.CONFIG)},J=async()=>{c(!0);try{const U={name:u,type:f,icon_type:g,icon_value:v,color_preference:N,rules:_?O:null};let H;if(n?(await He.updateBinder(n.id,U),H=n.id):H=(await He.post("/api/binders",U)).id,C.length>0){const re=C.map(ae=>ae.firestoreId||ae.id);await He.put("/api/collection/batch-update",{cardIds:re,binderId:H})}s(n?"Binder updated!":"Binder created successfully!","success"),e()}catch(U){console.error("[BinderWizard] Submit error:",U),s("Failed to save binder","error")}finally{c(!1)}},Z=async()=>{if(n&&window.confirm(`Are you sure you want to delete "${n.name}"? This will NOT delete the cards inside.`)){c(!0);try{await He.deleteBinder(n.id),s("Binder deleted","success"),e()}catch(U){console.error("[BinderWizard] Delete error:",U),s("Failed to delete binder","error")}finally{c(!1)}}},se=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("button",{onClick:()=>{E(!1),o(tc.CONFIG)},className:"p-6 bg-gray-950/40 hover:bg-indigo-900/10 border border-white/5 hover:border-indigo-500/50 rounded-3xl text-left transition-all group relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:i.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),i.jsx("div",{className:"w-14 h-14 bg-gray-800 rounded-2xl flex items-center justify-center text-3xl mb-4 group-hover:scale-110 transition-transform shadow-xl",children:""}),i.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Manual Binder"}),i.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:"Classic storage. Move cards in and out exactly how you want."})]}),i.jsxs("div",{className:"p-6 bg-indigo-950/20 border border-indigo-500/20 rounded-3xl relative overflow-hidden flex flex-col h-full",children:[i.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:i.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.381z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[i.jsx("div",{className:"w-14 h-14 bg-indigo-600/20 text-indigo-400 rounded-2xl flex items-center justify-center text-3xl mb-4 shadow-xl shadow-indigo-900/20",children:""}),i.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Smart Creator"}),i.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["Describe what you want, and AI will build the rules for you. ",i.jsx("button",{onClick:()=>window.open("https://github.com/TristinParker/MTGLibrary/blob/main/docs/SMART_BINDERS.md","_blank"),className:"text-indigo-400 hover:text-indigo-300 underline md:hidden",children:"What is this?"})]}),i.jsx("div",{className:"mt-auto",children:i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:S,onChange:U=>P(U.target.value),placeholder:'e.g., "Red Goblins over $5"',className:"w-full bg-black/40 border border-indigo-500/30 rounded-xl pl-4 pr-12 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-sm",onKeyDown:U=>U.key==="Enter"&&ee()}),i.jsx("button",{onClick:ee,disabled:!S.trim()||R,className:"absolute right-1 top-1 bottom-1 px-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-all flex items-center justify-center",children:R?i.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})})]})]})]}),(R||M.length>0)&&i.jsxs("div",{className:"mt-8 space-y-4 animate-fade-in-up",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-px bg-white/10 flex-1"}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Suggested Blueprints"}),i.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),R?i.jsxs("div",{className:"py-8 flex flex-col items-center",children:[i.jsxs("div",{className:"relative w-16 h-16",children:[i.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500/20 rounded-full"}),i.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),i.jsx("p",{className:"mt-4 text-indigo-400 font-mono text-xs animate-pulse",children:"Generating rules..."})]}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:M.map(U=>i.jsxs("button",{onClick:()=>G(U),className:"p-4 bg-gray-900/60 hover:bg-gray-800 border border-white/5 hover:border-indigo-500/30 rounded-2xl flex items-center gap-4 transition-all text-left group shadow-lg",children:[i.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-transform group-hover:scale-110",style:{backgroundColor:`rgba(${U.color==="purple"?"139, 92, 246":U.color==="green"?"16, 185, 129":U.color==="orange"?"249, 115, 22":"239, 68, 68"}, 0.1)`},children:U.icon}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-white text-sm",children:U.name}),i.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:U.description})]}),i.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-indigo-500",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]},U.id))})]})]}),X=()=>i.jsxs("div",{className:"space-y-8 max-w-xl mx-auto",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Binder Name"}),i.jsx("input",{type:"text",value:u,onChange:U=>h(U.target.value),placeholder:"e.g., The Vault",autoFocus:!0,className:"w-full bg-gray-950 border-2 border-white/5 focus:border-indigo-500/50 text-white px-5 py-4 rounded-2xl focus:outline-none font-black text-xl transition-all shadow-inner shadow-black/40 placeholder:text-gray-800"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Icon Type"}),i.jsxs("div",{className:"flex bg-gray-950 p-1 rounded-xl border border-white/5",children:[i.jsx("button",{onClick:()=>y("emoji"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${g==="emoji"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Emoji"}),i.jsx("button",{onClick:()=>y("mtg"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${g==="mtg"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Symbols"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Theme Color"}),i.jsxs("div",{className:"flex gap-2 bg-gray-950 p-2 rounded-xl border border-white/5 overflow-x-auto custom-scrollbar no-scrollbar items-center",children:[["blue","red","green","purple","orange","gray"].map(U=>i.jsx("button",{onClick:()=>k(U),className:`w-6 h-6 shrink-0 rounded-full transition-all ${N===U?"ring-2 ring-white scale-110 shadow-lg":"opacity-40 hover:opacity-100"}`,style:{backgroundColor:U==="blue"?"#3B82F6":U==="red"?"#EF4444":U==="green"?"#10B981":U==="purple"?"#8B5CF6":U==="orange"?"#F59E0B":"#6B7280"}},U)),i.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),i.jsx("div",{className:"relative group",children:i.jsx("div",{className:`w-6 h-6 rounded-full border border-white/20 flex items-center justify-center overflow-hidden ${["blue","red","green","purple","orange","gray"].includes(N)?"":"ring-2 ring-white"}`,children:i.jsx("input",{type:"color",value:["blue","red","green","purple","orange","gray"].includes(N)?"#ffffff":N,onChange:U=>k(U.target.value),className:"w-8 h-8 -m-1 cursor-pointer"})})})]})]})]})]}),i.jsx("div",{className:"bg-gray-950 rounded-3xl p-5 border border-white/5 shadow-inner shadow-black/40",children:i.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 gap-3 h-40 overflow-y-auto custom-scrollbar pr-2",children:g==="emoji"?T7e.map(U=>i.jsx("button",{onClick:()=>w(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40":"bg-gray-900 border border-white/5 text-gray-500 hover:bg-gray-800 hover:text-white"}`,children:U},U)):["ms-w","ms-u","ms-b","ms-r","ms-g","ms-c","ms-wp","ms-up","ms-bp","ms-rp","ms-gp","ms-s","ms-x","ms-e","ms-planeswalker","ms-land","ms-artifact","ms-enchantment","ms-creature","ms-instant","ms-sorcery","ms-multiple","ms-guild-azorius","ms-guild-selesnya","ms-guild-boros","ms-guild-dimir","ms-guild-simic","ms-guild-gruul","ms-guild-rakdos","ms-guild-orzhov","ms-guild-izzet","ms-guild-golgari","ms-clan-abzan","ms-clan-jeskai","ms-clan-sultai","ms-clan-mardu","ms-clan-temur","ms-shard-bant","ms-shard-esper","ms-shard-grixis","ms-shard-jund","ms-shard-naya","ms-p","ms-chaos","ms-loyalty-up","ms-loyalty-down","ms-loyalty-zero","ms-tap","ms-untap","ms-flashback","ms-dfc-day","ms-dfc-night"].map(U=>i.jsx("button",{onClick:()=>w(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40 text-white":"bg-gray-900 border border-white/5 text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:i.jsx("i",{className:`ms ${U} ms-cost`})},U))})}),i.jsxs("div",{className:"bg-gray-950 rounded-3xl p-6 border border-white/5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-xl transition-colors ${_?"bg-indigo-600/20 text-indigo-400":"bg-gray-800 text-gray-500"}`,children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-white font-bold text-sm",children:"Automated Smart Rules"}),i.jsx("p",{className:"text-[10px] text-gray-500",children:"Auto-organize collection based on conditions."})]})]}),i.jsx("button",{onClick:()=>E(!_),className:`w-12 h-6 rounded-full transition-all relative ${_?"bg-indigo-600":"bg-gray-800"}`,children:i.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-md ${_?"left-7":"left-1"}`})})]}),_&&i.jsx("div",{className:"pt-4 border-t border-white/5 animate-fade-in",children:i.jsx(A7e,{rules:O,onChange:L})})]})]}),q=()=>i.jsxs("div",{className:"text-center py-10 space-y-8 animate-fade-in",children:[i.jsxs("div",{className:"relative inline-block",children:[i.jsx("div",{className:`absolute inset-0 bg-${N}-500/20 blur-3xl rounded-full scale-150 animate-pulse`}),i.jsxs("div",{className:"relative w-32 h-32 bg-gray-900 border-4 border-white/10 rounded-[2.5rem] flex items-center justify-center text-6xl shadow-2xl z-10 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none"}),v.startsWith("ms")?i.jsx("i",{className:`ms ${v} ms-2x`}):v]}),i.jsx("div",{className:"absolute -bottom-2 -right-2 px-3 py-1 bg-indigo-600 text-white text-[10px] font-black uppercase rounded-full shadow-lg border border-white/20 z-20",children:_?"Smart":"Manual"})]}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-4xl font-black text-white mb-2 leading-tight",children:u||"Unnamed Binder"}),i.jsx("p",{className:"text-gray-500 text-sm",children:_?`Smart Binder with ${O.length} rule(s)`:"Curated collection binder"})]}),i.jsx("div",{className:"bg-gray-950/40 rounded-3xl p-6 border border-white/5 max-w-sm mx-auto shadow-inner shadow-black/60",children:_?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[i.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Recipe Preview"})]}),i.jsxs("div",{className:"space-y-2",children:[O.map((U,H)=>i.jsxs("div",{className:"text-xs text-gray-400 bg-black/40 p-2 rounded-xl border border-white/5 flex gap-2",children:[i.jsx("span",{className:"font-bold text-gray-500 uppercase",children:H===0?"IF":"AND"}),i.jsxs("span",{children:[U.field," ",i.jsx("span",{className:"text-indigo-400",children:U.operator})," '",Array.isArray(U.value)?U.value.join(", "):U.value,"'"]})]},H)),O.length===0&&i.jsx("p",{className:"text-xs text-red-400 italic",children:"Warning: No rules defined! This binder will be empty."})]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest text-gray-500",children:[i.jsx("span",{children:"Manifest"}),i.jsxs("span",{children:[C.length," Cards"]})]}),i.jsx("div",{className:"flex justify-center -space-x-4 pl-4 h-24 items-end pb-2",children:C.length>0?C.slice(0,5).map((U,H)=>i.jsx("div",{className:"w-16 h-20 bg-gray-800 rounded-lg border-2 border-white/10 shadow-2xl relative transition-transform hover:-translate-y-2 overflow-hidden",style:{transform:`rotate(${(H-2)*8}deg)`},children:U.data?.image_uris?.small||U.image_uris?.small?i.jsx("img",{src:U.data?.image_uris?.small||U.image_uris.small,className:"w-full h-full object-cover",alt:""}):null},H)):i.jsx("div",{className:"text-gray-700 italic text-xs",children:"Empty binder (add cards later)"})}),C.length>5&&i.jsxs("div",{className:"text-[10px] text-gray-600 font-bold",children:["+ ",C.length-5," more items"]})]})})]});return t?Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-950 border border-white/10 rounded-[2.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] w-full max-w-2xl flex flex-col max-h-[90vh] overflow-hidden relative",children:[i.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-48 h-1 bg-${N}-500 blur-md opacity-30`}),i.jsxs("div",{className:"p-8 pb-4 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsxs("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.3em]",children:["Step 0",a]}),i.jsx("div",{className:"h-px w-8 bg-indigo-500/30"})]}),i.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:a===tc.METHOD?"Initialize Binder":a===tc.CONFIG?"Configure Profile":"Final Review"})]}),i.jsx("button",{onClick:e,className:"w-10 h-10 rounded-2xl bg-white/5 hover:bg-white/10 flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-8 py-4 no-scrollbar",children:[a===tc.METHOD&&se(),a===tc.CONFIG&&X(),a===tc.REVIEW&&q()]}),i.jsxs("div",{className:"p-8 pt-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>a>1?o(a-1):e(),className:"px-6 py-3 font-black text-gray-500 hover:text-white transition-colors text-xs uppercase tracking-widest active:scale-95",children:a===1?"Cancel":"Back"}),n&&a===tc.CONFIG&&i.jsxs("button",{onClick:Z,disabled:l,className:"px-4 py-3 text-[10px] font-black text-red-500/60 hover:text-red-500 transition-colors uppercase tracking-[0.2em] flex items-center gap-2 bg-red-500/5 rounded-xl border border-red-500/10 hover:border-red-500/30",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),i.jsx("button",{onClick:()=>{a===tc.REVIEW?J():o(a+1)},disabled:l||a===tc.CONFIG&&!u,className:`group px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all ${l?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-2xl shadow-indigo-900/40 active:scale-95 flex items-center gap-3"}`,children:l?i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/30 border-t-white rounded-full"}):i.jsxs(i.Fragment,{children:[a===tc.REVIEW?n?"Push Changes":"Initialize":"Proceed",i.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7-7 7"})})]})})]})]})}),document.body):null},uq=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],P7e=[{value:"color",label:"Color"},{value:"color_identity",label:"Color Identity"},{value:"type",label:"Card Type"},{value:"cmc",label:"Mana Value (CMC)"},{value:"rarity",label:"Rarity"},{value:"set",label:"Set Release"},{value:"collector_number",label:"Collector Number"},{value:"name",label:"Name"},{value:"price",label:"Price"},{value:"power",label:"Power"},{value:"toughness",label:"Toughness"},{value:"artist",label:"Artist"}],eae=({isOpen:t,onClose:e,onComplete:r})=>{const{updateSettings:n}=Cr();Zie();const[s,a]=b.useState(1),[o,l]=b.useState(null),[c,u]=b.useState([null,null,null,null]),[h,f]=b.useState({rares:!0,foils:!0,value:!0,valueThreshold:2}),[m,g]=b.useState(!1);if(!t)return null;const y=N=>{const k=uq.find(C=>C.id===N);l(k),N==="advanced"?a(1.5):N==="hybrid"?a(2):w(k.sort,k.grouping)},v=(N,k)=>{const C=[...c];C[N]=k,u(C)},w=async(N,k)=>{g(!0);try{const C=N.filter(Boolean);let I=k;if(k==="custom"&&C.length>0){const L=C[0];["color","color_identity"].includes(L)?I="color":["set","release"].includes(L)?I="set":["type"].includes(L)?I="type":["rarity"].includes(L)?I="rarity":I="color"}const O={mode:o.id,sortHierarchy:C,groupingPreference:I};await n({organization:O}),r?r():e()}catch(C){console.error("Failed to save organization settings",C)}finally{g(!1)}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-5xl overflow-hidden shadow-2xl relative",children:[i.jsxs("div",{className:"p-8 pb-0 text-center",children:[i.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Organize Your Collection"}),i.jsx("p",{className:"text-gray-400",children:"Make your digital library feel like home."})]}),i.jsxs("div",{className:"p-8",children:[s===1&&i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:uq.map(N=>i.jsxs("button",{onClick:()=>y(N.id),className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl flex flex-col h-full",children:[i.jsx("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform",children:N.icon}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:N.name}),i.jsx("p",{className:"text-sm text-gray-300 mb-4 h-12",children:N.description}),i.jsx("ul",{className:"text-xs text-gray-400 space-y-2 mt-auto pt-4 border-t border-gray-700/50",children:N.features.map((k,C)=>i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-indigo-500",children:""}),k]},C))})]},N.id))}),s===1.5&&i.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[i.jsx("p",{className:"text-indigo-300 font-bold uppercase tracking-widest text-xs text-center",children:"Define your custom hierarchy (Max 4)"}),i.jsx("div",{className:"space-y-3 max-w-md mx-auto",children:[0,1,2,3].map(N=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:N+1}),i.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:c[N]||"",onChange:k=>v(N,k.target.value),children:[i.jsx("option",{value:"",children:"(None)"}),P7e.map(k=>i.jsx("option",{value:k.value,children:k.label},k.value))]})]},N))}),i.jsxs("div",{className:"flex justify-between pt-6",children:[i.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),i.jsx("button",{onClick:()=>w(c,"custom"),disabled:!c[0]||m,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:m?"Applying...":"Apply Hierarchy"})]})]}),s===2&&i.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[i.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl mb-4",children:i.jsxs("p",{className:"text-sm text-indigo-300",children:["We'll set your main view to ",i.jsx("strong",{children:"Set & Collector Number"})," (for your boxes), and create ",i.jsx("strong",{children:"Smart Binders"})," for your special cards."]})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:h.rares,onChange:N=>f({...h,rares:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-white",children:"Rares & Mythics"}),i.jsx("div",{className:"text-xs text-gray-400",children:'Create a "Trade Binder" for high rarity cards.'})]})]}),i.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:h.foils,onChange:N=>f({...h,foils:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-white",children:"Foils"}),i.jsx("div",{className:"text-xs text-gray-400",children:'Create a separate "Foils" binder.'})]})]}),i.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:h.value,onChange:N=>f({...h,value:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-white",children:"Valuable Cards"}),i.jsx("div",{className:"text-xs text-gray-400",children:'Create a "High Value" binder.'})]}),h.value&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-400",children:"$"}),i.jsx("input",{type:"number",value:h.valueThreshold,onChange:N=>f({...h,valueThreshold:N.target.value}),className:"w-16 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white text-sm",onClick:N=>N.stopPropagation()})]})]})]}),i.jsxs("div",{className:"flex justify-between pt-6",children:[i.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),i.jsx("button",{onClick:()=>w(o.sort,o.grouping),disabled:m,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:m?"Configuring...":"Finish Setup"})]})]})]})]})})},L7e=({selectedCount:t,totalCount:e,onSelectAll:r,onDeselectAll:n,onDelete:s,onMove:a,onExport:o,decks:l=[],isAllSelected:c})=>{const[u,h]=b.useState(!1);return t===0&&!c?null:i.jsxs("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-[60] bg-gray-900/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl px-6 py-3 flex items-center gap-4 animate-bounce-in",children:[i.jsxs("div",{className:"flex items-center gap-2 border-r border-gray-700 pr-4",children:[i.jsx("span",{className:"text-white font-bold bg-indigo-600 px-2 py-0.5 rounded-full text-xs",children:t}),i.jsx("span",{className:"text-gray-300 text-sm font-medium",children:"Selected"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:c?n:r,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors text-xs uppercase font-bold tracking-wider",children:c?"Deselect All":"Select All"}),i.jsx("div",{className:"h-4 w-px bg-gray-700 mx-2"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>h(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all text-sm font-bold",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Move to Deck"]}),u&&i.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-gray-900 border border-gray-700 rounded-xl shadow-xl overflow-hidden max-h-60 overflow-y-auto z-50",children:l.length>0?l.map(f=>i.jsx("button",{onClick:()=>{a(f.id),h(!1)},className:"w-full text-left px-4 py-3 hover:bg-indigo-900/30 text-gray-300 hover:text-indigo-300 border-b border-gray-800 last:border-0 text-sm transition-colors",children:f.name},f.id)):i.jsx("div",{className:"px-4 py-3 text-gray-500 text-sm italic",children:"No decks found"})})]}),i.jsx("button",{onClick:o,className:"p-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all",title:"Export JSON",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),i.jsx("button",{onClick:s,className:"p-2 bg-red-900/30 hover:bg-red-600 text-red-400 hover:text-white rounded-lg transition-all border border-red-500/20 hover:border-red-500/50",title:"Delete Selected",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},O7e=(t,e)=>!e||!Array.isArray(e)||e.length===0?!0:e.every(r=>{const{field:n,operator:s,value:a}=r;let o;switch(n){case"name":o=t.name||"";break;case"colors":o=t.data?.color_identity||[];break;case"rarity":o=t.data?.rarity||"";break;case"type":o=t.data?.type_line||"";break;case"price":o=parseFloat(t.data?.prices?.usd||0);break;case"set":o=t.data?.set_name||"";const c=t.data?.set||"";if(s==="contains")return o.toLowerCase().includes(String(a).toLowerCase())||c.toLowerCase().includes(String(a).toLowerCase());break;case"cmc":o=parseFloat(t.data?.cmc||0);break;case"count":o=parseInt(t.count||0,10);break;case"in_deck":const u=!!t.deck_id;return a==="true"?u:!u;default:o=t.data?.[n]||""}const l=Array.isArray(a)?a:String(a);switch(s){case"is":case"eq":return String(o).toLowerCase()===String(l).toLowerCase();case"not":return String(o).toLowerCase()!==String(l).toLowerCase();case"contains":return String(o).toLowerCase().includes(String(l).toLowerCase());case"gt":case"greater_than":return parseFloat(o)>parseFloat(l);case"lt":case"less_than":return parseFloat(o)<parseFloat(l);case"in":return Array.isArray(l)?l.includes(String(o).toLowerCase()):!1;case"not_in":return Array.isArray(l)?!l.includes(String(o).toLowerCase()):!0;case"contains_any":return Array.isArray(o)&&Array.isArray(l)?l.some(c=>o.includes(c)):!1;case"is_exactly":return Array.isArray(o)?JSON.stringify(o.sort())===JSON.stringify(l.sort()):!1;default:return!1}}),M7e=()=>{const{userProfile:t,updateSettings:e}=Cr(),{addToast:r}=Tn(),n=Ca(),s=new URLSearchParams(n.search),a=s.get("wishlist")==="true",o=s.get("onboarding")==="true",l=s.get("openAdd")==="true",[c,u]=b.useState(!1),[h,f]=b.useState("collection_tour_v1");b.useEffect(()=>{const Ae=()=>{f("collection_tour_v1"),u(!0)};return window.addEventListener("start-tour",Ae),l?(Fe(!0),f("add_card_tour"),setTimeout(()=>u(!0),800)):(!localStorage.getItem("tour_seen_collection_tour_v1")||o)&&(f("collection_tour_v1"),setTimeout(()=>u(!0),1e3),o&&setTimeout(()=>r("Welcome to your Collection! Let's get you started.","success"),500)),()=>window.removeEventListener("start-tour",Ae)},[o,l,r]);const[m,g]=b.useState([]),[y,v]=b.useState("me");b.useEffect(()=>{Ka.fetchIncomingPermissions().then(Ae=>{const Ke=[],Gt=new Set;(Array.isArray(Ae)?Ae:Ae.data||[]).forEach(zt=>{zt.owner_id&&!Gt.has(zt.owner_id)&&(Gt.add(zt.owner_id),Ke.push({id:zt.owner_id,name:zt.owner_username||"Unknown"}))}),g(Ke)}).catch(Ae=>console.error("Failed to fetch shared sources",Ae))},[]);const w=y!=="me"&&y!=="all",N=y==="all",{cards:k,error:C,refresh:I}=yo({wishlist:a,userId:y==="me"?null:y}),{binders:O,refreshBinders:L}=Zie(),{decks:_}=yd(y==="me"?null:y),[E,M]=b.useState(""),[B,S]=b.useState(!1),P=b.useMemo(()=>h==="add_card_tour"?[{target:"#card-search-input",title:"Search for Cards",content:"Type any card name here. We search Scryfall directly so you can find anything.",disableBeacon:!0},{target:"#card-search-advanced-toggle",title:"Advanced Filters",content:"Need to find a specific print? Filter by set, color, rarity, or artist."},{target:"#card-search-results",title:"Adding to Collection",content:'Hover over any card result and click "Add" to put it in your collection. You can toggle between Normal and Foil.',placement:"center"}]:[{target:"h1",title:"Welcome to your Collection",content:"This is the heart of your library. Here you can view, filter, and manage every card you own."},{target:"#collection-sync-btn",title:"Sync Prices",content:"Click here to fetch the latest prices from Scryfall. We track your collection value daily."},{target:"#collection-view-toggle",title:"View Modes",content:"Switch between Grid (visual), Folder (organized), and Table (data) views."},{target:"#collection-filter-bar",title:"Filters",content:"Drill down by color, type, rarity, and more to find exactly what you need."},{target:"#collection-add-card-btn",title:"Add Cards",content:"Manually add cards to your collection using our search tool."},{target:"#collection-forge-lens-btn",title:"Forge Lens",content:"Use your camera to scan physical cards directly into your digital collection."},...k.length>0?[{target:"#collection-first-card",title:"Card Details",content:"Click on any card to view detailed pricing, oracle text, and legality information."}]:[]],[k.length,h]),[R,V]=b.useState(!1),[ee,G]=b.useState(!1),[J,Z]=b.useState(new Set),se=()=>{G(!ee),Z(new Set)},X=Ae=>{const Ke=new Set(J);Ke.has(Ae)?Ke.delete(Ae):Ke.add(Ae),Z(Ke)},q=()=>{const Ae=nr.map(Ke=>Ke.firestoreId||Ke.id);Z(new Set(Ae))},U=()=>{Z(new Set)},H=async()=>{if(window.confirm(`Are you sure you want to delete ${J.size} cards? This cannot be undone.`))try{await He.batchDeleteCollection(Array.from(J)),r(`Successfully deleted ${J.size} cards.`,"success"),Z(new Set),G(!1),I()}catch(Ae){console.error("Bulk delete failed",Ae),r("Failed to delete cards","error")}},re=async Ae=>{try{const Ke=nr.filter(jt=>J.has(jt.firestoreId||jt.id)),Gt=Ke.map(jt=>({...jt,quantity:jt.count||1}));await He.batchAddCardsToDeck(Ae,Gt),r(`Added ${Ke.size} cards to deck.`,"success"),Z(new Set),G(!1)}catch(Ke){console.error("Bulk move failed",Ke),r("Failed to move cards","error")}},ae=()=>{const Ae=nr.filter(jt=>J.has(jt.firestoreId||jt.id)),Ke="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(Ae,null,2)),Gt=document.createElement("a");Gt.setAttribute("href",Ke),Gt.setAttribute("download","selected_cards_export.json"),document.body.appendChild(Gt),Gt.click(),Gt.remove(),r(`Exported ${Ae.size} cards.`,"success")},xe=async()=>{V(!0);try{await He.post("/api/sync/prices"),await I()}catch(Ae){console.error("Sync failed",Ae)}finally{V(!1)}},Ne=(Ae,Ke)=>t?.settings?.collection?.[Ae]||localStorage.getItem(`collection_${Ae}`)||Ke,pe=()=>{if(t?.settings?.collection?.filters)return t.settings.collection.filters;const Ae=localStorage.getItem("collection_filters");return Ae?JSON.parse(Ae):{colors:[],rarity:[],types:[],sets:[],decks:[],users:[]}},[K,ue]=b.useState(()=>Ne("viewMode","grid")),[fe,he]=b.useState(()=>Ne("groupingMode","binders")),[le,_e]=b.useState(null),[oe,Oe]=b.useState([]),[ze,Ye]=b.useState(!1),[je,Fe]=b.useState(!1),[Nt,$t]=b.useState(!1),[Ut,nt]=b.useState(!1),[bt,It]=b.useState(!1),[_t,wt]=b.useState(!1),[ut,Rt]=b.useState(!1),[Dt,at]=b.useState(null),[ft,Bt]=b.useState(()=>pe()),[De,lt]=b.useState(()=>Ne("sortBy","added_at")),[ht,Pt]=b.useState(()=>Ne("sortOrder","desc")),[At,mt]=b.useState(()=>{const Ae=t?.settings?.collection?.itemsPerPage||localStorage.getItem("collection_itemsPerPage");return Ae?parseInt(Ae):50}),Ft=b.forwardRef(({style:Ae,children:Ke,...Gt},jt)=>i.jsx("div",{ref:jt,...Gt,style:Ae,className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 animate-fade-in pb-24",children:Ke})),gt=b.forwardRef(({children:Ae,...Ke},Gt)=>i.jsx("div",{ref:Gt,...Ke,className:"h-full",children:Ae}));b.useEffect(()=>{if(!t?.settings?.collection)return;const Ae=t.settings.collection;Ae.viewMode&&Ae.viewMode!==K&&ue(Ae.viewMode),Ae.groupingMode&&Ae.groupingMode!==fe&&he(Ae.groupingMode),Ae.sortBy&&Ae.sortBy!==De&&lt(Ae.sortBy),Ae.sortOrder&&Ae.sortOrder!==ht&&Pt(Ae.sortOrder),Ae.itemsPerPage&&parseInt(Ae.itemsPerPage)!==At&&mt(parseInt(Ae.itemsPerPage)),Ae.filters&&JSON.stringify(Ae.filters)!==JSON.stringify(ft)&&Bt(Ae.filters)},[t]),b.useEffect(()=>{if(!t?.id)return;const Ae={viewMode:K,groupingMode:fe,sortBy:De,sortOrder:ht,itemsPerPage:At,filters:ft},Ke=t.settings?.collection||{},Gt={viewMode:Ke.viewMode,groupingMode:Ke.groupingMode,sortBy:Ke.sortBy,sortOrder:Ke.sortOrder,itemsPerPage:Ke.itemsPerPage?parseInt(Ke.itemsPerPage):void 0,filters:Ke.filters};JSON.stringify(Ae)!==JSON.stringify(Gt)&&e({collection:{...Ke,...Ae}}),localStorage.setItem("collection_viewMode",K),localStorage.setItem("collection_groupingMode",fe),localStorage.setItem("collection_filters",JSON.stringify(ft)),localStorage.setItem("collection_sortBy",De),localStorage.setItem("collection_sortOrder",ht),localStorage.setItem("collection_itemsPerPage",At)},[K,fe,ft,De,ht,At,t?.id]),b.useEffect(()=>{if(le&&le.startsWith("binder-")){const Ae=le.replace("binder-","");Ye(!0),He.getBinderCards(Ae).then(Ke=>Oe(Ke)).catch(Ke=>r("Failed to load binder cards","error")).finally(()=>Ye(!1))}else Oe([])},[le,r]);const Ot=b.useMemo(()=>{const Ae=new Set;return k.forEach(Ke=>{Ke.set&&Ke.set_name&&Ae.add(JSON.stringify({value:Ke.set,label:Ke.set_name}))}),Array.from(Ae).map(Ke=>JSON.parse(Ke)).sort((Ke,Gt)=>Ke.label.localeCompare(Gt.label))},[k]),Ct=b.useMemo(()=>m.map(Ae=>({value:Ae.id,label:Ae.name})),[m]),Xt=b.useMemo(()=>{const Ae=_.map(Ke=>({value:Ke.id,label:Ke.name}));return[{value:"none",label:"Unassigned (No Deck)"},...Ae]},[_]),Qt=(Ae,Ke,Gt)=>{switch(Gt){case"color":case"color_identity":{const jt={W:0,U:1,B:2,R:3,G:4},zt=Mt=>{let Ht=Mt.color_identity||[];if(typeof Ht=="string")try{Ht=JSON.parse(Ht)}catch{}return Ht.length===0?6:Ht.length>1?5:jt[Ht[0]]??7};return zt(Ae)-zt(Ke)}case"type":{const jt={Creature:0,Instant:1,Sorcery:2,Enchantment:3,Artifact:4,Planeswalker:5,Land:6},zt=Mt=>{const Ht=Mt.type_line||"";for(const[vr,Fr]of Object.entries(jt))if(Ht.includes(vr))return Fr;return 7};return zt(Ae)-zt(Ke)}case"cmc":return(parseFloat(Ae.cmc)||0)-(parseFloat(Ke.cmc)||0);case"price":return parseFloat(Ae.prices?.usd||0)-parseFloat(Ke.prices?.usd||0);case"collector_number":{const jt=parseInt(Ae.collector_number||0),zt=parseInt(Ke.collector_number||0);return jt-zt}case"set":return(Ae.set||"").localeCompare(Ke.set||"");case"name":return(Ae.name||"").localeCompare(Ke.name||"");case"power":return(parseFloat(Ae.power)||0)-(parseFloat(Ke.power)||0);case"toughness":return(parseFloat(Ae.toughness)||0)-(parseFloat(Ke.toughness)||0);case"artist":return(Ae.artist||"").localeCompare(Ke.artist||"");default:return 0}},nr=b.useMemo(()=>k.filter(Ke=>{const Gt=Ke.name||"";if(E&&!Gt.toLowerCase().includes(E.toLowerCase())||!!Ke.is_wishlist!==a)return!1;if(ft.colors.length>0){const jt=Ke.color_identity||[],zt=jt.length>1,Mt=jt.length===0;if(!ft.colors.some(vr=>vr==="C"?Mt:vr==="M"?zt:jt.includes(vr)))return!1}if(ft.rarity.length>0&&!ft.rarity.includes(Ke.rarity))return!1;if(ft.types.length>0){const jt=(Ke.type_line||"").toLowerCase();if(!ft.types.some(Mt=>jt.includes(Mt.toLowerCase())))return!1}return!(ft.sets.length>0&&!ft.sets.includes(Ke.set)||ft.decks.length>0&&!ft.decks.some(zt=>zt==="none"?!Ke.deckId:Ke.deckId===zt)||ft.users&&ft.users.length>0&&!ft.users.includes(Ke.user_id)&&!ft.users.includes(Ke.owner_id))}).sort((Ke,Gt)=>{const jt=t?.settings?.organization?.sortHierarchy;if(jt&&Array.isArray(jt)&&jt.length>0){for(const Ht of jt){const vr=Qt(Ke,Gt,Ht);if(vr!==0)return vr}return Qt(Ke,Gt,"name")}if(De==="added_at"){const Ht=new Date(Ke.added_at||0).getTime(),vr=new Date(Gt.added_at||0).getTime();return ht==="asc"?Ht-vr:vr-Ht}let zt=De;if(De==="owner")return(Ke.owner_username||"ME").localeCompare(Gt.owner_username||"ME");const Mt=Qt(Ke,Gt,zt);return ht==="asc"?Mt:-Mt}),[k,E,ft,De,ht,t]),sr=b.useMemo(()=>{if(K!=="folder")return[];if(fe==="custom"){const Ae={},Ke=[];nr.forEach(jt=>{const zt=typeof jt.tags=="string"?JSON.parse(jt.tags):jt.tags||[];zt.length===0?Ke.push(jt):zt.forEach(Mt=>{Ae[Mt]||(Ae[Mt]=[]),Ae[Mt].push(jt)})});const Gt=Object.entries(Ae).map(([jt,zt])=>({id:`tag-${jt}`,label:jt,type:"tag",cards:zt,icon:"",color:"indigo"}));return Ke.length>0&&Gt.push({id:"unsorted",label:"Unsorted",type:"tag",cards:Ke,icon:"",color:"gray"}),Gt.sort((jt,zt)=>jt.label.localeCompare(zt.label))}if(fe==="smart"){const Ae=[],Ke={};nr.forEach(Mt=>{if(Mt.deck_id){const Ht=_.find(vr=>vr.id===Mt.deck_id)?.name||"Unknown Deck";Ke[Ht]||(Ke[Ht]=[]),Ke[Ht].push(Mt)}}),Object.entries(Ke).forEach(([Mt,Ht])=>{const vr=N&&Ht[0]?.owner_username?Ht[0].owner_username:null;Ae.push({id:`deck-${Mt}`,label:Mt,type:"deck",cards:Ht,icon:"",color:"purple",sub:"Deck",ownerName:vr})});const Gt=t?.settings?.organization?.groupingPreference||"color",jt={};nr.forEach(Mt=>{let Ht="Other",vr="Other",Fr=0,ln={};if(Gt==="set")Ht=Mt.set||"unknown",vr=Mt.set_name||"Unknown Set",Fr=Mt.released_at?new Date(Mt.released_at).getTime():0,ln={icon:"",color:"blue"};else if(Gt==="type"){const hn=["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"],cn=Mt.type_line||"",Ks=hn.find(Ci=>cn.includes(Ci))||"Other";Ht=Ks,vr=Ks,ln={icon:"",color:"emerald"}}else if(Gt==="rarity")Ht=Mt.rarity||"common",vr=Ht.charAt(0).toUpperCase()+Ht.slice(1),Fr={common:0,uncommon:1,rare:2,mythic:3}[Ht]||0,ln={icon:"",color:"yellow"};else{let hn=Mt.color_identity;if(typeof hn=="string")try{hn=JSON.parse(hn)}catch{hn=[]}Array.isArray(hn)||(hn=[]);const cn={W:0,U:1,B:2,R:3,G:4},Ci=hn.filter(ps=>cn[ps]!==void 0).sort((ps,$e)=>cn[ps]-cn[$e]).join("");Ht=Ci.length===0?"C":Ci;const Ds=k7e(Ht);vr=Ds.name,Fr=Ht==="C"?-1:Ht.length,ln={icon:"",color:Ds.bg?.replace("bg-","")?.split(" ")[0]||"blue",pips:Ds.pips,flavor:Ds.flavor,theme:Ds.theme}}jt[Ht]||(jt[Ht]={label:vr,cards:[],sortValue:Fr,...ln}),jt[Ht].cards.push(Mt)});const zt=Object.entries(jt).map(([Mt,Ht])=>({id:`group-${Mt}`,label:Ht.label,type:Gt,cards:Ht.cards,icon:Ht.icon,color:Ht.color||"gray",sub:Gt.charAt(0).toUpperCase()+Gt.slice(1),pips:Ht.pips,flavor:Ht.flavor,theme:Ht.theme,sortValue:Ht.sortValue}));return zt.sort((Mt,Ht)=>Gt==="rarity"||Gt==="set"?Ht.sortValue-Mt.sortValue:Gt==="color"?(Mt.id.replace("group-","").length,Mt.theme&&Ht.theme?Mt.label.localeCompare(Ht.label):0):Mt.label.localeCompare(Ht.label)),[...Ae,...zt]}return fe==="binders"?O.map(Ae=>{const Ke=Ae.rules?typeof Ae.rules=="string"?JSON.parse(Ae.rules):Ae.rules:null,Gt=Ke?k.filter(jt=>O7e(jt,Ke)):k.filter(jt=>String(jt.binder_id)===String(Ae.id));return{id:`binder-${Ae.id}`,label:Ae.name,type:"binder",cards:Gt,icon:Ae.icon_value||"",color:Ae.color_preference||"blue",sub:Ke?"Smart Binder":"Collection Binder",isSmart:!!Ke}}):[]},[nr,fe,K,_,O,k,t]),Jt=(Ae,Ke)=>{Bt(Gt=>{const jt=Gt[Ae],zt=jt.includes(Ke)?jt.filter(Mt=>Mt!==Ke):[...jt,Ke];return{...Gt,[Ae]:zt}})},kr=b.useMemo(()=>{const Ae=sr.find(Ke=>Ke.id===le);return Ae&&Ae.type==="binder"?{...Ae,cards:oe}:Ae},[sr,le,oe]);return b.useEffect(()=>{const Ae=An(t?.subscription_tier).features.binders;K==="folder"&&fe==="binders"&&!Ae&&ue("grid")},[t,K,fe]),i.jsxs("div",{className:"relative min-h-screen overflow-x-hidden",children:[i.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transform-gpu",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:i.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),i.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto px-4 md:px-6 py-8 space-y-8 animate-fade-in pb-24",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 bg-gray-950/40 p-4 md:p-6 rounded-3xl backdrop-blur-md border border-white/5 shadow-xl",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl md:text-4xl font-black text-white tracking-tight mb-1 md:mb-2",children:a?"My Wishlist":"My Collection"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[i.jsxs("p",{className:"text-gray-400 font-medium text-xs md:text-sm",children:[nr.length," ",nr.length===1?"card":"cards"," found  ",i.jsxs("span",{className:"text-indigo-400",children:["$",nr.reduce((Ae,Ke)=>Ae+parseFloat(Ke.prices?.usd||0)*(Ke.count||1),0).toFixed(2)]})]}),i.jsxs("button",{id:"collection-sync-btn",onClick:xe,disabled:R,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-[10px] font-black uppercase tracking-widest transition-all border border-indigo-500/20 ${R?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[i.jsx("svg",{className:`w-3 h-3 ${R?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),R?"Syncing...":"Sync Prices"]})]})]}),i.jsxs("div",{className:"flex gap-2 md:gap-3 w-full md:w-auto items-center justify-between md:justify-end",children:[i.jsx("div",{id:"collection-view-toggle",children:i.jsx(S7e,{mode:K,onChange:Ae=>{ue(Ae),_e(null),Ae==="folder"&&(An(t?.subscription_tier).features.binders||he("smart"))}})}),!w&&i.jsxs("div",{className:"flex h-10 items-center gap-2",children:[i.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1 md:mx-2"}),i.jsxs("button",{onClick:()=>{if(!An(t?.subscription_tier).features.binders){r("Custom Binders are available on Wizard tier and above.","info");return}nt(!0)},className:`flex p-2.5 md:px-4 md:py-3 rounded-xl transition-all border items-center justify-center gap-2 group ${An(t?.subscription_tier).features.binders?"bg-gray-800 hover:bg-gray-700 text-indigo-400 hover:text-white border-gray-700 hover:border-indigo-500/50 cursor-pointer":"bg-gray-800/50 text-gray-600 border-gray-700 cursor-not-allowed opacity-60"}`,title:An(t?.subscription_tier).features.binders?"Create New Binder":"Requires Wizard Tier",children:[i.jsx("svg",{className:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest hidden lg:inline-block",children:"New Binder"})]}),i.jsx("button",{onClick:()=>{if(!An(t?.subscription_tier).features.collectionAudit){r("Collection Organization tools are available on Wizard tier.","info");return}wt(!0)},className:`hidden md:flex p-2.5 md:px-3 md:py-3 rounded-xl transition-all border items-center justify-center shadow-lg ${An(t?.subscription_tier).features.collectionAudit?"bg-gray-900 hover:bg-gray-800 text-gray-400 hover:text-white border-gray-800 hover:border-gray-700 cursor-pointer":"bg-gray-900/50 text-gray-600 border-gray-800 cursor-not-allowed opacity-50"}`,title:An(t?.subscription_tier).features.collectionAudit?"Organize Collection":"Requires Wizard Tier",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),i.jsx("button",{onClick:()=>It(!0),className:"hidden md:flex bg-gray-900 hover:bg-indigo-900/30 text-gray-500 hover:text-indigo-400 p-2.5 md:px-3 md:py-3 rounded-xl transition-all border border-gray-800 hover:border-indigo-500/30 items-center justify-center shadow-lg",title:"Binder Guide",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("button",{onClick:()=>$t(!0),className:"flex text-gray-400 hover:text-white font-bold p-2.5 md:px-4 md:py-3 rounded-xl hover:bg-gray-800 transition-all items-center gap-2 text-xs uppercase tracking-widest",title:"Bulk Paste",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),i.jsxs("button",{id:"collection-add-card-btn",onClick:()=>Fe(!0),className:"flex bg-indigo-600 hover:bg-indigo-500 text-white font-bold p-2.5 md:px-6 md:py-3 rounded-xl shadow-lg shadow-indigo-900/40 transition-all items-center gap-2 uppercase tracking-widest text-xs whitespace-nowrap",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),i.jsx("span",{className:"hidden md:inline-block",children:"Add Cards"})]}),i.jsxs("button",{id:"collection-forge-lens-btn",onClick:()=>Rt(!0),className:"flex bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-400 font-bold p-2.5 md:px-6 md:py-3 rounded-xl border border-indigo-500/20 transition-all items-center gap-2 uppercase tracking-widest text-xs whitespace-nowrap",title:"Scan Cards with Camera",children:[i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsx("span",{className:"hidden md:inline-block italic",children:"Forge Lens"})]})]})]})]}),i.jsx(zf,{steps:P,isOpen:c,onClose:()=>u(!1),tourId:"collection_tour_v1"}),C&&i.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-3xl p-8 text-center backdrop-blur-md",children:[i.jsx("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Failed to load collection"}),i.jsx("p",{className:"text-red-200 mb-6",children:C.message||"Something went wrong while fetching your cards."}),i.jsx("button",{onClick:()=>I(),className:"px-6 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-900/20",children:"Try Again"})]}),i.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-4 md:p-6 backdrop-blur-md shadow-2xl",children:[i.jsxs("div",{id:"collection-filter-bar",className:"flex flex-col lg:flex-row gap-3 md:gap-4 mb-6 justify-between",children:[i.jsxs("div",{className:"flex gap-2 flex-wrap flex-1",children:[i.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[i.jsx("input",{type:"text",placeholder:"Search cards...",value:E,onChange:Ae=>M(Ae.target.value),className:"w-full bg-gray-900/50 border border-gray-700 text-white px-4 py-2.5 md:py-3 pl-10 md:pl-12 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-gray-500 font-medium text-sm h-10 md:h-12"}),i.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 absolute left-3 md:left-4 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),i.jsxs("select",{value:y,onChange:Ae=>{v(Ae.target.value),_e(null)},className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 whitespace-nowrap h-10 md:h-12",children:[i.jsx("option",{value:"me",children:"My Collection"}),i.jsx("option",{value:"all",children:"All Linked Collections"}),m.map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"'s Collection"]},Ae.id))]}),i.jsxs("select",{value:De,onChange:Ae=>lt(Ae.target.value),className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 h-10 md:h-12",children:[i.jsx("option",{value:"added_at",children:"Date Added"}),i.jsx("option",{value:"name",children:"Name"}),i.jsx("option",{value:"price",children:"Price"}),N&&i.jsx("option",{value:"owner",children:"Owner"})]}),i.jsx("button",{onClick:()=>Pt(ht==="asc"?"desc":"asc"),className:"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white px-3 py-2 md:px-4 md:py-3 rounded-xl transition-all h-10 md:h-12",title:`Sort Order: ${ht.toUpperCase()}`,children:ht==="asc"?i.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}):i.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})})}),i.jsxs("button",{onClick:se,className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${ee?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20 ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[i.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),ee?"Cancel Selection":"Select"]}),i.jsxs("button",{onClick:()=>S(!B),className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${B?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[i.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),i.jsx("span",{className:"hidden sm:inline",children:"Filters"})]})]}),K==="folder"&&!le&&i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-1 rounded-xl flex self-start overflow-hidden",children:[i.jsxs("button",{onClick:()=>{if(!An(t?.subscription_tier).features.binders){r(`Custom Binders are available on ${ta[lr.TIER_2].name} tier.`,"info");return}he("binders")},className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${fe==="binders"?"bg-indigo-600 text-white":An(t?.subscription_tier).features.binders?"text-gray-500 hover:text-gray-300":"text-gray-600 cursor-not-allowed opacity-60"}`,children:["Binders",!An(t?.subscription_tier).features.binders&&i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),i.jsx("button",{onClick:()=>he("smart"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${fe==="smart"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Smart"}),i.jsx("button",{onClick:()=>he("custom"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${fe==="custom"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Tags"})]})})]}),B&&i.jsx("div",{className:"mb-8 p-6 bg-gray-900/50 rounded-2xl border border-gray-800 space-y-6 animate-fade-in-down",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Colors"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(Ae=>i.jsxs("button",{onClick:()=>Jt("colors",Ae),className:`
w - 8 h - 8 rounded - full border flex items - center justify - center transition - all transform hover: scale - 110
                                                    ${ft.colors.includes(Ae)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 shadow-lg scale-110":"opacity-60 hover:opacity-100"}
                                                    ${Ae==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                                    ${Ae==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                                    ${Ae==="B"?"bg-[#1F2937] text-white border-gray-600":""}
                                                    ${Ae==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                                    ${Ae==="G"?"bg-[#10B981] text-white border-green-600":""}
                                                    ${Ae==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                                    ${Ae==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
`,title:Ae==="C"?"Colorless":Ae==="M"?"Multicolor":Ae,children:[Ae!=="M"&&Ae!=="C"&&i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Ae}.svg`,alt:Ae,className:"w-4 h-4"}),Ae==="M"&&i.jsx("span",{className:"font-bold text-xs",children:"M"}),Ae==="C"&&i.jsx("span",{className:"font-bold text-xs",children:"C"})]},Ae))})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(Ae=>i.jsx("button",{onClick:()=>Jt("rarity",Ae),className:`
                                                    px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                    ${ft.rarity.includes(Ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                `,children:Ae},Ae))})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Types"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(Ae=>i.jsx("button",{onClick:()=>Jt("types",Ae),className:`
                                                     px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                     ${ft.types.includes(Ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                 `,children:Ae},Ae))})]}),i.jsxs("div",{className:"col-span-1 space-y-4",children:[i.jsx(Mj,{label:"Sets",options:Ot,selected:ft.sets,onChange:Ae=>Bt({...ft,sets:Ae})}),N&&i.jsx(Mj,{label:"Card Owner",options:Ct,selected:ft.users,onChange:Ae=>Bt({...ft,users:Ae})}),i.jsx(Mj,{label:"Filter by Deck",options:Xt,selected:ft.decks,onChange:Ae=>Bt(Ke=>({...Ke,decks:Ae})),placeholder:"All Decks"})]})]})}),C?i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-8 rounded-2xl text-center",children:[i.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Collection"}),i.jsx("p",{children:C.message})]}):i.jsxs(i.Fragment,{children:[K==="folder"&&!kr&&i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 animate-fade-in",children:[sr.map(Ae=>i.jsxs("div",{onClick:()=>_e(Ae.id),className:"bg-gray-900/40 hover:bg-gray-800/60 border border-white/5 hover:border-indigo-500/30 rounded-2xl p-4 md:p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-2 md:gap-3 backdrop-blur-sm relative overflow-hidden",children:[i.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 bg-${Ae.color}-500/10 rounded-full blur-3xl`}),i.jsx("div",{className:"flex gap-1 mb-1 md:mb-2 group-hover:scale-110 transition-transform",children:Ae.pips?Ae.pips.map((Ke,Gt)=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Ke}.svg`,alt:Ke,className:"w-6 h-6 md:w-8 md:h-8 drop-shadow-md transition-transform group-hover:scale-110"},Gt)):Ae.icon&&Ae.icon.startsWith("ms-")?i.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ae.color}-900/30 text-${Ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:i.jsx("i",{className:`ms ${Ae.icon} ms-cost`})}):i.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ae.color}-900/30 text-${Ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:Ae.icon})}),i.jsxs("div",{className:"z-10 px-2 mt-4",children:[i.jsx("div",{className:"text-[10px] uppercase tracking-tighter text-indigo-400 font-black mb-1",children:Ae.theme||Ae.sub}),i.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors leading-tight",children:Ae.label}),Ae.flavor&&i.jsxs("p",{className:"text-[10px] text-gray-500 italic mt-2 font-serif px-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity",children:['"',Ae.flavor,'"']}),Ae.ownerName&&i.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 bg-gray-950/80 text-gray-300 text-[9px] font-bold px-2 py-1 rounded-full border border-white/10",children:[i.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),Ae.ownerName]})]}),i.jsxs("span",{className:"mt-4 px-3 py-1 bg-black/30 rounded-full text-xs font-mono text-gray-400 border border-white/5",children:[Ae.cards.length," cards"]})]},Ae.id)),sr.length===0&&i.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards match your filter criteria."})]}),K==="folder"&&kr&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx("button",{onClick:()=>_e(null),className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[kr.icon," ",kr.label]}),kr.type==="binder"&&i.jsx("button",{onClick:()=>{const Ae=O.find(Ke=>Ke.id===parseInt(le.replace("binder-","")));at(Ae),nt(!0)},className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-indigo-400 hover:text-white transition-colors",title:"Edit Binder Rules",children:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),kr.type==="binder"&&i.jsx(JO,{type:"binder",targetId:le.replace("binder-",""),label:"Audit",className:"text-xs bg-gray-800 border-gray-700 hover:bg-gray-700 hover:text-white py-2"})]}),i.jsx(cq,{useWindowScroll:!0,totalCount:kr.cards.length,overscan:200,components:{List:Ft,Item:gt},itemContent:Ae=>{const Ke=kr.cards[Ae];return i.jsx(Ky,{card:Ke,decks:_,currentUser:t,showOwnerTag:N})}})]}),K==="grid"&&i.jsx(i.Fragment,{children:nr.length>0?i.jsx(cq,{useWindowScroll:!0,totalCount:nr.length,overscan:200,components:{List:Ft,Item:gt},itemContent:Ae=>{const Ke=nr[Ae];return i.jsx(Ky,{card:Ke,decks:_,currentUser:t,showOwnerTag:N,selectMode:ee,isSelected:J.has(Ke.firestoreId||Ke.id),onToggleSelect:Gt=>X(Gt)})}}):i.jsx("div",{className:"py-20 text-center text-gray-500 italic",children:"No cards found."})}),K==="table"&&i.jsx("div",{className:"animate-fade-in",children:i.jsx(_7e,{cards:nr,isMixed:N})})]})]})]}),ee&&i.jsx(L7e,{selectedCount:J.size,totalCount:nr.length,onSelectAll:q,onDeselectAll:U,onDelete:H,onMove:re,onExport:ae,decks:_,isAllSelected:J.size===nr.length&&nr.length>0}),i.jsx(mO,{isOpen:je,onClose:()=>Fe(!1),onAddCard:()=>I()}),i.jsx(C7e,{isOpen:Nt,onClose:()=>$t(!1)}),i.jsx(UO,{isOpen:bt,onClose:()=>It(!1)}),i.jsx(W_,{isOpen:ut,onClose:()=>Rt(!1),decks:_,sharedSources:m,onFinish:async(Ae,Ke)=>{if(Ae.length)try{const Gt=Ae.map(zt=>({name:zt.name,scryfall_id:zt.scryfall_id,set_code:zt.set_code,collector_number:zt.collector_number,image_uri:zt.data.image_uris?.normal||zt.data.card_faces?.[0]?.image_uris?.normal,count:zt.quantity,finish:zt.finish,data:zt.data,is_wishlist:zt.is_wishlist,tags:[]})),jt=Ae.reduce((zt,Mt)=>{const Ht=Mt.finish==="foil"&&Mt.data?.prices?.usd_foil||Mt.data?.prices?.usd;return zt+parseFloat(Ht||0)*Mt.quantity},0);Ke?.type==="deck"?(await He.batchAddCardsToDeck(Ke.id,Gt),r(`Addeed ${Ae.length} cards to deck ($${jt.toFixed(2)})`,"success")):Ke?.type==="user"&&Ke.id!==t.id?(await He.batchAddToCollection(Gt,"merge",Ke.id),r(`Added ${Ae.length} cards to ${Ke.name}'s collection ($${jt.toFixed(2)})`,"success")):(await He.batchAddToCollection(Gt),r(`Added ${Ae.length} cards to collection ($${jt.toFixed(2)})`,"success")),I()}catch(Gt){console.error("Forge Lens Add Failed",Gt),r("Failed to add scanned cards.","error")}}}),i.jsx(I7e,{isOpen:Ut,editingBinder:Dt,onClose:()=>{if(nt(!1),at(null),L(),le&&le.startsWith("binder-")){const Ae=le.replace("binder-","");Ye(!0),He.getBinderCards(Ae).then(Oe).finally(()=>Ye(!1))}}}),i.jsx(eae,{isOpen:_t,onClose:()=>wt(!1),onComplete:()=>{wt(!1),window.location.reload()}})]})},al={async addCardToDeck(t,e,r){return He.post("/api/collection",{scryfall_id:r.id,name:r.name,set_code:r.set||r.set_code,collector_number:r.collector_number,finish:r.finish||"nonfoil",data:r,deck_id:e,count:1,board:r.board})},async batchAddCardsToDeck(t,e,r,n="merge"){const s=r.map(a=>({...a,deck_id:e}));return He.batchAddToCollection(s,n)},async removeCardFromDeck(t,e,r){return He.put(`/api/collection/${r}`,{deck_id:null})},async updateCardQuantity(t,e,r,n){return n<=0?this.removeCardFromDeck(t,e,r):He.put(`/api/collection/${r}`,{count:n})},async moveCardToBoard(t,e,r,n){return He.put(`/api/collection/${r}`,{board:n})},async setCommander(t,e,r){return He.put(`/api/decks/${e}`,{commander:r})},async updateDeck(t,e,r){return He.put(`/api/decks/${e}`,r)},async reorderDecks(t,e){return He.put("/api/decks/reorder",{deckIds:e})},async batchRemoveCards(t,e,r,n){return He.delete(`/api/decks/${e}/cards/batch`,{cardIds:r,action:n})},async importDeck(t,e,r,n){return He.post("/api/decks/import",{deck:e,cards:r,options:n})},async createDeck(t,e){const r=await He.post("/api/decks",e);try{const n=Ha?.metrics?.decks_created||0;Ha?.check({decks_created:n+1})}catch(n){console.warn("Achievement trigger failed",n)}return r},async updateDeck(t,e,r){return He.put(`/api/decks/${e}`,r)},async deleteDeck(t,e,r={}){const n=new URLSearchParams(r).toString();return He.delete(`/api/decks/${e}?${n}`)},async batchRemoveCards(t,e,r,n="remove"){return He.delete(`/api/decks/${e}/cards?action=${n}`,{cardIds:r})}},dq=t=>{if(!t)return null;const e=t.data||t;return e.image_uris?.art_crop?e.image_uris.art_crop:e.card_faces?.[0]?.image_uris?.art_crop?e.card_faces[0].image_uris.art_crop:e.image_uris?.normal?e.image_uris.normal:null},R7e=t=>{const e=t?.commander?.color_identity||[],r=t?.commander_partner?.color_identity||[],n=[...new Set([...e,...r])];return n.length>0?n:["C"]},IM=b.memo(function({deck:e}){const r=yn(),n=R7e(e),s=F4(n),a=parseInt(e.card_count||0),o=dq(e.commander),l=dq(e.commander_partner);return i.jsx("div",{onClick:()=>r(`/decks/${e.id}`),className:"group relative flex flex-col h-[420px] rounded-3xl transition-all duration-300 hover:-translate-y-2 cursor-pointer",children:i.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"h-[60%] w-full relative overflow-hidden bg-gray-950 shrink-0",children:[e.commander_partner?i.jsxs("div",{className:"w-full h-full flex",children:[i.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[i.jsx("img",{src:o||"https://placehold.co/400x600?text=?",alt:e.commander?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]}),i.jsxs("div",{className:"w-1/2 h-full relative",children:[i.jsx("img",{src:l||"https://placehold.co/400x600?text=?",alt:e.commander_partner?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]})]}):o?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:o,alt:e.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}):i.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:i.jsx("svg",{className:"w-16 h-16 text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),i.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1 z-10",children:[e.tags&&e.tags.includes("Precon")&&i.jsx("div",{className:"px-2 py-1 bg-teal-500/20 text-teal-400 border border-teal-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Precon"}),e.is_mockup&&i.jsx("div",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 border border-orange-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Mockup"})]}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 pointer-events-none group-hover:pointer-events-auto",children:i.jsx(Hr,{to:`/solitaire/${e.id}`,onClick:c=>c.stopPropagation(),className:"transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300 bg-amber-600/90 hover:bg-amber-500 text-white p-4 rounded-full shadow-2xl backdrop-blur-sm border 2 border-white/20 flex flex-col items-center gap-1",title:"Play Solitaire",children:i.jsx("svg",{className:"w-8 h-8 ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M8 5v14l11-7z"})})})})]}),i.jsxs("div",{className:"h-[40%] p-5 flex flex-col justify-between relative grow",children:[i.jsx("div",{className:"absolute -top-3 left-5 flex gap-1 bg-gray-900/80 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:(e.format?.toLowerCase()==="standard"?e.colors||[]:n).map(c=>{const u=c.replace(/[{}]/g,"").replace("/",""),h=`/assets/mana/${u}.svg`;return i.jsx("img",{src:h,alt:u,className:"w-4 h-4 shadow-sm"},c)})}),(e.ai_blueprint?.grade?.powerLevel>0||e.aiBlueprint?.grade?.powerLevel>0)&&i.jsxs("div",{className:"absolute -top-3 right-5 flex items-center gap-1.5 bg-gray-900 backdrop-blur-md rounded-full px-3 py-1 border border-white/10 shadow-xl group-hover:border-indigo-500/50 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-[9px] font-black uppercase text-indigo-400 tracking-wider",children:"B"}),i.jsx("span",{className:"text-xs font-mono font-bold text-white",children:e.ai_blueprint?.grade?.commanderBracket||e.aiBlueprint?.grade?.commanderBracket||"?"})]}),i.jsx("div",{className:"w-px h-2.5 bg-white/10"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-[9px] font-black uppercase text-teal-400 tracking-wider",children:"PWR"}),i.jsx("span",{className:"text-xs font-mono font-bold text-white",children:Number(e.ai_blueprint?.grade?.powerLevel||e.aiBlueprint?.grade?.powerLevel).toFixed(1)})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-1 opacity-80",children:s.badge}),i.jsx("h3",{className:"text-xl font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:e.name||"Untitled Deck"}),i.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:e.commander_partner?`${e.commander?.name} & ${e.commander_partner?.name}`:e.commander?.name||"No Commander"})]}),i.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4 mt-2",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Format"}),i.jsx("span",{className:"text-xs text-gray-300 font-medium",children:e.format||"Commander"})]}),i.jsxs("div",{className:"flex flex-col items-end",children:[i.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Cards"}),i.jsxs("span",{className:`text-sm font-mono font-bold ${a>=(e.format?.toLowerCase()==="standard"?60:100)?"text-green-500":"text-indigo-400"}`,children:[a,i.jsxs("span",{className:"text-gray-600 text-[10px]",children:["/",e.format?.toLowerCase()==="standard"?"60":"100"]})]})]})]})]})]})})}),Q4=b.memo(function({title:e,decks:r,loading:n,error:s,isOwner:a=!1}){const[o,l]=b.useState(!1),c=o?r:r.slice(0,4),u=r.length>4;return n?i.jsxs("div",{className:"mb-12",children:[i.jsx("div",{className:"h-8 w-48 bg-gray-800 rounded-lg animate-pulse mb-6"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(h=>i.jsx("div",{className:"h-[420px] bg-gray-900 rounded-3xl animate-pulse"},h))})]}):s?i.jsx("div",{className:"mb-12 p-6 bg-red-900/20 border border-red-500/50 rounded-2xl",children:i.jsx("h3",{className:"text-red-400 font-bold",children:"Error loading decks"})}):r.length===0?null:i.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[i.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[i.jsx("div",{children:i.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:[e,i.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:r.length})]})}),u&&i.jsxs("button",{onClick:()=>l(!o),className:"text-indigo-400 hover:text-indigo-300 text-sm font-bold uppercase tracking-wider transition-colors flex items-center gap-2",children:[o?"Show Less":`Show All (${r.length})`,i.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:c.map(h=>i.jsx(IM,{deck:h},h.id))}),a&&r.length===0&&i.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[i.jsx("p",{className:"text-gray-500 mb-6",children:"You haven't built any decks yet."}),i.jsx(Hr,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]})}),D7e=Ie.memo(({friend:t})=>{const{decks:e,loading:r,error:n}=yd(t.owner_id),s=t.owner?.username||t.owner_username||"Unknown Friend";return!r&&!n&&e.length===0?null:i.jsx(Q4,{title:`Decks by ${s}`,decks:e,loading:r,error:n,isOwner:!1})}),hq={getPrice(t,e="usd"){if(!t)return 0;let r=null;return t.prices&&t.prices[e]&&(r=t.prices[e]),r?parseFloat(r):0},getDeckValue(t=[],e="usd"){let r=0,n=0,s=null;const a={bulk:0,budget:0,mid:0,high:0,premium:0};return t.map(o=>{const l=this.getPrice(o,e);return r+=l*(o.quantity||1),l>n&&(n=l,s=o),l<1?a.bulk+=o.quantity||1:l<5?a.budget+=o.quantity||1:l<20?a.mid+=o.quantity||1:l<50?a.high+=o.quantity||1:a.premium+=o.quantity||1,{...o,price:l}}),{total:parseFloat(r.toFixed(2)),max:parseFloat(n.toFixed(2)),maxCard:s,average:t.length?parseFloat((r/t.length).toFixed(2)):0,distribution:a,currency:e}},generateTCGPlayerLink(t,e="MTGLibrary"){if(!t||t.length===0)return"";const r=t.map(a=>`${a.quantity||1} ${a.name}`).join("||"),n="https://store.tcgplayer.com/massentry",s=new URLSearchParams({partner:e,utm_campaign:"affiliate",utm_medium:"mtglibrary",utm_source:"MTGLibrary",c:r});return`${n}?${s.toString()}`}};function B7e(t=[]){const e=b.useMemo(()=>!t||t.length===0?null:hq.getDeckValue(t),[t]),r=b.useMemo(()=>hq.generateTCGPlayerLink(t),[t]);return{value:e,tcgPlayerLink:r}}const F7e=()=>{const{cards:t,loading:e}=yo(),{value:r}=B7e(t),n=b.useMemo(()=>t?[...t].sort((o,l)=>(l.currPrice||0)*(l.quantity||1)-(o.currPrice||0)*(o.quantity||1)).slice(0,5):[],[t]);if(e)return i.jsx("div",{className:"animate-pulse h-12 bg-gray-900 rounded-xl"});const s=Math.random()>.5?"up":"down",a=(Math.random()*5).toFixed(1);return i.jsxs("div",{className:"bg-gray-900/50 border border-white/5 rounded-2xl p-4 flex flex-col md:flex-row items-center justify-between gap-6 overflow-hidden relative",children:[i.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2"}),i.jsxs("div",{className:"flex-shrink-0 flex items-center gap-4 z-10",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20",children:i.jsx("span",{className:"text-xl",children:""})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Collection Value"}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsxs("span",{className:"text-2xl font-mono font-bold text-white",children:["$",r?.total?.toFixed(2)||"0.00"]}),i.jsxs("span",{className:`text-xs font-bold ${s==="up"?"text-green-500":"text-red-500"} flex items-center`,children:[s==="up"?"":""," ",a,"%"]})]})]})]}),i.jsx("div",{className:"hidden md:block w-px h-10 bg-white/10"}),i.jsx("div",{className:"flex-grow overflow-hidden w-full relative z-10",children:i.jsxs("div",{className:"flex gap-6 animate-scroll-subtle hover:pause-scroll",children:[n.map(o=>i.jsxs("div",{className:"flex items-center gap-2 group flex-shrink-0 cursor-pointer",children:[i.jsx("div",{className:"w-8 h-8 rounded overflow-hidden relative border border-white/10 group-hover:border-indigo-500 transition-colors",children:i.jsx("img",{src:o.image_uris?.small||o.image_uri,className:"w-full h-full object-cover",alt:""})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),i.jsxs("div",{className:"text-[10px] font-mono text-emerald-400",children:["$",((o.currPrice||0)*(o.quantity||1)).toFixed(2)]})]})]},o.id||o.firestoreId)),n.length===0&&i.jsx("div",{className:"text-xs text-gray-500 italic",children:"Add cards to see market analysis"})]})}),i.jsx("style",{children:`
                .pause-scroll:hover {
                     animation-play-state: paused;
                }
            `})]})},$7e=({deck:t})=>{const{attributes:e,listeners:r,setNodeRef:n,transform:s,transition:a,isDragging:o}=Yne({id:t.id}),l={transform:jf.Transform.toString(s),transition:a,opacity:o?.3:1,zIndex:o?999:"auto"};return i.jsx("div",{ref:n,style:l,...e,...r,children:i.jsx(IM,{deck:t})})},U7e=t=>{const e=new Set;return t.forEach(r=>{Array.isArray(r.tags)&&r.tags.forEach(n=>e.add(n))}),Array.from(e).sort()},z7e=()=>{const{user:t,userProfile:e}=Cr(),{addToast:r}=Tn(),[n,s]=b.useState([]),{decks:a,loading:o,error:l}=yd(null),[c,u]=b.useState([]),[h,f]=b.useState([]),[m,g]=b.useState(""),[y,v]=b.useState("custom"),[w,N]=b.useState([]),[k,C]=b.useState([]),[I,O]=b.useState(!1),L=HO(qy(Z_),qy(J_,{coordinateGetter:Xne}));b.useEffect(()=>{if(a){f(a);const P=a.map(R=>({...R,tags:typeof R.tags=="string"?JSON.parse(R.tags):R.tags||[]}));u(P),C(U7e(P))}},[a]);const _=b.useMemo(()=>{let P=[...c];if(m){const R=m.toLowerCase();P=P.filter(V=>V.name.toLowerCase().includes(R)||V.commander&&V.commander.name.toLowerCase().includes(R))}return w.length>0&&(P=P.filter(R=>w.every(V=>(R.tags||[]).includes(V)))),y!=="custom"&&P.sort((R,V)=>{switch(y){case"name":return R.name.localeCompare(V.name);case"updated":return new Date(V.updated_at)-new Date(R.updated_at);case"created":return new Date(V.created_at)-new Date(R.created_at);case"color":const ee=G=>(G.commander?.color_identity||[]).join("");return ee(R).localeCompare(ee(V));default:return 0}}),P},[c,m,y,w]);b.useEffect(()=>{(async()=>{if(t)try{const R=await Ka.fetchIncomingPermissions(),V=(Array.isArray(R)?R:[]).filter(ee=>!ee.target_deck_id);s(V)}catch(R){console.error("Failed to load shared sources",R)}})()},[t]);const E=P=>{const R=An(e?.subscription_tier).limits.decks,V=c.length||0;R!==1/0&&V>=R&&(P.preventDefault(),r(`Deck limit reached (${V}/${R}). Upgrade to create more!`,"error"))};b.useEffect(()=>{(m||w.length>0)&&O(!1)},[m,w]);const M=async P=>{const{active:R,over:V}=P;!V||R.id===V.id||u(ee=>{const G=ee.findIndex(X=>X.id===R.id),J=ee.findIndex(X=>X.id===V.id),Z=rS(ee,G,J),se=Z.map(X=>X.id);return al.reorderDecks(t.uid,se).catch(X=>{console.error("Failed to save deck order",X),r("Failed to save new order","error")}),Z})},B=P=>{N(R=>R.includes(P)?R.filter(V=>V!==P):[...R,P])},S=()=>{I?O(!1):(v("custom"),g(""),N([]),O(!0),r("Reordering unlocked. Drag decks to arrange.","info"))};return i.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),i.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-10 relative z-10",children:[i.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-end mb-12 gap-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"My Strategies"}),i.jsx("p",{className:"text-gray-400 font-medium",children:"Manage your collection and view shared decks."})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full xl:w-auto items-center",children:[i.jsx("button",{onClick:S,className:`p-2 h-10 w-10 flex items-center justify-center rounded-xl border transition-all ${I?"bg-indigo-600 text-white border-indigo-500 shadow-lg shadow-indigo-500/20":"bg-gray-900/50 text-gray-400 border-gray-700 hover:text-white hover:border-gray-500"}`,title:I?"Lock Order":"Unlock to Reorder",children:I?i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})})}),i.jsxs("div",{className:"relative group flex-1 md:w-64",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-900 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Search decks...",value:m,onChange:P=>g(P.target.value),disabled:I})]}),k.length>0&&i.jsx("div",{className:"relative group",children:i.jsxs("select",{className:"appearance-none block w-full md:w-48 pl-3 pr-10 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed",onChange:P=>P.target.value&&B(P.target.value),value:"",disabled:I,children:[i.jsx("option",{value:"",children:"Filter by Tag..."}),k.map(P=>i.jsx("option",{value:P,disabled:w.includes(P),children:P},P))]})}),i.jsx("div",{className:"relative",children:i.jsxs("select",{value:y,onChange:P=>v(P.target.value),className:"appearance-none block w-full md:w-40 pl-3 pr-10 py-2 border border-gray-700 rounded-xl leading-5 bg-gray-900/50 text-gray-300 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed",disabled:I,children:[i.jsx("option",{value:"custom",children:"Custom Order"}),i.jsx("option",{value:"name",children:"Name (A-Z)"}),i.jsx("option",{value:"updated",children:"Last Updated"}),i.jsx("option",{value:"created",children:"Newest First"}),i.jsx("option",{value:"color",children:"Color Identity"})]})}),i.jsxs(Hr,{to:"/decks/new",onClick:E,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center justify-center gap-2 border border-indigo-400/20 hover:border-indigo-400 whitespace-nowrap",children:[i.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"New Deck"]})]})]}),w.length>0&&i.jsxs("div",{className:"flex flex-wrap gap-2 mb-8 animate-fade-in",children:[w.map(P=>i.jsxs("button",{onClick:()=>B(P),className:"bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 text-xs font-bold px-3 py-1 rounded-full flex items-center gap-2 hover:bg-indigo-500/30 transition-colors",children:[P,i.jsx("span",{className:"text-indigo-400/50 hover:text-white",children:""})]},P)),i.jsx("button",{onClick:()=>N([]),className:"text-gray-500 text-xs hover:text-white transition-colors underline decoration-dotted",children:"Clear Filter"})]}),i.jsx("div",{className:"mb-8",children:i.jsx(F7e,{})}),o?i.jsx(Q4,{title:"My Decks",decks:[],loading:!0}):l?i.jsx(Q4,{title:"My Decks",decks:[],error:l}):i.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[i.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:["My Decks",i.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:_.length})]}),I&&i.jsxs("div",{className:"w-full md:w-auto bg-indigo-500/10 border border-indigo-500/30 rounded-xl px-4 py-2 flex items-center justify-center gap-3 animate-pulse",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),i.jsx("span",{className:"text-sm md:text-base font-bold text-indigo-300",children:"Reordering Enabled - Drag to arrange!"})]})]}),I?i.jsxs(YO,{sensors:L,collisionDetection:nCe,onDragEnd:M,children:[i.jsx(Gne,{items:_.map(P=>P.id),strategy:nS,children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:_.map(P=>i.jsx($7e,{deck:P},P.id))})}),i.jsx(XO,{})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:_.map(P=>i.jsx(IM,{deck:P},P.id))}),_.length===0&&i.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[i.jsx("p",{className:"text-gray-500 mb-6",children:"No matching decks found."}),i.jsx(Hr,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]}),n.length>0&&i.jsxs("div",{className:"mt-16 border-t border-white/5 pt-12",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-500 uppercase tracking-widest mb-8 flex items-center gap-4",children:[i.jsx("span",{className:"h-px bg-gray-800 flex-1"}),"Shared Libraries",i.jsx("span",{className:"h-px bg-gray-800 flex-1"})]}),i.jsx("div",{className:"space-y-4",children:n.map(P=>i.jsx(D7e,{friend:P},P.id))})]})]})]})},V7e=()=>{const{decks:t,loading:e,refresh:r}=yd(),{currentUser:n,userProfile:s}=Cr(),{addToast:a}=Tn();yn();const[o,l]=b.useState(!1),[c,u]=b.useState(!1);b.useEffect(()=>{const g=()=>u(!0);return window.addEventListener("start-tour",g),localStorage.getItem("tour_seen_binders_tour_v1")||setTimeout(()=>u(!0),1e3),()=>window.removeEventListener("start-tour",g)},[]);const h=[{target:"h1",title:"The Armory",content:"Manage your binders here. Binders are like decks but for trading or showcasing."},{target:"#new-binder-btn",title:"Create Binder",content:"Start a new binder to organize your cards."}],f=t.filter(g=>g.format==="binder"),m=async()=>{l(!0);try{const g=ta[s?.subscription_tier||"free"];if(f.length>=(g?.limits?.binders||5)){a(`Upgrade to create more binders! (Limit: ${g?.limits?.binders||5})`,"error");return}const y=`New Binder ${f.length+1}`,v=await al.createDeck(n.uid,{name:y,format:"binder",description:"A dedicated trade binder.",isPublic:!0});await r(),a("Binder created!","success")}catch(g){console.error(g),a("Failed to create binder.","error")}finally{l(!1)}};return e?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):i.jsxs("div",{className:"min-h-screen bg-[#0B0C15] pb-24 relative overflow-hidden",children:[i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-10",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white tracking-tight mb-2",children:i.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Armory"})}),i.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"Manage your trade binders and share your collection with the community."})]}),i.jsxs("button",{id:"new-binder-btn",onClick:m,disabled:o,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?i.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"New Binder"]})]}),f.length>0?i.jsx(Q4,{title:"Your Binders",decks:f,canCreate:!1}):i.jsxs("div",{className:"text-center py-24 bg-gray-900/30 rounded-3xl border border-dashed border-gray-700",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Binders Yet"}),i.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"Create a binder to start organizing your trades or showcased cards separately from your playable decks."}),i.jsx("button",{onClick:m,className:"text-indigo-400 hover:text-indigo-300 font-bold uppercase tracking-widest text-xs hover:underline",children:"Create your first binder"})]})]}),i.jsx(zf,{steps:h,isOpen:c,onClose:()=>u(!1),tourId:"binders_tour_v1"})]})},q7e=({isOpen:t,onClose:e,onAdd:r})=>{const{addToast:n}=Tn(),[s,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState([]),[h,f]=b.useState(null),[m,g]=b.useState(!1),[y,v]=b.useState([]),[w,N]=b.useState("and"),[k,C]=b.useState(""),[I,O]=b.useState(""),L=B=>{v(S=>S.includes(B)?S.filter(P=>P!==B):[...S,B])},_=async B=>{B.preventDefault();const S=y.length>0||k.trim()||I.trim();if(!(!s.trim()&&!S)){l(!0);try{let P=null;if(I.trim()){const ee=I.trim().match(/^([<>]=?|=)?\s*(\d+)$/);ee&&(P={operator:ee[1]||"=",value:parseInt(ee[2],10)})}const R={query:s,type:"legendary creature",text:k,colors:y.length>0?y:void 0,colorIdentity:!0,colorLogic:w,mv:P},V=await He.post("/api/cards/search",R);u(V.data||[])}catch(P){console.error(P),n("Search failed. The Oracle is unreachable.","error")}finally{l(!1)}}},E=async B=>{f({id:B.id,name:B.name});try{const S={scryfall_id:B.id,name:B.name,set_code:B.set,collector_number:B.collector_number,finish:"nonfoil",count:1,data:B,is_wishlist:!0};await He.post("/api/collection",S),n(`"${B.name}" added to Wishlist!`,"success"),r&&r(),e()}catch(S){console.error(S),n("Failed to add to wishlist.","error")}finally{f(null)}};if(!t)return null;const M={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"}};return Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:[i.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col border border-white/10 overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 bg-gray-950/50 flex justify-between items-center shrink-0",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[i.jsx("span",{className:"text-purple-400",children:"Summon Legend"}),i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-300 uppercase tracking-wider border border-purple-500/30",children:"Wishlist"})]}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the multiverse for a commander you don't own yet."})]}),i.jsx("button",{onClick:e,className:"p-2 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"bg-gray-900 border-b border-white/5 flex flex-col shrink-0",children:i.jsxs("form",{onSubmit:_,className:"p-6",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx("input",{type:"text",value:s,onChange:B=>a(B.target.value),placeholder:"Search by name...",className:"w-full bg-gray-950 border border-white/10 rounded-2xl py-4 pl-14 pr-14 text-lg text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all shadow-inner",autoFocus:!m}),i.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s&&i.jsx("button",{type:"button",onClick:()=>a(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("button",{type:"button",onClick:()=>g(!m),className:`px-4 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${m?"bg-purple-600 text-white border-purple-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[i.jsx(gte,{className:"w-5 h-5"}),"Filters"]}),i.jsx("button",{type:"submit",disabled:o,className:"px-8 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-2xl transition-all disabled:opacity-50 shadow-lg shadow-purple-500/20",children:o?"Searching...":"Search"})]}),i.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${m?"max-h-96 opacity-100 mt-6":"max-h-0 opacity-0"}`,children:i.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Color Identity"}),i.jsx("div",{className:"flex gap-2",children:Object.entries(M).map(([B,S])=>i.jsx("button",{type:"button",onClick:()=>L(B),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${y.includes(B)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:y.includes(B)?"transparent":""},children:i.jsx("img",{src:S.symbol,alt:B,className:`w-full h-full ${y.includes(B)?"drop-shadow-md":"grayscale"}`})},B))}),i.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[i.jsx("span",{className:`cursor-pointer ${w==="or"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>N("or"),children:"Includes any (OR)"}),i.jsx("div",{className:"w-10 h-5 bg-gray-800 rounded-full relative cursor-pointer border border-white/10",onClick:()=>N(B=>B==="or"?"and":"or"),children:i.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-purple-500 transition-all ${w==="and"?"left-5.5":"left-0.5"}`})}),i.jsx("span",{className:`cursor-pointer ${w==="and"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>N("and"),children:"Exact match (AND)"})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Oracle Text"}),i.jsx("input",{type:"text",value:k,onChange:B=>C(B.target.value),placeholder:"e.g. 'draw cards', 'counter'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm"}),i.jsx("p",{className:"text-[10px] text-gray-600",children:"Searches abilities and rules text."})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Mana Value (CMC)"}),i.jsx("input",{type:"text",value:I,onChange:B=>O(B.target.value),placeholder:"e.g. '4' or '<= 3'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm font-mono"})]})]})})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-950/30 custom-scrollbar",children:[!o&&c.length===0&&i.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40",children:[i.jsx("svg",{className:"w-24 h-24 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),i.jsx("p",{className:"text-xl font-bold text-gray-400",children:"No legends found."}),i.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters."})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(B=>{const S=B.image_uris?.art_crop||B.image_uris?.normal||B.data?.image_uris?.art_crop||B.data?.image_uris?.normal,P=h?.id===B.id;return i.jsxs("div",{className:"group relative bg-gray-900 rounded-2xl border border-white/5 overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-2xl hover:shadow-purple-500/10 hover:-translate-y-1",children:[i.jsxs("div",{className:"h-60 w-full bg-black relative",children:[S?i.jsx("img",{src:S,alt:B.name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-500"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 font-bold",children:"No Art"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent"})]}),i.jsxs("div",{className:"p-4 relative",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-300 transition-colors line-clamp-1",children:B.name}),i.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-1",children:B.type_line}),i.jsx("button",{onClick:()=>E(B),disabled:P,className:"w-full py-2 bg-white/5 hover:bg-purple-600 text-gray-300 hover:text-white rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 group-hover:bg-purple-600 group-hover:text-white",children:P?i.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Wishlist"]})})]})]},B.id)})})]})]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(168, 85, 247, 0.4); }
            `}})]}),document.body)};class I8{static parseText(e){if(!e||typeof e!="string")return{mainboard:[],sideboard:[],errors:["Empty input"]};const r=e.split(/\r?\n/).map(a=>a.trim()).filter(a=>a),n={mainboard:[],sideboard:[],errors:[]};let s="mainboard";return r.forEach(a=>{if(a.toLowerCase()==="deck"||a.toLowerCase()==="mainboard"){s="mainboard";return}if(a.toLowerCase()==="sideboard"||a.toLowerCase()==="commander"){s="sideboard";return}const o=this.parseLine(a);o?n[s].push(o):a.length>2&&n.errors.push(`Could not parse line: "${a}"`)}),n.mainboard=this.consolidate(n.mainboard),n.sideboard=this.consolidate(n.sideboard),n}static parseLine(e){const r=/^(\d+)[xX]?\s+(.+)\s+\(([A-Za-z0-9]{3,4})\)\s*(\d+)?/,n=e.match(r);if(n)return{quantity:parseInt(n[1],10),name:n[2].trim(),set:n[3].toUpperCase(),collectorNumber:n[4]||null,isFoil:e.toLowerCase().includes(" *f*")};const s=/^(\d+)[xX]?\s+(.+)/,a=e.match(s);if(a){let o=a[2].trim(),l=null;const c=o.match(/\(([A-Za-z0-9]{3,4})\)$/);return c&&(l=c[1],o=o.replace(c[0],"").trim()),{quantity:parseInt(a[1],10),name:o,set:l,collectorNumber:null}}return/[a-zA-Z]/.test(e)?{quantity:1,name:e,set:null,collectorNumber:null}:null}static consolidate(e){const r=new Map;return e.forEach(n=>{const s=n.set?`${n.name}|${n.set}|${n.collectorNumber||""}`:n.name;r.has(s)?r.get(s).quantity+=n.quantity:r.set(s,{...n})}),Array.from(r.values())}static async resolveCards(e){if(!e||e.length===0)return[];const r=[],n=75;for(let o=0;o<e.length;o+=n)r.push(e.slice(o,o+n));const s=[],a=[];for(const o of r){const l=o.map(c=>c.set&&c.collectorNumber?{set:c.set,collector_number:c.collectorNumber}:c.set?{name:c.name,set:c.set}:{name:c.name});try{const c=await fetch("https://api.scryfall.com/cards/collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifiers:l})});if(!c.ok)throw new Error("Scryfall API Error");const u=await c.json();u.data.forEach(h=>{const f=o.find(m=>m.set&&m.collectorNumber?m.set.toLowerCase()===h.set&&m.collectorNumber===h.collector_number:m.name.toLowerCase()===h.name.toLowerCase()||h.card_faces&&h.card_faces[0].name.toLowerCase()===m.name.toLowerCase());f&&s.push({...f,scryfall_id:h.id,name:h.name,set_code:h.set,collector_number:h.collector_number,image_uri:h.image_uris?.normal||h.card_faces?.[0]?.image_uris?.normal,data:h})}),u.not_found&&u.not_found.length>0&&u.not_found.forEach(h=>{console.warn("Card not found:",h),a.push(h.name)})}catch(c){console.error("Failed to resolve batch",c)}}return s}static async parseUrl(e){try{const r=await He.post("/api/import/url",{url:e});return{mainboard:r.mainboard||[],sideboard:r.sideboard||[],name:r.name,errors:[]}}catch(r){return console.error("URL Import Error",r),{mainboard:[],sideboard:[],errors:[r.response?.data?.error||"Failed to fetch URL"]}}}}const H7e=({isOpen:t,onClose:e,onImport:r})=>{const[n,s]=b.useState(""),[a,o]=b.useState(null),[l,c]=b.useState("paste"),[u,h]=b.useState(""),[f,m]=b.useState(!1),g=async()=>{if(l==="paste"){const w=I8.parseText(n);o(w)}else{m(!0);try{const w=await I8.parseUrl(u);o(w)}finally{m(!1)}}},y=()=>{a&&(r(a),e())},v=()=>{s(""),o(null)};return i.jsx(tp,{open:t,onClose:e,className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[i.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl p-6 shadow-2xl mx-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx(tp.Title,{className:"text-2xl font-black text-white",children:"Import Deck"}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a?i.jsxs("div",{className:"flex flex-col h-[500px]",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-8 flex-1 overflow-hidden",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("h4",{className:"text-green-400 font-bold mb-2 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Mainboard (",a.mainboard.reduce((w,N)=>w+N.quantity,0),")"]}),i.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.mainboard.map((w,N)=>i.jsxs("div",{className:"flex justify-between items-center text-sm group",children:[i.jsxs("span",{className:"text-gray-300",children:[i.jsx("span",{className:"font-bold text-white mr-2",children:w.quantity}),w.name]}),w.set&&i.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:w.set})]},N))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("h4",{className:"text-purple-400 font-bold mb-2 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),"Sideboard / Commander (",a.sideboard.reduce((w,N)=>w+N.quantity,0),")"]}),i.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.sideboard.length>0?a.sideboard.map((w,N)=>i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("span",{className:"text-gray-300",children:[i.jsx("span",{className:"font-bold text-white mr-2",children:w.quantity}),w.name]}),w.set&&i.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:w.set})]},N)):i.jsx("div",{className:"h-full flex items-center justify-center text-gray-600 italic",children:"No Sideboard"})})]})]}),a.errors.length>0&&i.jsxs("div",{className:"mt-4 bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[i.jsx("h5",{className:"text-red-400 text-xs font-bold uppercase mb-1",children:"Parse Warnings"}),i.jsx("ul",{className:"text-xs text-red-300/80 list-disc ml-4",children:a.errors.map((w,N)=>i.jsx("li",{children:w},N))})]}),i.jsxs("div",{className:"mt-6 flex justify-between items-center pt-4 border-t border-white/5",children:[i.jsx("button",{onClick:v,className:"text-gray-400 hover:text-white font-medium text-sm",children:" Back to Paste"}),i.jsx("button",{onClick:y,className:"bg-green-600 hover:bg-green-500 text-white px-8 py-2 rounded-xl font-bold shadow-lg shadow-green-500/20",children:"Confirm Import"})]})]}):i.jsxs("div",{className:"flex gap-8 min-h-[400px]",children:[i.jsxs("div",{className:"w-48 flex flex-col gap-2 border-r border-white/5 pr-4",children:[i.jsx("button",{onClick:()=>c("paste"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="paste"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"Paste Text"}),i.jsx("button",{onClick:()=>c("url"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="url"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"From URL"}),i.jsxs("div",{className:"mt-auto p-3 bg-gray-800/50 rounded-lg text-xs text-gray-500",children:["Supports:",i.jsxs("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[i.jsx("li",{children:"Arena Exports"}),i.jsx("li",{children:"MTGO text"}),i.jsx("li",{children:"Moxfield URLs"})]})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[l==="paste"&&i.jsxs(i.Fragment,{children:[i.jsx("textarea",{value:n,onChange:w=>s(w.target.value),placeholder:`Paste your decklist here...

Example:
1 Sol Ring
1 Command Tower
1 Arcane Signet`,className:"w-full flex-1 bg-gray-950 border border-white/10 rounded-xl p-4 text-gray-300 font-mono text-sm focus:ring-2 focus:ring-indigo-500 outline-none resize-none"}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsx("button",{onClick:g,disabled:!n.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-6 py-2 rounded-xl font-bold",children:"Parse Deck"})})]}),l==="url"&&i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Import from Website"}),i.jsx("p",{className:"text-gray-400 mb-6",children:"Paste a URL from Moxfield, Archidekt, or TappedOut."}),i.jsxs("div",{className:"flex w-full max-w-lg gap-2",children:[i.jsx("input",{type:"text",value:u,onChange:w=>h(w.target.value),placeholder:"https://moxfield.com/decks/...",className:"flex-1 bg-gray-950 border border-white/10 rounded-xl px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),i.jsx("button",{onClick:g,disabled:!u||f,className:"bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-xl font-bold disabled:opacity-50",children:f?"...":"Fetch"})]}),i.jsx("p",{className:"mt-4 text-xs text-green-500/80",children:"Supports Moxfield & Archidekt"})]})]})]})]})]})})},Oi={BASICS:1,COMMANDER:2,PARTNER:2.5,AI_STRATEGY:3,REVIEW:4},W7e=()=>{const t=yn(),{userProfile:e}=Cr(),{addToast:r}=Tn(),[n,s]=b.useState(Oi.BASICS),[a,o]=b.useState(!1),[l,c]=b.useState("folder"),[u,h]=b.useState({}),[f,m]=b.useState(null),[g,y]=b.useState(""),[v,w]=b.useState("Commander"),[N,k]=b.useState([]),[C,I]=b.useState(null),[O,L]=b.useState(null),[_,E]=b.useState(""),[M,B]=b.useState(""),[S,P]=b.useState(null),[R,V]=b.useState("Consulting the Oracle..."),[ee,G]=b.useState(!1),[J,Z]=b.useState(!1),[se,X]=b.useState([]),[q,U]=b.useState(!0),[H,re]=b.useState(!1),[ae,xe]=b.useState(!1);b.useEffect(()=>{Ne()},[]);const Ne=async()=>{try{const nt=await He.get("/api/precons/types");X(nt)}catch(nt){console.error("Failed to fetch precon types",nt)}finally{U(!1)}};b.useEffect(()=>{window.scrollTo(0,0)},[n]);const pe=nt=>{if(!nt)return null;const bt=nt.data||nt;return bt.image_uris?.art_crop?bt.image_uris.art_crop:bt.card_faces?.[0]?.image_uris?.art_crop?bt.card_faces[0].image_uris.art_crop:bt.image_uris?.normal?bt.image_uris.normal:null},K=nt=>{const It=(nt.data||nt).color_identity||[];return It.length>0?It:["C"]},ue=(nt,bt)=>{nt==="Commander"||nt==="Standard"?fe(nt,bt):console.warn("Unknown format selected")},fe=async(nt,bt)=>{o(!0);try{const It={unused:!0};nt==="Commander"&&(It.type_line="legendary creature"),bt||(It.wishlist="false");const _t=await He.get("/api/collection",It);k(_t),s(Oi.COMMANDER)}catch(It){console.error(It),r("Failed to load cards","error")}finally{o(!1)}},he=nt=>{if(I(nt),v==="Standard"){r("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info"),s(Oi.REVIEW);return}const bt=nt.data||nt,It=bt.keywords||[],_t=bt.oracle_text||"";if(It.includes("Partner")||_t.includes("Partner"))s(Oi.PARTNER);else{const ut=An(e?.subscription_tier).features.aiStrategy;s(ut?Oi.AI_STRATEGY:Oi.REVIEW)}},le=nt=>{L(nt);const bt=An(e?.subscription_tier).features.aiStrategy;s(bt?Oi.AI_STRATEGY:Oi.REVIEW)},_e=async()=>{if(v==="Standard")return;const nt=e?.settings?.geminiApiKey,bt=e?.settings?.helper?.name||"The Oracle";if(!nt){r("AI Key missing. Skipping strategy.","warning"),s(Oi.REVIEW);return}o(!0),V(`${bt} is analyzing ${O?"your commanders":"your commander"}...`);try{const _t=[C,O].filter(Boolean).map(Rt=>({name:Rt.name||Rt.data?.name||"Unknown",mana_cost:Rt.mana_cost||Rt.cmc||Rt.data?.mana_cost||Rt.data?.cmc||"0",type_line:Rt.type_line||Rt.data?.type_line||"Legendary Creature",oracle_text:Rt.oracle_text||Rt.data?.oracle_text||""}));let wt=e.playstyle||e.settings?.playstyle||e.data?.playstyle||null;!wt&&e.data&&e.data.playstyle&&(wt=e.data.playstyle),wt||(console.warn(" Playstyle undefined in CreateDeck. Using generic fallback."),wt={summary:"Balanced Magic player enjoying strategic depth and interaction.",archetypes:["Midrange","Control"],scores:{aggression:5}});const ut=await Nl.getDeckStrategy(nt,_t,wt,[],e?.settings?.helper,e);ut.layout||(ut.layout={functional:{Lands:36,"Mana Ramp":10,"Card Draw":10,Removal:10,"Board Wipes":3,Synergy:30},types:{Creatures:30,Instants:10,Sorceries:10,Artifacts:10,Enchantments:4,Planeswalkers:0,Lands:36}}),P(ut),!g.trim()&&ut.suggestedName&&y(ut.suggestedName),s(Oi.REVIEW)}catch(It){console.error(It),r("AI Generation Failed. Proceeding manually.","error"),P({theme:"",strategy:"Manual strategy required.",layout:{functional:{Lands:36,Creatures:63},types:{Lands:36,Creatures:63}}}),s(Oi.REVIEW)}finally{o(!1)}},oe=async()=>{o(!0);try{const nt={name:g||(O?`${C.name} & ${O.name}`:C?.name)||"New Commander Deck",format:v,commander:C?.data||C||null,commanderPartner:O?.data||O||null,aiBlueprint:S?{theme:S.theme,strategy:S.strategy,suggestedCounts:S.layout?.functional||S.layout,typeCounts:S.layout?.types}:null,isMockup:ee},bt=await He.post("/api/decks",nt);r("Deck created successfully!","success"),t(`/decks/${bt.id}`)}catch(nt){console.error(nt),r("Failed to create deck","error")}finally{o(!1)}},Oe=async nt=>{xe(!0),re(!1),r("Resolving cards with Oracle...","info",1e4);try{const bt=[...nt.mainboard,...nt.sideboard],It=await I8.resolveCards(bt);if(It.length===0){r("No valid cards found to import.","error"),xe(!1);return}const _t={deck:{name:"Imported Deck",format:"Commander",commander:null},cards:It.map(ut=>({scryfall_id:ut.scryfall_id,name:ut.name,set_code:ut.set_code,collector_number:ut.collector_number,finish:ut.isFoil?"foil":"nonfoil",count:ut.quantity||1,data:ut.data})),options:{checkCollection:!0,addToCollection:!0}},wt=await He.post("/api/decks/import",_t);r(`Deck imported! ${wt.missingCards?.length?`(${wt.missingCards.length} missing)`:""}`,"success"),t(`/decks/${wt.deckId}`)}catch(bt){console.error(bt),r("Import Failed","error")}finally{xe(!1)}};b.useEffect(()=>{n===Oi.AI_STRATEGY&&C&&!S&&_e()},[n]);const ze=({card:nt,onClick:bt,isSelected:It})=>{const _t=pe(nt),wt=K(nt),ut=nt.data||nt;return i.jsx("div",{onClick:()=>bt(nt),className:`group relative h-[480px] rounded-3xl cursor-pointer transition-all duration-300 hover:-translate-y-2 ${It?"ring-4 ring-indigo-500 scale-105":""}`,children:i.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"h-[55%] w-full relative overflow-hidden bg-gray-950",children:[_t?i.jsx("img",{src:_t,alt:nt.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:i.jsx("span",{className:"text-gray-700 font-bold",children:"No Art"})}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}),i.jsxs("div",{className:"h-[45%] p-5 flex flex-col relative",children:[i.jsxs("div",{className:"absolute -top-3 left-5 flex gap-2 z-10",children:[i.jsx("div",{className:"flex gap-1 bg-gray-900/90 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:wt.map((Rt,Dt)=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Rt}.svg`,alt:Rt,className:"w-4 h-4 shadow-sm"},Dt))}),nt.finish==="foil"&&i.jsx("div",{className:"flex items-center justify-center w-8 h-8 -mt-1 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-[0_0_15px_rgba(250,204,21,0.6)] animate-pulse",title:"Foil",children:i.jsx("svg",{className:"w-5 h-5 text-white drop-shadow-sm",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),i.jsxs("div",{className:"mt-4 flex-1 flex flex-col gap-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:nt.name}),i.jsx("p",{className:"text-xs text-gray-400 font-medium line-clamp-1 border-b border-white/5 pb-2 mb-2",children:ut.type_line})]}),i.jsx("p",{className:"text-[10px] text-gray-300 leading-relaxed font-serif opacity-80 line-clamp-4",children:ut.oracle_text})]}),i.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[ut.power&&ut.toughness&&i.jsxs("div",{className:"bg-gray-800/80 px-2 py-1 rounded text-xs font-bold text-white border border-white/10 shadow-inner",children:[ut.power," / ",ut.toughness]}),i.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select"})]})]})]})})},Ye=b.useMemo(()=>{if(!N.length)return{};const nt={};return N.filter(It=>It.name.toLowerCase().includes(_.toLowerCase())||(It.data?.type_line||"").toLowerCase().includes(_.toLowerCase())).forEach(It=>{const _t=K(It),wt=F4(_t);nt[wt.badge]||(nt[wt.badge]={identity:wt,cards:[]}),nt[wt.badge].cards.push(It)}),nt},[N,_]),je=()=>{const nt=_.trim().length>0,bt=Object.entries(Ye).sort((_t,wt)=>{const ut=_t[1].identity.colors.length-wt[1].identity.colors.length;return ut!==0?ut:wt[1].cards.length-_t[1].cards.length}),It=(_t,wt,ut)=>i.jsxs("div",{onClick:ut,className:"w-full bg-gray-900/60 hover:bg-gray-800/60 backdrop-blur-md border border-white/5 rounded-2xl p-6 cursor-pointer transition-all flex items-center justify-between group mb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-1.5 border border-white/5",children:_t.identity.colors.map(Rt=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Rt}.svg`,alt:Rt,className:"w-5 h-5 shadow-sm"},Rt))}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:_t.identity.badge}),i.jsxs("p",{className:"text-sm text-gray-400 italic line-clamp-1",children:['"',_t.identity.flavor,'"']})]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[_t.cards.length," ",v==="Commander"?"Legends":"Cards"]}),i.jsx("svg",{className:`w-6 h-6 text-gray-400 transform transition-transform ${wt?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]});return i.jsxs("div",{className:"animate-fade-in space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-4 gap-4 shrink-0",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:v==="Commander"?"Choose Commander":"Choose Spotlight Card"}),i.jsx("p",{className:"text-gray-400",children:v==="Commander"?"Select the legend who will lead your deck.":"Select a card to feature as the face of your deck."})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("button",{onClick:()=>Z(!0),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-purple-500/20 flex items-center gap-2 transition-all hover:-translate-y-0.5",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Database"]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-1 flex border border-white/10",children:[i.jsx("button",{onClick:()=>c("list"),className:`p-2 rounded-lg transition-all ${l==="list"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"List View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),i.jsx("button",{onClick:()=>c("folder"),className:`p-2 rounded-lg transition-all ${l==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"Folder View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:v==="Commander"?"Search legends...":"Search cards...",value:_,onChange:_t=>E(_t.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),i.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),_&&i.jsx("button",{onClick:()=>E(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:[l==="folder"&&!f&&i.jsx(i.Fragment,{children:bt.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[i.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mb-6 border border-gray-700",children:i.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Cards Found"}),i.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:_?"No cards match your search filters.":"We couldn't find any qualifying cards in your collection."}),i.jsxs("button",{onClick:()=>Z(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/20 hover:-translate-y-1 transition-all flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Full Database"]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:bt.map(([_t,wt])=>i.jsxs("div",{onClick:()=>m(_t),className:"bg-gray-800/40 hover:bg-gray-700/50 border border-white/5 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm",children:[i.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-2 border border-white/5",children:wt.identity.colors.map(ut=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ut}.svg`,alt:ut,className:"w-6 h-6"},ut))}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-indigo-300 transition-colors uppercase tracking-wide",children:wt.identity.badge}),i.jsx("div",{className:"h-0.5 w-8 bg-indigo-500/50 mx-auto my-2"}),i.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',wt.identity.flavor,'"']})]}),i.jsxs("span",{className:"text-sm font-mono font-bold text-gray-500 bg-black/20 px-3 py-1 rounded-full mt-2",children:[wt.cards.length," ",v==="Commander"?"Legends":"Cards"]})]},_t))})}),l==="folder"&&f&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("button",{onClick:()=>m(null),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors font-bold uppercase text-xs tracking-widest mb-4",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Groups"]}),i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-3xl font-black text-white",children:Ye[f].identity.badge}),i.jsx("div",{className:"flex gap-1",children:Ye[f].identity.colors.map(_t=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${_t}.svg`,alt:_t,className:"w-6 h-6"},_t))})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ye[f].cards.map(_t=>i.jsx(ze,{card:_t,onClick:he},_t.id))})]}),l==="list"&&i.jsx("div",{className:"space-y-4",children:bt.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in border border-dashed border-gray-800 rounded-3xl",children:[i.jsx("p",{className:"text-gray-400",children:"No cards found in your collection matching criteria."}),i.jsx("button",{onClick:()=>Z(!0),className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 hover:underline",children:"Search Scryfall Database"})]}):bt.map(([_t,wt])=>{const ut=u[_t]||nt;return i.jsxs("div",{children:[It(wt,ut,()=>h(Rt=>({...Rt,[_t]:!Rt[_t]}))),ut&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8 pl-4 border-l-2 border-white/5 animate-fade-in",children:wt.cards.map(Rt=>i.jsx(ze,{card:Rt,onClick:he},Rt.id))})]},_t)})})]})]})},Fe=()=>{const nt=N.filter(bt=>{const It=bt.data||bt,_t=It.keywords||[],wt=It.oracle_text||"",ut=_t.includes("Partner")||wt.includes("Partner");return bt.id===C?.id||!ut?!1:bt.name.toLowerCase().includes(M.toLowerCase())});return i.jsxs("div",{className:"animate-fade-in space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-end mb-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Choose Partner"}),i.jsxs("p",{className:"text-gray-400",children:["Select a partner for ",C?.name,"."]})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Search partners...",value:M,onChange:bt=>B(bt.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),i.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),M&&i.jsx("button",{onClick:()=>B(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("button",{onClick:()=>{L(null),s(Oi.AI_STRATEGY)},className:"text-sm font-bold text-gray-400 hover:text-white underline self-center",children:"Skip / Solo Commander"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[nt.map(bt=>i.jsx(ze,{card:bt,onClick:le},bt.id)),nt.length===0&&i.jsx("div",{className:"col-span-full py-20 text-center text-gray-500",children:"No valid partners found matching your search."})]})]})},Nt=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in text-center",children:[i.jsxs("div",{className:"relative mb-8",children:[i.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full animate-ping absolute inset-0"}),i.jsx("div",{className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center relative shadow-[0_0_50px_rgba(79,70,229,0.5)]",children:i.jsx("svg",{className:"w-10 h-10 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})]}),i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:R}),i.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Brewing a perfect strategy tailored to your playstyle."})]}),$t=()=>{const nt=S?.layout?.functional||{},bt=S?.layout?.types||{};return i.jsxs("div",{className:"animate-fade-in flex flex-col space-y-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-6 mb-8 shrink-0 sticky -top-8 z-30 bg-gray-950/90 backdrop-blur-xl pt-4 pb-6 -mx-8 px-8 rounded-t-3xl border-b border-white/5",children:[i.jsxs("div",{className:"space-y-2 flex-1 w-full",children:[i.jsx("label",{className:"block text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deck Name"}),i.jsx("input",{type:"text",value:g,onChange:It=>y(It.target.value),className:"w-full text-4xl font-black bg-transparent border-b-2 border-white/10 focus:border-indigo-500 text-white placeholder-gray-600 outline-none pb-2 transition-colors",placeholder:"Name your deck..."})]}),i.jsxs("button",{onClick:oe,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 px-10 rounded-2xl shadow-lg shadow-indigo-500/20 transform hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 shrink-0",children:[a?"Forging...":"Create Deck",!a&&i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),i.jsx("div",{className:"space-y-8 flex-1",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md",children:[i.jsx("h3",{className:"text-xl font-bold text-indigo-300 mb-4",children:"Theme & Strategy"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Theme"}),i.jsx("p",{className:"text-lg text-white font-medium",children:S?.theme})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Gameplan"}),i.jsx("div",{className:"text-sm text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:S?.strategy}})]})]})]}),i.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md space-y-6",children:[i.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Composition Preview"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Functional Needs"}),i.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(nt).map(([It,_t])=>i.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[i.jsx("span",{className:"text-sm text-gray-300",children:It}),i.jsx("span",{className:"font-mono font-bold text-indigo-400",children:_t})]},It))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Type Balance"}),i.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(bt).map(([It,_t])=>i.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[i.jsx("span",{className:"text-sm text-gray-300",children:It}),i.jsx("span",{className:"font-mono font-bold text-emerald-400",children:_t})]},It))})]})]})]})})]})},Ut=C?pe(C):null;return i.jsxs("div",{className:"min-h-screen bg-gray-950 relative flex flex-col pb-20",children:[Ut&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-cover bg-center transition-all duration-1000 transform scale-105",style:{backgroundImage:`url(${Ut})`}}),i.jsx("div",{className:"fixed inset-0 bg-gray-950/60 backdrop-blur-2xl transition-all duration-1000"}),i.jsx("div",{className:"fixed inset-0 bg-gradient-to-t from-gray-950 via-gray-950/50 to-transparent"})]}),!Ut&&i.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/20 blur-[120px] rounded-full pointer-events-none"}),i.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto w-full px-6 py-8",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[i.jsx("button",{onClick:()=>t("/decks"),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),i.jsx("div",{className:"h-8 w-[1px] bg-white/10 mx-2"}),i.jsx("div",{className:"flex gap-2",children:[Oi.BASICS,Oi.COMMANDER,Oi.AI_STRATEGY,Oi.REVIEW].map((nt,bt)=>i.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${n>=nt?"w-12 bg-indigo-500":"w-4 bg-gray-700"}`},nt))})]}),i.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 shadow-2xl backdrop-blur-xl animate-fade-in-up",children:[a&&n!==Oi.AI_STRATEGY&&i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),!a&&n===Oi.BASICS&&i.jsxs("div",{className:"flex flex-col items-center space-y-12 animate-fade-in py-8",children:[i.jsxs("h1",{className:"text-5xl font-black text-white tracking-tight text-center",children:["Let's build something ",i.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"legendary."})]}),i.jsxs("div",{className:"w-full max-w-5xl px-4 space-y-12",children:[C&&i.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-white/5 backdrop-blur-sm animate-fade-in-down",children:[i.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:v==="Commander"?"Commander":"Spotlight Card"}),i.jsxs("div",{className:"flex gap-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl opacity-50 group-hover:opacity-75 blur transition duration-500"}),i.jsx("img",{src:C.image_uris?.normal||C.image_uris?.large,alt:C.name,className:"relative w-64 rounded-xl shadow-2xl transform group-hover:scale-[1.02] transition-all duration-500"})]}),i.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-3xl font-black text-white mb-2",children:C.name}),i.jsx("p",{className:"text-gray-400 text-sm",children:C.type_line}),i.jsx("p",{className:"text-gray-300 mt-4 text-base leading-relaxed",children:C.oracle_text})]}),i.jsxs("button",{onClick:()=>I(null),className:"self-start text-sm font-bold text-red-400 hover:text-red-300 underline mt-4",children:["Change ",v==="Commander"?"Commander":"Spotlight Card"]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),i.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Commander"}),i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{onClick:()=>{G(!1),w("Commander"),ue("Commander",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-indigo-900/20 border border-white/10 hover:border-indigo-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-indigo-500/30",children:i.jsx("svg",{className:"w-10 h-10 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"From Collection"}),i.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build using only cards you own.",i.jsx("br",{}),"Oracle verifies your binder."]})]})]}),i.jsxs("div",{onClick:()=>{G(!0),w("Commander"),ue("Commander",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-purple-900/20 border border-white/10 hover:border-purple-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-purple-500/30",children:i.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-purple-300 transition-colors",children:"Theorycraft Mockup"}),i.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Design without limits.",i.jsx("br",{}),"Missing cards added to wishlist."]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),i.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Quick Actions"}),i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 max-w-2xl mx-auto w-full",children:[i.jsxs("div",{onClick:()=>re(!0),className:"group cursor-pointer bg-gray-800/40 hover:bg-blue-900/20 border border-white/10 hover:border-blue-500/50 rounded-3xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-blue-500/10 flex items-center gap-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-blue-500/30 flex-shrink-0",children:i.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),i.jsxs("div",{className:"relative z-10 text-left",children:[i.jsx("h3",{className:"text-xl font-black text-white mb-1 group-hover:text-blue-300 transition-colors",children:"Import Deck"}),i.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Paste from Arena, Moxfield, or text file."})]})]}),i.jsxs("div",{className:"group opacity-50 cursor-not-allowed bg-gray-800/20 border border-white/5 rounded-3xl p-6 flex items-center gap-4 relative",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-700/20 rounded-2xl flex items-center justify-center border border-white/5 flex-shrink-0",children:i.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsxs("div",{className:"relative z-10 text-left",children:[i.jsx("h3",{className:"text-xl font-black text-gray-500 mb-1",children:"Scan Deck"}),i.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Coming soon to Mobile Companion."})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),i.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Standard"}),i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),"                                        ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{onClick:()=>{G(!1),w("Standard"),ue("Standard",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-emerald-900/20 border border-white/10 hover:border-emerald-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-emerald-500/30",children:i.jsx("svg",{className:"w-10 h-10 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-emerald-300 transition-colors",children:"Standard Collection"}),i.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build a 60-card Standard deck.",i.jsx("br",{}),"Using your own cards."]})]})]}),i.jsxs("div",{onClick:()=>{G(!0),w("Standard"),ue("Standard",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-cyan-900/20 border border-white/10 hover:border-cyan-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-cyan-500/30",children:i.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-cyan-300 transition-colors",children:"Standard Theorycraft"}),i.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Test new Standard meta decks.",i.jsx("br",{}),"Without owning every card."]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),i.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Precons"}),i.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),q?i.jsx("div",{className:"flex justify-center p-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[se.map(nt=>i.jsxs("div",{onClick:()=>t(`/precons?type=${encodeURIComponent(nt)}`),className:"group cursor-pointer bg-gray-800/40 hover:bg-amber-900/20 border border-white/10 hover:border-amber-500/50 rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-amber-500/10 flex flex-col items-center text-center gap-3 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),i.jsx("div",{className:"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-amber-500/30",children:i.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-amber-300 transition-colors",children:nt})]},nt)),se.length===0&&i.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No precon types found. (Is the DB populated?)"})]})]})]})]}),!a&&n===Oi.COMMANDER&&je(),!a&&n===Oi.PARTNER&&Fe(),n===Oi.AI_STRATEGY&&Nt(),!a&&n===Oi.REVIEW&&$t()]})]}),i.jsx(q7e,{isOpen:J,onClose:()=>Z(!1),onAdd:()=>fe()}),i.jsx(H7e,{isOpen:H,onClose:()=>re(!1),onImport:Oe}),ae&&i.jsxs("div",{className:"fixed inset-0 z-[60] bg-black/80 flex flex-col items-center justify-center backdrop-blur-sm",children:[i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mb-4"}),i.jsx("div",{className:"text-white font-bold text-xl",children:"Importing Deck..."}),i.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"Checking collection for matches"})]})]})};function PM(t){const{currentUser:e}=Cr(),r=yg(),n=["deck",t],{data:s,isLoading:a,error:o,refetch:l}=iw({queryKey:n,queryFn:async()=>{if(!e||!t||t==="new")return null;const{deck:m,items:g}=await He.get(`/api/decks/${t}`),y=g.map(v=>({...v,countInDeck:v.count||1,managedId:v.id}));return{deck:m,cards:y}},enabled:!!e&&!!t&&t!=="new",staleTime:1e3*60*1}),c=s?.deck||null,u=s?.cards||[];return{deck:c,cards:u,setDeck:m=>{r.setQueryData(n,g=>({...g,deck:typeof m=="function"?m(g.deck):m}))},setCards:m=>{r.setQueryData(n,g=>({...g,cards:typeof m=="function"?m(g.cards):m}))},loading:a,error:o,refresh:l}}const tae=({isOpen:t,onClose:e,onConfirm:r,title:n,message:s,confirmLabel:a="Confirm",isDangerous:o=!1,isLoading:l=!1,children:c})=>t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:`bg-gray-900 border ${o?"border-red-500/50":"border-blue-500/50"} rounded-2xl max-w-sm w-full p-6 shadow-2xl transform transition-all scale-100`,children:[i.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[i.jsx("div",{className:`w-12 h-12 rounded-full ${o?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-400"} flex items-center justify-center mb-4`,children:i.jsx(vj,{className:"w-6 h-6"})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),i.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:s}),c&&i.jsx("div",{className:"w-full text-left",children:c})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:e,disabled:l,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),i.jsxs("button",{onClick:r,disabled:l,className:`flex-1 px-4 py-2 font-bold rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed ${o?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:[l&&i.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})]})]})}):null,G7e=(t,e)=>{if(!t||t.length===0)return!0;const r=new Set(e||[]);return t.every(n=>r.has(n))},K7e=({isOpen:t,onClose:e,deck:r,deckCards:n=[],onCardAdded:s})=>{const{cards:a,loading:o}=yo(),{currentUser:l}=Cr(),{addToast:c}=Tn(),{openCardModal:u}=aw(),[h,f]=b.useState(""),[m,g]=b.useState("All"),[y,v]=b.useState(!1),[w,N]=b.useState({colors:[],rarity:[],set:"",manaValue:""}),[k,C]=b.useState("name"),I=b.useMemo(()=>{if(!a||!r)return[];const _=r.format?.toLowerCase()==="standard",E=r.commander?.color_identity||[],M=r.commander_partner?.color_identity||[],B=new Set([...E,...M]);return a.filter(P=>{if(P.deckId)return!1;const R=P.type_line?.toLowerCase().includes("basic land");if(!_&&!G7e(P.color_identity,[...B]))return!1;if(w.colors.length>0){const J=P.color_identity||[];if(!w.colors.some(se=>se==="C"?J.length===0:J.includes(se)))return!1}if(w.rarity.length>0&&!w.rarity.includes(P.rarity?.toLowerCase()))return!1;if(w.set){const J=w.set.toLowerCase();if(!P.set?.toLowerCase().includes(J)&&!P.set_name?.toLowerCase().includes(J))return!1}if(w.manaValue!==""){const J=parseFloat(w.manaValue);if(P.cmc!==J)return!1}const V=n.filter(J=>J.name===P.name).reduce((J,Z)=>J+(Z.countInDeck||1),0);if(!R&&V>=(_?4:1))return!1;const G=h.toLowerCase();return!(G&&!P.name.toLowerCase().includes(G)&&!P.type_line?.toLowerCase().includes(G)||m!=="All"&&!P.type_line?.toLowerCase().includes(m.toLowerCase()))}).sort((P,R)=>{if(k==="name")return P.name.localeCompare(R.name);if(k.startsWith("price")){const V=parseFloat(P.prices?.usd||P.data?.prices?.usd||0),ee=parseFloat(R.prices?.usd||R.data?.prices?.usd||0);return k==="price-asc"?V-ee:ee-V}if(k==="rarity"){const V={mythic:4,rare:3,uncommon:2,common:1},ee=V[P.rarity?.toLowerCase()]||0;return(V[R.rarity?.toLowerCase()]||0)-ee}return 0})},[a,r,n,h,m,w,k]),O=async(_,E="mainboard")=>{try{const M={..._,board:E};await al.addCardToDeck(l.uid,r.id,M);const B=E==="mainboard"?"Mainboard":E==="sideboard"?"Sideboard":"Maybeboard";c(`Added ${_.name} to ${B}`,"success"),s&&s()}catch(M){console.error(M),c("Failed to add card","error")}};if(!t)return null;const L=["All","Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"];return Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl h-[85vh] flex flex-col border border-gray-700",children:[i.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50 rounded-t-xl shrink-0",children:[i.jsx("div",{children:i.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"text-indigo-400",children:"Add from Collection"}),i.jsxs("span",{className:"text-sm font-normal text-gray-400 bg-gray-800 px-2 py-0.5 rounded-full border border-gray-700",children:[I.length," Available"]})]})}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 hover:bg-gray-700 p-2 rounded-lg",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700 space-y-4 shrink-0",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Search by name, type, or text...",className:"w-full bg-gray-900 text-white border border-gray-700 rounded-lg py-3 px-4 pl-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-inner",value:h,onChange:_=>f(_.target.value),autoFocus:!0}),i.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[i.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(_=>i.jsx("button",{onClick:()=>g(_),className:`px-3 py-1 text-xs font-bold rounded-full transition-colors border ${m===_?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200"}`,children:_},_))}),i.jsxs("button",{onClick:()=>v(!y),className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg border transition-all ${y?"bg-indigo-600 text-white border-indigo-500 shadow-lg":"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),y?"Hide Filters":"Advanced Filters"]})]}),y&&i.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-700 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-down shadow-inner",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Color Identity"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[["W","U","B","R","G"].filter(_=>r?.format?.toLowerCase()==="standard"?!0:new Set([...r?.commander?.color_identity||[],...r?.commander_partner?.color_identity||[]]).has(_)).map(_=>i.jsx("button",{onClick:()=>N(E=>({...E,colors:E.colors.includes(_)?E.colors.filter(M=>M!==_):[...E.colors,_]})),className:`w-8 h-8 rounded-full border flex items-center justify-center transition-all ${w.colors.includes(_)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-gray-700":"opacity-40 grayscale hover:grayscale-0 hover:opacity-100 border-gray-600 bg-gray-800"}`,children:i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${_}.svg`,alt:_,className:"w-5 h-5 shadow-sm"})},_)),i.jsx("button",{onClick:()=>N(_=>({..._,colors:_.colors.includes("C")?_.colors.filter(E=>E!=="C"):[..._.colors,"C"]})),className:`w-8 h-8 rounded-full border flex items-center justify-center text-[10px] font-black transition-all ${w.colors.includes("C")?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-indigo-600 text-white":"opacity-40 border-gray-600 bg-gray-800 text-gray-500 hover:opacity-100"}`,children:"C"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(_=>i.jsx("button",{onClick:()=>N(E=>({...E,rarity:E.rarity.includes(_)?E.rarity.filter(M=>M!==_):[...E.rarity,_]})),className:`px-3 py-1 text-[10px] font-bold uppercase rounded-lg border transition-all ${w.rarity.includes(_)?"bg-indigo-600 text-white border-indigo-400 shadow-md":"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:text-gray-300"}`,children:_.charAt(0)},_))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Set (Name/Code)"}),i.jsx("input",{type:"text",placeholder:"e.g. MH3 or Modern Horizons 3",value:w.set,onChange:_=>N(E=>({...E,set:_.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Mana Value"}),i.jsx("input",{type:"number",min:"0",placeholder:"CMC",value:w.manaValue,onChange:_=>N(E=>({...E,manaValue:_.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Sort By"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("select",{value:k,onChange:_=>C(_.target.value),className:"bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500 w-full",children:[i.jsx("option",{value:"name",children:"Name (A-Z)"}),i.jsx("option",{value:"price-desc",children:"Price (Highest)"}),i.jsx("option",{value:"price-asc",children:"Price (Lowest)"}),i.jsx("option",{value:"rarity",children:"Rarity"})]}),i.jsx("button",{onClick:()=>{N({colors:[],rarity:[],set:"",manaValue:""}),C("name"),f(""),g("All")},className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 transition-colors uppercase tracking-widest mt-1",children:"Reset All"})]})]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-950/50 p-4 custom-scrollbar",children:o?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):I.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-2",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),i.jsx("p",{children:"No cards found matching your criteria."})]}):i.jsx("div",{className:"space-y-3",children:I.map((_,E)=>{const M=_.data||_,B=M.image_uris?.art_crop||M.image_uris?.normal||M.card_faces?.[0]?.image_uris?.art_crop||M.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/100x100?text=No+Img",S=parseFloat(_.prices?.[_.finish==="foil"?"usd_foil":"usd"]||0).toFixed(2);return i.jsxs("div",{className:"flex bg-gray-800/60 rounded-xl border border-gray-700/50 hover:bg-gray-800 hover:border-indigo-500/50 transition-all group overflow-hidden h-24 relative",children:[i.jsxs("div",{className:"w-24 shrink-0 relative overflow-hidden cursor-pointer",onClick:()=>u(_),children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent to-gray-900/90 z-10"}),i.jsx("img",{src:B,className:"w-full h-full object-cover scale-150 transition-transform duration-700 group-hover:scale-125",alt:_.name,loading:"lazy"}),_.finish==="foil"&&i.jsx("div",{className:"absolute top-1 left-1 z-20 text-yellow-500 bg-black/60 rounded-full p-1 leading-none shadow-sm border border-yellow-500/30",title:"Foil",children:i.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})})]}),i.jsxs("div",{className:"flex-1 flex items-center justify-between px-4 py-2 min-w-0",children:[i.jsxs("div",{className:"flex flex-col justify-center min-w-0 pr-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"font-bold text-gray-100 text-base truncate cursor-pointer hover:text-indigo-400 transition-colors",onClick:()=>u(_),children:_.name}),i.jsx("span",{className:"text-xs font-mono text-gray-500 bg-gray-900 px-1.5 py-0.5 rounded border border-gray-700 shrink-0",children:_.mana_cost||""})]}),i.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[i.jsx("span",{className:"truncate",children:_.type_line}),i.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),i.jsx("span",{className:"font-mono text-xs uppercase bg-gray-700/50 px-1.5 rounded text-gray-300 border border-gray-600/50",children:_.set?.toUpperCase()}),S>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),i.jsxs("span",{className:"text-green-400/90 font-mono text-xs font-bold",children:["$",S]})]})]}),i.jsx("div",{className:"mt-1.5 flex items-center gap-2",children:i.jsxs("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider bg-gray-900/80 px-2 py-0.5 rounded-full",children:["Stack: ",_.count||1]})})]}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsx("button",{onClick:P=>{P.stopPropagation(),O(_,"mainboard")},className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg shadow-lg shadow-indigo-900/20 border border-indigo-500/50 transition-all active:scale-95 flex flex-col items-center min-w-[80px]",children:i.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Main"})}),i.jsx("button",{onClick:P=>{P.stopPropagation(),O(_,"sideboard")},className:"bg-gray-700 hover:bg-gray-600 text-gray-200 hover:text-white px-4 py-2 rounded-lg shadow-lg border border-gray-600 transition-all active:scale-95 flex flex-col items-center min-w-[80px]",children:i.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Side"})})]})]})]},_.firestoreId||`${_.id}-${E}`)})})})]})}),document.body)},_N=[{key:"W",name:"White",color:"bg-yellow-100",text:"text-yellow-600",border:"border-yellow-200/50",bg:"bg-yellow-500/10",pip:""},{key:"U",name:"Blue",color:"bg-blue-400",text:"text-blue-400",border:"border-blue-500/30",bg:"bg-blue-500/10",pip:""},{key:"B",name:"Black",color:"bg-gray-600",text:"text-gray-400",border:"border-gray-500/30",bg:"bg-gray-500/10",pip:""},{key:"R",name:"Red",color:"bg-red-500",text:"text-red-400",border:"border-red-500/30",bg:"bg-red-500/10",pip:""},{key:"G",name:"Green",color:"bg-green-500",text:"text-green-400",border:"border-green-500/30",bg:"bg-green-500/10",pip:""},{key:"C",name:"Colorless",color:"bg-gray-400",text:"text-gray-500",border:"border-gray-600/30",bg:"bg-gray-600/10",pip:""}],Y7e=({cards:t=[]})=>{const e=b.useMemo(()=>{const n={pips:{W:0,U:0,B:0,R:0,G:0,C:0},production:{W:0,U:0,B:0,R:0,G:0,C:0},curve:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0},colorCurve:{W:[0,0,0,0,0,0,0,0],U:[0,0,0,0,0,0,0,0],B:[0,0,0,0,0,0,0,0],R:[0,0,0,0,0,0,0,0],G:[0,0,0,0,0,0,0,0],C:[0,0,0,0,0,0,0,0]},totalPips:0,totalProduction:0,nonLandCount:0,avgCMC:0};let s=0;return t.forEach(a=>{const o=a.data||a,l=(o.type_line||"").toLowerCase(),c=l.includes("land"),u=o.mana_cost||"",h=(o.oracle_text||"").toLowerCase();if(!c){n.nonLandCount+=a.countInDeck||1;const g=o.cmc??0;s+=g*(a.countInDeck||1),(u.match(/\{([^}]+)\}/g)||[]).forEach(w=>{w.slice(1,-1).split("/").forEach(C=>{if(["W","U","B","R","G","C"].includes(C)){n.pips[C]+=a.countInDeck||1,n.totalPips+=a.countInDeck||1;const I=Math.min(Math.floor(g),7);n.colorCurve[C][I]+=a.countInDeck||1}})});const v=g>=7?"7+":Math.floor(g);n.curve[v]+=a.countInDeck||1}let f=o.produced_mana||[];(h.includes("any color")||h.includes("mana of any color"))&&(f=["W","U","B","R","G"]),f.length===0&&c&&(l.includes("plains")&&f.push("W"),l.includes("island")&&f.push("U"),l.includes("swamp")&&f.push("B"),l.includes("mountain")&&f.push("R"),l.includes("forest")&&f.push("G")),!c&&h.includes("add {")&&["w","u","b","r","g","c"].forEach(g=>{h.includes(`add {${g}}`)&&f.push(g.toUpperCase())}),[...new Set(f)].forEach(g=>{n.production[g]!==void 0&&(n.production[g]+=a.countInDeck||1,n.totalProduction+=a.countInDeck||1)})}),n.avgCMC=n.nonLandCount>0?(s/n.nonLandCount).toFixed(2):0,n},[t]),r=(n,s="bg-indigo-500",a="h-48")=>{const o=Object.entries(n),l=Math.max(...o.map(c=>c[1]),1);return i.jsx("div",{className:`flex gap-1 ${a} w-full px-2`,children:o.map(([c,u])=>i.jsxs("div",{className:"flex-1 h-full flex flex-col justify-end items-center group relative",children:[u>0&&i.jsx("div",{className:`w-full ${s} rounded-t transition-all duration-500 group-hover:brightness-125`,style:{height:`${u/l*100}%`},children:i.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 px-1 rounded",children:u})}),i.jsx("div",{className:"text-[10px] font-bold text-gray-500 mt-2",children:c})]},c))})};return i.jsxs("div",{className:"space-y-8 animate-fade-in",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[i.jsx("span",{children:"Cost (Pips)"}),i.jsxs("span",{children:[e.totalPips," Total"]})]}),i.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800",children:_N.filter(n=>e.pips[n.key]>0).map(n=>i.jsx("div",{className:`${n.color} h-full transition-all duration-700`,style:{width:`${e.pips[n.key]/e.totalPips*100}%`},title:`${n.name}: ${e.pips[n.key]}`},n.key))})]}),i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[i.jsx("span",{children:"Production"}),i.jsxs("span",{children:[e.totalProduction," Sources"]})]}),i.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800 shadow-inner",children:_N.filter(n=>e.production[n.key]>0).map(n=>i.jsx("div",{className:`${n.color} h-full transition-all duration-700 opacity-80`,style:{width:`${e.production[n.key]/e.totalProduction*100}%`},title:`${n.name}: ${e.production[n.key]}`},n.key))})]})]}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:_N.map(n=>{const s=e.pips[n.key],a=e.production[n.key],o=e.totalPips>0?Math.round(s/e.totalPips*100):0,l=e.totalProduction>0?Math.round(a/e.totalProduction*100):0,c=s>0||a>0;return i.jsxs("div",{className:`p-4 rounded-2xl border transition-all duration-300 ${c?`${n.bg} ${n.border}`:"bg-gray-800/10 border-gray-800/50 opacity-40"}`,children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("span",{className:"text-2xl",children:n.pip}),i.jsx("div",{className:"text-right",children:i.jsx("div",{className:`text-[10px] font-black uppercase tracking-tighter ${n.text}`,children:n.name})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[i.jsx("span",{children:"Cost"}),i.jsxs("span",{className:"text-white",children:[o,"%"]})]}),i.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full ${n.color} transition-all duration-1000`,style:{width:`${o}%`}})}),i.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[s," pips"]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[i.jsx("span",{children:"Prod"}),i.jsxs("span",{className:"text-white",children:[l,"%"]})]}),i.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full ${n.color} opacity-60 transition-all duration-1000`,style:{width:`${l}%`}})}),i.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[a," mana"]})]})]})]},n.key)})}),i.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-2xl border border-gray-800/50",children:[i.jsx("div",{className:"flex justify-between items-end mb-8",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"Mana Curve"}),i.jsxs("p",{className:"text-xs text-gray-500 font-medium",children:["Average Mana Value (Non-lands): ",i.jsx("span",{className:"text-indigo-400",children:e.avgCMC})]})]})}),r(e.curve,"bg-indigo-500","h-40")]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_N.filter(n=>e.pips[n.key]>0).map(n=>i.jsxs("div",{className:"bg-gray-900/30 p-4 rounded-xl border border-gray-800/50",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("span",{className:"text-lg",children:n.pip}),i.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${n.text}`,children:[n.name," Spells"]})]}),r(Object.fromEntries(e.colorCurve[n.key].map((s,a)=>[a===7?"7+":a,s])),n.color,"h-24")]},n.key))})]})},rae=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{userProfile:s}=Cr(),a=s?.settings?.helper?.name||"The Oracle";return t?o_.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[i.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-6xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),i.jsx("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0",children:i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[10px] font-black font-mono text-indigo-400 uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Analytics"}),i.jsx("span",{className:"text-[10px] font-black font-mono text-gray-400 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded border border-white/5",children:a})]}),i.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Deck Performance"})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 custom-scrollbar",children:i.jsx(Y7e,{cards:r})}),i.jsx("div",{className:"p-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0",children:i.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Analytics"})})]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body):null},X7e=({isOpen:t,onClose:e,deck:r,cards:n=[],onStrategyUpdate:s})=>{const{userProfile:a,currentUser:o}=Cr(),{addToast:l}=Tn(),c=a?.settings?.helper?.name||"The Oracle",[u,h]=Ie.useState(!1),[f,m]=Ie.useState(0),[g,y]=Ie.useState(!1),[v,w]=Ie.useState(r.notes||""),[N,k]=Ie.useState(!1),[C,I]=Ie.useState(!!(r.notes&&r.notes.length>0)),O=async()=>{if(v!==(r.notes||"")){k(!0);try{await al.updateDeck(o.uid,r.id,{notes:v}),l("Notes saved","success"),s&&s()}catch(Z){console.error(Z),l("Failed to save notes","error")}finally{k(!1)}}};if(Ie.useEffect(()=>(t?(m(0),y(!1),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t||!r)return null;const L=r.aiBlueprint||{},_=L.strategy||`<p class="text-gray-400 italic">No strategy generated for this deck yet. Ask ${c} to analyze it.</p>`,E=L.theme||"Uncharted Strategy",M=[r.commander];r.commander_partner&&M.push(r.commander_partner);const B=M[f]||M[0],S=B?.card_faces?.length>1,P=()=>{if(!B)return"https://placehold.co/480x680?text=Commander";if(S){const Z=B.card_faces[g?1:0];return Z.image_uris?.art_crop||Z.image_uris?.large||Z.image_uris?.normal}return B.image_uris?.art_crop||B.image_uris?.large||B.image_uris?.normal||B.image_uri},R=L.layout?.functional||L.suggestedCounts||{},V=L.layout?.types||L.typeCounts||{},ee=An(a?.subscription_tier).features.aiStrategy,G=!!L.strategy,J=async()=>{if(!a?.settings?.geminiApiKey){l("Gemini API Key missing in settings.","error");return}h(!0);try{console.log("[DeckStrategy] requesting new strategy..."),console.log("[DeckStrategy] Raw Deck:",r),console.log("[DeckStrategy] User Profile:",a);const se=[r.commander,r.commander_partner].filter(Boolean).map(H=>{const re=H.name||H.data?.name||"Unknown",ae=H.mana_cost||H.cmc||H.data?.mana_cost||H.data?.cmc||"0",xe=H.type_line||H.data?.type_line||"Legendary Creature",Ne=H.oracle_text||H.data?.oracle_text||"";return{name:re,mana_cost:ae,type_line:xe,oracle_text:Ne}});console.log("[DeckStrategy] sanitizedCommanders:",se);let X=a.playstyle||a.settings?.playstyle||a.data?.playstyle||null;!X&&a.data&&a.data.playstyle&&(X=a.data.playstyle),X?console.log("[DeckStrategy] playstyle found:",X):(console.warn("[DeckStrategy] User playstyle NOT found. Profile keys:",Object.keys(a)),X={summary:"Balanced Magic player enjoying strategic depth and interaction.",archetypes:["Midrange","Control"],scores:{aggression:5}});const q=await Nl.getDeckStrategy(a.settings.geminiApiKey,se,X,n,a?.settings?.helper,a);console.log("[DeckStrategy] new strategy received:",q);const U=await al.updateDeck(o.uid,r.id,{aiBlueprint:{...L,theme:q.theme,strategy:q.strategy,layout:q.layout}});console.log("[DeckStrategy] update response:",U),l("Strategy updated based on your current build!","success"),await new Promise(H=>setTimeout(H,500)),s&&await s()}catch(Z){console.error("[DeckStrategy] Rerun Error:",Z),l("Failed to rerun strategy analysis.","error")}finally{h(!1)}};return o_.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[i.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-5xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),i.jsx("div",{className:"absolute -top-[20%] -right-[10%] w-[500px] h-[500px] bg-indigo-500/10 rounded-full blur-[100px] pointer-events-none"}),i.jsx("div",{className:"absolute -bottom-[20%] -left-[10%] w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none"}),i.jsxs("div",{className:"px-4 py-6 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[i.jsxs("div",{className:"flex items-center gap-4 md:gap-6 w-full md:w-auto",children:[i.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm",children:i.jsx("span",{className:"text-3xl",children:""})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-3xl font-black text-white tracking-tighter uppercase leading-none mb-1",dangerouslySetInnerHTML:{__html:E}}),i.jsxs("p",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.3em]",children:[c," Strategic Blueprint"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 md:gap-4 w-full md:w-auto justify-end",children:[i.jsxs("button",{onClick:ee?J:()=>l(`Upgrade to ${ta[lr.TIER_2].name} to use AI Strategy tools.`,"info"),disabled:u||!ee,className:`flex-1 md:flex-none flex items-center justify-center gap-2 md:gap-3 px-4 md:px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all border ${u||!ee?"bg-white/5 text-gray-500 border-white/5 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white border-white/20 shadow-[0_0_20px_rgba(79,70,229,0.3)] hover:shadow-[0_0_30px_rgba(79,70,229,0.5)] active:scale-95"}`,title:ee?"":`Requires ${ta[lr.TIER_2].name} Tier`,children:[u?i.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),i.jsx("span",{className:"md:hidden",children:u?"Consulting...":"Recreate"}),i.jsx("span",{className:"hidden md:inline",children:u?`Consulting with ${c}...`:`Have ${c} Recreate Strategy`})]}),i.jsx("div",{className:"w-px h-8 bg-white/10 mx-2"}),i.jsx("button",{onClick:e,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl transition-all text-gray-400 hover:text-white border border-white/5 hover:border-white/10 group",children:i.jsx("svg",{className:"w-6 h-6 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto px-10 py-10 custom-scrollbar space-y-12 relative z-10 overscroll-contain",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12",children:[i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"sticky top-0 space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl rounded-[2rem] group-hover:bg-indigo-500/30 transition-all duration-700"}),i.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden shadow-2xl border border-white/10 z-10 bg-black/40",children:[i.jsx("img",{src:P(),className:"w-full h-full object-cover transition-transform duration-700 active:scale-95",alt:B?.name}),S&&i.jsx("button",{onClick:()=>y(!g),className:"absolute top-4 right-4 p-3 bg-black/60 hover:bg-indigo-600 backdrop-blur-md rounded-full text-white border border-white/20 shadow-lg transition-all group/flip z-30",title:"Flip Card",children:i.jsx("svg",{className:`w-5 h-5 transition-transform duration-500 ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),i.jsx("div",{className:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:i.jsxs("div",{className:"text-white font-bold text-center text-sm leading-tight drop-shadow-md",children:[B.name,S&&i.jsx("span",{className:"block text-[9px] text-gray-400 font-normal mt-0.5 uppercase tracking-widest",children:g?"Back Face":"Front Face"})]})})]}),i.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20",children:i.jsxs("div",{className:"bg-black/80 text-white px-5 py-2 rounded-full border border-white/10 shadow-xl backdrop-blur-md flex items-center gap-2 whitespace-nowrap",children:[i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Cards"}),i.jsx("div",{className:"w-px h-3 bg-white/20"}),i.jsxs("span",{className:"text-sm font-black font-mono",children:[(n||[]).length,"/100"]})]})})]}),i.jsxs("div",{className:"text-center pt-4 space-y-4",children:[i.jsxs("div",{onClick:()=>{m(0),y(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${f===0?"bg-indigo-500/10 border-indigo-500/30":"border-transparent hover:bg-white/5"}`,children:[i.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${f===0?"text-indigo-400":"text-gray-600"}`,children:"Lead Commander"}),i.jsx("div",{className:`font-bold text-sm leading-tight ${f===0?"text-white":"text-gray-400"}`,children:M[0]?.name})]}),M[1]&&i.jsxs("div",{onClick:()=>{m(1),y(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${f===1?"bg-purple-500/10 border-purple-500/30":"border-transparent hover:bg-white/5"}`,children:[i.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${f===1?"text-purple-400":"text-gray-600"}`,children:"Partnered With"}),i.jsx("div",{className:`font-bold text-sm leading-tight ${f===1?"text-white":"text-gray-400"}`,children:M[1].name})]})]})]})}),i.jsxs("div",{className:"space-y-10",children:[i.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[i.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:i.jsx("span",{className:"text-9xl",children:""})}),i.jsx("button",{onClick:()=>I(!C),className:"w-full text-left focus:outline-none group/header",children:i.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[i.jsx("span",{className:"w-8 h-px bg-gray-700 transition-colors group-hover/header:bg-indigo-500"}),"Deck Notes",i.jsx("span",{className:`transform transition-transform duration-300 ${C?"rotate-180":""}`,children:i.jsx("svg",{className:"w-4 h-4 text-gray-500 group-hover/header:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),N&&i.jsx("span",{className:"text-indigo-400 animate-pulse ml-2 text-[9px]",children:"Saving..."})]})}),C&&i.jsx("textarea",{value:v,onChange:Z=>w(Z.target.value),onBlur:O,placeholder:"Add your own notes about card choices, combos, or future upgrade plans...",className:"w-full bg-transparent border-0 text-gray-300 placeholder-gray-600 focus:ring-0 resize-none h-32 leading-relaxed animate-fade-in origin-top"})]}),i.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[i.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:i.jsx("span",{className:"text-9xl",children:""})}),i.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[i.jsx("span",{className:"w-8 h-px bg-gray-700"}),G||ee?"Tactical Overview":`Tactical Overview (Requires ${ta[lr.TIER_2].name})`]}),i.jsx("div",{className:"text-gray-300 leading-relaxed strategy-content-refined font-medium text-lg/8",dangerouslySetInnerHTML:{__html:G||ee?_:`<p class="italic text-gray-500">Strategy generation is available on the ${ta[lr.TIER_2].name} tier. Upgrade to unlock deep strategic insights for your deck.</p>`}})]}),i.jsxs("div",{className:"space-y-8",children:[Object.keys(R).length>0&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),"Target Functional Needs"]}),i.jsx("div",{className:"gap-3 grid grid-cols-1",children:Object.entries(R).map(([Z,se])=>i.jsxs("div",{className:"group relative h-8 bg-white/5 rounded-lg overflow-hidden flex items-center",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 group-hover:bg-indigo-500/30 transition-all duration-1000 ease-out rounded-r-lg",style:{width:`${Math.min(100,se/40*100)}%`}}),i.jsxs("div",{className:"relative z-10 w-full flex justify-between px-4 text-xs font-bold items-center",children:[i.jsx("span",{className:"uppercase tracking-wider text-gray-400 group-hover:text-white transition-colors",children:Z}),i.jsx("span",{className:"font-mono text-indigo-300",children:se})]})]},Z))})]}),Object.keys(V).length>0&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"text-[10px] font-black text-purple-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Target Type Distribution"]}),i.jsx("div",{className:"gap-3 grid grid-cols-1",children:Object.entries(V).map(([Z,se])=>i.jsxs("div",{className:"group relative h-8 bg-white/5 rounded-lg overflow-hidden flex items-center",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 bg-purple-500/20 group-hover:bg-purple-500/30 transition-all duration-1000 ease-out rounded-r-lg",style:{width:`${Math.min(100,se/40*100)}%`}}),i.jsxs("div",{className:"relative z-10 w-full flex justify-between px-4 text-xs font-bold items-center",children:[i.jsx("span",{className:"uppercase tracking-wider text-gray-400 group-hover:text-white transition-colors",children:Z}),i.jsx("span",{className:"font-mono text-purple-300",children:se})]})]},Z))})]})]})]})]})}),i.jsx("div",{className:"px-10 py-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0 relative z-10",children:i.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Blueprint"})})]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .strategy-content-refined h4 {
                    font-size: 1.1rem;
                    font-weight: 800;
                    color: white;
                    margin-top: 1.5rem;
                    margin-bottom: 0.5rem;
                }
                .strategy-content-refined p {
                    margin-bottom: 1rem;
                }
                .strategy-content-refined strong {
                    color: #a5b4fc; /* Indigo 300 */
                }
                .strategy-content-refined ul {
                    list-style-type: disc;
                    padding-left: 1.5rem;
                    margin-bottom: 1rem;
                    color: #9ca3af;
                }
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body)},Q7e=({isOpen:t,onClose:e,deck:r,onUpdateDeck:n})=>{const{user:s}=Cr(),[a,o]=b.useState([]),[l,c]=b.useState([]),[u,h]=b.useState(!0),[f,m]=b.useState(!1),[g,y]=b.useState(""),[v,w]=b.useState(!1),[N,k]=b.useState(""),[C,I]=b.useState("viewer"),[O,L]=b.useState(!1);b.useEffect(()=>{t&&r&&(E(),m(r.is_public||!1),y(r.share_slug||_(r.name)))},[t,r]);const _=R=>R.toLowerCase().replace(/[^a-z0-9]+/g,"-")+"-"+Math.random().toString(36).substring(2,6),E=async()=>{h(!0);try{const R=await Ka.fetchPermissions(r.id);o(R);const ee=(await Ka.fetchRelationships()).filter(G=>G.status==="accepted").map(G=>G.friend);c(ee)}catch(R){console.error("Failed to load share data",R)}finally{h(!1)}},M=async R=>{if(R.preventDefault(),!!N){L(!0);try{await Ka.grantPermission(N,C,r.id),await E(),k("")}catch(V){alert(`Failed to share: ${V.message}`)}finally{L(!1)}}},B=async R=>{try{await Ka.revokePermission(R),await E()}catch{alert("Failed to revoke access.")}},S=async()=>{const R=!f,V=g||_(r.name);try{await Ka.updateDeckPublicStatus(r.id,R,V),m(R),y(V),n({...r,is_public:R,share_slug:V})}catch{alert("Failed to update public status.")}},P=()=>{const R=window.location.origin;navigator.clipboard.writeText(`${R}/share/${g}`),w(!0),setTimeout(()=>w(!1),2e3)};return t?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 border border-indigo-500/20 rounded-2xl w-full max-w-lg shadow-2xl p-6 animate-fade-in-up",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),i.jsx("p",{className:"text-sm text-gray-400 mb-6 truncate",children:r?.name}),i.jsxs("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl p-4 mb-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${f?"bg-green-500":"bg-gray-500"}`}),i.jsx("span",{className:"font-bold text-gray-200",children:"Public Link"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:f,onChange:S}),i.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500"})]})]}),f&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/share/${g}`,className:"flex-1 bg-gray-950 border border-gray-700 rounded-lg px-3 py-2 text-xs text-gray-300 select-all"}),i.jsx("button",{onClick:P,className:"px-3 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-colors",children:v?"Copied!":"Copy"})]}),i.jsx("div",{className:"flex justify-center p-4 bg-white rounded-xl w-fit mx-auto shadow-lg",children:i.jsx(nne,{value:`${window.location.origin}/share/${g}`,size:128,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 128 128"})}),i.jsx("p",{className:"text-center text-[10px] text-gray-400",children:"Scan to view on mobile"})]}),i.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:f?"Anyone with this link can view this deck.":"Only people you explicitly add below can access this deck."})]}),i.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest mb-3",children:"Add People"}),i.jsxs("form",{onSubmit:M,className:"flex gap-2 mb-6",children:[i.jsxs("select",{value:N,onChange:R=>k(R.target.value),className:"flex-1 bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",required:!0,children:[i.jsx("option",{value:"",children:"Select a friend..."}),l.map(R=>i.jsx("option",{value:R.id,children:R.username},R.id))]}),i.jsxs("select",{value:C,onChange:R=>I(R.target.value),className:"bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",children:[i.jsx("option",{value:"viewer",children:"Viewer"}),i.jsx("option",{value:"contributor",children:"Contributor"}),i.jsx("option",{value:"editor",children:"Editor"})]}),i.jsx("button",{type:"submit",disabled:O||!N,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Add"})]}),i.jsx("div",{className:"space-y-4 max-h-[200px] overflow-y-auto",children:a.length===0?i.jsx("p",{className:"text-center text-gray-500 text-xs italic py-4",children:"No specific people have access."}):a.map(R=>i.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 text-xs font-bold",children:R.grantee_username?.[0]?.toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-bold text-gray-200",children:R.grantee_username}),i.jsx("div",{className:"text-xs text-gray-500 capitalize",children:R.permission_level})]})]}),i.jsx("button",{onClick:()=>B(R.id),className:"text-red-400 hover:text-red-300 text-xs font-bold px-2 py-1 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Remove"})]},R.id))})]})]}):null},nae=({isOpen:t,onClose:e,deck:r,cards:n,isOwner:s})=>{const{userProfile:a,currentUser:o}=Cr(),{addToast:l}=Tn();yn();const c=a?.settings?.helper?.name||"The Oracle",[u,h]=b.useState(!1),[f,m]=b.useState(r?.aiBlueprint?.grade||null),[g,y]=b.useState(!1);if(Ie.useEffect(()=>{t&&r?.aiBlueprint?.grade&&m(r.aiBlueprint.grade)},[t,r]),!t)return null;const v=async()=>{h(!0);try{const w=a?.settings?.geminiApiKey;if(!w){l("Please save your API Key in Settings > AI first.","error"),h(!1);return}const N=await Nl.gradeDeck(w,{deckName:r.name,commander:r.commander?.name||"Unknown",cards:n,playerProfile:"Competitive but casual friendly",strategyGuide:r.description||"General synergy",helperPersona:a?.settings?.helper},a);if(m(N),s){const k={...r.aiBlueprint,grade:N,lastDiagnosed:new Date().toISOString()};await al.updateDeck(o.uid,r.id,{aiBlueprint:k}),l("Power Level Calibrated & Saved!","success")}}catch(w){console.error(w),l("Doctor is out. Try again later.","error")}finally{h(!1)}};return o_.createPortal(i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 w-full max-w-4xl rounded-3xl border border-white/10 shadow-2xl p-8 relative flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"flex justify-between items-start mb-8 relative z-10",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-white italic uppercase",children:"Deck Power Analysis"}),i.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Evaluated by ",c]})]}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white p-2",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.12] saturate-[1.5] brightness-125",children:i.jsx("img",{src:"/icons/deck_doctor.png",alt:"",className:"w-[80%] h-[80%] object-contain"})}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-12 relative z-10",children:[!f&&!u&&i.jsxs("div",{className:"text-center py-20",children:[i.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Ready to calibrate?"}),i.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"This process will analyze every card in your deck to determine its competitive bracket and numerical power level."}),i.jsxs("button",{onClick:v,className:"px-10 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black text-lg rounded-2xl shadow-xl hover:shadow-indigo-500/20 transition-all uppercase tracking-widest flex items-center gap-3 mx-auto",children:[i.jsx("span",{children:"Run Diagnosis"}),i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),u&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-6",children:[i.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-b-4 border-indigo-500"}),i.jsx("p",{className:"text-indigo-400 font-black text-xl animate-pulse uppercase tracking-widest",children:"Simulating Matchups..."})]}),f&&i.jsxs("div",{className:"animate-fade-in space-y-10",children:[i.jsx("div",{className:"text-center",children:i.jsxs("div",{className:"inline-flex flex-col items-center",children:[i.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm mb-2",children:"Power Level"}),i.jsxs("div",{className:"text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 filter drop-shadow-lg",children:[Number(f.powerLevel).toFixed(2),i.jsx("span",{className:"text-3xl text-gray-600 ml-2",children:"/ 10"})]})]})}),i.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto",children:[i.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[i.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[f.metrics.efficiency,i.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),i.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Efficiency"})]}),i.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[i.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[f.metrics.interaction,i.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),i.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Interaction"})]}),i.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[i.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["Turn ",f.metrics.winTurn]}),i.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Avg Win Turn"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"text-center text-gray-500 text-xs font-black uppercase tracking-[0.2em]",children:["Commander Bracket: ",f.commanderBracket]}),i.jsx("div",{className:"grid grid-cols-5 gap-1 h-32 rounded-2xl overflow-hidden border border-white/10",children:[{id:1,label:"Exhibition",desc:"Ultra-Casual",color:"bg-yellow-500/20 text-yellow-500 border-yellow-500/50"},{id:2,label:"Core",desc:"Average Precon",color:"bg-green-500/20 text-green-500 border-green-500/50"},{id:3,label:"Upgraded",desc:"Beyond Precon",color:"bg-blue-500/20 text-blue-500 border-blue-500/50"},{id:4,label:"Optimized",desc:"High Power",color:"bg-orange-500/20 text-orange-500 border-orange-500/50"},{id:5,label:"cEDH",desc:"Competitive",color:"bg-purple-500/20 text-purple-500 border-purple-500/50"}].map(w=>{const N=f.commanderBracket===w.id;return i.jsxs("div",{className:`relative flex flex-col items-center justify-center p-4 border-t-4 transition-all ${N?`bg-gray-800 ${w.color.replace("/20","/10")} border-t-4 border-b-0 border-l-0 border-r-0`:"bg-gray-950 border-gray-800 opacity-40 grayscale"}`,style:{borderColor:N?void 0:"transparent"},children:[N&&i.jsx("div",{className:"absolute top-2 right-2 bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded",children:"MATCH"}),i.jsx("div",{className:`text-2xl font-black mb-1 ${N?w.color.split(" ")[1]:"text-gray-500"}`,children:w.id}),i.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider mb-1",children:w.label}),i.jsx("div",{className:"text-[10px] text-gray-400 text-center leading-tight",children:w.desc})]},w.id)})})]}),i.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-white/5",children:[i.jsx("h4",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:"Bracket Justification"}),i.jsxs("p",{className:"text-gray-300 leading-relaxed italic",children:['"',f.bracketJustification,'"']})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[i.jsx("span",{className:"text-indigo-500",children:""})," Clinical Critique"]}),i.jsx("div",{className:"bg-gray-950/50 p-8 rounded-3xl border border-white/5 shadow-inner",children:i.jsx("div",{className:"text-gray-300 leading-relaxed text-lg font-medium doctor-critique-content",dangerouslySetInnerHTML:{__html:f.critique}})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[i.jsx("span",{className:"text-orange-500",children:""})," Mechanical improvements"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.mechanicalImprovements.map((w,N)=>i.jsxs("div",{className:"flex gap-4 p-5 bg-white/5 rounded-2xl border border-white/5 items-start group hover:bg-orange-500/10 transition-colors",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400 font-bold shrink-0",children:N+1}),i.jsx("p",{className:"text-gray-300 text-sm leading-relaxed group-hover:text-white transition-colors",children:w})]},N))})]}),i.jsxs("div",{className:"space-y-6 pb-12",children:[i.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[i.jsx("span",{className:"text-red-500",children:""})," Surgical Swaps"]}),i.jsx("div",{className:"space-y-4",children:f.recommendedSwaps.map((w,N)=>i.jsxs("div",{className:"p-6 bg-gray-950/50 rounded-3xl border border-white/5 overflow-hidden",children:[i.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[i.jsxs("div",{className:"flex-1 w-full",children:[i.jsx("div",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-2",children:"Cut This Card"}),i.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:i.jsx("span",{className:"text-white font-bold",children:w.remove})})]}),i.jsx("div",{className:"flex items-center justify-center",children:i.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 border border-white/10 flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})}),i.jsxs("div",{className:"flex-1 w-full",children:[i.jsx("div",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-2",children:"Slot This In"}),i.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl text-right",children:i.jsx("span",{className:"text-white font-bold",children:w.add})})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:i.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',w.reason,'"']})})]},N))})]}),i.jsx("div",{className:"flex justify-center pb-12",children:i.jsxs("button",{onClick:v,disabled:u,className:"flex items-center gap-2 px-8 py-3 bg-indigo-900/40 hover:bg-indigo-600/40 text-indigo-300 rounded-xl border border-indigo-500/20 transition-all font-bold uppercase text-xs tracking-widest group",children:[i.jsx("svg",{className:`w-4 h-4 transition-transform duration-700 ${u?"animate-spin":"group-hover:rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),u?"Consulting Oracle...":"Rerun Diagnosis"]})})]})]})]})}),document.body)},J7e="modulepreload",Z7e=function(t){return"/"+t},fq={},Rj=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let c=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=c(r.map(u=>{if(u=Z7e(u),u in fq)return;fq[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":J7e,h||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((g,y)=>{m.addEventListener("load",g),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Ns(t){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ns(t)}var md=Uint8Array,Ic=Uint16Array,LM=Int32Array,OM=new md([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),MM=new md([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pq=new md([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sae=function(t,e){for(var r=new Ic(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new LM(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},iae=sae(OM,2),eDe=iae.b,P8=iae.r;eDe[28]=258,P8[258]=28;var tDe=sae(MM,0),mq=tDe.r,L8=new Ic(32768);for(var ci=0;ci<32768;++ci){var A0=(ci&43690)>>1|(ci&21845)<<1;A0=(A0&52428)>>2|(A0&13107)<<2,A0=(A0&61680)>>4|(A0&3855)<<4,L8[ci]=((A0&65280)>>8|(A0&255)<<8)>>1}var R1=(function(t,e,r){for(var n=t.length,s=0,a=new Ic(e);s<n;++s)t[s]&&++a[t[s]-1];var o=new Ic(e);for(s=1;s<e;++s)o[s]=o[s-1]+a[s-1]<<1;var l;if(r){l=new Ic(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],h=e-t[s],f=o[t[s]-1]++<<h,m=f|(1<<h)-1;f<=m;++f)l[L8[f]>>c]=u}else for(l=new Ic(n),s=0;s<n;++s)t[s]&&(l[s]=L8[o[t[s]-1]++]>>15-t[s]);return l}),sg=new md(288);for(var ci=0;ci<144;++ci)sg[ci]=8;for(var ci=144;ci<256;++ci)sg[ci]=9;for(var ci=256;ci<280;++ci)sg[ci]=7;for(var ci=280;ci<288;++ci)sg[ci]=8;var J4=new md(32);for(var ci=0;ci<32;++ci)J4[ci]=5;var rDe=R1(sg,9,0),nDe=R1(J4,5,0),aae=function(t){return(t+7)/8|0},sDe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new md(t.subarray(e,r))},Gh=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Mv=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},yA=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:lae,l:0};if(s==1){var o=new md(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(O,L){return O.f-L.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,h=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=s-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=h&&r[u].f<r[f].f?u++:f++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var m=a[0].s,n=1;n<s;++n)a[n].s>m&&(m=a[n].s);var g=new Ic(m+1),y=O8(r[h-1],g,0);if(y>e){var n=0,v=0,w=y-e,N=1<<w;for(a.sort(function(L,_){return g[_.s]-g[L.s]||L.f-_.f});n<s;++n){var k=a[n].s;if(g[k]>e)v+=N-(1<<y-g[k]),g[k]=e;else break}for(v>>=w;v>0;){var C=a[n].s;g[C]<e?v-=1<<e-g[C]++-1:++n}for(;n>=0&&v;--n){var I=a[n].s;g[I]==e&&(--g[I],++v)}y=e}return{t:new md(g),l:y}},O8=function(t,e,r){return t.s==-1?Math.max(O8(t.l,e,r+1),O8(t.r,e,r+1)):e[t.s]=r},gq=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ic(++e),n=0,s=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},Rv=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},oae=function(t,e,r){var n=r.length,s=aae(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},xq=function(t,e,r,n,s,a,o,l,c,u,h){Gh(e,h++,r),++s[256];for(var f=yA(s,15),m=f.t,g=f.l,y=yA(a,15),v=y.t,w=y.l,N=gq(m),k=N.c,C=N.n,I=gq(v),O=I.c,L=I.n,_=new Ic(19),E=0;E<k.length;++E)++_[k[E]&31];for(var E=0;E<O.length;++E)++_[O[E]&31];for(var M=yA(_,7),B=M.t,S=M.l,P=19;P>4&&!B[pq[P-1]];--P);var R=u+5<<3,V=Rv(s,sg)+Rv(a,J4)+o,ee=Rv(s,m)+Rv(a,v)+o+14+3*P+Rv(_,B)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&R<=V&&R<=ee)return oae(e,h,t.subarray(c,c+u));var G,J,Z,se;if(Gh(e,h,1+(ee<V)),h+=2,ee<V){G=R1(m,g,0),J=m,Z=R1(v,w,0),se=v;var X=R1(B,S,0);Gh(e,h,C-257),Gh(e,h+5,L-1),Gh(e,h+10,P-4),h+=14;for(var E=0;E<P;++E)Gh(e,h+3*E,B[pq[E]]);h+=3*P;for(var q=[k,O],U=0;U<2;++U)for(var H=q[U],E=0;E<H.length;++E){var re=H[E]&31;Gh(e,h,X[re]),h+=B[re],re>15&&(Gh(e,h,H[E]>>5&127),h+=H[E]>>12)}}else G=rDe,J=sg,Z=nDe,se=J4;for(var E=0;E<l;++E){var ae=n[E];if(ae>255){var re=ae>>18&31;Mv(e,h,G[re+257]),h+=J[re+257],re>7&&(Gh(e,h,ae>>23&31),h+=OM[re]);var xe=ae&31;Mv(e,h,Z[xe]),h+=se[xe],xe>3&&(Mv(e,h,ae>>5&8191),h+=MM[xe])}else Mv(e,h,G[ae]),h+=J[ae]}return Mv(e,h,G[256]),h+J[256]},iDe=new LM([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lae=new md(0),aDe=function(t,e,r,n,s,a){var o=a.z||t.length,l=new md(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),u=a.l,h=(a.r||0)&7;if(e){h&&(c[0]=a.r>>3);for(var f=iDe[e-1],m=f>>13,g=f&8191,y=(1<<r)-1,v=a.p||new Ic(32768),w=a.h||new Ic(y+1),N=Math.ceil(r/3),k=2*N,C=function(_e){return(t[_e]^t[_e+1]<<N^t[_e+2]<<k)&y},I=new LM(25e3),O=new Ic(288),L=new Ic(32),_=0,E=0,M=a.i||0,B=0,S=a.w||0,P=0;M+2<o;++M){var R=C(M),V=M&32767,ee=w[R];if(v[V]=ee,w[R]=V,S<=M){var G=o-M;if((_>7e3||B>24576)&&(G>423||!u)){h=xq(t,c,0,I,O,L,E,B,P,M-P,h),B=_=E=0,P=M;for(var J=0;J<286;++J)O[J]=0;for(var J=0;J<30;++J)L[J]=0}var Z=2,se=0,X=g,q=V-ee&32767;if(G>2&&R==C(M-q))for(var U=Math.min(m,G)-1,H=Math.min(32767,M),re=Math.min(258,G);q<=H&&--X&&V!=ee;){if(t[M+Z]==t[M+Z-q]){for(var ae=0;ae<re&&t[M+ae]==t[M+ae-q];++ae);if(ae>Z){if(Z=ae,se=q,ae>U)break;for(var xe=Math.min(q,ae-2),Ne=0,J=0;J<xe;++J){var pe=M-q+J&32767,K=v[pe],ue=pe-K&32767;ue>Ne&&(Ne=ue,ee=pe)}}}V=ee,ee=v[V],q+=V-ee&32767}if(se){I[B++]=268435456|P8[Z]<<18|mq[se];var fe=P8[Z]&31,he=mq[se]&31;E+=OM[fe]+MM[he],++O[257+fe],++L[he],S=M+Z,++_}else I[B++]=t[M],++O[t[M]]}}for(M=Math.max(M,S);M<o;++M)I[B++]=t[M],++O[t[M]];h=xq(t,c,u,I,O,L,E,B,P,M-P,h),u||(a.r=h&7|c[h/8|0]<<3,h-=7,a.h=w,a.p=v,a.i=M,a.w=S)}else{for(var M=a.w||0;M<o+u;M+=65535){var le=M+65535;le>=o&&(c[h/8|0]=u,le=o),h=oae(c,h+1,t.subarray(M,le))}a.i=o}return sDe(l,0,n+aae(h)+s)},cae=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},oDe=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new md(a.length+t.length);o.set(a),o.set(t,a.length),t=o,s.w=a.length}return aDe(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},uae=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},lDe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=cae();s.p(e.dictionary),uae(t,2,s.d())}};function M8(t,e){e||(e={});var r=cae();r.p(t);var n=oDe(t,e,e.dictionary?6:2,4);return lDe(n,e),uae(n,n.length-4,r.d()),n}var cDe=typeof TextDecoder<"u"&&new TextDecoder,uDe=0;try{cDe.decode(lae,{stream:!0}),uDe=1}catch{}function dDe(t){if(Array.isArray(t))return t}function hDe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function yq(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function fDe(t,e){if(t){if(typeof t=="string")return yq(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yq(t,e):void 0}}function pDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bq(t,e){return dDe(t)||hDe(t,e)||fDe(t,e)||pDe()}function vq(t,e="utf8"){return new TextDecoder(e).decode(t)}const mDe=new TextEncoder;function gDe(t){return mDe.encode(t)}const xDe=1024*8,yDe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),bA={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class RM{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=xDe,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=r.offset?r.offset>>>0:0,a=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof RM)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=bA[r].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===yDe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new bA[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new bA[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return vq(this.readBytes(e))}decodeText(e=1,r="utf8"){return vq(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(gDe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function vb(t){let e=t.length;for(;--e>=0;)t[e]=0}const bDe=3,vDe=258,dae=29,wDe=256,NDe=wDe+1+dae,hae=30,jDe=512,kDe=new Array((NDe+2)*2);vb(kDe);const _De=new Array(hae*2);vb(_De);const SDe=new Array(jDe);vb(SDe);const CDe=new Array(vDe-bDe+1);vb(CDe);const EDe=new Array(dae);vb(EDe);const ADe=new Array(hae);vb(ADe);const TDe=(t,e,r,n)=>{let s=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0};var R8=TDe;const IDe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},PDe=new Uint32Array(IDe()),LDe=(t,e,r,n)=>{const s=PDe,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var Bd=LDe,D8={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fae={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const ODe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var MDe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)ODe(r,n)&&(t[n]=r[n])}}return t},RDe=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,a=t.length;n<a;n++){let o=t[n];r.set(o,s),s+=o.length}return r},pae={assign:MDe,flattenChunks:RDe};let mae=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{mae=!1}const k2=new Uint8Array(256);for(let t=0;t<256;t++)k2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;k2[254]=k2[254]=1;var DDe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,a,o=t.length,l=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,s=0;a<l;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const BDe=(t,e)=>{if(e<65534&&t.subarray&&mae)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var FDe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){a[s++]=o;continue}let l=k2[o];if(l>4){a[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[s++]=65533;continue}o<65536?a[s++]=o:(o-=65536,a[s++]=55296|o>>10&1023,a[s++]=56320|o&1023)}return BDe(a,s)},$De=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+k2[t[r]]>e?r:e},B8={string2buf:DDe,buf2string:FDe,utf8border:$De};function UDe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zDe=UDe;const SN=16209,VDe=16191;var qDe=function(e,r){let n,s,a,o,l,c,u,h,f,m,g,y,v,w,N,k,C,I,O,L,_,E,M,B;const S=e.state;n=e.next_in,M=e.input,s=n+(e.avail_in-5),a=e.next_out,B=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=S.dmax,u=S.wsize,h=S.whave,f=S.wnext,m=S.window,g=S.hold,y=S.bits,v=S.lencode,w=S.distcode,N=(1<<S.lenbits)-1,k=(1<<S.distbits)-1;e:do{y<15&&(g+=M[n++]<<y,y+=8,g+=M[n++]<<y,y+=8),C=v[g&N];t:for(;;){if(I=C>>>24,g>>>=I,y-=I,I=C>>>16&255,I===0)B[a++]=C&65535;else if(I&16){O=C&65535,I&=15,I&&(y<I&&(g+=M[n++]<<y,y+=8),O+=g&(1<<I)-1,g>>>=I,y-=I),y<15&&(g+=M[n++]<<y,y+=8,g+=M[n++]<<y,y+=8),C=w[g&k];r:for(;;){if(I=C>>>24,g>>>=I,y-=I,I=C>>>16&255,I&16){if(L=C&65535,I&=15,y<I&&(g+=M[n++]<<y,y+=8,y<I&&(g+=M[n++]<<y,y+=8)),L+=g&(1<<I)-1,L>c){e.msg="invalid distance too far back",S.mode=SN;break e}if(g>>>=I,y-=I,I=a-o,L>I){if(I=L-I,I>h&&S.sane){e.msg="invalid distance too far back",S.mode=SN;break e}if(_=0,E=m,f===0){if(_+=u-I,I<O){O-=I;do B[a++]=m[_++];while(--I);_=a-L,E=B}}else if(f<I){if(_+=u+f-I,I-=f,I<O){O-=I;do B[a++]=m[_++];while(--I);if(_=0,f<O){I=f,O-=I;do B[a++]=m[_++];while(--I);_=a-L,E=B}}}else if(_+=f-I,I<O){O-=I;do B[a++]=m[_++];while(--I);_=a-L,E=B}for(;O>2;)B[a++]=E[_++],B[a++]=E[_++],B[a++]=E[_++],O-=3;O&&(B[a++]=E[_++],O>1&&(B[a++]=E[_++]))}else{_=a-L;do B[a++]=B[_++],B[a++]=B[_++],B[a++]=B[_++],O-=3;while(O>2);O&&(B[a++]=B[_++],O>1&&(B[a++]=B[_++]))}}else if((I&64)===0){C=w[(C&65535)+(g&(1<<I)-1)];continue r}else{e.msg="invalid distance code",S.mode=SN;break e}break}}else if((I&64)===0){C=v[(C&65535)+(g&(1<<I)-1)];continue t}else if(I&32){S.mode=VDe;break e}else{e.msg="invalid literal/length code",S.mode=SN;break e}break}}while(n<s&&a<l);O=y>>3,n-=O,y-=O<<3,g&=(1<<y)-1,e.next_in=n,e.next_out=a,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=a<l?257+(l-a):257-(a-l),S.hold=g,S.bits=y};const _x=15,wq=852,Nq=592,jq=0,vA=1,kq=2,HDe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),WDe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),GDe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),KDe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),YDe=(t,e,r,n,s,a,o,l)=>{const c=l.bits;let u=0,h=0,f=0,m=0,g=0,y=0,v=0,w=0,N=0,k=0,C,I,O,L,_,E=null,M;const B=new Uint16Array(_x+1),S=new Uint16Array(_x+1);let P=null,R,V,ee;for(u=0;u<=_x;u++)B[u]=0;for(h=0;h<n;h++)B[e[r+h]]++;for(g=c,m=_x;m>=1&&B[m]===0;m--);if(g>m&&(g=m),m===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<m&&B[f]===0;f++);for(g<f&&(g=f),w=1,u=1;u<=_x;u++)if(w<<=1,w-=B[u],w<0)return-1;if(w>0&&(t===jq||m!==1))return-1;for(S[1]=0,u=1;u<_x;u++)S[u+1]=S[u]+B[u];for(h=0;h<n;h++)e[r+h]!==0&&(o[S[e[r+h]]++]=h);if(t===jq?(E=P=o,M=20):t===vA?(E=HDe,P=WDe,M=257):(E=GDe,P=KDe,M=0),k=0,h=0,u=f,_=a,y=g,v=0,O=-1,N=1<<g,L=N-1,t===vA&&N>wq||t===kq&&N>Nq)return 1;for(;;){R=u-v,o[h]+1<M?(V=0,ee=o[h]):o[h]>=M?(V=P[o[h]-M],ee=E[o[h]-M]):(V=96,ee=0),C=1<<u-v,I=1<<y,f=I;do I-=C,s[_+(k>>v)+I]=R<<24|V<<16|ee|0;while(I!==0);for(C=1<<u-1;k&C;)C>>=1;if(C!==0?(k&=C-1,k+=C):k=0,h++,--B[u]===0){if(u===m)break;u=e[r+o[h]]}if(u>g&&(k&L)!==O){for(v===0&&(v=g),_+=f,y=u-v,w=1<<y;y+v<m&&(w-=B[y+v],!(w<=0));)y++,w<<=1;if(N+=1<<y,t===vA&&N>wq||t===kq&&N>Nq)return 1;O=k&L,s[O]=g<<24|y<<16|_-a|0}}return k!==0&&(s[_+k]=u-v<<24|64<<16|0),l.bits=g,0};var D1=YDe;const XDe=0,gae=1,xae=2,{Z_FINISH:_q,Z_BLOCK:QDe,Z_TREES:CN,Z_OK:ig,Z_STREAM_END:JDe,Z_NEED_DICT:ZDe,Z_STREAM_ERROR:wu,Z_DATA_ERROR:yae,Z_MEM_ERROR:bae,Z_BUF_ERROR:e9e,Z_DEFLATED:Sq}=fae,vS=16180,Cq=16181,Eq=16182,Aq=16183,Tq=16184,Iq=16185,Pq=16186,Lq=16187,Oq=16188,Mq=16189,Z4=16190,Kh=16191,wA=16192,Rq=16193,NA=16194,Dq=16195,Bq=16196,Fq=16197,$q=16198,EN=16199,AN=16200,Uq=16201,zq=16202,Vq=16203,qq=16204,Hq=16205,jA=16206,Wq=16207,Gq=16208,vi=16209,vae=16210,wae=16211,t9e=852,r9e=592,n9e=15,s9e=n9e,Kq=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function i9e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ag=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<vS||e.mode>wae?1:0},Nae=t=>{if(Ag(t))return wu;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=vS,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(t9e),e.distcode=e.distdyn=new Int32Array(r9e),e.sane=1,e.back=-1,ig},jae=t=>{if(Ag(t))return wu;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Nae(t)},kae=(t,e)=>{let r;if(Ag(t))return wu;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?wu:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,jae(t))},_ae=(t,e)=>{if(!t)return wu;const r=new i9e;t.state=r,r.strm=t,r.window=null,r.mode=vS;const n=kae(t,e);return n!==ig&&(t.state=null),n},a9e=t=>_ae(t,s9e);let Yq=!0,kA,_A;const o9e=t=>{if(Yq){kA=new Int32Array(512),_A=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(D1(gae,t.lens,0,288,kA,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;D1(xae,t.lens,0,32,_A,0,t.work,{bits:5}),Yq=!1}t.lencode=kA,t.lenbits=9,t.distcode=_A,t.distbits=5},Sae=(t,e,r,n)=>{let s;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(e.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},l9e=(t,e)=>{let r,n,s,a,o,l,c,u,h,f,m,g,y,v,w=0,N,k,C,I,O,L,_,E;const M=new Uint8Array(4);let B,S;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ag(t)||!t.output||!t.input&&t.avail_in!==0)return wu;r=t.state,r.mode===Kh&&(r.mode=wA),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,h=r.bits,f=l,m=c,E=ig;e:for(;;)switch(r.mode){case vS:if(r.wrap===0){r.mode=wA;break}for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,M[0]=u&255,M[1]=u>>>8&255,r.check=Bd(r.check,M,2,0),u=0,h=0,r.mode=Cq;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=vi;break}if((u&15)!==Sq){t.msg="unknown compression method",r.mode=vi;break}if(u>>>=4,h-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){t.msg="invalid window size",r.mode=vi;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?Mq:Kh,u=0,h=0;break;case Cq:for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.flags=u,(r.flags&255)!==Sq){t.msg="unknown compression method",r.mode=vi;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=vi;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Bd(r.check,M,2,0)),u=0,h=0,r.mode=Eq;case Eq:for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=Bd(r.check,M,4,0)),u=0,h=0,r.mode=Aq;case Aq:for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Bd(r.check,M,2,0)),u=0,h=0,r.mode=Tq;case Tq:if(r.flags&1024){for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Bd(r.check,M,2,0)),u=0,h=0}else r.head&&(r.head.extra=null);r.mode=Iq;case Iq:if(r.flags&1024&&(g=r.length,g>l&&(g=l),g&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+g),_)),r.flags&512&&r.wrap&4&&(r.check=Bd(r.check,n,g,a)),l-=g,a+=g,r.length-=g),r.length))break e;r.length=0,r.mode=Pq;case Pq:if(r.flags&2048){if(l===0)break e;g=0;do _=n[a+g++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&g<l);if(r.flags&512&&r.wrap&4&&(r.check=Bd(r.check,n,g,a)),l-=g,a+=g,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Lq;case Lq:if(r.flags&4096){if(l===0)break e;g=0;do _=n[a+g++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&g<l);if(r.flags&512&&r.wrap&4&&(r.check=Bd(r.check,n,g,a)),l-=g,a+=g,_)break e}else r.head&&(r.head.comment=null);r.mode=Oq;case Oq:if(r.flags&512){for(;h<16;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=vi;break}u=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Kh;break;case Mq:for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}t.adler=r.check=Kq(u),u=0,h=0,r.mode=Z4;case Z4:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,ZDe;t.adler=r.check=1,r.mode=Kh;case Kh:if(e===QDe||e===CN)break e;case wA:if(r.last){u>>>=h&7,h-=h&7,r.mode=jA;break}for(;h<3;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}switch(r.last=u&1,u>>>=1,h-=1,u&3){case 0:r.mode=Rq;break;case 1:if(o9e(r),r.mode=EN,e===CN){u>>>=2,h-=2;break e}break;case 2:r.mode=Bq;break;case 3:t.msg="invalid block type",r.mode=vi}u>>>=2,h-=2;break;case Rq:for(u>>>=h&7,h-=h&7;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=vi;break}if(r.length=u&65535,u=0,h=0,r.mode=NA,e===CN)break e;case NA:r.mode=Dq;case Dq:if(g=r.length,g){if(g>l&&(g=l),g>c&&(g=c),g===0)break e;s.set(n.subarray(a,a+g),o),l-=g,a+=g,c-=g,o+=g,r.length-=g;break}r.mode=Kh;break;case Bq:for(;h<14;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.nlen=(u&31)+257,u>>>=5,h-=5,r.ndist=(u&31)+1,u>>>=5,h-=5,r.ncode=(u&15)+4,u>>>=4,h-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=vi;break}r.have=0,r.mode=Fq;case Fq:for(;r.have<r.ncode;){for(;h<3;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.lens[P[r.have++]]=u&7,u>>>=3,h-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},E=D1(XDe,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,E){t.msg="invalid code lengths set",r.mode=vi;break}r.have=0,r.mode=$q;case $q:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[u&(1<<r.lenbits)-1],N=w>>>24,k=w>>>16&255,C=w&65535,!(N<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(C<16)u>>>=N,h-=N,r.lens[r.have++]=C;else{if(C===16){for(S=N+2;h<S;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(u>>>=N,h-=N,r.have===0){t.msg="invalid bit length repeat",r.mode=vi;break}_=r.lens[r.have-1],g=3+(u&3),u>>>=2,h-=2}else if(C===17){for(S=N+3;h<S;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=N,h-=N,_=0,g=3+(u&7),u>>>=3,h-=3}else{for(S=N+7;h<S;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=N,h-=N,_=0,g=11+(u&127),u>>>=7,h-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=vi;break}for(;g--;)r.lens[r.have++]=_}}if(r.mode===vi)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=vi;break}if(r.lenbits=9,B={bits:r.lenbits},E=D1(gae,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,E){t.msg="invalid literal/lengths set",r.mode=vi;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},E=D1(xae,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,E){t.msg="invalid distances set",r.mode=vi;break}if(r.mode=EN,e===CN)break e;case EN:r.mode=AN;case AN:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,qDe(t,m),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,h=r.bits,r.mode===Kh&&(r.back=-1);break}for(r.back=0;w=r.lencode[u&(1<<r.lenbits)-1],N=w>>>24,k=w>>>16&255,C=w&65535,!(N<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(k&&(k&240)===0){for(I=N,O=k,L=C;w=r.lencode[L+((u&(1<<I+O)-1)>>I)],N=w>>>24,k=w>>>16&255,C=w&65535,!(I+N<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=I,h-=I,r.back+=I}if(u>>>=N,h-=N,r.back+=N,r.length=C,k===0){r.mode=Hq;break}if(k&32){r.back=-1,r.mode=Kh;break}if(k&64){t.msg="invalid literal/length code",r.mode=vi;break}r.extra=k&15,r.mode=Uq;case Uq:if(r.extra){for(S=r.extra;h<S;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=zq;case zq:for(;w=r.distcode[u&(1<<r.distbits)-1],N=w>>>24,k=w>>>16&255,C=w&65535,!(N<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if((k&240)===0){for(I=N,O=k,L=C;w=r.distcode[L+((u&(1<<I+O)-1)>>I)],N=w>>>24,k=w>>>16&255,C=w&65535,!(I+N<=h);){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}u>>>=I,h-=I,r.back+=I}if(u>>>=N,h-=N,r.back+=N,k&64){t.msg="invalid distance code",r.mode=vi;break}r.offset=C,r.extra=k&15,r.mode=Vq;case Vq:if(r.extra){for(S=r.extra;h<S;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=vi;break}r.mode=qq;case qq:if(c===0)break e;if(g=m-c,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=vi;break}g>r.wnext?(g-=r.wnext,y=r.wsize-g):y=r.wnext-g,g>r.length&&(g=r.length),v=r.window}else v=s,y=o-r.offset,g=r.length;g>c&&(g=c),c-=g,r.length-=g;do s[o++]=v[y++];while(--g);r.length===0&&(r.mode=AN);break;case Hq:if(c===0)break e;s[o++]=r.length,c--,r.mode=AN;break;case jA:if(r.wrap){for(;h<32;){if(l===0)break e;l--,u|=n[a++]<<h,h+=8}if(m-=c,t.total_out+=m,r.total+=m,r.wrap&4&&m&&(t.adler=r.check=r.flags?Bd(r.check,s,m,o-m):R8(r.check,s,m,o-m)),m=c,r.wrap&4&&(r.flags?u:Kq(u))!==r.check){t.msg="incorrect data check",r.mode=vi;break}u=0,h=0}r.mode=Wq;case Wq:if(r.wrap&&r.flags){for(;h<32;){if(l===0)break e;l--,u+=n[a++]<<h,h+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=vi;break}u=0,h=0}r.mode=Gq;case Gq:E=JDe;break e;case vi:E=yae;break e;case vae:return bae;case wae:default:return wu}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=h,(r.wsize||m!==t.avail_out&&r.mode<vi&&(r.mode<jA||e!==_q))&&Sae(t,t.output,t.next_out,m-t.avail_out),f-=t.avail_in,m-=t.avail_out,t.total_in+=f,t.total_out+=m,r.total+=m,r.wrap&4&&m&&(t.adler=r.check=r.flags?Bd(r.check,s,m,t.next_out-m):R8(r.check,s,m,t.next_out-m)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Kh?128:0)+(r.mode===EN||r.mode===NA?256:0),(f===0&&m===0||e===_q)&&E===ig&&(E=e9e),E},c9e=t=>{if(Ag(t))return wu;let e=t.state;return e.window&&(e.window=null),t.state=null,ig},u9e=(t,e)=>{if(Ag(t))return wu;const r=t.state;return(r.wrap&2)===0?wu:(r.head=e,e.done=!1,ig)},d9e=(t,e)=>{const r=e.length;let n,s,a;return Ag(t)||(n=t.state,n.wrap!==0&&n.mode!==Z4)?wu:n.mode===Z4&&(s=1,s=R8(s,e,r,0),s!==n.check)?yae:(a=Sae(t,e,r,r),a?(n.mode=vae,bae):(n.havedict=1,ig))};var h9e=jae,f9e=kae,p9e=Nae,m9e=a9e,g9e=_ae,x9e=l9e,y9e=c9e,b9e=u9e,v9e=d9e,w9e="pako inflate (from Nodeca project)",Xh={inflateReset:h9e,inflateReset2:f9e,inflateResetKeep:p9e,inflateInit:m9e,inflateInit2:g9e,inflate:x9e,inflateEnd:y9e,inflateGetHeader:b9e,inflateSetDictionary:v9e,inflateInfo:w9e};function N9e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var j9e=N9e;const Cae=Object.prototype.toString,{Z_NO_FLUSH:k9e,Z_FINISH:_9e,Z_OK:_2,Z_STREAM_END:SA,Z_NEED_DICT:CA,Z_STREAM_ERROR:S9e,Z_DATA_ERROR:Xq,Z_MEM_ERROR:C9e}=fae;function kw(t){this.options=pae.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zDe,this.strm.avail_out=0;let r=Xh.inflateInit2(this.strm,e.windowBits);if(r!==_2)throw new Error(D8[r]);if(this.header=new j9e,Xh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=B8.string2buf(e.dictionary):Cae.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Xh.inflateSetDictionary(this.strm,e.dictionary),r!==_2)))throw new Error(D8[r])}kw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?_9e:k9e,Cae.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Xh.inflate(r,o),a===CA&&s&&(a=Xh.inflateSetDictionary(r,s),a===_2?a=Xh.inflate(r,o):a===Xq&&(a=CA));r.avail_in>0&&a===SA&&r.state.wrap>0&&t[r.next_in]!==0;)Xh.inflateReset(r),a=Xh.inflate(r,o);switch(a){case S9e:case Xq:case CA:case C9e:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===SA))if(this.options.to==="string"){let c=B8.utf8border(r.output,r.next_out),u=r.next_out-c,h=B8.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===_2&&l===0)){if(a===SA)return a=Xh.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};kw.prototype.onData=function(t){this.chunks.push(t)};kw.prototype.onEnd=function(t){t===_2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=pae.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function E9e(t,e){const r=new kw(e);if(r.push(t),r.err)throw r.msg||D8[r.err];return r.result}var A9e=kw,T9e=E9e,I9e={Inflate:A9e,inflate:T9e};const{Inflate:P9e,inflate:L9e}=I9e;var Qq=P9e,O9e=L9e;const Eae=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Eae[t]=e}const Jq=4294967295;function M9e(t,e,r){let n=t;for(let s=0;s<r;s++)n=Eae[(n^e[s])&255]^n>>>8;return n}function R9e(t,e){return(M9e(Jq,t,e)^Jq)>>>0}function Zq(t,e,r){const n=t.readUint32(),s=R9e(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function Aae(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function Tae(t,e,r,n){let s=0;for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}function Iae(t,e,r,n){let s=0;if(r.length===0)for(;s<n;s++)e[s]=t[s];else for(;s<n;s++)e[s]=t[s]+r[s]&255}function Pae(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-s]>>1)&255}else{for(;a<s;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-s]+r[a]>>1)&255}}function Lae(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-s]&255}else{for(;a<s;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+D9e(e[a-s],r[a],r[a-s])&255}}function D9e(t,e,r){const n=t+e-r,s=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return s<=a&&s<=o?t:a<=o?e:r}function B9e(t,e,r,n,s,a){switch(t){case 0:Aae(e,r,s);break;case 1:Tae(e,r,s,a);break;case 2:Iae(e,r,n,s);break;case 3:Pae(e,r,n,s,a);break;case 4:Lae(e,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const F9e=new Uint16Array([255]),$9e=new Uint8Array(F9e.buffer),U9e=$9e[0]===255;function z9e(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*s,c=new Uint8Array(n*r*l);let u=0;for(let h=0;h<7;h++){const f=o[h],m=Math.ceil((r-f.x)/f.xStep),g=Math.ceil((n-f.y)/f.yStep);if(m<=0||g<=0)continue;const y=m*l,v=new Uint8Array(y);for(let w=0;w<g;w++){const N=e[u++],k=e.subarray(u,u+y);u+=y;const C=new Uint8Array(y);B9e(N,k,C,v,y,l),v.set(C);for(let I=0;I<m;I++){const O=f.x+I*f.xStep,L=f.y+w*f.yStep;if(!(O>=r||L>=n))for(let _=0;_<l;_++)c[(L*r+O)*l+_]=C[I*l+_]}}}if(a===16){const h=new Uint16Array(c.buffer);if(U9e)for(let f=0;f<h.length;f++)h[f]=V9e(h[f]);return h}else return c}function V9e(t){return(t&255)<<8|t>>8&255}const q9e=new Uint16Array([255]),H9e=new Uint8Array(q9e.buffer),W9e=H9e[0]===255,G9e=new Uint8Array(0);function eH(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=Math.ceil(a/8)*s,l=Math.ceil(a/8*s*r),c=new Uint8Array(n*l);let u=G9e,h=0,f,m;for(let g=0;g<n;g++){switch(f=e.subarray(h+1,h+1+l),m=c.subarray(g*l,(g+1)*l),e[h]){case 0:Aae(f,m,l);break;case 1:Tae(f,m,l,o);break;case 2:Iae(f,m,u,l);break;case 3:Pae(f,m,u,l,o);break;case 4:Lae(f,m,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[h]}`)}u=m,h+=l+1}if(a===16){const g=new Uint16Array(c.buffer);if(W9e)for(let y=0;y<g.length;y++)g[y]=K9e(g[y]);return g}else return c}function K9e(t){return(t&255)<<8|t>>8&255}const Dj=Uint8Array.of(137,80,78,71,13,10,26,10);function tH(t){if(!Y9e(t.readBytes(Dj.length)))throw new Error("wrong PNG signature")}function Y9e(t){if(t.length<Dj.length)return!1;for(let e=0;e<Dj.length;e++)if(t[e]!==Dj[e])return!1;return!0}const X9e="tEXt",Q9e=0,Oae=new TextDecoder("latin1");function J9e(t){if(eBe(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Z9e=/^[\u0000-\u00FF]*$/;function eBe(t){if(!Z9e.test(t))throw new Error("invalid latin1 text")}function tBe(t,e,r){const n=Mae(e);t[n]=rBe(e,r-n.length-1)}function Mae(t){for(t.mark();t.readByte()!==Q9e;);const e=t.offset;t.reset();const r=Oae.decode(t.readBytes(e-t.offset-1));return t.skip(1),J9e(r),r}function rBe(t,e){return Oae.decode(t.readBytes(e))}const _c={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},EA={UNKNOWN:-1,DEFLATE:0},rH={UNKNOWN:-1,ADAPTIVE:0},AA={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},TN={NONE:0,BACKGROUND:1,PREVIOUS:2},TA={SOURCE:0,OVER:1};class nBe extends RM{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new Qq,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=EA.UNKNOWN,this._filterMethod=rH.UNKNOWN,this._interlaceMethod=AA.UNKNOWN,this._colorType=_c.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(tH(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(tH(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case X9e:tBe(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Zq(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Zq(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=sBe(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case _c.GREYSCALE:n=1;break;case _c.TRUECOLOUR:n=3;break;case _c.INDEXED_COLOUR:n=1;break;case _c.GREYSCALE_ALPHA:n=2;break;case _c.TRUECOLOUR_ALPHA:n=4;break;case _c.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==EA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let s=0;s<r;s++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case _c.GREYSCALE:case _c.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case _c.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case _c.UNKNOWN:case _c.GREYSCALE_ALPHA:case _c.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Mae(this),n=this.readUint8();if(n!==EA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const s=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:O9e(s)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=eH({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const s=this._apng.frames.at(e-1);this.disposeFrame(n,s,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case TN.NONE:break;case TN.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let a=0;a<this._png.width;a++){const o=(s*e.width+a)*this._png.channels;for(let l=0;l<this._png.channels;l++)n.data[o+l]=0}break;case TN.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,s=(a,o)=>{const l=((a+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,c=(a*r.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(r.blendOp){case TA.SOURCE:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=s(a,o);for(let u=0;u<this._png.channels;u++)e.data[l+u]=r.data[c+u]}break;case TA.OVER:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=s(a,o);for(let u=0;u<this._png.channels;u++){const h=r.data[c+this._png.channels-1]/n,f=u%(this._png.channels-1)===0?1:r.data[c+u],m=Math.floor(h*f+(1-h)*e.data[l+u]);e.data[l+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==rH.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===AA.NO_INTERLACE)this._png.data=eH({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===AA.ADAM7)this._png.data=z9e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:TN.NONE,blendOp:TA.SOURCE,data:e}),this._inflator=new Qq,this._writingDataChunks=!1}}function sBe(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var nH;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(nH||(nH={}));function iBe(t,e){return new nBe(t,e).decode()}var Jr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function IA(){Jr.console&&typeof Jr.console.log=="function"&&Jr.console.log.apply(Jr.console,arguments)}var qs={log:IA,warn:function(t){Jr.console&&(typeof Jr.console.warn=="function"?Jr.console.warn.apply(Jr.console,arguments):IA.call(null,arguments))},error:function(t){Jr.console&&(typeof Jr.console.error=="function"?Jr.console.error.apply(Jr.console,arguments):IA(t))}};function PA(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){nm(n.response,e,r)},n.onerror=function(){qs.error("could not download file")},n.send()}function sH(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function IN(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var nm=Jr.saveAs||((typeof window>"u"?"undefined":Ns(window))!=="object"||window!==Jr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Jr.URL||Jr.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?sH(s.href)?PA(t,e,r):IN(s,s.target="_blank"):IN(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){IN(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(sH(t))PA(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){IN(n)})}else navigator.msSaveOrOpenBlob((function(s,a){return a===void 0?a={autoBom:!1}:Ns(a)!=="object"&&(qs.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return PA(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(Jr.HTMLElement)||Jr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&a)&&(typeof FileReader>"u"?"undefined":Ns(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=o?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=Jr.URL||Jr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function Rae(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,o=s.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Bj=Jr.atob.bind(Jr),iH=Jr.btoa.bind(Jr);function LA(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=tl(r,n,s,a,e[0],7,-680876936),a=tl(a,r,n,s,e[1],12,-389564586),s=tl(s,a,r,n,e[2],17,606105819),n=tl(n,s,a,r,e[3],22,-1044525330),r=tl(r,n,s,a,e[4],7,-176418897),a=tl(a,r,n,s,e[5],12,1200080426),s=tl(s,a,r,n,e[6],17,-1473231341),n=tl(n,s,a,r,e[7],22,-45705983),r=tl(r,n,s,a,e[8],7,1770035416),a=tl(a,r,n,s,e[9],12,-1958414417),s=tl(s,a,r,n,e[10],17,-42063),n=tl(n,s,a,r,e[11],22,-1990404162),r=tl(r,n,s,a,e[12],7,1804603682),a=tl(a,r,n,s,e[13],12,-40341101),s=tl(s,a,r,n,e[14],17,-1502002290),r=rl(r,n=tl(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=rl(a,r,n,s,e[6],9,-1069501632),s=rl(s,a,r,n,e[11],14,643717713),n=rl(n,s,a,r,e[0],20,-373897302),r=rl(r,n,s,a,e[5],5,-701558691),a=rl(a,r,n,s,e[10],9,38016083),s=rl(s,a,r,n,e[15],14,-660478335),n=rl(n,s,a,r,e[4],20,-405537848),r=rl(r,n,s,a,e[9],5,568446438),a=rl(a,r,n,s,e[14],9,-1019803690),s=rl(s,a,r,n,e[3],14,-187363961),n=rl(n,s,a,r,e[8],20,1163531501),r=rl(r,n,s,a,e[13],5,-1444681467),a=rl(a,r,n,s,e[2],9,-51403784),s=rl(s,a,r,n,e[7],14,1735328473),r=nl(r,n=rl(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=nl(a,r,n,s,e[8],11,-2022574463),s=nl(s,a,r,n,e[11],16,1839030562),n=nl(n,s,a,r,e[14],23,-35309556),r=nl(r,n,s,a,e[1],4,-1530992060),a=nl(a,r,n,s,e[4],11,1272893353),s=nl(s,a,r,n,e[7],16,-155497632),n=nl(n,s,a,r,e[10],23,-1094730640),r=nl(r,n,s,a,e[13],4,681279174),a=nl(a,r,n,s,e[0],11,-358537222),s=nl(s,a,r,n,e[3],16,-722521979),n=nl(n,s,a,r,e[6],23,76029189),r=nl(r,n,s,a,e[9],4,-640364487),a=nl(a,r,n,s,e[12],11,-421815835),s=nl(s,a,r,n,e[15],16,530742520),r=sl(r,n=nl(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=sl(a,r,n,s,e[7],10,1126891415),s=sl(s,a,r,n,e[14],15,-1416354905),n=sl(n,s,a,r,e[5],21,-57434055),r=sl(r,n,s,a,e[12],6,1700485571),a=sl(a,r,n,s,e[3],10,-1894986606),s=sl(s,a,r,n,e[10],15,-1051523),n=sl(n,s,a,r,e[1],21,-2054922799),r=sl(r,n,s,a,e[8],6,1873313359),a=sl(a,r,n,s,e[15],10,-30611744),s=sl(s,a,r,n,e[6],15,-1560198380),n=sl(n,s,a,r,e[13],21,1309151649),r=sl(r,n,s,a,e[4],6,-145523070),a=sl(a,r,n,s,e[11],10,-1120210379),s=sl(s,a,r,n,e[2],15,718787259),n=sl(n,s,a,r,e[9],21,-343485551),t[0]=K0(r,t[0]),t[1]=K0(n,t[1]),t[2]=K0(s,t[2]),t[3]=K0(a,t[3])}function wS(t,e,r,n,s,a){return e=K0(K0(e,t),K0(n,a)),K0(e<<s|e>>>32-s,r)}function tl(t,e,r,n,s,a,o){return wS(e&r|~e&n,t,e,s,a,o)}function rl(t,e,r,n,s,a,o){return wS(e&n|r&~n,t,e,s,a,o)}function nl(t,e,r,n,s,a,o){return wS(e^r^n,t,e,s,a,o)}function sl(t,e,r,n,s,a,o){return wS(r^(e|~n),t,e,s,a,o)}function Dae(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)LA(n,aBe(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(LA(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,LA(n,s),n}function aBe(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var aH="0123456789abcdef".split("");function oBe(t){for(var e="",r=0;r<4;r++)e+=aH[t>>8*r+4&15]+aH[t>>8*r&15];return e}function lBe(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function F8(t){return Dae(t).map(lBe).join("")}var cBe=(function(t){for(var e=0;e<t.length;e++)t[e]=oBe(t[e]);return t.join("")})(Dae("hello"))!="5d41402abc4b2a76b9719d911017c592";function K0(t,e){if(cBe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function $8(t,e){var r,n,s,a;if(t!==r){for(var o=(s=t,a=1+(256/t.length|0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var h=l[c];u=(u+h+o.charCodeAt(c))%256,l[c]=l[u],l[u]=h}r=t,n=l}else l=n;var f=e.length,m=0,g=0,y="";for(c=0;c<f;c++)g=(g+(h=l[m=(m+1)%256]))%256,l[m]=l[g],l[g]=h,o=l[(l[m]+l[g])%256],y+=String.fromCharCode(e.charCodeAt(c)^o);return y}var oH={print:4,modify:8,copy:16,"annot-forms":32};function qx(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(oH.perm!==void 0)throw new Error("Invalid permission: "+l);s+=oH[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^s)),this.encryptionKey=F8(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=$8(this.encryptionKey,this.padding)}function Hx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[n]}return e}function lH(t){if(Ns(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Jr.console&&qs.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function ek(t){if(!(this instanceof ek))return new ek(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Bae(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function fm(t,e,r,n,s){if(!(this instanceof fm))return new fm(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Bae.call(this,n,s)}function Xx(t,e,r,n,s){if(!(this instanceof Xx))return new Xx(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Bae.call(this,n,s)}function Pr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],o=[],l=1,c=16,u="S",h=null;Ns(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,m={},g={internal:{},__private__:{}};g.__private__.PubSub=lH;var y="1.3",v=g.__private__.getPdfVersion=function(){return y};g.__private__.setPdfVersion=function(z){y=z};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var N=g.__private__.getPageFormat=function(z){return w[z]};s=s||"a4";var k="compat",C="advanced",I=k;function O(){this.saveGraphicsState(),oe(new Jt(Rt,0,0,-Rt,0,ti()*Rt).toString()+" cm"),this.setFontSize(this.getFontSize()/Rt),u="n",I=C}function L(){this.restoreGraphicsState(),u="S",I=k}var _=g.__private__.combineFontStyleAndFontWeight=function(z,ce){if(z=="bold"&&ce=="normal"||z=="bold"&&ce==400||z=="normal"&&ce=="italic"||z=="bold"&&ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ce&&(z=ce==400||ce==="normal"?z==="italic"?"italic":"normal":ce!=700&&ce!=="bold"||z!=="normal"?(ce==700?"bold":ce)+""+z:"bold"),z};g.advancedAPI=function(z){var ce=I===k;return ce&&O.call(this),typeof z!="function"||(z(this),ce&&L.call(this)),this},g.compatAPI=function(z){var ce=I===C;return ce&&L.call(this),typeof z!="function"||(z(this),ce&&O.call(this)),this},g.isAdvancedAPI=function(){return I===C};var E,M=function(z){if(I!==C)throw new Error(z+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=g.roundToPrecision=g.__private__.roundToPrecision=function(z,ce){var Se=e||ce;if(isNaN(z)||isNaN(Se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return z.toFixed(Se).replace(/0+$/,"")};E=g.hpf=g.__private__.hpf=typeof c=="number"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return B(z,c)}:c==="smart"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return B(z,z>-1&&z<1?16:5)}:function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return B(z,16)};var S=g.f2=g.__private__.f2=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f2");return B(z,2)},P=g.__private__.f3=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f3");return B(z,3)},R=g.scale=g.__private__.scale=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.scale");return I===k?z*Rt:I===C?z:void 0},V=function(z){return R((function(ce){return I===k?ti()-ce:I===C?ce:void 0})(z))};g.__private__.setPrecision=g.setPrecision=function(z){typeof parseInt(z,10)=="number"&&(e=parseInt(z,10))};var ee,G="00000000000000000000000000000000",J=g.__private__.getFileId=function(){return G},Z=g.__private__.setFileId=function(z){return G=z!==void 0&&/^[a-fA-F0-9]{32}$/.test(z)?z.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(ss=new qx(h.userPermissions,h.userPassword,h.ownerPassword,G)),G};g.setFileId=function(z){return Z(z),this},g.getFileId=function(){return J()};var se=g.__private__.convertDateToPDFDate=function(z){var ce=z.getTimezoneOffset(),Se=ce<0?"+":"-",Le=Math.floor(Math.abs(ce/60)),Ue=Math.abs(ce%60),xt=[Se,re(Le),"'",re(Ue),"'"].join("");return["D:",z.getFullYear(),re(z.getMonth()+1),re(z.getDate()),re(z.getHours()),re(z.getMinutes()),re(z.getSeconds()),xt].join("")},X=g.__private__.convertPDFDateToDate=function(z){var ce=parseInt(z.substr(2,4),10),Se=parseInt(z.substr(6,2),10)-1,Le=parseInt(z.substr(8,2),10),Ue=parseInt(z.substr(10,2),10),xt=parseInt(z.substr(12,2),10),Lt=parseInt(z.substr(14,2),10);return new Date(ce,Se,Le,Ue,xt,Lt,0)},q=g.__private__.setCreationDate=function(z){var ce;if(z===void 0&&(z=new Date),z instanceof Date)ce=se(z);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(z))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ce=z}return ee=ce},U=g.__private__.getCreationDate=function(z){var ce=ee;return z==="jsDate"&&(ce=X(ee)),ce};g.setCreationDate=function(z){return q(z),this},g.getCreationDate=function(z){return U(z)};var H,re=g.__private__.padd2=function(z){return("0"+parseInt(z)).slice(-2)},ae=g.__private__.padd2Hex=function(z){return("00"+(z=z.toString())).substr(z.length)},xe=0,Ne=[],pe=[],K=0,ue=[],fe=[],he=!1,le=pe;g.__private__.setCustomOutputDestination=function(z){he=!0,le=z};var _e=function(z){he||(le=z)};g.__private__.resetCustomOutputDestination=function(){he=!1,le=pe};var oe=g.__private__.out=function(z){return z=z.toString(),K+=z.length+1,le.push(z),le},Oe=g.__private__.write=function(z){return oe(arguments.length===1?z.toString():Array.prototype.join.call(arguments," "))},ze=g.__private__.getArrayBuffer=function(z){for(var ce=z.length,Se=new ArrayBuffer(ce),Le=new Uint8Array(Se);ce--;)Le[ce]=z.charCodeAt(ce);return Se},Ye=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Ye};var je=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(z){return je=I===C?z/Rt:z,this};var Fe,Nt=g.__private__.getFontSize=g.getFontSize=function(){return I===k?je:je*Rt},$t=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(z){return $t=z,this},g.__private__.getR2L=g.getR2L=function(){return $t};var Ut,nt=g.__private__.setZoomMode=function(z){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(z))Fe=z;else if(isNaN(z)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(z)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+z+'" is not recognized.');Fe=z}else Fe=parseInt(z,10)};g.__private__.getZoomMode=function(){return Fe};var bt,It=g.__private__.setPageMode=function(z){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(z)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+z+'" is not recognized.');Ut=z};g.__private__.getPageMode=function(){return Ut};var _t=g.__private__.setLayoutMode=function(z){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(z)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+z+'" is not recognized.');bt=z};g.__private__.getLayoutMode=function(){return bt},g.__private__.setDisplayMode=g.setDisplayMode=function(z,ce,Se){return nt(z),_t(ce),It(Se),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(z){if(Object.keys(wt).indexOf(z)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[z]},g.__private__.getDocumentProperties=function(){return wt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(z){for(var ce in wt)wt.hasOwnProperty(ce)&&z[ce]&&(wt[ce]=z[ce]);return this},g.__private__.setDocumentProperty=function(z,ce){if(Object.keys(wt).indexOf(z)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[z]=ce};var ut,Rt,Dt,at,ft,Bt={},De={},lt=[],ht={},Pt={},At={},mt={},Ft=null,gt=0,Ot=[],Ct=new lH(g),Xt=t.hotfixes||[],Qt={},nr={},sr=[],Jt=function z(ce,Se,Le,Ue,xt,Lt){if(!(this instanceof z))return new z(ce,Se,Le,Ue,xt,Lt);isNaN(ce)&&(ce=1),isNaN(Se)&&(Se=0),isNaN(Le)&&(Le=0),isNaN(Ue)&&(Ue=1),isNaN(xt)&&(xt=0),isNaN(Lt)&&(Lt=0),this._matrix=[ce,Se,Le,Ue,xt,Lt]};Object.defineProperty(Jt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(Jt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(Jt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(Jt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(Jt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(Jt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(Jt.prototype,"a",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(Jt.prototype,"b",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(Jt.prototype,"c",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(Jt.prototype,"d",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(Jt.prototype,"e",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(Jt.prototype,"f",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(Jt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Jt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Jt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Jt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Jt.prototype.join=function(z){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(z)},Jt.prototype.multiply=function(z){var ce=z.sx*this.sx+z.shy*this.shx,Se=z.sx*this.shy+z.shy*this.sy,Le=z.shx*this.sx+z.sy*this.shx,Ue=z.shx*this.shy+z.sy*this.sy,xt=z.tx*this.sx+z.ty*this.shx+this.tx,Lt=z.tx*this.shy+z.ty*this.sy+this.ty;return new Jt(ce,Se,Le,Ue,xt,Lt)},Jt.prototype.decompose=function(){var z=this.sx,ce=this.shy,Se=this.shx,Le=this.sy,Ue=this.tx,xt=this.ty,Lt=Math.sqrt(z*z+ce*ce),ur=(z/=Lt)*Se+(ce/=Lt)*Le;Se-=z*ur,Le-=ce*ur;var pr=Math.sqrt(Se*Se+Le*Le);return ur/=pr,z*(Le/=pr)<ce*(Se/=pr)&&(z=-z,ce=-ce,ur=-ur,Lt=-Lt),{scale:new Jt(Lt,0,0,pr,0,0),translate:new Jt(1,0,0,1,Ue,xt),rotate:new Jt(z,ce,-ce,z,0,0),skew:new Jt(1,0,ur,1,0,0)}},Jt.prototype.toString=function(z){return this.join(" ")},Jt.prototype.inversed=function(){var z=this.sx,ce=this.shy,Se=this.shx,Le=this.sy,Ue=this.tx,xt=this.ty,Lt=1/(z*Le-ce*Se),ur=Le*Lt,pr=-ce*Lt,Rr=-Se*Lt,Ir=z*Lt;return new Jt(ur,pr,Rr,Ir,-ur*Ue-Rr*xt,-pr*Ue-Ir*xt)},Jt.prototype.applyToPoint=function(z){var ce=z.x*this.sx+z.y*this.shx+this.tx,Se=z.x*this.shy+z.y*this.sy+this.ty;return new rr(ce,Se)},Jt.prototype.applyToRectangle=function(z){var ce=this.applyToPoint(z),Se=this.applyToPoint(new rr(z.x+z.w,z.y+z.h));return new Xr(ce.x,ce.y,Se.x-ce.x,Se.y-ce.y)},Jt.prototype.clone=function(){var z=this.sx,ce=this.shy,Se=this.shx,Le=this.sy,Ue=this.tx,xt=this.ty;return new Jt(z,ce,Se,Le,Ue,xt)},g.Matrix=Jt;var kr=g.matrixMult=function(z,ce){return ce.multiply(z)},Ae=new Jt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Ae;var Ke=function(z,ce){if(!Pt[z]){var Se=(ce instanceof fm?"Sh":"P")+(Object.keys(ht).length+1).toString(10);ce.id=Se,Pt[z]=Se,ht[Se]=ce,Ct.publish("addPattern",ce)}};g.ShadingPattern=fm,g.TilingPattern=Xx,g.addShadingPattern=function(z,ce){return M("addShadingPattern()"),Ke(z,ce),this},g.beginTilingPattern=function(z){M("beginTilingPattern()"),On(z.boundingBox[0],z.boundingBox[1],z.boundingBox[2]-z.boundingBox[0],z.boundingBox[3]-z.boundingBox[1],z.matrix)},g.endTilingPattern=function(z,ce){M("endTilingPattern()"),ce.stream=fe[H].join(`
`),Ke(z,ce),Ct.publish("endTilingPattern",ce),sr.pop().restore()};var Gt,jt=g.__private__.newObject=function(){var z=zt();return Mt(z,!0),z},zt=g.__private__.newObjectDeferred=function(){return xe++,Ne[xe]=function(){return K},xe},Mt=function(z,ce){return ce=typeof ce=="boolean"&&ce,Ne[z]=K,ce&&oe(z+" 0 obj"),z},Ht=g.__private__.newAdditionalObject=function(){var z={objId:zt(),content:""};return ue.push(z),z},vr=zt(),Fr=zt(),ln=g.__private__.decodeColorString=function(z){var ce=z.split(" ");if(ce.length!==2||ce[1]!=="g"&&ce[1]!=="G")ce.length!==5||ce[4]!=="k"&&ce[4]!=="K"||(ce=[(1-ce[0])*(1-ce[3]),(1-ce[1])*(1-ce[3]),(1-ce[2])*(1-ce[3]),"r"]);else{var Se=parseFloat(ce[0]);ce=[Se,Se,Se,"r"]}for(var Le="#",Ue=0;Ue<3;Ue++)Le+=("0"+Math.floor(255*parseFloat(ce[Ue])).toString(16)).slice(-2);return Le},hn=g.__private__.encodeColorString=function(z){var ce;typeof z=="string"&&(z={ch1:z});var Se=z.ch1,Le=z.ch2,Ue=z.ch3,xt=z.ch4,Lt=z.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Se=="string"&&Se.charAt(0)!=="#"){var ur=new Rae(Se);if(ur.ok)Se=ur.toHex();else if(!/^\d*\.?\d*$/.test(Se))throw new Error('Invalid color "'+Se+'" passed to jsPDF.encodeColorString.')}if(typeof Se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Se)&&(Se="#"+Se[1]+Se[1]+Se[2]+Se[2]+Se[3]+Se[3]),typeof Se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Se)){var pr=parseInt(Se.substr(1),16);Se=pr>>16&255,Le=pr>>8&255,Ue=255&pr}if(Le===void 0||xt===void 0&&Se===Le&&Le===Ue)ce=typeof Se=="string"?Se+" "+Lt[0]:z.precision===2?S(Se/255)+" "+Lt[0]:P(Se/255)+" "+Lt[0];else if(xt===void 0||Ns(xt)==="object"){if(xt&&!isNaN(xt.a)&&xt.a===0)return["1.","1.","1.",Lt[1]].join(" ");ce=typeof Se=="string"?[Se,Le,Ue,Lt[1]].join(" "):z.precision===2?[S(Se/255),S(Le/255),S(Ue/255),Lt[1]].join(" "):[P(Se/255),P(Le/255),P(Ue/255),Lt[1]].join(" ")}else ce=typeof Se=="string"?[Se,Le,Ue,xt,Lt[2]].join(" "):z.precision===2?[S(Se),S(Le),S(Ue),S(xt),Lt[2]].join(" "):[P(Se),P(Le),P(Ue),P(xt),Lt[2]].join(" ");return ce},cn=g.__private__.getFilters=function(){return o},Ks=g.__private__.putStream=function(z){var ce=(z=z||{}).data||"",Se=z.filters||cn(),Le=z.alreadyAppliedFilters||[],Ue=z.addLength1||!1,xt=ce.length,Lt=z.objectId,ur=function(Y){return Y};if(h!==null&&Lt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(ur=ss.encryptor(Lt,0));var pr={};Se===!0&&(Se=["FlateEncode"]);var Rr=z.additionalKeyValues||[],Ir=(pr=Pr.API.processDataByFilters!==void 0?Pr.API.processDataByFilters(ce,Se):{data:ce,reverseChain:[]}).reverseChain+(Array.isArray(Le)?Le.join(" "):Le.toString());if(pr.data.length!==0&&(Rr.push({key:"Length",value:pr.data.length}),Ue===!0&&Rr.push({key:"Length1",value:xt})),Ir.length!=0)if(Ir.split("/").length-1==1)Rr.push({key:"Filter",value:Ir});else{Rr.push({key:"Filter",value:"["+Ir+"]"});for(var Nn=0;Nn<Rr.length;Nn+=1)if(Rr[Nn].key==="DecodeParms"){for(var Cs=[],ds=0;ds<pr.reverseChain.split("/").length-1;ds+=1)Cs.push("null");Cs.push(Rr[Nn].value),Rr[Nn].value="["+Cs.join(" ")+"]"}}oe("<<");for(var T=0;T<Rr.length;T++)oe("/"+Rr[T].key+" "+Rr[T].value);oe(">>"),pr.data.length!==0&&(oe("stream"),oe(ur(pr.data)),oe("endstream"))},Ci=g.__private__.putPage=function(z){var ce=z.number,Se=z.data,Le=z.objId,Ue=z.contentsObjId;Mt(Le,!0),oe("<</Type /Page"),oe("/Parent "+z.rootDictionaryObjId+" 0 R"),oe("/Resources "+z.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(E(z.mediaBox.bottomLeftX))+" "+parseFloat(E(z.mediaBox.bottomLeftY))+" "+E(z.mediaBox.topRightX)+" "+E(z.mediaBox.topRightY)+"]"),z.cropBox!==null&&oe("/CropBox ["+E(z.cropBox.bottomLeftX)+" "+E(z.cropBox.bottomLeftY)+" "+E(z.cropBox.topRightX)+" "+E(z.cropBox.topRightY)+"]"),z.bleedBox!==null&&oe("/BleedBox ["+E(z.bleedBox.bottomLeftX)+" "+E(z.bleedBox.bottomLeftY)+" "+E(z.bleedBox.topRightX)+" "+E(z.bleedBox.topRightY)+"]"),z.trimBox!==null&&oe("/TrimBox ["+E(z.trimBox.bottomLeftX)+" "+E(z.trimBox.bottomLeftY)+" "+E(z.trimBox.topRightX)+" "+E(z.trimBox.topRightY)+"]"),z.artBox!==null&&oe("/ArtBox ["+E(z.artBox.bottomLeftX)+" "+E(z.artBox.bottomLeftY)+" "+E(z.artBox.topRightX)+" "+E(z.artBox.topRightY)+"]"),typeof z.userUnit=="number"&&z.userUnit!==1&&oe("/UserUnit "+z.userUnit),Ct.publish("putPage",{objId:Le,pageContext:Ot[ce],pageNumber:ce,page:Se}),oe("/Contents "+Ue+" 0 R"),oe(">>"),oe("endobj");var xt=Se.join(`
`);return I===C&&(xt+=`
Q`),Mt(Ue,!0),Ks({data:xt,filters:cn(),objectId:Ue}),oe("endobj"),Le},Ds=g.__private__.putPages=function(){var z,ce,Se=[];for(z=1;z<=gt;z++)Ot[z].objId=zt(),Ot[z].contentsObjId=zt();for(z=1;z<=gt;z++)Se.push(Ci({number:z,data:fe[z],objId:Ot[z].objId,contentsObjId:Ot[z].contentsObjId,mediaBox:Ot[z].mediaBox,cropBox:Ot[z].cropBox,bleedBox:Ot[z].bleedBox,trimBox:Ot[z].trimBox,artBox:Ot[z].artBox,userUnit:Ot[z].userUnit,rootDictionaryObjId:vr,resourceDictionaryObjId:Fr}));Mt(vr,!0),oe("<</Type /Pages");var Le="/Kids [";for(ce=0;ce<gt;ce++)Le+=Se[ce]+" 0 R ";oe(Le+"]"),oe("/Count "+gt),oe(">>"),oe("endobj"),Ct.publish("postPutPages")},ps=function(z){Ct.publish("putFont",{font:z,out:oe,newObject:jt,putStream:Ks}),z.isAlreadyPutted!==!0&&(z.objectNumber=jt(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+Hx(z.postScriptName)),oe("/Subtype /Type1"),typeof z.encoding=="string"&&oe("/Encoding /"+z.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},$e=function(z){z.objectNumber=jt();var ce=[];ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Form"}),ce.push({key:"BBox",value:"["+[E(z.x),E(z.y),E(z.x+z.width),E(z.y+z.height)].join(" ")+"]"}),ce.push({key:"Matrix",value:"["+z.matrix.toString()+"]"});var Se=z.pages[1].join(`
`);Ks({data:Se,additionalKeyValues:ce,objectId:z.objectNumber}),oe("endobj")},Xe=function(z,ce){ce||(ce=21);var Se=jt(),Le=(function(Lt,ur){var pr,Rr=[],Ir=1/(ur-1);for(pr=0;pr<1;pr+=Ir)Rr.push(pr);if(Rr.push(1),Lt[0].offset!=0){var Nn={offset:0,color:Lt[0].color};Lt.unshift(Nn)}if(Lt[Lt.length-1].offset!=1){var Cs={offset:1,color:Lt[Lt.length-1].color};Lt.push(Cs)}for(var ds="",T=0,Y=0;Y<Rr.length;Y++){for(pr=Rr[Y];pr>Lt[T+1].offset;)T++;var ie=Lt[T].offset,we=(pr-ie)/(Lt[T+1].offset-ie),qe=Lt[T].color,tt=Lt[T+1].color;ds+=ae(Math.round((1-we)*qe[0]+we*tt[0]).toString(16))+ae(Math.round((1-we)*qe[1]+we*tt[1]).toString(16))+ae(Math.round((1-we)*qe[2]+we*tt[2]).toString(16))}return ds.trim()})(z.colors,ce),Ue=[];Ue.push({key:"FunctionType",value:"0"}),Ue.push({key:"Domain",value:"[0.0 1.0]"}),Ue.push({key:"Size",value:"["+ce+"]"}),Ue.push({key:"BitsPerSample",value:"8"}),Ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ks({data:Le,additionalKeyValues:Ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Se}),oe("endobj"),z.objectNumber=jt(),oe("<< /ShadingType "+z.type),oe("/ColorSpace /DeviceRGB");var xt="/Coords ["+E(parseFloat(z.coords[0]))+" "+E(parseFloat(z.coords[1]))+" ";z.type===2?xt+=E(parseFloat(z.coords[2]))+" "+E(parseFloat(z.coords[3])):xt+=E(parseFloat(z.coords[2]))+" "+E(parseFloat(z.coords[3]))+" "+E(parseFloat(z.coords[4]))+" "+E(parseFloat(z.coords[5])),oe(xt+="]"),z.matrix&&oe("/Matrix ["+z.matrix.toString()+"]"),oe("/Function "+Se+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},ct=function(z,ce){var Se=zt(),Le=jt();ce.push({resourcesOid:Se,objectOid:Le}),z.objectNumber=Le;var Ue=[];Ue.push({key:"Type",value:"/Pattern"}),Ue.push({key:"PatternType",value:"1"}),Ue.push({key:"PaintType",value:"1"}),Ue.push({key:"TilingType",value:"1"}),Ue.push({key:"BBox",value:"["+z.boundingBox.map(E).join(" ")+"]"}),Ue.push({key:"XStep",value:E(z.xStep)}),Ue.push({key:"YStep",value:E(z.yStep)}),Ue.push({key:"Resources",value:Se+" 0 R"}),z.matrix&&Ue.push({key:"Matrix",value:"["+z.matrix.toString()+"]"}),Ks({data:z.stream,additionalKeyValues:Ue,objectId:z.objectNumber}),oe("endobj")},tr=function(z){for(var ce in z.objectNumber=jt(),oe("<<"),z)switch(ce){case"opacity":oe("/ca "+S(z[ce]));break;case"stroke-opacity":oe("/CA "+S(z[ce]))}oe(">>"),oe("endobj")},Lr=function(z){Mt(z.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ce in oe("/Font <<"),Bt)Bt.hasOwnProperty(ce)&&(f===!1||f===!0&&m.hasOwnProperty(ce))&&oe("/"+ce+" "+Bt[ce].objectNumber+" 0 R");oe(">>")})(),(function(){if(Object.keys(ht).length>0){for(var ce in oe("/Shading <<"),ht)ht.hasOwnProperty(ce)&&ht[ce]instanceof fm&&ht[ce].objectNumber>=0&&oe("/"+ce+" "+ht[ce].objectNumber+" 0 R");Ct.publish("putShadingPatternDict"),oe(">>")}})(),(function(ce){if(Object.keys(ht).length>0){for(var Se in oe("/Pattern <<"),ht)ht.hasOwnProperty(Se)&&ht[Se]instanceof g.TilingPattern&&ht[Se].objectNumber>=0&&ht[Se].objectNumber<ce&&oe("/"+Se+" "+ht[Se].objectNumber+" 0 R");Ct.publish("putTilingPatternDict"),oe(">>")}})(z.objectOid),(function(){if(Object.keys(At).length>0){var ce;for(ce in oe("/ExtGState <<"),At)At.hasOwnProperty(ce)&&At[ce].objectNumber>=0&&oe("/"+ce+" "+At[ce].objectNumber+" 0 R");Ct.publish("putGStateDict"),oe(">>")}})(),(function(){for(var ce in oe("/XObject <<"),Qt)Qt.hasOwnProperty(ce)&&Qt[ce].objectNumber>=0&&oe("/"+ce+" "+Qt[ce].objectNumber+" 0 R");Ct.publish("putXobjectDict"),oe(">>")})(),oe(">>"),oe("endobj")},tn=function(z){De[z.fontName]=De[z.fontName]||{},De[z.fontName][z.fontStyle]=z.id},Ea=function(z,ce,Se,Le,Ue){var xt={id:"F"+(Object.keys(Bt).length+1).toString(10),postScriptName:z,fontName:ce,fontStyle:Se,encoding:Le,isStandardFont:Ue||!1,metadata:{}};return Ct.publish("addFont",{font:xt,instance:this}),Bt[xt.id]=xt,tn(xt),xt.id},Bs=g.__private__.pdfEscape=g.pdfEscape=function(z,ce){return(function(Se,Le){var Ue,xt,Lt,ur,pr,Rr,Ir,Nn,Cs;if(Lt=(Le=Le||{}).sourceEncoding||"Unicode",pr=Le.outputEncoding,(Le.autoencode||pr)&&Bt[ut].metadata&&Bt[ut].metadata[Lt]&&Bt[ut].metadata[Lt].encoding&&(ur=Bt[ut].metadata[Lt].encoding,!pr&&Bt[ut].encoding&&(pr=Bt[ut].encoding),!pr&&ur.codePages&&(pr=ur.codePages[0]),typeof pr=="string"&&(pr=ur[pr]),pr)){for(Ir=!1,Rr=[],Ue=0,xt=Se.length;Ue<xt;Ue++)(Nn=pr[Se.charCodeAt(Ue)])?Rr.push(String.fromCharCode(Nn)):Rr.push(Se[Ue]),Rr[Ue].charCodeAt(0)>>8&&(Ir=!0);Se=Rr.join("")}for(Ue=Se.length;Ir===void 0&&Ue!==0;)Se.charCodeAt(Ue-1)>>8&&(Ir=!0),Ue--;if(!Ir)return Se;for(Rr=Le.noBOM?[]:[254,255],Ue=0,xt=Se.length;Ue<xt;Ue++){if((Cs=(Nn=Se.charCodeAt(Ue))>>8)>>8)throw new Error("Character at position "+Ue+" of string '"+Se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Rr.push(Cs),Rr.push(Nn-(Cs<<8))}return String.fromCharCode.apply(void 0,Rr)})(z,ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sa=g.__private__.beginPage=function(z){fe[++gt]=[],Ot[gt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(z[0]),topRightY:Number(z[1])}},Ko(gt),_e(fe[H])},Bi=function(z,ce){var Se,Le,Ue;switch(r=ce||r,typeof z=="string"&&(Se=N(z.toLowerCase()),Array.isArray(Se)&&(Le=Se[0],Ue=Se[1])),Array.isArray(z)&&(Le=z[0]*Rt,Ue=z[1]*Rt),isNaN(Le)&&(Le=s[0],Ue=s[1]),(Le>14400||Ue>14400)&&(qs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Le=Math.min(14400,Le),Ue=Math.min(14400,Ue)),s=[Le,Ue],r.substr(0,1)){case"l":Ue>Le&&(s=[Ue,Le]);break;case"p":Le>Ue&&(s=[Ue,Le])}sa(s),yr(Ai),oe(zi),Te!==0&&oe(Te+" J"),it!==0&&oe(it+" j"),Ct.publish("addPage",{pageNumber:gt})},Fi=function(z){z>0&&z<=gt&&(fe.splice(z,1),Ot.splice(z,1),gt--,H>gt&&(H=gt),this.setPage(H))},Ko=function(z){z>0&&z<=gt&&(H=z)},Rl=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return fe.length-1},pc=function(z,ce,Se){var Le,Ue=void 0;return Se=Se||{},z=z!==void 0?z:Bt[ut].fontName,ce=ce!==void 0?ce:Bt[ut].fontStyle,Le=z.toLowerCase(),De[Le]!==void 0&&De[Le][ce]!==void 0?Ue=De[Le][ce]:De[z]!==void 0&&De[z][ce]!==void 0?Ue=De[z][ce]:Se.disableWarning===!1&&qs.warn("Unable to look up font label for font '"+z+"', '"+ce+"'. Refer to getFontList() for available fonts."),Ue||Se.noFallback||(Ue=De.times[ce])==null&&(Ue=De.times.normal),Ue},ia=g.__private__.putInfo=function(){var z=jt(),ce=function(Le){return Le};for(var Se in h!==null&&(ce=ss.encryptor(z,0)),oe("<<"),oe("/Producer ("+Bs(ce("jsPDF "+Pr.version))+")"),wt)wt.hasOwnProperty(Se)&&wt[Se]&&oe("/"+Se.substr(0,1).toUpperCase()+Se.substr(1)+" ("+Bs(ce(wt[Se]))+")");oe("/CreationDate ("+Bs(ce(ee))+")"),oe(">>"),oe("endobj")},pi=g.__private__.putCatalog=function(z){var ce=(z=z||{}).rootDictionaryObjId||vr;switch(jt(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+ce+" 0 R"),Fe||(Fe="fullwidth"),Fe){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Se=""+Fe;Se.substr(Se.length-1)==="%"&&(Fe=parseInt(Fe)/100),typeof Fe=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+S(Fe)+"]")}switch(bt||(bt="continuous"),bt){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}Ut&&oe("/PageMode /"+Ut),Ct.publish("putCatalog"),oe(">>"),oe("endobj")},ks=g.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(xe+1)),oe("/Root "+xe+" 0 R"),oe("/Info "+(xe-1)+" 0 R"),h!==null&&oe("/Encrypt "+ss.oid+" 0 R"),oe("/ID [ <"+G+"> <"+G+"> ]"),oe(">>")},Zr=g.__private__.putHeader=function(){oe("%PDF-"+y),oe("%")},Aa=g.__private__.putXRef=function(){var z="0000000000";oe("xref"),oe("0 "+(xe+1)),oe("0000000000 65535 f ");for(var ce=1;ce<=xe;ce++)typeof Ne[ce]=="function"?oe((z+Ne[ce]()).slice(-10)+" 00000 n "):Ne[ce]!==void 0?oe((z+Ne[ce]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},mi=g.__private__.buildDocument=function(){var z;xe=0,K=0,pe=[],Ne=[],ue=[],vr=zt(),Fr=zt(),_e(pe),Ct.publish("buildDocument"),Zr(),Ds(),(function(){Ct.publish("putAdditionalObjects");for(var Se=0;Se<ue.length;Se++){var Le=ue[Se];Mt(Le.objId,!0),oe(Le.content),oe("endobj")}Ct.publish("postPutAdditionalObjects")})(),z=[],(function(){for(var Se in Bt)Bt.hasOwnProperty(Se)&&(f===!1||f===!0&&m.hasOwnProperty(Se))&&ps(Bt[Se])})(),(function(){var Se;for(Se in At)At.hasOwnProperty(Se)&&tr(At[Se])})(),(function(){for(var Se in Qt)Qt.hasOwnProperty(Se)&&$e(Qt[Se])})(),(function(Se){var Le;for(Le in ht)ht.hasOwnProperty(Le)&&(ht[Le]instanceof fm?Xe(ht[Le]):ht[Le]instanceof Xx&&ct(ht[Le],Se))})(z),Ct.publish("putResources"),z.forEach(Lr),Lr({resourcesOid:Fr,objectOid:Number.MAX_SAFE_INTEGER}),Ct.publish("postPutResources"),h!==null&&(ss.oid=jt(),oe("<<"),oe("/Filter /Standard"),oe("/V "+ss.v),oe("/R "+ss.r),oe("/U <"+ss.toHexString(ss.U)+">"),oe("/O <"+ss.toHexString(ss.O)+">"),oe("/P "+ss.P),oe(">>"),oe("endobj")),ia(),pi();var ce=K;return Aa(),ks(),oe("startxref"),oe(""+ce),oe("%%EOF"),_e(fe[H]),pe.join(`
`)},pn=g.__private__.getBlob=function(z){return new Blob([ze(z)],{type:"application/pdf"})},No=g.output=g.__private__.output=(Gt=function(z,ce){switch(typeof(ce=ce||{})=="string"?ce={filename:ce}:ce.filename=ce.filename||"generated.pdf",z){case void 0:return mi();case"save":g.save(ce.filename);break;case"arraybuffer":return ze(mi());case"blob":return pn(mi());case"bloburi":case"bloburl":if(Jr.URL!==void 0&&typeof Jr.URL.createObjectURL=="function")return Jr.URL&&Jr.URL.createObjectURL(pn(mi()))||void 0;qs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Se="",Le=mi();try{Se=iH(Le)}catch{Se=iH(unescape(encodeURIComponent(Le)))}return"data:application/pdf;filename="+ce.filename+";base64,"+Se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Jr)==="[object Window]"){var Ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",xt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ce.pdfObjectUrl&&(Ue=ce.pdfObjectUrl,xt="");var Lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ue+'"'+xt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ce)+");<\/script></body></html>",ur=Jr.open();return ur!==null&&ur.document.write(Lt),ur}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Jr)==="[object Window]"){var pr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ce.filename+'" width="500px" height="400px" /></body></html>',Rr=Jr.open();if(Rr!==null){Rr.document.write(pr);var Ir=this;Rr.document.documentElement.querySelector("#pdfViewer").onload=function(){Rr.document.title=ce.filename,Rr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ir.output("bloburl"))}}return Rr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Jr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Nn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ce)+'"></iframe></body></html>',Cs=Jr.open();if(Cs!==null&&(Cs.document.write(Nn),Cs.document.title=ce.filename),Cs||typeof safari>"u")return Cs;break;case"datauri":case"dataurl":return Jr.document.location.href=this.output("datauristring",ce);default:return null}},Gt.foo=function(){try{return Gt.apply(this,arguments)}catch(Se){var z=Se.stack||"";~z.indexOf(" at ")&&(z=z.split(" at ")[1]);var ce="Error in function "+z.split(`
`)[0].split("<")[0]+": "+Se.message;if(!Jr.console)throw new Error(ce);Jr.console.error(ce,Se),Jr.alert&&alert(ce)}},Gt.foo.bar=Gt,Gt.foo),Fs=function(z){return Array.isArray(Xt)===!0&&Xt.indexOf(z)>-1};switch(n){case"pt":Rt=1;break;case"mm":Rt=72/25.4;break;case"cm":Rt=72/2.54;break;case"in":Rt=72;break;case"px":Rt=Fs("px_scaling")==1?.75:96/72;break;case"pc":case"em":Rt=12;break;case"ex":Rt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Rt=n}var ss=null;q(),Z();var _s=g.__private__.getPageInfo=g.getPageInfo=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ot[z].objId,pageNumber:z,pageContext:Ot[z]}},hl=g.__private__.getPageInfoByObjId=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ce in Ot)if(Ot[ce].objId===z)break;return _s(ce)},Dl=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Ot[H].objId,pageNumber:H,pageContext:Ot[H]}};g.addPage=function(){return Bi.apply(this,arguments),this},g.setPage=function(){return Ko.apply(this,arguments),_e.call(this,fe[H]),this},g.insertPage=function(z){return this.addPage(),this.movePage(H,z),this},g.movePage=function(z,ce){var Se,Le;if(z>ce){Se=fe[z],Le=Ot[z];for(var Ue=z;Ue>ce;Ue--)fe[Ue]=fe[Ue-1],Ot[Ue]=Ot[Ue-1];fe[ce]=Se,Ot[ce]=Le,this.setPage(ce)}else if(z<ce){Se=fe[z],Le=Ot[z];for(var xt=z;xt<ce;xt++)fe[xt]=fe[xt+1],Ot[xt]=Ot[xt+1];fe[ce]=Se,Ot[ce]=Le,this.setPage(ce)}return this},g.deletePage=function(){return Fi.apply(this,arguments),this},g.__private__.text=g.text=function(z,ce,Se,Le,Ue){var xt,Lt,ur,pr,Rr,Ir,Nn,Cs,ds,T=(Le=Le||{}).scope||this;if(typeof z=="number"&&typeof ce=="number"&&(typeof Se=="string"||Array.isArray(Se))){var Y=Se;Se=ce,ce=z,z=Y}if(arguments[3]instanceof Jt==0?(ur=arguments[4],pr=arguments[5],Ns(Nn=arguments[3])==="object"&&Nn!==null||(typeof ur=="string"&&(pr=ur,ur=null),typeof Nn=="string"&&(pr=Nn,Nn=null),typeof Nn=="number"&&(ur=Nn,Nn=null),Le={flags:Nn,angle:ur,align:pr})):(M("The transform parameter of text() with a Matrix value"),ds=Ue),isNaN(ce)||isNaN(Se)||z==null)throw new Error("Invalid arguments passed to jsPDF.text");if(z.length===0)return T;var ie,we="",qe=typeof Le.lineHeightFactor=="number"?Le.lineHeightFactor:ms,tt=T.internal.scaleFactor;function Kt(Xn){return Xn=Xn.split("	").join(Array(Le.TabLen||9).join(" ")),Bs(Xn,Nn)}function Yr(Xn){for(var Mn,As=Xn.concat(),Ii=[],Kc=As.length;Kc--;)typeof(Mn=As.shift())=="string"?Ii.push(Mn):Array.isArray(Xn)&&(Mn.length===1||Mn[1]===void 0&&Mn[2]===void 0)?Ii.push(Mn[0]):Ii.push([Mn[0],Mn[1],Mn[2]]);return Ii}function Es(Xn,Mn){var As;if(typeof Xn=="string")As=Mn(Xn)[0];else if(Array.isArray(Xn)){for(var Ii,Kc,vc=Xn.concat(),Eh=[],Op=vc.length;Op--;)typeof(Ii=vc.shift())=="string"?Eh.push(Mn(Ii)[0]):Array.isArray(Ii)&&typeof Ii[0]=="string"&&(Kc=Mn(Ii[0],Ii[1],Ii[2]),Eh.push([Kc[0],Kc[1],Kc[2]]));As=Eh}return As}var bn=!1,Zn=!0;if(typeof z=="string")bn=!0;else if(Array.isArray(z)){var pa=z.concat();Lt=[];for(var Ia,gs=pa.length;gs--;)(typeof(Ia=pa.shift())!="string"||Array.isArray(Ia)&&typeof Ia[0]!="string")&&(Zn=!1);bn=Zn}if(bn===!1)throw new Error('Type of text must be string or Array. "'+z+'" is not recognized.');typeof z=="string"&&(z=z.match(/[\r?\n]/)?z.split(/\r\n|\r|\n/g):[z]);var Pa=je/T.internal.scaleFactor,fl=Pa*(qe-1);switch(Le.baseline){case"bottom":Se-=fl;break;case"top":Se+=Pa-fl;break;case"hanging":Se+=Pa-2*fl;break;case"middle":Se+=Pa/2-fl}if((Ir=Le.maxWidth||0)>0&&(typeof z=="string"?z=T.splitTextToSize(z,Ir):Object.prototype.toString.call(z)==="[object Array]"&&(z=z.reduce(function(Xn,Mn){return Xn.concat(T.splitTextToSize(Mn,Ir))},[]))),xt={text:z,x:ce,y:Se,options:Le,mutex:{pdfEscape:Bs,activeFontKey:ut,fonts:Bt,activeFontSize:je}},Ct.publish("preProcessText",xt),z=xt.text,ur=(Le=xt.options).angle,ds instanceof Jt==0&&ur&&typeof ur=="number"){ur*=Math.PI/180,Le.rotationDirection===0&&(ur=-ur),I===C&&(ur=-ur);var Uc=Math.cos(ur),zc=Math.sin(ur);ds=new Jt(Uc,zc,-zc,Uc,0,0)}else ur&&ur instanceof Jt&&(ds=ur);I!==C||ds||(ds=Ae),(Rr=Le.charSpace||Q)!==void 0&&(we+=E(R(Rr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Cs=Le.horizontalScale)!==void 0&&(we+=E(100*Cs)+` Tz
`),Le.lang;var Ao=-1,Cu=Le.renderingMode!==void 0?Le.renderingMode:Le.stroke,Xf=T.internal.getCurrentPageInfo().pageContext;switch(Cu){case 0:case!1:case"fill":Ao=0;break;case 1:case!0:case"stroke":Ao=1;break;case 2:case"fillThenStroke":Ao=2;break;case 3:case"invisible":Ao=3;break;case 4:case"fillAndAddForClipping":Ao=4;break;case 5:case"strokeAndAddPathForClipping":Ao=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ao=6;break;case 7:case"addToPathForClipping":Ao=7}var Pp=Xf.usedRenderingMode!==void 0?Xf.usedRenderingMode:-1;Ao!==-1?we+=Ao+` Tr
`:Pp!==-1&&(we+=`0 Tr
`),Ao!==-1&&(Xf.usedRenderingMode=Ao),pr=Le.align||"left";var pl,yc=je*qe,Eu=T.internal.pageSize.getWidth(),Lp=Bt[ut];Rr=Le.charSpace||Q,Ir=Le.maxWidth||0,Nn=Object.assign({autoencode:!0,noBOM:!0},Le.flags);var bc=[],kd=function(Xn){return T.getStringUnitWidth(Xn,{font:Lp,charSpace:Rr,fontSize:je,doKerning:!1})*je/tt};if(Object.prototype.toString.call(z)==="[object Array]"){var Qo;Lt=Yr(z),pr!=="left"&&(pl=Lt.map(kd));var To,Vc=0;if(pr==="right"){ce-=pl[0],z=[],gs=Lt.length;for(var qc=0;qc<gs;qc++)qc===0?(To=Ys(ce),Qo=Ss(Se)):(To=R(Vc-pl[qc]),Qo=-yc),z.push([Lt[qc],To,Qo]),Vc=pl[qc]}else if(pr==="center"){ce-=pl[0]/2,z=[],gs=Lt.length;for(var Au=0;Au<gs;Au++)Au===0?(To=Ys(ce),Qo=Ss(Se)):(To=R((Vc-pl[Au])/2),Qo=-yc),z.push([Lt[Au],To,Qo]),Vc=pl[Au]}else if(pr==="left"){z=[],gs=Lt.length;for(var Qf=0;Qf<gs;Qf++)z.push(Lt[Qf])}else if(pr==="justify"&&Lp.encoding==="Identity-H"){z=[],gs=Lt.length,Ir=Ir!==0?Ir:Eu;for(var Jf=0,Ti=0;Ti<gs;Ti++)if(Qo=Ti===0?Ss(Se):-yc,To=Ti===0?Ys(ce):Jf,Ti<gs-1){var Mg=R((Ir-pl[Ti])/(Lt[Ti].split(" ").length-1)),Hc=Lt[Ti].split(" ");z.push([Hc[0]+" ",To,Qo]),Jf=0;for(var Wc=1;Wc<Hc.length;Wc++){var La=(kd(Hc[Wc-1]+" "+Hc[Wc])-kd(Hc[Wc]))*tt+Mg;Wc==Hc.length-1?z.push([Hc[Wc],La,0]):z.push([Hc[Wc]+" ",La,0]),Jf-=La}}else z.push([Lt[Ti],To,Qo]);z.push(["",Jf,0])}else{if(pr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(z=[],gs=Lt.length,Ir=Ir!==0?Ir:Eu,Ti=0;Ti<gs;Ti++){Qo=Ti===0?Ss(Se):-yc,To=Ti===0?Ys(ce):0;var Tu=Lt[Ti].split(" ").length-1,Zf=Tu>0?(Ir-pl[Ti])/Tu:0;Ti<gs-1?bc.push(E(R(Zf))):bc.push(0),z.push([Lt[Ti],To,Qo])}}}(typeof Le.R2L=="boolean"?Le.R2L:$t)===!0&&(z=Es(z,function(Xn,Mn,As){return[Xn.split("").reverse().join(""),Mn,As]})),xt={text:z,x:ce,y:Se,options:Le,mutex:{pdfEscape:Bs,activeFontKey:ut,fonts:Bt,activeFontSize:je}},Ct.publish("postProcessText",xt),z=xt.text,ie=xt.mutex.isHex||!1;var e0=Bt[ut].encoding;e0!=="WinAnsiEncoding"&&e0!=="StandardEncoding"||(z=Es(z,function(Xn,Mn,As){return[Kt(Xn),Mn,As]})),Lt=Yr(z),z=[];for(var Iu,Pu,Gc,Ch=Array.isArray(Lt[0])?1:0,ml="",Lu=function(Xn,Mn,As){var Ii="";return As instanceof Jt?(As=typeof Le.angle=="number"?kr(As,new Jt(1,0,0,1,Xn,Mn)):kr(new Jt(1,0,0,1,Xn,Mn),As),I===C&&(As=kr(new Jt(1,0,0,-1,0,0),As)),Ii=As.join(" ")+` Tm
`):Ii=E(Xn)+" "+E(Mn)+` Td
`,Ii},no=0;no<Lt.length;no++){switch(ml="",Ch){case 1:Gc=(ie?"<":"(")+Lt[no][0]+(ie?">":")"),Iu=parseFloat(Lt[no][1]),Pu=parseFloat(Lt[no][2]);break;case 0:Gc=(ie?"<":"(")+Lt[no]+(ie?">":")"),Iu=Ys(ce),Pu=Ss(Se)}bc!==void 0&&bc[no]!==void 0&&(ml=bc[no]+` Tw
`),no===0?z.push(ml+Lu(Iu,Pu,ds)+Gc):Ch===0?z.push(ml+Gc):Ch===1&&z.push(ml+Lu(Iu,Pu,ds)+Gc)}z=Ch===0?z.join(` Tj
T* `):z.join(` Tj
`),z+=` Tj
`;var $l=`BT
/`;return $l+=ut+" "+je+` Tf
`,$l+=E(je*qe)+` TL
`,$l+=Ta+`
`,$l+=we,$l+=z,oe($l+="ET"),m[ut]=!0,T};var mc=g.__private__.clip=g.clip=function(z){return oe(z==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return mc("evenodd")},g.__private__.discardPath=g.discardPath=function(){return oe("n"),this};var Ei=g.__private__.isValidStyle=function(z){var ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(z)!==-1&&(ce=!0),ce};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(z){return Ei(z)&&(u=z),this};var jo=g.__private__.getStyle=g.getStyle=function(z){var ce=u;switch(z){case"D":case"S":ce="S";break;case"F":ce="f";break;case"FD":case"DF":ce="B";break;case"f":case"f*":case"B":case"B*":ce=z}return ce},ei=g.close=function(){return oe("h"),this};g.stroke=function(){return oe("S"),this},g.fill=function(z){return is("f",z),this},g.fillEvenOdd=function(z){return is("f*",z),this},g.fillStroke=function(z){return is("B",z),this},g.fillStrokeEvenOdd=function(z){return is("B*",z),this};var is=function(z,ce){Ns(ce)==="object"?ha(ce,z):oe(z)},$i=function(z){z===null||I===C&&z===void 0||(z=jo(z),oe(z))};function gc(z,ce,Se,Le,Ue){var xt=new Xx(ce||this.boundingBox,Se||this.xStep,Le||this.yStep,this.gState,Ue||this.matrix);xt.stream=this.stream;var Lt=z+"$$"+this.cloneIndex+++"$$";return Ke(Lt,xt),xt}var ha=function(z,ce){var Se=Pt[z.key],Le=ht[Se];if(Le instanceof fm)oe("q"),oe(Bl(ce)),Le.gState&&g.setGState(Le.gState),oe(z.matrix.toString()+" cm"),oe("/"+Se+" sh"),oe("Q");else if(Le instanceof Xx){var Ue=new Jt(1,0,0,-1,0,ti());z.matrix&&(Ue=Ue.multiply(z.matrix||Ae),Se=gc.call(Le,z.key,z.boundingBox,z.xStep,z.yStep,Ue).id),oe("q"),oe("/Pattern cs"),oe("/"+Se+" scn"),Le.gState&&g.setGState(Le.gState),oe(ce),oe("Q")}},Bl=function(z){switch(z){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Fl=g.moveTo=function(z,ce){return oe(E(R(z))+" "+E(V(ce))+" m"),this},ko=g.lineTo=function(z,ce){return oe(E(R(z))+" "+E(V(ce))+" l"),this},Ui=g.curveTo=function(z,ce,Se,Le,Ue,xt){return oe([E(R(z)),E(V(ce)),E(R(Se)),E(V(Le)),E(R(Ue)),E(V(xt)),"c"].join(" ")),this};g.__private__.line=g.line=function(z,ce,Se,Le,Ue){if(isNaN(z)||isNaN(ce)||isNaN(Se)||isNaN(Le)||!Ei(Ue))throw new Error("Invalid arguments passed to jsPDF.line");return I===k?this.lines([[Se-z,Le-ce]],z,ce,[1,1],Ue||"S"):this.lines([[Se-z,Le-ce]],z,ce,[1,1]).stroke()},g.__private__.lines=g.lines=function(z,ce,Se,Le,Ue,xt){var Lt,ur,pr,Rr,Ir,Nn,Cs,ds,T,Y,ie,we;if(typeof z=="number"&&(we=Se,Se=ce,ce=z,z=we),Le=Le||[1,1],xt=xt||!1,isNaN(ce)||isNaN(Se)||!Array.isArray(z)||!Array.isArray(Le)||!Ei(Ue)||typeof xt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Fl(ce,Se),Lt=Le[0],ur=Le[1],Rr=z.length,Y=ce,ie=Se,pr=0;pr<Rr;pr++)(Ir=z[pr]).length===2?(Y=Ir[0]*Lt+Y,ie=Ir[1]*ur+ie,ko(Y,ie)):(Nn=Ir[0]*Lt+Y,Cs=Ir[1]*ur+ie,ds=Ir[2]*Lt+Y,T=Ir[3]*ur+ie,Y=Ir[4]*Lt+Y,ie=Ir[5]*ur+ie,Ui(Nn,Cs,ds,T,Y,ie));return xt&&ei(),$i(Ue),this},g.path=function(z){for(var ce=0;ce<z.length;ce++){var Se=z[ce],Le=Se.c;switch(Se.op){case"m":Fl(Le[0],Le[1]);break;case"l":ko(Le[0],Le[1]);break;case"c":Ui.apply(this,Le);break;case"h":ei()}}return this},g.__private__.rect=g.rect=function(z,ce,Se,Le,Ue){if(isNaN(z)||isNaN(ce)||isNaN(Se)||isNaN(Le)||!Ei(Ue))throw new Error("Invalid arguments passed to jsPDF.rect");return I===k&&(Le=-Le),oe([E(R(z)),E(V(ce)),E(R(Se)),E(R(Le)),"re"].join(" ")),$i(Ue),this},g.__private__.triangle=g.triangle=function(z,ce,Se,Le,Ue,xt,Lt){if(isNaN(z)||isNaN(ce)||isNaN(Se)||isNaN(Le)||isNaN(Ue)||isNaN(xt)||!Ei(Lt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Se-z,Le-ce],[Ue-Se,xt-Le],[z-Ue,ce-xt]],z,ce,[1,1],Lt,!0),this},g.__private__.roundedRect=g.roundedRect=function(z,ce,Se,Le,Ue,xt,Lt){if(isNaN(z)||isNaN(ce)||isNaN(Se)||isNaN(Le)||isNaN(Ue)||isNaN(xt)||!Ei(Lt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ur=4/3*(Math.SQRT2-1);return Ue=Math.min(Ue,.5*Se),xt=Math.min(xt,.5*Le),this.lines([[Se-2*Ue,0],[Ue*ur,0,Ue,xt-xt*ur,Ue,xt],[0,Le-2*xt],[0,xt*ur,-Ue*ur,xt,-Ue,xt],[2*Ue-Se,0],[-Ue*ur,0,-Ue,-xt*ur,-Ue,-xt],[0,2*xt-Le],[0,-xt*ur,Ue*ur,-xt,Ue,-xt]],z+Ue,ce,[1,1],Lt,!0),this},g.__private__.ellipse=g.ellipse=function(z,ce,Se,Le,Ue){if(isNaN(z)||isNaN(ce)||isNaN(Se)||isNaN(Le)||!Ei(Ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var xt=4/3*(Math.SQRT2-1)*Se,Lt=4/3*(Math.SQRT2-1)*Le;return Fl(z+Se,ce),Ui(z+Se,ce-Lt,z+xt,ce-Le,z,ce-Le),Ui(z-xt,ce-Le,z-Se,ce-Lt,z-Se,ce),Ui(z-Se,ce+Lt,z-xt,ce+Le,z,ce+Le),Ui(z+xt,ce+Le,z+Se,ce+Lt,z+Se,ce),$i(Ue),this},g.__private__.circle=g.circle=function(z,ce,Se,Le){if(isNaN(z)||isNaN(ce)||isNaN(Se)||!Ei(Le))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(z,ce,Se,Se,Le)},g.setFont=function(z,ce,Se){return Se&&(ce=_(ce,Se)),ut=pc(z,ce,{disableWarning:!1}),this};var fa=g.__private__.getFont=g.getFont=function(){return Bt[pc.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var z,ce,Se={};for(z in De)if(De.hasOwnProperty(z))for(ce in Se[z]=[],De[z])De[z].hasOwnProperty(ce)&&Se[z].push(ce);return Se},g.addFont=function(z,ce,Se,Le,Ue){var xt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&xt.indexOf(arguments[3])!==-1?Ue=arguments[3]:arguments[3]&&xt.indexOf(arguments[3])==-1&&(Se=_(Se,Le)),Ea.call(this,z,ce,Se,Ue=Ue||"Identity-H")};var ms,Ai=t.lineWidth||.200025,_o=g.__private__.getLineWidth=g.getLineWidth=function(){return Ai},yr=g.__private__.setLineWidth=g.setLineWidth=function(z){return Ai=z,oe(E(R(z))+" w"),this};g.__private__.setLineDash=Pr.API.setLineDash=Pr.API.setLineDashPattern=function(z,ce){if(z=z||[],ce=ce||0,isNaN(ce)||!Array.isArray(z))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return z=z.map(function(Se){return E(R(Se))}).join(" "),ce=E(R(ce)),oe("["+z+"] "+ce+" d"),this};var So=g.__private__.getLineHeight=g.getLineHeight=function(){return je*ms};g.__private__.getLineHeight=g.getLineHeight=function(){return je*ms};var Co=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(z){return typeof(z=z||1.15)=="number"&&(ms=z),this},Yo=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return ms};Co(t.lineHeight);var Ys=g.__private__.getHorizontalCoordinate=function(z){return R(z)},Ss=g.__private__.getVerticalCoordinate=function(z){return I===C?z:Ot[H].mediaBox.topRightY-Ot[H].mediaBox.bottomLeftY-R(z)},Xo=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(z){return E(Ys(z))},un=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(z){return E(Ss(z))},zi=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return ln(zi)},g.__private__.setStrokeColor=g.setDrawColor=function(z,ce,Se,Le){return zi=hn({ch1:z,ch2:ce,ch3:Se,ch4:Le,pdfColorType:"draw",precision:2}),oe(zi),this};var Eo=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return ln(Eo)},g.__private__.setFillColor=g.setFillColor=function(z,ce,Se,Le){return Eo=hn({ch1:z,ch2:ce,ch3:Se,ch4:Le,pdfColorType:"fill",precision:2}),oe(Eo),this};var Ta=t.textColor||"0 g",xc=g.__private__.getTextColor=g.getTextColor=function(){return ln(Ta)};g.__private__.setTextColor=g.setTextColor=function(z,ce,Se,Le){return Ta=hn({ch1:z,ch2:ce,ch3:Se,ch4:Le,pdfColorType:"text",precision:3}),this};var Q=t.charSpace,be=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Q||0)};g.__private__.setCharSpace=g.setCharSpace=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Q=z,this};var Te=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(z){var ce=g.CapJoinStyles[z];if(ce===void 0)throw new Error("Line cap style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Te=ce,oe(ce+" J"),this};var it=0;g.__private__.setLineJoin=g.setLineJoin=function(z){var ce=g.CapJoinStyles[z];if(ce===void 0)throw new Error("Line join style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return it=ce,oe(ce+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(z){if(z=z||0,isNaN(z))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(E(R(z))+" M"),this},g.GState=ek,g.setGState=function(z){(z=typeof z=="string"?At[mt[z]]:Tr(null,z)).equals(Ft)||(oe("/"+z.id+" gs"),Ft=z)};var Tr=function(z,ce){if(!z||!mt[z]){var Se=!1;for(var Le in At)if(At.hasOwnProperty(Le)&&At[Le].equals(ce)){Se=!0;break}if(Se)ce=At[Le];else{var Ue="GS"+(Object.keys(At).length+1).toString(10);At[Ue]=ce,ce.id=Ue}return z&&(mt[z]=ce.id),Ct.publish("addGState",ce),ce}};g.addGState=function(z,ce){return Tr(z,ce),this},g.saveGraphicsState=function(){return oe("q"),lt.push({key:ut,size:je,color:Ta}),this},g.restoreGraphicsState=function(){oe("Q");var z=lt.pop();return ut=z.key,je=z.size,Ta=z.color,Ft=null,this},g.setCurrentTransformationMatrix=function(z){return oe(z.toString()+" cm"),this},g.comment=function(z){return oe("#"+z),this};var rr=function(z,ce){var Se=z||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Se},set:function(xt){isNaN(xt)||(Se=parseFloat(xt))}});var Le=ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Le},set:function(xt){isNaN(xt)||(Le=parseFloat(xt))}});var Ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ue},set:function(xt){Ue=xt.toString()}}),this},Xr=function(z,ce,Se,Le){rr.call(this,z,ce),this.type="rect";var Ue=Se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ue},set:function(Lt){isNaN(Lt)||(Ue=parseFloat(Lt))}});var xt=Le||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return xt},set:function(Lt){isNaN(Lt)||(xt=parseFloat(Lt))}}),this},en=function(){this.page=gt,this.currentPage=H,this.pages=fe.slice(0),this.pagesContext=Ot.slice(0),this.x=Dt,this.y=at,this.matrix=ft,this.width=Yn(H),this.height=us(H),this.outputDestination=le,this.id="",this.objectNumber=-1};en.prototype.restore=function(){gt=this.page,H=this.currentPage,Ot=this.pagesContext,fe=this.pages,Dt=this.x,at=this.y,ft=this.matrix,Xs(H,this.width),zn(H,this.height),le=this.outputDestination};var On=function(z,ce,Se,Le,Ue){sr.push(new en),gt=H=0,fe=[],Dt=z,at=ce,ft=Ue,sa([Se,Le])};for(var rn in g.beginFormObject=function(z,ce,Se,Le,Ue){return On(z,ce,Se,Le,Ue),this},g.endFormObject=function(z){return(function(ce){if(nr[ce])sr.pop().restore();else{var Se=new en,Le="Xo"+(Object.keys(Qt).length+1).toString(10);Se.id=Le,nr[ce]=Le,Qt[Le]=Se,Ct.publish("addFormObject",Se),sr.pop().restore()}})(z),this},g.doFormObject=function(z,ce){var Se=Qt[nr[z]];return oe("q"),oe(ce.toString()+" cm"),oe("/"+Se.id+" Do"),oe("Q"),this},g.getFormObject=function(z){var ce=Qt[nr[z]];return{x:ce.x,y:ce.y,width:ce.width,height:ce.height,matrix:ce.matrix}},g.save=function(z,ce){return z=z||"generated.pdf",(ce=ce||{}).returnPromise=ce.returnPromise||!1,ce.returnPromise===!1?(nm(pn(mi()),z),typeof nm.unload=="function"&&Jr.setTimeout&&setTimeout(nm.unload,911),this):new Promise(function(Se,Le){try{var Ue=nm(pn(mi()),z);typeof nm.unload=="function"&&Jr.setTimeout&&setTimeout(nm.unload,911),Se(Ue)}catch(xt){Le(xt.message)}})},Pr.API)Pr.API.hasOwnProperty(rn)&&(rn==="events"&&Pr.API.events.length?(function(z,ce){var Se,Le,Ue;for(Ue=ce.length-1;Ue!==-1;Ue--)Se=ce[Ue][0],Le=ce[Ue][1],z.subscribe.apply(z,[Se].concat(typeof Le=="function"?[Le]:Le))})(Ct,Pr.API.events):g[rn]=Pr.API[rn]);function Yn(z){return Ot[z].mediaBox.topRightX-Ot[z].mediaBox.bottomLeftX}function Xs(z,ce){Ot[z].mediaBox.topRightX=ce+Ot[z].mediaBox.bottomLeftX}function us(z){return Ot[z].mediaBox.topRightY-Ot[z].mediaBox.bottomLeftY}function zn(z,ce){Ot[z].mediaBox.topRightY=ce+Ot[z].mediaBox.bottomLeftY}var Jn=g.getPageWidth=function(z){return Yn(z=z||H)/Rt},to=g.setPageWidth=function(z,ce){Xs(z,ce*Rt)},ti=g.getPageHeight=function(z){return us(z=z||H)/Rt},ro=g.setPageHeight=function(z,ce){zn(z,ce*Rt)};return g.internal={pdfEscape:Bs,getStyle:jo,getFont:fa,getFontSize:Nt,getCharSpace:be,getTextColor:xc,getLineHeight:So,getLineHeightFactor:Yo,getLineWidth:_o,write:Oe,getHorizontalCoordinate:Ys,getVerticalCoordinate:Ss,getCoordinateString:Xo,getVerticalCoordinateString:un,collections:{},newObject:jt,newAdditionalObject:Ht,newObjectDeferred:zt,newObjectDeferredBegin:Mt,getFilters:cn,putStream:Ks,events:Ct,scaleFactor:Rt,pageSize:{getWidth:function(){return Jn(H)},setWidth:function(z){to(H,z)},getHeight:function(){return ti(H)},setHeight:function(z){ro(H,z)}},encryptionOptions:h,encryption:ss,getEncryptor:function(z){return h!==null?ss.encryptor(z,0):function(ce){return ce}},output:No,getNumberOfPages:Rl,get pages(){return fe},out:oe,f2:S,f3:P,getPageInfo:_s,getPageInfoByObjId:hl,getCurrentPageInfo:Dl,getPDFVersion:v,Point:rr,Rectangle:Xr,Matrix:Jt,hasHotfix:Fs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return Jn(H)},set:function(z){to(H,z)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return ti(H)},set:function(z){ro(H,z)},enumerable:!0,configurable:!0}),(function(z){for(var ce=0,Se=Ye.length;ce<Se;ce++){var Le=Ea.call(this,z[ce][0],z[ce][1],z[ce][2],Ye[ce][3],!0);f===!1&&(m[Le]=!0);var Ue=z[ce][0].split("-");tn({id:Le,fontName:Ue[0],fontStyle:Ue[1]||""})}Ct.publish("addFonts",{fonts:Bt,dictionary:De})}).call(g,Ye),ut="F1",Bi(s,r),Ct.publish("initialized"),g}qx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},qx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},qx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},qx.prototype.processOwnerPassword=function(t,e){return $8(F8(e).substr(0,5),t)},qx.prototype.encryptor=function(t,e){var r=F8(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return $8(r,n)}},ek.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Ns(t)!==Ns(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},Pr.API={events:[]},Pr.version="4.0.0";var Xi=Pr.API,DM=1,Tg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sx=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},on=function(t){return t.toFixed(2)},T0=function(t){return t.toFixed(5)};Xi.__acroform__={};var hc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},cH=function(t){return t*DM},Vd=function(t){var e=new $ae,r=xr.internal.getHeight(t)||0,n=xr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(on(n)),Number(on(r))],e},uBe=Xi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},dBe=Xi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},hBe=Xi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},la=Xi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return hBe(t,e-1)},ca=Xi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return uBe(t,e-1)},ua=Xi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return dBe(t,e-1)},fBe=Xi.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(a)||0,[Number(on(c.lowerLeft_X)),Number(on(c.lowerLeft_Y)),Number(on(c.upperRight_X)),Number(on(c.upperRight_Y))]},pBe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=U8(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+on(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Vd(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},U8=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(S){return S.split(`
`)}):s.map(function(S){return[S]});var a=r,o=xr.internal.getHeight(t)||0;o=o<0?-o:o;var l=xr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(S,P,R){if(S+1<s.length){var V=P+" "+s[S+1][0];return PN(V,t,R).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var u,h,f=PN("3",t,a).height,m=t.multiline?o-a:(o-f)/2,g=m+=2,y=0,v=0,w=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+PN(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var N="",k=0,C=0;C<s.length;C++)if(s.hasOwnProperty(C)){var I=!1;if(s[C].length!==1&&w!==s[C].length-1){if((f+2)*(k+2)+2>o)continue e;N+=s[C][w],I=!0,v=C,C--}else{N=(N+=s[C][w]+" ").substr(N.length-1)==" "?N.substr(0,N.length-1):N;var O=parseInt(C),L=c(O,N,a),_=C>=s.length-1;if(L&&!_){N+=" ",w=0;continue}if(L||_){if(_)v=O;else if(t.multiline&&(f+2)*(k+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(k+2)+2>o)continue e;v=O}}for(var E="",M=y;M<=v;M++){var B=s[M];if(t.multiline){if(M===v){E+=B[w]+" ",w=(w+1)%B.length;continue}if(M===y){E+=B[B.length-1]+" ";continue}}E+=B[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,h=PN(E,t,a).width,t.textAlign){case"right":u=l-h-2;break;case"center":u=(l-h)/2;break;default:u=2}e+=on(u)+" "+on(g)+` Td
`,e+="("+Tg(E)+`) Tj
`,e+=-on(u)+` 0 Td
`,g=-(a+2),h=0,y=I?v:v+1,k++,N=""}break}return n.text=e,n.fontSize=a,n},PN=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},mBe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gBe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},xBe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(wd.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(mBe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");DM=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Uae,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&gBe(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=fBe(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=xr.createDefaultAppearanceStream(l),Ns(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=pBe(l);c.push({key:"AP",value:"<</N "+h+">>"}),s.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var f="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var g=l.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var y=g[o];typeof y=="function"&&(y=y.call(s,l)),f+="/"+o+" "+y+" ",s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y)}}else typeof(y=g)=="function"&&(y=y.call(s,l)),f+="/"+o+" "+y,s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&(function(v,w){for(var N in v)if(v.hasOwnProperty(N)){var k=N,C=v[N];w.internal.newObjectDeferredBegin(C.objId,!0),Ns(C)==="object"&&typeof C.putStream=="function"&&C.putStream(),delete v[k]}})(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Fae=Xi.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),Ns(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Tg(n(t[a].toString()))+")"):s+=t[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},OA=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Tg(n(t))+")"},Jd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Jd.prototype.toString=function(){return this.objId+" 0 R"},Jd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Jd.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:Fae(s,this.objId,this.scope)}):s instanceof Jd?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var $ae=function(){Jd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};hc($ae,Jd);var Uae=function(){Jd.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Tg(r(t))+")"}},set:function(r){t=r}})};hc(Uae,Jd);var wd=function t(){Jd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute F supplied.');e=N}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!la(e,3)},set:function(N){N?this.F=ca(e,3):this.F=ua(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute Ff supplied.');r=N}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(N){n=N!==void 0?N:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(N){n[0]=N}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(N){n[1]=N}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(N){n[2]=N}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(N){n[3]=N}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(N){switch(N){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=N;break;default:throw new Error('Invalid value "'+N+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof tk)return;a="FieldObject"+t.FieldNum++}var N=function(k){return k};return this.scope&&(N=this.scope.internal.getEncryptor(this.objId)),"("+Tg(N(a))+")"},set:function(N){a=N.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(N){a=N}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(N){o=N}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(N){l=N}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(N){c=N}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/DM:u},set:function(N){u=N}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(N){h=N}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof tk||this instanceof Pm))return OA(f,this.objId,this.scope)},set:function(N){N=N.toString(),f=N}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof mo==0?OA(m,this.objId,this.scope):m},set:function(N){N=N.toString(),m=this instanceof mo==0?N.substr(0,1)==="("?Sx(N.substr(1,N.length-2)):Sx(N):N}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mo==1?Sx(m.substr(1,m.length-1)):m},set:function(N){N=N.toString(),m=this instanceof mo==1?"/"+N:N}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(N){this.V=N}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof mo==0?OA(g,this.objId,this.scope):g},set:function(N){N=N.toString(),g=this instanceof mo==0?N.substr(0,1)==="("?Sx(N.substr(1,N.length-2)):Sx(N):N}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mo==1?Sx(g.substr(1,g.length-1)):g},set:function(N){N=N.toString(),g=this instanceof mo==1?"/"+N:N}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(N){N=!!N,v=N}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(N){y=N}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,1)},set:function(N){N?this.Ff=ca(this.Ff,1):this.Ff=ua(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,2)},set:function(N){N?this.Ff=ca(this.Ff,2):this.Ff=ua(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,3)},set:function(N){N?this.Ff=ca(this.Ff,3):this.Ff=ua(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(N){if([0,1,2].indexOf(N)===-1)throw new Error('Invalid value "'+N+'" for attribute Q supplied.');w=N}}),Object.defineProperty(this,"textAlign",{get:function(){var N;switch(w){case 0:default:N="left";break;case 1:N="center";break;case 2:N="right"}return N},configurable:!0,enumerable:!0,set:function(N){switch(N){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};hc(wd,Jd);var by=function(){wd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Fae(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=(function(a,o,l){l||(l=1);for(var c,u=[];c=o.exec(a);)u.push(c[l]);return u})(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,18)},set:function(r){r?this.Ff=ca(this.Ff,18):this.Ff=ua(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ca(this.Ff,19):this.Ff=ua(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,20)},set:function(r){r?(this.Ff=ca(this.Ff,20),e.sort()):this.Ff=ua(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,22)},set:function(r){r?this.Ff=ca(this.Ff,22):this.Ff=ua(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,23)},set:function(r){r?this.Ff=ca(this.Ff,23):this.Ff=ua(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,27)},set:function(r){r?this.Ff=ca(this.Ff,27):this.Ff=ua(this.Ff,27)}}),this.hasAppearanceStream=!1};hc(by,wd);var vy=function(){by.call(this),this.fontName="helvetica",this.combo=!1};hc(vy,by);var wy=function(){vy.call(this),this.combo=!0};hc(wy,vy);var Fj=function(){wy.call(this),this.edit=!0};hc(Fj,wy);var mo=function(){wd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,15)},set:function(r){r?this.Ff=ca(this.Ff,15):this.Ff=ua(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,16)},set:function(r){r?this.Ff=ca(this.Ff,16):this.Ff=ua(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,17)},set:function(r){r?this.Ff=ca(this.Ff,17):this.Ff=ua(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,26)},set:function(r){r?this.Ff=ca(this.Ff,26):this.Ff=ua(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Tg(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Ns(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};hc(mo,wd);var $j=function(){mo.call(this),this.pushButton=!0};hc($j,mo);var Ny=function(){mo.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};hc(Ny,mo);var tk=function(){var t,e;wd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Tg(s(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Ns(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};hc(tk,wd),Ny.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Ny.prototype.createOption=function(t){var e=new tk;return e.Parent=this,e.optionName=t,this.Kids.push(e),yBe.call(this.scope,e),e};var Uj=function(){mo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xr.CheckBox.createAppearanceStream()};hc(Uj,mo);var Pm=function(){wd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,13)},set:function(e){e?this.Ff=ca(this.Ff,13):this.Ff=ua(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,21)},set:function(e){e?this.Ff=ca(this.Ff,21):this.Ff=ua(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,23)},set:function(e){e?this.Ff=ca(this.Ff,23):this.Ff=ua(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,24)},set:function(e){e?this.Ff=ca(this.Ff,24):this.Ff=ua(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,25)},set:function(e){e?this.Ff=ca(this.Ff,25):this.Ff=ua(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,26)},set:function(e){e?this.Ff=ca(this.Ff,26):this.Ff=ua(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};hc(Pm,wd);var zj=function(){Pm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,14)},set:function(t){t?this.Ff=ca(this.Ff,14):this.Ff=ua(this.Ff,14)}}),this.password=!0};hc(zj,Pm);var xr={CheckBox:{createAppearanceStream:function(){return{N:{On:xr.CheckBox.YesNormal},D:{On:xr.CheckBox.YesPushDown,Off:xr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=U8(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+on(xr.internal.getWidth(t))+" "+on(xr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+on(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Vd(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=xr.internal.getHeight(t),o=xr.internal.getWidth(t),l=U8(t,t.caption);return s.push("1 g"),s.push("0 0 "+on(o)+" "+on(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+on(o-1)+" "+on(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+on(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+on(xr.internal.getWidth(t))+" "+on(xr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:xr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=xr.RadioButton.Circle.YesNormal,e.D[t]=xr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Vd(t);e.scope=t.scope;var r=[],n=xr.internal.getWidth(t)<=xr.internal.getHeight(t)?xr.internal.getWidth(t)/4:xr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=xr.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+T0(xr.internal.getWidth(t)/2)+" "+T0(xr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=[],n=xr.internal.getWidth(t)<=xr.internal.getHeight(t)?xr.internal.getWidth(t)/4:xr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*xr.internal.Bezier_C).toFixed(5)),o=Number((n*xr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+T0(xr.internal.getWidth(t)/2)+" "+T0(xr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+T0(xr.internal.getWidth(t)/2)+" "+T0(xr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=[],n=xr.internal.getWidth(t)<=xr.internal.getHeight(t)?xr.internal.getWidth(t)/4:xr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*xr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+T0(xr.internal.getWidth(t)/2)+" "+T0(xr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:xr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=xr.RadioButton.Cross.YesNormal,e.D[t]=xr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Vd(t);e.scope=t.scope;var r=[],n=xr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+on(xr.internal.getWidth(t)-2)+" "+on(xr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(on(n.x1.x)+" "+on(n.x1.y)+" m"),r.push(on(n.x2.x)+" "+on(n.x2.y)+" l"),r.push(on(n.x4.x)+" "+on(n.x4.y)+" m"),r.push(on(n.x3.x)+" "+on(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=xr.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+on(xr.internal.getWidth(t))+" "+on(xr.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+on(xr.internal.getWidth(t)-2)+" "+on(xr.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(on(r.x1.x)+" "+on(r.x1.y)+" m"),n.push(on(r.x2.x)+" "+on(r.x2.y)+" l"),n.push(on(r.x4.x)+" "+on(r.x4.y)+" m"),n.push(on(r.x3.x)+" "+on(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Vd(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+on(xr.internal.getWidth(t))+" "+on(xr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};xr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=xr.internal.getWidth(t),r=xr.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},xr.internal.getWidth=function(t){var e=0;return Ns(t)==="object"&&(e=cH(t.Rect[2])),e},xr.internal.getHeight=function(t){var e=0;return Ns(t)==="object"&&(e=cH(t.Rect[3])),e};var yBe=Xi.addField=function(t){if(xBe(this,t),!(t instanceof wd))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Xi.AcroFormChoiceField=by,Xi.AcroFormListBox=vy,Xi.AcroFormComboBox=wy,Xi.AcroFormEditBox=Fj,Xi.AcroFormButton=mo,Xi.AcroFormPushButton=$j,Xi.AcroFormRadioButton=Ny,Xi.AcroFormCheckBox=Uj,Xi.AcroFormTextField=Pm,Xi.AcroFormPasswordField=zj,Xi.AcroFormAppearance=xr,Xi.AcroForm={ChoiceField:by,ListBox:vy,ComboBox:wy,EditBox:Fj,Button:mo,PushButton:$j,RadioButton:Ny,CheckBox:Uj,TextField:Pm,PasswordField:zj,Appearance:xr},Pr.AcroForm={ChoiceField:by,ListBox:vy,ComboBox:wy,EditBox:Fj,Button:mo,PushButton:$j,RadioButton:Ny,CheckBox:Uj,TextField:Pm,PasswordField:zj,Appearance:xr};Pr.AcroForm;function zae(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(S,P){var R,V,ee,G,J,Z=r;if((P=P||r)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(L(S))for(J in n)for(ee=n[J],R=0;R<ee.length;R+=1){for(G=!0,V=0;V<ee[R].length;V+=1)if(ee[R][V]!==void 0&&ee[R][V]!==S[V]){G=!1;break}if(G===!0){Z=J;break}}else for(J in n)for(ee=n[J],R=0;R<ee.length;R+=1){for(G=!0,V=0;V<ee[R].length;V+=1)if(ee[R][V]!==void 0&&ee[R][V]!==S.charCodeAt(V)){G=!1;break}if(G===!0){Z=J;break}}return Z===r&&P!==r&&(Z=P),Z},a=function S(P){for(var R=this.internal.write,V=this.internal.putStream,ee=(0,this.internal.getFilters)();ee.indexOf("FlateEncode")!==-1;)ee.splice(ee.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:P.width}),G.push({key:"Height",value:P.height}),P.colorSpace===N.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===N.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var J="",Z=0,se=P.transparency.length;Z<se;Z++)J+=P.transparency[Z]+" "+P.transparency[Z]+" ";G.push({key:"Mask",value:"["+J+"]"})}P.sMask!==void 0&&G.push({key:"SMask",value:P.objectId+1+" 0 R"});var X=P.filter!==void 0?["/"+P.filter]:void 0;if(V({data:P.data,additionalKeyValues:G,alreadyAppliedFilters:X,objectId:P.objectId}),R("endobj"),"sMask"in P&&P.sMask!==void 0){var q,U=(q=P.sMaskBitsPerComponent)!==null&&q!==void 0?q:P.bitsPerComponent,H={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:U,data:P.sMask};"filter"in P&&(H.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(U," /Columns ").concat(P.width),H.filter=P.filter),S.call(this,H)}if(P.colorSpace===N.INDEXED){var re=this.internal.newObject();V({data:E(new Uint8Array(P.palette)),objectId:re}),R("endobj")}},o=function(){var S=this.internal.collections[e+"images"];for(var P in S)a.call(this,S[P])},l=function(){var S,P=this.internal.collections[e+"images"],R=this.internal.write;for(var V in P)R("/I"+(S=P[V]).index,S.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var S=this.internal.collections[e+"images"];return c.call(this),S},h=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(S){return typeof t["process"+S.toUpperCase()]=="function"},m=function(S){return Ns(S)==="object"&&S.nodeType===1},g=function(S,P){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var R=""+S.getAttribute("src");if(R.indexOf("data:image/")===0)return Bj(unescape(R).split("base64,").pop());var V=t.loadFile(R,!0);if(V!==void 0)return V}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var ee;switch(P){case"PNG":ee="image/png";break;case"WEBP":ee="image/webp";break;default:ee="image/jpeg"}return Bj(S.toDataURL(ee,1).split("base64,").pop())}},y=function(S){var P=this.internal.collections[e+"images"];if(P){for(var R in P)if(S===P[R].alias)return P[R]}},v=function(S,P,R){return S||P||(S=-96,P=-96),S<0&&(S=-1*R.width*72/S/this.internal.scaleFactor),P<0&&(P=-1*R.height*72/P/this.internal.scaleFactor),S===0&&(S=P*R.width/R.height),P===0&&(P=S*R.height/R.width),[S,P]},w=function(S,P,R,V,ee,G){var J=v.call(this,R,V,ee),Z=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,X=u.call(this);if(R=J[0],V=J[1],X[ee.index]=ee,G){G*=Math.PI/180;var q=Math.cos(G),U=Math.sin(G),H=function(ae){return ae.toFixed(4)},re=[H(q),H(U),H(-1*U),H(q),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,Z(S),se(P+V),"cm"].join(" ")),this.internal.write(re.join(" ")),this.internal.write([Z(R),"0","0",Z(V),"0","0","cm"].join(" "))):this.internal.write([Z(R),"0","0",Z(V),Z(S),se(P+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ee.index+" Do"),this.internal.write("Q")},N=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},C=t.__addimage__.sHashCode=function(S){var P,R,V=0;if(typeof S=="string")for(R=S.length,P=0;P<R;P++)V=(V<<5)-V+S.charCodeAt(P),V|=0;else if(L(S))for(R=S.byteLength/2,P=0;P<R;P++)V=(V<<5)-V+S[P],V|=0;return V},I=t.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var P=!0;return S.length===0&&(P=!1),S.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(P=!1),P},O=t.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var P=S.indexOf(",");return P<0?null:S.substring(0,P).trim().endsWith("base64")?S.substring(P+1):null};t.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var L=t.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},_=t.__addimage__.binaryStringToUint8Array=function(S){for(var P=S.length,R=new Uint8Array(P),V=0;V<P;V++)R[V]=S.charCodeAt(V);return R},E=t.__addimage__.arrayBufferToBinaryString=function(S){for(var P="",R=L(S)?S:new Uint8Array(S),V=0;V<R.length;V+=8192)P+=String.fromCharCode.apply(null,R.subarray(V,V+8192));return P};t.addImage=function(){var S,P,R,V,ee,G,J,Z,se;if(typeof arguments[1]=="number"?(P=r,R=arguments[1],V=arguments[2],ee=arguments[3],G=arguments[4],J=arguments[5],Z=arguments[6],se=arguments[7]):(P=arguments[1],R=arguments[2],V=arguments[3],ee=arguments[4],G=arguments[5],J=arguments[6],Z=arguments[7],se=arguments[8]),Ns(S=arguments[0])==="object"&&!m(S)&&"imageData"in S){var X=S;S=X.imageData,P=X.format||P||r,R=X.x||R||0,V=X.y||V||0,ee=X.w||X.width||ee,G=X.h||X.height||G,J=X.alias||J,Z=X.compression||Z,se=X.rotation||X.angle||se}var q=this.internal.getFilters();if(Z===void 0&&q.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(R)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var U=M.call(this,S,P,J,Z);return w.call(this,R,V,ee,G,U,se),this};var M=function(S,P,R,V){var ee,G,J;if(typeof S=="string"&&s(S)===r){S=unescape(S);var Z=B(S,!1);(Z!==""||(Z=t.loadFile(S,!0))!==void 0)&&(S=Z)}if(m(S)&&(S=g(S,P)),P=s(S,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((J=R)==null||J.length===0)&&(R=(function(se){return typeof se=="string"||L(se)?C(se):L(se.data)?C(se.data):null})(S)),(ee=y.call(this,R))||(S instanceof Uint8Array||P==="RGBA"||(G=S,S=_(S)),ee=this["process"+P.toUpperCase()](S,h.call(this),R,(function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in t.image_compression?se:k.NONE})(V),G)),!ee)throw new Error("An unknown error occurred whilst processing the image.");return ee},B=t.__addimage__.convertBase64ToBinaryString=function(S,P){P=typeof P!="boolean"||P;var R,V="";if(typeof S=="string"){var ee;R=(ee=O(S))!==null&&ee!==void 0?ee:S;try{V=Bj(R)}catch(G){if(P)throw I(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(S){var P,R,V="";if(m(S)&&(S=g(S)),typeof S=="string"&&s(S)===r&&((V=B(S,!1))===""&&(V=t.loadFile(S)||""),S=V),R=s(S),!f(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(S instanceof Uint8Array||(S=_(S)),!(P=this["process"+R.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=R,P}})(Pr.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};Pr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,f=0;f<u.length&&!h;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var g=this.internal.pdfEscape,y=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),N=this.internal.getEncryptor(v.objId),k=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+g(N(n.contents))+")",a+=" /Popup "+w.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+g(N(k))+") >>",v.content=a;var C=v.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+C,n.open&&(a+=" /Open true"),a+=" >>",w.content=a,this.internal.write(v.objId,"0 R",w.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var I=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+g(y(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+I+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+g(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var L=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,s,a){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var h=this.splitTextToSize(r,l).length;o=Math.ceil(u*h)}else l=c,o=u;return this.text(r,n,s,a),s+=.2*u,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-u,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(Pr.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},l=t.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&s.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(v){var w=0,N=r,k="",C=0;for(w=0;w<v.length;w+=1)N[v.charCodeAt(w)]!==void 0?(C++,typeof(N=N[v.charCodeAt(w)])=="number"&&(k+=String.fromCharCode(N),N=r,C=0),w===v.length-1&&(N=r,k+=v.charAt(w-(C-1)),w-=C-1,C=0)):(N=r,k+=v.charAt(w-C),w-=C,C=0);return k};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var m=t.__arabicParser__.getCorrectForm=function(v,w,N){return o(v)?a(v)===!1?-1:!u(v)||!o(w)&&!o(N)||!o(N)&&l(w)||l(v)&&!o(w)||l(v)&&c(w)||l(v)&&l(w)?0:h(v)&&o(w)&&!l(w)&&o(N)&&u(N)?3:l(v)||!o(N)?1:2:-1},g=function(v){var w=0,N=0,k=0,C="",I="",O="",L=(v=v||"").split("\\s+"),_=[];for(w=0;w<L.length;w+=1){for(_.push(""),N=0;N<L[w].length;N+=1)C=L[w][N],I=L[w][N-1],O=L[w][N+1],o(C)?(k=m(C,I,O),_[w]+=k!==-1?String.fromCharCode(e[C.charCodeAt(0)][k]):C):_[w]+=C;_[w]=f(_[w])}return _.join(" ")},y=t.__arabicParser__.processArabic=t.processArabic=function(){var v,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,N=[];if(Array.isArray(w)){var k=0;for(N=[],k=0;k<w.length;k+=1)Array.isArray(w[k])?N.push([g(w[k][0]),w[k][1],w[k][2]]):N.push([g(w[k])]);v=N}else v=g(w);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",y])})(Pr.API),Pr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Pr.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(v){y=v}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,g=0,y=0,v=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var N=u.maxWidth;N>0?typeof c=="string"?c=this.splitTextToSize(c,N):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(C,I){return C.concat(w.splitTextToSize(I,N))},[])):c=Array.isArray(c)?c:[c];for(var k=0;k<c.length;k++)g<(v=this.getStringUnitWidth(c[k],{font:f})*h)&&(g=v);return g!==0&&(y=c.length),{w:g/=m,h:Math.max((y*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,g&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,f,m){if(n.call(this),!h)throw new Error("No data for PDF table.");var g,y,v,w,N=[],k=[],C=[],I={},O={},L=[],_=[],E=(m=m||{}).autoSize||!1,M=m.printHeaders!==!1,B=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,S=m.margins||Object.assign({width:this.getPageWidth()},e),P=typeof m.padding=="number"?m.padding:3,R=m.headerBackgroundColor||"#c8c8c8",V=m.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=V,this.setFontSize(B),f==null)k=N=Object.keys(h[0]),C=N.map(function(){return"left"});else if(Array.isArray(f)&&Ns(f[0])==="object")for(N=f.map(function(X){return X.name}),k=f.map(function(X){return X.prompt||X.name||""}),C=f.map(function(X){return X.align||"left"}),g=0;g<f.length;g+=1)O[f[g].name]=.7499990551181103*f[g].width;else Array.isArray(f)&&typeof f[0]=="string"&&(k=N=f,C=N.map(function(){return"left"}));if(E||Array.isArray(f)&&typeof f[0]=="string")for(g=0;g<N.length;g+=1){for(I[w=N[g]]=h.map(function(X){return X[w]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(k[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=I[w],this.setFont(void 0,"normal"),v=0;v<y.length;v+=1)L.push(this.getTextDimensions(y[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[w]=Math.max.apply(null,L)+P+P,L=[]}if(M){var ee={};for(g=0;g<N.length;g+=1)ee[N[g]]={},ee[N[g]].text=k[g],ee[N[g]].align=C[g];var G=l.call(this,ee,O);_=N.map(function(X){return new a(c,u,O[X],G,ee[X].text,void 0,ee[X].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var J=f.reduce(function(X,q){return X[q.name]=q.align,X},{});for(g=0;g<h.length;g+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:g,data:h[g]},this);var Z=l.call(this,h[g],O);for(v=0;v<N.length;v+=1){var se=h[g][N[v]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:g,col:v,data:se},this),o.call(this,new a(c,u,O[N[v]],Z,se,g+2,J[N[v]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var h=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(g){var y=c[g];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,u[g]-h-h)},this).map(function(g){return this.getLineHeightFactor()*g.length*f/m+h+h},this).reduce(function(g,y){return Math.max(g,y)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){h=this.internal.__cell__.tableHeaderRow[g].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,h),this.setTextColor(y)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}})(Pr.API);var Vae={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qae=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],z8=zae(qae),Hae=[100,200,300,400,500,600,700,800,900],bBe=zae(Hae);function MA(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return Vae[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),s=(function(a){return typeof z8[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function uH(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var vBe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},dH={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function hH(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function fH(t){return t.trimLeft()}function wBe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function NBe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var LN,pH,mH,Cx,ON,gH,xH,yH,RA=["times"];function bH(t,e,r,n,s){var a=4,o=wH;switch(s){case Pr.API.image_compression.FAST:a=1,o=vH;break;case Pr.API.image_compression.MEDIUM:a=6,o=NH;break;case Pr.API.image_compression.SLOW:a=9,o=jH}t=(function(c,u,h,f){for(var m,g=c.length/u,y=new Uint8Array(c.length+g),v=[jBe,vH,wH,NH,jH],w=0;w<g;w+=1){var N=w*u,k=c.subarray(N,N+u);if(f)y.set(f(k,h,m),N+w);else{for(var C=v.length,I=[],O=0;O<C;O+=1)I[O]=v[O](k,h,m);var L=_Be(I.concat());y.set(I[L],N+w)}m=k}return y})(t,e,Math.ceil(r*n/8),o);var l=M8(t,{level:a});return Pr.API.__addimage__.arrayBufferToBinaryString(l)}function jBe(t){var e=Array.apply([],t);return e.unshift(0),e}function vH(t,e){var r=t.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=t[s-e]||0;n[s+1]=t[s]-a+256&255}return n}function wH(t,e,r){var n=t.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;s[a+1]=t[a]-o+256&255}return s}function NH(t,e,r){var n=t.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;s[a+1]=t[a]+256-(o+l>>>1)&255}return s}function jH(t,e,r){var n=t.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var o=kBe(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);s[a+1]=t[a]-o+256&255}return s}function kBe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),s=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=s&&n<=a?t:s<=a?e:r}function _Be(t){var e=t.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function DA(t,e,r){var n=e*r,s=Math.floor(n/8),a=16-(n-8*s+r),o=(1<<r)-1;return Wae(t,s)>>a&o}function kH(t,e,r,n){var s=r*n,a=Math.floor(s/8),o=16-(s-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,h,f){if(h+1<u.byteLength)u.setUint16(h,f,!1);else{var m=f>>8&255;u.setUint8(h,m)}})(t,a,Wae(t,a)&~(l<<o)&65535|c)}function Wae(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function SBe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var u=!0,h=[],f=0,m=null,g=0,y=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,y=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[e++];f=t[e++]|t[e++]<<8,m=t[e++],1&v||(m=null),g=v>>2&7,e++;break;case 254:for(;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,I=t[e++],O=I>>6&1,L=1<<1+(7&I),_=l,E=c,M=!1;I>>7&&(M=!0,_=e,E=L,e+=3*L);var B=e;for(e++;;){var S;if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}h.push({x:w,y:N,width:k,height:C,has_local_palette:M,palette_offset:_,palette_size:E,data_offset:B,data_length:e-B,transparent_index:m,interlaced:!!O,delay:f,disposal:g});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return y},this.frameInfo=function(P){if(P<0||P>=h.length)throw new Error("Frame index out of range.");return h[P]},this.decodeAndBlitFrameBGRA=function(P,R){var V=this.frameInfo(P),ee=V.width*V.height,G=new Uint8Array(ee);_H(t,V.data_offset,G,ee);var J=V.palette_offset,Z=V.transparent_index;Z===null&&(Z=256);var se=V.width,X=r-se,q=se,U=4*(V.y*r+V.x),H=4*((V.y+V.height)*r+V.x),re=U,ae=4*X;V.interlaced===!0&&(ae+=4*r*7);for(var xe=8,Ne=0,pe=G.length;Ne<pe;++Ne){var K=G[Ne];if(q===0&&(q=se,(re+=ae)>=H&&(ae=4*X+4*r*(xe-1),re=U+(se+X)*(xe<<1),xe>>=1)),K===Z)re+=4;else{var ue=t[J+3*K],fe=t[J+3*K+1],he=t[J+3*K+2];R[re++]=he,R[re++]=fe,R[re++]=ue,R[re++]=255}--q}},this.decodeAndBlitFrameRGBA=function(P,R){var V=this.frameInfo(P),ee=V.width*V.height,G=new Uint8Array(ee);_H(t,V.data_offset,G,ee);var J=V.palette_offset,Z=V.transparent_index;Z===null&&(Z=256);var se=V.width,X=r-se,q=se,U=4*(V.y*r+V.x),H=4*((V.y+V.height)*r+V.x),re=U,ae=4*X;V.interlaced===!0&&(ae+=4*r*7);for(var xe=8,Ne=0,pe=G.length;Ne<pe;++Ne){var K=G[Ne];if(q===0&&(q=se,(re+=ae)>=H&&(ae=4*X+4*r*(xe-1),re=U+(se+X)*(xe<<1),xe>>=1)),K===Z)re+=4;else{var ue=t[J+3*K],fe=t[J+3*K+1],he=t[J+3*K+2];R[re++]=ue,R[re++]=fe,R[re++]=he,R[re++]=255}--q}}}function _H(t,e,r,n){for(var s=t[e++],a=1<<s,o=a+1,l=o+1,c=s+1,u=(1<<c)-1,h=0,f=0,m=0,g=t[e++],y=new Int32Array(4096),v=null;;){for(;h<16&&g!==0;)f|=t[e++]<<h,h+=8,g===1?g=t[e++]:--g;if(h<c)break;var w=f&u;if(f>>=c,h-=c,w!==a){if(w===o)break;for(var N=w<l?w:v,k=0,C=N;C>a;)C=y[C]>>8,++k;var I=C;if(m+k+(N!==w?1:0)>n)return void qs.log("Warning, gif stream longer than expected.");r[m++]=I;var O=m+=k;for(N!==w&&(r[m++]=I),C=N;k--;)C=y[C],r[--O]=255&C,C>>=8;v!==null&&l<4096&&(y[l++]=v<<8|I,l>=u+1&&c<12&&(++c,u=u<<1|1)),v=w}else l=o+1,u=(1<<(c=s+1))-1,v=null}return m!==n&&qs.log("Warning, gif stream shorter than expected."),r}function BA(t){var e,r,n,s,a,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),f=new Array(65535),m=new Array(65535),g=new Array(64),y=new Array(64),v=[],w=0,N=7,k=new Array(64),C=new Array(64),I=new Array(64),O=new Array(256),L=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ee=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(U,H){for(var re=0,ae=0,xe=new Array,Ne=1;Ne<=16;Ne++){for(var pe=1;pe<=U[Ne];pe++)xe[H[ae]]=[],xe[H[ae]][0]=re,xe[H[ae]][1]=Ne,ae++,re++;re*=2}return xe}function J(U){for(var H=U[0],re=U[1]-1;re>=0;)H&1<<re&&(w|=1<<N),re--,--N<0&&(w==255?(Z(255),Z(0)):Z(w),N=7,w=0)}function Z(U){v.push(U)}function se(U){Z(U>>8&255),Z(255&U)}function X(U,H,re,ae,xe){for(var Ne,pe=xe[0],K=xe[240],ue=(function(je,Fe){var Nt,$t,Ut,nt,bt,It,_t,wt,ut,Rt,Dt=0;for(ut=0;ut<8;++ut){Nt=je[Dt],$t=je[Dt+1],Ut=je[Dt+2],nt=je[Dt+3],bt=je[Dt+4],It=je[Dt+5],_t=je[Dt+6];var at=Nt+(wt=je[Dt+7]),ft=Nt-wt,Bt=$t+_t,De=$t-_t,lt=Ut+It,ht=Ut-It,Pt=nt+bt,At=nt-bt,mt=at+Pt,Ft=at-Pt,gt=Bt+lt,Ot=Bt-lt;je[Dt]=mt+gt,je[Dt+4]=mt-gt;var Ct=.707106781*(Ot+Ft);je[Dt+2]=Ft+Ct,je[Dt+6]=Ft-Ct;var Xt=.382683433*((mt=At+ht)-(Ot=De+ft)),Qt=.5411961*mt+Xt,nr=1.306562965*Ot+Xt,sr=.707106781*(gt=ht+De),Jt=ft+sr,kr=ft-sr;je[Dt+5]=kr+Qt,je[Dt+3]=kr-Qt,je[Dt+1]=Jt+nr,je[Dt+7]=Jt-nr,Dt+=8}for(Dt=0,ut=0;ut<8;++ut){Nt=je[Dt],$t=je[Dt+8],Ut=je[Dt+16],nt=je[Dt+24],bt=je[Dt+32],It=je[Dt+40],_t=je[Dt+48];var Ae=Nt+(wt=je[Dt+56]),Ke=Nt-wt,Gt=$t+_t,jt=$t-_t,zt=Ut+It,Mt=Ut-It,Ht=nt+bt,vr=nt-bt,Fr=Ae+Ht,ln=Ae-Ht,hn=Gt+zt,cn=Gt-zt;je[Dt]=Fr+hn,je[Dt+32]=Fr-hn;var Ks=.707106781*(cn+ln);je[Dt+16]=ln+Ks,je[Dt+48]=ln-Ks;var Ci=.382683433*((Fr=vr+Mt)-(cn=jt+Ke)),Ds=.5411961*Fr+Ci,ps=1.306562965*cn+Ci,$e=.707106781*(hn=Mt+jt),Xe=Ke+$e,ct=Ke-$e;je[Dt+40]=ct+Ds,je[Dt+24]=ct-Ds,je[Dt+8]=Xe+ps,je[Dt+56]=Xe-ps,Dt++}for(ut=0;ut<64;++ut)Rt=je[ut]*Fe[ut],g[ut]=Rt>0?Rt+.5|0:Rt-.5|0;return g})(U,H),fe=0;fe<64;++fe)y[_[fe]]=ue[fe];var he=y[0]-re;re=y[0],he==0?J(ae[0]):(J(ae[m[Ne=32767+he]]),J(f[Ne]));for(var le=63;le>0&&y[le]==0;)le--;if(le==0)return J(pe),re;for(var _e,oe=1;oe<=le;){for(var Oe=oe;y[oe]==0&&oe<=le;)++oe;var ze=oe-Oe;if(ze>=16){_e=ze>>4;for(var Ye=1;Ye<=_e;++Ye)J(K);ze&=15}Ne=32767+y[oe],J(xe[(ze<<4)+m[Ne]]),J(f[Ne]),oe++}return le!=63&&J(pe),re}function q(U){U=Math.min(Math.max(U,1),100),a!=U&&((function(H){for(var re=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ae=0;ae<64;ae++){var xe=o((re[ae]*H+50)/100);xe=Math.min(Math.max(xe,1),255),l[_[ae]]=xe}for(var Ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var K=o((Ne[pe]*H+50)/100);K=Math.min(Math.max(K,1),255),c[_[pe]]=K}for(var ue=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],fe=0,he=0;he<8;he++)for(var le=0;le<8;le++)u[fe]=1/(l[_[fe]]*ue[he]*ue[le]*8),h[fe]=1/(c[_[fe]]*ue[he]*ue[le]*8),fe++})(U<50?Math.floor(5e3/U):Math.floor(200-2*U)),a=U)}this.encode=function(U,H){H&&q(H),v=new Array,w=0,N=7,se(65496),se(65504),se(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),se(1),se(1),Z(0),Z(0),(function(){se(65499),se(132),Z(0);for(var $t=0;$t<64;$t++)Z(l[$t]);Z(1);for(var Ut=0;Ut<64;Ut++)Z(c[Ut])})(),(function($t,Ut){se(65472),se(17),Z(8),se(Ut),se($t),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)})(U.width,U.height),(function(){se(65476),se(418),Z(0);for(var $t=0;$t<16;$t++)Z(E[$t+1]);for(var Ut=0;Ut<=11;Ut++)Z(M[Ut]);Z(16);for(var nt=0;nt<16;nt++)Z(B[nt+1]);for(var bt=0;bt<=161;bt++)Z(S[bt]);Z(1);for(var It=0;It<16;It++)Z(P[It+1]);for(var _t=0;_t<=11;_t++)Z(R[_t]);Z(17);for(var wt=0;wt<16;wt++)Z(V[wt+1]);for(var ut=0;ut<=161;ut++)Z(ee[ut])})(),se(65498),se(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var re=0,ae=0,xe=0;w=0,N=7,this.encode.displayName="_encode_";for(var Ne,pe,K,ue,fe,he,le,_e,oe,Oe=U.data,ze=U.width,Ye=U.height,je=4*ze,Fe=0;Fe<Ye;){for(Ne=0;Ne<je;){for(fe=je*Fe+Ne,le=-1,_e=0,oe=0;oe<64;oe++)he=fe+(_e=oe>>3)*je+(le=4*(7&oe)),Fe+_e>=Ye&&(he-=je*(Fe+1+_e-Ye)),Ne+le>=je&&(he-=Ne+le-je+4),pe=Oe[he++],K=Oe[he++],ue=Oe[he++],k[oe]=(L[pe]+L[K+256|0]+L[ue+512|0]>>16)-128,C[oe]=(L[pe+768|0]+L[K+1024|0]+L[ue+1280|0]>>16)-128,I[oe]=(L[pe+1280|0]+L[K+1536|0]+L[ue+1792|0]>>16)-128;re=X(k,u,re,e,n),ae=X(C,h,ae,r,s),xe=X(I,h,xe,r,s),Ne+=32}Fe+=8}if(N>=0){var Nt=[];Nt[1]=N+1,Nt[0]=(1<<N+1)-1,J(Nt)}return se(65497),new Uint8Array(v)},t=t||50,(function(){for(var U=String.fromCharCode,H=0;H<256;H++)O[H]=U(H)})(),e=G(E,M),r=G(P,R),n=G(B,S),s=G(V,ee),(function(){for(var U=1,H=2,re=1;re<=15;re++){for(var ae=U;ae<H;ae++)m[32767+ae]=re,f[32767+ae]=[],f[32767+ae][1]=re,f[32767+ae][0]=ae;for(var xe=-(H-1);xe<=-U;xe++)m[32767+xe]=re,f[32767+xe]=[],f[32767+xe][1]=re,f[32767+xe][0]=H-1+xe;U<<=1,H<<=1}})(),(function(){for(var U=0;U<256;U++)L[U]=19595*U,L[U+256|0]=38470*U,L[U+512|0]=7471*U+32768,L[U+768|0]=-11059*U,L[U+1024|0]=-21709*U,L[U+1280|0]=32768*U+8421375,L[U+1536|0]=-27439*U,L[U+1792|0]=-5329*U})(),q(t)}function Vu(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function SH(t){function e(M){if(!M)throw Error("assert :P")}function r(M,B,S){for(var P=0;4>P;P++)if(M[B+P]!=S.charCodeAt(P))return!0;return!1}function n(M,B,S,P,R){for(var V=0;V<R;V++)M[B+V]=S[P+V]}function s(M,B,S,P){for(var R=0;R<P;R++)M[B+R]=S}function a(M){return new Int32Array(M)}function o(M,B){for(var S=[],P=0;P<M;P++)S.push(new B);return S}function l(M,B){var S=[];return(function P(R,V,ee){for(var G=ee[V],J=0;J<G&&(R.push(ee.length>V+1?[]:new B),!(ee.length<V+1));J++)P(R[J],V+1,ee)})(S,0,M),S}var c=function(){var M=this;function B(A,F){for(var W=1<<F-1>>>0;A&W;)W>>>=1;return W?(A&W-1)+W:A}function S(A,F,W,te,de){e(!(te%W));do A[F+(te-=W)]=de;while(0<te)}function P(A,F,W,te,de){if(e(2328>=de),512>=de)var me=a(512);else if((me=a(de))==null)return 0;return(function(ge,ve,ke,Ee,Me,Qe){var Ce,Be,We=ve,pt=1<<ke,Ge=a(16),dt=a(16);for(e(Me!=0),e(Ee!=null),e(ge!=null),e(0<ke),Be=0;Be<Me;++Be){if(15<Ee[Be])return 0;++Ge[Ee[Be]]}if(Ge[0]==Me)return 0;for(dt[1]=0,Ce=1;15>Ce;++Ce){if(Ge[Ce]>1<<Ce)return 0;dt[Ce+1]=dt[Ce]+Ge[Ce]}for(Be=0;Be<Me;++Be)Ce=Ee[Be],0<Ee[Be]&&(Qe[dt[Ce]++]=Be);if(dt[15]==1)return(Ee=new R).g=0,Ee.value=Qe[0],S(ge,We,1,pt,Ee),pt;var vt,Wt=-1,Tt=pt-1,mr=0,ir=1,Qr=1,dr=1<<ke;for(Be=0,Ce=1,Me=2;Ce<=ke;++Ce,Me<<=1){if(ir+=Qr<<=1,0>(Qr-=Ge[Ce]))return 0;for(;0<Ge[Ce];--Ge[Ce])(Ee=new R).g=Ce,Ee.value=Qe[Be++],S(ge,We+mr,Me,dr,Ee),mr=B(mr,Ce)}for(Ce=ke+1,Me=2;15>=Ce;++Ce,Me<<=1){if(ir+=Qr<<=1,0>(Qr-=Ge[Ce]))return 0;for(;0<Ge[Ce];--Ge[Ce]){if(Ee=new R,(mr&Tt)!=Wt){for(We+=dr,vt=1<<(Wt=Ce)-ke;15>Wt&&!(0>=(vt-=Ge[Wt]));)++Wt,vt<<=1;pt+=dr=1<<(vt=Wt-ke),ge[ve+(Wt=mr&Tt)].g=vt+ke,ge[ve+Wt].value=We-ve-Wt}Ee.g=Ce-ke,Ee.value=Qe[Be++],S(ge,We+(mr>>ke),Me,dr,Ee),mr=B(mr,Ce)}}return ir!=2*dt[15]-1?0:pt})(A,F,W,te,de,me)}function R(){this.value=this.g=0}function V(){this.value=this.g=0}function ee(){this.G=o(5,R),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(kd,V)}function G(A,F,W,te){e(A!=null),e(F!=null),e(2147483648>te),A.Ca=254,A.I=0,A.b=-8,A.Ka=0,A.oa=F,A.pa=W,A.Jd=F,A.Yc=W+te,A.Zc=4<=te?W+te-4+1:W,pe(A)}function J(A,F){for(var W=0;0<F--;)W|=ue(A,128)<<F;return W}function Z(A,F){var W=J(A,F);return K(A)?-W:W}function se(A,F,W,te){var de,me=0;for(e(A!=null),e(F!=null),e(4294967288>te),A.Sb=te,A.Ra=0,A.u=0,A.h=0,4<te&&(te=4),de=0;de<te;++de)me+=F[W+de]<<8*de;A.Ra=me,A.bb=te,A.oa=F,A.pa=W}function X(A){for(;8<=A.u&&A.bb<A.Sb;)A.Ra>>>=8,A.Ra+=A.oa[A.pa+A.bb]<<Vc-8>>>0,++A.bb,A.u-=8;ae(A)&&(A.h=1,A.u=0)}function q(A,F){if(e(0<=F),!A.h&&F<=To){var W=re(A)&Qo[F];return A.u+=F,X(A),W}return A.h=1,A.u=0}function U(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function re(A){return A.Ra>>>(A.u&Vc-1)>>>0}function ae(A){return e(A.bb<=A.Sb),A.h||A.bb==A.Sb&&A.u>Vc}function xe(A,F){A.u=F,A.h=ae(A)}function Ne(A){A.u>=qc&&(e(A.u>=qc),X(A))}function pe(A){e(A!=null&&A.oa!=null),A.pa<A.Zc?(A.I=(A.oa[A.pa++]|A.I<<8)>>>0,A.b+=8):(e(A!=null&&A.oa!=null),A.pa<A.Yc?(A.b+=8,A.I=A.oa[A.pa++]|A.I<<8):A.Ka?A.b=0:(A.I<<=8,A.b+=8,A.Ka=1))}function K(A){return J(A,1)}function ue(A,F){var W=A.Ca;0>A.b&&pe(A);var te=A.b,de=W*F>>>8,me=(A.I>>>te>de)+0;for(me?(W-=de,A.I-=de+1<<te>>>0):W=de+1,te=W,de=0;256<=te;)de+=8,te>>=8;return te=7^de+Au[te],A.b-=te,A.Ca=(W<<te)-1,me}function fe(A,F,W){A[F+0]=W>>24&255,A[F+1]=W>>16&255,A[F+2]=W>>8&255,A[F+3]=255&W}function he(A,F){return A[F+0]|A[F+1]<<8}function le(A,F){return he(A,F)|A[F+2]<<16}function _e(A,F){return he(A,F)|he(A,F+2)<<16}function oe(A,F){var W=1<<F;return e(A!=null),e(0<F),A.X=a(W),A.X==null?0:(A.Mb=32-F,A.Xa=F,1)}function Oe(A,F){e(A!=null),e(F!=null),e(A.Xa==F.Xa),n(F.X,0,A.X,0,1<<F.Xa)}function ze(){this.X=[],this.Xa=this.Mb=0}function Ye(A,F,W,te){e(W!=null),e(te!=null);var de=W[0],me=te[0];return de==0&&(de=(A*me+F/2)/F),me==0&&(me=(F*de+A/2)/A),0>=de||0>=me?0:(W[0]=de,te[0]=me,1)}function je(A,F){return A+(1<<F)-1>>>F}function Fe(A,F){return((4278255360&A)+(4278255360&F)>>>0&4278255360)+((16711935&A)+(16711935&F)>>>0&16711935)>>>0}function Nt(A,F){M[F]=function(W,te,de,me,ge,ve,ke){var Ee;for(Ee=0;Ee<ge;++Ee){var Me=M[A](ve[ke+Ee-1],de,me+Ee);ve[ke+Ee]=Fe(W[te+Ee],Me)}}}function $t(){this.ud=this.hd=this.jd=0}function Ut(A,F){return((4278124286&(A^F))>>>1)+(A&F)>>>0}function nt(A){return 0<=A&&256>A?A:0>A?0:255<A?255:void 0}function bt(A,F){return nt(A+(A-F+.5>>1))}function It(A,F,W){return Math.abs(F-W)-Math.abs(A-W)}function _t(A,F,W,te,de,me,ge){for(te=me[ge-1],W=0;W<de;++W)me[ge+W]=te=Fe(A[F+W],te)}function wt(A,F,W,te,de){var me;for(me=0;me<W;++me){var ge=A[F+me],ve=ge>>8&255,ke=16711935&(ke=(ke=16711935&ge)+((ve<<16)+ve));te[de+me]=(4278255360&ge)+ke>>>0}}function ut(A,F){F.jd=255&A,F.hd=A>>8&255,F.ud=A>>16&255}function Rt(A,F,W,te,de,me){var ge;for(ge=0;ge<te;++ge){var ve=F[W+ge],ke=ve>>>8,Ee=ve,Me=255&(Me=(Me=ve>>>16)+((A.jd<<24>>24)*(ke<<24>>24)>>>5));Ee=255&(Ee=(Ee+=(A.hd<<24>>24)*(ke<<24>>24)>>>5)+((A.ud<<24>>24)*(Me<<24>>24)>>>5)),de[me+ge]=(4278255360&ve)+(Me<<16)+Ee}}function Dt(A,F,W,te,de){M[F]=function(me,ge,ve,ke,Ee,Me,Qe,Ce,Be){for(ke=Qe;ke<Ce;++ke)for(Qe=0;Qe<Be;++Qe)Ee[Me++]=de(ve[te(me[ge++])])},M[A]=function(me,ge,ve,ke,Ee,Me,Qe){var Ce=8>>me.b,Be=me.Ea,We=me.K[0],pt=me.w;if(8>Ce)for(me=(1<<me.b)-1,pt=(1<<Ce)-1;ge<ve;++ge){var Ge,dt=0;for(Ge=0;Ge<Be;++Ge)Ge&me||(dt=te(ke[Ee++])),Me[Qe++]=de(We[dt&pt]),dt>>=Ce}else M["VP8LMapColor"+W](ke,Ee,We,pt,Me,Qe,ge,ve,Be)}}function at(A,F,W,te,de){for(W=F+W;F<W;){var me=A[F++];te[de++]=me>>16&255,te[de++]=me>>8&255,te[de++]=255&me}}function ft(A,F,W,te,de){for(W=F+W;F<W;){var me=A[F++];te[de++]=me>>16&255,te[de++]=me>>8&255,te[de++]=255&me,te[de++]=me>>24&255}}function Bt(A,F,W,te,de){for(W=F+W;F<W;){var me=(ge=A[F++])>>16&240|ge>>12&15,ge=240&ge|ge>>28&15;te[de++]=me,te[de++]=ge}}function De(A,F,W,te,de){for(W=F+W;F<W;){var me=(ge=A[F++])>>16&248|ge>>13&7,ge=ge>>5&224|ge>>3&31;te[de++]=me,te[de++]=ge}}function lt(A,F,W,te,de){for(W=F+W;F<W;){var me=A[F++];te[de++]=255&me,te[de++]=me>>8&255,te[de++]=me>>16&255}}function ht(A,F,W,te,de,me){if(me==0)for(W=F+W;F<W;)fe(te,((me=A[F++])[0]>>24|me[1]>>8&65280|me[2]<<8&16711680|me[3]<<24)>>>0),de+=32;else n(te,de,A,F,W)}function Pt(A,F){M[F][0]=M[A+"0"],M[F][1]=M[A+"1"],M[F][2]=M[A+"2"],M[F][3]=M[A+"3"],M[F][4]=M[A+"4"],M[F][5]=M[A+"5"],M[F][6]=M[A+"6"],M[F][7]=M[A+"7"],M[F][8]=M[A+"8"],M[F][9]=M[A+"9"],M[F][10]=M[A+"10"],M[F][11]=M[A+"11"],M[F][12]=M[A+"12"],M[F][13]=M[A+"13"],M[F][14]=M[A+"0"],M[F][15]=M[A+"0"]}function At(A){return A==$p||A==$g||A==r0||A==Ug}function mt(){this.eb=[],this.size=this.A=this.fb=0}function Ft(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function gt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new mt,this.f.kb=new Ft,this.sd=null}function Ot(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xt(A){return alert("todo:WebPSamplerProcessPlane"),A.T}function Qt(A,F){var W=A.T,te=F.ba.f.RGBA,de=te.eb,me=te.fb+A.ka*te.A,ge=Ra[F.ba.S],ve=A.y,ke=A.O,Ee=A.f,Me=A.N,Qe=A.ea,Ce=A.W,Be=F.cc,We=F.dc,pt=F.Mc,Ge=F.Nc,dt=A.ka,vt=A.ka+A.T,Wt=A.U,Tt=Wt+1>>1;for(dt==0?ge(ve,ke,null,null,Ee,Me,Qe,Ce,Ee,Me,Qe,Ce,de,me,null,null,Wt):(ge(F.ec,F.fc,ve,ke,Be,We,pt,Ge,Ee,Me,Qe,Ce,de,me-te.A,de,me,Wt),++W);dt+2<vt;dt+=2)Be=Ee,We=Me,pt=Qe,Ge=Ce,Me+=A.Rc,Ce+=A.Rc,me+=2*te.A,ge(ve,(ke+=2*A.fa)-A.fa,ve,ke,Be,We,pt,Ge,Ee,Me,Qe,Ce,de,me-te.A,de,me,Wt);return ke+=A.fa,A.j+vt<A.o?(n(F.ec,F.fc,ve,ke,Wt),n(F.cc,F.dc,Ee,Me,Tt),n(F.Mc,F.Nc,Qe,Ce,Tt),W--):1&vt||ge(ve,ke,null,null,Ee,Me,Qe,Ce,Ee,Me,Qe,Ce,de,me+te.A,null,null,Wt),W}function nr(A,F,W){var te=A.F,de=[A.J];if(te!=null){var me=A.U,ge=F.ba.S,ve=ge==Fp||ge==r0;F=F.ba.f.RGBA;var ke=[0],Ee=A.ka;ke[0]=A.T,A.Kb&&(Ee==0?--ke[0]:(--Ee,de[0]-=A.width),A.j+A.ka+A.T==A.o&&(ke[0]=A.o-A.j-Ee));var Me=F.eb;Ee=F.fb+Ee*F.A,A=Mp(te,de[0],A.width,me,ke,Me,Ee+(ve?0:3),F.A),e(W==ke),A&&At(ge)&&Ah(Me,Ee,ve,me,ke,F.A)}return 0}function sr(A){var F=A.ma,W=F.ba.S,te=11>W,de=W==io||W==zl||W==Fp||W==t0||W==12||At(W);if(F.memory=null,F.Ib=null,F.Jb=null,F.Nd=null,!Eu(F.Oa,A,de?11:12))return 0;if(de&&At(W)&&Yr(),A.da)alert("todo:use_scaling");else{if(te){if(F.Ib=Xt,A.Kb){if(W=A.U+1>>1,F.memory=a(A.U+2*W),F.memory==null)return 0;F.ec=F.memory,F.fc=0,F.cc=F.ec,F.dc=F.fc+A.U,F.Mc=F.cc,F.Nc=F.dc+W,F.Ib=Qt,Yr()}}else alert("todo:EmitYUV");de&&(F.Jb=nr,te&&tt())}if(te&&!Id){for(A=0;256>A;++A)Da[A]=89858*(A-128)+i0>>Kl,N3[A]=-22014*(A-128)+i0,Zw[A]=-45773*(A-128),Wg[A]=113618*(A-128)+i0>>Kl;for(A=Lh;A<Td;++A)F=76283*(A-16)+i0>>Kl,j3[A-Lh]=ia(F,255),k3[A-Lh]=ia(F+8>>4,15);Id=1}return 1}function Jt(A){var F=A.ma,W=A.U,te=A.T;return e(!(1&A.ka)),0>=W||0>=te?0:(W=F.Ib(A,F),F.Jb!=null&&F.Jb(A,F,W),F.Dc+=W,1)}function kr(A){A.ma.memory=null}function Ae(A,F,W,te){return q(A,8)!=47?0:(F[0]=q(A,14)+1,W[0]=q(A,14)+1,te[0]=q(A,1),q(A,3)!=0?0:!A.h)}function Ke(A,F){if(4>A)return A+1;var W=A-2>>1;return(2+(1&A)<<W)+q(F,W)+1}function Gt(A,F){return 120<F?F-120:1<=(W=((W=ql[F-1])>>4)*A+(8-(15&W)))?W:1;var W}function jt(A,F,W){var te=re(W),de=A[F+=255&te].g-8;return 0<de&&(xe(W,W.u+8),te=re(W),F+=A[F].value,F+=te&(1<<de)-1),xe(W,W.u+A[F].g),A[F].value}function zt(A,F,W){return W.g+=A.g,W.value+=A.value<<F>>>0,e(8>=W.g),A.g}function Mt(A,F,W){var te=A.xc;return e((F=te==0?0:A.vc[A.md*(W>>te)+(F>>te)])<A.Wb),A.Ya[F]}function Ht(A,F,W,te){var de=A.ab,me=A.c*F,ge=A.C;F=ge+F;var ve=W,ke=te;for(te=A.Ta,W=A.Ua;0<de--;){var Ee=A.gc[de],Me=ge,Qe=F,Ce=ve,Be=ke,We=(ke=te,ve=W,Ee.Ea);switch(e(Me<Qe),e(Qe<=Ee.nc),Ee.hc){case 2:Ti(Ce,Be,(Qe-Me)*We,ke,ve);break;case 0:var pt=Me,Ge=Qe,dt=ke,vt=ve,Wt=(dr=Ee).Ea;pt==0&&(Qf(Ce,Be,null,null,1,dt,vt),_t(Ce,Be+1,0,0,Wt-1,dt,vt+1),Be+=Wt,vt+=Wt,++pt);for(var Tt=1<<dr.b,mr=Tt-1,ir=je(Wt,dr.b),Qr=dr.K,dr=dr.w+(pt>>dr.b)*ir;pt<Ge;){var jn=Qr,Us=dr,nn=1;for(Jf(Ce,Be,dt,vt-Wt,1,dt,vt);nn<Wt;){var ar=(nn&~mr)+Tt;ar>Wt&&(ar=Wt),(0,Tu[jn[Us++]>>8&15])(Ce,Be+ +nn,dt,vt+nn-Wt,ar-nn,dt,vt+nn),nn=ar}Be+=Wt,vt+=Wt,++pt&mr||(dr+=ir)}Qe!=Ee.nc&&n(ke,ve-We,ke,ve+(Qe-Me-1)*We,We);break;case 1:for(We=Ce,Ge=Be,Wt=(Ce=Ee.Ea)-(vt=Ce&~(dt=(Be=1<<Ee.b)-1)),pt=je(Ce,Ee.b),Tt=Ee.K,Ee=Ee.w+(Me>>Ee.b)*pt;Me<Qe;){for(mr=Tt,ir=Ee,Qr=new $t,dr=Ge+vt,jn=Ge+Ce;Ge<dr;)ut(mr[ir++],Qr),Zf(Qr,We,Ge,Be,ke,ve),Ge+=Be,ve+=Be;Ge<jn&&(ut(mr[ir++],Qr),Zf(Qr,We,Ge,Wt,ke,ve),Ge+=Wt,ve+=Wt),++Me&dt||(Ee+=pt)}break;case 3:if(Ce==ke&&Be==ve&&0<Ee.b){for(Ge=ke,Ce=We=ve+(Qe-Me)*We-(vt=(Qe-Me)*je(Ee.Ea,Ee.b)),Be=ke,dt=ve,pt=[],vt=(Wt=vt)-1;0<=vt;--vt)pt[vt]=Be[dt+vt];for(vt=Wt-1;0<=vt;--vt)Ge[Ce+vt]=pt[vt];Mg(Ee,Me,Qe,ke,We,ke,ve)}else Mg(Ee,Me,Qe,Ce,Be,ke,ve)}ve=te,ke=W}ke!=W&&n(te,W,ve,ke,me)}function vr(A,F){var W=A.V,te=A.Ba+A.c*A.C,de=F-A.C;if(e(F<=A.l.o),e(16>=de),0<de){var me=A.l,ge=A.Ta,ve=A.Ua,ke=me.width;if(Ht(A,de,W,te),de=ve=[ve],e((W=A.C)<(te=F)),e(me.v<me.va),te>me.o&&(te=me.o),W<me.j){var Ee=me.j-W;W=me.j,de[0]+=Ee*ke}if(W>=te?W=0:(de[0]+=4*me.v,me.ka=W-me.j,me.U=me.va-me.v,me.T=te-W,W=1),W){if(ve=ve[0],11>(W=A.ca).S){var Me=W.f.RGBA,Qe=(te=W.S,de=me.U,me=me.T,Ee=Me.eb,Me.A),Ce=me;for(Me=Me.fb+A.Ma*Me.A;0<Ce--;){var Be=ge,We=ve,pt=de,Ge=Ee,dt=Me;switch(te){case Bg:e0(Be,We,pt,Ge,dt);break;case io:Iu(Be,We,pt,Ge,dt);break;case $p:Iu(Be,We,pt,Ge,dt),Ah(Ge,dt,0,pt,1,0);break;case Fg:Ch(Be,We,pt,Ge,dt);break;case zl:ht(Be,We,pt,Ge,dt,1);break;case $g:ht(Be,We,pt,Ge,dt,1),Ah(Ge,dt,0,pt,1,0);break;case Fp:ht(Be,We,pt,Ge,dt,0);break;case r0:ht(Be,We,pt,Ge,dt,0),Ah(Ge,dt,1,pt,1,0);break;case t0:Pu(Be,We,pt,Ge,dt);break;case Ug:Pu(Be,We,pt,Ge,dt),Ul(Ge,dt,pt,1,0);break;case _d:Gc(Be,We,pt,Ge,dt);break;default:e(0)}ve+=ke,Me+=Qe}A.Ma+=me}else alert("todo:EmitRescaledRowsYUVA");e(A.Ma<=W.height)}}A.C=F,e(A.C<=A.i)}function Fr(A){var F;if(0<A.ua)return 0;for(F=0;F<A.Wb;++F){var W=A.Ya[F].G,te=A.Ya[F].H;if(0<W[1][te[1]+0].g||0<W[2][te[2]+0].g||0<W[3][te[3]+0].g)return 0}return 1}function ln(A,F,W,te,de,me){if(A.Z!=0){var ge=A.qd,ve=A.rd;for(e(Mu[A.Z]!=null);F<W;++F)Mu[A.Z](ge,ve,te,de,te,de,me),ge=te,ve=de,de+=me;A.qd=ge,A.rd=ve}}function hn(A,F){var W=A.l.ma,te=W.Z==0||W.Z==1?A.l.j:A.C;if(te=A.C<te?te:A.C,e(F<=A.l.o),F>te){var de=A.l.width,me=W.ca,ge=W.tb+de*te,ve=A.V,ke=A.Ba+A.c*te,Ee=A.gc;e(A.ab==1),e(Ee[0].hc==3),Wc(Ee[0],te,F,ve,ke,me,ge),ln(W,te,F,me,ge,de)}A.C=A.Ma=F}function cn(A,F,W,te,de,me,ge){var ve=A.$/te,ke=A.$%te,Ee=A.m,Me=A.s,Qe=W+A.$,Ce=Qe;de=W+te*de;var Be=W+te*me,We=280+Me.ua,pt=A.Pb?ve:16777216,Ge=0<Me.ua?Me.Wa:null,dt=Me.wc,vt=Qe<Be?Mt(Me,ke,ve):null;e(A.C<me),e(Be<=de);var Wt=!1;e:for(;;){for(;Wt||Qe<Be;){var Tt=0;if(ve>=pt){var mr=Qe-W;e((pt=A).Pb),pt.wd=pt.m,pt.xd=mr,0<pt.s.ua&&Oe(pt.s.Wa,pt.s.vb),pt=ve+Sd}if(ke&dt||(vt=Mt(Me,ke,ve)),e(vt!=null),vt.Qb&&(F[Qe]=vt.qb,Wt=!0),!Wt)if(Ne(Ee),vt.jc){Tt=Ee,mr=F;var ir=Qe,Qr=vt.pd[re(Tt)&kd-1];e(vt.jc),256>Qr.g?(xe(Tt,Tt.u+Qr.g),mr[ir]=Qr.value,Tt=0):(xe(Tt,Tt.u+Qr.g-256),e(256<=Qr.value),Tt=Qr.value),Tt==0&&(Wt=!0)}else Tt=jt(vt.G[0],vt.H[0],Ee);if(Ee.h)break;if(Wt||256>Tt){if(!Wt)if(vt.nd)F[Qe]=(vt.qb|Tt<<8)>>>0;else{if(Ne(Ee),Wt=jt(vt.G[1],vt.H[1],Ee),Ne(Ee),mr=jt(vt.G[2],vt.H[2],Ee),ir=jt(vt.G[3],vt.H[3],Ee),Ee.h)break;F[Qe]=(ir<<24|Wt<<16|Tt<<8|mr)>>>0}if(Wt=!1,++Qe,++ke>=te&&(ke=0,++ve,ge!=null&&ve<=me&&!(ve%16)&&ge(A,ve),Ge!=null))for(;Ce<Qe;)Tt=F[Ce++],Ge.X[(506832829*Tt&4294967295)>>>Ge.Mb]=Tt}else if(280>Tt){if(Tt=Ke(Tt-256,Ee),mr=jt(vt.G[4],vt.H[4],Ee),Ne(Ee),mr=Gt(te,mr=Ke(mr,Ee)),Ee.h)break;if(Qe-W<mr||de-Qe<Tt)break e;for(ir=0;ir<Tt;++ir)F[Qe+ir]=F[Qe+ir-mr];for(Qe+=Tt,ke+=Tt;ke>=te;)ke-=te,++ve,ge!=null&&ve<=me&&!(ve%16)&&ge(A,ve);if(e(Qe<=de),ke&dt&&(vt=Mt(Me,ke,ve)),Ge!=null)for(;Ce<Qe;)Tt=F[Ce++],Ge.X[(506832829*Tt&4294967295)>>>Ge.Mb]=Tt}else{if(!(Tt<We))break e;for(Wt=Tt-280,e(Ge!=null);Ce<Qe;)Tt=F[Ce++],Ge.X[(506832829*Tt&4294967295)>>>Ge.Mb]=Tt;Tt=Qe,e(!(Wt>>>(mr=Ge).Xa)),F[Tt]=mr.X[Wt],Wt=!0}Wt||e(Ee.h==ae(Ee))}if(A.Pb&&Ee.h&&Qe<de)e(A.m.h),A.a=5,A.m=A.wd,A.$=A.xd,0<A.s.ua&&Oe(A.s.vb,A.s.Wa);else{if(Ee.h)break e;ge?.(A,ve>me?me:ve),A.a=0,A.$=Qe-W}return 1}return A.a=3,0}function Ks(A){e(A!=null),A.vc=null,A.yc=null,A.Ya=null;var F=A.Wa;F!=null&&(F.X=null),A.vb=null,e(A!=null)}function Ci(){var A=new Rr;return A==null?null:(A.a=0,A.xb=Fb,Pt("Predictor","VP8LPredictors"),Pt("Predictor","VP8LPredictors_C"),Pt("PredictorAdd","VP8LPredictorsAdd"),Pt("PredictorAdd","VP8LPredictorsAdd_C"),Ti=wt,Zf=Rt,e0=at,Iu=ft,Pu=Bt,Gc=De,Ch=lt,M.VP8LMapColor32b=Hc,M.VP8LMapColor8b=La,A)}function Ds(A,F,W,te,de){var me=1,ge=[A],ve=[F],ke=te.m,Ee=te.s,Me=null,Qe=0;e:for(;;){if(W)for(;me&&q(ke,1);){var Ce=ge,Be=ve,We=te,pt=1,Ge=We.m,dt=We.gc[We.ab],vt=q(Ge,2);if(We.Oc&1<<vt)me=0;else{switch(We.Oc|=1<<vt,dt.hc=vt,dt.Ea=Ce[0],dt.nc=Be[0],dt.K=[null],++We.ab,e(4>=We.ab),vt){case 0:case 1:dt.b=q(Ge,3)+2,pt=Ds(je(dt.Ea,dt.b),je(dt.nc,dt.b),0,We,dt.K),dt.K=dt.K[0];break;case 3:var Wt,Tt=q(Ge,8)+1,mr=16<Tt?0:4<Tt?1:2<Tt?2:3;if(Ce[0]=je(dt.Ea,mr),dt.b=mr,Wt=pt=Ds(Tt,1,0,We,dt.K)){var ir,Qr=Tt,dr=dt,jn=1<<(8>>dr.b),Us=a(jn);if(Us==null)Wt=0;else{var nn=dr.K[0],ar=dr.w;for(Us[0]=dr.K[0][0],ir=1;ir<1*Qr;++ir)Us[ir]=Fe(nn[ar+ir],Us[ir-1]);for(;ir<4*jn;++ir)Us[ir]=0;dr.K[0]=null,dr.K[0]=Us,Wt=1}}pt=Wt;break;case 2:break;default:e(0)}me=pt}}if(ge=ge[0],ve=ve[0],me&&q(ke,1)&&!(me=1<=(Qe=q(ke,4))&&11>=Qe)){te.a=3;break e}var Zt;if(Zt=me)t:{var ri,Ur,dn,as=te,aa=ge,Ba=ve,Ts=Qe,Vi=W,ao=as.m,qi=as.s,vn=[null],Vn=1,ni=0,Qn=Hl[Ts];r:for(;;){if(Vi&&q(ao,1)){var oa=q(ao,3)+2,si=je(aa,oa),qn=je(Ba,oa),Li=si*qn;if(!Ds(si,qn,0,as,vn))break r;for(vn=vn[0],qi.xc=oa,ri=0;ri<Li;++ri){var os=vn[ri]>>8&65535;vn[ri]=os,os>=Vn&&(Vn=os+1)}}if(ao.h)break r;for(Ur=0;5>Ur;++Ur){var Hi=Ih[Ur];!Ur&&0<Ts&&(Hi+=1<<Ts),ni<Hi&&(ni=Hi)}var Wi=o(Vn*Qn,R),xs=Vn,Rn=o(xs,ee);if(Rn==null)var oo=null;else e(65536>=xs),oo=Rn;var xi=a(ni);if(oo==null||xi==null||Wi==null){as.a=1;break r}var Or=Wi;for(ri=dn=0;ri<Vn;++ri){var Dr=oo[ri],Hn=Dr.G,Jo=Dr.H,Yl=0,Po=1,Gi=0;for(Ur=0;5>Ur;++Ur){Hi=Ih[Ur],Hn[Ur]=Or,Jo[Ur]=dn,!Ur&&0<Ts&&(Hi+=1<<Ts);s:{var Pd,Ld=Hi,Kg=as,Is=xi,Ub=Or,zb=dn,Yg=0,Ru=Kg.m,_3=q(Ru,1);if(s(Is,0,0,Ld),_3){var Vb=q(Ru,1)+1,qb=q(Ru,1),Xg=q(Ru,qb==0?1:8);Is[Xg]=1,Vb==2&&(Is[Xg=q(Ru,8)]=1);var ma=1}else{var yi=a(19),qp=q(Ru,4)+4;if(19<qp){Kg.a=3;var Od=0;break s}for(Pd=0;Pd<qp;++Pd)yi[Up[Pd]]=q(Ru,3);var o0=void 0,Oh=void 0,Xc=Kg,Qg=yi,l0=Ld,Jg=Is,Zg=0,Du=Xc.m,Hb=8,Wb=o(128,R);n:for(;P(Wb,0,7,Qg,19);){if(q(Du,1)){var e5=2+2*q(Du,3);if((o0=2+q(Du,e5))>l0)break n}else o0=l0;for(Oh=0;Oh<l0&&o0--;){Ne(Du);var Gb=Wb[0+(127&re(Du))];xe(Du,Du.u+Gb.g);var Md=Gb.value;if(16>Md)Jg[Oh++]=Md,Md!=0&&(Hb=Md);else{var t5=Md==16,r5=Md-16,n5=n0[r5],Kb=q(Du,Vl[r5])+n5;if(Oh+Kb>l0)break n;for(var s5=t5?Hb:0;0<Kb--;)Jg[Oh++]=s5}}Zg=1;break n}Zg||(Xc.a=3),ma=Zg}(ma=ma&&!Ru.h)&&(Yg=P(Ub,zb,8,Is,Ld)),ma&&Yg!=0?Od=Yg:(Kg.a=3,Od=0)}if(Od==0)break r;if(Po&&zg[Ur]==1&&(Po=Or[dn].g==0),Yl+=Or[dn].g,dn+=Od,3>=Ur){var Mh,ex=xi[0];for(Mh=1;Mh<Hi;++Mh)xi[Mh]>ex&&(ex=xi[Mh]);Gi+=ex}}if(Dr.nd=Po,Dr.Qb=0,Po&&(Dr.qb=(Hn[3][Jo[3]+0].value<<24|Hn[1][Jo[1]+0].value<<16|Hn[2][Jo[2]+0].value)>>>0,Yl==0&&256>Hn[0][Jo[0]+0].value&&(Dr.Qb=1,Dr.qb+=Hn[0][Jo[0]+0].value<<8)),Dr.jc=!Dr.Qb&&6>Gi,Dr.jc){var Hp,Qc=Dr;for(Hp=0;Hp<kd;++Hp){var Bu=Hp,Fu=Qc.pd[Bu],tx=Qc.G[0][Qc.H[0]+Bu];256<=tx.value?(Fu.g=tx.g+256,Fu.value=tx.value):(Fu.g=0,Fu.value=0,Bu>>=zt(tx,8,Fu),Bu>>=zt(Qc.G[1][Qc.H[1]+Bu],16,Fu),Bu>>=zt(Qc.G[2][Qc.H[2]+Bu],0,Fu),zt(Qc.G[3][Qc.H[3]+Bu],24,Fu))}}}qi.vc=vn,qi.Wb=Vn,qi.Ya=oo,qi.yc=Wi,Zt=1;break t}Zt=0}if(!(me=Zt)){te.a=3;break e}if(0<Qe){if(Ee.ua=1<<Qe,!oe(Ee.Wa,Qe)){te.a=1,me=0;break e}}else Ee.ua=0;var rx=te,Rh=ge,i5=ve,c0=rx.s,u0=c0.xc;if(rx.c=Rh,rx.i=i5,c0.md=je(Rh,u0),c0.wc=u0==0?-1:(1<<u0)-1,W){te.xb=Cd;break e}if((Me=a(ge*ve))==null){te.a=1,me=0;break e}me=(me=cn(te,Me,0,ge,ve,ve,null))&&!ke.h;break e}return me?(de!=null?de[0]=Me:(e(Me==null),e(W)),te.$=0,W||Ks(Ee)):Ks(Ee),me}function ps(A,F){var W=A.c*A.i,te=W+F+16*F;return e(A.c<=F),A.V=a(te),A.V==null?(A.Ta=null,A.Ua=0,A.a=1,0):(A.Ta=A.V,A.Ua=A.Ba+W+F,1)}function $e(A,F){var W=A.C,te=F-W,de=A.V,me=A.Ba+A.c*W;for(e(F<=A.l.o);0<te;){var ge=16<te?16:te,ve=A.l.ma,ke=A.l.width,Ee=ke*ge,Me=ve.ca,Qe=ve.tb+ke*W,Ce=A.Ta,Be=A.Ua;Ht(A,ge,de,me),gl(Ce,Be,Me,Qe,Ee),ln(ve,W,W+ge,Me,Qe,ke),te-=ge,de+=ge*A.c,W+=ge}e(W==F),A.C=A.Ma=F}function Xe(){this.ub=this.yd=this.td=this.Rb=0}function ct(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function tr(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Lr(){this.Yb=(function(){var A=[];return(function F(W,te,de){for(var me=de[te],ge=0;ge<me&&(W.push(de.length>te+1?[]:0),!(de.length<te+1));ge++)F(W[ge],te+1,de)})(A,0,[3,11]),A})()}function tn(){this.jb=a(3),this.Wc=l([4,8],Lr),this.Xc=l([4,17],Lr)}function Ea(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Bs(){this.ld=this.La=this.dd=this.tc=0}function sa(){this.Na=this.la=0}function Bi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Fi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ko(){this.uc=this.M=this.Nb=0,this.wa=Array(new Bs),this.Y=0,this.ya=Array(new Fi),this.aa=0,this.l=new pi}function Rl(){this.y=a(16),this.f=a(8),this.ea=a(8)}function pc(){this.cb=this.a=0,this.sc="",this.m=new U,this.Od=new Xe,this.Kc=new ct,this.ed=new Ea,this.Qa=new tr,this.Ic=this.$c=this.Aa=0,this.D=new Ko,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,U),this.ia=0,this.pb=o(4,Bi),this.Pa=new tn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Rl),this.Hd=0,this.rb=Array(new sa),this.sb=0,this.wa=Array(new Bs),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Fi),this.L=this.aa=0,this.gd=l([4,2],Bs),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ia(A,F){return 0>A?0:A>F?F:A}function pi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ks(){var A=new pc;return A!=null&&(A.a=0,A.sc="OK",A.cb=0,A.Xb=0,xl||(xl=pn)),A}function Zr(A,F,W){return A.a==0&&(A.a=F,A.sc=W,A.cb=0),0}function Aa(A,F,W){return 3<=W&&A[F+0]==157&&A[F+1]==1&&A[F+2]==42}function mi(A,F){if(A==null)return 0;if(A.a=0,A.sc="OK",F==null)return Zr(A,2,"null VP8Io passed to VP8GetHeaders()");var W=F.data,te=F.w,de=F.ha;if(4>de)return Zr(A,7,"Truncated header.");var me=W[te+0]|W[te+1]<<8|W[te+2]<<16,ge=A.Od;if(ge.Rb=!(1&me),ge.td=me>>1&7,ge.yd=me>>4&1,ge.ub=me>>5,3<ge.td)return Zr(A,3,"Incorrect keyframe parameters.");if(!ge.yd)return Zr(A,4,"Frame not displayable.");te+=3,de-=3;var ve=A.Kc;if(ge.Rb){if(7>de)return Zr(A,7,"cannot parse picture header");if(!Aa(W,te,de))return Zr(A,3,"Bad code word");ve.c=16383&(W[te+4]<<8|W[te+3]),ve.Td=W[te+4]>>6,ve.i=16383&(W[te+6]<<8|W[te+5]),ve.Ud=W[te+6]>>6,te+=7,de-=7,A.za=ve.c+15>>4,A.Ub=ve.i+15>>4,F.width=ve.c,F.height=ve.i,F.Da=0,F.j=0,F.v=0,F.va=F.width,F.o=F.height,F.da=0,F.ib=F.width,F.hb=F.height,F.U=F.width,F.T=F.height,s((me=A.Pa).jb,0,255,me.jb.length),e((me=A.Qa)!=null),me.Cb=0,me.Bb=0,me.Fb=1,s(me.Zb,0,0,me.Zb.length),s(me.Lb,0,0,me.Lb)}if(ge.ub>de)return Zr(A,7,"bad partition length");G(me=A.m,W,te,ge.ub),te+=ge.ub,de-=ge.ub,ge.Rb&&(ve.Ld=K(me),ve.Kd=K(me)),ve=A.Qa;var ke,Ee=A.Pa;if(e(me!=null),e(ve!=null),ve.Cb=K(me),ve.Cb){if(ve.Bb=K(me),K(me)){for(ve.Fb=K(me),ke=0;4>ke;++ke)ve.Zb[ke]=K(me)?Z(me,7):0;for(ke=0;4>ke;++ke)ve.Lb[ke]=K(me)?Z(me,6):0}if(ve.Bb)for(ke=0;3>ke;++ke)Ee.jb[ke]=K(me)?J(me,8):255}else ve.Bb=0;if(me.Ka)return Zr(A,3,"cannot parse segment header");if((ve=A.ed).zd=K(me),ve.Tb=J(me,6),ve.wb=J(me,3),ve.Pc=K(me),ve.Pc&&K(me)){for(Ee=0;4>Ee;++Ee)K(me)&&(ve.vd[Ee]=Z(me,6));for(Ee=0;4>Ee;++Ee)K(me)&&(ve.od[Ee]=Z(me,6))}if(A.L=ve.Tb==0?0:ve.zd?1:2,me.Ka)return Zr(A,3,"cannot parse filter header");var Me=de;if(de=ke=te,te=ke+Me,ve=Me,A.Xb=(1<<J(A.m,2))-1,Me<3*(Ee=A.Xb))W=7;else{for(ke+=3*Ee,ve-=3*Ee,Me=0;Me<Ee;++Me){var Qe=W[de+0]|W[de+1]<<8|W[de+2]<<16;Qe>ve&&(Qe=ve),G(A.Jc[+Me],W,ke,Qe),ke+=Qe,ve-=Qe,de+=3}G(A.Jc[+Ee],W,ke,ve),W=ke<te?0:5}if(W!=0)return Zr(A,W,"cannot parse partitions");for(W=J(ke=A.m,7),de=K(ke)?Z(ke,4):0,te=K(ke)?Z(ke,4):0,ve=K(ke)?Z(ke,4):0,Ee=K(ke)?Z(ke,4):0,ke=K(ke)?Z(ke,4):0,Me=A.Qa,Qe=0;4>Qe;++Qe){if(Me.Cb){var Ce=Me.Zb[Qe];Me.Fb||(Ce+=W)}else{if(0<Qe){A.pb[Qe]=A.pb[0];continue}Ce=W}var Be=A.pb[Qe];Be.Sc[0]=Wl[ia(Ce+de,127)],Be.Sc[1]=Gl[ia(Ce+0,127)],Be.Eb[0]=2*Wl[ia(Ce+te,127)],Be.Eb[1]=101581*Gl[ia(Ce+ve,127)]>>16,8>Be.Eb[1]&&(Be.Eb[1]=8),Be.Qc[0]=Wl[ia(Ce+Ee,117)],Be.Qc[1]=Gl[ia(Ce+ke,127)],Be.lc=Ce+ke}if(!ge.Rb)return Zr(A,4,"Not a key frame.");for(K(me),ge=A.Pa,W=0;4>W;++W){for(de=0;8>de;++de)for(te=0;3>te;++te)for(ve=0;11>ve;++ve)Ee=ue(me,$s[W][de][te][ve])?J(me,8):Jw[W][de][te][ve],ge.Wc[W][de].Yb[te][ve]=Ee;for(de=0;17>de;++de)ge.Xc[W][de]=ge.Wc[W][_n[de]]}return A.kc=K(me),A.kc&&(A.Bd=J(me,8)),A.cb=1}function pn(A,F,W,te,de,me,ge){var ve=F[de].Yb[W];for(W=0;16>de;++de){if(!ue(A,ve[W+0]))return de;for(;!ue(A,ve[W+1]);)if(ve=F[++de].Yb[0],W=0,de==16)return 16;var ke=F[de+1].Yb;if(ue(A,ve[W+2])){var Ee=A,Me=0;if(ue(Ee,(Ce=ve)[(Qe=W)+3]))if(ue(Ee,Ce[Qe+6])){for(ve=0,Qe=2*(Me=ue(Ee,Ce[Qe+8]))+(Ce=ue(Ee,Ce[Qe+9+Me])),Me=0,Ce=Qw[Qe];Ce[ve];++ve)Me+=Me+ue(Ee,Ce[ve]);Me+=3+(8<<Qe)}else ue(Ee,Ce[Qe+7])?(Me=7+2*ue(Ee,165),Me+=ue(Ee,145)):Me=5+ue(Ee,159);else Me=ue(Ee,Ce[Qe+4])?3+ue(Ee,Ce[Qe+5]):2;ve=ke[2]}else Me=1,ve=ke[1];ke=ge+Bb[de],0>(Ee=A).b&&pe(Ee);var Qe,Ce=Ee.b,Be=(Qe=Ee.Ca>>1)-(Ee.I>>Ce)>>31;--Ee.b,Ee.Ca+=Be,Ee.Ca|=1,Ee.I-=(Qe+1&Be)<<Ce,me[ke]=((Me^Be)-Be)*te[(0<de)+0]}return 16}function No(A){var F=A.rb[A.sb-1];F.la=0,F.Na=0,s(A.zc,0,0,A.zc.length),A.ja=0}function Fs(A,F,W,te,de){de=A[F+W+32*te]+(de>>3),A[F+W+32*te]=-256&de?0>de?0:255:de}function ss(A,F,W,te,de,me){Fs(A,F,0,W,te+de),Fs(A,F,1,W,te+me),Fs(A,F,2,W,te-me),Fs(A,F,3,W,te-de)}function _s(A){return(20091*A>>16)+A}function hl(A,F,W,te){var de,me=0,ge=a(16);for(de=0;4>de;++de){var ve=A[F+0]+A[F+8],ke=A[F+0]-A[F+8],Ee=(35468*A[F+4]>>16)-_s(A[F+12]),Me=_s(A[F+4])+(35468*A[F+12]>>16);ge[me+0]=ve+Me,ge[me+1]=ke+Ee,ge[me+2]=ke-Ee,ge[me+3]=ve-Me,me+=4,F++}for(de=me=0;4>de;++de)ve=(A=ge[me+0]+4)+ge[me+8],ke=A-ge[me+8],Ee=(35468*ge[me+4]>>16)-_s(ge[me+12]),Fs(W,te,0,0,ve+(Me=_s(ge[me+4])+(35468*ge[me+12]>>16))),Fs(W,te,1,0,ke+Ee),Fs(W,te,2,0,ke-Ee),Fs(W,te,3,0,ve-Me),me++,te+=32}function Dl(A,F,W,te){var de=A[F+0]+4,me=35468*A[F+4]>>16,ge=_s(A[F+4]),ve=35468*A[F+1]>>16;ss(W,te,0,de+ge,A=_s(A[F+1]),ve),ss(W,te,1,de+me,A,ve),ss(W,te,2,de-me,A,ve),ss(W,te,3,de-ge,A,ve)}function mc(A,F,W,te,de){hl(A,F,W,te),de&&hl(A,F+16,W,te+4)}function Ei(A,F,W,te){Lu(A,F+0,W,te,1),Lu(A,F+32,W,te+128,1)}function jo(A,F,W,te){var de;for(A=A[F+0]+4,de=0;4>de;++de)for(F=0;4>F;++F)Fs(W,te,F,de,A)}function ei(A,F,W,te){A[F+0]&&Xn(A,F+0,W,te),A[F+16]&&Xn(A,F+16,W,te+4),A[F+32]&&Xn(A,F+32,W,te+128),A[F+48]&&Xn(A,F+48,W,te+128+4)}function is(A,F,W,te){var de,me=a(16);for(de=0;4>de;++de){var ge=A[F+0+de]+A[F+12+de],ve=A[F+4+de]+A[F+8+de],ke=A[F+4+de]-A[F+8+de],Ee=A[F+0+de]-A[F+12+de];me[0+de]=ge+ve,me[8+de]=ge-ve,me[4+de]=Ee+ke,me[12+de]=Ee-ke}for(de=0;4>de;++de)ge=(A=me[0+4*de]+3)+me[3+4*de],ve=me[1+4*de]+me[2+4*de],ke=me[1+4*de]-me[2+4*de],Ee=A-me[3+4*de],W[te+0]=ge+ve>>3,W[te+16]=Ee+ke>>3,W[te+32]=ge-ve>>3,W[te+48]=Ee-ke>>3,te+=64}function $i(A,F,W){var te,de=F-32,me=so,ge=255-A[de-1];for(te=0;te<W;++te){var ve,ke=me,Ee=ge+A[F-1];for(ve=0;ve<W;++ve)A[F+ve]=ke[Ee+A[de+ve]];F+=32}}function gc(A,F){$i(A,F,4)}function ha(A,F){$i(A,F,8)}function Bl(A,F){$i(A,F,16)}function Fl(A,F){var W;for(W=0;16>W;++W)n(A,F+32*W,A,F-32,16)}function ko(A,F){var W;for(W=16;0<W;--W)s(A,F,A[F-1],16),F+=32}function Ui(A,F,W){var te;for(te=0;16>te;++te)s(F,W+32*te,A,16)}function fa(A,F){var W,te=16;for(W=0;16>W;++W)te+=A[F-1+32*W]+A[F+W-32];Ui(te>>5,A,F)}function ms(A,F){var W,te=8;for(W=0;16>W;++W)te+=A[F-1+32*W];Ui(te>>4,A,F)}function Ai(A,F){var W,te=8;for(W=0;16>W;++W)te+=A[F+W-32];Ui(te>>4,A,F)}function _o(A,F){Ui(128,A,F)}function yr(A,F,W){return A+2*F+W+2>>2}function So(A,F){var W,te=F-32;for(te=new Uint8Array([yr(A[te-1],A[te+0],A[te+1]),yr(A[te+0],A[te+1],A[te+2]),yr(A[te+1],A[te+2],A[te+3]),yr(A[te+2],A[te+3],A[te+4])]),W=0;4>W;++W)n(A,F+32*W,te,0,te.length)}function Co(A,F){var W=A[F-1],te=A[F-1+32],de=A[F-1+64],me=A[F-1+96];fe(A,F+0,16843009*yr(A[F-1-32],W,te)),fe(A,F+32,16843009*yr(W,te,de)),fe(A,F+64,16843009*yr(te,de,me)),fe(A,F+96,16843009*yr(de,me,me))}function Yo(A,F){var W,te=4;for(W=0;4>W;++W)te+=A[F+W-32]+A[F-1+32*W];for(te>>=3,W=0;4>W;++W)s(A,F+32*W,te,4)}function Ys(A,F){var W=A[F-1+0],te=A[F-1+32],de=A[F-1+64],me=A[F-1-32],ge=A[F+0-32],ve=A[F+1-32],ke=A[F+2-32],Ee=A[F+3-32];A[F+0+96]=yr(te,de,A[F-1+96]),A[F+1+96]=A[F+0+64]=yr(W,te,de),A[F+2+96]=A[F+1+64]=A[F+0+32]=yr(me,W,te),A[F+3+96]=A[F+2+64]=A[F+1+32]=A[F+0+0]=yr(ge,me,W),A[F+3+64]=A[F+2+32]=A[F+1+0]=yr(ve,ge,me),A[F+3+32]=A[F+2+0]=yr(ke,ve,ge),A[F+3+0]=yr(Ee,ke,ve)}function Ss(A,F){var W=A[F+1-32],te=A[F+2-32],de=A[F+3-32],me=A[F+4-32],ge=A[F+5-32],ve=A[F+6-32],ke=A[F+7-32];A[F+0+0]=yr(A[F+0-32],W,te),A[F+1+0]=A[F+0+32]=yr(W,te,de),A[F+2+0]=A[F+1+32]=A[F+0+64]=yr(te,de,me),A[F+3+0]=A[F+2+32]=A[F+1+64]=A[F+0+96]=yr(de,me,ge),A[F+3+32]=A[F+2+64]=A[F+1+96]=yr(me,ge,ve),A[F+3+64]=A[F+2+96]=yr(ge,ve,ke),A[F+3+96]=yr(ve,ke,ke)}function Xo(A,F){var W=A[F-1+0],te=A[F-1+32],de=A[F-1+64],me=A[F-1-32],ge=A[F+0-32],ve=A[F+1-32],ke=A[F+2-32],Ee=A[F+3-32];A[F+0+0]=A[F+1+64]=me+ge+1>>1,A[F+1+0]=A[F+2+64]=ge+ve+1>>1,A[F+2+0]=A[F+3+64]=ve+ke+1>>1,A[F+3+0]=ke+Ee+1>>1,A[F+0+96]=yr(de,te,W),A[F+0+64]=yr(te,W,me),A[F+0+32]=A[F+1+96]=yr(W,me,ge),A[F+1+32]=A[F+2+96]=yr(me,ge,ve),A[F+2+32]=A[F+3+96]=yr(ge,ve,ke),A[F+3+32]=yr(ve,ke,Ee)}function un(A,F){var W=A[F+0-32],te=A[F+1-32],de=A[F+2-32],me=A[F+3-32],ge=A[F+4-32],ve=A[F+5-32],ke=A[F+6-32],Ee=A[F+7-32];A[F+0+0]=W+te+1>>1,A[F+1+0]=A[F+0+64]=te+de+1>>1,A[F+2+0]=A[F+1+64]=de+me+1>>1,A[F+3+0]=A[F+2+64]=me+ge+1>>1,A[F+0+32]=yr(W,te,de),A[F+1+32]=A[F+0+96]=yr(te,de,me),A[F+2+32]=A[F+1+96]=yr(de,me,ge),A[F+3+32]=A[F+2+96]=yr(me,ge,ve),A[F+3+64]=yr(ge,ve,ke),A[F+3+96]=yr(ve,ke,Ee)}function zi(A,F){var W=A[F-1+0],te=A[F-1+32],de=A[F-1+64],me=A[F-1+96];A[F+0+0]=W+te+1>>1,A[F+2+0]=A[F+0+32]=te+de+1>>1,A[F+2+32]=A[F+0+64]=de+me+1>>1,A[F+1+0]=yr(W,te,de),A[F+3+0]=A[F+1+32]=yr(te,de,me),A[F+3+32]=A[F+1+64]=yr(de,me,me),A[F+3+64]=A[F+2+64]=A[F+0+96]=A[F+1+96]=A[F+2+96]=A[F+3+96]=me}function Eo(A,F){var W=A[F-1+0],te=A[F-1+32],de=A[F-1+64],me=A[F-1+96],ge=A[F-1-32],ve=A[F+0-32],ke=A[F+1-32],Ee=A[F+2-32];A[F+0+0]=A[F+2+32]=W+ge+1>>1,A[F+0+32]=A[F+2+64]=te+W+1>>1,A[F+0+64]=A[F+2+96]=de+te+1>>1,A[F+0+96]=me+de+1>>1,A[F+3+0]=yr(ve,ke,Ee),A[F+2+0]=yr(ge,ve,ke),A[F+1+0]=A[F+3+32]=yr(W,ge,ve),A[F+1+32]=A[F+3+64]=yr(te,W,ge),A[F+1+64]=A[F+3+96]=yr(de,te,W),A[F+1+96]=yr(me,de,te)}function Ta(A,F){var W;for(W=0;8>W;++W)n(A,F+32*W,A,F-32,8)}function xc(A,F){var W;for(W=0;8>W;++W)s(A,F,A[F-1],8),F+=32}function Q(A,F,W){var te;for(te=0;8>te;++te)s(F,W+32*te,A,8)}function be(A,F){var W,te=8;for(W=0;8>W;++W)te+=A[F+W-32]+A[F-1+32*W];Q(te>>4,A,F)}function Te(A,F){var W,te=4;for(W=0;8>W;++W)te+=A[F+W-32];Q(te>>3,A,F)}function it(A,F){var W,te=4;for(W=0;8>W;++W)te+=A[F-1+32*W];Q(te>>3,A,F)}function Tr(A,F){Q(128,A,F)}function rr(A,F,W){var te=A[F-W],de=A[F+0],me=3*(de-te)+Ou[1020+A[F-2*W]-A[F+W]],ge=Bp[112+(me+4>>3)];A[F-W]=so[255+te+Bp[112+(me+3>>3)]],A[F+0]=so[255+de-ge]}function Xr(A,F,W,te){var de=A[F+0],me=A[F+W];return Oa[255+A[F-2*W]-A[F-W]]>te||Oa[255+me-de]>te}function en(A,F,W,te){return 4*Oa[255+A[F-W]-A[F+0]]+Oa[255+A[F-2*W]-A[F+W]]<=te}function On(A,F,W,te,de){var me=A[F-3*W],ge=A[F-2*W],ve=A[F-W],ke=A[F+0],Ee=A[F+W],Me=A[F+2*W],Qe=A[F+3*W];return 4*Oa[255+ve-ke]+Oa[255+ge-Ee]>te?0:Oa[255+A[F-4*W]-me]<=de&&Oa[255+me-ge]<=de&&Oa[255+ge-ve]<=de&&Oa[255+Qe-Me]<=de&&Oa[255+Me-Ee]<=de&&Oa[255+Ee-ke]<=de}function rn(A,F,W,te){var de=2*te+1;for(te=0;16>te;++te)en(A,F+te,W,de)&&rr(A,F+te,W)}function Yn(A,F,W,te){var de=2*te+1;for(te=0;16>te;++te)en(A,F+te*W,1,de)&&rr(A,F+te*W,1)}function Xs(A,F,W,te){var de;for(de=3;0<de;--de)rn(A,F+=4*W,W,te)}function us(A,F,W,te){var de;for(de=3;0<de;--de)Yn(A,F+=4,W,te)}function zn(A,F,W,te,de,me,ge,ve){for(me=2*me+1;0<de--;){if(On(A,F,W,me,ge))if(Xr(A,F,W,ve))rr(A,F,W);else{var ke=A,Ee=F,Me=W,Qe=ke[Ee-2*Me],Ce=ke[Ee-Me],Be=ke[Ee+0],We=ke[Ee+Me],pt=ke[Ee+2*Me],Ge=27*(vt=Ou[1020+3*(Be-Ce)+Ou[1020+Qe-We]])+63>>7,dt=18*vt+63>>7,vt=9*vt+63>>7;ke[Ee-3*Me]=so[255+ke[Ee-3*Me]+vt],ke[Ee-2*Me]=so[255+Qe+dt],ke[Ee-Me]=so[255+Ce+Ge],ke[Ee+0]=so[255+Be-Ge],ke[Ee+Me]=so[255+We-dt],ke[Ee+2*Me]=so[255+pt-vt]}F+=te}}function Jn(A,F,W,te,de,me,ge,ve){for(me=2*me+1;0<de--;){if(On(A,F,W,me,ge))if(Xr(A,F,W,ve))rr(A,F,W);else{var ke=A,Ee=F,Me=W,Qe=ke[Ee-Me],Ce=ke[Ee+0],Be=ke[Ee+Me],We=Bp[112+(4+(pt=3*(Ce-Qe))>>3)],pt=Bp[112+(pt+3>>3)],Ge=We+1>>1;ke[Ee-2*Me]=so[255+ke[Ee-2*Me]+Ge],ke[Ee-Me]=so[255+Qe+pt],ke[Ee+0]=so[255+Ce-We],ke[Ee+Me]=so[255+Be-Ge]}F+=te}}function to(A,F,W,te,de,me){zn(A,F,W,1,16,te,de,me)}function ti(A,F,W,te,de,me){zn(A,F,1,W,16,te,de,me)}function ro(A,F,W,te,de,me){var ge;for(ge=3;0<ge;--ge)Jn(A,F+=4*W,W,1,16,te,de,me)}function z(A,F,W,te,de,me){var ge;for(ge=3;0<ge;--ge)Jn(A,F+=4,1,W,16,te,de,me)}function ce(A,F,W,te,de,me,ge,ve){zn(A,F,de,1,8,me,ge,ve),zn(W,te,de,1,8,me,ge,ve)}function Se(A,F,W,te,de,me,ge,ve){zn(A,F,1,de,8,me,ge,ve),zn(W,te,1,de,8,me,ge,ve)}function Le(A,F,W,te,de,me,ge,ve){Jn(A,F+4*de,de,1,8,me,ge,ve),Jn(W,te+4*de,de,1,8,me,ge,ve)}function Ue(A,F,W,te,de,me,ge,ve){Jn(A,F+4,1,de,8,me,ge,ve),Jn(W,te+4,1,de,8,me,ge,ve)}function xt(){this.ba=new gt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Lt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ur(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function pr(){this.ua=0,this.Wa=new ze,this.vb=new ze,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ee,this.yc=new R}function Rr(){this.xb=this.a=0,this.l=new pi,this.ca=new gt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new pr,this.ab=0,this.gc=o(4,ur),this.Oc=0}function Ir(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new pi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Nn(A,F,W,te,de,me,ge){for(A=A==null?0:A[F+0],F=0;F<ge;++F)de[me+F]=A+W[te+F]&255,A=de[me+F]}function Cs(A,F,W,te,de,me,ge){var ve;if(A==null)Nn(null,null,W,te,de,me,ge);else for(ve=0;ve<ge;++ve)de[me+ve]=A[F+ve]+W[te+ve]&255}function ds(A,F,W,te,de,me,ge){if(A==null)Nn(null,null,W,te,de,me,ge);else{var ve,ke=A[F+0],Ee=ke,Me=ke;for(ve=0;ve<ge;++ve)Ee=Me+(ke=A[F+ve])-Ee,Me=W[te+ve]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=ke,de[me+ve]=Me}}function T(A,F,W,te){var de=F.width,me=F.o;if(e(A!=null&&F!=null),0>W||0>=te||W+te>me)return null;if(!A.Cc){if(A.ga==null){var ge;if(A.ga=new Ir,(ge=A.ga==null)||(ge=F.width*F.o,e(A.Gb.length==0),A.Gb=a(ge),A.Uc=0,A.Gb==null?ge=0:(A.mb=A.Gb,A.nb=A.Uc,A.rc=null,ge=1),ge=!ge),!ge){ge=A.ga;var ve=A.Fa,ke=A.P,Ee=A.qc,Me=A.mb,Qe=A.nb,Ce=ke+1,Be=Ee-1,We=ge.l;if(e(ve!=null&&Me!=null&&F!=null),Mu[0]=null,Mu[1]=Nn,Mu[2]=Cs,Mu[3]=ds,ge.ca=Me,ge.tb=Qe,ge.c=F.width,ge.i=F.height,e(0<ge.c&&0<ge.i),1>=Ee)F=0;else if(ge.$a=3&ve[ke+0],ge.Z=ve[ke+0]>>2&3,ge.Lc=ve[ke+0]>>4&3,ke=ve[ke+0]>>6&3,0>ge.$a||1<ge.$a||4<=ge.Z||1<ge.Lc||ke)F=0;else if(We.put=Jt,We.ac=sr,We.bc=kr,We.ma=ge,We.width=F.width,We.height=F.height,We.Da=F.Da,We.v=F.v,We.va=F.va,We.j=F.j,We.o=F.o,ge.$a)e:{e(ge.$a==1),F=Ci();t:for(;;){if(F==null){F=0;break e}if(e(ge!=null),ge.mc=F,F.c=ge.c,F.i=ge.i,F.l=ge.l,F.l.ma=ge,F.l.width=ge.c,F.l.height=ge.i,F.a=0,se(F.m,ve,Ce,Be),!Ds(ge.c,ge.i,1,F,null)||(F.ab==1&&F.gc[0].hc==3&&Fr(F.s)?(ge.ic=1,ve=F.c*F.i,F.Ta=null,F.Ua=0,F.V=a(ve),F.Ba=0,F.V==null?(F.a=1,F=0):F=1):(ge.ic=0,F=ps(F,ge.c)),!F))break t;F=1;break e}ge.mc=null,F=0}else F=Be>=ge.c*ge.i;ge=!F}if(ge)return null;A.ga.Lc!=1?A.Ga=0:te=me-W}e(A.ga!=null),e(W+te<=me);e:{if(F=(ve=A.ga).c,me=ve.l.o,ve.$a==0){if(Ce=A.rc,Be=A.Vc,We=A.Fa,ke=A.P+1+W*F,Ee=A.mb,Me=A.nb+W*F,e(ke<=A.P+A.qc),ve.Z!=0)for(e(Mu[ve.Z]!=null),ge=0;ge<te;++ge)Mu[ve.Z](Ce,Be,We,ke,Ee,Me,F),Ce=Ee,Be=Me,Me+=F,ke+=F;else for(ge=0;ge<te;++ge)n(Ee,Me,We,ke,F),Ce=Ee,Be=Me,Me+=F,ke+=F;A.rc=Ce,A.Vc=Be}else{if(e(ve.mc!=null),F=W+te,e((ge=ve.mc)!=null),e(F<=ge.i),ge.C>=F)F=1;else if(ve.ic||tt(),ve.ic){ve=ge.V,Ce=ge.Ba,Be=ge.c;var pt=ge.i,Ge=(We=1,ke=ge.$/Be,Ee=ge.$%Be,Me=ge.m,Qe=ge.s,ge.$),dt=Be*pt,vt=Be*F,Wt=Qe.wc,Tt=Ge<vt?Mt(Qe,Ee,ke):null;e(Ge<=dt),e(F<=pt),e(Fr(Qe));t:for(;;){for(;!Me.h&&Ge<vt;){if(Ee&Wt||(Tt=Mt(Qe,Ee,ke)),e(Tt!=null),Ne(Me),256>(pt=jt(Tt.G[0],Tt.H[0],Me)))ve[Ce+Ge]=pt,++Ge,++Ee>=Be&&(Ee=0,++ke<=F&&!(ke%16)&&hn(ge,ke));else{if(!(280>pt)){We=0;break t}pt=Ke(pt-256,Me);var mr,ir=jt(Tt.G[4],Tt.H[4],Me);if(Ne(Me),!(Ge>=(ir=Gt(Be,ir=Ke(ir,Me)))&&dt-Ge>=pt)){We=0;break t}for(mr=0;mr<pt;++mr)ve[Ce+Ge+mr]=ve[Ce+Ge+mr-ir];for(Ge+=pt,Ee+=pt;Ee>=Be;)Ee-=Be,++ke<=F&&!(ke%16)&&hn(ge,ke);Ge<vt&&Ee&Wt&&(Tt=Mt(Qe,Ee,ke))}e(Me.h==ae(Me))}hn(ge,ke>F?F:ke);break t}!We||Me.h&&Ge<dt?(We=0,ge.a=Me.h?5:3):ge.$=Ge,F=We}else F=cn(ge,ge.V,ge.Ba,ge.c,ge.i,F,$e);if(!F){te=0;break e}}W+te>=me&&(A.Cc=1),te=1}if(!te)return null;if(A.Cc&&((te=A.ga)!=null&&(te.mc=null),A.ga=null,0<A.Ga))return alert("todo:WebPDequantizeLevels"),null}return A.nb+W*de}function Y(A,F,W,te,de,me){for(;0<de--;){var ge,ve=A,ke=F+(W?1:0),Ee=A,Me=F+(W?0:3);for(ge=0;ge<te;++ge){var Qe=Ee[Me+4*ge];Qe!=255&&(Qe*=32897,ve[ke+4*ge+0]=ve[ke+4*ge+0]*Qe>>23,ve[ke+4*ge+1]=ve[ke+4*ge+1]*Qe>>23,ve[ke+4*ge+2]=ve[ke+4*ge+2]*Qe>>23)}F+=me}}function ie(A,F,W,te,de){for(;0<te--;){var me;for(me=0;me<W;++me){var ge=A[F+2*me+0],ve=15&(Ee=A[F+2*me+1]),ke=4369*ve,Ee=(240&Ee|Ee>>4)*ke>>16;A[F+2*me+0]=(240&ge|ge>>4)*ke>>16&240|(15&ge|ge<<4)*ke>>16>>4&15,A[F+2*me+1]=240&Ee|ve}F+=de}}function we(A,F,W,te,de,me,ge,ve){var ke,Ee,Me=255;for(Ee=0;Ee<de;++Ee){for(ke=0;ke<te;++ke){var Qe=A[F+ke];me[ge+4*ke]=Qe,Me&=Qe}F+=W,ge+=ve}return Me!=255}function qe(A,F,W,te,de){var me;for(me=0;me<de;++me)W[te+me]=A[F+me]>>8}function tt(){Ah=Y,Ul=ie,Mp=we,gl=qe}function Kt(A,F,W){M[A]=function(te,de,me,ge,ve,ke,Ee,Me,Qe,Ce,Be,We,pt,Ge,dt,vt,Wt){var Tt,mr=Wt-1>>1,ir=ve[ke+0]|Ee[Me+0]<<16,Qr=Qe[Ce+0]|Be[We+0]<<16;e(te!=null);var dr=3*ir+Qr+131074>>2;for(F(te[de+0],255&dr,dr>>16,pt,Ge),me!=null&&(dr=3*Qr+ir+131074>>2,F(me[ge+0],255&dr,dr>>16,dt,vt)),Tt=1;Tt<=mr;++Tt){var jn=ve[ke+Tt]|Ee[Me+Tt]<<16,Us=Qe[Ce+Tt]|Be[We+Tt]<<16,nn=ir+jn+Qr+Us+524296,ar=nn+2*(jn+Qr)>>3;dr=ar+ir>>1,ir=(nn=nn+2*(ir+Us)>>3)+jn>>1,F(te[de+2*Tt-1],255&dr,dr>>16,pt,Ge+(2*Tt-1)*W),F(te[de+2*Tt-0],255&ir,ir>>16,pt,Ge+(2*Tt-0)*W),me!=null&&(dr=nn+Qr>>1,ir=ar+Us>>1,F(me[ge+2*Tt-1],255&dr,dr>>16,dt,vt+(2*Tt-1)*W),F(me[ge+2*Tt+0],255&ir,ir>>16,dt,vt+(2*Tt+0)*W)),ir=jn,Qr=Us}1&Wt||(dr=3*ir+Qr+131074>>2,F(te[de+Wt-1],255&dr,dr>>16,pt,Ge+(Wt-1)*W),me!=null&&(dr=3*Qr+ir+131074>>2,F(me[ge+Wt-1],255&dr,dr>>16,dt,vt+(Wt-1)*W)))}}function Yr(){Ra[Bg]=Ph,Ra[io]=s0,Ra[Fg]=$b,Ra[zl]=qg,Ra[Fp]=Ed,Ra[t0]=Yc,Ra[_d]=Ad,Ra[$p]=s0,Ra[$g]=qg,Ra[r0]=Ed,Ra[Ug]=Yc}function Es(A){return A&-16384?0>A?0:255:A>>Hg}function bn(A,F){return Es((19077*A>>8)+(26149*F>>8)-14234)}function Zn(A,F,W){return Es((19077*A>>8)-(6419*F>>8)-(13320*W>>8)+8708)}function pa(A,F){return Es((19077*A>>8)+(33050*F>>8)-17685)}function Ia(A,F,W,te,de){te[de+0]=bn(A,W),te[de+1]=Zn(A,F,W),te[de+2]=pa(A,F)}function gs(A,F,W,te,de){te[de+0]=pa(A,F),te[de+1]=Zn(A,F,W),te[de+2]=bn(A,W)}function Pa(A,F,W,te,de){var me=Zn(A,F,W);F=me<<3&224|pa(A,F)>>3,te[de+0]=248&bn(A,W)|me>>5,te[de+1]=F}function fl(A,F,W,te,de){var me=240&pa(A,F)|15;te[de+0]=240&bn(A,W)|Zn(A,F,W)>>4,te[de+1]=me}function Uc(A,F,W,te,de){te[de+0]=255,Ia(A,F,W,te,de+1)}function zc(A,F,W,te,de){gs(A,F,W,te,de),te[de+3]=255}function Ao(A,F,W,te,de){Ia(A,F,W,te,de),te[de+3]=255}function Cu(A,F,W){M[A]=function(te,de,me,ge,ve,ke,Ee,Me,Qe){for(var Ce=Me+(-2&Qe)*W;Me!=Ce;)F(te[de+0],me[ge+0],ve[ke+0],Ee,Me),F(te[de+1],me[ge+0],ve[ke+0],Ee,Me+W),de+=2,++ge,++ke,Me+=2*W;1&Qe&&F(te[de+0],me[ge+0],ve[ke+0],Ee,Me)}}function Xf(A,F,W){return W==0?A==0?F==0?6:5:F==0?4:0:W}function Pp(A,F,W,te,de){switch(A>>>30){case 3:Lu(F,W,te,de,0);break;case 2:no(F,W,te,de);break;case 1:Xn(F,W,te,de)}}function pl(A,F){var W,te,de=F.M,me=F.Nb,ge=A.oc,ve=A.pc+40,ke=A.oc,Ee=A.pc+584,Me=A.oc,Qe=A.pc+600;for(W=0;16>W;++W)ge[ve+32*W-1]=129;for(W=0;8>W;++W)ke[Ee+32*W-1]=129,Me[Qe+32*W-1]=129;for(0<de?ge[ve-1-32]=ke[Ee-1-32]=Me[Qe-1-32]=129:(s(ge,ve-32-1,127,21),s(ke,Ee-32-1,127,9),s(Me,Qe-32-1,127,9)),te=0;te<A.za;++te){var Ce=F.ya[F.aa+te];if(0<te){for(W=-1;16>W;++W)n(ge,ve+32*W-4,ge,ve+32*W+12,4);for(W=-1;8>W;++W)n(ke,Ee+32*W-4,ke,Ee+32*W+4,4),n(Me,Qe+32*W-4,Me,Qe+32*W+4,4)}var Be=A.Gd,We=A.Hd+te,pt=Ce.ad,Ge=Ce.Hc;if(0<de&&(n(ge,ve-32,Be[We].y,0,16),n(ke,Ee-32,Be[We].f,0,8),n(Me,Qe-32,Be[We].ea,0,8)),Ce.Za){var dt=ge,vt=ve-32+16;for(0<de&&(te>=A.za-1?s(dt,vt,Be[We].y[15],4):n(dt,vt,Be[We+1].y,0,4)),W=0;4>W;W++)dt[vt+128+W]=dt[vt+256+W]=dt[vt+384+W]=dt[vt+0+W];for(W=0;16>W;++W,Ge<<=2)dt=ge,vt=ve+Pi[W],gi[Ce.Ob[W]](dt,vt),Pp(Ge,pt,16*+W,dt,vt)}else if(dt=Xf(te,de,Ce.Ob[0]),Io[dt](ge,ve),Ge!=0)for(W=0;16>W;++W,Ge<<=2)Pp(Ge,pt,16*+W,ge,ve+Pi[W]);for(W=Ce.Gc,dt=Xf(te,de,Ce.Dd),wc[dt](ke,Ee),wc[dt](Me,Qe),Ge=pt,dt=ke,vt=Ee,255&(Ce=0|W)&&(170&Ce?$l(Ge,256,dt,vt):Mn(Ge,256,dt,vt)),Ce=Me,Ge=Qe,255&(W>>=8)&&(170&W?$l(pt,320,Ce,Ge):Mn(pt,320,Ce,Ge)),de<A.Ub-1&&(n(Be[We].y,0,ge,ve+480,16),n(Be[We].f,0,ke,Ee+224,8),n(Be[We].ea,0,Me,Qe+224,8)),W=8*me*A.B,Be=A.sa,We=A.ta+16*te+16*me*A.R,pt=A.qa,Ce=A.ra+8*te+W,Ge=A.Ha,dt=A.Ia+8*te+W,W=0;16>W;++W)n(Be,We+W*A.R,ge,ve+32*W,16);for(W=0;8>W;++W)n(pt,Ce+W*A.B,ke,Ee+32*W,8),n(Ge,dt+W*A.B,Me,Qe+32*W,8)}}function yc(A,F,W,te,de,me,ge,ve,ke){var Ee=[0],Me=[0],Qe=0,Ce=ke!=null?ke.kd:0,Be=ke??new Lt;if(A==null||12>W)return 7;Be.data=A,Be.w=F,Be.ha=W,F=[F],W=[W],Be.gb=[Be.gb];e:{var We=F,pt=W,Ge=Be.gb;if(e(A!=null),e(pt!=null),e(Ge!=null),Ge[0]=0,12<=pt[0]&&!r(A,We[0],"RIFF")){if(r(A,We[0]+8,"WEBP")){Ge=3;break e}var dt=_e(A,We[0]+4);if(12>dt||4294967286<dt){Ge=3;break e}if(Ce&&dt>pt[0]-8){Ge=7;break e}Ge[0]=dt,We[0]+=12,pt[0]-=12}Ge=0}if(Ge!=0)return Ge;for(dt=0<Be.gb[0],W=W[0];;){e:{var vt=A;pt=F,Ge=W;var Wt=Ee,Tt=Me,mr=We=[0];if((dr=Qe=[Qe])[0]=0,8>Ge[0])Ge=7;else{if(!r(vt,pt[0],"VP8X")){if(_e(vt,pt[0]+4)!=10){Ge=3;break e}if(18>Ge[0]){Ge=7;break e}var ir=_e(vt,pt[0]+8),Qr=1+le(vt,pt[0]+12);if(2147483648<=Qr*(vt=1+le(vt,pt[0]+15))){Ge=3;break e}mr!=null&&(mr[0]=ir),Wt!=null&&(Wt[0]=Qr),Tt!=null&&(Tt[0]=vt),pt[0]+=18,Ge[0]-=18,dr[0]=1}Ge=0}}if(Qe=Qe[0],We=We[0],Ge!=0)return Ge;if(pt=!!(2&We),!dt&&Qe)return 3;if(me!=null&&(me[0]=!!(16&We)),ge!=null&&(ge[0]=pt),ve!=null&&(ve[0]=0),ge=Ee[0],We=Me[0],Qe&&pt&&ke==null){Ge=0;break}if(4>W){Ge=7;break}if(dt&&Qe||!dt&&!Qe&&!r(A,F[0],"ALPH")){W=[W],Be.na=[Be.na],Be.P=[Be.P],Be.Sa=[Be.Sa];e:{ir=A,Ge=F,dt=W;var dr=Be.gb;Wt=Be.na,Tt=Be.P,mr=Be.Sa,Qr=22,e(ir!=null),e(dt!=null),vt=Ge[0];var jn=dt[0];for(e(Wt!=null),e(mr!=null),Wt[0]=null,Tt[0]=null,mr[0]=0;;){if(Ge[0]=vt,dt[0]=jn,8>jn){Ge=7;break e}var Us=_e(ir,vt+4);if(4294967286<Us){Ge=3;break e}var nn=8+Us+1&-2;if(Qr+=nn,0<dr&&Qr>dr){Ge=3;break e}if(!r(ir,vt,"VP8 ")||!r(ir,vt,"VP8L")){Ge=0;break e}if(jn[0]<nn){Ge=7;break e}r(ir,vt,"ALPH")||(Wt[0]=ir,Tt[0]=vt+8,mr[0]=Us),vt+=nn,jn-=nn}}if(W=W[0],Be.na=Be.na[0],Be.P=Be.P[0],Be.Sa=Be.Sa[0],Ge!=0)break}W=[W],Be.Ja=[Be.Ja],Be.xa=[Be.xa];e:if(dr=A,Ge=F,dt=W,Wt=Be.gb[0],Tt=Be.Ja,mr=Be.xa,ir=Ge[0],vt=!r(dr,ir,"VP8 "),Qr=!r(dr,ir,"VP8L"),e(dr!=null),e(dt!=null),e(Tt!=null),e(mr!=null),8>dt[0])Ge=7;else{if(vt||Qr){if(dr=_e(dr,ir+4),12<=Wt&&dr>Wt-12){Ge=3;break e}if(Ce&&dr>dt[0]-8){Ge=7;break e}Tt[0]=dr,Ge[0]+=8,dt[0]-=8,mr[0]=Qr}else mr[0]=5<=dt[0]&&dr[ir+0]==47&&!(dr[ir+4]>>5),Tt[0]=dt[0];Ge=0}if(W=W[0],Be.Ja=Be.Ja[0],Be.xa=Be.xa[0],F=F[0],Ge!=0)break;if(4294967286<Be.Ja)return 3;if(ve==null||pt||(ve[0]=Be.xa?2:1),ge=[ge],We=[We],Be.xa){if(5>W){Ge=7;break}ve=ge,Ce=We,pt=me,A==null||5>W?A=0:5<=W&&A[F+0]==47&&!(A[F+4]>>5)?(dt=[0],dr=[0],Wt=[0],se(Tt=new H,A,F,W),Ae(Tt,dt,dr,Wt)?(ve!=null&&(ve[0]=dt[0]),Ce!=null&&(Ce[0]=dr[0]),pt!=null&&(pt[0]=Wt[0]),A=1):A=0):A=0}else{if(10>W){Ge=7;break}ve=We,A==null||10>W||!Aa(A,F+3,W-3)?A=0:(Ce=A[F+0]|A[F+1]<<8|A[F+2]<<16,pt=16383&(A[F+7]<<8|A[F+6]),A=16383&(A[F+9]<<8|A[F+8]),1&Ce||3<(Ce>>1&7)||!(Ce>>4&1)||Ce>>5>=Be.Ja||!pt||!A?A=0:(ge&&(ge[0]=pt),ve&&(ve[0]=A),A=1))}if(!A||(ge=ge[0],We=We[0],Qe&&(Ee[0]!=ge||Me[0]!=We)))return 3;ke!=null&&(ke[0]=Be,ke.offset=F-ke.w,e(4294967286>F-ke.w),e(ke.offset==ke.ha-W));break}return Ge==0||Ge==7&&Qe&&ke==null?(me!=null&&(me[0]|=Be.na!=null&&0<Be.na.length),te!=null&&(te[0]=ge),de!=null&&(de[0]=We),0):Ge}function Eu(A,F,W){var te=F.width,de=F.height,me=0,ge=0,ve=te,ke=de;if(F.Da=A!=null&&0<A.Da,F.Da&&(ve=A.cd,ke=A.bd,me=A.v,ge=A.j,11>W||(me&=-2,ge&=-2),0>me||0>ge||0>=ve||0>=ke||me+ve>te||ge+ke>de))return 0;if(F.v=me,F.j=ge,F.va=me+ve,F.o=ge+ke,F.U=ve,F.T=ke,F.da=A!=null&&0<A.da,F.da){if(!Ye(ve,ke,W=[A.ib],me=[A.hb]))return 0;F.ib=W[0],F.hb=me[0]}return F.ob=A!=null&&A.ob,F.Kb=A==null||!A.Sd,F.da&&(F.ob=F.ib<3*te/4&&F.hb<3*de/4,F.Kb=0),1}function Lp(A){if(A==null)return 2;if(11>A.S){var F=A.f.RGBA;F.fb+=(A.height-1)*F.A,F.A=-F.A}else F=A.f.kb,A=A.height,F.O+=(A-1)*F.fa,F.fa=-F.fa,F.N+=(A-1>>1)*F.Ab,F.Ab=-F.Ab,F.W+=(A-1>>1)*F.Db,F.Db=-F.Db,F.F!=null&&(F.J+=(A-1)*F.lb,F.lb=-F.lb);return 0}function bc(A,F,W,te){if(te==null||0>=A||0>=F)return 2;if(W!=null){if(W.Da){var de=W.cd,me=W.bd,ge=-2&W.v,ve=-2&W.j;if(0>ge||0>ve||0>=de||0>=me||ge+de>A||ve+me>F)return 2;A=de,F=me}if(W.da){if(!Ye(A,F,de=[W.ib],me=[W.hb]))return 2;A=de[0],F=me[0]}}te.width=A,te.height=F;e:{var ke=te.width,Ee=te.height;if(A=te.S,0>=ke||0>=Ee||!(A>=Bg&&13>A))A=2;else{if(0>=te.Rd&&te.sd==null){ge=me=de=F=0;var Me=(ve=ke*Gg[A])*Ee;if(11>A||(me=(Ee+1)/2*(F=(ke+1)/2),A==12&&(ge=(de=ke)*Ee)),(Ee=a(Me+2*me+ge))==null){A=1;break e}te.sd=Ee,11>A?((ke=te.f.RGBA).eb=Ee,ke.fb=0,ke.A=ve,ke.size=Me):((ke=te.f.kb).y=Ee,ke.O=0,ke.fa=ve,ke.Fd=Me,ke.f=Ee,ke.N=0+Me,ke.Ab=F,ke.Cd=me,ke.ea=Ee,ke.W=0+Me+me,ke.Db=F,ke.Ed=me,A==12&&(ke.F=Ee,ke.J=0+Me+2*me),ke.Tc=ge,ke.lb=de)}if(F=1,de=te.S,me=te.width,ge=te.height,de>=Bg&&13>de)if(11>de)A=te.f.RGBA,F&=(ve=Math.abs(A.A))*(ge-1)+me<=A.size,F&=ve>=me*Gg[de],F&=A.eb!=null;else{A=te.f.kb,ve=(me+1)/2,Me=(ge+1)/2,ke=Math.abs(A.fa),Ee=Math.abs(A.Ab);var Qe=Math.abs(A.Db),Ce=Math.abs(A.lb),Be=Ce*(ge-1)+me;F&=ke*(ge-1)+me<=A.Fd,F&=Ee*(Me-1)+ve<=A.Cd,F=(F&=Qe*(Me-1)+ve<=A.Ed)&ke>=me&Ee>=ve&Qe>=ve,F&=A.y!=null,F&=A.f!=null,F&=A.ea!=null,de==12&&(F&=Ce>=me,F&=Be<=A.Tc,F&=A.F!=null)}else F=0;A=F?0:2}}return A!=0||W!=null&&W.fd&&(A=Lp(te)),A}var kd=64,Qo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],To=24,Vc=32,qc=8,Au=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Nt("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(A){return A},M.Predictor2=function(A,F,W){return F[W+0]},M.Predictor3=function(A,F,W){return F[W+1]},M.Predictor4=function(A,F,W){return F[W-1]},M.Predictor5=function(A,F,W){return Ut(Ut(A,F[W+1]),F[W+0])},M.Predictor6=function(A,F,W){return Ut(A,F[W-1])},M.Predictor7=function(A,F,W){return Ut(A,F[W+0])},M.Predictor8=function(A,F,W){return Ut(F[W-1],F[W+0])},M.Predictor9=function(A,F,W){return Ut(F[W+0],F[W+1])},M.Predictor10=function(A,F,W){return Ut(Ut(A,F[W-1]),Ut(F[W+0],F[W+1]))},M.Predictor11=function(A,F,W){var te=F[W+0];return 0>=It(te>>24&255,A>>24&255,(F=F[W-1])>>24&255)+It(te>>16&255,A>>16&255,F>>16&255)+It(te>>8&255,A>>8&255,F>>8&255)+It(255&te,255&A,255&F)?te:A},M.Predictor12=function(A,F,W){var te=F[W+0];return(nt((A>>24&255)+(te>>24&255)-((F=F[W-1])>>24&255))<<24|nt((A>>16&255)+(te>>16&255)-(F>>16&255))<<16|nt((A>>8&255)+(te>>8&255)-(F>>8&255))<<8|nt((255&A)+(255&te)-(255&F)))>>>0},M.Predictor13=function(A,F,W){var te=F[W-1];return(bt((A=Ut(A,F[W+0]))>>24&255,te>>24&255)<<24|bt(A>>16&255,te>>16&255)<<16|bt(A>>8&255,te>>8&255)<<8|bt(255&A,255&te))>>>0};var Qf=M.PredictorAdd0;M.PredictorAdd1=_t,Nt("Predictor2","PredictorAdd2"),Nt("Predictor3","PredictorAdd3"),Nt("Predictor4","PredictorAdd4"),Nt("Predictor5","PredictorAdd5"),Nt("Predictor6","PredictorAdd6"),Nt("Predictor7","PredictorAdd7"),Nt("Predictor8","PredictorAdd8"),Nt("Predictor9","PredictorAdd9"),Nt("Predictor10","PredictorAdd10"),Nt("Predictor11","PredictorAdd11"),Nt("Predictor12","PredictorAdd12"),Nt("Predictor13","PredictorAdd13");var Jf=M.PredictorAdd2;Dt("ColorIndexInverseTransform","MapARGB","32b",function(A){return A>>8&255},function(A){return A}),Dt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(A){return A},function(A){return A>>8&255});var Ti,Mg=M.ColorIndexInverseTransform,Hc=M.MapARGB,Wc=M.VP8LColorIndexInverseTransformAlpha,La=M.MapAlpha,Tu=M.VP8LPredictorsAdd=[];Tu.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var Zf,e0,Iu,Pu,Gc,Ch,ml,Lu,no,$l,Xn,Mn,As,Ii,Kc,vc,Eh,Op,Mb,Kw,Yw,Xw,Rb,Db,Ah,Ul,Mp,gl,Th=a(511),Rg=a(2041),Rp=a(225),Dp=a(767),Dg=0,Ou=Rg,Bp=Rp,so=Dp,Oa=Th,Bg=0,io=1,Fg=2,zl=3,Fp=4,t0=5,_d=6,$p=7,$g=8,r0=9,Ug=10,Vl=[2,3,7],n0=[3,3,11],Ih=[280,256,256,256,40],zg=[0,1,1,1,0],Up=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ql=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Hl=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Sd=8,Wl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Gl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],xl=null,Qw=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Bb=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Vg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Jw=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ma=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],$s=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_n=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Io=[],gi=[],wc=[],Cd=1,Fb=2,Mu=[],Ra=[];Kt("UpsampleRgbLinePair",Ia,3),Kt("UpsampleBgrLinePair",gs,3),Kt("UpsampleRgbaLinePair",Ao,4),Kt("UpsampleBgraLinePair",zc,4),Kt("UpsampleArgbLinePair",Uc,4),Kt("UpsampleRgba4444LinePair",fl,2),Kt("UpsampleRgb565LinePair",Pa,2);var Ph=M.UpsampleRgbLinePair,$b=M.UpsampleBgrLinePair,s0=M.UpsampleRgbaLinePair,qg=M.UpsampleBgraLinePair,Ed=M.UpsampleArgbLinePair,Yc=M.UpsampleRgba4444LinePair,Ad=M.UpsampleRgb565LinePair,Kl=16,i0=1<<Kl-1,Lh=-227,Td=482,Hg=6,Id=0,Da=a(256),Wg=a(256),Zw=a(256),N3=a(256),j3=a(Td-Lh),k3=a(Td-Lh);Cu("YuvToRgbRow",Ia,3),Cu("YuvToBgrRow",gs,3),Cu("YuvToRgbaRow",Ao,4),Cu("YuvToBgraRow",zc,4),Cu("YuvToArgbRow",Uc,4),Cu("YuvToRgba4444Row",fl,2),Cu("YuvToRgb565Row",Pa,2);var Pi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],a0=[0,2,8],zp=[8,7,6,4,4,2,2,2,1,1,1,1],Vp=1;this.WebPDecodeRGBA=function(A,F,W,te,de){var me=io,ge=new xt,ve=new gt;ge.ba=ve,ve.S=me,ve.width=[ve.width],ve.height=[ve.height];var ke=ve.width,Ee=ve.height,Me=new Ot;if(Me==null||A==null)var Qe=2;else e(Me!=null),Qe=yc(A,F,W,Me.width,Me.height,Me.Pd,Me.Qd,Me.format,null);if(Qe!=0?ke=0:(ke!=null&&(ke[0]=Me.width[0]),Ee!=null&&(Ee[0]=Me.height[0]),ke=1),ke){ve.width=ve.width[0],ve.height=ve.height[0],te!=null&&(te[0]=ve.width),de!=null&&(de[0]=ve.height);e:{if(te=new pi,(de=new Lt).data=A,de.w=F,de.ha=W,de.kd=1,F=[0],e(de!=null),((A=yc(de.data,de.w,de.ha,null,null,null,F,null,de))==0||A==7)&&F[0]&&(A=4),(F=A)==0){if(e(ge!=null),te.data=de.data,te.w=de.w+de.offset,te.ha=de.ha-de.offset,te.put=Jt,te.ac=sr,te.bc=kr,te.ma=ge,de.xa){if((A=Ci())==null){ge=1;break e}if((function(Ce,Be){var We=[0],pt=[0],Ge=[0];t:for(;;){if(Ce==null)return 0;if(Be==null)return Ce.a=2,0;if(Ce.l=Be,Ce.a=0,se(Ce.m,Be.data,Be.w,Be.ha),!Ae(Ce.m,We,pt,Ge)){Ce.a=3;break t}if(Ce.xb=Fb,Be.width=We[0],Be.height=pt[0],!Ds(We[0],pt[0],1,Ce,null))break t;return 1}return e(Ce.a!=0),0})(A,te)){if(te=(F=bc(te.width,te.height,ge.Oa,ge.ba))==0){t:{te=A;r:for(;;){if(te==null){te=0;break t}if(e(te.s.yc!=null),e(te.s.Ya!=null),e(0<te.s.Wb),e((W=te.l)!=null),e((de=W.ma)!=null),te.xb!=0){if(te.ca=de.ba,te.tb=de.tb,e(te.ca!=null),!Eu(de.Oa,W,zl)){te.a=2;break r}if(!ps(te,W.width)||W.da)break r;if((W.da||At(te.ca.S))&&tt(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&tt()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!oe(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!cn(te,te.V,te.Ba,te.c,te.i,W.o,vr))break r;de.Dc=te.Ma,te=1;break t}e(te.a!=0),te=0}te=!te}te&&(F=A.a)}else F=A.a}else{if((A=new ks)==null){ge=1;break e}if(A.Fa=de.na,A.P=de.P,A.qc=de.Sa,mi(A,te)){if((F=bc(te.width,te.height,ge.Oa,ge.ba))==0){if(A.Aa=0,W=ge.Oa,e((de=A)!=null),W!=null){if(0<(ke=0>(ke=W.Md)?0:100<ke?255:255*ke/100)){for(Ee=Me=0;4>Ee;++Ee)12>(Qe=de.pb[Ee]).lc&&(Qe.ia=ke*zp[0>Qe.lc?0:Qe.lc]>>3),Me|=Qe.ia;Me&&(alert("todo:VP8InitRandom"),de.ia=1)}de.Ga=W.Id,100<de.Ga?de.Ga=100:0>de.Ga&&(de.Ga=0)}(function(Ce,Be){if(Ce==null)return 0;if(Be==null)return Zr(Ce,2,"NULL VP8Io parameter in VP8Decode().");if(!Ce.cb&&!mi(Ce,Be))return 0;if(e(Ce.cb),Be.ac==null||Be.ac(Be)){Be.ob&&(Ce.L=0);var We=a0[Ce.L];if(Ce.L==2?(Ce.yb=0,Ce.zb=0):(Ce.yb=Be.v-We>>4,Ce.zb=Be.j-We>>4,0>Ce.yb&&(Ce.yb=0),0>Ce.zb&&(Ce.zb=0)),Ce.Va=Be.o+15+We>>4,Ce.Hb=Be.va+15+We>>4,Ce.Hb>Ce.za&&(Ce.Hb=Ce.za),Ce.Va>Ce.Ub&&(Ce.Va=Ce.Ub),0<Ce.L){var pt=Ce.ed;for(We=0;4>We;++We){var Ge;if(Ce.Qa.Cb){var dt=Ce.Qa.Lb[We];Ce.Qa.Fb||(dt+=pt.Tb)}else dt=pt.Tb;for(Ge=0;1>=Ge;++Ge){var vt=Ce.gd[We][Ge],Wt=dt;if(pt.Pc&&(Wt+=pt.vd[0],Ge&&(Wt+=pt.od[0])),0<(Wt=0>Wt?0:63<Wt?63:Wt)){var Tt=Wt;0<pt.wb&&(Tt=4<pt.wb?Tt>>2:Tt>>1)>9-pt.wb&&(Tt=9-pt.wb),1>Tt&&(Tt=1),vt.dd=Tt,vt.tc=2*Wt+Tt,vt.ld=40<=Wt?2:15<=Wt?1:0}else vt.tc=0;vt.La=Ge}}}We=0}else Zr(Ce,6,"Frame setup failed"),We=Ce.a;if(We=We==0){if(We){Ce.$c=0,0<Ce.Aa||(Ce.Ic=Vp);t:{We=Ce.Ic,pt=4*(Tt=Ce.za);var mr=32*Tt,ir=Tt+1,Qr=0<Ce.L?Tt*(0<Ce.Aa?2:1):0,dr=(Ce.Aa==2?2:1)*Tt;if((vt=pt+832+(Ge=3*(16*We+a0[Ce.L])/2*mr)+(dt=Ce.Fa!=null&&0<Ce.Fa.length?Ce.Kc.c*Ce.Kc.i:0))!=vt)We=0;else{if(vt>Ce.Vb){if(Ce.Vb=0,Ce.Ec=a(vt),Ce.Fc=0,Ce.Ec==null){We=Zr(Ce,1,"no memory during frame initialization.");break t}Ce.Vb=vt}vt=Ce.Ec,Wt=Ce.Fc,Ce.Ac=vt,Ce.Bc=Wt,Wt+=pt,Ce.Gd=o(mr,Rl),Ce.Hd=0,Ce.rb=o(ir+1,sa),Ce.sb=1,Ce.wa=Qr?o(Qr,Bs):null,Ce.Y=0,Ce.D.Nb=0,Ce.D.wa=Ce.wa,Ce.D.Y=Ce.Y,0<Ce.Aa&&(Ce.D.Y+=Tt),e(!0),Ce.oc=vt,Ce.pc=Wt,Wt+=832,Ce.ya=o(dr,Fi),Ce.aa=0,Ce.D.ya=Ce.ya,Ce.D.aa=Ce.aa,Ce.Aa==2&&(Ce.D.aa+=Tt),Ce.R=16*Tt,Ce.B=8*Tt,Tt=(mr=a0[Ce.L])*Ce.R,mr=mr/2*Ce.B,Ce.sa=vt,Ce.ta=Wt+Tt,Ce.qa=Ce.sa,Ce.ra=Ce.ta+16*We*Ce.R+mr,Ce.Ha=Ce.qa,Ce.Ia=Ce.ra+8*We*Ce.B+mr,Ce.$c=0,Wt+=Ge,Ce.mb=dt?vt:null,Ce.nb=dt?Wt:null,e(Wt+dt<=Ce.Fc+Ce.Vb),No(Ce),s(Ce.Ac,Ce.Bc,0,pt),We=1}}if(We){if(Be.ka=0,Be.y=Ce.sa,Be.O=Ce.ta,Be.f=Ce.qa,Be.N=Ce.ra,Be.ea=Ce.Ha,Be.Vd=Ce.Ia,Be.fa=Ce.R,Be.Rc=Ce.B,Be.F=null,Be.J=0,!Dg){for(We=-255;255>=We;++We)Th[255+We]=0>We?-We:We;for(We=-1020;1020>=We;++We)Rg[1020+We]=-128>We?-128:127<We?127:We;for(We=-112;112>=We;++We)Rp[112+We]=-16>We?-16:15<We?15:We;for(We=-255;510>=We;++We)Dp[255+We]=0>We?0:255<We?255:We;Dg=1}ml=is,Lu=mc,$l=Ei,Xn=jo,Mn=ei,no=Dl,As=to,Ii=ti,Kc=ce,vc=Se,Eh=ro,Op=z,Mb=Le,Kw=Ue,Yw=rn,Xw=Yn,Rb=Xs,Db=us,gi[0]=Yo,gi[1]=gc,gi[2]=So,gi[3]=Co,gi[4]=Ys,gi[5]=Xo,gi[6]=Ss,gi[7]=un,gi[8]=Eo,gi[9]=zi,Io[0]=fa,Io[1]=Bl,Io[2]=Fl,Io[3]=ko,Io[4]=ms,Io[5]=Ai,Io[6]=_o,wc[0]=be,wc[1]=ha,wc[2]=Ta,wc[3]=xc,wc[4]=it,wc[5]=Te,wc[6]=Tr,We=1}else We=0}We&&(We=(function(jn,Us){for(jn.M=0;jn.M<jn.Va;++jn.M){var nn,ar=jn.Jc[jn.M&jn.Xb],Zt=jn.m,ri=jn;for(nn=0;nn<ri.za;++nn){var Ur=Zt,dn=ri,as=dn.Ac,aa=dn.Bc+4*nn,Ba=dn.zc,Ts=dn.ya[dn.aa+nn];if(dn.Qa.Bb?Ts.$b=ue(Ur,dn.Pa.jb[0])?2+ue(Ur,dn.Pa.jb[2]):ue(Ur,dn.Pa.jb[1]):Ts.$b=0,dn.kc&&(Ts.Ad=ue(Ur,dn.Bd)),Ts.Za=!ue(Ur,145)+0,Ts.Za){var Vi=Ts.Ob,ao=0;for(dn=0;4>dn;++dn){var qi,vn=Ba[0+dn];for(qi=0;4>qi;++qi){vn=Ma[as[aa+qi]][vn];for(var Vn=Vg[ue(Ur,vn[0])];0<Vn;)Vn=Vg[2*Vn+ue(Ur,vn[Vn])];vn=-Vn,as[aa+qi]=vn}n(Vi,ao,as,aa,4),ao+=4,Ba[0+dn]=vn}}else vn=ue(Ur,156)?ue(Ur,128)?1:3:ue(Ur,163)?2:0,Ts.Ob[0]=vn,s(as,aa,vn,4),s(Ba,0,vn,4);Ts.Dd=ue(Ur,142)?ue(Ur,114)?ue(Ur,183)?1:3:2:0}if(ri.m.Ka)return Zr(jn,7,"Premature end-of-partition0 encountered.");for(;jn.ja<jn.za;++jn.ja){if(ri=ar,Ur=(Zt=jn).rb[Zt.sb-1],as=Zt.rb[Zt.sb+Zt.ja],nn=Zt.ya[Zt.aa+Zt.ja],aa=Zt.kc?nn.Ad:0)Ur.la=as.la=0,nn.Za||(Ur.Na=as.Na=0),nn.Hc=0,nn.Gc=0,nn.ia=0;else{var ni,Qn;if(Ur=as,as=ri,aa=Zt.Pa.Xc,Ba=Zt.ya[Zt.aa+Zt.ja],Ts=Zt.pb[Ba.$b],dn=Ba.ad,Vi=0,ao=Zt.rb[Zt.sb-1],vn=qi=0,s(dn,Vi,0,384),Ba.Za)var oa=0,si=aa[3];else{Vn=a(16);var qn=Ur.Na+ao.Na;if(qn=xl(as,aa[1],qn,Ts.Eb,0,Vn,0),Ur.Na=ao.Na=(0<qn)+0,1<qn)ml(Vn,0,dn,Vi);else{var Li=Vn[0]+3>>3;for(Vn=0;256>Vn;Vn+=16)dn[Vi+Vn]=Li}oa=1,si=aa[0]}var os=15&Ur.la,Hi=15&ao.la;for(Vn=0;4>Vn;++Vn){var Wi=1&Hi;for(Li=Qn=0;4>Li;++Li)os=os>>1|(Wi=(qn=xl(as,si,qn=Wi+(1&os),Ts.Sc,oa,dn,Vi))>oa)<<7,Qn=Qn<<2|(3<qn?3:1<qn?2:dn[Vi+0]!=0),Vi+=16;os>>=4,Hi=Hi>>1|Wi<<7,qi=(qi<<8|Qn)>>>0}for(si=os,oa=Hi>>4,ni=0;4>ni;ni+=2){for(Qn=0,os=Ur.la>>4+ni,Hi=ao.la>>4+ni,Vn=0;2>Vn;++Vn){for(Wi=1&Hi,Li=0;2>Li;++Li)qn=Wi+(1&os),os=os>>1|(Wi=0<(qn=xl(as,aa[2],qn,Ts.Qc,0,dn,Vi)))<<3,Qn=Qn<<2|(3<qn?3:1<qn?2:dn[Vi+0]!=0),Vi+=16;os>>=2,Hi=Hi>>1|Wi<<5}vn|=Qn<<4*ni,si|=os<<4<<ni,oa|=(240&Hi)<<ni}Ur.la=si,ao.la=oa,Ba.Hc=qi,Ba.Gc=vn,Ba.ia=43690&vn?0:Ts.ia,aa=!(qi|vn)}if(0<Zt.L&&(Zt.wa[Zt.Y+Zt.ja]=Zt.gd[nn.$b][nn.Za],Zt.wa[Zt.Y+Zt.ja].La|=!aa),ri.Ka)return Zr(jn,7,"Premature end-of-file encountered.")}if(No(jn),Zt=Us,ri=1,nn=(ar=jn).D,Ur=0<ar.L&&ar.M>=ar.zb&&ar.M<=ar.Va,ar.Aa==0)t:{if(nn.M=ar.M,nn.uc=Ur,pl(ar,nn),ri=1,nn=(Qn=ar.D).Nb,Ur=(vn=a0[ar.L])*ar.R,as=vn/2*ar.B,Vn=16*nn*ar.R,Li=8*nn*ar.B,aa=ar.sa,Ba=ar.ta-Ur+Vn,Ts=ar.qa,dn=ar.ra-as+Li,Vi=ar.Ha,ao=ar.Ia-as+Li,Hi=(os=Qn.M)==0,qi=os>=ar.Va-1,ar.Aa==2&&pl(ar,Qn),Qn.uc)for(Wi=(qn=ar).D.M,e(qn.D.uc),Qn=qn.yb;Qn<qn.Hb;++Qn){oa=Qn,si=Wi;var xs=(Rn=(Gi=qn).D).Nb;ni=Gi.R;var Rn=Rn.wa[Rn.Y+oa],oo=Gi.sa,xi=Gi.ta+16*xs*ni+16*oa,Or=Rn.dd,Dr=Rn.tc;if(Dr!=0)if(e(3<=Dr),Gi.L==1)0<oa&&Xw(oo,xi,ni,Dr+4),Rn.La&&Db(oo,xi,ni,Dr),0<si&&Yw(oo,xi,ni,Dr+4),Rn.La&&Rb(oo,xi,ni,Dr);else{var Hn=Gi.B,Jo=Gi.qa,Yl=Gi.ra+8*xs*Hn+8*oa,Po=Gi.Ha,Gi=Gi.Ia+8*xs*Hn+8*oa;xs=Rn.ld,0<oa&&(Ii(oo,xi,ni,Dr+4,Or,xs),vc(Jo,Yl,Po,Gi,Hn,Dr+4,Or,xs)),Rn.La&&(Op(oo,xi,ni,Dr,Or,xs),Kw(Jo,Yl,Po,Gi,Hn,Dr,Or,xs)),0<si&&(As(oo,xi,ni,Dr+4,Or,xs),Kc(Jo,Yl,Po,Gi,Hn,Dr+4,Or,xs)),Rn.La&&(Eh(oo,xi,ni,Dr,Or,xs),Mb(Jo,Yl,Po,Gi,Hn,Dr,Or,xs))}}if(ar.ia&&alert("todo:DitherRow"),Zt.put!=null){if(Qn=16*os,os=16*(os+1),Hi?(Zt.y=ar.sa,Zt.O=ar.ta+Vn,Zt.f=ar.qa,Zt.N=ar.ra+Li,Zt.ea=ar.Ha,Zt.W=ar.Ia+Li):(Qn-=vn,Zt.y=aa,Zt.O=Ba,Zt.f=Ts,Zt.N=dn,Zt.ea=Vi,Zt.W=ao),qi||(os-=vn),os>Zt.o&&(os=Zt.o),Zt.F=null,Zt.J=null,ar.Fa!=null&&0<ar.Fa.length&&Qn<os&&(Zt.J=T(ar,Zt,Qn,os-Qn),Zt.F=ar.mb,Zt.F==null&&Zt.F.length==0)){ri=Zr(ar,3,"Could not decode alpha data.");break t}Qn<Zt.j&&(vn=Zt.j-Qn,Qn=Zt.j,e(!(1&vn)),Zt.O+=ar.R*vn,Zt.N+=ar.B*(vn>>1),Zt.W+=ar.B*(vn>>1),Zt.F!=null&&(Zt.J+=Zt.width*vn)),Qn<os&&(Zt.O+=Zt.v,Zt.N+=Zt.v>>1,Zt.W+=Zt.v>>1,Zt.F!=null&&(Zt.J+=Zt.v),Zt.ka=Qn-Zt.j,Zt.U=Zt.va-Zt.v,Zt.T=os-Qn,ri=Zt.put(Zt))}nn+1!=ar.Ic||qi||(n(ar.sa,ar.ta-Ur,aa,Ba+16*ar.R,Ur),n(ar.qa,ar.ra-as,Ts,dn+8*ar.B,as),n(ar.Ha,ar.Ia-as,Vi,ao+8*ar.B,as))}if(!ri)return Zr(jn,6,"Output aborted.")}return 1})(Ce,Be)),Be.bc!=null&&Be.bc(Be),We&=1}return We?(Ce.cb=0,We):0})(A,te)||(F=A.a)}}else F=A.a}F==0&&ge.Oa!=null&&ge.Oa.fd&&(F=Lp(ge.ba))}ge=F}me=ge!=0?null:11>me?ve.f.RGBA.eb:ve.f.kb.y}else me=null;return me};var Gg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(M,B){for(var S="",P=0;P<4;P++)S+=String.fromCharCode(M[B++]);return S}function h(M,B){return M[B+0]|M[B+1]<<8}function f(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16)>>>0}function m(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16|M[B+3]<<24)>>>0}new c;var g=[0],y=[0],v=[],w=new c,N=t,k=(function(M,B){var S={},P=0,R=!1,V=0,ee=0;if(S.frames=[],!(function(U,H){for(var re=0;re<4;re++)if(U[H+re]!="RIFF".charCodeAt(re))return!0;return!1})(M,B)){for(m(M,B+=4),B+=8;B<M.length;){var G=u(M,B),J=m(M,B+=4);B+=4;var Z=J+(1&J);switch(G){case"VP8 ":case"VP8L":S.frames[P]===void 0&&(S.frames[P]={}),(q=S.frames[P]).src_off=R?ee:B-8,q.src_size=V+J+8,P++,R&&(R=!1,V=0,ee=0);break;case"VP8X":(q=S.header={}).feature_flags=M[B];var se=B+4;q.canvas_width=1+f(M,se),se+=3,q.canvas_height=1+f(M,se),se+=3;break;case"ALPH":R=!0,V=Z+8,ee=B-8;break;case"ANIM":(q=S.header).bgcolor=m(M,B),se=B+4,q.loop_count=h(M,se),se+=2;break;case"ANMF":var X,q;(q=S.frames[P]={}).offset_x=2*f(M,B),B+=3,q.offset_y=2*f(M,B),B+=3,q.width=1+f(M,B),B+=3,q.height=1+f(M,B),B+=3,q.duration=f(M,B),B+=3,X=M[B++],q.dispose=1&X,q.blend=X>>1&1}G!="ANMF"&&(B+=Z)}return S}})(N,0);k.response=N,k.rgbaoutput=!0,k.dataurl=!1;var C=k.header?k.header:null,I=k.frames?k.frames:null;if(C){C.loop_counter=C.loop_count,g=[C.canvas_height],y=[C.canvas_width];for(var O=0;O<I.length&&I[O].blend!=0;O++);}var L=I[0],_=w.WebPDecodeRGBA(N,L.src_off,L.src_size,y,g);L.rgba=_,L.imgwidth=y[0],L.imgheight=g[0];for(var E=0;E<y[0]*g[0]*4;E++)v[E]=_[E];return this.width=y,this.height=g,this.data=v,this}(function(t){var e,r,n,s,a,o,l,c,u,h=function(U){return U=U||{},this.isStrokeTransparent=U.isStrokeTransparent||!1,this.strokeOpacity=U.strokeOpacity||1,this.strokeStyle=U.strokeStyle||"#000000",this.fillStyle=U.fillStyle||"#000000",this.isFillTransparent=U.isFillTransparent||!1,this.fillOpacity=U.fillOpacity||1,this.font=U.font||"10px sans-serif",this.textBaseline=U.textBaseline||"alphabetic",this.textAlign=U.textAlign||"left",this.lineWidth=U.lineWidth||1,this.lineJoin=U.lineJoin||"miter",this.lineCap=U.lineCap||"butt",this.path=U.path||[],this.transform=U.transform!==void 0?U.transform.clone():new c,this.globalCompositeOperation=U.globalCompositeOperation||"normal",this.globalAlpha=U.globalAlpha||1,this.clip_path=U.clip_path||[],this.currentPoint=U.currentPoint||new o,this.miterLimit=U.miterLimit||10,this.lastPoint=U.lastPoint||new o,this.lineDashOffset=U.lineDashOffset||0,this.lineDash=U.lineDash||[],this.margin=U.margin||[0,0,0,0],this.prevPageLastElemOffset=U.prevPageLastElemOffset||0,this.ignoreClearRect=typeof U.ignoreClearRect!="boolean"||U.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var f=function(U){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=U;Object.defineProperty(this,"pdf",{get:function(){return H}});var re=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return re},set:function(oe){re=!!oe}});var ae=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ae},set:function(oe){ae=!!oe}});var xe=0;Object.defineProperty(this,"posX",{get:function(){return xe},set:function(oe){isNaN(oe)||(xe=oe)}});var Ne=0;Object.defineProperty(this,"posY",{get:function(){return Ne},set:function(oe){isNaN(oe)||(Ne=oe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(oe){var Oe;typeof oe=="number"?Oe=[oe,oe,oe,oe]:((Oe=new Array(4))[0]=oe[0],Oe[1]=oe.length>=2?oe[1]:Oe[0],Oe[2]=oe.length>=3?oe[2]:Oe[0],Oe[3]=oe.length>=4?oe[3]:Oe[1]),u.margin=Oe}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(oe){pe=oe}});var K=0;Object.defineProperty(this,"lastBreak",{get:function(){return K},set:function(oe){K=oe}});var ue=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ue},set:function(oe){ue=oe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(oe){oe instanceof h&&(u=oe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(oe){u.path=oe}});var fe=[];Object.defineProperty(this,"ctxStack",{get:function(){return fe},set:function(oe){fe=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var Oe;Oe=m(oe),this.ctx.fillStyle=Oe.style,this.ctx.isFillTransparent=Oe.a===0,this.ctx.fillOpacity=Oe.a,this.pdf.setFillColor(Oe.r,Oe.g,Oe.b,{a:Oe.a}),this.pdf.setTextColor(Oe.r,Oe.g,Oe.b,{a:Oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var Oe=m(oe);this.ctx.strokeStyle=Oe.style,this.ctx.isStrokeTransparent=Oe.a===0,this.ctx.strokeOpacity=Oe.a,Oe.a===0?this.pdf.setDrawColor(255,255,255):(Oe.a,this.pdf.setDrawColor(Oe.r,Oe.g,Oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var he=null,le=null,_e=null;Object.defineProperty(this,"fontFaces",{get:function(){return _e},set:function(oe){he=null,le=null,_e=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var Oe;if(this.ctx.font=oe,(Oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(oe))!==null){var ze=Oe[1];Oe[2];var Ye=Oe[3],je=Oe[4];Oe[5];var Fe=Oe[6],Nt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(Nt==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:Nt==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var $t=(function(Dt){var at,ft,Bt=[],De=Dt.trim();if(De==="")return RA;if(De in dH)return[dH[De]];for(;De!=="";){switch(ft=null,at=(De=fH(De)).charAt(0)){case'"':case"'":ft=wBe(De.substring(1),at);break;default:ft=NBe(De)}if(ft===null||(Bt.push(ft[0]),(De=fH(ft[1]))!==""&&De.charAt(0)!==","))return RA;De=De.replace(/^,/,"")}return Bt})(Fe);if(this.fontFaces){var Ut=(function(Dt,at){var ft=Dt.getFontList(),Bt=JSON.stringify(ft);if(he===null||le!==Bt){var De=(function(lt){var ht=[];return Object.keys(lt).forEach(function(Pt){lt[Pt].forEach(function(At){var mt=null;switch(At){case"bold":mt={family:Pt,weight:"bold"};break;case"italic":mt={family:Pt,style:"italic"};break;case"bolditalic":mt={family:Pt,weight:"bold",style:"italic"};break;case"":case"normal":mt={family:Pt}}mt!==null&&(mt.ref={name:Pt,style:At},ht.push(mt))})}),ht})(ft);he=(function(lt){for(var ht={},Pt=0;Pt<lt.length;++Pt){var At=MA(lt[Pt]),mt=At.family,Ft=At.stretch,gt=At.style,Ot=At.weight;ht[mt]=ht[mt]||{},ht[mt][Ft]=ht[mt][Ft]||{},ht[mt][Ft][gt]=ht[mt][Ft][gt]||{},ht[mt][Ft][gt][Ot]=At}return ht})(De.concat(at)),le=Bt}return he})(this.pdf,this.fontFaces),nt=$t.map(function(Dt){return{family:Dt,stretch:"normal",weight:Ye,style:ze}}),bt=(function(Dt,at,ft){for(var Bt=(ft=ft||{}).defaultFontFamily||"times",De=Object.assign({},vBe,ft.genericFontFamilies||{}),lt=null,ht=null,Pt=0;Pt<at.length;++Pt)if(De[(lt=MA(at[Pt])).family]&&(lt.family=De[lt.family]),Dt.hasOwnProperty(lt.family)){ht=Dt[lt.family];break}if(!(ht=ht||Dt[Bt]))throw new Error("Could not find a font-family for the rule '"+hH(lt)+"' and default family '"+Bt+"'.");if(ht=(function(At,mt){if(mt[At])return mt[At];var Ft=z8[At],gt=Ft<=z8.normal?-1:1,Ot=uH(mt,qae,Ft,gt);if(!Ot)throw new Error("Could not find a matching font-stretch value for "+At);return Ot})(lt.stretch,ht),ht=(function(At,mt){if(mt[At])return mt[At];for(var Ft=Vae[At],gt=0;gt<Ft.length;++gt)if(mt[Ft[gt]])return mt[Ft[gt]];throw new Error("Could not find a matching font-style for "+At)})(lt.style,ht),!(ht=(function(At,mt){if(mt[At])return mt[At];if(At===400&&mt[500])return mt[500];if(At===500&&mt[400])return mt[400];var Ft=bBe[At],gt=uH(mt,Hae,Ft,At<400?-1:1);if(!gt)throw new Error("Could not find a matching font-weight for value "+At);return gt})(lt.weight,ht)))throw new Error("Failed to resolve a font for the rule '"+hH(lt)+"'.");return ht})(Ut,nt);this.pdf.setFont(bt.ref.name,bt.ref.style)}else{var It="";(Ye==="bold"||parseInt(Ye,10)>=700||ze==="bold")&&(It="bold"),ze==="italic"&&(It+="italic"),It.length===0&&(It="normal");for(var _t="",wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ut=0;ut<$t.length;ut++){if(this.pdf.internal.getFont($t[ut],It,{noFallback:!0,disableWarning:!0})!==void 0){_t=$t[ut];break}if(It==="bolditalic"&&this.pdf.internal.getFont($t[ut],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_t=$t[ut],It="bold";else if(this.pdf.internal.getFont($t[ut],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_t=$t[ut],It="normal";break}}if(_t===""){for(var Rt=0;Rt<$t.length;Rt++)if(wt[$t[Rt]]){_t=wt[$t[Rt]];break}}_t=_t===""?"Times":_t,this.pdf.setFont(_t,It)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};f.prototype.setLineDash=function(U){this.lineDash=U},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){I.call(this,"fill",!1)},f.prototype.stroke=function(){I.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(U,H){if(isNaN(U)||isNaN(H))throw qs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var re=this.ctx.transform.applyToPoint(new o(U,H));this.path.push({type:"mt",x:re.x,y:re.y}),this.ctx.lastPoint=new o(U,H)},f.prototype.closePath=function(){var U=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&Ns(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){U=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(U.x,U.y)},f.prototype.lineTo=function(U,H){if(isNaN(U)||isNaN(H))throw qs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var re=this.ctx.transform.applyToPoint(new o(U,H));this.path.push({type:"lt",x:re.x,y:re.y}),this.ctx.lastPoint=new o(re.x,re.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),I.call(this,null,!0)},f.prototype.quadraticCurveTo=function(U,H,re,ae){if(isNaN(re)||isNaN(ae)||isNaN(U)||isNaN(H))throw qs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var xe=this.ctx.transform.applyToPoint(new o(re,ae)),Ne=this.ctx.transform.applyToPoint(new o(U,H));this.path.push({type:"qct",x1:Ne.x,y1:Ne.y,x:xe.x,y:xe.y}),this.ctx.lastPoint=new o(xe.x,xe.y)},f.prototype.bezierCurveTo=function(U,H,re,ae,xe,Ne){if(isNaN(xe)||isNaN(Ne)||isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae))throw qs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new o(xe,Ne)),K=this.ctx.transform.applyToPoint(new o(U,H)),ue=this.ctx.transform.applyToPoint(new o(re,ae));this.path.push({type:"bct",x1:K.x,y1:K.y,x2:ue.x,y2:ue.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new o(pe.x,pe.y)},f.prototype.arc=function(U,H,re,ae,xe,Ne){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae)||isNaN(xe))throw qs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ne=!!Ne,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new o(U,H));U=pe.x,H=pe.y;var K=this.ctx.transform.applyToPoint(new o(0,re)),ue=this.ctx.transform.applyToPoint(new o(0,0));re=Math.sqrt(Math.pow(K.x-ue.x,2)+Math.pow(K.y-ue.y,2))}Math.abs(xe-ae)>=2*Math.PI&&(ae=0,xe=2*Math.PI),this.path.push({type:"arc",x:U,y:H,radius:re,startAngle:ae,endAngle:xe,counterclockwise:Ne})},f.prototype.arcTo=function(U,H,re,ae,xe){throw new Error("arcTo not implemented.")},f.prototype.rect=function(U,H,re,ae){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae))throw qs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(U,H),this.lineTo(U+re,H),this.lineTo(U+re,H+ae),this.lineTo(U,H+ae),this.lineTo(U,H),this.lineTo(U+re,H),this.lineTo(U,H)},f.prototype.fillRect=function(U,H,re,ae){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae))throw qs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var xe={};this.lineCap!=="butt"&&(xe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(xe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(U,H,re,ae),this.fill(),xe.hasOwnProperty("lineCap")&&(this.lineCap=xe.lineCap),xe.hasOwnProperty("lineJoin")&&(this.lineJoin=xe.lineJoin)}},f.prototype.strokeRect=function(U,H,re,ae){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae))throw qs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(U,H,re,ae),this.stroke())},f.prototype.clearRect=function(U,H,re,ae){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae))throw qs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(U,H,re,ae))},f.prototype.save=function(U){U=typeof U!="boolean"||U;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,re=0;re<this.pdf.internal.getNumberOfPages();re++)this.pdf.setPage(re+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),U){this.ctx.fontSize=this.pdf.internal.getFontSize();var ae=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ae}},f.prototype.restore=function(U){U=typeof U!="boolean"||U;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,re=0;re<this.pdf.internal.getNumberOfPages();re++)this.pdf.setPage(re+1),this.pdf.internal.out("Q");this.pdf.setPage(H),U&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(U){var H,re,ae,xe;if(U.isCanvasGradient===!0&&(U=U.getColor()),!U)return{r:0,g:0,b:0,a:0,style:U};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(U))H=0,re=0,ae=0,xe=0;else{var Ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(U);if(Ne!==null)H=parseInt(Ne[1]),re=parseInt(Ne[2]),ae=parseInt(Ne[3]),xe=1;else if((Ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(U))!==null)H=parseInt(Ne[1]),re=parseInt(Ne[2]),ae=parseInt(Ne[3]),xe=parseFloat(Ne[4]);else{if(xe=1,typeof U=="string"&&U.charAt(0)!=="#"){var pe=new Rae(U);U=pe.ok?pe.toHex():"#000000"}U.length===4?(H=U.substring(1,2),H+=H,re=U.substring(2,3),re+=re,ae=U.substring(3,4),ae+=ae):(H=U.substring(1,3),re=U.substring(3,5),ae=U.substring(5,7)),H=parseInt(H,16),re=parseInt(re,16),ae=parseInt(ae,16)}}return{r:H,g:re,b:ae,a:xe,style:U}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(U,H,re,ae){if(isNaN(H)||isNaN(re)||typeof U!="string")throw qs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ae=isNaN(ae)?void 0:ae,!g.call(this)){var xe=Z(this.ctx.transform.rotation),Ne=this.ctx.transform.scaleX;P.call(this,{text:U,x:H,y:re,scale:Ne,angle:xe,align:this.textAlign,maxWidth:ae})}},f.prototype.strokeText=function(U,H,re,ae){if(isNaN(H)||isNaN(re)||typeof U!="string")throw qs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){ae=isNaN(ae)?void 0:ae;var xe=Z(this.ctx.transform.rotation),Ne=this.ctx.transform.scaleX;P.call(this,{text:U,x:H,y:re,scale:Ne,renderingMode:"stroke",angle:xe,align:this.textAlign,maxWidth:ae})}},f.prototype.measureText=function(U){if(typeof U!="string")throw qs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,re=this.pdf.internal.scaleFactor,ae=H.internal.getFontSize(),xe=H.getStringUnitWidth(U)*ae/H.internal.scaleFactor;return new function(Ne){var pe=(Ne=Ne||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:xe*=Math.round(96*re/72*1e4)/1e4})},f.prototype.scale=function(U,H){if(isNaN(U)||isNaN(H))throw qs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var re=new c(U,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(re)},f.prototype.rotate=function(U){if(isNaN(U))throw qs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(U),Math.sin(U),-Math.sin(U),Math.cos(U),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.translate=function(U,H){if(isNaN(U)||isNaN(H))throw qs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var re=new c(1,0,0,1,U,H);this.ctx.transform=this.ctx.transform.multiply(re)},f.prototype.transform=function(U,H,re,ae,xe,Ne){if(isNaN(U)||isNaN(H)||isNaN(re)||isNaN(ae)||isNaN(xe)||isNaN(Ne))throw qs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new c(U,H,re,ae,xe,Ne);this.ctx.transform=this.ctx.transform.multiply(pe)},f.prototype.setTransform=function(U,H,re,ae,xe,Ne){U=isNaN(U)?1:U,H=isNaN(H)?0:H,re=isNaN(re)?0:re,ae=isNaN(ae)?1:ae,xe=isNaN(xe)?0:xe,Ne=isNaN(Ne)?0:Ne,this.ctx.transform=new c(U,H,re,ae,xe,Ne)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(U,H,re,ae,xe,Ne,pe,K,ue){var fe=this.pdf.getImageProperties(U),he=1,le=1,_e=1,oe=1;ae!==void 0&&K!==void 0&&(_e=K/ae,oe=ue/xe,he=fe.width/ae*K/ae,le=fe.height/xe*ue/xe),Ne===void 0&&(Ne=H,pe=re,H=0,re=0),ae!==void 0&&K===void 0&&(K=ae,ue=xe),ae===void 0&&K===void 0&&(K=fe.width,ue=fe.height);var Oe=this.ctx.transform.decompose(),ze=Z(Oe.rotate.shx),Ye=new c,je=(Ye=(Ye=(Ye=Ye.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new l(Ne-H*_e,pe-re*oe,ae*he,xe*le));if(this.autoPaging){for(var Fe,Nt=w.call(this,je),$t=[],Ut=0;Ut<Nt.length;Ut+=1)$t.indexOf(Nt[Ut])===-1&&$t.push(Nt[Ut]);C($t);for(var nt=$t[0],bt=$t[$t.length-1],It=nt;It<bt+1;It++){this.pdf.setPage(It);var _t=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=It===1?this.posY+this.margin[0]:this.margin[0],ut=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Rt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Dt=It===1?0:ut+(It-2)*Rt;if(this.ctx.clip_path.length!==0){var at=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Fe,this.posX+this.margin[3],-Dt+wt+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=at}var ft=JSON.parse(JSON.stringify(je));ft=k([ft],this.posX+this.margin[3],-Dt+wt+this.ctx.prevPageLastElemOffset)[0];var Bt=(It>nt||It<bt)&&v.call(this);Bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,Rt,null).clip().discardPath()),this.pdf.addImage(U,"JPEG",ft.x,ft.y,ft.w,ft.h,null,null,ze),Bt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(U,"JPEG",je.x,je.y,je.w,je.h,null,null,ze)};var w=function(U,H,re){var ae=[];H=H||this.pdf.internal.pageSize.width,re=re||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var xe=this.posY+this.ctx.prevPageLastElemOffset;switch(U.type){default:case"mt":case"lt":ae.push(Math.floor((U.y+xe)/re)+1);break;case"arc":ae.push(Math.floor((U.y+xe-U.radius)/re)+1),ae.push(Math.floor((U.y+xe+U.radius)/re)+1);break;case"qct":var Ne=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x,U.y);ae.push(Math.floor((Ne.y+xe)/re)+1),ae.push(Math.floor((Ne.y+Ne.h+xe)/re)+1);break;case"bct":var pe=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x2,U.y2,U.x,U.y);ae.push(Math.floor((pe.y+xe)/re)+1),ae.push(Math.floor((pe.y+pe.h+xe)/re)+1);break;case"rect":ae.push(Math.floor((U.y+xe)/re)+1),ae.push(Math.floor((U.y+U.h+xe)/re)+1)}for(var K=0;K<ae.length;K+=1)for(;this.pdf.internal.getNumberOfPages()<ae[K];)N.call(this);return ae},N=function(){var U=this.fillStyle,H=this.strokeStyle,re=this.font,ae=this.lineCap,xe=this.lineWidth,Ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=U,this.strokeStyle=H,this.font=re,this.lineCap=ae,this.lineWidth=xe,this.lineJoin=Ne},k=function(U,H,re){for(var ae=0;ae<U.length;ae++)switch(U[ae].type){case"bct":U[ae].x2+=H,U[ae].y2+=re;case"qct":U[ae].x1+=H,U[ae].y1+=re;default:U[ae].x+=H,U[ae].y+=re}return U},C=function(U){return U.sort(function(H,re){return H-re})},I=function(U,H){var re=this.fillStyle,ae=this.strokeStyle,xe=this.lineCap,Ne=this.lineWidth,pe=Math.abs(Ne*this.ctx.transform.scaleX),K=this.lineJoin;if(this.autoPaging){for(var ue,fe,he=JSON.parse(JSON.stringify(this.path)),le=JSON.parse(JSON.stringify(this.path)),_e=[],oe=0;oe<le.length;oe++)if(le[oe].x!==void 0)for(var Oe=w.call(this,le[oe]),ze=0;ze<Oe.length;ze+=1)_e.indexOf(Oe[ze])===-1&&_e.push(Oe[ze]);for(var Ye=0;Ye<_e.length;Ye++)for(;this.pdf.internal.getNumberOfPages()<_e[Ye];)N.call(this);C(_e);for(var je=_e[0],Fe=_e[_e.length-1],Nt=je;Nt<Fe+1;Nt++){this.pdf.setPage(Nt),this.fillStyle=re,this.strokeStyle=ae,this.lineCap=xe,this.lineWidth=pe,this.lineJoin=K;var $t=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ut=Nt===1?this.posY+this.margin[0]:this.margin[0],nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],It=Nt===1?0:nt+(Nt-2)*bt;if(this.ctx.clip_path.length!==0){var _t=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(ue,this.posX+this.margin[3],-It+Ut+this.ctx.prevPageLastElemOffset),O.call(this,U,!0),this.path=_t}if(fe=JSON.parse(JSON.stringify(he)),this.path=k(fe,this.posX+this.margin[3],-It+Ut+this.ctx.prevPageLastElemOffset),H===!1||Nt===0){var wt=(Nt>je||Nt<Fe)&&v.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$t,bt,null).clip().discardPath()),O.call(this,U,H),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=Ne}this.path=he}else this.lineWidth=pe,O.call(this,U,H),this.lineWidth=Ne},O=function(U,H){if((U!=="stroke"||H||!y.call(this))&&(U==="stroke"||H||!g.call(this))){for(var re,ae,xe=[],Ne=this.path,pe=0;pe<Ne.length;pe++){var K=Ne[pe];switch(K.type){case"begin":xe.push({begin:!0});break;case"close":xe.push({close:!0});break;case"mt":xe.push({start:K,deltas:[],abs:[]});break;case"lt":var ue=xe.length;if(Ne[pe-1]&&!isNaN(Ne[pe-1].x)&&(re=[K.x-Ne[pe-1].x,K.y-Ne[pe-1].y],ue>0)){for(;ue>=0;ue--)if(xe[ue-1].close!==!0&&xe[ue-1].begin!==!0){xe[ue-1].deltas.push(re),xe[ue-1].abs.push(K);break}}break;case"bct":re=[K.x1-Ne[pe-1].x,K.y1-Ne[pe-1].y,K.x2-Ne[pe-1].x,K.y2-Ne[pe-1].y,K.x-Ne[pe-1].x,K.y-Ne[pe-1].y],xe[xe.length-1].deltas.push(re);break;case"qct":var fe=Ne[pe-1].x+2/3*(K.x1-Ne[pe-1].x),he=Ne[pe-1].y+2/3*(K.y1-Ne[pe-1].y),le=K.x+2/3*(K.x1-K.x),_e=K.y+2/3*(K.y1-K.y),oe=K.x,Oe=K.y;re=[fe-Ne[pe-1].x,he-Ne[pe-1].y,le-Ne[pe-1].x,_e-Ne[pe-1].y,oe-Ne[pe-1].x,Oe-Ne[pe-1].y],xe[xe.length-1].deltas.push(re);break;case"arc":xe.push({deltas:[],abs:[],arc:!0}),Array.isArray(xe[xe.length-1].abs)&&xe[xe.length-1].abs.push(K)}}ae=H?null:U==="stroke"?"stroke":"fill";for(var ze=!1,Ye=0;Ye<xe.length;Ye++)if(xe[Ye].arc)for(var je=xe[Ye].abs,Fe=0;Fe<je.length;Fe++){var Nt=je[Fe];Nt.type==="arc"?E.call(this,Nt.x,Nt.y,Nt.radius,Nt.startAngle,Nt.endAngle,Nt.counterclockwise,void 0,H,!ze):R.call(this,Nt.x,Nt.y),ze=!0}else if(xe[Ye].close===!0)this.pdf.internal.out("h"),ze=!1;else if(xe[Ye].begin!==!0){var $t=xe[Ye].start.x,Ut=xe[Ye].start.y;V.call(this,xe[Ye].deltas,$t,Ut),ze=!0}ae&&M.call(this,ae),H&&B.call(this)}},L=function(U){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,re=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return U-re;case"top":return U+H-re;case"hanging":return U+H-2*re;case"middle":return U+H/2-re;default:return U}},_=function(U){return U+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var U=function(){};return U.colorStops=[],U.addColorStop=function(H,re){this.colorStops.push([H,re])},U.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},U.isCanvasGradient=!0,U},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(U,H,re,ae,xe,Ne,pe,K,ue){for(var fe=G.call(this,re,ae,xe,Ne),he=0;he<fe.length;he++){var le=fe[he];he===0&&(ue?S.call(this,le.x1+U,le.y1+H):R.call(this,le.x1+U,le.y1+H)),ee.call(this,U,H,le.x2,le.y2,le.x3,le.y3,le.x4,le.y4)}K?B.call(this):M.call(this,pe)},M=function(U){switch(U){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(U,H){this.pdf.internal.out(r(U)+" "+n(H)+" m")},P=function(U){var H;switch(U.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var re,ae,xe,Ne=this.pdf.getTextDimensions(U.text),pe=L.call(this,U.y),K=_.call(this,pe)-Ne.h,ue=this.ctx.transform.applyToPoint(new o(U.x,pe));if(this.autoPaging){var fe=this.ctx.transform.decompose(),he=new c;he=(he=(he=he.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var le=this.ctx.transform.applyToRectangle(new l(U.x,pe,Ne.w,Ne.h)),_e=he.applyToRectangle(new l(U.x,K,Ne.w,Ne.h)),oe=w.call(this,_e),Oe=[],ze=0;ze<oe.length;ze+=1)Oe.indexOf(oe[ze])===-1&&Oe.push(oe[ze]);C(Oe);for(var Ye=Oe[0],je=Oe[Oe.length-1],Fe=Ye;Fe<je+1;Fe++){this.pdf.setPage(Fe);var Nt=Fe===1?this.posY+this.margin[0]:this.margin[0],$t=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ut=this.pdf.internal.pageSize.height-this.margin[2],nt=Ut-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],It=bt-this.margin[3],_t=Fe===1?0:$t+(Fe-2)*nt;if(this.ctx.clip_path.length!==0){var wt=this.path;re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(re,this.posX+this.margin[3],-1*_t+Nt),O.call(this,"fill",!0),this.path=wt}var ut=k([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-_t+Nt+this.ctx.prevPageLastElemOffset)[0];U.scale>=.01&&(ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ae*U.scale),xe=this.lineWidth,this.lineWidth=xe*U.scale);var Rt=this.autoPaging!=="text";if(Rt||ut.y+ut.h<=Ut){if(Rt||ut.y>=Nt&&ut.x<=bt){var Dt=Rt?U.text:this.pdf.splitTextToSize(U.text,U.maxWidth||bt-ut.x)[0],at=k([JSON.parse(JSON.stringify(le))],this.posX+this.margin[3],-_t+Nt+this.ctx.prevPageLastElemOffset)[0],ft=Rt&&(Fe>Ye||Fe<je)&&v.call(this);ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,nt,null).clip().discardPath()),this.pdf.text(Dt,at.x,at.y,{angle:U.angle,align:H,renderingMode:U.renderingMode}),ft&&this.pdf.restoreGraphicsState()}}else ut.y<Ut&&(this.ctx.prevPageLastElemOffset+=Ut-ut.y);U.scale>=.01&&(this.pdf.setFontSize(ae),this.lineWidth=xe)}}else U.scale>=.01&&(ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ae*U.scale),xe=this.lineWidth,this.lineWidth=xe*U.scale),this.pdf.text(U.text,ue.x+this.posX,ue.y+this.posY,{angle:U.angle,align:H,renderingMode:U.renderingMode,maxWidth:U.maxWidth}),U.scale>=.01&&(this.pdf.setFontSize(ae),this.lineWidth=xe)},R=function(U,H,re,ae){re=re||0,ae=ae||0,this.pdf.internal.out(r(U+re)+" "+n(H+ae)+" l")},V=function(U,H,re){return this.pdf.lines(U,H,re,null,null)},ee=function(U,H,re,ae,xe,Ne,pe,K){this.pdf.internal.out([e(s(re+U)),e(a(ae+H)),e(s(xe+U)),e(a(Ne+H)),e(s(pe+U)),e(a(K+H)),"c"].join(" "))},G=function(U,H,re,ae){for(var xe=2*Math.PI,Ne=Math.PI/2;H>re;)H-=xe;var pe=Math.abs(re-H);pe<xe&&ae&&(pe=xe-pe);for(var K=[],ue=ae?-1:1,fe=H;pe>1e-5;){var he=fe+ue*Math.min(pe,Ne);K.push(J.call(this,U,fe,he)),pe-=Math.abs(he-fe),fe=he}return K},J=function(U,H,re){var ae=(re-H)/2,xe=U*Math.cos(ae),Ne=U*Math.sin(ae),pe=xe,K=-Ne,ue=pe*pe+K*K,fe=ue+pe*xe+K*Ne,he=4/3*(Math.sqrt(2*ue*fe)-fe)/(pe*Ne-K*xe),le=pe-he*K,_e=K+he*pe,oe=le,Oe=-_e,ze=ae+H,Ye=Math.cos(ze),je=Math.sin(ze);return{x1:U*Math.cos(H),y1:U*Math.sin(H),x2:le*Ye-_e*je,y2:le*je+_e*Ye,x3:oe*Ye-Oe*je,y3:oe*je+Oe*Ye,x4:U*Math.cos(re),y4:U*Math.sin(re)}},Z=function(U){return 180*U/Math.PI},se=function(U,H,re,ae,xe,Ne){var pe=U+.5*(re-U),K=H+.5*(ae-H),ue=xe+.5*(re-xe),fe=Ne+.5*(ae-Ne),he=Math.min(U,xe,pe,ue),le=Math.max(U,xe,pe,ue),_e=Math.min(H,Ne,K,fe),oe=Math.max(H,Ne,K,fe);return new l(he,_e,le-he,oe-_e)},X=function(U,H,re,ae,xe,Ne,pe,K){var ue,fe,he,le,_e,oe,Oe,ze,Ye,je,Fe,Nt,$t,Ut,nt=re-U,bt=ae-H,It=xe-re,_t=Ne-ae,wt=pe-xe,ut=K-Ne;for(fe=0;fe<41;fe++)Ye=(Oe=(he=U+(ue=fe/40)*nt)+ue*((_e=re+ue*It)-he))+ue*(_e+ue*(xe+ue*wt-_e)-Oe),je=(ze=(le=H+ue*bt)+ue*((oe=ae+ue*_t)-le))+ue*(oe+ue*(Ne+ue*ut-oe)-ze),fe==0?(Fe=Ye,Nt=je,$t=Ye,Ut=je):(Fe=Math.min(Fe,Ye),Nt=Math.min(Nt,je),$t=Math.max($t,Ye),Ut=Math.max(Ut,je));return new l(Math.round(Fe),Math.round(Nt),Math.round($t-Fe),Math.round(Ut-Nt))},q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var U,H,re=(U=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:U,lineDashOffset:H}));this.prevLineDash!==re&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=re)}}})(Pr.API),(function(t){var e=function(o){var l,c,u,h,f,m,g,y,v,w;for(c=[],u=0,h=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;h>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(m=(f=((f=((f=((f=(f-(w=f%85))/85)-(v=f%85))/85)-(y=f%85))/85)-(g=f%85))/85)%85,c.push(m+33,g+33,y+33,v+33,w+33)):c.push(122);return(function(N,k){for(var C=k;C>0;C--)N.pop()})(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,h,f,m=String,g="length",y=255,v="charCodeAt",w="slice",N="replace";for(o[w](-2),o=o[w](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),u=[],h=0,f=(o+=l="uuuuu"[w](o[g]%5||5))[g];f>h;h+=5)c=52200625*(o[v](h)-33)+614125*(o[v](h+1)-33)+7225*(o[v](h+2)-33)+85*(o[v](h+3)-33)+(o[v](h+4)-33),u.push(y&c>>24,y&c>>16,y&c>>8,y&c);return(function(k,C){for(var I=C;I>0;I--)k.pop()})(u,l[g]),m.fromCharCode.apply(m,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=M8(l)).reduce(function(u,h){return u+String.fromCharCode(h)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",h=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:h.reverse().join(" ")}}})(Pr.API),(function(t){t.loadFile=function(e,r,n){return(function(s,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(c,u,h){var f=new XMLHttpRequest,m=0,g=function(y){var v=y.length,w=[],N=String.fromCharCode;for(m=0;m<v;m+=1)w.push(N(255&y.charCodeAt(m)));return w.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?h(g(this.responseText)):h(void 0)}),f.send(null),u&&f.status===200)return g(f.responseText)})(s,a,o)}catch{}return l})(e,r,n)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Pr.API),(function(t){function e(){return(Jr.html2canvas?Promise.resolve(Jr.html2canvas):Rj(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Jr.DOMPurify?Promise.resolve(Jr.DOMPurify):Rj(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Ns(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var u=document.createElement(l);for(var h in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[h]=c.style[h];return u},a=function l(c,u){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||h.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),h=l.convert(Promise.resolve(),u);return(h=h.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||(function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),c){case"string":return this.then(r).then(function(u){return this.set({src:s("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,h=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=h,h)for(var g=0;g<h.length;++g){var y=h[g],v=y.src.find(function(w){return w.format==="truetype"});v&&u.addFont(v.url,y.ref.name,y.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,u.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,h){return Math.floor(u*h/72*96)}return this.then(function(){(l=l||Pr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,h){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,h){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,h?this.progress.stack.concat(h):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(h,f){return u.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(m){return u.updateProgress(null,h),m}).then(h,f).then(function(m){return u.updateProgress(1),m})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var h=this;l&&(l=l.bind(h)),c&&(c=c.bind(h));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:o.convert(Object.assign({},h),Promise.prototype),m=u.call(f,l,c);return o.convert(m,h.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Pr.getPageSize=function(l,c,u){if(Ns(l)==="object"){var h=l;l=h.orientation,c=h.unit||c,u=h.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,m=(""+u).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var y,v=0,w=0;if(g.hasOwnProperty(m))v=g[m][1]/f,w=g[m][0]/f;else try{v=u[1],w=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",w>v&&(y=w,w=v,v=y);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",v>w&&(y=w,w=v,v=y)}return{width:w,height:v,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(MA):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}})(Pr.API),Pr.API.addJS=function(t){return mH=t,this.internal.events.subscribe("postPutResources",function(){LN=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(LN+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),pH=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+mH+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){LN!==void 0&&pH!==void 0&&this.internal.out("/Names <</JavaScript "+LN+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var o=s[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(a=0;a<u;a++){var f=r.internal.newObject();h.push(f);var m=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<h.length;a++)r.internal.write("(page_"+(a+1)+")"+h[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var o={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])})(Pr.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,o,l){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(f){for(var m,g=256*f.charCodeAt(4)+f.charCodeAt(5),y=f.length,v={width:0,height:0,numcomponents:1},w=4;w<y;w+=2){if(w+=g,e.indexOf(f.charCodeAt(w+1))!==-1){m=256*f.charCodeAt(w+5)+f.charCodeAt(w+6),v={width:256*f.charCodeAt(w+7)+f.charCodeAt(w+8),height:m,numcomponents:f.charCodeAt(w+9)};break}g=256*f.charCodeAt(w+2)+f.charCodeAt(w+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return h}})(Pr.API),Pr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,a=iBe(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,u=a.palette,h=a.depth;s=u&&c===1?(function(E){for(var M=E.width,B=E.height,S=E.data,P=E.palette,R=E.depth,V=!1,ee=[],G=[],J=void 0,Z=!1,se=0,X=0;X<P.length;X++){var q=bq(P[X],4),U=q[0],H=q[1],re=q[2],ae=q[3];ee.push(U,H,re),ae!=null&&(ae===0?(se++,G.length<1&&G.push(X)):ae<255&&(Z=!0))}if(Z||se>1){V=!0,G=void 0;var xe=M*B;J=new Uint8Array(xe);for(var Ne=new DataView(S.buffer),pe=0;pe<xe;pe++){var K=DA(Ne,pe,R),ue=bq(P[K],4)[3];J[pe]=ue}}else se===0&&(G=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:V?8:void 0,colorBytes:S,alphaBytes:J,needSMask:V,palette:ee,mask:G}})(a):c===2||c===4?(function(E){for(var M=E.data,B=E.width,S=E.height,P=E.channels,R=E.depth,V=P===2?"DeviceGray":"DeviceRGB",ee=P-1,G=B*S,J=ee,Z=G*J,se=1*G,X=Math.ceil(Z*R/8),q=Math.ceil(se*R/8),U=new Uint8Array(X),H=new Uint8Array(q),re=new DataView(M.buffer),ae=new DataView(U.buffer),xe=new DataView(H.buffer),Ne=!1,pe=0;pe<G;pe++){for(var K=pe*P,ue=0;ue<J;ue++)kH(ae,DA(re,K+ue,R),pe*J+ue,R);var fe=DA(re,K+J,R);fe<(1<<R)-1&&(Ne=!0),kH(xe,fe,1*pe,R)}return{colorSpace:V,colorsPerPixel:ee,sMaskBitsPerComponent:Ne?R:void 0,colorBytes:U,alphaBytes:H,needSMask:Ne}})(a):(function(E){var M=E.data,B=E.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?(function(S){for(var P=S.length,R=new Uint8Array(2*P),V=new DataView(R.buffer,R.byteOffset,R.byteLength),ee=0;ee<P;ee++)V.setUint16(2*ee,S[ee],!1);return R})(M):M,needSMask:!1}})(a);var f,m,g,y=s,v=y.colorSpace,w=y.colorsPerPixel,N=y.sMaskBitsPerComponent,k=y.colorBytes,C=y.alphaBytes,I=y.needSMask,O=y.palette,L=y.mask,_=null;return n!==Pr.API.image_compression.NONE&&typeof M8=="function"?(_=(function(E){var M;switch(E){case Pr.API.image_compression.FAST:M=11;break;case Pr.API.image_compression.MEDIUM:M=13;break;case Pr.API.image_compression.SLOW:M=14;break;default:M=12}return M})(n),f=this.decode.FLATE_DECODE,m="/Predictor ".concat(_," /Colors ").concat(w," /BitsPerComponent ").concat(h," /Columns ").concat(o),t=bH(k,Math.ceil(o*w*h/8),w,h,n),I&&(g=bH(C,Math.ceil(o*N/8),1,N,n))):(f=void 0,m=void 0,t=k,I&&(g=C)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:f,decodeParameters:m,transparency:L,palette:O,sMask:g,predictor:_,width:o,height:l,bitsPerComponent:h,sMaskBitsPerComponent:N,colorSpace:v}}},(function(t){t.processGIF89A=function(e,r,n,s){var a=new SBe(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},h=new BA(100).encode(u,100);return t.processJPEG.call(this,h,r,n,s)},t.processGIF87A=t.processGIF89A})(Pr.API),Vu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Vu.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){qs.log("bit decode error:"+r)}},Vu.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Vu.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=a>>4,c=15&a,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Vu.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Vu.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,u=a>>15?255:0,h=n*this.width*4+4*s;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=u}this.pos+=t}},Vu.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,h=s*this.width*4+4*a;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},Vu.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Vu.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Vu.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,s){var a=new Vu(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new BA(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}})(Pr.API),SH.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,s){var a=new SH(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new BA(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}})(Pr.API),Pr.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var h=n[u],f=n[u+1],m=n[u+2],g=n[u+3];a[l++]=h,a[l++]=f,a[l++]=m,o[c++]=g}var y=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:y,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Pr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Cx=Pr.API,ON=Cx.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:s.metadata.Unicode.kerning,h=u.fof?u.fof:1,f=e.doKerning!==!1,m=0,g=t.length,y=0,v=l[0]||c,w=[];for(r=0;r<g;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?w.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(m=f&&Ns(u[n])==="object"&&!isNaN(parseInt(u[n][y],10))?u[n][y]/h:0,w.push((l[n]||v)/c+m)),y=n;return w},gH=Cx.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Cx.processArabic&&(t=Cx.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:ON.apply(this,arguments).reduce(function(a,o){return a+o},0)},xH=function(t,e,r,n){for(var s=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},yH=function(t,e,r){r||(r={});var n,s,a,o,l,c,u,h=[],f=[h],m=r.textIndent||0,g=0,y=0,v=t.split(" "),w=ON.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var N=Array(c).join(" "),k=[];v.map(function(I){(I=I.split(/\s*\n/)).length>1?k=k.concat(I.map(function(O,L){return(L&&O.length?`
`:"")+O})):k.push(I[0])}),v=k,c=gH.apply(this,[N,r])}for(a=0,o=v.length;a<o;a++){var C=0;if(n=v[a],c&&n[0]==`
`&&(n=n.substr(1),C=1),m+g+(y=(s=ON.apply(this,[n,r])).reduce(function(I,O){return I+O},0))>e||C){if(y>e){for(l=xH.apply(this,[n,s,e-(m+g),e]),h.push(l.shift()),h=[l.pop()];l.length;)f.push([l.shift()]);y=s.slice(n.length-(h[0]?h[0].length:0)).reduce(function(I,O){return I+O},0)}else h=[n];f.push(h),m=y+c,g=w}else h.push(n),m+=g+y,g=w}return u=c?function(I,O){return(O?N:"")+I.join(" ")}:function(I){return I.join(" ")},f.map(u)},Cx.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var f=this.internal.getFont(h.fontName,h.fontStyle),m="Unicode";return f.metadata[m]?{widths:f.metadata[m].widths||{0:1},kerning:f.metadata[m].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(yH.apply(this,[n[l],o,a]));return u},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=e[a],s[e[a]]=r[a];var o=function(m){return"0x"+parseInt(m,10).toString(16)},l=t.__fontmetrics__.compress=function(m){var g,y,v,w,N=["{"];for(var k in m){if(g=m[k],isNaN(parseInt(k,10))?y="'"+k+"'":(k=parseInt(k,10),y=(y=o(k).slice(2)).slice(0,-1)+s[y.slice(-1)]),typeof g=="number")g<0?(v=o(g).slice(3),w="-"):(v=o(g).slice(2),w=""),v=w+v.slice(0,-1)+s[v.slice(-1)];else{if(Ns(g)!=="object")throw new Error("Don't know what to do with value type "+Ns(g)+".");v=l(g)}N.push(y+v)}return N.push("}"),N.join("")},c=t.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,y,v,w,N={},k=1,C=N,I=[],O="",L="",_=m.length-1,E=1;E<_;E+=1)(w=m[E])=="'"?g?(v=g.join(""),g=void 0):g=[]:g?g.push(w):w=="{"?(I.push([C,v]),C={},v=void 0):w=="}"?((y=I.pop())[0][y[1]]=C,v=void 0,C=y[0]):w=="-"?k=-1:v===void 0?n.hasOwnProperty(w)?(O+=n[w],v=parseInt(O,16)*k,k=1,O=""):O+=w:n.hasOwnProperty(w)?(L+=n[w],C[v]=parseInt(L,16)*k,k=1,v=void 0,L=""):L+=w;return N},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(m){var g=m.font,y=f.Unicode[g.postScriptName];y&&(g.metadata.Unicode={},g.metadata.Unicode.widths=y.widths,g.metadata.Unicode.kerning=y.kerning);var v=h.Unicode[g.postScriptName];v&&(g.metadata.Unicode.encoding=v,g.encoding=v.codePages[0])}])})(Pr.API),(function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Bj(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])})(Pr),Pr.API.addSvgAsImage=function(t,e,r,n,s,a,o,l){if(isNaN(e)||isNaN(r))throw qs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw qs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Jr.canvg?Promise.resolve(Jr.canvg):Rj(()=>import("./index.es-Co2vgg1_.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,s,o,l)})},Pr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},Pr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,h=0,f=0;function m(y,v){var w,N=!1;for(w=0;w<y.length;w+=1)y[w]===v&&(N=!0);return N}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=l.length;for(f=0;f<g;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Ns(t)==="object"){for(s in t)if(a=t[s],m(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&m(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")c.push(String(a[u]-1));else if(a[u].length>1){for(h=0;h<a[u].length;h+=1)typeof a[u][h]!="number"&&(n=!1);n===!0&&c.push([a[u][0]-1,a[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,v=[];for(y in r)r[y].explicitSet===!0&&(r[y].type==="name"?v.push("/"+y+" /"+r[y].value):v.push("/"+y+" "+r[y].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(Pr.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],f=0,m=a.length;f<m;++f){if(l=o.metadata.characterToGlyph(a.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(u[4-l.length],l)}return h.join("")},n=function(a){var o,l,c,u,h,f,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(l=Object.keys(a).sort(function(g,y){return g-y})).length;f<m;f++)o=l[f],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(u=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,h=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),g="",y=0;y<m.length;y++)g+=String.fromCharCode(m[y]);var v=u();h({data:g,addLength1:!0,objectId:v}),c("endobj");var w=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var N=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Hx(l.fontName)),c("/FontFile2 "+v+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var k=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Hx(l.fontName)),c("/FontDescriptor "+N+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+Hx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+k+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,h=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,m="",g=0;g<f.length;g++)m+=String.fromCharCode(f[g]);var y=u();h({data:m,addLength1:!0,objectId:y}),c("endobj");var v=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var w=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Hx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var N=0;N<l.metadata.hmtx.widths.length;N++)l.metadata.hmtx.widths[N]=parseInt(l.metadata.hmtx.widths[N]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Hx(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var o,l=a.text||"",c=a.x,u=a.y,h=a.options||{},f=a.mutex||{},m=f.pdfEscape,g=f.activeFontKey,y=f.fonts,v=g,w="",N=0,k="",C=y[v].encoding;if(y[v].encoding!=="Identity-H")return{text:l,x:c,y:u,options:h,mutex:f};for(k=l,v=g,Array.isArray(l)&&(k=l[0]),N=0;N<k.length;N+=1)y[v].metadata.hasOwnProperty("cmap")&&(o=y[v].metadata.cmap.unicode.codeMap[k[N].charCodeAt(0)]),o||k[N].charCodeAt(0)<256&&y[v].metadata.hasOwnProperty("Unicode")?w+=k[N]:w+="";var I="";return parseInt(v.slice(1))<14||C==="WinAnsiEncoding"?I=m(w,v).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):C==="Identity-H"&&(I=r(w,y[v])),f.isHex=!0,{text:I,x:c,y:u,options:h,mutex:f}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([s(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(s(Object.assign({},c,{text:o[u]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:o})).text}])})(Pr),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(Pr.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,o,l,c,u,h,f=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],N=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,C=0;this.__bidiEngine__={};var I=function(S){var P=S.charCodeAt(),R=P>>8,V=v[R];return V!==void 0?f[256*V+(255&P)]:R===252||R===253?"AL":N.test(R)?"L":R===8?"R":"N"},O=function(S){for(var P,R=0;R<S.length;R++){if((P=I(S.charAt(R)))==="L")return!1;if(P==="R")return!0}return!1},L=function(S,P,R,V){var ee,G,J,Z,se=P[V];switch(se){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(se="AN");break;case"AL":k=!0,se="R";break;case"WS":case"BN":se="N";break;case"CS":V<1||V+1>=P.length||(ee=R[V-1])!=="EN"&&ee!=="AN"||(G=P[V+1])!=="EN"&&G!=="AN"?se="N":k&&(G="AN"),se=G===ee?G:"N";break;case"ES":se=(ee=V>0?R[V-1]:"B")==="EN"&&V+1<P.length&&P[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&R[V-1]==="EN"){se="EN";break}if(k){se="N";break}for(J=V+1,Z=P.length;J<Z&&P[J]==="ET";)J++;se=J<Z&&P[J]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Z=P.length,J=V+1;J<Z&&P[J]==="NSM";)J++;if(J<Z){var X=S[V],q=X>=1425&&X<=2303||X===64286;if(ee=P[J],q&&(ee==="R"||ee==="AL")){se="R";break}}}se=V<1||(ee=P[V-1])==="B"?"N":R[V-1];break;case"B":k=!1,s=!0,se=C;break;case"S":a=!0,se="N"}return se},_=function(S,P,R){var V=S.split("");return R&&E(V,R,{hiLevel:C}),V.reverse(),P&&P.reverse(),V.join("")},E=function(S,P,R){var V,ee,G,J,Z,se=-1,X=S.length,q=0,U=[],H=C?g:m,re=[];for(k=!1,s=!1,a=!1,ee=0;ee<X;ee++)re[ee]=I(S[ee]);for(G=0;G<X;G++){if(Z=q,U[G]=L(S,re,U,G),V=240&(q=H[Z][y[U[G]]]),q&=15,P[G]=J=H[q][5],V>0)if(V===16){for(ee=se;ee<G;ee++)P[ee]=1;se=-1}else se=-1;if(H[q][6])se===-1&&(se=G);else if(se>-1){for(ee=se;ee<G;ee++)P[ee]=J;se=-1}re[G]==="B"&&(P[G]=0),R.hiLevel|=J}a&&(function(ae,xe,Ne){for(var pe=0;pe<Ne;pe++)if(ae[pe]==="S"){xe[pe]=C;for(var K=pe-1;K>=0&&ae[K]==="WS";K--)xe[K]=C}})(re,P,X)},M=function(S,P,R,V,ee){if(!(ee.hiLevel<S)){if(S===1&&C===1&&!s)return P.reverse(),void(R&&R.reverse());for(var G,J,Z,se,X=P.length,q=0;q<X;){if(V[q]>=S){for(Z=q+1;Z<X&&V[Z]>=S;)Z++;for(se=q,J=Z-1;se<J;se++,J--)G=P[se],P[se]=P[J],P[J]=G,R&&(G=R[se],R[se]=R[J],R[J]=G);q=Z}q++}}},B=function(S,P,R){var V=S.split(""),ee={hiLevel:C};return R||(R=[]),E(V,R,ee),(function(G,J,Z){if(Z.hiLevel!==0&&h)for(var se,X=0;X<G.length;X++)J[X]===1&&(se=w.indexOf(G[X]))>=0&&(G[X]=w[se+1])})(V,R,ee),M(2,V,P,R,ee),M(1,V,P,R,ee),V.join("")};return this.__bidiEngine__.doBidiReorder=function(S,P,R){if((function(ee,G){if(G)for(var J=0;J<ee.length;J++)G[J]=J;l===void 0&&(l=O(ee)),u===void 0&&(u=O(ee))})(S,P),o||!c||u)if(o&&c&&l^u)C=l?1:0,S=_(S,P,R);else if(!o&&c&&u)C=l?1:0,S=B(S,P,R),S=_(S,P);else if(!o||l||c||u){if(o&&!c&&l^u)S=_(S,P),l?(C=0,S=B(S,P,R)):(C=1,S=B(S,P,R),S=_(S,P));else if(o&&l&&!c&&u)C=1,S=B(S,P,R),S=_(S,P);else if(!o&&!c&&l^u){var V=h;l?(C=1,S=B(S,P,R),C=0,h=!1,S=B(S,P,R),h=V):(C=0,S=B(S,P,R),S=_(S,P),C=1,h=!1,S=B(S,P,R),h=V,S=_(S,P))}}else C=0,S=B(S,P,R);else C=l?1:0,S=B(S,P,R);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,u=S.isOutputRtl,h=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])})(Pr),Pr.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new mp(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new UBe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new CBe(this.contents),this.head=new ABe(this),this.name=new OBe(this),this.cmap=new Gae(this),this.toUnicode={},this.hhea=new TBe(this),this.maxp=new MBe(this),this.hmtx=new RBe(this),this.post=new PBe(this),this.os2=new IBe(this),this.loca=new $Be(this),this.glyf=new DBe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var Nd,mp=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),CBe=(function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,o,l,c,u,h,f,m,g,y,v;for(v in g=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(g)/c),o=Math.floor(f/c),h=16*g-f,(s=new mp).writeInt(this.scalarType),s.writeShort(g),s.writeShort(f),s.writeShort(o),s.writeShort(h),a=16*g,u=s.pos+a,l=null,y=[],r)for(m=r[v],s.writeString(v),s.writeInt(t(m)),s.writeInt(u),s.writeInt(m.length),y=y.concat(m),v==="head"&&(l=u),u+=m.length;u%4;)y.push(0),u++;return s.write(y),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,o;for(r=Kae.call(r);r.length%4;)r.push(0);for(a=new mp(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=a.readUInt32();return 4294967295&s},e})(),EBe={}.hasOwnProperty,_h=function(t,e){for(var r in e)EBe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Nd=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var ABe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new mp).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),CH=(function(){function t(e,r){var n,s,a,o,l,c,u,h,f,m,g,y,v,w,N,k,C;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(g=e.readUInt16(),m=g/2,e.pos+=6,a=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),e.pos+=2,v=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),u=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),h=(function(){var I,O;for(O=[],c=I=0;0<=m?I<m:I>m;c=0<=m?++I:--I)O.push(e.readUInt16());return O})(),s=(this.length-e.pos+this.offset)/2,l=(function(){var I,O;for(O=[],c=I=0;0<=s?I<s:I>s;c=0<=s?++I:--I)O.push(e.readUInt16());return O})(),c=N=0,C=a.length;N<C;c=++N)for(w=a[c],n=k=y=v[c];y<=w?k<=w:k>=w;n=y<=w?++k:--k)h[c]===0?o=n+u[c]:(o=l[h[c]/2+(n-y)-(m-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,s,a,o,l,c,u,h,f,m,g,y,v,w,N,k,C,I,O,L,_,E,M,B,S,P,R,V,ee,G,J,Z,se,X,q,U,H,re,ae,xe,Ne,pe,K,ue,fe,he;switch(V=new mp,o=Object.keys(e).sort(function(le,_e){return le-_e}),r){case"macroman":for(v=0,w=(function(){var le=[];for(y=0;y<256;++y)le.push(0);return le})(),k={0:0},a={},ee=0,se=o.length;ee<se;ee++)k[K=e[s=o[ee]]]==null&&(k[K]=++v),a[s]={old:e[s],new:k[e[s]]},w[s]=k[e[s]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(w),{charMap:a,subtable:V.data,maxGlyphID:v+1};case"unicode":for(P=[],f=[],C=0,k={},n={},N=u=null,G=0,X=o.length;G<X;G++)k[O=e[s=o[G]]]==null&&(k[O]=++C),n[s]={old:O,new:k[O]},l=k[O]-s,N!=null&&l===u||(N&&f.push(N),P.push(s),u=l),N=s;for(N&&f.push(N),f.push(65535),P.push(65535),B=2*(M=P.length),E=2*Math.pow(Math.log(M)/Math.LN2,2),m=Math.log(E/2)/Math.LN2,_=2*M-E,c=[],L=[],g=[],y=J=0,q=P.length;J<q;y=++J){if(S=P[y],h=f[y],S===65535){c.push(0),L.push(0);break}if(S-(R=n[S].new)>=32768)for(c.push(0),L.push(2*(g.length+M-y)),s=Z=S;S<=h?Z<=h:Z>=h;s=S<=h?++Z:--Z)g.push(n[s].new);else c.push(R-S),L.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*M+2*g.length),V.writeUInt16(0),V.writeUInt16(B),V.writeUInt16(E),V.writeUInt16(m),V.writeUInt16(_),Ne=0,U=f.length;Ne<U;Ne++)s=f[Ne],V.writeUInt16(s);for(V.writeUInt16(0),pe=0,H=P.length;pe<H;pe++)s=P[pe],V.writeUInt16(s);for(ue=0,re=c.length;ue<re;ue++)l=c[ue],V.writeUInt16(l);for(fe=0,ae=L.length;fe<ae;fe++)I=L[fe],V.writeUInt16(I);for(he=0,xe=g.length;he<xe;he++)v=g[he],V.writeUInt16(v);return{charMap:n,subtable:V.data,maxGlyphID:C+1}}},t})(),Gae=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new CH(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,s;return r==null&&(r="macroman"),n=CH.encode(e,r),(s=new mp).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t})(),TBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),IBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),PBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)r=e.readByte(),s.push(this.names.push(e.readString(r)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t})(),LBe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},OBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,s,a,o,l,c,u,h,f,m;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=h=0,f=n.length;h<f;a=++h)s=n[a],e.pos=s.offset,u=e.readString(s.length),o=new LBe(u,s),c[m=s.nameID]==null&&(c[m]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),MBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),RBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,s,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,h;for(h=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)h.push(e.readInt16());return h})(),this.widths=(function(){var u,h,f,m;for(m=[],u=0,h=(f=this.metrics).length;u<h;u++)a=f[u],m.push(a.advance);return m}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),Kae=[].slice,DBe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,s,a,o,l,c,u,h,f;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new mp(r.read(s))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),h=l.readShort(),this.cache[e]=o===-1?new FBe(l,u,f,c,h):new BBe(l,o,u,f,c,h),this.cache[e]))},t.prototype.encode=function(e,r,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)s=e[r[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},t})(),BBe=(function(){function t(e,r,n,s,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),FBe=(function(){function t(e,r,n,s,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new mp(Kae.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),$Be=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _h(t,Nd),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<r.length&&r[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var u=new Array(4*n.length),h=0;h<n.length;++h)u[4*h+3]=255&n[h],u[4*h+2]=(65280&n[h])>>8,u[4*h+1]=(16711680&n[h])>>16,u[4*h]=(4278190080&n[h])>>24;return u},t})(),UBe=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,o,l,c,u,h,f,m,g,y,v,w,N;for(s in n=Gae.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),g={0:0},N=n.charMap)g[(c=N[s]).old]=c.new;for(y in m=n.maxGlyphID,o)y in g||(g[y]=m++);return h=(function(k){var C,I;for(C in I={},k)I[k[C]]=C;return I})(g),f=Object.keys(h).sort(function(k,C){return k-C}),v=(function(){var k,C,I;for(I=[],k=0,C=f.length;k<C;k++)l=f[k],I.push(h[l]);return I})(),a=this.font.glyf.encode(o,v,g),u=this.font.loca.encode(a.offsets,v),w={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();Pr.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,o;if(Array.isArray(r))return"["+(function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)o=r[s],a.push("/"+s+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e})();const zBe={async generatePDF(t,e={paperSize:"letter",cutLines:!0},r){const a={letter:{width:215.9,height:279.4},a4:{width:210,height:297}},o=new Pr({orientation:"portrait",unit:"mm",format:e.paperSize}),l=a[e.paperSize].width,c=a[e.paperSize].height,u=3,h=3,f=u*h,m=u*63,g=h*88,y=(l-m)/2,v=(c-g)/2,w=async k=>{try{const C=`/api/proxy/image?url=${encodeURIComponent(k)}`,I=await fetch(C);if(!I.ok)throw new Error(`Failed to fetch image: ${I.statusText}`);const O=await I.blob();return new Promise((L,_)=>{const E=new FileReader;E.onloadend=()=>L(E.result),E.onerror=_,E.readAsDataURL(O)})}catch(C){return console.error("Image load failed",k,C),null}},N=t.length;for(let k=0;k<N;k++){r&&r(k+1,N),k>0&&k%f===0&&o.addPage();const C=k%f,I=C%u,O=Math.floor(C/u),L=y+I*63,_=v+O*88,E=t[k],M=E.image_uri||E.image_uris?.normal||E.data?.image_uris?.normal||E.card_faces?.[0]?.image_uris?.normal||E.data?.card_faces?.[0]?.image_uris?.normal;let B=!1;if(M)try{const S=await w(M);S&&(o.addImage(S,"JPEG",L,_,63,88),B=!0)}catch(S){console.error("Error adding image to PDF",S)}if(!B){o.setDrawColor(0),o.rect(L,_,63,88),o.setFontSize(10);const S=o.splitTextToSize(E.name,53);if(o.text(S,L+5,_+10),o.setFontSize(8),E.mana_cost&&o.text(E.mana_cost,L+5,_+20),E.type_line){const P=o.splitTextToSize(E.type_line,53);o.text(P,L+5,_+30)}}e.cutLines&&(o.setDrawColor(200,200,200),o.rect(L,_,63,88))}return o}},VBe=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{addToast:s}=Tn(),[a,o]=b.useState("letter"),[l,c]=b.useState(!0),[u,h]=b.useState(!1),[f,m]=b.useState(0);if(!t)return null;const g=async()=>{h(!0),m(0);try{(await zBe.generatePDF(r,{paperSize:a,cutLines:l},(v,w)=>{m(Math.round(v/w*100))})).save(`${n}_Proxies.pdf`),s("PDF ready for download!","success"),e()}catch(y){console.error(y),s("Failed to generate PDF","error")}finally{h(!1)}};return i.jsx(gf,{appear:!0,show:t,as:b.Fragment,children:i.jsxs(tp,{as:"div",className:"relative z-[100]",onClose:u?()=>{}:e,children:[i.jsx(gf.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),i.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:i.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:i.jsx(gf.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:i.jsxs(tp.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-gray-900 border border-gray-700 shadow-2xl transition-all text-left align-middle",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[i.jsxs(tp.Title,{as:"h2",className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-2xl",children:""}),"Print Proxies"]}),i.jsx("button",{onClick:e,disabled:u,className:"text-gray-500 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg text-sm text-blue-200",children:["Generates a checklist or visual proxies for playtesting. ",i.jsx("br",{}),i.jsxs("strong",{children:[r.length," cards"]})," selected."]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Paper Size"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsx("button",{onClick:()=>o("letter"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="letter"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"Letter (8.5 x 11)"}),i.jsx("button",{onClick:()=>o("a4"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="a4"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"A4 (210 x 297mm)"})]})]}),i.jsx("div",{children:i.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg border border-gray-700 cursor-pointer hover:bg-gray-750 transition-colors",children:[i.jsx("input",{type:"checkbox",checked:l,onChange:y=>c(y.target.checked),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500"}),i.jsx("span",{className:"text-gray-300 font-medium",children:"Show Cut Lines"})]})}),u&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-xs text-indigo-300 font-bold uppercase",children:[i.jsx("span",{children:"Generating PDF..."}),i.jsxs("span",{children:[f,"%"]})]}),i.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:`${f}%`}})})]}),i.jsx("button",{onClick:g,disabled:u,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-sm shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:u?"Processing...":"Download PDF"})]})]})})})})]})})},MN=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],qBe=()=>{const{deckId:t}=cc(),e=yn(),{currentUser:r,userProfile:n,updateSettings:s}=Cr(),{addToast:a}=Tn(),o=n?.settings?.helper?.name||"The Oracle",[l,c]=b.useState(!1),[u,h]=b.useState(!1),[f,m]=b.useState(!1),[g,y]=b.useState(!1),[v,w]=b.useState(!1),[N,k]=b.useState(""),[C,I]=b.useState(0),[O,L]=b.useState(!1),[_,E]=b.useState(!1),[M,B]=b.useState(new Set),S=$e=>{const Xe=new Set(M);Xe.has($e)?Xe.delete($e):Xe.add($e),B(Xe)},P=()=>{M.size===Fe.length?B(new Set):B(new Set(Fe.map($e=>$e.id)))},R=async()=>{if(M.size===0)return;const $e=je.is_mockup?"delete":"remove",Xe=M.size;if(window.confirm(`Are you sure you want to ${$e==="delete"?"delete":"remove"} ${Xe} cards?`))try{await al.batchRemoveCards(r.uid,t,Array.from(M),$e),a(`Successfully removed ${Xe} cards`,"success"),E(!1),B(new Set),window.location.reload()}catch(ct){console.error(ct),a("Failed to remove cards","error")}},[V,ee]=b.useState({}),[G,J]=b.useState(!1),[Z,se]=b.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[X,q]=b.useState(!1),[U,H]=b.useState(!1),[re,ae]=b.useState(!1),[xe,Ne]=b.useState(!1),[pe,K]=b.useState(!1),ue=b.useRef(null),[fe,he]=b.useState(!0),[le,_e]=b.useState(n?.settings?.deckViewMode||"grid");b.useEffect(()=>{const $e=Xe=>{ue.current&&!ue.current.contains(Xe.target)&&K(!1)};return document.addEventListener("mousedown",$e),()=>document.removeEventListener("mousedown",$e)},[]);const[oe,Oe]=b.useState(!1);b.useEffect(()=>{const $e=()=>Oe(!0);return window.addEventListener("start-tour",$e),localStorage.getItem("tour_seen_deck_details_v1")||setTimeout(()=>Oe(!0),1e3),()=>window.removeEventListener("start-tour",$e)},[]);const ze=[{target:"h2",title:"Deck Command",content:"Rename your deck, see its colors, and track its stats."},{target:"#deck-identity-badge",title:"Identity & Theme",content:"Automatically detected color identity and archetype theme."},{target:"#deck-stats-bar",title:"Vital Stats",content:"Track power level, value, and mana curve brackets."},{target:"#deck-tools-trigger",title:"Tools & Strategy",content:"Access AI strategy analysis, Mana Curve Doctor, and more."}],Ye=$e=>{_e($e),s({deckViewMode:$e})},{deck:je,cards:Fe,loading:Nt,error:$t,refresh:Ut}=PM(t),{decks:nt}=yd(),{cards:bt}=yo(),It=je?.permissionLevel||"viewer",_t=It==="owner",wt=It==="owner"||It==="editor",ut=b.useMemo(()=>{if(je?.format?.toLowerCase()==="standard"){const Lr=je.colors||je.commander?.color_identity||[];return MN.find(Ea=>Ea.colors.length!==Lr.length?!1:Ea.colors.every(Bs=>Lr.includes(Bs)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const $e=je?.commander?.color_identity||[],Xe=je?.commander_partner?.color_identity||[],ct=[...new Set([...$e,...Xe])];return!je||ct.length===0?MN.find(Lr=>Lr.badge==="Colorless"):MN.find(Lr=>Lr.colors.length!==ct.length?!1:Lr.colors.every(tn=>ct.includes(tn)))||MN.find(Lr=>Lr.badge==="Colorless")},[je]),Rt=b.useMemo(()=>{if(!bt)return new Set;const $e=new Set;return bt.forEach(Xe=>{Xe.finish==="foil"&&!Xe.deckId&&$e.add(Xe.name)}),$e},[bt]),Dt=$e=>{if(!Fe)return 0;let Xe=Fe.reduce((ct,tr)=>(tr.data?.type_line||tr.type_line||"").includes($e)?ct+(tr.countInDeck||1):ct,0);return je?.commander&&!Fe.some(ct=>ct.scryfall_id===(je.commander.id||je.commander.scryfall_id)||ct.oracle_id&&ct.oracle_id===je.commander.oracle_id)&&(je.commander.type_line||"").includes($e)&&Xe++,je?.commander_partner&&!Fe.some(ct=>ct.scryfall_id===(je.commander_partner.id||je.commander_partner.scryfall_id)||ct.oracle_id&&ct.oracle_id===je.commander_partner.oracle_id)&&(je.commander_partner.type_line||"").includes($e)&&Xe++,Xe},at=b.useMemo(()=>{if(!Fe)return 0;let $e=Fe.reduce((Xe,ct)=>Xe+(ct.countInDeck||1),0);return je?.commander&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander.id||je.commander.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander.oracle_id)&&$e++,je?.commander_partner&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander_partner.id||je.commander_partner.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander_partner.oracle_id)&&$e++,$e},[Fe,je]),ft=b.useMemo(()=>{if(!Fe)return 0;let $e=Fe.filter(Xe=>!Xe.is_wishlist).reduce((Xe,ct)=>Xe+(ct.countInDeck||1),0);return je?.commander&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander.id||je.commander.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander.oracle_id)&&$e++,je?.commander_partner&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander_partner.id||je.commander_partner.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander_partner.oracle_id)&&$e++,$e},[Fe,je]),Bt=b.useMemo(()=>{if(!Fe)return 0;let $e=Fe.reduce((Xe,ct)=>{const tr=parseFloat(ct.prices?.[ct.finish==="foil"?"usd_foil":"usd"])||parseFloat(ct.data?.prices?.[ct.finish==="foil"?"usd_foil":"usd"])||0;return Xe+tr*(ct.countInDeck||1)},0);if(je?.commander&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander.id||je.commander.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander.oracle_id)){const Xe=je.commander,ct=parseFloat(Xe.prices?.[Xe.finish==="foil"?"usd_foil":"usd"])||0;$e+=ct}if(je?.commander_partner&&!Fe.some(Xe=>Xe.scryfall_id===(je.commander_partner.id||je.commander_partner.scryfall_id)||Xe.oracle_id&&Xe.oracle_id===je.commander_partner.oracle_id)){const Xe=je.commander_partner,ct=parseFloat(Xe.prices?.[Xe.finish==="foil"?"usd_foil":"usd"])||0;$e+=ct}return $e},[Fe,je]),De=b.useMemo(()=>{const $e=je?.aiBlueprint||{},Xe=$e.layout?.types||$e.suggestedCounts||{};return[{label:"Total",current:at,target:je?.format?.toLowerCase()==="standard"||je?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:Dt("Creature"),target:Xe.Creatures||Xe.Creature||30},{label:"Lands",current:Dt("Land"),target:Xe.Lands||Xe.Land||36},{label:"Instants",current:Dt("Instant"),target:Xe.Instants||Xe.Instant||10},{label:"Sorceries",current:Dt("Sorcery"),target:Xe.Sorceries||Xe.Sorcery||10},{label:"Enchantments",current:Dt("Enchantment"),target:Xe.Enchantments||Xe.Enchantment||5},{label:"Artifacts",current:Dt("Artifact"),target:Xe.Artifacts||Xe.Artifact||10},{label:"Planeswalkers",current:Dt("Planeswalker"),target:Xe.Planeswalkers||Xe.Planeswalker||0}].filter(tr=>tr.target>0)},[je,at,Fe]),lt=b.useMemo(()=>{if(!Fe)return{};const $e={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return Fe.forEach(Xe=>{const ct=Xe,tr=(ct.data?.type_line||ct.type_line||"").toLowerCase(),Lr=je?.commander&&(ct.scryfall_id===(je.commander.id||je.commander.scryfall_id)||ct.oracle_id&&ct.oracle_id===je.commander.oracle_id),tn=je?.commander_partner&&(ct.scryfall_id===(je.commander_partner.id||je.commander_partner.scryfall_id)||ct.oracle_id&&ct.oracle_id===je.commander_partner.oracle_id);if(Lr||tn){$e.Commander.push(ct);return}tr.includes("creature")?$e.Creature.push(ct):tr.includes("planeswalker")?$e.Planeswalker.push(ct):tr.includes("instant")?$e.Instant.push(ct):tr.includes("sorcery")?$e.Sorcery.push(ct):tr.includes("artifact")?$e.Artifact.push(ct):tr.includes("enchantment")?$e.Enchantment.push(ct):tr.includes("land")?$e.Land.push(ct):$e.Other.push(ct)}),Object.fromEntries(Object.entries($e).filter(([Xe,ct])=>ct.length>0))},[Fe,je]),ht=()=>{if(!je||!Fe)return;const $e={deck:{name:je.name,commander:je.commander},cards:Fe,exported_at:new Date},Xe=JSON.stringify($e,null,2),ct=new Blob([Xe],{type:"application/json"}),tr=URL.createObjectURL(ct),Lr=document.createElement("a");Lr.href=tr,Lr.download=`${je.name.replace(/[^a-z0-9]/yi,"_")}_backup.json`,document.body.appendChild(Lr),Lr.click(),document.body.removeChild(Lr)},Pt=$e=>{let Xe=$e.split(/[\r\n~]/);Xe.forEach((tr,Lr)=>{tr=tr.split("(")[0],tr=tr.replace(/ *\[[^\]]*\] */g," "),tr=tr.replace(/ *<[^>]*> */g," "),tr=tr.trim(),Xe[Lr]=tr});const ct=Xe.join("~");return encodeURIComponent(ct).replace(/%20/g,"+")+"~Z~"},At=()=>{if(!je||!Fe)return;const $e=[];je.commander&&$e.push(`1 ${je.commander.name}`),je.commander_partner&&$e.push(`1 ${je.commander_partner.name}`),Fe.forEach(tr=>{const Lr=tr.countInDeck||1,tn=tr.name||tr.data?.name||"";tn&&$e.push(`${Lr} ${tn}`)});const Xe=$e.join(`
`),ct=Pt(Xe);window.open(`https://edhpowerlevel.com?d=${ct}`,"_blank")},mt=()=>{if(!je||!Fe)return;const $e=[];je.commander&&$e.push(`1 ${je.commander.name}`),je.commander_partner&&$e.push(`1 ${je.commander_partner.name}`),Fe.forEach(tr=>{const Lr=tr.countInDeck||1,tn=tr.name||tr.data?.name||"";tn&&$e.push(`${Lr} ${tn}`)});const Xe=$e.join(`
`),ct=encodeURIComponent(Xe);window.open(`https://www.tcgplayer.com/massentry?c=${ct}`,"_blank")},Ft=async $e=>{try{await al.addCardToDeck(r.uid,t,$e),a(`Added ${$e.name} to deck`,"success")}catch(Xe){console.error(Xe),a("Failed to add card to deck","error")}},gt=async($e,Xe)=>{se({isOpen:!0,title:"Remove Card",message:`Are you sure you want to remove ${Xe} from this deck?`,onConfirm:async()=>{try{await al.removeCardFromDeck(r.uid,t,$e),a(`Removed ${Xe} from deck`,"success")}catch(ct){console.error(ct),a("Failed to remove card","error")}}})},Ot=$e=>{if(!$e)return"https://placehold.co/250x350?text=No+Image";const Xe=$e.data||$e;return V[Xe.id]&&Xe.card_faces&&Xe.card_faces[1]&&Xe.card_faces[1].image_uris?.normal?Xe.card_faces[1].image_uris.normal:Xe.image_uris?.normal?Xe.image_uris.normal:Xe.card_faces?.[0]?.image_uris?.normal?Xe.card_faces[0].image_uris.normal:$e.image_uri?$e.image_uri:"https://placehold.co/250x350?text=No+Image"},Ct=async($e,Xe,ct)=>{if($e.stopPropagation(),je.commander_partner&&C!==ct){I(ct);return}const tr=Xe.data||Xe;if(!(!tr.card_faces||tr.card_faces.length<2)){if(!V[tr.id]&&!tr.card_faces[1].image_uris){J(!0);try{a("Fetching back face data...","info");const Lr=await fetch(`https://api.scryfall.com/cards/${tr.id}`);if(!Lr.ok)throw new Error("Fetch failed");const tn=await Lr.json(),Ea=ct===0?{commander:tn}:{commanderPartner:tn};await al.updateDeck(r.uid,t,Ea),ct===0?je.commander=tn:je.commander_partner=tn,a("Commander data updated.","success")}catch(Lr){console.error("Flip fix failed",Lr),a("Could not load card back.","error")}finally{J(!1)}}ee(Lr=>({...Lr,[tr.id]:!Lr[tr.id]}))}},Xt=()=>{k(je.name),w(!0)},Qt=async()=>{try{await al.updateDeck(r.uid,t,{name:N}),a("Deck renamed successfully","success"),w(!1),window.location.reload()}catch($e){console.error($e),a("Failed to rename deck","error")}},nr=async()=>{try{await al.updateDeck(r.uid,t,{is_mockup:!je.is_mockup}),a(`Deck set to ${je.is_mockup?"Collection":"Mockup"} mode`,"info"),window.location.reload()}catch($e){console.error($e),a("Failed to update deck mode","error")}},sr=Ie.useRef(!1),[Jt,kr]=b.useState(!1),[Ae,Ke]=b.useState(!1),Gt=()=>{sr.current=!1,kr(!0),se({isOpen:!0,title:"Delete Deck",message:"Are you sure you want to delete this deck? Cards inside will be returned to your collection binder.",onConfirm:()=>jt()})},jt=async()=>{Ke(!0);try{await al.deleteDeck(r.uid,t,{deleteCards:sr.current}),a("Deck deleted successfully","success"),e("/decks")}catch($e){console.error($e),a("Failed to delete deck","error"),Ke(!1)}finally{window.location.pathname.includes(t)&&se($e=>({...$e,isOpen:!1})),kr(!1)}},zt=$e=>{if(!$e)return"";const Xe=$e.data||$e;return V[Xe.id]&&Xe.card_faces&&Xe.card_faces[1]&&Xe.card_faces[1].image_uris?.art_crop?Xe.card_faces[1].image_uris.art_crop:Xe.image_uris?.art_crop?Xe.image_uris.art_crop:Xe.card_faces?.[0]?.image_uris?.art_crop?Xe.card_faces[0].image_uris.art_crop:Xe.image_uris?.normal?Xe.image_uris.normal:$e.image_uri?$e.image_uri:""},[Mt,Ht]=b.useState(!1),[vr,Fr]=b.useState(!1),[ln,hn]=b.useState(null),cn=async()=>{K(!1),Fr(!0);try{const $e=await He.getActiveAudit();if($e){const Xe=$e.type==="deck",ct=String($e.target_id)===String(t);if(Xe&&ct){e(`/audit/${$e.id}`);return}hn($e),Ht(!0);return}hn(null),Ht(!0)}catch($e){console.error($e),hn(null),Ht(!0)}finally{Fr(!1)}},Ks=async()=>{Fr(!0);try{ln&&await He.cancelAudit(ln.id);const $e=await He.startAudit({type:"deck",targetId:t});e(`/audit/${$e.id}`)}catch($e){console.error($e),a("Failed to start audit: "+$e.message,"error")}finally{Fr(!1),Ht(!1),hn(null)}};if(Nt)return i.jsx("div",{className:"flex justify-center p-20",children:i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if($t)return i.jsxs("div",{className:"p-20 text-center text-red-500 text-xl font-bold",children:["Error loading deck: ",$t.message]});if(!je)return null;const Ci=C===0?je.commander:je.commander_partner||je.commander,Ds=zt(Ci),ps={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"};return i.jsxs("div",{className:"relative min-h-screen",children:[i.jsx("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${Ds})`,backgroundSize:"cover",backgroundPosition:"center"},children:i.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"})}),i.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 md:p-6 space-y-6 animate-fade-in pb-24 relative z-10",children:[i.jsx("div",{className:"sticky top-16 z-40 bg-gradient-to-r from-gray-900/95 via-gray-900/80 to-gray-900/40 backdrop-blur-3xl border-b border-white/10 shadow-2xl transition-all duration-300 mx-auto w-full max-w-[1600px] rounded-b-3xl",children:i.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 md:gap-6 px-3 md:px-8 py-3 md:py-4",children:[i.jsxs("div",{className:"flex items-start gap-3 md:gap-4 min-w-0 shrink-0",children:[i.jsx(Hr,{to:"/decks",className:"w-9 h-9 md:w-12 md:h-12 flex items-center justify-center bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shrink-0 mt-0.5 md:mt-0",title:"Back to Decks",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[v?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:N,onChange:$e=>k($e.target.value),className:"bg-black/50 text-2xl font-black text-white border-b-2 border-indigo-500 outline-none px-2 py-1 w-full max-w-md backdrop-blur-sm rounded",autoFocus:!0}),i.jsx("button",{onClick:Qt,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white shadow-lg",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}):i.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 group max-w-full",children:[i.jsx("h2",{className:"text-xl md:text-3xl lg:text-4xl font-black text-white tracking-tighter uppercase truncate leading-tight flex-1",title:je.name,children:je.name}),wt&&i.jsx("button",{onClick:Xt,className:"p-1 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity text-gray-500 hover:text-white shrink-0",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[i.jsxs("div",{id:"deck-identity-badge",className:"text-[10px] md:text-[11px] text-indigo-300 font-black uppercase tracking-[0.15em] md:tracking-[0.2em] opacity-80 whitespace-nowrap",children:[ut.badge,"  ",ut.theme]}),!_t&&i.jsxs("span",{className:`text-[9px] md:text-[10px] font-bold uppercase tracking-widest px-2 py-0.5 rounded-full border whitespace-nowrap ${wt?"bg-green-900/40 text-green-400 border-green-500/30":"bg-gray-800 text-gray-400 border-gray-700"}`,children:[It," Access"]}),i.jsx("div",{className:"flex items-center gap-1 shrink-0",children:(()=>{const $e=je?.commander?.color_identity||[],Xe=je?.commander_partner?.color_identity||[];return[...new Set([...$e,...Xe])].map(tr=>i.jsx("img",{src:ps[tr],alt:tr,className:"w-5 h-5 md:w-6 md:h-6 shadow-sm"},tr))})()})]})]}),i.jsx("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-2 md:mt-3",children:i.jsxs("div",{id:"deck-stats-bar",className:"flex items-center gap-2 bg-black/40 px-2.5 md:px-3 py-1 md:py-1.5 rounded-xl border border-white/5 backdrop-blur-md shadow-2xl",children:[i.jsx("span",{className:"bg-orange-600/20 text-orange-400 px-2 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-orange-500/30",children:je.format||"Commander"}),je.tags&&je.tags.includes("Precon")&&i.jsx("span",{className:"bg-teal-600/20 text-teal-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-teal-500/30",children:"Precon"}),je.aiBlueprint?.grade?.commanderBracket&&i.jsxs("span",{className:"bg-indigo-600/20 text-indigo-300 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-indigo-500/30",children:[i.jsx("span",{className:"hidden md:inline",children:"Bracket "}),je.aiBlueprint.grade.commanderBracket]}),je.is_mockup&&i.jsx("span",{className:"bg-red-600/20 text-red-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-red-500/30",children:"Mockup"}),je.aiBlueprint?.grade?.powerLevel>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),i.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold uppercase tracking-widest opacity-80",children:[i.jsx("span",{className:"hidden md:inline",children:"power "}),je.aiBlueprint.grade.powerLevel.toFixed(1)]})]}),i.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),i.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold font-mono",children:["$",Bt.toFixed(2)]})]})})]})]}),i.jsx("div",{className:"hidden sm:block flex-1 px-8 text-center",children:i.jsxs("div",{className:"text-[12px] md:text-[13px] text-white/30 italic font-medium tracking-tight mx-auto max-w-2xl leading-relaxed",children:['"',ut.flavor_text,'"']})}),i.jsxs("div",{className:"flex items-center gap-2 md:gap-3 bg-gray-950/40 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md relative self-end lg:self-auto",ref:ue,children:[i.jsxs("button",{onClick:()=>q(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-indigo-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),i.jsx("span",{className:"hidden sm:inline",children:"Strategy"})]}),wt&&i.jsxs("button",{onClick:()=>h(!0),className:"bg-green-600 hover:bg-green-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-green-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),i.jsx("span",{className:"hidden sm:inline",children:"Collection"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{id:"deck-tools-trigger",onClick:()=>K(!pe),className:`group relative flex items-center justify-center w-12 h-11 md:w-auto md:px-5 transition-all rounded-xl border ${pe?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"} shadow-md`,title:"Deck Tools & Management",children:[i.jsxs("div",{className:"hidden md:flex items-center -space-x-2 mr-3 opacity-70 group-hover:opacity-100 transition-opacity",children:[i.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),i.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),i.jsx("span",{className:"text-[10px] md:text-xs font-black uppercase tracking-widest",children:pe?"Close":"Tools"}),!pe&&i.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-indigo-500 rounded-full border-2 border-gray-900 md:hidden animate-pulse"})]}),pe&&i.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[60] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Deck Building"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[wt&&i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),m(!0),K(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group",children:[i.jsxs("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Scan"})]}),i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),c(!0),K(!1)},className:`flex flex-col items-center gap-2 p-3 bg-white/5 rounded-xl border border-white/5 transition-all group ${wt?"hover:bg-indigo-500/20":"opacity-50 cursor-not-allowed"}`,disabled:!wt,children:[i.jsx("svg",{className:"w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Search"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Logic & Analysis"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("button",{onClick:$e=>{if($e.stopPropagation(),!An(n?.subscription_tier).features.deckDoctor){a("Deck Doctor is available on Wizard tier and above.","info");return}ae(!0),K(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-xl border transition-all group ${An(n?.subscription_tier).features.deckDoctor?"bg-indigo-500/10 hover:bg-indigo-500/30 border-indigo-500/20":"bg-gray-900 border-gray-800 opacity-40 cursor-not-allowed"}`,children:[i.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),i.jsx("span",{className:"text-[10px] font-bold text-indigo-300",children:"Doctor"})]}),wt&&(An(n?.subscription_tier).features.deckAudit?i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),cn()},className:"w-full h-full flex flex-col items-center gap-2 p-3 bg-purple-500/10 hover:bg-purple-500/30 border border-purple-500/20 rounded-xl transition-all group",children:[i.jsx("svg",{className:"w-5 h-5 text-purple-400 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),i.jsx("span",{className:"text-[10px] font-bold text-purple-300 uppercase tracking-wider",children:"Audit"})]}):i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),a("Deck Audits are available on Magician tier and above.","info")},className:"flex flex-col items-center gap-2 p-3 bg-gray-900 border border-gray-800 rounded-xl opacity-40 cursor-not-allowed",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"Audit"})]}))]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Tabletop Tools"}),i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),e(`/solitaire/${t}`),K(!1)},className:"w-full py-3 bg-emerald-900/10 hover:bg-emerald-900/20 text-emerald-400 rounded-xl border border-emerald-500/10 hover:border-emerald-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group",children:[i.jsx("span",{className:"text-lg group-hover:scale-110 transition-transform",children:""}),"Solitaire & Playtest"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),y(!0),K(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/5 transition-all group",children:[i.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),i.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Print Proxies"})]}),i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),e("/play/lobby"),K(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/5 transition-all group",children:[i.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),i.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Live Session"})]})]}),i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),e("/tournaments"),K(!1)},className:"w-full py-2 bg-amber-900/10 hover:bg-amber-900/20 text-amber-500 rounded-xl border border-amber-500/10 hover:border-amber-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-2 group",children:[i.jsx("span",{className:"text-sm group-hover:scale-110 transition-transform",children:""}),"Find Tournament"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),i.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5",children:[i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),Ne(!0),K(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center justify-between hover:bg-indigo-500/10 transition-colors group",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),i.jsx("span",{className:"font-bold text-gray-300",children:"Share Deck"})]}),i.jsx("svg",{className:"w-3 h-3 text-gray-600 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),An(n?.subscription_tier).features.deckBackup?(ht(),K(!1)):a("Deck Export is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${An(n?.subscription_tier).features.deckBackup?"hover:bg-gray-800":"opacity-40 cursor-not-allowed"}`,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{className:"font-bold text-gray-300",children:"Export JSON"})]}),!An(n?.subscription_tier).features.deckBackup&&i.jsx("span",{className:"text-[8px] bg-amber-500/20 text-amber-500 px-1.5 py-0.5 rounded leading-none",children:"PRO"})]}),wt&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:$e=>{$e.stopPropagation(),An(n?.subscription_tier).features.mockupDeck?(nr(),K(!1)):a("Mockup Mode is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${An(n?.subscription_tier).features.mockupDeck?"hover:bg-orange-950/20":"opacity-40 cursor-not-allowed"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("span",{className:"font-bold text-gray-300",children:je.is_mockup?"To Collection":"To Mockup"})]})}),i.jsxs("button",{onClick:$e=>{$e.stopPropagation(),Gt(),K(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-red-900/30 text-red-400 transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),i.jsx("span",{className:"font-bold",children:"Delete Deck"})]})]})]})]})]})})]})]})]})}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:De.map(($e,Xe)=>{const ct=$e.target>0?Math.min($e.current/$e.target*100,100):0,tr=$e.target>0&&$e.current===$e.target,Lr=$e.target>0&&$e.current>$e.target;return i.jsxs("div",{className:"bg-gray-950/30 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg group hover:border-indigo-500/30 transition-all hover:bg-gray-950/50",children:[i.jsxs("div",{className:"flex justify-between items-end mb-1",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:$e.label}),i.jsxs("span",{className:`text-xs font-mono font-bold ${tr?"text-green-400":Lr?"text-orange-400":"text-indigo-300"}`,children:[$e.current,i.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),$e.target||"?"]})]}),i.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:i.jsx("div",{className:`h-full transition-all duration-700 ${tr?"bg-green-500":Lr?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${ct||0}%`}})})]},Xe)})}),i.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[i.jsxs("div",{className:"flex-1 min-w-0 bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl border border-white/10 order-2 lg:order-1 flex flex-col overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5 rounded-t-xl backdrop-blur-sm",children:[i.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),at>0&&i.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-700",children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acquired"}),i.jsxs("span",{className:`text-sm font-mono font-bold ${ft===at?"text-green-400":"text-orange-400"}`,children:[ft,"/",at]}),i.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden ml-1",children:i.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${ft/at*100}%`}})})]})]}),i.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700 items-center",children:[_?i.jsxs("div",{className:"flex items-center gap-2 mr-2 animate-fade-in",children:[i.jsx("button",{onClick:P,className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:M.size===Fe.length?"Deselect All":"Select All"}),i.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2",children:[M.size," Selected"]}),i.jsx("button",{onClick:R,disabled:M.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:je.is_mockup?"Delete":"Remove"}),i.jsx("button",{onClick:()=>E(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):i.jsx("button",{onClick:()=>E(!0),className:"text-xs font-bold text-gray-400 hover:text-indigo-400 px-3 transition-colors uppercase mr-1",children:"Select"}),i.jsx("div",{className:"w-px h-4 bg-gray-700 mx-1"}),i.jsx("button",{onClick:()=>Ye("grid"),className:`p-1.5 rounded-md transition-all ${le==="grid"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Grid View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),i.jsx("button",{onClick:()=>Ye("table"),className:`p-1.5 rounded-md transition-all ${le==="table"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Table View",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),i.jsxs("div",{className:"p-4 space-y-8 min-h-[500px]",children:[Object.entries(lt).length===0&&i.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:'Use the "Collection" button to start building your deck.'}),Object.entries(lt).map(([$e,Xe])=>i.jsxs("div",{className:"animate-fade-in text-left",children:[i.jsxs("h4",{className:"text-sm font-bold text-indigo-300 border-b border-white/5 mb-4 pb-2 sticky top-0 bg-gray-950/60 backdrop-blur-md z-10 flex justify-between uppercase tracking-wider pl-1",children:[i.jsx("span",{children:$e}),i.jsx("span",{className:"text-gray-500 text-xs bg-gray-900 px-2 py-0.5 rounded-full border border-gray-700",children:Xe.reduce((ct,tr)=>ct+(tr.countInDeck||1),0)})]}),le==="grid"?i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 px-1",children:Xe.map(ct=>i.jsx(Ky,{card:ct,availableFoils:Rt,onRemove:gt,decks:nt,currentUser:n,showOwnerTag:!0,hideDeckTag:!0,hideOwnerTag:!0,selectMode:_,isSelected:M.has(ct.id),onToggleSelect:S},ct.firestoreId||ct.id))}):i.jsx("div",{className:"space-y-1",children:Xe.map((ct,tr)=>i.jsxs("div",{className:`flex items-center justify-between p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm group border ${M.has(ct.id)?"bg-indigo-900/20 border-indigo-500/50":"border-transparent hover:border-gray-700"}`,onClick:Lr=>{_&&(Lr.stopPropagation(),S(ct.id))},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[_&&i.jsx("input",{type:"checkbox",checked:M.has(ct.id),readOnly:!0,className:"rounded bg-gray-700 border-gray-600 text-indigo-500 focus:ring-0 w-4 h-4 cursor-pointer"}),i.jsx("span",{className:"font-mono text-gray-500 w-6 text-center bg-gray-900 rounded py-0.5 text-xs",children:ct.countInDeck}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`font-medium ${ct.finish==="foil"?"text-yellow-200":"text-gray-200"}`,children:ct.name}),ct.finish!=="foil"&&Rt.has(ct.name)&&i.jsx("span",{className:"text-yellow-500 text-xs cursor-help",title:"Foil copy available in collection",children:""})]}),ct.finish==="foil"&&i.jsx("span",{className:"text-[10px] bg-yellow-900/40 text-yellow-500 px-1 rounded uppercase tracking-wider border border-yellow-800",children:"Foil"})]}),i.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[i.jsx("span",{className:"hidden md:inline-block text-xs text-gray-500",children:ct.data?.type_line||ct.type_line||""}),i.jsx("span",{className:"font-mono w-16 text-right text-xs",children:ct.mana_cost||""}),i.jsxs("span",{className:"font-mono w-16 text-right text-green-400/80 text-xs",children:["$",(parseFloat(ct.prices?.[ct.finish==="foil"?"usd_foil":"usd"])||0).toFixed(2)]}),wt&&!_&&i.jsx("button",{onClick:()=>gt(ct.firestoreId||ct.id,ct.name),className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]},ct.id+tr))})]},$e))]})]}),i.jsxs("div",{className:"w-full lg:w-80 space-y-6 shrink-0 order-1 lg:order-2",children:[je.commander&&i.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[i.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:je.format?.toLowerCase()==="standard"?"Spotlight Card":je.commander_partner?"Partners":"Commander"}),je.commander_partner&&i.jsx("button",{onClick:()=>I($e=>$e===0?1:0),className:"text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider transition-colors",children:"Swap View "})]}),i.jsxs("div",{className:"p-4 flex justify-center relative min-h-[350px]",children:[je.commander_partner&&i.jsx("div",{className:`transition-all duration-500 ease-out transform absolute top-4 
                                            ${C===0?"scale-90 opacity-60 translate-x-4 -rotate-3 z-0 blur-[1px] hover:blur-0":"scale-100 opacity-100 z-10 translate-x-0 rotate-0"}
                                            cursor-pointer`,onClick:$e=>Ct($e,je.commander_partner,1),children:i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:Ot(je.commander_partner),className:"w-full max-w-[250px] rounded-lg shadow-2xl skew-y-1",alt:je.commander_partner.name}),(je.commander_partner.card_faces||je.commander_partner.data?.card_faces)&&C===1&&i.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:i.jsx("svg",{className:`w-4 h-4 ${G?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),i.jsx("div",{className:`transition-all duration-500 ease-out transform relative 
                                        ${je.commander_partner&&C===1?"scale-90 opacity-60 -translate-x-4 rotate-3 z-0 blur-[1px] hover:blur-0 cursor-pointer":"scale-100 opacity-100 z-10"}
                                        `,onClick:$e=>Ct($e,je.commander,0),children:i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:Ot(je.commander),className:"w-full max-w-[250px] rounded-lg shadow-2xl hover:shadow-indigo-500/30 transition-shadow duration-300",alt:je.commander.name}),(je.commander.card_faces||je.commander.data?.card_faces)&&C===0&&i.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:i.jsx("svg",{className:`w-4 h-4 ${G?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]}),i.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl p-6 border border-white/10 relative overflow-hidden group",children:[i.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:i.jsx("span",{className:"text-8xl",children:""})}),i.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),o," Tools"]}),i.jsxs("div",{className:"space-y-3 relative z-10",children:[i.jsxs("button",{onClick:()=>{if(!An(n?.subscription_tier).features.deckSuggestions){a("Deck Builder is available on Magician tier and above.","info");return}je.format?.toLowerCase()==="standard"?a("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info",0):e(`/decks/${t}/build`)},className:`w-full py-4 rounded-xl border transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn ${An(n?.subscription_tier).features.deckSuggestions?"bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-300 border-indigo-500/20 hover:border-indigo-500/40":"bg-gray-900/50 border-gray-800 text-gray-600 cursor-not-allowed hover:bg-gray-900/50"}`,children:[i.jsx("span",{className:`text-lg transition-transform ${An(n?.subscription_tier).features.deckSuggestions?"group-hover/btn:scale-110":""}`,children:An(n?.subscription_tier).features.deckSuggestions?"":""}),o,"'s Deck Builder"]}),i.jsxs("button",{onClick:()=>H(!0),className:"w-full py-4 bg-indigo-900/10 hover:bg-indigo-900/20 text-indigo-400 rounded-xl border border-indigo-500/10 hover:border-indigo-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[i.jsx("span",{className:"text-lg",children:""}),"Full Deck Stats"]})]})]}),i.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[i.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:i.jsx("span",{className:"text-8xl",children:""})}),i.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 p-4 pb-0 flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse"}),"External Sites"]}),i.jsxs("div",{className:"space-y-3 relative z-10 p-4 pt-3",children:[i.jsxs("button",{onClick:At,className:"w-full py-4 bg-purple-600/10 hover:bg-purple-600/20 text-purple-300 rounded-xl border border-purple-500/20 hover:border-purple-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[i.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),"EDH Power Level"]}),i.jsxs("button",{onClick:mt,className:"w-full py-4 bg-green-900/10 hover:bg-green-900/20 text-green-400 rounded-xl border border-green-500/10 hover:border-green-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[i.jsx("span",{className:"text-lg",children:""}),"Buy on TCGPlayer"]})]})]})]})]}),i.jsx(Q7e,{isOpen:xe,onClose:()=>Ne(!1),deck:je,onUpdateDeck:$e=>Object.assign(je,$e)}),i.jsx(nae,{isOpen:re,onClose:()=>ae(!1),deck:je,cards:Fe,isOwner:wt}),i.jsx(mO,{isOpen:l,onClose:()=>c(!1),onAddCard:Ft}),i.jsx(tae,{isOpen:Z.isOpen,onClose:()=>se({...Z,isOpen:!1}),onConfirm:Z.onConfirm,title:Z.title,message:Z.message,isDanger:!0,confirmText:"Remove",isLoading:Ae,children:Jt&&i.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white/5 p-3 rounded-lg border border-white/10",children:[i.jsx("input",{type:"checkbox",id:"deleteCardsCheckbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500",onChange:$e=>sr.current=$e.target.checked}),i.jsxs("label",{htmlFor:"deleteCardsCheckbox",className:"text-gray-300 text-sm select-none",children:["Also remove these cards from my ",je.is_mockup?"wishlist":"collection binder"]})]})}),i.jsx(X7e,{isOpen:X,onClose:()=>q(!1),deck:je,cards:Fe,onStrategyUpdate:()=>Ut(!0)}),i.jsx(K7e,{isOpen:u,onClose:()=>h(!1),deck:je,deckCards:Fe,onCardAdded:()=>Ut()}),i.jsx(rae,{isOpen:U,onClose:()=>H(!1),cards:Fe,deckName:je.name}),i.jsx(W_,{isOpen:f,onClose:()=>m(!1),onFinish:async $e=>{if($e.length)try{const Xe=$e.map(ct=>({name:ct.name,scryfall_id:ct.scryfall_id,set_code:ct.set_code,collector_number:ct.collector_number,image_uri:ct.data.image_uris?.normal||ct.data.card_faces?.[0]?.image_uris?.normal,count:ct.quantity,data:ct.data,finish:ct.finish||"nonfoil",is_wishlist:ct.is_wishlist,tags:[]}));await al.batchAddCardsToDeck(r.uid,t,Xe),a(`Successfully added ${$e.length} cards to deck!`,"success"),Ut()}catch(Xe){console.error("Forge Lens Add Failed",Xe),a("Failed to add scanned cards.","error")}}}),i.jsx(VBe,{isOpen:g,onClose:()=>y(!1),cards:Fe}),i.jsx(nse,{isOpen:Mt,onClose:()=>Ht(!1),onConfirm:Ks,type:"deck",targetId:t,loading:vr,activeSession:ln,deckName:je?.name})]}),i.jsx(zf,{steps:ze,isOpen:oe,onClose:()=>Oe(!1),tourId:"deck_details_v1"})]})},Yae=({value:t,onChange:e,onSelect:r,placeholder:n="Find card in sets..."})=>{const[s,a]=b.useState([]),[o,l]=b.useState(!1),[c,u]=b.useState(!1),h=b.useRef(null);b.useEffect(()=>{const m=g=>{h.current&&!h.current.contains(g.target)&&l(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),b.useEffect(()=>{const g=setTimeout(async()=>{if(t.length<2){a([]);return}u(!0);try{const y=await He.get("/api/cards/autocomplete",{q:t});a(y.data||[]),l(!0)}catch(y){console.error("Autocomplete failed",y)}finally{u(!1)}},300);return()=>clearTimeout(g)},[t]);const f=m=>{e(m),l(!1),r&&r(m)};return i.jsxs("div",{ref:h,className:"relative w-full",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c?i.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-indigo-400"}):i.jsx("svg",{className:"h-4 w-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 bg-gray-900/50 border border-indigo-500/20 rounded-xl text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none text-sm",placeholder:n,value:t,onChange:m=>e(m.target.value),onFocus:()=>t.length>=2&&l(!0)}),t&&i.jsx("button",{onClick:()=>e(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o&&s.length>0&&i.jsx("div",{className:"absolute z-50 w-full mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl overflow-hidden animate-fade-in",children:s.map((m,g)=>i.jsx("button",{onClick:()=>f(m),className:"w-full text-left px-4 py-2.5 text-sm text-gray-300 hover:bg-indigo-600 hover:text-white transition-colors border-b border-white/5 last:border-0",children:m},g))})]})},HBe=()=>{const{sets:t,loading:e,error:r}=Ore(),{cards:n}=yo(),[s,a]=b.useState(""),[o,l]=b.useState(sessionStorage.getItem("mtg_card_search")||""),[c,u]=b.useState(null),[h,f]=b.useState(!1),[m,g]=b.useState(!1),y=yn(),[v,w]=b.useState(!1);b.useEffect(()=>{const L=()=>w(!0);return window.addEventListener("start-tour",L),localStorage.getItem("tour_seen_sets_tour_v1")||setTimeout(()=>w(!0),1e3),()=>window.removeEventListener("start-tour",L)},[]);const N=[{target:"h1",title:"Set Library",content:"Browse every Magic: The Gathering set ever released."},{target:"#sets-search",title:"Find Sets",content:'Search for sets by name or code (e.g. "ELD").'},{target:"#sets-card-search",title:"Find Card in Sets",content:"Looking for a specific card? Find which sets contain it."},{target:"#sets-owned-toggle",title:"Collection Filter",content:"Toggle to show only sets where you own cards."}];b.useEffect(()=>{const _=setTimeout(async()=>{const E=o.trim();if(!E){u(null),sessionStorage.removeItem("mtg_card_search");return}sessionStorage.setItem("mtg_card_search",E),f(!0);try{const M=await He.get("/api/cards/sets-for-card",{name:E});u(new Set(M.data||[]))}catch(M){console.error("Local card search failed",M),u(new Set)}finally{f(!1)}},500);return()=>clearTimeout(_)},[o]);const k=b.useMemo(()=>{const L=new Map;n&&n.forEach(E=>{if(E.is_wishlist)return;const M=(E.set||E.set_code||E.data?.set)?.toLowerCase(),B=E.name||E.data?.name;L.has(M)||L.set(M,new Set),B&&L.get(M).add(B)});const _={};return L.forEach((E,M)=>{_[M]=E.size}),_},[n]),C=b.useMemo(()=>{if(!t)return{};const L={Expansion:[],Core:[],Commander:[],Masters:[],"Draft Innovation":[],Other:[]},_={expansion:"Expansion",core:"Core",commander:"Commander",masters:"Masters",draft_innovation:"Draft Innovation"};return t.forEach(E=>{const M=k[E.code.toLowerCase()]||0,B=M>0,S=!s||E.name.toLowerCase().includes(s.toLowerCase())||E.code.toLowerCase().includes(s.toLowerCase()),P=!c||c.has(E.code.toLowerCase());if(!S||!(!m||B)||!P)return;const V=_[E.set_type]||"Other";L[V]?L[V].push({...E,ownedCount:M}):L.Other.push({...E,ownedCount:M})}),Object.keys(L).forEach(E=>{L[E].sort((M,B)=>new Date(B.released_at)-new Date(M.released_at))}),L},[t,s,m,k,c]),I=L=>{y(`/sets/${L}`)};if(e)return i.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(r)return i.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:i.jsxs("div",{className:"text-center text-red-500 bg-red-500/10 p-8 rounded-2xl border border-red-500/20 max-w-md",children:[i.jsx("p",{className:"font-bold text-xl mb-2",children:"Error loading sets"}),i.jsx("p",{className:"text-sm opacity-80",children:r.message})]})});const O=["Expansion","Core","Commander","Masters","Draft Innovation","Other"];return i.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[i.jsx("div",{className:"bg-gray-950/80 backdrop-blur-xl border-b border-white/10 sticky top-16 z-30 py-3 md:py-4",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[i.jsx("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:["Set ",i.jsx("span",{className:"text-indigo-500",children:"Library"})]}),i.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Browse Collections"})]})}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto lg:flex-1 lg:justify-end",children:[i.jsxs("div",{className:"relative flex-grow max-w-xs group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-3.5 w-3.5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("input",{type:"text",className:"block w-full pl-9 pr-10 py-2 bg-gray-900/50 border border-white/5 rounded-lg text-xs text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all outline-none",placeholder:"Search sets...",value:s,onChange:L=>a(L.target.value),id:"sets-search"}),s&&i.jsx("button",{onClick:()=>a(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"relative flex-grow max-w-sm",id:"sets-card-search",children:i.jsx(Yae,{value:o,onChange:l,placeholder:"Find card in sets..."})}),i.jsx("button",{onClick:()=>g(!m),id:"sets-owned-toggle",className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${m?"bg-indigo-600 text-white shadow-lg":"bg-gray-800/80 text-gray-400 border border-white/5 hover:bg-gray-700"}`,children:m?"Owned":"Show All"})]})]})})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:O.map(L=>C[L]&&C[L].length>0&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[i.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-3",children:[L,i.jsx("div",{className:"h-[2px] w-12 bg-indigo-500/50"})]}),i.jsxs("span",{className:"text-[10px] font-black text-gray-500 bg-gray-800/50 border border-white/5 px-3 py-1 rounded-full uppercase tracking-widest",children:[C[L].length," Sets"]})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:C[L].map(_=>{const E=Math.min(100,Math.round(_.ownedCount/_.card_count*100)),M=E>=100;return i.jsxs("div",{onClick:()=>I(_.code),className:"relative bg-gray-800/40 backdrop-blur-md rounded-2xl border border-white/5 p-5 group cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:border-indigo-500/30 overflow-hidden min-h-[160px] flex flex-col justify-between",children:[i.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-1000 ease-out z-0",style:{height:`${E}%`,background:M?"linear-gradient(to top, rgba(34, 197, 94, 0.15) 0%, transparent 100%)":"linear-gradient(to top, rgba(79, 70, 229, 0.15) 0%, transparent 100%)"}}),i.jsxs("div",{className:"relative z-10",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-900/80 rounded-xl flex items-center justify-center border border-white/5 shadow-inner",children:_.icon_svg_uri?i.jsx("img",{src:_.icon_svg_uri,alt:_.name,className:"w-6 h-6 filter invert opacity-60 group-hover:opacity-100 transition-opacity"}):i.jsx("span",{className:"text-xs font-black text-gray-500",children:_.code.toUpperCase()})}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"flex flex-col items-end",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Code"}),i.jsx("span",{className:"text-xs font-bold text-indigo-400 mb-2",children:_.code.toUpperCase()}),i.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Release"}),i.jsx("span",{className:"text-xs font-bold text-gray-400",children:_.released_at?.split("-")[0]})]})})]}),i.jsx("h3",{className:"text-sm font-black text-white leading-snug group-hover:text-indigo-400 transition-colors",children:_.name})]}),i.jsxs("div",{className:"relative z-10 pt-4 mt-4 border-t border-white/5 flex items-end justify-between",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Collected"}),i.jsxs("div",{className:"flex items-baseline gap-1",children:[i.jsx("span",{className:`text-lg font-black tabular-nums ${M?"text-green-400":"text-indigo-400"}`,children:_.ownedCount}),i.jsxs("span",{className:"text-gray-600 text-[10px] font-bold",children:["/ ",_.card_count]})]})]}),i.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-[10px] font-black ${M?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-gray-950/80 text-gray-400 border border-white/5"}`,children:[E,"%"]})]})]},_.id)})})]},L))}),i.jsx(zf,{steps:N,isOpen:v,onClose:()=>w(!1),tourId:"sets_tour_v1"})]})},WBe=()=>{const{setCode:t}=cc(),[e,r]=b.useState([]),[n,s]=b.useState(!0),[a,o]=b.useState(null),[l,c]=b.useState("all"),[u,h]=b.useState(sessionStorage.getItem("mtg_card_search")||""),{currentUser:f,userProfile:m}=Cr(),{addToast:g}=Tn(),{cards:y,refresh:v}=yo(),{decks:w}=yd();b.useEffect(()=>{u?sessionStorage.setItem("mtg_card_search",u):sessionStorage.removeItem("mtg_card_search")},[u]);const N=b.useMemo(()=>{const L=new Map;return y&&y.forEach(_=>{const E=new Set;_.scryfall_id&&E.add(_.scryfall_id),_.scryfallId&&E.add(_.scryfallId),_.id&&E.add(_.id),_.data?.id&&E.add(_.data.id),_.data?.scryfall_id&&E.add(_.data.scryfall_id),E.forEach(M=>{L.has(M)||L.set(M,[]),L.get(M).push(_)})}),L},[y]),k=b.useMemo(()=>{const L=new Set(e.map(M=>M.name)),_=new Set;let E=0;return e.forEach(M=>{const B=N.get(M.scryfall_id||M.id)||[],S=B.filter(R=>R.finish==="nonfoil"&&!R.is_wishlist).reduce((R,V)=>R+(V.count??1),0),P=B.filter(R=>R.finish==="foil"&&!R.is_wishlist).reduce((R,V)=>R+(V.count??1),0);if(S>0||P>0){_.add(M.name);const R=parseFloat(M.prices?.usd||0)*S,V=parseFloat(M.prices?.usd_foil||0)*P;E+=R+V}}),{collected:_.size,total:L.size,value:E.toFixed(2)}},[e,N]),C=b.useMemo(()=>{let L=e;if(l!=="all"&&(L=L.filter(_=>{const M=(N.get(_.scryfall_id||_.id)||[]).some(B=>!B.is_wishlist&&(B.count??1)>0);return l==="owned"?M:!M})),u){const _=u.toLowerCase();L=L.filter(E=>E.name.toLowerCase().includes(_)||(E.data?.name_en||"").toLowerCase().includes(_))}return L},[e,N,l,u]);b.useEffect(()=>{(async()=>{if(t){s(!0);try{const _=await He.get(`/api/sets/${t}/cards`);r(_.data||[]),o(null)}catch(_){console.error("Failed to load set cards",_),o(_.message)}finally{s(!1)}}})()},[t]);const I=async(L,_,E,M=null)=>{if(!f)return g("Please log in","error");try{const B=L.id,S=N.get(B)||[],P=_==="foil"?"foil":"nonfoil",R=S.filter(Z=>Z.finish===P&&!Z.is_wishlist).reduce((Z,se)=>Z+(se.count||1),0),V=S.filter(Z=>Z.finish===P&&!Z.is_wishlist&&Z.deck_id).reduce((Z,se)=>Z+(se.count||1),0);let ee;if(M!==null?ee=Math.max(0,parseInt(M)):ee=Math.max(0,R+E),ee<V){g(`Cannot reduce count below ${V} (used in decks)`,"error");return}const G=ee-V,J=S.find(Z=>Z.finish===P&&!Z.deck_id&&!Z.is_wishlist);if(J)if(G>0){await bl.updateCard(J.id,{count:G});const Z=M!==null?`Updated ${P} count to ${ee}`:`Added ${P} ${L.name}`;M!==null||E>0?g(Z,"success"):g(`Removed ${P} ${L.name}`,"info")}else await bl.removeCard(J.id),g(`Removed last binder copy of ${P} ${L.name}`,"info");else G>0&&(await bl.addCardToCollection(f.uid,L,G,P),g(`Added new ${P} ${L.name}`,"success"));await v()}catch(B){console.error("Update failed",B),g("Failed to update collection","error")}},O=async(L,_)=>{if(!f)return g("Please log in","error");try{const E=L.id,B=(N.get(E)||[]).find(S=>S.is_wishlist&&!S.deck_id);_>0?B?(await bl.updateCard(B.id,{count:(B.count||1)+1}),g(`Increased wishlist for ${L.name}`,"success")):(await bl.addCardToCollection(f.uid,L,1,"nonfoil",!0),g(`Added ${L.name} to wishlist`,"success")):B&&((B.count||1)>1?(await bl.updateCard(B.id,{count:B.count-1}),g(`Decreased wishlist for ${L.name}`,"info")):(await bl.removeCard(B.id),g(`Removed ${L.name} from wishlist`,"info"))),await v()}catch(E){console.error("Wishlist update failed",E),g("Failed to update wishlist","error")}};return i.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[i.jsx("div",{className:"sticky top-16 z-30 bg-gray-950/80 backdrop-blur-xl border-b border-white/10 shadow-2xl",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Hr,{to:"/sets",className:"p-1.5 bg-gray-800/50 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white transition-all group",title:"Back to Sets",children:i.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:[t," ",i.jsx("span",{className:"text-gray-500 font-bold ml-1",children:"Library"})]}),i.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Expansion Collection"})]})]}),i.jsxs("div",{className:"flex items-center gap-6 bg-gray-900/50 border border-white/5 px-4 py-2 rounded-xl",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Collected"}),i.jsxs("div",{className:"flex items-baseline gap-1",children:[i.jsx("span",{className:"text-sm font-black text-indigo-400",children:k.collected}),i.jsxs("span",{className:"text-gray-600 font-bold text-[10px]",children:["/ ",k.total]})]})]}),i.jsx("div",{className:"w-[1px] h-4 bg-white/10"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Estimate Value"}),i.jsxs("span",{className:"text-sm font-black text-emerald-400 tabular-nums",children:["$",k.value]})]})]}),An(m?.subscription_tier).features.setAudit?i.jsx(JO,{type:"set",targetId:t,label:"Audit Set",className:"text-xs py-1.5"}):i.jsxs("button",{onClick:()=>g(`Set Audits are available on ${ta[lr.TIER_2].name} tier and above.`,"info"),className:"bg-gray-800/50 border border-gray-700 text-gray-500 px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-widest cursor-not-allowed flex items-center gap-2",title:`Requires ${ta[lr.TIER_2].name} Tier`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Audit Set"]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 pt-3 border-t border-white/5",children:[i.jsx("div",{className:"flex bg-gray-900/80 rounded-lg p-0.5 border border-white/5 w-full md:w-auto overflow-hidden",children:["all","owned","missing"].map(L=>i.jsx("button",{onClick:()=>c(L),className:`flex-1 md:flex-none px-4 py-1.5 rounded-md text-[10px] font-black uppercase tracking-widest transition-all duration-300 ${l===L?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white hover:bg-white/5"}`,children:L},L))}),i.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto md:flex-1 justify-end",children:[i.jsx("div",{className:"relative w-full max-w-sm",children:i.jsx(Yae,{value:u,onChange:h,placeholder:"Filter cards..."})}),u&&i.jsx("button",{onClick:()=>{h(""),sessionStorage.removeItem("mtg_card_search")},className:"p-2 bg-indigo-500/10 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/20 hover:text-white rounded-lg transition-all",title:"Clear filter",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:n?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",children:Array.from({length:12}).map((L,_)=>i.jsx(TM,{},_))}):a?i.jsxs("div",{className:"text-center text-red-500 py-12 bg-red-500/10 rounded-2xl border border-red-500/20",children:["Error loading set: ",a]}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:C.map((L,_)=>{const E=N.get(L.scryfall_id||L.id)||[],M=E.filter(P=>P.finish==="nonfoil"&&!P.is_wishlist).reduce((P,R)=>P+(R.count||1),0),B=E.filter(P=>P.finish==="foil"&&!P.is_wishlist).reduce((P,R)=>P+(R.count||1),0),S=E.filter(P=>P.is_wishlist).reduce((P,R)=>P+(R.count||1),0);return i.jsx(mte,{card:L,normalCount:M,foilCount:B,wishlistCount:S,onUpdateCount:I,onUpdateWishlistCount:O,currentUser:m,showOwnerTag:!0,userCopies:E,decks:w},L.id||_)})})})]})},GBe=()=>{const{userProfile:t,currentUser:e,refreshUserProfile:r}=Cr();yn();const[n,s]=b.useState(!1),[a,o]=b.useState(!1),[l,c]=b.useState("monthly"),{cards:u}=yo(),{decks:h}=yd(),f=t?.override_tier||t?.subscription_tier,m=An(f),g=t?.subscription_status||(f!==lr.FREE?"active":"free"),y=g==="trial",v=y?t?.trial_end_date:t?.subscription_end_date,w=v?new Date(v).toLocaleDateString():null,N=b.useMemo(()=>{if(!u||!h)return{decks:0,collection:0,wishlist:0};const L=u.filter(B=>!B.is_wishlist),_=u.filter(B=>B.is_wishlist);let E=L.reduce((B,S)=>B+(S.count||1),0),M=_.reduce((B,S)=>B+(S.count||1),0);return{decks:h.length,collection:E,wishlist:M}},[u,h]),k=async()=>{s(!0);try{const L=await He.post("/api/payments/create-portal-session",{});L.url?window.location.href=L.url:alert("Failed to redirect to billing portal.")}catch(L){console.error("Billing portal error:",L),alert("Could not open billing portal. "+(L.response?.data?.error||L.message))}finally{s(!1)}},C=async L=>{s(!0);try{const _=await He.post("/api/payments/create-checkout-session",{tierId:L,interval:l,successUrl:`${window.location.origin}/settings?success=true`,cancelUrl:`${window.location.origin}/settings?canceled=true`});if(_.url)window.location.href=_.url;else throw new Error("No checkout URL returned")}catch(_){console.error("Subscription error:",_),alert(_.message||"Failed to start subscription process"),s(!1)}},I=L=>{switch(L){case lr.FREE:return i.jsx(Nf,{className:"w-12 h-12 text-gray-400"});case lr.TIER_1:return i.jsx(HI,{className:"w-12 h-12 text-blue-400"});case lr.TIER_2:return i.jsx(ud,{className:"w-12 h-12 text-purple-400"});case lr.TIER_3:return i.jsx(rp,{className:"w-12 h-12 text-yellow-400"});case lr.TIER_4:return i.jsx(rp,{className:"w-12 h-12 text-orange-500"});case lr.TIER_5:return i.jsx(rp,{className:"w-12 h-12 text-red-500"});default:return i.jsx(Nf,{className:"w-12 h-12 text-gray-400"})}},O=(L,_,E,M)=>{const B=E===1/0?0:Math.min(_/E*100,100),S=E!==1/0&&_/E>=.9;let P="bg-green-500";return E===1/0?P="bg-blue-500":B>=90?P="bg-red-500":B>=75&&(P="bg-yellow-500"),i.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("span",{className:"text-gray-300 text-sm font-medium flex items-center gap-2",children:[i.jsx("span",{children:M})," ",L]}),i.jsxs("span",{className:`font-bold text-sm ${S?"text-red-400":"text-white"}`,children:[_," / ",E===1/0?"":E]})]}),i.jsx("div",{className:"h-2 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/50",children:i.jsx("div",{className:`h-full ${P} transition-all duration-1000 ease-out`,style:{width:E===1/0?"100%":`${B}%`}})}),S&&i.jsx("p",{className:"text-[10px] text-red-400 mt-1 mt-2",children:"Running low on space!"})]})};return i.jsxs("div",{className:"space-y-8 animate-fade-in",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Membership & Billing"}),i.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6 relative overflow-hidden",children:[i.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between relative z-10 gap-6",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsx("div",{className:"p-3 bg-gray-800 rounded-lg border border-gray-700 shrink-0",children:I(f)}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:m.name}),i.jsx("p",{className:"text-gray-400 text-sm max-w-md",children:m.description}),i.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border ${g==="active"?"bg-green-500/10 text-green-400 border-green-500/20":g==="canceled"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/20":y?"bg-blue-500/10 text-blue-400 border-blue-500/20":g==="past_due"?"bg-red-500/10 text-red-400 border-red-500/20":"bg-gray-700 text-gray-300 border-gray-600"}`,children:g==="free"?"Free Plan":g==="trial"?"Full Access Trial":g.replace("_"," ")}),t?.override_tier&&i.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border bg-purple-500/10 text-purple-400 border-purple-500/20",children:"Admin Override"})]}),w&&g!=="free"&&!t?.override_tier&&i.jsxs("div",{className:`mt-2 p-3 rounded-lg border ${y?"bg-blue-500/10 border-blue-500/30":"bg-gray-800 border-gray-700"}`,children:[i.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-gray-400 mb-1",children:g==="canceled"?"Access Expires":y?"Trial Remaining":"Next Renewal"}),i.jsx("div",{className:"flex items-baseline gap-2",children:y?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xl font-bold text-white",children:Math.max(0,Math.ceil((new Date(v)-new Date)/(1e3*60*60*24)))}),i.jsx("span",{className:"text-sm text-gray-400",children:"Days Left"}),i.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",w,")"]})]}):i.jsx("span",{className:"text-sm font-bold text-white",children:new Date(v).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:[i.jsx("button",{onClick:()=>o(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-purple-900/20 transition-all hover:scale-105 whitespace-nowrap",children:f===lr.FREE?"Upgrade Plan":"Change Plan"}),f!==lr.FREE&&i.jsxs("button",{onClick:k,disabled:n,className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium border border-gray-600 transition-colors text-sm",children:[i.jsx(Oke,{className:"w-4 h-4"}),n?"Loading...":"Manage Billing"]})]})]}),i.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-b from-purple-500/10 to-transparent rounded-bl-full pointer-events-none"})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""})," Usage & Limits"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[O("Decks",N.decks,m.limits.decks,""),O("Collection",N.collection,m.limits.collection,""),O("Wishlist",N.wishlist,m.limits.wishlist,"")]}),i.jsx("p",{className:"text-xs text-gray-500 mt-2 text-right",children:"* Limits apply to active items. Archived/Deleted items do not count."})]}),a&&Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center p-4 pt-24 text-left font-sans",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>o(!1)}),i.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-[95vw] max-h-[85vh] overflow-y-auto shadow-2xl animate-scale-in",children:[i.jsxs("div",{className:"sticky top-0 z-20 flex justify-between items-center p-6 bg-gray-900/95 backdrop-blur border-b border-gray-800",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select a Plan"}),i.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:i.jsx(vu,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"p-6 md:p-8",children:i.jsx(wie,{billingInterval:l,setBillingInterval:c,onSubscribe:C,isLoading:n,currentTier:f})})]})]}),document.body)]})},KBe=()=>{const{user:t,userProfile:e,updateProfileFields:r,resetPassword:n,sendVerification:s}=Cr(),[a,o]=b.useState(""),[l,c]=b.useState(""),[u,h]=b.useState(""),[f,m]=b.useState(""),[g,y]=b.useState(""),[v,w]=b.useState(!1),[N,k]=b.useState(!1),[C,I]=b.useState(!1),[O,L]=b.useState(!1);b.useEffect(()=>{e&&(o(e.first_name||""),c(e.last_name||""),h(e.username||""),m(e.data?.bio||""),y(e.data?.avatar||""),w(e.is_public_library||e.settings?.is_public_library||!1))},[e]);const _=async()=>{k(!0);try{await r({username:u,first_name:a,last_name:l,is_public_library:v,data:{...e?.data||{},bio:f,avatar:g}}),alert("Profile saved successfully!")}catch(B){console.error("Failed to save profile:",B),alert("Error saving profile: "+(B.message||"Unknown error"))}finally{k(!1)}},E=async()=>{if(t?.email){I(!0);try{await n(t.email),alert("Password reset email sent!")}catch(B){alert("Error: "+B.message)}finally{I(!1)}}},M=async()=>{L(!0);try{await s(),alert("Verification email sent!")}catch(B){alert("Error: "+B.message)}finally{L(!1)}};return i.jsxs("div",{className:"space-y-8 animate-fade-in max-w-4xl mx-auto p-4 md:p-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 mb-6",children:"Account Settings"}),i.jsxs("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Profile Information"}),i.jsx("button",{onClick:_,disabled:N,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-lg shadow-lg shadow-indigo-500/20 transition-all ${N?"opacity-50 cursor-not-allowed":""}`,children:N?"Saving...":"Save Changes"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm text-gray-400 block",children:"First Name"}),i.jsx("input",{type:"text",value:a,onChange:B=>o(B.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm text-gray-400 block",children:"Last Name"}),i.jsx("input",{type:"text",value:l,onChange:B=>c(B.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm text-gray-400 block",children:"Username"}),i.jsx("input",{type:"text",value:u,onChange:B=>h(B.target.value),placeholder:"Enter username...",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),i.jsxs("div",{className:"pt-6 border-t border-gray-700 space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Public Appearance"}),i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-200",children:"Public Library Access"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Allow others to view your collection and decks via your profile."})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v,onChange:B=>w(B.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm text-gray-400 block",children:"Avatar URL"}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"text",value:g,onChange:B=>y(B.target.value),placeholder:"https://example.com/avatar.jpg",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})}),i.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 overflow-hidden flex-shrink-0 border border-gray-600",children:g?i.jsx("img",{src:g,alt:"Avatar Preview",className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:"?"})})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm text-gray-400 block",children:"Bio"}),i.jsx("textarea",{value:f,onChange:B=>m(B.target.value),placeholder:"Tell us about yourself...",rows:3,className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]})]})]}),i.jsx("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg",children:i.jsx(GBe,{})}),i.jsxs("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg space-y-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Security & Login"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-200",children:"Email Address"}),i.jsx("p",{className:"text-sm text-gray-400",children:t?.email}),t&&!t.emailVerified&&i.jsx("span",{className:"text-[10px] bg-yellow-500/20 text-yellow-500 px-1.5 py-0.5 rounded-full border border-yellow-500/30 mt-1 inline-block",children:"Unverified"}),t&&t.emailVerified&&i.jsx("span",{className:"text-[10px] bg-green-500/20 text-green-500 px-1.5 py-0.5 rounded-full border border-green-500/30 mt-1 inline-block",children:"Verified"})]}),!t?.emailVerified&&i.jsx("button",{onClick:M,disabled:O,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium",children:O?"Sending...":"Send Verification"})]}),i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-200",children:"Password"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Change your account password"})]}),i.jsx("button",{onClick:E,disabled:C,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium disabled:opacity-50",children:C?"Sending...":"Reset Password"})]})]})]})]})},YBe=({isOpen:t,onClose:e})=>{const[r,n]=b.useState({});b.useEffect(()=>{if(t){const c=JSON.parse(localStorage.getItem("gemini_usage_stats")||"{}");n(c)}},[t]);const s=(c,u,h)=>{const f=K$(c),m=G$[f]||G$.flash;return u*m.input+h*m.output},a=()=>{window.confirm("Are you sure you want to reset all usage statistics?")&&(localStorage.removeItem("gemini_usage_stats"),n({}))};if(!t)return null;let o=0,l=0;return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-gray-950/80 backdrop-blur-md animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-3xl w-full max-w-4xl max-h-[90vh] flex flex-col shadow-2xl overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-center bg-gray-900/50",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[i.jsx("span",{className:"text-indigo-400",children:""})," AI Oracle Usage & Costs"]}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Independent tracking per API key and model tier."})]}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors p-2",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:Object.keys(r).length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-4xl mb-4",children:""}),i.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"No stats recorded yet"}),i.jsx("p",{className:"text-gray-500",children:"Usage is tracked locally as you use AI features."})]}):Object.entries(r).map(([c,u])=>i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h3",{className:"text-lg font-bold text-indigo-400 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-pulse"}),c.replace("_"," ")]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(u).map(([h,f])=>{const m=s(h,f.inputTokens,f.outputTokens);return o+=m,l+=f.success+f.failure+f[429],i.jsxs("div",{className:"bg-gray-800/40 border border-gray-700/50 rounded-2xl p-4 hover:border-indigo-500/30 transition-all group",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("span",{className:"font-mono text-sm text-indigo-300",children:h}),i.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 font-bold uppercase",children:K$(h)})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mb-4",children:[i.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-black",children:"Success"}),i.jsx("div",{className:"text-lg font-bold text-emerald-400",children:f.success})]}),i.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-black",children:"fail"}),i.jsx("div",{className:"text-lg font-bold text-red-400",children:f.failure})]}),i.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-black",children:"429"}),i.jsx("div",{className:"text-lg font-bold text-yellow-400",children:f[429]||0})]})]}),i.jsxs("div",{className:"flex justify-between items-end border-t border-white/5 pt-3",children:[i.jsxs("div",{className:"text-[10px] text-gray-500 leading-tight",children:["Tokens: ",f.inputTokens.toLocaleString()," in / ",f.outputTokens.toLocaleString()," out"]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:"Shadow Cost"}),i.jsxs("div",{className:"text-indigo-400 font-bold",children:["$",m.toLocaleString(void 0,{minimumFractionDigits:4,maximumFractionDigits:4})]})]})]})]},h)})})]},c))}),i.jsxs("div",{className:"p-6 bg-gray-950/50 border-t border-white/10 flex flex-col md:flex-row justify-between items-center gap-6",children:[i.jsxs("div",{className:"flex gap-8",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black tracking-widest",children:"Total Usage Estimate"}),i.jsxs("div",{className:"text-3xl font-black text-indigo-400",children:["$",o.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"border-l border-white/10 pl-8",children:[i.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black tracking-widest",children:"Total API Requests"}),i.jsx("div",{className:"text-3xl font-black text-white",children:l})]})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:a,className:"px-6 py-2 rounded-xl bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 font-bold transition-all text-sm",children:"Reset Stats"}),i.jsx("button",{onClick:e,className:"px-8 py-2 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white font-bold transition-all shadow-lg shadow-indigo-500/20",children:"Close"})]})]}),i.jsx("div",{className:"px-6 py-3 bg-indigo-600/10 text-center",children:i.jsx("p",{className:"text-[10px] text-indigo-300 uppercase font-black tracking-widest",children:" Costs are estimates based on standard Google AI Studio pricing tiers for context only."})})]})})},XBe=({isOpen:t,onClose:e})=>{const{userProfile:r,refreshUserProfile:n}=Cr(),[s,a]=b.useState(!1),[o,l]=b.useState(r?.settings?.helper?.name||""),[c,u]=b.useState(r?.settings?.helper?.type||""),[h,f]=b.useState(r?.settings?.helper?.personality||""),[m,g]=b.useState(!1),[y,v]=b.useState([]),[w,N]=b.useState(""),[k,C]=b.useState(!1),[I,O]=b.useState({});Ie.useEffect(()=>{if(t){const B=r?.settings?.helper||{};l(B.name||""),u(B.type||""),f(B.personality||""),a(!1),v([]),O({})}},[t,r]);const L=async()=>{g(!0);try{const S={...r?.settings||{},helper:{name:o,type:c,personality:h}};await He.updateUser(r.id,{settings:S}),await n(),e()}catch(B){console.error(B),alert("Failed to save helper.")}finally{g(!1)}},_=async()=>{a(!0),C(!0),O({}),v([]);try{const B=r?.settings?.geminiApiKey;if(!B)throw new Error("API Key missing");const S=await Nl.forgeHelperChat(B,[],{});v([{role:"model",content:S.aiResponse}])}catch(B){console.error(B),v([{role:"model",content:"Error connecting to the Forge. Please try again."}])}finally{C(!1)}},E=async()=>{if(!w.trim())return;const B=w;N(""),v(S=>[...S,{role:"user",content:B}]),C(!0);try{const S=r?.settings?.geminiApiKey,P=y.map(V=>({role:V.role,content:V.content}));P.push({role:"user",content:B});const R=await Nl.forgeHelperChat(S,P,I);O(R.updatedDraft||{}),v(V=>[...V,{role:"model",content:R.aiResponse}])}catch(S){console.error(S),v(P=>[...P,{role:"model",content:"Reviewing the blueprints... (Error, try again)"}])}finally{C(!1)}},M=()=>{I.name&&l(I.name),I.type&&u(I.type),I.personality&&f(I.personality),a(!1)};return t?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500",children:"Helper Settings"}),i.jsx("span",{className:"text-xs bg-gray-800 text-gray-500 px-2 py-1 rounded border border-gray-700",children:"Beta"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:s?i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-lg mb-4 text-sm text-gray-400 flex justify-between items-center",children:[i.jsx("span",{children:"Forging new identity..."}),i.jsx("button",{onClick:()=>a(!1),className:"text-white hover:underline",children:"Cancel"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-950/30 rounded-lg border border-gray-800",children:[y.map((B,S)=>i.jsx("div",{className:`flex ${B.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[85%] p-3 rounded-xl text-sm ${B.role==="user"?"bg-emerald-600 text-white":"bg-gray-800 text-gray-200"}`,children:B.content})},S)),k&&i.jsx("div",{className:"flex justify-start",children:i.jsx("span",{className:"animate-pulse text-emerald-500",children:"..."})})]}),(I.name||I.type)&&i.jsxs("div",{className:"bg-black/40 p-3 rounded border border-emerald-500/30 mb-4 flex gap-4 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Name:"})," ",i.jsx("span",{className:"text-white",children:I.name||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Type:"})," ",i.jsx("span",{className:"text-white",children:I.type||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Personality:"})," ",i.jsx("span",{className:"text-white",children:I.personality||"-"})]}),i.jsx("button",{onClick:M,className:"ml-auto bg-emerald-600 text-white px-3 py-1 rounded hover:bg-emerald-500",children:"Apply This"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:w,onChange:B=>N(B.target.value),onKeyDown:B=>B.key==="Enter"&&E(),placeholder:"Describe your helper...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-emerald-500 outline-none"}),i.jsx("button",{onClick:E,disabled:k,className:"bg-emerald-600 p-2 rounded-lg text-white",children:""})]})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex gap-4 items-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-teal-500 to-emerald-700 rounded-full flex items-center justify-center text-2xl shadow-lg",children:""}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:o||"Unknown Helper"}),i.jsx("p",{className:"text-emerald-400 text-sm font-medium",children:c||"Generic Construct"}),i.jsxs("p",{className:"text-gray-400 text-sm italic mt-1",children:['"',h||"Standard protocol.",'"']})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Name"}),i.jsx("input",{type:"text",value:o,onChange:B=>l(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),i.jsx("input",{type:"text",value:c,onChange:B=>u(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Personality"}),i.jsx("input",{type:"text",value:h,onChange:B=>f(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]})]})]}),i.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-800",children:[i.jsxs("button",{onClick:_,className:"text-emerald-400 hover:text-emerald-300 font-bold flex items-center gap-2 px-4 py-2 hover:bg-emerald-900/20 rounded-lg transition-colors",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Re-Forge Persona"]}),i.jsx("button",{onClick:L,disabled:m,className:"bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-6 rounded-lg transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m?"Saving...":"Save Changes"})]})]})})]})}):null},QBe=()=>{const{userProfile:t,refreshUserProfile:e}=Cr(),r=yn(),[n,s]=b.useState("grid"),[a,o]=b.useState("md"),[l,c]=b.useState(["","","",""]),[u,h]=b.useState(!1),[f,m]=b.useState(!1),[g,y]=b.useState(!1),[v,w]=b.useState(!1);b.useEffect(()=>{if(t?.settings)if(t.settings.viewMode&&s(t.settings.viewMode),t.settings.gridSize&&o(t.settings.gridSize),t.settings.geminiApiKeys){const k=[...t.settings.geminiApiKeys];for(;k.length<4;)k.push("");c(k.slice(0,4))}else t.settings.geminiApiKey&&c([t.settings.geminiApiKey,"","",""])},[t]);const N=async()=>{w(!0);try{const C={...t?.settings||{},geminiApiKey:l[0],geminiApiKeys:l,viewMode:n,gridSize:a};await He.updateUser(t.id,{settings:C}),await e(),alert("Preferences saved!")}catch(k){console.error("Failed to save preferences:",k),alert("Error saving preferences: "+k.message)}finally{w(!1)}};return i.jsxs("div",{className:"space-y-8 animate-fade-in max-w-4xl mx-auto p-4 md:p-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 mb-6",children:"App Preferences"}),i.jsxs("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Display & Interface"}),i.jsx("button",{onClick:N,disabled:v,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-lg shadow-lg shadow-indigo-500/20 transition-all ${v?"opacity-50 cursor-not-allowed":""}`,children:v?"Saving...":"Save Changes"})]}),i.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-xl p-4 md:p-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Organization Profile"}),i.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Current Mode: ",i.jsx("span",{className:"text-indigo-400 font-bold capitalize",children:t?.settings?.organization?.mode||"Default"})]}),i.jsx("p",{className:"text-xs text-gray-500 max-w-lg mb-4",children:"Your organization profile determines how your collection is sorted and grouped by default."})]}),i.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-lg text-indigo-400",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})]}),i.jsx("button",{onClick:()=>y(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors",children:"Configure Organization..."})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Default View "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:`flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border cursor-pointer transition-all ${n==="grid"?"bg-indigo-600/20 border-indigo-500 text-white":"bg-gray-900 border-gray-700 hover:border-gray-600 text-gray-400"}`,children:[i.jsx("input",{type:"radio",name:"viewMode",value:"grid",checked:n==="grid",onChange:()=>s("grid"),className:"sr-only"}),i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),i.jsx("span",{children:"Grid"})]}),i.jsxs("label",{className:`flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border cursor-pointer transition-all ${n==="table"?"bg-indigo-600/20 border-indigo-500 text-white":"bg-gray-900 border-gray-700 hover:border-gray-600 text-gray-400"}`,children:[i.jsx("input",{type:"radio",name:"viewMode",value:"table",checked:n==="table",onChange:()=>s("table"),className:"sr-only"}),i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),i.jsx("span",{children:"Table"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Grid Size"}),i.jsxs("select",{value:a,onChange:k=>o(k.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 w-full",children:[i.jsx("option",{value:"sm",children:"Small"}),i.jsx("option",{value:"md",children:"Medium"}),i.jsx("option",{value:"lg",children:"Large"})]})]})]}),i.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Guided Experience"}),i.jsx("button",{onClick:async()=>{if(window.confirm("This will restart the welcome tour. Continue?")){const k=t.settings?.geminiApiKeys,C=t.settings?.geminiApiKey;await He.updateUser(t.id,{settings:{...t.settings,onboarding_complete:!1,onboarding_step:0,helper:null,playstyle_profile:null,ai_enabled:!1,organization:{mode:"default",sortHierarchy:[],groupingPreference:"set"},geminiApiKeys:k,geminiApiKey:C}}),await e(),r("/onboarding")}},className:"w-full md:w-auto px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg border border-gray-600 transition-colors text-sm font-medium",children:"Reset Onboarding Tour"})]})]}),i.jsxs("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Integrations"}),i.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded border border-indigo-700/50",children:"Gemini"})]}),i.jsx("p",{className:"text-gray-400 text-sm",children:"To enable the AI Assistant and Deck Suggestions, you need a Google Gemini API Key. Keys are stored securely in your user profile."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Google Gemini API Keys (Up to 4)"}),i.jsx("button",{onClick:()=>h(!0),className:"text-xs bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-400 px-3 py-1 rounded-lg border border-indigo-500/30 transition-all font-bold",children:"View Usage & Costs"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:l.map((k,C)=>i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsxs("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:["Key ",C+1," ",C===0?"(Primary)":""]})}),i.jsx("input",{type:"password",value:k,onChange:I=>{const O=[...l];O[C]=I.target.value,c(O)},placeholder:`Enter Key ${C+1}...`,className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-sm"})]},C))}),i.jsxs("div",{className:"text-xs text-gray-500 flex justify-between bg-gray-900/50 p-3 rounded-lg border border-gray-700",children:[i.jsx("span",{children:"Multiple keys enable automatic rotation when rate limits (429) are hit on free tiers."}),i.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 hover:underline",children:"Get more keys "})]})]}),i.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Personalization"}),i.jsx("div",{className:"flex flex-wrap gap-4",children:i.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-3 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-5 py-3 rounded-xl transition-all hover:shadow-lg hover:border-emerald-500 group",children:[i.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center text-xl group-hover:scale-110 transition-transform",children:""}),i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-bold text-sm",children:"Helper Settings"}),i.jsx("div",{className:"text-xs text-gray-400",children:"Customize your AI companion"})]})]})})]})]}),i.jsx(YBe,{isOpen:u,onClose:()=>h(!1)}),i.jsx(XBe,{isOpen:f,onClose:()=>m(!1)}),i.jsx(eae,{isOpen:g,onClose:()=>y(!1),onComplete:()=>{y(!1),e()}})]})},JBe=({isOpen:t,onClose:e,mode:r="global"})=>{const{currentUser:n}=Cr(),{addToast:s}=Tn(),a=b.useRef(null),[o,l]=b.useState(null),[c,u]=b.useState(!1),[h,f]=b.useState("cards"),[m,g]=b.useState("merge"),[y,v]=b.useState({checkCollection:!0,addToCollection:!0}),w=k=>{const C=k.target.files[0];if(!C)return;const I=new FileReader;I.onload=O=>{try{const L=JSON.parse(O.target.result);if(L.deck&&L.cards)f("deck"),l(L);else if(L.cards&&L.decks)f("cards"),l(L);else if(L.collection&&typeof L.collection=="object"&&!Array.isArray(L.collection)){const _=Object.values(L.collection);f("cards"),l({cards:_})}else if(Array.isArray(L))f("cards"),l({cards:L});else if(L.cards&&Array.isArray(L.cards))f("cards"),l(L);else if(typeof L=="object"){const _=Object.values(L).find(E=>Array.isArray(E)&&E.length>0&&(E[0].name||E[0].id));_?(f("cards"),l({cards:_})):(console.error("Invalid JSON structure",L),s("Invalid JSON: Could not find card data","error"))}else s("Invalid JSON format","error")}catch(L){console.error(L),s("Failed to parse JSON","error")}},I.readAsText(C)},N=async()=>{if(o){u(!0);try{if(h==="cards")await bl.importBatch(n.uid,o.cards,m,o.decks),s(`Successfully imported ${o.cards.length} cards${o.decks?.length?` and ${o.decks.length} decks`:""}`,"success"),e();else if(h==="deck"){const k=await al.importDeck(n.uid,o.deck,o.cards,y);k.missingCards?.length>0?s(`Imported deck with ${k.missingCards.length} missing cards`,"warning"):s("Deck imported successfully","success"),e()}}catch(k){console.error(k),s("Import failed","error")}finally{u(!1)}}};return t?Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[i.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import Data"]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"p-6 space-y-6",children:o?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg border border-gray-700 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detected Content"}),i.jsx("p",{className:"text-white font-bold text-lg",children:h==="cards"?i.jsxs(i.Fragment,{children:["Collection (",o.cards?.length||0," cards)",o.decks?.length>0&&` + ${o.decks.length} Decks`]}):`Deck: ${o.deck?.name} (${o.cards?.length||0} cards)`})]}),i.jsx("button",{onClick:()=>l(null),className:"text-sm text-red-400 hover:text-red-300 underline",children:"Change File"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-700 pb-2",children:"Import Options"}),h==="cards"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-700 hover:bg-gray-700/50 cursor-pointer transition-colors",children:[i.jsx("input",{type:"radio",name:"replaceMode",checked:m==="merge",onChange:()=>g("merge"),className:"mt-1 bg-gray-900 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),i.jsxs("div",{children:[i.jsx("span",{className:"block text-white font-medium",children:"Merge (Recommended)"}),i.jsx("span",{className:"block text-gray-400 text-sm",children:"Add records to your existing collection. Updates if exists."})]})]}),i.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-red-900/30 hover:bg-red-900/10 cursor-pointer transition-colors",children:[i.jsx("input",{type:"radio",name:"replaceMode",checked:m==="replace",onChange:()=>g("replace"),className:"mt-1 bg-gray-900 border-gray-600 text-red-600 focus:ring-red-500"}),i.jsxs("div",{children:[i.jsx("span",{className:"block text-white font-medium",children:"Replace (Use with Caution)"}),i.jsxs("span",{className:"block text-red-300 text-sm",children:["Delete your ENTIRE current collection.",o.decks?.length>0?" Existing decks will also be replaced by those in the backup.":" Your decks will be preserved since this backup only contains cards."]})]})]})]}),h==="deck"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:y.checkCollection,onChange:k=>v(C=>({...C,checkCollection:k.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),i.jsx("span",{className:"text-gray-300",children:"Use existing unassigned copies from collection"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:y.addToCollection,onChange:k=>v(C=>({...C,addToCollection:k.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),i.jsx("span",{className:"text-gray-300",children:"Add missing cards to collection automatically"})]})]})]})]}):i.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 hover:bg-gray-700/30 transition-all group",onClick:()=>a.current?.click(),children:[i.jsx("svg",{className:"w-12 h-12 text-gray-500 group-hover:text-indigo-400 mb-4 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),i.jsx("p",{className:"text-gray-300 font-medium",children:"Click to select backup JSON"}),i.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Supports Collection exports and Deck exports"}),i.jsx("input",{type:"file",ref:a,onChange:w,accept:".json",className:"hidden"})]})}),i.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",disabled:c,children:"Cancel"}),i.jsx("button",{onClick:N,disabled:!o||c,className:`px-6 py-2 rounded-lg font-bold text-white transition-all shadow-lg ${c?"bg-indigo-800 cursor-wait":m==="replace"&&h==="cards"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:c?"Importing...":"Start Import"})]})]})}),document.body):null},ZBe=()=>{const[t,e]=b.useState(!1),[r,n]=b.useState(!1),[s,a]=b.useState(null),[o,l]=b.useState(!1),c=async()=>{try{const u=await He.get("/api/collection/export");let h=[],f=[];if(Array.isArray(u)?h=u:u&&typeof u=="object"&&(h=u.cards||[],f=u.decks||[]),h.length===0&&f.length===0){alert("No data to export.");return}const m=JSON.stringify({cards:h,decks:f,exported_at:new Date},null,2),g=new Blob([m],{type:"application/json"}),y=URL.createObjectURL(g),v=document.createElement("a");v.href=y,v.download=`mtg_library_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v)}catch(u){console.error("Export failed:",u),alert("Failed to export library.")}};return i.jsxs("div",{className:"space-y-8 animate-fade-in max-w-4xl mx-auto p-4 md:p-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 mb-6",children:"Data Management"}),i.jsxs("section",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg space-y-6",children:[i.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-yellow-500 font-bold mb-1 flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Note"]}),i.jsx("p",{className:"text-yellow-200/80 text-sm",children:"Backups include your collection data. Deck exports can also be done from individual deck pages."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex flex-col md:flex-row md:items-center justify-between gap-4 hover:bg-gray-700/30 transition-colors",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white font-medium",children:"Export Collection"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Download a JSON backup of your entire card collection."})]}),i.jsx("button",{onClick:c,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export JSON"})]}),i.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex flex-col md:flex-row md:items-center justify-between gap-4 hover:bg-gray-700/30 transition-colors",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white font-medium",children:"Import Data"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Restore from a backup or import cards. Supports Merge and Replace."})]}),i.jsx("button",{onClick:()=>e(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors border border-gray-600",children:"Import..."})]})]}),i.jsx("div",{className:"pt-6 border-t border-gray-700",children:i.jsxs("details",{className:"group border border-red-500/20 rounded-xl bg-red-500/5 open:bg-red-500/10 transition-colors",children:[i.jsxs("summary",{className:"flex items-center justify-between p-4 cursor-pointer select-none",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-red-500",children:""}),i.jsx("h3",{className:"text-lg font-bold text-red-500 uppercase tracking-wide",children:"Danger Zone"})]}),i.jsx("div",{className:"text-red-500 transform transition-transform group-open:rotate-180",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),i.jsxs("div",{className:"p-4 pt-0 border-t border-red-500/10 mt-2 space-y-4",children:[i.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-white",children:"Clear Wishlist"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Permanently delete all items from your wishlist."})]}),i.jsx("button",{onClick:()=>{a("wishlist"),n(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Clear Wishlist"})]}),i.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-white",children:"Delete All Decks"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Delete all your decks. Cards will remain in your collection."})]}),i.jsx("button",{onClick:()=>{a("decks"),n(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Decks"})]}),i.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-white",children:"Delete Collection"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Delete all cards. This will empty your decks."})]}),i.jsx("button",{onClick:()=>{a("collection"),n(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Collection"})]}),i.jsxs("div",{className:"p-4 bg-red-900/20 rounded-lg flex flex-col md:flex-row md:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-white",children:"Delete Everything"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Wipe your entire library: decks, cards, and wishlist."})]}),i.jsx("button",{onClick:()=>{a("all"),n(!0)},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-bold transition-colors shadow-lg shadow-red-900/20",children:"Delete Everything"})]})]})]})})]}),i.jsx(JBe,{isOpen:t,onClose:()=>e(!1),mode:"global"}),i.jsx(ise,{isOpen:r,onClose:()=>n(!1),targetName:s?s.toUpperCase():"",title:s==="all"?"Delete Everything?":s==="decks"?"Delete All Decks?":s==="collection"?"Delete Collection?":"Clear Wishlist?",message:s==="all"?"This will permanently delete ALL data associated with your account. This cannot be undone.":s==="decks"?"This will delete all your deck lists.":s==="collection"?"This will delete all cards in your collection.":"This will remove all cards from your wishlist.",onConfirm:async()=>{l(!0);try{await He.delete("/api/users/me/data",{target:s}),window.location.reload()}catch(u){console.error(u),alert("Failed to delete data.")}finally{l(!1),n(!1)}}})]})},Xae=({isOpen:t,onClose:e})=>t?Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),i.jsx("p",{className:"text-gray-400 text-xs",children:"Everything you need to know about Pods & Permissions."})]})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),i.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',i.jsx("strong",{children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),i.jsx("div",{className:"bg-blue-900/10 border border-blue-500/20 p-4 rounded-xl",children:i.jsx("p",{className:"text-blue-200 text-sm font-medium",children:" Pro Tip: Only add people you actually know and trust to your Pod."})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("span",{className:"text-indigo-400 font-black uppercase text-xs tracking-wider",children:"Default"}),i.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Viewer"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," View Private Decks"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," View Collection"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," Download/Clone Decks"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-red-400",children:""})," Edit Decks"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-red-400",children:""})," Change Settings"]})]})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("span",{className:"text-purple-400 font-black uppercase text-xs tracking-wider",children:"Advanced"}),i.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Editor"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," Everything in Viewer"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," ",i.jsx("strong",{children:"Add/Remove Cards"})," from Decks"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-green-400",children:""})," Add Cards to Collection"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-red-400",children:""})," Delete Decks"]}),i.jsxs("li",{className:"flex gap-2",children:[i.jsx("span",{className:"text-red-400",children:""})," Manage Account"]})]})]})]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),i.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),i.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-sm text-gray-400 border border-gray-700",children:[i.jsx("strong",{children:"How to use:"}),` In the Deck Builder, open the "Sources" dropdown and select a friend's collection to see their cards alongside yours.`]})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-red-500/20 text-red-400 flex items-center justify-center text-xs",children:"4"}),"Safety & Revoking"]}),i.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["You are always in control. You can revoke access at any time from this menu or the Settings page. Revoking access is ",i.jsx("strong",{children:"immediate"}),". The other user will be disconnected from your session instantly."]}),i.jsx("div",{className:"mt-4 flex gap-4",children:i.jsxs("div",{className:"flex-1 p-3 bg-red-900/10 border border-red-500/10 rounded-lg",children:[i.jsx("h5",{className:"font-bold text-red-400 text-xs uppercase mb-1",children:"They Cannot"}),i.jsx("p",{className:"text-xs text-gray-400",children:"Delete your account, change your password, or permanently delete your cards/decks."})]})})]})]}),i.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors font-bold text-sm shadow-lg",children:"Got it, thanks!"})})]})]}),document.body):null,eFe=({isOpen:t,onClose:e,connection:r})=>{const{addToast:n}=Tn(),[s,a]=b.useState([]),[o,l]=b.useState(!0),[c,u]=b.useState(!1),[h,f]=b.useState(!1);b.useEffect(()=>{t&&r&&(async()=>{l(!0);try{const w=await Ka.fetchPermissions(),N=(Array.isArray(w)?w:[]).filter(k=>k.grantee_id===r.friend.id);a(N)}catch(w){console.error(w),n("Failed to load permissions","error")}finally{l(!1)}})()},[t,r]);const m=async v=>{u(!0);try{await Ka.grantPermission(r.friend.id,v,null),n(`Global ${v} access granted`,"success");const w=await Ka.fetchPermissions(),N=(Array.isArray(w)?w:[]).filter(k=>k.grantee_id===r.friend.id);a(N)}catch(w){console.error(w),n("Failed to update permission","error")}finally{u(!1)}},g=async v=>{try{await Ka.revokePermission(v),n("Permission revoked","info"),a(w=>w.filter(N=>N.id!==v))}catch(w){console.error(w),n("Failed to revoke permission","error")}};if(!t||!r)return null;const y=s.find(v=>v.target_deck_id===null);return Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-2xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[i.jsx("div",{className:"p-8 border-b border-white/5 bg-gradient-to-r from-gray-900 to-gray-950 flex justify-between items-start",children:i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-black text-3xl shadow-lg ring-4 ring-gray-900",children:r.friend.username?.[0]?.toUpperCase()}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:r.friend.username}),i.jsx("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-xs mt-1",children:"Manage Permissions"})]})]})}),i.jsxs("div",{className:"p-8 space-y-8 overflow-y-auto custom-scrollbar",children:[i.jsx("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl overflow-hidden",children:i.jsx(dy,{children:({open:v})=>i.jsxs(i.Fragment,{children:[i.jsxs(dy.Button,{className:"flex justify-between w-full px-4 py-3 text-sm font-bold text-indigo-300 hover:text-indigo-200 transition-colors uppercase tracking-wider text-left",children:[i.jsx("span",{children:"What does Linking Accounts do?"}),i.jsx(I5e,{className:`${v?"transform rotate-180":""} w-5 h-5 text-indigo-400`})]}),i.jsxs(dy.Panel,{className:"px-4 pb-4 text-sm text-indigo-200/80 leading-relaxed space-y-2",children:[i.jsx("p",{children:"Linking accounts allows you to share your Magic: The Gathering experience with trusted friends."}),i.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-white",children:"Sharing Decks:"})," Friends can view your private decks to offer advice or clone them."]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-white",children:"Shared Collection:"})," Combine your card pools visually to build decks together."]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-white",children:"Deck Editing:"})," If granted ",i.jsx("strong",{children:"Editor"})," access, friends can actively tweak your deck lists (add/remove cards)."]})]}),i.jsx("p",{className:"mt-2 text-xs italic opacity-70",children:"Note: Friends can NEVER delete your decks or account, regardless of permission level."}),i.jsx("div",{className:"pt-2 mt-2 border-t border-indigo-500/20",children:i.jsxs("a",{href:"#",className:"flex items-center gap-2 text-indigo-400 hover:text-white font-bold transition-colors",onClick:w=>{w.preventDefault(),f(!0)},children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Read the Full Setup Guide"]})})]})]})})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Global Access Level"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("button",{onClick:()=>m("viewer"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${y?.permission_level==="viewer"?"bg-indigo-600/10 border-indigo-500 shadow-indigo-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:`text-lg font-black ${y?.permission_level==="viewer"?"text-indigo-400":"text-white"}`,children:"Viewer"}),y?.permission_level==="viewer"&&i.jsx("span",{className:"bg-indigo-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),i.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Read-only access. Can view your ",i.jsx("strong",{children:"private decks"}),", ",i.jsx("strong",{children:"binders"}),", and ",i.jsx("strong",{children:"collection"}),". Cannot make changes."]})]}),i.jsxs("button",{onClick:()=>m("editor"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${y?.permission_level==="editor"?"bg-purple-600/10 border-purple-500 shadow-purple-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:`text-lg font-black ${y?.permission_level==="editor"?"text-purple-400":"text-white"}`,children:"Editor"}),y?.permission_level==="editor"&&i.jsx("span",{className:"bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),i.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Full collaboration. Can ",i.jsx("strong",{children:"edit your decks"}),", add cards to your ",i.jsx("strong",{children:"collection"}),", and view everything."]})]})]}),y&&i.jsx("div",{className:"mt-6 flex justify-center",children:i.jsxs("button",{onClick:()=>g(y.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Revoke All Access"]})})]}),i.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Specific Deck Overrides"}),i.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto custom-scrollbar bg-gray-950/30 rounded-xl border border-white/5 p-2",children:s.filter(v=>v.target_deck_id).length>0?s.filter(v=>v.target_deck_id).map(v=>i.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded bg-gray-900 flex items-center justify-center text-gray-500",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsxs("div",{children:[i.jsxs("span",{className:"text-sm font-bold text-gray-200 block",children:["Deck #",v.target_deck_id.slice(0,8),"..."]}),i.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wider",children:[v.permission_level," Access"]})]})]}),i.jsx("button",{onClick:()=>g(v.id),className:"text-gray-500 hover:text-red-400 p-2 hover:bg-white/5 rounded-lg transition-colors",title:"Revoke Permission",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},v.id)):i.jsx("div",{className:"text-center py-6 text-gray-500",children:i.jsx("p",{className:"text-xs italic",children:"No specific deck permissions granted."})})})]})]}),i.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-6 py-3 bg-white text-gray-900 hover:bg-gray-200 rounded-xl transition-colors font-bold text-sm shadow-xl",children:"Done"})})]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
            `}}),i.jsx(Xae,{isOpen:h,onClose:()=>f(!1)})]}),document.body)},tFe=({isOpen:t,onClose:e,onSuccess:r})=>{const{updateProfileFields:n}=Cr(),[s,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState(null),h=async f=>{if(f.preventDefault(),u(null),!s.trim()){u("Username is required.");return}l(!0);try{await n({username:s.trim()}),r(),e()}catch(m){console.error(m),u("Failed to update username. It might be taken.")}finally{l(!1)}};return t?Kn.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm"}),i.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md relative z-10 shadow-2xl p-8 animate-fade-in-up",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Identify Yourself"}),i.jsx("p",{className:"text-gray-400 mb-6",children:"To connect with friends and share decks, you need to set a unique username so others can find you."}),i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Username"}),i.jsx("input",{type:"text",value:s,onChange:f=>a(f.target.value),placeholder:"e.g. Planeswalker99",className:"w-full bg-gray-950 border border-gray-800 text-white px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-600 focus:border-transparent outline-none transition-all",autoFocus:!0})]}),c&&i.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:c}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:o,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-xl shadow-lg shadow-indigo-600/20 transition-all disabled:opacity-50 flex items-center gap-2",children:o?"Saving...":"Save & Continue"})]})]})]})]}),document.body):null},rFe=({isOpen:t,onClose:e,referralUrl:r,username:n})=>{if(!t)return null;const s=()=>{const a=document.getElementById("qr-gen"),o=new XMLSerializer().serializeToString(a),l=document.createElement("canvas"),c=l.getContext("2d"),u=new Image;u.onload=()=>{l.width=u.width,l.height=u.height,c.drawImage(u,0,0);const h=l.toDataURL("image/png"),f=document.createElement("a");f.download=`MTG-Forge-Referral-${n}.png`,f.href=`${h}`,f.click()},u.src="data:image/svg+xml;base64,"+btoa(o)};return i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-[#1a1c23] border border-indigo-500/30 w-full max-w-sm rounded-3xl p-8 shadow-2xl animate-fade-in pointer-events-auto",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white p-2 transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsxs("div",{className:"text-center space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-black text-white mb-2",children:"Share The Forge"}),i.jsxs("p",{className:"text-sm text-gray-400",children:["Scan this code to join ",n,"'s Pod and start brewing together."]})]}),i.jsx("div",{className:"bg-white p-4 rounded-3xl inline-block shadow-inner mx-auto",children:i.jsx(G_,{id:"qr-gen",value:r,size:200,level:"H",includeMargin:!0,imageSettings:{src:"/logo.png",x:void 0,y:void 0,height:40,width:40,excavate:!0}})}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("button",{onClick:s,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all shadow-lg flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download QR Code"]}),i.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:"Supports iOS & Android Camera Apps"})]})]})]})]})},nFe=()=>{const{user:t,userProfile:e}=Cr(),[r,n]=b.useState([]),[s,a]=b.useState(!0),[o,l]=b.useState(null),[c,u]=b.useState(""),[h,f]=b.useState("pod"),[m,g]=b.useState(!1),[y,v]=b.useState(null),[w,N]=b.useState(!1),k=`https://mtg-forge.com/?ref=${e?.username||t.uid}`,[C,I]=b.useState(null),[O,L]=b.useState(!1),[_,E]=b.useState(!1),[M,B]=b.useState(!1),S=async()=>{a(!0);try{const Z=await Ka.fetchRelationships();n(Z)}catch(Z){console.error(Z),l("Failed to load connections.")}finally{a(!1)}};b.useEffect(()=>{S()},[]);const P=async Z=>{if(Z.preventDefault(),!e?.username){B(!0);return}g(!0),v(null);try{await Ka.sendRequest(c,h),v({type:"success",text:`Invite sent to ${c}!`}),u(""),S()}catch(se){v({type:"error",text:se.response?.data?.error||"Failed to send request."})}finally{g(!1)}},R=async(Z,se)=>{if(!e?.username){B(!0);return}try{await Ka.respondToRequest(Z,se),S()}catch(X){console.error(X),l("Failed to update request.")}},V=r.filter(Z=>Z.status==="pending"),ee=V.filter(Z=>Z.direction==="incoming"),G=V.filter(Z=>Z.direction==="outgoing"),J=r.filter(Z=>Z.status==="accepted");return i.jsxs("div",{className:"space-y-8 animate-fade-in relative z-0",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 border-b border-gray-800 pb-6 relative",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 mb-2",children:"My Pod"}),i.jsx("p",{className:"text-gray-400 text-sm max-w-xl leading-relaxed",children:"Connect with trusted friends to view their decks, share collections, and collaborate on brews."})]}),i.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors text-sm font-bold bg-indigo-900/20 hover:bg-indigo-900/40 px-4 py-2 rounded-lg border border-indigo-500/30",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"How it Works"]})]}),s?i.jsx("div",{className:"flex justify-center py-20",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):J.length===0&&ee.length===0&&G.length===0?i.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-gray-800 p-8 md:p-12 text-center animate-fade-in-up shadow-2xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),i.jsxs("div",{className:"max-w-md mx-auto relative z-10",children:[i.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 text-indigo-400 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl ring-1 ring-inset ring-indigo-500/20",children:i.jsx("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),i.jsx("h2",{className:"text-2xl font-black text-white mb-3",children:"Start Your Pod"}),i.jsx("p",{className:"text-gray-400 mb-8 leading-relaxed",children:"Magic is better with friends. Invite someone to your Pod to start sharing decks and combining collections."}),i.jsxs("form",{onSubmit:P,className:"space-y-6",children:[i.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl max-w-xs mx-auto",children:[i.jsx("button",{type:"button",onClick:()=>f("pod"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${h==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod Invite"}),i.jsx("button",{type:"button",onClick:()=>f("friend"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${h==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Social Friend"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{type:"email",required:!0,placeholder:"Enter friend's email address...",value:c,onChange:Z=>u(Z.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-5 py-4 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-center placeholder-gray-600 shadow-inner"}),i.jsx("button",{type:"submit",disabled:m,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg shadow-indigo-900/20 transform hover:-translate-y-1",children:m?"Sending Invite...":h==="pod"?"Send Pod Invitation":"Send Friend Invite"})]}),y&&i.jsx("div",{className:`text-sm font-medium mt-2 ${y.type==="success"?"text-green-400":"text-red-400"}`,children:y.text})]})]})]}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-gray-900/30 rounded-3xl border border-gray-800 p-8 shadow-xl",children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-3",children:[i.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-2 rounded-lg shadow-lg",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Active Connections"]}),J.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:J.map(Z=>i.jsxs("div",{className:"relative group bg-gray-800/40 p-5 rounded-2xl border border-gray-700/50 hover:border-indigo-500/50 transition-all duration-300 hover:bg-gray-800/60 hover:shadow-xl hover:shadow-indigo-900/10",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center text-white font-black text-2xl shadow-lg ring-2 ring-gray-900",children:Z.friend.username?.[0]?.toUpperCase()||"?"}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold text-white text-lg truncate group-hover:text-indigo-300 transition-colors uppercase",children:Z.friend.username}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`text-[10px] uppercase tracking-widest font-black px-2 py-0.5 rounded ${Z.type==="friend"?"bg-purple-900/30 text-purple-400 border border-purple-800/50":"bg-indigo-900/30 text-indigo-400 border border-indigo-800/50"}`,children:Z.type==="friend"?"Friend":"Pod"}),i.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:Z.type==="friend"?"Social Connect":"Full Access"})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{I(Z),L(!0)},className:"flex-1 bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white py-2 rounded-lg text-xs font-bold transition-colors uppercase tracking-wider border border-white/5",children:"Manage"}),i.jsx("button",{onClick:async()=>{if(window.confirm(`Are you sure you want to remove ${Z.friend.username} from your Pod?`))try{await Ka.deleteRelationship(Z.id),n(se=>se.filter(X=>X.id!==Z.id))}catch(se){console.error(se),alert("Failed to remove")}},className:"px-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 rounded-lg transition-colors border border-red-500/10",title:"Remove Connection",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},Z.id))}):i.jsx("div",{className:"text-center py-12 text-gray-500 italic opacity-50",children:"No active connections. Check your pending requests!"})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6",children:[i.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Add to Pod"}),i.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl mb-4",children:[i.jsx("button",{type:"button",onClick:()=>f("pod"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${h==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod"}),i.jsx("button",{type:"button",onClick:()=>f("friend"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${h==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Friend"})]}),i.jsxs("form",{onSubmit:P,className:"space-y-3",children:[i.jsx("input",{type:"email",required:!0,placeholder:"friend@example.com",value:c,onChange:Z=>u(Z.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-4 py-3 rounded-xl focus:outline-none focus:border-indigo-500 text-sm transition-all"}),i.jsxs("button",{type:"submit",disabled:m,className:`w-full ${h==="friend"?"bg-purple-600 hover:bg-purple-500":"bg-indigo-600 hover:bg-indigo-500"} text-white font-bold py-3 px-4 rounded-xl transition-all shadow-lg text-sm flex items-center justify-center gap-2`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Invite ",h==="pod"?"to Pod":"as Friend"]}),y&&i.jsx("div",{className:`text-xs text-center ${y.type==="success"?"text-green-400":"text-red-400"}`,children:y.text})]})]}),i.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/10 to-purple-900/10 rounded-2xl border border-indigo-500/20 p-6 space-y-4",children:[i.jsx("h3",{className:"text-sm font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 uppercase tracking-wider mb-2",children:"Referral & Sharing"}),i.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Spread the word about MTG Forge. Anyone who joins using your unique link will be automatically connected as a Social Friend."}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded-xl p-3 flex items-center gap-2",children:[i.jsxs("span",{className:"text-[10px] text-indigo-400 font-mono truncate flex-1 leading-none select-all pt-1",children:["https://mtg-forge.com/?ref=$",e?.username||t.uid]}),i.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://mtg-forge.com/?ref=${e?.username||t.uid}`),alert("Referral link copied!")},className:"p-1.5 hover:bg-indigo-500/20 text-indigo-400 rounded-lg transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("button",{onClick:()=>window.open(`mailto:?subject=Join me on MTG Forge&body=Hey, I've been using this awesome MTG collection manager and deck builder. Check it out: https://mtg-forge.com/?ref=${e?.username||t.uid}`),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),i.jsxs("button",{onClick:()=>N(!0),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1l-3 3h2v5h2V8h2l-3-3V4h-2zm-6 8v1h12v-1H6zm0 3v1h12v-1H6z"})}),"QR Code"]})]})]})]}),i.jsx(rFe,{isOpen:w,onClose:()=>N(!1),referralUrl:k,username:e?.username||"Hunter"}),ee.length>0&&i.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/30 to-purple-900/30 rounded-2xl border border-indigo-500/30 p-6 animate-pulse-border",children:[i.jsxs("h3",{className:"text-sm font-bold text-indigo-300 uppercase tracking-wider mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"relative flex h-3 w-3",children:[i.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),i.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-indigo-500"})]}),"Pending Requests"]}),i.jsx("div",{className:"space-y-3",children:ee.map(Z=>i.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-indigo-500/20 shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:Z.friend.username?.[0]?.toUpperCase()}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-bold text-white text-sm truncate",children:Z.friend.username}),i.jsx("div",{className:"text-xs text-indigo-300 truncate",children:"wants to join your Pod"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>R(Z.id,"accepted"),className:"flex-1 bg-indigo-500 hover:bg-indigo-400 text-white text-xs font-bold py-2 rounded-lg transition-colors shadow-md",children:"Accept"}),i.jsx("button",{onClick:()=>R(Z.id,"blocked"),className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-400 text-xs font-bold py-2 rounded-lg transition-colors border border-gray-700",children:"Decline"})]})]},Z.id))})]}),G.length>0&&i.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6 opacity-60 hover:opacity-100 transition-opacity",children:[i.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Pending Invites"}),i.jsx("div",{className:"space-y-3",children:G.map(Z=>i.jsxs("div",{className:"flex items-center gap-3 text-sm bg-gray-900 p-3 rounded-lg border border-gray-800",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 animate-pulse"}),i.jsx("span",{className:"text-gray-300 truncate flex-1",children:Z.friend.email})]},Z.id))})]})]})]}),i.jsx(eFe,{isOpen:O,onClose:()=>L(!1),connection:C,currentUser:t}),i.jsx(tFe,{isOpen:M,onClose:()=>B(!1),onSuccess:()=>{}}),i.jsx(Xae,{isOpen:_,onClose:()=>E(!1)})]})},Qae=({players:t,logs:e})=>{const r=b.useMemo(()=>{if(!e||e.length===0)return null;const k=Math.max(...e.map(S=>S.metadata?.turn||S.turn||0),0)+1,C=["#6366f1","#ec4899","#22c55e","#eab308","#ef4444","#3b82f6"],I={};t.forEach((S,P)=>{I[S.id]=C[P%C.length]});const O={0:{}};t.forEach(S=>O[0][S.id]=40);let L={};t.forEach(S=>L[S.id]=40),[...e].sort((S,P)=>new Date(S.created_at||S.timestamp)-new Date(P.created_at||P.timestamp)).forEach(S=>{if(S.type==="life"||S.action_type==="life"){const R=S.playerId||S.actor_participant_id;if(R){const V=S.currentLife??S.metadata?.currentLife;V!==void 0?L[R]=V:L[R]=(L[R]||40)+(S.change||S.value||0)}}const P=S.turn||S.metadata?.turn||1;O[P]||(O[P]={}),t.forEach(R=>{O[P][R.id]=L[R.id]})});const E={};t.forEach(S=>E[S.id]=[]);let M=0,B=45;return Object.keys(O).forEach(S=>{const P=parseInt(S);t.forEach(R=>{let V=O[P][R.id];V!==void 0&&(E[R.id].push({x:P,y:V}),V>B&&(B=V),V<M&&(M=V))})}),t.forEach(S=>{const P=E[S.id];P.length===0&&P.push({x:0,y:40}),P[P.length-1].x<k&&P.push({x:k,y:L[S.id]});const V=L[S.id];V>B&&(B=V),V<M&&(M=V)}),{playerPoints:E,minLife:M,maxLife:B,maxTurn:k,playerColorMap:I,finalLife:L}},[t,e]);if(!r)return null;const{playerPoints:n,minLife:s,maxLife:a,maxTurn:o,playerColorMap:l,finalLife:c}=r,u=300,h=150,f={top:10,right:10,bottom:20,left:25},m=u-f.left-f.right,g=h-f.top-f.bottom,y=k=>f.left+k/(o-1||1)*m,v=k=>{const C=a-s||1;return f.top+g-(k-s)/C*g},w=Array.from({length:o},(k,C)=>C),N=(()=>{const k=[],I=a-s>20?10:5;for(let O=Math.ceil(s/I)*I;O<=a;O+=I)k.push(O);return k.includes(s)||k.unshift(s),k.includes(a)||k.push(a),[...new Set(k)].sort((O,L)=>O-L)})();return i.jsxs("div",{className:"w-full h-full flex flex-col relative",children:[i.jsx("div",{className:"flex flex-wrap gap-3 absolute top-2 right-2 z-10 pointer-events-none",children:t.map(k=>i.jsxs("div",{className:"flex items-center gap-1.5 bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-white/10 shadow-sm",children:[i.jsx("div",{className:"w-2 h-2 rounded-full shadow-[0_0_5px]",style:{backgroundColor:l[k.id],boxShadow:`0 0 5px ${l[k.id]}`}}),i.jsxs("span",{className:"text-[10px] text-gray-200 font-bold leading-none",children:[k.name,": ",i.jsx("span",{className:"text-white",children:c[k.id]??"?"})]})]},k.id))}),i.jsxs("svg",{viewBox:`0 0 ${u} ${h}`,className:"w-full h-full overflow-visible font-mono select-none",children:[i.jsxs("g",{className:"opacity-20",children:[N.map(k=>i.jsx("line",{x1:f.left,y1:v(k),x2:u-f.right,y2:v(k),stroke:"currentColor",strokeWidth:"0.5",strokeDasharray:"2",className:"text-gray-500"},`y-${k}`)),w.map(k=>i.jsx("line",{x1:y(k),y1:f.top,x2:y(k),y2:h-f.bottom,stroke:"currentColor",strokeWidth:"0.5",className:"text-gray-500"},`x-${k}`))]}),i.jsxs("g",{className:"text-[8px] fill-gray-500 font-medium",children:[N.map(k=>i.jsx("text",{x:f.left-4,y:v(k),dy:"0.3em",textAnchor:"end",children:k},`yl-${k}`)),w.map(k=>i.jsx("text",{x:y(k),y:h-f.bottom+10,textAnchor:"middle",children:k},`xl-${k}`))]}),t.map(k=>{const C=n[k.id];if(!C||C.length===0)return null;const I=C.map((O,L)=>`${L===0?"M":"L"} ${y(O.x)} ${v(O.y)}`).join(" ");return i.jsxs("g",{children:[i.jsx("path",{d:I,fill:"none",stroke:l[k.id],strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"drop-shadow-md vector-effect-non-scaling-stroke"}),C.map((O,L)=>i.jsx("circle",{cx:y(O.x),cy:v(O.y),r:"1.5",fill:l[k.id],stroke:"black",strokeWidth:"0.5"},L))]},k.id)})]})]})},FA=({label:t,value:e,subtext:r,icon:n,color:s="text-gray-400"})=>i.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:t}),i.jsx("div",{className:"text-2xl font-black text-white",children:e}),r&&i.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:r})]}),n&&i.jsx(n,{className:`w-8 h-8 opacity-20 ${s}`})]}),sFe=({isOpen:t,onClose:e,match:r,logs:n})=>{if(!t||!r)return null;const s=b.useMemo(()=>{if(!n||n.length===0)return null;const o=r.my_participant_id;let l=0,c=0;const u={poison:0,energy:0,experience:0},h={};n.forEach(g=>{const y=g.metadata?.turn||0;if(y>c&&(c=y),g.action_type==="life"&&(g.actor_participant_id===o||g.playerId===o)){const v=g.value||g.change;if(v<0){const w=Math.abs(v);l+=w,h[y]=(h[y]||0)+w}}g.action_type==="counter"&&(g.actor_participant_id===o||g.playerId===o)&&u[g.counterType]!==void 0&&(u[g.counterType]=g.newValue)});const f=c>0?(l/c).toFixed(1):"0.0",m=Math.max(0,...Object.values(h));return{avgDamageTaken:f,maxDamageInTurn:m,turns:c,finalResources:u}},[r,n]),a=[{id:r.my_participant_id,name:"Me"},...(r.opponents||[]).map(o=>({id:o.participant_id,name:o.name}))];return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl h-[90vh] shadow-2xl overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-gradient-to-r from-gray-900 to-indigo-950/30",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center gap-3",children:[i.jsx(UI,{className:"w-6 h-6 text-indigo-500"}),"Match Report"]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-gray-400 mt-2",children:[i.jsx("span",{children:wa(new Date(r.ended_at),"PPP p")}),i.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),i.jsx("span",{children:r.duration_seconds?`${Math.floor(r.duration_seconds/60)}m`:"Unknown duration"})]})]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:i.jsx(vu,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[i.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/5 p-6 min-h-[400px] flex flex-col relative",children:[i.jsx("div",{className:"absolute top-4 left-4 z-10",children:i.jsx("h3",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:"Life History"})}),!n||n.length===0?i.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 italic",children:"No combat data available"}):i.jsx(Qae,{players:a,logs:n})]}),s&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsx(FA,{label:"Avg Dmg Taken / Turn",value:s.avgDamageTaken,icon:Nf,color:"text-red-500"}),i.jsx(FA,{label:"Most Dmg / Turn",value:s.maxDamageInTurn,icon:zy,color:"text-orange-500"}),i.jsx(FA,{label:"Turns Played",value:s.turns,icon:UI,color:"text-blue-500"}),i.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"My Resources"}),i.jsxs("div",{className:"flex items-center gap-3",children:[s.finalResources.poison>0&&i.jsxs("div",{className:"flex items-center gap-1 text-green-500",title:"Poison",children:[i.jsx(zy,{className:"w-4 h-4"})," ",i.jsx("span",{className:"font-bold",children:s.finalResources.poison})]}),s.finalResources.energy>0&&i.jsxs("div",{className:"flex items-center gap-1 text-yellow-400",title:"Energy",children:[i.jsx(ud,{className:"w-4 h-4"})," ",i.jsx("span",{className:"font-bold",children:s.finalResources.energy})]}),s.finalResources.experience>0&&i.jsxs("div",{className:"flex items-center gap-1 text-blue-400",title:"Experience",children:[i.jsx(V_,{className:"w-4 h-4"})," ",i.jsx("span",{className:"font-bold",children:s.finalResources.experience})]}),!s.finalResources.poison&&!s.finalResources.energy&&!s.finalResources.experience&&i.jsx("span",{className:"text-gray-500 text-xs italic",children:"None recorded"})]})]})]})]})]})})},iFe=()=>{const{userProfile:t}=Cr(),[e,r]=b.useState([]),[n,s]=b.useState(!0),[a,o]=b.useState(null),[l,c]=b.useState({}),[u,h]=b.useState(!1),[f,m]=b.useState(null);b.useEffect(()=>{t?.id&&g()},[t]);const g=async()=>{try{s(!0);const I=await He.get(`/api/matches/user/${t.id}`);r(I||[])}catch(I){console.error("Failed to load match history:",I),o("Failed to load match history.")}finally{s(!1)}},y=async I=>{if(window.confirm("Are you sure you want to delete this match record?"))try{await He.delete(`/api/matches/${I}`),r(O=>O.filter(L=>L.match_id!==I))}catch(O){console.error(O),alert("Failed to delete match")}},v=async()=>{if(window.confirm("Are you sure you want to clear ALL match history? This cannot be undone."))try{await He.delete(`/api/matches/user/${t.id}`),r([])}catch(I){console.error(I),alert("Failed to clear history")}},w=async I=>{const O=I.match_id;if(m(I),!l[O]){h(!0);try{const L=await He.get(`/api/matches/${O}/logs`);c(_=>({..._,[O]:L}))}catch(L){console.error("Failed to fetch logs:",L)}finally{h(!1)}}};if(n)return i.jsx("div",{className:"flex justify-center p-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})});if(a)return i.jsx("div",{className:"text-center p-8 text-red-400 bg-red-900/10 rounded-xl border border-red-500/20",children:a});if(e.length===0)return i.jsxs("div",{className:"text-center p-12 bg-gray-900 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"bg-gray-800 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(ra,{className:"w-8 h-8 text-gray-600"})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Matches Yet"}),i.jsx("p",{className:"text-gray-400",children:"Join a Live Session to track your games!"})]});const N=e.length,k=e.filter(I=>I.placement===1).length,C=Math.round(k/N*100);return i.jsxs("div",{className:"space-y-8 animate-fade-in",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Games"}),i.jsx("div",{className:"text-3xl font-black text-white",children:N})]}),i.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Wins"}),i.jsx("div",{className:"text-3xl font-black text-indigo-400",children:k})]}),i.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Win Rate"}),i.jsxs("div",{className:"text-3xl font-black text-green-400",children:[C,"%"]})]}),i.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Recent Activity"}),i.jsx("div",{className:"text-sm font-medium text-gray-300 mt-1",children:e[0]?wa(new Date(e[0].ended_at),"MMM d"):"-"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"Recent Matches"}),e.length>0&&i.jsxs("button",{onClick:v,className:"text-red-400 hover:text-red-300 text-xs font-bold uppercase tracking-wider flex items-center gap-2 px-3 py-2 hover:bg-red-500/10 rounded transition-colors",children:[i.jsx(Pre,{className:"w-4 h-4"}),"Clear History"]})]}),i.jsx("div",{className:"grid gap-3",children:e.map(I=>{const O=I.placement===1,L=new Date(I.ended_at),_=Math.floor((new Date(I.ended_at)-new Date(I.started_at))/1e3/60);return[I.my_participant_id,...(I.opponents||[]).map(E=>({id:E.participant_id,name:E.name}))],i.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden group",children:i.jsxs("div",{className:"p-4 flex flex-col md:flex-row items-start md:items-center gap-4 hover:bg-gray-750 transition-colors",children:[i.jsx("div",{className:`shrink-0 w-12 h-12 rounded-lg flex items-center justify-center border ${O?"bg-yellow-500/10 border-yellow-500/30 text-yellow-500":"bg-gray-700/50 border-gray-600 text-gray-400"}`,children:O?i.jsx(ra,{className:"w-6 h-6"}):i.jsxs("span",{className:"text-lg font-bold",children:["#",I.placement]})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex flex-col gap-1 mb-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Me:"}),i.jsx("h4",{className:"font-bold text-white truncate max-w-[200px]",children:I.deck_name||"Generic Deck"}),I.deck_commander&&i.jsx("span",{className:"text-[10px] bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/30 truncate max-w-[150px]",children:typeof I.deck_commander=="object"?I.deck_commander.name:I.deck_commander})]}),I.opponents?.length>0&&i.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"VS:"}),I.opponents.map((E,M)=>i.jsxs("div",{className:"flex items-center gap-1.5 bg-black/20 px-2 py-1 rounded",children:[i.jsx(GI,{className:"w-3 h-3 text-gray-500"}),i.jsx("span",{className:"text-sm text-gray-300",children:E.name}),i.jsx("span",{className:"text-xs text-gray-500 border-l border-gray-700 pl-1.5 ml-0.5",children:E.deck_name||"Generic"}),E.commander&&i.jsxs("span",{className:"text-[10px] text-gray-600 truncate max-w-[80px]",children:["(",typeof E.commander=="object"?E.commander.name:E.commander,")"]})]},M))]})]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-400 mt-2",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Tre,{className:"w-3 h-3"}),wa(L,"MMM d, h:mm a")]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ire,{className:"w-3 h-3"}),_," min"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>w(I),className:"p-2 text-indigo-400 hover:text-white bg-indigo-500/10 hover:bg-indigo-500 rounded-lg transition-colors flex items-center gap-2 border border-indigo-500/20",children:[i.jsx(bke,{className:"w-4 h-4"}),i.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Report"})]}),i.jsx("button",{onClick:()=>y(I.match_id),className:"p-2 text-gray-600 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete Record",children:i.jsx(Ake,{className:"w-5 h-5"})})]})]})},I.match_id)})})]}),i.jsx(sFe,{isOpen:!!f,onClose:()=>m(null),match:f,logs:f?l[f.match_id]:[]})]})},aFe=()=>{const t=Ca();console.log("SettingsPage Render:",t.pathname);const[e,r]=b.useState(!1),n=[{path:"account",label:"Account",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})},{path:"preferences",label:"Preferences",icon:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},{path:"data",label:"Data Management",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})})},{path:"community",label:"My Pod",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{path:"history",label:"Match History",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}];return i.jsxs("div",{className:"flex h-[calc(100vh-64px)] bg-gray-900 overflow-hidden relative",children:[i.jsx("div",{className:"md:hidden absolute top-4 left-4 z-50",children:i.jsx("button",{onClick:()=>r(!e),className:"p-2 bg-gray-800 rounded-lg text-white border border-gray-700 shadow-lg",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),e&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>r(!1)}),i.jsxs("aside",{className:`
                absolute md:relative z-40 h-full w-64 bg-gray-950 border-r border-gray-800 flex flex-col transition-transform duration-300
                ${e?"translate-x-0":"-translate-x-full md:translate-x-0"}
            `,children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 pt-16 md:pt-6",children:[i.jsx("h1",{className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Settings"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage your experience"})]}),i.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:n.map(s=>i.jsxs(NL,{to:`/settings/${s.path}`,onClick:()=>r(!1),className:({isActive:a})=>`
                                flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm
                                ${a?"bg-indigo-600/10 text-indigo-400 border border-indigo-500/20 shadow-lg shadow-indigo-900/10":"text-gray-400 hover:bg-gray-800 hover:text-gray-200 border border-transparent"}
                            `,children:[i.jsx("div",{className:`${t.pathname.includes(s.path)?"text-indigo-500":"text-gray-500"}`,children:s.icon}),s.label]},s.path))})]}),i.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-900 relative w-full",children:i.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8 pt-16 md:pt-8",children:i.jsxs(bL,{children:[i.jsx(Vr,{path:"account",element:i.jsx(KBe,{})}),i.jsx(Vr,{path:"preferences",element:i.jsx(QBe,{})}),i.jsx(Vr,{path:"data",element:i.jsx(ZBe,{})}),i.jsx(Vr,{path:"community",element:i.jsx(nFe,{})}),i.jsx(Vr,{path:"history",element:i.jsx(iFe,{})}),i.jsx(Vr,{path:"*",element:i.jsx(e4,{to:"/settings/account",replace:!0})})]})})})]})},oFe=()=>{const{cards:t,loading:e,error:r}=yo({wishlist:!0}),{currentUser:n}=Cr(),{addToast:s}=Tn(),[a,o]=b.useState(""),[l,c]=b.useState(!1),[u,h]=b.useState(!1);b.useEffect(()=>{const E=()=>h(!0);return window.addEventListener("start-tour",E),localStorage.getItem("tour_seen_wishlist_tour_v1")||setTimeout(()=>h(!0),1e3),()=>window.removeEventListener("start-tour",E)},[]);const f=[{target:"h1",title:"Wishlist",content:"Track cards you want to acquire here."},{target:"#wishlist-search",title:"Search",content:"Quickly find specific cards in your wishlist."},{target:"#wishlist-manage-btn",title:"Bulk Actions",content:"Switch to selection mode to remove multiple cards at once."},{target:"#wishlist-filter-btn",title:"Filters",content:"Filter by color, scarcity, or set to prioritize."}],[m,g]=b.useState(!1),[y,v]=b.useState(new Set),w=E=>{const M=new Set(y);M.has(E)?M.delete(E):M.add(E),v(M)},N=E=>{y.size===E.length?v(new Set):v(new Set(E.map(M=>M.id)))},k=async()=>{if(y.size===0)return;const E=y.size;if(window.confirm(`Are you sure you want to delete ${E} cards from your wishlist?`))try{await bl.batchRemoveCards(Array.from(y)),s(`Successfully removed ${E} cards`,"success"),g(!1),v(new Set),window.location.reload()}catch(M){console.error(M),s("Failed to remove cards","error")}},[C,I]=b.useState({colors:[],rarity:[],types:[],sets:[]}),O=b.useMemo(()=>{const E=new Set;return t.forEach(M=>{M.set&&M.set_name&&E.add(JSON.stringify({value:M.set,label:M.set_name}))}),Array.from(E).map(M=>JSON.parse(M)).sort((M,B)=>M.label.localeCompare(B.label))},[t]),L=b.useMemo(()=>t.filter(E=>{const M=E.name||"";if(a&&!M.toLowerCase().includes(a.toLowerCase()))return!1;if(C.colors.length>0){const B=E.color_identity||[],S=B.length>1,P=B.length===0;if(!C.colors.some(V=>V==="C"?P:V==="M"?S:B.includes(V)))return!1}if(C.rarity.length>0&&!C.rarity.includes(E.rarity))return!1;if(C.types.length>0){const B=(E.type_line||"").toLowerCase();if(!C.types.some(P=>B.includes(P.toLowerCase())))return!1}return!(C.sets.length>0&&!C.sets.includes(E.set))}),[t,a,C]),_=(E,M)=>{I(B=>{const S=B[E],P=S.includes(M)?S.filter(R=>R!==M):[...S,M];return{...B,[E]:P}})};return i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"p-2 bg-orange-500/10 rounded-xl",children:i.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Wishlist"]}),i.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Manage cards you want to acquire"})]}),i.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[i.jsxs("div",{className:"relative w-full md:w-80",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("input",{id:"wishlist-search",type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-700 rounded-md leading-5 bg-gray-800 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-700 focus:border-orange-500 transition duration-150 ease-in-out sm:text-sm",placeholder:"Search wishlist...",value:a,onChange:E=>o(E.target.value)}),a&&i.jsx("button",{onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[m?i.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 p-1 rounded-lg border border-gray-700 animate-fade-in mr-2",children:[i.jsx("button",{onClick:()=>N(L),className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:y.size===L.length?"Deselect All":"Select All"}),i.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2 whitespace-nowrap",children:[y.size," Selected"]}),i.jsx("button",{onClick:k,disabled:y.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"}),i.jsx("button",{onClick:()=>g(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):i.jsx("button",{onClick:()=>g(!0),id:"wishlist-manage-btn",className:"px-3 py-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-indigo-400 border border-gray-700 rounded-md transition-colors text-sm font-bold uppercase",children:"Select"}),i.jsxs("button",{id:"wishlist-filter-btn",onClick:()=>c(!l),className:`px-3 py-2 rounded-md border transition-colors flex items-center gap-2 ${l?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}`,children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})]})]}),l&&i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8 border border-gray-700 gap-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 animate-fade-in-down",children:[i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Colors"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(E=>i.jsx("button",{onClick:()=>_("colors",E),className:`
                                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border shadow-sm transition-transform hover:scale-105
                                        ${C.colors.includes(E)?"ring-2 ring-orange-500 ring-offset-2 ring-offset-gray-800":"opacity-70 hover:opacity-100"}
                                        ${E==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                        ${E==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                        ${E==="B"?"bg-[#1F2937] text-white border-gray-900":""}
                                        ${E==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                        ${E==="G"?"bg-[#10B981] text-white border-green-600":""}
                                        ${E==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                        ${E==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                    `,children:E},E))})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Rarity"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(E=>i.jsx("button",{onClick:()=>_("rarity",E),className:`
                                        px-3 py-1 rounded text-xs font-bold uppercase border transition-colors
                                        ${C.rarity.includes(E)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                    `,children:E},E))})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Types"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(E=>i.jsx("button",{onClick:()=>_("types",E),className:`
                                         px-2 py-1 rounded text-xs border transition-colors
                                         ${C.types.includes(E)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                     `,children:E},E))})]}),i.jsx("div",{className:"col-span-1",children:i.jsx(Mj,{label:"Filter by Set",options:O,selected:C.sets,onChange:E=>I(M=>({...M,sets:E})),placeholder:"All Sets"})})]}),e?i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:Array.from({length:12}).map((E,M)=>i.jsx(TM,{},M))}):r?i.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg",children:["Error loading wishlist: ",r.message]}):i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[L.map(E=>i.jsx("div",{className:"h-full",children:i.jsx(Ky,{card:E,selectMode:m,isSelected:y.has(E.id),onToggleSelect:w})},E.id)),L.length===0&&i.jsxs("div",{className:"col-span-full text-center text-gray-500 py-12 flex flex-col items-center",children:[i.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),i.jsx("p",{className:"text-xl",children:"Your wishlist is empty"}),i.jsx("p",{className:"text-sm mt-2 font-medium",children:"Add cards to your wishlist from the search modal!"})]})]}),i.jsx(zf,{steps:f,isOpen:u,onClose:()=>h(!1),tourId:"wishlist_tour_v1"})]})},$A=()=>{const t=yn(),{type:e,set:r}=cc(),{addToast:n}=Tn(),[s,a]=b.useState([]),[o,l]=b.useState([]),[c,u]=b.useState([]),[h,f]=b.useState("types"),[m,g]=b.useState(!0),[y,v]=b.useState(""),[w,N]=b.useState("");b.useEffect(()=>{const _=setTimeout(()=>N(y),500);return()=>clearTimeout(_)},[y]),b.useEffect(()=>{(async()=>(s.length===0&&await k(),o.length===0&&await C()))()},[]),b.useEffect(()=>{(async()=>{g(!0);try{w?await I({search:w}):e?await I({type:e}):r?await I({set_code:r}):u([])}finally{g(!1)}})()},[w,e,r]);const k=async()=>{try{const _=await He.get("/api/precons/types");a(_)}catch(_){console.error(_),n("Failed to load types","error")}},C=async()=>{try{const _=await He.get("/api/precons/sets");l(_)}catch(_){console.error(_)}},I=async _=>{try{const E=new URLSearchParams(_).toString(),M=await He.get(`/api/precons?${E}`);u(M)}catch(E){console.error(E),n("Failed to load precons","error")}},O=_=>{const E=["from-purple-500/20 to-blue-500/5 hover:border-purple-500","from-emerald-500/20 to-teal-500/5 hover:border-emerald-500","from-amber-500/20 to-orange-500/5 hover:border-amber-500","from-rose-500/20 to-red-500/5 hover:border-rose-500","from-cyan-500/20 to-blue-500/5 hover:border-cyan-500"];let M=0;for(let S=0;S<_.length;S++)M=_.charCodeAt(S)+((M<<5)-M);const B=Math.abs(M)%E.length;return E[B]},L=!!(e||r||w);return i.jsx("div",{className:"min-h-screen bg-gray-950 p-6 md:p-8 pt-24",children:i.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 border-b border-gray-800 pb-6",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:["Precon ",i.jsx("span",{className:"text-purple-500",children:"Database"})]}),i.jsx("p",{className:"text-gray-400",children:L?i.jsxs(i.Fragment,{children:[i.jsx(Hr,{to:"/precons",onClick:()=>{v("")},className:"hover:text-white transition-colors underline decoration-dotted",children:"Database"})," > ",i.jsx("span",{className:"text-white font-bold",children:w?`Search: "${w}"`:e||r})]}):"Browse official preconstructed decks."})]}),i.jsxs("div",{className:"flex gap-4",children:[!L&&i.jsxs("div",{className:"bg-gray-900 rounded-lg p-1 border border-gray-700 flex text-sm font-bold",children:[i.jsx("button",{onClick:()=>f("types"),className:`px-4 py-2 rounded-md transition-colors ${h==="types"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Types"}),i.jsx("button",{onClick:()=>f("sets"),className:`px-4 py-2 rounded-md transition-colors ${h==="sets"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Sets"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Search decks or commanders...",value:y,onChange:_=>v(_.target.value),className:"bg-gray-900 border border-gray-700 text-white px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none w-64 md:w-80 pl-10 pr-10"}),i.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),y&&i.jsx("button",{onClick:()=>v(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:i.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),m?i.jsx("div",{className:"flex justify-center py-20",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):L?c.length===0?i.jsx("div",{className:"text-center py-20 text-gray-500",children:"No precons found."}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(_=>i.jsxs(Hr,{to:`/precons/deck/${_.id}`,className:"bg-gray-900 border border-gray-800 rounded-2xl overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-xl group flex flex-col cursor-pointer hover:-translate-y-1",children:[i.jsxs("div",{className:"p-6 flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-purple-400 transition-colors line-clamp-2",children:_.name}),i.jsx("span",{className:"text-xs font-bold bg-gray-800 text-gray-400 px-2 py-1 rounded uppercase tracking-wider",children:_.data?.code||"???"})]}),i.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Commander"}),i.jsx("span",{className:"text-gray-200 font-medium truncate ml-2 max-w-[150px] text-right",children:_.data?.commander?.[0]?.name||"Unknown"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Cards"}),i.jsx("span",{className:"text-gray-200",children:(_.data?.mainBoard?.length||0)+(_.data?.sideBoard?.length||0)+(_.data?.commander?.length||0)})]}),_.total_price>0&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Market Price"}),i.jsxs("span",{className:"text-green-400 font-bold",children:["$",_.total_price.toFixed(2)]})]})]})]}),i.jsx("div",{className:"bg-gray-800/50 p-4 border-t border-gray-800 flex justify-center text-purple-400 font-bold text-sm group-hover:bg-purple-900/20 transition-colors",children:"View Deck List"})]},_.id))}):h==="types"?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.map(_=>i.jsx("div",{onClick:()=>t(`/precons/type/${encodeURIComponent(_)}`),className:`group cursor-pointer bg-gray-900 border border-gray-800 rounded-2xl p-8 transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${O(_)}`,children:i.jsx("h3",{className:"text-xl font-bold text-white text-center group-hover:scale-105 transition-transform",children:_})},_))}):i.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.map(_=>i.jsxs("div",{onClick:()=>t(`/precons/set/${_}`),className:"group cursor-pointer bg-gray-900 border border-gray-800 rounded-xl p-6 transition-all hover:-translate-y-1 hover:border-purple-500 flex flex-col items-center justify-center gap-2",children:[i.jsx("span",{className:"text-2xl font-black text-gray-700 group-hover:text-white transition-colors uppercase",children:_}),i.jsx("span",{className:"text-xs text-purple-400 font-bold",children:"Set Code"})]},_))})]})})};var lFe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function BM(t){if(typeof t!="string")return!1;var e=lFe;return e.includes(t)}var cFe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],uFe=new Set(cFe);function Jae(t){return typeof t!="string"?!1:uFe.has(t)}function Zae(t){return typeof t=="string"&&t.startsWith("data-")}function ph(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Jae(r)||Zae(r))&&(e[r]=t[r]);return e}function S2(t){if(t==null)return null;if(b.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return ph(e)}return typeof t=="object"&&!Array.isArray(t)?ph(t):null}function Nu(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Jae(r)||Zae(r)||BM(r))&&(e[r]=t[r]);return e}var dFe=["children","width","height","viewBox","className","style","title","desc"];function V8(){return V8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},V8.apply(null,arguments)}function hFe(t,e){if(t==null)return{};var r,n,s=fFe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function fFe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var FM=b.forwardRef((t,e)=>{var{children:r,width:n,height:s,viewBox:a,className:o,style:l,title:c,desc:u}=t,h=hFe(t,dFe),f=a||{width:n,height:s,x:0,y:0},m=js("recharts-surface",o);return b.createElement("svg",V8({},Nu(h),{className:m,width:n,height:s,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),b.createElement("title",null,c),b.createElement("desc",null,u),r)}),pFe=["children","className"];function q8(){return q8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},q8.apply(null,arguments)}function mFe(t,e){if(t==null)return{};var r,n,s=gFe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function gFe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Tl=b.forwardRef((t,e)=>{var{children:r,className:n}=t,s=mFe(t,pFe),a=js("recharts-layer",n);return b.createElement("g",q8({className:a},Nu(s),{ref:e}),r)}),eoe=b.createContext(null),xFe=()=>b.useContext(eoe);function Js(t){return function(){return t}}const toe=Math.cos,rk=Math.sin,jd=Math.sqrt,nk=Math.PI,NS=2*nk,H8=Math.PI,W8=2*H8,sm=1e-6,yFe=W8-sm;function roe(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function bFe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return roe;const r=10**e;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class vFe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?roe:bFe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,s){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(e,r,n,s,a,o){this._append`C${+e},${+r},${+n},${+s},${this._x1=+a},${this._y1=+o}`}arcTo(e,r,n,s,a){if(e=+e,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,l=this._y1,c=n-e,u=s-r,h=o-e,f=l-r,m=h*h+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>sm)if(!(Math.abs(f*c-u*h)>sm)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let g=n-o,y=s-l,v=c*c+u*u,w=g*g+y*y,N=Math.sqrt(v),k=Math.sqrt(m),C=a*Math.tan((H8-Math.acos((v+m-w)/(2*N*k)))/2),I=C/k,O=C/N;Math.abs(I-1)>sm&&this._append`L${e+I*h},${r+I*f}`,this._append`A${a},${a},0,0,${+(f*g>h*y)},${this._x1=e+O*c},${this._y1=r+O*u}`}}arc(e,r,n,s,a,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(s),c=n*Math.sin(s),u=e+l,h=r+c,f=1^o,m=o?s-a:a-s;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>sm||Math.abs(this._y1-h)>sm)&&this._append`L${u},${h}`,n&&(m<0&&(m=m%W8+W8),m>yFe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=h}`:m>sm&&this._append`A${n},${n},0,${+(m>=H8)},${f},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function $M(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new vFe(e)}function UM(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function noe(t){this._context=t}noe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function jS(t){return new noe(t)}function soe(t){return t[0]}function ioe(t){return t[1]}function aoe(t,e){var r=Js(!0),n=null,s=jS,a=null,o=$M(l);t=typeof t=="function"?t:t===void 0?soe:Js(t),e=typeof e=="function"?e:e===void 0?ioe:Js(e);function l(c){var u,h=(c=UM(c)).length,f,m=!1,g;for(n==null&&(a=s(g=o())),u=0;u<=h;++u)!(u<h&&r(f=c[u],u,c))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(f,u,c),+e(f,u,c));if(g)return a=null,g+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:Js(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:Js(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Js(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,n!=null&&(a=s(n)),l):s},l.context=function(c){return arguments.length?(c==null?n=a=null:a=s(n=c),l):n},l}function RN(t,e,r){var n=null,s=Js(!0),a=null,o=jS,l=null,c=$M(u);t=typeof t=="function"?t:t===void 0?soe:Js(+t),e=typeof e=="function"?e:Js(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?ioe:Js(+r);function u(f){var m,g,y,v=(f=UM(f)).length,w,N=!1,k,C=new Array(v),I=new Array(v);for(a==null&&(l=o(k=c())),m=0;m<=v;++m){if(!(m<v&&s(w=f[m],m,f))===N)if(N=!N)g=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=m-1;y>=g;--y)l.point(C[y],I[y]);l.lineEnd(),l.areaEnd()}N&&(C[m]=+t(w,m,f),I[m]=+e(w,m,f),l.point(n?+n(w,m,f):C[m],r?+r(w,m,f):I[m]))}if(k)return l=null,k+""||null}function h(){return aoe().defined(s).curve(o).context(a)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:Js(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:Js(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Js(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:Js(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:Js(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Js(+f),u):r},u.lineX0=u.lineY0=function(){return h().x(t).y(e)},u.lineY1=function(){return h().x(t).y(r)},u.lineX1=function(){return h().x(n).y(e)},u.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Js(!!f),u):s},u.curve=function(f){return arguments.length?(o=f,a!=null&&(l=o(a)),u):o},u.context=function(f){return arguments.length?(f==null?a=l=null:l=o(a=f),u):a},u}class ooe{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function wFe(t){return new ooe(t,!0)}function NFe(t){return new ooe(t,!1)}const zM={draw(t,e){const r=jd(e/nk);t.moveTo(r,0),t.arc(0,0,r,0,NS)}},jFe={draw(t,e){const r=jd(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},loe=jd(1/3),kFe=loe*2,_Fe={draw(t,e){const r=jd(e/kFe),n=r*loe;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},SFe={draw(t,e){const r=jd(e),n=-r/2;t.rect(n,n,r,r)}},CFe=.8908130915292852,coe=rk(nk/10)/rk(7*nk/10),EFe=rk(NS/10)*coe,AFe=-toe(NS/10)*coe,TFe={draw(t,e){const r=jd(e*CFe),n=EFe*r,s=AFe*r;t.moveTo(0,-r),t.lineTo(n,s);for(let a=1;a<5;++a){const o=NS*a/5,l=toe(o),c=rk(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*s,c*n+l*s)}t.closePath()}},UA=jd(3),IFe={draw(t,e){const r=-jd(e/(UA*3));t.moveTo(0,r*2),t.lineTo(-UA*r,-r),t.lineTo(UA*r,-r),t.closePath()}},tu=-.5,ru=jd(3)/2,G8=1/jd(12),PFe=(G8/2+1)*3,LFe={draw(t,e){const r=jd(e/PFe),n=r/2,s=r*G8,a=n,o=r*G8+r,l=-a,c=o;t.moveTo(n,s),t.lineTo(a,o),t.lineTo(l,c),t.lineTo(tu*n-ru*s,ru*n+tu*s),t.lineTo(tu*a-ru*o,ru*a+tu*o),t.lineTo(tu*l-ru*c,ru*l+tu*c),t.lineTo(tu*n+ru*s,tu*s-ru*n),t.lineTo(tu*a+ru*o,tu*o-ru*a),t.lineTo(tu*l+ru*c,tu*c-ru*l),t.closePath()}};function OFe(t,e){let r=null,n=$M(s);t=typeof t=="function"?t:Js(t||zM),e=typeof e=="function"?e:Js(e===void 0?64:+e);function s(){let a;if(r||(r=a=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),a)return r=null,a+""||null}return s.type=function(a){return arguments.length?(t=typeof a=="function"?a:Js(a),s):t},s.size=function(a){return arguments.length?(e=typeof a=="function"?a:Js(+a),s):e},s.context=function(a){return arguments.length?(r=a??null,s):r},s}function sk(){}function ik(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function uoe(t){this._context=t}uoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ik(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ik(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function MFe(t){return new uoe(t)}function doe(t){this._context=t}doe.prototype={areaStart:sk,areaEnd:sk,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ik(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function RFe(t){return new doe(t)}function hoe(t){this._context=t}hoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ik(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function DFe(t){return new hoe(t)}function foe(t){this._context=t}foe.prototype={areaStart:sk,areaEnd:sk,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function BFe(t){return new foe(t)}function EH(t){return t<0?-1:1}function AH(t,e,r){var n=t._x1-t._x0,s=e-t._x1,a=(t._y1-t._y0)/(n||s<0&&-0),o=(r-t._y1)/(s||n<0&&-0),l=(a*s+o*n)/(n+s);return(EH(a)+EH(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function TH(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function zA(t,e,r){var n=t._x0,s=t._y0,a=t._x1,o=t._y1,l=(a-n)/3;t._context.bezierCurveTo(n+l,s+l*e,a-l,o-l*r,a,o)}function ak(t){this._context=t}ak.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:zA(this,this._t0,TH(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,zA(this,TH(this,r=AH(this,t,e)),r);break;default:zA(this,this._t0,r=AH(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function poe(t){this._context=new moe(t)}(poe.prototype=Object.create(ak.prototype)).point=function(t,e){ak.prototype.point.call(this,e,t)};function moe(t){this._context=t}moe.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,s,a){this._context.bezierCurveTo(e,t,n,r,a,s)}};function FFe(t){return new ak(t)}function $Fe(t){return new poe(t)}function goe(t){this._context=t}goe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=IH(t),s=IH(e),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function IH(t){var e,r=t.length-1,n,s=new Array(r),a=new Array(r),o=new Array(r);for(s[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)s[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=s[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(s[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)s[e]=(o[e]-s[e+1])/a[e];for(a[r-1]=(t[r]+s[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-s[e+1];return[s,a]}function UFe(t){return new goe(t)}function kS(t,e){this._context=t,this._t=e}kS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function zFe(t){return new kS(t,.5)}function VFe(t){return new kS(t,0)}function qFe(t){return new kS(t,1)}function ag(t,e){if((o=t.length)>1)for(var r=1,n,s,a=t[e[0]],o,l=a.length;r<o;++r)for(s=a,a=t[e[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function K8(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function HFe(t,e){return t[e]}function WFe(t){const e=[];return e.key=t,e}function GFe(){var t=Js([]),e=K8,r=ag,n=HFe;function s(a){var o=Array.from(t.apply(this,arguments),WFe),l,c=o.length,u=-1,h;for(const f of a)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,a)]).data=f;for(l=0,h=UM(e(o));l<c;++l)o[h[l]].index=l;return r(o,h),o}return s.keys=function(a){return arguments.length?(t=typeof a=="function"?a:Js(Array.from(a)),s):t},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:Js(+a),s):n},s.order=function(a){return arguments.length?(e=a==null?K8:typeof a=="function"?a:Js(Array.from(a)),s):e},s.offset=function(a){return arguments.length?(r=a??ag,s):r},s}function KFe(t,e){if((n=t.length)>0){for(var r,n,s=0,a=t[0].length,o;s<a;++s){for(o=r=0;r<n;++r)o+=t[r][s][1]||0;if(o)for(r=0;r<n;++r)t[r][s][1]/=o}ag(t,e)}}function YFe(t,e){if((s=t.length)>0){for(var r=0,n=t[e[0]],s,a=n.length;r<a;++r){for(var o=0,l=0;o<s;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}ag(t,e)}}function XFe(t,e){if(!(!((o=t.length)>0)||!((a=(s=t[e[0]]).length)>0))){for(var r=0,n=1,s,a,o;n<a;++n){for(var l=0,c=0,u=0;l<o;++l){for(var h=t[e[l]],f=h[n][1]||0,m=h[n-1][1]||0,g=(f-m)/2,y=0;y<l;++y){var v=t[e[y]],w=v[n][1]||0,N=v[n-1][1]||0;g+=w-N}c+=f,u+=g*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,ag(t,e)}}var VA={},qA={},PH;function QFe(){return PH||(PH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(qA)),qA}var HA={},LH;function xoe(){return LH||(LH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(HA)),HA}var WA={},OH;function VM(){return OH||(OH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(WA)),WA}var GA={},KA={},MH;function JFe(){return MH||(MH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(KA)),KA}var RH;function qM(){return RH||(RH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JFe(),r=VM();function n(s){if(Array.isArray(s))return s.map(r.toKey);if(typeof s=="symbol")return[s];s=e.toString(s);const a=[],o=s.length;if(o===0)return a;let l=0,c="",u="",h=!1;for(s.charCodeAt(0)===46&&(a.push(""),l++);l<o;){const f=s[l];u?f==="\\"&&l+1<o?(l++,c+=s[l]):f===u?u="":c+=f:h?f==='"'||f==="'"?u=f:f==="]"?(h=!1,a.push(c),c=""):c+=f:f==="["?(h=!0,c&&(a.push(c),c="")):f==="."?c&&(a.push(c),c=""):c+=f,l++}return c&&a.push(c),a}t.toPath=n})(GA)),GA}var DH;function HM(){return DH||(DH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=QFe(),r=xoe(),n=VM(),s=qM();function a(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?r.isDeepKey(c)?a(l,s.toPath(c),u):u:h}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const h=l[c];return h===void 0?u:h}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?u:h}}}function o(l,c,u){if(c.length===0)return u;let h=l;for(let f=0;f<c.length;f++){if(h==null||e.isUnsafeProperty(c[f]))return u;h=h[c[f]]}return h===void 0?u:h}t.get=a})(VA)),VA}var YA,BH;function ZFe(){return BH||(BH=1,YA=HM().get),YA}var e$e=ZFe();const og=Pl(e$e);var t$e=4;function Y0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t$e,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function Ji(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((s,a,o)=>{var l=r[o-1];return typeof l=="string"?s+l+a:l!==void 0?s+Y0(l)+a:s+a},"")}var Ho=t=>t===0?0:t>0?1:-1,mh=t=>typeof t=="number"&&t!=+t,lg=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Mr=t=>(typeof t=="number"||t instanceof Number)&&!mh(t),gh=t=>Mr(t)||typeof t=="string",r$e=0,C2=t=>{var e=++r$e;return"".concat(t||"").concat(e)},dl=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Mr(e)&&typeof e!="string")return n;var a;if(lg(e)){if(r==null)return n;var o=e.indexOf("%");a=r*parseFloat(e.slice(0,o))/100}else a=+e;return mh(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},yoe=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Va(t,e,r){return Mr(t)&&Mr(e)?Y0(t+r*(e-t)):e}function n$e(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):og(n,e))===r)}var xo=t=>t===null||typeof t>"u",_w=t=>xo(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function Zd(t){return t!=null}function wb(){}var s$e=["type","size","sizeType"];function Y8(){return Y8=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Y8.apply(null,arguments)}function FH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function $H(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FH(Object(r),!0).forEach(function(n){i$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function i$e(t,e,r){return(e=a$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$e(t){var e=o$e(t,"string");return typeof e=="symbol"?e:e+""}function o$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l$e(t,e){if(t==null)return{};var r,n,s=c$e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function c$e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var boe={symbolCircle:zM,symbolCross:jFe,symbolDiamond:_Fe,symbolSquare:SFe,symbolStar:TFe,symbolTriangle:IFe,symbolWye:LFe},u$e=Math.PI/180,d$e=t=>{var e="symbol".concat(_w(t));return boe[e]||zM},h$e=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*u$e;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},f$e=(t,e)=>{boe["symbol".concat(_w(t))]=e},WM=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,s=l$e(t,s$e),a=$H($H({},s),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var m=d$e(o),g=OFe().type(m).size(h$e(r,n,o)),y=g();if(y!==null)return y},{className:c,cx:u,cy:h}=a,f=Nu(a);return Mr(u)&&Mr(h)&&Mr(r)?b.createElement("path",Y8({},f,{className:js("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(h,")"),d:l()})):null};WM.registerSymbol=f$e;var voe=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,p$e=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(b.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{BM(s)&&(n[s]=(a=>r[s](r,a)))}),n},m$e=(t,e,r)=>n=>(t(e,r,n),null),Sw=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(s=>{var a=t[s];BM(s)&&typeof a=="function"&&(n||(n={}),n[s]=m$e(a,e,r))}),n};function UH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function g$e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UH(Object(r),!0).forEach(function(n){x$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function x$e(t,e,r){return(e=y$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$e(t){var e=b$e(t,"string");return typeof e=="symbol"?e:e+""}function b$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Go(t,e){var r=g$e({},t),n=e,s=Object.keys(e),a=s.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return a}function ok(){return ok=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ok.apply(null,arguments)}function zH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function v$e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zH(Object(r),!0).forEach(function(n){w$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function w$e(t,e,r){return(e=N$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N$e(t){var e=j$e(t,"string");return typeof e=="symbol"?e:e+""}function j$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var su=32,k$e={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function _$e(t){var{data:e,iconType:r,inactiveColor:n}=t,s=su/2,a=su/6,o=su/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return b.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:s,x2:su,y2:s,className:"recharts-legend-icon"})}if(c==="line")return b.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(s,`
            H`).concat(su,"M").concat(2*o,",").concat(s,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(s),className:"recharts-legend-icon"});if(c==="rect")return b.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(su/8,"h").concat(su,"v").concat(su*3/4,"h").concat(-su,"z"),className:"recharts-legend-icon"});if(b.isValidElement(e.legendIcon)){var h=v$e({},e);return delete h.legendIcon,b.cloneElement(e.legendIcon,h)}return b.createElement(WM,{fill:l,cx:s,cy:s,size:su,sizeType:"diameter",type:c})}function S$e(t){var{payload:e,iconSize:r,layout:n,formatter:s,inactiveColor:a,iconType:o}=t,l={x:0,y:0,width:su,height:su},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((h,f)=>{var m=h.formatter||s,g=js({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:h.inactive});if(h.type==="none")return null;var y=h.inactive?a:h.color,v=m?m(h.value,h,f):h.value;return b.createElement("li",ok({className:g,style:c,key:"legend-item-".concat(f)},Sw(t,h,f)),b.createElement(FM,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(v," legend icon")},b.createElement(_$e,{data:h,iconType:o,inactiveColor:a})),b.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v))})}var C$e=t=>{var e=Go(t,k$e),{payload:r,layout:n,align:s}=e;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?s:"left"};return b.createElement("ul",{className:"recharts-default-legend",style:a},b.createElement(S$e,ok({},e,{payload:r})))},XA={},QA={},VH;function E$e(){return VH||(VH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const s=new Map;for(let a=0;a<r.length;a++){const o=r[a],l=n(o,a,r);s.has(l)||s.set(l,o)}return Array.from(s.values())}t.uniqBy=e})(QA)),QA}var JA={},qH;function A$e(){return qH||(qH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return function(...s){return r.apply(this,s.slice(0,n))}}t.ary=e})(JA)),JA}var ZA={},HH;function woe(){return HH||(HH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(ZA)),ZA}var e6={},t6={},r6={},WH;function T$e(){return WH||(WH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(r6)),r6}var GH;function GM(){return GH||(GH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=T$e();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(t6)),t6}var n6={},KH;function I$e(){return KH||(KH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(n6)),n6}var YH;function P$e(){return YH||(YH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=GM(),r=I$e();function n(s){return r.isObjectLike(s)&&e.isArrayLike(s)}t.isArrayLikeObject=n})(e6)),e6}var s6={},i6={},XH;function L$e(){return XH||(XH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HM();function r(n){return function(s){return e.get(s,n)}}t.property=r})(i6)),i6}var a6={},o6={},l6={},c6={},QH;function Noe(){return QH||(QH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(c6)),c6}var u6={},JH;function joe(){return JH||(JH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(u6)),u6}var d6={},ZH;function koe(){return ZH||(ZH=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.isEqualsSameValueZero=e})(d6)),d6}var eW;function O$e(){return eW||(eW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Noe(),r=joe(),n=koe();function s(h,f,m){return typeof m!="function"?s(h,f,()=>{}):a(h,f,function g(y,v,w,N,k,C){const I=m(y,v,w,N,k,C);return I!==void 0?!!I:a(y,v,g,C)},new Map)}function a(h,f,m,g){if(f===h)return!0;switch(typeof f){case"object":return o(h,f,m,g);case"function":return Object.keys(f).length>0?a(h,{...f},m,g):n.isEqualsSameValueZero(h,f);default:return e.isObject(h)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(h,f)}}function o(h,f,m,g){if(f==null)return!0;if(Array.isArray(f))return c(h,f,m,g);if(f instanceof Map)return l(h,f,m,g);if(f instanceof Set)return u(h,f,m,g);const y=Object.keys(f);if(h==null||r.isPrimitive(h))return y.length===0;if(y.length===0)return!0;if(g?.has(f))return g.get(f)===h;g?.set(f,h);try{for(let v=0;v<y.length;v++){const w=y[v];if(!r.isPrimitive(h)&&!(w in h)||f[w]===void 0&&h[w]!==void 0||f[w]===null&&h[w]!==null||!m(h[w],f[w],w,h,f,g))return!1}return!0}finally{g?.delete(f)}}function l(h,f,m,g){if(f.size===0)return!0;if(!(h instanceof Map))return!1;for(const[y,v]of f.entries()){const w=h.get(y);if(m(w,v,y,h,f,g)===!1)return!1}return!0}function c(h,f,m,g){if(f.length===0)return!0;if(!Array.isArray(h))return!1;const y=new Set;for(let v=0;v<f.length;v++){const w=f[v];let N=!1;for(let k=0;k<h.length;k++){if(y.has(k))continue;const C=h[k];let I=!1;if(m(C,w,v,h,f,g)&&(I=!0),I){y.add(k),N=!0;break}}if(!N)return!1}return!0}function u(h,f,m,g){return f.size===0?!0:h instanceof Set?c([...h],[...f],m,g):!1}t.isMatchWith=s,t.isSetMatch=u})(l6)),l6}var tW;function _oe(){return tW||(tW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=O$e();function r(n,s){return e.isMatchWith(n,s,()=>{})}t.isMatch=r})(o6)),o6}var h6={},f6={},p6={},rW;function M$e(){return rW||(rW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(p6)),p6}var m6={},nW;function KM(){return nW||(nW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(m6)),m6}var g6={},sW;function Soe(){return sW||(sW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",h="[object Array]",f="[object Function]",m="[object ArrayBuffer]",g="[object Object]",y="[object Error]",v="[object DataView]",w="[object Uint8Array]",N="[object Uint8ClampedArray]",k="[object Uint16Array]",C="[object Uint32Array]",I="[object BigUint64Array]",O="[object Int8Array]",L="[object Int16Array]",_="[object Int32Array]",E="[object BigInt64Array]",M="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=h,t.bigInt64ArrayTag=E,t.bigUint64ArrayTag=I,t.booleanTag=s,t.dataViewTag=v,t.dateTag=l,t.errorTag=y,t.float32ArrayTag=M,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=L,t.int32ArrayTag=_,t.int8ArrayTag=O,t.mapTag=c,t.numberTag=n,t.objectTag=g,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=k,t.uint32ArrayTag=C,t.uint8ArrayTag=w,t.uint8ClampedArrayTag=N})(g6)),g6}var x6={},iW;function R$e(){return iW||(iW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(x6)),x6}var aW;function Coe(){return aW||(aW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=M$e(),r=KM(),n=Soe(),s=joe(),a=R$e();function o(h,f){return l(h,void 0,h,new Map,f)}function l(h,f,m,g=new Map,y=void 0){const v=y?.(h,f,m,g);if(v!==void 0)return v;if(s.isPrimitive(h))return h;if(g.has(h))return g.get(h);if(Array.isArray(h)){const w=new Array(h.length);g.set(h,w);for(let N=0;N<h.length;N++)w[N]=l(h[N],N,m,g,y);return Object.hasOwn(h,"index")&&(w.index=h.index),Object.hasOwn(h,"input")&&(w.input=h.input),w}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const w=new RegExp(h.source,h.flags);return w.lastIndex=h.lastIndex,w}if(h instanceof Map){const w=new Map;g.set(h,w);for(const[N,k]of h)w.set(N,l(k,N,m,g,y));return w}if(h instanceof Set){const w=new Set;g.set(h,w);for(const N of h)w.add(l(N,void 0,m,g,y));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(a.isTypedArray(h)){const w=new(Object.getPrototypeOf(h)).constructor(h.length);g.set(h,w);for(let N=0;N<h.length;N++)w[N]=l(h[N],N,m,g,y);return w}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const w=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return g.set(h,w),c(w,h,m,g,y),w}if(typeof File<"u"&&h instanceof File){const w=new File([h],h.name,{type:h.type});return g.set(h,w),c(w,h,m,g,y),w}if(typeof Blob<"u"&&h instanceof Blob){const w=new Blob([h],{type:h.type});return g.set(h,w),c(w,h,m,g,y),w}if(h instanceof Error){const w=new h.constructor;return g.set(h,w),w.message=h.message,w.name=h.name,w.stack=h.stack,w.cause=h.cause,c(w,h,m,g,y),w}if(h instanceof Boolean){const w=new Boolean(h.valueOf());return g.set(h,w),c(w,h,m,g,y),w}if(h instanceof Number){const w=new Number(h.valueOf());return g.set(h,w),c(w,h,m,g,y),w}if(h instanceof String){const w=new String(h.valueOf());return g.set(h,w),c(w,h,m,g,y),w}if(typeof h=="object"&&u(h)){const w=Object.create(Object.getPrototypeOf(h));return g.set(h,w),c(w,h,m,g,y),w}return h}function c(h,f,m=h,g,y){const v=[...Object.keys(f),...e.getSymbols(f)];for(let w=0;w<v.length;w++){const N=v[w],k=Object.getOwnPropertyDescriptor(h,N);(k==null||k.writable)&&(h[N]=l(f[N],N,m,g,y))}}function u(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(f6)),f6}var oW;function D$e(){return oW||(oW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Coe();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(h6)),h6}var lW;function B$e(){return lW||(lW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_oe(),r=D$e();function n(s){return s=r.cloneDeep(s),a=>e.isMatch(a,s)}t.matches=n})(a6)),a6}var y6={},b6={},v6={},cW;function F$e(){return cW||(cW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Coe(),r=KM(),n=Soe();function s(a,o){return e.cloneDeepWith(a,(l,c,u,h)=>{const f=o?.(l,c,u,h);if(f!==void 0)return f;if(typeof a=="object"){if(r.getTag(a)===n.objectTag&&typeof a.constructor!="function"){const m={};return h.set(a,m),e.copyProperties(m,a,u,h),m}switch(Object.prototype.toString.call(a)){case n.numberTag:case n.stringTag:case n.booleanTag:{const m=new a.constructor(a?.valueOf());return e.copyProperties(m,a),m}case n.argumentsTag:{const m={};return e.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}}})}t.cloneDeepWith=s})(v6)),v6}var uW;function $$e(){return uW||(uW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=F$e();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(b6)),b6}var w6={},N6={},dW;function Eoe(){return dW||(dW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(N6)),N6}var j6={},hW;function U$e(){return hW||(hW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=KM();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(j6)),j6}var fW;function z$e(){return fW||(fW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xoe(),r=Eoe(),n=U$e(),s=qM();function a(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&o?.[l]==null?c=s.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let h=0;h<c.length;h++){const f=c[h];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=a})(w6)),w6}var pW;function V$e(){return pW||(pW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_oe(),r=VM(),n=$$e(),s=HM(),a=z$e();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const h=s.get(u,l);return h===void 0?a.has(u,l):c===void 0?h===void 0:e.isMatch(h,c)}}t.matchesProperty=o})(y6)),y6}var mW;function q$e(){return mW||(mW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=woe(),r=L$e(),n=B$e(),s=V$e();function a(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?s.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=a})(s6)),s6}var gW;function H$e(){return gW||(gW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=E$e(),r=A$e(),n=woe(),s=P$e(),a=q$e();function o(l,c=n.identity){return s.isArrayLikeObject(l)?e.uniqBy(Array.from(l),r.ary(a.iteratee(c),1)):[]}t.uniqBy=o})(XA)),XA}var k6,xW;function W$e(){return xW||(xW=1,k6=H$e().uniqBy),k6}var G$e=W$e();const yW=Pl(G$e);function Aoe(t,e,r){return e===!0?yW(t,r):typeof e=="function"?yW(t,e):t}var _6={exports:{}},S6={},C6={exports:{}},E6={};var bW;function K$e(){if(bW)return E6;bW=1;var t=Mf();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,s=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function l(f,m){var g=m(),y=n({inst:{value:g,getSnapshot:m}}),v=y[0].inst,w=y[1];return a(function(){v.value=g,v.getSnapshot=m,c(v)&&w({inst:v})},[f,g,m]),s(function(){return c(v)&&w({inst:v}),f(function(){c(v)&&w({inst:v})})},[f]),o(g),g}function c(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!r(f,g)}catch{return!0}}function u(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return E6.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,E6}var vW;function Y$e(){return vW||(vW=1,C6.exports=K$e()),C6.exports}var wW;function X$e(){if(wW)return S6;wW=1;var t=Mf(),e=Y$e();function r(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var n=typeof Object.is=="function"?Object.is:r,s=e.useSyncExternalStore,a=t.useRef,o=t.useEffect,l=t.useMemo,c=t.useDebugValue;return S6.useSyncExternalStoreWithSelector=function(u,h,f,m,g){var y=a(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=l(function(){function N(L){if(!k){if(k=!0,C=L,L=m(L),g!==void 0&&v.hasValue){var _=v.value;if(g(_,L))return I=_}return I=L}if(_=I,n(C,L))return _;var E=m(L);return g!==void 0&&g(_,E)?(C=L,_):(C=L,I=E)}var k=!1,C,I,O=f===void 0?null:f;return[function(){return N(h())},O===null?void 0:function(){return N(O())}]},[h,f,m,g]);var w=s(u,y[0],y[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),c(w),w},S6}var NW;function Q$e(){return NW||(NW=1,_6.exports=X$e()),_6.exports}var J$e=Q$e(),YM=b.createContext(null),Z$e=t=>t,Zs=()=>{var t=b.useContext(YM);return t?t.store.dispatch:Z$e},Vj=()=>{},eUe=()=>Vj,tUe=(t,e)=>t===e;function Ar(t){var e=b.useContext(YM),r=b.useMemo(()=>e?n=>{if(n!=null)return t(n)}:Vj,[e,t]);return J$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:eUe,e?e.store.getState:Vj,e?e.store.getState:Vj,r,tUe)}function rUe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function nUe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function sUe(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var jW=t=>Array.isArray(t)?t:[t];function iUe(t){const e=Array.isArray(t[0])?t[0]:t;return sUe(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function aUe(t,e){const r=[],{length:n}=t;for(let s=0;s<n;s++)r.push(t[s].apply(null,e));return r}var oUe=class{constructor(t){this.value=t}deref(){return this.value}},lUe=typeof WeakRef<"u"?WeakRef:oUe,cUe=0,kW=1;function DN(){return{s:cUe,v:void 0,o:null,p:null}}function Toe(t,e={}){let r=DN();const{resultEqualityCheck:n}=e;let s,a=0;function o(){let l=r;const{length:c}=arguments;for(let f=0,m=c;f<m;f++){const g=arguments[f];if(typeof g=="function"||typeof g=="object"&&g!==null){let y=l.o;y===null&&(l.o=y=new WeakMap);const v=y.get(g);v===void 0?(l=DN(),y.set(g,l)):l=v}else{let y=l.p;y===null&&(l.p=y=new Map);const v=y.get(g);v===void 0?(l=DN(),y.set(g,l)):l=v}}const u=l;let h;if(l.s===kW)h=l.v;else if(h=t.apply(null,arguments),a++,n){const f=s?.deref?.()??s;f!=null&&n(f,h)&&(h=f,a!==0&&a--),s=typeof h=="object"&&h!==null||typeof h=="function"?new lUe(h):h}return u.s=kW,u.v=h,h}return o.clearCache=()=>{r=DN(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function uUe(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...s)=>{let a=0,o=0,l,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),rUe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...r,...c},{memoize:f,memoizeOptions:m=[],argsMemoize:g=Toe,argsMemoizeOptions:y=[]}=h,v=jW(m),w=jW(y),N=iUe(s),k=f(function(){return a++,u.apply(null,arguments)},...v),C=g(function(){o++;const O=aUe(N,arguments);return l=k.apply(null,O),l},...w);return Object.assign(C,{resultFunc:u,memoizedResultFunc:k,dependencies:N,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var et=uUe(Toe),dUe=Object.assign((t,e=et)=>{nUe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>dUe}),A6={},T6={},I6={},_W;function hUe(){return _W||(_W=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const o=e(n),l=e(s);if(o===l&&o===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?l-o:o-l}return 0};t.compareValues=r})(I6)),I6}var P6={},L6={},SW;function Ioe(){return SW||(SW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(L6)),L6}var CW;function fUe(){return CW||(CW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ioe(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,o){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||o!=null&&Object.hasOwn(o,a)}t.isKey=s})(P6)),P6}var EW;function pUe(){return EW||(EW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hUe(),r=fUe(),n=qM();function s(a,o,l,c){if(a==null)return[];l=c?void 0:l,Array.isArray(a)||(a=Object.values(a)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(g=>String(g));const u=(g,y)=>{let v=g;for(let w=0;w<y.length&&v!=null;++w)v=v[y[w]];return v},h=(g,y)=>y==null||g==null?y:typeof g=="object"&&"key"in g?Object.hasOwn(y,g.key)?y[g.key]:u(y,g.path):typeof g=="function"?g(y):Array.isArray(g)?u(y,g):typeof y=="object"?y[g]:y,f=o.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return a.map(g=>({original:g,criteria:f.map(y=>h(y,g))})).slice().sort((g,y)=>{for(let v=0;v<f.length;v++){const w=e.compareValues(g.criteria[v],y.criteria[v],l[v]);if(w!==0)return w}return 0}).map(g=>g.original)}t.orderBy=s})(T6)),T6}var O6={},AW;function mUe(){return AW||(AW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const s=[],a=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const h=l[u];Array.isArray(h)&&c<a?o(h,c+1):s.push(h)}};return o(r,0),s}t.flatten=e})(O6)),O6}var M6={},TW;function Poe(){return TW||(TW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eoe(),r=GM(),n=Noe(),s=koe();function a(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?s.isEqualsSameValueZero(c[l],o):!1}t.isIterateeCall=a})(M6)),M6}var IW;function gUe(){return IW||(IW=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pUe(),r=mUe(),n=Poe();function s(a,...o){const l=o.length;return l>1&&n.isIterateeCall(a,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(a,r.flatten(o),["asc"])}t.sortBy=s})(A6)),A6}var R6,PW;function xUe(){return PW||(PW=1,R6=gUe().sortBy),R6}var yUe=xUe();const _S=Pl(yUe);var Loe=t=>t.legend.settings,bUe=t=>t.legend.size,vUe=t=>t.legend.payload,wUe=et([vUe,Loe],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?_S(n,r):n});function NUe(){return Ar(wUe)}var BN=1;function Ooe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=b.useState({height:0,left:0,top:0,width:0}),n=b.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),o={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(o.height-e.height)>BN||Math.abs(o.left-e.left)>BN||Math.abs(o.top-e.top)>BN||Math.abs(o.width-e.width)>BN)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function Do(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var jUe=typeof Symbol=="function"&&Symbol.observable||"@@observable",LW=jUe,D6=()=>Math.random().toString(36).substring(7).split("").join("."),kUe={INIT:`@@redux/INIT${D6()}`,REPLACE:`@@redux/REPLACE${D6()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${D6()}`},lk=kUe;function XM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Moe(t,e,r){if(typeof t!="function")throw new Error(Do(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Do(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Do(1));return r(Moe)(t,e)}let n=t,s=e,a=new Map,o=a,l=0,c=!1;function u(){o===a&&(o=new Map,a.forEach((w,N)=>{o.set(N,w)}))}function h(){if(c)throw new Error(Do(3));return s}function f(w){if(typeof w!="function")throw new Error(Do(4));if(c)throw new Error(Do(5));let N=!0;u();const k=l++;return o.set(k,w),function(){if(N){if(c)throw new Error(Do(6));N=!1,u(),o.delete(k),a=null}}}function m(w){if(!XM(w))throw new Error(Do(7));if(typeof w.type>"u")throw new Error(Do(8));if(typeof w.type!="string")throw new Error(Do(17));if(c)throw new Error(Do(9));try{c=!0,s=n(s,w)}finally{c=!1}return(a=o).forEach(k=>{k()}),w}function g(w){if(typeof w!="function")throw new Error(Do(10));n=w,m({type:lk.REPLACE})}function y(){const w=f;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(Do(11));function k(){const I=N;I.next&&I.next(h())}return k(),{unsubscribe:w(k)}},[LW](){return this}}}return m({type:lk.INIT}),{dispatch:m,subscribe:f,getState:h,replaceReducer:g,[LW]:y}}function _Ue(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:lk.INIT})>"u")throw new Error(Do(12));if(typeof r(void 0,{type:lk.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Do(13))})}function Roe(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const o=e[a];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let s;try{_Ue(r)}catch(a){s=a}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let h=0;h<n.length;h++){const f=n[h],m=r[f],g=o[f],y=m(g,l);if(typeof y>"u")throw l&&l.type,new Error(Do(14));u[f]=y,c=c||y!==g}return c=c||n.length!==Object.keys(o).length,c?u:o}}function ck(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function SUe(...t){return e=>(r,n)=>{const s=e(r,n);let a=()=>{throw new Error(Do(15))};const o={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},l=t.map(c=>c(o));return a=ck(...l)(s.dispatch),{...s,dispatch:a}}}function Doe(t){return XM(t)&&"type"in t&&typeof t.type=="string"}var Boe=Symbol.for("immer-nothing"),OW=Symbol.for("immer-draftable"),Il=Symbol.for("immer-state");function Qu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Pc=Object,Yy=Pc.getPrototypeOf,uk="constructor",SS="prototype",X8="configurable",dk="enumerable",qj="writable",E2="value",Cf=t=>!!t&&!!t[Il];function gd(t){return t?Foe(t)||ES(t)||!!t[OW]||!!t[uk]?.[OW]||AS(t)||TS(t):!1}var CUe=Pc[SS][uk].toString(),MW=new WeakMap;function Foe(t){if(!t||!QM(t))return!1;const e=Yy(t);if(e===null||e===Pc[SS])return!0;const r=Pc.hasOwnProperty.call(e,uk)&&e[uk];if(r===Object)return!0;if(!Wx(r))return!1;let n=MW.get(r);return n===void 0&&(n=Function.toString.call(r),MW.set(r,n)),n===CUe}function CS(t,e,r=!0){Cw(t)===0?(r?Reflect.ownKeys(t):Pc.keys(t)).forEach(s=>{e(s,t[s],t)}):t.forEach((n,s)=>e(s,n,t))}function Cw(t){const e=t[Il];return e?e.type_:ES(t)?1:AS(t)?2:TS(t)?3:0}var RW=(t,e,r=Cw(t))=>r===2?t.has(e):Pc[SS].hasOwnProperty.call(t,e),Q8=(t,e,r=Cw(t))=>r===2?t.get(e):t[e],hk=(t,e,r,n=Cw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function EUe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var ES=Array.isArray,AS=t=>t instanceof Map,TS=t=>t instanceof Set,QM=t=>typeof t=="object",Wx=t=>typeof t=="function",B6=t=>typeof t=="boolean";function AUe(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Qh=t=>t.copy_||t.base_,JM=t=>t.modified_?t.copy_:t.base_;function J8(t,e){if(AS(t))return new Map(t);if(TS(t))return new Set(t);if(ES(t))return Array[SS].slice.call(t);const r=Foe(t);if(e===!0||e==="class_only"&&!r){const n=Pc.getOwnPropertyDescriptors(t);delete n[Il];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const o=s[a],l=n[o];l[qj]===!1&&(l[qj]=!0,l[X8]=!0),(l.get||l.set)&&(n[o]={[X8]:!0,[qj]:!0,[dk]:l[dk],[E2]:t[o]})}return Pc.create(Yy(t),n)}else{const n=Yy(t);if(n!==null&&r)return{...t};const s=Pc.create(n);return Pc.assign(s,t)}}function ZM(t,e=!1){return IS(t)||Cf(t)||!gd(t)||(Cw(t)>1&&Pc.defineProperties(t,{set:FN,add:FN,clear:FN,delete:FN}),Pc.freeze(t),e&&CS(t,(r,n)=>{ZM(n,!0)},!1)),t}function TUe(){Qu(2)}var FN={[E2]:TUe};function IS(t){return t===null||!QM(t)?!0:Pc.isFrozen(t)}var fk="MapSet",Z8="Patches",DW="ArrayMethods",$oe={};function cg(t){const e=$oe[t];return e||Qu(0,t),e}var BW=t=>!!$oe[t],A2,Uoe=()=>A2,IUe=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:BW(fk)?cg(fk):void 0,arrayMethodsPlugin_:BW(DW)?cg(DW):void 0});function FW(t,e){e&&(t.patchPlugin_=cg(Z8),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function eP(t){tP(t),t.drafts_.forEach(PUe),t.drafts_=null}function tP(t){t===A2&&(A2=t.parent_)}var $W=t=>A2=IUe(A2,t);function PUe(t){const e=t[Il];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function UW(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Il].modified_&&(eP(e),Qu(4)),gd(t)&&(t=zW(e,t));const{patchPlugin_:s}=e;s&&s.generateReplacementPatches_(r[Il].base_,t,e)}else t=zW(e,r);return LUe(e,t,!0),eP(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Boe?t:void 0}function zW(t,e){if(IS(e))return e;const r=e[Il];if(!r)return pk(e,t.handledSet_,t);if(!PS(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);qoe(r,t)}return r.copy_}function LUe(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ZM(e,r)}function zoe(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var PS=(t,e)=>t.scope_===e,OUe=[];function Voe(t,e,r,n){const s=Qh(t),a=t.type_;if(n!==void 0&&Q8(s,n,a)===e){hk(s,n,r,a);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;CS(s,(c,u)=>{if(Cf(u)){const h=l.get(u)||[];h.push(c),l.set(u,h)}})}const o=t.draftLocations_.get(e)??OUe;for(const l of o)hk(s,l,r,a)}function MUe(t,e,r){t.callbacks_.push(function(s){const a=e;if(!a||!PS(a,s))return;s.mapSetPlugin_?.fixSetContents(a);const o=JM(a);Voe(t,a.draft_??a,o,r),qoe(a,s)})}function qoe(t,e){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){const{patchPlugin_:n}=e;if(n){const s=n.getPath(t);s&&n.generatePatches_(t,s,e)}zoe(t)}}function RUe(t,e,r){const{scope_:n}=t;if(Cf(r)){const s=r[Il];PS(s,n)&&s.callbacks_.push(function(){Hj(t);const o=JM(s);Voe(t,r,o,e)})}else gd(r)&&t.callbacks_.push(function(){const a=Qh(t);t.type_===3?a.has(r)&&pk(r,n.handledSet_,n):Q8(a,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&pk(Q8(t.copy_,e,t.type_),n.handledSet_,n)})}function pk(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Cf(t)||e.has(t)||!gd(t)||IS(t)||(e.add(t),CS(t,(n,s)=>{if(Cf(s)){const a=s[Il];if(PS(a,r)){const o=JM(a);hk(t,n,o,t.type_),zoe(a)}}else gd(s)&&pk(s,e,r)})),t}function DUe(t,e){const r=ES(t),n={type_:r?1:0,scope_:e?e.scope_:Uoe(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let s=n,a=mk;r&&(s=[n],a=T2);const{revoke:o,proxy:l}=Proxy.revocable(s,a);return n.draft_=l,n.revoke_=o,[l,n]}var mk={get(t,e){if(e===Il)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r?.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const s=Qh(t);if(!RW(s,e,t.type_))return BUe(t,s,e);const a=s[e];if(t.finalized_||!gd(a)||n&&t.operationMethod&&r?.isMutatingArrayMethod(t.operationMethod)&&AUe(e))return a;if(a===F6(t.base_,e)){Hj(t);const o=t.type_===1?+e:e,l=nP(t.scope_,a,t,o);return t.copy_[o]=l}return a},has(t,e){return e in Qh(t)},ownKeys(t){return Reflect.ownKeys(Qh(t))},set(t,e,r){const n=Hoe(Qh(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const s=F6(Qh(t),e),a=s?.[Il];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(EUe(r,s)&&(r!==void 0||RW(t.base_,e,t.type_)))return!0;Hj(t),rP(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),RUe(t,e,r)),!0},deleteProperty(t,e){return Hj(t),F6(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),rP(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Qh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[qj]:!0,[X8]:t.type_!==1||e!=="length",[dk]:n[dk],[E2]:r[e]}},defineProperty(){Qu(11)},getPrototypeOf(t){return Yy(t.base_)},setPrototypeOf(){Qu(12)}},T2={};for(let t in mk){let e=mk[t];T2[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}T2.deleteProperty=function(t,e){return T2.set.call(this,t,e,void 0)};T2.set=function(t,e,r){return mk.set.call(this,t[0],e,r,t[0])};function F6(t,e){const r=t[Il];return(r?Qh(r):t)[e]}function BUe(t,e,r){const n=Hoe(e,r);return n?E2 in n?n[E2]:n.get?.call(t.draft_):void 0}function Hoe(t,e){if(!(e in t))return;let r=Yy(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Yy(r)}}function rP(t){t.modified_||(t.modified_=!0,t.parent_&&rP(t.parent_))}function Hj(t){t.copy_||(t.assigned_=new Map,t.copy_=J8(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var FUe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,s)=>{if(Wx(r)&&!Wx(n)){const o=n;n=r;const l=this;return function(u=o,...h){return l.produce(u,f=>n.call(this,f,...h))}}Wx(n)||Qu(6),s!==void 0&&!Wx(s)&&Qu(7);let a;if(gd(r)){const o=$W(this),l=nP(o,r,void 0);let c=!0;try{a=n(l),c=!1}finally{c?eP(o):tP(o)}return FW(o,s),UW(a,o)}else if(!r||!QM(r)){if(a=n(r),a===void 0&&(a=r),a===Boe&&(a=void 0),this.autoFreeze_&&ZM(a,!0),s){const o=[],l=[];cg(Z8).generateReplacementPatches_(r,a,{patches_:o,inversePatches_:l}),s(o,l)}return a}else Qu(1,r)},this.produceWithPatches=(r,n)=>{if(Wx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let s,a;return[this.produce(r,n,(l,c)=>{s=l,a=c}),s,a]},B6(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),B6(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),B6(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){gd(e)||Qu(8),Cf(e)&&(e=cd(e));const r=$W(this),n=nP(r,e,void 0);return n[Il].isManual_=!0,tP(r),n}finishDraft(e,r){const n=e&&e[Il];(!n||!n.isManual_)&&Qu(9);const{scope_:s}=n;return FW(s,r),UW(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(r=r.slice(n+1));const s=cg(Z8).applyPatches_;return Cf(e)?s(e,r):this.produce(e,a=>s(a,r))}};function nP(t,e,r,n){const[s,a]=AS(e)?cg(fk).proxyMap_(e,r):TS(e)?cg(fk).proxySet_(e,r):DUe(e,r);return(r?.scope_??Uoe()).drafts_.push(s),a.callbacks_=r?.callbacks_??[],a.key_=n,r&&n!==void 0?MUe(r,a,n):a.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(a);const{patchPlugin_:u}=c;a.modified_&&u&&u.generatePatches_(a,[],c)}),s}function cd(t){return Cf(t)||Qu(10,t),Woe(t)}function Woe(t){if(!gd(t)||IS(t))return t;const e=t[Il];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=J8(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=J8(t,!0);return CS(r,(s,a)=>{hk(r,s,Woe(a))},n),e&&(e.finalized_=!1),r}var $Ue=new FUe,Goe=$Ue.produce;function Koe(t){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,t):s(a)}var UUe=Koe(),zUe=Koe,VUe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ck:ck.apply(null,arguments)};function ju(t,e){function r(...n){if(e){let s=e(...n);if(!s)throw new Error(Mc(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Doe(n)&&n.type===t,r}var Yoe=class l1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,l1.prototype)}static get[Symbol.species](){return l1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new l1(...e[0].concat(this)):new l1(...e.concat(this))}};function VW(t){return gd(t)?Goe(t,()=>{}):t}function $N(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function qUe(t){return typeof t=="boolean"}var HUe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=e??{};let o=new Yoe;return r&&(qUe(r)?o.push(UUe):o.push(zUe(r.extraArgument))),o},Xoe="RTK_autoBatch",ji=()=>t=>({payload:t,meta:{[Xoe]:!0}}),qW=t=>e=>{setTimeout(e,t)},Qoe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let s=!0,a=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:qW(10):t.type==="callback"?t.queueNotification:qW(t.timeout),u=()=>{o=!1,a&&(a=!1,l.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const f=()=>s&&h(),m=n.subscribe(f);return l.add(h),()=>{m(),l.delete(h)}},dispatch(h){try{return s=!h?.meta?.[Xoe],a=!s,a&&(o||(o=!0,c(u))),n.dispatch(h)}finally{s=!0}}})},WUe=t=>function(r){const{autoBatch:n=!0}=r??{};let s=new Yoe(t);return n&&s.push(Qoe(typeof n=="object"?n:void 0)),s};function GUe(t){const e=HUe(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(XM(r))l=Roe(r);else throw new Error(Mc(1));let c;typeof n=="function"?c=n(e):c=e();let u=ck;s&&(u=VUe({trace:!1,...typeof s=="object"&&s}));const h=SUe(...c),f=WUe(h);let m=typeof o=="function"?o(f):f();const g=u(...m);return Moe(l,a,g)}function Joe(t){const e={},r=[];let n;const s={addCase(a,o){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(Mc(28));if(l in e)throw new Error(Mc(29));return e[l]=o,s},addAsyncThunk(a,o){return o.pending&&(e[a.pending.type]=o.pending),o.rejected&&(e[a.rejected.type]=o.rejected),o.fulfilled&&(e[a.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:a.settled,reducer:o.settled}),s},addMatcher(a,o){return r.push({matcher:a,reducer:o}),s},addDefaultCase(a){return n=a,s}};return t(s),[e,r,n]}function KUe(t){return typeof t=="function"}function YUe(t,e){let[r,n,s]=Joe(e),a;if(KUe(t))a=()=>VW(t());else{const l=VW(t);a=()=>l}function o(l=a(),c){let u=[r[c.type],...n.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[s]),u.reduce((h,f)=>{if(f)if(Cf(h)){const g=f(h,c);return g===void 0?h:g}else{if(gd(h))return Goe(h,m=>f(m,c));{const m=f(h,c);if(m===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return h},l)}return o.getInitialState=a,o}var XUe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",QUe=(t=21)=>{let e="",r=t;for(;r--;)e+=XUe[Math.random()*64|0];return e},JUe=Symbol.for("rtk-slice-createasyncthunk");function ZUe(t,e){return`${t}/${e}`}function eze({creators:t}={}){const e=t?.asyncThunk?.[JUe];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Mc(11));const o=(typeof n.reducers=="function"?n.reducers(rze()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(C,I){const O=typeof C=="string"?C:C.type;if(!O)throw new Error(Mc(12));if(O in c.sliceCaseReducersByType)throw new Error(Mc(13));return c.sliceCaseReducersByType[O]=I,u},addMatcher(C,I){return c.sliceMatchers.push({matcher:C,reducer:I}),u},exposeAction(C,I){return c.actionCreators[C]=I,u},exposeCaseReducer(C,I){return c.sliceCaseReducersByName[C]=I,u}};l.forEach(C=>{const I=o[C],O={reducerName:C,type:ZUe(s,C),createNotation:typeof n.reducers=="function"};sze(I)?aze(O,I,u,e):nze(O,I,u)});function h(){const[C={},I=[],O=void 0]=typeof n.extraReducers=="function"?Joe(n.extraReducers):[n.extraReducers],L={...C,...c.sliceCaseReducersByType};return YUe(n.initialState,_=>{for(let E in L)_.addCase(E,L[E]);for(let E of c.sliceMatchers)_.addMatcher(E.matcher,E.reducer);for(let E of I)_.addMatcher(E.matcher,E.reducer);O&&_.addDefaultCase(O)})}const f=C=>C,m=new Map,g=new WeakMap;let y;function v(C,I){return y||(y=h()),y(C,I)}function w(){return y||(y=h()),y.getInitialState()}function N(C,I=!1){function O(_){let E=_[C];return typeof E>"u"&&I&&(E=$N(g,O,w)),E}function L(_=f){const E=$N(m,I,()=>new WeakMap);return $N(E,_,()=>{const M={};for(const[B,S]of Object.entries(n.selectors??{}))M[B]=tze(S,_,()=>$N(g,_,w),I);return M})}return{reducerPath:C,getSelectors:L,get selectors(){return L(O)},selectSlice:O}}const k={name:s,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...N(a),injectInto(C,{reducerPath:I,...O}={}){const L=I??a;return C.inject({reducerPath:L,reducer:v},O),{...k,...N(L,!0)}}};return k}}function tze(t,e,r,n){function s(a,...o){let l=e(a);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return s.unwrapped=t,s}var fc=eze();function rze(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function nze({type:t,reducerName:e,createNotation:r},n,s){let a,o;if("reducer"in n){if(r&&!ize(n))throw new Error(Mc(17));a=n.reducer,o=n.prepare}else a=n;s.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,o?ju(t,o):ju(t))}function sze(t){return t._reducerDefinitionType==="asyncThunk"}function ize(t){return t._reducerDefinitionType==="reducerWithPrepare"}function aze({type:t,reducerName:e},r,n,s){if(!s)throw new Error(Mc(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:u,options:h}=r,f=s(t,a,h);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||UN,pending:l||UN,rejected:c||UN,settled:u||UN})}function UN(){}var oze="task",Zoe="listener",ele="completed",eR="cancelled",lze=`task-${eR}`,cze=`task-${ele}`,sP=`${Zoe}-${eR}`,uze=`${Zoe}-${ele}`,LS=class{constructor(t){this.code=t,this.message=`${oze} ${eR} (reason: ${t})`}name="TaskAbortError";message},tR=(t,e)=>{if(typeof t!="function")throw new TypeError(Mc(32))},gk=()=>{},tle=(t,e=gk)=>(t.catch(e),t),rle=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Lm=t=>{if(t.aborted)throw new LS(t.reason)};function nle(t,e){let r=gk;return new Promise((n,s)=>{const a=()=>s(new LS(t.reason));if(t.aborted){a();return}r=rle(t,a),e.finally(()=>r()).then(n,s)}).finally(()=>{r=gk})}var dze=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof LS?"cancelled":"rejected",error:r}}finally{e?.()}},xk=t=>e=>tle(nle(t,e).then(r=>(Lm(t),r))),sle=t=>{const e=xk(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:jy}=Object,HW={},OS="listenerMiddleware",hze=(t,e)=>{const r=n=>rle(t,()=>n.abort(t.reason));return(n,s)=>{tR(n);const a=new AbortController;r(a);const o=dze(async()=>{Lm(t),Lm(a.signal);const l=await n({pause:xk(a.signal),delay:sle(a.signal),signal:a.signal});return Lm(a.signal),l},()=>a.abort(cze));return s?.autoJoin&&e.push(o.catch(gk)),{result:xk(t)(o),cancel(){a.abort(lze)}}}},fze=(t,e)=>{const r=async(n,s)=>{Lm(e);let a=()=>{};const l=[new Promise((c,u)=>{let h=t({predicate:n,effect:(f,m)=>{m.unsubscribe(),c([f,m.getState(),m.getOriginalState()])}});a=()=>{h(),u()}})];s!=null&&l.push(new Promise(c=>setTimeout(c,s,null)));try{const c=await nle(e,Promise.race(l));return Lm(e),c}finally{a()}};return(n,s)=>tle(r(n,s))},ile=t=>{let{type:e,actionCreator:r,matcher:n,predicate:s,effect:a}=t;if(e)s=ju(e).match;else if(r)e=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Mc(21));return tR(a),{predicate:s,type:e,effect:a}},ale=jy(t=>{const{type:e,predicate:r,effect:n}=ile(t);return{id:QUe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Mc(22))}}},{withTypes:()=>ale}),WW=(t,e)=>{const{type:r,effect:n,predicate:s}=ile(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},iP=t=>{t.pending.forEach(e=>{e.abort(sP)})},pze=(t,e)=>()=>{for(const r of e.keys())iP(r);t.clear()},GW=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},ole=jy(ju(`${OS}/add`),{withTypes:()=>ole}),mze=ju(`${OS}/removeAll`),lle=jy(ju(`${OS}/remove`),{withTypes:()=>lle}),gze=(...t)=>{console.error(`${OS}/error`,...t)},Ew=(t={})=>{const e=new Map,r=new Map,n=g=>{const y=r.get(g)??0;r.set(g,y+1)},s=g=>{const y=r.get(g)??1;y===1?r.delete(g):r.set(g,y-1)},{extra:a,onError:o=gze}=t;tR(o);const l=g=>(g.unsubscribe=()=>e.delete(g.id),e.set(g.id,g),y=>{g.unsubscribe(),y?.cancelActive&&iP(g)}),c=g=>{const y=WW(e,g)??ale(g);return l(y)};jy(c,{withTypes:()=>c});const u=g=>{const y=WW(e,g);return y&&(y.unsubscribe(),g.cancelActive&&iP(y)),!!y};jy(u,{withTypes:()=>u});const h=async(g,y,v,w)=>{const N=new AbortController,k=fze(c,N.signal),C=[];try{g.pending.add(N),n(g),await Promise.resolve(g.effect(y,jy({},v,{getOriginalState:w,condition:(I,O)=>k(I,O).then(Boolean),take:k,delay:sle(N.signal),pause:xk(N.signal),extra:a,signal:N.signal,fork:hze(N.signal,C),unsubscribe:g.unsubscribe,subscribe:()=>{e.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((I,O,L)=>{I!==N&&(I.abort(sP),L.delete(I))})},cancel:()=>{N.abort(sP),g.pending.delete(N)},throwIfCancelled:()=>{Lm(N.signal)}})))}catch(I){I instanceof LS||GW(o,I,{raisedBy:"effect"})}finally{await Promise.all(C),N.abort(uze),s(g),g.pending.delete(N)}},f=pze(e,r);return{middleware:g=>y=>v=>{if(!Doe(v))return y(v);if(ole.match(v))return c(v.payload);if(mze.match(v)){f();return}if(lle.match(v))return u(v.payload);let w=g.getState();const N=()=>{if(w===HW)throw new Error(Mc(23));return w};let k;try{if(k=y(v),e.size>0){const C=g.getState(),I=Array.from(e.values());for(const O of I){let L=!1;try{L=O.predicate(v,C,w)}catch(_){L=!1,GW(o,_,{raisedBy:"predicate"})}L&&h(O,v,g,N)}}}finally{w=HW}return k},startListening:c,stopListening:u,clearListeners:f}};function Mc(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var xze={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},cle=fc({name:"chartLayout",initialState:xze,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,s,a;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(s=e.payload.bottom)!==null&&s!==void 0?s:0,t.margin.left=(a=e.payload.left)!==null&&a!==void 0?a:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:yze,setLayout:bze,setChartSize:vze,setScale:wze}=cle.actions,Nze=cle.reducer;function ule(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function cs(t){return Number.isFinite(t)}function gp(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function KW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Qx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KW(Object(r),!0).forEach(function(n){jze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jze(t,e,r){return(e=kze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kze(t){var e=_ze(t,"string");return typeof e=="symbol"?e:e+""}function _ze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ui(t,e,r){return xo(t)||xo(e)?r:gh(e)?og(t,e,r):typeof e=="function"?e(t):r}var Sze=(t,e,r)=>{if(e&&r){var{width:n,height:s}=r,{align:a,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&a!=="center"&&Mr(t[a]))return Qx(Qx({},t),{},{[a]:t[a]+(n||0)});if((l==="horizontal"||l==="vertical"&&a==="center")&&o!=="middle"&&Mr(t[o]))return Qx(Qx({},t),{},{[o]:t[o]+(s||0)})}return t},Cp=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",Cze=(t,e)=>{if(!e||e.length!==2||!Mr(e[0])||!Mr(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),s=[t[0],t[1]];return(!Mr(t[0])||t[0]<r)&&(s[0]=r),(!Mr(t[1])||t[1]>n)&&(s[1]=n),s[0]>n&&(s[0]=n),s[1]<r&&(s[1]=r),s},Eze=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var s=0;s<n;++s)for(var a=0,o=0,l=0;l<r;++l){var c=t[l],u=c?.[s];if(u!=null){var h=u[1],f=u[0],m=mh(h)?f:h;m>=0?(u[0]=a,a+=m,u[1]=a):(u[0]=o,o+=m,u[1]=o)}}}},Aze=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var s=0;s<n;++s)for(var a=0,o=0;o<r;++o){var l=t[o],c=l?.[s];if(c!=null){var u=mh(c[1])?c[0]:c[1];u>=0?(c[0]=a,a+=u,c[1]=a):(c[0]=0,c[1]=0)}}}},Tze={sign:Eze,expand:KFe,none:ag,silhouette:YFe,wiggle:XFe,positive:Aze},Ize=(t,e,r)=>{var n,s=(n=Tze[r])!==null&&n!==void 0?n:ag,a=GFe().keys(e).value((l,c)=>Number(ui(l,c,0))).order(K8).offset(s),o=a(t);return o.forEach((l,c)=>{l.forEach((u,h)=>{var f=ui(t[h],e[c],0);Array.isArray(f)&&f.length===2&&Mr(f[0])&&Mr(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function Pze(t){return t==null?void 0:String(t)}var YW=t=>{var{axis:e,ticks:r,offset:n,bandSize:s,entry:a,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=ui(a,e.dataKey,e.scale.domain()[o]);if(xo(l))return null;var c=e.scale.map(l);return Mr(c)?c-s/2+n:null},Lze=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]);return n<=0&&s>=0?0:s<0?s:n}return r[0]},Oze=t=>{var e=t.flat(2).filter(Mr);return[Math.min(...e),Math.max(...e)]},Mze=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],Rze=(t,e,r)=>{if(t!=null)return Mze(Object.keys(t).reduce((n,s)=>{var a=t[s];if(!a)return n;var{stackedData:o}=a,l=o.reduce((c,u)=>{var h=ule(u,e,r),f=Oze(h);return!cs(f[0])||!cs(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},XW=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QW=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,yk=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var s=_S(e,h=>h.coordinate),a=1/0,o=1,l=s.length;o<l;o++){var c=s[o],u=s[o-1];a=Math.min((c?.coordinate||0)-(u?.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function JW(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:s,name:a}=t;return Qx(Qx({},e),{},{dataKey:r,payload:n,value:s,name:a})}function MS(t,e){if(t)return String(t);if(typeof e=="string")return e}var Dze=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},Bze=(t,e)=>e==="centric"?t.angle:t.radius,Vf=t=>t.layout.width,qf=t=>t.layout.height,Fze=t=>t.layout.scale,dle=t=>t.layout.margin,RS=et(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),DS=et(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),hle="data-recharts-item-index",fle="data-recharts-item-id",Aw=60;function ZW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function zN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZW(Object(r),!0).forEach(function(n){$ze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $ze(t,e,r){return(e=Uze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uze(t){var e=zze(t,"string");return typeof e=="symbol"?e:e+""}function zze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vze=t=>t.brush.height;function qze(t){var e=DS(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:Aw;return r+s}return r},0)}function Hze(t){var e=DS(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:Aw;return r+s}return r},0)}function Wze(t){var e=RS(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Gze(t){var e=RS(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ja=et([Vf,qf,dle,Vze,qze,Hze,Wze,Gze,Loe,bUe],(t,e,r,n,s,a,o,l,c,u)=>{var h={left:(r.left||0)+s,right:(r.right||0)+a},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},m=zN(zN({},f),h),g=m.bottom;m.bottom+=n,m=Sze(m,c,u);var y=t-m.left-m.right,v=e-m.top-m.bottom;return zN(zN({brushBottom:g},m),{},{width:Math.max(y,0),height:Math.max(v,0)})}),Kze=et(Ja,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),rR=et(Vf,qf,(t,e)=>({x:0,y:0,width:t,height:e})),Yze=b.createContext(null),$c=()=>b.useContext(Yze)!=null,BS=t=>t.brush,FS=et([BS,Ja,dle],(t,e,r)=>({height:t.height,x:Mr(t.x)?t.x:e.left,y:Mr(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:Mr(t.width)?t.width:e.width})),$6={},U6={},z6={},eG;function Xze(){return eG||(eG=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:s,edges:a}={}){let o,l=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),h=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&h(),v()};let m=null;const g=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},n)},y=()=>{m!==null&&(clearTimeout(m),m=null)},v=()=>{y(),o=void 0,l=null},w=()=>{h()},N=function(...k){if(s?.aborted)return;o=this,l=k;const C=m==null;g(),c&&C&&h()};return N.schedule=g,N.cancel=v,N.flush=w,s?.addEventListener("abort",v,{once:!0}),N}t.debounce=e})(z6)),z6}var tG;function Qze(){return tG||(tG=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Xze();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:o=!1,trailing:l=!0,maxWait:c}=a,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let h,f=null;const m=e.debounce(function(...v){h=n.apply(this,v),f=null},s,{edges:u}),g=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(h=n.apply(this,v),f=Date.now(),m.cancel(),m.schedule(),h):(m.apply(this,v),h)},y=()=>(m.flush(),h);return g.cancel=m.cancel,g.flush=y,g}t.debounce=r})(U6)),U6}var rG;function Jze(){return rG||(rG=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qze();function r(n,s=0,a={}){const{leading:o=!0,trailing:l=!0}=a;return e.debounce(n,s,{leading:o,maxWait:s,trailing:l})}t.throttle=r})($6)),$6}var V6,nG;function Zze(){return nG||(nG=1,V6=Jze().throttle),V6}var eVe=Zze();const tVe=Pl(eVe);var sG=function(e,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>s[o++]))}},eh={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},ple=(t,e,r)=>{var{width:n=eh.width,height:s=eh.height,aspect:a,maxHeight:o}=r,l=lg(n)?t:Number(n),c=lg(s)?e:Number(s);return a&&a>0&&(l?c=l/a:c&&(l=c*a),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},rVe={width:0,height:0,overflow:"visible"},nVe={width:0,overflowX:"visible"},sVe={height:0,overflowY:"visible"},iVe={},aVe=t=>{var{width:e,height:r}=t,n=lg(e),s=lg(r);return n&&s?rVe:n?nVe:s?sVe:iVe};function oVe(t){var{width:e,height:r,aspect:n}=t,s=e,a=r;return s===void 0&&a===void 0?(s=eh.width,a=eh.height):s===void 0?s=n&&n>0?void 0:eh.width:a===void 0&&(a=n&&n>0?void 0:eh.height),{width:s,height:a}}function aP(){return aP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aP.apply(null,arguments)}function iG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function aG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iG(Object(r),!0).forEach(function(n){lVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lVe(t,e,r){return(e=cVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cVe(t){var e=uVe(t,"string");return typeof e=="symbol"?e:e+""}function uVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mle=b.createContext(eh.initialDimension);function dVe(t){return gp(t.width)&&gp(t.height)}function gle(t){var{children:e,width:r,height:n}=t,s=b.useMemo(()=>({width:r,height:n}),[r,n]);return dVe(s)?b.createElement(mle.Provider,{value:s},e):null}var nR=()=>b.useContext(mle),hVe=b.forwardRef((t,e)=>{var{aspect:r,initialDimension:n=eh.initialDimension,width:s,height:a,minWidth:o=eh.minWidth,minHeight:l,maxHeight:c,children:u,debounce:h=eh.debounce,id:f,className:m,onResize:g,style:y={}}=t,v=b.useRef(null),w=b.useRef();w.current=g,b.useImperativeHandle(e,()=>v.current);var[N,k]=b.useState({containerWidth:n.width,containerHeight:n.height}),C=b.useCallback((E,M)=>{k(B=>{var S=Math.round(E),P=Math.round(M);return B.containerWidth===S&&B.containerHeight===P?B:{containerWidth:S,containerHeight:P}})},[]);b.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return wb;var E=P=>{var R,V=P[0];if(V!=null){var{width:ee,height:G}=V.contentRect;C(ee,G),(R=w.current)===null||R===void 0||R.call(w,ee,G)}};h>0&&(E=tVe(E,h,{trailing:!0,leading:!1}));var M=new ResizeObserver(E),{width:B,height:S}=v.current.getBoundingClientRect();return C(B,S),M.observe(v.current),()=>{M.disconnect()}},[C,h]);var{containerWidth:I,containerHeight:O}=N;sG(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:L,calculatedHeight:_}=ple(I,O,{width:s,height:a,aspect:r,maxHeight:c});return sG(L!=null&&L>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,L,_,s,a,o,l,r),b.createElement("div",{id:f?"".concat(f):void 0,className:js("recharts-responsive-container",m),style:aG(aG({},y),{},{width:s,height:a,minWidth:o,minHeight:l,maxHeight:c}),ref:v},b.createElement("div",{style:aVe({width:s,height:a})},b.createElement(gle,{width:L,height:_},u)))}),oG=b.forwardRef((t,e)=>{var r=nR();if(gp(r.width)&&gp(r.height))return t.children;var{width:n,height:s}=oVe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:a,calculatedHeight:o}=ple(void 0,void 0,{width:n,height:s,aspect:t.aspect,maxHeight:t.maxHeight});return Mr(a)&&Mr(o)?b.createElement(gle,{width:a,height:o},t.children):b.createElement(hVe,aP({},t,{width:n,height:s,ref:e}))});function sR(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var $S=()=>{var t,e=$c(),r=Ar(Kze),n=Ar(FS),s=(t=Ar(BS))===null||t===void 0?void 0:t.padding;return!e||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},fVe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pVe=()=>{var t;return(t=Ar(Ja))!==null&&t!==void 0?t:fVe},xle=()=>Ar(Vf),yle=()=>Ar(qf),mVe=()=>Ar(t=>t.layout.margin),fs=t=>t.layout.layoutType,Nb=()=>Ar(fs),ble=()=>{var t=Nb();if(t==="horizontal"||t==="vertical")return t},vle=t=>{var e=t.layout.layoutType;if(e==="centric"||e==="radial")return e},gVe=()=>{var t=Nb();return t!==void 0},Tw=t=>{var e=Zs(),r=$c(),{width:n,height:s}=t,a=nR(),o=n,l=s;return a&&(o=a.width>0?a.width:n,l=a.height>0?a.height:s),b.useEffect(()=>{!r&&gp(o)&&gp(l)&&e(vze({width:o,height:l}))},[e,r,o,l]),null},wle=Symbol.for("immer-nothing"),lG=Symbol.for("immer-draftable"),Dc=Symbol.for("immer-state");function Ju(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var I2=Object.getPrototypeOf;function Xy(t){return!!t&&!!t[Dc]}function ug(t){return t?Nle(t)||Array.isArray(t)||!!t[lG]||!!t.constructor?.[lG]||Iw(t)||zS(t):!1}var xVe=Object.prototype.constructor.toString(),cG=new WeakMap;function Nle(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=cG.get(r);return n===void 0&&(n=Function.toString.call(r),cG.set(r,n)),n===xVe}function bk(t,e,r=!0){US(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(s=>{e(s,t[s],t)}):t.forEach((n,s)=>e(s,n,t))}function US(t){const e=t[Dc];return e?e.type_:Array.isArray(t)?1:Iw(t)?2:zS(t)?3:0}function oP(t,e){return US(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function jle(t,e,r){const n=US(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function yVe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Iw(t){return t instanceof Map}function zS(t){return t instanceof Set}function im(t){return t.copy_||t.base_}function lP(t,e){if(Iw(t))return new Map(t);if(zS(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Nle(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Dc];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const o=s[a],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(I2(t),n)}else{const n=I2(t);if(n!==null&&r)return{...t};const s=Object.create(n);return Object.assign(s,t)}}function iR(t,e=!1){return VS(t)||Xy(t)||!ug(t)||(US(t)>1&&Object.defineProperties(t,{set:VN,add:VN,clear:VN,delete:VN}),Object.freeze(t),e&&Object.values(t).forEach(r=>iR(r,!0))),t}function bVe(){Ju(2)}var VN={value:bVe};function VS(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var vVe={};function dg(t){const e=vVe[t];return e||Ju(0,t),e}var P2;function kle(){return P2}function wVe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function uG(t,e){e&&(dg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function cP(t){uP(t),t.drafts_.forEach(NVe),t.drafts_=null}function uP(t){t===P2&&(P2=t.parent_)}function dG(t){return P2=wVe(P2,t)}function NVe(t){const e=t[Dc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function hG(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Dc].modified_&&(cP(e),Ju(4)),ug(t)&&(t=vk(e,t),e.parent_||wk(e,t)),e.patches_&&dg("Patches").generateReplacementPatches_(r[Dc].base_,t,e.patches_,e.inversePatches_)):t=vk(e,r,[]),cP(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==wle?t:void 0}function vk(t,e,r){if(VS(e))return e;const n=t.immer_.shouldUseStrictIteration(),s=e[Dc];if(!s)return bk(e,(a,o)=>fG(t,s,e,a,o,r),n),e;if(s.scope_!==t)return e;if(!s.modified_)return wk(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const a=s.copy_;let o=a,l=!1;s.type_===3&&(o=new Set(a),a.clear(),l=!0),bk(o,(c,u)=>fG(t,s,a,c,u,r,l),n),wk(t,a,!1),r&&t.patches_&&dg("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function fG(t,e,r,n,s,a,o){if(s==null||typeof s!="object"&&!o)return;const l=VS(s);if(!(l&&!o)){if(Xy(s)){const c=a&&e&&e.type_!==3&&!oP(e.assigned_,n)?a.concat(n):void 0,u=vk(t,s,c);if(jle(r,n,u),Xy(u))t.canAutoFreeze_=!1;else return}else o&&r.add(s);if(ug(s)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===s&&l)return;vk(t,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(Iw(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&wk(t,s)}}}function wk(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&iR(e,r)}function jVe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:kle(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=aR;r&&(s=[n],a=L2);const{revoke:o,proxy:l}=Proxy.revocable(s,a);return n.draft_=l,n.revoke_=o,l}var aR={get(t,e){if(e===Dc)return t;const r=im(t);if(!oP(r,e))return kVe(t,r,e);const n=r[e];return t.finalized_||!ug(n)?n:n===q6(t.base_,e)?(H6(t),t.copy_[e]=hP(n,t)):n},has(t,e){return e in im(t)},ownKeys(t){return Reflect.ownKeys(im(t))},set(t,e,r){const n=_le(im(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const s=q6(im(t),e),a=s?.[Dc];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(yVe(r,s)&&(r!==void 0||oP(t.base_,e)))return!0;H6(t),dP(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return q6(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,H6(t),dP(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=im(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Ju(11)},getPrototypeOf(t){return I2(t.base_)},setPrototypeOf(){Ju(12)}},L2={};bk(aR,(t,e)=>{L2[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});L2.deleteProperty=function(t,e){return L2.set.call(this,t,e,void 0)};L2.set=function(t,e,r){return aR.set.call(this,t[0],e,r,t[0])};function q6(t,e){const r=t[Dc];return(r?im(r):t)[e]}function kVe(t,e,r){const n=_le(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function _le(t,e){if(!(e in t))return;let r=I2(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=I2(r)}}function dP(t){t.modified_||(t.modified_=!0,t.parent_&&dP(t.parent_))}function H6(t){t.copy_||(t.copy_=lP(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var _Ve=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const o=this;return function(c=a,...u){return o.produce(c,h=>r.call(this,h,...u))}}typeof r!="function"&&Ju(6),n!==void 0&&typeof n!="function"&&Ju(7);let s;if(ug(e)){const a=dG(this),o=hP(e,void 0);let l=!0;try{s=r(o),l=!1}finally{l?cP(a):uP(a)}return uG(a,n),hG(s,a)}else if(!e||typeof e!="object"){if(s=r(e),s===void 0&&(s=e),s===wle&&(s=void 0),this.autoFreeze_&&iR(s,!0),n){const a=[],o=[];dg("Patches").generateReplacementPatches_(e,s,a,o),n(a,o)}return s}else Ju(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,s;return[this.produce(e,r,(o,l)=>{n=o,s=l}),n,s]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){ug(t)||Ju(8),Xy(t)&&(t=SVe(t));const e=dG(this),r=hP(t,void 0);return r[Dc].isManual_=!0,uP(e),r}finishDraft(t,e){const r=t&&t[Dc];(!r||!r.isManual_)&&Ju(9);const{scope_:n}=r;return uG(n,e),hG(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const s=e[r];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}r>-1&&(e=e.slice(r+1));const n=dg("Patches").applyPatches_;return Xy(t)?n(t,e):this.produce(t,s=>n(s,e))}};function hP(t,e){const r=Iw(t)?dg("MapSet").proxyMap_(t,e):zS(t)?dg("MapSet").proxySet_(t,e):jVe(t,e);return(e?e.scope_:kle()).drafts_.push(r),r}function SVe(t){return Xy(t)||Ju(10,t),Sle(t)}function Sle(t){if(!ug(t)||VS(t))return t;const e=t[Dc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=lP(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=lP(t,!0);return bk(r,(s,a)=>{jle(r,s,Sle(a))},n),e&&(e.finalized_=!1),r}var CVe=new _Ve;CVe.produce;var EVe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Cle=fc({name:"legend",initialState:EVe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:ji()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,s=cd(t).payload.indexOf(r);s>-1&&(t.payload[s]=n)},prepare:ji()},removeLegendPayload:{reducer(t,e){var r=cd(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:ji()}}}),{setLegendSize:pG,setLegendSettings:AVe,addLegendPayload:Ele,replaceLegendPayload:Ale,removeLegendPayload:Tle}=Cle.actions,TVe=Cle.reducer,IVe=["contextPayload"];function fP(){return fP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fP.apply(null,arguments)}function mG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Qy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mG(Object(r),!0).forEach(function(n){PVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PVe(t,e,r){return(e=LVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LVe(t){var e=OVe(t,"string");return typeof e=="symbol"?e:e+""}function OVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MVe(t,e){if(t==null)return{};var r,n,s=RVe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function RVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function DVe(t){return t.value}function BVe(t){var{contextPayload:e}=t,r=MVe(t,IVe),n=Aoe(e,t.payloadUniqBy,DVe),s=Qy(Qy({},r),{},{payload:n});return b.isValidElement(t.content)?b.cloneElement(t.content,s):typeof t.content=="function"?b.createElement(t.content,s):b.createElement(C$e,s)}function FVe(t,e,r,n,s,a){var{layout:o,align:l,verticalAlign:c}=e,u,h;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-a.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?h={top:((s||0)-a.height)/2}:h=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Qy(Qy({},u),h)}function $Ve(t){var e=Zs();return b.useEffect(()=>{e(AVe(t))},[e,t]),null}function UVe(t){var e=Zs();return b.useEffect(()=>(e(pG(t)),()=>{e(pG({width:0,height:0}))}),[e,t]),null}function zVe(t,e,r,n){return t==="vertical"&&e!=null?{height:e}:t==="horizontal"?{width:r||n}:null}var VVe={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function Ile(t){var e=Go(t,VVe),r=NUe(),n=xFe(),s=mVe(),{width:a,height:o,wrapperStyle:l,portal:c}=e,[u,h]=Ooe([r]),f=xle(),m=yle();if(f==null||m==null)return null;var g=f-(s?.left||0)-(s?.right||0),y=zVe(e.layout,o,a,g),v=c?l:Qy(Qy({position:"absolute",width:y?.width||a||"auto",height:y?.height||o||"auto"},FVe(l,e,s,f,m,u)),l),w=c??n;if(w==null||r==null)return null;var N=b.createElement("div",{className:"recharts-legend-wrapper",style:v,ref:h},b.createElement($Ve,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&b.createElement(UVe,{width:u.width,height:u.height}),b.createElement(BVe,fP({},e,y,{margin:s,chartWidth:f,chartHeight:m,contextPayload:r})));return Kn.createPortal(N,w)}Ile.displayName="Legend";function pP(){return pP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pP.apply(null,arguments)}function gG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Dv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gG(Object(r),!0).forEach(function(n){qVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qVe(t,e,r){return(e=HVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HVe(t){var e=WVe(t,"string");return typeof e=="symbol"?e:e+""}function WVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GVe(t){return Array.isArray(t)&&gh(t[0])&&gh(t[1])?t.join(" ~ "):t}var Ex={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},KVe=t=>{var{separator:e=Ex.separator,contentStyle:r,itemStyle:n,labelStyle:s=Ex.labelStyle,payload:a,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:h,labelFormatter:f,accessibilityLayer:m=Ex.accessibilityLayer}=t,g=()=>{if(a&&a.length){var O={padding:0,margin:0},L=(l?_S(a,l):a).map((_,E)=>{if(_.type==="none")return null;var M=_.formatter||o||GVe,{value:B,name:S}=_,P=B,R=S;if(M){var V=M(B,S,_,E,a);if(Array.isArray(V))[P,R]=V;else if(V!=null)P=V;else return null}var ee=Dv(Dv({},Ex.itemStyle),{},{color:_.color||Ex.itemStyle.color},n);return b.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(E),style:ee},gh(R)?b.createElement("span",{className:"recharts-tooltip-item-name"},R):null,gh(R)?b.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,b.createElement("span",{className:"recharts-tooltip-item-value"},P),b.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return b.createElement("ul",{className:"recharts-tooltip-item-list",style:O},L)}return null},y=Dv(Dv({},Ex.contentStyle),r),v=Dv({margin:0},s),w=!xo(h),N=w?h:"",k=js("recharts-default-tooltip",c),C=js("recharts-tooltip-label",u);w&&f&&a!==void 0&&a!==null&&(N=f(h,a));var I=m?{role:"status","aria-live":"assertive"}:{};return b.createElement("div",pP({className:k,style:y},I),b.createElement("p",{className:C,style:v},b.isValidElement(N)?N:"".concat(N)),g())},Bv="recharts-tooltip-wrapper",YVe={visibility:"hidden"};function XVe(t){var{coordinate:e,translateX:r,translateY:n}=t;return js(Bv,{["".concat(Bv,"-right")]:Mr(r)&&e&&Mr(e.x)&&r>=e.x,["".concat(Bv,"-left")]:Mr(r)&&e&&Mr(e.x)&&r<e.x,["".concat(Bv,"-bottom")]:Mr(n)&&e&&Mr(e.y)&&n>=e.y,["".concat(Bv,"-top")]:Mr(n)&&e&&Mr(e.y)&&n<e.y})}function xG(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offset:s,position:a,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(a&&Mr(a[n]))return a[n];var h=r[n]-l-(s>0?s:0),f=r[n]+s;if(e[n])return o[n]?h:f;var m=c[n];if(m==null)return 0;if(o[n]){var g=h,y=m;return g<y?Math.max(f,m):Math.max(h,m)}if(u==null)return 0;var v=f+l,w=m+u;return v>w?Math.max(h,m):Math.max(f,m)}function QVe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function JVe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTop:n,offsetLeft:s,position:a,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=t,h,f,m;return l.height>0&&l.width>0&&r?(f=xG({allowEscapeViewBox:e,coordinate:r,key:"x",offset:s,position:a,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),m=xG({allowEscapeViewBox:e,coordinate:r,key:"y",offset:n,position:a,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),h=QVe({translateX:f,translateY:m,useTranslate3d:c})):h=YVe,{cssProperties:h,cssClasses:XVe({translateX:f,translateY:m,coordinate:r})}}function yG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function qN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yG(Object(r),!0).forEach(function(n){mP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mP(t,e,r){return(e=ZVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZVe(t){var e=eqe(t,"string");return typeof e=="symbol"?e:e+""}function eqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tqe extends b.PureComponent{constructor(){super(...arguments),mP(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),mP(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:h,reverseDirection:f,useTranslate3d:m,viewBox:g,wrapperStyle:y,lastBoundingBox:v,innerRef:w,hasPortalFromProps:N}=this.props,k=typeof u=="number"?u:u.x,C=typeof u=="number"?u:u.y,{cssClasses:I,cssProperties:O}=JVe({allowEscapeViewBox:r,coordinate:o,offsetLeft:k,offsetTop:C,position:h,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:m,viewBox:g}),L=N?{}:qN(qN({transition:c&&e?"transform ".concat(n,"ms ").concat(s):void 0},O),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),_=qN(qN({},L),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},y);return b.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:I,style:_,ref:w},a)}}var Ple=()=>{var t;return(t=Ar(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function gP(){return gP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gP.apply(null,arguments)}function bG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function vG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bG(Object(r),!0).forEach(function(n){rqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rqe(t,e,r){return(e=nqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nqe(t){var e=sqe(t,"string");return typeof e=="symbol"?e:e+""}function sqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wG={curveBasisClosed:RFe,curveBasisOpen:DFe,curveBasis:MFe,curveBumpX:wFe,curveBumpY:NFe,curveLinearClosed:BFe,curveLinear:jS,curveMonotoneX:FFe,curveMonotoneY:$Fe,curveNatural:UFe,curveStep:zFe,curveStepAfter:qFe,curveStepBefore:VFe},Nk=t=>cs(t.x)&&cs(t.y),NG=t=>t.base!=null&&Nk(t.base)&&Nk(t),Fv=t=>t.x,$v=t=>t.y,iqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(_w(t));if((r==="curveMonotone"||r==="curveBump")&&e){var n=wG["".concat(r).concat(e==="vertical"?"Y":"X")];if(n)return n}return wG[r]||jS},jG={connectNulls:!1,type:"linear"},aqe=t=>{var{type:e=jG.type,points:r=[],baseLine:n,layout:s,connectNulls:a=jG.connectNulls}=t,o=iqe(e,s),l=a?r.filter(Nk):r;if(Array.isArray(n)){var c,u=r.map((y,v)=>vG(vG({},y),{},{base:n[v]}));s==="vertical"?c=RN().y($v).x1(Fv).x0(y=>y.base.x):c=RN().x(Fv).y1($v).y0(y=>y.base.y);var h=c.defined(NG).curve(o),f=a?u.filter(NG):u;return h(f)}var m;s==="vertical"&&Mr(n)?m=RN().y($v).x1(Fv).x0(n):Mr(n)?m=RN().x(Fv).y1($v).y0(n):m=aoe().x(Fv).y($v);var g=m.defined(Nk).curve(o);return g(l)},oR=t=>{var{className:e,points:r,path:n,pathRef:s}=t,a=Nb();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||a,connectNulls:t.connectNulls},l=r&&r.length?aqe(o):n;return b.createElement("path",gP({},ph(t),p$e(t),{className:js("recharts-curve",e),d:l===null?void 0:l,ref:s}))},oqe=["x","y","top","left","width","height","className"];function xP(){return xP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xP.apply(null,arguments)}function kG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function lqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kG(Object(r),!0).forEach(function(n){cqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cqe(t,e,r){return(e=uqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uqe(t){var e=dqe(t,"string");return typeof e=="symbol"?e:e+""}function dqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hqe(t,e){if(t==null)return{};var r,n,s=fqe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function fqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var pqe=(t,e,r,n,s,a)=>"M".concat(t,",").concat(s,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),mqe=t=>{var{x:e=0,y:r=0,top:n=0,left:s=0,width:a=0,height:o=0,className:l}=t,c=hqe(t,oqe),u=lqe({x:e,y:r,top:n,left:s,width:a,height:o},c);return!Mr(e)||!Mr(r)||!Mr(a)||!Mr(o)||!Mr(n)||!Mr(s)?null:b.createElement("path",xP({},Nu(u),{className:js("recharts-cross",l),d:pqe(e,r,a,o,n,s)}))};function gqe(t,e,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-s:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-s,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function _G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function SG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_G(Object(r),!0).forEach(function(n){xqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_G(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xqe(t,e,r){return(e=yqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yqe(t){var e=bqe(t,"string");return typeof e=="symbol"?e:e+""}function bqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),Lle=(t,e,r)=>t.map(n=>"".concat(vqe(n)," ").concat(e,"ms ").concat(r)).join(","),wqe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(s=>n.includes(s))),O2=(t,e)=>Object.keys(e).reduce((r,n)=>SG(SG({},r),{},{[n]:t(n,e[n])}),{});function CG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function qa(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CG(Object(r),!0).forEach(function(n){Nqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nqe(t,e,r){return(e=jqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jqe(t){var e=kqe(t,"string");return typeof e=="symbol"?e:e+""}function kqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jk=(t,e,r)=>t+(e-t)*r,yP=t=>{var{from:e,to:r}=t;return e!==r},Ole=(t,e,r)=>{var n=O2((s,a)=>{if(yP(a)){var[o,l]=t(a.from,a.to,a.velocity);return qa(qa({},a),{},{from:o,velocity:l})}return a},e);return r<1?O2((s,a)=>yP(a)&&n[s]!=null?qa(qa({},a),{},{velocity:jk(a.velocity,n[s].velocity,r),from:jk(a.from,n[s].from,r)}):a,e):Ole(t,n,r-1)};function _qe(t,e,r,n,s,a){var o,l=n.reduce((m,g)=>qa(qa({},m),{},{[g]:{from:t[g],velocity:0,to:e[g]}}),{}),c=()=>O2((m,g)=>g.from,l),u=()=>!Object.values(l).filter(yP).length,h=null,f=m=>{o||(o=m);var g=m-o,y=g/r.dt;l=Ole(r,l,y),s(qa(qa(qa({},t),e),c())),o=m,u()||(h=a.setTimeout(f))};return()=>(h=a.setTimeout(f),()=>{var m;(m=h)===null||m===void 0||m()})}function Sqe(t,e,r,n,s,a,o){var l=null,c=s.reduce((f,m)=>{var g=t[m],y=e[m];return g==null||y==null?f:qa(qa({},f),{},{[m]:[g,y]})},{}),u,h=f=>{u||(u=f);var m=(f-u)/n,g=O2((v,w)=>jk(...w,r(m)),c);if(a(qa(qa(qa({},t),e),g)),m<1)l=o.setTimeout(h);else{var y=O2((v,w)=>jk(...w,r(1)),c);a(qa(qa(qa({},t),e),y))}};return()=>(l=o.setTimeout(h),()=>{var f;(f=l)===null||f===void 0||f()})}const Cqe=(t,e,r,n,s,a)=>{var o=wqe(t,e);return r==null?()=>(s(qa(qa({},t),e)),()=>{}):r.isStepper===!0?_qe(t,e,r,o,s,a):Sqe(t,e,r,n,o,s,a)};var kk=1e-4,Mle=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Rle=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),EG=(t,e)=>r=>{var n=Mle(t,e);return Rle(n,r)},Eqe=(t,e)=>r=>{var n=Mle(t,e),s=[...n.map((a,o)=>a*o).slice(1),0];return Rle(s,r)},Aqe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var s=n.map(a=>parseFloat(a));return[s[0],s[1],s[2],s[3]]},Tqe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var s=Aqe(r[0]);if(s)return s}}return r.length===4?r:[0,0,1,1]},Iqe=(t,e,r,n)=>{var s=EG(t,r),a=EG(e,n),o=Eqe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var h=u>1?1:u,f=h,m=0;m<8;++m){var g=s(f)-h,y=o(f);if(Math.abs(g-h)<kk||y<kk)return a(f);f=l(f-g/y)}return a(f)};return c.isStepper=!1,c},AG=function(){return Iqe(...Tqe(...arguments))},Pqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=e,a=(o,l,c)=>{var u=-(o-l)*r,h=c*n,f=c+(u-h)*s/1e3,m=c*s/1e3+o;return Math.abs(m-l)<kk&&Math.abs(f)<kk?[l,0]:[m,f]};return a.isStepper=!0,a.dt=s,a},Lqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return AG(t);case"spring":return Pqe();default:if(t.split("(")[0]==="cubic-bezier")return AG(t)}return typeof t=="function"?t:null};function Oqe(t){var e,r=()=>null,n=!1,s=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){s=t.setTimeout(a.bind(null,u),c);return}a(c),s=t.setTimeout(a.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,s&&(s(),s=null),a(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class Mqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{s!=null&&cancelAnimationFrame(s)}}}function Rqe(){return Oqe(new Mqe)}var Dqe=b.createContext(Rqe);function Bqe(t,e){var r=b.useContext(Dqe);return b.useMemo(()=>e??r(t),[t,e,r])}var Fqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),qS={isSsr:Fqe()},$qe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},TG={t:0},W6={t:1};function HS(t){var e=Go(t,$qe),{isActive:r,canBegin:n,duration:s,easing:a,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,h=r==="auto"?!qS.isSsr:r,f=Bqe(e.animationId,e.animationManager),[m,g]=b.useState(h?TG:W6),y=b.useRef(null);return b.useEffect(()=>{h||g(W6)},[h]),b.useEffect(()=>{if(!h||!n)return wb;var v=Cqe(TG,W6,Lqe(a),s,g,f.getTimeoutController()),w=()=>{y.current=v()};return f.start([c,o,w,s,l]),()=>{f.stop(),y.current&&y.current(),l()}},[h,n,s,a,o,c,l,f]),u(m.t)}function WS(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=b.useRef(C2(e)),n=b.useRef(t);return n.current!==t&&(r.current=C2(e),n.current=t),r.current}var Uqe=["radius"],zqe=["radius"],IG,PG,LG,OG,MG,RG,DG,BG,FG,$G;function UG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function zG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UG(Object(r),!0).forEach(function(n){Vqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Vqe(t,e,r){return(e=qqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qqe(t){var e=Hqe(t,"string");return typeof e=="symbol"?e:e+""}function Hqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _k(){return _k=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_k.apply(null,arguments)}function VG(t,e){if(t==null)return{};var r,n,s=Wqe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Wqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Fd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var qG=(t,e,r,n,s)=>{var a=Y0(r),o=Y0(n),l=Math.min(Math.abs(a)/2,Math.abs(o)/2),c=o>=0?1:-1,u=a>=0?1:-1,h=o>=0&&a>=0||o<0&&a<0?1:0,f;if(l>0&&Array.isArray(s)){for(var m=[0,0,0,0],g=0,y=4;g<y;g++){var v,w=(v=s[g])!==null&&v!==void 0?v:0;m[g]=w>l?l:w}f=Ji(IG||(IG=Fd(["M",",",""])),t,e+c*m[0]),m[0]>0&&(f+=Ji(PG||(PG=Fd(["A ",",",",0,0,",",",",",""])),m[0],m[0],h,t+u*m[0],e)),f+=Ji(LG||(LG=Fd(["L ",",",""])),t+r-u*m[1],e),m[1]>0&&(f+=Ji(OG||(OG=Fd(["A ",",",",0,0,",`,
        `,",",""])),m[1],m[1],h,t+r,e+c*m[1])),f+=Ji(MG||(MG=Fd(["L ",",",""])),t+r,e+n-c*m[2]),m[2]>0&&(f+=Ji(RG||(RG=Fd(["A ",",",",0,0,",`,
        `,",",""])),m[2],m[2],h,t+r-u*m[2],e+n)),f+=Ji(DG||(DG=Fd(["L ",",",""])),t+u*m[3],e+n),m[3]>0&&(f+=Ji(BG||(BG=Fd(["A ",",",",0,0,",`,
        `,",",""])),m[3],m[3],h,t,e+n-c*m[3])),f+="Z"}else if(l>0&&s===+s&&s>0){var N=Math.min(l,s);f=Ji(FG||(FG=Fd(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*N,N,N,h,t+u*N,e,t+r-u*N,e,N,N,h,t+r,e+c*N,t+r,e+n-c*N,N,N,h,t+r-u*N,e+n,t+u*N,e+n,N,N,h,t,e+n-c*N)}else f=Ji($G||($G=Fd(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},HG={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Dle=t=>{var e=Go(t,HG),r=b.useRef(null),[n,s]=b.useState(-1);b.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var J=r.current.getTotalLength();J&&s(J)}catch{}},[]);var{x:a,y:o,width:l,height:c,radius:u,className:h}=e,{animationEasing:f,animationDuration:m,animationBegin:g,isAnimationActive:y,isUpdateAnimationActive:v}=e,w=b.useRef(l),N=b.useRef(c),k=b.useRef(a),C=b.useRef(o),I=b.useMemo(()=>({x:a,y:o,width:l,height:c,radius:u}),[a,o,l,c,u]),O=WS(I,"rectangle-");if(a!==+a||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var L=js("recharts-rectangle",h);if(!v){var _=Nu(e),{radius:E}=_,M=VG(_,Uqe);return b.createElement("path",_k({},M,{x:Y0(a),y:Y0(o),width:Y0(l),height:Y0(c),radius:typeof u=="number"?u:void 0,className:L,d:qG(a,o,l,c,u)}))}var B=w.current,S=N.current,P=k.current,R=C.current,V="0px ".concat(n===-1?1:n,"px"),ee="".concat(n,"px 0px"),G=Lle(["strokeDasharray"],m,typeof f=="string"?f:HG.animationEasing);return b.createElement(HS,{animationId:O,key:O,canBegin:n>0,duration:m,easing:f,isActive:v,begin:g},J=>{var Z=Va(B,l,J),se=Va(S,c,J),X=Va(P,a,J),q=Va(R,o,J);r.current&&(w.current=Z,N.current=se,k.current=X,C.current=q);var U;y?J>0?U={transition:G,strokeDasharray:ee}:U={strokeDasharray:V}:U={strokeDasharray:ee};var H=Nu(e),{radius:re}=H,ae=VG(H,zqe);return b.createElement("path",_k({},ae,{radius:typeof u=="number"?u:void 0,className:L,d:qG(X,q,Z,se,u),ref:r,style:zG(zG({},U),e.style)}))})};function WG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function GG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WG(Object(r),!0).forEach(function(n){Gqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Gqe(t,e,r){return(e=Kqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kqe(t){var e=Yqe(t,"string");return typeof e=="symbol"?e:e+""}function Yqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Sk=Math.PI/180,Xqe=t=>t*180/Math.PI,_a=(t,e,r,n)=>({x:t+Math.cos(-Sk*n)*r,y:e+Math.sin(-Sk*n)*r}),Ble=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Qqe=(t,e)=>{var{x:r,y:n}=t,{x:s,y:a}=e;return Math.sqrt((r-s)**2+(n-a)**2)},Jqe=(t,e)=>{var{x:r,y:n}=t,{cx:s,cy:a}=e,o=Qqe({x:r,y:n},{x:s,y:a});if(o<=0)return{radius:o,angle:0};var l=(r-s)/o,c=Math.acos(l);return n>a&&(c=2*Math.PI-c),{radius:o,angle:Xqe(c),angleInRadian:c}},Zqe=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:e-a*360,endAngle:r-a*360}},eHe=(t,e)=>{var{startAngle:r,endAngle:n}=e,s=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(s,a);return t+o*360},tHe=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:s,angle:a}=Jqe({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(s<o||s>l||s===0)return null;var{startAngle:c,endAngle:u}=Zqe(e),h=a,f;if(c<=u){for(;h>u;)h-=360;for(;h<c;)h+=360;f=h>=c&&h<=u}else{for(;h>c;)h-=360;for(;h<u;)h+=360;f=h>=u&&h<=c}return f?GG(GG({},e),{},{radius:s,angle:eHe(h,e)}):null};function Fle(t){var{cx:e,cy:r,radius:n,startAngle:s,endAngle:a}=t,o=_a(e,r,n,s),l=_a(e,r,n,a);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:s,endAngle:a}}var KG,YG,XG,QG,JG,ZG,eK;function bP(){return bP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bP.apply(null,arguments)}function wm(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var rHe=(t,e)=>{var r=Ho(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},HN=t=>{var{cx:e,cy:r,radius:n,angle:s,sign:a,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,h=Math.asin(l/u)/Sk,f=c?s:s+a*h,m=_a(e,r,u,f),g=_a(e,r,n,f),y=c?s-a*h:s,v=_a(e,r,u*Math.cos(h*Sk),y);return{center:m,circleTangency:g,lineTangency:v,theta:h}},$le=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:o}=t,l=rHe(a,o),c=a+l,u=_a(e,r,s,a),h=_a(e,r,s,c),f=Ji(KG||(KG=wm(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,s,s,+(Math.abs(l)>180),+(a>c),h.x,h.y);if(n>0){var m=_a(e,r,n,a),g=_a(e,r,n,c);f+=Ji(YG||(YG=wm(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),g.x,g.y,n,n,+(Math.abs(l)>180),+(a<=c),m.x,m.y)}else f+=Ji(XG||(XG=wm(["L ",","," Z"])),e,r);return f},nHe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,h=Ho(u-c),{circleTangency:f,lineTangency:m,theta:g}=HN({cx:e,cy:r,radius:s,angle:c,sign:h,cornerRadius:a,cornerIsExternal:l}),{circleTangency:y,lineTangency:v,theta:w}=HN({cx:e,cy:r,radius:s,angle:u,sign:-h,cornerRadius:a,cornerIsExternal:l}),N=l?Math.abs(c-u):Math.abs(c-u)-g-w;if(N<0)return o?Ji(QG||(QG=wm(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),m.x,m.y,a,a,a*2,a,a,-a*2):$le({cx:e,cy:r,innerRadius:n,outerRadius:s,startAngle:c,endAngle:u});var k=Ji(JG||(JG=wm(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),m.x,m.y,a,a,+(h<0),f.x,f.y,s,s,+(N>180),+(h<0),y.x,y.y,a,a,+(h<0),v.x,v.y);if(n>0){var{circleTangency:C,lineTangency:I,theta:O}=HN({cx:e,cy:r,radius:n,angle:c,sign:h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),{circleTangency:L,lineTangency:_,theta:E}=HN({cx:e,cy:r,radius:n,angle:u,sign:-h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-O-E;if(M<0&&a===0)return"".concat(k,"L").concat(e,",").concat(r,"Z");k+=Ji(ZG||(ZG=wm(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),_.x,_.y,a,a,+(h<0),L.x,L.y,n,n,+(M>180),+(h>0),C.x,C.y,a,a,+(h<0),I.x,I.y)}else k+=Ji(eK||(eK=wm(["L",",","Z"])),e,r);return k},sHe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Ule=t=>{var e=Go(t,sHe),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h,className:f}=e;if(a<s||u===h)return null;var m=js("recharts-sector",f),g=a-s,y=dl(o,g,0,!0),v;return y>0&&Math.abs(u-h)<360?v=nHe({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(y,g/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h}):v=$le({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:h}),b.createElement("path",bP({},Nu(e),{className:m,d:v}))};function iHe(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(voe(e)){if(t==="centric"){var{cx:n,cy:s,innerRadius:a,outerRadius:o,angle:l}=e,c=_a(n,s,a,l),u=_a(n,s,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Fle(e)}}var G6={},K6={},Y6={},tK;function aHe(){return tK||(tK=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ioe();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Y6)),Y6}var rK;function oHe(){return rK||(rK=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aHe();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(K6)),K6}var nK;function lHe(){return nK||(nK=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Poe(),r=oHe();function n(s,a,o){o&&typeof o!="number"&&e.isIterateeCall(s,a,o)&&(a=o=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),o=o===void 0?s<a?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((a-s)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=s,s+=o;return c}t.range=n})(G6)),G6}var X6,sK;function cHe(){return sK||(sK=1,X6=lHe().range),X6}var uHe=cHe();const zle=Pl(uHe);function ap(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function dHe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lR(t){let e,r,n;t.length!==2?(e=ap,r=(l,c)=>ap(t(l),c),n=(l,c)=>t(l)-c):(e=t===ap||t===dHe?t:hHe,r=t,n=t);function s(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;r(l[f],c)<0?u=f+1:h=f}while(u<h)}return u}function a(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;r(l[f],c)<=0?u=f+1:h=f}while(u<h)}return u}function o(l,c,u=0,h=l.length){const f=s(l,c,u,h-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:s,center:o,right:a}}function hHe(){return 0}function Vle(t){return t===null?NaN:+t}function*fHe(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const pHe=lR(ap),Pw=pHe.right;lR(Vle).center;class iK extends Map{constructor(e,r=xHe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,s]of e)this.set(n,s)}get(e){return super.get(aK(this,e))}has(e){return super.has(aK(this,e))}set(e,r){return super.set(mHe(this,e),r)}delete(e){return super.delete(gHe(this,e))}}function aK({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function mHe({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function gHe({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function xHe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function yHe(t=ap){if(t===ap)return qle;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function qle(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const bHe=Math.sqrt(50),vHe=Math.sqrt(10),wHe=Math.sqrt(2);function Ck(t,e,r){const n=(e-t)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),o=a>=bHe?10:a>=vHe?5:a>=wHe?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,s)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?Ck(t,e,r*2):[l,c,u]}function vP(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[s,a,o]=n?Ck(e,t,r):Ck(t,e,r);if(!(a>=s))return[];const l=a-s+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(a-u)/-o;else for(let u=0;u<l;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(s+u)/-o;else for(let u=0;u<l;++u)c[u]=(s+u)*o;return c}function wP(t,e,r){return e=+e,t=+t,r=+r,Ck(t,e,r)[2]}function NP(t,e,r){e=+e,t=+t,r=+r;const n=e<t,s=n?wP(e,t,r):wP(t,e,r);return(n?-1:1)*(s<0?1/-s:s)}function oK(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function lK(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Hle(t,e,r=0,n=1/0,s){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(s=s===void 0?qle:yHe(s);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,h=Math.log(c),f=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*f*(c-f)/c)*(u-c/2<0?-1:1),g=Math.max(r,Math.floor(e-u*f/c+m)),y=Math.min(n,Math.floor(e+(c-u)*f/c+m));Hle(t,e,g,y,s)}const a=t[e];let o=r,l=n;for(Uv(t,r,e),s(t[n],a)>0&&Uv(t,r,n);o<l;){for(Uv(t,o,l),++o,--l;s(t[o],a)<0;)++o;for(;s(t[l],a)>0;)--l}s(t[r],a)===0?Uv(t,r,l):(++l,Uv(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Uv(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function NHe(t,e,r){if(t=Float64Array.from(fHe(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return lK(t);if(e>=1)return oK(t);var n,s=(n-1)*e,a=Math.floor(s),o=oK(Hle(t,a).subarray(0,a+1)),l=lK(t.subarray(a+1));return o+(l-o)*(s-a)}}function jHe(t,e,r=Vle){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,s=(n-1)*e,a=Math.floor(s),o=+r(t[a],a,t),l=+r(t[a+1],a+1,t);return o+(l-o)*(s-a)}}function kHe(t,e,r){t=+t,e=+e,r=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(s);++n<s;)a[n]=t+n*r;return a}function Su(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Hf(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const jP=Symbol("implicit");function cR(){var t=new iK,e=[],r=[],n=jP;function s(a){let o=t.get(a);if(o===void 0){if(n!==jP)return n;t.set(a,o=e.push(a)-1)}return r[o%r.length]}return s.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new iK;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return cR(e,r).unknown(n)},Su.apply(s,arguments),s}function uR(){var t=cR().unknown(void 0),e=t.domain,r=t.range,n=0,s=1,a,o,l=!1,c=0,u=0,h=.5;delete t.unknown;function f(){var m=e().length,g=s<n,y=g?s:n,v=g?n:s;a=(v-y)/Math.max(1,m-c+u*2),l&&(a=Math.floor(a)),y+=(v-y-a*(m-c))*h,o=a*(1-c),l&&(y=Math.round(y),o=Math.round(o));var w=kHe(m).map(function(N){return y+a*N});return r(g?w.reverse():w)}return t.domain=function(m){return arguments.length?(e(m),f()):e()},t.range=function(m){return arguments.length?([n,s]=m,n=+n,s=+s,f()):[n,s]},t.rangeRound=function(m){return[n,s]=m,n=+n,s=+s,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(m){return arguments.length?(l=!!m,f()):l},t.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},t.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},t.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},t.align=function(m){return arguments.length?(h=Math.max(0,Math.min(1,m)),f()):h},t.copy=function(){return uR(e(),[n,s]).round(l).paddingInner(c).paddingOuter(u).align(h)},Su.apply(f(),arguments)}function Wle(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Wle(e())},t}function _He(){return Wle(uR.apply(null,arguments).paddingInner(1))}function dR(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Gle(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Lw(){}var M2=.7,Ek=1/M2,ky="\\s*([+-]?\\d+)\\s*",R2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SHe=/^#([0-9a-f]{3,8})$/,CHe=new RegExp(`^rgb\\(${ky},${ky},${ky}\\)$`),EHe=new RegExp(`^rgb\\(${oh},${oh},${oh}\\)$`),AHe=new RegExp(`^rgba\\(${ky},${ky},${ky},${R2}\\)$`),THe=new RegExp(`^rgba\\(${oh},${oh},${oh},${R2}\\)$`),IHe=new RegExp(`^hsl\\(${R2},${oh},${oh}\\)$`),PHe=new RegExp(`^hsla\\(${R2},${oh},${oh},${R2}\\)$`),cK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dR(Lw,D2,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:uK,formatHex:uK,formatHex8:LHe,formatHsl:OHe,formatRgb:dK,toString:dK});function uK(){return this.rgb().formatHex()}function LHe(){return this.rgb().formatHex8()}function OHe(){return Kle(this).formatHsl()}function dK(){return this.rgb().formatRgb()}function D2(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=SHe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?hK(e):r===3?new ic(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?WN(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?WN(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=CHe.exec(t))?new ic(e[1],e[2],e[3],1):(e=EHe.exec(t))?new ic(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=AHe.exec(t))?WN(e[1],e[2],e[3],e[4]):(e=THe.exec(t))?WN(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=IHe.exec(t))?mK(e[1],e[2]/100,e[3]/100,1):(e=PHe.exec(t))?mK(e[1],e[2]/100,e[3]/100,e[4]):cK.hasOwnProperty(t)?hK(cK[t]):t==="transparent"?new ic(NaN,NaN,NaN,0):null}function hK(t){return new ic(t>>16&255,t>>8&255,t&255,1)}function WN(t,e,r,n){return n<=0&&(t=e=r=NaN),new ic(t,e,r,n)}function MHe(t){return t instanceof Lw||(t=D2(t)),t?(t=t.rgb(),new ic(t.r,t.g,t.b,t.opacity)):new ic}function kP(t,e,r,n){return arguments.length===1?MHe(t):new ic(t,e,r,n??1)}function ic(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}dR(ic,kP,Gle(Lw,{brighter(t){return t=t==null?Ek:Math.pow(Ek,t),new ic(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?M2:Math.pow(M2,t),new ic(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ic(Om(this.r),Om(this.g),Om(this.b),Ak(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fK,formatHex:fK,formatHex8:RHe,formatRgb:pK,toString:pK}));function fK(){return`#${Nm(this.r)}${Nm(this.g)}${Nm(this.b)}`}function RHe(){return`#${Nm(this.r)}${Nm(this.g)}${Nm(this.b)}${Nm((isNaN(this.opacity)?1:this.opacity)*255)}`}function pK(){const t=Ak(this.opacity);return`${t===1?"rgb(":"rgba("}${Om(this.r)}, ${Om(this.g)}, ${Om(this.b)}${t===1?")":`, ${t})`}`}function Ak(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Om(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Nm(t){return t=Om(t),(t<16?"0":"")+t.toString(16)}function mK(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Zu(t,e,r,n)}function Kle(t){if(t instanceof Zu)return new Zu(t.h,t.s,t.l,t.opacity);if(t instanceof Lw||(t=D2(t)),!t)return new Zu;if(t instanceof Zu)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,s=Math.min(e,r,n),a=Math.max(e,r,n),o=NaN,l=a-s,c=(a+s)/2;return l?(e===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?a+s:2-a-s,o*=60):l=c>0&&c<1?0:o,new Zu(o,l,c,t.opacity)}function DHe(t,e,r,n){return arguments.length===1?Kle(t):new Zu(t,e,r,n??1)}function Zu(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}dR(Zu,DHe,Gle(Lw,{brighter(t){return t=t==null?Ek:Math.pow(Ek,t),new Zu(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?M2:Math.pow(M2,t),new Zu(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,s=2*r-n;return new ic(Q6(t>=240?t-240:t+120,s,n),Q6(t,s,n),Q6(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new Zu(gK(this.h),GN(this.s),GN(this.l),Ak(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ak(this.opacity);return`${t===1?"hsl(":"hsla("}${gK(this.h)}, ${GN(this.s)*100}%, ${GN(this.l)*100}%${t===1?")":`, ${t})`}`}}));function gK(t){return t=(t||0)%360,t<0?t+360:t}function GN(t){return Math.max(0,Math.min(1,t||0))}function Q6(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const hR=t=>()=>t;function BHe(t,e){return function(r){return t+r*e}}function FHe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function $He(t){return(t=+t)==1?Yle:function(e,r){return r-e?FHe(e,r,t):hR(isNaN(e)?r:e)}}function Yle(t,e){var r=e-t;return r?BHe(t,r):hR(isNaN(t)?e:t)}const xK=(function t(e){var r=$He(e);function n(s,a){var o=r((s=kP(s)).r,(a=kP(a)).r),l=r(s.g,a.g),c=r(s.b,a.b),u=Yle(s.opacity,a.opacity);return function(h){return s.r=o(h),s.g=l(h),s.b=c(h),s.opacity=u(h),s+""}}return n.gamma=t,n})(1);function UHe(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=t[s]*(1-a)+e[s]*a;return n}}function zHe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function VHe(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,s=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)s[o]=jb(t[o],e[o]);for(;o<r;++o)a[o]=e[o];return function(l){for(o=0;o<n;++o)a[o]=s[o](l);return a}}function qHe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Tk(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function HHe(t,e){var r={},n={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?r[s]=jb(t[s],e[s]):n[s]=e[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var _P=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,J6=new RegExp(_P.source,"g");function WHe(t){return function(){return t}}function GHe(t){return function(e){return t(e)+""}}function KHe(t,e){var r=_P.lastIndex=J6.lastIndex=0,n,s,a,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=_P.exec(t))&&(s=J6.exec(e));)(a=s.index)>r&&(a=e.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:Tk(n,s)})),r=J6.lastIndex;return r<e.length&&(a=e.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?GHe(c[0].x):WHe(e):(e=c.length,function(u){for(var h=0,f;h<e;++h)l[(f=c[h]).i]=f.x(u);return l.join("")})}function jb(t,e){var r=typeof e,n;return e==null||r==="boolean"?hR(e):(r==="number"?Tk:r==="string"?(n=D2(e))?(e=n,xK):KHe:e instanceof D2?xK:e instanceof Date?qHe:zHe(e)?UHe:Array.isArray(e)?VHe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?HHe:Tk)(t,e)}function fR(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function YHe(t,e){e===void 0&&(e=t,t=jb);for(var r=0,n=e.length-1,s=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(s,s=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[l](o-l)}}function XHe(t){return function(){return t}}function Ik(t){return+t}var yK=[0,1];function kl(t){return t}function SP(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:XHe(isNaN(e)?NaN:.5)}function QHe(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function JHe(t,e,r){var n=t[0],s=t[1],a=e[0],o=e[1];return s<n?(n=SP(s,n),a=r(o,a)):(n=SP(n,s),a=r(a,o)),function(l){return a(n(l))}}function ZHe(t,e,r){var n=Math.min(t.length,e.length)-1,s=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)s[o]=SP(t[o],t[o+1]),a[o]=r(e[o],e[o+1]);return function(l){var c=Pw(t,l,1,n)-1;return a[c](s[c](l))}}function Ow(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function GS(){var t=yK,e=yK,r=jb,n,s,a,o=kl,l,c,u;function h(){var m=Math.min(t.length,e.length);return o!==kl&&(o=QHe(t[0],t[m-1])),l=m>2?ZHe:JHe,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?a:(c||(c=l(t.map(n),e,r)))(n(o(m)))}return f.invert=function(m){return o(s((u||(u=l(e,t.map(n),Tk)))(m)))},f.domain=function(m){return arguments.length?(t=Array.from(m,Ik),h()):t.slice()},f.range=function(m){return arguments.length?(e=Array.from(m),h()):e.slice()},f.rangeRound=function(m){return e=Array.from(m),r=fR,h()},f.clamp=function(m){return arguments.length?(o=m?!0:kl,h()):o!==kl},f.interpolate=function(m){return arguments.length?(r=m,h()):r},f.unknown=function(m){return arguments.length?(a=m,f):a},function(m,g){return n=m,s=g,h()}}function pR(){return GS()(kl,kl)}function eWe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Pk(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Jy(t){return t=Pk(Math.abs(t)),t?t[1]:NaN}function tWe(t,e){return function(r,n){for(var s=r.length,a=[],o=0,l=t[0],c=0;s>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(s-=l,s+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return a.reverse().join(e)}}function rWe(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var nWe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B2(t){if(!(e=nWe.exec(t)))throw new Error("invalid format: "+t);var e;return new mR({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}B2.prototype=mR.prototype;function mR(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}mR.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sWe(t){e:for(var e=t.length,r=1,n=-1,s;r<e;++r)switch(t[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(s+1):t}var Lk;function iWe(t,e){var r=Pk(t,e);if(!r)return Lk=void 0,t.toPrecision(e);var n=r[0],s=r[1],a=s-(Lk=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Pk(t,Math.max(0,e+a-1))[0]}function bK(t,e){var r=Pk(t,e);if(!r)return t+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const vK={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:eWe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>bK(t*100,e),r:bK,s:iWe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function wK(t){return t}var NK=Array.prototype.map,jK=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function aWe(t){var e=t.grouping===void 0||t.thousands===void 0?wK:tWe(NK.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?wK:rWe(NK.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,m){f=B2(f);var g=f.fill,y=f.align,v=f.sign,w=f.symbol,N=f.zero,k=f.width,C=f.comma,I=f.precision,O=f.trim,L=f.type;L==="n"?(C=!0,L="g"):vK[L]||(I===void 0&&(I=12),O=!0,L="g"),(N||g==="0"&&y==="=")&&(N=!0,g="0",y="=");var _=(m&&m.prefix!==void 0?m.prefix:"")+(w==="$"?r:w==="#"&&/[boxX]/.test(L)?"0"+L.toLowerCase():""),E=(w==="$"?n:/[%p]/.test(L)?o:"")+(m&&m.suffix!==void 0?m.suffix:""),M=vK[L],B=/[defgprs%]/.test(L);I=I===void 0?6:/[gprs]/.test(L)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function S(P){var R=_,V=E,ee,G,J;if(L==="c")V=M(P)+V,P="";else{P=+P;var Z=P<0||1/P<0;if(P=isNaN(P)?c:M(Math.abs(P),I),O&&(P=sWe(P)),Z&&+P==0&&v!=="+"&&(Z=!1),R=(Z?v==="("?v:l:v==="-"||v==="("?"":v)+R,V=(L==="s"&&!isNaN(P)&&Lk!==void 0?jK[8+Lk/3]:"")+V+(Z&&v==="("?")":""),B){for(ee=-1,G=P.length;++ee<G;)if(J=P.charCodeAt(ee),48>J||J>57){V=(J===46?s+P.slice(ee+1):P.slice(ee))+V,P=P.slice(0,ee);break}}}C&&!N&&(P=e(P,1/0));var se=R.length+P.length+V.length,X=se<k?new Array(k-se+1).join(g):"";switch(C&&N&&(P=e(X+P,X.length?k-V.length:1/0),X=""),y){case"<":P=R+P+V+X;break;case"=":P=R+X+P+V;break;case"^":P=X.slice(0,se=X.length>>1)+R+P+V+X.slice(se);break;default:P=X+R+P+V;break}return a(P)}return S.toString=function(){return f+""},S}function h(f,m){var g=Math.max(-8,Math.min(8,Math.floor(Jy(m)/3)))*3,y=Math.pow(10,-g),v=u((f=B2(f),f.type="f",f),{suffix:jK[8+g/3]});return function(w){return v(y*w)}}return{format:u,formatPrefix:h}}var KN,gR,Xle;oWe({thousands:",",grouping:[3],currency:["$",""]});function oWe(t){return KN=aWe(t),gR=KN.format,Xle=KN.formatPrefix,KN}function lWe(t){return Math.max(0,-Jy(Math.abs(t)))}function cWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Jy(e)/3)))*3-Jy(Math.abs(t)))}function uWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Jy(e)-Jy(t))+1}function Qle(t,e,r,n){var s=NP(t,e,r),a;switch(n=B2(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=cWe(s,o))&&(n.precision=a),Xle(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=uWe(s,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=lWe(s))&&(n.precision=a-(n.type==="%")*2);break}}return gR(n)}function Ep(t){var e=t.domain;return t.ticks=function(r){var n=e();return vP(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var s=e();return Qle(s[0],s[s.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),s=0,a=n.length-1,o=n[s],l=n[a],c,u,h=10;for(l<o&&(u=o,o=l,l=u,u=s,s=a,a=u);h-- >0;){if(u=wP(o,l,r),u===c)return n[s]=o,n[a]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function Jle(){var t=pR();return t.copy=function(){return Ow(t,Jle())},Su.apply(t,arguments),Ep(t)}function Zle(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Ik),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return Zle(t).unknown(e)},t=arguments.length?Array.from(t,Ik):[0,1],Ep(r)}function ece(t,e){t=t.slice();var r=0,n=t.length-1,s=t[r],a=t[n],o;return a<s&&(o=r,r=n,n=o,o=s,s=a,a=o),t[r]=e.floor(s),t[n]=e.ceil(a),t}function kK(t){return Math.log(t)}function _K(t){return Math.exp(t)}function dWe(t){return-Math.log(-t)}function hWe(t){return-Math.exp(-t)}function fWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pWe(t){return t===10?fWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function mWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function SK(t){return(e,r)=>-t(-e,r)}function xR(t){const e=t(kK,_K),r=e.domain;let n=10,s,a;function o(){return s=mWe(n),a=pWe(n),r()[0]<0?(s=SK(s),a=SK(a),t(dWe,hWe)):t(kK,_K),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],h=c[c.length-1];const f=h<u;f&&([u,h]=[h,u]);let m=s(u),g=s(h),y,v;const w=l==null?10:+l;let N=[];if(!(n%1)&&g-m<w){if(m=Math.floor(m),g=Math.ceil(g),u>0){for(;m<=g;++m)for(y=1;y<n;++y)if(v=m<0?y/a(-m):y*a(m),!(v<u)){if(v>h)break;N.push(v)}}else for(;m<=g;++m)for(y=n-1;y>=1;--y)if(v=m>0?y/a(-m):y*a(m),!(v<u)){if(v>h)break;N.push(v)}N.length*2<w&&(N=vP(u,h,w))}else N=vP(m,g,Math.min(g-m,w)).map(a);return f?N.reverse():N},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=B2(c)).precision==null&&(c.trim=!0),c=gR(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return h=>{let f=h/a(Math.round(s(h)));return f*n<n-.5&&(f*=n),f<=u?c(h):""}},e.nice=()=>r(ece(r(),{floor:l=>a(Math.floor(s(l))),ceil:l=>a(Math.ceil(s(l)))})),e}function tce(){const t=xR(GS()).domain([1,10]);return t.copy=()=>Ow(t,tce()).base(t.base()),Su.apply(t,arguments),t}function CK(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function EK(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function yR(t){var e=1,r=t(CK(e),EK(e));return r.constant=function(n){return arguments.length?t(CK(e=+n),EK(e)):e},Ep(r)}function rce(){var t=yR(GS());return t.copy=function(){return Ow(t,rce()).constant(t.constant())},Su.apply(t,arguments)}function AK(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function gWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function xWe(t){return t<0?-t*t:t*t}function bR(t){var e=t(kl,kl),r=1;function n(){return r===1?t(kl,kl):r===.5?t(gWe,xWe):t(AK(r),AK(1/r))}return e.exponent=function(s){return arguments.length?(r=+s,n()):r},Ep(e)}function vR(){var t=bR(GS());return t.copy=function(){return Ow(t,vR()).exponent(t.exponent())},Su.apply(t,arguments),t}function yWe(){return vR.apply(null,arguments).exponent(.5)}function TK(t){return Math.sign(t)*t*t}function bWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function nce(){var t=pR(),e=[0,1],r=!1,n;function s(a){var o=bWe(t(a));return isNaN(o)?n:r?Math.round(o):o}return s.invert=function(a){return t.invert(TK(a))},s.domain=function(a){return arguments.length?(t.domain(a),s):t.domain()},s.range=function(a){return arguments.length?(t.range((e=Array.from(a,Ik)).map(TK)),s):e.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(t.clamp(a),s):t.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return nce(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Su.apply(s,arguments),Ep(s)}function sce(){var t=[],e=[],r=[],n;function s(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=jHe(t,o/l);return a}function a(o){return o==null||isNaN(o=+o)?n:e[Pw(r,o)]}return a.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(ap),s()},a.range=function(o){return arguments.length?(e=Array.from(o),s()):e.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return sce().domain(t).range(e).unknown(n)},Su.apply(a,arguments)}function ice(){var t=0,e=1,r=1,n=[.5],s=[0,1],a;function o(c){return c!=null&&c<=c?s[Pw(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return ice().domain([t,e]).range(s).unknown(a)},Su.apply(Ep(o),arguments)}function ace(){var t=[.5],e=[0,1],r,n=1;function s(a){return a!=null&&a<=a?e[Pw(t,a,0,n)]:r}return s.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),s):t.slice()},s.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),s):e.slice()},s.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return ace().domain(t).range(e).unknown(r)},Su.apply(s,arguments)}const Z6=new Date,eT=new Date;function Za(t,e,r,n){function s(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(t(a=new Date(+a)),a),s.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),s.round=a=>{const o=s(a),l=s.ceil(a);return a-o<l-a?o:l},s.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),s.range=(a,o,l)=>{const c=[];if(a=s.ceil(a),l=l==null?1:Math.floor(l),!(a<o)||!(l>0))return c;let u;do c.push(u=new Date(+a)),e(a,l),t(a);while(u<a&&a<o);return c},s.filter=a=>Za(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!a(o););else for(;--l>=0;)for(;e(o,1),!a(o););}),r&&(s.count=(a,o)=>(Z6.setTime(+a),eT.setTime(+o),t(Z6),t(eT),Math.floor(r(Z6,eT))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?o=>n(o)%a===0:o=>s.count(0,o)%a===0):s)),s}const Ok=Za(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ok.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Za(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Ok);Ok.range;const cf=1e3,pu=cf*60,uf=pu*60,Ef=uf*24,wR=Ef*7,IK=Ef*30,tT=Ef*365,jm=Za(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*cf)},(t,e)=>(e-t)/cf,t=>t.getUTCSeconds());jm.range;const NR=Za(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*cf)},(t,e)=>{t.setTime(+t+e*pu)},(t,e)=>(e-t)/pu,t=>t.getMinutes());NR.range;const jR=Za(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*pu)},(t,e)=>(e-t)/pu,t=>t.getUTCMinutes());jR.range;const kR=Za(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*cf-t.getMinutes()*pu)},(t,e)=>{t.setTime(+t+e*uf)},(t,e)=>(e-t)/uf,t=>t.getHours());kR.range;const _R=Za(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*uf)},(t,e)=>(e-t)/uf,t=>t.getUTCHours());_R.range;const Mw=Za(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*pu)/Ef,t=>t.getDate()-1);Mw.range;const KS=Za(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ef,t=>t.getUTCDate()-1);KS.range;const oce=Za(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ef,t=>Math.floor(t/Ef));oce.range;function Ig(t){return Za(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*pu)/wR)}const YS=Ig(0),Mk=Ig(1),vWe=Ig(2),wWe=Ig(3),Zy=Ig(4),NWe=Ig(5),jWe=Ig(6);YS.range;Mk.range;vWe.range;wWe.range;Zy.range;NWe.range;jWe.range;function Pg(t){return Za(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/wR)}const XS=Pg(0),Rk=Pg(1),kWe=Pg(2),_We=Pg(3),eb=Pg(4),SWe=Pg(5),CWe=Pg(6);XS.range;Rk.range;kWe.range;_We.range;eb.range;SWe.range;CWe.range;const SR=Za(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());SR.range;const CR=Za(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());CR.range;const Af=Za(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Af.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Za(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});Af.range;const Tf=Za(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Tf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Za(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});Tf.range;function lce(t,e,r,n,s,a){const o=[[jm,1,cf],[jm,5,5*cf],[jm,15,15*cf],[jm,30,30*cf],[a,1,pu],[a,5,5*pu],[a,15,15*pu],[a,30,30*pu],[s,1,uf],[s,3,3*uf],[s,6,6*uf],[s,12,12*uf],[n,1,Ef],[n,2,2*Ef],[r,1,wR],[e,1,IK],[e,3,3*IK],[t,1,tT]];function l(u,h,f){const m=h<u;m&&([u,h]=[h,u]);const g=f&&typeof f.range=="function"?f:c(u,h,f),y=g?g.range(u,+h+1):[];return m?y.reverse():y}function c(u,h,f){const m=Math.abs(h-u)/f,g=lR(([,,w])=>w).right(o,m);if(g===o.length)return t.every(NP(u/tT,h/tT,f));if(g===0)return Ok.every(Math.max(NP(u,h,f),1));const[y,v]=o[m/o[g-1][2]<o[g][2]/m?g-1:g];return y.every(v)}return[l,c]}const[EWe,AWe]=lce(Tf,CR,XS,oce,_R,jR),[TWe,IWe]=lce(Af,SR,YS,Mw,kR,NR);function rT(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function nT(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function zv(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function PWe(t){var e=t.dateTime,r=t.date,n=t.time,s=t.periods,a=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=Vv(s),h=qv(s),f=Vv(a),m=qv(a),g=Vv(o),y=qv(o),v=Vv(l),w=qv(l),N=Vv(c),k=qv(c),C={a:J,A:Z,b:se,B:X,c:null,d:DK,e:DK,f:tGe,g:dGe,G:fGe,H:JWe,I:ZWe,j:eGe,L:cce,m:rGe,M:nGe,p:q,q:U,Q:$K,s:UK,S:sGe,u:iGe,U:aGe,V:oGe,w:lGe,W:cGe,x:null,X:null,y:uGe,Y:hGe,Z:pGe,"%":FK},I={a:H,A:re,b:ae,B:xe,c:null,d:BK,e:BK,f:yGe,g:EGe,G:TGe,H:mGe,I:gGe,j:xGe,L:dce,m:bGe,M:vGe,p:Ne,q:pe,Q:$K,s:UK,S:wGe,u:NGe,U:jGe,V:kGe,w:_Ge,W:SGe,x:null,X:null,y:CGe,Y:AGe,Z:IGe,"%":FK},O={a:B,A:S,b:P,B:R,c:V,d:MK,e:MK,f:KWe,g:OK,G:LK,H:RK,I:RK,j:qWe,L:GWe,m:VWe,M:HWe,p:M,q:zWe,Q:XWe,s:QWe,S:WWe,u:DWe,U:BWe,V:FWe,w:RWe,W:$We,x:ee,X:G,y:OK,Y:LK,Z:UWe,"%":YWe};C.x=L(r,C),C.X=L(n,C),C.c=L(e,C),I.x=L(r,I),I.X=L(n,I),I.c=L(e,I);function L(K,ue){return function(fe){var he=[],le=-1,_e=0,oe=K.length,Oe,ze,Ye;for(fe instanceof Date||(fe=new Date(+fe));++le<oe;)K.charCodeAt(le)===37&&(he.push(K.slice(_e,le)),(ze=PK[Oe=K.charAt(++le)])!=null?Oe=K.charAt(++le):ze=Oe==="e"?" ":"0",(Ye=ue[Oe])&&(Oe=Ye(fe,ze)),he.push(Oe),_e=le+1);return he.push(K.slice(_e,le)),he.join("")}}function _(K,ue){return function(fe){var he=zv(1900,void 0,1),le=E(he,K,fe+="",0),_e,oe;if(le!=fe.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(ue&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(_e=nT(zv(he.y,0,1)),oe=_e.getUTCDay(),_e=oe>4||oe===0?Rk.ceil(_e):Rk(_e),_e=KS.offset(_e,(he.V-1)*7),he.y=_e.getUTCFullYear(),he.m=_e.getUTCMonth(),he.d=_e.getUTCDate()+(he.w+6)%7):(_e=rT(zv(he.y,0,1)),oe=_e.getDay(),_e=oe>4||oe===0?Mk.ceil(_e):Mk(_e),_e=Mw.offset(_e,(he.V-1)*7),he.y=_e.getFullYear(),he.m=_e.getMonth(),he.d=_e.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),oe="Z"in he?nT(zv(he.y,0,1)).getUTCDay():rT(zv(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(oe+5)%7:he.w+he.U*7-(oe+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,nT(he)):rT(he)}}function E(K,ue,fe,he){for(var le=0,_e=ue.length,oe=fe.length,Oe,ze;le<_e;){if(he>=oe)return-1;if(Oe=ue.charCodeAt(le++),Oe===37){if(Oe=ue.charAt(le++),ze=O[Oe in PK?ue.charAt(le++):Oe],!ze||(he=ze(K,fe,he))<0)return-1}else if(Oe!=fe.charCodeAt(he++))return-1}return he}function M(K,ue,fe){var he=u.exec(ue.slice(fe));return he?(K.p=h.get(he[0].toLowerCase()),fe+he[0].length):-1}function B(K,ue,fe){var he=g.exec(ue.slice(fe));return he?(K.w=y.get(he[0].toLowerCase()),fe+he[0].length):-1}function S(K,ue,fe){var he=f.exec(ue.slice(fe));return he?(K.w=m.get(he[0].toLowerCase()),fe+he[0].length):-1}function P(K,ue,fe){var he=N.exec(ue.slice(fe));return he?(K.m=k.get(he[0].toLowerCase()),fe+he[0].length):-1}function R(K,ue,fe){var he=v.exec(ue.slice(fe));return he?(K.m=w.get(he[0].toLowerCase()),fe+he[0].length):-1}function V(K,ue,fe){return E(K,e,ue,fe)}function ee(K,ue,fe){return E(K,r,ue,fe)}function G(K,ue,fe){return E(K,n,ue,fe)}function J(K){return o[K.getDay()]}function Z(K){return a[K.getDay()]}function se(K){return c[K.getMonth()]}function X(K){return l[K.getMonth()]}function q(K){return s[+(K.getHours()>=12)]}function U(K){return 1+~~(K.getMonth()/3)}function H(K){return o[K.getUTCDay()]}function re(K){return a[K.getUTCDay()]}function ae(K){return c[K.getUTCMonth()]}function xe(K){return l[K.getUTCMonth()]}function Ne(K){return s[+(K.getUTCHours()>=12)]}function pe(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var ue=L(K+="",C);return ue.toString=function(){return K},ue},parse:function(K){var ue=_(K+="",!1);return ue.toString=function(){return K},ue},utcFormat:function(K){var ue=L(K+="",I);return ue.toString=function(){return K},ue},utcParse:function(K){var ue=_(K+="",!0);return ue.toString=function(){return K},ue}}}var PK={"-":"",_:" ",0:"0"},vo=/^\s*\d+/,LWe=/^%/,OWe=/[\\^$*+?|[\]().{}]/g;function rs(t,e,r){var n=t<0?"-":"",s=(n?-t:t)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(e)+s:s)}function MWe(t){return t.replace(OWe,"\\$&")}function Vv(t){return new RegExp("^(?:"+t.map(MWe).join("|")+")","i")}function qv(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function RWe(t,e,r){var n=vo.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function DWe(t,e,r){var n=vo.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function BWe(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function FWe(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function $We(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function LK(t,e,r){var n=vo.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function OK(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function UWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function zWe(t,e,r){var n=vo.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function VWe(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function MK(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function qWe(t,e,r){var n=vo.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function RK(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function HWe(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function WWe(t,e,r){var n=vo.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function GWe(t,e,r){var n=vo.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function KWe(t,e,r){var n=vo.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function YWe(t,e,r){var n=LWe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function XWe(t,e,r){var n=vo.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function QWe(t,e,r){var n=vo.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function DK(t,e){return rs(t.getDate(),e,2)}function JWe(t,e){return rs(t.getHours(),e,2)}function ZWe(t,e){return rs(t.getHours()%12||12,e,2)}function eGe(t,e){return rs(1+Mw.count(Af(t),t),e,3)}function cce(t,e){return rs(t.getMilliseconds(),e,3)}function tGe(t,e){return cce(t,e)+"000"}function rGe(t,e){return rs(t.getMonth()+1,e,2)}function nGe(t,e){return rs(t.getMinutes(),e,2)}function sGe(t,e){return rs(t.getSeconds(),e,2)}function iGe(t){var e=t.getDay();return e===0?7:e}function aGe(t,e){return rs(YS.count(Af(t)-1,t),e,2)}function uce(t){var e=t.getDay();return e>=4||e===0?Zy(t):Zy.ceil(t)}function oGe(t,e){return t=uce(t),rs(Zy.count(Af(t),t)+(Af(t).getDay()===4),e,2)}function lGe(t){return t.getDay()}function cGe(t,e){return rs(Mk.count(Af(t)-1,t),e,2)}function uGe(t,e){return rs(t.getFullYear()%100,e,2)}function dGe(t,e){return t=uce(t),rs(t.getFullYear()%100,e,2)}function hGe(t,e){return rs(t.getFullYear()%1e4,e,4)}function fGe(t,e){var r=t.getDay();return t=r>=4||r===0?Zy(t):Zy.ceil(t),rs(t.getFullYear()%1e4,e,4)}function pGe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+rs(e/60|0,"0",2)+rs(e%60,"0",2)}function BK(t,e){return rs(t.getUTCDate(),e,2)}function mGe(t,e){return rs(t.getUTCHours(),e,2)}function gGe(t,e){return rs(t.getUTCHours()%12||12,e,2)}function xGe(t,e){return rs(1+KS.count(Tf(t),t),e,3)}function dce(t,e){return rs(t.getUTCMilliseconds(),e,3)}function yGe(t,e){return dce(t,e)+"000"}function bGe(t,e){return rs(t.getUTCMonth()+1,e,2)}function vGe(t,e){return rs(t.getUTCMinutes(),e,2)}function wGe(t,e){return rs(t.getUTCSeconds(),e,2)}function NGe(t){var e=t.getUTCDay();return e===0?7:e}function jGe(t,e){return rs(XS.count(Tf(t)-1,t),e,2)}function hce(t){var e=t.getUTCDay();return e>=4||e===0?eb(t):eb.ceil(t)}function kGe(t,e){return t=hce(t),rs(eb.count(Tf(t),t)+(Tf(t).getUTCDay()===4),e,2)}function _Ge(t){return t.getUTCDay()}function SGe(t,e){return rs(Rk.count(Tf(t)-1,t),e,2)}function CGe(t,e){return rs(t.getUTCFullYear()%100,e,2)}function EGe(t,e){return t=hce(t),rs(t.getUTCFullYear()%100,e,2)}function AGe(t,e){return rs(t.getUTCFullYear()%1e4,e,4)}function TGe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?eb(t):eb.ceil(t),rs(t.getUTCFullYear()%1e4,e,4)}function IGe(){return"+0000"}function FK(){return"%"}function $K(t){return+t}function UK(t){return Math.floor(+t/1e3)}var Ax,fce,pce;PGe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function PGe(t){return Ax=PWe(t),fce=Ax.format,Ax.parse,pce=Ax.utcFormat,Ax.utcParse,Ax}function LGe(t){return new Date(t)}function OGe(t){return t instanceof Date?+t:+new Date(+t)}function ER(t,e,r,n,s,a,o,l,c,u){var h=pR(),f=h.invert,m=h.domain,g=u(".%L"),y=u(":%S"),v=u("%I:%M"),w=u("%I %p"),N=u("%a %d"),k=u("%b %d"),C=u("%B"),I=u("%Y");function O(L){return(c(L)<L?g:l(L)<L?y:o(L)<L?v:a(L)<L?w:n(L)<L?s(L)<L?N:k:r(L)<L?C:I)(L)}return h.invert=function(L){return new Date(f(L))},h.domain=function(L){return arguments.length?m(Array.from(L,OGe)):m().map(LGe)},h.ticks=function(L){var _=m();return t(_[0],_[_.length-1],L??10)},h.tickFormat=function(L,_){return _==null?O:u(_)},h.nice=function(L){var _=m();return(!L||typeof L.range!="function")&&(L=e(_[0],_[_.length-1],L??10)),L?m(ece(_,L)):h},h.copy=function(){return Ow(h,ER(t,e,r,n,s,a,o,l,c,u))},h}function MGe(){return Su.apply(ER(TWe,IWe,Af,SR,YS,Mw,kR,NR,jm,fce).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function RGe(){return Su.apply(ER(EWe,AWe,Tf,CR,XS,KS,_R,jR,jm,pce).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function QS(){var t=0,e=1,r,n,s,a,o=kl,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(s===0?.5:(f=(a(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=a(t=+t),n=a(e=+e),s=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function h(f){return function(m){var g,y;return arguments.length?([g,y]=m,o=f(g,y),u):[o(0),o(1)]}}return u.range=h(jb),u.rangeRound=h(fR),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,r=f(t),n=f(e),s=r===n?0:1/(n-r),u}}function Ap(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function mce(){var t=Ep(QS()(kl));return t.copy=function(){return Ap(t,mce())},Hf.apply(t,arguments)}function gce(){var t=xR(QS()).domain([1,10]);return t.copy=function(){return Ap(t,gce()).base(t.base())},Hf.apply(t,arguments)}function xce(){var t=yR(QS());return t.copy=function(){return Ap(t,xce()).constant(t.constant())},Hf.apply(t,arguments)}function AR(){var t=bR(QS());return t.copy=function(){return Ap(t,AR()).exponent(t.exponent())},Hf.apply(t,arguments)}function DGe(){return AR.apply(null,arguments).exponent(.5)}function yce(){var t=[],e=kl;function r(n){if(n!=null&&!isNaN(n=+n))return e((Pw(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let s of n)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(ap),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,s)=>e(s/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>NHe(t,a/n))},r.copy=function(){return yce(e).domain(t)},Hf.apply(r,arguments)}function JS(){var t=0,e=.5,r=1,n=1,s,a,o,l,c,u=kl,h,f=!1,m;function g(v){return isNaN(v=+v)?m:(v=.5+((v=+h(v))-a)*(n*v<n*a?l:c),u(f?Math.max(0,Math.min(1,v)):v))}g.domain=function(v){return arguments.length?([t,e,r]=v,s=h(t=+t),a=h(e=+e),o=h(r=+r),l=s===a?0:.5/(a-s),c=a===o?0:.5/(o-a),n=a<s?-1:1,g):[t,e,r]},g.clamp=function(v){return arguments.length?(f=!!v,g):f},g.interpolator=function(v){return arguments.length?(u=v,g):u};function y(v){return function(w){var N,k,C;return arguments.length?([N,k,C]=w,u=YHe(v,[N,k,C]),g):[u(0),u(.5),u(1)]}}return g.range=y(jb),g.rangeRound=y(fR),g.unknown=function(v){return arguments.length?(m=v,g):m},function(v){return h=v,s=v(t),a=v(e),o=v(r),l=s===a?0:.5/(a-s),c=a===o?0:.5/(o-a),n=a<s?-1:1,g}}function bce(){var t=Ep(JS()(kl));return t.copy=function(){return Ap(t,bce())},Hf.apply(t,arguments)}function vce(){var t=xR(JS()).domain([.1,1,10]);return t.copy=function(){return Ap(t,vce()).base(t.base())},Hf.apply(t,arguments)}function wce(){var t=yR(JS());return t.copy=function(){return Ap(t,wce()).constant(t.constant())},Hf.apply(t,arguments)}function TR(){var t=bR(JS());return t.copy=function(){return Ap(t,TR()).exponent(t.exponent())},Hf.apply(t,arguments)}function BGe(){return TR.apply(null,arguments).exponent(.5)}const c1=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:uR,scaleDiverging:bce,scaleDivergingLog:vce,scaleDivergingPow:TR,scaleDivergingSqrt:BGe,scaleDivergingSymlog:wce,scaleIdentity:Zle,scaleImplicit:jP,scaleLinear:Jle,scaleLog:tce,scaleOrdinal:cR,scalePoint:_He,scalePow:vR,scaleQuantile:sce,scaleQuantize:ice,scaleRadial:nce,scaleSequential:mce,scaleSequentialLog:gce,scaleSequentialPow:AR,scaleSequentialQuantile:yce,scaleSequentialSqrt:DGe,scaleSequentialSymlog:xce,scaleSqrt:yWe,scaleSymlog:rce,scaleThreshold:ace,scaleTime:MGe,scaleUtc:RGe,tickFormat:Qle},Symbol.toStringTag,{value:"Module"}));var Wf=t=>t.chartData,ZS=et([Wf],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Nce=(t,e,r,n)=>n?ZS(t):Wf(t),FGe=(t,e,r)=>r?ZS(t):Wf(t);function If(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(cs(e)&&cs(r))return!0}return!1}function zK(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function jce(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,s,a;if(cs(r))s=r;else if(typeof r=="function")return;if(cs(n))a=n;else if(typeof n=="function")return;var o=[s,a];if(If(o))return o}}function $Ge(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(If(n))return zK(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[s,a]=t,o,l;if(s==="auto")e!=null&&(o=Math.min(...e));else if(Mr(s))o=s;else if(typeof s=="function")try{e!=null&&(o=s(e?.[0]))}catch{}else if(typeof s=="string"&&XW.test(s)){var c=XW.exec(s);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e?.[0];if(a==="auto")e!=null&&(l=Math.max(...e));else if(Mr(a))l=a;else if(typeof a=="function")try{e!=null&&(l=a(e?.[1]))}catch{}else if(typeof a=="string"&&QW.test(a)){var h=QW.exec(a);if(h==null||h[1]==null||e==null)l=void 0;else{var f=+h[1];l=e[1]+f}}else l=e?.[1];var m=[o,l];if(If(m))return e==null?m:zK(m,e,r)}}}var kb=1e9,UGe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},PR,_i=!0,ku="[DecimalError] ",Mm=ku+"Invalid argument: ",IR=ku+"Exponent out of range: ",_b=Math.floor,am=Math.pow,zGe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Tc,fo=1e7,oi=7,kce=9007199254740991,Dk=_b(kce/oi),hr={};hr.absoluteValue=hr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};hr.comparedTo=hr.cmp=function(t){var e,r,n,s,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,s=t.d.length,e=0,r=n<s?n:s;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};hr.decimalPlaces=hr.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*oi;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};hr.dividedBy=hr.div=function(t){return xf(this,new this.constructor(t))};hr.dividedToIntegerBy=hr.idiv=function(t){var e=this,r=e.constructor;return Ws(xf(e,new r(t),0,1),r.precision)};hr.equals=hr.eq=function(t){return!this.cmp(t)};hr.exponent=function(){return Sa(this)};hr.greaterThan=hr.gt=function(t){return this.cmp(t)>0};hr.greaterThanOrEqualTo=hr.gte=function(t){return this.cmp(t)>=0};hr.isInteger=hr.isint=function(){return this.e>this.d.length-2};hr.isNegative=hr.isneg=function(){return this.s<0};hr.isPositive=hr.ispos=function(){return this.s>0};hr.isZero=function(){return this.s===0};hr.lessThan=hr.lt=function(t){return this.cmp(t)<0};hr.lessThanOrEqualTo=hr.lte=function(t){return this.cmp(t)<1};hr.logarithm=hr.log=function(t){var e,r=this,n=r.constructor,s=n.precision,a=s+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Tc))throw Error(ku+"NaN");if(r.s<1)throw Error(ku+(r.s?"NaN":"-Infinity"));return r.eq(Tc)?new n(0):(_i=!1,e=xf(F2(r,a),F2(t,a),a),_i=!0,Ws(e,s))};hr.minus=hr.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Cce(e,t):_ce(e,(t.s=-t.s,t))};hr.modulo=hr.mod=function(t){var e,r=this,n=r.constructor,s=n.precision;if(t=new n(t),!t.s)throw Error(ku+"NaN");return r.s?(_i=!1,e=xf(r,t,0,1).times(t),_i=!0,r.minus(e)):Ws(new n(r),s)};hr.naturalExponential=hr.exp=function(){return Sce(this)};hr.naturalLogarithm=hr.ln=function(){return F2(this)};hr.negated=hr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};hr.plus=hr.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?_ce(e,t):Cce(e,(t.s=-t.s,t))};hr.precision=hr.sd=function(t){var e,r,n,s=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Mm+t);if(e=Sa(s)+1,n=s.d.length-1,r=n*oi+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};hr.squareRoot=hr.sqrt=function(){var t,e,r,n,s,a,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ku+"NaN")}for(t=Sa(l),_i=!1,s=Math.sqrt(+l),s==0||s==1/0?(e=th(l.d),(e.length+t)%2==0&&(e+="0"),s=Math.sqrt(e),t=_b((t+1)/2)-(t<0||t%2),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(s.toString()),r=c.precision,s=o=r+3;;)if(a=n,n=a.plus(xf(l,a,o+2)).times(.5),th(a.d).slice(0,o)===(e=th(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),s==o&&e=="4999"){if(Ws(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(e!="9999")break;o+=4}return _i=!0,Ws(n,r)};hr.times=hr.mul=function(t){var e,r,n,s,a,o,l,c,u,h=this,f=h.constructor,m=h.d,g=(t=new f(t)).d;if(!h.s||!t.s)return new f(0);for(t.s*=h.s,r=h.e+t.e,c=m.length,u=g.length,c<u&&(a=m,m=g,g=a,o=c,c=u,u=o),a=[],o=c+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(e=0,s=c+n;s>n;)l=a[s]+g[n]*m[s-n-1]+e,a[s--]=l%fo|0,e=l/fo|0;a[s]=(a[s]+e)%fo|0}for(;!a[--o];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,_i?Ws(t,f.precision):t};hr.toDecimalPlaces=hr.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(xh(t,0,kb),e===void 0?e=n.rounding:xh(e,0,8),Ws(r,t+Sa(r)+1,e))};hr.toExponential=function(t,e){var r,n=this,s=n.constructor;return t===void 0?r=hg(n,!0):(xh(t,0,kb),e===void 0?e=s.rounding:xh(e,0,8),n=Ws(new s(n),t+1,e),r=hg(n,!0,t+1)),r};hr.toFixed=function(t,e){var r,n,s=this,a=s.constructor;return t===void 0?hg(s):(xh(t,0,kb),e===void 0?e=a.rounding:xh(e,0,8),n=Ws(new a(s),t+Sa(s)+1,e),r=hg(n.abs(),!1,t+Sa(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};hr.toInteger=hr.toint=function(){var t=this,e=t.constructor;return Ws(new e(t),Sa(t)+1,e.rounding)};hr.toNumber=function(){return+this};hr.toPower=hr.pow=function(t){var e,r,n,s,a,o,l=this,c=l.constructor,u=12,h=+(t=new c(t));if(!t.s)return new c(Tc);if(l=new c(l),!l.s){if(t.s<1)throw Error(ku+"Infinity");return l}if(l.eq(Tc))return l;if(n=c.precision,t.eq(Tc))return Ws(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,a=l.s,o){if((r=h<0?-h:h)<=kce){for(s=new c(Tc),e=Math.ceil(n/oi+4),_i=!1;r%2&&(s=s.times(l),qK(s.d,e)),r=_b(r/2),r!==0;)l=l.times(l),qK(l.d,e);return _i=!0,t.s<0?new c(Tc).div(s):Ws(s,n)}}else if(a<0)throw Error(ku+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,_i=!1,s=t.times(F2(l,n+u)),_i=!0,s=Sce(s),s.s=a,s};hr.toPrecision=function(t,e){var r,n,s=this,a=s.constructor;return t===void 0?(r=Sa(s),n=hg(s,r<=a.toExpNeg||r>=a.toExpPos)):(xh(t,1,kb),e===void 0?e=a.rounding:xh(e,0,8),s=Ws(new a(s),t,e),r=Sa(s),n=hg(s,t<=r||r<=a.toExpNeg,t)),n};hr.toSignificantDigits=hr.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(xh(t,1,kb),e===void 0?e=n.rounding:xh(e,0,8)),Ws(new n(r),t,e)};hr.toString=hr.valueOf=hr.val=hr.toJSON=hr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Sa(t),r=t.constructor;return hg(t,e<=r.toExpNeg||e>=r.toExpPos)};function _ce(t,e){var r,n,s,a,o,l,c,u,h=t.constructor,f=h.precision;if(!t.s||!e.s)return e.s||(e=new h(t)),_i?Ws(e,f):e;if(c=t.d,u=e.d,o=t.e,s=e.e,c=c.slice(),a=o-s,a){for(a<0?(n=c,a=-a,l=u.length):(n=u,s=o,l=c.length),o=Math.ceil(f/oi),l=o>l?o+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=c.length,a=u.length,l-a<0&&(a=l,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/fo|0,c[a]%=fo;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=s,_i?Ws(e,f):e}function xh(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Mm+t)}function th(t){var e,r,n,s=t.length-1,a="",o=t[0];if(s>0){for(a+=o,e=1;e<s;e++)n=t[e]+"",r=oi-n.length,r&&(a+=M0(r)),a+=n;o=t[e],n=o+"",r=oi-n.length,r&&(a+=M0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var xf=(function(){function t(n,s){var a,o=0,l=n.length;for(n=n.slice();l--;)a=n[l]*s+o,n[l]=a%fo|0,o=a/fo|0;return o&&n.unshift(o),n}function e(n,s,a,o){var l,c;if(a!=o)c=a>o?1:-1;else for(l=c=0;l<a;l++)if(n[l]!=s[l]){c=n[l]>s[l]?1:-1;break}return c}function r(n,s,a){for(var o=0;a--;)n[a]-=o,o=n[a]<s[a]?1:0,n[a]=o*fo+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,o){var l,c,u,h,f,m,g,y,v,w,N,k,C,I,O,L,_,E,M=n.constructor,B=n.s==s.s?1:-1,S=n.d,P=s.d;if(!n.s)return new M(n);if(!s.s)throw Error(ku+"Division by zero");for(c=n.e-s.e,_=P.length,O=S.length,g=new M(B),y=g.d=[],u=0;P[u]==(S[u]||0);)++u;if(P[u]>(S[u]||0)&&--c,a==null?k=a=M.precision:o?k=a+(Sa(n)-Sa(s))+1:k=a,k<0)return new M(0);if(k=k/oi+2|0,u=0,_==1)for(h=0,P=P[0],k++;(u<O||h)&&k--;u++)C=h*fo+(S[u]||0),y[u]=C/P|0,h=C%P|0;else{for(h=fo/(P[0]+1)|0,h>1&&(P=t(P,h),S=t(S,h),_=P.length,O=S.length),I=_,v=S.slice(0,_),w=v.length;w<_;)v[w++]=0;E=P.slice(),E.unshift(0),L=P[0],P[1]>=fo/2&&++L;do h=0,l=e(P,v,_,w),l<0?(N=v[0],_!=w&&(N=N*fo+(v[1]||0)),h=N/L|0,h>1?(h>=fo&&(h=fo-1),f=t(P,h),m=f.length,w=v.length,l=e(f,v,m,w),l==1&&(h--,r(f,_<m?E:P,m))):(h==0&&(l=h=1),f=P.slice()),m=f.length,m<w&&f.unshift(0),r(v,f,w),l==-1&&(w=v.length,l=e(P,v,_,w),l<1&&(h++,r(v,_<w?E:P,w))),w=v.length):l===0&&(h++,v=[0]),y[u++]=h,l&&v[0]?v[w++]=S[I]||0:(v=[S[I]],w=1);while((I++<O||v[0]!==void 0)&&k--)}return y[0]||y.shift(),g.e=c,Ws(g,o?a+Sa(g)+1:a)}})();function Sce(t,e){var r,n,s,a,o,l,c=0,u=0,h=t.constructor,f=h.precision;if(Sa(t)>16)throw Error(IR+Sa(t));if(!t.s)return new h(Tc);for(_i=!1,l=f,o=new h(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(am(2,u))/Math.LN10*2+5|0,l+=n,r=s=a=new h(Tc),h.precision=l;;){if(s=Ws(s.times(t),l),r=r.times(++c),o=a.plus(xf(s,r,l)),th(o.d).slice(0,l)===th(a.d).slice(0,l)){for(;u--;)a=Ws(a.times(a),l);return h.precision=f,e==null?(_i=!0,Ws(a,f)):a}a=o}}function Sa(t){for(var e=t.e*oi,r=t.d[0];r>=10;r/=10)e++;return e}function sT(t,e,r){if(e>t.LN10.sd())throw _i=!0,r&&(t.precision=r),Error(ku+"LN10 precision limit exceeded");return Ws(new t(t.LN10),e)}function M0(t){for(var e="";t--;)e+="0";return e}function F2(t,e){var r,n,s,a,o,l,c,u,h,f=1,m=10,g=t,y=g.d,v=g.constructor,w=v.precision;if(g.s<1)throw Error(ku+(g.s?"NaN":"-Infinity"));if(g.eq(Tc))return new v(0);if(e==null?(_i=!1,u=w):u=e,g.eq(10))return e==null&&(_i=!0),sT(v,u);if(u+=m,v.precision=u,r=th(y),n=r.charAt(0),a=Sa(g),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(t),r=th(g.d),n=r.charAt(0),f++;a=Sa(g),n>1?(g=new v("0."+r),a++):g=new v(n+"."+r.slice(1))}else return c=sT(v,u+2,w).times(a+""),g=F2(new v(n+"."+r.slice(1)),u-m).plus(c),v.precision=w,e==null?(_i=!0,Ws(g,w)):g;for(l=o=g=xf(g.minus(Tc),g.plus(Tc),u),h=Ws(g.times(g),u),s=3;;){if(o=Ws(o.times(h),u),c=l.plus(xf(o,new v(s),u)),th(c.d).slice(0,u)===th(l.d).slice(0,u))return l=l.times(2),a!==0&&(l=l.plus(sT(v,u+2,w).times(a+""))),l=xf(l,new v(f),u),v.precision=w,e==null?(_i=!0,Ws(l,w)):l;l=c,s+=2}}function VK(t,e){var r,n,s;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(n,s),e){if(s-=n,r=r-n-1,t.e=_b(r/oi),t.d=[],n=(r+1)%oi,r<0&&(n+=oi),n<s){for(n&&t.d.push(+e.slice(0,n)),s-=oi;n<s;)t.d.push(+e.slice(n,n+=oi));e=e.slice(n),n=oi-e.length}else n-=s;for(;n--;)e+="0";if(t.d.push(+e),_i&&(t.e>Dk||t.e<-Dk))throw Error(IR+r)}else t.s=0,t.e=0,t.d=[0];return t}function Ws(t,e,r){var n,s,a,o,l,c,u,h,f=t.d;for(o=1,a=f[0];a>=10;a/=10)o++;if(n=e-o,n<0)n+=oi,s=e,u=f[h=0];else{if(h=Math.ceil((n+1)/oi),a=f.length,h>=a)return t;for(u=a=f[h],o=1;a>=10;a/=10)o++;n%=oi,s=n-oi+o}if(r!==void 0&&(a=am(10,o-s-1),l=u/a%10|0,c=e<0||f[h+1]!==void 0||u%a,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?s>0?u/am(10,o-s):0:f[h-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(a=Sa(t),f.length=1,e=e-a-1,f[0]=am(10,(oi-e%oi)%oi),t.e=_b(-e/oi)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=h,a=1,h--):(f.length=h+1,a=am(10,oi-n),f[h]=s>0?(u/am(10,o-s)%am(10,s)|0)*a:0),c)for(;;)if(h==0){(f[0]+=a)==fo&&(f[0]=1,++t.e);break}else{if(f[h]+=a,f[h]!=fo)break;f[h--]=0,a=1}for(n=f.length;f[--n]===0;)f.pop();if(_i&&(t.e>Dk||t.e<-Dk))throw Error(IR+Sa(t));return t}function Cce(t,e){var r,n,s,a,o,l,c,u,h,f,m=t.constructor,g=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),_i?Ws(e,g):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(h=o<0,h?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),s=Math.max(Math.ceil(g/oi),l)+2,o>s&&(o=s,r.length=1),r.reverse(),s=o;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,h=s<l,h&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){h=c[s]<f[s];break}o=0}for(h&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>o;){if(c[--s]<f[s]){for(a=s;a&&c[--a]===0;)c[a]=fo-1;--c[a],c[s]+=fo}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,_i?Ws(e,g):e):new m(0)}function hg(t,e,r){var n,s=Sa(t),a=th(t.d),o=a.length;return e?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+M0(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+M0(-s-1)+a,r&&(n=r-o)>0&&(a+=M0(n))):s>=o?(a+=M0(s+1-o),r&&(n=r-s-1)>0&&(a=a+"."+M0(n))):((n=s+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(s+1===o&&(a+="."),a+=M0(n))),t.s<0?"-"+a:a}function qK(t,e){if(t.length>e)return t.length=e,!0}function Ece(t){var e,r,n;function s(a){var o=this;if(!(o instanceof s))return new s(a);if(o.constructor=s,a instanceof s){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Mm+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return VK(o,a.toString())}else if(typeof a!="string")throw Error(Mm+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,zGe.test(a))VK(o,a);else throw Error(Mm+a)}if(s.prototype=hr,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=Ece,s.config=s.set=VGe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return s.config(t),s}function VGe(t){if(!t||typeof t!="object")throw Error(ku+"Object expected");var e,r,n,s=["precision",1,kb,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((n=t[r=s[e]])!==void 0)if(_b(n)===n&&n>=s[e+1]&&n<=s[e+2])this[r]=n;else throw Error(Mm+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Mm+r+": "+n);return this}var PR=Ece(UGe);Tc=new PR(1);const ws=PR;function Ace(t){var e;return t===0?e=1:e=Math.floor(new ws(t).abs().log(10).toNumber())+1,e}function Tce(t,e,r){for(var n=new ws(t),s=0,a=[];n.lt(e)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}var Ice=t=>{var[e,r]=t,[n,s]=[e,r];return e>r&&([n,s]=[r,e]),[n,s]},Pce=(t,e,r)=>{if(t.lte(0))return new ws(0);var n=Ace(t.toNumber()),s=new ws(10).pow(n),a=t.div(s),o=n!==1?.05:.1,l=new ws(Math.ceil(a.div(o).toNumber())).add(r).mul(o),c=l.mul(s);return e?new ws(c.toNumber()):new ws(Math.ceil(c.toNumber()))},qGe=(t,e,r)=>{var n=new ws(1),s=new ws(t);if(!s.isint()&&r){var a=Math.abs(t);a<1?(n=new ws(10).pow(Ace(t)-1),s=new ws(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new ws(Math.floor(t)))}else t===0?s=new ws(Math.floor((e-1)/2)):r||(s=new ws(Math.floor(t)));for(var o=Math.floor((e-1)/2),l=[],c=0;c<e;c++)l.push(s.add(new ws(c-o).mul(n)).toNumber());return l},Lce=function(e,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new ws(0),tickMin:new ws(0),tickMax:new ws(0)};var o=Pce(new ws(r).sub(e).div(n-1),s,a),l;e<=0&&r>=0?l=new ws(0):(l=new ws(e).add(r).div(2),l=l.sub(new ws(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new ws(r).sub(l).div(o).toNumber()),h=c+u+1;return h>n?Lce(e,r,n,s,a+1):(h<n&&(u=r>0?u+(n-h):u,c=r>0?c:c+(n-h)),{step:o,tickMin:l.sub(new ws(c).mul(o)),tickMax:l.add(new ws(u).mul(o))})},HGe=function(e){var[r,n]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),[l,c]=Ice([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(s-1).fill(1/0)]:[...Array(s-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return qGe(l,s,a);var{step:h,tickMin:f,tickMax:m}=Lce(l,c,o,a,0),g=Tce(f,m.add(new ws(.1).mul(h)),h);return r>n?g.reverse():g},WGe=function(e,r){var[n,s]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=Ice([n,s]);if(o===-1/0||l===1/0)return[n,s];if(o===l)return[o];var c=Math.max(r,2),u=Pce(new ws(l).sub(o).div(c-1),a,0),h=[...Tce(new ws(o),new ws(l),u),l];return a===!1&&(h=h.map(f=>Math.round(f))),n>s?h.reverse():h},Oce=t=>t.rootProps.maxBarSize,GGe=t=>t.rootProps.barGap,Mce=t=>t.rootProps.barCategoryGap,KGe=t=>t.rootProps.barSize,Rw=t=>t.rootProps.stackOffset,Rce=t=>t.rootProps.reverseStackOrder,LR=t=>t.options.chartName,OR=t=>t.rootProps.syncId,Dce=t=>t.rootProps.syncMethod,MR=t=>t.options.eventEmitter,cl={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Xp={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},$d={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},e3=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e};function t3(t,e,r){if(r!=="auto")return r;if(t!=null)return Cp(t,e)?"category":"number"}function HK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Bk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?HK(Object(r),!0).forEach(function(n){YGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YGe(t,e,r){return(e=XGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XGe(t){var e=QGe(t,"string");return typeof e=="symbol"?e:e+""}function QGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WK={allowDataOverflow:Xp.allowDataOverflow,allowDecimals:Xp.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Xp.angleAxisId,includeHidden:!1,name:void 0,reversed:Xp.reversed,scale:Xp.scale,tick:Xp.tick,tickCount:void 0,ticks:void 0,type:Xp.type,unit:void 0},GK={allowDataOverflow:$d.allowDataOverflow,allowDecimals:$d.allowDecimals,allowDuplicatedCategory:$d.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$d.radiusAxisId,includeHidden:$d.includeHidden,name:void 0,reversed:$d.reversed,scale:$d.scale,tick:$d.tick,tickCount:$d.tickCount,ticks:void 0,type:$d.type,unit:void 0},JGe=(t,e)=>{if(e!=null)return t.polarAxis.angleAxis[e]},RR=et([JGe,vle],(t,e)=>{var r;if(t!=null)return t;var n=(r=t3(e,"angleAxis",WK.type))!==null&&r!==void 0?r:"category";return Bk(Bk({},WK),{},{type:n})}),ZGe=(t,e)=>t.polarAxis.radiusAxis[e],DR=et([ZGe,vle],(t,e)=>{var r;if(t!=null)return t;var n=(r=t3(e,"radiusAxis",GK.type))!==null&&r!==void 0?r:"category";return Bk(Bk({},GK),{},{type:n})}),r3=t=>t.polarOptions,BR=et([Vf,qf,Ja],Ble),Bce=et([r3,BR],(t,e)=>{if(t!=null)return dl(t.innerRadius,e,0)}),Fce=et([r3,BR],(t,e)=>{if(t!=null)return dl(t.outerRadius,e,e*.8)}),eKe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},$ce=et([r3],eKe);et([RR,$ce],e3);var Uce=et([BR,Bce,Fce],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});et([DR,Uce],e3);var zce=et([fs,r3,Bce,Fce,Vf,qf],(t,e,r,n,s,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:dl(o,s,s/2),cy:dl(l,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Di=(t,e)=>e,Dw=(t,e,r)=>r;function FR(t){return t?.id}function Vce(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:s,dataKey:a}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var h=FR(l);u.forEach((f,m)=>{var g=a==null||s?m:String(ui(f,a,null)),y=ui(f,l.dataKey,0),v;o.has(g)?v=o.get(g):v={},Object.assign(v,{[h]:y}),o.set(g,v)})}}),Array.from(o.values())}function n3(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var s3=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function i3(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function tKe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var wo=t=>{var e=fs(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Sb=t=>t.tooltip.settings.axisId;function rKe(t){if(t in c1)return c1[t]();var e="scale".concat(_w(t));if(e in c1)return c1[e]()}function KK(t){var e=t.ticks,r=t.bandwidth,n=t.range(),s=[Math.min(...n),Math.max(...n)];return{domain:()=>t.domain(),range:(function(a){function o(){return a.apply(this,arguments)}return o.toString=function(){return a.toString()},o})(()=>s),rangeMin:()=>s[0],rangeMax:()=>s[1],isInRange(a){var o=s[0],l=s[1];return o<=l?a>=o&&a<=l:a>=l&&a<=o},bandwidth:r?()=>r.call(t):void 0,ticks:e?a=>e.call(t,a):void 0,map:(a,o)=>{var l=t(a);if(l!=null){if(t.bandwidth&&o!==null&&o!==void 0&&o.position){var c=t.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function YK(t,e,r){if(typeof t=="function")return KK(t.copy().domain(e).range(r));if(t!=null){var n=rKe(t);if(n!=null)return n.domain(e).range(r),KK(n)}}var qce=(t,e)=>{if(e!=null)switch(t){case"linear":{if(!If(e)){for(var r,n,s=0;s<e.length;s++){var a=e[s];cs(a)&&((r===void 0||a<r)&&(r=a),(n===void 0||a>n)&&(n=a))}return r!==void 0&&n!==void 0?[r,n]:void 0}return e}default:return e}};function XK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Fk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XK(Object(r),!0).forEach(function(n){nKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nKe(t,e,r){return(e=sKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sKe(t){var e=iKe(t,"string");return typeof e=="symbol"?e:e+""}function iKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CP=[0,"auto"],co={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Hce=(t,e)=>t.cartesianAxis.xAxis[e],Gf=(t,e)=>{var r=Hce(t,e);return r??co},uo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:CP,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Aw},Wce=(t,e)=>t.cartesianAxis.yAxis[e],Kf=(t,e)=>{var r=Wce(t,e);return r??uo},aKe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},$R=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??aKe},na=(t,e,r)=>{switch(e){case"xAxis":return Gf(t,r);case"yAxis":return Kf(t,r);case"zAxis":return $R(t,r);case"angleAxis":return RR(t,r);case"radiusAxis":return DR(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},oKe=(t,e,r)=>{switch(e){case"xAxis":return Gf(t,r);case"yAxis":return Kf(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Cb=(t,e,r)=>{switch(e){case"xAxis":return Gf(t,r);case"yAxis":return Kf(t,r);case"angleAxis":return RR(t,r);case"radiusAxis":return DR(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Gce=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function UR(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var zR=t=>t.graphicalItems.cartesianItems,lKe=et([Di,Dw],UR),VR=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),Bw=et([zR,na,lKe],VR,{memoizeOptions:{resultEqualityCheck:i3}}),Kce=et([Bw],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(n3)),Yce=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),cKe=et([Bw],Yce),qR=t=>t.map(e=>e.data).filter(Boolean).flat(1),uKe=et([Bw],qR,{memoizeOptions:{resultEqualityCheck:i3}}),HR=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=e;return t.length>0?t:r.slice(n,s+1)},WR=et([uKe,Nce],HR),GR=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:ui(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(s=>({value:ui(s,n)}))):t.map(n=>({value:n})),a3=et([WR,na,Bw],GR);function Xce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Wj(t){if(gh(t)||t instanceof Date){var e=Number(t);if(cs(e))return e}}function QK(t){if(Array.isArray(t)){var e=[Wj(t[0]),Wj(t[1])];return If(e)?e:void 0}var r=Wj(t);if(r!=null)return[r,r]}function Pf(t){return t.map(Wj).filter(Zd)}function dKe(t,e,r){return!r||typeof e!="number"||mh(e)?[]:r.length?Pf(r.flatMap(n=>{var s=ui(t,n.dataKey),a,o;if(Array.isArray(s)?[a,o]=s:a=o=s,!(!cs(a)||!cs(o)))return[e-a,e+o]})):[]}var eo=t=>{var e=wo(t),r=Sb(t);return Cb(t,e,r)},Fw=et([eo],t=>t?.dataKey),hKe=et([Kce,Nce,eo],Vce),Qce=(t,e,r,n)=>{var s={},a=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},s);return Object.fromEntries(Object.entries(a).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,h=u.map(FR);return[l,{stackedData:Ize(t,h,r),graphicalItems:u}]}))},EP=et([hKe,Kce,Rw,Rce],Qce),Jce=(t,e,r,n)=>{var{dataStartIndex:s,dataEndIndex:a}=e;if(n==null&&r!=="zAxis"){var o=Rze(t,s,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},fKe=et([na],t=>t.allowDataOverflow),KR=t=>{var e;if(t==null||!("domain"in t))return CP;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=Pf(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:CP},YR=et([na],KR),XR=et([YR,fKe],jce),pKe=et([EP,Wf,Di,XR],Jce,{memoizeOptions:{resultEqualityCheck:s3}}),o3=t=>t.errorBars,mKe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>Xce(r,n)),$k=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),o=Math.min(...a),l=Math.max(...a);return[o,l]}},QR=(t,e,r,n,s)=>{var a,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,h,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(N=>Xce(s,N)),m=ui(l,(h=e.dataKey)!==null&&h!==void 0?h:c.dataKey),g=dKe(l,m,f);if(g.length>=2){var y=Math.min(...g),v=Math.max(...g);(a==null||y<a)&&(a=y),(o==null||v>o)&&(o=v)}var w=QK(m);w!=null&&(a=a==null?w[0]:Math.min(a,w[0]),o=o==null?w[1]:Math.max(o,w[1]))})}),e?.dataKey!=null&&t.forEach(l=>{var c=QK(ui(l,e.dataKey));c!=null&&(a=a==null?c[0]:Math.min(a,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),cs(a)&&cs(o))return[a,o]},gKe=et([WR,na,cKe,o3,Di],QR,{memoizeOptions:{resultEqualityCheck:s3}});function xKe(t){var{value:e}=t;if(gh(e)||e instanceof Date)return e}var yKe=(t,e,r)=>{var n=t.map(xKe).filter(s=>s!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&yoe(n))?zle(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Zce=t=>t.referenceElements.dots,Eb=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),bKe=et([Zce,Di,Dw],Eb),eue=t=>t.referenceElements.areas,vKe=et([eue,Di,Dw],Eb),tue=t=>t.referenceElements.lines,wKe=et([tue,Di,Dw],Eb),rue=(t,e)=>{if(t!=null){var r=Pf(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},NKe=et(bKe,Di,rue),nue=(t,e)=>{if(t!=null){var r=Pf(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},jKe=et([vKe,Di],nue);function kKe(t){var e;if(t.x!=null)return Pf([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:Pf(r)}function _Ke(t){var e;if(t.y!=null)return Pf([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:Pf(r)}var sue=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?kKe(n):_Ke(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},SKe=et([wKe,Di],sue),CKe=et(NKe,SKe,jKe,(t,e,r)=>$k(t,r,e)),JR=(t,e,r,n,s,a,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?$k(n,a,s):$k(a,s);return $Ge(e,u,t.allowDataOverflow)},EKe=et([na,YR,XR,pKe,gKe,CKe,fs,Di],JR,{memoizeOptions:{resultEqualityCheck:s3}}),AKe=[0,1],ZR=(t,e,r,n,s,a,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=Cp(e,a);if(u&&l==null){var h;return zle(0,(h=r?.length)!==null&&h!==void 0?h:0)}return c==="category"?yKe(n,t,u):s==="expand"?AKe:o}},e7=et([na,fs,WR,a3,Rw,Di,EKe],ZR);function TKe(t){return t in c1}var iue=(t,e,r)=>{if(t!=null){var{scale:n,type:s}=t;if(n==="auto")return s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!e)?"point":s==="category"?"band":"linear";if(typeof n=="string"){var a="scale".concat(_w(n));return TKe(a)?a:"point"}}},Tp=et([na,Gce,LR],iue);function t7(t,e,r,n){if(!(r==null||n==null))return typeof t.scale=="function"?YK(t.scale,r,n):YK(e,r,n)}var r7=(t,e,r)=>{var n=KR(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&If(t))return HGe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&If(t))return WGe(t,e.tickCount,e.allowDecimals)}},n7=et([e7,Cb,Tp],r7),s7=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&If(e)&&Array.isArray(r)&&r.length>0){var s,a,o=e[0],l=(s=r[0])!==null&&s!==void 0?s:0,c=e[1],u=(a=r[r.length-1])!==null&&a!==void 0?a:0;return[Math.min(o,l),Math.max(c,u)]}return e},IKe=et([na,e7,n7,Di],s7),PKe=et(a3,na,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Pf(t.map(f=>f.value))).sort((f,m)=>f-m),s=n[0],a=n[n.length-1];if(s==null||a==null)return 1/0;var o=a-s;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var h=u-c;r=Math.min(r,h)}}return r/o}}),aue=et(PKe,fs,Mce,Ja,(t,e,r,n,s)=>s,(t,e,r,n,s)=>{if(!cs(t))return 0;var a=e==="vertical"?n.height:n.width;if(s==="gap")return t*a/2;if(s==="no-gap"){var o=dl(r,t*a),l=t*a/2;return l-o-(l-o)/a*o}return 0}),LKe=(t,e,r)=>{var n=Gf(t,e);return n==null||typeof n.padding!="string"?0:aue(t,"xAxis",e,r,n.padding)},OKe=(t,e,r)=>{var n=Kf(t,e);return n==null||typeof n.padding!="string"?0:aue(t,"yAxis",e,r,n.padding)},MKe=et(Gf,LKe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:s}=t;return typeof s=="string"?{left:e,right:e}:{left:((r=s.left)!==null&&r!==void 0?r:0)+e,right:((n=s.right)!==null&&n!==void 0?n:0)+e}}),RKe=et(Kf,OKe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:s}=t;return typeof s=="string"?{top:e,bottom:e}:{top:((r=s.top)!==null&&r!==void 0?r:0)+e,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+e}}),DKe=et([Ja,MKe,FS,BS,(t,e,r)=>r],(t,e,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),BKe=et([Ja,fs,RKe,FS,BS,(t,e,r)=>r],(t,e,r,n,s,a)=>{var{padding:o}=s;return a?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),$w=(t,e,r,n)=>{var s;switch(e){case"xAxis":return DKe(t,r,n);case"yAxis":return BKe(t,r,n);case"zAxis":return(s=$R(t,r))===null||s===void 0?void 0:s.range;case"angleAxis":return $ce(t);case"radiusAxis":return Uce(t,r);default:return}},oue=et([na,$w],e3),FKe=et([Tp,IKe],qce),l3=et([na,Tp,FKe,oue],t7);et([Bw,o3,Di],mKe);function lue(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var c3=(t,e)=>e,u3=(t,e,r)=>r,$Ke=et(RS,c3,u3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(lue)),UKe=et(DS,c3,u3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(lue)),cue=(t,e)=>({width:t.width,height:e.height}),zKe=(t,e)=>{var r=typeof e.width=="number"?e.width:Aw;return{width:r,height:t.height}},uue=et(Ja,Gf,cue),VKe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},qKe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},HKe=et(qf,Ja,$Ke,c3,u3,(t,e,r,n,s)=>{var a={},o;return r.forEach(l=>{var c=cue(e,l);o==null&&(o=VKe(e,n,t));var u=n==="top"&&!s||n==="bottom"&&s;a[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),a}),WKe=et(Vf,Ja,UKe,c3,u3,(t,e,r,n,s)=>{var a={},o;return r.forEach(l=>{var c=zKe(e,l);o==null&&(o=qKe(e,n,t));var u=n==="left"&&!s||n==="right"&&s;a[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),a}),GKe=(t,e)=>{var r=Gf(t,e);if(r!=null)return HKe(t,r.orientation,r.mirror)},KKe=et([Ja,Gf,GKe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var s=r?.[n];return s==null?{x:t.left,y:0}:{x:t.left,y:s}}}),YKe=(t,e)=>{var r=Kf(t,e);if(r!=null)return WKe(t,r.orientation,r.mirror)},XKe=et([Ja,Kf,YKe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var s=r?.[n];return s==null?{x:0,y:t.top}:{x:s,y:t.top}}}),due=et(Ja,Kf,(t,e)=>{var r=typeof e.width=="number"?e.width:Aw;return{width:r,height:t.height}}),JK=(t,e,r)=>{switch(e){case"xAxis":return uue(t,r).width;case"yAxis":return due(t,r).height;default:return}},hue=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:o}=r,l=Cp(t,n),c=e.map(u=>u.value);if(o&&l&&a==="category"&&s&&yoe(c))return c}},i7=et([fs,a3,na,Di],hue),fue=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,o=Cp(t,n);if(o&&(s==="number"||a!=="auto"))return e.map(l=>l.value)}},a7=et([fs,a3,Cb,Di],fue);et([fs,oKe,Tp,l3,i7,a7,$w,n7,Di],(t,e,r,n,s,a,o,l,c)=>{if(e!=null){var u=Cp(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var QKe=(t,e,r,n,s,a,o,l,c)=>{if(!(e==null||n==null)){var u=Cp(t,c),{type:h,ticks:f,tickCount:m}=e,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=h==="category"&&n.bandwidth?n.bandwidth()/g:0;y=c==="angleAxis"&&a!=null&&a.length>=2?Ho(a[0]-a[1])*2*y:y;var v=f||s;return v?v.map((w,N)=>{var k=o?o.indexOf(w):w,C=n.map(k);return cs(C)?{index:N,coordinate:C+y,value:w,offset:y}:null}).filter(Zd):u&&l?l.map((w,N)=>{var k=n.map(w);return cs(k)?{coordinate:k+y,value:w,index:N,offset:y}:null}).filter(Zd):n.ticks?n.ticks(m).map((w,N)=>{var k=n.map(w);return cs(k)?{coordinate:k+y,value:w,index:N,offset:y}:null}).filter(Zd):n.domain().map((w,N)=>{var k=n.map(w);return cs(k)?{coordinate:k+y,value:o?o[w]:w,index:N,offset:y}:null}).filter(Zd)}},pue=et([fs,Cb,Tp,l3,n7,$w,i7,a7,Di],QKe),JKe=(t,e,r,n,s,a,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=Cp(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&n?.length>=2?Ho(n[0]-n[1])*2*u:u,l&&a?a.map((h,f)=>{var m=r.map(h);return cs(m)?{coordinate:m+u,value:h,index:f,offset:u}:null}).filter(Zd):r.ticks?r.ticks(c).map((h,f)=>{var m=r.map(h);return cs(m)?{coordinate:m+u,value:h,index:f,offset:u}:null}).filter(Zd):r.domain().map((h,f)=>{var m=r.map(h);return cs(m)?{coordinate:m+u,value:s?s[h]:h,index:f,offset:u}:null}).filter(Zd)}},tb=et([fs,Cb,l3,$w,i7,a7,Di],JKe),rb=et(na,l3,(t,e)=>{if(!(t==null||e==null))return Fk(Fk({},t),{},{scale:e})}),ZKe=et([na,Tp,e7,oue],t7);et((t,e,r)=>$R(t,r),ZKe,(t,e)=>{if(!(t==null||e==null))return Fk(Fk({},t),{},{scale:e})});var eYe=et([fs,RS,DS],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),mue=t=>t.options.defaultTooltipEventType,gue=t=>t.options.validateTooltipEventTypes;function xue(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function o7(t,e){var r=mue(t),n=gue(t);return xue(e,r,n)}function tYe(t){return Ar(e=>o7(e,t))}var yue=(t,e)=>{var r,n=Number(e);if(!(mh(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},rYe=t=>t.tooltip.settings,V0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},nYe={itemInteraction:{click:V0,hover:V0},axisInteraction:{click:V0,hover:V0},keyboardInteraction:V0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},bue=fc({name:"tooltip",initialState:nYe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:ji()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,s=cd(t).tooltipItemPayloads.indexOf(r);s>-1&&(t.tooltipItemPayloads[s]=n)},prepare:ji()},removeTooltipEntrySettings:{reducer(t,e){var r=cd(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:ji()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:sYe,replaceTooltipEntrySettings:iYe,removeTooltipEntrySettings:aYe,setTooltipSettingsState:oYe,setActiveMouseOverItemIndex:vue,mouseLeaveItem:lYe,mouseLeaveChart:wue,setActiveClickItemIndex:cYe,setMouseOverAxisIndex:Nue,setMouseClickAxisIndex:uYe,setSyncInteraction:AP,setKeyboardInteraction:TP}=bue.actions,dYe=bue.reducer;function ZK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function YN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZK(Object(r),!0).forEach(function(n){hYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hYe(t,e,r){return(e=fYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fYe(t){var e=pYe(t,"string");return typeof e=="symbol"?e:e+""}function pYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mYe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function gYe(t){return t.index!=null}var jue=(t,e,r,n)=>{if(e==null)return V0;var s=mYe(t,e,r);if(s==null)return V0;if(s.active)return s;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(gYe(s)){if(a)return YN(YN({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return YN(YN({},V0),{},{coordinate:s.coordinate})};function xYe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function yYe(t,e){var r=xYe(t),n=e[0],s=e[1];if(r===void 0)return!1;var a=Math.min(n,s),o=Math.max(n,s);return r>=a&&r<=o}function bYe(t,e,r){if(r==null||e==null)return!0;var n=ui(t,e);return n==null||!If(r)?!0:yYe(n,r)}var l7=(t,e,r,n)=>{var s=t?.index;if(s==null)return null;var a=Number(s);if(!cs(a))return s;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(a,l)),u=e[c];return u==null||bYe(u,r,n)?String(c):null},kue=(t,e,r,n,s,a,o)=>{if(a!=null){var l=o[0],c=l?.getPosition(a);if(c!=null)return c;var u=s?.[Number(a)];if(u)return r==="horizontal"?{x:u.coordinate,y:(n.top+e)/2}:{x:(n.left+t)/2,y:u.coordinate}}},_ue=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var s;if(r==="hover"?s=t.itemInteraction.hover.graphicalItemId:s=t.itemInteraction.click.graphicalItemId,s==null&&n!=null){var a=t.tooltipItemPayloads[0];return a!=null?[a]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===s})},Sue=t=>t.options.tooltipPayloadSearcher,Ab=t=>t.tooltip;function eY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function tY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eY(Object(r),!0).forEach(function(n){vYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vYe(t,e,r){return(e=wYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wYe(t){var e=NYe(t,"string");return typeof e=="symbol"?e:e+""}function NYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jYe(t,e){return t??e}var Cue=(t,e,r,n,s,a,o)=>{if(!(e==null||a==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:h}=r,f=[];return t.reduce((m,g)=>{var y,{dataDefinedOnItem:v,settings:w}=g,N=jYe(v,l),k=Array.isArray(N)?ule(N,u,h):N,C=(y=w?.dataKey)!==null&&y!==void 0?y:n,I=w?.nameKey,O;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&o==="axis"?O=n$e(k,n,s):O=a(k,e,c,I),Array.isArray(O))O.forEach(_=>{var E=tY(tY({},w),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});m.push(JW({tooltipEntrySettings:E,dataKey:_.dataKey,payload:_.payload,value:ui(_.payload,_.dataKey),name:_.name}))});else{var L;m.push(JW({tooltipEntrySettings:w,dataKey:C,payload:O,value:ui(O,C),name:(L=ui(O,I))!==null&&L!==void 0?L:w?.name}))}return m},f)}},c7=et([eo,Gce,LR],iue),kYe=et([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),_Ye=et([wo,Sb],UR),Tb=et([kYe,eo,_Ye],VR,{memoizeOptions:{resultEqualityCheck:i3}}),SYe=et([Tb],t=>t.filter(n3)),CYe=et([Tb],qR,{memoizeOptions:{resultEqualityCheck:i3}}),Ib=et([CYe,Wf],HR),EYe=et([SYe,Wf,eo],Vce),u7=et([Ib,eo,Tb],GR),Eue=et([eo],KR),AYe=et([eo],t=>t.allowDataOverflow),Aue=et([Eue,AYe],jce),TYe=et([Tb],t=>t.filter(n3)),IYe=et([EYe,TYe,Rw,Rce],Qce),PYe=et([IYe,Wf,wo,Aue],Jce),LYe=et([Tb],Yce),OYe=et([Ib,eo,LYe,o3,wo],QR,{memoizeOptions:{resultEqualityCheck:s3}}),MYe=et([Zce,wo,Sb],Eb),RYe=et([MYe,wo],rue),DYe=et([eue,wo,Sb],Eb),BYe=et([DYe,wo],nue),FYe=et([tue,wo,Sb],Eb),$Ye=et([FYe,wo],sue),UYe=et([RYe,$Ye,BYe],$k),zYe=et([eo,Eue,Aue,PYe,OYe,UYe,fs,wo],JR),Uw=et([eo,fs,Ib,u7,Rw,wo,zYe],ZR),VYe=et([Uw,eo,c7],r7),qYe=et([eo,Uw,VYe,wo],s7),Tue=t=>{var e=wo(t),r=Sb(t),n=!1;return $w(t,e,r,n)},Iue=et([eo,Tue],e3),Pue=et([eo,c7,qYe,Iue],t7),HYe=et([fs,u7,eo,wo],hue),WYe=et([fs,u7,eo,wo],fue),GYe=(t,e,r,n,s,a,o,l)=>{if(e){var{type:c}=e,u=Cp(t,l);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/h:0;return f=l==="angleAxis"&&s!=null&&s?.length>=2?Ho(s[0]-s[1])*2*f:f,u&&o?o.map((m,g)=>{var y=n.map(m);return cs(y)?{coordinate:y+f,value:m,index:g,offset:f}:null}).filter(Zd):n.domain().map((m,g)=>{var y=n.map(m);return cs(y)?{coordinate:y+f,value:a?a[m]:m,index:g,offset:f}:null}).filter(Zd)}}},Yf=et([fs,eo,c7,Pue,Tue,HYe,WYe,wo],GYe),d7=et([mue,gue,rYe],(t,e,r)=>xue(r.shared,t,e)),Lue=t=>t.tooltip.settings.trigger,h7=t=>t.tooltip.settings.defaultIndex,zw=et([Ab,d7,Lue,h7],jue),fg=et([zw,Ib,Fw,Uw],l7),Oue=et([Yf,fg],yue),f7=et([zw],t=>{if(t)return t.dataKey}),KYe=et([zw],t=>{if(t)return t.graphicalItemId}),Mue=et([Ab,d7,Lue,h7],_ue),YYe=et([Vf,qf,fs,Ja,Yf,h7,Mue],kue),XYe=et([zw,YYe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),QYe=et([zw],t=>{var e;return(e=t?.active)!==null&&e!==void 0?e:!1}),JYe=et([Mue,fg,Wf,Fw,Oue,Sue,d7],Cue);et([JYe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function rY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function nY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rY(Object(r),!0).forEach(function(n){ZYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZYe(t,e,r){return(e=eXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eXe(t){var e=tXe(t,"string");return typeof e=="symbol"?e:e+""}function tXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rXe=()=>Ar(eo),nXe=()=>{var t=rXe(),e=Ar(Yf),r=Ar(Pue);return yk(!t||!r?void 0:nY(nY({},t),{},{scale:r}),e)};function sY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Tx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sY(Object(r),!0).forEach(function(n){sXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sXe(t,e,r){return(e=iXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iXe(t){var e=aXe(t,"string");return typeof e=="symbol"?e:e+""}function aXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oXe=(t,e,r,n)=>{var s=e.find(a=>a&&a.index===r);if(s){if(t==="horizontal")return{x:s.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:s.coordinate}}return{x:0,y:0}},lXe=(t,e,r,n)=>{var s=e.find(u=>u&&u.index===r);if(s){if(t==="centric"){var a=s.coordinate,{radius:o}=n;return Tx(Tx(Tx({},n),_a(n.cx,n.cy,o,a)),{},{angle:a,radius:o})}var l=s.coordinate,{angle:c}=n;return Tx(Tx(Tx({},n),_a(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function cXe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Rue=(t,e,r,n,s)=>{var a,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,h,f,m,g=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,y=(h=r[l])===null||h===void 0?void 0:h.coordinate,v=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(m=r[l+1])===null||m===void 0?void 0:m.coordinate,w=void 0;if(!(g==null||y==null||v==null))if(Ho(y-g)!==Ho(v-y)){var N=[];if(Ho(v-y)===Ho(s[1]-s[0])){w=v;var k=y+s[1]-s[0];N[0]=Math.min(k,(k+g)/2),N[1]=Math.max(k,(k+g)/2)}else{w=g;var C=v+s[1]-s[0];N[0]=Math.min(y,(C+y)/2),N[1]=Math.max(y,(C+y)/2)}var I=[Math.min(y,(w+y)/2),Math.max(y,(w+y)/2)];if(t>I[0]&&t<=I[1]||t>=N[0]&&t<=N[1]){var O;return(O=r[l])===null||O===void 0?void 0:O.index}}else{var L=Math.min(g,v),_=Math.max(g,v);if(t>(L+y)/2&&t<=(_+y)/2){var E;return(E=r[l])===null||E===void 0?void 0:E.index}}}else if(e)for(var M=0;M<o;M++){var B=e[M];if(B!=null){var S=e[M+1],P=e[M-1];if(M===0&&S!=null&&t<=(B.coordinate+S.coordinate)/2||M===o-1&&P!=null&&t>(B.coordinate+P.coordinate)/2||M>0&&M<o-1&&P!=null&&S!=null&&t>(B.coordinate+P.coordinate)/2&&t<=(B.coordinate+S.coordinate)/2)return B.index}}return-1},uXe=()=>Ar(LR),p7=(t,e)=>e,Due=(t,e,r)=>r,m7=(t,e,r,n)=>n,dXe=et(Yf,t=>_S(t,e=>e.coordinate)),g7=et([Ab,p7,Due,m7],jue),x7=et([g7,Ib,Fw,Uw],l7),hXe=(t,e,r)=>{if(e!=null){var n=Ab(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Bue=et([Ab,p7,Due,m7],_ue),Uk=et([Vf,qf,fs,Ja,Yf,m7,Bue],kue),fXe=et([g7,Uk],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Fue=et([Yf,x7],yue),pXe=et([Bue,x7,Wf,Fw,Fue,Sue,p7],Cue),mXe=et([g7,x7],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),gXe=(t,e,r,n,s,a,o)=>{if(!(!t||!r||!n||!s)&&cXe(t,o)){var l=Dze(t,e),c=Rue(l,a,s,r,n),u=oXe(e,s,c,t);return{activeIndex:String(c),activeCoordinate:u}}},xXe=(t,e,r,n,s,a,o)=>{if(!(!t||!n||!s||!a||!r)){var l=tHe(t,r);if(l){var c=Bze(l,e),u=Rue(c,o,a,n,s),h=lXe(e,a,u,l);return{activeIndex:String(u),activeCoordinate:h}}}},yXe=(t,e,r,n,s,a,o,l)=>{if(!(!t||!e||!n||!s||!a))return e==="horizontal"||e==="vertical"?gXe(t,e,n,s,a,o,l):xXe(t,e,r,n,s,a,o)},bXe=et(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),vXe=et(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(cl)),r=Array.from(new Set(e));return r.sort((n,s)=>n-s)},{memoizeOptions:{resultEqualityCheck:tKe}});function iY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function aY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iY(Object(r),!0).forEach(function(n){wXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wXe(t,e,r){return(e=NXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NXe(t){var e=jXe(t,"string");return typeof e=="symbol"?e:e+""}function jXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kXe={},_Xe={zIndexMap:Object.values(cl).reduce((t,e)=>aY(aY({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),kXe)},SXe=new Set(Object.values(cl));function CXe(t){return SXe.has(t)}var $ue=fc({name:"zIndex",initialState:_Xe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:ji()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!CXe(r)&&delete t.zIndexMap[r])},prepare:ji()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:s}=e.payload;t.zIndexMap[r]?s?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:s?void 0:n,panoramaElement:s?n:void 0}},prepare:ji()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:ji()}}}),{registerZIndexPortal:EXe,unregisterZIndexPortal:AXe,registerZIndexPortalElement:TXe,unregisterZIndexPortalElement:IXe}=$ue.actions,PXe=$ue.reducer;function Sh(t){var{zIndex:e,children:r}=t,n=gVe(),s=n&&e!==void 0&&e!==0,a=$c(),o=Zs();b.useLayoutEffect(()=>s?(o(EXe({zIndex:e})),()=>{o(AXe({zIndex:e}))}):wb,[o,e,s]);var l=Ar(c=>bXe(c,e,a));return s?l?Kn.createPortal(r,l):null:r}function IP(){return IP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IP.apply(null,arguments)}function oY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function XN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oY(Object(r),!0).forEach(function(n){LXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LXe(t,e,r){return(e=OXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OXe(t){var e=MXe(t,"string");return typeof e=="symbol"?e:e+""}function MXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RXe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return b.isValidElement(e)?b.cloneElement(e,n):b.createElement(r,n)}function DXe(t){var e,{coordinate:r,payload:n,index:s,offset:a,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:h}=t,f=r,m=n,g=s;if(!c||!f||h!=="ScatterChart"&&u!=="axis")return null;var y,v,w;if(h==="ScatterChart")y=f,v=mqe,w=cl.cursorLine;else if(h==="BarChart")y=gqe(l,f,a,o),v=Dle,w=cl.cursorRectangle;else if(l==="radial"&&voe(f)){var{cx:N,cy:k,radius:C,startAngle:I,endAngle:O}=Fle(f);y={cx:N,cy:k,startAngle:I,endAngle:O,innerRadius:C,outerRadius:C},v=Ule,w=cl.cursorLine}else y={points:iHe(l,f,a)},v=oR,w=cl.cursorLine;var L=typeof c=="object"&&"className"in c?c.className:void 0,_=XN(XN(XN(XN({stroke:"#ccc",pointerEvents:"none"},a),y),S2(c)),{},{payload:m,payloadIndex:g,className:js("recharts-tooltip-cursor",L)});return b.createElement(Sh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:w},b.createElement(RXe,{cursor:c,cursorComp:v,cursorProps:_}))}function BXe(t){var e=nXe(),r=pVe(),n=Nb(),s=uXe();return e==null||r==null||n==null||s==null?null:b.createElement(DXe,IP({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:s}))}var Uue=b.createContext(null),FXe=()=>b.useContext(Uue),$2=new $se,PP="recharts.syncEvent.tooltip",lY="recharts.syncEvent.brush",zue=(t,e)=>{if(e&&Array.isArray(t)){var r=Number.parseInt(e,10);if(!mh(r))return t[r]}},$Xe={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},Vue=fc({name:"options",initialState:$Xe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),UXe=Vue.reducer,{createEventEmitter:zXe}=Vue.actions;function VXe(t){return t.tooltip.syncInteraction}var qXe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},que=fc({name:"chartData",initialState:qXe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:cY,setDataStartEndIndexes:HXe,setComputedData:Ndt}=que.actions,WXe=que.reducer,GXe=["x","y"];function uY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ix(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uY(Object(r),!0).forEach(function(n){KXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function KXe(t,e,r){return(e=YXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YXe(t){var e=XXe(t,"string");return typeof e=="symbol"?e:e+""}function XXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QXe(t,e){if(t==null)return{};var r,n,s=JXe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function JXe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ZXe(){var t=Ar(OR),e=Ar(MR),r=Zs(),n=Ar(Dce),s=Ar(Yf),a=Nb(),o=$S(),l=Ar(c=>c.rootProps.className);b.useEffect(()=>{if(t==null)return wb;var c=(u,h,f)=>{if(e!==f&&t===u){if(n==="index"){var m;if(o&&h!==null&&h!==void 0&&(m=h.payload)!==null&&m!==void 0&&m.coordinate&&h.payload.sourceViewBox){var g=h.payload.coordinate,{x:y,y:v}=g,w=QXe(g,GXe),{x:N,y:k,width:C,height:I}=h.payload.sourceViewBox,O=Ix(Ix({},w),{},{x:o.x+(C?(y-N)/C:0)*o.width,y:o.y+(I?(v-k)/I:0)*o.height});r(Ix(Ix({},h),{},{payload:Ix(Ix({},h.payload),{},{coordinate:O})}))}else r(h);return}if(s!=null){var L;if(typeof n=="function"){var _={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},E=n(s,_);L=s[E]}else n==="value"&&(L=s.find(G=>String(G.value)===h.payload.label));var{coordinate:M}=h.payload;if(L==null||h.payload.active===!1||M==null||o==null){r(AP({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:S}=M,P=Math.min(B,o.x+o.width),R=Math.min(S,o.y+o.height),V={x:a==="horizontal"?L.coordinate:P,y:a==="horizontal"?R:L.coordinate},ee=AP({active:h.payload.active,coordinate:V,dataKey:h.payload.dataKey,index:String(L.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});r(ee)}}};return $2.on(PP,c),()=>{$2.off(PP,c)}},[l,r,e,t,n,s,a,o])}function eQe(){var t=Ar(OR),e=Ar(MR),r=Zs();b.useEffect(()=>{if(t==null)return wb;var n=(s,a,o)=>{e!==o&&t===s&&r(HXe(a))};return $2.on(lY,n),()=>{$2.off(lY,n)}},[r,e,t])}function tQe(){var t=Zs();b.useEffect(()=>{t(zXe())},[t]),ZXe(),eQe()}function rQe(t,e,r,n,s,a){var o=Ar(g=>hXe(g,t,e)),l=Ar(MR),c=Ar(OR),u=Ar(Dce),h=Ar(VXe),f=h?.active,m=$S();b.useEffect(()=>{if(!f&&c!=null&&l!=null){var g=AP({active:a,coordinate:r,dataKey:o,index:s,label:typeof n=="number"?String(n):n,sourceViewBox:m,graphicalItemId:void 0});$2.emit(PP,c,g,l)}},[f,r,o,s,n,l,c,u,a,m])}function dY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function hY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dY(Object(r),!0).forEach(function(n){nQe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nQe(t,e,r){return(e=sQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sQe(t){var e=iQe(t,"string");return typeof e=="symbol"?e:e+""}function iQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aQe(t){return t.dataKey}function oQe(t,e){return b.isValidElement(t)?b.cloneElement(t,e):typeof t=="function"?b.createElement(t,e):b.createElement(KVe,e)}var fY=[],lQe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function pY(t){var e,r,n=Go(t,lQe),{active:s,allowEscapeViewBox:a,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:h,offset:f,payloadUniqBy:m,position:g,reverseDirection:y,useTranslate3d:v,wrapperStyle:w,cursor:N,shared:k,trigger:C,defaultIndex:I,portal:O,axisId:L}=n,_=Zs(),E=typeof I=="number"?String(I):I;b.useEffect(()=>{_(oYe({shared:k,trigger:C,axisId:L,active:s,defaultIndex:E}))},[_,k,C,L,s,E]);var M=$S(),B=Ple(),S=tYe(k),{activeIndex:P,isActive:R}=(e=Ar(Ne=>mXe(Ne,S,C,E)))!==null&&e!==void 0?e:{},V=Ar(Ne=>pXe(Ne,S,C,E)),ee=Ar(Ne=>Fue(Ne,S,C,E)),G=Ar(Ne=>fXe(Ne,S,C,E)),J=V,Z=FXe(),se=(r=s??R)!==null&&r!==void 0?r:!1,[X,q]=Ooe([J,se]),U=S==="axis"?ee:void 0;rQe(S,C,G,U,P,se);var H=O??Z;if(H==null||M==null||S==null)return null;var re=J??fY;se||(re=fY),u&&re.length&&(re=Aoe(re.filter(Ne=>Ne.value!=null&&(Ne.hide!==!0||n.includeHidden)),m,aQe));var ae=re.length>0,xe=b.createElement(tqe,{allowEscapeViewBox:a,animationDuration:o,animationEasing:l,isAnimationActive:h,active:se,coordinate:G,hasPayload:ae,offset:f,position:g,reverseDirection:y,useTranslate3d:v,viewBox:M,wrapperStyle:w,lastBoundingBox:X,innerRef:q,hasPortalFromProps:!!O},oQe(c,hY(hY({},n),{},{payload:re,label:U,active:se,activeIndex:P,coordinate:G,accessibilityLayer:B})));return b.createElement(b.Fragment,null,Kn.createPortal(xe,H),se&&b.createElement(BXe,{cursor:N,tooltipEventType:S,coordinate:G,payload:re,index:P}))}var nb=t=>null;nb.displayName="Cell";function cQe(t,e,r){return(e=uQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uQe(t){var e=dQe(t,"string");return typeof e=="symbol"?e:e+""}function dQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hQe{constructor(e){cQe(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function mY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function fQe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mY(Object(r),!0).forEach(function(n){pQe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pQe(t,e,r){return(e=mQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mQe(t){var e=gQe(t,"string");return typeof e=="symbol"?e:e+""}function gQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xQe={cacheSize:2e3,enableCache:!0},Hue=fQe({},xQe),gY=new hQe(Hue.cacheSize),yQe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},xY="recharts_measurement_span";function bQe(t,e){var r=e.fontSize||"",n=e.fontFamily||"",s=e.fontWeight||"",a=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(o,"|").concat(l)}var yY=(t,e)=>{try{var r=document.getElementById(xY);r||(r=document.createElement("span"),r.setAttribute("id",xY),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,yQe,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},B1=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||qS.isSsr)return{width:0,height:0};if(!Hue.enableCache)return yY(e,r);var n=bQe(e,r),s=gY.get(n);if(s)return s;var a=yY(e,r);return gY.set(n,a),a},Wue;function vQe(t,e,r){return(e=wQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wQe(t){var e=NQe(t,"string");return typeof e=="symbol"?e:e+""}function NQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bY=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vY=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,jQe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,kQe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_Qe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},SQe=["cm","mm","pt","pc","in","Q","px"];function CQe(t){return SQe.includes(t)}var Jx="NaN";function EQe(t,e){return t*_Qe[e]}class Fo{static parse(e){var r,[,n,s]=(r=kQe.exec(e))!==null&&r!==void 0?r:[];return n==null?Fo.NaN:new Fo(parseFloat(n),s??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,mh(e)&&(this.unit=""),r!==""&&!jQe.test(r)&&(this.num=NaN,this.unit=""),CQe(r)&&(this.num=EQe(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new Fo(NaN,""):new Fo(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Fo(NaN,""):new Fo(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Fo(NaN,""):new Fo(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Fo(NaN,""):new Fo(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return mh(this.num)}}Wue=Fo;vQe(Fo,"NaN",new Wue(NaN,""));function Gue(t){if(t==null||t.includes(Jx))return Jx;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,s,a]=(r=bY.exec(e))!==null&&r!==void 0?r:[],o=Fo.parse(n??""),l=Fo.parse(a??""),c=s==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Jx;e=e.replace(bY,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,h,f,m]=(u=vY.exec(e))!==null&&u!==void 0?u:[],g=Fo.parse(h??""),y=Fo.parse(m??""),v=f==="+"?g.add(y):g.subtract(y);if(v.isNaN())return Jx;e=e.replace(vY,v.toString())}return e}var wY=/\(([^()]*)\)/;function AQe(t){for(var e=t,r;(r=wY.exec(e))!=null;){var[,n]=r;e=e.replace(wY,Gue(n))}return e}function TQe(t){var e=t.replace(/\s+/g,"");return e=AQe(e),e=Gue(e),e}function IQe(t){try{return TQe(t)}catch{return Jx}}function iT(t){var e=IQe(t.slice(5,-1));return e===Jx?"":e}var PQe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],LQe=["dx","dy","angle","className","breakAll"];function LP(){return LP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},LP.apply(null,arguments)}function NY(t,e){if(t==null)return{};var r,n,s=OQe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function OQe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Kue=/[ \f\n\r\t\v\u2028\u2029]+/,Yue=t=>{var{children:e,breakAll:r,style:n}=t;try{var s=[];xo(e)||(r?s=e.toString().split(""):s=e.toString().split(Kue));var a=s.map(l=>({word:l,width:B1(l,n).width})),o=r?0:B1("",n).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}};function MQe(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Xue=(t,e,r,n)=>t.reduce((s,a)=>{var{word:o,width:l}=a,c=s[s.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};s.push(u)}return s},[]),Que=t=>t.reduce((e,r)=>e.width>r.width?e:r),RQe="",jY=(t,e,r,n,s,a,o,l)=>{var c=t.slice(0,e),u=Yue({breakAll:r,style:n,children:c+RQe});if(!u)return[!1,[]];var h=Xue(u.wordsWithComputedWidth,a,o,l),f=h.length>s||Que(h).width>Number(a);return[f,h]},DQe=(t,e,r,n,s)=>{var{maxLines:a,children:o,style:l,breakAll:c}=t,u=Mr(a),h=String(o),f=Xue(e,n,r,s);if(!u||s)return f;var m=f.length>a||Que(f).width>Number(n);if(!m)return f;for(var g=0,y=h.length-1,v=0,w;g<=y&&v<=h.length-1;){var N=Math.floor((g+y)/2),k=N-1,[C,I]=jY(h,k,c,l,a,n,r,s),[O]=jY(h,N,c,l,a,n,r,s);if(!C&&!O&&(g=N+1),C&&O&&(y=N-1),!C&&O){w=I;break}v++}return w||f},kY=t=>{var e=xo(t)?[]:t.toString().split(Kue);return[{words:e,width:void 0}]},BQe=t=>{var{width:e,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:o}=t;if((e||r)&&!qS.isSsr){var l,c,u=Yue({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:h,spaceWidth:f}=u;l=h,c=f}else return kY(n);return DQe({breakAll:a,children:n,maxLines:o,style:s},l,c,e,!!r)}return kY(n)},Jue="#808080",FQe={angle:0,breakAll:!1,capHeight:"0.71em",fill:Jue,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},d3=b.forwardRef((t,e)=>{var r=Go(t,FQe),{x:n,y:s,lineHeight:a,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:h}=r,f=NY(r,PQe),m=b.useMemo(()=>BQe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:g,dy:y,angle:v,className:w,breakAll:N}=f,k=NY(f,LQe);if(!gh(n)||!gh(s)||m.length===0)return null;var C=Number(n)+(Mr(g)?g:0),I=Number(s)+(Mr(y)?y:0);if(!cs(C)||!cs(I))return null;var O;switch(h){case"start":O=iT("calc(".concat(o,")"));break;case"middle":O=iT("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:O=iT("calc(".concat(m.length-1," * -").concat(a,")"));break}var L=[],_=m[0];if(c&&_!=null){var E=_.width,{width:M}=f;L.push("scale(".concat(Mr(M)&&Mr(E)?M/E:1,")"))}return v&&L.push("rotate(".concat(v,", ").concat(C,", ").concat(I,")")),L.length&&(k.transform=L.join(" ")),b.createElement("text",LP({},Nu(k),{ref:e,x:C,y:I,className:js("recharts-text",w),textAnchor:u,fill:l.includes("url")?Jue:l}),m.map((B,S)=>{var P=B.words.join(N?"":" ");return b.createElement("tspan",{x:C,dy:S===0?O:a,key:"".concat(P,"-").concat(S)},P)}))});d3.displayName="Text";function _Y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ud(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_Y(Object(r),!0).forEach(function(n){$Qe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_Y(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $Qe(t,e,r){return(e=UQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UQe(t){var e=zQe(t,"string");return typeof e=="symbol"?e:e+""}function zQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VQe=t=>{var{viewBox:e,position:r,offset:n=0,parentViewBox:s}=t,{x:a,y:o,height:l,upperWidth:c,lowerWidth:u}=sR(e),h=a,f=a+(c-u)/2,m=(h+f)/2,g=(c+u)/2,y=h+c/2,v=l>=0?1:-1,w=v*n,N=v>0?"end":"start",k=v>0?"start":"end",C=c>=0?1:-1,I=C*n,O=C>0?"end":"start",L=C>0?"start":"end",_=s;if(r==="top"){var E={x:h+c/2,y:o-w,horizontalAnchor:"middle",verticalAnchor:N};return _&&(E.height=Math.max(o-_.y,0),E.width=c),E}if(r==="bottom"){var M={x:f+u/2,y:o+l+w,horizontalAnchor:"middle",verticalAnchor:k};return _&&(M.height=Math.max(_.y+_.height-(o+l),0),M.width=u),M}if(r==="left"){var B={x:m-I,y:o+l/2,horizontalAnchor:O,verticalAnchor:"middle"};return _&&(B.width=Math.max(B.x-_.x,0),B.height=l),B}if(r==="right"){var S={x:m+g+I,y:o+l/2,horizontalAnchor:L,verticalAnchor:"middle"};return _&&(S.width=Math.max(_.x+_.width-S.x,0),S.height=l),S}var P=_?{width:g,height:l}:{};return r==="insideLeft"?Ud({x:m+I,y:o+l/2,horizontalAnchor:L,verticalAnchor:"middle"},P):r==="insideRight"?Ud({x:m+g-I,y:o+l/2,horizontalAnchor:O,verticalAnchor:"middle"},P):r==="insideTop"?Ud({x:h+c/2,y:o+w,horizontalAnchor:"middle",verticalAnchor:k},P):r==="insideBottom"?Ud({x:f+u/2,y:o+l-w,horizontalAnchor:"middle",verticalAnchor:N},P):r==="insideTopLeft"?Ud({x:h+I,y:o+w,horizontalAnchor:L,verticalAnchor:k},P):r==="insideTopRight"?Ud({x:h+c-I,y:o+w,horizontalAnchor:O,verticalAnchor:k},P):r==="insideBottomLeft"?Ud({x:f+I,y:o+l-w,horizontalAnchor:L,verticalAnchor:N},P):r==="insideBottomRight"?Ud({x:f+u-I,y:o+l-w,horizontalAnchor:O,verticalAnchor:N},P):r&&typeof r=="object"&&(Mr(r.x)||lg(r.x))&&(Mr(r.y)||lg(r.y))?Ud({x:a+dl(r.x,g),y:o+dl(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},P):Ud({x:y,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},P)},qQe=["labelRef"],HQe=["content"];function SY(t,e){if(t==null)return{};var r,n,s=WQe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function WQe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function CY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function u1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CY(Object(r),!0).forEach(function(n){GQe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GQe(t,e,r){return(e=KQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KQe(t){var e=YQe(t,"string");return typeof e=="symbol"?e:e+""}function YQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rf(){return rf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rf.apply(null,arguments)}var Zue=b.createContext(null),XQe=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:s,width:a,height:o,children:l}=t,c=b.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:s,width:a,height:o}),[e,r,n,s,a,o]);return b.createElement(Zue.Provider,{value:c},l)},ede=()=>{var t=b.useContext(Zue),e=$S();return t||(e?sR(e):void 0)},QQe=b.createContext(null),JQe=()=>{var t=b.useContext(QQe),e=Ar(zce);return t||e},ZQe=t=>{var{value:e,formatter:r}=t,n=xo(t.children)?e:t.children;return typeof r=="function"?r(n):n},y7=t=>t!=null&&typeof t=="function",eJe=(t,e)=>{var r=Ho(e-t),n=Math.min(Math.abs(e-t),360);return r*n},tJe=(t,e,r,n,s)=>{var{offset:a,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:h,startAngle:f,endAngle:m,clockWise:g}=s,y=(u+h)/2,v=eJe(f,m),w=v>=0?1:-1,N,k;switch(e){case"insideStart":N=f+w*a,k=g;break;case"insideEnd":N=m-w*a,k=!g;break;case"end":N=m+w*a,k=g;break;default:throw new Error("Unsupported position ".concat(e))}k=v<=0?k:!k;var C=_a(l,c,y,N),I=_a(l,c,y,N+(k?1:-1)*359),O="M".concat(C.x,",").concat(C.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(k?0:1,`,
    `).concat(I.x,",").concat(I.y),L=xo(t.id)?C2("recharts-radial-line-"):t.id;return b.createElement("text",rf({},n,{dominantBaseline:"central",className:js("recharts-radial-bar-label",o)}),b.createElement("defs",null,b.createElement("path",{id:L,d:O})),b.createElement("textPath",{xlinkHref:"#".concat(L)},r))},rJe=(t,e,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:h,y:f}=_a(n,s,o+e,u);return{x:h,y:f,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var m=(a+o)/2,{x:g,y}=_a(n,s,m,u);return{x:g,y,textAnchor:"middle",verticalAnchor:"middle"}},Gj=t=>t!=null&&"cx"in t&&Mr(t.cx),nJe={angle:0,offset:5,zIndex:cl.label,position:"middle",textBreakAll:!1};function sJe(t){if(!Gj(t))return t;var{cx:e,cy:r,outerRadius:n}=t,s=n*2;return{x:e-n,y:r-n,width:s,upperWidth:s,lowerWidth:s,height:s}}function R0(t){var e=Go(t,nJe),{viewBox:r,parentViewBox:n,position:s,value:a,children:o,content:l,className:c="",textBreakAll:u,labelRef:h}=e,f=JQe(),m=ede(),g=s==="center"?m:f??m,y,v,w;r==null?y=g:Gj(r)?y=r:y=sR(r);var N=sJe(y);if(!y||xo(a)&&xo(o)&&!b.isValidElement(l)&&typeof l!="function")return null;var k=u1(u1({},e),{},{viewBox:y});if(b.isValidElement(l)){var{labelRef:C}=k,I=SY(k,qQe);return b.cloneElement(l,I)}if(typeof l=="function"){var{content:O}=k,L=SY(k,HQe);if(v=b.createElement(l,L),b.isValidElement(v))return v}else v=ZQe(e);var _=Nu(e);if(Gj(y)){if(s==="insideStart"||s==="insideEnd"||s==="end")return tJe(e,s,v,_,y);w=rJe(y,e.offset,e.position)}else{if(!N)return null;var E=VQe({viewBox:N,position:s,offset:e.offset,parentViewBox:Gj(n)?void 0:n});w=u1(u1({x:E.x,y:E.y,textAnchor:E.horizontalAnchor,verticalAnchor:E.verticalAnchor},E.width!==void 0?{width:E.width}:{}),E.height!==void 0?{height:E.height}:{})}return b.createElement(Sh,{zIndex:e.zIndex},b.createElement(d3,rf({ref:h,className:js("recharts-label",c)},_,w,{textAnchor:MQe(_.textAnchor)?_.textAnchor:w.textAnchor,breakAll:u}),v))}R0.displayName="Label";var iJe=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?b.createElement(R0,rf({key:"label-implicit"},n)):gh(t)?b.createElement(R0,rf({key:"label-implicit",value:t},n)):b.isValidElement(t)?t.type===R0?b.cloneElement(t,u1({key:"label-implicit"},n)):b.createElement(R0,rf({key:"label-implicit",content:t},n)):y7(t)?b.createElement(R0,rf({key:"label-implicit",content:t},n)):t&&typeof t=="object"?b.createElement(R0,rf({},t,{key:"label-implicit"},n)):null};function aJe(t){var{label:e,labelRef:r}=t,n=ede();return iJe(e,n,r)||null}var aT={},oT={},EY;function oJe(){return EY||(EY=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(oT)),oT}var lT={},AY;function lJe(){return AY||(AY=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(lT)),lT}var TY;function cJe(){return TY||(TY=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oJe(),r=lJe(),n=GM();function s(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=s})(aT)),aT}var cT,IY;function uJe(){return IY||(IY=1,cT=cJe().last),cT}var dJe=uJe();const hJe=Pl(dJe);var fJe=["valueAccessor"],pJe=["dataKey","clockWise","id","textBreakAll","zIndex"];function zk(){return zk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zk.apply(null,arguments)}function PY(t,e){if(t==null)return{};var r,n,s=mJe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function mJe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var gJe=t=>Array.isArray(t.value)?hJe(t.value):t.value,tde=b.createContext(void 0),xJe=tde.Provider,rde=b.createContext(void 0),yJe=rde.Provider;function bJe(){return b.useContext(tde)}function vJe(){return b.useContext(rde)}function Kj(t){var{valueAccessor:e=gJe}=t,r=PY(t,fJe),{dataKey:n,clockWise:s,id:a,textBreakAll:o,zIndex:l}=r,c=PY(r,pJe),u=bJe(),h=vJe(),f=u||h;return!f||!f.length?null:b.createElement(Sh,{zIndex:l??cl.label},b.createElement(Tl,{className:"recharts-label-list"},f.map((m,g)=>{var y,v=xo(n)?e(m,g):ui(m.payload,n),w=xo(a)?{}:{id:"".concat(a,"-").concat(g)};return b.createElement(R0,zk({key:"label-".concat(g)},Nu(m),c,w,{fill:(y=r.fill)!==null&&y!==void 0?y:m.fill,parentViewBox:m.parentViewBox,value:v,textBreakAll:o,viewBox:m.viewBox,index:g,zIndex:0}))})))}Kj.displayName="LabelList";function nde(t){var{label:e}=t;return e?e===!0?b.createElement(Kj,{key:"labelList-implicit"}):b.isValidElement(e)||y7(e)?b.createElement(Kj,{key:"labelList-implicit",content:e}):typeof e=="object"?b.createElement(Kj,zk({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var sde=t=>t.graphicalItems.polarItems,wJe=et([Di,Dw],UR),h3=et([sde,na,wJe],VR),NJe=et([h3],qR),f3=et([NJe,ZS],HR),jJe=et([f3,na,h3],GR);et([f3,na,h3],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(s=>{var a,o=ui(n,(a=e.dataKey)!==null&&a!==void 0?a:s.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:ui(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var LY=()=>{},kJe=et([f3,na,h3,o3,Di],QR),_Je=et([na,YR,XR,LY,kJe,LY,fs,Di],JR),ide=et([na,fs,f3,jJe,Rw,Di,_Je],ZR),SJe=et([ide,Cb,Tp],r7),CJe=et([na,ide,SJe,Di],s7);et([Tp,CJe],qce);var EJe={radiusAxis:{},angleAxis:{}},ade=fc({name:"polarAxis",initialState:EJe,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:jdt,removeRadiusAxis:kdt,addAngleAxis:_dt,removeAngleAxis:Sdt}=ade.actions,AJe=ade.reducer;function ode(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}function OY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function MY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OY(Object(r),!0).forEach(function(n){TJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TJe(t,e,r){return(e=IJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IJe(t){var e=PJe(t,"string");return typeof e=="symbol"?e:e+""}function PJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LJe=(t,e)=>e,b7=et([sde,LJe],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),OJe=[],v7=(t,e,r)=>r?.length===0?OJe:r,lde=et([ZS,b7,v7],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var s;if(e?.data!=null&&e.data.length>0?s=e.data:s=n,(!s||!s.length)&&r!=null&&(s=r.map(a=>MY(MY({},e.presentationProps),a.props))),s!=null)return s}}),MJe=et([lde,b7,v7],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,s)=>{var a,o=ui(n,e.nameKey,e.name),l;return r!=null&&(a=r[s])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?l=r[s].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:MS(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),RJe=et([lde,b7,v7,Ja],(t,e,r,n)=>{if(!(e==null||t==null))return FZe({offset:n,pieSettings:e,displayedData:t,cells:r})}),uT={exports:{}},Os={};var RY;function DJe(){if(RY)return Os;RY=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function y(v){if(typeof v=="object"&&v!==null){var w=v.$$typeof;switch(w){case t:switch(v=v.type,v){case r:case s:case n:case c:case u:case m:return v;default:switch(v=v&&v.$$typeof,v){case o:case l:case f:case h:return v;case a:return v;default:return w}}case e:return w}}}return Os.ContextConsumer=a,Os.ContextProvider=o,Os.Element=t,Os.ForwardRef=l,Os.Fragment=r,Os.Lazy=f,Os.Memo=h,Os.Portal=e,Os.Profiler=s,Os.StrictMode=n,Os.Suspense=c,Os.SuspenseList=u,Os.isContextConsumer=function(v){return y(v)===a},Os.isContextProvider=function(v){return y(v)===o},Os.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},Os.isForwardRef=function(v){return y(v)===l},Os.isFragment=function(v){return y(v)===r},Os.isLazy=function(v){return y(v)===f},Os.isMemo=function(v){return y(v)===h},Os.isPortal=function(v){return y(v)===e},Os.isProfiler=function(v){return y(v)===s},Os.isStrictMode=function(v){return y(v)===n},Os.isSuspense=function(v){return y(v)===c},Os.isSuspenseList=function(v){return y(v)===u},Os.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===r||v===s||v===n||v===c||v===u||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===h||v.$$typeof===o||v.$$typeof===a||v.$$typeof===l||v.$$typeof===g||v.getModuleId!==void 0)},Os.typeOf=y,Os}var DY;function BJe(){return DY||(DY=1,uT.exports=DJe()),uT.exports}var FJe=BJe(),BY=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",FY=null,dT=null,cde=t=>{if(t===FY&&Array.isArray(dT))return dT;var e=[];return b.Children.forEach(t,r=>{xo(r)||(FJe.isFragment(r)?e=e.concat(cde(r.props.children)):e.push(r))}),dT=e,FY=t,e};function w7(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(s=>BY(s)):n=[BY(e)],cde(t).forEach(s=>{var a=og(s,"type.displayName")||og(s,"type.name");a&&n.indexOf(a)!==-1&&r.push(s)}),r}var hT={},$Y;function $Je(){return $Y||($Y=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(hT)),hT}var fT,UY;function UJe(){return UY||(UY=1,fT=$Je().isPlainObject),fT}var zJe=UJe();const VJe=Pl(zJe);var zY,VY,qY,HY,WY;function GY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function KY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GY(Object(r),!0).forEach(function(n){qJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qJe(t,e,r){return(e=HJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HJe(t){var e=WJe(t,"string");return typeof e=="symbol"?e:e+""}function WJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vk(){return Vk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vk.apply(null,arguments)}function Hv(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var YY=(t,e,r,n,s)=>{var a=r-n,o;return o=Ji(zY||(zY=Hv(["M ",",",""])),t,e),o+=Ji(VY||(VY=Hv(["L ",",",""])),t+r,e),o+=Ji(qY||(qY=Hv(["L ",",",""])),t+r-a/2,e+s),o+=Ji(HY||(HY=Hv(["L ",",",""])),t+r-a/2-n,e+s),o+=Ji(WY||(WY=Hv(["L ",","," Z"])),t,e),o},GJe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},KJe=t=>{var e=Go(t,GJe),{x:r,y:n,upperWidth:s,lowerWidth:a,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:h,isUpdateAnimationActive:f}=e,m=b.useRef(null),[g,y]=b.useState(-1),v=b.useRef(s),w=b.useRef(a),N=b.useRef(o),k=b.useRef(r),C=b.useRef(n),I=WS(t,"trapezoid-");if(b.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var V=m.current.getTotalLength();V&&y(V)}catch{}},[]),r!==+r||n!==+n||s!==+s||a!==+a||o!==+o||s===0&&a===0||o===0)return null;var O=js("recharts-trapezoid",l);if(!f)return b.createElement("g",null,b.createElement("path",Vk({},Nu(e),{className:O,d:YY(r,n,s,a,o)})));var L=v.current,_=w.current,E=N.current,M=k.current,B=C.current,S="0px ".concat(g===-1?1:g,"px"),P="".concat(g,"px 0px"),R=Lle(["strokeDasharray"],u,c);return b.createElement(HS,{animationId:I,key:I,canBegin:g>0,duration:u,easing:c,isActive:f,begin:h},V=>{var ee=Va(L,s,V),G=Va(_,a,V),J=Va(E,o,V),Z=Va(M,r,V),se=Va(B,n,V);m.current&&(v.current=ee,w.current=G,N.current=J,k.current=Z,C.current=se);var X=V>0?{transition:R,strokeDasharray:P}:{strokeDasharray:S};return b.createElement("path",Vk({},Nu(e),{className:O,d:YY(Z,se,ee,G,J),ref:m,style:KY(KY({},X),e.style)}))})},YJe=["option","shapeType","activeClassName"];function XJe(t,e){if(t==null)return{};var r,n,s=QJe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function QJe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function XY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function qk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XY(Object(r),!0).forEach(function(n){JJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JJe(t,e,r){return(e=ZJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZJe(t){var e=eZe(t,"string");return typeof e=="symbol"?e:e+""}function eZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tZe(t,e){return qk(qk({},e),t)}function rZe(t,e){return t==="symbols"}function QY(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return b.createElement(Dle,r);case"trapezoid":return b.createElement(KJe,r);case"sector":return b.createElement(Ule,r);case"symbols":if(rZe(e))return b.createElement(WM,r);break;case"curve":return b.createElement(oR,r);default:return null}}function nZe(t){return b.isValidElement(t)?t.props:t}function ude(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,s=XJe(t,YJe),a;if(b.isValidElement(e))a=b.cloneElement(e,qk(qk({},s),nZe(e)));else if(typeof e=="function")a=e(s,s.index);else if(VJe(e)&&typeof e!="boolean"){var o=tZe(e,s);a=b.createElement(QY,{shapeType:r,elementProps:o})}else{var l=s;a=b.createElement(QY,{shapeType:r,elementProps:l})}return s.isActive?b.createElement(Tl,{className:n},a):a}var N7=(t,e,r)=>{var n=Zs();return(s,a)=>o=>{t?.(s,a,o),n(vue({activeIndex:String(a),activeDataKey:e,activeCoordinate:s.tooltipPosition,activeGraphicalItemId:r}))}},j7=t=>{var e=Zs();return(r,n)=>s=>{t?.(r,n,s),e(lYe())}},k7=(t,e,r)=>{var n=Zs();return(s,a)=>o=>{t?.(s,a,o),n(cYe({activeIndex:String(a),activeDataKey:e,activeCoordinate:s.tooltipPosition,activeGraphicalItemId:r}))}};function dde(t){var{tooltipEntrySettings:e}=t,r=Zs(),n=$c(),s=b.useRef(null);return b.useLayoutEffect(()=>{n||(s.current===null?r(sYe(e)):s.current!==e&&r(iYe({prev:s.current,next:e})),s.current=e)},[e,r,n]),b.useLayoutEffect(()=>()=>{s.current&&(r(aYe(s.current)),s.current=null)},[r]),null}function sZe(t){var{legendPayload:e}=t,r=Zs(),n=$c(),s=b.useRef(null);return b.useLayoutEffect(()=>{n||(s.current===null?r(Ele(e)):s.current!==e&&r(Ale({prev:s.current,next:e})),s.current=e)},[r,n,e]),b.useLayoutEffect(()=>()=>{s.current&&(r(Tle(s.current)),s.current=null)},[r]),null}function iZe(t){var{legendPayload:e}=t,r=Zs(),n=Ar(fs),s=b.useRef(null);return b.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(s.current===null?r(Ele(e)):s.current!==e&&r(Ale({prev:s.current,next:e})),s.current=e)},[r,n,e]),b.useLayoutEffect(()=>()=>{s.current&&(r(Tle(s.current)),s.current=null)},[r]),null}var pT,aZe=()=>{var[t]=b.useState(()=>C2("uid-"));return t},oZe=(pT=FT.useId)!==null&&pT!==void 0?pT:aZe;function lZe(t,e){var r=oZe();return e||(t?"".concat(t,"-").concat(r):r)}var cZe=b.createContext(void 0),hde=t=>{var{id:e,type:r,children:n}=t,s=lZe("recharts-".concat(r),e);return b.createElement(cZe.Provider,{value:s},n(s))},uZe={cartesianItems:[],polarItems:[]},fde=fc({name:"graphicalItems",initialState:uZe,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:ji()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,s=cd(t).cartesianItems.indexOf(r);s>-1&&(t.cartesianItems[s]=n)},prepare:ji()},removeCartesianGraphicalItem:{reducer(t,e){var r=cd(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:ji()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:ji()},removePolarGraphicalItem:{reducer(t,e){var r=cd(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:ji()}}}),{addCartesianGraphicalItem:dZe,replaceCartesianGraphicalItem:hZe,removeCartesianGraphicalItem:fZe,addPolarGraphicalItem:pZe,removePolarGraphicalItem:mZe}=fde.actions,gZe=fde.reducer,xZe=t=>{var e=Zs(),r=b.useRef(null);return b.useLayoutEffect(()=>{r.current===null?e(dZe(t)):r.current!==t&&e(hZe({prev:r.current,next:t})),r.current=t},[e,t]),b.useLayoutEffect(()=>()=>{r.current&&(e(fZe(r.current)),r.current=null)},[e]),null},yZe=b.memo(xZe);function bZe(t){var e=Zs();return b.useLayoutEffect(()=>(e(pZe(t)),()=>{e(mZe(t))}),[e,t]),null}var vZe=["key"],wZe=["onMouseEnter","onClick","onMouseLeave"],NZe=["id"],jZe=["id"];function JY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function ea(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JY(Object(r),!0).forEach(function(n){kZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kZe(t,e,r){return(e=_Ze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ze(t){var e=SZe(t,"string");return typeof e=="symbol"?e:e+""}function SZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xp(){return xp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xp.apply(null,arguments)}function p3(t,e){if(t==null)return{};var r,n,s=CZe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function CZe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function EZe(t){var e=b.useMemo(()=>w7(t.children,nb),[t.children]),r=Ar(n=>MJe(n,t.id,e));return r==null?null:b.createElement(iZe,{legendPayload:r})}var AZe=b.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:s,strokeWidth:a,fill:o,name:l,hide:c,tooltipType:u,id:h}=t,f={dataDefinedOnItem:n.map(m=>m.tooltipPayload),getPosition:m=>{var g;return(g=n[Number(m)])===null||g===void 0?void 0:g.tooltipPosition},settings:{stroke:s,strokeWidth:a,fill:o,dataKey:e,nameKey:r,name:MS(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:h}};return b.createElement(dde,{tooltipEntrySettings:f})}),TZe=(t,e)=>t>e?"start":t<e?"end":"middle",IZe=(t,e,r)=>dl(typeof e=="function"?e(t):e,r,r*.8),PZe=(t,e,r)=>{var{top:n,left:s,width:a,height:o}=e,l=Ble(a,o),c=s+dl(t.cx,a,a/2),u=n+dl(t.cy,o,o/2),h=dl(t.innerRadius,l,0),f=IZe(r,t.outerRadius,l),m=t.maxRadius||Math.sqrt(a*a+o*o)/2;return{cx:c,cy:u,innerRadius:h,outerRadius:f,maxRadius:m}},LZe=(t,e)=>{var r=Ho(e-t),n=Math.min(Math.abs(e-t),360);return r*n},OZe=(t,e)=>{if(b.isValidElement(t))return b.cloneElement(t,e);if(typeof t=="function")return t(e);var r=js("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,s=p3(e,vZe);return b.createElement(oR,xp({},s,{type:"linear",className:r}))},MZe=(t,e,r)=>{if(b.isValidElement(t))return b.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),b.isValidElement(n)))return n;var s=js("recharts-pie-label-text",ode(t));return b.createElement(d3,xp({},e,{alignmentBaseline:"middle",className:s}),n)};function RZe(t){var{sectors:e,props:r,showLabels:n}=t,{label:s,labelLine:a,dataKey:o}=r;if(!n||!s||!e)return null;var l=ph(r),c=S2(s),u=S2(a),h=typeof s=="object"&&"offsetRadius"in s&&typeof s.offsetRadius=="number"&&s.offsetRadius||20,f=e.map((m,g)=>{var y=(m.startAngle+m.endAngle)/2,v=_a(m.cx,m.cy,m.outerRadius+h,y),w=ea(ea(ea(ea({},l),m),{},{stroke:"none"},c),{},{index:g,textAnchor:TZe(v.x,m.cx)},v),N=ea(ea(ea(ea({},l),m),{},{fill:"none",stroke:m.fill},u),{},{index:g,points:[_a(m.cx,m.cy,m.outerRadius,y),v],key:"line"});return b.createElement(Sh,{zIndex:cl.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(g)},b.createElement(Tl,null,a&&OZe(a,N),MZe(s,w,ui(m,o))))});return b.createElement(Tl,{className:"recharts-pie-labels"},f)}function DZe(t){var{sectors:e,props:r,showLabels:n}=t,{label:s}=r;return typeof s=="object"&&s!=null&&"position"in s?b.createElement(nde,{label:s}):b.createElement(RZe,{sectors:e,props:r,showLabels:n})}function BZe(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:s,shape:a,id:o}=t,l=Ar(fg),c=Ar(f7),u=Ar(KYe),{onMouseEnter:h,onClick:f,onMouseLeave:m}=s,g=p3(s,wZe),y=N7(h,s.dataKey,o),v=j7(m),w=k7(f,s.dataKey,o);return e==null||e.length===0?null:b.createElement(b.Fragment,null,e.map((N,k)=>{if(N?.startAngle===0&&N?.endAngle===0&&e.length!==1)return null;var C=u==null||u===o,I=String(k)===l&&(c==null||s.dataKey===c)&&C,O=l?n:null,L=r&&I?r:O,_=ea(ea({},N),{},{stroke:N.stroke,tabIndex:-1,[hle]:k,[fle]:o});return b.createElement(Tl,xp({key:"sector-".concat(N?.startAngle,"-").concat(N?.endAngle,"-").concat(N.midAngle,"-").concat(k),tabIndex:-1,className:"recharts-pie-sector"},Sw(g,N,k),{onMouseEnter:y(N,k),onMouseLeave:v(N,k),onClick:w(N,k)}),b.createElement(ude,xp({option:a??L,index:k,shapeType:"sector",isActive:I},_)))}))}function FZe(t){var e,{pieSettings:r,displayedData:n,cells:s,offset:a}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:h,tooltipType:f}=r,m=Math.abs(r.minAngle),g=LZe(l,c),y=Math.abs(g),v=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,w=n.filter(L=>ui(L,u,0)!==0).length,N=(y>=360?w:w-1)*v,k=y-w*m-N,C=n.reduce((L,_)=>{var E=ui(_,u,0);return L+(Mr(E)?E:0)},0),I;if(C>0){var O;I=n.map((L,_)=>{var E=ui(L,u,0),M=ui(L,h,_),B=PZe(r,a,L),S=(Mr(E)?E:0)/C,P,R=ea(ea({},L),s&&s[_]&&s[_].props);_?P=O.endAngle+Ho(g)*v*(E!==0?1:0):P=l;var V=P+Ho(g)*((E!==0?m:0)+S*k),ee=(P+V)/2,G=(B.innerRadius+B.outerRadius)/2,J=[{name:M,value:E,payload:R,dataKey:u,type:f,graphicalItemId:r.id}],Z=_a(B.cx,B.cy,G,ee);return O=ea(ea(ea(ea({},r.presentationProps),{},{percent:S,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:J,midAngle:ee,middleRadius:G,tooltipPosition:Z},R),B),{},{value:E,dataKey:u,startAngle:P,endAngle:V,payload:R,paddingAngle:Ho(g)*v}),O})}return I}function $Ze(t){var{showLabels:e,sectors:r,children:n}=t,s=b.useMemo(()=>!e||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,e]);return b.createElement(yJe,{value:e?s:void 0},n)}function UZe(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:s,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:h,onAnimationStart:f,onAnimationEnd:m}=e,g=WS(e,"recharts-pie-"),y=r.current,[v,w]=b.useState(!1),N=b.useCallback(()=>{typeof m=="function"&&m(),w(!1)},[m]),k=b.useCallback(()=>{typeof f=="function"&&f(),w(!0)},[f]);return b.createElement($Ze,{showLabels:!v,sectors:s},b.createElement(HS,{animationId:g,begin:o,duration:l,isActive:a,easing:c,onAnimationStart:k,onAnimationEnd:N,key:g},C=>{var I,O=[],L=s&&s[0],_=(I=L?.startAngle)!==null&&I!==void 0?I:0;return s?.forEach((E,M)=>{var B=y&&y[M],S=M>0?og(E,"paddingAngle",0):0;if(B){var P=Va(B.endAngle-B.startAngle,E.endAngle-E.startAngle,C),R=ea(ea({},E),{},{startAngle:_+S,endAngle:_+P+S});O.push(R),_=R.endAngle}else{var{endAngle:V,startAngle:ee}=E,G=Va(0,V-ee,C),J=ea(ea({},E),{},{startAngle:_+S,endAngle:_+G+S});O.push(J),_=J.endAngle}}),r.current=O,b.createElement(Tl,null,b.createElement(BZe,{sectors:O,activeShape:u,inactiveShape:h,allOtherPieProps:e,shape:e.shape,id:n}))}),b.createElement(DZe,{showLabels:!v,sectors:s,props:e}),e.children)}var zZe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:cl.area};function VZe(t){var{id:e}=t,r=p3(t,NZe),{hide:n,className:s,rootTabIndex:a}=t,o=b.useMemo(()=>w7(t.children,nb),[t.children]),l=Ar(h=>RJe(h,e,o)),c=b.useRef(null),u=js("recharts-pie",s);return n||l==null?(c.current=null,b.createElement(Tl,{tabIndex:a,className:u})):b.createElement(Sh,{zIndex:t.zIndex},b.createElement(AZe,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),b.createElement(Tl,{tabIndex:a,className:u},b.createElement(UZe,{props:ea(ea({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function pde(t){var e=Go(t,zZe),{id:r}=e,n=p3(e,jZe),s=ph(n);return b.createElement(hde,{id:r,type:"pie"},a=>b.createElement(b.Fragment,null,b.createElement(bZe,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:s,maxRadius:e.maxRadius}),b.createElement(EZe,xp({},n,{id:a})),b.createElement(VZe,xp({},n,{id:a}))))}pde.displayName="Pie";function ZY(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function eX(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZY(Object(r),!0).forEach(function(n){qZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZY(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qZe(t,e,r){return(e=HZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HZe(t){var e=WZe(t,"string");return typeof e=="symbol"?e:e+""}function WZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mde=0,GZe={xAxis:{},yAxis:{},zAxis:{}},gde=fc({name:"cartesianAxis",initialState:GZe,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:ji()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:ji()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:ji()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:ji()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:ji()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:ji()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:ji()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:ji()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:ji()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,s=t.yAxis[r];if(s){var a,o=s.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==s.width&&Math.abs(n-((a=o[0])!==null&&a!==void 0?a:0))<=1)return;var l=[...o,n].slice(-3);t.yAxis[r]=eX(eX({},s),{},{width:n,widthHistory:l})}}}}),{addXAxis:KZe,replaceXAxis:YZe,removeXAxis:XZe,addYAxis:QZe,replaceYAxis:JZe,removeYAxis:ZZe,addZAxis:Cdt,replaceZAxis:Edt,removeZAxis:Adt,updateYAxisWidth:eet}=gde.actions,tet=gde.reducer,ret=et([Ja],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),net=et([ret,Vf,qf],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),xde=()=>Ar(net),tX=(t,e,r)=>{var n=r??t;if(!xo(n))return dl(n,e,0)},set=(t,e,r)=>{var n={},s=t.filter(n3),a=t.filter(u=>u.stackId==null),o=s.reduce((u,h)=>{var f=u[h.stackId];return f==null&&(f=[]),f.push(h),u[h.stackId]=f,u},n),l=Object.entries(o).map(u=>{var h,[f,m]=u,g=m.map(v=>v.dataKey),y=tX(e,r,(h=m[0])===null||h===void 0?void 0:h.barSize);return{stackId:f,dataKeys:g,barSize:y}}),c=a.map(u=>{var h=[u.dataKey].filter(m=>m!=null),f=tX(e,r,u.barSize);return{stackId:void 0,dataKeys:h,barSize:f}});return[...l,...c]};function rX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function QN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rX(Object(r),!0).forEach(function(n){iet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iet(t,e,r){return(e=aet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aet(t){var e=oet(t,"string");return typeof e=="symbol"?e:e+""}function oet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cet(t,e,r,n,s){var a,o=n.length;if(!(o<1)){var l=dl(t,r,0,!0),c,u=[];if(cs((a=n[0])===null||a===void 0?void 0:a.barSize)){var h=!1,f=r/o,m=n.reduce((k,C)=>k+(C.barSize||0),0);m+=(o-1)*l,m>=r&&(m-=(o-1)*l,l=0),m>=r&&f>0&&(h=!0,f*=.9,m=o*f);var g=(r-m)/2>>0,y={offset:g-l,size:0};c=n.reduce((k,C)=>{var I,O={stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:y.offset+y.size+l,size:h?f:(I=C.barSize)!==null&&I!==void 0?I:0}},L=[...k,O];return y=O.position,L},u)}else{var v=dl(e,r,0,!0);r-2*v-(o-1)*l<=0&&(l=0);var w=(r-2*v-(o-1)*l)/o;w>1&&(w>>=0);var N=cs(s)?Math.min(w,s):w;c=n.reduce((k,C,I)=>[...k,{stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:v+(w+l)*I+(w-N)/2,size:N}}],u)}return c}}var uet=(t,e,r,n,s,a,o)=>{var l=xo(o)?e:o,c=cet(r,n,s!==a?s:a,t,l);return s!==a&&c!=null&&(c=c.map(u=>QN(QN({},u),{},{position:QN(QN({},u.position),{},{offset:u.position.offset-s/2})}))),c},det=(t,e)=>{var r=FR(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var s=t[n];if(s){var{stackedData:a}=s;if(a)return a.find(o=>o.key===r)}}}},het=(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}};function fet(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&cs(t.zIndex)?t.zIndex:e}var yde=t=>{var{chartData:e}=t,r=Zs(),n=$c();return b.useEffect(()=>n?()=>{}:(r(cY(e)),()=>{r(cY(void 0))}),[e,r,n]),null},nX={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},bde=fc({name:"brush",initialState:nX,reducers:{setBrushSettings(t,e){return e.payload==null?nX:e.payload}}}),{setBrushSettings:Tdt}=bde.actions,pet=bde.reducer;function met(t){return(t%180+180)%180}var get=function(e){var{width:r,height:n}=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=met(s),o=a*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},xet={dots:[],areas:[],lines:[]},vde=fc({name:"referenceElements",initialState:xet,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=cd(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=cd(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=cd(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:Idt,removeDot:Pdt,addArea:Ldt,removeArea:Odt,addLine:Mdt,removeLine:Rdt}=vde.actions,yet=vde.reducer,bet=b.createContext(void 0),vet=t=>{var{children:e}=t,[r]=b.useState("".concat(C2("recharts"),"-clip")),n=xde();if(n==null)return null;var{x:s,y:a,width:o,height:l}=n;return b.createElement(bet.Provider,{value:r},b.createElement("defs",null,b.createElement("clipPath",{id:r},b.createElement("rect",{x:s,y:a,height:l,width:o}))),e)};function wde(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var s=t[n];s!==void 0&&r.push(s)}return r}function wet(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return get(n,r)}function Net(t,e,r){var n=r==="width",{x:s,y:a,width:o,height:l}=t;return e===1?{start:n?s:a,end:n?s+o:a+l}:{start:n?s+o:a+l,end:n?s:a}}function U2(t,e,r,n,s){if(t*e<t*n||t*e>t*s)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-s)<=0}function jet(t,e){return wde(t,e+1)}function ket(t,e,r,n,s){for(var a=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,h=o,f=function(){var y=n?.[c];if(y===void 0)return{v:wde(n,u)};var v=c,w,N=()=>(w===void 0&&(w=r(y,v)),w),k=y.coordinate,C=c===0||U2(t,k,N,h,l);C||(c=0,h=o,u+=1),C&&(h=k+t*(N()/2+s),c+=u)},m;u<=a.length;)if(m=f(),m)return m.v;return[]}function _et(t,e,r,n,s){var a=(n||[]).slice(),o=a.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var h=(o-1)%u,f=l,m=!0,g=function(){var I=n[v];if(I==null)return 0;var O=v,L,_=()=>(L===void 0&&(L=r(I,O)),L),E=I.coordinate,M=v===h||U2(t,E,_,f,c);if(!M)return m=!1,1;M&&(f=E+t*(_()/2+s))},y,v=h;v<o&&(y=g(),!(y!==0&&y===1));v+=u);if(m){for(var w=[],N=h;N<o;N+=u){var k=n[N];k!=null&&w.push(k)}return w}}return[]}function sX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function il(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sX(Object(r),!0).forEach(function(n){Cet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cet(t,e,r){return(e=Eet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eet(t){var e=Aet(t,"string");return typeof e=="symbol"?e:e+""}function Aet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tet(t,e,r,n,s){for(var a=(n||[]).slice(),o=a.length,{start:l}=e,{end:c}=e,u=function(m){var g=a[m];if(g==null)return 1;var y=g,v,w=()=>(v===void 0&&(v=r(g,m)),v);if(m===o-1){var N=t*(y.coordinate+t*w()/2-c);a[m]=y=il(il({},y),{},{tickCoord:N>0?y.coordinate-N*t:y.coordinate})}else a[m]=y=il(il({},y),{},{tickCoord:y.coordinate});if(y.tickCoord!=null){var k=U2(t,y.tickCoord,w,l,c);k&&(c=y.tickCoord-t*(w()/2+s),a[m]=il(il({},y),{},{isShow:!0}))}},h=o-1;h>=0;h--)u(h);return a}function Iet(t,e,r,n,s,a){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(a){var h=n[l-1];if(h!=null){var f=r(h,l-1),m=t*(h.coordinate+t*f/2-u);if(o[l-1]=h=il(il({},h),{},{tickCoord:m>0?h.coordinate-m*t:h.coordinate}),h.tickCoord!=null){var g=U2(t,h.tickCoord,()=>f,c,u);g&&(u=h.tickCoord-t*(f/2+s),o[l-1]=il(il({},h),{},{isShow:!0}))}}}for(var y=a?l-1:l,v=function(k){var C=o[k];if(C==null)return 1;var I=C,O,L=()=>(O===void 0&&(O=r(C,k)),O);if(k===0){var _=t*(I.coordinate-t*L()/2-c);o[k]=I=il(il({},I),{},{tickCoord:_<0?I.coordinate-_*t:I.coordinate})}else o[k]=I=il(il({},I),{},{tickCoord:I.coordinate});if(I.tickCoord!=null){var E=U2(t,I.tickCoord,L,c,u);E&&(c=I.tickCoord+t*(L()/2+s),o[k]=il(il({},I),{},{isShow:!0}))}},w=0;w<y;w++)v(w);return o}function Pet(t,e,r){var{tick:n,ticks:s,viewBox:a,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:h,angle:f}=t;if(!s||!s.length||!n)return[];if(Mr(c)||qS.isSsr){var m;return(m=jet(s,Mr(c)?c:0))!==null&&m!==void 0?m:[]}var g=[],y=l==="top"||l==="bottom"?"width":"height",v=h&&y==="width"?B1(h,{fontSize:e,letterSpacing:r}):{width:0,height:0},w=(O,L)=>{var _=typeof u=="function"?u(O.value,L):O.value;return y==="width"?wet(B1(_,{fontSize:e,letterSpacing:r}),v,f):B1(_,{fontSize:e,letterSpacing:r})[y]},N=s[0],k=s[1],C=s.length>=2&&N!=null&&k!=null?Ho(k.coordinate-N.coordinate):1,I=Net(a,C,y);return c==="equidistantPreserveStart"?ket(C,I,w,s,o):c==="equidistantPreserveEnd"?_et(C,I,w,s,o):(c==="preserveStart"||c==="preserveStartEnd"?g=Iet(C,I,w,s,o,c==="preserveStartEnd"):g=Tet(C,I,w,s,o),g.filter(O=>O.isShow))}var Let=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=t,o=0;if(e){Array.from(e).forEach(h=>{if(h){var f=h.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=s+a,u=o+c+l+(r?n:0);return Math.round(u)}return 0},Oet=["axisLine","width","height","className","hide","ticks","axisType"];function Met(t,e){if(t==null)return{};var r,n,s=Ret(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Ret(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function pg(){return pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pg.apply(null,arguments)}function iX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Qi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iX(Object(r),!0).forEach(function(n){Det(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Det(t,e,r){return(e=Bet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bet(t){var e=Fet(t,"string");return typeof e=="symbol"?e:e+""}function Fet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rm={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:cl.axis};function $et(t){var{x:e,y:r,width:n,height:s,orientation:a,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=Qi(Qi(Qi({},c),ph(l)),{},{fill:"none"});if(a==="top"||a==="bottom"){var h=+(a==="top"&&!o||a==="bottom"&&o);u=Qi(Qi({},u),{},{x1:e,y1:r+h*s,x2:e+n,y2:r+h*s})}else{var f=+(a==="left"&&!o||a==="right"&&o);u=Qi(Qi({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+s})}return b.createElement("line",pg({},u,{className:js("recharts-cartesian-axis-line",og(l,"className"))}))}function Uet(t,e,r,n,s,a,o,l,c){var u,h,f,m,g,y,v=l?-1:1,w=t.tickSize||o,N=Mr(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":u=h=t.coordinate,m=r+ +!l*s,f=m-v*w,y=f-v*c,g=N;break;case"left":f=m=t.coordinate,h=e+ +!l*n,u=h-v*w,g=u-v*c,y=N;break;case"right":f=m=t.coordinate,h=e+ +l*n,u=h+v*w,g=u+v*c,y=N;break;default:u=h=t.coordinate,m=r+ +l*s,f=m+v*w,y=f+v*c,g=N;break}return{line:{x1:u,y1:f,x2:h,y2:m},tick:{x:g,y}}}function zet(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function Vet(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function qet(t){var{option:e,tickProps:r,value:n}=t,s,a=js(r.className,"recharts-cartesian-axis-tick-value");if(b.isValidElement(e))s=b.cloneElement(e,Qi(Qi({},r),{},{className:a}));else if(typeof e=="function")s=e(Qi(Qi({},r),{},{className:a}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=js(o,ode(e))),s=b.createElement(d3,pg({},r,{className:o}),n)}return s}var Het=b.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:s,stroke:a,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:h,mirror:f,x:m,y:g,width:y,height:v,tickSize:w,tickMargin:N,fontSize:k,letterSpacing:C,getTicksConfig:I,events:O,axisType:L}=t,_=Pet(Qi(Qi({},I),{},{ticks:r}),k,C),E=zet(h,f),M=Vet(h,f),B=ph(I),S=S2(n),P={};typeof s=="object"&&(P=s);var R=Qi(Qi({},B),{},{fill:"none"},P),V=_.map(J=>Qi({entry:J},Uet(J,m,g,y,v,h,w,f,N))),ee=V.map(J=>{var{entry:Z,line:se}=J;return b.createElement(Tl,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Z.value,"-").concat(Z.coordinate,"-").concat(Z.tickCoord)},s&&b.createElement("line",pg({},R,se,{className:js("recharts-cartesian-axis-tick-line",og(s,"className"))})))}),G=V.map((J,Z)=>{var se,X,{entry:q,tick:U}=J,H=Qi(Qi(Qi(Qi({verticalAnchor:M},B),{},{textAnchor:E,stroke:"none",fill:a},U),{},{index:Z,payload:q,visibleTicksCount:_.length,tickFormatter:o,padding:c},u),{},{angle:(se=(X=u?.angle)!==null&&X!==void 0?X:B.angle)!==null&&se!==void 0?se:0}),re=Qi(Qi({},H),S);return b.createElement(Tl,pg({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},Sw(O,q,Z)),n&&b.createElement(qet,{option:n,tickProps:re,value:"".concat(typeof o=="function"?o(q.value,Z):q.value).concat(l||"")}))});return b.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(L,"-ticks")},G.length>0&&b.createElement(Sh,{zIndex:cl.label},b.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(L,"-tick-labels"),ref:e},G)),ee.length>0&&b.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(L,"-tick-lines")},ee))}),Wet=b.forwardRef((t,e)=>{var{axisLine:r,width:n,height:s,className:a,hide:o,ticks:l,axisType:c}=t,u=Met(t,Oet),[h,f]=b.useState(""),[m,g]=b.useState(""),y=b.useRef(null);b.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var w;return Let({ticks:y.current,label:(w=t.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var v=b.useCallback(w=>{if(w){var N=w.getElementsByClassName("recharts-cartesian-axis-tick-value");y.current=N;var k=N[0];if(k){var C=window.getComputedStyle(k),I=C.fontSize,O=C.letterSpacing;(I!==h||O!==m)&&(f(I),g(O))}}},[h,m]);return o||n!=null&&n<=0||s!=null&&s<=0?null:b.createElement(Sh,{zIndex:t.zIndex},b.createElement(Tl,{className:js("recharts-cartesian-axis",a)},b.createElement($et,{x:t.x,y:t.y,width:n,height:s,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:ph(t)}),b.createElement(Het,{ref:v,axisType:c,events:u,fontSize:h,getTicksConfig:t,height:t.height,letterSpacing:m,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),b.createElement(XQe,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},b.createElement(aJe,{label:t.label,labelRef:t.labelRef}),t.children)))}),_7=b.forwardRef((t,e)=>{var r=Go(t,Rm);return b.createElement(Wet,pg({},r,{ref:e}))});_7.displayName="CartesianAxis";var Get={},Nde=fc({name:"errorBars",initialState:Get,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:s}=e.payload;t[r]&&(t[r]=t[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:Ddt,replaceErrorBar:Bdt,removeErrorBar:Fdt}=Nde.actions,Ket=Nde.reducer,Yet=["children"];function Xet(t,e){if(t==null)return{};var r,n,s=Qet(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Qet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Jet={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Zet=b.createContext(Jet);function ett(t){var{children:e}=t,r=Xet(t,Yet);return b.createElement(Zet.Provider,{value:r},e)}function jde(t,e){var r,n,s=Ar(u=>Gf(u,t)),a=Ar(u=>Kf(u,e)),o=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:co.allowDataOverflow,l=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:uo.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function ttt(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,s=xde(),{needClipX:a,needClipY:o,needClip:l}=jde(e,r);if(!l||!s)return null;var{x:c,y:u,width:h,height:f}=s;return b.createElement("clipPath",{id:"clipPath-".concat(n)},b.createElement("rect",{x:a?c:c-h/2,y:o?u:u-f/2,width:a?h:h*2,height:o?f:f*2}))}function rtt(t){t()}function ntt(){let t=null,e=null;return{clear(){t=null,e=null},notify(){rtt(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=e={callback:r,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!n||t===null||(n=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var aX={notify(){},get:()=>[]};function stt(t,e){let r,n=aX,s=0,a=!1;function o(v){h();const w=n.subscribe(v);let N=!1;return()=>{N||(N=!0,w(),f())}}function l(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return a}function h(){s++,r||(r=t.subscribe(c),n=ntt())}function f(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=aX)}function m(){a||(a=!0,h())}function g(){a&&(a=!1,f())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>n};return y}var itt=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",att=itt(),ott=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ltt=ott(),ctt=()=>att||ltt?b.useLayoutEffect:b.useEffect,utt=ctt();function oX(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function dtt(t,e){if(oX(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(e,r[s])||!oX(t[r[s]],e[r[s]]))return!1;return!0}var htt=Symbol.for("react-redux-context"),ftt=typeof globalThis<"u"?globalThis:{};function ptt(){if(!b.createContext)return{};const t=ftt[htt]??=new Map;let e=t.get(b.createContext);return e||(e=b.createContext(null),t.set(b.createContext,e)),e}var mtt=ptt();function gtt(t){const{children:e,context:r,serverState:n,store:s}=t,a=b.useMemo(()=>{const c=stt(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),o=b.useMemo(()=>s.getState(),[s]);utt(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=r||mtt;return b.createElement(l.Provider,{value:a},e)}var xtt=gtt,ytt=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function btt(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function S7(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(ytt.has(n)){if(t[n]==null&&e[n]==null)continue;if(!dtt(t[n],e[n]))return!1}else if(!btt(t[n],e[n]))return!1;return!0}function Lg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(s=>s.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:mde}function Og(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(s=>s.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:mde}var vtt="Invariant failed";function wtt(t,e){throw new Error(vtt)}function OP(){return OP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},OP.apply(null,arguments)}function Hk(t){return b.createElement(ude,OP({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Ntt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,s)=>{if(Mr(e))return e;var a=Mr(n)||xo(n);return a?e(n,s):(a||wtt(),r)}},jtt=(t,e,r)=>r,ktt=(t,e)=>e,Vw=et([zR,ktt],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),_tt=et([Vw],t=>t?.maxBarSize),Stt=(t,e,r,n)=>n,Ctt=et([fs,zR,Lg,Og,jtt],(t,e,r,n,s)=>e.filter(a=>t==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===s).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),Ett=(t,e,r)=>{var n=fs(t),s=Lg(t,e),a=Og(t,e);if(!(s==null||a==null))return n==="horizontal"?EP(t,"yAxis",a,r):EP(t,"xAxis",s,r)},Att=(t,e)=>{var r=fs(t),n=Lg(t,e),s=Og(t,e);if(!(n==null||s==null))return r==="horizontal"?JK(t,"xAxis",n):JK(t,"yAxis",s)},Ttt=et([Ctt,KGe,Att],set),Itt=(t,e,r)=>{var n,s,a=Vw(t,e);if(a==null)return 0;var o=Lg(t,e),l=Og(t,e);if(o==null||l==null)return 0;var c=fs(t),u=Oce(t),{maxBarSize:h}=a,f=xo(h)?u:h,m,g;return c==="horizontal"?(m=rb(t,"xAxis",o,r),g=tb(t,"xAxis",o,r)):(m=rb(t,"yAxis",l,r),g=tb(t,"yAxis",l,r)),(n=(s=yk(m,g,!0))!==null&&s!==void 0?s:f)!==null&&n!==void 0?n:0},kde=(t,e,r)=>{var n=fs(t),s=Lg(t,e),a=Og(t,e);if(!(s==null||a==null)){var o,l;return n==="horizontal"?(o=rb(t,"xAxis",s,r),l=tb(t,"xAxis",s,r)):(o=rb(t,"yAxis",a,r),l=tb(t,"yAxis",a,r)),yk(o,l)}},Ptt=et([Ttt,Oce,GGe,Mce,Itt,kde,_tt],uet),Ltt=(t,e,r)=>{var n=Lg(t,e);if(n!=null)return rb(t,"xAxis",n,r)},Ott=(t,e,r)=>{var n=Og(t,e);if(n!=null)return rb(t,"yAxis",n,r)},Mtt=(t,e,r)=>{var n=Lg(t,e);if(n!=null)return tb(t,"xAxis",n,r)},Rtt=(t,e,r)=>{var n=Og(t,e);if(n!=null)return tb(t,"yAxis",n,r)},Dtt=et([Ptt,Vw],het),Btt=et([Ett,Vw],det),Ftt=et([Ja,rR,Ltt,Ott,Mtt,Rtt,Dtt,fs,FGe,kde,Btt,Vw,Stt],(t,e,r,n,s,a,o,l,c,u,h,f,m)=>{var{chartData:g,dataStartIndex:y,dataEndIndex:v}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||s==null||a==null||u==null)){var{data:w}=f,N;if(w!=null&&w.length>0?N=w:N=g?.slice(y,v+1),N!=null)return frt({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,stackedData:h,displayedData:N,offset:t,cells:m,dataStartIndex:y})}}),$tt=["index"];function MP(){return MP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MP.apply(null,arguments)}function Utt(t,e){if(t==null)return{};var r,n,s=ztt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function ztt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _de=b.createContext(void 0),Vtt=t=>{var e=b.useContext(_de);if(e!=null)return e.stackId;if(t!=null)return Pze(t)},qtt=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),Htt=t=>{var e=b.useContext(_de);if(e!=null){var{stackId:r}=e;return"url(#".concat(qtt(r,t),")")}},Sde=t=>{var{index:e}=t,r=Utt(t,$tt),n=Htt(e);return b.createElement(Tl,MP({className:"recharts-bar-stack-layer",clipPath:n},r))},Wtt=["onMouseEnter","onMouseLeave","onClick"],Gtt=["value","background","tooltipPosition"],Ktt=["id"],Ytt=["onMouseEnter","onClick","onMouseLeave"];function Lf(){return Lf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lf.apply(null,arguments)}function lX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function wl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lX(Object(r),!0).forEach(function(n){Xtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xtt(t,e,r){return(e=Qtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qtt(t){var e=Jtt(t,"string");return typeof e=="symbol"?e:e+""}function Jtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wk(t,e){if(t==null)return{};var r,n,s=Ztt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Ztt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var ert=t=>{var{dataKey:e,name:r,fill:n,legendType:s,hide:a}=t;return[{inactive:a,dataKey:e,type:s,color:n,value:MS(r,e),payload:t}]},trt=b.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:s,name:a,hide:o,unit:l,tooltipType:c,id:u}=t,h={dataDefinedOnItem:void 0,getPosition:wb,settings:{stroke:r,strokeWidth:n,fill:s,dataKey:e,nameKey:void 0,name:MS(a,e),hide:o,type:c,color:s,unit:l,graphicalItemId:u}};return b.createElement(dde,{tooltipEntrySettings:h})});function rrt(t){var e=Ar(fg),{data:r,dataKey:n,background:s,allOtherBarProps:a}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=a,u=Wk(a,Wtt),h=N7(o,n,a.id),f=j7(l),m=k7(c,n,a.id);if(!s||r==null)return null;var g=S2(s);return b.createElement(Sh,{zIndex:fet(s,cl.barBackground)},r.map((y,v)=>{var{value:w,background:N,tooltipPosition:k}=y,C=Wk(y,Gtt);if(!N)return null;var I=h(y,v),O=f(y,v),L=m(y,v),_=wl(wl(wl(wl(wl({option:s,isActive:String(v)===e},C),{},{fill:"#eee"},N),g),Sw(u,y,v)),{},{onMouseEnter:I,onMouseLeave:O,onClick:L,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return b.createElement(Hk,Lf({key:"background-bar-".concat(v)},_))}))}function nrt(t){var{showLabels:e,children:r,rects:n}=t,s=n?.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return wl(wl({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return b.createElement(xJe,{value:e?s:void 0},r)}function srt(t){var{shape:e,activeBar:r,baseProps:n,entry:s,index:a,dataKey:o}=t,l=Ar(fg),c=Ar(f7),u=r&&String(a)===l&&(c==null||o===c),h=u?r:e;return u?b.createElement(Sh,{zIndex:cl.activeBar},b.createElement(Sde,{index:a},b.createElement(Hk,Lf({},n,{name:String(n.name)},s,{isActive:u,option:h,index:a,dataKey:o})))):b.createElement(Hk,Lf({},n,{name:String(n.name)},s,{isActive:u,option:h,index:a,dataKey:o}))}function irt(t){var{shape:e,baseProps:r,entry:n,index:s,dataKey:a}=t;return b.createElement(Hk,Lf({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:s,dataKey:a}))}function art(t){var e,{data:r,props:n}=t,s=(e=ph(n))!==null&&e!==void 0?e:{},{id:a}=s,o=Wk(s,Ktt),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:h,onClick:f,onMouseLeave:m}=n,g=Wk(n,Ytt),y=N7(h,c,a),v=j7(m),w=k7(f,c,a);return r?b.createElement(b.Fragment,null,r.map((N,k)=>b.createElement(Sde,Lf({index:k,key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(k),className:"recharts-bar-rectangle"},Sw(g,N,k),{onMouseEnter:y(N,k),onMouseLeave:v(N,k),onClick:w(N,k)}),u?b.createElement(srt,{shape:l,activeBar:u,baseProps:o,entry:N,index:k,dataKey:c}):b.createElement(irt,{shape:l,baseProps:o,entry:N,index:k,dataKey:c})))):null}function ort(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:s,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:h}=e,f=r.current,m=WS(e,"recharts-bar-"),[g,y]=b.useState(!1),v=!g,w=b.useCallback(()=>{typeof u=="function"&&u(),y(!1)},[u]),N=b.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return b.createElement(nrt,{showLabels:v,rects:n},b.createElement(HS,{animationId:m,begin:o,duration:l,isActive:a,easing:c,onAnimationEnd:w,onAnimationStart:N,key:m},k=>{var C=k===1?n:n?.map((I,O)=>{var L=f&&f[O];if(L)return wl(wl({},I),{},{x:Va(L.x,I.x,k),y:Va(L.y,I.y,k),width:Va(L.width,I.width,k),height:Va(L.height,I.height,k)});if(s==="horizontal"){var _=Va(0,I.height,k),E=Va(I.stackedBarStart,I.y,k);return wl(wl({},I),{},{y:E,height:_})}var M=Va(0,I.width,k),B=Va(I.stackedBarStart,I.x,k);return wl(wl({},I),{},{width:M,x:B})});return k>0&&(r.current=C??null),C==null?null:b.createElement(Tl,null,b.createElement(art,{props:e,data:C}))}),b.createElement(nde,{label:e.label}),e.children)}function lrt(t){var e=b.useRef(null);return b.createElement(ort,{previousRectanglesRef:e,props:t})}var Cde=0,crt=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ui(t,e)}};class urt extends b.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:s,xAxisId:a,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var h=js("recharts-bar",s),f=u;return b.createElement(Tl,{className:h,id:u},l&&b.createElement("defs",null,b.createElement(ttt,{clipPathId:f,xAxisId:a,yAxisId:o})),b.createElement(Tl,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},b.createElement(rrt,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),b.createElement(lrt,this.props)))}}var drt={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Cde,xAxisId:0,yAxisId:0,zIndex:cl.bar};function hrt(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:s,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h}=t,{needClip:f}=jde(e,r),m=Nb(),g=$c(),y=w7(t.children,nb),v=Ar(k=>Ftt(k,t.id,g,y));if(m!=="vertical"&&m!=="horizontal")return null;var w,N=v?.[0];return N==null||N.height==null||N.width==null?w=0:w=m==="vertical"?N.height/2:N.width/2,b.createElement(ett,{xAxisId:e,yAxisId:r,data:v,dataPointFormatter:crt,errorBarOffset:w},b.createElement(urt,Lf({},t,{layout:m,needClip:f,data:v,xAxisId:e,yAxisId:r,hide:n,legendType:s,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h})))}function frt(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:s,bandSize:a,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:h,displayedData:f,offset:m,cells:g,parentViewBox:y,dataStartIndex:v}=t,w=e==="horizontal"?l:o,N=h?w.scale.domain():null,k=Lze({numericAxis:w}),C=w.scale.map(k);return f.map((I,O)=>{var L,_,E,M,B,S;if(h){var P=h[O+v];if(P==null)return null;L=Cze(P,N)}else L=ui(I,r),Array.isArray(L)||(L=[k,L]);var R=Ntt(n,Cde)(L[1],O);if(e==="horizontal"){var V,ee=l.scale.map(L[0]),G=l.scale.map(L[1]);if(ee==null||G==null)return null;_=YW({axis:o,ticks:c,bandSize:a,offset:s.offset,entry:I,index:O}),E=(V=G??ee)!==null&&V!==void 0?V:void 0,M=s.size;var J=ee-G;if(B=mh(J)?0:J,S={x:_,y:m.top,width:M,height:m.height},Math.abs(R)>0&&Math.abs(B)<Math.abs(R)){var Z=Ho(B||R)*(Math.abs(R)-Math.abs(B));E-=Z,B+=Z}}else{var se=o.scale.map(L[0]),X=o.scale.map(L[1]);if(se==null||X==null)return null;if(_=se,E=YW({axis:l,ticks:u,bandSize:a,offset:s.offset,entry:I,index:O}),M=X-se,B=s.size,S={x:m.left,y:E,width:m.width,height:B},Math.abs(R)>0&&Math.abs(M)<Math.abs(R)){var q=Ho(M||R)*(Math.abs(R)-Math.abs(M));M+=q}}if(_==null||E==null||M==null||B==null)return null;var U=wl(wl({},I),{},{stackedBarStart:C,x:_,y:E,width:M,height:B,value:h?L:L[1],payload:I,background:S,tooltipPosition:{x:_+M/2,y:E+B/2},parentViewBox:y},g&&g[O]&&g[O].props);return U}).filter(Boolean)}function prt(t){var e=Go(t,drt),r=Vtt(e.stackId),n=$c();return b.createElement(hde,{id:e.id,type:"bar"},s=>b.createElement(b.Fragment,null,b.createElement(sZe,{legendPayload:ert(e)}),b.createElement(trt,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:s}),b.createElement(yZe,{type:"bar",id:s,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),b.createElement(Sh,{zIndex:e.zIndex},b.createElement(hrt,Lf({},e,{id:s})))))}var Ede=b.memo(prt,S7);Ede.displayName="Bar";var mrt=["domain","range"],grt=["domain","range"];function cX(t,e){if(t==null)return{};var r,n,s=xrt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function xrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function uX(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function Ade(t,e){if(t===e)return!0;var{domain:r,range:n}=t,s=cX(t,mrt),{domain:a,range:o}=e,l=cX(e,grt);return!uX(r,a)||!uX(n,o)?!1:S7(s,l)}var yrt=["type"],brt=["dangerouslySetInnerHTML","ticks","scale"],vrt=["id","scale"];function RP(){return RP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},RP.apply(null,arguments)}function dX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function hX(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dX(Object(r),!0).forEach(function(n){wrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wrt(t,e,r){return(e=Nrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nrt(t){var e=jrt(t,"string");return typeof e=="symbol"?e:e+""}function jrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DP(t,e){if(t==null)return{};var r,n,s=krt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function krt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _rt(t){var e=Zs(),r=b.useRef(null),n=ble(),{type:s}=t,a=DP(t,yrt),o=t3(n,"xAxis",s),l=b.useMemo(()=>{if(o!=null)return hX(hX({},a),{},{type:o})},[a,o]);return b.useLayoutEffect(()=>{l!=null&&(r.current===null?e(KZe(l)):r.current!==l&&e(YZe({prev:r.current,next:l})),r.current=l)},[l,e]),b.useLayoutEffect(()=>()=>{r.current&&(e(XZe(r.current)),r.current=null)},[e]),null}var Srt=t=>{var{xAxisId:e,className:r}=t,n=Ar(rR),s=$c(),a="xAxis",o=Ar(N=>pue(N,a,e,s)),l=Ar(N=>uue(N,e)),c=Ar(N=>KKe(N,e)),u=Ar(N=>Hce(N,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:h,ticks:f,scale:m}=t,g=DP(t,brt),{id:y,scale:v}=u,w=DP(u,vrt);return b.createElement(_7,RP({},g,w,{x:c.x,y:c.y,width:l.width,height:l.height,className:js("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o,axisType:a}))},Crt={allowDataOverflow:co.allowDataOverflow,allowDecimals:co.allowDecimals,allowDuplicatedCategory:co.allowDuplicatedCategory,angle:co.angle,axisLine:Rm.axisLine,height:co.height,hide:!1,includeHidden:co.includeHidden,interval:co.interval,label:!1,minTickGap:co.minTickGap,mirror:co.mirror,orientation:co.orientation,padding:co.padding,reversed:co.reversed,scale:co.scale,tick:co.tick,tickCount:co.tickCount,tickLine:Rm.tickLine,tickSize:Rm.tickSize,type:co.type,xAxisId:0},Ert=t=>{var e=Go(t,Crt);return b.createElement(b.Fragment,null,b.createElement(_rt,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),b.createElement(Srt,e))},Tde=b.memo(Ert,Ade);Tde.displayName="XAxis";var Art=["type"],Trt=["dangerouslySetInnerHTML","ticks","scale"],Irt=["id","scale"];function BP(){return BP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BP.apply(null,arguments)}function fX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function pX(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fX(Object(r),!0).forEach(function(n){Prt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Prt(t,e,r){return(e=Lrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lrt(t){var e=Ort(t,"string");return typeof e=="symbol"?e:e+""}function Ort(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FP(t,e){if(t==null)return{};var r,n,s=Mrt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Mrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Rrt(t){var e=Zs(),r=b.useRef(null),n=ble(),{type:s}=t,a=FP(t,Art),o=t3(n,"yAxis",s),l=b.useMemo(()=>{if(o!=null)return pX(pX({},a),{},{type:o})},[o,a]);return b.useLayoutEffect(()=>{l!=null&&(r.current===null?e(QZe(l)):r.current!==l&&e(JZe({prev:r.current,next:l})),r.current=l)},[l,e]),b.useLayoutEffect(()=>()=>{r.current&&(e(ZZe(r.current)),r.current=null)},[e]),null}function Drt(t){var{yAxisId:e,className:r,width:n,label:s}=t,a=b.useRef(null),o=b.useRef(null),l=Ar(rR),c=$c(),u=Zs(),h="yAxis",f=Ar(L=>due(L,e)),m=Ar(L=>XKe(L,e)),g=Ar(L=>pue(L,h,e,c)),y=Ar(L=>Wce(L,e));if(b.useLayoutEffect(()=>{if(!(n!=="auto"||!f||y7(s)||b.isValidElement(s)||y==null)){var L=a.current;if(L){var _=L.getCalculatedWidth();Math.round(f.width)!==Math.round(_)&&u(eet({id:e,width:_}))}}},[g,f,u,s,e,n,y]),f==null||m==null||y==null)return null;var{dangerouslySetInnerHTML:v,ticks:w,scale:N}=t,k=FP(t,Trt),{id:C,scale:I}=y,O=FP(y,Irt);return b.createElement(_7,BP({},k,O,{ref:a,labelRef:o,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:js("recharts-".concat(h," ").concat(h),r),viewBox:l,ticks:g,axisType:h}))}var Brt={allowDataOverflow:uo.allowDataOverflow,allowDecimals:uo.allowDecimals,allowDuplicatedCategory:uo.allowDuplicatedCategory,angle:uo.angle,axisLine:Rm.axisLine,hide:!1,includeHidden:uo.includeHidden,interval:uo.interval,label:!1,minTickGap:uo.minTickGap,mirror:uo.mirror,orientation:uo.orientation,padding:uo.padding,reversed:uo.reversed,scale:uo.scale,tick:uo.tick,tickCount:uo.tickCount,tickLine:Rm.tickLine,tickSize:Rm.tickSize,type:uo.type,width:uo.width,yAxisId:0},Frt=t=>{var e=Go(t,Brt);return b.createElement(b.Fragment,null,b.createElement(Rrt,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),b.createElement(Drt,e))},Ide=b.memo(Frt,Ade);Ide.displayName="YAxis";var $rt=(t,e)=>e,C7=et([$rt,fs,zce,wo,Iue,Yf,dXe,Ja],yXe),E7=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Pde=ju("mouseClick"),Lde=Ew();Lde.startListening({actionCreator:Pde,effect:(t,e)=>{var r=t.payload,n=C7(e.getState(),E7(r));n?.activeIndex!=null&&e.dispatch(uYe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var $P=ju("mouseMove"),Ode=Ew(),JN=null;Ode.startListening({actionCreator:$P,effect:(t,e)=>{var r=t.payload;JN!==null&&cancelAnimationFrame(JN);var n=E7(r);JN=requestAnimationFrame(()=>{var s=e.getState(),a=o7(s,s.tooltip.settings.shared);if(a==="axis"){var o=C7(s,n);o?.activeIndex!=null?e.dispatch(Nue({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(wue())}JN=null})}});function Urt(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var mX={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Mde=fc({name:"rootProps",initialState:mX,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:mX.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),zrt=Mde.reducer,{updateOptions:Vrt}=Mde.actions,qrt=null,Hrt={updatePolarOptions:(t,e)=>e.payload},Rde=fc({name:"polarOptions",initialState:qrt,reducers:Hrt}),{updatePolarOptions:Wrt}=Rde.actions,Grt=Rde.reducer,Dde=ju("keyDown"),Bde=ju("focus"),A7=Ew();A7.startListening({actionCreator:Dde,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var o=l7(s,Ib(r),Fw(r),Uw(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=Yf(r);if(a==="Enter"){var u=Uk(r,"axis","hover",String(s.index));e.dispatch(TP({active:!s.active,activeIndex:s.index,activeCoordinate:u}));return}var h=eYe(r),f=h==="left-to-right"?1:-1,m=a==="ArrowRight"?1:-1,g=l+m*f;if(!(c==null||g>=c.length||g<0)){var y=Uk(r,"axis","hover",String(g));e.dispatch(TP({active:!0,activeIndex:g.toString(),activeCoordinate:y}))}}}}}});A7.startListening({actionCreator:Bde,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",o=Uk(r,"axis","hover",String(a));e.dispatch(TP({active:!0,activeIndex:a,activeCoordinate:o}))}}}});var nu=ju("externalEvent"),Fde=Ew(),mT=new Map;Fde.startListening({actionCreator:nu,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var s=n.type,a=mT.get(s);a!==void 0&&cancelAnimationFrame(a);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:XYe(l),activeDataKey:f7(l),activeIndex:fg(l),activeLabel:Oue(l),activeTooltipIndex:fg(l),isTooltipActive:QYe(l)};r(c,n)}finally{mT.delete(s)}});mT.set(s,o)}}});var Krt=et([Ab],t=>t.tooltipItemPayloads),Yrt=et([Krt,(t,e)=>e,(t,e,r)=>r],(t,e,r)=>{if(e!=null){var n=t.find(a=>a.settings.graphicalItemId===r);if(n!=null){var{getPosition:s}=n;if(s!=null)return s(e)}}}),$de=ju("touchMove"),Ude=Ew();Ude.startListening({actionCreator:$de,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),s=o7(n,n.tooltip.settings.shared);if(s==="axis"){var a=r.touches[0];if(a==null)return;var o=C7(n,E7({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));o?.activeIndex!=null&&e.dispatch(Nue({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(s==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var h=u.getAttribute(hle),f=(l=u.getAttribute(fle))!==null&&l!==void 0?l:void 0,m=Tb(n).find(v=>v.id===f);if(h==null||m==null||f==null)return;var{dataKey:g}=m,y=Yrt(n,h,f);e.dispatch(vue({activeDataKey:g,activeIndex:h,activeCoordinate:y,activeGraphicalItemId:f}))}}}});var Xrt=Roe({brush:pet,cartesianAxis:tet,chartData:WXe,errorBars:Ket,graphicalItems:gZe,layout:Nze,legend:TVe,options:UXe,polarAxis:AJe,polarOptions:Grt,referenceElements:yet,rootProps:zrt,tooltip:dYe,zIndex:PXe}),Qrt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return GUe({reducer:Xrt,preloadedState:e,middleware:n=>{var s;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((s="es6")!==null&&s!==void 0?s:"")}).concat([Lde.middleware,Ode.middleware,A7.middleware,Fde.middleware,Ude.middleware])},enhancers:n=>{var s=n;return typeof n=="function"&&(s=n()),s.concat(Qoe({type:"raf"}))},devTools:{serialize:{replacer:Urt},name:"recharts-".concat(r)}})};function zde(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,s=$c(),a=b.useRef(null);if(s)return r;a.current==null&&(a.current=Qrt(e,n));var o=YM;return b.createElement(xtt,{context:o,store:a.current},r)}function Jrt(t){var{layout:e,margin:r}=t,n=Zs(),s=$c();return b.useEffect(()=>{s||(n(bze(e)),n(yze(r)))},[n,s,e,r]),null}var Vde=b.memo(Jrt,S7);function qde(t){var e=Zs();return b.useEffect(()=>{e(Vrt(t))},[e,t]),null}function gX(t){var{zIndex:e,isPanorama:r}=t,n=b.useRef(null),s=Zs();return b.useLayoutEffect(()=>(n.current&&s(TXe({zIndex:e,element:n.current,isPanorama:r})),()=>{s(IXe({zIndex:e,isPanorama:r}))}),[s,e,r]),b.createElement("g",{tabIndex:-1,ref:n})}function xX(t){var{children:e,isPanorama:r}=t,n=Ar(vXe);if(!n||n.length===0)return e;var s=n.filter(o=>o<0),a=n.filter(o=>o>0);return b.createElement(b.Fragment,null,s.map(o=>b.createElement(gX,{key:o,zIndex:o,isPanorama:r})),e,a.map(o=>b.createElement(gX,{key:o,zIndex:o,isPanorama:r})))}var Zrt=["children"];function ent(t,e){if(t==null)return{};var r,n,s=tnt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function tnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Gk(){return Gk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gk.apply(null,arguments)}var rnt={width:"100%",height:"100%",display:"block"},nnt=b.forwardRef((t,e)=>{var r=xle(),n=yle(),s=Ple();if(!gp(r)||!gp(n))return null;var{children:a,otherAttributes:o,title:l,desc:c}=t,u,h;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=s?0:void 0,typeof o.role=="string"?h=o.role:h=s?"application":void 0),b.createElement(FM,Gk({},o,{title:l,desc:c,role:h,tabIndex:u,width:r,height:n,style:rnt,ref:e}),a)}),snt=t=>{var{children:e}=t,r=Ar(FS);if(!r)return null;var{width:n,height:s,y:a,x:o}=r;return b.createElement(FM,{width:n,height:s,x:o,y:a},e)},yX=b.forwardRef((t,e)=>{var{children:r}=t,n=ent(t,Zrt),s=$c();return s?b.createElement(snt,null,b.createElement(xX,{isPanorama:!0},r)):b.createElement(nnt,Gk({ref:e},n),b.createElement(xX,{isPanorama:!1},r))});function int(){var t=Zs(),[e,r]=b.useState(null),n=Ar(Fze);return b.useEffect(()=>{if(e!=null){var s=e.getBoundingClientRect(),a=s.width/e.offsetWidth;cs(a)&&a!==n&&t(wze(a))}},[e,t,n]),r}function bX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function ant(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bX(Object(r),!0).forEach(function(n){ont(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ont(t,e,r){return(e=lnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lnt(t){var e=cnt(t,"string");return typeof e=="symbol"?e:e+""}function cnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function op(){return op=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},op.apply(null,arguments)}var unt=()=>(tQe(),null);function Kk(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var dnt=b.forwardRef((t,e)=>{var r,n,s=b.useRef(null),[a,o]=b.useState({containerWidth:Kk((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:Kk((n=t.style)===null||n===void 0?void 0:n.height)}),l=b.useCallback((u,h)=>{o(f=>{var m=Math.round(u),g=Math.round(h);return f.containerWidth===m&&f.containerHeight===g?f:{containerWidth:m,containerHeight:g}})},[]),c=b.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:h,height:f}=u.getBoundingClientRect();l(h,f);var m=y=>{var v=y[0];if(v!=null){var{width:w,height:N}=v.contentRect;l(w,N)}},g=new ResizeObserver(m);g.observe(u),s.current=g}},[e,l]);return b.useEffect(()=>()=>{var u=s.current;u?.disconnect()},[l]),b.createElement(b.Fragment,null,b.createElement(Tw,{width:a.containerWidth,height:a.containerHeight}),b.createElement("div",op({ref:c},t)))}),hnt=b.forwardRef((t,e)=>{var{width:r,height:n}=t,[s,a]=b.useState({containerWidth:Kk(r),containerHeight:Kk(n)}),o=b.useCallback((c,u)=>{a(h=>{var f=Math.round(c),m=Math.round(u);return h.containerWidth===f&&h.containerHeight===m?h:{containerWidth:f,containerHeight:m}})},[]),l=b.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:h}=c.getBoundingClientRect();o(u,h)}},[e,o]);return b.createElement(b.Fragment,null,b.createElement(Tw,{width:s.containerWidth,height:s.containerHeight}),b.createElement("div",op({ref:l},t)))}),fnt=b.forwardRef((t,e)=>{var{width:r,height:n}=t;return b.createElement(b.Fragment,null,b.createElement(Tw,{width:r,height:n}),b.createElement("div",op({ref:e},t)))}),pnt=b.forwardRef((t,e)=>{var{width:r,height:n}=t;return typeof r=="string"||typeof n=="string"?b.createElement(hnt,op({},t,{ref:e})):typeof r=="number"&&typeof n=="number"?b.createElement(fnt,op({},t,{width:r,height:n,ref:e})):b.createElement(b.Fragment,null,b.createElement(Tw,{width:r,height:n}),b.createElement("div",op({ref:e},t)))});function mnt(t){return t?dnt:pnt}var gnt=b.forwardRef((t,e)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:h,onMouseMove:f,onMouseUp:m,onTouchEnd:g,onTouchMove:y,onTouchStart:v,style:w,width:N,responsive:k,dispatchTouchEvents:C=!0}=t,I=b.useRef(null),O=Zs(),[L,_]=b.useState(null),[E,M]=b.useState(null),B=int(),S=nR(),P=S?.width>0?S.width:N,R=S?.height>0?S.height:s,V=b.useCallback(K=>{B(K),typeof e=="function"&&e(K),_(K),M(K),K!=null&&(I.current=K)},[B,e,_,M]),ee=b.useCallback(K=>{O(Pde(K)),O(nu({handler:a,reactEvent:K}))},[O,a]),G=b.useCallback(K=>{O($P(K)),O(nu({handler:u,reactEvent:K}))},[O,u]),J=b.useCallback(K=>{O(wue()),O(nu({handler:h,reactEvent:K}))},[O,h]),Z=b.useCallback(K=>{O($P(K)),O(nu({handler:f,reactEvent:K}))},[O,f]),se=b.useCallback(()=>{O(Bde())},[O]),X=b.useCallback(K=>{O(Dde(K.key))},[O]),q=b.useCallback(K=>{O(nu({handler:o,reactEvent:K}))},[O,o]),U=b.useCallback(K=>{O(nu({handler:l,reactEvent:K}))},[O,l]),H=b.useCallback(K=>{O(nu({handler:c,reactEvent:K}))},[O,c]),re=b.useCallback(K=>{O(nu({handler:m,reactEvent:K}))},[O,m]),ae=b.useCallback(K=>{O(nu({handler:v,reactEvent:K}))},[O,v]),xe=b.useCallback(K=>{C&&O($de(K)),O(nu({handler:y,reactEvent:K}))},[O,C,y]),Ne=b.useCallback(K=>{O(nu({handler:g,reactEvent:K}))},[O,g]),pe=mnt(k);return b.createElement(Uue.Provider,{value:L},b.createElement(eoe.Provider,{value:E},b.createElement(pe,{width:P??w?.width,height:R??w?.height,className:js("recharts-wrapper",n),style:ant({position:"relative",cursor:"default",width:P,height:R},w),onClick:ee,onContextMenu:q,onDoubleClick:U,onFocus:se,onKeyDown:X,onMouseDown:H,onMouseEnter:G,onMouseLeave:J,onMouseMove:Z,onMouseUp:re,onTouchEnd:Ne,onTouchMove:xe,onTouchStart:ae,ref:V},b.createElement(unt,null),r)))}),xnt=["width","height","responsive","children","className","style","compact","title","desc"];function ynt(t,e){if(t==null)return{};var r,n,s=bnt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function bnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Hde=b.forwardRef((t,e)=>{var{width:r,height:n,responsive:s,children:a,className:o,style:l,compact:c,title:u,desc:h}=t,f=ynt(t,xnt),m=ph(f);return c?b.createElement(b.Fragment,null,b.createElement(Tw,{width:r,height:n}),b.createElement(yX,{otherAttributes:m,title:u,desc:h},a)):b.createElement(gnt,{className:o,style:l,width:r,height:n,responsive:s??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},b.createElement(yX,{otherAttributes:m,title:u,desc:h,ref:e},b.createElement(vet,null,a)))});function UP(){return UP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},UP.apply(null,arguments)}var vnt={top:5,right:5,bottom:5,left:5},wnt={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:vnt,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Nnt=b.forwardRef(function(e,r){var n,s=Go(e.categoricalChartProps,wnt),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,h={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return b.createElement(zde,{preloadedState:{options:h},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:a},b.createElement(yde,{chartData:u.data}),b.createElement(Vde,{layout:s.layout,margin:s.margin}),b.createElement(qde,{baseValue:s.baseValue,accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className,reverseStackOrder:s.reverseStackOrder}),b.createElement(Hde,UP({},s,{ref:r})))}),jnt=["axis","item"],knt=b.forwardRef((t,e)=>b.createElement(Nnt,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:jnt,tooltipPayloadSearcher:zue,categoricalChartProps:t,ref:e}));function _nt(t){var e=Zs();return b.useEffect(()=>{e(Wrt(t))},[e,t]),null}var Snt=["layout"];function zP(){return zP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zP.apply(null,arguments)}function Cnt(t,e){if(t==null)return{};var r,n,s=Ent(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Ent(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Ant={top:5,right:5,bottom:5,left:5},Wde={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Ant,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Tnt=b.forwardRef(function(e,r){var n,s=Go(e.categoricalChartProps,Wde),{layout:a}=s,o=Cnt(s,Snt),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return b.createElement(zde,{preloadedState:{options:f},reduxStoreName:(n=s.id)!==null&&n!==void 0?n:l},b.createElement(yde,{chartData:s.data}),b.createElement(Vde,{layout:a,margin:s.margin}),b.createElement(qde,{baseValue:void 0,accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className,reverseStackOrder:s.reverseStackOrder}),b.createElement(_nt,{cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius}),b.createElement(Hde,zP({},o,{ref:r})))});function vX(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function wX(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vX(Object(r),!0).forEach(function(n){Int(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vX(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Int(t,e,r){return(e=Pnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pnt(t){var e=Lnt(t,"string");return typeof e=="symbol"?e:e+""}function Lnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ont=["item"],Mnt=wX(wX({},Wde),{},{layout:"centric",startAngle:0,endAngle:360}),Rnt=b.forwardRef((t,e)=>{var r=Go(t,Mnt);return b.createElement(Tnt,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Ont,tooltipPayloadSearcher:zue,categoricalChartProps:r,ref:e})});const Yk=({cards:t=[],type:e="all"})=>{const r=b.useMemo(()=>{const l={0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0};return t.forEach(c=>{const u=c.data||c,h=(u.type_line||"").toLowerCase();if(h.includes("land")&&!h.includes("creature")&&!h.includes("artifact"))return;const f=u.cmc??u.manavalue??0;f>=7?l["7+"]++:l[Math.floor(f)]++}),Object.entries(l).map(([c,u])=>({label:c,value:u}))},[t]),n=b.useMemo(()=>{const l={};return t.forEach(c=>{const h=(c.data||c).type_line||"";["Creature","Instant","Sorcery","Artifact","Enchantment","Planeswalker","Land","Battle"].forEach(m=>{h.includes(m)&&(l[m]=(l[m]||0)+1)})}),Object.entries(l).map(([c,u])=>({name:c,value:u}))},[t]),s=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c","#d0ed57","#8dd1e1"],a=()=>i.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[e==="all"&&i.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Mana Curve"}),i.jsx(oG,{width:"100%",height:"100%",children:i.jsxs(knt,{data:r,children:[i.jsx(Tde,{dataKey:"label",stroke:"#9ca3af",tick:{fontSize:12}}),i.jsx(Ide,{stroke:"#9ca3af",allowDecimals:!1,tick:{fontSize:12},width:30}),i.jsx(pY,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(255,255,255,0.1)"}}),i.jsx(Ede,{dataKey:"value",fill:"#6366f1",radius:[4,4,0,0],children:r.map((l,c)=>i.jsx(nb,{fill:s[c%s.length]},`cell-${c}`))})]})})]}),o=()=>i.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[i.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Card Types"}),i.jsx(oG,{width:"100%",height:"100%",children:i.jsxs(Rnt,{children:[i.jsx(pde,{data:n,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",fill:"#8884d8",dataKey:"value",label:({cx:l,cy:c,midAngle:u,innerRadius:h,outerRadius:f,percent:m,index:g})=>null,children:n.map((l,c)=>i.jsx(nb,{fill:s[c%s.length]},`cell-${c}`))}),i.jsx(pY,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"}}),i.jsx(Ile,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"12px"}})]})})]});return e==="mana"?i.jsx("div",{className:"w-full h-full",children:a()}):e==="types"?i.jsx("div",{className:"w-full h-full",children:o()}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-800 rounded-xl border border-gray-700",children:[i.jsx("div",{className:"h-64",children:a()}),i.jsx("div",{className:"h-64",children:o()})]})},Dnt=({isOpen:t,onClose:e,onConfirm:r,ownership:n})=>{if(!t)return null;const{ownedCards:s,totalCards:a,percentOwned:o}=n;return Kn.createPortal(i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-slide-up",children:[i.jsx("div",{className:"p-6 border-b border-gray-800 bg-gray-900/50",children:i.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Import Deck Options"]})}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl p-4",children:[i.jsxs("div",{className:"flex justify-between items-end mb-2",children:[i.jsx("span",{className:"text-gray-400 text-sm font-medium uppercase tracking-wider",children:"Ownership"}),i.jsxs("span",{className:"text-indigo-300 font-mono font-bold",children:[o,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 mb-2",children:i.jsx("div",{className:"bg-indigo-500 h-2 rounded-full transition-all duration-1000",style:{width:`${o}%`}})}),i.jsxs("p",{className:"text-gray-300 text-sm",children:["You already own ",i.jsx("strong",{className:"text-white",children:s})," of the ",i.jsx("strong",{className:"text-white",children:a})," cards in this deck."]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h3",{className:"text-white font-bold text-sm",children:"How would you like to proceed?"}),i.jsxs("button",{onClick:()=>r(!0),className:"w-full flex items-start text-left p-4 rounded-xl border border-indigo-500/30 bg-indigo-900/10 hover:bg-indigo-900/20 transition-all group",children:[i.jsx("div",{className:"mt-1 shrink-0 w-6 h-6 rounded-full border-2 border-indigo-500 flex items-center justify-center mr-4 group-hover:scale-110 transition-transform",children:i.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Use Existing Cards"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Moves cards from your collection (Binder) into this deck. Best for organizing your physical collection."})]})]}),i.jsxs("button",{onClick:()=>r(!1),className:"w-full flex items-start text-left p-4 rounded-xl border border-gray-700 bg-gray-800/30 hover:bg-gray-800 hover:border-gray-600 transition-all group",children:[i.jsx("div",{className:"mt-1 shrink-0 w-6 h-6 rounded-full border-2 border-gray-600 flex items-center justify-center mr-4 group-hover:border-gray-500 transition-colors"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-gray-300 group-hover:text-white transition-colors",children:"Add New Copies"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Adds fresh copies of all cards to your collection. Select this if you bought a new boxed Precon."})]})]})]})]}),i.jsx("div",{className:"p-4 border-t border-gray-800 flex justify-end",children:i.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-bold text-gray-400 hover:text-white transition-colors",children:"Cancel"})})]})}),document.body)},gT=[{badge:"White",colors:["W"],theme:"Absolute Order"},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry"},{badge:"Black",colors:["B"],theme:"Unrestricted Power"},{badge:"Red",colors:["R"],theme:"Chaotic Passion"},{badge:"Green",colors:["G"],theme:"Primal Growth"},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control"},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration"},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage"},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction"},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony"},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity"},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genus"},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot"},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression"},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution"},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic"},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny"},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation"},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty"},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order"},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance"},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark"},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay"},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest"},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct"},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence"},{badge:"Colorless",colors:["C"],theme:"The Great Void"}],Bnt=()=>{const{id:t}=cc(),e=yn(),{currentUser:r,userProfile:n}=Cr(),{addToast:s}=Tn(),[a,o]=b.useState(null),[l,c]=b.useState(!0),[u,h]=b.useState("grid"),[f,m]=b.useState(null),[g,y]=b.useState(0),[v,w]=b.useState(!1),[N,k]=b.useState(null),[C,I]=b.useState(null);b.useEffect(()=>{(async()=>{try{const U=await He.get(`/api/precons/${t}`);o(U)}catch(U){console.error("Precon load failed",U),s("Failed to load precon","error"),e("/precons")}finally{c(!1)}})()},[t,e,s]);const O=b.useMemo(()=>a?[...(a.data.commander||[]).map(q=>({...q,isCommander:!0})),...a.data.mainBoard||[]]:[],[a]),L=b.useMemo(()=>{if(!a)return null;const q=a.data.commander||[];if(q.length>0)return q[0];let U=null,H=-1;const re=ae=>ae.data?.cmc||ae.cmc||0;for(const ae of a.data.mainBoard||[]){const xe=re(ae);xe>H&&(H=xe,U=ae)}return U},[a]),_=b.useMemo(()=>!a?.data?.commander||a.data.commander.length<2?null:a.data.commander[1],[a]),E=g===0?L:_||L,M=q=>q?q.image_uris?.normal?q.image_uris.normal:q.card_faces?.[0]?.image_uris?.normal?q.card_faces[0].image_uris.normal:q.data?.image_uris?.normal?q.data.image_uris.normal:q.data?.card_faces?.[0]?.image_uris?.normal?q.data.card_faces[0].image_uris.normal:"https://placehold.co/400x600":"",S=(q=>q?q.image_uris?.art_crop?q.image_uris.art_crop:q.data?.image_uris?.art_crop?q.data.image_uris.art_crop:q.card_faces?.[0]?.image_uris?.art_crop?q.card_faces[0].image_uris.art_crop:q.data?.card_faces?.[0]?.image_uris?.art_crop?q.data.card_faces[0].image_uris.art_crop:M(q):"")(E),P={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},R=b.useMemo(()=>O.reduce((q,U)=>q+(U.count||U.quantity||1),0),[O]),V=b.useMemo(()=>O.reduce((q,U)=>{const H=parseFloat(U.prices?.usd||U.prices?.usd_foil||U.data?.prices?.usd||U.data?.prices?.usd_foil||0);return q+H*(U.count||U.quantity||1)},0),[O]),ee=b.useMemo(()=>{const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return O.forEach(U=>{if(U.isCommander){q.Commander.push(U);return}const H=(U.data?.type_line||U.type||"").toLowerCase();H.includes("creature")?q.Creature.push(U):H.includes("planeswalker")?q.Planeswalker.push(U):H.includes("instant")?q.Instant.push(U):H.includes("sorcery")?q.Sorcery.push(U):H.includes("artifact")?q.Artifact.push(U):H.includes("enchantment")?q.Enchantment.push(U):H.includes("land")?q.Land.push(U):q.Other.push(U)}),Object.keys(q).forEach(U=>{q[U]=q[U].map(H=>({...H,image_uri:M(H)}))}),Object.fromEntries(Object.entries(q).filter(([U,H])=>H.length>0))},[O]),G=b.useMemo(()=>{if(!a)return gT.find(H=>H.badge==="Colorless");const q=a.data?.colors||[];return gT.find(H=>H.colors.length!==q.length?!1:H.colors.every(re=>q.includes(re)))||gT.find(H=>H.badge==="Colorless")},[a]);yo();const{decks:J}=yd(),Z=async q=>{const U=n?.subscription_tier||"free",re=An(U).limits.decks;if(re!==1/0&&J&&J.length>=re){s(`Deck limit reached (${J.length}/${re}). Upgrade to add this deck!`,"error");return}m(q);try{const ae=await He.checkPreconOwnership(a.id);console.log("Precon Ownership Check:",ae);const xe=ae.ownedCards||0,Ne=ae.totalCards||0,pe=ae.percentOwned||0;xe>0?(k(ae),I(q),w(!0)):await X(q,!1)}catch(ae){console.error("Ownership check failed",ae),window.confirm("Ownership check failed. Create deck anyway (may duplicate cards)?")&&await X(q,!1)}finally{m(null)}},se=async q=>{if(w(!1),C){m(C);try{await X(C,q)}finally{m(null),I(null)}}},X=async(q,U)=>{try{const H=await He.createPreconDeck(a.id,{mode:q,useExisting:U});H.success&&(s(U?"Deck created using existing cards!":"Deck created with new cards!","success"),e(`/decks/${H.deckId}`))}catch(H){console.error(H),H.message&&H.message.includes("Limit reached")?s(H.message,"error"):s("Failed to create deck","error")}};return l?i.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})}):a?i.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[i.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${S})`},children:i.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),i.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2 font-bold",children:[i.jsx(Hr,{to:"/precons",className:"hover:text-white transition-colors",children:"Precons"}),i.jsx("span",{children:"/"}),a.data.code&&i.jsxs(i.Fragment,{children:[i.jsx(Hr,{to:`/precons/set/${a.data.code}`,className:"hover:text-white transition-colors",children:a.data.code}),i.jsx("span",{children:"/"})]}),i.jsx("span",{className:"text-white",children:a.name})]}),i.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:i.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:a.type||"Commander"}),i.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:"Official Precon"})]}),i.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:a.name}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex items-center gap-1",children:(a.data.colors||[]).map(q=>i.jsx("img",{src:P[q],alt:q,className:"w-6 h-6"},q))}),i.jsx("div",{className:"h-4 w-px bg-white/10"}),i.jsx("div",{className:"text-sm font-bold text-gray-400",children:G?.theme||"Deck"})]})]}),i.jsxs("div",{className:"flex flex-col items-end gap-2",children:[i.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",V.toFixed(2)]}),i.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[R," Cards"]}),i.jsxs("div",{className:"flex flex-wrap justify-end gap-2 mt-2",children:[i.jsxs("a",{href:`https://www.amazon.com/s?k=${encodeURIComponent(a.name)}&tag=mtgsite-20`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#FF9900] text-black px-4 py-2 rounded-xl font-black hover:bg-[#FF9900]/90 transition-colors shadow-lg shadow-orange-900/20 text-xs uppercase tracking-wider flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M15.54 13.924c-1.35 1.572-3.645 2.502-5.466 2.502-3.132 0-5.187-1.487-6.264-2.292l-.768 1.488c1.374 1.05 4.092 3.036 8.046 2.454 2.829-.414 5.37-2.67 6.096-3.816l-1.644-.336zM3.444 19.542l1.626 1.104c.126.066.27.018.33-.096.792-2.142 2.766-3.21 2.898-3.276.102-.054.126-.18.066-.27l-1.632-2.07c-.066-.09-.192-.09-.264-.024-.03.042-2.22 2.652-3.09 4.392-.048.102.006.21.066.24zM20.598 6.942C20.598 6.942 18.078 2.37 11.232 2.598 4.296 2.826 2.898 7.356 2.898 7.356c-.054.168.042.33.204.372l1.83.474c.144.036.294-.036.354-.168.03-.066 1.038-2.61 5.388-2.88 2.058-.126 4.194.516 5.34 1.764.57.624.81 1.434.69 2.214-1.284.186-2.58.348-3.84.48-4.2.438-6.198 2.052-6.114 4.542.06 1.764 1.344 3.324 3.96 3.258 2.634-.066 4.104-1.848 4.104-1.848v1.446c0 .168.126.3.288.3h1.992c.162 0 .288-.132.288-.3l.006-4.944c-.006-3.324-1.746-5.124-4.8-5.124H20.598zM12.924 10.998c0 .672-.084 1.458-.87 2.016-.624.456-1.398.546-1.956.558-1.098.024-1.722-.594-1.758-1.218-.048-1.02 0-1.872 4.584-2.316v.96z"})}),"Amazon"]}),i.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${a.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-black hover:bg-[#3a3a3a] transition-colors shadow-lg shadow-black/20 text-xs uppercase tracking-wider flex items-center gap-2 border border-white/10",children:[i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"TCGPlayer"]}),i.jsx("button",{onClick:()=>Z("collection"),disabled:f,className:"bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm disabled:opacity-50",children:f==="collection"?"Adding...":"Add to Collection"}),i.jsx("button",{onClick:()=>Z("wishlist"),disabled:f,className:"bg-gray-800 text-white border border-gray-700 px-4 py-2 rounded-xl font-bold hover:bg-gray-700 transition-colors text-sm disabled:opacity-50",children:"Wishlist"})]})]})]})}),i.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[i.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[i.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[i.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),i.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[i.jsx("button",{onClick:()=>h("grid"),className:`p-1.5 rounded ${u==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),i.jsx("button",{onClick:()=>h("table"),className:`p-1.5 rounded ${u==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),i.jsx("div",{className:"p-4 space-y-8",children:Object.entries(ee).map(([q,U])=>i.jsxs("div",{children:[i.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[i.jsx("span",{children:q}),i.jsx("span",{className:"text-gray-500",children:U.reduce((H,re)=>H+(re.count||re.quantity||1),0)})]}),u==="grid"?i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:U.map((H,re)=>i.jsx(Ky,{card:H,readOnly:!0,showQuantity:!0},re))}):i.jsx("div",{className:"space-y-1",children:U.map((H,re)=>i.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("span",{className:"font-mono text-gray-500",children:H.count||H.quantity||1}),i.jsx("span",{className:H.finish==="foil"?"text-yellow-200":"",children:H.name})]}),i.jsx("div",{className:"font-mono text-xs opacity-50",children:H.manacost||H.mana_cost||H.data?.mana_cost})]},re))})]},q))})]})}),i.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:L?.isCommander?"Commander":"Spotlight Card"}),i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:M(E)||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Featured Card"}),E?.data?.card_faces?.length>1&&E.data.card_faces[1].image_uris&&i.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-gray-900/80 rounded block md:hidden",title:"Flip",children:""})]}),_&&i.jsx("button",{onClick:()=>y(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:g===0?"View Partner":"View Commander"})]}),i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[i.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"h-[120px]",children:[i.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),i.jsx(Yk,{cards:O,type:"mana"})]}),i.jsxs("div",{className:"h-[220px]",children:[i.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),i.jsx(Yk,{cards:O,type:"types"})]})]})]})]})]})]}),i.jsx(Dnt,{isOpen:v,onClose:()=>{w(!1),m(null)},onConfirm:se,ownership:N})]}):null},Yh={ANALYSIS:1,ARCHITECT:2,DEPLOY:3},Fnt=()=>{const{deckId:t}=cc(),e=yn(),{userProfile:r,currentUser:n}=Cr(),{addToast:s}=Tn(),{deck:a,cards:o,loading:l}=PM(t),{cards:c}=yo();b.useEffect(()=>{if(!r)return;An(r.subscription_tier).features.deckSuggestions||(s("Deck Builder requires Magician tier or higher.","error"),e(`/decks/${t}`))},[r,t]);const[u,h]=b.useState(Yh.ANALYSIS),[f,m]=b.useState(`Initializing ${r?.settings?.helper?.name||"Oracle"}...`),[g,y]=b.useState([]),[v,w]=b.useState(!1),[N,k]=b.useState({}),[C,I]=b.useState(new Set),[O,L]=b.useState("All"),[_,E]=b.useState("grid"),M=b.useRef(null),[B,S]=b.useState({ownedOnly:!0,excludeAssigned:!0,restrictSet:!1,setName:"",finishPreference:"cheapest"}),[P,R]=b.useState("collection"),[V,ee]=b.useState("");b.useEffect(()=>{M.current?.scrollIntoView({behavior:"smooth"})},[g]),b.useEffect(()=>{a?.commander?.set_name&&!B.setName&&S(fe=>({...fe,setName:a.commander.set_name}))},[a,B.setName]);const G=fe=>{y(he=>[...he,`[${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${fe}`])},J=r?.settings?.helper?.name||"The Oracle",Z=fe=>{if(!fe)return null;const he=fe.data||fe;return he.image_uris?.art_crop?he.image_uris.art_crop:he.card_faces?.[0]?.image_uris?.art_crop?he.card_faces[0].image_uris.art_crop:he.image_uris?.normal?he.image_uris.normal:null},se=fe=>new Promise(he=>setTimeout(he,fe)),X={W:"00000000-0000-0000-0000-000000000001",U:"00000000-0000-0000-0000-000000000002",B:"00000000-0000-0000-0000-000000000003",R:"00000000-0000-0000-0000-000000000004",G:"00000000-0000-0000-0000-000000000005"},q=(fe,he)=>{if(!fe||fe.length===0)return!0;if(!he||he.length===0)return fe.length===0;const le=new Set(he);return fe.every(_e=>le.has(_e))},U=(fe,he)=>{const le={W:0,U:0,B:0,R:0,G:0,total:0},_e=oe=>{oe&&(le.W+=(oe.match(/\{W\}/g)||[]).length,le.U+=(oe.match(/\{U\}/g)||[]).length,le.B+=(oe.match(/\{B\}/g)||[]).length,le.R+=(oe.match(/\{R\}/g)||[]).length,le.G+=(oe.match(/\{G\}/g)||[]).length)};return fe.forEach(oe=>_e(oe.mana_cost||oe.data?.mana_cost)),Object.values(he).forEach(oe=>_e(oe.data?.mana_cost||oe.type_line)),le.total=le.W+le.U+le.B+le.R+le.G,le},H=(fe,he,le)=>{if(fe<=0)return{};if(he.total===0)return{};const _e={W:{name:"Plains",type:"Basic Land  Plains"},U:{name:"Island",type:"Basic Land  Island"},B:{name:"Swamp",type:"Basic Land  Swamp"},R:{name:"Mountain",type:"Basic Land  Mountain"},G:{name:"Forest",type:"Basic Land  Forest"}},oe={},Oe={W:0,U:0,B:0,R:0,G:0};let ze=0;if(["W","U","B","R","G"].forEach(Ye=>{if(he[Ye]>0){const je=he[Ye]/he.total,Fe=Math.round(fe*je);Oe[Ye]=Fe,ze+=Fe}}),ze>0){const Ye=Object.keys(Oe).filter(je=>Oe[je]>0);Ye.sort((je,Fe)=>Oe[Fe]-Oe[je]),ze<fe?Oe[Ye[0]]+=fe-ze:ze>fe&&(Oe[Ye[0]]-=ze-fe)}return Object.entries(Oe).forEach(([Ye,je])=>{if(je>0){const Fe=_e[Ye],Nt=X[Ye],$t=le.find(Ut=>Ut.name===Fe.name)||{name:Fe.name,type_line:Fe.type,scryfall_id:Nt,id:Nt,image_uris:{normal:`https://api.scryfall.com/cards/named?exact=${Fe.name}&format=image`}};for(let Ut=0;Ut<je;Ut++){const nt=`basic-${Ye}-${Ut}-${Date.now()}`;oe[nt]={firestoreId:nt,name:Fe.name,type_line:Fe.type,rating:10,reason:`Auto-filled to match ${Math.round(he[Ye]/he.total*100)}% ${Ye} pip density.`,suggestedType:"Land",data:{...$t.data||$t,scryfall_id:$t.scryfall_id||$t.id||Nt},isVirtual:!0}}}}),oe},re=async()=>{if(!r?.settings?.geminiApiKey){s("Gemini API Key missing in settings.","error"),e("/settings/ai");return}w(!0),m(`Preparing ${P==="discovery"?"Global Analysis":"Collection Analysis"}...`),G(`Starting analysis (Mode: ${P.toUpperCase()})...`);try{const fe=[...new Set([...a.commander?.color_identity||[],...a.commander_partner?.color_identity||[]])],he=a.aiBlueprint||{},le=["Synergy / Strategy","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Land"],_e=new Set(o.map(mt=>mt.name));a.commander?.name&&_e.add(a.commander.name),a.commander_partner?.name&&_e.add(a.commander_partner.name);const Oe={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...he.layout?.functional||he.suggestedCounts||{}},ze={},Ye=new Set,je=(B.setName||"").toLowerCase().trim(),Fe={};let Nt=0;for(const mt of le){const Ft=o.filter(Ct=>(Ct.data?.type_line||Ct.type_line||"").includes(mt)).reduce((Ct,Xt)=>Ct+(Xt.countInDeck||1),0),gt=Oe[mt]||0;let Ot=Math.max(0,gt-Ft);Ot>0&&(Fe[mt]=Ot,Nt+=Ot)}const Ut=100-(o.length+(a.commander?1:0)+(a.commander_partner?1:0));if(Nt>Ut){let mt=Nt-Ut;if(G(`Detected over-request (Needs ${Nt} for slots, but only ${Ut} available). Balancing...`),Fe["Synergy / Strategy"]>0){const Ft=Math.min(Fe["Synergy / Strategy"],mt);Fe["Synergy / Strategy"]-=Ft,mt-=Ft}Nt=Object.values(Fe).reduce((Ft,gt)=>Ft+gt,0)}if(Nt===0){G("Deck goals appear met! No missing slots found based on targets."),w(!1),m("Idle");return}const nt=[];if(P==="collection"){G("Scanning collection for candidates...");const mt=new Set;for(const Ft of c){if(mt.has(Ft.name)||B.ownedOnly&&Ft.is_wishlist||B.excludeAssigned&&Ft.deckId)continue;const gt=Ft.data?.color_identity||Ft.data?.colors||[];if(q(gt,fe)&&!_e.has(Ft.name)){if(B.restrictSet&&je){const Ot=(Ft.set_name||Ft.data?.set_name||"").toLowerCase(),Ct=(Ft.set||Ft.data?.set||"").toLowerCase();if(!Ot.includes(je)&&Ct!==je)continue}nt.push({firestoreId:Ft.id,name:Ft.name,type_line:Ft.data?.type_line||Ft.type_line}),mt.add(Ft.name)}}if(nt.length===0){G("No valid candidates found with current filters."),w(!1),m("Idle");return}G(`Payload: ${nt.length} Cards available for Analysis.`)}else G("Discovery Mode Active: Bypassing collection scan. AI will search global database.");const It=[a.commander,a.commander_partner].filter(Boolean).map(mt=>({name:mt.name||mt.data?.name||"Unknown",mana_cost:mt.mana_cost||mt.cmc||mt.data?.mana_cost||mt.data?.cmc||"0",type_line:mt.type_line||mt.data?.type_line||"Legendary Creature",oracle_text:mt.oracle_text||mt.data?.oracle_text||""})),_t=It.map(mt=>mt.name).join(" & ");let wt=r.playstyle||r.settings?.playstyle||r.data?.playstyle||null;!wt&&r.data&&r.data.playstyle&&(wt=r.data.playstyle),wt||(G(" Playstyle undefined in profile. Using generic fallback."),wt={summary:"Balanced Magic player enjoying strategic depth and interaction.",archetypes:["Midrange","Control"],scores:{aggression:5}});const ut={deckName:a.name,commander:_t,strategyGuide:he?.strategy||"No specific strategy guide.",helperPersona:r?.settings?.helper,instructions:`Fill the following deck slots: ${JSON.stringify(Fe)}. 
                ${V?`STRATEGY FOCUS: ${V}`:""}
                IMPORTANT: For every card suggested, you MUST provide the specific 'set' code and 'collectorNumber' from Scryfall to ensure the correct printing is identified.`,deckRequirements:Fe,candidates:P==="collection"?nt.slice(0,3500):[],buildMode:P,currentContext:Array.from(_e),neededCount:Nt,commanderColorIdentity:fe.join("")||"Colorless",commanders:It};m(`Consulting ${J} for a strategy centered around ${_t}...`),G(`Core Directive: Synergize with ${_t}'s specific triggers and playstyle.`);const Rt=async(mt,Ft,gt={})=>{const Ot={},Ct=new Set,Xt=new Set(Ft),Qt=["Consulting the archives...","Analysing mana curves...","Simulating games...","Searching for hidden gems...","Optimizing synergy lines..."];let nr=setInterval(()=>{const sr=Qt[Math.floor(Math.random()*Qt.length)];m(`${J}: ${sr}`)},2500);try{const sr=Object.values(mt).reduce((Ae,Ke)=>Ae+Ke,0);G(`Requesting ${sr} cards from ${J} for a cohesive deck strategy...`);const Jt={...ut,deckRequirements:mt,currentContext:Array.from(Xt),neededCount:sr},kr=await Nl.generateDeckSuggestions(r.settings.geminiApiKey,Jt,null,r);if(kr?.suggestions){const Ae=kr.suggestions.sort((jt,zt)=>(zt.rating||0)-(jt.rating||0)),Ke={},Gt=Ae.filter(jt=>{const zt=jt.role||"Synergy / Strategy",Mt=mt[zt]||0;return Mt===0&&gt.isReconciliation&&Object.values(Ke).reduce((vr,Fr)=>vr+Fr,0)<sr?(Ke[zt]=(Ke[zt]||0)+1,!0):(Ke[zt]=(Ke[zt]||0)+1,Ke[zt]<=Mt)});for(const jt of Gt){const zt=jt.role||"Synergy / Strategy";if(Xt.add(jt.name),P==="discovery"&&(!jt.firestoreId||jt.firestoreId==="discovery")){await new Promise(vr=>setTimeout(vr,100)),G(`Resolving "${jt.name}"...`);const Ht=((await He.post("/api/cards/search",{query:jt.name,set:jt.set,cn:jt.collectorNumber,preferFinish:B.finishPreference})).data||[])[0];if(Ht){const vr=Ht.uuid||Ht.id;Ot[vr]={...jt,firestoreId:vr,name:Ht.name,type_line:Ht.type_line||Ht.type,data:Ht,isDiscovery:!0,is_wishlist:!c.some(Fr=>(Fr.scryfall_id||Fr.uuid)===vr),suggestedType:zt},Ct.add(vr)}}else if(jt.firestoreId){const Mt=c.find(Ht=>Ht.id===jt.firestoreId);Mt&&(Ot[jt.firestoreId]={...jt,firestoreId:jt.firestoreId,name:Mt.name,type_line:Mt.data?.type_line||Mt.type_line,data:Mt.data||Mt,suggestedType:zt},Ct.add(jt.firestoreId))}}}}catch(sr){throw nr&&clearInterval(nr),sr}finally{nr&&clearInterval(nr)}return{suggestions:Ot,ids:Ct}},{suggestions:Dt,ids:at}=await Rt(Fe,Array.from(_e));Object.assign(ze,Dt),at.forEach(mt=>Ye.add(mt));const ft=[];if(Object.entries(ze).forEach(([mt,Ft])=>{const gt=Ft.data?.color_identity||[];q(gt,fe)||(G(` "${Ft.name}" violates color identity. Discarding.`),ft.push(mt))}),ft.length>0){G("Pacing AI for refinement..."),await se(2e3);const mt={};ft.forEach(gt=>{const Ot=ze[gt].suggestedType;mt[Ot]=(mt[Ot]||0)+1,delete ze[gt],Ye.delete(gt)}),G(`Detected ${ft.length} illegal cards. Refining...`);const Ft=[...Array.from(_e),...Object.values(ze).map(gt=>gt.name)];try{const{suggestions:gt,ids:Ot}=await Rt(mt,Ft);Object.assign(ze,gt),Ot.forEach(Ct=>Ye.add(Ct))}catch{G("Refinement unsuccessful. Proceeding.")}}const Bt=o.filter(mt=>(mt.data?.type_line||mt.type_line||"").includes("Land")).length,De=Object.values(ze).filter(mt=>mt.suggestedType==="Land").length,lt=Oe.Land||36;let ht=Math.max(0,lt-(Bt+De));if(ht>0){G(`Balancing mana base and filling ${ht} targeted land slots...`);const mt=H(ht,U(o,ze),c);Object.assign(ze,mt),Object.keys(mt).forEach(Ft=>Ye.add(Ft))}const Pt=o.length+Object.keys(ze).length+(a.commander?1:0)+(a.commander_partner?1:0),At=100-Pt;if(At>2){G("Pacing AI for reconciliation..."),await se(2e3),G(`Final check: Deck is at ${Pt}/100. Requesting ${At} missing cards from ${J}...`);const mt={};[...o,...Object.values(ze)].forEach(Ct=>{let Xt=Ct.suggestedType;Xt||((Ct.data?.type_line||Ct.type_line||"").toLowerCase().includes("land")?Xt="Land":Xt="Synergy / Strategy"),mt[Xt]=(mt[Xt]||0)+(Ct.countInDeck||1)});const Ft={};let gt=At;const Ot=["Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];for(const Ct of Ot){const Xt=Oe[Ct]||0,Qt=mt[Ct]||0,nr=Math.max(0,Xt-Qt);if(nr>0){const sr=Math.min(nr,gt);Ft[Ct]=sr,gt-=sr}}gt>0&&(Ft["Synergy / Strategy"]=(Ft["Synergy / Strategy"]||0)+gt);try{const Ct=[...Array.from(_e),...Object.values(ze).map(sr=>sr.name)],{suggestions:Xt,ids:Qt}=await Rt(Ft,Ct,{isReconciliation:!0});Object.assign(ze,Xt),Qt.forEach(sr=>Ye.add(sr));const nr=o.length+Object.keys(ze).length+(a.commander?1:0)+(a.commander_partner?1:0);G(`Reconciliation complete. Added ${Qt.size} cards. Final deck size: ${nr}/100.`)}catch{G("Reconciliation AI pass failed. Filling remaining slots with basics as fallback.");const Xt=100-(o.length+Object.keys(ze).length+(a.commander?1:0)+(a.commander_partner?1:0));if(Xt>0){const Qt=H(Xt,U(o,ze),c);Object.assign(ze,Qt),Object.keys(Qt).forEach(nr=>Ye.add(nr))}}}k(ze),I(Ye),G(`Analysis complete. Outputting ${Object.keys(ze).length} suggestions for a balanced 100-card deck.`),h(Yh.ARCHITECT)}catch(fe){console.error(fe),s("Architecture failed. Please check your AI key.","error")}finally{w(!1),m("Ready.")}},ae=()=>h(Yh.ARCHITECT),xe=fe=>{const he=new Set(C);he.has(fe)?he.delete(fe):he.add(fe),I(he)},Ne=()=>i.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 py-12",children:[i.jsxs("div",{className:"text-center space-y-4",children:[i.jsx("div",{className:"inline-block p-4 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-4 animate-bounce",children:i.jsx("span",{className:"text-4xl",children:""})}),i.jsxs("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase italic",children:[J," Deck Architect"]}),i.jsxs("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:[J," will analyze your collection and current deck composition to architect the perfect additions for ",i.jsx("span",{className:"text-indigo-400 font-bold",children:a?.name}),"."]})]}),i.jsxs("div",{className:"bg-gray-900/40 backdrop-blur-xl rounded-3xl border border-white/10 p-6 space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),i.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Builder Configuration"})]}),i.jsxs("div",{className:"bg-gray-950/50 p-1 rounded-xl flex mb-6",children:[i.jsx("button",{onClick:()=>R("collection"),className:`flex-1 py-3 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${P==="collection"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Collection Mode"}),i.jsx("button",{onClick:()=>R("discovery"),className:`flex-1 py-3 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${P==="discovery"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Discovery Mode"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[P==="discovery"&&i.jsxs("div",{className:"md:col-span-2 space-y-4 animate-fade-in",children:[i.jsxs("label",{className:"text-xs font-black text-purple-400 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Strategy Focus / Specific Requests"]}),i.jsx("textarea",{value:V,onChange:fe=>ee(fe.target.value),placeholder:"E.g. 'I want a Dinosaur tribal theme with aggressive ramp'...",className:"w-full h-32 bg-gray-950/50 border border-purple-500/30 rounded-2xl p-4 text-sm text-white placeholder-gray-600 focus:ring-2 focus:ring-purple-500/50 outline-none resize-none shadow-inner"}),i.jsxs("p",{className:"text-[10px] text-gray-500 italic",children:["Note: Discovery Mode searches the entire Magic history. Cards you don't own will be marked as ",i.jsx("strong",{children:"Wishlist"})," items."]})]}),P==="collection"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Candidate Pool"}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Owned Cards Only"}),i.jsx("span",{className:"text-[10px] text-gray-500",children:"Hide wishlist items"})]}),i.jsx("div",{onClick:()=>S(fe=>({...fe,ownedOnly:!fe.ownedOnly})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${B.ownedOnly?"bg-indigo-600":"bg-gray-700"}`,children:i.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${B.ownedOnly?"translate-x-6":"translate-x-0"}`})})]}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Exclude Assigned"}),i.jsx("span",{className:"text-[10px] text-gray-500",children:"Skip cards in other decks"})]}),i.jsx("div",{onClick:()=>S(fe=>({...fe,excludeAssigned:!fe.excludeAssigned})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${B.excludeAssigned?"bg-indigo-600":"bg-gray-700"}`,children:i.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${B.excludeAssigned?"translate-x-6":"translate-x-0"}`})})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Set Priority"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"restrictSet",checked:B.restrictSet,onChange:fe=>S(he=>({...he,restrictSet:fe.target.checked})),className:"rounded bg-gray-800 border-gray-700 text-indigo-500 focus:ring-indigo-500 focus:ring-offset-gray-900"}),i.jsx("label",{htmlFor:"restrictSet",className:"text-xs text-indigo-300 font-bold cursor-pointer select-none",children:"Restrict to Set"})]})]}),i.jsx("input",{type:"text",disabled:!B.restrictSet,value:B.setName,onChange:fe=>S(he=>({...he,setName:fe.target.value})),placeholder:"e.g. Avatar, KTK, Khans...",className:`w-full bg-gray-950/50 border rounded-xl px-4 py-2.5 text-sm transition-all focus:ring-2 focus:ring-indigo-500/50 outline-none ${B.restrictSet?"border-indigo-500/30 text-white placeholder-gray-600":"border-white/5 text-gray-600 cursor-not-allowed"}`}),B.restrictSet&&i.jsxs("p",{className:"text-[10px] text-yellow-500/80 font-medium animate-fade-in",children:[' Only cards matching "',B.setName,'" will be suggested.']})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Finish / Price Preference"}),i.jsxs("select",{value:B.finishPreference,onChange:fe=>S(he=>({...he,finishPreference:fe.target.value})),className:"w-full bg-gray-950/50 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",children:[i.jsx("option",{value:"cheapest",children:"Cheapest Version (Any)"}),i.jsx("option",{value:"nonfoil",children:"Normal (Non-Foil)"}),i.jsx("option",{value:"foil",children:"Premium (Foil Only)"})]}),i.jsxs("p",{className:"text-[10px] text-gray-500 italic",children:["Determines which printing ",J," selects when resolving suggestions."]})]})]})]}),i.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 overflow-hidden shadow-2xl",children:[i.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/5 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${v?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:f})]}),i.jsxs("div",{className:"flex gap-4",children:[(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&i.jsx("button",{onClick:ae,className:"bg-amber-600/20 hover:bg-amber-600/40 text-amber-500 font-black px-6 py-3 rounded-2xl transition-all uppercase tracking-widest text-[10px] border border-amber-500/20",children:"Quick Skip (Dev)"}),!v&&i.jsx("button",{onClick:re,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black px-8 py-3 rounded-2xl transition-all shadow-lg shadow-indigo-500/20 uppercase tracking-widest text-xs border border-white/10",children:"Start Architecture"})]})]}),i.jsxs("div",{className:"p-8 h-[400px] overflow-y-auto font-mono text-xs space-y-3 custom-scrollbar bg-black/40 backdrop-blur-inner shadow-inner border-t border-white/5 leading-relaxed",children:[g.length===0?i.jsx("div",{className:"text-gray-600 italic animate-pulse",children:"Waiting for architecture to start..."}):g.map((fe,he)=>i.jsx("div",{className:"text-gray-300 animate-fade-in pl-4 border-l-2 border-indigo-500/40 py-1 hover:bg-white/5 transition-colors rounded-r",children:fe},he)),i.jsx("div",{ref:M})]})]})]})]}),pe=()=>{const fe=Object.values(N).filter(le=>O==="All"||le.suggestedType===O),he=["All","Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];return i.jsxs("div",{className:"h-full flex flex-col gap-6 py-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Selection Phase"}),i.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:["Review ",J,"'s suggestions and select the ones you want to draft into your deck."]})]}),i.jsx("div",{className:"flex items-center gap-3 bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md",children:[{mode:"grid",icon:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{mode:"table",icon:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"list",icon:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}].map(({mode:le,icon:_e})=>i.jsx("button",{onClick:()=>E(le),className:`p-2 rounded-xl transition-all ${_===le?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,title:`${le.charAt(0).toUpperCase()+le.slice(1)} View`,children:_e},le))})]}),i.jsx("div",{className:"flex bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md overflow-x-auto no-scrollbar mx-4",children:he.map(le=>{const _e=Object.values(N).filter(oe=>le==="All"||oe.suggestedType===le).length;return le!=="All"&&_e===0?null:i.jsxs("button",{onClick:()=>L(le),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${O===le?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[le," ",i.jsx("span",{className:"ml-1 opacity-40 font-mono",children:_e})]},le)})}),i.jsxs("div",{className:"flex-1 overflow-y-auto px-4 custom-scrollbar",children:[_==="list"&&i.jsx("div",{className:"space-y-4",children:fe.map(le=>i.jsxs("div",{onClick:()=>xe(le.firestoreId),className:`grid grid-cols-[auto_1fr_auto_auto] gap-8 items-center p-6 rounded-[2rem] border transition-all cursor-pointer group ${C.has(le.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[i.jsx("div",{className:`w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${C.has(le.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10 group-hover:border-white/30"}`,children:C.has(le.firestoreId)&&i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),i.jsxs("div",{className:"space-y-1 relative group/tooltip",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"block text-xl font-black text-white uppercase italic tracking-tight group-hover:text-indigo-300 transition-colors truncate",children:le.name}),le.data?.mana_cost&&i.jsx("span",{className:"text-xs font-bold text-gray-500 bg-gray-900/50 px-2 py-0.5 rounded border border-white/5",children:le.data.mana_cost.replace(/[{}]/g,"")})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.2em] uppercase",children:le.type_line}),i.jsx("span",{className:`text-[9px] font-black uppercase px-2 py-0.5 rounded ${le.is_wishlist?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"bg-green-500/20 text-green-400 border border-green-500/30"}`,children:le.is_wishlist?"Wishlist":"Owned"}),le.data?.power!==void 0&&le.data?.toughness!==void 0&&i.jsxs("span",{className:"text-[10px] font-black text-gray-500 px-2 py-0.5 bg-white/5 rounded",children:[le.data.power,"/",le.data.toughness]})]}),le.data?.oracle_text&&i.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1 max-w-sm italic",children:le.data.oracle_text}),i.jsx("div",{className:"absolute left-0 bottom-full mb-4 w-48 rounded-2xl overflow-hidden shadow-2xl border border-white/20 opacity-0 group-hover/tooltip:opacity-100 pointer-events-none transition-all duration-300 z-50 transform group-hover/tooltip:translate-y-[-8px]",children:i.jsx("img",{src:le.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(le.name)}&format=image`,className:"w-full h-auto",alt:le.name})})]}),i.jsxs("div",{className:"text-center font-mono text-indigo-400 font-bold bg-white/5 px-4 py-2 rounded-2xl border border-white/5",children:[le.rating,"/10"]}),i.jsxs("div",{className:"max-w-md bg-black/30 p-4 rounded-2xl border border-white/5 text-sm text-gray-400 font-medium italic leading-relaxed",children:['"',le.reason,'"']})]},le.firestoreId))}),_==="grid"&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-6",children:fe.map(le=>i.jsx("div",{onClick:()=>xe(le.firestoreId),className:`flex flex-col rounded-[2rem] border transition-all cursor-pointer group overflow-hidden ${C.has(le.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:i.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden",children:[i.jsx("img",{src:le.data?.image_uris?.art_crop||le.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(le.name)}&format=image`,alt:le.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",loading:"lazy"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-80"}),i.jsx("div",{className:`absolute top-4 right-4 w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${C.has(le.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"bg-black/40 border-white/20 group-hover:border-white/40"}`,children:C.has(le.firestoreId)&&i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:`text-[8px] font-black uppercase px-2 py-0.5 rounded ${le.is_wishlist?"bg-purple-500/50 text-white":"bg-green-500/50 text-white"}`,children:le.is_wishlist?"Wishlist":"Owned"}),le.data?.mana_cost&&i.jsx("span",{className:"text-[10px] font-bold text-white/70",children:le.data.mana_cost.replace(/[{}]/g,"")})]}),i.jsx("span",{className:"block text-lg font-black text-white uppercase italic tracking-tight line-clamp-1",children:le.name}),i.jsxs("div",{className:"flex justify-between items-center mt-1",children:[i.jsx("span",{className:"text-[10px] font-black text-indigo-300 tracking-[0.2em] uppercase truncate max-w-[70%]",children:le.type_line}),i.jsxs("span",{className:"text-xs font-mono text-indigo-400 font-bold bg-black/60 px-2 py-0.5 rounded-lg border border-white/10",children:[le.rating,"/10"]})]})]}),i.jsxs("div",{className:"absolute inset-0 bg-gray-950/90 opacity-0 group-hover:opacity-100 transition-opacity p-6 flex flex-col justify-center gap-4",children:[le.data?.oracle_text&&i.jsx("p",{className:"text-[11px] text-gray-300 line-clamp-4 leading-relaxed border-b border-white/5 pb-2",children:le.data.oracle_text}),i.jsxs("p",{className:"text-xs text-indigo-300 italic leading-relaxed",children:['"',le.reason,'"']}),i.jsxs("div",{className:"pt-2 flex justify-between items-center",children:[i.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:le.suggestedType}),le.data?.power!==void 0&&i.jsxs("span",{className:"text-xs font-black text-white/50",children:[le.data.power,"/",le.data.toughness]})]})]})]})},le.firestoreId))}),_==="table"&&i.jsx("div",{className:"bg-gray-950/30 rounded-[2rem] border border-white/5 overflow-hidden backdrop-blur-xl",children:i.jsxs("table",{className:"w-full text-left",children:[i.jsx("thead",{className:"bg-white/5 font-black text-[10px] uppercase tracking-[0.2em] text-gray-500",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-4 w-16",children:"Select"}),i.jsx("th",{className:"px-6 py-4",children:"Card Name"}),i.jsx("th",{className:"px-6 py-4",children:"Type"}),i.jsx("th",{className:"px-6 py-4 text-center",children:"Rating"}),i.jsx("th",{className:"px-6 py-4",children:"Reasoning"})]})}),i.jsx("tbody",{className:"divide-y divide-white/5",children:fe.map(le=>i.jsxs("tr",{onClick:()=>xe(le.firestoreId),className:`hover:bg-white/5 cursor-pointer transition-colors ${C.has(le.firestoreId)?"bg-indigo-500/5":""}`,children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${C.has(le.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10"}`,children:C.has(le.firestoreId)&&i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-bold text-white uppercase italic tracking-tight",children:le.name}),i.jsx("span",{className:`text-[8px] font-black w-fit mt-0.5 px-1 rounded uppercase ${le.is_wishlist?"bg-purple-500/20 text-purple-400":"bg-green-500/20 text-green-400"}`,children:le.is_wishlist?"Wishlist":"Owned"})]})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.1em] uppercase",children:le.type_line})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"font-mono text-indigo-400 font-bold bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:le.rating})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("span",{className:"text-xs text-gray-400 italic line-clamp-1",children:['"',le.reason,'"']})})]},le.firestoreId))})]})})]}),i.jsxs("div",{className:"p-8 bg-gray-950/40 backdrop-blur-3xl rounded-3xl border border-white/10 flex justify-between items-center shadow-2xl mx-4",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Draft Progress"}),i.jsxs("span",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:[C.size," Cards Selected"]})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>h(Yh.ANALYSIS),className:"px-8 py-3.5 bg-white/5 hover:bg-white/10 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-[11px] transition-all",children:"Re-Analyze"}),i.jsx("button",{onClick:()=>h(Yh.DEPLOY),className:"px-10 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/20 uppercase tracking-widest text-[11px] border border-white/10 transition-all",children:"Review & Deploy"})]})]})]})},K=()=>{const fe=Array.from(C).map(le=>N[le]),he=async()=>{if(!v){w(!0);try{const le=[],_e=new Map;c.forEach(ze=>{const Ye=ze.scryfall_id||ze.data?.scryfall_id;Ye&&!ze.deck_id&&_e.set(Ye,(_e.get(Ye)||0)+1)});const oe=new Set(o.map(ze=>ze.name)),Oe=new Set;for(const ze of fe){const Ye=ze.data||ze,je=Ye.scryfall_id||Ye.id;if(!je||!(ze.name.includes("Plains")||ze.name.includes("Island")||ze.name.includes("Swamp")||ze.name.includes("Mountain")||ze.name.includes("Forest"))&&(Oe.has(ze.name)||oe.has(ze.name)))continue;Oe.add(ze.name);let $t=ze.isDiscovery||P==="discovery";je&&_e.has(je)&&_e.get(je)>0&&($t=!1,_e.set(je,_e.get(je)-1)),le.push({scryfall_id:je,name:ze.name,set_code:Ye.set||Ye.set_code||"???",collector_number:Ye.collector_number||"0",finish:"nonfoil",image_uri:Ye.image_uris?.normal||null,data:Ye,count:1,is_wishlist:$t})}await He.post(`/api/decks/${t}/cards/batch`,{cards:le}),s(`Successfully added ${le.length} cards to ${a.name}!`,"success"),e(`/decks/${t}`)}catch(le){console.error("Deployment failed:",le),s("Failed to deploy cards. Please try again.","error")}finally{w(!1)}}};return i.jsxs("div",{className:"max-w-5xl mx-auto space-y-12 py-12",children:[i.jsxs("div",{className:"text-center space-y-4",children:[i.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:"Final Deployment"}),i.jsx("p",{className:"text-gray-500 font-medium",children:"Review your selected additions before applying them to your deck."})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:fe.map(le=>i.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-[2rem] border border-white/10 space-y-3 relative overflow-hidden group",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("span",{className:"font-black text-white uppercase italic text-lg truncate block flex-1",children:le.name}),i.jsx("span",{className:`text-[9px] font-black uppercase px-2 py-1 rounded ${le.is_wishlist?"bg-purple-500/20 text-purple-400":"bg-green-500/20 text-green-400"}`,children:le.is_wishlist?"Wishlist":"Owned"})]}),i.jsx("div",{className:"text-xs text-indigo-400/60 font-black uppercase tracking-widest",children:le.suggestedType}),i.jsxs("div",{className:"text-xs text-gray-400 leading-relaxed italic line-clamp-3",children:['"',le.reason,'"']}),i.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity pointer-events-none",children:i.jsx("img",{src:le.data?.image_uris?.art_crop||le.data?.image_uris?.normal,className:"w-full h-full object-cover",alt:""})})]},le.firestoreId))}),i.jsxs("div",{className:"flex gap-6 justify-center pt-8",children:[i.jsx("button",{onClick:()=>h(Yh.ARCHITECT),className:"px-12 py-4 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-xs transition-all shadow-xl",children:"Back to Architect"}),i.jsxs("button",{onClick:he,disabled:v,className:"px-16 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-2xl shadow-indigo-500/40 uppercase tracking-widest text-xs border border-white/10 transition-all flex items-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[v?i.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),'Apply to "',a?.name,'"']})]})]})};if(l)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-950",children:i.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-indigo-500 border-t-transparent rounded-full"})});const ue=Z(a?.commander)||Z(a?.commander_partner);return i.jsxs("div",{className:"min-h-screen bg-gray-950 text-gray-200 font-sans relative flex flex-col pt-16",children:[i.jsxs("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${ue})`,backgroundSize:"cover",backgroundPosition:"center"},children:[i.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/80 to-gray-950/40"})]}),i.jsxs("div",{className:"sticky top-0 z-50 px-6 py-4 flex justify-between items-center bg-gray-950 border-b border-white/5",children:[i.jsxs("button",{onClick:()=>e(`/decks/${t}`),className:"text-gray-500 hover:text-white flex items-center gap-2 group transition-all",children:[i.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),i.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Exit Wizard"})]}),i.jsx("div",{className:"flex gap-12",children:[1,2,3].map(fe=>i.jsxs("div",{className:`flex items-center gap-3 transition-all ${u===fe?"scale-110":"opacity-40"}`,children:[i.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${u>=fe?"bg-indigo-500 text-white":"bg-gray-800 text-gray-600"}`,children:fe}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em]",children:fe===1?"Analysis":fe===2?"Architect":"Deploy"})]},fe))}),i.jsx("div",{className:"w-32"})," "]}),i.jsxs("main",{className:"flex-1 relative z-10 px-4 max-w-7xl mx-auto w-full",children:[u===Yh.ANALYSIS&&Ne(),u===Yh.ARCHITECT&&pe(),u===Yh.DEPLOY&&K()]}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
                @keyframes pulse { 0%, 100% { opacity: 0.2; transform: scale(1.05); } 50% { opacity: 0.4; transform: scale(1); } }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
                .no-scrollbar::-webkit-scrollbar { display: none; }
                .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `}})]})},T7=b.createContext({});function I7(t){const e=b.useRef(null);return e.current===null&&(e.current=t()),e.current}const Gde=typeof window<"u",Kde=Gde?b.useLayoutEffect:b.useEffect,m3=b.createContext(null);function P7(t,e){t.indexOf(e)===-1&&t.push(e)}function L7(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const yh=(t,e,r)=>r>e?e:r<t?t:r;let O7=()=>{};const Of={},Yde=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function Xde(t){return typeof t=="object"&&t!==null}const Qde=t=>/^0[^.\s]+$/u.test(t);function M7(t){let e;return()=>(e===void 0&&(e=t()),e)}const gu=t=>t,$nt=(t,e)=>r=>e(t(r)),qw=(...t)=>t.reduce($nt),z2=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class R7{constructor(){this.subscriptions=[]}add(e){return P7(this.subscriptions,e),()=>L7(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let a=0;a<s;a++){const o=this.subscriptions[a];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const yf=t=>t*1e3,mu=t=>t/1e3;function Jde(t,e){return e?t*(1e3/e):0}const Zde=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,Unt=1e-7,znt=12;function Vnt(t,e,r,n,s){let a,o,l=0;do o=e+(r-e)/2,a=Zde(o,n,s)-t,a>0?r=o:e=o;while(Math.abs(a)>Unt&&++l<znt);return o}function Hw(t,e,r,n){if(t===e&&r===n)return gu;const s=a=>Vnt(a,0,1,t,r);return a=>a===0||a===1?a:Zde(s(a),e,n)}const ehe=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,the=t=>e=>1-t(1-e),rhe=Hw(.33,1.53,.69,.99),D7=the(rhe),nhe=ehe(D7),she=t=>(t*=2)<1?.5*D7(t):.5*(2-Math.pow(2,-10*(t-1))),B7=t=>1-Math.sin(Math.acos(t)),ihe=the(B7),ahe=ehe(B7),qnt=Hw(.42,0,1,1),Hnt=Hw(0,0,.58,1),ohe=Hw(.42,0,.58,1),Wnt=t=>Array.isArray(t)&&typeof t[0]!="number",lhe=t=>Array.isArray(t)&&typeof t[0]=="number",Gnt={linear:gu,easeIn:qnt,easeInOut:ohe,easeOut:Hnt,circIn:B7,circInOut:ahe,circOut:ihe,backIn:D7,backInOut:nhe,backOut:rhe,anticipate:she},Knt=t=>typeof t=="string",NX=t=>{if(lhe(t)){O7(t.length===4);const[e,r,n,s]=t;return Hw(e,r,n,s)}else if(Knt(t))return Gnt[t];return t},ZN=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Ynt(t,e){let r=new Set,n=new Set,s=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(h){o.has(h)&&(u.schedule(h),t()),h(l)}const u={schedule:(h,f=!1,m=!1)=>{const y=m&&s?r:n;return f&&o.add(h),y.has(h)||y.add(h),h},cancel:h=>{n.delete(h),o.delete(h)},process:h=>{if(l=h,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,u.process(h))}};return u}const Xnt=40;function che(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,o=ZN.reduce((C,I)=>(C[I]=Ynt(a),C),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:h,update:f,preRender:m,render:g,postRender:y}=o,v=()=>{const C=Of.useManualTiming?s.timestamp:performance.now();r=!1,Of.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(C-s.timestamp,Xnt),1)),s.timestamp=C,s.isProcessing=!0,l.process(s),c.process(s),u.process(s),h.process(s),f.process(s),m.process(s),g.process(s),y.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(v))},w=()=>{r=!0,n=!0,s.isProcessing||t(v)};return{schedule:ZN.reduce((C,I)=>{const O=o[I];return C[I]=(L,_=!1,E=!1)=>(r||w(),O.schedule(L,_,E)),C},{}),cancel:C=>{for(let I=0;I<ZN.length;I++)o[ZN[I]].cancel(C)},state:s,steps:o}}const{schedule:di,cancel:yp,state:Bo,steps:xT}=che(typeof requestAnimationFrame<"u"?requestAnimationFrame:gu,!0);let Yj;function Qnt(){Yj=void 0}const _l={now:()=>(Yj===void 0&&_l.set(Bo.isProcessing||Of.useManualTiming?Bo.timestamp:performance.now()),Yj),set:t=>{Yj=t,queueMicrotask(Qnt)}},uhe=t=>e=>typeof e=="string"&&e.startsWith(t),dhe=uhe("--"),Jnt=uhe("var(--"),F7=t=>Jnt(t)?Znt.test(t.split("/*")[0].trim()):!1,Znt=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function jX(t){return typeof t!="string"?!1:t.split("/*")[0].includes("var(--")}const Pb={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},V2={...Pb,transform:t=>yh(0,1,t)},ej={...Pb,default:1},F1=t=>Math.round(t*1e5)/1e5,$7=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function est(t){return t==null}const tst=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,U7=(t,e)=>r=>!!(typeof r=="string"&&tst.test(r)&&r.startsWith(t)||e&&!est(r)&&Object.prototype.hasOwnProperty.call(r,e)),hhe=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,a,o,l]=n.match($7);return{[t]:parseFloat(s),[e]:parseFloat(a),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},rst=t=>yh(0,255,t),yT={...Pb,transform:t=>Math.round(rst(t))},km={test:U7("rgb","red"),parse:hhe("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+yT.transform(t)+", "+yT.transform(e)+", "+yT.transform(r)+", "+F1(V2.transform(n))+")"};function nst(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const VP={test:U7("#"),parse:nst,transform:km.transform},Ww=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),P0=Ww("deg"),lh=Ww("%"),gr=Ww("px"),sst=Ww("vh"),ist=Ww("vw"),kX={...lh,parse:t=>lh.parse(t)/100,transform:t=>lh.transform(t*100)},Zx={test:U7("hsl","hue"),parse:hhe("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+lh.transform(F1(e))+", "+lh.transform(F1(r))+", "+F1(V2.transform(n))+")"},ba={test:t=>km.test(t)||VP.test(t)||Zx.test(t),parse:t=>km.test(t)?km.parse(t):Zx.test(t)?Zx.parse(t):VP.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?km.transform(t):Zx.transform(t),getAnimatableNone:t=>{const e=ba.parse(t);return e.alpha=0,ba.transform(e)}},ast=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function ost(t){return isNaN(t)&&typeof t=="string"&&(t.match($7)?.length||0)+(t.match(ast)?.length||0)>0}const fhe="number",phe="color",lst="var",cst="var(",_X="${}",ust=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function q2(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const l=e.replace(ust,c=>(ba.test(c)?(n.color.push(a),s.push(phe),r.push(ba.parse(c))):c.startsWith(cst)?(n.var.push(a),s.push(lst),r.push(c)):(n.number.push(a),s.push(fhe),r.push(parseFloat(c))),++a,_X)).split(_X);return{values:r,split:l,indexes:n,types:s}}function mhe(t){return q2(t).values}function ghe(t){const{split:e,types:r}=q2(t),n=e.length;return s=>{let a="";for(let o=0;o<n;o++)if(a+=e[o],s[o]!==void 0){const l=r[o];l===fhe?a+=F1(s[o]):l===phe?a+=ba.transform(s[o]):a+=s[o]}return a}}const dst=t=>typeof t=="number"?0:ba.test(t)?ba.getAnimatableNone(t):t;function hst(t){const e=mhe(t);return ghe(t)(e.map(dst))}const bp={test:ost,parse:mhe,createTransformer:ghe,getAnimatableNone:hst};function bT(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function fst({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,a=0,o=0;if(!e)s=a=o=r;else{const l=r<.5?r*(1+e):r+e-r*e,c=2*r-l;s=bT(c,l,t+1/3),a=bT(c,l,t),o=bT(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}function Xk(t,e){return r=>r>0?e:t}const Ri=(t,e,r)=>t+(e-t)*r,vT=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},pst=[VP,km,Zx],mst=t=>pst.find(e=>e.test(t));function SX(t){const e=mst(t);if(!e)return!1;let r=e.parse(t);return e===Zx&&(r=fst(r)),r}const CX=(t,e)=>{const r=SX(t),n=SX(e);if(!r||!n)return Xk(t,e);const s={...r};return a=>(s.red=vT(r.red,n.red,a),s.green=vT(r.green,n.green,a),s.blue=vT(r.blue,n.blue,a),s.alpha=Ri(r.alpha,n.alpha,a),km.transform(s))},qP=new Set(["none","hidden"]);function gst(t,e){return qP.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function xst(t,e){return r=>Ri(t,e,r)}function z7(t){return typeof t=="number"?xst:typeof t=="string"?F7(t)?Xk:ba.test(t)?CX:vst:Array.isArray(t)?xhe:typeof t=="object"?ba.test(t)?CX:yst:Xk}function xhe(t,e){const r=[...t],n=r.length,s=t.map((a,o)=>z7(a)(a,e[o]));return a=>{for(let o=0;o<n;o++)r[o]=s[o](a);return r}}function yst(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=z7(t[s])(t[s],e[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function bst(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=t.indexes[a][n[a]],l=t.values[o]??0;r[s]=l,n[a]++}return r}const vst=(t,e)=>{const r=bp.createTransformer(e),n=q2(t),s=q2(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?qP.has(t)&&!s.values.length||qP.has(e)&&!n.values.length?gst(t,e):qw(xhe(bst(n,s),s.values),r):Xk(t,e)};function yhe(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Ri(t,e,r):z7(t)(t,e)}const wst=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>di.update(e,r),stop:()=>yp(e),now:()=>Bo.isProcessing?Bo.timestamp:_l.now()}},bhe=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let a=0;a<s;a++)n+=Math.round(t(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Qk=2e4;function V7(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<Qk;)e+=r,n=t.next(e);return e>=Qk?1/0:e}function Nst(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(V7(n),Qk);return{type:"keyframes",ease:a=>n.next(s*a).value/e,duration:mu(s)}}const jst=5;function vhe(t,e,r){const n=Math.max(e-jst,0);return Jde(r-t(n),e-n)}const Zi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},wT=.001;function kst({duration:t=Zi.duration,bounce:e=Zi.bounce,velocity:r=Zi.velocity,mass:n=Zi.mass}){let s,a,o=1-e;o=yh(Zi.minDamping,Zi.maxDamping,o),t=yh(Zi.minDuration,Zi.maxDuration,mu(t)),o<1?(s=u=>{const h=u*o,f=h*t,m=h-r,g=HP(u,o),y=Math.exp(-f);return wT-m/g*y},a=u=>{const f=u*o*t,m=f*r+r,g=Math.pow(o,2)*Math.pow(u,2)*t,y=Math.exp(-f),v=HP(Math.pow(u,2),o);return(-s(u)+wT>0?-1:1)*((m-g)*y)/v}):(s=u=>{const h=Math.exp(-u*t),f=(u-r)*t+1;return-wT+h*f},a=u=>{const h=Math.exp(-u*t),f=(r-u)*(t*t);return h*f});const l=5/t,c=Sst(s,a,l);if(t=yf(t),isNaN(c))return{stiffness:Zi.stiffness,damping:Zi.damping,duration:t};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:t}}}const _st=12;function Sst(t,e,r){let n=r;for(let s=1;s<_st;s++)n=n-t(n)/e(n);return n}function HP(t,e){return t*Math.sqrt(1-e*e)}const Cst=["duration","bounce"],Est=["stiffness","damping","mass"];function EX(t,e){return e.some(r=>t[r]!==void 0)}function Ast(t){let e={velocity:Zi.velocity,stiffness:Zi.stiffness,damping:Zi.damping,mass:Zi.mass,isResolvedFromDuration:!1,...t};if(!EX(t,Est)&&EX(t,Cst))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*yh(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Zi.mass,stiffness:s,damping:a}}else{const r=kst(t);e={...e,...r,mass:Zi.mass},e.isResolvedFromDuration=!0}return e}function Jk(t=Zi.visualDuration,e=Zi.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:u,mass:h,duration:f,velocity:m,isResolvedFromDuration:g}=Ast({...r,velocity:-mu(r.velocity||0)}),y=m||0,v=u/(2*Math.sqrt(c*h)),w=o-a,N=mu(Math.sqrt(c/h)),k=Math.abs(w)<5;n||(n=k?Zi.restSpeed.granular:Zi.restSpeed.default),s||(s=k?Zi.restDelta.granular:Zi.restDelta.default);let C;if(v<1){const O=HP(N,v);C=L=>{const _=Math.exp(-v*N*L);return o-_*((y+v*N*w)/O*Math.sin(O*L)+w*Math.cos(O*L))}}else if(v===1)C=O=>o-Math.exp(-N*O)*(w+(y+N*w)*O);else{const O=N*Math.sqrt(v*v-1);C=L=>{const _=Math.exp(-v*N*L),E=Math.min(O*L,300);return o-_*((y+v*N*w)*Math.sinh(E)+O*w*Math.cosh(E))/O}}const I={calculatedDuration:g&&f||null,next:O=>{const L=C(O);if(g)l.done=O>=f;else{let _=O===0?y:0;v<1&&(_=O===0?yf(y):vhe(C,O,L));const E=Math.abs(_)<=n,M=Math.abs(o-L)<=s;l.done=E&&M}return l.value=l.done?o:L,l},toString:()=>{const O=Math.min(V7(I),Qk),L=bhe(_=>I.next(O*_).value,O,30);return O+"ms "+L},toTransition:()=>{}};return I}Jk.applyToOptions=t=>{const e=Nst(t,100,Jk);return t.ease=e.ease,t.duration=yf(e.duration),t.type="keyframes",t};function WP({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:h}){const f=t[0],m={done:!1,value:f},g=E=>l!==void 0&&E<l||c!==void 0&&E>c,y=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let v=r*e;const w=f+v,N=o===void 0?w:o(w);N!==w&&(v=N-f);const k=E=>-v*Math.exp(-E/n),C=E=>N+k(E),I=E=>{const M=k(E),B=C(E);m.done=Math.abs(M)<=u,m.value=m.done?N:B};let O,L;const _=E=>{g(m.value)&&(O=E,L=Jk({keyframes:[m.value,y(m.value)],velocity:vhe(C,E,m.value),damping:s,stiffness:a,restDelta:u,restSpeed:h}))};return _(0),{calculatedDuration:null,next:E=>{let M=!1;return!L&&O===void 0&&(M=!0,I(E),_(E)),O!==void 0&&E>=O?L.next(E-O):(!M&&I(E),m)}}}function Tst(t,e,r){const n=[],s=r||Of.mix||yhe,a=t.length-1;for(let o=0;o<a;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||gu:e;l=qw(c,l)}n.push(l)}return n}function Ist(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const a=t.length;if(O7(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=Tst(e,n,s),c=l.length,u=h=>{if(o&&h<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(h<t[f+1]);f++);const m=z2(t[f],t[f+1],h);return l[f](m)};return r?h=>u(yh(t[0],t[a-1],h)):u}function Pst(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=z2(0,e,n);t.push(Ri(r,1,s))}}function Lst(t){const e=[0];return Pst(e,t.length-1),e}function Ost(t,e){return t.map(r=>r*e)}function Mst(t,e){return t.map(()=>e||ohe).splice(0,t.length-1)}function $1({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=Wnt(n)?n.map(NX):NX(n),a={done:!1,value:e[0]},o=Ost(r&&r.length===e.length?r:Lst(e),t),l=Ist(o,e,{ease:Array.isArray(s)?s:Mst(e,s)});return{calculatedDuration:t,next:c=>(a.value=l(c),a.done=c>=t,a)}}const Rst=t=>t!==null;function q7(t,{repeat:e,repeatType:r="loop"},n,s=1){const a=t.filter(Rst),l=s<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const Dst={decay:WP,inertia:WP,tween:$1,keyframes:$1,spring:Jk};function whe(t){typeof t.type=="string"&&(t.type=Dst[t.type])}class H7{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const Bst=t=>t/100;class W7 extends H7{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==_l.now()&&this.tick(_l.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;whe(e);const{type:r=$1,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:o=0}=e;let{keyframes:l}=e;const c=r||$1;c!==$1&&typeof l[0]!="number"&&(this.mixKeyframes=qw(Bst,yhe(l[0],l[1])),l=[0,100]);const u=c({...e,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...l].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=V7(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:h,repeat:f,repeatType:m,repeatDelay:g,type:y,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const N=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?N<0:N>s;this.currentTime=Math.max(N,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let C=this.currentTime,I=n;if(f){const E=Math.min(this.currentTime,s)/l;let M=Math.floor(E),B=E%1;!B&&E>=1&&(B=1),B===1&&M--,M=Math.min(M,f+1),M%2&&(m==="reverse"?(B=1-B,g&&(B-=g/l)):m==="mirror"&&(I=o)),C=yh(0,1,B)*l}const O=k?{done:!1,value:h[0]}:I.next(C);a&&(O.value=a(O.value));let{done:L}=O;!k&&c!==null&&(L=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&L);return _&&y!==WP&&(O.value=q7(h,this.options,w,this.speed)),v&&v(O.value),_&&this.finish(),O}then(e,r){return this.finished.then(e,r)}get duration(){return mu(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+mu(e)}get time(){return mu(this.currentTime)}set time(e){e=yf(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(_l.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=mu(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=wst,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_l.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function Fst(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const _m=t=>t*180/Math.PI,GP=t=>{const e=_m(Math.atan2(t[1],t[0]));return KP(e)},$st={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:GP,rotateZ:GP,skewX:t=>_m(Math.atan(t[1])),skewY:t=>_m(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},KP=t=>(t=t%360,t<0&&(t+=360),t),AX=GP,TX=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),IX=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Ust={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:TX,scaleY:IX,scale:t=>(TX(t)+IX(t))/2,rotateX:t=>KP(_m(Math.atan2(t[6],t[5]))),rotateY:t=>KP(_m(Math.atan2(-t[2],t[0]))),rotateZ:AX,rotate:AX,skewX:t=>_m(Math.atan(t[4])),skewY:t=>_m(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function YP(t){return t.includes("scale")?1:0}function XP(t,e){if(!t||t==="none")return YP(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Ust,s=r;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=$st,s=l}if(!s)return YP(e);const a=n[e],o=s[1].split(",").map(Vst);return typeof a=="function"?a(o):o[a]}const zst=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return XP(r,e)};function Vst(t){return parseFloat(t.trim())}const Lb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ob=new Set(Lb),PX=t=>t===Pb||t===gr,qst=new Set(["x","y","z"]),Hst=Lb.filter(t=>!qst.has(t));function Wst(t){const e=[];return Hst.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const X0={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>XP(e,"x"),y:(t,{transform:e})=>XP(e,"y")};X0.translateX=X0.x;X0.translateY=X0.y;const Dm=new Set;let QP=!1,JP=!1,ZP=!1;function Nhe(){if(JP){const t=Array.from(Dm).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=Wst(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,o])=>{n.getValue(a)?.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}JP=!1,QP=!1,Dm.forEach(t=>t.complete(ZP)),Dm.clear()}function jhe(){Dm.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(JP=!0)})}function Gst(){ZP=!0,jhe(),Nhe(),ZP=!1}class G7{constructor(e,r,n,s,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Dm.add(this),QP||(QP=!0,di.read(jhe),di.resolveKeyframes(Nhe))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const a=s?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const l=n.readValue(r,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),s&&a===void 0&&s.set(e[0])}Fst(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Dm.delete(this)}cancel(){this.state==="scheduled"&&(Dm.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Kst=t=>t.startsWith("--");function Yst(t,e,r){Kst(e)?t.style.setProperty(e,r):t.style[e]=r}const Xst=M7(()=>window.ScrollTimeline!==void 0),Qst={};function Jst(t,e){const r=M7(t);return()=>Qst[e]??r()}const khe=Jst(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),d1=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,LX={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:d1([0,.65,.55,1]),circOut:d1([.55,0,1,.45]),backIn:d1([.31,.01,.66,-.59]),backOut:d1([.33,1.53,.69,.99])};function _he(t,e){if(t)return typeof t=="function"?khe()?bhe(t,e):"ease-out":lhe(t)?d1(t):Array.isArray(t)?t.map(r=>_he(r,e)||LX.easeOut):LX[t]}function Zst(t,e,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},u=void 0){const h={[e]:r};c&&(h.offset=c);const f=_he(l,s);Array.isArray(f)&&(h.easing=f);const m={delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return u&&(m.pseudoElement=u),t.animate(h,m)}function She(t){return typeof t=="function"&&"applyToOptions"in t}function eit({type:t,...e}){return She(t)&&khe()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class tit extends H7{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,O7(typeof e.type!="string");const u=eit(e);this.animation=Zst(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=q7(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(h):Yst(r,n,h),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return mu(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+mu(e)}get time(){return mu(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=yf(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&Xst()?(this.animation.timeline=e,gu):r(this)}}const Che={anticipate:she,backInOut:nhe,circInOut:ahe};function rit(t){return t in Che}function nit(t){typeof t.ease=="string"&&rit(t.ease)&&(t.ease=Che[t.ease])}const NT=10;class sit extends tit{constructor(e){nit(e),whe(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...o}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const l=new W7({...o,autoplay:!1}),c=Math.max(NT,_l.now()-this.startTime),u=yh(0,NT,c-NT);r.setWithVelocity(l.sample(Math.max(0,c-u)).value,l.sample(c).value,u),l.stop()}}const OX=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(bp.test(t)||t==="0")&&!t.startsWith("url("));function iit(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function ait(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=OX(s,e),l=OX(a,e);return!o||!l?!1:iit(t)||(r==="spring"||She(r))&&n}function eL(t){t.duration=0,t.type="keyframes"}const oit=new Set(["opacity","clipPath","filter","transform"]),lit=M7(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function cit(t){const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=e.owner.getProps();return lit()&&r&&oit.has(r)&&(r!=="transform"||!u)&&!c&&!n&&s!=="mirror"&&a!==0&&o!=="inertia"}const uit=40;class dit extends H7{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:u,element:h,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=_l.now();const m={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:o,name:c,motionValue:u,element:h,...f},g=h?.KeyframeResolver||G7;this.keyframeResolver=new g(l,(y,v,w)=>this.onKeyframesResolved(y,v,m,!w),c,u,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:u,onUpdate:h}=n;this.resolvedAt=_l.now(),ait(e,a,o,l)||((Of.instantAnimations||!c)&&h?.(q7(e,n,r)),e[0]=e[e.length-1],eL(n),n.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>uit?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},g=!u&&cit(m),y=m.motionValue?.owner?.current,v=g?new sit({...m,element:y}):new W7(m);v.finished.then(()=>{this.notifyFinished()}).catch(gu),this.pendingTimeline&&(this.stopTimeline=v.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=v}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Gst()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function Ehe(t,e,r,n=0,s=1){const a=Array.from(t).sort((u,h)=>u.sortNodePosition(h)).indexOf(e),o=t.size,l=(o-1)*n;return typeof r=="function"?r(a,o):s===1?a*n:l-a*n}const hit=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function fit(t){const e=hit.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function Ahe(t,e,r=1){const[n,s]=fit(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const o=a.trim();return Yde(o)?parseFloat(o):o}return F7(s)?Ahe(s,e,r+1):s}const pit={type:"spring",stiffness:500,damping:25,restSpeed:10},mit=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),git={type:"keyframes",duration:.8},xit={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},yit=(t,{keyframes:e})=>e.length>2?git:Ob.has(t)?t.startsWith("scale")?mit(e[1]):pit:xit,bit=t=>t!==null;function vit(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(bit),a=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[a]}function K7(t,e){return t?.[e]??t?.default??t}function wit({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:u,...h}){return!!Object.keys(h).length}const Y7=(t,e,r,n={},s,a)=>o=>{const l=K7(n,t)||{},c=l.delay||n.delay||0;let{elapsed:u=0}=n;u=u-yf(c);const h={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:a?void 0:s};wit(l)||Object.assign(h,yit(t,h)),h.duration&&(h.duration=yf(h.duration)),h.repeatDelay&&(h.repeatDelay=yf(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(eL(h),h.delay===0&&(f=!0)),(Of.instantAnimations||Of.skipAnimations)&&(f=!0,eL(h),h.delay=0),h.allowFlatten=!l.type&&!l.ease,f&&!a&&e.get()!==void 0){const m=vit(h.keyframes,l);if(m!==void 0){di.update(()=>{h.onUpdate(m),h.onComplete()});return}}return l.isSync?new W7(h):new dit(h)};function MX(t){const e=[{},{}];return t?.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function X7(t,e,r,n){if(typeof e=="function"){const[s,a]=MX(n);e=e(r!==void 0?r:t.custom,s,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,a]=MX(n);e=e(r!==void 0?r:t.custom,s,a)}return e}function _y(t,e,r){const n=t.getProps();return X7(n,e,r!==void 0?r:n.custom,t)}const The=new Set(["width","height","top","left","right","bottom",...Lb]),RX=30,Nit=t=>!isNaN(parseFloat(t));class jit{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=_l.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=_l.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Nit(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new R7);const n=this.events[e].add(r);return e==="change"?()=>{n(),di.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=_l.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>RX)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,RX);return Jde(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sb(t,e){return new jit(t,e)}const tL=t=>Array.isArray(t);function kit(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,sb(r))}function _it(t){return tL(t)?t[t.length-1]||0:t}function Sit(t,e){const r=_y(t,e);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const o in a){const l=_it(a[o]);kit(t,o,l)}}const ul=t=>!!(t&&t.getVelocity);function Cit(t){return!!(ul(t)&&t.add)}function rL(t,e){const r=t.getValue("willChange");if(Cit(r))return r.add(e);if(!r&&Of.WillChange){const n=new Of.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function Q7(t){return t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const Eit="framerAppearId",Ihe="data-"+Q7(Eit);function Phe(t){return t.props[Ihe]}function Ait({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function Lhe(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...l}=e;const c=a?.reduceMotion;n&&(a=n);const u=[],h=s&&t.animationState&&t.animationState.getState()[s];for(const f in l){const m=t.getValue(f,t.latestValues[f]??null),g=l[f];if(g===void 0||h&&Ait(h,f))continue;const y={delay:r,...K7(a||{},f)},v=m.get();if(v!==void 0&&!m.isAnimating&&!Array.isArray(g)&&g===v&&!y.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const C=Phe(t);if(C){const I=window.MotionHandoffAnimation(C,f,di);I!==null&&(y.startTime=I,w=!0)}}rL(t,f);const N=c??t.shouldReduceMotion;m.start(Y7(f,m,g,N&&The.has(f)?{type:!1}:y,t,w));const k=m.animation;k&&u.push(k)}return o&&Promise.all(u).then(()=>{di.update(()=>{o&&Sit(t,o)})}),u}function nL(t,e,r={}){const n=_y(t,e,r.type==="exit"?t.presenceContext?.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(Lhe(t,n,r)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return Tit(t,e,c,u,h,f,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>u())}else return Promise.all([a(),o(r.delay)])}function Tit(t,e,r=0,n=0,s=0,a=1,o){const l=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),l.push(nL(c,e,{...o,delay:r+(typeof n=="function"?0:n)+Ehe(t.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(l)}function Iit(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(a=>nL(t,a,r));n=Promise.all(s)}else if(typeof e=="string")n=nL(t,e,r);else{const s=typeof e=="function"?_y(t,e,r.custom):e;n=Promise.all(Lhe(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}const Pit={test:t=>t==="auto",parse:t=>t},Ohe=t=>e=>e.test(t),Mhe=[Pb,gr,lh,P0,ist,sst,Pit],DX=t=>Mhe.find(Ohe(t));function Lit(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Qde(t):!0}const Oit=new Set(["brightness","contrast","saturate","opacity"]);function Mit(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match($7)||[];if(!n)return t;const s=r.replace(n,"");let a=Oit.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+s+")"}const Rit=/\b([a-z-]*)\(.*?\)/gu,sL={...bp,getAnimatableNone:t=>{const e=t.match(Rit);return e?e.map(Mit).join(" "):t}},BX={...Pb,transform:Math.round},Dit={rotate:P0,rotateX:P0,rotateY:P0,rotateZ:P0,scale:ej,scaleX:ej,scaleY:ej,scaleZ:ej,skew:P0,skewX:P0,skewY:P0,distance:gr,translateX:gr,translateY:gr,translateZ:gr,x:gr,y:gr,z:gr,perspective:gr,transformPerspective:gr,opacity:V2,originX:kX,originY:kX,originZ:gr},J7={borderWidth:gr,borderTopWidth:gr,borderRightWidth:gr,borderBottomWidth:gr,borderLeftWidth:gr,borderRadius:gr,borderTopLeftRadius:gr,borderTopRightRadius:gr,borderBottomRightRadius:gr,borderBottomLeftRadius:gr,width:gr,maxWidth:gr,height:gr,maxHeight:gr,top:gr,right:gr,bottom:gr,left:gr,inset:gr,insetBlock:gr,insetBlockStart:gr,insetBlockEnd:gr,insetInline:gr,insetInlineStart:gr,insetInlineEnd:gr,padding:gr,paddingTop:gr,paddingRight:gr,paddingBottom:gr,paddingLeft:gr,paddingBlock:gr,paddingBlockStart:gr,paddingBlockEnd:gr,paddingInline:gr,paddingInlineStart:gr,paddingInlineEnd:gr,margin:gr,marginTop:gr,marginRight:gr,marginBottom:gr,marginLeft:gr,marginBlock:gr,marginBlockStart:gr,marginBlockEnd:gr,marginInline:gr,marginInlineStart:gr,marginInlineEnd:gr,fontSize:gr,backgroundPositionX:gr,backgroundPositionY:gr,...Dit,zIndex:BX,fillOpacity:V2,strokeOpacity:V2,numOctaves:BX},Bit={...J7,color:ba,backgroundColor:ba,outlineColor:ba,fill:ba,stroke:ba,borderColor:ba,borderTopColor:ba,borderRightColor:ba,borderBottomColor:ba,borderLeftColor:ba,filter:sL,WebkitFilter:sL},Rhe=t=>Bit[t];function Dhe(t,e){let r=Rhe(t);return r!==sL&&(r=bp),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const Fit=new Set(["auto","none","0"]);function $it(t,e,r){let n=0,s;for(;n<t.length&&!s;){const a=t[n];typeof a=="string"&&!Fit.has(a)&&q2(a).values.length&&(s=t[n]),n++}if(s&&r)for(const a of e)t[a]=Dhe(r,s)}class Uit extends G7{constructor(e,r,n,s,a){super(e,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let f=e[h];if(typeof f=="string"&&(f=f.trim(),F7(f))){const m=Ahe(f,r.current);m!==void 0&&(e[h]=m),h===e.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!The.has(n)||e.length!==2)return;const[s,a]=e,o=DX(s),l=DX(a),c=jX(s),u=jX(a);if(c!==u&&X0[n]){this.needsMeasurement=!0;return}if(o!==l)if(PX(o)&&PX(l))for(let h=0;h<e.length;h++){const f=e[h];typeof f=="string"&&(e[h]=parseFloat(f))}else X0[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||Lit(e[s]))&&n.push(s);n.length&&$it(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=X0[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,o=n[a];n[a]=X0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function zit(t,e,r){if(t==null)return[];if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=r?.[t]??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t).filter(n=>n!=null)}const Bhe=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function iL(t){return Xde(t)&&"offsetHeight"in t}const{schedule:Z7}=che(queueMicrotask,!1),Hu={x:!1,y:!1};function Fhe(){return Hu.x||Hu.y}function Vit(t){return t==="x"||t==="y"?Hu[t]?null:(Hu[t]=!0,()=>{Hu[t]=!1}):Hu.x||Hu.y?null:(Hu.x=Hu.y=!0,()=>{Hu.x=Hu.y=!1})}function $he(t,e){const r=zit(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function FX(t){return!(t.pointerType==="touch"||Fhe())}function qit(t,e,r={}){const[n,s,a]=$he(t,r),o=l=>{if(!FX(l))return;const{target:c}=l,u=e(c,l);if(typeof u!="function"||!c)return;const h=f=>{FX(f)&&(u(f),c.removeEventListener("pointerleave",h))};c.addEventListener("pointerleave",h,s)};return n.forEach(l=>{l.addEventListener("pointerenter",o,s)}),a}const Uhe=(t,e)=>e?t===e?!0:Uhe(t,e.parentElement):!1,eD=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Hit=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function zhe(t){return Hit.has(t.tagName)||t.isContentEditable===!0}const Xj=new WeakSet;function $X(t){return e=>{e.key==="Enter"&&t(e)}}function jT(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Wit=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=$X(()=>{if(Xj.has(r))return;jT(r,"down");const s=$X(()=>{jT(r,"up")}),a=()=>jT(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function UX(t){return eD(t)&&!Fhe()}function Git(t,e,r={}){const[n,s,a]=$he(t,r),o=l=>{const c=l.currentTarget;if(!UX(l))return;Xj.add(c);const u=e(c,l),h=(g,y)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),Xj.has(c)&&Xj.delete(c),UX(g)&&typeof u=="function"&&u(g,{success:y})},f=g=>{h(g,c===window||c===document||r.useGlobalTarget||Uhe(c,g.target))},m=g=>{h(g,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",m,s)};return n.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",o,s),iL(l)&&(l.addEventListener("focus",u=>Wit(u,s)),!zhe(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function Vhe(t){return Xde(t)&&"ownerSVGElement"in t}function Kit(t){return Vhe(t)&&t.tagName==="svg"}const Yit=[...Mhe,ba,bp],Xit=t=>Yit.find(Ohe(t)),zX=()=>({translate:0,scale:1,origin:0,originPoint:0}),ey=()=>({x:zX(),y:zX()}),VX=()=>({min:0,max:0}),$a=()=>({x:VX(),y:VX()}),aL={current:null},qhe={current:!1},Qit=typeof window<"u";function Jit(){if(qhe.current=!0,!!Qit)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>aL.current=t.matches;t.addEventListener("change",e),e()}else aL.current=!1}const Zit=new WeakMap;function g3(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function H2(t){return typeof t=="string"||Array.isArray(t)}const tD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],rD=["initial",...tD];function x3(t){return g3(t.animate)||rD.some(e=>H2(t[e]))}function Hhe(t){return!!(x3(t)||t.variants)}function eat(t,e,r){for(const n in e){const s=e[n],a=r[n];if(ul(s))t.addValue(n,s);else if(ul(a))t.addValue(n,sb(s,{owner:t}));else if(a!==s)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(n);t.addValue(n,sb(o!==void 0?o:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const qX=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Zk={};function Whe(t){Zk=t}function tat(){return Zk}class rat{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=G7,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=_l.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,di.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=x3(r),this.isVariantNode=Hhe(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in f){const g=f[m];c[m]!==void 0&&ul(g)&&g.set(c[m])}}mount(e){this.current=e,Zit.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(qhe.current||Jit(),this.shouldReduceMotion=aL.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),yp(this.notifyUpdate),yp(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Ob.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&di.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;typeof window<"u"&&window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Zk){const r=Zk[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$a()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<qX.length;n++){const s=qX[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,o=e[a];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=eat(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=sb(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(Yde(n)||Qde(n))?n=parseFloat(n):!Xit(n)&&bp.test(r)&&(n=Dhe(e,r)),this.setBaseTarget(e,ul(n)?n.get():n)),ul(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=X7(this.props,r,this.presenceContext?.custom);a&&(n=a[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ul(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new R7),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){Z7.render(this.render)}}class Ghe extends rat{constructor(){super(...arguments),this.KeyframeResolver=Uit}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){const n=e.style;return n?n[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ul(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class Ip{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Khe({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function nat({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function sat(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function kT(t){return t===void 0||t===1}function oL({scale:t,scaleX:e,scaleY:r}){return!kT(t)||!kT(e)||!kT(r)}function om(t){return oL(t)||Yhe(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Yhe(t){return HX(t.x)||HX(t.y)}function HX(t){return t&&t!=="0%"}function e_(t,e,r){const n=t-r,s=e*n;return r+s}function WX(t,e,r,n,s){return s!==void 0&&(t=e_(t,s,n)),e_(t,r,n)+e}function lL(t,e=0,r=1,n,s){t.min=WX(t.min,e,r,n,s),t.max=WX(t.max,e,r,n,s)}function Xhe(t,{x:e,y:r}){lL(t.x,e.translate,e.scale,e.originPoint),lL(t.y,r.translate,r.scale,r.originPoint)}const GX=.999999999999,KX=1.0000000000001;function iat(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let a,o;for(let l=0;l<s;l++){a=r[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&ry(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Xhe(t,o)),n&&om(a.latestValues)&&ry(t,a.latestValues))}e.x<KX&&e.x>GX&&(e.x=1),e.y<KX&&e.y>GX&&(e.y=1)}function ty(t,e){t.min=t.min+e,t.max=t.max+e}function YX(t,e,r,n,s=.5){const a=Ri(t.min,t.max,s);lL(t,e,r,a,n)}function ry(t,e){YX(t.x,e.x,e.scaleX,e.scale,e.originX),YX(t.y,e.y,e.scaleY,e.scale,e.originY)}function Qhe(t,e){return Khe(sat(t.getBoundingClientRect(),e))}function aat(t,e,r){const n=Qhe(t,r),{scroll:s}=e;return s&&(ty(n.x,s.offset.x),ty(n.y,s.offset.y)),n}const oat={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lat=Lb.length;function cat(t,e,r){let n="",s=!0;for(let a=0;a<lat;a++){const o=Lb[a],l=t[o];if(l===void 0)continue;let c=!0;if(typeof l=="number")c=l===(o.startsWith("scale")?1:0);else{const u=parseFloat(l);c=o.startsWith("scale")?u===1:u===0}if(!c||r){const u=Bhe(l,J7[o]);if(!c){s=!1;const h=oat[o]||o;n+=`${h}(${u}) `}r&&(e[o]=u)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function nD(t,e,r){const{style:n,vars:s,transformOrigin:a}=t;let o=!1,l=!1;for(const c in e){const u=e[c];if(Ob.has(c)){o=!0;continue}else if(dhe(c)){s[c]=u;continue}else{const h=Bhe(u,J7[c]);c.startsWith("origin")?(l=!0,a[c]=h):n[c]=h}}if(e.transform||(o||r?n.transform=cat(e,t.transform,r):n.transform&&(n.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:h=0}=a;n.transformOrigin=`${c} ${u} ${h}`}}function Jhe(t,{style:e,vars:r},n,s){const a=t.style;let o;for(o in e)a[o]=e[o];s?.applyProjectionStyles(a,n);for(o in r)a.setProperty(o,r[o])}function XX(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Wv={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(gr.test(t))t=parseFloat(t);else return t;const r=XX(t,e.target.x),n=XX(t,e.target.y);return`${r}% ${n}%`}},uat={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=bp.parse(t);if(s.length>5)return n;const a=bp.createTransformer(t),o=typeof s[0]!="number"?1:0,l=r.x.scale*e.x,c=r.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=Ri(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),a(s)}},cL={borderRadius:{...Wv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wv,borderTopRightRadius:Wv,borderBottomLeftRadius:Wv,borderBottomRightRadius:Wv,boxShadow:uat};function Zhe(t,{layout:e,layoutId:r}){return Ob.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!cL[t]||t==="opacity")}function sD(t,e,r){const n=t.style,s=e?.style,a={};if(!n)return a;for(const o in n)(ul(n[o])||s&&ul(s[o])||Zhe(o,t)||r?.getValue(o)?.liveStyle!==void 0)&&(a[o]=n[o]);return a}function dat(t){return window.getComputedStyle(t)}class hat extends Ghe{constructor(){super(...arguments),this.type="html",this.renderInstance=Jhe}readValueFromInstance(e,r){if(Ob.has(r))return this.projection?.isProjecting?YP(r):zst(e,r);{const n=dat(e),s=(dhe(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:r}){return Qhe(e,r)}build(e,r,n){nD(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return sD(e,r,n)}}const fat={offset:"stroke-dashoffset",array:"stroke-dasharray"},pat={offset:"strokeDashoffset",array:"strokeDasharray"};function mat(t,e,r=1,n=0,s=!0){t.pathLength=1;const a=s?fat:pat;t[a.offset]=`${-n}`,t[a.array]=`${e} ${r}`}const gat=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function efe(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:o=0,...l},c,u,h){if(nD(t,l,u),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:m}=t;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete f.transformBox);for(const g of gat)f[g]!==void 0&&(m[g]=f[g],delete f[g]);e!==void 0&&(f.x=e),r!==void 0&&(f.y=r),n!==void 0&&(f.scale=n),s!==void 0&&mat(f,s,a,o,!1)}const tfe=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),rfe=t=>typeof t=="string"&&t.toLowerCase()==="svg";function xat(t,e,r,n){Jhe(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(tfe.has(s)?s:Q7(s),e.attrs[s])}function nfe(t,e,r){const n=sD(t,e,r);for(const s in t)if(ul(t[s])||ul(e[s])){const a=Lb.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=t[s]}return n}class yat extends Ghe{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$a}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(Ob.has(r)){const n=Rhe(r);return n&&n.default||0}return r=tfe.has(r)?r:Q7(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return nfe(e,r,n)}build(e,r,n){efe(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){xat(e,r,n,s)}mount(e){this.isSVGTag=rfe(e.tagName),super.mount(e)}}const bat=rD.length;function sfe(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?sfe(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<bat;r++){const n=rD[r],s=t.props[n];(H2(s)||s===!1)&&(e[n]=s)}return e}function ife(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const vat=[...tD].reverse(),wat=tD.length;function Nat(t){return e=>Promise.all(e.map(({animation:r,options:n})=>Iit(t,r,n)))}function jat(t){let e=Nat(t),r=QX(),n=!0;const s=c=>(u,h)=>{const f=_y(t,h,c==="exit"?t.presenceContext?.custom:void 0);if(f){const{transition:m,transitionEnd:g,...y}=f;u={...u,...y,...g}}return u};function a(c){e=c(t)}function o(c){const{props:u}=t,h=sfe(t.parent)||{},f=[],m=new Set;let g={},y=1/0;for(let w=0;w<wat;w++){const N=vat[w],k=r[N],C=u[N]!==void 0?u[N]:h[N],I=H2(C),O=N===c?k.isActive:null;O===!1&&(y=w);let L=C===h[N]&&C!==u[N]&&I;if(L&&n&&t.manuallyAnimateOnMount&&(L=!1),k.protectedKeys={...g},!k.isActive&&O===null||!C&&!k.prevProp||g3(C)||typeof C=="boolean")continue;const _=kat(k.prevProp,C);let E=_||N===c&&k.isActive&&!L&&I||w>y&&I,M=!1;const B=Array.isArray(C)?C:[C];let S=B.reduce(s(N),{});O===!1&&(S={});const{prevResolvedValues:P={}}=k,R={...P,...S},V=J=>{E=!0,m.has(J)&&(M=!0,m.delete(J)),k.needsAnimating[J]=!0;const Z=t.getValue(J);Z&&(Z.liveStyle=!1)};for(const J in R){const Z=S[J],se=P[J];if(g.hasOwnProperty(J))continue;let X=!1;tL(Z)&&tL(se)?X=!ife(Z,se):X=Z!==se,X?Z!=null?V(J):m.add(J):Z!==void 0&&m.has(J)?V(J):k.protectedKeys[J]=!0}k.prevProp=C,k.prevResolvedValues=S,k.isActive&&(g={...g,...S}),n&&t.blockInitialAnimation&&(E=!1);const ee=L&&_;E&&(!ee||M)&&f.push(...B.map(J=>{const Z={type:N};if(typeof J=="string"&&n&&!ee&&t.manuallyAnimateOnMount&&t.parent){const{parent:se}=t,X=_y(se,J);if(se.enteringChildren&&X){const{delayChildren:q}=X.transition||{};Z.delay=Ehe(se.enteringChildren,t,q)}}return{animation:J,options:Z}}))}if(m.size){const w={};if(typeof u.initial!="boolean"){const N=_y(t,Array.isArray(u.initial)?u.initial[0]:u.initial);N&&N.transition&&(w.transition=N.transition)}m.forEach(N=>{const k=t.getBaseTarget(N),C=t.getValue(N);C&&(C.liveStyle=!0),w[N]=k??null}),f.push({animation:w})}let v=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(f):Promise.resolve()}function l(c,u){if(r[c].isActive===u)return Promise.resolve();t.variantChildren?.forEach(f=>f.animationState?.setActive(c,u)),r[c].isActive=u;const h=o(c);for(const f in r)r[f].protectedKeys={};return h}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=QX()}}}function kat(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!ife(e,t):!1}function Qp(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function QX(){return{animate:Qp(!0),whileInView:Qp(),whileHover:Qp(),whileTap:Qp(),whileDrag:Qp(),whileFocus:Qp(),exit:Qp()}}function JX(t,e){t.min=e.min,t.max=e.max}function qu(t,e){JX(t.x,e.x),JX(t.y,e.y)}function ZX(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}const afe=1e-4,_at=1-afe,Sat=1+afe,ofe=.01,Cat=0-ofe,Eat=0+ofe;function Sl(t){return t.max-t.min}function Aat(t,e,r){return Math.abs(t-e)<=r}function eQ(t,e,r,n=.5){t.origin=n,t.originPoint=Ri(e.min,e.max,t.origin),t.scale=Sl(r)/Sl(e),t.translate=Ri(r.min,r.max,t.origin)-t.originPoint,(t.scale>=_at&&t.scale<=Sat||isNaN(t.scale))&&(t.scale=1),(t.translate>=Cat&&t.translate<=Eat||isNaN(t.translate))&&(t.translate=0)}function U1(t,e,r,n){eQ(t.x,e.x,r.x,n?n.originX:void 0),eQ(t.y,e.y,r.y,n?n.originY:void 0)}function tQ(t,e,r){t.min=r.min+e.min,t.max=t.min+Sl(e)}function Tat(t,e,r){tQ(t.x,e.x,r.x),tQ(t.y,e.y,r.y)}function rQ(t,e,r){t.min=e.min-r.min,t.max=t.min+Sl(e)}function t_(t,e,r){rQ(t.x,e.x,r.x),rQ(t.y,e.y,r.y)}function nQ(t,e,r,n,s){return t-=e,t=e_(t,1/r,n),s!==void 0&&(t=e_(t,1/s,n)),t}function Iat(t,e=0,r=1,n=.5,s,a=t,o=t){if(lh.test(e)&&(e=parseFloat(e),e=Ri(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Ri(a.min,a.max,n);t===a&&(l-=e),t.min=nQ(t.min,e,r,l,s),t.max=nQ(t.max,e,r,l,s)}function sQ(t,e,[r,n,s],a,o){Iat(t,e[r],e[n],e[s],e.scale,a,o)}const Pat=["x","scaleX","originX"],Lat=["y","scaleY","originY"];function iQ(t,e,r,n){sQ(t.x,e,Pat,r?r.x:void 0,n?n.x:void 0),sQ(t.y,e,Lat,r?r.y:void 0,n?n.y:void 0)}function aQ(t){return t.translate===0&&t.scale===1}function lfe(t){return aQ(t.x)&&aQ(t.y)}function oQ(t,e){return t.min===e.min&&t.max===e.max}function Oat(t,e){return oQ(t.x,e.x)&&oQ(t.y,e.y)}function lQ(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function cfe(t,e){return lQ(t.x,e.x)&&lQ(t.y,e.y)}function cQ(t){return Sl(t.x)/Sl(t.y)}function uQ(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}function iu(t){return[t("x"),t("y")]}function Mat(t,e,r){let n="";const s=t.x.translate/e.x,a=t.y.translate/e.y,o=r?.z||0;if((s||a||o)&&(n=`translate3d(${s}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:m,skewX:g,skewY:y}=r;u&&(n=`perspective(${u}px) ${n}`),h&&(n+=`rotate(${h}deg) `),f&&(n+=`rotateX(${f}deg) `),m&&(n+=`rotateY(${m}deg) `),g&&(n+=`skewX(${g}deg) `),y&&(n+=`skewY(${y}deg) `)}const l=t.x.scale*e.x,c=t.y.scale*e.y;return(l!==1||c!==1)&&(n+=`scale(${l}, ${c})`),n||"none"}const ufe=["TopLeft","TopRight","BottomLeft","BottomRight"],Rat=ufe.length,dQ=t=>typeof t=="string"?parseFloat(t):t,hQ=t=>typeof t=="number"||gr.test(t);function Dat(t,e,r,n,s,a){s?(t.opacity=Ri(0,r.opacity??1,Bat(n)),t.opacityExit=Ri(e.opacity??1,0,Fat(n))):a&&(t.opacity=Ri(e.opacity??1,r.opacity??1,n));for(let o=0;o<Rat;o++){const l=`border${ufe[o]}Radius`;let c=fQ(e,l),u=fQ(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||hQ(c)===hQ(u)?(t[l]=Math.max(Ri(dQ(c),dQ(u),n),0),(lh.test(u)||lh.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||r.rotate)&&(t.rotate=Ri(e.rotate||0,r.rotate||0,n))}function fQ(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Bat=dfe(0,.5,ihe),Fat=dfe(.5,.95,gu);function dfe(t,e,r){return n=>n<t?0:n>e?1:r(z2(t,e,n))}function $at(t,e,r){const n=ul(t)?t:sb(t);return n.start(Y7("",n,e,r)),n.animation}function W2(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}const Uat=(t,e)=>t.depth-e.depth;class zat{constructor(){this.children=[],this.isDirty=!1}add(e){P7(this.children,e),this.isDirty=!0}remove(e){L7(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Uat),this.isDirty=!1,this.children.forEach(e)}}function Vat(t,e){const r=_l.now(),n=({timestamp:s})=>{const a=s-r;a>=e&&(yp(n),t(a-e))};return di.setup(n,!0),()=>yp(n)}function Qj(t){return ul(t)?t.get():t}class qat{constructor(){this.members=[]}add(e){P7(this.members,e),e.scheduleRender()}remove(e){if(L7(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender();const s=n.options.layoutDependency,a=e.options.layoutDependency;s!==void 0&&a!==void 0&&s===a||(e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));const{crossfade:l}=e.options;l===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Jj={hasAnimatedSinceResize:!0,hasEverUpdated:!1},_T=["","X","Y","Z"],Hat=1e3;let Wat=0;function ST(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function hfe(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=Phe(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",di,!(s||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&hfe(n)}function ffe({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=e?.()){this.id=Wat++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Yat),this.nodes.forEach(Zat),this.nodes.forEach(eot),this.nodes.forEach(Xat)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new zat)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new R7),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Vhe(o)&&!Kit(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),t){let h,f=0;const m=()=>this.root.updateBlockedByResize=!1;di.read(()=>{f=window.innerWidth}),t(o,()=>{const g=window.innerWidth;g!==f&&(f=g,this.root.updateBlockedByResize=!0,h&&h(),h=Vat(m,250),Jj.hasAnimatedSinceResize&&(Jj.hasAnimatedSinceResize=!1,this.nodes.forEach(gQ)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||u.getDefaultTransition()||iot,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),N=!this.targetLayout||!cfe(this.targetLayout,g),k=!f&&m;if(this.options.layoutRoot||this.resumeFrom||k||f&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const C={...K7(y,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C),this.setAnimationOrigin(h,k)}else f||gQ(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),yp(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tot),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&hfe(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pQ);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(mQ);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Jat),this.nodes.forEach(Gat),this.nodes.forEach(Kat)):this.nodes.forEach(mQ),this.clearAllSnapshots();const l=_l.now();Bo.delta=yh(0,1e3/60,l-Bo.timestamp),Bo.timestamp=l,Bo.isProcessing=!0,xT.update.process(Bo),xT.preRender.process(Bo),xT.render.process(Bo),Bo.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Z7.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Qat),this.sharedNodes.forEach(rot)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,di.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){di.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Sl(this.snapshot.measuredBox.x)&&!Sl(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=$a(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!lfe(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&this.instance&&(l||om(this.latestValues)||h)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),aot(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return $a();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(oot))){const{scroll:u}=this.root;u&&(ty(l.x,u.offset.x),ty(l.y,u.offset.y))}return l}removeElementScroll(o){const l=$a();if(qu(l,o),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&qu(l,o),ty(l.x,h.offset.x),ty(l.y,h.offset.y))}return l}applyTransform(o,l=!1){const c=$a();qu(c,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!l&&h.options.layoutScroll&&h.scroll&&h!==h.root&&ry(c,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),om(h.latestValues)&&ry(c,h.latestValues)}return om(this.latestValues)&&ry(c,this.latestValues),c}removeTransform(o){const l=$a();qu(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!om(u.latestValues))continue;oL(u.latestValues)&&u.updateSnapshot();const h=$a(),f=u.measurePageBox();qu(h,f),iQ(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return om(this.latestValues)&&iQ(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bo.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!this.layout||!(h||f))return;this.resolvedRelativeTargetAt=Bo.timestamp;const m=this.getClosestProjectingParent();m&&this.linkedParentVersion!==m.layoutVersion&&!m.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(m&&m.layout?this.createRelativeTarget(m,this.layout.layoutBox,m.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=$a(),this.targetWithTransforms=$a()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Tat(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):qu(this.target,this.layout.layoutBox),Xhe(this.target,this.targetDelta)):qu(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?this.createRelativeTarget(m,this.target,m.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||oL(this.parent.latestValues)||Yhe(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$a(),this.relativeTargetOrigin=$a(),t_(this.relativeTargetOrigin,l,c),qu(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Bo.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;qu(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;iat(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=$a());const{target:g}=o;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ZX(this.prevProjectionDelta.x,this.projectionDelta.x),ZX(this.prevProjectionDelta.y,this.projectionDelta.y)),U1(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!uQ(this.projectionDelta.x,this.prevProjectionDelta.x)||!uQ(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ey(),this.projectionDelta=ey(),this.projectionDeltaWithTransform=ey()}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},h={...this.latestValues},f=ey();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=$a(),g=c?c.source:void 0,y=this.layout?this.layout.source:void 0,v=g!==y,w=this.getStack(),N=!w||w.members.length<=1,k=!!(v&&!N&&this.options.crossfade===!0&&!this.path.some(sot));this.animationProgress=0;let C;this.mixTargetDelta=I=>{const O=I/1e3;xQ(f.x,o.x,O),xQ(f.y,o.y,O),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(t_(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),not(this.relativeTarget,this.relativeTargetOrigin,m,O),C&&Oat(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=$a()),qu(C,this.relativeTarget)),v&&(this.animationValues=h,Dat(h,u,this.latestValues,O,k,N)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(yp(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=di.update(()=>{Jj.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=sb(0)),this.currentAnimation=$at(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Hat),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:h}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&pfe(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||$a();const f=Sl(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+f;const m=Sl(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}qu(l,c),ry(l,h),U1(this.projectionDeltaWithTransform,this.layoutCorrected,l,h)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new qat),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&ST("z",o,u,this.animationValues);for(let h=0;h<_T.length;h++)ST(`rotate${_T[h]}`,o,u,this.animationValues),ST(`skew${_T[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Qj(l?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Qj(l?.pointerEvents)||""),this.hasProjected&&!om(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=Mat(this.projectionDeltaWithTransform,this.treeScale,h);c&&(f=c(h,f)),o.transform=f;const{x:m,y:g}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,u.animationValues?o.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const y in cL){if(h[y]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:N}=cL[y],k=f==="none"?h[y]:v(h[y],u);if(w){const C=w.length;for(let I=0;I<C;I++)o[w[I]]=k}else N?this.options.visualElement.renderState.vars[y]=k:o[y]=k}this.options.layoutId&&(o.pointerEvents=u===this?Qj(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(pQ),this.root.sharedNodes.clear()}}}function Gat(t){t.updateLayout()}function Kat(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=t.layout,{animationType:s}=t.options,a=e.source!==t.layout.source;s==="size"?iu(h=>{const f=a?e.measuredBox[h]:e.layoutBox[h],m=Sl(f);f.min=r[h].min,f.max=f.min+m}):pfe(s,e.layoutBox,r)&&iu(h=>{const f=a?e.measuredBox[h]:e.layoutBox[h],m=Sl(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const o=ey();U1(o,r,e.layoutBox);const l=ey();a?U1(l,t.applyTransform(n,!0),e.measuredBox):U1(l,r,e.layoutBox);const c=!lfe(o);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=$a();t_(g,e.layoutBox,f.layoutBox);const y=$a();t_(y,r,m.layoutBox),cfe(g,y)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=y,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Yat(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Xat(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Qat(t){t.clearSnapshot()}function pQ(t){t.clearMeasurements()}function mQ(t){t.isLayoutDirty=!1}function Jat(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function gQ(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Zat(t){t.resolveTargetDelta()}function eot(t){t.calcProjection()}function tot(t){t.resetSkewAndRotation()}function rot(t){t.removeLeadSnapshot()}function xQ(t,e,r){t.translate=Ri(e.translate,0,r),t.scale=Ri(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function yQ(t,e,r,n){t.min=Ri(e.min,r.min,n),t.max=Ri(e.max,r.max,n)}function not(t,e,r,n){yQ(t.x,e.x,r.x,n),yQ(t.y,e.y,r.y,n)}function sot(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const iot={duration:.45,ease:[.4,0,.1,1]},bQ=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),vQ=bQ("applewebkit/")&&!bQ("chrome/")?Math.round:gu;function wQ(t){t.min=vQ(t.min),t.max=vQ(t.max)}function aot(t){wQ(t.x),wQ(t.y)}function pfe(t,e,r){return t==="position"||t==="preserve-aspect"&&!Aat(cQ(e),cQ(r),.2)}function oot(t){return t!==t.root&&t.scroll?.wasRoot}const lot=ffe({attachResizeListener:(t,e)=>W2(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),CT={current:void 0},mfe=ffe({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!CT.current){const t=new lot({});t.mount(window),t.setOptions({layoutScroll:!0}),CT.current=t}return CT.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),iD=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function NQ(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function cot(...t){return e=>{let r=!1;const n=t.map(s=>{const a=NQ(s,e);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():NQ(t[s],null)}}}}function uot(...t){return b.useCallback(cot(...t),t)}class dot extends b.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=iL(n)&&n.offsetWidth||0,a=iL(n)&&n.offsetHeight||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=s-o.width-o.left,o.bottom=a-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function hot({children:t,isPresent:e,anchorX:r,anchorY:n,root:s}){const a=b.useId(),o=b.useRef(null),l=b.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:c}=b.useContext(iD),u=t.props?.ref??t?.ref,h=uot(o,u);return b.useInsertionEffect(()=>{const{width:f,height:m,top:g,left:y,right:v,bottom:w}=l.current;if(e||!o.current||!f||!m)return;const N=r==="left"?`left: ${y}`:`right: ${v}`,k=n==="bottom"?`bottom: ${w}`:`top: ${g}`;o.current.dataset.motionPopId=a;const C=document.createElement("style");c&&(C.nonce=c);const I=s??document.head;return I.appendChild(C),C.sheet&&C.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${m}px !important;
            ${N}px !important;
            ${k}px !important;
          }
        `),()=>{I.contains(C)&&I.removeChild(C)}},[e]),i.jsx(dot,{isPresent:e,childRef:o,sizeRef:l,children:b.cloneElement(t,{ref:h})})}const fot=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:o,anchorX:l,anchorY:c,root:u})=>{const h=I7(pot),f=b.useId();let m=!0,g=b.useMemo(()=>(m=!1,{id:f,initial:e,isPresent:r,custom:s,onExitComplete:y=>{h.set(y,!0);for(const v of h.values())if(!v)return;n&&n()},register:y=>(h.set(y,!1),()=>h.delete(y))}),[r,h,n]);return a&&m&&(g={...g}),b.useMemo(()=>{h.forEach((y,v)=>h.set(v,!1))},[r]),b.useEffect(()=>{!r&&!h.size&&n&&n()},[r]),o==="popLayout"&&(t=i.jsx(hot,{isPresent:r,anchorX:l,anchorY:c,root:u,children:t})),i.jsx(m3.Provider,{value:g,children:t})};function pot(){return new Map}function gfe(t=!0){const e=b.useContext(m3);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,a=b.useId();b.useEffect(()=>{if(t)return s(a)},[t]);const o=b.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,o]:[!0]}const tj=t=>t.key||"";function jQ(t){const e=[];return b.Children.forEach(t,r=>{b.isValidElement(r)&&e.push(r)}),e}const mot=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",anchorY:c="top",root:u})=>{const[h,f]=gfe(o),m=b.useMemo(()=>jQ(t),[t]),g=o&&!h?[]:m.map(tj),y=b.useRef(!0),v=b.useRef(m),w=I7(()=>new Map),N=b.useRef(new Set),[k,C]=b.useState(m),[I,O]=b.useState(m);Kde(()=>{y.current=!1,v.current=m;for(let E=0;E<I.length;E++){const M=tj(I[E]);g.includes(M)?(w.delete(M),N.current.delete(M)):w.get(M)!==!0&&w.set(M,!1)}},[I,g.length,g.join("-")]);const L=[];if(m!==k){let E=[...m];for(let M=0;M<I.length;M++){const B=I[M],S=tj(B);g.includes(S)||(E.splice(M,0,B),L.push(B))}return a==="wait"&&L.length&&(E=L),O(jQ(E)),C(m),null}const{forceRender:_}=b.useContext(T7);return i.jsx(i.Fragment,{children:I.map(E=>{const M=tj(E),B=o&&!h?!1:m===I||g.includes(M),S=()=>{if(N.current.has(M))return;if(N.current.add(M),w.has(M))w.set(M,!0);else return;let P=!0;w.forEach(R=>{R||(P=!1)}),P&&(_?.(),O(v.current),o&&f?.(),n&&n())};return i.jsx(fot,{isPresent:B,initial:!y.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:a,root:u,onExitComplete:B?void 0:S,anchorX:l,anchorY:c,children:E},M)})})},xfe=b.createContext({strict:!1}),kQ={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let _Q=!1;function got(){if(_Q)return;const t={};for(const e in kQ)t[e]={isEnabled:r=>kQ[e].some(n=>!!r[n])};Whe(t),_Q=!0}function yfe(){return got(),tat()}function xot(t){const e=yfe();for(const r in t)e[r]={...e[r],...t[r]};Whe(e)}const yot=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function r_(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||yot.has(t)}let bfe=t=>!r_(t);function bot(t){typeof t=="function"&&(bfe=e=>e.startsWith("on")?!r_(e):t(e))}try{bot(require("@emotion/is-prop-valid").default)}catch{}function vot(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(bfe(s)||r===!0&&r_(s)||!e&&!r_(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const y3=b.createContext({});function wot(t,e){if(x3(t)){const{initial:r,animate:n}=t;return{initial:r===!1||H2(r)?r:void 0,animate:H2(n)?n:void 0}}return t.inherit!==!1?e:{}}function Not(t){const{initial:e,animate:r}=wot(t,b.useContext(y3));return b.useMemo(()=>({initial:e,animate:r}),[SQ(e),SQ(r)])}function SQ(t){return Array.isArray(t)?t.join(" "):t}const aD=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function vfe(t,e,r){for(const n in e)!ul(e[n])&&!Zhe(n,r)&&(t[n]=e[n])}function jot({transformTemplate:t},e){return b.useMemo(()=>{const r=aD();return nD(r,e,t),Object.assign({},r.vars,r.style)},[e])}function kot(t,e){const r=t.style||{},n={};return vfe(n,r,t),Object.assign(n,jot(t,e)),n}function _ot(t,e){const r={},n=kot(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const wfe=()=>({...aD(),attrs:{}});function Sot(t,e,r,n){const s=b.useMemo(()=>{const a=wfe();return efe(a,e,rfe(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};vfe(a,t.style,t),s.style={...a,...s.style}}return s}const Cot=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function oD(t){return typeof t!="string"||t.includes("-")?!1:!!(Cot.indexOf(t)>-1||/[A-Z]/u.test(t))}function Eot(t,e,r,{latestValues:n},s,a=!1,o){const c=(o??oD(t)?Sot:_ot)(e,n,s,t),u=vot(e,typeof t=="string",a),h=t!==b.Fragment?{...u,...c,ref:r}:{},{children:f}=e,m=b.useMemo(()=>ul(f)?f.get():f,[f]);return b.createElement(t,{...h,children:m})}function Aot({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:Tot(r,n,s,t),renderState:e()}}function Tot(t,e,r,n){const s={},a=n(t,{});for(const m in a)s[m]=Qj(a[m]);let{initial:o,animate:l}=t;const c=x3(t),u=Hhe(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let h=r?r.initial===!1:!1;h=h||o===!1;const f=h?l:o;if(f&&typeof f!="boolean"&&!g3(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const y=X7(t,m[g]);if(y){const{transitionEnd:v,transition:w,...N}=y;for(const k in N){let C=N[k];if(Array.isArray(C)){const I=h?C.length-1:0;C=C[I]}C!==null&&(s[k]=C)}for(const k in v)s[k]=v[k]}}}return s}const Nfe=t=>(e,r)=>{const n=b.useContext(y3),s=b.useContext(m3),a=()=>Aot(t,e,n,s);return r?a():I7(a)},Iot=Nfe({scrapeMotionValuesFromProps:sD,createRenderState:aD}),Pot=Nfe({scrapeMotionValuesFromProps:nfe,createRenderState:wfe}),Lot=Symbol.for("motionComponentSymbol");function Oot(t,e,r){const n=b.useRef(r);b.useInsertionEffect(()=>{n.current=r});const s=b.useRef(null);return b.useCallback(a=>{a&&t.onMount?.(a),e&&(a?e.mount(a):e.unmount());const o=n.current;if(typeof o=="function")if(a){const l=o(a);typeof l=="function"&&(s.current=l)}else s.current?(s.current(),s.current=null):o(a);else o&&(o.current=a)},[e])}const jfe=b.createContext({});function h1(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Mot(t,e,r,n,s,a){const{visualElement:o}=b.useContext(y3),l=b.useContext(xfe),c=b.useContext(m3),u=b.useContext(iD).reducedMotion,h=b.useRef(null),f=b.useRef(!1);n=n||l.renderer,!h.current&&n&&(h.current=n(t,{visualState:e,parent:o,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u,isSVG:a}),f.current&&h.current&&(h.current.manuallyAnimateOnMount=!0));const m=h.current,g=b.useContext(jfe);m&&!m.projection&&s&&(m.type==="html"||m.type==="svg")&&Rot(h.current,r,s,g);const y=b.useRef(!1);b.useInsertionEffect(()=>{m&&y.current&&m.update(r,c)});const v=r[Ihe],w=b.useRef(!!v&&!window.MotionHandoffIsComplete?.(v)&&window.MotionHasOptimisedAnimation?.(v));return Kde(()=>{f.current=!0,m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),w.current&&m.animationState&&m.animationState.animateChanges())}),b.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(v)}),w.current=!1),m.enteringChildren=void 0)}),m}function Rot(t,e,r,n){const{layoutId:s,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:h}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:kfe(t.parent)),t.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!o||l&&h1(l),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:h,layoutScroll:c,layoutRoot:u})}function kfe(t){if(t)return t.options.allowProjection!==!1?t.projection:kfe(t.parent)}function ET(t,{forwardMotionProps:e=!1,type:r}={},n,s){n&&xot(n);const a=r?r==="svg":oD(t),o=a?Pot:Iot;function l(u,h){let f;const m={...b.useContext(iD),...u,layoutId:Dot(u)},{isStatic:g}=m,y=Not(u),v=o(u,g);if(!g&&Gde){Bot();const w=Fot(m);f=w.MeasureLayout,y.visualElement=Mot(t,v,m,s,w.ProjectionNode,a)}return i.jsxs(y3.Provider,{value:y,children:[f&&y.visualElement?i.jsx(f,{visualElement:y.visualElement,...m}):null,Eot(t,u,Oot(v,y.visualElement,h),v,g,e,a)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const c=b.forwardRef(l);return c[Lot]=t,c}function Dot({layoutId:t}){const e=b.useContext(T7).id;return e&&t!==void 0?e+"-"+t:t}function Bot(t,e){b.useContext(xfe).strict}function Fot(t){const e=yfe(),{drag:r,layout:n}=e;if(!r&&!n)return{};const s={...r,...n};return{MeasureLayout:r?.isEnabled(t)||n?.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function $ot(t,e){if(typeof Proxy>"u")return ET;const r=new Map,n=(a,o)=>ET(a,o,t,e),s=(a,o)=>n(a,o);return new Proxy(s,{get:(a,o)=>o==="create"?n:(r.has(o)||r.set(o,ET(o,void 0,t,e)),r.get(o))})}const Uot=(t,e)=>e.isSVG??oD(t)?new yat(e):new hat(e,{allowProjection:t!==b.Fragment});class zot extends Ip{constructor(e){super(e),e.animationState||(e.animationState=jat(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();g3(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Vot=0;class qot extends Ip{constructor(){super(...arguments),this.id=Vot++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Hot={animation:{Feature:zot},exit:{Feature:qot}};function Gw(t){return{point:{x:t.pageX,y:t.pageY}}}const Wot=t=>e=>eD(e)&&t(e,Gw(e));function z1(t,e,r,n){return W2(t,e,Wot(r),n)}const _fe=({current:t})=>t?t.ownerDocument.defaultView:null,CQ=(t,e)=>Math.abs(t-e);function Got(t,e){const r=CQ(t.x,e.x),n=CQ(t.y,e.y);return Math.sqrt(r**2+n**2)}const EQ=new Set(["auto","scroll"]);class Sfe{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=g=>{this.handleScroll(g.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=TT(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=Got(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!v)return;const{point:w}=g,{timestamp:N}=Bo;this.history.push({...w,timestamp:N});const{onStart:k,onMove:C}=this.handlers;y||(k&&k(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=AT(y,this.transformPagePoint),di.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:v,onSessionEnd:w,resumeAnimation:N}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&N&&N(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=TT(g.type==="pointercancel"?this.lastMoveEventInfo:AT(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,k),w&&w(g,k)},!eD(e))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=s||window;const c=Gw(e),u=AT(c,this.transformPagePoint),{point:h}=u,{timestamp:f}=Bo;this.history=[{...h,timestamp:f}];const{onSessionStart:m}=r;m&&m(e,TT(u,this.history)),this.removeListeners=qw(z1(this.contextWindow,"pointermove",this.handlePointerMove),z1(this.contextWindow,"pointerup",this.handlePointerUp),z1(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(e){let r=e.parentElement;for(;r;){const n=getComputedStyle(r);(EQ.has(n.overflowX)||EQ.has(n.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const r=this.scrollPositions.get(e);if(!r)return;const n=e===window,s=n?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},a={x:s.x-r.x,y:s.y-r.y};a.x===0&&a.y===0||(n?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=a.x,this.lastMoveEventInfo.point.y+=a.y):this.history.length>0&&(this.history[0].x-=a.x,this.history[0].y-=a.y),this.scrollPositions.set(e,s),di.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),yp(this.updatePoint)}}function AT(t,e){return e?{point:e(t.point)}:t}function AQ(t,e){return{x:t.x-e.x,y:t.y-e.y}}function TT({point:t},e){return{point:t,delta:AQ(t,Cfe(e)),offset:AQ(t,Kot(e)),velocity:Yot(e,.1)}}function Kot(t){return t[0]}function Cfe(t){return t[t.length-1]}function Yot(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=Cfe(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>yf(e)));)r--;if(!n)return{x:0,y:0};const a=mu(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const o={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Xot(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Ri(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Ri(r,t,n.max):Math.min(t,r)),t}function TQ(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function Qot(t,{top:e,left:r,bottom:n,right:s}){return{x:TQ(t.x,r,s),y:TQ(t.y,e,n)}}function IQ(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function Jot(t,e){return{x:IQ(t.x,e.x),y:IQ(t.y,e.y)}}function Zot(t,e){let r=.5;const n=Sl(t),s=Sl(e);return s>n?r=z2(e.min,e.max-n,t.min):n>s&&(r=z2(t.min,t.max-s,e.min)),yh(0,1,r)}function elt(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const uL=.35;function tlt(t=uL){return t===!1?t=0:t===!0&&(t=uL),{x:PQ(t,"left","right"),y:PQ(t,"top","bottom")}}function PQ(t,e,r){return{min:LQ(t,e),max:LQ(t,r)}}function LQ(t,e){return typeof t=="number"?t:t[e]||0}const rlt=new WeakMap;class nlt{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$a(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=f=>{r?(this.stopAnimation(),this.snapToCursor(Gw(f).point)):this.pauseAnimation()},o=(f,m)=>{this.stopAnimation();const{drag:g,dragPropagation:y,onDragStart:v}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Vit(g),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),iu(N=>{let k=this.getAxisMotionValue(N).get()||0;if(lh.test(k)){const{projection:C}=this.visualElement;if(C&&C.layout){const I=C.layout.layoutBox[N];I&&(k=Sl(I)*(parseFloat(k)/100))}}this.originPoint[N]=k}),v&&di.postRender(()=>v(f,m)),rL(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},l=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m;const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:v,onDrag:w}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:N}=m;if(y&&this.currentDirection===null){this.currentDirection=slt(N),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",m.point,N),this.updateAxis("y",m.point,N),this.visualElement.render(),w&&w(f,m)},c=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m,this.stop(f,m),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>iu(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new Sfe(e,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:n,contextWindow:_fe(this.visualElement),element:this.visualElement.current})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&di.postRender(()=>l(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!rj(e,s,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=Xot(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;e&&h1(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=Qot(n.layoutBox,e):this.constraints=!1,this.elastic=tlt(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&iu(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=elt(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!h1(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=aat(n,s.root,this.visualElement.getTransformPagePoint());let o=Jot(s.layout.layoutBox,a);if(r){const l=r(nat(o));this.hasMutatedConstraints=!!l,l&&(o=Khe(l))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=iu(h=>{if(!rj(h,r,this.currentDirection))return;let f=c&&c[h]||{};o&&(f={min:0,max:0});const m=s?200:1e6,g=s?40:1e7,y={type:"inertia",velocity:n?e[h]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(h,y)});return Promise.all(u).then(l)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return rL(this.visualElement,e),n.start(Y7(e,n,0,r,this.visualElement,!1))}stopAnimation(){iu(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){iu(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){iu(r=>{const{drag:n}=this.getProps();if(!rj(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r],c=a.get()||0;a.set(e[r]-Ri(o,l,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!h1(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};iu(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();s[o]=Zot({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),iu(o=>{if(!rj(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(Ri(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;rlt.set(this.visualElement,this);const e=this.visualElement.current,r=z1(e,"pointerdown",c=>{const{drag:u,dragListener:h=!0}=this.getProps(),f=c.target,m=f!==e&&zhe(f);u&&h&&!m&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();h1(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),di.read(n);const o=W2(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(iu(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=c[h].translate,f.set(f.get()+c[h].translate))}),this.visualElement.render())}));return()=>{o(),r(),a(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:o=uL,dragMomentum:l=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function rj(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function slt(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class ilt extends Ip{constructor(e){super(e),this.removeGroupControls=gu,this.removeListeners=gu,this.controls=new nlt(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||gu}update(){const{dragControls:e}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};e!==r&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const OQ=t=>(e,r)=>{t&&di.postRender(()=>t(e,r))};class alt extends Ip{constructor(){super(...arguments),this.removePointerDownListener=gu}onPointerDown(e){this.session=new Sfe(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_fe(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:OQ(e),onStart:OQ(r),onMove:n,onEnd:(a,o)=>{delete this.session,s&&di.postRender(()=>s(a,o))}}}mount(){this.removePointerDownListener=z1(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let IT=!1;class olt extends b.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=e;a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),IT&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Jj.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:o}=n;return o&&(o.isPresent=a,e.layoutDependency!==r&&o.setOptions({...o.options,layoutDependency:r}),IT=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||di.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Z7.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;IT=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Efe(t){const[e,r]=gfe(),n=b.useContext(T7);return i.jsx(olt,{...t,layoutGroup:n,switchLayoutGroup:b.useContext(jfe),isPresent:e,safeToRemove:r})}const llt={pan:{Feature:alt},drag:{Feature:ilt,ProjectionNode:mfe,MeasureLayout:Efe}};function MQ(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&di.postRender(()=>a(e,Gw(e)))}class clt extends Ip{mount(){const{current:e}=this.node;e&&(this.unmount=qit(e,(r,n)=>(MQ(this.node,n,"Start"),s=>MQ(this.node,s,"End"))))}unmount(){}}class ult extends Ip{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=qw(W2(this.node.current,"focus",()=>this.onFocus()),W2(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function RQ(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&di.postRender(()=>a(e,Gw(e)))}class dlt extends Ip{mount(){const{current:e}=this.node;e&&(this.unmount=Git(e,(r,n)=>(RQ(this.node,n,"Start"),(s,{success:a})=>RQ(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const dL=new WeakMap,PT=new WeakMap,hlt=t=>{const e=dL.get(t.target);e&&e(t)},flt=t=>{t.forEach(hlt)};function plt({root:t,...e}){const r=t||document;PT.has(r)||PT.set(r,{});const n=PT.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(flt,{root:t,...e})),n[s]}function mlt(t,e,r){const n=plt(e);return dL.set(t,r),n.observe(t),()=>{dL.delete(t),n.unobserve(t)}}const glt={some:0,all:1};class xlt extends Ip{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:glt[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=u?h:f;m&&m(c)};return mlt(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(ylt(e,r))&&this.startObserver()}unmount(){}}function ylt({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const blt={inView:{Feature:xlt},tap:{Feature:dlt},focus:{Feature:ult},hover:{Feature:clt}},vlt={layout:{ProjectionNode:mfe,MeasureLayout:Efe}},wlt={...Hot,...blt,...llt,...vlt},Mo=$ot(wlt,Uot),Nlt=({onDeckAdded:t})=>{const{addToast:e}=Tn(),[r,n]=b.useState(""),[s,a]=b.useState([]),[o,l]=b.useState(!1),[c,u]=b.useState(null),[h,f]=b.useState(!1);b.useEffect(()=>{g("")},[]);const m=async w=>{const N=w.filter(I=>!I.image_uri);if(N.length===0)return;console.log(`[Onboarding] Hydrating art for ${N.length} decks...`);const C=(await Promise.all(N.map(async I=>{try{let O=I.data;const L=P=>{if(!P)return null;const R=G=>Array.isArray(G)?G:[],V=R(P.commander);if(V.length>0)return V[0];const ee=R(P.mainBoard);return ee.length>0?[...ee].sort((J,Z)=>(Z.cmc||0)-(J.cmc||0))[0]:null};let _=L(O);const E=_&&(!_.set&&!_.set_code&&!_.SetCode&&!O?.code||!_.collector_number&&!_.number&&!_.cn&&!_.CollectorNumber);if(!_||E)try{const P=await He.get(`/api/precons/${I.id}`);P&&P.data&&(O=P.data,_=L(O))}catch(P){console.warn(`[Onboarding] Failed to fetch full deck for "${I.name}"`,P)}if(!_)return null;const M=_.set||_.set_code||_.SetCode||O?.code,B=_.collector_number||_.number||_.cn||_.CollectorNumber;if(!M||!B)return console.warn(`[Onboarding] Skipping hydration for "${I.name}": Missing Set/CN on candidate`,_),null;const S=await He.post("/api/cards/search",{set:M,cn:B});if(S.data&&S.data.length>0){const P=S.data[0],R=P.image_uris?.art_crop||P.card_faces?.[0]?.image_uris?.art_crop||P.image_uri||P.image_uris?.large||P.card_faces?.[0]?.image_uris?.large||P.image_uris?.normal;if(R)return{id:I.id,image_uri:R}}else console.warn(`[Onboarding] No art found in DB for ${M} #${B}`)}catch(O){console.warn(`[Onboarding] Failed to hydrate image for "${I.name}"`,O)}return null}))).filter(Boolean);C.length>0&&(console.log(`[Onboarding] Successfully hydrated ${C.length} decks.`),a(I=>I.map(O=>{const L=C.find(_=>_.id===O.id);return L?{...O,image_uri:L.image_uri}:O})))},g=async w=>{l(!0);try{let N;if(!w)N=await He.get("/api/precons");else{const I=`search=${encodeURIComponent(w)}`;N=await He.get(`/api/precons?${I}`)}const k=Array.isArray(N)?N:[],C=w?k:k.filter(I=>I.data?.type==="Commander Deck");a(C),m(C)}catch(N){console.error(N)}finally{l(!1)}},y=async()=>{if(c){f(!0);try{await He.createPreconDeck(c.id,{mode:"collection",useExisting:!0}),e(`Added "${c.name}" to your collection!`,"success"),t(c)}catch(w){console.error(w),e("Failed to add deck. Please try again.","error")}finally{f(!1)}}},v=w=>{if(!w||!w.data)return w?.image_uri||null;const N=O=>Array.isArray(O)?O:[],k=O=>O?O.image_uris?.art_crop?O.image_uris.art_crop:O.card_faces?.[0]?.image_uris?.art_crop?O.card_faces[0].image_uris.art_crop:O.image_uris?.large?O.image_uris.large:O.card_faces?.[0]?.image_uris?.large?O.card_faces[0].image_uris.large:null:null,C=N(w.data.commander);if(C.length>0){const O=k(C[0]);if(O)return O}if(w.image_uri)return w.image_uri;const I=[...C,...N(w.data.mainBoard),...N(w.data.sideBoard)];if(I.length===0)return null;I.sort((O,L)=>(L.cmc||0)-(O.cmc||0));for(const O of I){const L=k(O);if(L)return L}return null};return i.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-6 animate-fade-in",children:[i.jsx("div",{className:"flex gap-4",children:i.jsxs("div",{className:"relative flex-1",children:[i.jsx("input",{id:"precon-search-input",type:"text",placeholder:"Search for a deck (e.g. 'Eldrazi', 'Slivers', 'Mothman')...",value:r,onChange:w=>n(w.target.value),onKeyDown:w=>w.key==="Enter"&&g(r),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-5 py-4 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all"}),i.jsx("button",{onClick:()=>g(r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:o?i.jsx("div",{className:"col-span-full flex justify-center items-center h-40",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):s.length===0?i.jsx("div",{className:"col-span-full text-center py-10 text-gray-500",children:"No decks found. Try searching for a commander or set name."}):s.map(w=>{const N=v(w);return i.jsxs("div",{onClick:()=>u(w),className:`
                                    relative group cursor-pointer rounded-xl overflow-hidden border-2 transition-all duration-200
                                    h-48 flex flex-col justify-end
                                    ${c?.id===w.id?"border-indigo-500 ring-2 ring-indigo-500/50 shadow-xl scale-[1.02] z-10":"border-gray-800 hover:border-gray-600 hover:-translate-y-1"}
                                `,children:[i.jsxs("div",{className:"absolute inset-0 bg-gray-900 z-0",children:[N&&i.jsx("img",{src:N,alt:w.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-60 transition-opacity"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"})]}),i.jsxs("div",{className:"relative z-10 p-4 w-full",children:[i.jsx("h3",{className:"text-lg font-bold text-white leading-tight mb-2 drop-shadow-md line-clamp-2",children:w.name}),i.jsxs("div",{className:"flex justify-between items-end",children:[i.jsx("span",{className:"text-xs font-bold text-gray-200 bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-white/10",children:w.set_code?.toUpperCase()}),c?.id===w.id&&i.jsx("div",{className:"bg-indigo-500 text-white p-1.5 rounded-full shadow-lg animate-fade-in shadow-indigo-500/50",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]})]},w.id)})}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-800",children:i.jsx("button",{id:"precon-import-btn",onClick:y,disabled:!c||h,className:`
                        px-8 py-3 rounded-xl font-bold text-white transition-all shadow-lg flex items-center gap-2
                        ${!c||h?"bg-gray-700 cursor-not-allowed opacity-50":"bg-indigo-600 hover:bg-indigo-500 hover:shadow-indigo-500/25 transform hover:scale-105"}
                    `,children:h?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):i.jsxs(i.Fragment,{children:["Import Selected Deck",i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})]})})})]})},jlt=({onNext:t,onManualEntry:e})=>{const[r,n]=b.useState("selection"),[s,a]=b.useState(!1),o=[{target:"#precon-search-input",title:"Search Database",content:'Type the name of any official Magic: The Gathering product. Try "Commander" or a set name.'},{target:"#precon-import-btn",title:"One-Click Import",content:"Once you select a deck, click here to instantly add all valid cards (and prints!) to your collection."}],l=c=>{setTimeout(()=>{t()},1500)};return i.jsxs("div",{className:"w-full max-w-5xl animate-fade-in-up px-4",children:[i.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-2 text-center tracking-tight",children:r==="selection"?"Start Your Collection":"Find Your Deck"}),i.jsx("p",{className:"text-gray-400 text-center mb-10 max-w-2xl mx-auto",children:r==="selection"?"Your vault is empty. Let's add your first cards.":"Search our database of official preconstructed decks."}),r==="selection"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[i.jsxs("button",{onClick:e,className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-3xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-2xl flex flex-col h-full",children:[i.jsx("div",{className:"w-16 h-16 rounded-2xl bg-indigo-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:i.jsx(T_e,{size:32,className:"text-indigo-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Add Manually"}),i.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:"Have loose cards or a custom binder? Use our fast search to add them one by one."}),i.jsx("div",{className:"mt-auto flex items-center text-indigo-400 font-bold text-sm tracking-wide",children:"GO TO COLLECTION "})]}),i.jsxs("button",{onClick:()=>{n("precon"),setTimeout(()=>a(!0),1e3)},className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-purple-500 rounded-3xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-2xl flex flex-col h-full",children:[i.jsx("div",{className:"w-16 h-16 rounded-2xl bg-purple-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:i.jsx(z_,{size:32,className:"text-purple-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Import Precon"}),i.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:"Bought a Commander deck or Structure Deck? Find it and add all 100 cards instantly."}),i.jsx("div",{className:"mt-auto flex items-center text-purple-400 font-bold text-sm tracking-wide",children:"SEARCH DATABASE "})]})]}),r==="selection"&&i.jsx("div",{className:"mt-12 text-center",children:i.jsx("button",{onClick:t,className:"text-gray-500 hover:text-white transition-colors text-sm font-medium hover:underline underline-offset-4",children:"Skip for now, I'll figure it out later"})}),r==="precon"&&i.jsxs("div",{className:"bg-gray-900/50 border border-gray-800 rounded-3xl p-6 md:p-8 backdrop-blur-sm",children:[i.jsx("button",{onClick:()=>{n("selection"),a(!1)},className:"mb-6 flex items-center text-gray-500 hover:text-white transition-colors text-sm font-bold uppercase tracking-wider",children:" Back to Options"}),i.jsx(Nlt,{onDeckAdded:l})]}),i.jsx(zf,{steps:o,isOpen:s,onClose:()=>a(!1),tourId:"onboarding_precon_tour"})]})},klt=({onNext:t,onBack:e})=>{const{userProfile:r,updateSettings:n}=Cr(),[s,a]=b.useState("selection"),[o,l]=b.useState({name:"",type:"",personality:""}),[c,u]=b.useState([]),[h,f]=b.useState(""),[m,g]=b.useState(!1),y=b.useRef(null),v={name:"Oracle",type:"Mystic Construct",personality:"Wise, Efficient, Slightly Mystical"};b.useEffect(()=>{y.current?.scrollIntoView({behavior:"smooth"})},[c]);const w=()=>{t(v)},N=async()=>{a("forge"),g(!0),u([{role:"model",content:"Booting Forge System... I am the construct builder. Let's create your companion. First, does your helper have a name, or shall we define their personality first?"}]),g(!1)},k=async()=>{if(!h.trim())return;const O={role:"user",content:h},L=[...c,O];u(L),f(""),g(!0);try{const _=r?.settings?.geminiApiKey,E=await Nl.forgeHelperChat(_,L,o,r);l(M=>({...M,...E.updatedDraft})),u(M=>[...M,{role:"model",content:E.aiResponse}])}catch(_){console.error("Forge Error:",_);let E="System Glitch. Please repeat.";_.message.includes("Leaked")||_.message.includes("Exhausted")||_.message.includes("429")?E=" ORACLE DISCONNECTED: The shared connection is exhausted or blocked. Please enter a custom Gemini API Key below to continue.":_.message.includes("403")&&(E=" ACCESS DENIED: The current key does not have permission. Please verify your API Key."),u(M=>[...M,{role:"model",content:E}])}finally{g(!1)}},C=()=>{const O={name:o.name||"Companion",type:o.type||"Construct",personality:o.personality||"Helpful"};t(O)},I=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),k())};return i.jsxs("div",{className:"w-full max-w-5xl animate-fade-in mx-auto",children:[s==="selection"&&i.jsxs("div",{className:"text-center space-y-8",children:[i.jsx("div",{className:"w-24 h-24 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center ring-1 ring-amber-500/50 shadow-[0_0_30px_rgba(245,158,11,0.3)]",children:i.jsx("svg",{className:"w-12 h-12 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Forge Your Helper"}),i.jsx("p",{className:"text-gray-300 max-w-2xl mx-auto",children:'Who will guide you through the multiverse? You can use our standard "Oracle" construct, or forge a completely custom AI companion with its own name and personality.'})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[e&&i.jsx("button",{onClick:e,className:"col-span-1 md:col-span-2 mx-auto text-gray-500 hover:text-white mb-2 underline",children:" Go Back"}),i.jsxs("button",{onClick:w,className:"p-6 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-gray-500 rounded-xl transition-all group text-left",children:[i.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Default: The Oracle"}),i.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"A wise, mystical construct focused on efficient and accurate advice."}),i.jsx("span",{className:"text-xs font-bold uppercase text-gray-500 group-hover:text-white tracking-wider",children:"Select Oracle "})]}),i.jsxs("button",{onClick:()=>{N()},className:"p-6 border rounded-xl transition-all group text-left relative overflow-hidden bg-amber-900/20 hover:bg-amber-900/30 border-amber-500/30 hover:border-amber-500 cursor-pointer",children:[i.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:i.jsx("svg",{className:"w-16 h-16 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("div",{className:"text-xl font-bold mb-2 text-white group-hover:text-amber-400",children:"Forge Custom Helper"}),i.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create a unique companion. Define their name, species, and personality via chat."}),i.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-green-400 group-hover:text-white block",children:"Included in Trial"}),i.jsx("span",{className:"text-[10px] text-gray-500 mt-1 block group-hover:text-gray-300",children:"Retained with Magician tier or higher."})]})]})]}),i.jsx("div",{className:"max-w-xl mx-auto mt-8 pt-6 border-t border-gray-800",children:i.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[i.jsx("label",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:"Optional: Enable High-Power Uplink (API Key)"}),i.jsx("input",{type:"password",placeholder:"Paste Gemini API Key here (starts with AIza...)",defaultValue:r?.settings?.geminiApiKey||"",onBlur:async O=>{const L=O.target.value.trim();if(L&&L.startsWith("AIza"))try{await n({geminiApiKey:L})}catch(_){console.error("Failed to save key",_)}},className:"bg-black/40 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-300 focus:border-amber-500 focus:outline-none w-full"}),i.jsx("p",{className:"text-[10px] text-gray-600",children:"Use this if the Oracle is exhausted. Overrides the shared connection."})]})})]}),s==="forge"&&i.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border border-gray-700 rounded-2xl overflow-hidden bg-gray-900",children:[i.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-800",children:[i.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-800/50 flex justify-between items-center",children:i.jsx("span",{className:"font-mono text-amber-400 text-sm",children:"SYSTEM: FORGE PROTOCOL ENGAGED"})}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[c.map((O,L)=>i.jsx("div",{className:`flex ${O.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${O.role==="user"?"bg-amber-600 text-white":"bg-gray-800 text-gray-300"}`,children:O.content})},L)),m&&i.jsx("div",{className:"text-gray-500 text-xs animate-pulse ml-2",children:" Processing..."}),i.jsx("div",{ref:y})]}),i.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:h,onChange:O=>f(O.target.value),onKeyDown:I,placeholder:"Ex: Name him 'Gobbo', make him a goblin...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-amber-500 focus:outline-none",disabled:m}),i.jsx("button",{onClick:k,disabled:m||!h.trim(),className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold",children:"Send"})]})})]}),i.jsxs("div",{className:"w-full md:w-80 bg-gray-950 p-6 flex flex-col",children:[i.jsx("h3",{className:"text-gray-400 font-bold uppercase tracking-wider text-xs mb-6",children:"Blueprint Status"}),i.jsxs("div",{className:"space-y-6 flex-1",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"DESIGNATION (NAME)"}),i.jsx("div",{className:`text-lg font-bold ${o.name?"text-amber-400":"text-gray-700 italic"}`,children:o.name||"Undefined"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"CLASSIFICATION (TYPE)"}),i.jsx("div",{className:`text-sm font-medium ${o.type?"text-white":"text-gray-700 italic"}`,children:o.type||"Undefined"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"PARAMETERS (PERSONALITY)"}),i.jsx("div",{className:`text-sm font-medium ${o.personality?"text-white":"text-gray-700 italic"}`,children:o.personality||"Undefined"})]})]}),i.jsx("button",{onClick:C,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-lg hover:shadow-green-500/20 transition-all mt-4",children:"Complete Forge Protocol"})]})]})]})},Vs={FORGE:"forge",COLLECTION:"collection",CHOICE:"choice",ALIGNMENT:"alignment",ORGANIZATION:"organization",COMPANION:"companion",ASCENSION:"ascension"},_lt=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing. Find mechanics and colors instantly.",icon:Kke,sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Track sets and variants.",icon:cke,sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"Bulk in boxes, staples in binders. Best of both worlds.",icon:TO,sort:["set","collector_number"],grouping:"set"},{id:"advanced",name:"The Artificer",description:"Full manual control over sorting hierarchies.",icon:w_e,sort:[],grouping:"custom"}],Slt=()=>{const{userProfile:t,updateSettings:e,refreshUserProfile:r}=Cr(),n=yn(),[s,a]=b.useState(Vs.FORGE),[o,l]=b.useState(!1),[c,u]=b.useState(!1),[h,f]=b.useState({x:0,y:0});b.useEffect(()=>{const se=X=>{f({x:X.clientX/window.innerWidth*100,y:X.clientY/window.innerHeight*100})};return window.addEventListener("mousemove",se),()=>window.removeEventListener("mousemove",se)},[]);const[m,g]=b.useState([]),[y,v]=b.useState(null),[w,N]=b.useState("Oracle"),[k,C]=b.useState("");b.useEffect(()=>{if(!t?.settings)return;const se=t.settings.onboarding_step||0;if(t.settings.onboarding_complete){n("/dashboard");return}switch(se){case 0:a(Vs.FORGE);break;case 1:a(Vs.CHOICE);break;case 2:a(Vs.COMPANION);break;case 3:a(Vs.ALIGNMENT);break;case 4:a(Vs.ORGANIZATION);break;case 5:a(Vs.ASCENSION);break;case 6:a(Vs.COLLECTION);break;default:a(Vs.FORGE);break}},[t?.settings?.onboarding_step,t?.settings?.onboarding_complete]),b.useEffect(()=>{s===Vs.ALIGNMENT&&u(!0)},[s]);const I=async()=>{y&&g([{role:"model",content:y}]),await e({onboarding_step:1}),a(Vs.CHOICE)},O=async()=>{await e({onboarding_step:4}),a(Vs.ORGANIZATION)},L=async()=>{await e({onboarding_step:2}),a(Vs.COMPANION)},_=async se=>{try{await e({playstyle:se,onboarding_step:4}),await r(),u(!1),a(Vs.ORGANIZATION)}catch(X){console.error(X),a(Vs.ORGANIZATION)}},E=async se=>{l(!0);try{await e({organization:{mode:se.id,sortHierarchy:se.sort,groupingPreference:se.grouping},onboarding_step:5}),a(Vs.ASCENSION)}catch(X){console.error(X)}finally{l(!1)}},M=async se=>{l(!0);try{await e({ai_enabled:!0,helper:{name:se.name||"Oracle",type:se.type||"Mystic Construct",personality:se.personality||"Wise, Efficient, Slightly Mystical"},onboarding_step:3}),Ha.check({ai_setup_complete:1}),a(Vs.ALIGNMENT)}catch(X){console.error(X)}finally{l(!1)}},B=async()=>{try{await e({subscription_status:"trial",subscription_tier:"tier_3",trial_start_date:new Date().toISOString(),trial_end_date:new Date(Date.now()+336*60*60*1e3).toISOString(),onboarding_complete:!1,onboarding_step:6}),await r(),Ha.check({onboarding_finished:1}),a(Vs.COLLECTION)}catch(se){console.error("Trial activation failed",se),a(Vs.COLLECTION)}},S=()=>i.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(20)].map((se,X)=>i.jsx(Mo.div,{className:"absolute w-1 h-1 bg-orange-500/60 rounded-full blur-[1px]",initial:{x:Math.random()*100+"%",y:"110%",opacity:0,scale:.5},animate:{y:"-10%",opacity:[0,1,0],scale:[.5,1.5,.5],x:`calc(${Math.random()*100}% + ${(Math.random()-.5)*50}px)`},transition:{duration:3+Math.random()*4,repeat:1/0,delay:Math.random()*5,ease:"easeOut"}},X))}),P=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-black relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_var(--x)_var(--y),_rgba(234,88,12,0.15)_0%,_transparent_50%)] transition-opacity duration-500",style:{"--x":`${h.x}%`,"--y":`${h.y}%`}}),i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-orange-900/40 via-black to-black opacity-60"}),i.jsx(S,{}),i.jsxs(Mo.button,{whileHover:{scale:1.05,boxShadow:"0 0 80px rgba(249, 115, 22, 0.6)"},whileTap:{scale:.95},onClick:I,animate:{boxShadow:["0 0 20px rgba(249, 115, 22, 0.1)","0 0 40px rgba(249, 115, 22, 0.3)","0 0 20px rgba(249, 115, 22, 0.1)"]},transition:{duration:3,repeat:1/0},className:"relative z-10 w-48 h-48 rounded-full bg-gradient-to-br from-orange-500 to-red-700 flex items-center justify-center group",children:[i.jsx("div",{className:"absolute inset-1 rounded-full bg-black flex items-center justify-center",children:i.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-orange-500/10 to-transparent flex items-center justify-center group-hover:from-orange-500/20 transition-all",children:i.jsx(wj,{className:"w-16 h-16 text-orange-500 group-hover:text-orange-400 transition-colors"})})}),i.jsx(Mo.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 rounded-full bg-orange-500/20 blur-xl group-hover:bg-orange-500/30 transition-all"})]}),i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"absolute top-20 text-orange-500/50 text-xs tracking-[0.5em] uppercase font-bold z-10",children:"Welcome to MTG Forge"}),i.jsx(Mo.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-12 text-3xl font-serif text-orange-500 tracking-[0.2em] uppercase z-10 font-bold drop-shadow-[0_2px_10px_rgba(249,115,22,0.3)]",children:"Start the Forge"}),i.jsxs("p",{className:"text-gray-400 mt-4 text-sm z-10 relative max-w-md text-center leading-relaxed",children:["Begin the calibration sequence to unlock your vault.",i.jsx("br",{}),i.jsx("span",{className:"text-gray-600 text-xs mt-2 block",children:"AI Assistance  Organization  Collection Import"})]})]}),R=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-6 relative",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"",className:"w-full h-full object-cover opacity-10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900/80 via-gray-900/95 to-black"})]}),i.jsxs("div",{className:"z-10 max-w-4xl w-full text-center space-y-12",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-4xl font-serif text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-200 mb-4 font-bold",children:"Choose Your Path"}),i.jsx("p",{className:"text-gray-400 text-lg",children:"How would you like to enter the Forge?"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("button",{onClick:O,className:"group relative bg-gray-800/40 hover:bg-gray-800/60 border border-gray-700 hover:border-gray-500 rounded-2xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-xl",children:[i.jsx("div",{className:"absolute top-4 right-4 text-gray-600 group-hover:text-gray-400",children:i.jsx(ud,{className:"w-8 h-8"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2 group-hover:text-amber-400 transition-colors",children:"Jump Right In"}),i.jsx("p",{className:"text-gray-400 leading-relaxed mb-6",children:"Skip the arcane rituals. I just want to organize my collection and build decks manually."}),i.jsxs("div",{className:"text-sm font-bold text-gray-500 group-hover:text-white uppercase tracking-wider flex items-center",children:["Enter Forge ",i.jsx("span",{className:"ml-2",children:""})]})]}),i.jsxs("button",{onClick:L,className:"group relative bg-gradient-to-br from-indigo-900/20 to-purple-900/20 hover:from-indigo-900/40 hover:to-purple-900/40 border border-indigo-500/30 hover:border-indigo-400 rounded-2xl p-8 text-left transition-all hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[i.jsx("div",{className:"absolute top-4 right-4 text-indigo-500/50 group-hover:text-indigo-400",children:i.jsx(Vy,{className:"w-8 h-8"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"Maximize Experience"}),i.jsx("p",{className:"text-indigo-200/70 leading-relaxed mb-6",children:"Configure your Personal AI Companion and analyze your playstyle for tailored suggestions."}),i.jsxs("div",{className:"text-sm font-bold text-indigo-400 group-hover:text-indigo-300 uppercase tracking-wider flex items-center",children:["For the Wizard ",i.jsx("span",{className:"ml-2",children:""})]})]})]})]})]}),V=()=>{const se=t?.settings?.helper?.name||"Oracle",X=t?.settings?.helper?.personality||"Wise, Efficient";return i.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-8 pt-24 relative",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"",className:"w-full h-full object-cover opacity-10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900/50 via-gray-900/80 to-black"})]}),i.jsx(Mo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl w-full bg-black/60 backdrop-blur-md border border-orange-500/20 p-6 rounded-2xl mb-8 relative z-10",children:i.jsxs("div",{className:"flex items-start gap-5",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-orange-500/20 to-purple-500/20 border border-orange-500/30 flex items-center justify-center shrink-0 shadow-lg shadow-orange-500/10",children:i.jsx(Vy,{className:"w-7 h-7 text-orange-400"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-sm font-bold text-orange-400 mb-2 uppercase tracking-wide",children:se}),i.jsx("div",{className:"text-lg font-serif leading-relaxed text-gray-200",dangerouslySetInnerHTML:{__html:m[0]?.content||y||"The Forge is lit, Planeswalker. What colors fuel your spark?"}})]})]})}),i.jsxs("div",{className:"z-10 text-center max-w-xl",children:[i.jsx("h2",{className:"text-3xl font-serif text-white mb-4",children:"Attune Your Playstyle"}),i.jsxs("p",{className:"text-gray-300 mb-6 leading-relaxed",children:["To forge the perfect experience, we must understand the mana that flows through you.",i.jsx("br",{}),"Take the assessment to analyze your magical signature."]}),i.jsx("div",{className:"flex gap-4 justify-center",children:i.jsx("button",{onClick:()=>u(!0),className:"px-8 py-3 bg-indigo-600 rounded-xl font-bold",children:"Re-open Assessment"})})]}),i.jsx(yte,{isOpen:c,onClose:()=>u(!1),onComplete:_,helperName:se,helperPersonality:X})]})},ee=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white p-8 relative",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"",className:"w-full h-full object-cover opacity-10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/95 to-black"})]}),i.jsxs(Mo.div,{initial:{opacity:0},animate:{opacity:1},className:"z-10 text-center mb-10",children:[i.jsx("h2",{className:"text-3xl font-serif text-white mb-2",children:"Forge Your Registry"}),i.jsx("p",{className:"text-gray-400",children:"How should the Oracle organize your collection?"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl w-full z-10",children:_lt.map(se=>i.jsxs(Mo.button,{whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>E(se),disabled:o,className:"bg-gray-800/60 backdrop-blur border border-gray-700 hover:border-indigo-500 rounded-2xl p-6 text-left hover:shadow-2xl hover:shadow-indigo-500/20 transition-all flex flex-col h-full group",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center mb-4 group-hover:bg-indigo-500/30 transition-colors",children:i.jsx(se.icon,{className:"w-6 h-6 text-indigo-400"})}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:se.name}),i.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:se.description})]},se.id))})]}),G=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white p-8 relative",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"",className:"w-full h-full object-cover opacity-10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900/50 via-gray-900/80 to-black"})]}),i.jsx("div",{className:"w-full max-w-5xl z-10",children:i.jsx(klt,{onNext:M,onBack:()=>a(Vs.FORGE)})})]}),J=()=>i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-black text-white p-8 relative overflow-hidden",children:i.jsxs(Mo.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8},className:"text-center z-10",children:[i.jsxs(Mo.div,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},className:"w-64 h-64 mx-auto mb-8 relative",children:[i.jsx("div",{className:"absolute inset-0 border-4 border-dashed border-amber-500/30 rounded-full"}),i.jsx("div",{className:"absolute inset-4 border-2 border-amber-500/50 rounded-full"}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i.jsx(L_e,{className:"w-32 h-32 text-amber-500 animate-pulse"})})]}),i.jsx("h1",{className:"text-5xl font-serif text-amber-500 mb-4 tracking-tight",children:"Ascension Complete"}),i.jsx("p",{className:"text-xl text-gray-400 max-w-lg mx-auto mb-12",children:"Your spark burns bright, Planeswalker."}),i.jsx("button",{onClick:B,className:"px-12 py-4 bg-amber-600 hover:bg-amber-500 text-black font-bold text-xl rounded-full shadow-[0_0_30px_rgba(245,158,11,0.4)] hover:shadow-[0_0_50px_rgba(245,158,11,0.6)] transition-all transform hover:scale-105",children:"Enter the Multiverse"})]})}),Z=()=>i.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white relative",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"",className:"w-full h-full object-cover opacity-10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/90 to-black"})]}),i.jsx("div",{className:"z-10 w-full",children:i.jsx(jlt,{onNext:async()=>{await e({onboarding_complete:!0,onboarding_step:7}),await r(),n("/dashboard")},onManualEntry:()=>n("/collection?openAdd=true")})})]});return i.jsx("div",{className:"font-sans antialiased text-white",children:i.jsxs(mot,{mode:"wait",children:[s===Vs.FORGE&&i.jsx(Mo.div,{exit:{opacity:0},className:"absolute inset-0",children:P()},"forge"),s===Vs.CHOICE&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:R()},"choice"),s===Vs.ALIGNMENT&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:V()},"alignment"),s===Vs.ORGANIZATION&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:ee()},"org"),s===Vs.COMPANION&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:G()},"companion"),s===Vs.ASCENSION&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:J()},"ascension"),s===Vs.COLLECTION&&i.jsx(Mo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:Z()},"collection")]})})},Clt=()=>i.jsx(Slt,{}),Elt=()=>i.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[i.jsxs("div",{className:"relative py-20 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-indigo-900/10"}),i.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-6 text-center",children:[i.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white mb-6 tracking-tight",children:"About The Forge"}),i.jsx("p",{className:"text-xl text-gray-400 leading-relaxed",children:"Built by players, for players. The Forge is designed to be the ultimate companion for Magic: The Gathering deck building and collection management."})]})]}),i.jsxs("div",{className:"max-w-4xl mx-auto px-6 space-y-16",children:[i.jsxs("section",{className:"space-y-6 animate-fade-in-up",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"w-8 h-1 bg-amber-500 rounded-full"}),"The Human Factor"]}),i.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-3xl border border-amber-500/10 relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:i.jsx("svg",{className:"w-64 h-64 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),i.jsxs("div",{className:"relative z-10 space-y-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"AI is a Tool, Not a Replacement"}),i.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[i.jsx("p",{children:"At The Forge, we believe AI can be an incredible creative partner. It can scan thousands of cards in seconds, find obscure combos, and suggest perfectly curved land bases."}),i.jsxs("p",{children:[i.jsx("strong",{className:"text-amber-400",children:"However, AI is still a work in progress."}),' It can hallucinate interactions, suggest banned cards, or miss the subtle "fun factor" that makes a Commander deck truly special.']}),i.jsx("p",{children:"We built these tools to get you 80% of the way there. The final 20%the soul of the deckcomes from you. Use our suggestions as a starting point, but trust your intuition and knowledge to build something truly unique."})]})]})]})]}),i.jsxs("section",{className:"space-y-8 animate-fade-in-up",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"w-8 h-1 bg-indigo-500 rounded-full"}),"Powered By"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("a",{href:"https://scryfall.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 hover:bg-gray-800 transition-all group",children:[i.jsx("div",{className:"text-indigo-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),i.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Scryfall"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"The best MTG card database in the world. All card data and imagery is provided by their incredible API."})]}),i.jsxs("a",{href:"https://tcgplayer.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-green-500 hover:bg-gray-800 transition-all group",children:[i.jsx("div",{className:"text-green-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"TCGPlayer"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time pricing data for card values. Keeping your collection valuation accurate and up to date."})]}),i.jsxs("a",{href:"https://magic.wizards.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800 transition-all group",children:[i.jsx("div",{className:"text-orange-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Wizards of the Coast"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Creators of Magic: The Gathering. All mana symbols, card names, and art are copyright WotC."})]})]})]}),i.jsxs("section",{className:"space-y-8 animate-fade-in-up delay-100",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"w-8 h-1 bg-purple-500 rounded-full"}),"Get in Touch"]}),i.jsx("div",{className:"bg-gradient-to-br from-indigo-900/20 to-purple-900/20 p-8 rounded-3xl border border-white/5 relative overflow-hidden",children:i.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[i.jsxs("div",{className:"space-y-4 text-center md:text-left",children:[i.jsx("h3",{className:"text-2xl font-bold text-white",children:"Join the Community"}),i.jsx("p",{className:"text-gray-400 max-w-md",children:"Have a feature request? Found a bug? Or just want to show off your latest brew? Come chat with us on Discord."})]}),i.jsxs("a",{href:"https://discord.gg/your-discord-link",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/25 flex items-center gap-3 transform hover:-translate-y-1",children:[i.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]})]})})]}),i.jsx("div",{className:"text-center text-gray-600 text-xs pt-20",children:i.jsx("p",{children:"The Forge is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Wizards of the Coast LLC."})})]})]}),Gv=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],Alt=()=>{const{slug:t}=cc(),e=yn(),{currentUser:r}=Cr(),{addToast:n}=Tn(),[s,a]=b.useState(null),[o,l]=b.useState(!0),[c,u]=b.useState(null),[h,f]=b.useState("grid"),[m,g]=b.useState(!1),[y,v]=b.useState(!1),[w,N]=b.useState(0);b.useEffect(()=>{(async()=>{try{const ee=await He.get(`/api/decks/public/${t}`);a(ee)}catch(ee){console.error("Public deck load failed",ee),u("Deck not found or private.")}finally{l(!1)}})()},[t]);const{deck:k,items:C}=s||{},I=b.useMemo(()=>{if(!k)return Gv.find(Z=>Z.badge==="Colorless");if(k?.format?.toLowerCase()==="standard"){const Z=k.colors||k.commander?.color_identity||[];return Gv.find(X=>X.colors.length!==Z.length?!1:X.colors.every(q=>Z.includes(q)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const V=k?.commander?.color_identity||[],ee=k?.commander_partner?.color_identity||[],G=[...new Set([...V,...ee])];return G.length===0?Gv.find(Z=>Z.badge==="Colorless"):Gv.find(Z=>Z.colors.length!==G.length?!1:Z.colors.every(se=>G.includes(se)))||Gv.find(Z=>Z.badge==="Colorless")},[k]),O=b.useMemo(()=>{if(!C)return 0;let V=C.reduce((J,Z)=>J+(Z.countInDeck||Z.count||1),0);const ee=k?.commander?.id||k?.commander?.scryfall_id,G=k?.commander_partner?.id||k?.commander_partner?.scryfall_id;return k?.commander&&!C.some(J=>(J.scryfall_id||J.id)===ee)&&V++,k?.commander_partner&&!C.some(J=>(J.scryfall_id||J.id)===G)&&V++,V},[C,k]),L=b.useMemo(()=>{if(!C)return 0;let V=C.reduce((J,Z)=>{const se=parseFloat(Z.prices?.[Z.finish==="foil"?"usd_foil":"usd"]||Z.data?.prices?.[Z.finish==="foil"?"usd_foil":"usd"]||0);return J+se*(Z.countInDeck||Z.count||1)},0);const ee=k?.commander?.id||k?.commander?.scryfall_id,G=k?.commander_partner?.id||k?.commander_partner?.scryfall_id;if(k?.commander&&!C.some(J=>(J.scryfall_id||J.id)===ee)){const J=k.commander;V+=parseFloat(J.prices?.usd||0)}if(k?.commander_partner&&!C.some(J=>(J.scryfall_id||J.id)===G)){const J=k.commander_partner;V+=parseFloat(J.prices?.usd||0)}return V},[C,k]),_=V=>{if(!C)return 0;let ee=C.reduce((Z,se)=>((se.data||se).type_line||"").includes(V)?Z+(se.countInDeck||1):Z,0);const G=k?.commander?.id||k?.commander?.scryfall_id,J=k?.commander_partner?.id||k?.commander_partner?.scryfall_id;return k?.commander&&!C.some(Z=>(Z.scryfall_id||Z.id)===G)&&(k.commander.type_line||"").includes(V)&&ee++,k?.commander_partner&&!C.some(Z=>(Z.scryfall_id||Z.id)===J)&&(k.commander_partner.type_line||"").includes(V)&&ee++,ee},E=b.useMemo(()=>{const V=k?.ai_blueprint||k?.aiBlueprint||{},ee=V.layout?.types||V.suggestedCounts||{};return[{label:"Total",current:O,target:k?.format?.toLowerCase()==="standard"||k?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:_("Creature"),target:ee.Creatures||ee.Creature||30},{label:"Lands",current:_("Land"),target:ee.Lands||ee.Land||36},{label:"Instants",current:_("Instant"),target:ee.Instants||ee.Instant||10},{label:"Sorceries",current:_("Sorcery"),target:ee.Sorceries||ee.Sorcery||10},{label:"Enchantments",current:_("Enchantment"),target:ee.Enchantments||ee.Enchantment||5},{label:"Artifacts",current:_("Artifact"),target:ee.Artifacts||ee.Artifact||10},{label:"Planeswalkers",current:_("Planeswalker"),target:ee.Planeswalkers||ee.Planeswalker||0}].filter(J=>J.target>0)},[k,O,C]),M=b.useMemo(()=>{if(!C)return{};const V={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return C.forEach(ee=>{const J=((ee.data||ee).type_line||"").toLowerCase(),Z=ee.scryfall_id||ee.id,se=k?.commander&&Z===(k.commander.id||k.commander.scryfall_id),X=k?.commander_partner&&Z===(k.commander_partner.id||k.commander_partner.scryfall_id);if(se||X){V.Commander.push(ee);return}J.includes("creature")?V.Creature.push(ee):J.includes("planeswalker")?V.Planeswalker.push(ee):J.includes("instant")?V.Instant.push(ee):J.includes("sorcery")?V.Sorcery.push(ee):J.includes("artifact")?V.Artifact.push(ee):J.includes("enchantment")?V.Enchantment.push(ee):J.includes("land")?V.Land.push(ee):V.Other.push(ee)}),Object.fromEntries(Object.entries(V).filter(([ee,G])=>G.length>0))},[C,k]);if(o)return i.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(c||!k)return i.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center text-red-500 font-bold text-xl",children:c||"Deck inaccessible"});const B=w===0?k.commander:k.commander_partner||k.commander,S=B?.image_uris?.art_crop||B?.card_faces?.[0]?.image_uris?.art_crop||"",P={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},R=async()=>{if(r)try{n("Cloning deck...","info");const V=await al.createDeck(r.uid,{name:`Copy of ${k.name}`,commander:k.commander,commanderPartner:k.commander_partner,format:k.format,isMockup:!0}),ee=C.map(G=>({scryfall_id:G.scryfall_id||G.id,name:G.name,set_code:G.set_code,collector_number:G.collector_number,finish:G.finish,image_uri:G.image_uri,data:G.data}));await He.post(`/api/decks/${V.id}/cards/batch`,{cards:ee}),n("Deck cloned successfully!","success"),e(`/decks/${V.id}`)}catch(V){console.error(V),n("Failed to clone deck","error")}};return i.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[i.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${S})`},children:i.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),i.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[i.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:i.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:k.format||"Commander"}),i.jsxs("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:["Shared by ",k.user_id?"a User":"Unknown"]})]}),i.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:k.name}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex items-center gap-1",children:(()=>{const V=k?.commander?.color_identity||[],ee=k?.commander_partner?.color_identity||[];return[...new Set([...V,...ee])].map(J=>i.jsx("img",{src:P[J],alt:J,className:"w-6 h-6"},J))})()}),i.jsx("div",{className:"h-4 w-px bg-white/10"}),i.jsx("div",{className:"text-sm font-bold text-gray-400",children:I.theme})]})]}),i.jsxs("div",{className:"flex flex-col items-end gap-2",children:[i.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",L.toFixed(2)]}),i.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[O," Cards"]}),r?i.jsx("button",{onClick:R,className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Clone to Collection"}):i.jsx(Hr,{to:"/login",className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Login to Clone"})]})]})}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-8",children:E.map((V,ee)=>{const G=V.target>0?Math.min(V.current/V.target*100,100):0,J=V.target>0&&V.current===V.target,Z=V.target>0&&V.current>V.target;return i.jsxs("div",{className:"bg-gray-950/20 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg",children:[i.jsxs("div",{className:"flex justify-between items-end mb-1",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:V.label}),i.jsxs("span",{className:`text-xs font-mono font-bold ${J?"text-green-400":Z?"text-orange-400":"text-indigo-300"}`,children:[V.current,i.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),V.target||"?"]})]}),i.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:i.jsx("div",{className:`h-full transition-all duration-700 ${J?"bg-green-500":Z?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${G||0}%`}})})]},ee)})}),i.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[i.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[i.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[i.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),i.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[i.jsx("button",{onClick:()=>f("grid"),className:`p-1.5 rounded ${h==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),i.jsx("button",{onClick:()=>f("table"),className:`p-1.5 rounded ${h==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),i.jsx("div",{className:"p-4 space-y-8",children:Object.entries(M).map(([V,ee])=>i.jsxs("div",{children:[i.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[i.jsx("span",{children:V}),i.jsx("span",{className:"text-gray-500",children:ee.length})]}),h==="grid"?i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:ee.map((G,J)=>i.jsx(Ky,{card:G,readOnly:!0},J))}):i.jsx("div",{className:"space-y-1",children:ee.map((G,J)=>i.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("span",{className:"font-mono text-gray-500",children:G.countInDeck||1}),i.jsx("span",{className:G.finish==="foil"?"text-yellow-200":"",children:G.name})]}),i.jsx("div",{className:"font-mono text-xs opacity-50",children:G.mana_cost})]},J))})]},V))})]})}),i.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[k.commander&&i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:"Commander"}),i.jsx("img",{src:B?.image_uris?.normal||B?.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Commander"}),k.commander_partner&&i.jsx("button",{onClick:()=>N(V=>V===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:"View Partner"})]}),i.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>v(!0),className:"text-[10px] font-black text-white uppercase tracking-[0.2em] bg-indigo-600 flex flex-col items-center gap-2 p-3 rounded-2xl hover:bg-indigo-500 transition-all shadow-xl shadow-indigo-900/40 group overflow-hidden",children:[i.jsx("svg",{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),i.jsx("span",{className:"text-[8px]",children:"Deck Doctor"})]}),i.jsx("button",{onClick:()=>g(!0),className:"text-[10px] font-bold text-indigo-400 hover:text-white uppercase tracking-wider bg-indigo-500/10 px-2 py-1 rounded hover:bg-indigo-500/20 transition-colors",children:"Details "})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"h-[120px]",children:[i.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),i.jsx(Yk,{cards:C,type:"mana"})]}),i.jsxs("div",{className:"h-[160px]",children:[i.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),i.jsx(Yk,{cards:C,type:"types"})]})]})]}),!r&&i.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 backdrop-blur-md rounded-3xl border border-white/10 p-6 text-center",children:[i.jsx("h3",{className:"font-bold text-white mb-2",children:"Build Your Own Decks"}),i.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Join MTG Forge to manage your collection, build decks with AI, and track prices."}),i.jsx(Hr,{to:"/login",className:"block w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-900/20 transition-all text-sm",children:"Get Started Free"})]})]})]})]}),i.jsx(rae,{isOpen:m,onClose:()=>g(!1),cards:C,deckName:k.name}),i.jsx(nae,{isOpen:y,onClose:()=>v(!1),deck:k,cards:C,isOwner:!1})]})},Tlt=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const r=console.log,n=console.warn,s=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{s(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=s}},[]),i.jsx("div",{className:"fixed bottom-0 left-0 w-full h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border-t border-green-500/20",children:t.map((r,n)=>i.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5",children:r},n))})},Ilt=()=>{const{sessionId:t}=cc(),[e,r]=b.useState("connecting"),[n,s]=b.useState(null),[a,o]=b.useState([]),l=b.useRef(null),c=b.useRef(null),[u,h]=b.useState(null),[f,m]=b.useState(!1),[g,y]=b.useState(!1),[v,w]=b.useState(null);b.useEffect(()=>{const O=Im();return s(O),O.on("connect",()=>{console.log("Connected to Forge Bridge"),O.emit("join-pairing",t),r("ready")}),O.on("disconnect",()=>{console.log("Disconnected"),r("error")}),()=>O.disconnect()},[t]),b.useEffect(()=>{let O=null;return(async()=>{try{console.log("[OCR] Initializing Tesseract (Remote)...");const _=await Fre.createWorker("eng",1,{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),O=_,h(_),y(!0)}catch(_){console.error("OCR Worker Init Failed",_||"Unknown Error")}})(),()=>{O&&O.terminate()}},[]);const N=async()=>{if(!(!g||f||!l.current)){m(!0);try{const O=l.current.getScreenshot();if(!O)return;const L=new Image;L.src=O,await new Promise(E=>L.onload=E);const _=await k(L);await I(_)}catch(O){console.error("Processing error",O),w({error:"Processing Error"})}finally{m(!1),setTimeout(()=>{w(O=>O?.error?null:O)},3e3)}}},k=async O=>{const L=c.current,_=L.getContext("2d",{willReadFrequently:!0}),E=async(q,U,H,re)=>{let ae=250/re;ae=Math.max(.1,Math.min(ae,4));let xe=Math.floor(H*ae),Ne=Math.floor(re*ae);xe>4e3&&(ae=4e3/H,xe=4e3,Ne=Math.floor(re*ae)),console.log(`[RemoteLens] OCR Crop: ${xe}x${Ne} (Src: ${Math.floor(H)}x${Math.floor(re)})`),L.width=xe,L.height=Ne,_.imageSmoothingEnabled=!0,_.imageSmoothingQuality="high",_.drawImage(O,q,U,H,re,0,0,xe,Ne);const pe=_.getImageData(0,0,L.width,L.height),K=pe.data;for(let he=0;he<K.length;he+=4){const le=(K[he]+K[he+1]+K[he+2])/3;K[he]=K[he+1]=K[he+2]=le}_.putImageData(pe,0,0);const{data:{text:ue}}=await u.recognize(L);return ue.split(`
`).map(he=>he.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(he=>he.length>=1)},M=O.width,B=O.height,S=Math.min(M,B),P=(M-S)/2,R=(B-S)/2;console.log(`[RemoteLens] Precision Mode: ${M}x${B}, Crop: ${S}x${S} @ (${P}, ${R})`);const V=await E(P+S*.1,R+S*.35,S*.8,S*.3);let ee="",G="";const J=V.join(" ").toUpperCase();console.log(`[RemoteLens] Raw Scan: "${J}"`);const se=(J.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(q=>!/^(19|20)\d{2}$/.test(q));se.length>0&&(G=se[0]);const X=J.match(/\b[A-Z0-9]{3,4}\b/g);if(X){const q=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],U=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],H=X.find(re=>!U.includes(re)&&!q.includes(re)&&!/^\d+$/.test(re));H&&(ee=H)}return{name:"",set:ee,cn:G,raw_footer:J}},C=(O,L,_)=>{const E={id:Math.random().toString(36).substr(2,9),scryfall_id:O.scryfall_id||O.uuid,name:O.name,set_name:O.set_name||O.setcode,set_code:O.set||O.setcode,collector_number:O.collector_number||O.number,image:O.image_uri||O.image_uris?.small||O.card_faces?.[0]?.image_uris?.small,finish:"nonfoil",quantity:1,data:O,variants:L,raw_ocr:_};n.emit("card-scanned",{sessionId:t,card:E}),o(M=>[E,...M].slice(0,5)),w({success:!0,name:O.name})},I=async({name:O,set:L,cn:_,raw_footer:E})=>{if(console.log(`[RemoteLens] Resolving: Set="${L}", CN="${_}"`),L&&_){console.log(`[RemoteLens] Attempting Set/CN match: ${L} #${_}`);try{const M=await He.post("/api/cards/search",{set:L,cn:_});if(M.data&&M.data.length>0){const B=M.data[0];console.log(`[RemoteLens] Match found: ${B.name}`);const S=M.data.length>1?M.data:[B];C(B,S,{name:O,set:L,cn:_});return}else{w({error:`Not Found: ${L} #${_}`});return}}catch(M){console.warn("[RemoteLens] Set/CN search failed",M)}}w({error:"Scan Set Code & Number"})};return i.jsxs("div",{className:"fixed inset-0 bg-gray-950 flex flex-col items-center justify-between p-6 text-white overflow-hidden",children:[i.jsx(Tlt,{}),i.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(qI,{className:"w-5 h-5 text-indigo-400"}),i.jsx("h1",{className:"font-black italic uppercase text-lg",children:"Forge Remote"})]}),i.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${e==="ready"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[e==="ready"?i.jsx(Q_e,{className:"w-3 h-3"}):i.jsx(Y_e,{className:"w-3 h-3"}),e==="ready"?"Paired":"Connecting..."]})]}),i.jsxs("div",{className:"relative w-full aspect-[3/4] max-h-[60vh] rounded-3xl overflow-hidden border-2 border-white/10 shadow-2xl bg-black",children:[i.jsx(Mre,{ref:l,audio:!1,screenshotFormat:"image/webp",videoConstraints:{facingMode:"environment"},className:"w-full h-full object-cover brightness-110 contrast-125"}),i.jsxs("div",{className:"absolute inset-4 border-2 border-white/5 rounded-2xl pointer-events-none",children:[i.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),i.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),i.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),i.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),i.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 w-full px-8",children:f?i.jsx("div",{className:"bg-indigo-600 text-white text-xs py-2 rounded-full font-black text-center animate-pulse",children:"ANALYZING..."}):v?.success?i.jsxs("div",{className:"bg-green-600 text-white text-xs py-2 rounded-full font-black text-center flex items-center justify-center gap-2",children:[i.jsx(ih,{className:"w-4 h-4"})," ",v.name," SENT!"]}):v?.error?i.jsx("div",{className:"bg-red-600 text-white text-xs py-2 rounded-full font-black text-center",children:v.error}):i.jsx("div",{className:"bg-black/60 backdrop-blur-md text-white/60 text-[10px] py-2 rounded-full text-center uppercase font-bold tracking-widest",children:"Align Set Code & Number"})})]})]}),i.jsxs("div",{className:"w-full flex flex-col items-center gap-6 mb-20",children:[i.jsx("button",{onClick:N,disabled:f||!g,className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center shadow-2xl active:scale-90 transition-all border-4 border-white/5",children:f?i.jsx(Uy,{className:"w-10 h-10 animate-spin"}):i.jsx(zI,{className:"w-10 h-10"})}),i.jsx("div",{className:"w-full h-20 flex gap-3 overflow-x-auto pb-2 scroll-smooth",children:a.map((O,L)=>i.jsxs("div",{className:"flex-shrink-0 w-12 h-16 rounded-lg overflow-hidden border border-white/10 relative group",children:[i.jsx("img",{src:O.image,className:"w-full h-full object-cover",alt:""}),i.jsx("div",{className:"absolute inset-0 bg-green-500/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(ih,{className:"w-4 h-4 text-white"})})]},L))})]}),i.jsx("canvas",{ref:c,className:"hidden"})]})},Plt=()=>i.jsxs("div",{className:"min-h-screen bg-gray-950 text-white relative flex flex-col pt-16",children:[i.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden pointer-events-none",children:[i.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-indigo-600/10 blur-[120px] rounded-full"}),i.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-orange-600/10 blur-[120px] rounded-full"}),i.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(30,27,75,0.2)_0%,transparent_70%)]"})]}),i.jsxs("div",{className:"relative z-20 max-w-7xl mx-auto px-4 w-full py-8",children:[i.jsxs(Hr,{to:"/",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors gap-2 group mb-12",children:[i.jsx(Ere,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),i.jsx("span",{className:"font-bold uppercase tracking-widest text-xs",children:"Back to The Forge"})]}),i.jsxs("div",{className:"max-w-4xl",children:[i.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-6 text-indigo-400",children:[i.jsx(Vy,{className:"w-4 h-4"}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Actionable Intelligence"})]}),i.jsxs("h1",{className:"text-5xl md:text-7xl font-black tracking-tight mb-8 leading-tight",children:["The AI Strategic",i.jsx("br",{}),i.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-500 to-orange-500",children:"Companion Guide"})]}),i.jsx("p",{className:"text-xl md:text-2xl text-gray-400 leading-relaxed font-medium max-w-2xl",children:"Stop tracking data. Start forging strategy. Explore the neural engines that give you the edge in every brew and every match."})]})]}),i.jsxs("main",{className:"relative z-10 max-w-7xl mx-auto px-4 py-24 space-y-48",children:[i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-0 bg-indigo-600/30 blur-[80px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),i.jsx("div",{className:"relative bg-black/60 border border-white/10 rounded-[3rem] p-12 backdrop-blur-3xl shadow-2xl",children:i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Neural Synthesis Engine"}),i.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"text-sm font-bold text-gray-400 italic",children:'"Architect, build me a Bracket 4 competitive deck around [Selected Commander], prioritize my collection first..."'}),i.jsx("div",{className:"h-[1px] w-full bg-white/10"}),i.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{l:"Analyzing Archetype...",s:"100%"},{l:"Mapping Collection Staples...",s:"84%"},{l:"Optimizing Mana Curve...",s:"92%"},{l:"Finalizing Deck List...",s:"Processing"}].map((t,e)=>i.jsxs("div",{className:"flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-500",children:[i.jsx("span",{children:t.l}),i.jsx("span",{className:t.s==="100%"?"text-green-400":"text-indigo-400",children:t.s})]},e))})]}),i.jsxs("div",{className:"p-6 bg-indigo-500/10 rounded-2xl border border-indigo-500/20",children:[i.jsx("div",{className:"text-white font-black text-lg mb-2",children:"The Neural Architect"}),i.jsxs("div",{className:"text-gray-400 text-sm leading-relaxed",children:["Generating 100-card Commander list... ",i.jsx("br",{}),i.jsx("span",{className:"text-indigo-300",children:"62/100 Cards found in your collection."})," ",i.jsx("br",{}),i.jsx("span",{className:"text-orange-300",children:"38/100 Cards required for purchase."})]})]})]})})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center text-indigo-400 border border-indigo-500/20 shadow-[0_0_40px_rgba(79,70,229,0.3)]",children:i.jsx(ud,{className:"w-10 h-10"})}),i.jsxs("h2",{className:"text-5xl font-black leading-tight",children:["Zero-to-Brews:",i.jsx("br",{}),"The Neural Architect"]}),i.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"While other sites give you a search bar, we give you a brain. The **Neural Architect** is the world's first AI engine that doesn't just suggest cardsit synthesizes entire, playable decks from your Commander selection."}),i.jsx("ul",{className:"space-y-6",children:[{t:"Commander-Centric Synthesis",d:"Select your Commander and target a specific power bracket for a precision brew."},{t:"Collection-Aware logic",d:"The AI builds around what you own, drastically reducing the cost of new brews."},{t:"Bracket-Targeting",d:"Specify exactly which pod power level you want to compete in."}].map((t,e)=>i.jsxs("li",{className:"flex gap-4",children:[i.jsx("div",{className:"mt-1 w-5 h-5 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400 text-[10px] font-black border border-indigo-500/30 shrink-0",children:e+1}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-bold",children:t.t}),i.jsx("div",{className:"text-gray-500 text-sm",children:t.d})]})]},e))})]})]}),i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[i.jsxs("div",{className:"space-y-8 order-2 lg:order-1",children:[i.jsx("div",{className:"w-16 h-16 bg-orange-500/10 rounded-2xl flex items-center justify-center text-orange-400 border border-orange-500/20",children:i.jsx(gU,{className:"w-8 h-8"})}),i.jsx("h2",{className:"text-4xl font-black",children:"The AI Deck Doctor"}),i.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Traditional deck-building tools treat your list like a static file. The **Deck Doctor** treats it like a living strategy. It uses advanced neural analysis to evaluate not just individual cards, but the synergistic web they form."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("h3",{className:"text-xl font-bold flex items-center gap-3",children:[i.jsx(R_e,{className:"w-5 h-5 text-indigo-400"}),"The 1-5 Bracket System"]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[{t:"Bracket 1",d:"Casual/Precon: Narrative focus."},{t:"Bracket 3",d:"High Power: Efficient execution."},{t:"Bracket 5",d:"Maximum Power: Competitive meta."},{t:"0.01 PL Step",d:"Precision tracking of deck shifts."}].map((t,e)=>i.jsxs("div",{className:"p-4 bg-white/5 rounded-xl border border-white/10",children:[i.jsx("div",{className:"font-black text-indigo-400 text-sm mb-1 uppercase tracking-wider",children:t.t}),i.jsx("div",{className:"text-sm text-gray-400",children:t.d})]},e))})]})]}),i.jsxs("div",{className:"relative order-1 lg:order-2 group",children:[i.jsx("div",{className:"absolute inset-0 bg-indigo-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),i.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-end",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Power Level"}),i.jsx("div",{className:"text-5xl font-black text-white",children:"7.42"})]}),i.jsx("div",{className:"px-4 py-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30 text-indigo-400 font-bold uppercase tracking-widest text-xs",children:"Bracket 3"})]}),i.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-orange-500 w-[74%]"})}),i.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]})]}),i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-0 bg-orange-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),i.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Recommended Adjustments"}),[{out:"Murder",in:"Assassin's Trophy",reason:"Broadened threat coverage"},{out:"Sol Ring",in:"Mana Crypt",reason:"Maximum acceleration"}].map((t,e)=>i.jsxs("div",{className:"flex items-center gap-4 p-4 bg-black/40 rounded-2xl border border-white/5",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"text-red-400 text-xs font-bold line-through",children:["OUT: ",t.out]}),i.jsxs("div",{className:"text-green-400 text-sm font-bold mt-1",children:["IN: ",t.in]})]}),i.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:t.reason})]},e))]})})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsx("div",{className:"w-16 h-16 bg-indigo-500/10 rounded-2xl flex items-center justify-center text-indigo-400 border border-indigo-500/20",children:i.jsx(ud,{className:"w-8 h-8"})}),i.jsx("h2",{className:"text-4xl font-black",children:"Surgical Swaps"}),i.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Stop buying proxies you don't need or spending money on cards that clash with your goals. Our AI scans your **available collection** in real-time to suggest surgical changes."}),i.jsx("ul",{className:"space-y-4",children:["Find hidden staples already in your binders","Optimize curve without increasing budget","Identify over-committed resources"].map((t,e)=>i.jsxs("li",{className:"flex items-center gap-3 text-white font-medium",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),t]},e))})]})]}),i.jsxs("section",{className:"space-y-16",children:[i.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[i.jsx("h2",{className:"text-4xl font-black mb-6",children:"Tactical Advisor Personas"}),i.jsx("p",{className:"text-xl text-gray-400",children:"Different archetypes for different goals. Choose who critiques your brew."})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{n:"Ruthless Optimizer",t:"Cedh Meta",icon:i.jsx(xke,{className:"w-6 h-6"}),color:"text-red-400",bg:"hover:border-red-500/30"},{n:"Flavor Specialist",t:"Vorthos/Lore",icon:i.jsx(Xm,{className:"w-6 h-6"}),color:"text-blue-400",bg:"hover:border-blue-500/30"},{n:"Budget Engineer",t:"Cost Neutral",icon:i.jsx(Vy,{className:"w-6 h-6"}),color:"text-green-400",bg:"hover:border-green-500/30"},{n:"Chaos Librarian",t:"Unique Tech",icon:i.jsx(gU,{className:"w-6 h-6"}),color:"text-purple-400",bg:"hover:border-purple-500/30"}].map((t,e)=>i.jsxs("div",{className:`p-8 bg-white/5 border border-white/10 rounded-3xl transition-all ${t.bg} group`,children:[i.jsx("div",{className:`w-12 h-12 mb-6 flex items-center justify-center bg-gray-900 rounded-xl ${t.color} border border-white/5 group-hover:scale-110 transition-transform`,children:t.icon}),i.jsx("h4",{className:"text-lg font-black mb-1",children:t.n}),i.jsx("div",{className:"text-xs font-bold uppercase tracking-widest text-gray-500",children:t.t})]},e))})]}),i.jsxs("section",{className:"relative overflow-hidden rounded-[3rem] bg-gradient-to-br from-indigo-600 to-purple-800 p-12 md:p-24 text-center",children:[i.jsx("div",{className:"absolute inset-0 bg-[url(/MTG-Forge_Logo_Background.png)] bg-cover bg-center mix-blend-overlay opacity-20"}),i.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto space-y-8",children:[i.jsx("h2",{className:"text-4xl md:text-6xl font-black text-white leading-tight",children:"Ready to Forge Your Legends?"}),i.jsx("p",{className:"text-xl text-indigo-100 font-medium",children:"Join the new generation of brewers using Actionable Intelligence to dominate their pods."}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-8",children:[i.jsx(Hr,{to:"/dashboard",className:"px-10 py-5 bg-white text-indigo-900 font-black rounded-2xl shadow-xl hover:scale-105 transition-all",children:"Enter The Forge"}),i.jsx(Hr,{to:"/pricing",className:"px-10 py-5 bg-black/30 backdrop-blur-md text-white border border-white/20 font-black rounded-2xl hover:bg-black/40 transition-all",children:"View Pricing"})]})]})]})]}),i.jsx("footer",{className:"relative z-10 py-24 border-t border-white/5 bg-gray-950 mt-auto",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center space-y-4",children:[i.jsx("p",{className:"text-gray-500 text-sm",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."}),i.jsxs("div",{className:"flex justify-center gap-8 text-xs font-bold uppercase tracking-widest text-gray-600",children:[i.jsx(Hr,{to:"/about",className:"hover:text-white transition-colors",children:"About"}),i.jsx(Hr,{to:"/pricing",className:"hover:text-white transition-colors",children:"Pricing"}),i.jsx(Hr,{to:"/settings",className:"hover:text-white transition-colors",children:"Settings"})]})]})})]}),Llt=({card:t,rank:e})=>{const[r,n]=b.useState({}),[s,a]=b.useState({}),[o,l]=b.useState(!1),c=t.finish==="foil",u=t.card_faces?.length>1,h=c?t.prices?.usd_foil||t.prices?.usd||0:t.prices?.usd||0,f=Number(h),m=y=>{const{left:v,top:w,width:N,height:k}=y.currentTarget.getBoundingClientRect(),C=v+N/2,I=w+k/2,O=(y.clientX-C)/(N/2),L=(y.clientY-I)/(k/2),_=12;n({transform:`perspective(1000px) rotateY(${O*_}deg) rotateX(${-L*_}deg) scale3d(1.02, 1.02, 1.02)`,transition:"none"}),a({opacity:1,background:`radial-gradient(circle at ${50+O*50}% ${50+L*50}%, rgba(255,255,255,0.4) 0%, transparent 50%)`,transform:`translateX(${-O*20}px) translateY(${-L*20}px)`})},g=()=>{n({transform:"perspective(1000px) rotateY(0deg) rotateX(0deg) scale3d(1, 1, 1)",transition:"transform 0.5s ease-out"}),a({opacity:0,transition:"opacity 0.5s ease-out"})};return i.jsxs("div",{className:"relative group w-[300px] h-[480px] select-none cursor-pointer",onMouseMove:m,onMouseLeave:g,onClick:()=>u&&l(!o),style:{zIndex:r.transform?.includes("rotate")?50:1},children:[i.jsxs("div",{className:"w-full h-full rounded-[20px] transition-all duration-100 ease-out relative",style:{...r,transformStyle:"preserve-3d",boxShadow:"0 20px 40px -5px rgba(0,0,0,0.4), 0 10px 20px -5px rgba(0,0,0,0.3)",background:"linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%)",border:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("div",{className:"absolute inset-0 rounded-[20px] ring-1 ring-white/10 ring-inset pointer-events-none"}),i.jsxs("div",{className:"absolute top-2 left-2 right-2 h-14 bg-gray-100 rounded-t-[14px] flex items-center justify-between px-3 shadow-inner border-b border-gray-300 z-20",children:[i.jsxs("div",{className:"flex flex-col overflow-hidden",children:[i.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 tracking-wider",children:"MTG Forge Auth"}),i.jsx("span",{className:"text-xs font-bold text-gray-900 truncate w-40 font-mono tracking-tight",children:t.name})]}),i.jsxs("div",{className:"text-right flex flex-col items-end",children:[i.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest",children:t.range||"MINT"}),i.jsx("span",{className:"text-lg font-black text-red-600 leading-none",children:"10"})]})]}),i.jsx("div",{className:"absolute top-20 left-4 right-4 bottom-4 rounded-[4px] bg-[#111] shadow-[inset_0_0_15px_rgba(0,0,0,1)] flex items-center justify-center p-1 border border-white/5",children:i.jsxs("div",{className:"relative w-full h-full rounded-[3.5px] overflow-hidden",children:[i.jsx("img",{src:u&&o?t.card_faces?.[1]?.image_uris?.normal||t.card_faces?.[1]?.image_uris?.large:t.image_uris?.normal||t.image_uris?.large||t.card_faces?.[0]?.image_uris?.normal||t.card_faces?.[0]?.image_uris?.large,alt:t.name,className:"w-full h-full object-cover"}),c&&i.jsx("div",{className:"absolute inset-0 z-10 mix-blend-color-dodge opacity-40 pointer-events-none",style:{background:"linear-gradient(115deg, transparent 20%, rgba(255,255,255,0.4) 30%, rgba(255,0,255,0.3) 45%, rgba(0,255,255,0.3) 55%, rgba(255,255,255,0.4) 70%, transparent 80%)",backgroundSize:"300% 300%",animation:"holoShift 5s ease infinite alternate"}}),u&&i.jsx("div",{className:"absolute bottom-3 right-3 bg-black/60 backdrop-blur-md p-1.5 rounded-full border border-white/20 shadow-lg group-hover:scale-110 transition-transform z-20",children:i.jsx(Uy,{className:"w-4 h-4 text-yellow-400"})})]})}),i.jsx("div",{className:"absolute inset-0 rounded-[20px] pointer-events-none z-50 mix-blend-overlay",style:{...s,transition:"opacity 0.2s"}}),i.jsx("div",{className:"absolute -top-3 -left-3 w-10 h-10 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg border-2 border-[#0a0a0a] z-50 text-black font-black text-lg",style:{transform:"translateZ(30px)"},children:e}),i.jsxs("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 px-6 py-2 bg-black/90 backdrop-blur-xl rounded-full border border-yellow-500/50 shadow-[0_5px_20px_rgba(0,0,0,0.8)] z-50 flex flex-col items-center",style:{transform:"translateZ(40px)"},children:[i.jsx("span",{className:"text-[9px] text-gray-500 uppercase tracking-widest font-bold leading-none mb-0.5",children:"Market Price"}),i.jsxs("span",{className:"text-lg font-bold text-yellow-500 font-mono tracking-wide leading-none",children:["$",f.toFixed(2)]})]})]}),i.jsx("style",{jsx:!0,children:`
                @keyframes holoShift {
                    0% { background-position: 0% 50%; }
                    100% { background-position: 100% 50%; }
                }
            `})]})};function Olt(){const{cards:t,loading:e}=yo(),r=b.useMemo(()=>{if(!t)return{topCards:[],totalValue:0};const a=[...t.filter(l=>!l.is_wishlist&&!l.deck_id)].sort((l,c)=>{const u=Number((l.finish==="foil"?l.prices?.usd_foil:l.prices?.usd)||0);return Number((c.finish==="foil"?c.prices?.usd_foil:c.prices?.usd)||0)-u}).slice(0,10),o=a.reduce((l,c)=>{const u=Number((c.finish==="foil"?c.prices?.usd_foil:c.prices?.usd)||0);return l+u},0);return{topCards:a,totalValue:o}},[t]);return e?i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center text-yellow-600 font-mono animate-pulse",children:"ACCESSING VAULT..."}):i.jsxs("div",{className:"min-h-screen bg-[#050505] overflow-hidden relative font-sans text-gray-200 pb-20",children:[i.jsx("div",{className:"absolute top-[-20%] left-1/2 -translate-x-1/2 w-[80%] h-[60%] bg-yellow-600/10 blur-[150px] rounded-full pointer-events-none"}),i.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),i.jsxs("div",{className:"max-w-[1800px] mx-auto px-8 py-12 relative z-10",children:[i.jsxs("div",{className:"flex justify-between items-center mb-16",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-yellow-500 to-yellow-700 rounded-2xl flex items-center justify-center shadow-[0_0_40px_rgba(234,179,8,0.3)] border border-yellow-400/50",children:i.jsx(IO,{className:"w-8 h-8 text-black"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-600 tracking-tight",style:{fontFamily:"Playfair Display, serif"},children:"THE VAULT"}),i.jsx("p",{className:"text-yellow-500/60 font-mono tracking-[0.3em] text-sm uppercase mt-1",children:"Secure Storage // Level 5 Clearance"})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mb-1",children:"Vault Asset Value"}),i.jsxs("div",{className:"text-4xl font-black text-white font-mono flex items-center gap-2 justify-end",children:[i.jsx("span",{className:"text-yellow-500",children:"$"}),r.totalValue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),r.topCards.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-96 border border-gray-800 rounded-3xl bg-gray-900/30 backdrop-blur",children:[i.jsx(qke,{className:"w-16 h-16 text-gray-700 mb-4"}),i.jsx("h3",{className:"text-2xl font-bold text-gray-500",children:"Vault Empty"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Add cards to your collection to populate the vault."})]}):i.jsx("div",{className:"flex flex-wrap justify-center gap-12 perspective-2000",children:r.topCards.map((n,s)=>i.jsx("div",{className:"transform hover:z-50 transition-all duration-300",children:i.jsx(Llt,{card:n,rank:s+1})},n.id||s))})]}),i.jsx("style",{children:`
                .perspective-1000 { perspective: 1000px; }
                .perspective-2000 { perspective: 2000px; }
            `})]})}const Mlt=Ie.memo(({item:t,onUpdate:e,onViewDetails:r,onSwapFoil:n})=>{const[s,a]=b.useState(!1),o=t.reviewed,l=o&&t.scanned_qty===t.expected_qty,c=o&&t.scanned_qty!==t.expected_qty,u=!o,h=t.finish==="foil",f=t.card_data?.card_faces,m=f&&f.length>1;let g=t.image_uri,y=t.art_uri,v=t.name;if(m){const O=f[s?1:0];O.image_uris?.art_crop&&(y=O.image_uris.art_crop),O.image_uris?.large?g=O.image_uris.large:O.image_uris?.normal&&(g=O.image_uris.normal),v=O.name}const w=c,N=I=>{I.stopPropagation(),c||e(t.id,0,!0)},k=I=>{I.stopPropagation(),l||e(t.id,t.expected_qty,!0)},C=I=>{const O=parseInt(I.target.value);isNaN(O)||O<0||e(t.id,O,!0)};return i.jsxs("div",{onClick:()=>r(t),className:`group relative flex flex-col rounded-xl overflow-hidden border transition-all duration-300 hover:-translate-y-1 hover:shadow-xl cursor-pointer 
                ${l?"bg-gray-800/80 border-green-500/30 shadow-green-500/5":""}
                ${c?"bg-red-900/20 border-red-500/50 shadow-red-500/10":""}
                ${u?"bg-gray-800/40 border-gray-700/50 hover:border-gray-500/50":""}
            `,children:[i.jsxs("div",{className:"relative aspect-[4/3] bg-gray-900 w-full overflow-hidden",children:[y||g?i.jsx("img",{src:y||g,alt:v,loading:"lazy",className:"w-full h-full object-cover transition-transform group-hover:scale-110 duration-700"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-600",children:"No Image"}),i.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 transition-colors z-20 
                    ${l?"bg-green-500":""}
                    ${c?"bg-red-500":""}
                    ${u?"bg-gray-700":""}
                `}),i.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-wider shadow-lg backdrop-blur-md border z-10 
                    ${h?"bg-gradient-to-r from-yellow-600/90 to-yellow-400/90 text-white border-yellow-300/50":"bg-gray-900/80 text-gray-400 border-gray-600/50"}`,children:h?"Foil":"Normal"}),m&&i.jsxs("button",{onClick:I=>{I.stopPropagation(),a(!s)},className:"absolute bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 bg-black/60 hover:bg-black/80 text-white text-xs font-bold rounded-full backdrop-blur-sm border border-white/20 shadow-lg flex items-center gap-1 z-30 transition-all hover:scale-105",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Flip"]})]}),i.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[i.jsx("h3",{className:"text-white font-black text-lg leading-tight mb-1 truncate",title:v,children:v}),i.jsxs("div",{className:"text-xs text-gray-500 font-mono mb-4 flex items-center justify-between",children:[i.jsxs("span",{children:["#",t.collector_number,"  ",t.set_code.toUpperCase()]}),i.jsxs("span",{className:"text-gray-400 font-bold",children:["Goal: ",t.expected_qty]})]}),i.jsxs("div",{className:"mt-auto flex items-center justify-between gap-3",onClick:I=>I.stopPropagation(),children:[i.jsx("button",{onClick:N,disabled:c,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${c?"bg-red-500 text-white shadow-lg shadow-red-500/20":"text-gray-500 hover:text-red-400 hover:bg-red-500/10"}`,title:"Mark Mismatch (Set to 0)",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("div",{className:"relative flex-1",children:i.jsx("input",{type:"number",min:"0",value:t.scanned_qty,disabled:!w,onChange:C,className:`w-full bg-gray-900 border rounded-lg px-3 py-1.5 font-mono text-center focus:outline-none focus:ring-2 transition-colors 
                                ${l?"border-green-500/50 text-green-400 opacity-90 cursor-not-allowed":""}
                                ${c?"border-red-500/50 text-white focus:ring-red-500":""}
                                ${u?"border-gray-700 text-gray-400 cursor-not-allowed":""}
                            `})}),i.jsx("button",{onClick:k,disabled:l,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${l?"bg-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-500 hover:text-green-400 hover:bg-green-500/10"}`,title:"Confirm Match",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]})]})}),Rlt=({symbol:t,size:e="w-12 h-12"})=>i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${t.toUpperCase()}.svg`,alt:t,className:`${e} drop-shadow-md rounded-full bg-gray-900 border-2 border-white/10`,onError:r=>{r.target.style.display="none"}}),Dlt=({items:t})=>i.jsx("div",{className:"flex -space-x-4 items-center justify-center p-2",children:t.split("").map((e,r)=>i.jsx("div",{className:"z-10 transition-transform hover:scale-125 hover:z-20",title:e,children:i.jsx(Rlt,{symbol:e})},r))}),Blt=({type:t})=>{const e=t.toLowerCase(),r="w-12 h-12 text-gray-400 group-hover:text-indigo-400 transition-colors";return e.includes("artifact")?i.jsx(Pke,{className:"w-12 h-12 text-gray-400 group-hover:text-slate-300",strokeWidth:1.5}):e.includes("land")?i.jsx(u_e,{className:"w-12 h-12 text-gray-400 group-hover:text-amber-600",strokeWidth:1.5}):e.includes("creature")?i.jsx(i2,{className:"w-12 h-12 text-gray-400 group-hover:text-red-400",strokeWidth:1.5}):e.includes("enchantment")?i.jsx(Vy,{className:"w-12 h-12 text-gray-400 group-hover:text-yellow-400",strokeWidth:1.5}):e.includes("instant")?i.jsx(ud,{className:"w-12 h-12 text-gray-400 group-hover:text-blue-500",strokeWidth:1.5,fill:"currentColor",fillOpacity:.2}):e.includes("sorcery")?i.jsx(y_e,{className:"w-12 h-12 text-gray-400 group-hover:text-orange-500",strokeWidth:1.5}):e.includes("planeswalker")?i.jsx(rp,{className:"w-12 h-12 text-gray-400 group-hover:text-purple-500",strokeWidth:1.5}):i.jsx(Are,{className:r,strokeWidth:1})},Flt=({name:t,count:e,reviewed:r,onClick:n,type:s})=>{const a=(s==="color"||s==="color_identity")&&t!=="Unknown",o=s==="set"||s==="set_code",l=s==="type"||s==="type_line",c=Math.round(r/e*100)||0,u=c===100;return i.jsxs("div",{onClick:n,className:"group relative flex flex-col aspect-[4/3] bg-gray-800 rounded-xl overflow-hidden border border-gray-700 hover:border-indigo-500/50 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-indigo-900/40 to-transparent transition-all duration-500",style:{height:`${c}%`,top:"auto",bottom:0,opacity:.3}}),i.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-900/50 group-hover:bg-gray-800 transition-colors p-4 z-10",children:a?i.jsx(Dlt,{items:t}):o?i.jsx("img",{src:`https://svgs.scryfall.io/sets/${t.toLowerCase()}.svg`,alt:t,className:"w-20 h-20 opacity-70 group-hover:opacity-100 transition-opacity filter drop-shadow-lg",onError:h=>{h.target.style.display="none"}}):l?i.jsx(Blt,{type:t}):i.jsx("svg",{className:"w-16 h-16 text-gray-700 group-hover:text-indigo-500/50 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),i.jsxs("div",{className:"p-4 bg-gray-900/90 border-t border-gray-800 z-10 backdrop-blur-sm",children:[i.jsxs("div",{className:"flex justify-between items-start mb-1",children:[i.jsx("div",{className:"text-white font-bold truncate text-lg uppercase tracking-tight",children:t||"Unknown"}),u&&i.jsx("span",{className:"text-green-400",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),i.jsxs("div",{className:"flex items-center justify-between text-xs font-mono uppercase tracking-wider",children:[i.jsxs("span",{className:u?"text-green-400":"text-gray-500",children:[r," / ",e," Verified"]}),i.jsxs("span",{className:`font-bold ${u?"text-green-400":"text-indigo-400"}`,children:[c,"%"]})]}),i.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:`h-full transition-all duration-500 ${u?"bg-green-500":"bg-indigo-500"}`,style:{width:`${c}%`}})})]})]})};function $lt(){const{userProfile:t}=Cr(),{auditId:e}=cc(),[r]=mJ(),n=r.get("deckId"),s=r.get("group"),{openCardModal:a}=aw(),{addToast:o}=Tn(),[l,c]=b.useState(!1),[u,h]=b.useState(null),[f,m]=b.useState([]),[g,y]=b.useState(!0),[v,w]=b.useState(null),[N,k]=b.useState([]),[C,I]=b.useState(50),[O,L]=b.useState(!1),[_,E]=b.useState("all"),M=yn();b.useEffect(()=>{B(),n&&He.get(`/api/decks/${n}`).then(K=>w((K.deck||K).name)).catch(()=>{})},[e,n]);const B=async()=>{try{const K=await He.getActiveAudit();if(!K){alert("No active audit session found."),M("/dashboard");return}h(K);const ue=await He.getAuditItems(K.id,{deckId:n,group:s});m(ue)}catch(K){console.error(K)}finally{y(!1)}},{groupHierarchy:S,leafSortOrder:P}=b.useMemo(()=>{const K=t?.settings?.organization?.sortHierarchy;if(!K||K.length===0)return{groupHierarchy:[],leafSortOrder:["name"]};const ue=new Set(["set","color","color_identity","type","rarity","artist","power","toughness"]),fe=[],he=[];let le=0;for(const _e of K)le<2&&ue.has(_e)?(fe.push(_e),le++):he.push(_e);return he.includes("name")||he.push("name"),{groupHierarchy:fe,leafSortOrder:he}},[t]),R=(K,ue)=>{if(!ue)return"Unknown";let fe=K[ue];return ue==="type"||ue==="type_line"?fe=(K.type_line||K.card_data?.type_line||"Unknown").split("")[0].trim():ue==="set"||ue==="set_code"?fe=(K.set_code||K.card_data?.set||"???").toUpperCase():ue==="color"||ue==="colors"?(fe=K.colors||K.card_data?.colors,Array.isArray(fe)?fe=fe.join("")||"C":fe||(fe="C")):ue==="color_identity"?(fe=K.color_identity||K.card_data?.color_identity,Array.isArray(fe)?fe=fe.join("")||"C":fe||(fe="C")):ue==="rarity"?fe=K.rarity||K.card_data?.rarity||"common":ue==="artist"&&(fe=K.artist||K.card_data?.artist||"Unknown"),String(fe||"Unknown")},V=()=>f.filter(K=>N.every(ue=>R(K,ue.type)===ue.value)),ee=b.useMemo(()=>{let K=V();return _==="pending"?K=K.filter(ue=>!ue.reviewed):_==="mismatch"&&(K=K.filter(ue=>ue.reviewed&&ue.actual_quantity!==ue.expected_quantity)),K.sort((ue,fe)=>{for(const he of P){let le=0;if(he==="collector_number"){const _e=parseInt(ue.collector_number)||0,oe=parseInt(fe.collector_number)||0;le=_e-oe}else if(he==="price"){const _e=parseFloat(ue.prices?.usd||ue.card_data?.prices?.usd||0);le=parseFloat(fe.prices?.usd||fe.card_data?.prices?.usd||0)-_e}else if(he==="cmc"){const _e=parseFloat(ue.cmc||ue.card_data?.cmc||0),oe=parseFloat(fe.cmc||fe.card_data?.cmc||0);le=_e-oe}else he==="name"&&(le=(ue.name||"").localeCompare(fe.name||""));if(le!==0)return le}return 0})},[f,N,_,P]),G=b.useRef(),J=b.useCallback(K=>{g||(G.current&&G.current.disconnect(),G.current=new IntersectionObserver(ue=>{ue[0].isIntersecting&&C<ee.length&&I(fe=>fe+50)}),K&&G.current.observe(K))},[g,C,ee.length]),Z=O||N.length>=S.length,se=S[N.length],X=b.useMemo(()=>{if(Z)return[];const K={};return V().forEach(fe=>{const he=R(fe,se);K[he]||(K[he]={count:0,reviewed:0}),K[he].count++,fe.reviewed&&K[he].reviewed++}),Object.entries(K).map(([fe,he])=>({name:fe,count:he.count,reviewed:he.reviewed,type:se})).sort((fe,he)=>fe.name.localeCompare(he.name))},[f,N,Z,S]),q=K=>{L(!1),k([...N,{type:se,value:K}])},U=K=>{L(!1),k(K===-1?[]:N.slice(0,K+1))},[H,re]=b.useState({collectorNumber:"",finish:"nonfoil",setCode:"",isSubmitting:!1});b.useEffect(()=>{let K="";const ue=N.find(fe=>fe.type==="set"||fe.type==="set_code");ue?K=ue.value:s&&s.length<=4?K=s:u&&u.type==="set"&&u.target_id&&(K=u.target_id),K&&re(fe=>({...fe,setCode:K.toUpperCase()}))},[s,u,N]);const ae=async K=>{K.preventDefault();const{setCode:ue,collectorNumber:fe,finish:he}=H;if(!(!ue||!fe)){re(le=>({...le,isSubmitting:!0}));try{const le=await He.addAuditItem(u.id,{setCode:ue,collectorNumber:fe,finish:he,deckId:n||null});le.success&&le.item&&(m(_e=>_e.find(Oe=>Oe.id===le.item.id)?_e.map(Oe=>Oe.id===le.item.id?le.item:Oe):[..._e,le.item]),o(`Added ${le.item.name} #${le.item.collector_number}`,"success"),re(_e=>({..._e,collectorNumber:"",isSubmitting:!1})))}catch(le){console.error(le),o(le.message||"Failed to add card","error"),re(_e=>({..._e,isSubmitting:!1}))}}},xe=async(K,ue,fe=null)=>{const he=parseInt(ue);if(!(isNaN(he)||he<0)){m(le=>le.map(_e=>_e.id!==K?_e:{..._e,scanned_qty:he,reviewed:fe!==null?fe:_e.reviewed}));try{await He.updateAuditItem(u.id,K,he,fe)}catch(le){console.error(le)}}},Ne=async()=>{const K=ee.filter(fe=>!fe.reviewed);if(K.length===0){o("All items in this section are already reviewed.","info");return}if(!window.confirm(`Mark ${K.length} items as verified?`))return;y(!0);const ue=K.map(fe=>({id:fe.id,scanned_qty:fe.expected_qty,reviewed:!0}));m(fe=>fe.map(he=>{const le=ue.find(_e=>_e.id===he.id);return le?{...he,...le}:he}));try{await He.batchUpdateAuditItems(u.id,ue),o(`Verified ${K.length} items`,"success")}catch(fe){console.error(fe),o("Failed to batch verify items","error")}finally{y(!1)}},pe=ee.slice(0,C);return g?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-500 rounded-full"})}):u?i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 animate-fade-in pb-24",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-8 bg-gray-900/50 p-6 rounded-2xl border border-white/5 backdrop-blur-md sticky top-20 z-30 shadow-xl",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("button",{onClick:()=>M(`/audit/${u.id}`),className:"text-gray-500 hover:text-white flex items-center gap-2 text-sm font-bold mb-2",children:"Back to Hub"}),i.jsxs("h1",{className:"text-2xl font-black text-white flex items-center gap-3",children:[i.jsx("span",{className:"text-indigo-400",children:"Audit:"}),v||(S.length>0?S[0].replace("_"," ").replace(/\b\w/g,K=>K.toUpperCase()):u.type)]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-sm font-mono",children:[i.jsx("button",{onClick:()=>U(-1),className:`hover:text-white transition-colors py-1 px-2 rounded ${N.length===0?"text-white font-bold bg-gray-800":"text-gray-500"}`,children:"ROOT"}),N.map((K,ue)=>i.jsxs(Ie.Fragment,{children:[i.jsx("span",{className:"text-gray-600",children:"/"}),i.jsx("button",{onClick:()=>U(ue),className:`hover:text-white transition-colors py-1 px-2 rounded ${ue===N.length-1?"text-white font-bold bg-gray-800":"text-gray-500"}`,children:K.value})]},ue))]})]}),i.jsxs("div",{className:"flex gap-4 items-center",children:[Z&&i.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg flex text-xs font-bold",children:[i.jsx("button",{onClick:()=>E("all"),className:`px-3 py-1.5 rounded-md transition-colors ${_==="all"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"All"}),i.jsx("button",{onClick:()=>E("pending"),className:`px-3 py-1.5 rounded-md transition-colors ${_==="pending"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Pending"}),i.jsx("button",{onClick:()=>E("mismatch"),className:`px-3 py-1.5 rounded-md transition-colors ${_==="mismatch"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:"Mismatches"})]}),i.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 hover:bg-indigo-600/30 font-bold rounded-lg text-sm flex items-center gap-2 transition-all",title:"Verify Cards with Camera",children:[i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Scan Verify"]}),i.jsx("button",{onClick:Ne,className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg shadow-lg shadow-blue-500/20 text-sm flex items-center gap-2",children:"Finish Section"})]})]}),Z&&i.jsxs("div",{className:"sticky top-[168px] z-20 bg-gray-800/90 backdrop-blur border border-white/10 rounded-xl p-3 mb-6 flex flex-col md:flex-row items-center gap-4 shadow-lg",children:[i.jsx("span",{className:"text-xs font-bold uppercase text-gray-400 whitespace-nowrap px-2",children:"Found Missing Card?"}),i.jsxs("form",{onSubmit:ae,className:"flex-1 flex gap-2 w-full",children:[i.jsx("input",{type:"text",placeholder:"Set (e.g. KND)",className:"w-24 bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm font-mono uppercase focus:border-indigo-500 outline-none",value:H.setCode,onChange:K=>re({...H,setCode:K.target.value.toUpperCase()})}),i.jsx("input",{type:"text",placeholder:"# No.",className:"w-24 bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm font-mono focus:border-indigo-500 outline-none",value:H.collectorNumber,onChange:K=>re({...H,collectorNumber:K.target.value})}),i.jsxs("select",{className:"bg-gray-900 border border-gray-700 rounded px-3 py-1 text-white text-sm focus:border-indigo-500 outline-none",value:H.finish,onChange:K=>re({...H,finish:K.target.value}),children:[i.jsx("option",{value:"nonfoil",children:"Normal"}),i.jsx("option",{value:"foil",children:"Foil"})]}),i.jsx("button",{type:"submit",disabled:H.isSubmitting,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold px-4 py-1 rounded text-sm transition-colors flex items-center gap-1",children:H.isSubmitting?"...":i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]})})]})]}),Z?i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[pe.map(K=>i.jsx(Mlt,{item:K,onUpdate:xe,onViewDetails:ue=>a({...ue,data:ue.card_data}),onSwapFoil:()=>{}},K.id)),C<ee.length&&i.jsxs("div",{ref:J,className:"h-32 flex flex-col items-center justify-center col-span-full gap-2 p-4",children:[i.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-indigo-500 rounded-full"}),i.jsx("button",{onClick:()=>I(K=>K+50),className:"text-xs text-indigo-400 hover:text-white underline",children:"Load More"})]})]}):i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{onClick:()=>L(!0),className:"group relative flex flex-col aspect-[4/3] bg-gray-800/30 border-2 border-dashed border-gray-700/50 hover:border-indigo-500/50 hover:bg-gray-800 rounded-xl overflow-hidden cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl items-center justify-center p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-800 group-hover:bg-indigo-600/20 flex items-center justify-center mb-3 transition-colors",children:i.jsx("svg",{className:"w-8 h-8 text-gray-500 group-hover:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),i.jsx("span",{className:"text-white font-bold text-lg",children:"View All Cards"}),i.jsx("span",{className:"text-xs text-gray-500 font-mono mt-1 uppercase tracking-wider",children:"In this section"})]}),X.map(K=>i.jsx(Flt,{name:K.name,count:K.count,reviewed:K.reviewed,type:K.type,onClick:()=>q(K.name)},K.name))]}),i.jsx(W_,{isOpen:l,onClose:()=>c(!1),onFinish:async K=>{if(!K.length)return;let ue=0;const fe=[...f];for(const he of K){const le=fe.findIndex(_e=>_e.scryfall_id===he.scryfall_id&&(he.finish?_e.finish===he.finish:!0));if(le!==-1){const _e=fe[le],oe=(_e.scanned_qty||0)+he.quantity;fe[le]={..._e,scanned_qty:oe,reviewed:!0},He.updateAuditItem(u.id,_e.id,oe,!0).catch(console.error),ue++}}m(fe),ue>0?o(`Verified ${ue} cards in this audit session!`,"success"):o("No matching cards found in this session.","warning")}})]}):null}function DQ(){const{id:t}=cc(),[e,r]=b.useState(null),[n,s]=b.useState(null),[a,o]=b.useState(!0),[l,c]=b.useState(null),u=yn(),[h,f]=b.useState({isOpen:!1,type:null,onConfirm:()=>{}}),[m,g]=b.useState(!1),[y,v]=b.useState(""),[w,N]=b.useState(!1);b.useEffect(()=>{const P=()=>N(!0);return window.addEventListener("start-tour",P),localStorage.getItem("tour_seen_audit_tour_v1")||setTimeout(()=>N(!0),1e3),()=>window.removeEventListener("start-tour",P)},[]);const k=[{target:"h1",title:"Audit Dashboard",content:"Track the status of your collection verification."},{target:"#audit-progress",title:"Progress",content:"See your overall completion and accuracy."},{target:"#audit-decks",title:"Decks",content:"Audit specific decks card by card."},{target:"#audit-guide-btn",title:"Guide",content:"Read the full guide if you get stuck."}];b.useEffect(()=>{(async()=>{try{let R=t;if(!R){const V=await He.getActiveAudit();if(V)R=V.id;else return}if(R){const V=await He.get(`/api/audit/${R}/stats`);s(V);const ee=await He.getActiveAudit();r(ee)}}catch(R){console.error("Failed to load audit hub",R),c(R.message)}finally{o(!1)}})()},[t]);const C=(P,R)=>{f({isOpen:!0,type:P,onConfirm:R}),v("")},I=async()=>{const P=h.type==="cancel"?"delete":"complete";y.toLowerCase().trim()===P&&(await h.onConfirm(),f({isOpen:!1,type:null,onConfirm:()=>{}}))},O=()=>{e&&C("cancel",async()=>{try{await He.cancelAudit(e.id),u("/dashboard")}catch(P){alert("Failed to cancel: "+P.message)}})},L=()=>{C("finalize",async()=>{try{const P=await He.finalizeAudit(e.id),R=P&&P.stats?P.stats:n;u("/audit/complete",{state:{session:e,stats:R}})}catch(P){console.error("Finalize failed",P),alert("Finalize failed: "+P.message)}})};if(a)return i.jsx("div",{className:"p-8 text-center text-gray-400 animate-pulse",children:"Loading Audit..."});if(l)return i.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",l]});if(!e||!n)return i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"No Active Audit"}),i.jsx("button",{onClick:()=>u("/dashboard"),className:"px-4 py-2 bg-gray-700 rounded text-white",children:"Return to Dashboard"})]});const _=n.total_cards||1,E=n.total_reviewed||0,M=n.total_verified||0,B=Math.round(E/_*100),S=(P,R,V)=>{if(R===0)return"from-gray-800 to-gray-900 border-gray-700";if(V>0&&V>=R)return"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400";const ee=V/R;return ee===1?P===R?"from-green-900/40 to-green-900/20 border-green-500/50 hover:border-green-400":"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400":ee<.1?"from-gray-800/40 to-gray-800/20 border-gray-700/50 hover:border-gray-600":"from-yellow-900/40 to-yellow-900/20 border-yellow-500/50 hover:border-yellow-400"};return i.jsxs("div",{className:"min-h-screen bg-gray-900 p-8 pt-24 relative",children:[i.jsxs("div",{className:`max-w-7xl mx-auto space-y-8 animate-fade-in-up transition-all ${h.isOpen?"blur-sm pointer-events-none":""}`,children:[i.jsxs("div",{className:"flex justify-between items-end",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase px-2 py-1 rounded border border-indigo-500/30",children:"Audit in Progress"}),i.jsxs("span",{className:"text-gray-500 text-sm",children:["Started ",new Date(e.created_at).toLocaleDateString()]})]}),i.jsx("h1",{className:"text-4xl font-black text-white",children:"Audit the Forge"}),i.jsxs("p",{className:"text-gray-400 mt-2 flex items-center gap-2",children:["Verify decks and binder to reconcile your inventory.",i.jsxs("button",{onClick:()=>g(!0),id:"audit-guide-btn",className:"text-indigo-400 hover:text-indigo-300 font-bold ml-2 text-sm flex items-center gap-1 group/guide",children:[i.jsx("svg",{className:"w-4 h-4 transition-transform group-hover/guide:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Setup Guide"]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:O,className:"px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors font-medium text-sm",children:"Cancel Audit"}),i.jsx("button",{onClick:L,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold rounded-lg shadow-lg shadow-green-500/20 text-sm transition-all hover:scale-105",children:"Finalize Results"})]})]}),i.jsxs("div",{id:"audit-progress",className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700 relative overflow-hidden",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 relative z-10",children:[i.jsx("span",{className:"text-xl font-bold text-white",children:"Total Progress"}),i.jsxs("span",{className:"text-2xl font-mono text-indigo-400",children:[B,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-4 overflow-hidden relative z-10",children:i.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-500 h-full transition-all duration-1000 ease-out",style:{width:`${B}%`}})}),i.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-400 relative z-10",children:[i.jsxs("span",{children:[E," / ",_," Cards Reviewed (",M," Matched)"]}),i.jsxs("span",{children:[n.decks.length," Decks  ",Object.keys(n.collection.groups).length," Loose Groups"]})]})]}),n.decks.length>0&&i.jsxs("div",{id:"audit-decks",children:[i.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decks"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.decks.map(P=>i.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?deckId=${P.id}`),className:`relative group p-6 rounded-xl border transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${S(P.verified,P.total,P.reviewed)} overflow-hidden`,children:[i.jsx("h4",{className:"font-bold text-white text-lg truncate mb-1 relative z-10 text-left",children:P.name}),i.jsxs("div",{className:"text-sm text-gray-300 mb-4 flex justify-between relative z-10",children:[i.jsx("span",{children:P.colors?P.colors.join(""):"Colorless"}),i.jsx("span",{children:P.reviewed>=P.total?i.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," Complete"]}):i.jsxs("span",{children:[P.reviewed,"/",P.total," Done"]})})]}),i.jsx("div",{className:"w-full bg-black/30 rounded-full h-1.5 overflow-hidden relative z-10",children:i.jsx("div",{className:"bg-white/80 h-full transition-all",style:{width:`${P.reviewed/P.total*100}%`}})})]},P.id))})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Collection (Loose Cards)"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.collection.groups.map(P=>i.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?group=${P.name}`),className:`relative p-4 rounded-xl border text-left transition-all hover:brightness-110 bg-gradient-to-br ${S(P.verified,P.total,P.reviewed)} overflow-hidden group isolate`,children:[i.jsx("div",{className:"text-3xl font-black text-white/5 absolute -bottom-1 -right-1 select-none pointer-events-none transition-colors z-0 whitespace-nowrap transform rotate-0 origin-bottom-right",children:P.name}),i.jsx("h4",{className:"font-bold text-white text-md mb-2 relative z-10",children:P.name}),i.jsx("div",{className:"text-xs text-gray-300 relative z-10",children:P.reviewed>=P.total?i.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})," Complete"]}):i.jsxs("span",{children:[P.reviewed,"/",P.total," Done"]})})]},P.name)),n.collection.total>0&&n.collection.groups.length===0&&i.jsx("div",{className:"col-span-full text-gray-500 italic p-4",children:"No groups found for loose cards. (All cards might be in decks)"}),n.collection.total===0&&i.jsx("div",{className:"col-span-full border border-dashed border-gray-700 rounded-xl p-8 text-center text-gray-500",children:"No loose cards in this audit scope."})]})]}),n.mismatches&&n.mismatches.length>0&&i.jsxs("div",{className:"bg-gray-800/50 rounded-2xl border border-red-500/20 overflow-hidden mb-8",children:[i.jsx("div",{className:"p-6 border-b border-gray-700/50 flex items-center gap-3",children:i.jsx("h3",{className:"text-xl font-bold text-white",children:"Discrepancy Report"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-900/50 text-gray-400 text-xs uppercase tracking-wider",children:[i.jsx("th",{className:"p-4",children:"Card"}),i.jsx("th",{className:"p-4",children:"Set"}),i.jsx("th",{className:"p-4",children:"Location"}),i.jsx("th",{className:"p-4 text-center",children:"Expected"}),i.jsx("th",{className:"p-4 text-center",children:"Actual"}),i.jsx("th",{className:"p-4 text-right",children:"Diff"})]})}),i.jsx("tbody",{className:"text-sm divide-y divide-gray-700/50",children:n.mismatches.map(P=>{const R=P.expected_qty!==void 0?P.expected_qty:P.expected,V=P.scanned_qty!==void 0?P.scanned_qty:P.actual!==void 0?P.actual:0,ee=V-R;return i.jsxs("tr",{className:"text-white hover:bg-white/5 transition-colors",children:[i.jsxs("td",{className:"p-4 font-bold max-w-xs truncate",children:[P.name," ",P.finish==="foil"&&i.jsx("span",{className:"text-xs text-yellow-500 ml-1",children:"FOIL"})]}),i.jsxs("td",{className:"p-4 font-mono text-gray-400",children:[P.set_code.toUpperCase()," #",P.collector_number]}),i.jsx("td",{className:"p-4 text-gray-300",children:P.deck_name?i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500"})," ",P.deck_name]}):i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-500"})," Collection"]})}),i.jsx("td",{className:"p-4 text-center font-mono text-gray-400",children:R}),i.jsx("td",{className:"p-4 text-center font-mono font-bold",children:V}),i.jsx("td",{className:`p-4 text-right font-mono font-bold ${ee>0?"text-green-400":"text-red-400"}`,children:ee>0?`+${ee}`:ee})]},P.id)})})]})})]})]}),h.isOpen&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>f({...h,isOpen:!1})}),i.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-6 max-w-md w-full relative z-10 shadow-2xl animate-fade-in-up",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:h.type==="cancel"?"Delete Audit Session?":"Complete Audit?"}),i.jsx("p",{className:"text-gray-400 text-sm mb-6",children:h.type==="cancel"?"This will definitively DELETE this session and all progress. This cannot be undone.":"This will sync all verified counts to your collection. Cards in 'Reviewed' sections with mismatching counts will NOT be synced, only exact matches are auto-synced. Proceed?"}),i.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:["Type ",i.jsx("span",{className:"text-white select-none",children:h.type==="cancel"?"Delete":"Complete"})," to confirm"]}),i.jsx("input",{type:"text",value:y,onChange:P=>v(P.target.value),placeholder:h.type==="cancel"?"Delete":"Complete",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-600 focus:border-indigo-500 outline-none mb-6",autoFocus:!0}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>f({...h,isOpen:!1}),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),i.jsx("button",{onClick:I,disabled:y.toLowerCase().trim()!==(h.type==="cancel"?"delete":"complete"),className:`px-4 py-2 rounded-lg font-bold text-white transition-all ${y.toLowerCase().trim()===(h.type==="cancel"?"delete":"complete")?h.type==="cancel"?"bg-red-500 hover:bg-red-600":"bg-green-600 hover:bg-green-500":"bg-gray-700 opacity-50 cursor-not-allowed"}`,children:h.type==="cancel"?"Delete Audit":"Complete Audit"})]})]})]}),i.jsx(zO,{isOpen:m,onClose:()=>g(!1)}),i.jsx(zf,{steps:k,isOpen:w,onClose:()=>N(!1),tourId:"audit_tour_v1"})]})}function Ult(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),s=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(s),e&&(n.href=e),s.href=t,s.href}const zlt=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function lp(t){const e=[];for(let r=0,n=t.length;r<n;r++)e.push(t[r]);return e}let Px=null;function Afe(t={}){return Px||(t.includeStyleProperties?(Px=t.includeStyleProperties,Px):(Px=lp(window.getComputedStyle(document.documentElement)),Px))}function n_(t,e){const n=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return n?parseFloat(n.replace("px","")):0}function Vlt(t){const e=n_(t,"border-left-width"),r=n_(t,"border-right-width");return t.clientWidth+e+r}function qlt(t){const e=n_(t,"border-top-width"),r=n_(t,"border-bottom-width");return t.clientHeight+e+r}function Tfe(t,e={}){const r=e.width||Vlt(t),n=e.height||qlt(t);return{width:r,height:n}}function Hlt(){let t,e;try{e=process}catch{}const r=e&&e.env?e.env.devicePixelRatio:null;return r&&(t=parseInt(r,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Sc=16384;function Wlt(t){(t.width>Sc||t.height>Sc)&&(t.width>Sc&&t.height>Sc?t.width>t.height?(t.height*=Sc/t.width,t.width=Sc):(t.width*=Sc/t.height,t.height=Sc):t.width>Sc?(t.height*=Sc/t.width,t.width=Sc):(t.width*=Sc/t.height,t.height=Sc))}function s_(t){return new Promise((e,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>e(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=t})}async function Glt(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function Klt(t,e,r){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),a=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${e}`),s.setAttribute("height",`${r}`),s.setAttribute("viewBox",`0 0 ${e} ${r}`),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("externalResourcesRequired","true"),s.appendChild(a),a.appendChild(t),Glt(s)}const ac=(t,e)=>{if(t instanceof e)return!0;const r=Object.getPrototypeOf(t);return r===null?!1:r.constructor.name===e.name||ac(r,e)};function Ylt(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function Xlt(t,e){return Afe(e).map(r=>{const n=t.getPropertyValue(r),s=t.getPropertyPriority(r);return`${r}: ${n}${s?" !important":""};`}).join(" ")}function Qlt(t,e,r,n){const s=`.${t}:${e}`,a=r.cssText?Ylt(r):Xlt(r,n);return document.createTextNode(`${s}{${a}}`)}function BQ(t,e,r,n){const s=window.getComputedStyle(t,r),a=s.getPropertyValue("content");if(a===""||a==="none")return;const o=zlt();try{e.className=`${e.className} ${o}`}catch{return}const l=document.createElement("style");l.appendChild(Qlt(o,r,s,n)),e.appendChild(l)}function Jlt(t,e,r){BQ(t,e,":before",r),BQ(t,e,":after",r)}const FQ="application/font-woff",$Q="image/jpeg",Zlt={woff:FQ,woff2:FQ,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:$Q,jpeg:$Q,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ect(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function lD(t){const e=ect(t).toLowerCase();return Zlt[e]||""}function tct(t){return t.split(/,/)[1]}function hL(t){return t.search(/^(data:)/)!==-1}function rct(t,e){return`data:${e};base64,${t}`}async function Ife(t,e,r){const n=await fetch(t,e);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((a,o)=>{const l=new FileReader;l.onerror=o,l.onloadend=()=>{try{a(r({res:n,result:l.result}))}catch(c){o(c)}},l.readAsDataURL(s)})}const LT={};function nct(t,e,r){let n=t.replace(/\?.*/,"");return r&&(n=t),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),e?`[${e}]${n}`:n}async function cD(t,e,r){const n=nct(t,e,r.includeQueryParams);if(LT[n]!=null)return LT[n];r.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let s;try{const a=await Ife(t,r.fetchRequestInit,({res:o,result:l})=>(e||(e=o.headers.get("Content-Type")||""),tct(l)));s=rct(a,e)}catch(a){s=r.imagePlaceholder||"";let o=`Failed to fetch resource: ${t}`;a&&(o=typeof a=="string"?a:a.message),o&&console.warn(o)}return LT[n]=s,s}async function sct(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):s_(e)}async function ict(t,e){if(t.currentSrc){const a=document.createElement("canvas"),o=a.getContext("2d");a.width=t.clientWidth,a.height=t.clientHeight,o?.drawImage(t,0,0,a.width,a.height);const l=a.toDataURL();return s_(l)}const r=t.poster,n=lD(r),s=await cD(r,n,e);return s_(s)}async function act(t,e){var r;try{if(!((r=t?.contentDocument)===null||r===void 0)&&r.body)return await b3(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function oct(t,e){return ac(t,HTMLCanvasElement)?sct(t):ac(t,HTMLVideoElement)?ict(t,e):ac(t,HTMLIFrameElement)?act(t,e):t.cloneNode(Pfe(t))}const lct=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",Pfe=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function cct(t,e,r){var n,s;if(Pfe(e))return e;let a=[];return lct(t)&&t.assignedNodes?a=lp(t.assignedNodes()):ac(t,HTMLIFrameElement)&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?a=lp(t.contentDocument.body.childNodes):a=lp(((s=t.shadowRoot)!==null&&s!==void 0?s:t).childNodes),a.length===0||ac(t,HTMLVideoElement)||await a.reduce((o,l)=>o.then(()=>b3(l,r)).then(c=>{c&&e.appendChild(c)}),Promise.resolve()),e}function uct(t,e,r){const n=e.style;if(!n)return;const s=window.getComputedStyle(t);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):Afe(r).forEach(a=>{let o=s.getPropertyValue(a);a==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),ac(t,HTMLIFrameElement)&&a==="display"&&o==="inline"&&(o="block"),a==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),n.setProperty(a,o,s.getPropertyPriority(a))})}function dct(t,e){ac(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),ac(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function hct(t,e){if(ac(t,HTMLSelectElement)){const n=Array.from(e.children).find(s=>t.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function fct(t,e,r){return ac(e,Element)&&(uct(t,e,r),Jlt(t,e,r),dct(t,e),hct(t,e)),e}async function pct(t,e){const r=t.querySelectorAll?t.querySelectorAll("use"):[];if(r.length===0)return t;const n={};for(let a=0;a<r.length;a++){const l=r[a].getAttribute("xlink:href");if(l){const c=t.querySelector(l),u=document.querySelector(l);!c&&u&&!n[l]&&(n[l]=await b3(u,e,!0))}}const s=Object.values(n);if(s.length){const a="http://www.w3.org/1999/xhtml",o=document.createElementNS(a,"svg");o.setAttribute("xmlns",a),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const l=document.createElementNS(a,"defs");o.appendChild(l);for(let c=0;c<s.length;c++)l.appendChild(s[c]);t.appendChild(o)}return t}async function b3(t,e,r){return!r&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(n=>oct(n,e)).then(n=>cct(t,n,e)).then(n=>fct(t,n,e)).then(n=>pct(n,e))}const Lfe=/url\((['"]?)([^'"]+?)\1\)/g,mct=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,gct=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function xct(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function yct(t){const e=[];return t.replace(Lfe,(r,n,s)=>(e.push(s),r)),e.filter(r=>!hL(r))}async function bct(t,e,r,n,s){try{const a=r?Ult(e,r):e,o=lD(e);let l;return s||(l=await cD(a,o,n)),t.replace(xct(e),`$1${l}$3`)}catch{}return t}function vct(t,{preferredFontFormat:e}){return e?t.replace(gct,r=>{for(;;){const[n,,s]=mct.exec(r)||[];if(!s)return"";if(s===e)return`src: ${n};`}}):t}function Ofe(t){return t.search(Lfe)!==-1}async function Mfe(t,e,r){if(!Ofe(t))return t;const n=vct(t,r);return yct(n).reduce((a,o)=>a.then(l=>bct(l,o,e,r)),Promise.resolve(n))}async function Lx(t,e,r){var n;const s=(n=e.style)===null||n===void 0?void 0:n.getPropertyValue(t);if(s){const a=await Mfe(s,null,r);return e.style.setProperty(t,a,e.style.getPropertyPriority(t)),!0}return!1}async function wct(t,e){await Lx("background",t,e)||await Lx("background-image",t,e),await Lx("mask",t,e)||await Lx("-webkit-mask",t,e)||await Lx("mask-image",t,e)||await Lx("-webkit-mask-image",t,e)}async function Nct(t,e){const r=ac(t,HTMLImageElement);if(!(r&&!hL(t.src))&&!(ac(t,SVGImageElement)&&!hL(t.href.baseVal)))return;const n=r?t.src:t.href.baseVal,s=await cD(n,lD(n),e);await new Promise((a,o)=>{t.onload=a,t.onerror=e.onImageErrorHandler?(...c)=>{try{a(e.onImageErrorHandler(...c))}catch(u){o(u)}}:o;const l=t;l.decode&&(l.decode=a),l.loading==="lazy"&&(l.loading="eager"),r?(t.srcset="",t.src=s):t.href.baseVal=s})}async function jct(t,e){const n=lp(t.childNodes).map(s=>Rfe(s,e));await Promise.all(n).then(()=>t)}async function Rfe(t,e){ac(t,Element)&&(await wct(t,e),await Nct(t,e),await jct(t,e))}function kct(t,e){const{style:r}=t;e.backgroundColor&&(r.backgroundColor=e.backgroundColor),e.width&&(r.width=`${e.width}px`),e.height&&(r.height=`${e.height}px`);const n=e.style;return n!=null&&Object.keys(n).forEach(s=>{r[s]=n[s]}),t}const UQ={};async function zQ(t){let e=UQ[t];if(e!=null)return e;const n=await(await fetch(t)).text();return e={url:t,cssText:n},UQ[t]=e,e}async function VQ(t,e){let r=t.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,a=(r.match(/url\([^)]+\)/g)||[]).map(async o=>{let l=o.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,t.url).href),Ife(l,e.fetchRequestInit,({result:c})=>(r=r.replace(o,`url(${c})`),[o,c]))});return Promise.all(a).then(()=>r)}function qQ(t){if(t==null)return[];const e=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=t.replace(r,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=s.exec(n);if(c===null)break;e.push(c[0])}n=n.replace(s,"");const a=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(o,"gi");for(;;){let c=a.exec(n);if(c===null){if(c=l.exec(n),c===null)break;a.lastIndex=l.lastIndex}else l.lastIndex=a.lastIndex;e.push(c[0])}return e}async function _ct(t,e){const r=[],n=[];return t.forEach(s=>{if("cssRules"in s)try{lp(s.cssRules||[]).forEach((a,o)=>{if(a.type===CSSRule.IMPORT_RULE){let l=o+1;const c=a.href,u=zQ(c).then(h=>VQ(h,e)).then(h=>qQ(h).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?l+=1:s.cssRules.length)}catch(m){console.error("Error inserting rule from remote css",{rule:f,error:m})}})).catch(h=>{console.error("Error loading remote css",h.toString())});n.push(u)}})}catch(a){const o=t.find(l=>l.href==null)||document.styleSheets[0];s.href!=null&&n.push(zQ(s.href).then(l=>VQ(l,e)).then(l=>qQ(l).forEach(c=>{o.insertRule(c,o.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",a)}}),Promise.all(n).then(()=>(t.forEach(s=>{if("cssRules"in s)try{lp(s.cssRules||[]).forEach(a=>{r.push(a)})}catch(a){console.error(`Error while reading CSS rules from ${s.href}`,a)}}),r))}function Sct(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Ofe(e.style.getPropertyValue("src")))}async function Cct(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=lp(t.ownerDocument.styleSheets),n=await _ct(r,e);return Sct(n)}function Dfe(t){return t.trim().replace(/["']/g,"")}function Ect(t){const e=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(a=>{e.add(Dfe(a))}),Array.from(n.children).forEach(a=>{a instanceof HTMLElement&&r(a)})}return r(t),e}async function Act(t,e){const r=await Cct(t,e),n=Ect(t);return(await Promise.all(r.filter(a=>n.has(Dfe(a.style.fontFamily))).map(a=>{const o=a.parentStyleSheet?a.parentStyleSheet.href:null;return Mfe(a.cssText,o,e)}))).join(`
`)}async function Tct(t,e){const r=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await Act(t,e);if(r){const n=document.createElement("style"),s=document.createTextNode(r);n.appendChild(s),t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}}async function Ict(t,e={}){const{width:r,height:n}=Tfe(t,e),s=await b3(t,e,!0);return await Tct(s,e),await Rfe(s,e),kct(s,e),await Klt(s,r,n)}async function Pct(t,e={}){const{width:r,height:n}=Tfe(t,e),s=await Ict(t,e),a=await s_(s),o=document.createElement("canvas"),l=o.getContext("2d"),c=e.pixelRatio||Hlt(),u=e.canvasWidth||r,h=e.canvasHeight||n;return o.width=u*c,o.height=h*c,e.skipAutoScale||Wlt(o),o.style.width=`${u}`,o.style.height=`${h}`,e.backgroundColor&&(l.fillStyle=e.backgroundColor,l.fillRect(0,0,o.width,o.height)),l.drawImage(a,0,0,o.width,o.height),o}async function Lct(t,e={}){return(await Pct(t,e)).toDataURL()}const Oct=()=>i.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(20)].map((t,e)=>i.jsx("div",{className:"absolute animate-float-down",style:{left:`${Math.random()*100}%`,top:`-${Math.random()*20}%`,animationDuration:`${3+Math.random()*4}s`,animationDelay:`${Math.random()*2}s`,opacity:.6},children:i.jsx("div",{className:`w-3 h-3 rotate-45 ${["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500"][Math.floor(Math.random()*5)]}`})},e))});function Mct(){const t=Ca(),e=yn(),{userProfile:r}=Cr(),{state:n}=t,[s,a]=b.useState(0),[o,l]=b.useState(0);if(b.useEffect(()=>{if(!n||!n.session||!n.stats)e("/dashboard");else{const C=500+(n.stats.total_verified||0)*10;a(C),Ha.check({audits_completed:(r?.stats?.audits_completed||0)+1});const I=Ha.metrics.audits_completed||0,O=Ha.metrics.perfect_audits||0,L=n.stats.mismatches?.length===0&&n.stats.total_cards>=50;Ha.check({audits_completed:I+1,perfect_audits:L?O+1:O})}},[n,e]),b.useEffect(()=>{if(o<s){const C=setTimeout(()=>{l(I=>Math.min(I+Math.ceil(s/20),s))},30);return()=>clearTimeout(C)}},[o,s]),!n||!n.session||!n.stats)return null;const{stats:c,session:u}=n,h=c.mismatches||[],f=c.total_verified||0,m=c.total_cards||0,g=m>0?Math.round(f/m*100):0,y=C=>{const I=C.expected_qty!==void 0?C.expected_qty:C.expected,O=C.scanned_qty!==void 0?C.scanned_qty:C.actual!==void 0?C.actual:0;return{actual:parseInt(O||0),expected:parseInt(I||0)}},v=h.filter(C=>{const{actual:I,expected:O}=y(C);return I>O}),w=h.filter(C=>{const{actual:I,expected:O}=y(C);return I<O}),N=v.reduce((C,I)=>{const{actual:O,expected:L}=y(I);return C+(O-L)},0)+w.reduce((C,I)=>{const{actual:O,expected:L}=y(I);return C+(O-L)},0),k=async()=>{const C=document.getElementById("audit-report-node");if(C)try{const I=await Lct(C,{quality:.95,backgroundColor:"#111827",fontEmbedCSS:""}),O=document.createElement("a");O.download=`audit-report-${new Date().toISOString().split("T")[0]}.png`,O.href=I,O.click()}catch(I){console.error("Failed to generate image:",I),alert(`Failed to generate image: ${I.message||"Unknown error"}`)}};return i.jsxs("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/20 to-black pointer-events-none"}),i.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-500/10 via-gray-900/0 to-transparent pointer-events-none"}),i.jsx(Oct,{}),i.jsxs("div",{className:"max-w-4xl w-full relative z-10 animate-fade-in-up",children:[i.jsxs("div",{id:"audit-report-node",className:"p-4 rounded-3xl bg-gray-900/50 backdrop-blur-sm",children:[i.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl mb-6 text-center relative overflow-hidden group",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-400 via-indigo-500 to-purple-500"}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("div",{className:"inline-flex items-center justify-center p-4 bg-green-500/20 text-green-400 rounded-full mb-6 border border-green-500/30 shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:i.jsx(ra,{className:"w-12 h-12"})}),i.jsx("h1",{className:"text-4xl md:text-6xl font-black text-white mb-2 tracking-tight",children:"Audit Complete!"}),i.jsx("p",{className:"text-gray-400 text-lg mb-8",children:"Your collection metadata has been successfully updated."}),i.jsxs("div",{className:"inline-flex flex-col items-center justify-center bg-gray-900/50 rounded-2xl p-4 px-8 border border-indigo-500/30",children:[i.jsx("span",{className:"text-indigo-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Experience Gained"}),i.jsxs("span",{className:"text-4xl font-black text-white flex items-center gap-2",children:["+",o," ",i.jsx("span",{className:"text-xl text-indigo-500",children:"XP"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-gray-800/60 backdrop-blur-md rounded-2xl p-6 border border-white/5 flex flex-col items-center justify-center hover:bg-gray-800 transition-colors group",children:[i.jsx("div",{className:"text-green-400 mb-2 group-hover:scale-110 transition-transform",children:i.jsx(_ke,{className:"w-8 h-8"})}),i.jsxs("div",{className:"text-4xl font-black text-white mb-1",children:[g,"%"]}),i.jsx("div",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest",children:"Accuracy"})]}),i.jsxs("div",{className:"bg-gray-800/60 backdrop-blur-md rounded-2xl p-6 border border-white/5 flex flex-col items-center justify-center hover:bg-gray-800 transition-colors group",children:[i.jsx("div",{className:"text-yellow-400 mb-2 group-hover:scale-110 transition-transform",children:i.jsx(Lre,{className:"w-8 h-8"})}),i.jsx("div",{className:"text-4xl font-black text-white mb-1",children:h.length}),i.jsx("div",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest",children:"Discrepancies"})]}),i.jsxs("div",{className:"bg-gray-800/60 backdrop-blur-md rounded-2xl p-6 border border-white/5 flex flex-col items-center justify-center hover:bg-gray-800 transition-colors group",children:[i.jsx("div",{className:`${N>=0?"text-blue-400":"text-red-400"} mb-2 group-hover:scale-110 transition-transform`,children:i.jsx(V_,{className:`w-8 h-8 ${N<0?"rotate-180":""}`})}),i.jsxs("div",{className:"text-4xl font-black text-white mb-1",children:[N>0?"+":"",N]}),i.jsx("div",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest",children:"Net Card Count"})]})]}),h.length>0&&i.jsxs("div",{className:"bg-gray-800/60 backdrop-blur-md rounded-2xl border border-white/5 overflow-hidden mb-6",children:[i.jsx("div",{className:"p-4 border-b border-white/5 bg-gray-900/30 flex justify-between items-center",children:i.jsx("h3",{className:"font-bold text-white text-sm uppercase tracking-wide",children:"Change Log"})}),i.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[v.length>0&&i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"text-xs font-bold text-blue-400 uppercase mb-2",children:"Found (Added)"}),i.jsx("div",{className:"space-y-1",children:v.map((C,I)=>{const{actual:O,expected:L}=y(C);return i.jsxs("div",{className:"flex justify-between text-sm text-gray-300",children:[i.jsx("span",{children:C.name||C.card_name}),i.jsxs("span",{className:"font-mono text-blue-400",children:["+",O-L]})]},I)})})]}),w.length>0&&i.jsxs("div",{className:"p-4 border-t border-white/5",children:[i.jsx("h4",{className:"text-xs font-bold text-red-400 uppercase mb-2",children:"Missing (Removed)"}),i.jsx("div",{className:"space-y-1",children:w.map((C,I)=>{const{actual:O,expected:L}=y(C);return i.jsxs("div",{className:"flex justify-between text-sm text-gray-300",children:[i.jsx("span",{children:C.name||C.card_name}),i.jsx("span",{className:"font-mono text-red-400",children:O-L})]},I)})})]})]})]}),i.jsxs("div",{className:"mt-8 flex flex-col items-center justify-center opacity-80 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("img",{src:"/logo.png",alt:"MTG Forge",className:"h-8 w-auto opacity-90"}),i.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent",children:"MTG-Forge"})]}),i.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-widest",children:"Collection Verified"})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-center mt-6",children:[i.jsxs("button",{onClick:()=>e("/dashboard"),className:"flex items-center justify-center gap-2 px-8 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-bold transition-all",children:[i.jsx(Jke,{className:"w-5 h-5"}),"Back to Dashboard"]}),i.jsxs("button",{onClick:k,className:"flex items-center justify-center gap-2 px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:[i.jsx(PO,{className:"w-5 h-5"}),"Save as Image"]})]})]}),i.jsx("style",{children:`
                @keyframes float-down {
                    0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
                    10% { opacity: 1; }
                    90% { opacity: 1; }
                    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
                }
                .animate-float-down {
                    animation-name: float-down;
                    animation-timing-function: linear;
                    animation-iteration-count: infinite;
                }
            `})]})}function Rct(){const[t,e]=b.useState([]),[r,n]=b.useState(!1),[s,a]=b.useState(null);if(b.useEffect(()=>Ha.subscribe(c=>{e(u=>[...u,c])}),[]),b.useEffect(()=>{if(!r&&t.length>0){const l=t[0];a(l),e(u=>u.slice(1)),n(!0);const c=setTimeout(()=>{n(!1)},5e3);return()=>clearTimeout(c)}},[r,t]),!r||!s)return null;const o=i.jsx("div",{className:"fixed top-24 left-0 right-0 md:top-auto md:bottom-8 md:left-1/2 md:-translate-x-1/2 z-[100000] flex flex-col items-center pointer-events-none px-0 md:px-4",children:i.jsxs("div",{className:`
                flex items-center gap-4 bg-gray-950/90 border-y border-yellow-500/50 p-4 shadow-[0_0_50px_rgba(234,179,8,0.2)] relative overflow-hidden group pointer-events-auto
                w-full md:w-auto md:rounded-2xl md:border md:pr-12 md:animate-slide-up backdrop-blur-xl
                animate-fade-in-down md:animate-none
            `,children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:animate-shine pointer-events-none"}),i.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center shadow-lg transform rotate-3",children:i.jsx(ra,{className:"w-7 h-7 text-white drop-shadow-md"})}),i.jsxs("div",{className:"flex-grow md:flex-grow-0",children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-yellow-500 mb-0.5 text-center md:text-left",children:"Achievement Unlocked"}),i.jsx("h4",{className:"text-lg font-bold text-white leading-tight text-center md:text-left",children:s.title}),i.jsx("p",{className:"text-xs text-gray-400 mt-1 leading-snug text-center md:text-left",children:s.description}),i.jsxs("div",{className:"text-xs font-bold text-gray-500 mt-1 flex items-center justify-center md:justify-start gap-1",children:[s.xp," XP Gained"]})]}),i.jsx("button",{onClick:()=>n(!1),className:"absolute top-2 right-2 p-1 text-gray-500 hover:text-white cursor-pointer transition-colors",children:i.jsx(vu,{className:"w-4 h-4"})})]})});return Kn.createPortal(o,document.body)}const Dct=()=>{const t=yn(),{currentUser:e,userProfile:r}=Cr(),[n,s]=b.useState(""),[a,o]=b.useState(!1),[l,c]=b.useState(null),[u,h]=b.useState(null);b.useEffect(()=>{const g=Im();return h(g),g.on("connect_error",y=>{console.error("Socket Connection Error:",y),c("Connection to Game Server failed.")}),()=>{g&&g.disconnect()}},[]);const f=()=>{if(!u||!u.connected){c("Connecting to server... please wait."),u&&u.connect();return}const g=Math.floor(1e5+Math.random()*9e5).toString();u.emit("host-game",{pin:g},y=>{y.success?t(`/play/room/${y.roomId}`,{state:{pin:g,isHost:!0}}):c("Failed to create game: "+(y.error||"Unknown"))})},m=g=>{if(g.preventDefault(),n.length!==6){c("PIN must be 6 digits");return}t("/play/room/game-found-via-pin",{state:{pin:n,isHost:!1}})};return i.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/20 via-gray-900 to-black z-0"}),i.jsxs("div",{className:"relative z-10 w-full max-w-md space-y-8",children:[i.jsxs("div",{className:"text-center space-y-2",children:[i.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-wider",children:"The War Room"}),i.jsx("p",{className:"text-indigo-300 font-medium",children:"MTG Live Session"})]}),l&&i.jsx("div",{className:"bg-red-500/10 border border-red-500/50 text-red-200 p-3 rounded-lg text-center text-sm font-bold",children:l}),i.jsxs("div",{className:"grid gap-6",children:[i.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 p-6 rounded-2xl space-y-4",children:[i.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Join a Battle"}),i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Session PIN"}),i.jsx("input",{type:"text",maxLength:"6",placeholder:"000000",className:"w-full bg-black/50 border border-white/10 rounded-xl px-4 py-4 text-center text-3xl font-mono text-white tracking-[0.5em] focus:outline-none focus:border-indigo-500 transition-colors",value:n,onChange:g=>s(g.target.value.replace(/\D/g,""))})]}),i.jsx("button",{type:"submit",disabled:n.length!==6,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-500/20 transition-all transform active:scale-95 uppercase tracking-wider",children:"Enter Battlefield"})]})]}),i.jsxs("div",{className:"relative flex py-2 items-center",children:[i.jsx("div",{className:"flex-grow border-t border-white/10"}),i.jsx("span",{className:"flex-shrink-0 mx-4 text-gray-500 text-xs font-bold uppercase tracking-widest",children:"OR"}),i.jsx("div",{className:"flex-grow border-t border-white/10"})]}),i.jsxs("button",{onClick:f,className:"w-full bg-white/5 hover:bg-white/10 border border-white/10 text-white font-bold py-4 rounded-xl transition-all flex flex-col items-center justify-center gap-1 group",children:[i.jsx("span",{className:"uppercase tracking-wider",children:"Host New Session"}),i.jsx("span",{className:"text-[10px] text-gray-400 font-normal group-hover:text-indigo-300",children:"Generate a PIN for friends to join"})]})]}),i.jsx("div",{className:"text-center pt-8",children:i.jsx("button",{onClick:()=>t("/"),className:"text-gray-500 hover:text-white text-sm font-bold uppercase tracking-widest transition-colors",children:" Back to Base"})})]})]})},Bct=({isOpen:t,onClose:e,onApply:r,currentValue:n})=>{const[s,a]=b.useState(""),[o,l]=b.useState("subtract"),[c,u]=b.useState(null);if(!t)return null;const h=g=>{s.length>3||(a(y=>y+g),u(null))},f=()=>{a(g=>g.slice(0,-1)),u(null)},m=()=>{const g=parseInt(s,10);if(!g||isNaN(g)){e();return}if(!c&&g>=10){u(`Large change detected (${g}). Confirm?`);return}const y=o==="subtract"?-g:g;r(y),a(""),u(null),e()};return i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center pointer-events-none",children:[i.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm pointer-events-auto transition-opacity",onClick:e}),i.jsxs("div",{className:"bg-gray-900 border-t md:border border-gray-700 w-full md:w-[400px] md:rounded-2xl shadow-2xl overflow-hidden pointer-events-auto animate-slide-up md:animate-zoom-in p-6 z-10",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider",children:"Quick Math"}),i.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-full",children:i.jsx(vu,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"bg-black/40 rounded-xl p-4 mb-6 border border-white/5 flex items-center justify-between",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"Current Life"}),i.jsx("span",{className:"text-2xl font-mono text-gray-300",children:n})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:`text-4xl font-mono font-black ${o==="subtract"?"text-red-500":"text-green-500"}`,children:[o==="subtract"?"-":"+",s||"0"]}),i.jsxs("span",{className:"text-xs text-gray-500 font-bold uppercase self-end mb-1",children:["= ",n+parseInt(s||0)*(o==="subtract"?-1:1)]})]})]}),c&&i.jsxs("div",{className:"bg-yellow-500/10 text-yellow-500 p-3 rounded-lg border border-yellow-500/20 mb-4 flex items-center justify-center gap-2 animate-pulse",children:[i.jsx(Lre,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-bold",children:c})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[i.jsx("button",{onClick:()=>l("subtract"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="subtract"?"bg-red-500 text-white shadow-lg shadow-red-900/50":"bg-gray-800 text-gray-500"}`,children:"Damage"}),i.jsx("button",{onClick:()=>l("add"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="add"?"bg-green-500 text-white shadow-lg shadow-green-900/50":"bg-gray-800 text-gray-500"}`,children:"Life"})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[[1,2,3,4,5,6,7,8,9].map(g=>i.jsx("button",{onClick:()=>h(g),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:g},g)),i.jsx("button",{onClick:()=>h(0),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:"0"}),i.jsx("button",{onClick:f,className:"bg-gray-800 hover:bg-red-900/30 text-gray-400 hover:text-red-400 text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center",children:i.jsx(Dke,{className:"w-6 h-6"})}),i.jsx("button",{onClick:m,className:`bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center ${c?"animate-bounce":""}`,children:i.jsx(ih,{className:"w-8 h-8"})})]})]})]})},Fct=({life:t,onChange:e,isSelf:r=!1,label:n})=>{const[s,a]=b.useState(!1);return i.jsxs("div",{className:`flex flex-col items-center justify-center ${r?"h-full":"h-32"} w-full relative group`,children:[i.jsx("div",{className:"absolute inset-x-0 top-0 text-center py-2 z-10 pointer-events-none",children:i.jsx("span",{className:`${r?"text-sm text-gray-400":"text-xs text-gray-500"} font-black uppercase tracking-widest truncate max-w-[90%] inline-block shadow-black drop-shadow-md`,children:n})}),i.jsxs("div",{className:"flex w-full h-full",children:[i.jsx("button",{onClick:()=>e(-1),className:`flex-1 flex items-center justify-center ${r?"bg-red-900/20 hover:bg-red-900/40":"bg-red-900/10 hover:bg-red-900/20"} active:bg-red-500/30 transition-colors touch-manipulation`,children:i.jsx("span",{className:"sr-only",children:"Minus 1 Life"})}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:i.jsx("button",{onClick:()=>r&&a(!0),className:`pointer-events-auto ${r?"text-8xl md:text-9xl hover:scale-105 active:scale-95 cursor-pointer":"text-5xl"} font-black text-white tabular-nums drop-shadow-xl tracking-tighter transition-transform`,children:t})}),i.jsx("button",{onClick:()=>e(1),className:`flex-1 flex items-center justify-center ${r?"bg-green-900/20 hover:bg-green-900/40":"bg-green-900/10 hover:bg-green-900/20"} active:bg-green-500/30 transition-colors touch-manipulation`,children:i.jsx("span",{className:"sr-only",children:"Plus 1 Life"})})]}),i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[1px] h-1/2 bg-white/5 pointer-events-none"}),r&&i.jsx(Bct,{isOpen:s,onClose:()=>a(!1),currentValue:t,onApply:o=>e(o)})]})},Kv=({label:t,value:e,onChange:r,icon:n,color:s="text-white"})=>i.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[n&&i.jsx(n,{className:`w-5 h-5 ${s}`}),i.jsx("span",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:t})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>r(e-1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",disabled:e<=0,children:"-"}),i.jsx("span",{className:"text-2xl font-black text-white w-8 text-center tabular-nums",children:e}),i.jsx("button",{onClick:()=>r(e+1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",children:"+"})]})]}),$ct=({isOpen:t,onClose:e,players:r,myPlayerId:n,myCounters:s,myCommanderDamage:a,onUpdateCounter:o,onUpdateCmdDamage:l})=>{const[c,u]=b.useState("commander");if(!t)return null;const h=r.filter(f=>f.id!==n);return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm pointer-events-auto",onClick:e}),i.jsxs("div",{className:"bg-gray-900 w-full sm:max-w-md h-[80vh] sm:h-auto sm:rounded-3xl rounded-t-3xl border-t sm:border border-white/10 shadow-2xl flex flex-col pointer-events-auto relative overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[i.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-wider",children:"Resources"}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:i.jsx(vu,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"flex border-b border-white/5",children:[i.jsx("button",{onClick:()=>u("counters"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="counters"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Counters"}),i.jsx("button",{onClick:()=>u("commander"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="commander"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Commander Dmg"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[c==="counters"&&i.jsxs(i.Fragment,{children:[i.jsx(Kv,{label:"Poison",value:s.poison||0,onChange:f=>o("poison",f),icon:zy,color:"text-green-500"}),i.jsx(Kv,{label:"Energy",value:s.energy||0,onChange:f=>o("energy",f),icon:ud,color:"text-yellow-400"}),i.jsx(Kv,{label:"Experience",value:s.experience||0,onChange:f=>o("experience",f),icon:V_,color:"text-blue-400"}),i.jsx(Kv,{label:"Tax",value:s.commanderTax||0,onChange:f=>o("commanderTax",f),icon:AO,color:"text-gray-400"})]}),c==="commander"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-xs text-gray-500 text-center uppercase tracking-widest mb-4",children:"Damage taken from Commanders"}),h.length===0&&i.jsx("p",{className:"text-gray-500 text-center py-4",children:"No opponents found."}),h.map(f=>i.jsx(Kv,{label:f.name,value:a[f.id]||0,onChange:m=>l(f.id,m),icon:Nf,color:"text-red-400"},f.id))]})]})]})]})},Uct=({isOpen:t,onClose:e,finalState:r,onSave:n,roomId:s})=>{const{userProfile:a}=Cr(),[o,l]=b.useState(null),[c,u]=b.useState(null),[h,f]=b.useState([]),[m,g]=b.useState(!1),[y,v]=b.useState("summary");if(b.useEffect(()=>{t&&a&&He.get("/api/decks",{limit:100}).then(_=>f(Array.isArray(_)?_:_.decks||[])).catch(console.error)},[t,a]),!t||!r)return null;const{players:w,durationSeconds:N,startedAt:k,endedAt:C,logs:I}=r,O=_=>{const E=Math.floor(_/60),M=_%60;return`${E}m ${M}s`},L=async()=>{g(!0);try{const E=w.find(B=>B.id===o)?.userId||null,M={roomId:s,winnerId:E,startedAt:k,endedAt:C,logs:I||[],players:w.map(B=>({userId:B.userId||null,guestName:B.name,placement:B.id===o?1:2,life:B.life,deckId:B.deckId,socketId:B.id}))};await n(M)}catch(_){console.error("Failed to save match:",_)}finally{g(!1)}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-xl w-full max-w-lg shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-900/50 to-purple-900/50 p-6 text-center border-b border-white/5",children:[i.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center justify-center gap-3",children:[i.jsx(ra,{className:"w-8 h-8 text-yellow-500"}),"Game Over"]}),i.jsxs("p",{className:"text-gray-400 text-sm mt-2 font-mono",children:["Duration: ",O(N)]})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"flex p-1 bg-gray-800 rounded-lg",children:[i.jsx("button",{onClick:()=>v("summary"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${y==="summary"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Summary"}),i.jsx("button",{onClick:()=>v("report"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${y==="report"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Combat Report"})]}),y==="summary"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Select Winner"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:w.map(_=>i.jsxs("button",{onClick:()=>l(_.id),className:`p-3 rounded-lg border text-sm font-bold transition-all flex items-center justify-between ${o===_.id?"bg-yellow-500/10 border-yellow-500 text-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[i.jsx("span",{className:"truncate",children:_.name}),o===_.id&&i.jsx(ra,{className:"w-4 h-4"})]},_.id))})]}):i.jsx("div",{className:"h-64 w-full bg-gray-950/50 rounded-xl border border-white/5 p-4 flex flex-col justify-end relative overflow-hidden",children:!I||I.length===0?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"No battle data recorded."}):i.jsx(Qae,{players:w,logs:I})})]}),i.jsxs("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex gap-3",children:[i.jsx("button",{onClick:e,className:"flex-1 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-lg font-bold text-sm transition-colors",children:"Close"}),i.jsx("button",{onClick:L,disabled:!o||m,className:"flex-[2] py-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-bold text-sm transition-colors flex items-center justify-center gap-2 shadow-lg shadow-indigo-900/20",children:m?"Saving...":i.jsxs(i.Fragment,{children:[i.jsx(g_e,{className:"w-4 h-4"}),"Save Match History"]})})]})]})})};let Dn;const zct=()=>{const t=Ca(),e=yn(),{userProfile:r}=Cr(),{addToast:n}=Tn(),[s,a]=b.useState(null),[o,l]=b.useState(null),[c,u]=b.useState(null),[h,f]=b.useState(null),[m,g]=b.useState(!0),[y,v]=b.useState(!1),[w,N]=b.useState(!1),k=t.state?.pin,C=t.state?.isHost,[I,O]=b.useState(null),[L,_]=b.useState([]),[E,M]=b.useState(!1),[B,S]=b.useState(null),P=b.useRef(null),[R,V]=b.useState(null),ee=b.useRef(null),G=K=>{const ue=K.counters||{},he=(K.commanderDamage||{})[c]||0;return!he&&!ue.poison&&!ue.energy&&!ue.experience&&!ue.commanderTax?null:i.jsxs("div",{className:"flex items-center justify-center gap-2 absolute bottom-2 w-full px-2 pointer-events-none",children:[he>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-red-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[i.jsx(Nf,{className:"w-3 h-3"}),i.jsx("span",{className:"text-[10px] font-bold",children:he})]}),ue.poison>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-green-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[i.jsx(zy,{className:"w-3 h-3"}),i.jsx("span",{className:"text-[10px] font-bold",children:ue.poison})]}),ue.energy>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-yellow-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[i.jsx(ud,{className:"w-3 h-3"}),i.jsx("span",{className:"text-[10px] font-bold",children:ue.energy})]}),ue.experience>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-blue-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[i.jsx(V_,{className:"w-3 h-3"}),i.jsx("span",{className:"text-[10px] font-bold",children:ue.experience})]}),ue.commanderTax>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-gray-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[i.jsx(AO,{className:"w-3 h-3"}),i.jsx("span",{className:"text-[10px] font-bold",children:ue.commanderTax})]})]})};b.useEffect(()=>{r&&He.get("/api/decks",{limit:100}).then(K=>_(Array.isArray(K)?K:K.decks||[])).catch(K=>{console.error("Failed to load decks:",K),_([])})},[r]),b.useEffect(()=>{if(!E)return;Dn?Dn.disconnected&&Dn.connect():Dn=Im({transports:["websocket","polling"],reconnectionAttempts:5});const K=()=>{if(!k){f("No PIN provided. Please join from the lobby."),setTimeout(()=>e("/play/lobby"),3e3);return}const oe=r?.username||(C?"Host":"Guest");console.log("Emitting join-game..."),Dn.emit("join-game",{pin:k,name:oe,userId:r?.id,deckId:I==="generic"?null:I},Oe=>{console.log("Join response:",Oe),Oe.success?(P.current=Oe.roomId,u(Oe.playerId)):(S(Oe.error||"Failed to join game"),M(!1))})},ue=()=>{console.log("Connected to Game Socket:",Dn.id),K()},fe=oe=>{console.log("Game State Update:",oe),a(oe),g(!1)},he=({finalState:oe})=>{console.log("Game Over!",oe),l(oe),N(!0)},le=oe=>{console.error("Socket Connection Error:",oe),S("Connection error. Retrying...")},_e=({entry:oe})=>{oe.type==="note"&&n(`${oe.emoji} ${oe.note}`,"info",4e3)};return Dn.on("connect",ue),Dn.on("game-state-update",fe),Dn.on("game-over",he),Dn.on("connect_error",le),Dn.on("game-log-entry",_e),Dn.connected&&ue(),()=>{Dn.off("connect",ue),Dn.off("game-state-update",fe),Dn.off("game-over",he),Dn.off("connect_error",le),Dn.off("game-log-entry",_e),Dn&&Dn.disconnect(),Dn=null}},[k,C,r,e,E,I,n]);const J=K=>{ee.current&&clearTimeout(ee.current),V(K),ee.current=setTimeout(()=>{V(null)},5e3)},Z=()=>{if(R){if(R.type==="LIFE"){const K=-R.change;a(ue=>{const fe=ue.players.map(he=>he.id===c?{...he,life:he.life+K}:he);return{...ue,players:fe}}),Dn.emit("update-life",{roomId:P.current,change:K})}else if(R.type==="COUNTER"){const K=-R.change;Dn.emit("update-counters",{roomId:P.current,type:R.counterType,change:K})}else if(R.type==="CMDR_DMG"){const K=-R.change;Dn.emit("update-commander-damage",{roomId:P.current,targetId:R.targetId,change:K})}V(null),ee.current&&clearTimeout(ee.current)}},se=K=>{!Dn||!s||!c||!P.current||(J({type:"LIFE",change:K}),a(ue=>{const fe=ue.players.map(he=>he.id===c?{...he,life:he.life+K}:he);return{...ue,players:fe}}),Dn.emit("update-life",{roomId:P.current,change:K}))},X=(K,ue)=>{const fe=s.players.find(le=>le.id===c),he=ue-(fe.counters[K]||0);J({type:"COUNTER",counterType:K,change:he}),Dn.emit("update-counters",{roomId:P.current,type:K,change:he})},q=(K,ue)=>{const he=s.players.find(_e=>_e.id===c).commanderDamage[K]||0,le=ue-he;J({type:"CMDR_DMG",targetId:K,change:le}),Dn.emit("update-commander-damage",{roomId:P.current,targetId:K,change:le})},U=()=>{!Dn||!P.current||window.confirm("Are you sure you want to end the game for everyone?")&&Dn.emit("end-game",{roomId:P.current})},H=async K=>{try{const ue=await He.post("/api/matches",K);ue.success?(alert("Game saved successfully!"),N(!1),e("/play/lobby")):alert("Failed to save game: "+(ue.error||"Unknown error"))}catch(ue){console.error(ue),alert("Error saving game")}},re=K=>{!Dn||!P.current||Dn.emit("start-game",{roomId:P.current,firstPlayerId:K})},ae=()=>{!Dn||!P.current||Dn.emit("pass-turn",{roomId:P.current})},xe=()=>{if(!Dn||!P.current)return;const K=window.prompt("Add a note to the game log (e.g. 'Board Wipe', 'Infinite Combo'):");K&&K.trim()&&Dn.emit("add-log-note",{roomId:P.current,note:K.trim()})};if(h)return i.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 font-bold p-4 text-center",children:[h,i.jsx("button",{onClick:()=>e("/play/lobby"),className:"block mt-4 text-sm text-gray-500 hover:text-white underline mx-auto",children:"Return to Lobby"})]});if(B)return i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 p-4 text-center",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"font-bold",children:B}),i.jsx("button",{onClick:()=>S(null),className:"text-sm bg-red-500/10 hover:bg-red-500/20 px-4 py-2 rounded text-red-400",children:"Try Again"}),i.jsx("button",{onClick:()=>e("/play/lobby"),className:"block w-full text-sm text-gray-500 hover:text-white underline",children:"Return to Lobby"})]})});if(!E)return i.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 p-4 animate-fade-in",children:i.jsxs("div",{className:"w-full max-w-md space-y-8",children:[i.jsxs("div",{className:"text-center space-y-2",children:[i.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-widest",children:"Select Your Deck"}),i.jsx("p",{className:"text-gray-400",children:"Choose a deck to play with for this session."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:I||"",onChange:K=>O(K.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl p-4 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-lg",children:[i.jsx("option",{value:"",children:"-- Select a Deck --"}),i.jsx("option",{value:"generic",children:"Generic Deck (No stats)"}),L.map(K=>i.jsxs("option",{value:K.id,children:[K.name," (",typeof K.commander=="object"?K.commander?.name:K.commander||"No Commander",")"]},K.id))]}),i.jsxs("button",{onClick:()=>{I&&(M(!0),g(!0))},disabled:!I,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:[i.jsx(VI,{className:"w-5 h-5 fill-current"}),"Join Game"]})]}),i.jsx("div",{className:"text-center",children:i.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-sm text-gray-600 hover:text-gray-400 transition-colors",children:"Cancel and Return to Lobby"})})]})});if(m||!s)return i.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 space-y-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"}),i.jsx("div",{className:"text-gray-500 text-xs uppercase tracking-widest font-bold",children:"Connecting to War Room..."})]});const Ne=s.players.find(K=>K.id===c),pe=s.players.filter(K=>K.id!==c);return Ne?i.jsxs("div",{className:"flex flex-col h-[100dvh] bg-black overflow-hidden relative touch-none",children:[i.jsx("div",{className:"flex-1 bg-gray-900 grid grid-cols-2 gap-px border-b border-gray-800",children:pe.length>0?pe.map(K=>i.jsxs("div",{className:`relative flex flex-col items-center justify-center bg-gray-900 p-2 border group transition-colors duration-500 ${s.activePlayerId===K.id?"border-indigo-500 shadow-[inset_0_0_20px_rgba(79,70,229,0.2)]":"border-black/20"}`,children:[i.jsx("span",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest absolute top-2 w-full text-center truncate px-2",children:K.name}),i.jsx("span",{className:"text-4xl font-black text-white/90 mb-2",children:K.life}),G(K)]},K.id)):i.jsxs("div",{className:"col-span-2 flex flex-col items-center justify-center text-gray-600 space-y-2 p-6 text-center",children:[i.jsx("div",{className:"animate-pulse",children:"Waiting for opponents..."}),i.jsxs("div",{className:"text-xs font-mono bg-white/5 px-2 py-1 rounded",children:["PIN: ",k]})]})}),i.jsxs("div",{className:"h-12 bg-gray-950 shrink-0 flex items-center justify-between px-4 border-y border-white/5 z-20",children:[i.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-4",children:[i.jsxs("span",{children:["PIN: ",i.jsx("span",{className:"text-indigo-400 font-mono tracking-widest ml-1",children:k})]}),s.turnCount>0&&i.jsxs("span",{className:"bg-white/10 px-2 py-0.5 rounded text-gray-300",children:["Turn ",s.turnCount]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:xe,className:"p-2 text-gray-500 hover:text-white transition-colors",title:"Add Log Note",children:i.jsx(a_e,{className:"w-4 h-4"})}),C&&i.jsxs("button",{onClick:U,className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 text-[10px] uppercase font-bold px-3 py-1.5 rounded flex items-center gap-1.5 transition-colors border border-red-500/20",children:[i.jsx(Uke,{className:"w-3 h-3"}),"End Game"]}),i.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-[10px] uppercase font-bold text-gray-600 hover:text-white transition-colors",children:"Leave"})]})]}),i.jsxs("div",{className:`flex-[2] bg-gray-950 relative group transition-all duration-500 ${s.activePlayerId===c?"shadow-[inset_0_0_30px_rgba(79,70,229,0.15)] border-t-2 border-indigo-500":""}`,children:[i.jsx(Fct,{life:Ne.life,isSelf:!0,label:Ne.name,onChange:se}),i.jsx("button",{onClick:()=>v(!0),className:"absolute top-6 right-6 w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center border border-white/10 shadow-lg z-20 transition-colors",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:[i.jsx("path",{d:"M12 2v20"}),i.jsx("path",{d:"M2 12h20"}),i.jsx("path",{d:"m4.93 4.93 14.14 14.14"}),i.jsx("path",{d:"m19.07 4.93-14.14 14.14"})]})})]}),R&&i.jsx("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 z-[60] animate-fade-in-up",children:i.jsxs("button",{onClick:Z,className:"bg-gray-800/90 text-white px-6 py-3 rounded-full shadow-2xl border border-white/10 flex items-center gap-3 hover:bg-gray-700 transition-colors backdrop-blur-md",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),i.jsxs("div",{className:"flex flex-col items-start leading-none",children:[i.jsx("span",{className:"text-xs font-bold uppercase text-gray-400",children:"Undo"}),i.jsxs("span",{className:"font-bold text-sm",children:[R.type==="LIFE"&&`Life ${R.change>0?"+":""}${R.change}`,R.type==="COUNTER"&&`${R.counterType} ${R.change>0?"+":""}${R.change}`,R.type==="CMDR_DMG"&&`Cmd Dmg ${R.change>0?"+":""}${R.change}`]})]}),i.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),i.jsx("span",{className:"text-xs font-mono text-gray-500",children:"5s"})]})}),i.jsx($ct,{isOpen:y,onClose:()=>v(!1),players:s.players,myPlayerId:c,myCounters:Ne.counters,myCommanderDamage:Ne.commanderDamage,onUpdateCounter:X,onUpdateCmdDamage:q}),s.turnCount===0&&i.jsxs("div",{className:"absolute inset-0 z-40 bg-black/90 flex flex-col items-center justify-center p-6 space-y-6",children:[i.jsxs("div",{className:"text-center space-y-2",children:[i.jsx("h2",{className:"text-3xl font-black text-white tracking-widest uppercase",children:"Prepare for Battle"}),i.jsxs("p",{className:"text-gray-400",children:["Waiting for ",C?"you to start":"host to start","..."]}),i.jsx("div",{className:"pt-2",children:i.jsxs("div",{className:"inline-block bg-white/10 rounded px-4 py-2 border border-white/20",children:[i.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mr-2",children:"Session PIN"}),i.jsx("span",{className:"text-2xl font-mono font-bold text-indigo-400 tracking-widest",children:k})]})})]}),C&&i.jsxs("div",{className:"w-full max-w-sm space-y-4",children:[i.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Who goes first?"}),i.jsx("div",{className:"grid gap-2",children:s.players.map(K=>i.jsxs("button",{onClick:()=>re(K.id),className:"w-full p-4 bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-indigo-500 text-left rounded-xl transition-all flex items-center justify-between group",children:[i.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white",children:K.name}),i.jsx(VI,{className:"w-4 h-4 text-gray-600 group-hover:text-indigo-400"})]},K.id))})]})]}),s.turnCount>0&&s.activePlayerId===c&&i.jsx("div",{className:"absolute bottom-32 md:bottom-24 left-1/2 -translate-x-1/2 z-50 animate-bounce-message",children:i.jsxs("button",{onClick:ae,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-full font-bold shadow-lg shadow-indigo-900/50 flex items-center gap-2 transition-transform active:scale-95 border-2 border-indigo-400/50",children:[i.jsx(__e,{className:"w-5 h-5"}),"Pass Turn"]})}),i.jsx(Uct,{isOpen:w,onClose:()=>N(!1),finalState:o,onSave:H,roomId:P.current})]}):null},Vct=({title:t,subtitle:e,icon:r,actions:n})=>i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[r&&i.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl text-indigo-400 border border-indigo-500/20",children:i.jsx(r,{size:32})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:t}),e&&i.jsx("p",{className:"text-gray-400 mt-1 text-sm font-medium",children:e})]})]}),n&&i.jsx("div",{className:"flex items-center gap-2",children:n})]}),qct=()=>{const[t,e]=b.useState({friends:[],pending_sent:[],pending_received:[]}),[r,n]=b.useState(""),[s,a]=b.useState([]),[o,l]=b.useState(!0),[c,u]=b.useState(null);b.useEffect(()=>{h()},[]);const h=async()=>{try{const y=await He.get("/api/friends");e(y)}catch(y){console.error(y),u("Failed to load friends")}finally{l(!1)}},f=async()=>{if(!(r.length<3))try{const y=await He.get(`/api/friends/search?q=${encodeURIComponent(r)}`),v=new Set([...t.friends.map(w=>w.id),...t.pending_sent.map(w=>w.id),...t.pending_received.map(w=>w.id)]);a(y.filter(w=>!v.has(w.id)))}catch(y){console.error(y)}},m=async y=>{try{await He.post("/api/friends/request",{target_id:y}),a(v=>v.filter(w=>w.id!==y)),h()}catch(v){alert(v.response?.data?.error||"Failed to send request")}},g=async(y,v)=>{try{await He.post("/api/friends/respond",{friendship_id:y,action:v}),h()}catch(w){console.error(w)}};return i.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[i.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Find Friends"}),i.jsxs("div",{className:"flex gap-2 mb-4",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(z_,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),i.jsx("input",{type:"text",value:r,onChange:y=>n(y.target.value),onKeyDown:y=>y.key==="Enter"&&f(),placeholder:"Search by username...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg py-2 pl-10 pr-4 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsx("button",{onClick:f,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors",children:"Search"})]}),s.length>0&&i.jsx("div",{className:"bg-gray-900 rounded-lg overflow-hidden border border-gray-700",children:s.map(y=>i.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-800 last:border-0 hover:bg-gray-800/50 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-gray-300 font-bold",children:y.username[0].toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-medium",children:y.username}),i.jsx("div",{className:"text-xs text-gray-500",children:y.email})]})]}),i.jsxs("button",{onClick:()=>m(y.id),className:"flex items-center gap-2 px-3 py-1.5 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/10 rounded-lg text-sm transition-colors",children:[i.jsx(WI,{size:16}),"Add"]})]},y.id))})]}),(t.pending_received.length>0||t.pending_sent.length>0)&&i.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Pending Requests"}),i.jsxs("div",{className:"space-y-2",children:[t.pending_received.map(y=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 font-bold border border-indigo-500/30",children:y.username[0].toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-medium",children:y.username}),i.jsx("div",{className:"text-xs text-gray-400",children:"wants to be your friend"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>g(y.friendship_id,"accept"),className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[i.jsx(ih,{size:16})," Accept"]}),i.jsxs("button",{onClick:()=>g(y.friendship_id,"reject"),className:"bg-gray-700 hover:bg-red-600/80 text-gray-300 hover:text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[i.jsx(vu,{size:16})," Reject"]})]})]},y.id)),t.pending_sent.map(y=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/30 rounded-lg border border-gray-800 opacity-75",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-gray-500 font-bold",children:y.username[0].toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-300 font-medium",children:y.username}),i.jsx("div",{className:"text-xs text-gray-500",children:"Request sent"})]})]}),i.jsx("span",{className:"px-2 py-1 bg-gray-800 rounded text-xs text-gray-500 font-medium border border-gray-700",children:"Pending"})]},y.id))]})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-4",children:["My Friends (",t.friends.length,")"]}),t.friends.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-900/50 rounded-lg border border-dashed border-gray-700",children:[i.jsx(WI,{size:48,className:"mx-auto mb-4 opacity-20"}),i.jsx("p",{children:"You haven't added any friends yet."}),i.jsx("p",{className:"text-sm",children:"Search above to connect!"})]}):i.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.friends.map(y=>i.jsxs("div",{className:"flex items-center p-3 bg-gray-900 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors group",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-500/20 mr-4",children:y.username[0].toUpperCase()}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white font-bold",children:y.username}),y.lfg_status&&i.jsx("span",{className:"px-1.5 py-0.5 bg-green-500/20 text-green-400 text-[10px] font-bold uppercase rounded border border-green-500/30",children:"LFG"})]}),i.jsx("div",{className:"text-xs text-gray-500",children:y.email})]}),i.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-2 text-gray-500 hover:text-red-400 transition-all"})]},y.id))})]})]})},Hct=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(!0);return b.useEffect(()=>{(async()=>{try{const a=await He.get("/api/social/feed");e(a)}catch(a){console.error(a)}finally{n(!1)}})()},[]),r?i.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:[1,2,3].map(s=>i.jsx("div",{className:"h-32 bg-gray-800/50 rounded-xl animate-pulse"},s))}):t.length===0?i.jsxs("div",{className:"text-center py-16 max-w-lg mx-auto",children:[i.jsx("div",{className:"inline-flex p-4 rounded-full bg-gray-800 mb-4",children:i.jsx(i2,{size:48,className:"text-gray-600"})}),i.jsx("h3",{className:"text-xl font-bold text-gray-300 mb-2",children:"No recent activity"}),i.jsxs("p",{className:"text-gray-500",children:["Matches played by you and your friends will appear here.",i.jsx("br",{}),"Add friends to populate your feed!"]})]}):i.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:t.map(s=>i.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[i.jsx(i2,{size:20}),i.jsx("span",{className:"font-bold text-sm uppercase tracking-wide",children:"Commander Match"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:XAe(new Date(s.date),{addSuffix:!0})})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:s.participants.map(a=>i.jsxs("div",{className:`
                    flex items-center justify-between p-3 rounded-lg border 
                    ${a.outcome==="win"?"bg-amber-500/10 border-amber-500/30":"bg-gray-900/50 border-gray-800"}
                  `,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs
                        ${a.outcome==="win"?"bg-amber-500 text-black shadow-lg shadow-amber-500/20":"bg-gray-700 text-gray-300"}
                    `,children:a.username[0].toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:`text-sm font-bold ${a.outcome==="win"?"text-amber-200":"text-gray-300"}`,children:a.username}),i.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:a.deck||"Unknown Deck"})]})]}),a.outcome==="win"&&i.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-500/20 rounded text-amber-400 text-[10px] font-bold uppercase border border-amber-500/30",children:[i.jsx(rp,{size:12})," Winner"]})]},a.userId))})]},s.id))})},Wct=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(!0);b.useEffect(()=>{(async()=>{try{const o=await He.get("/api/social/leaderboard");e(o)}catch(o){console.error(o)}finally{n(!1)}})()},[]);const s=a=>a===0?{icon:i.jsx(ra,{size:20,className:"text-yellow-400"}),bg:"bg-yellow-500/10",border:"border-yellow-500/30"}:a===1?{icon:i.jsx(bU,{size:20,className:"text-gray-300"}),bg:"bg-gray-400/10",border:"border-gray-400/30"}:a===2?{icon:i.jsx(bU,{size:20,className:"text-amber-700"}),bg:"bg-orange-900/10",border:"border-orange-700/30"}:{icon:i.jsxs("span",{className:"text-gray-500 font-bold ml-1.5",children:["#",a+1]}),bg:"bg-transparent",border:"border-transparent"};return i.jsxs("div",{className:"max-w-3xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[i.jsx(ra,{className:"text-yellow-500",size:24}),i.jsx("h2",{className:"text-xl font-bold text-white",children:"Weekly Top Players"})]}),i.jsx("div",{className:"bg-gray-900/60 rounded-xl overflow-hidden border border-gray-800",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-900/80 text-gray-400 text-xs uppercase tracking-wider border-b border-gray-800",children:[i.jsx("th",{className:"p-4 w-20 text-center",children:"Rank"}),i.jsx("th",{className:"p-4",children:"Player"}),i.jsx("th",{className:"p-4 text-center",children:"Wins"}),i.jsx("th",{className:"p-4 text-center",children:"Games"}),i.jsx("th",{className:"p-4 text-center",children:"Win Rate"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-800",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Loading leaderboard..."})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No games played this week yet. Get out there!"})}):t.map((a,o)=>{const l=s(o),c=a.games_played>0?Math.round(a.wins/a.games_played*100):0;return i.jsxs("tr",{className:`hover:bg-gray-800/30 transition-colors ${o<3?"bg-gray-800/10":""}`,children:[i.jsx("td",{className:"p-4 text-center",children:i.jsx("div",{className:"flex justify-center items-center",children:l.icon})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs bg-gray-700 text-gray-200 border border-gray-600",children:a.username?a.username[0].toUpperCase():"?"}),i.jsx("span",{className:`font-bold ${o===0?"text-yellow-400":"text-gray-200"}`,children:a.username}),o===0&&i.jsx(rp,{size:14,className:"text-yellow-500"})]})}),i.jsx("td",{className:"p-4 text-center font-bold text-green-400 text-lg",children:a.wins}),i.jsx("td",{className:"p-4 text-center text-gray-400",children:a.games_played}),i.jsx("td",{className:"p-4 text-center",children:i.jsxs("span",{className:`
                                        inline-block px-2 py-1 rounded text-xs font-bold
                                        ${c>=50?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-gray-800 text-gray-400 border border-gray-700"}
                                    `,children:[c,"%"]})})]},a.user_id)})})]})})]})},Bfe=({tournaments:t,emptyMessage:e="No tournaments found."})=>{const r=yn();return!t||t.length===0?i.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[i.jsx(ra,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments"}),i.jsx("p",{className:"text-gray-500 mb-6",children:e})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(n=>i.jsxs("div",{onClick:()=>r(`/tournaments/${n.id}`),className:"group bg-gray-800/50 hover:bg-gray-800 border border-gray-700 hover:border-yellow-500/50 rounded-xl p-5 cursor-pointer transition-all hover:shadow-lg hover:shadow-yellow-500/10",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-yellow-400 transition-colors",children:n.name}),i.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase tracking-wider ${n.status==="active"?"bg-green-500/20 text-green-400":n.status==="completed"?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-400"}`,children:n.status})]}),i.jsxs("div",{className:"space-y-2 text-sm text-gray-400 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Tre,{className:"w-4 h-4"}),new Date(n.created_at).toLocaleDateString()]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ra,{className:"w-4 h-4"}),n.format.toUpperCase()]})]}),i.jsxs("div",{className:"flex items-center text-yellow-500 text-sm font-medium group-hover:translate-x-1 transition-transform",children:["Manage Tournament ",i.jsx(oke,{className:"w-4 h-4 ml-1"})]})]},n.id))})},Ffe=({isOpen:t,onClose:e,onCreated:r})=>{const n=yn(),[s,a]=b.useState(""),[o,l]=b.useState("swiss"),[c,u]=b.useState(""),[h,f]=b.useState(!1),m=async g=>{g.preventDefault(),f(!0);try{const y={name:s||"New Tournament",format:o,settings:{total_rounds:o==="elimination"&&c?parseInt(c,10):null,target_points:o==="swiss"&&c?parseInt(c,10):null}},v=await He.post("/api/tournaments",y);a(""),l("swiss"),u(""),f(!1),r?r(v):(e(),n(`/tournaments/${v.id}`))}catch(y){console.error("Failed to create tournament",y),f(!1),alert("Failed to create tournament. Please try again.")}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md p-6 shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Create Tournament"}),i.jsxs("form",{onSubmit:m,children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Event Name"}),i.jsx("input",{autoFocus:!0,type:"text",value:s,onChange:g=>a(g.target.value),placeholder:"e.g. Friday Night Magic",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none mb-4",required:!0}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Format"}),i.jsxs("select",{value:o,onChange:g=>l(g.target.value),className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none",children:[i.jsx("option",{value:"swiss",children:"Swiss (Points)"}),i.jsx("option",{value:"elimination",children:"Single Elimination"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:o==="swiss"?"Target Points (Optional)":"Round Limit (Optional)"}),i.jsx("input",{type:"number",min:"1",value:c,onChange:g=>u(g.target.value),placeholder:o==="swiss"?"e.g. 12":"Auto",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none"})]})]}),o==="swiss"&&i.jsxs("div",{className:"text-xs text-gray-500 mb-6 bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[i.jsx("span",{className:"font-bold text-yellow-500",children:"Note:"})," Wins are 3 points, Draws are 1 point. Setting a target will end the tournament once a player reaches this score."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 hover:bg-gray-800 rounded-lg text-gray-400 font-medium transition-colors",disabled:h,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-6 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors disabled:opacity-50",disabled:h,children:h?"Creating...":"Create Event"})]})]})]})}):null},Gct=()=>{const{user:t,userProfile:e,refreshUserProfile:r}=Cr(),[n,s]=mJ(),[a,o]=b.useState(n.get("tab")||"feed"),[l,c]=b.useState(!1),[u,h]=b.useState([]),[f,m]=b.useState(!1),[g,y]=b.useState(!1),[v,w]=b.useState(!1);b.useEffect(()=>{const O=()=>w(!0);return window.addEventListener("start-tour",O),localStorage.getItem("tour_seen_social_tour_v1")||setTimeout(()=>w(!0),1e3),()=>window.removeEventListener("start-tour",O)},[]);const N=[{target:"h1",title:"Social Hub",content:"Connect with friends and the community."},{target:"#social-lfg-toggle",title:"Looking for Game",content:"Toggle this on to let your friends know you are ready to play."},{target:"#social-tabs",title:"Navigation",content:"Switch between Activity Feed, Friends, Leaderboards, and Tournaments."}];b.useEffect(()=>{e?.lfg_status!==void 0&&c(e.lfg_status)},[e]),b.useEffect(()=>{a==="tournaments"&&k(),s({tab:a},{replace:!0})},[a,s]);const k=async()=>{try{m(!0);const O=await He.get("/api/tournaments");h(O||[])}catch(O){console.error("Failed to fetch tournaments",O)}finally{m(!1)}},C=async()=>{const O=!l;c(O);try{e?.id&&(await He.updateUser(e.id,{lfg_status:O}),r&&await r())}catch(L){console.error("Failed to update LFG status",L),c(!O)}},I=[{id:"feed",label:"Activity Feed",icon:UI},{id:"friends",label:"Friends",icon:Xm},{id:"leaderboard",label:"Leaderboard",icon:ra},{id:"tournaments",label:"Tournaments",icon:i2}];return i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[i.jsx(Vct,{title:"Social Hub",subtitle:"Connect with friends and track the meta.",icon:Xm}),i.jsx("div",{className:`p-4 rounded-xl border transition-colors ${l?"bg-green-500/10 border-green-500/30":"bg-gray-900 border-gray-800"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{id:"social-lfg-toggle",onClick:C,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900 ${l?"bg-green-500":"bg-gray-700"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l?"translate-x-6":"translate-x-1"}`})}),i.jsxs("div",{children:[i.jsx("div",{className:`text-sm font-bold ${l?"text-green-400":"text-gray-400"}`,children:"Looking for Game"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Signal your friends you're ready to play"})]})]})})]}),i.jsxs("div",{className:"bg-gray-900/40 border border-white/5 rounded-2xl overflow-hidden backdrop-blur-sm",children:[i.jsx("div",{className:"border-b border-white/5",children:i.jsx("div",{className:"flex overflow-x-auto",id:"social-tabs",children:I.map(O=>{const L=O.icon,_=a===O.id;return i.jsxs("button",{onClick:()=>o(O.id),className:`flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${_?"border-indigo-500 text-indigo-400 bg-indigo-500/5":"border-transparent text-gray-400 hover:text-gray-200 hover:bg-white/5"}`,children:[i.jsx(L,{size:18}),O.label]},O.id)})})}),i.jsxs("div",{className:"p-6",children:[a==="feed"&&i.jsx(Hct,{}),a==="friends"&&i.jsx(qct,{}),a==="leaderboard"&&i.jsx(Wct,{}),a==="tournaments"&&(f?i.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading Tournaments..."}):i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg text-sm transition-colors",children:[i.jsx(i2,{className:"w-4 h-4"}),"Create Tournament"]})}),i.jsx(Bfe,{tournaments:u,emptyMessage:"No active tournaments found based on filters."})]}))]})]}),i.jsx(Ffe,{isOpen:g,onClose:()=>y(!1)}),i.jsx(zf,{steps:N,isOpen:v,onClose:()=>w(!1),tourId:"social_tour_v1"})]})},Kct=()=>{const{currentUser:t,userProfile:e}=Cr(),[r,n]=b.useState([]),[s,a]=b.useState(!0),[o,l]=b.useState(null);return b.useEffect(()=>{if(!e?.id)return;(async()=>{a(!0);try{const u=await sse.findMatches(e.id);n(u)}catch(u){console.error("Trade fetch error:",u),l("Failed to load trade matches.")}finally{a(!1)}})()},[e]),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[i.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-xl",children:i.jsx("span",{className:"text-3xl",children:""})}),"The Armory"]}),i.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Automated Trade Matches with your Pod"})]}),i.jsx("div",{className:"flex gap-4",children:i.jsxs("div",{className:"bg-gray-800 rounded-xl px-4 py-2 border border-gray-700 text-center",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Matches"}),i.jsx("div",{className:"text-xl font-bold text-white",children:r.length})]})})]}),s?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((c,u)=>i.jsx("div",{className:"h-32 bg-gray-800 rounded-xl animate-pulse"},u))}):o?i.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 p-6 rounded-xl text-center text-red-300",children:[i.jsx("p",{children:o}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-900/50 hover:bg-red-800 rounded-lg text-white text-sm",children:"Retry"})]}):r.length===0?i.jsxs("div",{className:"text-center py-20 bg-gray-900/50 rounded-2xl border border-gray-800",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Matches Found"}),i.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"We couldn't find anyone in your Pod who has cards from your Wishlist in their Public Binders."}),i.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[i.jsx(Hr,{to:"/binders",className:"px-5 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-bold",children:"Update Binders"}),i.jsx(Hr,{to:"/wishlist",className:"px-5 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold",children:"Update Wishlist"})]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((c,u)=>i.jsxs("div",{className:"bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-indigo-500/50 rounded-xl p-4 flex gap-4 transition-all group relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-indigo-500/5 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none"}),i.jsx("div",{className:"relative w-24 min-w-[6rem] aspect-[2.5/3.5] rounded-lg overflow-hidden shadow-lg border border-black/50",children:c.image?i.jsx("img",{src:c.image,alt:c.cardName,className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center text-xs text-gray-500",children:"No Img"})}),i.jsxs("div",{className:"flex flex-col justify-between flex-1 min-w-0 z-10",children:[i.jsxs("div",{children:[i.jsx("div",{className:"flex justify-between items-start",children:i.jsx("h3",{className:"text-lg font-bold text-white truncate",children:c.cardName})}),i.jsxs("div",{className:"text-xs text-indigo-400 font-mono mt-1",children:[c.set?.toUpperCase(),"  ",c.finish]}),i.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[i.jsx("div",{className:"text-xs text-gray-400",children:"Available from:"}),i.jsx(Hr,{to:`/profile/${c.friendId}`,className:"px-2 py-0.5 bg-indigo-900/30 text-indigo-300 rounded text-xs font-bold border border-indigo-500/20 hover:bg-indigo-500 hover:text-white transition-colors cursor-pointer",children:c.friendName})]}),i.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Quantity: ",c.quantity]})]}),i.jsxs("button",{onClick:()=>alert(`Requesting ${c.cardName} from ${c.friendName}... (Feature Coming Soon)`),className:"mt-3 w-full py-2 bg-gray-700 hover:bg-indigo-600 text-white text-xs font-bold uppercase rounded-lg transition-colors flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Request Trade"]})]})]},`${c.cardId}-${u}`))})]})},Yct={analyze(t){if(!t||t.length<10)return null;const e={colors:{W:0,U:0,B:0,R:0,G:0,C:0},types:{Creature:0,Instant:0,Sorcery:0,Artifact:0,Enchantment:0,Planeswalker:0,Land:0},totalCmc:0,nonLandCount:0};t.forEach(m=>{const g=m.data||m,y=g.colors;!y||!Array.isArray(y)||y.length===0?e.colors.C++:y.forEach(w=>{e.colors[w]!==void 0&&e.colors[w]++});const v=(g.type_line||"").toLowerCase();v.includes("creature")&&e.types.Creature++,v.includes("instant")&&e.types.Instant++,v.includes("sorcery")&&e.types.Sorcery++,v.includes("artifact")&&e.types.Artifact++,v.includes("enchantment")&&e.types.Enchantment++,v.includes("planeswalker")&&e.types.Planeswalker++,v.includes("land")&&e.types.Land++,v.includes("land")||(e.totalCmc+=g.cmc||0,e.nonLandCount++)});const n=Object.entries(e.colors).filter(([m,g])=>m!=="C").sort((m,g)=>g[1]-m[1]).slice(0,2).filter(m=>m[1]>t.length*.1),s=n.map(m=>m[0]).sort().join(""),a={WU:"Azorius",UB:"Dimir",BR:"Rakdos",RG:"Gruul",GW:"Selesnya",WB:"Orzhov",BG:"Golgari",GU:"Simic",UR:"Izzet",RW:"Boros"};let o="";n.length===0?o="Colorless":n.length===1?o=`Mono-${{W:"White",U:"Blue",B:"Black",R:"Red",G:"Green"}[n[0][0]]}`:n.length===2?o=a[s]||"Dual-Color":o="Multicolor";let l="Novice",c="";const u={};Object.keys(e.types).forEach(m=>u[m]=e.types[m]/t.length);const h=e.nonLandCount>0?e.totalCmc/e.nonLandCount:0;return u.Artifact>.15?(l="Artificer",c="Forging victory from steel and stone."):u.Instant+u.Sorcery>.3?(l="Spellslinger",c="Control the stack, control the game."):u.Creature>.4?h>3.5?(l="Behemoth",c="Crushing foes with massive threats."):(l="Tactician",c="Overwhelming boards with numbers."):u.Enchantment>.15?(l="Enchantress",c="Weaving magic into permanent reality."):u.Planeswalker>.05?(l="Superfriend",c="Summoning allies from across the multiverse."):h<2?(l="Speedster",c="Efficiency is the key to victory."):(l="General",c="Balanced and ready for anything."),{title:`${o} ${l}`,className:l,colorName:o,colorKey:s,flavor:c,stats:{topColors:n,counts:e.types}}}},Xct=({archetype:t})=>{if(!t)return null;const e=n=>n.includes("W")?"from-yellow-100 to-yellow-300 text-yellow-900":n.includes("U")?"from-blue-400 to-blue-600 text-white":n.includes("B")?"from-gray-700 to-black text-white":n.includes("R")?"from-red-500 to-orange-500 text-white":n.includes("G")?"from-green-500 to-emerald-700 text-white":"from-gray-400 to-gray-600 text-white",r=t.colorKey?e(t.colorKey):"from-indigo-500 to-purple-600 text-white";return i.jsxs("div",{className:"relative group cursor-default",children:[i.jsxs("div",{className:`
                relative overflow-hidden
                bg-gradient-to-br ${r}
                rounded-xl p-6 shadow-xl border border-white/10
                transform transition-all duration-500
                hover:scale-105 hover:shadow-2xl
            `,children:[i.jsx("div",{className:"absolute inset-0 opacity-20 mix-blend-overlay bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"}),i.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[i.jsx("div",{className:"mb-2 p-2 bg-white/20 backdrop-blur-sm rounded-full shadow-inner",children:i.jsx(rp,{className:"w-8 h-8 drop-shadow-md"})}),i.jsx("h3",{className:"text-2xl font-black uppercase tracking-tight leading-none mb-1 drop-shadow-lg",children:t.title}),i.jsx("div",{className:"h-0.5 w-12 bg-white/40 my-2 rounded-full"}),i.jsxs("p",{className:"text-sm font-medium opacity-90 italic",children:['"',t.flavor,'"']})]})]}),i.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-4 w-64 bg-gray-900/95 backdrop-blur-xl border border-gray-700 rounded-xl p-4 shadow-2xl opacity-0 group-hover:opacity-100 transition-all pointer-events-none z-50 translate-y-2 group-hover:translate-y-0",children:[i.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Collection Analysis"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-400",children:"Creatures"}),i.jsx("span",{className:"text-white font-mono",children:t.stats.counts.Creature||0})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-400",children:"Instants/Sorc"}),i.jsx("span",{className:"text-white font-mono",children:(t.stats.counts.Instant||0)+(t.stats.counts.Sorcery||0)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-400",children:"Artifacts"}),i.jsx("span",{className:"text-white font-mono",children:t.stats.counts.Artifact||0})]})]})]})]})},Qct=({playstyle:t,isOwnProfile:e,onRetake:r,canRegenerate:n=!0})=>{if(!t)return e?i.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 border border-gray-700/50 text-center space-y-4",children:[i.jsx("h2",{className:"text-xl font-bold text-white",children:"Discover Your Playstyle"}),i.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Take the magical identity assessment to uncover your archetypes and get personalized recommendations."}),i.jsx("button",{onClick:n?r:()=>{},disabled:!n,className:`px-6 py-2 font-bold rounded-lg shadow-lg transition-all ${n?"bg-indigo-600 hover:bg-indigo-500 text-white hover:shadow-indigo-500/25":"bg-gray-700 text-gray-500 cursor-not-allowed opacity-50"}`,title:n?"":"Available on Tier 2 (Magician) and above",children:n?"Start Assessment":"Locked (Tier 2+)"})]}):null;const{summary:s,tags:a,scores:o,archetypes:l}=t;return i.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700/50 overflow-hidden flex flex-col md:flex-row",children:[i.jsxs("div",{className:"w-full md:w-64 bg-gray-800/80 p-6 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[i.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Playstyle"}),i.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:a&&a.map((c,u)=>i.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:c},u))}),e&&i.jsxs("div",{className:"mt-auto flex flex-col items-center gap-2",children:[i.jsx("button",{onClick:n?r:()=>{},disabled:!n,className:`text-xs underline transition-colors ${n?"text-gray-500 hover:text-white cursor-pointer":"text-gray-600 cursor-not-allowed hover:text-gray-600"}`,title:n?"Retake the assessment to update your profile":"Available on Tier 2 (Magician) and above",children:"Retake Assessment"}),!n&&i.jsx("span",{className:"text-[10px] text-indigo-500/80 font-medium bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Feature Locked"})]})]}),i.jsxs("div",{className:"flex-1 p-6 md:p-8 space-y-6",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute top-0 bottom-0 left-0 w-1 bg-indigo-500 rounded-full"}),i.jsxs("p",{className:"pl-4 text-gray-300 italic font-serif leading-relaxed text-lg",children:['"',s,'"']})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),i.jsx("div",{className:"space-y-3",children:o&&Object.entries(o).map(([c,u])=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[i.jsx("span",{className:"text-gray-400 capitalize",children:c.replace(/([A-Z])/g," $1").trim()}),i.jsxs("span",{className:"text-white font-mono",children:[u,"/100"]})]}),i.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full rounded-full ${Jct(u)}`,style:{width:`${u}%`}})})]},c))})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Affinity Archetypes"}),i.jsx("div",{className:"flex flex-col gap-2",children:l&&l.map((c,u)=>i.jsxs("div",{className:"bg-gray-900/50 px-4 py-3 rounded-lg border border-gray-700/50 flex items-center gap-3",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),i.jsx("span",{className:"text-gray-200 text-sm font-medium",children:c})]},u))})]})]})]})]})};function Jct(t){return t>75?"bg-green-500":t>50?"bg-blue-500":t>25?"bg-yellow-500":"bg-red-500"}const Zct=()=>{const{id:t}=cc(),e=yn(),{userProfile:r}=Cr(),[n,s]=b.useState(null),[a,o]=b.useState([]),[l,c]=b.useState(null),[u,h]=b.useState(!0),[f,m]=b.useState(null),[g,y]=b.useState(!1),v=async()=>{try{h(!0);const N=await He.get(`/api/users/public/${t}`);if(s(N),N.is_public_library||N.relationship?.status==="accepted"||r?.id===N.id){const C=await He.get(`/api/decks?userId=${t}`);o(C);const I=await He.get(`/api/collection?userId=${t}`),O=Yct.analyze(I.data||I);c(O)}}catch(N){console.error("Failed to fetch profile",N),N.response?.status===403?m("This profile is private."):N.response?.status===404?m("User not found."):m("Failed to load profile.")}finally{h(!1)}};b.useEffect(()=>{t&&v()},[t]);const w=async N=>{if(n){y(!0);try{N==="request"&&await Ka.sendRequest({targetId:n.id},"friend"),await v()}catch(k){console.error("Friend action failed",k),alert("Action failed: "+(k.response?.data?.error||"Unknown error"))}finally{y(!1)}}};return u?i.jsxs("div",{className:"flex items-center justify-center h-screen text-slate-400",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500 mr-3"}),"Loading Profile..."]}):f?i.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center px-4",children:[i.jsx("div",{className:"bg-red-500/10 p-4 rounded-full mb-4",children:i.jsx(Nf,{className:"w-12 h-12 text-red-500"})}),i.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-slate-400 mb-6 max-w-md",children:f}),i.jsx("button",{onClick:()=>e("/dashboard"),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors",children:"Return to Dashboard"})]}):i.jsxs("div",{className:"min-h-screen pb-20",children:[i.jsxs("div",{className:"relative h-64 w-full bg-slate-900 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900 via-slate-900 to-black animate-gradient-slow"}),i.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"}),i.jsx("div",{className:"absolute -top-24 -right-24 w-96 h-96 bg-indigo-500/20 rounded-full blur-3xl"}),i.jsx("div",{className:"absolute top-1/2 left-1/4 w-64 h-64 bg-purple-500/20 rounded-full blur-3xl"})]}),i.jsxs("div",{className:"max-w-7xl mx-auto px-6 sm:px-8",children:[i.jsxs("div",{className:"relative -mt-20 mb-8 flex flex-col md:flex-row items-end md:items-end gap-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"w-40 h-40 rounded-full p-1 bg-gradient-to-br from-indigo-500 to-purple-600 shadow-2xl z-10 relative",children:i.jsx("div",{className:"w-full h-full rounded-full bg-slate-800 flex items-center justify-center overflow-hidden border-4 border-slate-900",children:n.avatar?i.jsx("img",{src:n.avatar,alt:n.username,className:"w-full h-full object-cover transition-transform group-hover:scale-110 duration-500"}):i.jsx(GI,{className:"w-20 h-20 text-slate-500"})})}),i.jsx("div",{className:"absolute bottom-4 right-4 w-6 h-6 bg-green-500 border-4 border-slate-900 rounded-full z-20",title:"Online"})]}),i.jsxs("div",{className:"flex-1 pb-4 text-center md:text-left",children:[i.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-baseline gap-3 mb-2",children:[i.jsx("h1",{className:"text-4xl font-black text-white tracking-tight drop-shadow-lg filter",children:n.username}),n.is_friend&&i.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 backdrop-blur-sm",children:"Friend"}),r?.id===n.id&&i.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-indigo-500/20 text-indigo-300 border border-indigo-500/30 backdrop-blur-sm",children:"You"})]}),i.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 text-sm text-slate-400 font-medium",children:[i.jsxs("span",{className:"flex items-center",children:[i.jsx(Nf,{className:"w-4 h-4 mr-1.5 text-slate-500"}),"Joined ",new Date(n.joined_at).toLocaleDateString(void 0,{month:"long",year:"numeric"})]}),n.is_public_library&&i.jsxs("span",{className:"flex items-center text-amber-400 bg-amber-400/10 px-2 py-0.5 rounded-md border border-amber-400/20",children:[i.jsx(PO,{className:"w-3.5 h-3.5 mr-1.5"}),"Public Library"]})]}),n.bio&&i.jsx("p",{className:"mt-4 text-slate-300 max-w-2xl text-lg leading-relaxed font-light border-l-2 border-indigo-500/50 pl-4",children:n.bio})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 pb-4 justify-center md:justify-end min-w-[200px]",children:[r?.id===n.id?i.jsx("button",{onClick:()=>e("/settings"),className:"px-6 py-2.5 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-semibold border border-slate-600 transition-all hover:shadow-lg flex items-center",children:"Edit Profile"}):i.jsx(i.Fragment,{children:(!n.relationship||!n.relationship.status)&&i.jsxs("button",{onClick:()=>w("request"),disabled:g,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2.5 rounded-xl font-bold shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-50 flex items-center gap-2",children:[i.jsx(GI,{className:"w-4 h-4"})," Add Friend"]})}),i.jsx("button",{onClick:()=>e(`/collection?userId=${n.id}&public=true`),className:"px-6 py-2.5 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 transition-all flex items-center gap-2",children:"View Collection"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mt-12",children:[i.jsx("div",{className:"space-y-8",children:i.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-white/5 shadow-xl hover:border-white/10 transition-colors",children:[i.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-4",children:"Archetype"}),i.jsx("div",{className:"flex justify-center py-4",children:i.jsx(Xct,{archetype:l})})]})}),i.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[i.jsx(Qct,{playstyle:n.playstyle,isOwnProfile:r?.id===n.id,onRetake:()=>e("/onboarding?step=5"),canRegenerate:An(r?.subscription_tier).features.customAiPersona}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"w-1 h-8 bg-indigo-500 rounded-full"}),"Public Decks"]}),i.jsxs("span",{className:"text-slate-400 text-sm font-medium",children:[a.length," Decks Shared"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.length>0?a.map(N=>i.jsxs("div",{onClick:()=>e(`/decks/${N.id}`),className:"group cursor-pointer relative bg-slate-800/80 hover:bg-slate-800 border-2 border-transparent hover:border-indigo-500/50 rounded-2xl p-6 transition-all hover:-translate-y-1 hover:shadow-2xl overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-indigo-500/10 rounded-bl-full -mr-4 -mt-4 transition-transform group-hover:scale-110"}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("div",{className:"flex justify-between items-start mb-3",children:i.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-400 transition-colors line-clamp-1",children:N.name})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("span",{className:"px-2.5 py-1 rounded text-xs font-bold bg-indigo-500/20 text-indigo-300 border border-indigo-500/30 uppercase tracking-wide",children:N.format}),i.jsxs("span",{className:"text-xs text-slate-400 font-medium flex items-center gap-1",children:[i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-500"}),N.card_count," Cards"]})]}),i.jsx("div",{className:"w-full bg-slate-700/50 h-1.5 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 w-2/3"})})]})]},N.id)):i.jsx("div",{className:"col-span-2 py-12 text-center rounded-2xl border-2 border-dashed border-slate-700/50 bg-slate-800/20",children:i.jsx("p",{className:"text-slate-500 italic",children:"No public decks to display."})})})]})]})]})]})]})},eut=({tournamentId:t,round:e,initialPairings:r,participants:n,onUpdate:s,isPending:a,isOrganizer:o})=>{const{user:l}=Cr(),[c,u]=Ie.useState(!1),{addToast:h}=Tn();if(a)return i.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[i.jsx(Nf,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"Tournament Pending"}),i.jsx("p",{className:"text-gray-500",children:"Add players and click Start to generate pairings."})]});if(!r||r.length===0)return i.jsx("div",{className:"p-4 text-center text-gray-400",children:"No pairings for this round."});const f=n.reduce((y,v)=>(y[v.id]=v,y),{}),m=async(y,v,w)=>{try{await He.post(`/api/tournaments/${t}/matches`,{matchId:y,winnerId:w?null:v,isDraw:w}),s()}catch(N){console.error("Failed to report result",N),h("Failed to save result","error")}},g=async(y,v)=>{try{await He.put(`/api/tournaments/${t}/pairings/${y}`,v),h("Pairing updated","success"),setTimeout(s,500)}catch(w){console.error("Failed to edit pairing",w),h("Failed to update pairing","error")}};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-bold text-white",children:["Round ",e," Pairings"]}),o&&i.jsx("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-lg border font-bold transition-all ${c?"bg-indigo-600 text-white border-indigo-500":"bg-gray-800 text-gray-400 border-gray-700 hover:text-white"}`,children:c?"Done Editing":"Edit Pairings"})]}),r.map(y=>{const v=f[y.player1_id],w=f[y.player2_id],N=y.winner_id===y.player1_id&&!y.is_draw,k=y.winner_id===y.player2_id&&!y.is_draw,C=y.is_draw,I=n.find(L=>L.user_id===l?.id),O=I&&(y.player1_id===I.id||y.player2_id===I.id);return i.jsxs("div",{className:`p-4 rounded-xl border flex flex-col md:flex-row items-center justify-between gap-4 transition-all ${O&&!c?"bg-blue-900/20 border-blue-500/50":"bg-gray-800 border-gray-700"}`,children:[i.jsxs("div",{className:"flex items-center gap-4 flex-1 w-full md:w-auto",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsxs("span",{className:"text-gray-500 font-mono text-sm",children:["Table ",y.table_number]}),O&&!y.winner_id&&!y.is_draw&&!c&&i.jsxs("button",{onClick:()=>window.open(`/play/room/pair-${y.id}`,"_blank"),className:"px-2 py-1 bg-green-600 hover:bg-green-500 text-white text-[10px] font-bold rounded flex items-center gap-1 shadow-lg",children:[i.jsx(Cke,{className:"w-3 h-3"})," JOIN"]})]}),i.jsx("div",{className:`flex-1 text-right font-bold ${N?"text-green-400":"text-white"}`,children:c?i.jsx("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full text-right",value:y.player1_id||"",onChange:L=>g(y.id,{player1Id:L.target.value}),children:n.map(L=>i.jsx("option",{value:L.id,children:L.username||L.guest_name},L.id))}):v?v.username||v.guest_name:"Unknown"}),i.jsx("div",{className:"text-gray-500 font-bold text-xs",children:"VS"}),i.jsx("div",{className:`flex-1 text-left font-bold ${k?"text-green-400":"text-white"}`,children:c?i.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full",value:y.player2_id||"",onChange:L=>g(y.id,{player2Id:L.target.value||null}),children:[i.jsx("option",{value:"",children:"(Bye)"}),n.map(L=>i.jsx("option",{value:L.id,children:L.username||L.guest_name},L.id))]}):w?w.username||w.guest_name:y.player2_id===null?"BYE":"Unknown"})]}),!c&&(y.player2_id?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>m(y.id,y.player1_id,!1),className:`p-2 rounded-lg transition-colors ${N?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 1 Wins",children:i.jsx(ra,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>m(y.id,null,!0),className:`p-2 rounded-lg transition-colors ${C?"bg-yellow-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Draw",children:i.jsx(l_e,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>m(y.id,y.player2_id,!1),className:`p-2 rounded-lg transition-colors ${k?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 2 Wins",children:i.jsx(ra,{className:"w-4 h-4"})})]}):i.jsx("div",{className:"px-4 py-2 bg-gray-700/50 rounded-lg text-gray-400 text-sm",children:"Automatic Win"}))]},y.id)})]})},tut=({participants:t,tournamentId:e,currentUserId:r,isOrganizer:n,onUpdate:s})=>{if(!t||t.length===0)return i.jsx("div",{className:"p-4 text-center text-gray-400",children:"No participants yet."});const{addToast:a}=Tn(),o=[...t].sort((c,u)=>u.score!==c.score?u.score-c.score:u.wins!==c.wins?u.wins-c.wins:c.losses-u.losses),l=async c=>{if(confirm("Are you sure you want to drop this player? They will be removed from future pairings."))try{await He.post(`/api/tournaments/${e}/drop`,{participantId:c}),a("Player dropped successfully","success"),s()}catch(u){console.error(u),a("Failed to drop player","error")}};return i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"text-gray-400 border-b border-gray-700",children:[i.jsx("th",{className:"p-4 font-medium uppercase text-xs",children:"Rank"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs w-full",children:"Player"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Pts"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"W"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"L"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"D"}),i.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-800",children:o.map((c,u)=>i.jsxs("tr",{className:`transition-colors ${c.is_active===!1?"bg-red-900/10 opacity-60":"hover:bg-gray-800/50"}`,children:[i.jsx("td",{className:"p-4",children:i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${u===0?"bg-yellow-500/20 text-yellow-500":u===1?"bg-gray-400/20 text-gray-400":u===2?"bg-orange-700/20 text-orange-700":"text-gray-500"}`,children:u+1})}),i.jsx("td",{className:"p-4 font-bold text-white",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{children:c.username||c.guest_name}),c.deck_snapshot&&i.jsx("span",{className:"text-xs text-blue-400 font-normal",children:c.deck_snapshot.name})]})}),i.jsx("td",{className:"p-4 text-center font-bold text-yellow-500 text-lg",children:c.score}),i.jsx("td",{className:"p-4 text-center text-green-400 font-medium",children:c.wins}),i.jsx("td",{className:"p-4 text-center text-red-400 font-medium",children:c.losses}),i.jsx("td",{className:"p-4 text-center text-gray-400 font-medium",children:c.draws}),i.jsx("td",{className:"p-4 text-center",children:c.is_active===!1?i.jsx("span",{className:"text-xs bg-red-900 text-red-300 px-2 py-1 rounded",children:"Dropped"}):(n||c.user_id===r)&&i.jsx("button",{onClick:()=>l(c.id),className:"text-xs bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-300 px-2 py-1 rounded border border-gray-600 hover:border-red-800 transition-colors",children:"Drop"})})]},c.id))})]})})},rut=({pairings:t,participants:e})=>{const r=b.useMemo(()=>{if(!t||t.length===0)return[];const s={};let a=0;t.forEach(l=>{s[l.round_number]||(s[l.round_number]=[]),s[l.round_number].push(l),l.round_number>a&&(a=l.round_number)});const o=[];for(let l=1;l<=a;l++)s[l]&&o.push(s[l].sort((c,u)=>c.table_number-u.table_number));return o},[t]),n=s=>{if(!s)return"Bye";const a=e.find(o=>o.id===s);return a?a.username||a.guest_name:"Unknown"};return r.length===0?i.jsx("div",{className:"text-center py-12 text-gray-500",children:"No bracket data available yet. Start the tournament to generate the bracket."}):i.jsx("div",{className:"overflow-x-auto pb-6 custom-scrollbar",children:i.jsx("div",{className:"flex gap-8 min-w-max px-4",children:r.map((s,a)=>i.jsxs("div",{className:"flex flex-col justify-around gap-8",children:[i.jsxs("div",{className:"text-center text-gray-500 font-bold uppercase text-xs mb-2 tracking-wider",children:["Round ",a+1]}),i.jsx("div",{className:"flex flex-col justify-around flex-grow gap-4",children:s.map(o=>i.jsx(nut,{match:o,getPlayerName:n},o.id))})]},a))})})},nut=({match:t,getPlayerName:e})=>{const r=t.winner_id===t.player1_id,n=t.winner_id===t.player2_id;return i.jsxs("div",{className:"w-48 bg-gray-800 border border-gray-700 rounded-lg overflow-hidden flex flex-col shadow-lg relative",children:[i.jsxs("div",{className:`p-2 flex justify-between items-center ${r?"bg-green-900/20":""} border-b border-gray-700/50`,children:[i.jsx("span",{className:`text-sm truncate ${r?"text-green-400 font-bold":"text-gray-300"}`,children:e(t.player1_id)}),r&&i.jsx(ra,{className:"w-3 h-3 text-yellow-500"})]}),i.jsxs("div",{className:`p-2 flex justify-between items-center ${n?"bg-green-900/20":""}`,children:[i.jsx("span",{className:`text-sm truncate ${n?"text-green-400 font-bold":"text-gray-300"}`,children:t.player2_id?e(t.player2_id):i.jsx("span",{className:"text-gray-600 italic",children:"Bye"})}),n&&i.jsx(ra,{className:"w-3 h-3 text-yellow-500"})]})]})},sut=({isOpen:t,onClose:e,tournamentName:r,winnerName:n,stats:s})=>t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fade-in",children:i.jsxs("div",{className:"relative bg-gradient-to-b from-gray-900 to-black border border-yellow-500/30 rounded-2xl max-w-md w-full p-8 shadow-2xl shadow-yellow-900/20 text-center overflow-hidden",children:[i.jsx("div",{className:"absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-yellow-500 to-transparent opacity-50"}),i.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-yellow-500/10 rounded-full blur-3xl"}),i.jsx("div",{className:"absolute -bottom-10 -left-10 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl"}),i.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:i.jsx(vu,{className:"w-5 h-5"})}),i.jsxs("div",{className:"mb-6 relative",children:[i.jsx("div",{className:"mx-auto w-20 h-20 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg shadow-yellow-500/30 mb-4 animate-bounce-slow",children:i.jsx(ra,{className:"w-10 h-10 text-black fill-current"})}),i.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-300 uppercase tracking-widest mb-1 filter drop-shadow-sm",children:"Champion"}),i.jsx("p",{className:"text-yellow-500/80 text-xs font-bold uppercase tracking-widest",children:r})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50 mb-8 backdrop-blur-sm",children:[i.jsx("div",{className:"text-4xl font-bold text-white mb-2 tracking-tight",children:n||"Unknown Winner"}),i.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Score"}),i.jsx("div",{className:"text-xl font-mono text-yellow-500 font-bold",children:s?.score||0})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Wins"}),i.jsx("div",{className:"text-xl font-mono text-green-400 font-bold",children:s?.wins||0})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Losses"}),i.jsx("div",{className:"text-xl font-mono text-red-400 font-bold",children:s?.losses||0})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("button",{className:"w-full py-3 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 shadow-lg",onClick:()=>alert("Sharing implemented soon!"),children:[i.jsx(PO,{className:"w-4 h-4"})," Share Victory"]}),i.jsx("button",{onClick:e,className:"w-full py-3 bg-gray-800 text-gray-400 font-bold rounded-xl hover:bg-gray-700 hover:text-white transition-colors",children:"Close"})]})]})}):null,iut=()=>{const{id:t}=cc(),e=yn(),{user:r,userProfile:n}=Cr(),[s,a]=b.useState(null),[o,l]=b.useState("pairings"),[c,u]=b.useState(!0),[h,f]=b.useState(null),[m,g]=b.useState(""),[y,v]=b.useState(""),[w,N]=b.useState([]),[k,C]=b.useState(!1),[I,O]=b.useState(null),[L,_]=b.useState({isOpen:!1,type:null,title:"",message:""}),[E,M]=b.useState(!1);b.useEffect(()=>{t&&(B(),S())},[t]);const B=async()=>{try{u(!0);const q=await He.get(`/api/tournaments/${t}`);a(q)}catch(q){f(q.message)}finally{u(!1)}},S=async()=>{try{const q=await He.get("/api/friends");N(q.friends||[])}catch(q){console.error("Failed to load friends",q)}},P=async q=>{q.preventDefault();try{await He.post(`/api/tournaments/${t}/participants`,{userId:m||null,guestName:y||null}),g(""),v(""),B()}catch{alert("Failed to add participant")}},R=()=>{_({isOpen:!0,type:"START",title:"Start Tournament?",message:"This will generate Round 1 pairings. Ensure all players are added."})},V=async()=>{try{await He.post(`/api/tournaments/${t}/start`),B(),_({isOpen:!1})}catch{alert("Failed to start tournament")}},ee=()=>{_({isOpen:!0,type:"NEXT_ROUND",title:"Generate Next Round?",message:"This will lock current round results and generate new pairings."})},G=async()=>{try{const q=await He.post(`/api/tournaments/${t}/next-round`);if(B(),_({isOpen:!1}),q.completed){const U=await He.get(`/api/tournaments/${t}`),H=U.participants&&U.participants[0];H&&(O(H),C(!0))}}catch{alert("Failed to generate next round. Make sure all matches are finished.")}},J=()=>{L.type==="START"&&V(),L.type==="NEXT_ROUND"&&G()},Z=s&&s.status==="active"&&s.currentPairings&&s.currentPairings.every(q=>q.winner_id||q.is_draw);console.log("[TournamentDetail] Auth Debug:",{userId:n?.id,organizerId:s?.organizer_id,match:String(n?.id)===String(s?.organizer_id)});const se=n?.id&&s?.organizer_id&&String(n.id)===String(s.organizer_id);if(c)return i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Tournament..."});if(h)return i.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",h]});if(!s)return null;const X=`${window.location.origin}/tournaments/${t}/join`;return i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("button",{onClick:()=>e("/social?tab=tournaments"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[i.jsx(Ere,{className:"w-4 h-4 mr-2"})," Back to Arena"]}),i.jsx("div",{className:"bg-gray-800 rounded-xl p-6 mb-6 border border-gray-700 shadow-lg",children:i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:s.name}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${s.status==="active"?"bg-green-500/20 text-green-400 border border-green-500/50":s.status==="completed"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-gray-600/50 text-gray-400 border border-gray-600"}`,children:s.status})]}),i.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ra,{className:"w-4 h-4 text-yellow-500"}),s.format.toUpperCase()]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ire,{className:"w-4 h-4 text-blue-400"}),"Round ",s.current_round]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Xm,{className:"w-4 h-4 text-purple-400"}),s.participants?.length||0," Players"]})]}),s.status==="pending"&&i.jsxs("button",{onClick:()=>M(!0),className:"mt-4 text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2",children:[i.jsx(Xm,{className:"w-4 h-4"})," Show Join QR Code"]})]}),s.status==="pending"&&se&&i.jsxs("button",{onClick:R,disabled:s.participants?.length<2,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-green-500/20",children:[i.jsx(VI,{className:"w-5 h-5 fill-current"}),"Start Tournament"]}),s.status==="active"&&se&&i.jsx("div",{className:"flex gap-2",children:i.jsxs("button",{onClick:ee,disabled:!Z,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-blue-500/20",children:[i.jsx(Uy,{className:"w-5 h-5"}),"Next Round"]})}),se&&i.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to DELETE this tournament? This cannot be undone."))try{await He.delete(`/api/tournaments/${t}`),e("/tournaments")}catch{alert("Failed to delete tournament")}},className:"flex items-center gap-2 px-4 py-3 bg-red-900/30 hover:bg-red-900/50 text-red-400 border border-red-900/50 rounded-lg transition-all ml-2",title:"Delete Tournament",children:[i.jsx(F_e,{className:"w-5 h-5"}),i.jsx("span",{className:"hidden md:inline",children:"Delete"})]})]})}),s.settings?.total_rounds&&i.jsxs("div",{className:"mb-4 text-xs text-gray-500 text-right",children:["Playing best of ",s.settings.total_rounds," Rounds"]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"lg:col-span-3",children:[i.jsxs("div",{className:"flex border-b border-gray-700 mb-6",children:[i.jsx("button",{onClick:()=>l("pairings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="pairings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Pairings"}),i.jsx("button",{onClick:()=>l("standings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="standings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Standings"}),(s.format==="elimination"||s.settings?.mode==="elimination")&&i.jsx("button",{onClick:()=>l("bracket"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="bracket"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Bracket"})]}),o==="pairings"&&i.jsx(eut,{tournamentId:t,round:s.current_round,initialPairings:s.currentPairings,participants:s.participants,onUpdate:B,isPending:s.status==="pending",isOrganizer:se}),o==="standings"&&i.jsx(tut,{participants:s.participants,tournamentId:t,currentUserId:r?.id,isOrganizer:se,onUpdate:B}),o==="bracket"&&i.jsx(rut,{pairings:s.allPairings,participants:s.participants})]}),i.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[s.status==="pending"&&i.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[i.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[i.jsx(aut,{})," Add Player"]}),i.jsxs("form",{onSubmit:P,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"From Friends"}),i.jsxs("select",{value:m,onChange:q=>{g(q.target.value),v("")},className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none",children:[i.jsx("option",{value:"",children:"Select Friend..."}),w.map(q=>i.jsx("option",{value:q.id,children:q.username},q.id))]})]}),i.jsx("div",{className:"text-center text-gray-600 text-xs font-bold",children:"- OR -"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"Guest Name"}),i.jsx("input",{type:"text",value:y,onChange:q=>{v(q.target.value),g("")},placeholder:"Enter Name...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none"})]}),i.jsx("button",{type:"submit",disabled:!m&&!y,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 text-white font-bold rounded-lg text-sm transition-colors disabled:opacity-50",children:"Add Participant"})]})]}),i.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Players"}),i.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:s.participants&&s.participants.length>0?s.participants.map((q,U)=>i.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[i.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400 flex-shrink-0",children:U+1}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-gray-300 truncate",children:q.username||q.guest_name}),q.deck_snapshot&&i.jsx("span",{className:"text-xs text-blue-400 truncate",children:q.deck_snapshot.name})]})]}),i.jsxs("div",{className:"text-xs font-mono text-gray-500",children:[q.score,"pts"]})]},q.id)):i.jsx("div",{className:"text-center text-gray-500 text-sm py-4 italic",children:"No players yet."})})]})]})]}),i.jsx(tae,{isOpen:L.isOpen,onClose:()=>_({...L,isOpen:!1}),onConfirm:J,title:L.title,message:L.message}),i.jsx(sut,{isOpen:k,onClose:()=>C(!1),tournamentName:s.name,winnerName:I?.username||I?.guest_name,stats:I}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-gray-800 rounded-xl max-w-sm w-full p-6 border border-gray-700 relative shadow-2xl",children:[i.jsx("button",{onClick:()=>M(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:""}),i.jsx("h3",{className:"text-xl font-bold text-white mb-2 text-center",children:"Join Tournament"}),i.jsx("p",{className:"text-gray-400 text-sm mb-6 text-center",children:"Scan to join on your device"}),i.jsx("div",{className:"bg-white p-4 rounded-lg mx-auto w-fit mb-6",children:i.jsx(G_,{value:X,size:200})}),i.jsxs("div",{className:"bg-gray-900 rounded p-3 flex items-center gap-2",children:[i.jsx("input",{type:"text",readOnly:!0,value:X,className:"bg-transparent text-gray-400 text-xs w-full outline-none"}),i.jsx("button",{onClick:()=>navigator.clipboard.writeText(X),className:"text-blue-400 hover:text-white text-xs font-bold",children:"COPY"})]})]})})]})},aut=()=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),i.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),i.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]}),HQ=()=>{const{id:t}=cc(),[e,r]=b.useState([]),[n,s]=b.useState(!0),[a,o]=b.useState(!1);yn(),b.useEffect(()=>{t||l()},[t]);const l=async()=>{try{const c=await He.get("/api/tournaments");r(c||[])}catch(c){console.error("Failed to fetch tournaments",c)}finally{s(!1)}};return t?i.jsx(iut,{}):n?i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Arena..."}):i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent flex items-center gap-3",children:[i.jsx(ra,{className:"w-8 h-8 text-yellow-500"}),"The Arena"]}),i.jsx("p",{className:"text-gray-400 mt-1",children:"Organize tournaments and track competitive standings."})]}),i.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors",children:[i.jsx(f_e,{className:"w-5 h-5"}),"New Tournament"]})]}),e.length===0?i.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[i.jsx(ra,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments Yet"}),i.jsx("p",{className:"text-gray-500 mb-6",children:"Create your first event to start tracking games!"}),i.jsx("button",{onClick:()=>o(!0),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Create Event"})]}):i.jsx(Bfe,{tournaments:e}),i.jsx(Ffe,{isOpen:a,onClose:()=>o(!1)})]})},out=()=>{const{id:t}=cc(),e=yn(),{user:r}=Cr(),[n,s]=b.useState(null),[a,o]=b.useState([]),[l,c]=b.useState(""),[u,h]=b.useState(!0),[f,m]=b.useState(!1),[g,y]=b.useState(null);b.useEffect(()=>{v()},[t]);const v=async()=>{try{const[N,k]=await Promise.all([He.get(`/api/tournaments/${t}`),He.get("/api/decks")]);s(N.data),o(k.data)}catch{y("Failed to load tournament info.")}finally{h(!1)}},w=async()=>{m(!0);try{await He.post(`/api/tournaments/${t}/join`,{deckId:l||null}),e(`/tournaments/${t}`)}catch(N){alert(N.response?.data?.error||"Failed to join tournament"),m(!1)}};return u?i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading..."}):g?i.jsx("div",{className:"p-8 text-center text-red-500",children:g}):i.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-gray-800 rounded-xl border border-gray-700 shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:n.name}),i.jsxs("p",{className:"text-gray-400 mb-6",children:["Format: ",i.jsx("span",{className:"capitalize text-blue-400",children:n.format})]}),n.status!=="pending"?i.jsxs("div",{className:"text-center py-6 bg-gray-900/50 rounded-lg border border-red-500/30",children:[i.jsx("p",{className:"text-red-400",children:"This tournament is already active or completed."}),i.jsx("button",{onClick:()=>e(`/tournaments/${t}`),className:"mt-4 text-blue-400 hover:text-blue-300",children:"View Tournament"})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Deck (Optional)"}),i.jsxs("select",{value:l,onChange:N=>c(N.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[i.jsx("option",{value:"",children:"No Deck / Decide Later"}),a.map(N=>i.jsxs("option",{value:N.id,children:[N.name," (",N.format||"Standard",")"]},N.id))]}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Selecting a deck locks in your list for this tournament."})]}),i.jsx("button",{onClick:w,disabled:f,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all flex items-center justify-center gap-2",children:f?"Joining...":"Join Tournament"})]})]})},Ro=[];for(let t=0;t<256;++t)Ro.push((t+256).toString(16).slice(1));function lut(t,e=0){return(Ro[t[e+0]]+Ro[t[e+1]]+Ro[t[e+2]]+Ro[t[e+3]]+"-"+Ro[t[e+4]]+Ro[t[e+5]]+"-"+Ro[t[e+6]]+Ro[t[e+7]]+"-"+Ro[t[e+8]]+Ro[t[e+9]]+"-"+Ro[t[e+10]]+Ro[t[e+11]]+Ro[t[e+12]]+Ro[t[e+13]]+Ro[t[e+14]]+Ro[t[e+15]]).toLowerCase()}let OT;const cut=new Uint8Array(16);function uut(){if(!OT){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");OT=crypto.getRandomValues.bind(crypto)}return OT(cut)}const dut=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),WQ={randomUUID:dut};function Yv(t,e,r){if(WQ.randomUUID&&!t)return WQ.randomUUID();t=t||{};const n=t.random??t.rng?.()??uut();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lut(n)}function $fe(t){if(!t)return{};const e={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},r=t.match(/\{([^}]+)\}/g);return r&&r.forEach(n=>{const s=n.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(s)?e[s]++:isNaN(s)||(e.generic+=parseInt(s))}),e}function hut(t,e){if(!e)return!0;const r=$fe(e),n={...t};for(const a of["w","u","b","r","g","c"]){if(n[a]<r[a])return!1;n[a]-=r[a]}return Object.values(n).reduce((a,o)=>a+o,0)>=r.generic}function fut(t,e){const r=$fe(e),n={...t};["w","u","b","r","g","c"].forEach(o=>{n[o]-=r[o]});let s=r.generic;const a=["c","w","u","b","r","g"];for(const o of a){const l=Math.min(n[o],s);if(n[o]-=l,s-=l,s<=0)break}return n}const f1={zones:{library:[],hand:[],battlefield:[],graveyard:[],exile:[],command:[]},counters:{life:40,poison:0,commanderDamage:{},energy:0},turn:{count:1,phase:"Untap",landsPlayed:0},manaPool:{w:0,u:0,b:0,r:0,g:0,c:0},commanderTax:{},ui:{selectedIds:[],draggingId:null,error:null},past:[]},MT=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function rc(t,e){const r=[...t.past||[],{...t,past:[]}].slice(-20);return{...e,past:r}}function put(t,e){return!e||e.includes("Instant")||e.includes("Creature")&&e.includes("Flash")?!0:t==="Main 1"||t==="Main 2"}function mut(t,e){switch(e.type){case"UNDO":return!t.past||t.past.length===0?t:{...t.past[t.past.length-1],past:t.past.slice(0,-1)};case"LOAD_DECK":{const{mainboard:r,commander:n}=e.payload,s=r.map(o=>({...o,id:Yv(),instanceId:Yv(),tapped:!1,faceDown:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})),a=n?n.map(o=>({...o,id:Yv(),instanceId:Yv(),tapped:!1,faceDown:!1,isCommander:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})):[];return{...f1,zones:{...f1.zones,library:nj(s),command:a},commanderTax:a.reduce((o,l)=>({...o,[l.instanceId]:0}),{})}}case"DRAW_CARD":{const{count:r=1}=e.payload||{},n=[...t.zones.library],s=[...t.zones.hand];let a=null;for(let o=0;o<r;o++)if(n.length>0){const l=n.pop();l.faceDown=!1,s.push(l)}else a="Library is empty! You lose the game (if this were a real game).";return rc(t,{...t,ui:{...t.ui,error:a},zones:{...t.zones,library:n,hand:s}})}case"MOVE_CARD":{const{cardId:r,fromZone:n,toZone:s,index:a,position:o}=e.payload,l=[...t.zones[n]],c=[...t.zones[s]],u=l.findIndex(v=>v.instanceId===r);if(u===-1)return t;const[h]=l.splice(u,1);let f=t.manaPool,m=t.turn.landsPlayed,g={...t.commanderTax};if((n==="hand"||n==="command")&&s==="battlefield"){const v=h.type_line&&h.type_line.includes("Land");if(!put(t.turn.phase,h.type_line))return{...t,ui:{...t.ui,error:`Can only play ${h.name} during your Main phase.`}};if(v){if(m>=1)return{...t,ui:{...t.ui,error:"Only one land per turn allowed."}};m++}else{let w=h.mana_cost;if(h.isCommander&&n==="command"){const N=g[h.instanceId]||0;N>0&&(w=`${w}{${N*2}}`)}if(!hut(t.manaPool,w))return{...t,ui:{...t.ui,error:`Cannot afford ${h.name}. Cost: ${w}`}};f=fut(t.manaPool,w),h.isCommander&&n==="command"&&(g[h.instanceId]=(g[h.instanceId]||0)+1)}}const y={...h,faceDown:s==="library",position:o||(s==="battlefield"?h.position:null),summoningSickness:s==="battlefield"&&h.type_line?.includes("Creature")?!0:h.summoningSickness};return typeof a=="number"?c.splice(a,0,y):c.push(y),rc(t,{...t,manaPool:f,turn:{...t.turn,landsPlayed:m},commanderTax:g,ui:{...t.ui,error:null},zones:{...t.zones,[n]:l,[s]:c}})}case"TAP_CARD":{const{cardId:r,zone:n}=e.payload;let s=[];const a=t.zones[n].map(l=>{if(l.instanceId===r){if(l.summoningSickness&&l.type_line?.includes("Creature"))return l;const c=!l.tapped;if(c){if(l.produced_mana&&l.produced_mana.length>0)s.push(l.produced_mana[0].toLowerCase());else if(l.type_line&&l.type_line.includes("Land")){const u={Plains:"w",Island:"u",Swamp:"b",Mountain:"r",Forest:"g",Wastes:"c"};for(const[h,f]of Object.entries(u))if(l.type_line.includes(h)){s.push(f);break}}}return{...l,tapped:c}}return l}),o={...t.manaPool};return s.forEach(l=>{o[l]!==void 0&&o[l]++}),rc(t,{...t,ui:{...t.ui,error:null},zones:{...t.zones,[n]:a},manaPool:o})}case"NEXT_PHASE":{let n=MT.indexOf(t.turn.phase)+1,s=t.turn.count,a=!1,o=t.turn.landsPlayed;n>=MT.length&&(n=0,s++,a=!0,o=0);const l=MT[n],c={w:0,u:0,b:0,r:0,g:0,c:0};let u=t.zones.battlefield;return(a||l==="Untap")&&(u=t.zones.battlefield.map(h=>({...h,tapped:!1,summoningSickness:!1}))),rc(t,{...t,turn:{count:s,phase:l,landsPlayed:o},manaPool:c,ui:{...t.ui,error:null},zones:{...t.zones,battlefield:u}})}case"ADD_MANA":{const{color:r}=e.payload;return rc(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]+1}})}case"SPEND_MANA":{const{color:r}=e.payload;return t.manaPool[r]<=0?t:rc(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]-1}})}case"UNTAP_ALL":{const r=t.zones.battlefield.map(n=>({...n,tapped:!1}));return rc(t,{...t,zones:{...t.zones,battlefield:r}})}case"SHUFFLE_LIBRARY":return rc(t,{...t,zones:{...t.zones,library:nj([...t.zones.library])}});case"SET_LIFE":return rc(t,{...t,counters:{...t.counters,life:e.payload}});case"MULLIGAN":{const r=t.zones.hand.map(o=>({...o,faceDown:!0,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}})),n=[...t.zones.library,...r],s=nj(n),a=[];for(let o=0;o<7;o++)if(s.length>0){const l=s.pop();l.faceDown=!1,a.push(l)}return rc(t,{...t,turn:{...t.turn,landsPlayed:0},ui:{...t.ui,error:null},zones:{...t.zones,hand:a,library:s}})}case"RESTART_GAME":{const r=[...t.zones.hand,...t.zones.battlefield,...t.zones.graveyard,...t.zones.exile].map(a=>({...a,tapped:!1,faceDown:!0,counters:{p1p1:0,loyalty:0,other:0}})),n=nj([...t.zones.library,...r]),s=[];for(let a=0;a<7;a++)if(n.length>0){const o=n.pop();o.faceDown=!1,s.push(o)}return{...f1,zones:{...f1.zones,library:n,hand:s,battlefield:[],graveyard:[],exile:[],command:t.zones.command.map(a=>({...a,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}}))},commanderTax:t.zones.command.reduce((a,o)=>({...a,[o.instanceId]:0}),{})}}case"ADD_COUNTER":{const{cardId:r,zone:n,counterType:s,amount:a=1}=e.payload;return rc(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[s]:(o.counters[s]||0)+a}}:o)}})}case"REMOVE_COUNTER":{const{cardId:r,zone:n,counterType:s,amount:a=1}=e.payload;return rc(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[s]:Math.max(0,(o.counters[s]||0)-a)}}:o)}})}case"CREATE_TOKEN":{const{tokenData:r}=e.payload,n={...r,instanceId:Yv(),tapped:!1,faceDown:!1,isToken:!0,counters:{p1p1:0,loyalty:0,other:0}};return rc(t,{...t,zones:{...t.zones,battlefield:[...t.zones.battlefield,n]}})}case"SET_LIFE":return rc(t,{...t,counters:{...t.counters,life:e.payload}});default:return t}}function nj(t){let e=t.length,r;for(;e!==0;)r=Math.floor(Math.random()*e),e--,[t[e],t[r]]=[t[r],t[e]];return t}function gut(){const[t,e]=b.useReducer(mut,f1),r=b.useCallback(C=>e({type:"LOAD_DECK",payload:C}),[]),n=b.useCallback((C=1)=>e({type:"DRAW_CARD",payload:{count:C}}),[]),s=b.useCallback((C,I,O,L,_)=>e({type:"MOVE_CARD",payload:{cardId:C,fromZone:I,toZone:O,index:L,position:_}}),[]),a=b.useCallback((C,I)=>e({type:"TAP_CARD",payload:{cardId:C,zone:I}}),[]),o=b.useCallback(()=>e({type:"UNTAP_ALL"}),[]),l=b.useCallback(()=>e({type:"SHUFFLE_LIBRARY"}),[]),c=b.useCallback(C=>e({type:"SET_LIFE",payload:C}),[]),u=b.useCallback(()=>e({type:"UNDO"}),[]),h=b.useCallback(()=>e({type:"MULLIGAN"}),[]),f=b.useCallback(()=>e({type:"RESTART_GAME"}),[]),m=b.useCallback(()=>e({type:"NEXT_PHASE"}),[]),g=b.useCallback(C=>e({type:"ADD_MANA",payload:{color:C}}),[]),y=b.useCallback(C=>e({type:"SPEND_MANA",payload:{color:C}}),[]),v=b.useCallback((C,I,O,L)=>e({type:"ADD_COUNTER",payload:{cardId:C,zone:I,counterType:O,amount:L}}),[]),w=b.useCallback((C,I,O,L)=>e({type:"REMOVE_COUNTER",payload:{cardId:C,zone:I,counterType:O,amount:L}}),[]),N=b.useCallback(C=>e({type:"CREATE_TOKEN",payload:{tokenData:C}}),[]),k=b.useMemo(()=>({loadDeck:r,drawCard:n,moveCard:s,tapCard:a,untapAll:o,shuffleLibrary:l,setLife:c,undo:u,mulligan:h,restartGame:f,nextPhase:m,addMana:g,spendMana:y,addCounter:v,removeCounter:w,createToken:N}),[r,n,s,a,o,l,c,u,h,f,m,g,y,v,w,N]);return{state:t,actions:k}}const Ufe=b.createContext(null);function xut({children:t}){const e=gut();return i.jsx(Ufe.Provider,{value:e,children:t})}function v3(){const t=b.useContext(Ufe);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function yut({x:t,y:e,onClose:r,actions:n,card:s,zoneId:a}){const o=b.useRef(null);b.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&r()};return window.addEventListener("mousedown",c),()=>window.removeEventListener("mousedown",c)},[r]);const l=c=>{c(),r()};return i.jsxs("div",{ref:o,className:"fixed z-[100] bg-gray-900/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl py-2 min-w-[180px] overflow-hidden",style:{left:t,top:e},children:[i.jsxs("div",{className:"px-4 py-1.5 border-b border-white/5 mb-1",children:[i.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest leading-none",children:"Card Actions"}),i.jsx("div",{className:"text-white text-xs font-bold truncate",children:s.name})]}),i.jsx(Xv,{onClick:()=>l(()=>n.moveCard(s.instanceId,a,"graveyard")),label:"Destroy / Discard",icon:i.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),i.jsx(Xv,{onClick:()=>l(()=>n.moveCard(s.instanceId,a,"exile")),label:"Exile",icon:i.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsx(Xv,{onClick:()=>l(()=>n.moveCard(s.instanceId,a,"library",0)),label:"Put on Top",icon:i.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 11l7-7 7 7M5 19l7-7 7 7"})})}),i.jsx(Xv,{onClick:()=>l(()=>n.moveCard(s.instanceId,a,"hand")),label:"Return to Hand",icon:i.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),i.jsx("div",{className:"h-px bg-white/5 my-1"}),i.jsx("div",{className:"px-4 py-1 text-[8px] font-bold text-gray-500 uppercase tracking-widest",children:"Counters"}),i.jsxs("div",{className:"flex px-2 pb-1 gap-1",children:[i.jsx(GQ,{label:"+1/+1",onAdd:()=>n.addCounter(s.instanceId,a,"p1p1",1),onSub:()=>n.removeCounter(s.instanceId,a,"p1p1",1)}),i.jsx(GQ,{label:"Loyalty",onAdd:()=>n.addCounter(s.instanceId,a,"loyalty",1),onSub:()=>n.removeCounter(s.instanceId,a,"loyalty",1)})]}),i.jsx("div",{className:"h-px bg-white/5 my-1"}),i.jsx(Xv,{onClick:()=>l(()=>n.tapCard(s.instanceId,a)),label:s.tapped?"Untap":"Tap",icon:i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}function Xv({onClick:t,label:e,icon:r}){return i.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-2 text-xs font-bold text-gray-400 hover:text-white hover:bg-white/5 transition-all text-left group",children:[i.jsx("span",{className:"opacity-70 group-hover:opacity-100 transition-opacity",children:r}),i.jsx("span",{children:e})]})}function GQ({label:t,onAdd:e,onSub:r}){return i.jsxs("div",{className:"flex-1 flex flex-col items-center bg-white/5 rounded-lg py-1 px-2 border border-white/5",children:[i.jsx("span",{className:"text-[8px] text-gray-500 mb-1",children:t}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-red-500 text-[10px] p-1 font-black",children:""}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-emerald-500 text-[10px] p-1 font-black",children:""})]})]})}function but(t,e){if(!e)return!0;const r={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},n=e.match(/\{([^}]+)\}/g);if(!n)return!0;n.forEach(o=>{const l=o.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(l)?r[l]++:isNaN(l)||(r.generic+=parseInt(l))});const s={...t};for(const o of["w","u","b","r","g","c"]){if(s[o]<r[o])return!1;s[o]-=r[o]}return Object.values(s).reduce((o,l)=>o+l,0)>=r.generic}const ny=b.memo(function({card:e,zoneId:r,isOverlay:n=!1,size:s="md"}){const{state:a,actions:o}=v3(),[l,c]=b.useState(null),u=r==="hand"||n&&e.fromZone==="hand",h=e.type_line&&e.type_line.includes("Land"),f=b.useMemo(()=>u&&!h&&but(a.manaPool,e.mana_cost),[u,h,a.manaPool,e.mana_cost]),m=b.useMemo(()=>u&&h&&a.turn.landsPlayed<1,[u,h,a.turn.landsPlayed]),{attributes:g,listeners:y,setNodeRef:v,transform:w,isDragging:N}=Une({id:e.instanceId,data:{card:e,fromZone:r},disabled:n}),k=w?{transform:`translate3d(${w.x}px, ${w.y}px, 0)`,zIndex:1e3,willChange:"transform"}:{willChange:"transform"},C=E=>{E.preventDefault(),c({x:E.clientX,y:E.clientY})},I=E=>{N||o.tapCard(e.instanceId,r)},O={sm:"w-32 h-44 rounded-xl",md:"w-40 h-56 rounded-[1.5rem]",lg:"w-48 h-64 rounded-[2rem]",tactical:"w-44 h-60 rounded-2xl"},L=s||(r==="battlefield"?"tactical":r==="hand"?"md":"sm"),_=e.tapped?"rotate-90 translate-x-8":"";return i.jsxs(i.Fragment,{children:[i.jsxs("div",{ref:n?null:v,style:k,...n?{}:y,...n?{}:g,onClick:n?void 0:I,onContextMenu:n?void 0:C,className:`
                    relative ${O[L]} bg-gray-900 border-2 transition-all duration-300
                    ${n?"border-indigo-500 shadow-2xl scale-110":"border-white/10 shadow-lg"}
                    ${e.isToken?"border-dashed border-emerald-500/50":""}
                    ${(f||m)&&!N?"ring-4 ring-emerald-500/30":""}
                    hover:border-indigo-500/50 hover:shadow-indigo-500/40 hover:scale-[1.05] 
                    cursor-grab active:cursor-grabbing group z-[10] hover:z-[50]
                    ${_}
                    ${N?"opacity-0":"opacity-100"}
                `,children:[i.jsx(vut,{card:e,isOverlay:n,size:L,zoneId:r}),(f||m)&&!N&&i.jsx("div",{className:"absolute inset-0 rounded-inherit bg-emerald-500/5 animate-pulse pointer-events-none"})]}),l&&i.jsx(yut,{x:l.x,y:l.y,onClose:()=>c(null),actions:o,card:e,zoneId:r})]})}),vut=b.memo(function({card:e,isOverlay:r,size:n,zoneId:s}){const{state:a}=v3(),o=e.counters?.p1p1||0,l=e.counters?.loyalty||0;e.counters?.other;const c=e.power!==void 0&&e.toughness!==void 0,{currentPower:u,currentToughness:h}=b.useMemo(()=>{const m=parseInt(e.power),g=parseInt(e.toughness);return{currentPower:c?isNaN(m)?e.power:m+o:null,currentToughness:c?isNaN(g)?e.toughness:g+o:null}},[e.power,e.toughness,c,o]),f=n==="lg"||n==="tactical"||n==="md";return i.jsxs("div",{className:"w-full h-full relative pointer-events-none select-none overflow-hidden rounded-inherit",children:[e.faceDown?i.jsxs("div",{className:"w-full h-full bg-indigo-950 rounded-inherit flex items-center justify-center border-4 border-white/5 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20"}),i.jsx("div",{className:`${f?"w-24 h-24":"w-16 h-16"} rounded-full border-2 border-white/20 bg-indigo-900/30 backdrop-blur-md flex items-center justify-center shadow-2xl`,children:i.jsx("div",{className:`${f?"w-16 h-16":"w-10 h-10"} rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 opacity-50 blur-sm animate-pulse`})})]}):i.jsxs("div",{className:"w-full h-full overflow-hidden rounded-inherit relative bg-gray-950 flex flex-col",children:[e.image_uri?i.jsx("img",{src:e.image_uri,alt:e.name,loading:"lazy",onError:m=>{m.target.onerror=null,m.target.src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/card-back.svg",m.target.style.opacity=.5},className:"w-full h-full object-cover select-none pointer-events-none"}):i.jsxs("div",{className:"p-4 text-xs text-gray-400 font-bold uppercase tracking-tighter bg-gray-900 h-full flex flex-col items-center justify-center text-center",children:[i.jsx("span",{className:"text-white text-sm mb-1",children:e.name}),e.type_line&&i.jsx("span",{className:"opacity-50 text-[10px] leading-tight",children:e.type_line})]}),e.isToken&&i.jsx("div",{className:`absolute top-0 right-0 bg-emerald-600 ${f?"text-[10px] px-3 py-1":"text-[8px] px-2 py-0.5"} font-black text-white rounded-bl-xl shadow-md uppercase tracking-widest z-20 border-l border-b border-white/10`,children:"Token"}),i.jsxs("div",{className:"absolute bottom-2 right-2 flex flex-col gap-2 z-30",children:[e.tapped&&i.jsx("div",{className:`${f?"w-8 h-8":"w-6 h-6"} rounded-full bg-amber-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:i.jsx("svg",{className:`${f?"w-5 h-5":"w-4 h-4"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M4.555 13.791L14.17 9.852l-1.474-3.56L3.081 10.23l1.474 3.561z"})})}),e.summoningSickness&&e.type_line?.includes("Creature")&&i.jsx("div",{className:`${f?"w-8 h-8":"w-6 h-6"} rounded-full bg-indigo-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:i.jsx("span",{className:`${f?"text-sm":"text-xs"} font-black text-white italic`,children:"zZz"})})]}),c&&i.jsx("div",{className:`absolute ${f?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:i.jsxs("div",{className:`bg-black/80 backdrop-blur-xl border-2 border-white/20 rounded-xl ${f?"px-3 py-1.5 gap-2":"px-2 py-1 gap-1"} flex items-center shadow-2xl transition-transform group-hover:scale-110`,children:[i.jsx("span",{className:`${f?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:u}),i.jsx("span",{className:"text-gray-500 font-black",children:"/"}),i.jsx("span",{className:`${f?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:h})]})}),e.type_line?.includes("Planeswalker")&&i.jsx("div",{className:`absolute ${f?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:i.jsxs("div",{className:`bg-orange-600/90 backdrop-blur-xl border-2 border-white/20 rounded-xl ${f?"px-3 py-1 gap-2":"px-2 py-0.5 gap-1"} flex items-center shadow-2xl`,children:[i.jsx("svg",{className:`${f?"w-5 h-5":"w-3 h-3"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M10 2l-7 7 7 7 7-7-7-7z"})}),i.jsx("span",{className:`${f?"text-xl":"text-base"} font-black text-white italic tracking-tighter`,children:l||e.loyalty})]})}),i.jsxs("div",{className:`absolute ${f?"top-2 left-2 gap-2":"top-1 left-1 gap-1"} flex flex-col z-30 pointer-events-none`,children:[o!==0&&i.jsxs("div",{className:`bg-indigo-600 text-white rounded-xl ${f?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2 animate-in slide-in-from-left-4 duration-300`,children:[i.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Counters"}),i.jsx("span",{className:f?"text-sm":"text-xs",children:o>0?`+${o}`:o})]}),e.isCommander&&s==="command"&&i.jsxs("div",{className:`bg-red-600 text-white rounded-xl ${f?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2`,children:[i.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Tax"}),i.jsxs("span",{className:f?"text-sm":"text-xs",children:["+",(a.commanderTax?.[e.instanceId]||0)*2]})]})]})]}),!r&&!e.faceDown&&i.jsx("div",{className:"absolute inset-0 bg-indigo-500/0 group-hover:bg-indigo-500/5 transition-colors pointer-events-none rounded-inherit"})]})}),Ox=b.memo(function({id:e,cards:r,title:n,className:s="",layout:a="grid",onCardClick:o}){const{isOver:l,setNodeRef:c}=Vne({id:e}),u={opacity:l?.9:1};return i.jsxs("div",{ref:c,className:`relative rounded-2xl transition-all ${s} ${l?"ring-2 ring-emerald-500/50 bg-emerald-500/5":""}`,style:u,children:[i.jsx("div",{className:"absolute -top-3 left-4 bg-gray-950 px-2 text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] z-10 border border-white/5 rounded-full",children:n}),i.jsxs("div",{className:`w-full h-full p-4 ${a==="spread"?"flex items-center gap-[-4rem]":""} ${a==="stacked"?"relative flex items-center justify-center":""}`,children:[a==="stacked"&&i.jsxs("div",{className:"relative w-36 h-52",children:[r.slice(-3).map((h,f)=>i.jsx("div",{className:"absolute inset-0 transition-transform",style:{transform:`translate(${f*2}px, ${f*2}px)`,zIndex:f},children:i.jsx(ny,{card:h,zoneId:e})},h.instanceId)),r.length===0&&i.jsx("div",{className:"w-full h-full border-2 border-dashed border-white/5 rounded-xl flex items-center justify-center text-[10px] font-black text-gray-800 uppercase tracking-widest",children:"Empty"})]}),a==="spread"&&i.jsx("div",{className:"flex -space-x-24 hover:-space-x-12 transition-all duration-500 py-8 px-12 overflow-x-auto no-scrollbar",children:r.map(h=>i.jsx("div",{className:"shrink-0 first:ml-0 transition-transform hover:-translate-y-8 hover:z-50",children:i.jsx(ny,{card:h,zoneId:e})},h.instanceId))}),(a==="grid"||a==="free")&&i.jsx("div",{className:`w-full h-full ${a==="free"?"relative":"flex flex-wrap gap-12"}`,children:r.map((h,f)=>a==="free"&&h.position?i.jsx("div",{className:"absolute transition-shadow active:z-[1000]",style:{left:h.position.x,top:h.position.y,zIndex:10+f},children:i.jsx(ny,{card:h,zoneId:e})},h.instanceId):i.jsx("div",{className:a==="free"?"absolute":"",style:a==="free"?{left:f%4*200,top:Math.floor(f/4)*280}:{},children:i.jsx(ny,{card:h,zoneId:e})},h.instanceId))}),r.length===0&&a!=="stacked"&&i.jsxs("div",{className:"w-full h-full flex items-center justify-center text-gray-800 text-xs font-black uppercase tracking-[0.3em] select-none opacity-20",children:[n," Void"]})]})]})}),wut=b.memo(function({state:e,onCardClick:r}){const{zones:n}=e;return i.jsxs("div",{className:"flex flex-col h-full gap-4 p-4 bg-[radial-gradient(circle_at_50%_-20%,_#1e1b4b_0%,_#020617_100%)] rounded-3xl border border-white/5 shadow-inner relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10 pointer-events-none"}),i.jsxs("div",{className:"flex h-56 gap-6 shrink-0 z-10",children:[i.jsx(Ox,{id:"command",cards:n.command,title:"Command Zone",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r}),i.jsx(Ox,{id:"exile",cards:n.exile,title:"Exile",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r})]}),i.jsxs("div",{className:"flex-grow bg-emerald-500/5 rounded-3xl border-2 border-dashed border-emerald-500/10 p-6 relative min-h-[400px] shadow-inner group",children:[i.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none group-hover:opacity-[0.05] transition-opacity",children:i.jsx("span",{className:"text-[200px] font-black uppercase tracking-tighter rotate-[-15deg]",children:"Battlefield"})}),i.jsx(Ox,{id:"battlefield",cards:n.battlefield,title:"Battlefield",className:"h-full w-full border-none",layout:"free",onCardClick:r})]}),i.jsxs("div",{className:"h-72 flex gap-6 shrink-0 z-10",children:[i.jsx("div",{className:"flex-grow bg-white/5 backdrop-blur-md rounded-2xl border border-white/10 p-4 shadow-xl",children:i.jsx(Ox,{id:"hand",cards:n.hand,title:"Hand",layout:"spread",className:"h-full w-full border-none",onCardClick:r})}),i.jsxs("div",{className:"w-80 flex gap-4",children:[i.jsx(Ox,{id:"library",cards:n.library,title:`Library (${n.library.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r}),i.jsx(Ox,{id:"graveyard",cards:n.graveyard,title:`Graveyard (${n.graveyard.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r})]})]})]})}),KQ=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function Nut({currentPhase:t,turnCount:e,landsPlayed:r,onNextPhase:n}){return i.jsxs("div",{className:"flex items-center bg-gray-900/80 backdrop-blur-md rounded-2xl border border-white/10 px-4 py-2 shadow-2xl relative overflow-hidden group",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500/5 via-purple-500/5 to-pink-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),i.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[i.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Turn"}),i.jsx("span",{className:"text-xl font-black text-white italic leading-none",children:e})]}),i.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Lands"}),i.jsxs("span",{className:`text-xl font-black italic leading-none ${r>=1?"text-amber-500":"text-emerald-400"}`,children:[r,"/1"]})]}),i.jsx("div",{className:"flex items-center gap-1 md:gap-2",children:KQ.map((s,a)=>{const o=t===s,l=KQ.indexOf(t)>a;return i.jsxs("div",{className:`flex flex-col items-center transition-all duration-300 ${o?"scale-110":"opacity-40"}`,children:[i.jsx("div",{className:`h-1.5 w-8 md:w-12 rounded-full mb-2 transition-all duration-500 ${o?"bg-gradient-to-r from-indigo-500 to-purple-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]":l?"bg-indigo-900/40":"bg-gray-800"}`}),i.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest ${o?"text-indigo-400":"text-gray-500"}`,children:s})]},s)})}),i.jsx("button",{onClick:n,className:"ml-2 w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/20 transition-all hover:scale-110 active:scale-95 group/btn",title:"Next Phase (Space)",children:i.jsx("svg",{className:"w-5 h-5 transition-transform group-hover/btn:translate-x-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 5l7 7-7 7"})})})]})]})}const jut=[{name:"Soldier",power:1,toughness:1,color:"W",type:"Token Creature  Soldier"},{name:"Zombie",power:2,toughness:2,color:"B",type:"Token Creature  Zombie"},{name:"Knight",power:2,toughness:2,color:"W",type:"Token Creature  Knight",keywords:["Vigilance"]},{name:"Spirit",power:1,toughness:1,color:"U",type:"Token Creature  Spirit",keywords:["Flying"]},{name:"Goblin",power:1,toughness:1,color:"R",type:"Token Creature  Goblin"},{name:"Beast",power:3,toughness:3,color:"G",type:"Token Creature  Beast"},{name:"Treasure",power:0,toughness:0,color:"C",type:"Token Artifact  Treasure",text:"T, Sacrifice this artifact: Add one mana of any color."},{name:"Clue",power:0,toughness:0,color:"C",type:"Token Artifact  Clue",text:"2, Sacrifice this artifact: Draw a card."},{name:"Food",power:0,toughness:0,color:"C",type:"Token Artifact  Food",text:"2, T, Sacrifice this artifact: You gain 3 life."}];function kut({isOpen:t,onClose:e,onCreateToken:r}){const[n,s]=b.useState({name:"",power:0,toughness:0,type:"Token Creature",color:"C"});return t?i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-white/5",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Generator Engine"}),i.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-widest",children:"Create Tokens & Emblems"})]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl text-gray-400",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Common Presets"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:jut.map(a=>i.jsxs("button",{onClick:()=>r(a),className:"flex flex-col items-start p-4 bg-white/5 border border-white/5 hover:border-indigo-500/50 hover:bg-indigo-500/5 rounded-2xl transition-all group",children:[i.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-black/40 border border-white/10 flex items-center justify-center text-[10px] font-black group-hover:scale-110 transition-transform",children:a.color}),a.power>0&&i.jsxs("span",{className:"text-xs font-black text-gray-400 group-hover:text-white transition-colors",children:[a.power,"/",a.toughness]})]}),i.jsx("span",{className:"text-sm font-bold text-white mb-1",children:a.name}),i.jsx("span",{className:"text-[10px] text-gray-500 truncate w-full text-left italic",children:a.type})]},a.name))})]}),i.jsxs("section",{className:"bg-white/5 p-6 rounded-3xl border border-white/5",children:[i.jsx("h3",{className:"text-xs font-black text-emerald-400 uppercase tracking-widest mb-4",children:"Manual Synthesis"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Identifier"}),i.jsx("input",{type:"text",value:n.name,onChange:a=>s({...n,name:a.target.value}),placeholder:"Token Name...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Power"}),i.jsx("input",{type:"number",value:n.power,onChange:a=>s({...n,power:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Toughness"}),i.jsx("input",{type:"number",value:n.toughness,onChange:a=>s({...n,toughness:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Type Line"}),i.jsx("input",{type:"text",value:n.type,onChange:a=>s({...n,type:a.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),i.jsx("button",{onClick:()=>r(n),disabled:!n.name,className:"w-full bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 text-white font-black uppercase tracking-widest py-3 rounded-2xl shadow-xl shadow-emerald-900/20 transition-all active:scale-95",children:"Synthesize Token"})]})]})]})]})]})]}):null}function _ut({isOpen:t,zoneId:e,onClose:r}){const{state:n,actions:s}=v3();if(!t||!e)return null;const a=n.zones[e]||[];return i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[i.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:r}),i.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-[3rem] shadow-2xl w-full max-w-6xl overflow-hidden flex flex-col max-h-[85vh]",children:[i.jsxs("div",{className:"p-8 border-b border-white/5 flex items-center justify-between bg-white/5",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-2xl bg-indigo-600 flex items-center justify-center text-white shadow-lg",children:i.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic",children:["Inspecting ",e]}),i.jsxs("p",{className:"text-gray-500 text-xs font-black uppercase tracking-widest",children:[a.length," Objects Detected"]})]})]}),i.jsxs("div",{className:"flex gap-4",children:[e==="library"&&i.jsx("button",{onClick:()=>s.shuffleLibrary(),className:"px-6 py-3 bg-white/5 hover:bg-white/10 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all border border-white/10",children:"Shuffle Library"}),i.jsx("button",{onClick:r,className:"p-3 hover:bg-white/10 rounded-2xl text-gray-400 transition-colors",children:i.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-12 bg-black/20",children:i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-x-8 gap-y-12",children:a.map((o,l)=>i.jsxs("div",{className:"flex flex-col items-center gap-4 group",children:[i.jsx("div",{className:"transform transition-all group-hover:scale-110 group-hover:-translate-y-2",children:i.jsx(ny,{card:{...o,faceDown:!1},zoneId:e})}),i.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0",children:[i.jsx("button",{onClick:()=>s.moveCard(o.instanceId,e,"hand"),className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Move to Hand",children:"Hand"}),i.jsx("button",{onClick:()=>s.moveCard(o.instanceId,e,"battlefield"),className:"bg-emerald-600 hover:bg-emerald-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Play Directly",children:"Play"})]})]},o.instanceId))})})]})]})}function Sut(){return i.jsx(xut,{children:i.jsx(Cut,{})})}function Cut(){const{deckId:t}=cc();yn();const{state:e,actions:r}=v3(),{deck:n,cards:s,loading:a}=PM(t),[o,l]=b.useState(!1),[c,u]=b.useState(null),[h,f]=b.useState(!1),[m,g]=b.useState(null),[y,v]=b.useState({x:32,y:120,isMinimized:!1,isVisible:!0}),[w,N]=b.useState({x:window.innerWidth-240,y:window.innerHeight-300,isMinimized:!1,isVisible:!0}),[k,C]=b.useState({x:window.innerWidth/2-250,y:20,isMinimized:!1,isVisible:!0}),I=qy(One,{activationConstraint:{distance:8}}),O=qy(Mne,{activationConstraint:{delay:250,tolerance:5}}),L=HO(I,O);b.useEffect(()=>{!a&&n&&s&&!o&&(r.loadDeck({mainboard:s,commander:s.filter(S=>{const P=n.commander&&S.scryfall_id===(n.commander.id||n.commander.scryfall_id),R=n.commander_partner&&S.scryfall_id===(n.commander_partner.id||n.commander_partner.scryfall_id);return P||R})}),l(!0))},[a,n,s,o,r]);const _=a||!o;b.useEffect(()=>{const S=P=>{if(!(P.target.tagName==="INPUT"||P.target.tagName==="TEXTAREA"))switch(P.key.toLowerCase()){case"d":r.drawCard();break;case" ":P.preventDefault(),r.nextPhase();break;case"u":r.untapAll();break;case"m":window.confirm("Mulligan hand?")&&r.mulligan();break;case"r":(P.ctrlKey||P.metaKey||window.confirm("Restart game?"))&&r.restartGame();break;case"s":r.shuffleLibrary();break}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[r]);const E=b.useCallback(S=>{const{active:P}=S;u(P.data.current?.card)},[]),M=b.useCallback(S=>{const{active:P,over:R}=S;if(u(null),!R)return;const V=P.id,ee=P.data.current?.fromZone,G=R.id;let J=null;if(G==="battlefield"){const Z=R.rect,se=P.rect.current.translated;Z&&se&&(J={x:se.left-Z.left,y:se.top-Z.top})}(ee!==G||J)&&r.moveCard(V,ee,G,0,J)},[r]),B=b.useCallback(S=>r.tapCard(S.instanceId,S.zoneId),[r]);return i.jsxs("div",{className:"h-screen bg-gray-950 flex flex-col overflow-hidden",children:[i.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center px-6 justify-between bg-black/40 backdrop-blur-xl shrink-0 z-40 relative",children:[i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs font-black text-indigo-500 uppercase tracking-widest",children:"Solitaire"}),i.jsx("span",{className:"text-sm font-bold text-white truncate max-w-[200px]",children:n?.name||"Loading..."})]}),i.jsx("div",{className:"h-8 w-px bg-white/10"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(RT,{active:k.isVisible,onClick:()=>C(S=>({...S,isVisible:!S.isVisible})),label:"Phase"}),i.jsx(RT,{active:y.isVisible,onClick:()=>v(S=>({...S,isVisible:!S.isVisible})),label:"Mana"}),i.jsx(RT,{active:w.isVisible,onClick:()=>N(S=>({...S,isVisible:!S.isVisible})),label:"Vitality"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})}),"Token"]}),i.jsx("button",{onClick:()=>g("library"),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Library"}),i.jsx("button",{onClick:()=>g("graveyard"),className:"px-4 py-2 bg-gray-500/10 hover:bg-gray-500/20 text-gray-400 border border-gray-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Graveyard"}),i.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),i.jsx("button",{onClick:()=>r.untapAll(),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Untap (U)"}),i.jsx("button",{onClick:()=>r.drawCard(),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Draw (D)"}),i.jsx("button",{onClick:()=>{window.confirm("Restart game?")&&r.restartGame()},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Restart"})]})]}),i.jsxs("div",{className:"flex-grow p-4 overflow-hidden relative select-none",children:[_?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{className:"text-indigo-400 font-black uppercase tracking-widest animate-pulse",children:"Initializing Board..."})]})}):i.jsxs(YO,{sensors:L,onDragStart:E,onDragEnd:M,children:[i.jsx(wut,{state:e,onCardClick:B}),Kn.createPortal(i.jsx(XO,{dropAnimation:null,children:c?i.jsx("div",{className:"scale-110 rotate-3 transition-transform",children:i.jsx(ny,{card:c,zoneId:"overlay",isOverlay:!0})}):null}),document.body)]}),i.jsx(DT,{title:"Phase Bar",pos:k,setPos:C,isVisible:k.isVisible,children:i.jsx(Nut,{currentPhase:e.turn.phase,turnCount:e.turn.count,landsPlayed:e.turn.landsPlayed,onNextPhase:()=>r.nextPhase()})}),i.jsx(DT,{title:"Mana Pool",pos:y,setPos:v,isVisible:y.isVisible,icon:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse delay-75"})]}),children:i.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.manaPool).map(([S,P])=>i.jsxs("div",{className:"flex flex-col items-center group",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 border-white/5 bg-black/40 shadow-xl overflow-hidden transition-transform group-hover:scale-110 mb-2",children:i.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${S.toUpperCase()}.svg`,alt:S,className:"w-8 h-8 object-contain active:scale-95 transition-transform cursor-pointer",onClick:()=>r.addMana(S)})}),i.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 rounded-full bg-indigo-600 border-2 border-gray-950 flex items-center justify-center text-[10px] font-black text-white shadow-lg",children:P})]}),i.jsx("div",{className:"flex gap-4",children:i.jsx("button",{onClick:()=>r.spendMana(S),className:"text-gray-600 hover:text-red-500 p-1",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})})})]},S))})}),i.jsx(DT,{title:"Vitality",pos:w,setPos:N,isVisible:w.isVisible,children:i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx("div",{className:"text-6xl font-black text-white italic tracking-tighter drop-shadow-2xl",children:e.counters.life}),i.jsxs("div",{className:"flex gap-4 mt-2",children:[i.jsx("button",{onClick:()=>r.setLife(e.counters.life-1),className:"w-10 h-10 rounded-xl bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 flex items-center justify-center transition-all",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})}),i.jsx("button",{onClick:()=>r.setLife(e.counters.life+1),className:"w-10 h-10 rounded-xl bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 flex items-center justify-center transition-all",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})})]})]})}),e.ui.error&&i.jsx("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-top-4 duration-300",children:i.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border-2 border-white/20",children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),i.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:e.ui.error})]})})]}),i.jsxs("div",{className:"h-10 bg-black/60 text-[10px] font-black uppercase tracking-[0.2em] text-gray-600 flex items-center px-8 border-t border-white/5 shrink-0 gap-6 z-40",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("button",{onClick:()=>r.undo(),disabled:e.past.length===0,className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${e.past.length>0?"bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/20":"bg-gray-800 text-gray-600 border border-gray-700 cursor-not-allowed opacity-50"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),i.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Undo"})]}),i.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-md px-6 py-2 rounded-xl border border-white/5 flex items-center gap-8 text-[10px] font-black uppercase tracking-[0.2em] text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"})," [1-7] Draw X"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"})," Space: Next Phase"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-pink-500"})," U: Untap All"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"})," S: Shuffle"]})]})]}),i.jsx("div",{className:"flex-grow"}),i.jsx("span",{className:"text-indigo-500/50",children:"Antigravity Solitaire Engine v2.0"})]}),i.jsx(kut,{isOpen:h,onClose:()=>f(!1),onCreateToken:S=>{r.createToken(S),f(!1)}}),i.jsx(_ut,{isOpen:!!m,zoneId:m,onClose:()=>g(null)})]})}function RT({active:t,onClick:e,label:r}){return i.jsx("button",{onClick:e,className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border transition-all ${t?"bg-indigo-500/20 text-indigo-400 border-indigo-500/50":"bg-gray-800/40 text-gray-600 border-white/5"}`,children:r})}function DT({title:t,pos:e,setPos:r,children:n,icon:s,isVisible:a}){const o=b.useRef(!1),l=b.useRef({x:0,y:0}),c=u=>{u.target.closest("button")||(o.current=!0,l.current={x:u.clientX-e.x,y:u.clientY-e.y},u.preventDefault())};return b.useEffect(()=>{const u=f=>{o.current&&r(m=>({...m,x:f.clientX-l.current.x,y:f.clientY-l.current.y}))},h=()=>o.current=!1;return window.addEventListener("mousemove",u),window.addEventListener("mouseup",h),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",h)}},[r]),a?i.jsxs("div",{className:`absolute bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl p-6 flex flex-col shadow-[0_32px_64px_-16px_rgba(0,0,0,0.5)] z-50 transition-all duration-300 ${e.isMinimized?"w-16 h-16 p-2 rounded-2xl items-center justify-center":""}`,style:{transform:`translate3d(${e.x}px, ${e.y}px, 0)`,top:0,left:0,cursor:o.current?"grabbing":"grab"},onMouseDown:c,children:[i.jsxs("div",{className:`flex items-center justify-between mb-4 select-none ${e.isMinimized?"hidden":""}`,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em]",children:t}),s]}),i.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!u.isMinimized})),className:"p-1 hover:bg-white/10 rounded-lg text-gray-500 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})})]}),e.isMinimized?i.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!1})),className:"w-12 h-12 flex items-center justify-center bg-indigo-600/20 text-indigo-400 rounded-xl hover:bg-indigo-600/40 transition-all",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}):n]}):null}const Eut=({isOpen:t,onClose:e,onConfirm:r,user:n})=>{const[s,a]=b.useState(lr.FREE);if(b.useEffect(()=>{t&&n&&a(n.override_tier||n.subscription_tier||lr.FREE)},[t,n]),!t||!n)return null;const o=ta[s],l=s===lr.FREE;o.prices;const u={[lr.FREE]:{m:"$0",b:"$0",y:"$0"},[lr.TIER_1]:{m:"$2.99",b:"$14.99",y:"$29.99"},[lr.TIER_2]:{m:"$4.99",b:"$24.99",y:"$49.99"},[lr.TIER_3]:{m:"$9.99",b:"$49.99",y:"$99.99"},[lr.TIER_4]:{m:"$14.99",b:"$74.99",y:"$149.99"},[lr.TIER_5]:{m:"$19.99",b:"$99.99",y:"$199.99"}}[s]||{m:"-",b:"-",y:"-"};return i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 border border-purple-500/30 rounded-xl p-6 max-w-lg w-full shadow-2xl transform transition-all animate-fade-in relative",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Override Subscription"}),i.jsxs("p",{className:"text-gray-400 text-sm mb-6",children:["Manually set the subscription tier for ",i.jsx("span",{className:"text-white font-bold",children:n.username}),". This will bypass Stripe billing."]}),i.jsxs("div",{className:"space-y-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Select Tier"}),i.jsx("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-500",value:s,onChange:h=>a(h.target.value),children:Object.values(lr).map(h=>i.jsxs("option",{value:h,children:[ta[h].name," (",h.replace("tier_","Tier "),")"]},h))})]}),!l&&i.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[i.jsx("h4",{className:"text-red-400 font-bold text-sm mb-2",children:" Potential Revenue Loss"}),i.jsxs("p",{className:"text-gray-400 text-xs mb-3",children:["By overriding this user to ",i.jsx("strong",{children:o.name}),", you are bypassing the following billing options:"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[i.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Monthly"}),i.jsx("div",{className:"text-white font-mono",children:u.m})]}),i.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"6 Months"}),i.jsx("div",{className:"text-white font-mono",children:u.b})]}),i.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Yearly"}),i.jsx("div",{className:"text-white font-mono",children:u.y})]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[n.override_tier&&i.jsx("button",{onClick:()=>r(null),className:"mr-auto px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold border border-red-500/30 transition-colors",children:"Remove Override"}),i.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),i.jsx("button",{onClick:()=>r(s),className:"px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-500 text-white font-bold shadow-lg",children:"Apply Override"})]})]})})},Aut=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(!1),[s,a]=b.useState(""),[o,l]=b.useState({key:"id",direction:"asc"}),[c,u]=b.useState(null),[h,f]=b.useState(!1),[m,g]=b.useState(null);b.useEffect(()=>{y()},[]);const y=async()=>{n(!0);try{const L=await He.getUsers();e(L)}catch(L){console.error(L)}finally{n(!1)}},v=L=>{let _="asc";o.key===L&&o.direction==="asc"&&(_="desc"),l({key:L,direction:_})},w=[...t].filter(L=>L.username?.toLowerCase().includes(s.toLowerCase())||L.email?.toLowerCase().includes(s.toLowerCase())||String(L.id).includes(s)).sort((L,_)=>{let E=L[o.key],M=_[o.key];return o.key==="tier"&&(E=L.override_tier||L.subscription_tier||"free"),o.key==="tier"&&(M=_.override_tier||_.subscription_tier||"free"),E<M?o.direction==="asc"?-1:1:E>M?o.direction==="asc"?1:-1:0}),N=async L=>{if(window.confirm(`Toggle ADMIN for ${L.username}?`))try{const _=!L.settings?.isAdmin;e(t.map(E=>E.id===L.id?{...E,settings:{...E.settings,isAdmin:_}}:E)),await He.updateUserPermissions(L.id,L.settings?.permissions,_)}catch{alert("Failed"),y()}},k=async(L,_)=>{try{const E=L.settings?.permissions||[],M=E.includes(_)?E.filter(B=>B!==_):[...E,_];e(t.map(B=>B.id===L.id?{...B,settings:{...B.settings,permissions:M}}:B)),await He.updateUserPermissions(L.id,M,L.settings?.isAdmin)}catch{alert("Failed"),y()}},C=async L=>{if(window.confirm(`Force push card collection for ${L.username}? Overwrites Firestore data.`)){u(L.id);try{const E=await(await fetch("/api/admin/sync-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:L.id})})).json();E.success?alert(`Sync Complete! Upserted: ${E.stats.upserted}`):alert(`Failed: ${E.error}`)}catch(_){alert(`Error: ${_.message}`)}finally{u(null)}}},I=async L=>{if(m)try{const _=L||"free";e(t.map(M=>M.id===m.id?{...M,override_tier:L,subscription_tier:_}:M));const E={user_override_tier:L,subscription_status:L?"active":"canceled",subscription_tier:_};await He.updateUserPermissions(m.id,m.settings?.permissions,m.settings?.isAdmin,E),f(!1),g(null)}catch(_){alert(_.message),y()}},O=async L=>{if(window.confirm(`Are you sure you want to DELETE user "${L.username}"? This cannot be undone.`)&&window.confirm(`Double Check: DELETING "${L.username}" (${L.email}). Confirm?`))try{await He.delete(`/api/users/${L.id}`),e(t.filter(_=>_.id!==L.id)),alert("User deleted.")}catch(_){console.error(_),alert("Failed to delete user: "+_.message)}};return i.jsxs("div",{className:"space-y-4",children:[i.jsx(Eut,{isOpen:h,onClose:()=>f(!1),onConfirm:I,user:m}),i.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-4 rounded-xl border border-gray-700",children:[i.jsx("input",{type:"text",placeholder:"Search users...",value:s,onChange:L=>a(L.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white w-64 focus:ring-2 focus:ring-indigo-500"}),i.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",w.length," / ",t.length," users"]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto rounded-xl border border-gray-700 bg-gray-900/50",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-800 text-gray-400 text-xs uppercase font-bold text-center",children:[i.jsxs("th",{className:"py-3 px-4 text-left cursor-pointer hover:text-white",onClick:()=>v("id"),children:["ID ",o.key==="id"&&(o.direction==="asc"?"":"")]}),i.jsxs("th",{className:"py-3 px-4 text-left cursor-pointer hover:text-white",onClick:()=>v("username"),children:["User ",o.key==="username"&&(o.direction==="asc"?"":"")]}),i.jsxs("th",{className:"py-3 px-4 cursor-pointer hover:text-white",onClick:()=>v("tier"),children:["Sub ",o.key==="tier"&&(o.direction==="asc"?"":"")]}),i.jsxs("th",{className:"py-3 px-4 cursor-pointer hover:text-white",onClick:()=>v("card_count"),children:["Cards ",o.key==="card_count"&&(o.direction==="asc"?"":"")]}),i.jsxs("th",{className:"py-3 px-4 cursor-pointer hover:text-white",onClick:()=>v("deck_count"),children:["Decks ",o.key==="deck_count"&&(o.direction==="asc"?"":"")]}),i.jsxs("th",{className:"py-3 px-4 cursor-pointer hover:text-white",onClick:()=>v("last_login"),children:["Last Active ",o.key==="last_login"&&(o.direction==="asc"?"":"")]}),i.jsx("th",{className:"py-3 px-4",children:"Permissions"}),i.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),i.jsx("tbody",{className:"text-sm divide-y divide-gray-800",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"p-8 text-center text-gray-500",children:"Loading..."})}):w.map(L=>{const _=L.settings?.permissions?.includes("manage_tickets");return i.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[i.jsx("td",{className:"py-3 px-4 text-gray-500 text-xs text-center",children:L.id}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"font-bold text-white max-w-[150px] truncate",title:L.username,children:L.username||"No Name"}),i.jsx("div",{className:"text-xs text-gray-500 max-w-[150px] truncate",title:L.email,children:L.email})]}),i.jsx("td",{className:"py-3 px-4 text-center",children:i.jsx("button",{onClick:()=>{g(L),f(!0)},className:`text-[10px] px-2 py-0.5 rounded border uppercase font-bold tracking-wider ${L.override_tier?"bg-purple-900/30 text-purple-400 border-purple-500/30":L.subscription_status==="trial"?"bg-amber-500/20 text-amber-400 border-amber-500/30":"bg-gray-800 text-gray-400 border-gray-600"}`,children:(L.override_tier||L.subscription_tier||"free").replace("tier_","Tier ")})}),i.jsx("td",{className:"py-3 px-4 text-center font-mono text-indigo-300",children:L.card_count||0}),i.jsx("td",{className:"py-3 px-4 text-center font-mono text-purple-300",children:L.deck_count||0}),i.jsx("td",{className:"py-3 px-4 text-center text-xs text-gray-500",children:L.last_login?new Date(L.last_login).toLocaleDateString():"-"}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx("button",{onClick:()=>N(L),title:"Toggle Admin",className:`w-3 h-3 rounded-full ${L.settings?.isAdmin?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":"bg-gray-700"}`}),i.jsx("button",{onClick:()=>k(L,"manage_tickets"),title:"Toggle Ticket Mgr",className:`w-3 h-3 rounded-full ${_?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.5)]":"bg-gray-700"}`})]})}),i.jsx("td",{className:"py-3 px-4 text-right",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>C(L),disabled:c===L.id,className:"text-[10px] bg-cyan-900/30 hover:bg-cyan-800 text-cyan-400 border border-cyan-700/50 px-2 py-1 rounded transition-colors disabled:opacity-50",children:c===L.id?"Syncing...":"Push FS"}),i.jsx("button",{onClick:()=>O(L),className:"text-red-500 hover:text-red-400 p-1 rounded hover:bg-red-500/10 transition-colors",title:"Delete User",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},L.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-4",children:r?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):w.map(L=>{const _=L.settings?.permissions?.includes("manage_tickets");return i.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-4 space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-white text-lg",children:L.username||"No Name"}),i.jsx("div",{className:"text-xs text-gray-500",children:L.email})]}),i.jsxs("div",{className:"text-xs font-mono text-gray-500",children:["#",L.id]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm bg-gray-900/50 p-3 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs uppercase",children:"Cards"}),i.jsx("p",{className:"font-mono text-indigo-400",children:L.card_count||0})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs uppercase",children:"Decks"}),i.jsx("p",{className:"font-mono text-purple-400",children:L.deck_count||0})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs uppercase",children:"Sub"}),i.jsx("button",{onClick:()=>{g(L),f(!0)},className:"text-xs text-gray-300 underline",children:(L.override_tier||L.subscription_tier||"free").replace("tier_","Tier ")})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs uppercase",children:"Active"}),i.jsx("p",{className:"text-gray-300",children:L.last_login?new Date(L.last_login).toLocaleDateString():"-"})]})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-700",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>N(L),className:`text-xs px-2 py-1 rounded ${L.settings?.isAdmin?"bg-indigo-500/20 text-indigo-400":"bg-gray-700 text-gray-400"}`,children:"Admin"}),i.jsx("button",{onClick:()=>k(L,"manage_tickets"),className:`text-xs px-2 py-1 rounded ${_?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-400"}`,children:"Ticket Mgr"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>C(L),disabled:c===L.id,className:"p-2 bg-cyan-900/30 text-cyan-400 rounded hover:bg-cyan-800",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),i.jsx("button",{onClick:()=>O(L),className:"p-2 bg-red-900/30 text-red-500 rounded hover:bg-red-800",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 0 00-1-1h-4a1 0 00-1 1v3M4 7h16"})})})]})]})]},L.id)})})]})},Tut=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(""),[s,a]=b.useState([]),[o,l]=b.useState(!1),c=b.useRef(!1),[u,h]=b.useState({current:0,total:0}),[f,m]=b.useState({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),[g,y]=b.useState({updatePrices:!0,updateInfo:!0}),[v,w]=b.useState(null);b.useEffect(()=>{N();const B=localStorage.getItem("admin_last_sync");if(B)try{w(JSON.parse(B))}catch(S){console.error(S)}},[]);const N=async()=>{try{const B=await He.get("/api/admin/sets");e(B.data||[])}catch(B){console.error(B)}},k=B=>a(S=>[...S,`${new Date().toLocaleTimeString()} - ${B}`]),C=(B,S)=>{m(P=>{const R={...P};return R.totalCards+=B,S&&Object.keys(S).forEach(V=>R.types[V]=(R.types[V]||0)+(S[V]||0)),R})},I=B=>{const S={date:new Date().toISOString(),stats:B};w(S),localStorage.setItem("admin_last_sync",JSON.stringify(S))},O=async(B,S=!1)=>{if(B)try{k(`Starting sync for ${B}...`);const R=await(await fetch("/api/admin/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({setCode:B,...g})})).json();R.success?(k(`Success: ${B}. Processed ${R.count} cards.`),C(R.count,R.typeStats),S&&h(V=>({...V,current:V.current+1}))):k(`Error: ${R.error}`)}catch(P){k(`Request Failed: ${P.message}`)}},L=()=>{window.confirm("Cancel sync?")&&(c.current=!0,k("Cancelling..."))},_=async()=>{if(window.confirm("Sync ALL sets?")){l(!0),c.current=!1,k("Starting Mass Sync..."),m({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),h({current:0,total:t.length});for(const B of t){if(c.current)break;await O(B.code,!0)}k("Mass Sync Complete!"),I(f),l(!1)}},E=async()=>{r&&(l(!0),m({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),await O(r),l(!1))},M=async B=>{const S=B.target.files[0];if(!S||!window.confirm(`Upload ${S.name}?`))return;const P=new FormData;P.append("file",S);try{const V=await(await fetch("/api/admin/precons/upload",{method:"POST",body:P})).json();V.success?alert(`Uploaded ${V.name}`):alert(`Error: ${V.error}`)}catch{alert("Upload failed")}B.target.value=null};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Scryfall Sync"}),v&&i.jsxs("div",{className:"text-right text-xs text-gray-400",children:[i.jsxs("p",{children:["Last: ",new Date(v.date).toLocaleString()]}),i.jsxs("p",{children:[v.stats.totalCards," cards"]})]})]}),i.jsxs("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Upload Precon JSON"}),i.jsx("p",{className:"text-xs text-purple-300 mb-3",children:"Upload a JSON file from MTGJSON or similar format to import preconstructed decks."}),i.jsx("input",{type:"file",accept:".json",onChange:M,className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-indigo-900/40 p-4 rounded-lg border border-indigo-700/50",children:[i.jsx("p",{className:"text-xs text-indigo-300 uppercase font-bold",children:"Total Cards"}),i.jsx("p",{className:"text-2xl font-bold text-white",children:f.totalCards})]}),i.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700",children:[i.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Progress"}),i.jsx("p",{className:"text-2xl font-bold text-white",children:u.total>0?`${u.current} / ${u.total}`:"-"}),u.total>0&&i.jsx("div",{className:"w-full bg-gray-700 h-1.5 mt-2 rounded-full overflow-hidden",children:i.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${u.current/u.total*100}%`}})})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-lg border border-gray-700/50 flex flex-wrap gap-6 items-center",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:g.updatePrices,onChange:B=>y(S=>({...S,updatePrices:B.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),i.jsx("span",{className:"text-gray-200 text-sm",children:"Update Prices"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:g.updateInfo,onChange:B=>y(S=>({...S,updateInfo:B.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),i.jsx("span",{className:"text-gray-200 text-sm",children:"Update Card Info"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[i.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Single Set"}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white flex-1 min-w-0 max-w-full",value:r,onChange:B=>n(B.target.value),children:[i.jsx("option",{value:"",children:"Select Set..."}),t.map(B=>i.jsxs("option",{value:B.code,className:"truncate",children:[B.name," (",B.code.toUpperCase(),")"]},B.code))]}),i.jsx("button",{onClick:E,disabled:o||!r,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg",children:o?"...":"Sync"})]})]}),i.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[i.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Mass Sync"}),o?i.jsx("button",{onClick:L,className:"bg-red-600 text-white px-6 py-3 rounded-lg w-full font-bold animate-pulse",children:"CANCEL"}):i.jsx("button",{onClick:_,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold",children:"SYNC ALL"})]})]}),i.jsx("div",{className:"bg-black/50 p-4 rounded-lg font-mono text-xs text-green-400 h-64 overflow-y-auto border border-white/10",children:s.map((B,S)=>i.jsx("div",{children:B},S))})]})]})},Iut=({isOpen:t,onClose:e,onConfirm:r,title:n,message:s,confirmText:a="Confirm",creating:o})=>t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all animate-fade-in relative",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),i.jsx("p",{className:"text-gray-300 mb-6",children:s}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:e,disabled:o,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),i.jsxs("button",{onClick:r,disabled:o,className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-bold shadow-lg disabled:opacity-50 flex items-center gap-2",children:[o&&i.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})]})]})}):null,Put=({activeTab:t="epics"})=>{const{userProfile:e}=Cr(),[r,n]=b.useState([]),[s,a]=b.useState({title:"",description:"",status:"open"}),[o,l]=b.useState(null),[c,u]=b.useState(!1),[h,f]=b.useState({start:wa(new Date(Date.now()-10080*60*1e3),"yyyy-MM-dd"),end:wa(new Date,"yyyy-MM-dd")}),[m,g]=b.useState([]),[y,v]=b.useState(!1),[w,N]=b.useState(""),[k,C]=b.useState(!1),[I,O]=b.useState(!1),[L,_]=b.useState(""),[E,M]=b.useState(!1);b.useEffect(()=>{t==="epics"&&B()},[t]);const B=async()=>{u(!0);try{const G=await He.getEpics();n(G||[])}catch(G){console.error(G)}finally{u(!1)}},S=async G=>{if(window.confirm("Delete this epic? This will NOT delete associated tickets but will unlink them."))try{await He.deleteEpic(G),B()}catch(J){alert("Failed to delete epic: "+J.message)}},P=G=>{const J={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"};return i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-bold tracking-wider border ${J[G]||J.open}`,children:G.replace("_"," ")})},R=async()=>{v(!0);try{const G=await He.getTicketReport({startDate:h.start,endDate:h.end,excludeReleased:!0,status:""});g(G)}catch(G){alert("Failed to fetch report: "+G.message)}finally{v(!1)}},V=async()=>{if(!e?.settings?.geminiApiKey)return alert("Missing Gemini API Key.");C(!0);try{const G=await Nl.generateReleaseNotes(e.settings.geminiApiKey,m,e);N(G),_(`v${new Date().toISOString().slice(0,10).replace(/-/g,".")}`)}catch(G){alert("Failed to generate release notes: "+G.message)}finally{C(!1)}},ee=async()=>{O(!0);try{await He.publishRelease({version:L,notes:w,ticketIds:m.map(G=>G.id),typeStats:{total:m.length}}),M(!1),N(""),g([]),alert("Release Published Successfully!")}catch(G){alert("Failed to publish: "+G.message),M(!1)}finally{O(!1)}};return i.jsxs("div",{className:"space-y-8",children:[i.jsx(Iut,{isOpen:E,onClose:()=>M(!1),onConfirm:ee,title:`Publish Release ${L}?`,message:`This will move ${m.length} tickets to "Released".`,confirmText:I?"Publishing...":"Confirm Publish",creating:I}),i.jsxs("section",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Epics / Projects"}),i.jsx("button",{onClick:()=>a(G=>({...G,open:!G.open})),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium",children:"New Epic"})]}),c?i.jsx("p",{className:"text-gray-400",children:"Loading..."}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(G=>i.jsxs("div",{className:"bg-gray-800 border border-gray-700 p-4 rounded-xl",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"font-bold text-white",children:G.title}),P(G.status)]}),i.jsx("p",{className:"text-sm text-gray-400 mb-4 line-clamp-2",children:G.description}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:()=>l(G),className:"text-xs bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded",children:"Edit"}),i.jsx("button",{onClick:()=>S(G.id),className:"text-xs bg-red-900/40 text-red-400 hover:bg-red-900/60 px-2 py-1 rounded border border-red-900/50",children:"Delete"})]})]},G.id))})]}),i.jsx("hr",{className:"border-gray-700"}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Release Notes Generator"}),i.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 space-y-6",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Start Date"}),i.jsx("input",{type:"date",value:h.start,onChange:G=>f(J=>({...J,start:G.target.value})),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"End Date"}),i.jsx("input",{type:"date",value:h.end,onChange:G=>f(J=>({...J,end:G.target.value})),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm"})]}),i.jsx("button",{onClick:R,disabled:y,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-bold h-[38px]",children:y?"Fetching...":"Fetch Activity"})]}),m.length>0&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("h3",{className:"font-bold text-white",children:["Found ",m.length," Items"]}),i.jsx("button",{onClick:V,disabled:k,className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2",children:k?"Generating...":"Generate with AI"})]}),i.jsx("div",{className:"max-h-60 overflow-y-auto bg-gray-900/50 border border-gray-700 rounded-lg p-2 space-y-1",children:m.map(G=>i.jsxs("div",{className:"text-xs text-gray-300 flex justify-between p-1 hover:bg-gray-800 rounded",children:[i.jsx("span",{className:"truncate flex-1",children:G.title}),i.jsx("span",{className:`px-1.5 rounded uppercase text-[10px] font-bold ${G.type==="bug"?"bg-red-900/50 text-red-400":"bg-blue-900/50 text-blue-400"}`,children:G.type})]},G.id))})]}),w&&i.jsxs("div",{className:"animate-fade-in space-y-4",children:[i.jsx("h3",{className:"font-bold text-white",children:"Preview & Publish"}),i.jsx("div",{className:"bg-gray-950 p-4 rounded-lg border border-gray-700 font-mono text-sm text-gray-300 whitespace-pre-wrap max-h-96 overflow-y-auto",children:w}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("input",{type:"text",value:L,onChange:G=>_(G.target.value),placeholder:"v1.0.0",className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white font-mono"}),i.jsx("button",{onClick:()=>M(!0),className:"bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-green-900/20",children:"Publish Release"})]})]})]})]})]})},Lut=()=>{const{userProfile:t}=Cr(),e=Ca(),[r,n]=b.useState(!1);if(!t?.settings?.isAdmin&&t?.firestore_id!=="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")return i.jsx(e4,{to:"/dashboard",replace:!0});const s=[{path:"users",label:"User Management",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{path:"sync",label:"DB Sync & Tools",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})})},{path:"content",label:"Content Manager",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})}];return i.jsxs("div",{className:"flex h-[calc(100vh-64px)] bg-gray-900 overflow-hidden relative",children:[i.jsx("div",{className:"md:hidden absolute top-4 left-4 z-50",children:i.jsx("button",{onClick:()=>n(!r),className:"p-2 bg-gray-800 rounded-lg text-white border border-gray-700 shadow-lg",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),r&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>n(!1)}),i.jsxs("aside",{className:`
                absolute md:relative z-40 h-full w-64 bg-gray-950 border-r border-gray-800 flex flex-col transition-transform duration-300
                ${r?"translate-x-0":"-translate-x-full md:translate-x-0"}
            `,children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 pt-16 md:pt-6",children:[i.jsx("h1",{className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Admin Console"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"System Management"})]}),i.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:s.map(a=>i.jsxs(NL,{to:`/admin/${a.path}`,onClick:()=>n(!1),className:({isActive:o})=>`
                                flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm
                                ${o?"bg-indigo-600/10 text-indigo-400 border border-indigo-500/20 shadow-lg shadow-indigo-900/10":"text-gray-400 hover:bg-gray-800 hover:text-gray-200 border border-transparent"}
                            `,children:[i.jsx("div",{className:`${e.pathname.includes(a.path)?"text-indigo-500":"text-gray-500"}`,children:a.icon}),a.label]},a.path))}),i.jsx("div",{className:"p-4 border-t border-gray-800",children:i.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 text-xs text-gray-500 border border-gray-800",children:[i.jsx("p",{className:"font-bold text-gray-400 mb-1",children:"System Status"}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{children:"Server"}),i.jsxs("span",{className:"text-green-500 flex items-center gap-1",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})," Online"]})]})]})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-900 relative w-full",children:i.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8 pt-16 md:pt-8",children:i.jsxs(bL,{children:[i.jsx(Vr,{path:"users",element:i.jsx(Aut,{})}),i.jsx(Vr,{path:"sync",element:i.jsx(Tut,{})}),i.jsx(Vr,{path:"content",element:i.jsx(Put,{})}),i.jsx(Vr,{path:"*",element:i.jsx(e4,{to:"users",replace:!0})})]})})})]})},Out=()=>{const{userProfile:t}=Cr(),[e,r]=b.useState(!1),[n,s]=b.useState(!1),a=t?.settings?.helper,o=a?.name||"MTG Forge",[l,c]=b.useState([]),[u,h]=b.useState(""),[f,m]=b.useState(!1),[g,y]=b.useState(!1),v=b.useRef(null),w=()=>{v.current?.scrollIntoView({behavior:"smooth"})};b.useEffect(()=>{w()},[l]),b.useEffect(()=>{const E=()=>{r(!0)};return window.addEventListener("open-chat-widget",E),()=>window.removeEventListener("open-chat-widget",E)},[]),b.useEffect(()=>{if(!e)return;(async()=>{const M=t?.settings?.geminiApiKey;if(!M||g){!M&&l.length===0&&c([{role:"model",content:'<p class="text-gray-300">Please add your Gemini API Key in Settings to enable the chat.</p>'}]);return}if(y(!0),!(l.length>0))try{const B=`
                    You are about to have a conversation with a user.
                    your name is ${o}.
                    Your personality is: ${a?.personality||"Knowledgeable and friendly"}.
                    It is not their first time working with you, interact with them appropriately.
                    Use emojis. 
                `,S=await Nl.sendMessage(M,[],B,"",a,t);c([{role:"model",content:S}])}catch(B){console.error("Intro fetch failed",B),c([{role:"model",content:`<p>Greetings. I am ${o}. How may I assist?</p>`}])}})()},[e,t?.settings?.geminiApiKey,o,g]);const N=Ca(),k=t?.settings?.playstyle,C=k?`
User's Playstyle Profile:
- Archetypes: ${k.archetypes?.join(", ")||"Unknown"}
- Summary: ${k.summary||"Unknown"}
- Combat Preference: ${k.scores?.aggression>50?"Aggressive":"Defensive"}
- Interaction Level: ${k.scores?.interaction>50?"High":"Low"}
    `.trim():"",O=`
${pU?pU(N.pathname):""}

${C}
    `.trim(),L=async E=>{if(E.preventDefault(),!u.trim()||f)return;const M=u.trim();h(""),c(B=>[...B,{role:"user",content:M}]),m(!0);try{const B=t?.settings?.geminiApiKey;if(!B){c(R=>[...R,{role:"model",content:'<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Please add your Gemini API Key in <a href="/settings" class="underline font-bold">Settings</a> to use the chat.</div>'}]);return}const S=l.map(R=>({role:R.role,content:R.content})),P=await Nl.sendMessage(B,S,M,O,a,t);c(R=>[...R,{role:"model",content:P}])}catch(B){console.error(B),c(S=>[...S,{role:"model",content:`<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Error: ${B.message}</div>`}])}finally{m(!1)}},_=n?"fixed inset-0 top-16 z-40":`fixed bottom-0 right-0 z-[60] transition-all duration-300 ${e?"":"w-16 h-16 mb-20 mr-4 md:mb-6 md:mr-6"}`;return i.jsxs("div",{className:`${_} ${!n&&e?"w-full md:w-96 h-[600px] mb-16 md:mb-0 mr-0":""}`,children:[!e&&i.jsx("button",{onClick:()=>r(!0),className:"w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full shadow-lg shadow-purple-500/30 flex items-center justify-center hover:scale-110 transition-transform animate-bounce-slow",children:i.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e&&i.jsxs("div",{className:`flex flex-col h-full bg-gray-800 border-t border-l border-gray-700 shadow-2xl overflow-hidden ${n?"w-full h-full":"rounded-tl-2xl md:rounded-tr-2xl md:border-r"}`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-700",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),i.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:o})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>s(!n),className:"text-gray-400 hover:text-white p-1 hover:bg-gray-800 rounded transition-colors",title:n?"Collapse":"Expand",children:n?i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6m-6 0v6M20 10h-6m6 0V4"})}):i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),i.jsx("button",{onClick:()=>{r(!1),s(!1)},className:"text-gray-400 hover:text-white",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-800/95 backdrop-blur",children:[l.length===0&&!f?i.jsxs("div",{className:"flex justify-center items-center h-full text-gray-500 italic",children:["Summoning ",o,"..."]}):l.map((E,M)=>i.jsx("div",{className:`flex ${E.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl ${E.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"} shadow-md`,children:E.role==="user"?E.content:i.jsx("div",{dangerouslySetInnerHTML:{__html:E.content}})})},M)),f&&i.jsx("div",{className:"flex justify-start",children:i.jsxs("div",{className:"bg-gray-700 rounded-2xl rounded-bl-none p-3 flex gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),i.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-75"}),i.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"})]})}),i.jsx("div",{ref:v})]}),i.jsx("form",{onSubmit:L,className:"p-4 bg-gray-900 border-t border-gray-700",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:u,onChange:E=>h(E.target.value),placeholder:`Ask ${o}...`,className:"flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"}),i.jsx("button",{type:"submit",disabled:f,className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg hover:shadow-indigo-500/20 transition-all disabled:opacity-50",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})};var Mut=["added","removed","updated"];function YQ(t){return Mut.includes(t)}async function Rut({queryClient:t,persister:e,maxAge:r=1e3*60*60*24,buster:n="",hydrateOptions:s}){try{const a=await e.restoreClient();if(a)if(a.timestamp){const o=Date.now()-a.timestamp>r,l=a.buster!==n;if(o||l)return e.removeClient();Ywe(t,a.clientState,s)}else return e.removeClient()}catch(a){throw await e.removeClient(),a}}async function XQ({queryClient:t,persister:e,buster:r="",dehydrateOptions:n}){const s={buster:r,timestamp:Date.now(),clientState:Kwe(t,n)};await e.persistClient(s)}function Dut(t){const e=t.queryClient.getQueryCache().subscribe(n=>{YQ(n.type)&&XQ(t)}),r=t.queryClient.getMutationCache().subscribe(n=>{YQ(n.type)&&XQ(t)});return()=>{e(),r()}}var But=({children:t,persistOptions:e,onSuccess:r,onError:n,...s})=>{const[a,o]=b.useState(!0),l=b.useRef({persistOptions:e,onSuccess:r,onError:n}),c=b.useRef(!1);return b.useEffect(()=>{l.current={persistOptions:e,onSuccess:r,onError:n}}),b.useEffect(()=>{const u={...l.current.persistOptions,queryClient:s.client};return c.current||(c.current=!0,Rut(u).then(()=>l.current.onSuccess?.()).catch(()=>l.current.onError?.()).finally(()=>{o(!1)})),a?void 0:Dut(u)},[s.client,a]),i.jsx(u5e,{...s,children:i.jsx(h5e,{value:a,children:t})})};function fL(){}function Fut(t,{interval:e=1e3,onError:r=fL}={}){if(typeof t!="function")throw new Error("argument is not function.");let n=0,s=null,a=!1,o=!1;return async(...l)=>{if(s=l,!o){for(o=!0;a;)await new Promise(c=>of.setTimeout(c,e));for(;Date.now()<n;)await new Promise(c=>of.setTimeout(c,n-Date.now()));o=!1,a=!0;try{await t(...s)}catch(c){try{r(c)}catch{}}n=Date.now()+e,a=!1}}}var $ut=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:r=1e3,serialize:n=JSON.stringify,deserialize:s=JSON.parse,retry:a})=>{if(t){const o=async l=>{try{const c=await n(l);await t.setItem(e,c);return}catch(c){return c}};return{persistClient:Fut(async l=>{let c=l,u=await o(c),h=0;for(;u&&c;)h++,c=await a?.({persistedClient:c,error:u,errorCount:h}),c&&(u=await o(c))},{interval:r}),restoreClient:async()=>{const l=await t.getItem(e);if(l)return await s(l)},removeClient:()=>t.removeItem(e)}}return{persistClient:fL,restoreClient:()=>Promise.resolve(void 0),removeClient:fL}};function w3(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Uut(t,e){let r;const n=()=>{if(r)return r;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),r=w3(s),r.then(a=>{a.onclose=()=>r=void 0},()=>{}),r};return(s,a)=>n().then(o=>a(o.transaction(e,s).objectStore(e)))}let BT;function uD(){return BT||(BT=Uut("keyval-store","keyval")),BT}function zut(t,e=uD()){return e("readonly",r=>w3(r.get(t)))}function Vut(t,e,r=uD()){return r("readwrite",n=>(n.put(e,t),w3(n.transaction)))}function qut(t,e=uD()){return e("readwrite",r=>(r.delete(t),w3(r.transaction)))}const Hut=new c5e({defaultOptions:{queries:{staleTime:1e3*60*5,cacheTime:1e3*60*60*24,retry:(t,e)=>e?.response?.status===403||e?.response?.status===404||!navigator.onLine?!1:t<2,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),Wut=$ut({storage:{getItem:async t=>await zut(t),setItem:async(t,e)=>await Vut(t,e),removeItem:async t=>await qut(t)},key:"REACT_QUERY_OFFLINE_CACHE",throttleTime:1e3});var Gut=function(){return null};const Kut=()=>{const{isOpen:t,selectedCard:e,closeCardModal:r}=aw(),{cards:n,removeCard:s,updateCard:a}=yo(),{decks:o}=yd(),{addToast:l}=Tn(),[c,u]=b.useState(!1),[h,f]=b.useState(!1),[m,g]=b.useState({quantity:1,finish:"nonfoil",deckId:"",price_bought:"",tags:[],currentTag:""}),[y,v]=b.useState([]);if(b.useEffect(()=>{t&&e&&(u(!1),f(!1),g({quantity:e.count||e.quantity||1,finish:e.finish||"nonfoil",deckId:e.deckId||e.deck_id||"",price_bought:e.price_bought||"",tags:typeof e.tags=="string"?JSON.parse(e.tags):e.tags||[],currentTag:""}),He.get("/api/decks").then(v).catch(X=>console.error("Failed to load decks",X)))},[t,e]),!t||!e)return null;const w=e.data||e,N=w.card_faces,k=N&&N.length>1&&!!N[1].image_uris,O=(X=>k?w.card_faces[X]:w)(c?1:0),L=X=>X.image_uris?.normal||X.image_uris?.large||null,_=X=>X.image_uris?.art_crop||X.image_uris?.large||X.image_uris?.normal||null,E=k?L(w.card_faces[0]):w.image_uris?.normal||w.image_uris?.large||e.image_uri,M=k?L(w.card_faces[1]):null,B=k?_(w.card_faces[0]):w.image_uris?.art_crop||w.image_uris?.large||e.image_uri,S=k?_(w.card_faces[1]):null,P=c?M:E,R=(c?S:B)||"https://placehold.co/1000x800?text=No+Art",V=X=>X?X.replace(/\{/g,"").replace(/\}/g," "):"",ee=(X,q)=>{const U={legal:"bg-green-600 text-white border-green-700",not_legal:"bg-gray-700 text-gray-400 border-gray-600",banned:"bg-red-600 text-white border-red-700",restricted:"bg-yellow-600 text-white border-yellow-700"},H=U[q]||U.not_legal;return i.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border ${H} flex justify-center items-center shadow-sm`,children:i.jsx("span",{children:X})},X)},G=async()=>{if(window.confirm(`Are you sure you want to delete ${e.name} from your collection?`))try{e.onDelete?await e.onDelete(e.id||e.firestoreId,e.name):(await s(e.id||e.firestoreId),l("Card deleted","success")),r()}catch(X){console.error(X),l("Failed to delete card","error")}},J=async()=>{try{const X={count:parseInt(m.quantity),finish:m.finish,deck_id:m.deckId?parseInt(m.deckId):null,price_bought:m.price_bought?parseFloat(m.price_bought):null,tags:m.tags};await a(e.id||e.firestoreId,X),l("Card details updated","success"),f(!1)}catch(X){console.error(X),l("Failed to update details","error")}},Z=X=>{X.key==="Enter"&&m.currentTag.trim()&&(X.preventDefault(),m.tags.includes(m.currentTag.trim())||g(q=>({...q,tags:[...q.tags,q.currentTag.trim()],currentTag:""})))},se=X=>{g(q=>({...q,tags:q.tags.filter(U=>U!==X)}))};return i.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center overflow-hidden animate-fade-in",role:"dialog",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:r}),i.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full md:h-[90vh] max-h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-y-auto md:overflow-hidden bg-gray-900/50 border border-gray-700",children:[i.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-2xl",children:[i.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-700 ease-in-out transform scale-110 opacity-100",style:{backgroundImage:`url('${R}')`}}),i.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),i.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-50 p-2 bg-black/30 hover:bg-black/60 rounded-full text-white/70 hover:text-white transition-colors backdrop-blur-md",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsxs("div",{className:"w-full md:w-1/2 lg:w-5/12 p-8 flex flex-col items-center justify-center relative shrink-0 z-10",children:[i.jsxs("div",{className:"relative w-full max-w-xs md:max-w-md aspect-[2.5/3.5] perspective-1000 transition-transform duration-500",children:[i.jsx("img",{src:P||"https://placehold.co/250x350?text=No+Image",alt:e.name,className:"w-full h-full object-contain drop-shadow-2xl rounded-xl shadow-black/50"}),k&&i.jsx("button",{onClick:()=>u(!c),className:"absolute top-4 right-4 bg-black/60 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg border border-white/20 hover:border-indigo-400 transition-all group backdrop-blur-md",title:"Flip Card",children:i.jsx("svg",{className:`w-6 h-6 transform transition-transform duration-500 ${c?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),w.artist&&i.jsxs("div",{className:"mt-4 text-white/80 text-xs flex items-center gap-1 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Illustrated by ",i.jsx("span",{className:"font-medium",children:w.artist})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col md:h-full bg-gray-900/60 backdrop-blur-xl min-h-0 z-10 border-l border-white/10",children:[i.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 shrink-0 relative group",children:[i.jsx("button",{onClick:()=>f(!h),className:`absolute top-6 right-16 p-2 rounded-full transition-all ${h?"text-indigo-400 bg-indigo-500/20":"text-gray-500 hover:text-white hover:bg-gray-700"}`,title:h?"Cancel Editing":"Edit Card Details",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsx("h2",{className:"text-3xl font-bold text-white mb-1 pr-10",children:w.name}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-400 text-sm mt-2",children:[i.jsx("span",{className:"font-medium text-gray-300",children:O.type_line}),O.mana_cost&&i.jsx("span",{className:"bg-gray-800 px-2 py-0.5 rounded border border-gray-700 text-gray-200 font-mono tracking-wider",children:V(O.mana_cost)}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-indigo-400 font-bold",children:w.set_name||w.set?.toUpperCase()}),i.jsx("span",{className:"text-gray-600",children:""}),i.jsx("span",{className:"capitalize",children:w.rarity}),i.jsx("span",{className:"text-gray-600",children:""}),i.jsxs("span",{children:["#",w.collector_number]})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-visible md:overflow-y-auto p-6 space-y-8 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Gameplay & Rules"]}),i.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-5 border border-gray-700/50 shadow-inner",children:[O.oracle_text?i.jsx("div",{className:"text-gray-200 whitespace-pre-wrap font-serif leading-relaxed text-lg",children:O.oracle_text.split(`
`).map((X,q)=>i.jsx("p",{className:"mb-2 last:mb-0",children:X},q))}):i.jsx("span",{className:"text-gray-500 italic",children:"No rules text."}),O.flavor_text&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-gray-400 italic font-serif text-sm",children:['"',O.flavor_text,'"']})]}),(O.power||O.loyalty)&&i.jsx("div",{className:"flex justify-end",children:i.jsx("div",{className:"bg-gray-800 border border-gray-600 px-4 py-2 rounded-lg text-xl font-bold text-white shadow-lg",children:O.power?`${O.power} / ${O.toughness}`:`Loyalty: ${O.loyalty}`})})]}),w.legalities&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Legalities"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[ee("Commander",w.legalities.commander),ee("Standard",w.legalities.standard),ee("Modern",w.legalities.modern),ee("Pauper",w.legalities.pauper),ee("Legacy",w.legalities.legacy),ee("Vintage",w.legalities.vintage)]})]}),i.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[i.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Status & Ownership ",h&&i.jsx("span",{className:"text-indigo-400 text-[10px] ml-2 font-normal animate-pulse",children:"(Editing)"})]}),e.is_wishlist&&!h&&i.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3 animate-pulse space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-orange-500 rounded-full text-white shrink-0",children:i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-orange-400 font-black text-xs uppercase tracking-wider",children:"In Wishlist"}),i.jsx("div",{className:"text-gray-400 text-[10px]",children:"This card is on your want list."})]})]}),i.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${e.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center py-2 bg-gray-900/50 hover:bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded border border-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"Find on TCGPlayer"]})]}),(()=>{const X=w.id,q=n.filter(ae=>ae.scryfall_id===X||ae.scryfallId===X||ae.id===X),U=q.filter(ae=>!ae.is_wishlist&&ae.finish==="nonfoil").reduce((ae,xe)=>ae+(xe.count||1),0),H=q.filter(ae=>!ae.is_wishlist&&ae.finish==="foil").reduce((ae,xe)=>ae+(xe.count||1),0),re=q.filter(ae=>ae.is_wishlist).reduce((ae,xe)=>ae+(xe.count||1),0);return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${U>0?"bg-indigo-500/10 border-indigo-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Normal"}),i.jsx("div",{className:"text-xl font-black text-white",children:U}),i.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),i.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${H>0?"bg-purple-500/10 border-purple-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Foil"}),i.jsx("div",{className:"text-xl font-black text-indigo-400",children:H}),i.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),i.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${re>0?"bg-orange-500/10 border-orange-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Wishlist"}),i.jsx("div",{className:"text-xl font-black text-orange-400",children:re}),i.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Wanted"})]})]}),i.jsxs("div",{className:"bg-gray-900/40 rounded-xl p-3 border border-gray-700/50",children:[i.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2",children:"Locations"}),i.jsx("div",{className:"space-y-1.5",children:(()=>{const ae=[];let xe=0,Ne=0;const pe={};return q.forEach(K=>{if(K.is_wishlist)return;const ue=K.count||1;if(K.deck_id){if(!pe[K.deck_id]){const fe=o?.find(he=>he.id===K.deck_id)?.name||`Deck #${K.deck_id}`;pe[K.deck_id]={name:fe,n:0,f:0}}K.finish==="foil"?pe[K.deck_id].f+=ue:pe[K.deck_id].n+=ue}else K.finish==="foil"?Ne+=ue:xe+=ue}),(xe>0||Ne>0)&&ae.push(i.jsxs("div",{className:"flex justify-between items-center text-xs",children:[i.jsxs("span",{className:"text-gray-300 flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gray-500"}),"Binder"]}),i.jsxs("div",{className:"flex gap-2",children:[xe>0&&i.jsxs("span",{className:"text-gray-400 font-mono",children:[xe," Normal"]}),Ne>0&&i.jsxs("span",{className:"text-indigo-400 font-mono",children:[Ne," Foil"]})]})]},"binder")),Object.values(pe).forEach(K=>{ae.push(i.jsxs("div",{className:"flex justify-between items-center text-xs",children:[i.jsxs("span",{className:"text-gray-300 flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),K.name]}),i.jsxs("div",{className:"flex gap-2",children:[K.n>0&&i.jsxs("span",{className:"text-gray-400 font-mono",children:[K.n," Normal"]}),K.f>0&&i.jsxs("span",{className:"text-indigo-400 font-mono",children:[K.f," Foil"]})]})]},K.name))}),ae.length===0?i.jsx("div",{className:"text-gray-500 italic text-xs",children:"No copies in collection."}):ae})()})]}),(h||e.firestoreId||e.firestore_id)&&i.jsxs("div",{className:"bg-gray-950/40 rounded-xl overflow-hidden border border-gray-700/50",children:[i.jsxs("div",{className:"px-3 py-2 bg-gray-800/40 border-b border-gray-700/50 flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-400",children:[i.jsx("span",{children:"Selected Item Details"}),e.is_wishlist&&i.jsx("span",{className:"text-orange-500",children:"Wishlist Copy"})]}),i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2",children:"Location"}),i.jsx("th",{className:"px-3 py-2 text-center",children:"Foil"}),i.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),i.jsx("th",{className:"px-3 py-2 text-right",children:"Added"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-700/30 text-gray-300",children:i.jsxs("tr",{children:[i.jsx("td",{className:"px-3 py-2",children:h?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("select",{value:m.deckId,onChange:ae=>g({...m,deckId:ae.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full",children:[i.jsx("option",{value:"",children:"Binder"}),y.map(ae=>i.jsxs("option",{value:ae.id,children:["Deck: ",ae.name]},ae.id))]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-500 text-[9px]",children:"PAID $"}),i.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:m.price_bought,onChange:ae=>g({...m,price_bought:ae.target.value}),className:"bg-gray-800 border-none rounded px-2 py-0.5 text-[10px] text-white w-20 focus:ring-1 focus:ring-indigo-500"})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"flex flex-wrap gap-1",children:m.tags&&m.tags.map(ae=>i.jsxs("span",{className:"bg-indigo-600/50 text-white px-1.5 rounded text-[9px] flex items-center gap-1 border border-indigo-500/30",children:[ae,i.jsx("button",{onClick:()=>se(ae),className:"hover:text-red-300",children:""})]},ae))}),i.jsx("input",{type:"text",placeholder:"+ Tag...",value:m.currentTag,onChange:ae=>g({...m,currentTag:ae.target.value}),onKeyDown:Z,className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full focus:ring-1 focus:ring-indigo-500"})]})]}):i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{children:e.deckId?`Deck #${e.deckId}`:"Binder"}),e.tags&&(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).length>0&&i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).map(ae=>i.jsx("span",{className:"text-[9px] bg-gray-700 px-1 rounded text-gray-300",children:ae},ae))})]})}),i.jsx("td",{className:"px-3 py-2 text-center align-top",children:h?i.jsx("input",{type:"checkbox",checked:m.finish==="foil",onChange:ae=>g({...m,finish:ae.target.checked?"foil":"nonfoil"}),className:"rounded bg-gray-700 border-gray-600 text-indigo-600",title:"Is Foil?"}):e.finish==="foil"?"Yes":"-"}),i.jsx("td",{className:"px-3 py-2 text-right font-black align-top",children:h?i.jsx("input",{type:"number",min:"1",value:m.quantity,onChange:ae=>g({...m,quantity:ae.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-[10px] text-white w-12 text-center"}):e.count||e.quantity||1}),i.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 font-mono text-[10px] align-top",children:[i.jsx("div",{children:e.added_at?new Date(e.added_at).toLocaleDateString():"N/A"}),e.price_bought&&i.jsxs("div",{className:"text-green-500/70 mt-1",title:"Price Paid",children:["$",parseFloat(e.price_bought).toFixed(2)]})]})]})})]})]}),e.is_wishlist&&!h&&i.jsxs("button",{onClick:async()=>{try{await a(e.id||e.firestoreId,{is_wishlist:!1}),l("Card moved to collection!","success")}catch{l("Failed to move card","error")}},className:"w-full py-2.5 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-lg shadow-lg shadow-orange-900/30 transition-all flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})}),"I Got This Copy!"]})]})})()]}),i.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[i.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Art & Aesthetics"]}),i.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Artist"}),i.jsx("span",{className:"text-white font-medium",children:w.artist||"Unknown"})]}),i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Frame"}),i.jsx("span",{className:"text-white",children:w.frame||"2015"})]}),i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Border Color"}),i.jsx("span",{className:"text-white capitalize",children:w.border_color||"Black"})]}),i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Finishes"}),i.jsx("span",{className:"text-white capitalize",children:w.finishes?.join(", ")})]}),w.watermark&&i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Watermark"}),i.jsx("span",{className:"text-white capitalize",children:w.watermark})]}),i.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[i.jsx("span",{className:"text-gray-500",children:"Illustration ID"}),i.jsxs("span",{className:"text-gray-400 font-mono text-xs",children:[w.illustration_id?.slice(0,8),"..."]})]})]})]}),i.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[i.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Developer / Metadata"]}),i.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 space-y-2 text-sm font-mono",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"External Links"}),i.jsx("a",{href:w.scryfall_uri,target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"View on Scryfall"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Scryfall ID"}),i.jsx("span",{className:"text-gray-400",children:w.id})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Oracle ID"}),i.jsx("span",{className:"text-gray-400",children:w.oracle_id})]}),e.firestoreId&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Database ID"}),i.jsx("span",{className:"text-gray-400",children:e.firestoreId})]}),i.jsxs("div",{className:"border-t border-gray-800 pt-2 mt-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Released At"}),i.jsx("span",{className:"text-gray-300",children:w.released_at})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Reserved List"}),i.jsx("span",{className:w.reserved?"text-red-400":"text-gray-400",children:w.reserved?"true":"false"})]})]})]})]}),h&&i.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-700 flex gap-4 animate-fade-in-up",children:[i.jsx("button",{onClick:()=>f(!1),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg border border-gray-500 transition-all font-bold tracking-wide uppercase text-sm",children:"Cancel"}),i.jsx("button",{onClick:G,className:"flex-1 bg-red-600/80 hover:bg-red-600 text-white py-3 rounded-lg shadow-md transition-all font-bold tracking-wide uppercase text-sm",children:"Delete Card"}),i.jsx("button",{onClick:J,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg shadow-lg shadow-green-900/20 transition-all font-bold tracking-wide uppercase text-sm",children:"Save Changes"})]})]})]})]})]})},Yut=({children:t})=>{const{currentUser:e,userProfile:r,loading:n}=Cr(),s=Ca(),a=yn(),[o,l]=b.useState(!1);return b.useEffect(()=>{if(!e&&!n){l(!1);return}if(!(n||o)&&e&&r){const u=["/","/login","/about"].includes(s.pathname)||s.pathname.startsWith("/share/"),h=s.pathname==="/onboarding";!r.settings?.onboarding_complete&&!h&&!u&&a("/onboarding"),l(!0)}},[e,r,n,s,a,o]),n?i.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-indigo-500",children:"Loading..."}):t},Xut=()=>{const{addToast:t}=Tn();return b.useEffect(()=>(W$(t),()=>W$(null)),[t]),null},Qut=()=>{const t=Ca();return b.useEffect(()=>{const r=new URLSearchParams(t.search).get("ref");r&&(console.log("[ReferralTracker] Capturing referral code:",r),localStorage.setItem("mtg_forge_ref",r))},[t]),null},Jut=()=>{const{addToast:t}=Tn();return b.useEffect(()=>{const e=()=>t("You are back online!","success"),r=()=>t("You are offline. Accessing cached data.","warning");return window.addEventListener("online",e),window.addEventListener("offline",r),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}},[t]),null},Zut=()=>{const{userProfile:t,refreshUserProfile:e}=Cr(),{cards:r}=yo();return b.useEffect(()=>{const n=Ha.onSync(()=>{console.log("[AchievementMonitor] Achievement sync detected, refreshing profile..."),e()});return()=>n()},[e]),b.useEffect(()=>{if(!t)return;Ha.loadUserAchievements(t);const n={};if(t.createdAt){const s=new Date(t.createdAt),o=Math.abs(new Date-s),l=Math.ceil(o/(1e3*60*60*24));n.account_age_days=l}if(r&&r.length>0){const s=r.filter(a=>!a.is_wishlist&&!a.deck_id);n.total_cards=s.length,n.total_value=s.reduce((a,o)=>{const l=(o.finish==="foil"?o.prices?.usd_foil:o.prices?.usd)||0;return a+Number(l)},0),n.foil_count=s.filter(a=>a.finish==="foil").length,n.count_white=s.filter(a=>a.colors?.includes("W")).length,n.count_blue=s.filter(a=>a.colors?.includes("U")).length,n.count_black=s.filter(a=>a.colors?.includes("B")).length,n.count_red=s.filter(a=>a.colors?.includes("R")).length,n.count_green=s.filter(a=>a.colors?.includes("G")).length,n.count_creature=s.filter(a=>a.type_line?.toLowerCase().includes("creature")).length,n.count_artifact=s.filter(a=>a.type_line?.toLowerCase().includes("artifact")).length,n.count_land_special=s.filter(a=>a.type_line?.toLowerCase().includes("land")&&!a.type_line?.includes("Basic")).length,n.count_spell=s.filter(a=>a.type_line?.toLowerCase().includes("instant")||a.type_line?.toLowerCase().includes("sorcery")).length,n.count_mythic=s.filter(a=>a.rarity==="mythic").length}Object.keys(n).length>0&&Ha.check(n)},[r,t]),null};function edt(){return sne([{key:"Escape",action:()=>{window.dispatchEvent(new CustomEvent("close-modals"))}}]),i.jsxs(But,{client:Hut,persistOptions:{persister:Wut,maxAge:1e3*60*60*24*7},onSuccess:()=>console.log("Query cache restored successfully"),loadingComponent:i.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center text-indigo-500 font-bold tracking-widest animate-pulse",children:"LOADING MAGIC..."}),children:[i.jsxs(C5e,{children:[i.jsx(Jut,{}),i.jsx(Rct,{}),i.jsxs(_5e,{children:[i.jsx(Zut,{}),i.jsx(A5e,{children:i.jsxs("div",{className:"bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col",children:[i.jsx(Mme,{}),i.jsx(Qut,{}),i.jsx(E3e,{}),i.jsx(Yut,{children:i.jsx("div",{className:"flex-grow pb-24 md:pb-0",children:i.jsxs(bL,{children:[i.jsx(Vr,{path:"/",element:i.jsx($3e,{})}),i.jsx(Vr,{path:"/about",element:i.jsx(Elt,{})}),i.jsx(Vr,{path:"/dashboard",element:i.jsx(QMe,{})}),i.jsx(Vr,{path:"/login",element:i.jsx(eRe,{})}),i.jsx(Vr,{path:"/onboarding",element:i.jsx(Clt,{})}),i.jsx(Vr,{path:"/collection",element:i.jsx(M7e,{})}),i.jsx(Vr,{path:"/pricing",element:i.jsx(ZMe,{})}),i.jsx(Vr,{path:"/decks",element:i.jsx(z7e,{})}),i.jsx(Vr,{path:"/binders",element:i.jsx(V7e,{})}),i.jsx(Vr,{path:"/precons",element:i.jsx($A,{})}),i.jsx(Vr,{path:"/precons/type/:type",element:i.jsx($A,{})}),i.jsx(Vr,{path:"/precons/set/:set",element:i.jsx($A,{})}),i.jsx(Vr,{path:"/precons/deck/:id",element:i.jsx(Bnt,{})}),i.jsx(Vr,{path:"/decks/new",element:i.jsx(W7e,{})}),i.jsx(Vr,{path:"/decks/:deckId",element:i.jsx(qBe,{})}),i.jsx(Vr,{path:"/share/:slug",element:i.jsx(Alt,{})}),i.jsx(Vr,{path:"/decks/:deckId/build",element:i.jsx(Fnt,{})}),i.jsx(Vr,{path:"/sets",element:i.jsx(HBe,{})}),i.jsx(Vr,{path:"/sets/:setCode",element:i.jsx(WBe,{})}),i.jsx(Vr,{path:"/wishlist",element:i.jsx(oFe,{})}),i.jsx(Vr,{path:"/settings/*",element:i.jsx(aFe,{})}),i.jsx(Vr,{path:"/vault",element:i.jsx(Olt,{})}),i.jsx(Vr,{path:"/audit",element:i.jsx(DQ,{})}),i.jsx(Vr,{path:"/audit/complete",element:i.jsx(Mct,{})}),i.jsx(Vr,{path:"/audit/:id",element:i.jsx(DQ,{})}),i.jsx(Vr,{path:"/audit/:auditId/wizard",element:i.jsx($lt,{})}),i.jsx(Vr,{path:"/remote/:sessionId",element:i.jsx(Ilt,{})}),i.jsx(Vr,{path:"/strategy",element:i.jsx(Plt,{})}),i.jsx(Vr,{path:"/play",element:i.jsx(e4,{to:"/play/lobby",replace:!0})}),i.jsx(Vr,{path:"/play/lobby",element:i.jsx(Dct,{})}),i.jsx(Vr,{path:"/play/room/:id",element:i.jsx(zct,{})}),i.jsx(Vr,{path:"/social",element:i.jsx(Gct,{})}),i.jsx(Vr,{path:"/profile/:id",element:i.jsx(Zct,{})}),i.jsx(Vr,{path:"/armory",element:i.jsx(Kct,{})}),i.jsx(Vr,{path:"/tournaments",element:i.jsx(HQ,{})}),i.jsx(Vr,{path:"/tournaments/:id",element:i.jsx(HQ,{})}),i.jsx(Vr,{path:"/tournaments/:id/join",element:i.jsx(out,{})}),i.jsx(Vr,{path:"/solitaire/:deckId",element:i.jsx(Sut,{})}),i.jsx(Vr,{path:"/admin/*",element:i.jsx(Lut,{})})]})})}),i.jsx(Xut,{}),i.jsx(Out,{}),i.jsx(Kut,{})]})})]})]}),i.jsx(Gut,{initialIsOpen:!1})]})}function tdt(t={}){const{immediate:e=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:a,onRegisterError:o}=t;let l,c;const u=async(f=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(l=await Rj(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/sw.js",{scope:"/",type:"classic"})).catch(f=>{o?.(f)}),!l)return;l.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),l.addEventListener("installed",f=>{f.isUpdate||n?.()}),l.register({immediate:e}).then(f=>{a?a("/sw.js",f):s?.(f)}).catch(f=>{o?.(f)})}}return c=h(),u}const rdt=tdt({immediate:!0,onNeedRefresh(){confirm("New content available. Reload?")&&rdt(!0)},onOfflineReady(){}});ipe.createRoot(document.getElementById("root")).render(i.jsx(Ie.StrictMode,{children:i.jsx(Sme,{children:i.jsx(edt,{})})}));export{Ns as _,q0 as c,Pl as g};
