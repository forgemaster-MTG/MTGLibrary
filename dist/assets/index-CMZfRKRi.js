function FJ(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Co(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ij={exports:{}},Mg={};var YT;function UJ(){if(YT)return Mg;YT=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var l in i)l!=="key"&&(a[l]=i[l])}else a=i;return i=a.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:a}}return Mg.Fragment=e,Mg.jsx=r,Mg.jsxs=r,Mg}var KT;function zJ(){return KT||(KT=1,ij.exports=UJ()),ij.exports}var s=zJ(),aj={exports:{}},zr={};var XT;function qJ(){if(XT)return zr;XT=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function m(W){return W===null||typeof W!="object"?null:(W=x&&W[x]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,j={};function N(W,U,Y){this.props=W,this.context=U,this.refs=j,this.updater=Y||y}N.prototype.isReactComponent={},N.prototype.setState=function(W,U){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,U,"setState")},N.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=N.prototype;function A(W,U,Y){this.props=W,this.context=U,this.refs=j,this.updater=Y||y}var L=A.prototype=new C;L.constructor=A,v(L,N.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function F(){}var T={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function B(W,U,Y){var te=Y.ref;return{$$typeof:t,type:W,key:U,ref:te!==void 0?te:null,props:Y}}function $(W,U){return B(W.type,U,W.props)}function k(W){return typeof W=="object"&&W!==null&&W.$$typeof===t}function R(W){var U={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Y){return U[Y]})}var P=/\/+/g;function q(W,U){return typeof W=="object"&&W!==null&&W.key!=null?R(""+W.key):U.toString(36)}function X(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(F,F):(W.status="pending",W.then(function(U){W.status==="pending"&&(W.status="fulfilled",W.value=U)},function(U){W.status==="pending"&&(W.status="rejected",W.reason=U)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function G(W,U,Y,te,ce){var xe=typeof W;(xe==="undefined"||xe==="boolean")&&(W=null);var ue=!1;if(W===null)ue=!0;else switch(xe){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(W.$$typeof){case t:case e:ue=!0;break;case f:return ue=W._init,G(ue(W._payload),U,Y,te,ce)}}if(ue)return ce=ce(W),ue=te===""?"."+q(W,0):te,O(ce)?(Y="",ue!=null&&(Y=ue.replace(P,"$&/")+"/"),G(ce,U,Y,"",function(pe){return pe})):ce!=null&&(k(ce)&&(ce=$(ce,Y+(ce.key==null||W&&W.key===ce.key?"":(""+ce.key).replace(P,"$&/")+"/")+ue)),U.push(ce)),1;ue=0;var ve=te===""?".":te+":";if(O(W))for(var Q=0;Q<W.length;Q++)te=W[Q],xe=ve+q(te,Q),ue+=G(te,U,Y,xe,ce);else if(Q=m(W),typeof Q=="function")for(W=Q.call(W),Q=0;!(te=W.next()).done;)te=te.value,xe=ve+q(te,Q++),ue+=G(te,U,Y,xe,ce);else if(xe==="object"){if(typeof W.then=="function")return G(X(W),U,Y,te,ce);throw U=String(W),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ue}function ne(W,U,Y){if(W==null)return W;var te=[],ce=0;return G(W,te,"","",function(xe){return U.call(Y,xe,ce++)}),te}function ee(W){if(W._status===-1){var U=W._result;U=U(),U.then(function(Y){(W._status===0||W._status===-1)&&(W._status=1,W._result=Y)},function(Y){(W._status===0||W._status===-1)&&(W._status=2,W._result=Y)}),W._status===-1&&(W._status=0,W._result=U)}if(W._status===1)return W._result.default;throw W._result}var se=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},J={map:ne,forEach:function(W,U,Y){ne(W,function(){U.apply(this,arguments)},Y)},count:function(W){var U=0;return ne(W,function(){U++}),U},toArray:function(W){return ne(W,function(U){return U})||[]},only:function(W){if(!k(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return zr.Activity=p,zr.Children=J,zr.Component=N,zr.Fragment=r,zr.Profiler=i,zr.PureComponent=A,zr.StrictMode=n,zr.Suspense=c,zr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,zr.__COMPILER_RUNTIME={__proto__:null,c:function(W){return T.H.useMemoCache(W)}},zr.cache=function(W){return function(){return W.apply(null,arguments)}},zr.cacheSignal=function(){return null},zr.cloneElement=function(W,U,Y){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var te=v({},W.props),ce=W.key;if(U!=null)for(xe in U.key!==void 0&&(ce=""+U.key),U)!I.call(U,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&U.ref===void 0||(te[xe]=U[xe]);var xe=arguments.length-2;if(xe===1)te.children=Y;else if(1<xe){for(var ue=Array(xe),ve=0;ve<xe;ve++)ue[ve]=arguments[ve+2];te.children=ue}return B(W.type,ce,te)},zr.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:a,_context:W},W},zr.createElement=function(W,U,Y){var te,ce={},xe=null;if(U!=null)for(te in U.key!==void 0&&(xe=""+U.key),U)I.call(U,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(ce[te]=U[te]);var ue=arguments.length-2;if(ue===1)ce.children=Y;else if(1<ue){for(var ve=Array(ue),Q=0;Q<ue;Q++)ve[Q]=arguments[Q+2];ce.children=ve}if(W&&W.defaultProps)for(te in ue=W.defaultProps,ue)ce[te]===void 0&&(ce[te]=ue[te]);return B(W,xe,ce)},zr.createRef=function(){return{current:null}},zr.forwardRef=function(W){return{$$typeof:l,render:W}},zr.isValidElement=k,zr.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ee}},zr.memo=function(W,U){return{$$typeof:u,type:W,compare:U===void 0?null:U}},zr.startTransition=function(W){var U=T.T,Y={};T.T=Y;try{var te=W(),ce=T.S;ce!==null&&ce(Y,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(F,se)}catch(xe){se(xe)}finally{U!==null&&Y.types!==null&&(U.types=Y.types),T.T=U}},zr.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},zr.use=function(W){return T.H.use(W)},zr.useActionState=function(W,U,Y){return T.H.useActionState(W,U,Y)},zr.useCallback=function(W,U){return T.H.useCallback(W,U)},zr.useContext=function(W){return T.H.useContext(W)},zr.useDebugValue=function(){},zr.useDeferredValue=function(W,U){return T.H.useDeferredValue(W,U)},zr.useEffect=function(W,U){return T.H.useEffect(W,U)},zr.useEffectEvent=function(W){return T.H.useEffectEvent(W)},zr.useId=function(){return T.H.useId()},zr.useImperativeHandle=function(W,U,Y){return T.H.useImperativeHandle(W,U,Y)},zr.useInsertionEffect=function(W,U){return T.H.useInsertionEffect(W,U)},zr.useLayoutEffect=function(W,U){return T.H.useLayoutEffect(W,U)},zr.useMemo=function(W,U){return T.H.useMemo(W,U)},zr.useOptimistic=function(W,U){return T.H.useOptimistic(W,U)},zr.useReducer=function(W,U,Y){return T.H.useReducer(W,U,Y)},zr.useRef=function(W){return T.H.useRef(W)},zr.useState=function(W){return T.H.useState(W)},zr.useSyncExternalStore=function(W,U,Y){return T.H.useSyncExternalStore(W,U,Y)},zr.useTransition=function(){return T.H.useTransition()},zr.version="19.2.3",zr}var JT;function Fu(){return JT||(JT=1,aj.exports=qJ()),aj.exports}var b=Fu();const Ke=Co(b),R3=FJ({__proto__:null,default:Ke},[b]);var oj={exports:{}},Pg={},lj={exports:{}},cj={};var ZT;function HJ(){return ZT||(ZT=1,(function(t){function e(G,ne){var ee=G.length;G.push(ne);e:for(;0<ee;){var se=ee-1>>>1,J=G[se];if(0<i(J,ne))G[se]=ne,G[ee]=J,ee=se;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var ne=G[0],ee=G.pop();if(ee!==ne){G[0]=ee;e:for(var se=0,J=G.length,W=J>>>1;se<W;){var U=2*(se+1)-1,Y=G[U],te=U+1,ce=G[te];if(0>i(Y,ee))te<J&&0>i(ce,Y)?(G[se]=ce,G[te]=ee,se=te):(G[se]=Y,G[U]=ee,se=U);else if(te<J&&0>i(ce,ee))G[se]=ce,G[te]=ee,se=te;else break e}}return ne}function i(G,ne){var ee=G.sortIndex-ne.sortIndex;return ee!==0?ee:G.id-ne.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,p=null,x=3,m=!1,y=!1,v=!1,j=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function L(G){for(var ne=r(u);ne!==null;){if(ne.callback===null)n(u);else if(ne.startTime<=G)n(u),ne.sortIndex=ne.expirationTime,e(c,ne);else break;ne=r(u)}}function O(G){if(v=!1,L(G),!y)if(r(c)!==null)y=!0,F||(F=!0,R());else{var ne=r(u);ne!==null&&X(O,ne.startTime-G)}}var F=!1,T=-1,I=5,B=-1;function $(){return j?!0:!(t.unstable_now()-B<I)}function k(){if(j=!1,F){var G=t.unstable_now();B=G;var ne=!0;try{e:{y=!1,v&&(v=!1,C(T),T=-1),m=!0;var ee=x;try{t:{for(L(G),p=r(c);p!==null&&!(p.expirationTime>G&&$());){var se=p.callback;if(typeof se=="function"){p.callback=null,x=p.priorityLevel;var J=se(p.expirationTime<=G);if(G=t.unstable_now(),typeof J=="function"){p.callback=J,L(G),ne=!0;break t}p===r(c)&&n(c),L(G)}else n(c);p=r(c)}if(p!==null)ne=!0;else{var W=r(u);W!==null&&X(O,W.startTime-G),ne=!1}}break e}finally{p=null,x=ee,m=!1}ne=void 0}}finally{ne?R():F=!1}}}var R;if(typeof A=="function")R=function(){A(k)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,q=P.port2;P.port1.onmessage=k,R=function(){q.postMessage(null)}}else R=function(){N(k,0)};function X(G,ne){T=N(function(){G(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var ee=x;x=ne;try{return G()}finally{x=ee}},t.unstable_requestPaint=function(){j=!0},t.unstable_runWithPriority=function(G,ne){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ee=x;x=G;try{return ne()}finally{x=ee}},t.unstable_scheduleCallback=function(G,ne,ee){var se=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?se+ee:se):ee=se,G){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ee+J,G={id:f++,callback:ne,priorityLevel:G,startTime:ee,expirationTime:J,sortIndex:-1},ee>se?(G.sortIndex=ee,e(u,G),r(c)===null&&G===r(u)&&(v?(C(T),T=-1):v=!0,X(O,ee-se))):(G.sortIndex=J,e(c,G),y||m||(y=!0,F||(F=!0,R()))),G},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(G){var ne=x;return function(){var ee=x;x=ne;try{return G.apply(this,arguments)}finally{x=ee}}}})(cj)),cj}var QT;function WJ(){return QT||(QT=1,lj.exports=HJ()),lj.exports}var dj={exports:{}},Qa={};var eL;function GJ(){if(eL)return Qa;eL=1;var t=Fu();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(c,u,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:c,containerInfo:u,implementation:f}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Qa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Qa.createPortal=function(c,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(c,u,null,f)},Qa.flushSync=function(c){var u=o.T,f=n.p;try{if(o.T=null,n.p=2,c)return c()}finally{o.T=u,n.p=f,n.d.f()}},Qa.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(c,u))},Qa.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},Qa.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin),x=typeof u.integrity=="string"?u.integrity:void 0,m=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?n.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:m}):f==="script"&&n.d.X(c,{crossOrigin:p,integrity:x,fetchPriority:m,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Qa.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=l(u.as,u.crossOrigin);n.d.M(c,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(c)},Qa.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin);n.d.L(c,f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Qa.preloadModule=function(c,u){if(typeof c=="string")if(u){var f=l(u.as,u.crossOrigin);n.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(c)},Qa.requestFormReset=function(c){n.d.r(c)},Qa.unstable_batchedUpdates=function(c,u){return c(u)},Qa.useFormState=function(c,u,f){return o.H.useFormState(c,u,f)},Qa.useFormStatus=function(){return o.H.useHostTransitionStatus()},Qa.version="19.2.3",Qa}var tL;function i$(){if(tL)return dj.exports;tL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),dj.exports=GJ(),dj.exports}var rL;function VJ(){if(rL)return Pg;rL=1;var t=WJ(),e=Fu(),r=i$();function n(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var h=d,g=d;if(d.alternate)for(;h.return;)h=h.return;else{d=h;do h=d,(h.flags&4098)!==0&&(g=h.return),d=h.return;while(d)}return h.tag===3?g:null}function o(d){if(d.tag===13){var h=d.memoizedState;if(h===null&&(d=d.alternate,d!==null&&(h=d.memoizedState)),h!==null)return h.dehydrated}return null}function l(d){if(d.tag===31){var h=d.memoizedState;if(h===null&&(d=d.alternate,d!==null&&(h=d.memoizedState)),h!==null)return h.dehydrated}return null}function c(d){if(a(d)!==d)throw Error(n(188))}function u(d){var h=d.alternate;if(!h){if(h=a(d),h===null)throw Error(n(188));return h!==d?null:d}for(var g=d,w=h;;){var E=g.return;if(E===null)break;var D=E.alternate;if(D===null){if(w=E.return,w!==null){g=w;continue}break}if(E.child===D.child){for(D=E.child;D;){if(D===g)return c(E),d;if(D===w)return c(E),h;D=D.sibling}throw Error(n(188))}if(g.return!==w.return)g=E,w=D;else{for(var re=!1,fe=E.child;fe;){if(fe===g){re=!0,g=E,w=D;break}if(fe===w){re=!0,w=E,g=D;break}fe=fe.sibling}if(!re){for(fe=D.child;fe;){if(fe===g){re=!0,g=D,w=E;break}if(fe===w){re=!0,w=D,g=E;break}fe=fe.sibling}if(!re)throw Error(n(189))}}if(g.alternate!==w)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?d:h}function f(d){var h=d.tag;if(h===5||h===26||h===27||h===6)return d;for(d=d.child;d!==null;){if(h=f(d),h!==null)return h;d=d.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),A=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function R(d){return d===null||typeof d!="object"?null:(d=k&&d[k]||d["@@iterator"],typeof d=="function"?d:null)}var P=Symbol.for("react.client.reference");function q(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===P?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case N:return"Profiler";case j:return"StrictMode";case O:return"Suspense";case F:return"SuspenseList";case B:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case y:return"Portal";case A:return d.displayName||"Context";case C:return(d._context.displayName||"Context")+".Consumer";case L:var h=d.render;return d=d.displayName,d||(d=h.displayName||h.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case T:return h=d.displayName||null,h!==null?h:q(d.type)||"Memo";case I:h=d._payload,d=d._init;try{return q(d(h))}catch{}}return null}var X=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},se=[],J=-1;function W(d){return{current:d}}function U(d){0>J||(d.current=se[J],se[J]=null,J--)}function Y(d,h){J++,se[J]=d.current,d.current=h}var te=W(null),ce=W(null),xe=W(null),ue=W(null);function ve(d,h){switch(Y(xe,h),Y(ce,d),Y(te,null),h.nodeType){case 9:case 11:d=(d=h.documentElement)&&(d=d.namespaceURI)?xT(d):0;break;default:if(d=h.tagName,h=h.namespaceURI)h=xT(h),d=bT(h,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}U(te),Y(te,d)}function Q(){U(te),U(ce),U(xe)}function pe(d){d.memoizedState!==null&&Y(ue,d);var h=te.current,g=bT(h,d.type);h!==g&&(Y(ce,d),Y(te,g))}function Ce(d){ce.current===d&&(U(te),U(ce)),ue.current===d&&(U(ue),Eg._currentValue=ee)}var je,we;function Te(d){if(je===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);je=h&&h[1]||"",we=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+d+we}var oe=!1;function De(d,h){if(!d||oe)return"";oe=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(h){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(ut){var it=ut}Reflect.construct(d,[],jt)}else{try{jt.call()}catch(ut){it=ut}d.call(jt.prototype)}}else{try{throw Error()}catch(ut){it=ut}(jt=d())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(ut){if(ut&&it&&typeof ut.stack=="string")return[ut.stack,it.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=w.DetermineComponentFrameRoot(),re=D[0],fe=D[1];if(re&&fe){var Oe=re.split(`
`),tt=fe.split(`
`);for(E=w=0;w<Oe.length&&!Oe[w].includes("DetermineComponentFrameRoot");)w++;for(;E<tt.length&&!tt[E].includes("DetermineComponentFrameRoot");)E++;if(w===Oe.length||E===tt.length)for(w=Oe.length-1,E=tt.length-1;1<=w&&0<=E&&Oe[w]!==tt[E];)E--;for(;1<=w&&0<=E;w--,E--)if(Oe[w]!==tt[E]){if(w!==1||E!==1)do if(w--,E--,0>E||Oe[w]!==tt[E]){var gt=`
`+Oe[w].replace(" at new "," at ");return d.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",d.displayName)),gt}while(1<=w&&0<=E);break}}}finally{oe=!1,Error.prepareStackTrace=g}return(g=d?d.displayName||d.name:"")?Te(g):""}function Nt(d,h){switch(d.tag){case 26:case 27:case 5:return Te(d.type);case 16:return Te("Lazy");case 13:return d.child!==h&&h!==null?Te("Suspense Fallback"):Te("Suspense");case 19:return Te("SuspenseList");case 0:case 15:return De(d.type,!1);case 11:return De(d.type.render,!1);case 1:return De(d.type,!0);case 31:return Te("Activity");default:return""}}function ot(d){try{var h="",g=null;do h+=Nt(d,g),g=d,d=d.return;while(d);return h}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Ne=Object.prototype.hasOwnProperty,Ge=t.unstable_scheduleCallback,Xe=t.unstable_cancelCallback,xt=t.unstable_shouldYield,Ae=t.unstable_requestPaint,Pe=t.unstable_now,ct=t.unstable_getCurrentPriorityLevel,bt=t.unstable_ImmediatePriority,dt=t.unstable_UserBlockingPriority,Ve=t.unstable_NormalPriority,lt=t.unstable_LowPriority,kt=t.unstable_IdlePriority,Ue=t.log,Bt=t.unstable_setDisableYieldValue,zt=null,Ot=null;function Et(d){if(typeof Ue=="function"&&Bt(d),Ot&&typeof Ot.setStrictMode=="function")try{Ot.setStrictMode(zt,d)}catch{}}var $t=Math.clz32?Math.clz32:qt,At=Math.log,Xt=Math.LN2;function qt(d){return d>>>=0,d===0?32:31-(At(d)/Xt|0)|0}var Ht=256,jr=262144,Ct=4194304;function Tt(d){var h=d&42;if(h!==0)return h;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Yt(d,h,g){var w=d.pendingLanes;if(w===0)return 0;var E=0,D=d.suspendedLanes,re=d.pingedLanes;d=d.warmLanes;var fe=w&134217727;return fe!==0?(w=fe&~D,w!==0?E=Tt(w):(re&=fe,re!==0?E=Tt(re):g||(g=fe&~d,g!==0&&(E=Tt(g))))):(fe=w&~D,fe!==0?E=Tt(fe):re!==0?E=Tt(re):g||(g=w&~d,g!==0&&(E=Tt(g)))),E===0?0:h!==0&&h!==E&&(h&D)===0&&(D=E&-E,g=h&-h,D>=g||D===32&&(g&4194048)!==0)?h:E}function Be(d,h){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&h)===0}function Lt(d,h){switch(d){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ft(){var d=Ct;return Ct<<=1,(Ct&62914560)===0&&(Ct=4194304),d}function Ee(d){for(var h=[],g=0;31>g;g++)h.push(d);return h}function He(d,h){d.pendingLanes|=h,h!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function Mt(d,h,g,w,E,D){var re=d.pendingLanes;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=g,d.entangledLanes&=g,d.errorRecoveryDisabledLanes&=g,d.shellSuspendCounter=0;var fe=d.entanglements,Oe=d.expirationTimes,tt=d.hiddenUpdates;for(g=re&~g;0<g;){var gt=31-$t(g),jt=1<<gt;fe[gt]=0,Oe[gt]=-1;var it=tt[gt];if(it!==null)for(tt[gt]=null,gt=0;gt<it.length;gt++){var ut=it[gt];ut!==null&&(ut.lane&=-536870913)}g&=~jt}w!==0&&Gt(d,w,0),D!==0&&E===0&&d.tag!==0&&(d.suspendedLanes|=D&~(re&~h))}function Gt(d,h,g){d.pendingLanes|=h,d.suspendedLanes&=~h;var w=31-$t(h);d.entangledLanes|=h,d.entanglements[w]=d.entanglements[w]|1073741824|g&261930}function Zt(d,h){var g=d.entangledLanes|=h;for(d=d.entanglements;g;){var w=31-$t(g),E=1<<w;E&h|d[w]&h&&(d[w]|=h),g&=~E}}function Ut(d,h){var g=h&-h;return g=(g&42)!==0?1:It(g),(g&(d.suspendedLanes|h))!==0?0:g}function It(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Vt(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function pr(){var d=ne.p;return d!==0?d:(d=window.event,d===void 0?32:UT(d.type))}function en(d,h){var g=ne.p;try{return ne.p=d,h()}finally{ne.p=g}}var Yr=Math.random().toString(36).slice(2),$r="__reactFiber$"+Yr,Qr="__reactProps$"+Yr,pn="__reactContainer$"+Yr,Hr="__reactEvents$"+Yr,ss="__reactListeners$"+Yr,Ei="__reactHandles$"+Yr,wi="__reactResources$"+Yr,$s="__reactMarker$"+Yr;function zi(d){delete d[$r],delete d[Qr],delete d[Hr],delete d[ss],delete d[Ei]}function jn(d){var h=d[$r];if(h)return h;for(var g=d.parentNode;g;){if(h=g[pn]||g[$r]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(d=ST(d);d!==null;){if(g=d[$r])return g;d=ST(d)}return h}d=g,g=d.parentNode}return null}function ze(d){if(d=d[$r]||d[pn]){var h=d.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return d}return null}function rt(d){var h=d.tag;if(h===5||h===26||h===27||h===6)return d.stateNode;throw Error(n(33))}function ht(d){var h=d[wi];return h||(h=d[wi]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Rt(d){d[$s]=!0}var yr=new Set,Fr={};function Mn(d,h){ps(d,h),ps(d+"Capture",h)}function ps(d,h){for(Fr[d]=h,d=0;d<h.length;d++)yr.add(h[d])}var _r=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qi={},Ya={};function al(d){return Ne.call(Ya,d)?!0:Ne.call(qi,d)?!1:_r.test(d)?Ya[d]=!0:(qi[d]=!0,!1)}function ji(d,h,g){if(al(h))if(g===null)d.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":d.removeAttribute(h);return;case"boolean":var w=h.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){d.removeAttribute(h);return}}d.setAttribute(h,""+g)}}function Fs(d,h,g){if(g===null)d.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(h);return}d.setAttribute(h,""+g)}}function is(d,h,g,w){if(w===null)d.removeAttribute(g);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(g);return}d.setAttributeNS(h,g,""+w)}}function Rr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Hi(d){var h=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Us(d,h,g){var w=Object.getOwnPropertyDescriptor(d.constructor.prototype,h);if(!d.hasOwnProperty(h)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var E=w.get,D=w.set;return Object.defineProperty(d,h,{configurable:!0,get:function(){return E.call(this)},set:function(re){g=""+re,D.call(this,re)}}),Object.defineProperty(d,h,{enumerable:w.enumerable}),{getValue:function(){return g},setValue:function(re){g=""+re},stopTracking:function(){d._valueTracker=null,delete d[h]}}}}function Kr(d){if(!d._valueTracker){var h=Hi(d)?"checked":"value";d._valueTracker=Us(d,h,""+d[h])}}function _a(d){if(!d)return!1;var h=d._valueTracker;if(!h)return!0;var g=h.getValue(),w="";return d&&(w=Hi(d)?d.checked?"true":"false":d.value),d=w,d!==g?(h.setValue(d),!0):!1}function ms(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var Fn=/[\n"\\]/g;function as(d){return d.replace(Fn,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function lo(d,h,g,w,E,D,re,fe){d.name="",re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?d.type=re:d.removeAttribute("type"),h!=null?re==="number"?(h===0&&d.value===""||d.value!=h)&&(d.value=""+Rr(h)):d.value!==""+Rr(h)&&(d.value=""+Rr(h)):re!=="submit"&&re!=="reset"||d.removeAttribute("value"),h!=null?ol(d,re,Rr(h)):g!=null?ol(d,re,Rr(g)):w!=null&&d.removeAttribute("value"),E==null&&D!=null&&(d.defaultChecked=!!D),E!=null&&(d.checked=E&&typeof E!="function"&&typeof E!="symbol"),fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?d.name=""+Rr(fe):d.removeAttribute("name")}function Mo(d,h,g,w,E,D,re,fe){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(d.type=D),h!=null||g!=null){if(!(D!=="submit"&&D!=="reset"||h!=null)){Kr(d);return}g=g!=null?""+Rr(g):"",h=h!=null?""+Rr(h):g,fe||h===d.value||(d.value=h),d.defaultValue=h}w=w??E,w=typeof w!="function"&&typeof w!="symbol"&&!!w,d.checked=fe?d.checked:!!w,d.defaultChecked=!!w,re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"&&(d.name=re),Kr(d)}function ol(d,h,g){h==="number"&&ms(d.ownerDocument)===d||d.defaultValue===""+g||(d.defaultValue=""+g)}function Zs(d,h,g,w){if(d=d.options,h){h={};for(var E=0;E<g.length;E++)h["$"+g[E]]=!0;for(g=0;g<d.length;g++)E=h.hasOwnProperty("$"+d[g].value),d[g].selected!==E&&(d[g].selected=E),E&&w&&(d[g].defaultSelected=!0)}else{for(g=""+Rr(g),h=null,E=0;E<d.length;E++){if(d[E].value===g){d[E].selected=!0,w&&(d[E].defaultSelected=!0);return}h!==null||d[E].disabled||(h=d[E])}h!==null&&(h.selected=!0)}}function Ca(d,h,g){if(h!=null&&(h=""+Rr(h),h!==d.value&&(d.value=h),g==null)){d.defaultValue!==h&&(d.defaultValue=h);return}d.defaultValue=g!=null?""+Rr(g):""}function Es(d,h,g,w){if(h==null){if(w!=null){if(g!=null)throw Error(n(92));if(X(w)){if(1<w.length)throw Error(n(93));w=w[0]}g=w}g==null&&(g=""),h=g}g=Rr(h),d.defaultValue=g,w=d.textContent,w===g&&w!==""&&w!==null&&(d.value=w),Kr(d)}function Un(d,h){if(h){var g=d.firstChild;if(g&&g===d.lastChild&&g.nodeType===3){g.nodeValue=h;return}}d.textContent=h}var oi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ll(d,h,g){var w=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?w?d.setProperty(h,""):h==="float"?d.cssFloat="":d[h]="":w?d.setProperty(h,g):typeof g!="number"||g===0||oi.has(h)?h==="float"?d.cssFloat=g:d[h]=(""+g).trim():d[h]=g+"px"}function Ti(d,h,g){if(h!=null&&typeof h!="object")throw Error(n(62));if(d=d.style,g!=null){for(var w in g)!g.hasOwnProperty(w)||h!=null&&h.hasOwnProperty(w)||(w.indexOf("--")===0?d.setProperty(w,""):w==="float"?d.cssFloat="":d[w]="");for(var E in h)w=h[E],h.hasOwnProperty(E)&&g[E]!==w&&ll(d,E,w)}else for(var D in h)h.hasOwnProperty(D)&&ll(d,D,h[D])}function Po(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Io=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Aa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function li(d){return Aa.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function Li(){}var Kn=null;function Qs(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Ea=null,lr=null;function Ta(d){var h=ze(d);if(h&&(d=h.stateNode)){var g=d[Qr]||null;e:switch(d=h.stateNode,h.type){case"input":if(lo(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=d;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+as(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var w=g[h];if(w!==d&&w.form===d.form){var E=w[Qr]||null;if(!E)throw Error(n(90));lo(w,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(h=0;h<g.length;h++)w=g[h],w.form===d.form&&_a(w)}break e;case"textarea":Ca(d,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&Zs(d,!!g.multiple,h,!1)}}}var La=!1;function Ka(d,h,g){if(La)return d(h,g);La=!0;try{var w=d(h);return w}finally{if(La=!1,(Ea!==null||lr!==null)&&(Ry(),Ea&&(h=Ea,d=lr,lr=Ea=null,Ta(h),d)))for(h=0;h<d.length;h++)Ta(d[h])}}function Ns(d,h){var g=d.stateNode;if(g===null)return null;var w=g[Qr]||null;if(w===null)return null;g=w[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(d=d.type,w=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!w;break e;default:d=!1}if(d)return null;if(g&&typeof g!="function")throw Error(n(231,h,typeof g));return g}var os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xa=!1;if(os)try{var Gr={};Object.defineProperty(Gr,"passive",{get:function(){Xa=!0}}),window.addEventListener("test",Gr,Gr),window.removeEventListener("test",Gr,Gr)}catch{Xa=!1}var ci=null,Oa=null,Wi=null;function cl(){if(Wi)return Wi;var d,h=Oa,g=h.length,w,E="value"in ci?ci.value:ci.textContent,D=E.length;for(d=0;d<g&&h[d]===E[d];d++);var re=g-d;for(w=1;w<=re&&h[g-w]===E[D-w];w++);return Wi=E.slice(d,1<w?1-w:void 0)}function K(d){var h=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&h===13&&(d=13)):d=h,d===10&&(d=13),32<=d||d===13?d:0}function me(){return!0}function Le(){return!1}function at(d){function h(g,w,E,D,re){this._reactName=g,this._targetInst=E,this.type=w,this.nativeEvent=D,this.target=re,this.currentTarget=null;for(var fe in d)d.hasOwnProperty(fe)&&(g=d[fe],this[fe]=g?g(D):D[fe]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?me:Le,this.isPropagationStopped=Le,this}return p(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=me)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=me)},persist:function(){},isPersistent:me}),h}var gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kt=at(gr),Or=p({},gr,{view:0,detail:0}),Dr=at(Or),mn,Br,Tn,ks=p({},Or,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cr,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Tn&&(Tn&&d.type==="mousemove"?(mn=d.screenX-Tn.screenX,Br=d.screenY-Tn.screenY):Br=mn=0,Tn=d),mn)},movementY:function(d){return"movementY"in d?d.movementY:Br}}),Vn=at(ks),Nn=p({},ks,{dataTransfer:0}),Pn=at(Nn),oa=p({},Or,{relatedTarget:0}),Ts=at(oa),la=p({},gr,{animationName:0,elapsedTime:0,pseudoElement:0}),z=at(la),ae=p({},gr,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),ke=at(ae),Me=p({},gr,{data:0}),Fe=at(Me),mt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_t={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ir(d){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(d):(d=tr[d])?!!h[d]:!1}function cr(){return ir}var Mr=p({},Or,{key:function(d){if(d.key){var h=mt[d.key]||d.key;if(h!=="Unidentified")return h}return d.type==="keypress"?(d=K(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?_t[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cr,charCode:function(d){return d.type==="keypress"?K(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?K(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),tn=at(Mr),In=p({},ks,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_=at(In),V=p({},Or,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cr}),ie=at(V),be=p({},gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),qe=at(be),st=p({},ks,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Dt=at(st),Ar=p({},gr,{newState:0,oldState:0}),gs=at(Ar),un=[9,13,27,32],zn=os&&"CompositionEvent"in window,zs=null;os&&"documentMode"in document&&(zs=document.documentMode);var Ma=os&&"TextEvent"in window&&!zs,Oi=os&&(!zn||zs&&8<zs&&11>=zs),Xn=" ",co=!1;function Ro(d,h){switch(d){case"keyup":return un.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eh(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Al=!1;function Pa(d,h){switch(d){case"compositionend":return eh(h);case"keypress":return h.which!==32?null:(co=!0,Xn);case"textInput":return d=h.data,d===Xn&&co?null:d;default:return null}}function ic(d,h){if(Al)return d==="compositionend"||!zn&&Ro(d,h)?(d=cl(),Wi=Oa=ci=null,Al=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Oi&&h.locale!=="ko"?null:h.data;default:return null}}var th={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xf(d){var h=d&&d.nodeName&&d.nodeName.toLowerCase();return h==="input"?!!th[d.type]:h==="textarea"}function uo(d,h,g,w){Ea?lr?lr.push(w):lr=[w]:Ea=w,h=qy(h,"onChange"),0<h.length&&(g=new Kt("onChange","change",null,g,w),d.push({event:g,listeners:h}))}var dl=null,ac=null;function bf(d){uT(d,0)}function ul(d){var h=rt(d);if(_a(h))return d}function Yc(d,h){if(d==="change")return h}var Ja=!1;if(os){var Ia;if(os){var El="oninput"in document;if(!El){var Tl=document.createElement("div");Tl.setAttribute("oninput","return;"),El=typeof Tl.oninput=="function"}Ia=El}else Ia=!1;Ja=Ia&&(!document.documentMode||9<document.documentMode)}function oc(){dl&&(dl.detachEvent("onpropertychange",rh),ac=dl=null)}function rh(d){if(d.propertyName==="value"&&ul(ac)){var h=[];uo(h,ac,d,Qs(d)),Ka(bf,h)}}function nh(d,h,g){d==="focusin"?(oc(),dl=h,ac=g,dl.attachEvent("onpropertychange",rh)):d==="focusout"&&oc()}function ei(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ul(ac)}function G0(d,h){if(d==="click")return ul(h)}function Ll(d,h){if(d==="input"||d==="change")return ul(h)}function Ol(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var Gi=typeof Object.is=="function"?Object.is:Ol;function lc(d,h){if(Gi(d,h))return!0;if(typeof d!="object"||d===null||typeof h!="object"||h===null)return!1;var g=Object.keys(d),w=Object.keys(h);if(g.length!==w.length)return!1;for(w=0;w<g.length;w++){var E=g[w];if(!Ne.call(h,E)||!Gi(d[E],h[E]))return!1}return!0}function sh(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function ih(d,h){var g=sh(d);d=0;for(var w;g;){if(g.nodeType===3){if(w=d+g.textContent.length,d<=h&&w>=h)return{node:g,offset:h-d};d=w}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=sh(g)}}function cc(d,h){return d&&h?d===h?!0:d&&d.nodeType===3?!1:h&&h.nodeType===3?cc(d,h.parentNode):"contains"in d?d.contains(h):d.compareDocumentPosition?!!(d.compareDocumentPosition(h)&16):!1:!1}function dc(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var h=ms(d.document);h instanceof d.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)d=h.contentWindow;else break;h=ms(d.document)}return h}function Ml(d){var h=d&&d.nodeName&&d.nodeName.toLowerCase();return h&&(h==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||h==="textarea"||d.contentEditable==="true")}var Fd=os&&"documentMode"in document&&11>=document.documentMode,ho=null,uc=null,ca=null,Do=!1;function Ln(d,h,g){var w=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Do||ho==null||ho!==ms(w)||(w=ho,"selectionStart"in w&&Ml(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),ca&&lc(ca,w)||(ca=w,w=qy(uc,"onSelect"),0<w.length&&(h=new Kt("onSelect","select",null,h,g),d.push({event:h,listeners:w}),h.target=ho)))}function gn(d,h){var g={};return g[d.toLowerCase()]=h.toLowerCase(),g["Webkit"+d]="webkit"+h,g["Moz"+d]="moz"+h,g}var ls={animationend:gn("Animation","AnimationEnd"),animationiteration:gn("Animation","AnimationIteration"),animationstart:gn("Animation","AnimationStart"),transitionrun:gn("Transition","TransitionRun"),transitionstart:gn("Transition","TransitionStart"),transitioncancel:gn("Transition","TransitionCancel"),transitionend:gn("Transition","TransitionEnd")},ti={},Pl={};os&&(Pl=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function hl(d){if(ti[d])return ti[d];if(!ls[d])return d;var h=ls[d],g;for(g in h)if(h.hasOwnProperty(g)&&g in Pl)return ti[d]=h[g];return d}var Ud=hl("animationend"),yf=hl("animationiteration"),Zm=hl("animationstart"),hy=hl("transitionrun"),fy=hl("transitionstart"),py=hl("transitioncancel"),Qm=hl("transitionend"),eg=new Map,zd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zd.push("scrollEnd");function Bo(d,h){eg.set(d,h),Mn(h,[d])}var vf=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},fo=[],qd=0,V0=0;function wf(){for(var d=qd,h=V0=qd=0;h<d;){var g=fo[h];fo[h++]=null;var w=fo[h];fo[h++]=null;var E=fo[h];fo[h++]=null;var D=fo[h];if(fo[h++]=null,w!==null&&E!==null){var re=w.pending;re===null?E.next=E:(E.next=re.next,re.next=E),w.pending=E}D!==0&&Nf(g,E,D)}}function jf(d,h,g,w){fo[qd++]=d,fo[qd++]=h,fo[qd++]=g,fo[qd++]=w,V0|=w,d.lanes|=w,d=d.alternate,d!==null&&(d.lanes|=w)}function Y0(d,h,g,w){return jf(d,h,g,w),da(d)}function hc(d,h){return jf(d,null,null,h),da(d)}function Nf(d,h,g){d.lanes|=g;var w=d.alternate;w!==null&&(w.lanes|=g);for(var E=!1,D=d.return;D!==null;)D.childLanes|=g,w=D.alternate,w!==null&&(w.childLanes|=g),D.tag===22&&(d=D.stateNode,d===null||d._visibility&1||(E=!0)),d=D,D=D.return;return d.tag===3?(D=d.stateNode,E&&h!==null&&(E=31-$t(g),d=D.hiddenUpdates,w=d[E],w===null?d[E]=[h]:w.push(h),h.lane=g|536870912),D):null}function da(d){if(50<jg)throw jg=0,E4=null,Error(n(185));for(var h=d.return;h!==null;)d=h,h=d.return;return d.tag===3?d.stateNode:null}var Vi={};function K0(d,h,g,w){this.tag=d,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ua(d,h,g,w){return new K0(d,h,g,w)}function X0(d){return d=d.prototype,!(!d||!d.isReactComponent)}function $o(d,h){var g=d.alternate;return g===null?(g=ua(d.tag,h,d.key,d.mode),g.elementType=d.elementType,g.type=d.type,g.stateNode=d.stateNode,g.alternate=d,d.alternate=g):(g.pendingProps=h,g.type=d.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=d.flags&65011712,g.childLanes=d.childLanes,g.lanes=d.lanes,g.child=d.child,g.memoizedProps=d.memoizedProps,g.memoizedState=d.memoizedState,g.updateQueue=d.updateQueue,h=d.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=d.sibling,g.index=d.index,g.ref=d.ref,g.refCleanup=d.refCleanup,g}function kf(d,h){d.flags&=65011714;var g=d.alternate;return g===null?(d.childLanes=0,d.lanes=h,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=g.childLanes,d.lanes=g.lanes,d.child=g.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=g.memoizedProps,d.memoizedState=g.memoizedState,d.updateQueue=g.updateQueue,d.type=g.type,h=g.dependencies,d.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),d}function ah(d,h,g,w,E,D){var re=0;if(w=d,typeof d=="function")X0(d)&&(re=1);else if(typeof d=="string")re=AJ(d,g,te.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case B:return d=ua(31,g,h,E),d.elementType=B,d.lanes=D,d;case v:return Kc(g.children,E,D,h);case j:re=8,E|=24;break;case N:return d=ua(12,g,h,E|2),d.elementType=N,d.lanes=D,d;case O:return d=ua(13,g,h,E),d.elementType=O,d.lanes=D,d;case F:return d=ua(19,g,h,E),d.elementType=F,d.lanes=D,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case A:re=10;break e;case C:re=9;break e;case L:re=11;break e;case T:re=14;break e;case I:re=16,w=null;break e}re=29,g=Error(n(130,d===null?"null":typeof d,"")),w=null}return h=ua(re,g,h,E),h.elementType=d,h.type=w,h.lanes=D,h}function Kc(d,h,g,w){return d=ua(7,d,w,h),d.lanes=g,d}function Sf(d,h,g){return d=ua(6,d,null,h),d.lanes=g,d}function J0(d){var h=ua(18,null,null,0);return h.stateNode=d,h}function oh(d,h,g){return h=ua(4,d.children!==null?d.children:[],d.key,h),h.lanes=g,h.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},h}var Z0=new WeakMap;function Fo(d,h){if(typeof d=="object"&&d!==null){var g=Z0.get(d);return g!==void 0?g:(h={value:d,source:h,stack:ot(h)},Z0.set(d,h),h)}return{value:d,source:h,stack:ot(h)}}var lh=[],Hd=0,Q0=null,_f=0,Uo=[],zo=0,Xc=null,qo=1,Ho="";function po(d,h){lh[Hd++]=_f,lh[Hd++]=Q0,Q0=d,_f=h}function my(d,h,g){Uo[zo++]=qo,Uo[zo++]=Ho,Uo[zo++]=Xc,Xc=d;var w=qo;d=Ho;var E=32-$t(w)-1;w&=~(1<<E),g+=1;var D=32-$t(h)+E;if(30<D){var re=E-E%5;D=(w&(1<<re)-1).toString(32),w>>=re,E-=re,qo=1<<32-$t(h)+E|g<<E|w,Ho=D+d}else qo=1<<D|g<<E|w,Ho=d}function tg(d){d.return!==null&&(po(d,1),my(d,1,0))}function ep(d){for(;d===Q0;)Q0=lh[--Hd],lh[Hd]=null,_f=lh[--Hd],lh[Hd]=null;for(;d===Xc;)Xc=Uo[--zo],Uo[zo]=null,Ho=Uo[--zo],Uo[zo]=null,qo=Uo[--zo],Uo[zo]=null}function gy(d,h){Uo[zo++]=qo,Uo[zo++]=Ho,Uo[zo++]=Xc,qo=h.id,Ho=h.overflow,Xc=d}var Yi=null,xs=null,sn=!1,Ra=null,qs=!1,fl=Error(n(519));function Jc(d){var h=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ch(Fo(h,d)),fl}function rg(d){var h=d.stateNode,g=d.type,w=d.memoizedProps;switch(h[$r]=d,h[Qr]=w,g){case"dialog":on("cancel",h),on("close",h);break;case"iframe":case"object":case"embed":on("load",h);break;case"video":case"audio":for(g=0;g<kg.length;g++)on(kg[g],h);break;case"source":on("error",h);break;case"img":case"image":case"link":on("error",h),on("load",h);break;case"details":on("toggle",h);break;case"input":on("invalid",h),Mo(h,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":on("invalid",h);break;case"textarea":on("invalid",h),Es(h,w.value,w.defaultValue,w.children)}g=w.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||w.suppressHydrationWarning===!0||mT(h.textContent,g)?(w.popover!=null&&(on("beforetoggle",h),on("toggle",h)),w.onScroll!=null&&on("scroll",h),w.onScrollEnd!=null&&on("scrollend",h),w.onClick!=null&&(h.onclick=Li),h=!0):h=!1,h||Jc(d,!0)}function fc(d){for(Yi=d.return;Yi;)switch(Yi.tag){case 5:case 31:case 13:qs=!1;return;case 27:case 3:qs=!0;return;default:Yi=Yi.return}}function Ki(d){if(d!==Yi)return!1;if(!sn)return fc(d),sn=!0,!1;var h=d.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=d.type,g=!(g!=="form"&&g!=="button")||H4(d.type,d.memoizedProps)),g=!g),g&&xs&&Jc(d),fc(d),h===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));xs=kT(d)}else if(h===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));xs=kT(d)}else h===27?(h=xs,Nh(d.type)?(d=K4,K4=null,xs=d):xs=h):xs=Yi?Bl(d.stateNode.nextSibling):null;return!0}function Wd(){xs=Yi=null,sn=!1}function ng(){var d=Ra;return d!==null&&(Xo===null?Xo=d:Xo.push.apply(Xo,d),Ra=null),d}function ch(d){Ra===null?Ra=[d]:Ra.push(d)}var tp=W(null),Zc=null,Il=null;function Qc(d,h,g){Y(tp,h._currentValue),h._currentValue=g}function Wo(d){d._currentValue=tp.current,U(tp)}function dh(d,h,g){for(;d!==null;){var w=d.alternate;if((d.childLanes&h)!==h?(d.childLanes|=h,w!==null&&(w.childLanes|=h)):w!==null&&(w.childLanes&h)!==h&&(w.childLanes|=h),d===g)break;d=d.return}}function Gd(d,h,g,w){var E=d.child;for(E!==null&&(E.return=d);E!==null;){var D=E.dependencies;if(D!==null){var re=E.child;D=D.firstContext;e:for(;D!==null;){var fe=D;D=E;for(var Oe=0;Oe<h.length;Oe++)if(fe.context===h[Oe]){D.lanes|=g,fe=D.alternate,fe!==null&&(fe.lanes|=g),dh(D.return,g,d),w||(re=null);break e}D=fe.next}}else if(E.tag===18){if(re=E.return,re===null)throw Error(n(341));re.lanes|=g,D=re.alternate,D!==null&&(D.lanes|=g),dh(re,g,d),re=null}else re=E.child;if(re!==null)re.return=E;else for(re=E;re!==null;){if(re===d){re=null;break}if(E=re.sibling,E!==null){E.return=re.return,re=E;break}re=re.return}E=re}}function ed(d,h,g,w){d=null;for(var E=h,D=!1;E!==null;){if(!D){if((E.flags&524288)!==0)D=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var re=E.alternate;if(re===null)throw Error(n(387));if(re=re.memoizedProps,re!==null){var fe=E.type;Gi(E.pendingProps.value,re.value)||(d!==null?d.push(fe):d=[fe])}}else if(E===ue.current){if(re=E.alternate,re===null)throw Error(n(387));re.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(d!==null?d.push(Eg):d=[Eg])}E=E.return}d!==null&&Gd(h,d,g,w),h.flags|=262144}function rp(d){for(d=d.firstContext;d!==null;){if(!Gi(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function td(d){Zc=d,Il=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Xi(d){return xy(Zc,d)}function np(d,h){return Zc===null&&td(d),xy(d,h)}function xy(d,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},Il===null){if(d===null)throw Error(n(308));Il=h,d.dependencies={lanes:0,firstContext:h},d.flags|=524288}else Il=Il.next=h;return g}var Y5=typeof AbortController<"u"?AbortController:function(){var d=[],h=this.signal={aborted:!1,addEventListener:function(g,w){d.push(w)}};this.abort=function(){h.aborted=!0,d.forEach(function(g){return g()})}},K5=t.unstable_scheduleCallback,X5=t.unstable_NormalPriority,ri={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uh(){return{controller:new Y5,data:new Map,refCount:0}}function Cf(d){d.refCount--,d.refCount===0&&K5(X5,function(){d.controller.abort()})}var Af=null,sp=0,S=0,M=null;function H(d,h){if(Af===null){var g=Af=[];sp=0,S=I4(),M={status:"pending",value:void 0,then:function(w){g.push(w)}}}return sp++,h.then(Z,Z),h}function Z(){if(--sp===0&&Af!==null){M!==null&&(M.status="fulfilled");var d=Af;Af=null,S=0,M=null;for(var h=0;h<d.length;h++)(0,d[h])()}}function le(d,h){var g=[],w={status:"pending",value:null,reason:null,then:function(E){g.push(E)}};return d.then(function(){w.status="fulfilled",w.value=h;for(var E=0;E<g.length;E++)(0,g[E])(h)},function(E){for(w.status="rejected",w.reason=E,E=0;E<g.length;E++)(0,g[E])(void 0)}),w}var de=G.S;G.S=function(d,h){$8=Pe(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&H(d,h),de!==null&&de(d,h)};var he=W(null);function ge(){var d=he.current;return d!==null?d:ys.pooledCache}function ye(d,h){h===null?Y(he,he.current):Y(he,h.pool)}function _e(){var d=ge();return d===null?null:{parent:ri._currentValue,pool:d}}var Ie=Error(n(460)),Qe=Error(n(474)),Se=Error(n(542)),$e={then:function(){}};function Ye(d){return d=d.status,d==="fulfilled"||d==="rejected"}function pt(d,h,g){switch(g=d[g],g===void 0?d.push(h):g!==h&&(h.then(Li,Li),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw d=h.reason,Pt(d),d;default:if(typeof h.status=="string")h.then(Li,Li);else{if(d=ys,d!==null&&100<d.shellSuspendCounter)throw Error(n(482));d=h,d.status="pending",d.then(function(w){if(h.status==="pending"){var E=h;E.status="fulfilled",E.value=w}},function(w){if(h.status==="pending"){var E=h;E.status="rejected",E.reason=w}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw d=h.reason,Pt(d),d}throw ft=h,Ie}}function Je(d){try{var h=d._init;return h(d._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(ft=g,Ie):g}}var ft=null;function yt(){if(ft===null)throw Error(n(459));var d=ft;return ft=null,d}function Pt(d){if(d===Ie||d===Se)throw Error(n(483))}var St=null,ar=0;function Qt(d){var h=ar;return ar+=1,St===null&&(St=[]),pt(St,d,h)}function Pr(d,h){h=h.props.ref,d.ref=h!==void 0?h:null}function rr(d,h){throw h.$$typeof===x?Error(n(525)):(d=Object.prototype.toString.call(h),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":d)))}function rn(d){function h(We,Re){if(d){var et=We.deletions;et===null?(We.deletions=[Re],We.flags|=16):et.push(Re)}}function g(We,Re){if(!d)return null;for(;Re!==null;)h(We,Re),Re=Re.sibling;return null}function w(We){for(var Re=new Map;We!==null;)We.key!==null?Re.set(We.key,We):Re.set(We.index,We),We=We.sibling;return Re}function E(We,Re){return We=$o(We,Re),We.index=0,We.sibling=null,We}function D(We,Re,et){return We.index=et,d?(et=We.alternate,et!==null?(et=et.index,et<Re?(We.flags|=67108866,Re):et):(We.flags|=67108866,Re)):(We.flags|=1048576,Re)}function re(We){return d&&We.alternate===null&&(We.flags|=67108866),We}function fe(We,Re,et,vt){return Re===null||Re.tag!==6?(Re=Sf(et,We.mode,vt),Re.return=We,Re):(Re=E(Re,et),Re.return=We,Re)}function Oe(We,Re,et,vt){var kr=et.type;return kr===v?gt(We,Re,et.props.children,vt,et.key):Re!==null&&(Re.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===I&&Je(kr)===Re.type)?(Re=E(Re,et.props),Pr(Re,et),Re.return=We,Re):(Re=ah(et.type,et.key,et.props,null,We.mode,vt),Pr(Re,et),Re.return=We,Re)}function tt(We,Re,et,vt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==et.containerInfo||Re.stateNode.implementation!==et.implementation?(Re=oh(et,We.mode,vt),Re.return=We,Re):(Re=E(Re,et.children||[]),Re.return=We,Re)}function gt(We,Re,et,vt,kr){return Re===null||Re.tag!==7?(Re=Kc(et,We.mode,vt,kr),Re.return=We,Re):(Re=E(Re,et),Re.return=We,Re)}function jt(We,Re,et){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=Sf(""+Re,We.mode,et),Re.return=We,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case m:return et=ah(Re.type,Re.key,Re.props,null,We.mode,et),Pr(et,Re),et.return=We,et;case y:return Re=oh(Re,We.mode,et),Re.return=We,Re;case I:return Re=Je(Re),jt(We,Re,et)}if(X(Re)||R(Re))return Re=Kc(Re,We.mode,et,null),Re.return=We,Re;if(typeof Re.then=="function")return jt(We,Qt(Re),et);if(Re.$$typeof===A)return jt(We,np(We,Re),et);rr(We,Re)}return null}function it(We,Re,et,vt){var kr=Re!==null?Re.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return kr!==null?null:fe(We,Re,""+et,vt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case m:return et.key===kr?Oe(We,Re,et,vt):null;case y:return et.key===kr?tt(We,Re,et,vt):null;case I:return et=Je(et),it(We,Re,et,vt)}if(X(et)||R(et))return kr!==null?null:gt(We,Re,et,vt,null);if(typeof et.then=="function")return it(We,Re,Qt(et),vt);if(et.$$typeof===A)return it(We,Re,np(We,et),vt);rr(We,et)}return null}function ut(We,Re,et,vt,kr){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return We=We.get(et)||null,fe(Re,We,""+vt,kr);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case m:return We=We.get(vt.key===null?et:vt.key)||null,Oe(Re,We,vt,kr);case y:return We=We.get(vt.key===null?et:vt.key)||null,tt(Re,We,vt,kr);case I:return vt=Je(vt),ut(We,Re,et,vt,kr)}if(X(vt)||R(vt))return We=We.get(et)||null,gt(Re,We,vt,kr,null);if(typeof vt.then=="function")return ut(We,Re,et,Qt(vt),kr);if(vt.$$typeof===A)return ut(We,Re,et,np(Re,vt),kr);rr(Re,vt)}return null}function sr(We,Re,et,vt){for(var kr=null,Rn=null,ur=Re,Xr=Re=0,fn=null;ur!==null&&Xr<et.length;Xr++){ur.index>Xr?(fn=ur,ur=null):fn=ur.sibling;var Dn=it(We,ur,et[Xr],vt);if(Dn===null){ur===null&&(ur=fn);break}d&&ur&&Dn.alternate===null&&h(We,ur),Re=D(Dn,Re,Xr),Rn===null?kr=Dn:Rn.sibling=Dn,Rn=Dn,ur=fn}if(Xr===et.length)return g(We,ur),sn&&po(We,Xr),kr;if(ur===null){for(;Xr<et.length;Xr++)ur=jt(We,et[Xr],vt),ur!==null&&(Re=D(ur,Re,Xr),Rn===null?kr=ur:Rn.sibling=ur,Rn=ur);return sn&&po(We,Xr),kr}for(ur=w(ur);Xr<et.length;Xr++)fn=ut(ur,We,Xr,et[Xr],vt),fn!==null&&(d&&fn.alternate!==null&&ur.delete(fn.key===null?Xr:fn.key),Re=D(fn,Re,Xr),Rn===null?kr=fn:Rn.sibling=fn,Rn=fn);return d&&ur.forEach(function(Ah){return h(We,Ah)}),sn&&po(We,Xr),kr}function Tr(We,Re,et,vt){if(et==null)throw Error(n(151));for(var kr=null,Rn=null,ur=Re,Xr=Re=0,fn=null,Dn=et.next();ur!==null&&!Dn.done;Xr++,Dn=et.next()){ur.index>Xr?(fn=ur,ur=null):fn=ur.sibling;var Ah=it(We,ur,Dn.value,vt);if(Ah===null){ur===null&&(ur=fn);break}d&&ur&&Ah.alternate===null&&h(We,ur),Re=D(Ah,Re,Xr),Rn===null?kr=Ah:Rn.sibling=Ah,Rn=Ah,ur=fn}if(Dn.done)return g(We,ur),sn&&po(We,Xr),kr;if(ur===null){for(;!Dn.done;Xr++,Dn=et.next())Dn=jt(We,Dn.value,vt),Dn!==null&&(Re=D(Dn,Re,Xr),Rn===null?kr=Dn:Rn.sibling=Dn,Rn=Dn);return sn&&po(We,Xr),kr}for(ur=w(ur);!Dn.done;Xr++,Dn=et.next())Dn=ut(ur,We,Xr,Dn.value,vt),Dn!==null&&(d&&Dn.alternate!==null&&ur.delete(Dn.key===null?Xr:Dn.key),Re=D(Dn,Re,Xr),Rn===null?kr=Dn:Rn.sibling=Dn,Rn=Dn);return d&&ur.forEach(function($J){return h(We,$J)}),sn&&po(We,Xr),kr}function hs(We,Re,et,vt){if(typeof et=="object"&&et!==null&&et.type===v&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case m:e:{for(var kr=et.key;Re!==null;){if(Re.key===kr){if(kr=et.type,kr===v){if(Re.tag===7){g(We,Re.sibling),vt=E(Re,et.props.children),vt.return=We,We=vt;break e}}else if(Re.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===I&&Je(kr)===Re.type){g(We,Re.sibling),vt=E(Re,et.props),Pr(vt,et),vt.return=We,We=vt;break e}g(We,Re);break}else h(We,Re);Re=Re.sibling}et.type===v?(vt=Kc(et.props.children,We.mode,vt,et.key),vt.return=We,We=vt):(vt=ah(et.type,et.key,et.props,null,We.mode,vt),Pr(vt,et),vt.return=We,We=vt)}return re(We);case y:e:{for(kr=et.key;Re!==null;){if(Re.key===kr)if(Re.tag===4&&Re.stateNode.containerInfo===et.containerInfo&&Re.stateNode.implementation===et.implementation){g(We,Re.sibling),vt=E(Re,et.children||[]),vt.return=We,We=vt;break e}else{g(We,Re);break}else h(We,Re);Re=Re.sibling}vt=oh(et,We.mode,vt),vt.return=We,We=vt}return re(We);case I:return et=Je(et),hs(We,Re,et,vt)}if(X(et))return sr(We,Re,et,vt);if(R(et)){if(kr=R(et),typeof kr!="function")throw Error(n(150));return et=kr.call(et),Tr(We,Re,et,vt)}if(typeof et.then=="function")return hs(We,Re,Qt(et),vt);if(et.$$typeof===A)return hs(We,Re,np(We,et),vt);rr(We,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Re!==null&&Re.tag===6?(g(We,Re.sibling),vt=E(Re,et),vt.return=We,We=vt):(g(We,Re),vt=Sf(et,We.mode,vt),vt.return=We,We=vt),re(We)):g(We,Re)}return function(We,Re,et,vt){try{ar=0;var kr=hs(We,Re,et,vt);return St=null,kr}catch(ur){if(ur===Ie||ur===Se)throw ur;var Rn=ua(29,ur,null,We.mode);return Rn.lanes=vt,Rn.return=We,Rn}}}var bs=rn(!0),Ur=rn(!1),er=!1;function Wt(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ls(d,h){d=d.updateQueue,h.updateQueue===d&&(h.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Er(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Wr(d,h,g){var w=d.updateQueue;if(w===null)return null;if(w=w.shared,(Wn&2)!==0){var E=w.pending;return E===null?h.next=h:(h.next=E.next,E.next=h),w.pending=h,h=da(d),Nf(d,null,g),h}return jf(d,w,h,g),da(d)}function qn(d,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var w=h.lanes;w&=d.pendingLanes,g|=w,h.lanes=g,Zt(d,g)}}function Ni(d,h){var g=d.updateQueue,w=d.alternate;if(w!==null&&(w=w.updateQueue,g===w)){var E=null,D=null;if(g=g.firstBaseUpdate,g!==null){do{var re={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};D===null?E=D=re:D=D.next=re,g=g.next}while(g!==null);D===null?E=D=h:D=D.next=h}else E=D=h;g={baseState:w.baseState,firstBaseUpdate:E,lastBaseUpdate:D,shared:w.shared,callbacks:w.callbacks},d.updateQueue=g;return}d=g.lastBaseUpdate,d===null?g.firstBaseUpdate=h:d.next=h,g.lastBaseUpdate=h}var Ji=!1;function cs(){if(Ji){var d=M;if(d!==null)throw d}}function di(d,h,g,w){Ji=!1;var E=d.updateQueue;er=!1;var D=E.firstBaseUpdate,re=E.lastBaseUpdate,fe=E.shared.pending;if(fe!==null){E.shared.pending=null;var Oe=fe,tt=Oe.next;Oe.next=null,re===null?D=tt:re.next=tt,re=Oe;var gt=d.alternate;gt!==null&&(gt=gt.updateQueue,fe=gt.lastBaseUpdate,fe!==re&&(fe===null?gt.firstBaseUpdate=tt:fe.next=tt,gt.lastBaseUpdate=Oe))}if(D!==null){var jt=E.baseState;re=0,gt=tt=Oe=null,fe=D;do{var it=fe.lane&-536870913,ut=it!==fe.lane;if(ut?(hn&it)===it:(w&it)===it){it!==0&&it===S&&(Ji=!0),gt!==null&&(gt=gt.next={lane:0,tag:fe.tag,payload:fe.payload,callback:null,next:null});e:{var sr=d,Tr=fe;it=h;var hs=g;switch(Tr.tag){case 1:if(sr=Tr.payload,typeof sr=="function"){jt=sr.call(hs,jt,it);break e}jt=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=Tr.payload,it=typeof sr=="function"?sr.call(hs,jt,it):sr,it==null)break e;jt=p({},jt,it);break e;case 2:er=!0}}it=fe.callback,it!==null&&(d.flags|=64,ut&&(d.flags|=8192),ut=E.callbacks,ut===null?E.callbacks=[it]:ut.push(it))}else ut={lane:it,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},gt===null?(tt=gt=ut,Oe=jt):gt=gt.next=ut,re|=it;if(fe=fe.next,fe===null){if(fe=E.shared.pending,fe===null)break;ut=fe,fe=ut.next,ut.next=null,E.lastBaseUpdate=ut,E.shared.pending=null}}while(!0);gt===null&&(Oe=jt),E.baseState=Oe,E.firstBaseUpdate=tt,E.lastBaseUpdate=gt,D===null&&(E.shared.lanes=0),bh|=re,d.lanes=re,d.memoizedState=jt}}function ha(d,h){if(typeof d!="function")throw Error(n(191,d));d.call(h)}function ui(d,h){var g=d.callbacks;if(g!==null)for(d.callbacks=null,d=0;d<g.length;d++)ha(g[d],h)}var Jr=W(null),kn=W(0);function Os(d,h){d=ru,Y(kn,d),Y(Jr,h),ru=d|h.baseLanes}function On(){Y(kn,ru),Y(Jr,Jr.current)}function ki(){ru=kn.current,U(Jr),U(kn)}var Ms=W(null),Sn=null;function ni(d){var h=d.alternate;Y(xn,xn.current&1),Y(Ms,d),Sn===null&&(h===null||Jr.current!==null||h.memoizedState!==null)&&(Sn=d)}function Hn(d){Y(xn,xn.current),Y(Ms,d),Sn===null&&(Sn=d)}function hi(d){d.tag===22?(Y(xn,xn.current),Y(Ms,d),Sn===null&&(Sn=d)):fi()}function fi(){Y(xn,xn.current),Y(Ms,Ms.current)}function Jn(d){U(Ms),Sn===d&&(Sn=null),U(xn)}var xn=W(0);function fa(d){for(var h=d;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||V4(g)||Y4(g)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Hs=0,vr=null,Nr=null,_n=null,Za=!1,Go=!1,Da=!1,pi=0,rd=0,nd=null,ip=0;function ds(){throw Error(n(321))}function sg(d,h){if(h===null)return!1;for(var g=0;g<h.length&&g<d.length;g++)if(!Gi(d[g],h[g]))return!1;return!0}function ig(d,h,g,w,E,D){return Hs=D,vr=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,G.H=d===null||d.memoizedState===null?XE:s4,Da=!1,D=g(w,E),Da=!1,Go&&(D=pc(h,g,w,E)),ap(d),D}function ap(d){G.H=fg;var h=Nr!==null&&Nr.next!==null;if(Hs=0,_n=Nr=vr=null,Za=!1,rd=0,nd=null,h)throw Error(n(300));d===null||Pi||(d=d.dependencies,d!==null&&rp(d)&&(Pi=!0))}function pc(d,h,g,w){vr=d;var E=0;do{if(Go&&(nd=null),rd=0,Go=!1,25<=E)throw Error(n(301));if(E+=1,_n=Nr=null,d.updateQueue!=null){var D=d.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}G.H=JE,D=h(g,w)}while(Go);return D}function J5(){var d=G.H,h=d.useState()[0];return h=typeof h.then=="function"?sd(h):h,d=d.useState()[0],(Nr!==null?Nr.memoizedState:null)!==d&&(vr.flags|=1024),h}function ag(){var d=pi!==0;return pi=0,d}function og(d,h,g){h.updateQueue=d.updateQueue,h.flags&=-2053,d.lanes&=~g}function op(d){if(Za){for(d=d.memoizedState;d!==null;){var h=d.queue;h!==null&&(h.pending=null),d=d.next}Za=!1}Hs=0,_n=Nr=vr=null,Go=!1,rd=pi=0,nd=null}function Mi(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?vr.memoizedState=_n=d:_n=_n.next=d,_n}function Ws(){if(Nr===null){var d=vr.alternate;d=d!==null?d.memoizedState:null}else d=Nr.next;var h=_n===null?vr.memoizedState:_n.next;if(h!==null)_n=h,Nr=d;else{if(d===null)throw vr.alternate===null?Error(n(467)):Error(n(310));Nr=d,d={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},_n===null?vr.memoizedState=_n=d:_n=_n.next=d}return _n}function Ef(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sd(d){var h=rd;return rd+=1,nd===null&&(nd=[]),d=pt(nd,d,h),h=vr,(_n===null?h.memoizedState:_n.next)===null&&(h=h.alternate,G.H=h===null||h.memoizedState===null?XE:s4),d}function hh(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return sd(d);if(d.$$typeof===A)return Xi(d)}throw Error(n(438,String(d)))}function Vd(d){var h=null,g=vr.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var w=vr.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(h={data:w.data.map(function(E){return E.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=Ef(),vr.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(d),w=0;w<d;w++)g[w]=$;return h.index++,g}function Rl(d,h){return typeof h=="function"?h(d):h}function lp(d){var h=Ws();return fh(h,Nr,d)}function fh(d,h,g){var w=d.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=g;var E=d.baseQueue,D=w.pending;if(D!==null){if(E!==null){var re=E.next;E.next=D.next,D.next=re}h.baseQueue=E=D,w.pending=null}if(D=d.baseState,E===null)d.memoizedState=D;else{h=E.next;var fe=re=null,Oe=null,tt=h,gt=!1;do{var jt=tt.lane&-536870913;if(jt!==tt.lane?(hn&jt)===jt:(Hs&jt)===jt){var it=tt.revertLane;if(it===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),jt===S&&(gt=!0);else if((Hs&it)===it){tt=tt.next,it===S&&(gt=!0);continue}else jt={lane:0,revertLane:tt.revertLane,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Oe===null?(fe=Oe=jt,re=D):Oe=Oe.next=jt,vr.lanes|=it,bh|=it;jt=tt.action,Da&&g(D,jt),D=tt.hasEagerState?tt.eagerState:g(D,jt)}else it={lane:jt,revertLane:tt.revertLane,gesture:tt.gesture,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Oe===null?(fe=Oe=it,re=D):Oe=Oe.next=it,vr.lanes|=jt,bh|=jt;tt=tt.next}while(tt!==null&&tt!==h);if(Oe===null?re=D:Oe.next=fe,!Gi(D,d.memoizedState)&&(Pi=!0,gt&&(g=M,g!==null)))throw g;d.memoizedState=D,d.baseState=re,d.baseQueue=Oe,w.lastRenderedState=D}return E===null&&(w.lanes=0),[d.memoizedState,w.dispatch]}function cp(d){var h=Ws(),g=h.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=d;var w=g.dispatch,E=g.pending,D=h.memoizedState;if(E!==null){g.pending=null;var re=E=E.next;do D=d(D,re.action),re=re.next;while(re!==E);Gi(D,h.memoizedState)||(Pi=!0),h.memoizedState=D,h.baseQueue===null&&(h.baseState=D),g.lastRenderedState=D}return[D,w]}function dp(d,h,g){var w=vr,E=Ws(),D=sn;if(D){if(g===void 0)throw Error(n(407));g=g()}else g=h();var re=!Gi((Nr||E).memoizedState,g);if(re&&(E.memoizedState=g,Pi=!0),E=E.queue,Z5(cg.bind(null,w,E,d),[d]),E.getSnapshot!==h||re||_n!==null&&_n.memoizedState.tag&1){if(w.flags|=2048,Kd(9,{destroy:void 0},lg.bind(null,w,E,g,h),null),ys===null)throw Error(n(349));D||(Hs&127)!==0||mc(w,h,g)}return g}function mc(d,h,g){d.flags|=16384,d={getSnapshot:h,value:g},h=vr.updateQueue,h===null?(h=Ef(),vr.updateQueue=h,h.stores=[d]):(g=h.stores,g===null?h.stores=[d]:g.push(d))}function lg(d,h,g,w){h.value=g,h.getSnapshot=w,by(h)&&dg(d)}function cg(d,h,g){return g(function(){by(h)&&dg(d)})}function by(d){var h=d.getSnapshot;d=d.value;try{var g=h();return!Gi(d,g)}catch{return!0}}function dg(d){var h=hc(d,2);h!==null&&Jo(h,d,2)}function id(d){var h=Mi();if(typeof d=="function"){var g=d;if(d=g(),Da){Et(!0);try{g()}finally{Et(!1)}}}return h.memoizedState=h.baseState=d,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rl,lastRenderedState:d},h}function yy(d,h,g,w){return d.baseState=g,fh(d,Nr,typeof w=="function"?w:Rl)}function vy(d,h,g,w,E){if(ky(d))throw Error(n(485));if(d=h.action,d!==null){var D={payload:E,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(re){D.listeners.push(re)}};G.T!==null?g(!0):D.isTransition=!1,w(D),g=h.pending,g===null?(D.next=h.pending=D,wy(h,D)):(D.next=g.next,h.pending=g.next=D)}}function wy(d,h){var g=h.action,w=h.payload,E=d.state;if(h.isTransition){var D=G.T,re={};G.T=re;try{var fe=g(E,w),Oe=G.S;Oe!==null&&Oe(re,fe),ug(d,h,fe)}catch(tt){Yd(d,h,tt)}finally{D!==null&&re.types!==null&&(D.types=re.types),G.T=D}}else try{D=g(E,w),ug(d,h,D)}catch(tt){Yd(d,h,tt)}}function ug(d,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(w){jy(d,h,w)},function(w){return Yd(d,h,w)}):jy(d,h,g)}function jy(d,h,g){h.status="fulfilled",h.value=g,up(h),d.state=g,h=d.pending,h!==null&&(g=h.next,g===h?d.pending=null:(g=g.next,h.next=g,wy(d,g)))}function Yd(d,h,g){var w=d.pending;if(d.pending=null,w!==null){w=w.next;do h.status="rejected",h.reason=g,up(h),h=h.next;while(h!==w)}d.action=null}function up(d){d=d.listeners;for(var h=0;h<d.length;h++)(0,d[h])()}function Tf(d,h){return h}function Dl(d,h){if(sn){var g=ys.formState;if(g!==null){e:{var w=vr;if(sn){if(xs){t:{for(var E=xs,D=qs;E.nodeType!==8;){if(!D){E=null;break t}if(E=Bl(E.nextSibling),E===null){E=null;break t}}D=E.data,E=D==="F!"||D==="F"?E:null}if(E){xs=Bl(E.nextSibling),w=E.data==="F!";break e}}Jc(w)}w=!1}w&&(h=g[0])}}return g=Mi(),g.memoizedState=g.baseState=h,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tf,lastRenderedState:h},g.queue=w,g=VE.bind(null,vr,w),w.dispatch=g,w=id(!1),D=n4.bind(null,vr,!1,w.queue),w=Mi(),E={state:h,dispatch:null,action:d,pending:null},w.queue=E,g=vy.bind(null,vr,E,D,g),E.dispatch=g,w.memoizedState=d,[h,g,!1]}function gc(d){var h=Ws();return xc(h,Nr,d)}function xc(d,h,g){if(h=fh(d,h,Tf)[0],d=lp(Rl)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var w=sd(h)}catch(re){throw re===Ie?Se:re}else w=h;h=Ws();var E=h.queue,D=E.dispatch;return g!==h.memoizedState&&(vr.flags|=2048,Kd(9,{destroy:void 0},hp.bind(null,E,g),null)),[w,D,d]}function hp(d,h){d.action=h}function fp(d){var h=Ws(),g=Nr;if(g!==null)return xc(h,g,d);Ws(),h=h.memoizedState,g=Ws();var w=g.queue.dispatch;return g.memoizedState=d,[h,w,!1]}function Kd(d,h,g,w){return d={tag:d,create:g,deps:w,inst:h,next:null},h=vr.updateQueue,h===null&&(h=Ef(),vr.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=d.next=d:(w=g.next,g.next=d,d.next=w,h.lastEffect=d),d}function Ny(){return Ws().memoizedState}function ph(d,h,g,w){var E=Mi();vr.flags|=d,E.memoizedState=Kd(1|h,{destroy:void 0},g,w===void 0?null:w)}function mh(d,h,g,w){var E=Ws();w=w===void 0?null:w;var D=E.memoizedState.inst;Nr!==null&&w!==null&&sg(w,Nr.memoizedState.deps)?E.memoizedState=Kd(h,D,g,w):(vr.flags|=d,E.memoizedState=Kd(1|h,D,g,w))}function ME(d,h){ph(8390656,8,d,h)}function Z5(d,h){mh(2048,8,d,h)}function MX(d){vr.flags|=4;var h=vr.updateQueue;if(h===null)h=Ef(),vr.updateQueue=h,h.events=[d];else{var g=h.events;g===null?h.events=[d]:g.push(d)}}function PE(d){var h=Ws().memoizedState;return MX({ref:h,nextImpl:d}),function(){if((Wn&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}function IE(d,h){return mh(4,2,d,h)}function RE(d,h){return mh(4,4,d,h)}function DE(d,h){if(typeof h=="function"){d=d();var g=h(d);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return d=d(),h.current=d,function(){h.current=null}}function BE(d,h,g){g=g!=null?g.concat([d]):null,mh(4,4,DE.bind(null,h,d),g)}function Q5(){}function $E(d,h){var g=Ws();h=h===void 0?null:h;var w=g.memoizedState;return h!==null&&sg(h,w[1])?w[0]:(g.memoizedState=[d,h],d)}function FE(d,h){var g=Ws();h=h===void 0?null:h;var w=g.memoizedState;if(h!==null&&sg(h,w[1]))return w[0];if(w=d(),Da){Et(!0);try{d()}finally{Et(!1)}}return g.memoizedState=[w,h],w}function e4(d,h,g){return g===void 0||(Hs&1073741824)!==0&&(hn&261930)===0?d.memoizedState=h:(d.memoizedState=g,d=U8(),vr.lanes|=d,bh|=d,g)}function UE(d,h,g,w){return Gi(g,h)?g:Jr.current!==null?(d=e4(d,g,w),Gi(d,h)||(Pi=!0),d):(Hs&42)===0||(Hs&1073741824)!==0&&(hn&261930)===0?(Pi=!0,d.memoizedState=g):(d=U8(),vr.lanes|=d,bh|=d,h)}function zE(d,h,g,w,E){var D=ne.p;ne.p=D!==0&&8>D?D:8;var re=G.T,fe={};G.T=fe,n4(d,!1,h,g);try{var Oe=E(),tt=G.S;if(tt!==null&&tt(fe,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var gt=le(Oe,w);hg(d,h,gt,gl(d))}else hg(d,h,w,gl(d))}catch(jt){hg(d,h,{then:function(){},status:"rejected",reason:jt},gl())}finally{ne.p=D,re!==null&&fe.types!==null&&(re.types=fe.types),G.T=re}}function PX(){}function t4(d,h,g,w){if(d.tag!==5)throw Error(n(476));var E=qE(d).queue;zE(d,E,h,ee,g===null?PX:function(){return HE(d),g(w)})}function qE(d){var h=d.memoizedState;if(h!==null)return h;h={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rl,lastRenderedState:ee},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rl,lastRenderedState:g},next:null},d.memoizedState=h,d=d.alternate,d!==null&&(d.memoizedState=h),h}function HE(d){var h=qE(d);h.next===null&&(h=d.alternate.memoizedState),hg(d,h.next.queue,{},gl())}function r4(){return Xi(Eg)}function WE(){return Ws().memoizedState}function GE(){return Ws().memoizedState}function IX(d){for(var h=d.return;h!==null;){switch(h.tag){case 24:case 3:var g=gl();d=Er(g);var w=Wr(h,d,g);w!==null&&(Jo(w,h,g),qn(w,h,g)),h={cache:uh()},d.payload=h;return}h=h.return}}function RX(d,h,g){var w=gl();g={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},ky(d)?YE(h,g):(g=Y0(d,h,g,w),g!==null&&(Jo(g,d,w),KE(g,h,w)))}function VE(d,h,g){var w=gl();hg(d,h,g,w)}function hg(d,h,g,w){var E={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(ky(d))YE(h,E);else{var D=d.alternate;if(d.lanes===0&&(D===null||D.lanes===0)&&(D=h.lastRenderedReducer,D!==null))try{var re=h.lastRenderedState,fe=D(re,g);if(E.hasEagerState=!0,E.eagerState=fe,Gi(fe,re))return jf(d,h,E,0),ys===null&&wf(),!1}catch{}if(g=Y0(d,h,E,w),g!==null)return Jo(g,d,w),KE(g,h,w),!0}return!1}function n4(d,h,g,w){if(w={lane:2,revertLane:I4(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},ky(d)){if(h)throw Error(n(479))}else h=Y0(d,g,w,2),h!==null&&Jo(h,d,2)}function ky(d){var h=d.alternate;return d===vr||h!==null&&h===vr}function YE(d,h){Go=Za=!0;var g=d.pending;g===null?h.next=h:(h.next=g.next,g.next=h),d.pending=h}function KE(d,h,g){if((g&4194048)!==0){var w=h.lanes;w&=d.pendingLanes,g|=w,h.lanes=g,Zt(d,g)}}var fg={readContext:Xi,use:hh,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useLayoutEffect:ds,useInsertionEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useSyncExternalStore:ds,useId:ds,useHostTransitionStatus:ds,useFormState:ds,useActionState:ds,useOptimistic:ds,useMemoCache:ds,useCacheRefresh:ds};fg.useEffectEvent=ds;var XE={readContext:Xi,use:hh,useCallback:function(d,h){return Mi().memoizedState=[d,h===void 0?null:h],d},useContext:Xi,useEffect:ME,useImperativeHandle:function(d,h,g){g=g!=null?g.concat([d]):null,ph(4194308,4,DE.bind(null,h,d),g)},useLayoutEffect:function(d,h){return ph(4194308,4,d,h)},useInsertionEffect:function(d,h){ph(4,2,d,h)},useMemo:function(d,h){var g=Mi();h=h===void 0?null:h;var w=d();if(Da){Et(!0);try{d()}finally{Et(!1)}}return g.memoizedState=[w,h],w},useReducer:function(d,h,g){var w=Mi();if(g!==void 0){var E=g(h);if(Da){Et(!0);try{g(h)}finally{Et(!1)}}}else E=h;return w.memoizedState=w.baseState=E,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:E},w.queue=d,d=d.dispatch=RX.bind(null,vr,d),[w.memoizedState,d]},useRef:function(d){var h=Mi();return d={current:d},h.memoizedState=d},useState:function(d){d=id(d);var h=d.queue,g=VE.bind(null,vr,h);return h.dispatch=g,[d.memoizedState,g]},useDebugValue:Q5,useDeferredValue:function(d,h){var g=Mi();return e4(g,d,h)},useTransition:function(){var d=id(!1);return d=zE.bind(null,vr,d.queue,!0,!1),Mi().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,h,g){var w=vr,E=Mi();if(sn){if(g===void 0)throw Error(n(407));g=g()}else{if(g=h(),ys===null)throw Error(n(349));(hn&127)!==0||mc(w,h,g)}E.memoizedState=g;var D={value:g,getSnapshot:h};return E.queue=D,ME(cg.bind(null,w,D,d),[d]),w.flags|=2048,Kd(9,{destroy:void 0},lg.bind(null,w,D,g,h),null),g},useId:function(){var d=Mi(),h=ys.identifierPrefix;if(sn){var g=Ho,w=qo;g=(w&~(1<<32-$t(w)-1)).toString(32)+g,h="_"+h+"R_"+g,g=pi++,0<g&&(h+="H"+g.toString(32)),h+="_"}else g=ip++,h="_"+h+"r_"+g.toString(32)+"_";return d.memoizedState=h},useHostTransitionStatus:r4,useFormState:Dl,useActionState:Dl,useOptimistic:function(d){var h=Mi();h.memoizedState=h.baseState=d;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=n4.bind(null,vr,!0,g),g.dispatch=h,[d,h]},useMemoCache:Vd,useCacheRefresh:function(){return Mi().memoizedState=IX.bind(null,vr)},useEffectEvent:function(d){var h=Mi(),g={impl:d};return h.memoizedState=g,function(){if((Wn&2)!==0)throw Error(n(440));return g.impl.apply(void 0,arguments)}}},s4={readContext:Xi,use:hh,useCallback:$E,useContext:Xi,useEffect:Z5,useImperativeHandle:BE,useInsertionEffect:IE,useLayoutEffect:RE,useMemo:FE,useReducer:lp,useRef:Ny,useState:function(){return lp(Rl)},useDebugValue:Q5,useDeferredValue:function(d,h){var g=Ws();return UE(g,Nr.memoizedState,d,h)},useTransition:function(){var d=lp(Rl)[0],h=Ws().memoizedState;return[typeof d=="boolean"?d:sd(d),h]},useSyncExternalStore:dp,useId:WE,useHostTransitionStatus:r4,useFormState:gc,useActionState:gc,useOptimistic:function(d,h){var g=Ws();return yy(g,Nr,d,h)},useMemoCache:Vd,useCacheRefresh:GE};s4.useEffectEvent=PE;var JE={readContext:Xi,use:hh,useCallback:$E,useContext:Xi,useEffect:Z5,useImperativeHandle:BE,useInsertionEffect:IE,useLayoutEffect:RE,useMemo:FE,useReducer:cp,useRef:Ny,useState:function(){return cp(Rl)},useDebugValue:Q5,useDeferredValue:function(d,h){var g=Ws();return Nr===null?e4(g,d,h):UE(g,Nr.memoizedState,d,h)},useTransition:function(){var d=cp(Rl)[0],h=Ws().memoizedState;return[typeof d=="boolean"?d:sd(d),h]},useSyncExternalStore:dp,useId:WE,useHostTransitionStatus:r4,useFormState:fp,useActionState:fp,useOptimistic:function(d,h){var g=Ws();return Nr!==null?yy(g,Nr,d,h):(g.baseState=d,[d,g.queue.dispatch])},useMemoCache:Vd,useCacheRefresh:GE};JE.useEffectEvent=PE;function i4(d,h,g,w){h=d.memoizedState,g=g(w,h),g=g==null?h:p({},h,g),d.memoizedState=g,d.lanes===0&&(d.updateQueue.baseState=g)}var a4={enqueueSetState:function(d,h,g){d=d._reactInternals;var w=gl(),E=Er(w);E.payload=h,g!=null&&(E.callback=g),h=Wr(d,E,w),h!==null&&(Jo(h,d,w),qn(h,d,w))},enqueueReplaceState:function(d,h,g){d=d._reactInternals;var w=gl(),E=Er(w);E.tag=1,E.payload=h,g!=null&&(E.callback=g),h=Wr(d,E,w),h!==null&&(Jo(h,d,w),qn(h,d,w))},enqueueForceUpdate:function(d,h){d=d._reactInternals;var g=gl(),w=Er(g);w.tag=2,h!=null&&(w.callback=h),h=Wr(d,w,g),h!==null&&(Jo(h,d,g),qn(h,d,g))}};function ZE(d,h,g,w,E,D,re){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(w,D,re):h.prototype&&h.prototype.isPureReactComponent?!lc(g,w)||!lc(E,D):!0}function QE(d,h,g,w){d=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,w),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,w),h.state!==d&&a4.enqueueReplaceState(h,h.state,null)}function Lf(d,h){var g=h;if("ref"in h){g={};for(var w in h)w!=="ref"&&(g[w]=h[w])}if(d=d.defaultProps){g===h&&(g=p({},g));for(var E in d)g[E]===void 0&&(g[E]=d[E])}return g}function e8(d){vf(d)}function t8(d){console.error(d)}function r8(d){vf(d)}function Sy(d,h){try{var g=d.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(w){setTimeout(function(){throw w})}}function n8(d,h,g){try{var w=d.onCaughtError;w(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function o4(d,h,g){return g=Er(g),g.tag=3,g.payload={element:null},g.callback=function(){Sy(d,h)},g}function s8(d){return d=Er(d),d.tag=3,d}function i8(d,h,g,w){var E=g.type.getDerivedStateFromError;if(typeof E=="function"){var D=w.value;d.payload=function(){return E(D)},d.callback=function(){n8(h,g,w)}}var re=g.stateNode;re!==null&&typeof re.componentDidCatch=="function"&&(d.callback=function(){n8(h,g,w),typeof E!="function"&&(yh===null?yh=new Set([this]):yh.add(this));var fe=w.stack;this.componentDidCatch(w.value,{componentStack:fe!==null?fe:""})})}function DX(d,h,g,w,E){if(g.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(h=g.alternate,h!==null&&ed(h,g,E,!0),g=Ms.current,g!==null){switch(g.tag){case 31:case 13:return Sn===null?Dy():g.alternate===null&&mi===0&&(mi=3),g.flags&=-257,g.flags|=65536,g.lanes=E,w===$e?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([w]):h.add(w),O4(d,w,E)),!1;case 22:return g.flags|=65536,w===$e?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([w])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([w]):g.add(w)),O4(d,w,E)),!1}throw Error(n(435,g.tag))}return O4(d,w,E),Dy(),!1}if(sn)return h=Ms.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=E,w!==fl&&(d=Error(n(422),{cause:w}),ch(Fo(d,g)))):(w!==fl&&(h=Error(n(423),{cause:w}),ch(Fo(h,g))),d=d.current.alternate,d.flags|=65536,E&=-E,d.lanes|=E,w=Fo(w,g),E=o4(d.stateNode,w,E),Ni(d,E),mi!==4&&(mi=2)),!1;var D=Error(n(520),{cause:w});if(D=Fo(D,g),wg===null?wg=[D]:wg.push(D),mi!==4&&(mi=2),h===null)return!0;w=Fo(w,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,d=E&-E,g.lanes|=d,d=o4(g.stateNode,w,d),Ni(g,d),!1;case 1:if(h=g.type,D=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(yh===null||!yh.has(D))))return g.flags|=65536,E&=-E,g.lanes|=E,E=s8(E),i8(E,d,g,w),Ni(g,E),!1}g=g.return}while(g!==null);return!1}var l4=Error(n(461)),Pi=!1;function Ba(d,h,g,w){h.child=d===null?Ur(h,null,g,w):bs(h,d.child,g,w)}function a8(d,h,g,w,E){g=g.render;var D=h.ref;if("ref"in w){var re={};for(var fe in w)fe!=="ref"&&(re[fe]=w[fe])}else re=w;return td(h),w=ig(d,h,g,re,D,E),fe=ag(),d!==null&&!Pi?(og(d,h,E),Xd(d,h,E)):(sn&&fe&&tg(h),h.flags|=1,Ba(d,h,w,E),h.child)}function o8(d,h,g,w,E){if(d===null){var D=g.type;return typeof D=="function"&&!X0(D)&&D.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=D,l8(d,h,D,w,E)):(d=ah(g.type,null,w,h,h.mode,E),d.ref=h.ref,d.return=h,h.child=d)}if(D=d.child,!g4(d,E)){var re=D.memoizedProps;if(g=g.compare,g=g!==null?g:lc,g(re,w)&&d.ref===h.ref)return Xd(d,h,E)}return h.flags|=1,d=$o(D,w),d.ref=h.ref,d.return=h,h.child=d}function l8(d,h,g,w,E){if(d!==null){var D=d.memoizedProps;if(lc(D,w)&&d.ref===h.ref)if(Pi=!1,h.pendingProps=w=D,g4(d,E))(d.flags&131072)!==0&&(Pi=!0);else return h.lanes=d.lanes,Xd(d,h,E)}return c4(d,h,g,w,E)}function c8(d,h,g,w){var E=w.children,D=d!==null?d.memoizedState:null;if(d===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((h.flags&128)!==0){if(D=D!==null?D.baseLanes|g:g,d!==null){for(w=h.child=d.child,E=0;w!==null;)E=E|w.lanes|w.childLanes,w=w.sibling;w=E&~D}else w=0,h.child=null;return d8(d,h,D,g,w)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},d!==null&&ye(h,D!==null?D.cachePool:null),D!==null?Os(h,D):On(),hi(h);else return w=h.lanes=536870912,d8(d,h,D!==null?D.baseLanes|g:g,g,w)}else D!==null?(ye(h,D.cachePool),Os(h,D),fi(),h.memoizedState=null):(d!==null&&ye(h,null),On(),fi());return Ba(d,h,E,g),h.child}function pg(d,h){return d!==null&&d.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function d8(d,h,g,w,E){var D=ge();return D=D===null?null:{parent:ri._currentValue,pool:D},h.memoizedState={baseLanes:g,cachePool:D},d!==null&&ye(h,null),On(),hi(h),d!==null&&ed(d,h,w,!0),h.childLanes=E,null}function _y(d,h){return h=Ay({mode:h.mode,children:h.children},d.mode),h.ref=d.ref,d.child=h,h.return=d,h}function u8(d,h,g){return bs(h,d.child,null,g),d=_y(h,h.pendingProps),d.flags|=2,Jn(h),h.memoizedState=null,d}function BX(d,h,g){var w=h.pendingProps,E=(h.flags&128)!==0;if(h.flags&=-129,d===null){if(sn){if(w.mode==="hidden")return d=_y(h,w),h.lanes=536870912,pg(null,d);if(Hn(h),(d=xs)?(d=NT(d,qs),d=d!==null&&d.data==="&"?d:null,d!==null&&(h.memoizedState={dehydrated:d,treeContext:Xc!==null?{id:qo,overflow:Ho}:null,retryLane:536870912,hydrationErrors:null},g=J0(d),g.return=h,h.child=g,Yi=h,xs=null)):d=null,d===null)throw Jc(h);return h.lanes=536870912,null}return _y(h,w)}var D=d.memoizedState;if(D!==null){var re=D.dehydrated;if(Hn(h),E)if(h.flags&256)h.flags&=-257,h=u8(d,h,g);else if(h.memoizedState!==null)h.child=d.child,h.flags|=128,h=null;else throw Error(n(558));else if(Pi||ed(d,h,g,!1),E=(g&d.childLanes)!==0,Pi||E){if(w=ys,w!==null&&(re=Ut(w,g),re!==0&&re!==D.retryLane))throw D.retryLane=re,hc(d,re),Jo(w,d,re),l4;Dy(),h=u8(d,h,g)}else d=D.treeContext,xs=Bl(re.nextSibling),Yi=h,sn=!0,Ra=null,qs=!1,d!==null&&gy(h,d),h=_y(h,w),h.flags|=4096;return h}return d=$o(d.child,{mode:w.mode,children:w.children}),d.ref=h.ref,h.child=d,d.return=h,d}function Cy(d,h){var g=h.ref;if(g===null)d!==null&&d.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(n(284));(d===null||d.ref!==g)&&(h.flags|=4194816)}}function c4(d,h,g,w,E){return td(h),g=ig(d,h,g,w,void 0,E),w=ag(),d!==null&&!Pi?(og(d,h,E),Xd(d,h,E)):(sn&&w&&tg(h),h.flags|=1,Ba(d,h,g,E),h.child)}function h8(d,h,g,w,E,D){return td(h),h.updateQueue=null,g=pc(h,w,g,E),ap(d),w=ag(),d!==null&&!Pi?(og(d,h,D),Xd(d,h,D)):(sn&&w&&tg(h),h.flags|=1,Ba(d,h,g,D),h.child)}function f8(d,h,g,w,E){if(td(h),h.stateNode===null){var D=Vi,re=g.contextType;typeof re=="object"&&re!==null&&(D=Xi(re)),D=new g(w,D),h.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=a4,h.stateNode=D,D._reactInternals=h,D=h.stateNode,D.props=w,D.state=h.memoizedState,D.refs={},Wt(h),re=g.contextType,D.context=typeof re=="object"&&re!==null?Xi(re):Vi,D.state=h.memoizedState,re=g.getDerivedStateFromProps,typeof re=="function"&&(i4(h,g,re,w),D.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(re=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),re!==D.state&&a4.enqueueReplaceState(D,D.state,null),di(h,w,D,E),cs(),D.state=h.memoizedState),typeof D.componentDidMount=="function"&&(h.flags|=4194308),w=!0}else if(d===null){D=h.stateNode;var fe=h.memoizedProps,Oe=Lf(g,fe);D.props=Oe;var tt=D.context,gt=g.contextType;re=Vi,typeof gt=="object"&&gt!==null&&(re=Xi(gt));var jt=g.getDerivedStateFromProps;gt=typeof jt=="function"||typeof D.getSnapshotBeforeUpdate=="function",fe=h.pendingProps!==fe,gt||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(fe||tt!==re)&&QE(h,D,w,re),er=!1;var it=h.memoizedState;D.state=it,di(h,w,D,E),cs(),tt=h.memoizedState,fe||it!==tt||er?(typeof jt=="function"&&(i4(h,g,jt,w),tt=h.memoizedState),(Oe=er||ZE(h,g,Oe,w,it,tt,re))?(gt||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(h.flags|=4194308)):(typeof D.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=w,h.memoizedState=tt),D.props=w,D.state=tt,D.context=re,w=Oe):(typeof D.componentDidMount=="function"&&(h.flags|=4194308),w=!1)}else{D=h.stateNode,Ls(d,h),re=h.memoizedProps,gt=Lf(g,re),D.props=gt,jt=h.pendingProps,it=D.context,tt=g.contextType,Oe=Vi,typeof tt=="object"&&tt!==null&&(Oe=Xi(tt)),fe=g.getDerivedStateFromProps,(tt=typeof fe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(re!==jt||it!==Oe)&&QE(h,D,w,Oe),er=!1,it=h.memoizedState,D.state=it,di(h,w,D,E),cs();var ut=h.memoizedState;re!==jt||it!==ut||er||d!==null&&d.dependencies!==null&&rp(d.dependencies)?(typeof fe=="function"&&(i4(h,g,fe,w),ut=h.memoizedState),(gt=er||ZE(h,g,gt,w,it,ut,Oe)||d!==null&&d.dependencies!==null&&rp(d.dependencies))?(tt||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(w,ut,Oe),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(w,ut,Oe)),typeof D.componentDidUpdate=="function"&&(h.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof D.componentDidUpdate!="function"||re===d.memoizedProps&&it===d.memoizedState||(h.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||re===d.memoizedProps&&it===d.memoizedState||(h.flags|=1024),h.memoizedProps=w,h.memoizedState=ut),D.props=w,D.state=ut,D.context=Oe,w=gt):(typeof D.componentDidUpdate!="function"||re===d.memoizedProps&&it===d.memoizedState||(h.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||re===d.memoizedProps&&it===d.memoizedState||(h.flags|=1024),w=!1)}return D=w,Cy(d,h),w=(h.flags&128)!==0,D||w?(D=h.stateNode,g=w&&typeof g.getDerivedStateFromError!="function"?null:D.render(),h.flags|=1,d!==null&&w?(h.child=bs(h,d.child,null,E),h.child=bs(h,null,g,E)):Ba(d,h,g,E),h.memoizedState=D.state,d=h.child):d=Xd(d,h,E),d}function p8(d,h,g,w){return Wd(),h.flags|=256,Ba(d,h,g,w),h.child}var d4={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function u4(d){return{baseLanes:d,cachePool:_e()}}function h4(d,h,g){return d=d!==null?d.childLanes&~g:0,h&&(d|=ml),d}function m8(d,h,g){var w=h.pendingProps,E=!1,D=(h.flags&128)!==0,re;if((re=D)||(re=d!==null&&d.memoizedState===null?!1:(xn.current&2)!==0),re&&(E=!0,h.flags&=-129),re=(h.flags&32)!==0,h.flags&=-33,d===null){if(sn){if(E?ni(h):fi(),(d=xs)?(d=NT(d,qs),d=d!==null&&d.data!=="&"?d:null,d!==null&&(h.memoizedState={dehydrated:d,treeContext:Xc!==null?{id:qo,overflow:Ho}:null,retryLane:536870912,hydrationErrors:null},g=J0(d),g.return=h,h.child=g,Yi=h,xs=null)):d=null,d===null)throw Jc(h);return Y4(d)?h.lanes=32:h.lanes=536870912,null}var fe=w.children;return w=w.fallback,E?(fi(),E=h.mode,fe=Ay({mode:"hidden",children:fe},E),w=Kc(w,E,g,null),fe.return=h,w.return=h,fe.sibling=w,h.child=fe,w=h.child,w.memoizedState=u4(g),w.childLanes=h4(d,re,g),h.memoizedState=d4,pg(null,w)):(ni(h),f4(h,fe))}var Oe=d.memoizedState;if(Oe!==null&&(fe=Oe.dehydrated,fe!==null)){if(D)h.flags&256?(ni(h),h.flags&=-257,h=p4(d,h,g)):h.memoizedState!==null?(fi(),h.child=d.child,h.flags|=128,h=null):(fi(),fe=w.fallback,E=h.mode,w=Ay({mode:"visible",children:w.children},E),fe=Kc(fe,E,g,null),fe.flags|=2,w.return=h,fe.return=h,w.sibling=fe,h.child=w,bs(h,d.child,null,g),w=h.child,w.memoizedState=u4(g),w.childLanes=h4(d,re,g),h.memoizedState=d4,h=pg(null,w));else if(ni(h),Y4(fe)){if(re=fe.nextSibling&&fe.nextSibling.dataset,re)var tt=re.dgst;re=tt,w=Error(n(419)),w.stack="",w.digest=re,ch({value:w,source:null,stack:null}),h=p4(d,h,g)}else if(Pi||ed(d,h,g,!1),re=(g&d.childLanes)!==0,Pi||re){if(re=ys,re!==null&&(w=Ut(re,g),w!==0&&w!==Oe.retryLane))throw Oe.retryLane=w,hc(d,w),Jo(re,d,w),l4;V4(fe)||Dy(),h=p4(d,h,g)}else V4(fe)?(h.flags|=192,h.child=d.child,h=null):(d=Oe.treeContext,xs=Bl(fe.nextSibling),Yi=h,sn=!0,Ra=null,qs=!1,d!==null&&gy(h,d),h=f4(h,w.children),h.flags|=4096);return h}return E?(fi(),fe=w.fallback,E=h.mode,Oe=d.child,tt=Oe.sibling,w=$o(Oe,{mode:"hidden",children:w.children}),w.subtreeFlags=Oe.subtreeFlags&65011712,tt!==null?fe=$o(tt,fe):(fe=Kc(fe,E,g,null),fe.flags|=2),fe.return=h,w.return=h,w.sibling=fe,h.child=w,pg(null,w),w=h.child,fe=d.child.memoizedState,fe===null?fe=u4(g):(E=fe.cachePool,E!==null?(Oe=ri._currentValue,E=E.parent!==Oe?{parent:Oe,pool:Oe}:E):E=_e(),fe={baseLanes:fe.baseLanes|g,cachePool:E}),w.memoizedState=fe,w.childLanes=h4(d,re,g),h.memoizedState=d4,pg(d.child,w)):(ni(h),g=d.child,d=g.sibling,g=$o(g,{mode:"visible",children:w.children}),g.return=h,g.sibling=null,d!==null&&(re=h.deletions,re===null?(h.deletions=[d],h.flags|=16):re.push(d)),h.child=g,h.memoizedState=null,g)}function f4(d,h){return h=Ay({mode:"visible",children:h},d.mode),h.return=d,d.child=h}function Ay(d,h){return d=ua(22,d,null,h),d.lanes=0,d}function p4(d,h,g){return bs(h,d.child,null,g),d=f4(h,h.pendingProps.children),d.flags|=2,h.memoizedState=null,d}function g8(d,h,g){d.lanes|=h;var w=d.alternate;w!==null&&(w.lanes|=h),dh(d.return,h,g)}function m4(d,h,g,w,E,D){var re=d.memoizedState;re===null?d.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:w,tail:g,tailMode:E,treeForkCount:D}:(re.isBackwards=h,re.rendering=null,re.renderingStartTime=0,re.last=w,re.tail=g,re.tailMode=E,re.treeForkCount=D)}function x8(d,h,g){var w=h.pendingProps,E=w.revealOrder,D=w.tail;w=w.children;var re=xn.current,fe=(re&2)!==0;if(fe?(re=re&1|2,h.flags|=128):re&=1,Y(xn,re),Ba(d,h,w,g),w=sn?_f:0,!fe&&d!==null&&(d.flags&128)!==0)e:for(d=h.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&g8(d,g,h);else if(d.tag===19)g8(d,g,h);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break e;for(;d.sibling===null;){if(d.return===null||d.return===h)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(E){case"forwards":for(g=h.child,E=null;g!==null;)d=g.alternate,d!==null&&fa(d)===null&&(E=g),g=g.sibling;g=E,g===null?(E=h.child,h.child=null):(E=g.sibling,g.sibling=null),m4(h,!1,E,g,D,w);break;case"backwards":case"unstable_legacy-backwards":for(g=null,E=h.child,h.child=null;E!==null;){if(d=E.alternate,d!==null&&fa(d)===null){h.child=E;break}d=E.sibling,E.sibling=g,g=E,E=d}m4(h,!0,g,null,D,w);break;case"together":m4(h,!1,null,null,void 0,w);break;default:h.memoizedState=null}return h.child}function Xd(d,h,g){if(d!==null&&(h.dependencies=d.dependencies),bh|=h.lanes,(g&h.childLanes)===0)if(d!==null){if(ed(d,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(d!==null&&h.child!==d.child)throw Error(n(153));if(h.child!==null){for(d=h.child,g=$o(d,d.pendingProps),h.child=g,g.return=h;d.sibling!==null;)d=d.sibling,g=g.sibling=$o(d,d.pendingProps),g.return=h;g.sibling=null}return h.child}function g4(d,h){return(d.lanes&h)!==0?!0:(d=d.dependencies,!!(d!==null&&rp(d)))}function $X(d,h,g){switch(h.tag){case 3:ve(h,h.stateNode.containerInfo),Qc(h,ri,d.memoizedState.cache),Wd();break;case 27:case 5:pe(h);break;case 4:ve(h,h.stateNode.containerInfo);break;case 10:Qc(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,Hn(h),null;break;case 13:var w=h.memoizedState;if(w!==null)return w.dehydrated!==null?(ni(h),h.flags|=128,null):(g&h.child.childLanes)!==0?m8(d,h,g):(ni(h),d=Xd(d,h,g),d!==null?d.sibling:null);ni(h);break;case 19:var E=(d.flags&128)!==0;if(w=(g&h.childLanes)!==0,w||(ed(d,h,g,!1),w=(g&h.childLanes)!==0),E){if(w)return x8(d,h,g);h.flags|=128}if(E=h.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Y(xn,xn.current),w)break;return null;case 22:return h.lanes=0,c8(d,h,g,h.pendingProps);case 24:Qc(h,ri,d.memoizedState.cache)}return Xd(d,h,g)}function b8(d,h,g){if(d!==null)if(d.memoizedProps!==h.pendingProps)Pi=!0;else{if(!g4(d,g)&&(h.flags&128)===0)return Pi=!1,$X(d,h,g);Pi=(d.flags&131072)!==0}else Pi=!1,sn&&(h.flags&1048576)!==0&&my(h,_f,h.index);switch(h.lanes=0,h.tag){case 16:e:{var w=h.pendingProps;if(d=Je(h.elementType),h.type=d,typeof d=="function")X0(d)?(w=Lf(d,w),h.tag=1,h=f8(null,h,d,w,g)):(h.tag=0,h=c4(null,h,d,w,g));else{if(d!=null){var E=d.$$typeof;if(E===L){h.tag=11,h=a8(null,h,d,w,g);break e}else if(E===T){h.tag=14,h=o8(null,h,d,w,g);break e}}throw h=q(d)||d,Error(n(306,h,""))}}return h;case 0:return c4(d,h,h.type,h.pendingProps,g);case 1:return w=h.type,E=Lf(w,h.pendingProps),f8(d,h,w,E,g);case 3:e:{if(ve(h,h.stateNode.containerInfo),d===null)throw Error(n(387));w=h.pendingProps;var D=h.memoizedState;E=D.element,Ls(d,h),di(h,w,null,g);var re=h.memoizedState;if(w=re.cache,Qc(h,ri,w),w!==D.cache&&Gd(h,[ri],g,!0),cs(),w=re.element,D.isDehydrated)if(D={element:w,isDehydrated:!1,cache:re.cache},h.updateQueue.baseState=D,h.memoizedState=D,h.flags&256){h=p8(d,h,w,g);break e}else if(w!==E){E=Fo(Error(n(424)),h),ch(E),h=p8(d,h,w,g);break e}else for(d=h.stateNode.containerInfo,d.nodeType===9?d=d.body:d=d.nodeName==="HTML"?d.ownerDocument.body:d,xs=Bl(d.firstChild),Yi=h,sn=!0,Ra=null,qs=!0,g=Ur(h,null,w,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Wd(),w===E){h=Xd(d,h,g);break e}Ba(d,h,w,g)}h=h.child}return h;case 26:return Cy(d,h),d===null?(g=ET(h.type,null,h.pendingProps,null))?h.memoizedState=g:sn||(g=h.type,d=h.pendingProps,w=Hy(xe.current).createElement(g),w[$r]=h,w[Qr]=d,$a(w,g,d),Rt(w),h.stateNode=w):h.memoizedState=ET(h.type,d.memoizedProps,h.pendingProps,d.memoizedState),null;case 27:return pe(h),d===null&&sn&&(w=h.stateNode=_T(h.type,h.pendingProps,xe.current),Yi=h,qs=!0,E=xs,Nh(h.type)?(K4=E,xs=Bl(w.firstChild)):xs=E),Ba(d,h,h.pendingProps.children,g),Cy(d,h),d===null&&(h.flags|=4194304),h.child;case 5:return d===null&&sn&&((E=w=xs)&&(w=mJ(w,h.type,h.pendingProps,qs),w!==null?(h.stateNode=w,Yi=h,xs=Bl(w.firstChild),qs=!1,E=!0):E=!1),E||Jc(h)),pe(h),E=h.type,D=h.pendingProps,re=d!==null?d.memoizedProps:null,w=D.children,H4(E,D)?w=null:re!==null&&H4(E,re)&&(h.flags|=32),h.memoizedState!==null&&(E=ig(d,h,J5,null,null,g),Eg._currentValue=E),Cy(d,h),Ba(d,h,w,g),h.child;case 6:return d===null&&sn&&((d=g=xs)&&(g=gJ(g,h.pendingProps,qs),g!==null?(h.stateNode=g,Yi=h,xs=null,d=!0):d=!1),d||Jc(h)),null;case 13:return m8(d,h,g);case 4:return ve(h,h.stateNode.containerInfo),w=h.pendingProps,d===null?h.child=bs(h,null,w,g):Ba(d,h,w,g),h.child;case 11:return a8(d,h,h.type,h.pendingProps,g);case 7:return Ba(d,h,h.pendingProps,g),h.child;case 8:return Ba(d,h,h.pendingProps.children,g),h.child;case 12:return Ba(d,h,h.pendingProps.children,g),h.child;case 10:return w=h.pendingProps,Qc(h,h.type,w.value),Ba(d,h,w.children,g),h.child;case 9:return E=h.type._context,w=h.pendingProps.children,td(h),E=Xi(E),w=w(E),h.flags|=1,Ba(d,h,w,g),h.child;case 14:return o8(d,h,h.type,h.pendingProps,g);case 15:return l8(d,h,h.type,h.pendingProps,g);case 19:return x8(d,h,g);case 31:return BX(d,h,g);case 22:return c8(d,h,g,h.pendingProps);case 24:return td(h),w=Xi(ri),d===null?(E=ge(),E===null&&(E=ys,D=uh(),E.pooledCache=D,D.refCount++,D!==null&&(E.pooledCacheLanes|=g),E=D),h.memoizedState={parent:w,cache:E},Wt(h),Qc(h,ri,E)):((d.lanes&g)!==0&&(Ls(d,h),di(h,null,null,g),cs()),E=d.memoizedState,D=h.memoizedState,E.parent!==w?(E={parent:w,cache:w},h.memoizedState=E,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=E),Qc(h,ri,w)):(w=D.cache,Qc(h,ri,w),w!==E.cache&&Gd(h,[ri],g,!0))),Ba(d,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(n(156,h.tag))}function Jd(d){d.flags|=4}function x4(d,h,g,w,E){if((h=(d.mode&32)!==0)&&(h=!1),h){if(d.flags|=16777216,(E&335544128)===E)if(d.stateNode.complete)d.flags|=8192;else if(W8())d.flags|=8192;else throw ft=$e,Qe}else d.flags&=-16777217}function y8(d,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!PT(h))if(W8())d.flags|=8192;else throw ft=$e,Qe}function Ey(d,h){h!==null&&(d.flags|=4),d.flags&16384&&(h=d.tag!==22?Ft():536870912,d.lanes|=h,xp|=h)}function mg(d,h){if(!sn)switch(d.tailMode){case"hidden":h=d.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?d.tail=null:g.sibling=null;break;case"collapsed":g=d.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?h||d.tail===null?d.tail=null:d.tail.sibling=null:w.sibling=null}}function Ps(d){var h=d.alternate!==null&&d.alternate.child===d.child,g=0,w=0;if(h)for(var E=d.child;E!==null;)g|=E.lanes|E.childLanes,w|=E.subtreeFlags&65011712,w|=E.flags&65011712,E.return=d,E=E.sibling;else for(E=d.child;E!==null;)g|=E.lanes|E.childLanes,w|=E.subtreeFlags,w|=E.flags,E.return=d,E=E.sibling;return d.subtreeFlags|=w,d.childLanes=g,h}function FX(d,h,g){var w=h.pendingProps;switch(ep(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ps(h),null;case 1:return Ps(h),null;case 3:return g=h.stateNode,w=null,d!==null&&(w=d.memoizedState.cache),h.memoizedState.cache!==w&&(h.flags|=2048),Wo(ri),Q(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(d===null||d.child===null)&&(Ki(h)?Jd(h):d===null||d.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,ng())),Ps(h),null;case 26:var E=h.type,D=h.memoizedState;return d===null?(Jd(h),D!==null?(Ps(h),y8(h,D)):(Ps(h),x4(h,E,null,w,g))):D?D!==d.memoizedState?(Jd(h),Ps(h),y8(h,D)):(Ps(h),h.flags&=-16777217):(d=d.memoizedProps,d!==w&&Jd(h),Ps(h),x4(h,E,d,w,g)),null;case 27:if(Ce(h),g=xe.current,E=h.type,d!==null&&h.stateNode!=null)d.memoizedProps!==w&&Jd(h);else{if(!w){if(h.stateNode===null)throw Error(n(166));return Ps(h),null}d=te.current,Ki(h)?rg(h):(d=_T(E,w,g),h.stateNode=d,Jd(h))}return Ps(h),null;case 5:if(Ce(h),E=h.type,d!==null&&h.stateNode!=null)d.memoizedProps!==w&&Jd(h);else{if(!w){if(h.stateNode===null)throw Error(n(166));return Ps(h),null}if(D=te.current,Ki(h))rg(h);else{var re=Hy(xe.current);switch(D){case 1:D=re.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:D=re.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":D=re.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":D=re.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":D=re.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof w.is=="string"?re.createElement("select",{is:w.is}):re.createElement("select"),w.multiple?D.multiple=!0:w.size&&(D.size=w.size);break;default:D=typeof w.is=="string"?re.createElement(E,{is:w.is}):re.createElement(E)}}D[$r]=h,D[Qr]=w;e:for(re=h.child;re!==null;){if(re.tag===5||re.tag===6)D.appendChild(re.stateNode);else if(re.tag!==4&&re.tag!==27&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===h)break e;for(;re.sibling===null;){if(re.return===null||re.return===h)break e;re=re.return}re.sibling.return=re.return,re=re.sibling}h.stateNode=D;e:switch($a(D,E,w),E){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&Jd(h)}}return Ps(h),x4(h,h.type,d===null?null:d.memoizedProps,h.pendingProps,g),null;case 6:if(d&&h.stateNode!=null)d.memoizedProps!==w&&Jd(h);else{if(typeof w!="string"&&h.stateNode===null)throw Error(n(166));if(d=xe.current,Ki(h)){if(d=h.stateNode,g=h.memoizedProps,w=null,E=Yi,E!==null)switch(E.tag){case 27:case 5:w=E.memoizedProps}d[$r]=h,d=!!(d.nodeValue===g||w!==null&&w.suppressHydrationWarning===!0||mT(d.nodeValue,g)),d||Jc(h,!0)}else d=Hy(d).createTextNode(w),d[$r]=h,h.stateNode=d}return Ps(h),null;case 31:if(g=h.memoizedState,d===null||d.memoizedState!==null){if(w=Ki(h),g!==null){if(d===null){if(!w)throw Error(n(318));if(d=h.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(557));d[$r]=h}else Wd(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ps(h),d=!1}else g=ng(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=g),d=!0;if(!d)return h.flags&256?(Jn(h),h):(Jn(h),null);if((h.flags&128)!==0)throw Error(n(558))}return Ps(h),null;case 13:if(w=h.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(E=Ki(h),w!==null&&w.dehydrated!==null){if(d===null){if(!E)throw Error(n(318));if(E=h.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[$r]=h}else Wd(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ps(h),E=!1}else E=ng(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=E),E=!0;if(!E)return h.flags&256?(Jn(h),h):(Jn(h),null)}return Jn(h),(h.flags&128)!==0?(h.lanes=g,h):(g=w!==null,d=d!==null&&d.memoizedState!==null,g&&(w=h.child,E=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(E=w.alternate.memoizedState.cachePool.pool),D=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(D=w.memoizedState.cachePool.pool),D!==E&&(w.flags|=2048)),g!==d&&g&&(h.child.flags|=8192),Ey(h,h.updateQueue),Ps(h),null);case 4:return Q(),d===null&&$4(h.stateNode.containerInfo),Ps(h),null;case 10:return Wo(h.type),Ps(h),null;case 19:if(U(xn),w=h.memoizedState,w===null)return Ps(h),null;if(E=(h.flags&128)!==0,D=w.rendering,D===null)if(E)mg(w,!1);else{if(mi!==0||d!==null&&(d.flags&128)!==0)for(d=h.child;d!==null;){if(D=fa(d),D!==null){for(h.flags|=128,mg(w,!1),d=D.updateQueue,h.updateQueue=d,Ey(h,d),h.subtreeFlags=0,d=g,g=h.child;g!==null;)kf(g,d),g=g.sibling;return Y(xn,xn.current&1|2),sn&&po(h,w.treeForkCount),h.child}d=d.sibling}w.tail!==null&&Pe()>Py&&(h.flags|=128,E=!0,mg(w,!1),h.lanes=4194304)}else{if(!E)if(d=fa(D),d!==null){if(h.flags|=128,E=!0,d=d.updateQueue,h.updateQueue=d,Ey(h,d),mg(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!sn)return Ps(h),null}else 2*Pe()-w.renderingStartTime>Py&&g!==536870912&&(h.flags|=128,E=!0,mg(w,!1),h.lanes=4194304);w.isBackwards?(D.sibling=h.child,h.child=D):(d=w.last,d!==null?d.sibling=D:h.child=D,w.last=D)}return w.tail!==null?(d=w.tail,w.rendering=d,w.tail=d.sibling,w.renderingStartTime=Pe(),d.sibling=null,g=xn.current,Y(xn,E?g&1|2:g&1),sn&&po(h,w.treeForkCount),d):(Ps(h),null);case 22:case 23:return Jn(h),ki(),w=h.memoizedState!==null,d!==null?d.memoizedState!==null!==w&&(h.flags|=8192):w&&(h.flags|=8192),w?(g&536870912)!==0&&(h.flags&128)===0&&(Ps(h),h.subtreeFlags&6&&(h.flags|=8192)):Ps(h),g=h.updateQueue,g!==null&&Ey(h,g.retryQueue),g=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(g=d.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==g&&(h.flags|=2048),d!==null&&U(he),null;case 24:return g=null,d!==null&&(g=d.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),Wo(ri),Ps(h),null;case 25:return null;case 30:return null}throw Error(n(156,h.tag))}function UX(d,h){switch(ep(h),h.tag){case 1:return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 3:return Wo(ri),Q(),d=h.flags,(d&65536)!==0&&(d&128)===0?(h.flags=d&-65537|128,h):null;case 26:case 27:case 5:return Ce(h),null;case 31:if(h.memoizedState!==null){if(Jn(h),h.alternate===null)throw Error(n(340));Wd()}return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 13:if(Jn(h),d=h.memoizedState,d!==null&&d.dehydrated!==null){if(h.alternate===null)throw Error(n(340));Wd()}return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 19:return U(xn),null;case 4:return Q(),null;case 10:return Wo(h.type),null;case 22:case 23:return Jn(h),ki(),d!==null&&U(he),d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 24:return Wo(ri),null;case 25:return null;default:return null}}function v8(d,h){switch(ep(h),h.tag){case 3:Wo(ri),Q();break;case 26:case 27:case 5:Ce(h);break;case 4:Q();break;case 31:h.memoizedState!==null&&Jn(h);break;case 13:Jn(h);break;case 19:U(xn);break;case 10:Wo(h.type);break;case 22:case 23:Jn(h),ki(),d!==null&&U(he);break;case 24:Wo(ri)}}function gg(d,h){try{var g=h.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var E=w.next;g=E;do{if((g.tag&d)===d){w=void 0;var D=g.create,re=g.inst;w=D(),re.destroy=w}g=g.next}while(g!==E)}}catch(fe){Qn(h,h.return,fe)}}function gh(d,h,g){try{var w=h.updateQueue,E=w!==null?w.lastEffect:null;if(E!==null){var D=E.next;w=D;do{if((w.tag&d)===d){var re=w.inst,fe=re.destroy;if(fe!==void 0){re.destroy=void 0,E=h;var Oe=g,tt=fe;try{tt()}catch(gt){Qn(E,Oe,gt)}}}w=w.next}while(w!==D)}}catch(gt){Qn(h,h.return,gt)}}function w8(d){var h=d.updateQueue;if(h!==null){var g=d.stateNode;try{ui(h,g)}catch(w){Qn(d,d.return,w)}}}function j8(d,h,g){g.props=Lf(d.type,d.memoizedProps),g.state=d.memoizedState;try{g.componentWillUnmount()}catch(w){Qn(d,h,w)}}function xg(d,h){try{var g=d.ref;if(g!==null){switch(d.tag){case 26:case 27:case 5:var w=d.stateNode;break;case 30:w=d.stateNode;break;default:w=d.stateNode}typeof g=="function"?d.refCleanup=g(w):g.current=w}}catch(E){Qn(d,h,E)}}function ad(d,h){var g=d.ref,w=d.refCleanup;if(g!==null)if(typeof w=="function")try{w()}catch(E){Qn(d,h,E)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(E){Qn(d,h,E)}else g.current=null}function N8(d){var h=d.type,g=d.memoizedProps,w=d.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&w.focus();break e;case"img":g.src?w.src=g.src:g.srcSet&&(w.srcset=g.srcSet)}}catch(E){Qn(d,d.return,E)}}function b4(d,h,g){try{var w=d.stateNode;cJ(w,d.type,g,h),w[Qr]=h}catch(E){Qn(d,d.return,E)}}function k8(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Nh(d.type)||d.tag===4}function y4(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||k8(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Nh(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function v4(d,h,g){var w=d.tag;if(w===5||w===6)d=d.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(d,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(d),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=Li));else if(w!==4&&(w===27&&Nh(d.type)&&(g=d.stateNode,h=null),d=d.child,d!==null))for(v4(d,h,g),d=d.sibling;d!==null;)v4(d,h,g),d=d.sibling}function Ty(d,h,g){var w=d.tag;if(w===5||w===6)d=d.stateNode,h?g.insertBefore(d,h):g.appendChild(d);else if(w!==4&&(w===27&&Nh(d.type)&&(g=d.stateNode),d=d.child,d!==null))for(Ty(d,h,g),d=d.sibling;d!==null;)Ty(d,h,g),d=d.sibling}function S8(d){var h=d.stateNode,g=d.memoizedProps;try{for(var w=d.type,E=h.attributes;E.length;)h.removeAttributeNode(E[0]);$a(h,w,g),h[$r]=d,h[Qr]=g}catch(D){Qn(d,d.return,D)}}var Zd=!1,Ii=!1,w4=!1,_8=typeof WeakSet=="function"?WeakSet:Set,pa=null;function zX(d,h){if(d=d.containerInfo,z4=Jy,d=dc(d),Ml(d)){if("selectionStart"in d)var g={start:d.selectionStart,end:d.selectionEnd};else e:{g=(g=d.ownerDocument)&&g.defaultView||window;var w=g.getSelection&&g.getSelection();if(w&&w.rangeCount!==0){g=w.anchorNode;var E=w.anchorOffset,D=w.focusNode;w=w.focusOffset;try{g.nodeType,D.nodeType}catch{g=null;break e}var re=0,fe=-1,Oe=-1,tt=0,gt=0,jt=d,it=null;t:for(;;){for(var ut;jt!==g||E!==0&&jt.nodeType!==3||(fe=re+E),jt!==D||w!==0&&jt.nodeType!==3||(Oe=re+w),jt.nodeType===3&&(re+=jt.nodeValue.length),(ut=jt.firstChild)!==null;)it=jt,jt=ut;for(;;){if(jt===d)break t;if(it===g&&++tt===E&&(fe=re),it===D&&++gt===w&&(Oe=re),(ut=jt.nextSibling)!==null)break;jt=it,it=jt.parentNode}jt=ut}g=fe===-1||Oe===-1?null:{start:fe,end:Oe}}else g=null}g=g||{start:0,end:0}}else g=null;for(q4={focusedElem:d,selectionRange:g},Jy=!1,pa=h;pa!==null;)if(h=pa,d=h.child,(h.subtreeFlags&1028)!==0&&d!==null)d.return=h,pa=d;else for(;pa!==null;){switch(h=pa,D=h.alternate,d=h.flags,h.tag){case 0:if((d&4)!==0&&(d=h.updateQueue,d=d!==null?d.events:null,d!==null))for(g=0;g<d.length;g++)E=d[g],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&D!==null){d=void 0,g=h,E=D.memoizedProps,D=D.memoizedState,w=g.stateNode;try{var sr=Lf(g.type,E);d=w.getSnapshotBeforeUpdate(sr,D),w.__reactInternalSnapshotBeforeUpdate=d}catch(Tr){Qn(g,g.return,Tr)}}break;case 3:if((d&1024)!==0){if(d=h.stateNode.containerInfo,g=d.nodeType,g===9)G4(d);else if(g===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":G4(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(n(163))}if(d=h.sibling,d!==null){d.return=h.return,pa=d;break}pa=h.return}}function C8(d,h,g){var w=g.flags;switch(g.tag){case 0:case 11:case 15:eu(d,g),w&4&&gg(5,g);break;case 1:if(eu(d,g),w&4)if(d=g.stateNode,h===null)try{d.componentDidMount()}catch(re){Qn(g,g.return,re)}else{var E=Lf(g.type,h.memoizedProps);h=h.memoizedState;try{d.componentDidUpdate(E,h,d.__reactInternalSnapshotBeforeUpdate)}catch(re){Qn(g,g.return,re)}}w&64&&w8(g),w&512&&xg(g,g.return);break;case 3:if(eu(d,g),w&64&&(d=g.updateQueue,d!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{ui(d,h)}catch(re){Qn(g,g.return,re)}}break;case 27:h===null&&w&4&&S8(g);case 26:case 5:eu(d,g),h===null&&w&4&&N8(g),w&512&&xg(g,g.return);break;case 12:eu(d,g);break;case 31:eu(d,g),w&4&&T8(d,g);break;case 13:eu(d,g),w&4&&L8(d,g),w&64&&(d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(g=JX.bind(null,g),xJ(d,g))));break;case 22:if(w=g.memoizedState!==null||Zd,!w){h=h!==null&&h.memoizedState!==null||Ii,E=Zd;var D=Ii;Zd=w,(Ii=h)&&!D?tu(d,g,(g.subtreeFlags&8772)!==0):eu(d,g),Zd=E,Ii=D}break;case 30:break;default:eu(d,g)}}function A8(d){var h=d.alternate;h!==null&&(d.alternate=null,A8(h)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(h=d.stateNode,h!==null&&zi(h)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Gs=null,Vo=!1;function Qd(d,h,g){for(g=g.child;g!==null;)E8(d,h,g),g=g.sibling}function E8(d,h,g){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(zt,g)}catch{}switch(g.tag){case 26:Ii||ad(g,h),Qd(d,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Ii||ad(g,h);var w=Gs,E=Vo;Nh(g.type)&&(Gs=g.stateNode,Vo=!1),Qd(d,h,g),_g(g.stateNode),Gs=w,Vo=E;break;case 5:Ii||ad(g,h);case 6:if(w=Gs,E=Vo,Gs=null,Qd(d,h,g),Gs=w,Vo=E,Gs!==null)if(Vo)try{(Gs.nodeType===9?Gs.body:Gs.nodeName==="HTML"?Gs.ownerDocument.body:Gs).removeChild(g.stateNode)}catch(D){Qn(g,h,D)}else try{Gs.removeChild(g.stateNode)}catch(D){Qn(g,h,D)}break;case 18:Gs!==null&&(Vo?(d=Gs,wT(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,g.stateNode),Sp(d)):wT(Gs,g.stateNode));break;case 4:w=Gs,E=Vo,Gs=g.stateNode.containerInfo,Vo=!0,Qd(d,h,g),Gs=w,Vo=E;break;case 0:case 11:case 14:case 15:gh(2,g,h),Ii||gh(4,g,h),Qd(d,h,g);break;case 1:Ii||(ad(g,h),w=g.stateNode,typeof w.componentWillUnmount=="function"&&j8(g,h,w)),Qd(d,h,g);break;case 21:Qd(d,h,g);break;case 22:Ii=(w=Ii)||g.memoizedState!==null,Qd(d,h,g),Ii=w;break;default:Qd(d,h,g)}}function T8(d,h){if(h.memoizedState===null&&(d=h.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{Sp(d)}catch(g){Qn(h,h.return,g)}}}function L8(d,h){if(h.memoizedState===null&&(d=h.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Sp(d)}catch(g){Qn(h,h.return,g)}}function qX(d){switch(d.tag){case 31:case 13:case 19:var h=d.stateNode;return h===null&&(h=d.stateNode=new _8),h;case 22:return d=d.stateNode,h=d._retryCache,h===null&&(h=d._retryCache=new _8),h;default:throw Error(n(435,d.tag))}}function Ly(d,h){var g=qX(d);h.forEach(function(w){if(!g.has(w)){g.add(w);var E=ZX.bind(null,d,w);w.then(E,E)}})}function Yo(d,h){var g=h.deletions;if(g!==null)for(var w=0;w<g.length;w++){var E=g[w],D=d,re=h,fe=re;e:for(;fe!==null;){switch(fe.tag){case 27:if(Nh(fe.type)){Gs=fe.stateNode,Vo=!1;break e}break;case 5:Gs=fe.stateNode,Vo=!1;break e;case 3:case 4:Gs=fe.stateNode.containerInfo,Vo=!0;break e}fe=fe.return}if(Gs===null)throw Error(n(160));E8(D,re,E),Gs=null,Vo=!1,D=E.alternate,D!==null&&(D.return=null),E.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)O8(h,d),h=h.sibling}var bc=null;function O8(d,h){var g=d.alternate,w=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Yo(h,d),Ko(d),w&4&&(gh(3,d,d.return),gg(3,d),gh(5,d,d.return));break;case 1:Yo(h,d),Ko(d),w&512&&(Ii||g===null||ad(g,g.return)),w&64&&Zd&&(d=d.updateQueue,d!==null&&(w=d.callbacks,w!==null&&(g=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=g===null?w:g.concat(w))));break;case 26:var E=bc;if(Yo(h,d),Ko(d),w&512&&(Ii||g===null||ad(g,g.return)),w&4){var D=g!==null?g.memoizedState:null;if(w=d.memoizedState,g===null)if(w===null)if(d.stateNode===null){e:{w=d.type,g=d.memoizedProps,E=E.ownerDocument||E;t:switch(w){case"title":D=E.getElementsByTagName("title")[0],(!D||D[$s]||D[$r]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=E.createElement(w),E.head.insertBefore(D,E.querySelector("head > title"))),$a(D,w,g),D[$r]=d,Rt(D),w=D;break e;case"link":var re=OT("link","href",E).get(w+(g.href||""));if(re){for(var fe=0;fe<re.length;fe++)if(D=re[fe],D.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&D.getAttribute("rel")===(g.rel==null?null:g.rel)&&D.getAttribute("title")===(g.title==null?null:g.title)&&D.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){re.splice(fe,1);break t}}D=E.createElement(w),$a(D,w,g),E.head.appendChild(D);break;case"meta":if(re=OT("meta","content",E).get(w+(g.content||""))){for(fe=0;fe<re.length;fe++)if(D=re[fe],D.getAttribute("content")===(g.content==null?null:""+g.content)&&D.getAttribute("name")===(g.name==null?null:g.name)&&D.getAttribute("property")===(g.property==null?null:g.property)&&D.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&D.getAttribute("charset")===(g.charSet==null?null:g.charSet)){re.splice(fe,1);break t}}D=E.createElement(w),$a(D,w,g),E.head.appendChild(D);break;default:throw Error(n(468,w))}D[$r]=d,Rt(D),w=D}d.stateNode=w}else MT(E,d.type,d.stateNode);else d.stateNode=LT(E,w,d.memoizedProps);else D!==w?(D===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):D.count--,w===null?MT(E,d.type,d.stateNode):LT(E,w,d.memoizedProps)):w===null&&d.stateNode!==null&&b4(d,d.memoizedProps,g.memoizedProps)}break;case 27:Yo(h,d),Ko(d),w&512&&(Ii||g===null||ad(g,g.return)),g!==null&&w&4&&b4(d,d.memoizedProps,g.memoizedProps);break;case 5:if(Yo(h,d),Ko(d),w&512&&(Ii||g===null||ad(g,g.return)),d.flags&32){E=d.stateNode;try{Un(E,"")}catch(sr){Qn(d,d.return,sr)}}w&4&&d.stateNode!=null&&(E=d.memoizedProps,b4(d,E,g!==null?g.memoizedProps:E)),w&1024&&(w4=!0);break;case 6:if(Yo(h,d),Ko(d),w&4){if(d.stateNode===null)throw Error(n(162));w=d.memoizedProps,g=d.stateNode;try{g.nodeValue=w}catch(sr){Qn(d,d.return,sr)}}break;case 3:if(Vy=null,E=bc,bc=Wy(h.containerInfo),Yo(h,d),bc=E,Ko(d),w&4&&g!==null&&g.memoizedState.isDehydrated)try{Sp(h.containerInfo)}catch(sr){Qn(d,d.return,sr)}w4&&(w4=!1,M8(d));break;case 4:w=bc,bc=Wy(d.stateNode.containerInfo),Yo(h,d),Ko(d),bc=w;break;case 12:Yo(h,d),Ko(d);break;case 31:Yo(h,d),Ko(d),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,Ly(d,w)));break;case 13:Yo(h,d),Ko(d),d.child.flags&8192&&d.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(My=Pe()),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,Ly(d,w)));break;case 22:E=d.memoizedState!==null;var Oe=g!==null&&g.memoizedState!==null,tt=Zd,gt=Ii;if(Zd=tt||E,Ii=gt||Oe,Yo(h,d),Ii=gt,Zd=tt,Ko(d),w&8192)e:for(h=d.stateNode,h._visibility=E?h._visibility&-2:h._visibility|1,E&&(g===null||Oe||Zd||Ii||Of(d)),g=null,h=d;;){if(h.tag===5||h.tag===26){if(g===null){Oe=g=h;try{if(D=Oe.stateNode,E)re=D.style,typeof re.setProperty=="function"?re.setProperty("display","none","important"):re.display="none";else{fe=Oe.stateNode;var jt=Oe.memoizedProps.style,it=jt!=null&&jt.hasOwnProperty("display")?jt.display:null;fe.style.display=it==null||typeof it=="boolean"?"":(""+it).trim()}}catch(sr){Qn(Oe,Oe.return,sr)}}}else if(h.tag===6){if(g===null){Oe=h;try{Oe.stateNode.nodeValue=E?"":Oe.memoizedProps}catch(sr){Qn(Oe,Oe.return,sr)}}}else if(h.tag===18){if(g===null){Oe=h;try{var ut=Oe.stateNode;E?jT(ut,!0):jT(Oe.stateNode,!1)}catch(sr){Qn(Oe,Oe.return,sr)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===d)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break e;for(;h.sibling===null;){if(h.return===null||h.return===d)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}w&4&&(w=d.updateQueue,w!==null&&(g=w.retryQueue,g!==null&&(w.retryQueue=null,Ly(d,g))));break;case 19:Yo(h,d),Ko(d),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,Ly(d,w)));break;case 30:break;case 21:break;default:Yo(h,d),Ko(d)}}function Ko(d){var h=d.flags;if(h&2){try{for(var g,w=d.return;w!==null;){if(k8(w)){g=w;break}w=w.return}if(g==null)throw Error(n(160));switch(g.tag){case 27:var E=g.stateNode,D=y4(d);Ty(d,D,E);break;case 5:var re=g.stateNode;g.flags&32&&(Un(re,""),g.flags&=-33);var fe=y4(d);Ty(d,fe,re);break;case 3:case 4:var Oe=g.stateNode.containerInfo,tt=y4(d);v4(d,tt,Oe);break;default:throw Error(n(161))}}catch(gt){Qn(d,d.return,gt)}d.flags&=-3}h&4096&&(d.flags&=-4097)}function M8(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var h=d;M8(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),d=d.sibling}}function eu(d,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)C8(d,h.alternate,h),h=h.sibling}function Of(d){for(d=d.child;d!==null;){var h=d;switch(h.tag){case 0:case 11:case 14:case 15:gh(4,h,h.return),Of(h);break;case 1:ad(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&j8(h,h.return,g),Of(h);break;case 27:_g(h.stateNode);case 26:case 5:ad(h,h.return),Of(h);break;case 22:h.memoizedState===null&&Of(h);break;case 30:Of(h);break;default:Of(h)}d=d.sibling}}function tu(d,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var w=h.alternate,E=d,D=h,re=D.flags;switch(D.tag){case 0:case 11:case 15:tu(E,D,g),gg(4,D);break;case 1:if(tu(E,D,g),w=D,E=w.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(tt){Qn(w,w.return,tt)}if(w=D,E=w.updateQueue,E!==null){var fe=w.stateNode;try{var Oe=E.shared.hiddenCallbacks;if(Oe!==null)for(E.shared.hiddenCallbacks=null,E=0;E<Oe.length;E++)ha(Oe[E],fe)}catch(tt){Qn(w,w.return,tt)}}g&&re&64&&w8(D),xg(D,D.return);break;case 27:S8(D);case 26:case 5:tu(E,D,g),g&&w===null&&re&4&&N8(D),xg(D,D.return);break;case 12:tu(E,D,g);break;case 31:tu(E,D,g),g&&re&4&&T8(E,D);break;case 13:tu(E,D,g),g&&re&4&&L8(E,D);break;case 22:D.memoizedState===null&&tu(E,D,g),xg(D,D.return);break;case 30:break;default:tu(E,D,g)}h=h.sibling}}function j4(d,h){var g=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(g=d.memoizedState.cachePool.pool),d=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(d=h.memoizedState.cachePool.pool),d!==g&&(d!=null&&d.refCount++,g!=null&&Cf(g))}function N4(d,h){d=null,h.alternate!==null&&(d=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==d&&(h.refCount++,d!=null&&Cf(d))}function yc(d,h,g,w){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)P8(d,h,g,w),h=h.sibling}function P8(d,h,g,w){var E=h.flags;switch(h.tag){case 0:case 11:case 15:yc(d,h,g,w),E&2048&&gg(9,h);break;case 1:yc(d,h,g,w);break;case 3:yc(d,h,g,w),E&2048&&(d=null,h.alternate!==null&&(d=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==d&&(h.refCount++,d!=null&&Cf(d)));break;case 12:if(E&2048){yc(d,h,g,w),d=h.stateNode;try{var D=h.memoizedProps,re=D.id,fe=D.onPostCommit;typeof fe=="function"&&fe(re,h.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Oe){Qn(h,h.return,Oe)}}else yc(d,h,g,w);break;case 31:yc(d,h,g,w);break;case 13:yc(d,h,g,w);break;case 23:break;case 22:D=h.stateNode,re=h.alternate,h.memoizedState!==null?D._visibility&2?yc(d,h,g,w):bg(d,h):D._visibility&2?yc(d,h,g,w):(D._visibility|=2,pp(d,h,g,w,(h.subtreeFlags&10256)!==0||!1)),E&2048&&j4(re,h);break;case 24:yc(d,h,g,w),E&2048&&N4(h.alternate,h);break;default:yc(d,h,g,w)}}function pp(d,h,g,w,E){for(E=E&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var D=d,re=h,fe=g,Oe=w,tt=re.flags;switch(re.tag){case 0:case 11:case 15:pp(D,re,fe,Oe,E),gg(8,re);break;case 23:break;case 22:var gt=re.stateNode;re.memoizedState!==null?gt._visibility&2?pp(D,re,fe,Oe,E):bg(D,re):(gt._visibility|=2,pp(D,re,fe,Oe,E)),E&&tt&2048&&j4(re.alternate,re);break;case 24:pp(D,re,fe,Oe,E),E&&tt&2048&&N4(re.alternate,re);break;default:pp(D,re,fe,Oe,E)}h=h.sibling}}function bg(d,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=d,w=h,E=w.flags;switch(w.tag){case 22:bg(g,w),E&2048&&j4(w.alternate,w);break;case 24:bg(g,w),E&2048&&N4(w.alternate,w);break;default:bg(g,w)}h=h.sibling}}var yg=8192;function mp(d,h,g){if(d.subtreeFlags&yg)for(d=d.child;d!==null;)I8(d,h,g),d=d.sibling}function I8(d,h,g){switch(d.tag){case 26:mp(d,h,g),d.flags&yg&&d.memoizedState!==null&&EJ(g,bc,d.memoizedState,d.memoizedProps);break;case 5:mp(d,h,g);break;case 3:case 4:var w=bc;bc=Wy(d.stateNode.containerInfo),mp(d,h,g),bc=w;break;case 22:d.memoizedState===null&&(w=d.alternate,w!==null&&w.memoizedState!==null?(w=yg,yg=16777216,mp(d,h,g),yg=w):mp(d,h,g));break;default:mp(d,h,g)}}function R8(d){var h=d.alternate;if(h!==null&&(d=h.child,d!==null)){h.child=null;do h=d.sibling,d.sibling=null,d=h;while(d!==null)}}function vg(d){var h=d.deletions;if((d.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];pa=w,B8(w,d)}R8(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)D8(d),d=d.sibling}function D8(d){switch(d.tag){case 0:case 11:case 15:vg(d),d.flags&2048&&gh(9,d,d.return);break;case 3:vg(d);break;case 12:vg(d);break;case 22:var h=d.stateNode;d.memoizedState!==null&&h._visibility&2&&(d.return===null||d.return.tag!==13)?(h._visibility&=-3,Oy(d)):vg(d);break;default:vg(d)}}function Oy(d){var h=d.deletions;if((d.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];pa=w,B8(w,d)}R8(d)}for(d=d.child;d!==null;){switch(h=d,h.tag){case 0:case 11:case 15:gh(8,h,h.return),Oy(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,Oy(h));break;default:Oy(h)}d=d.sibling}}function B8(d,h){for(;pa!==null;){var g=pa;switch(g.tag){case 0:case 11:case 15:gh(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var w=g.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Cf(g.memoizedState.cache)}if(w=g.child,w!==null)w.return=g,pa=w;else e:for(g=d;pa!==null;){w=pa;var E=w.sibling,D=w.return;if(A8(w),w===g){pa=null;break e}if(E!==null){E.return=D,pa=E;break e}pa=D}}}var HX={getCacheForType:function(d){var h=Xi(ri),g=h.data.get(d);return g===void 0&&(g=d(),h.data.set(d,g)),g},cacheSignal:function(){return Xi(ri).controller.signal}},WX=typeof WeakMap=="function"?WeakMap:Map,Wn=0,ys=null,an=null,hn=0,Zn=0,pl=null,xh=!1,gp=!1,k4=!1,ru=0,mi=0,bh=0,Mf=0,S4=0,ml=0,xp=0,wg=null,Xo=null,_4=!1,My=0,$8=0,Py=1/0,Iy=null,yh=null,Zi=0,vh=null,bp=null,nu=0,C4=0,A4=null,F8=null,jg=0,E4=null;function gl(){return(Wn&2)!==0&&hn!==0?hn&-hn:G.T!==null?I4():pr()}function U8(){if(ml===0)if((hn&536870912)===0||sn){var d=jr;jr<<=1,(jr&3932160)===0&&(jr=262144),ml=d}else ml=536870912;return d=Ms.current,d!==null&&(d.flags|=32),ml}function Jo(d,h,g){(d===ys&&(Zn===2||Zn===9)||d.cancelPendingCommit!==null)&&(yp(d,0),wh(d,hn,ml,!1)),He(d,g),((Wn&2)===0||d!==ys)&&(d===ys&&((Wn&2)===0&&(Mf|=g),mi===4&&wh(d,hn,ml,!1)),od(d))}function z8(d,h,g){if((Wn&6)!==0)throw Error(n(327));var w=!g&&(h&127)===0&&(h&d.expiredLanes)===0||Be(d,h),E=w?YX(d,h):L4(d,h,!0),D=w;do{if(E===0){gp&&!w&&wh(d,h,0,!1);break}else{if(g=d.current.alternate,D&&!GX(g)){E=L4(d,h,!1),D=!1;continue}if(E===2){if(D=h,d.errorRecoveryDisabledLanes&D)var re=0;else re=d.pendingLanes&-536870913,re=re!==0?re:re&536870912?536870912:0;if(re!==0){h=re;e:{var fe=d;E=wg;var Oe=fe.current.memoizedState.isDehydrated;if(Oe&&(yp(fe,re).flags|=256),re=L4(fe,re,!1),re!==2){if(k4&&!Oe){fe.errorRecoveryDisabledLanes|=D,Mf|=D,E=4;break e}D=Xo,Xo=E,D!==null&&(Xo===null?Xo=D:Xo.push.apply(Xo,D))}E=re}if(D=!1,E!==2)continue}}if(E===1){yp(d,0),wh(d,h,0,!0);break}e:{switch(w=d,D=E,D){case 0:case 1:throw Error(n(345));case 4:if((h&4194048)!==h)break;case 6:wh(w,h,ml,!xh);break e;case 2:Xo=null;break;case 3:case 5:break;default:throw Error(n(329))}if((h&62914560)===h&&(E=My+300-Pe(),10<E)){if(wh(w,h,ml,!xh),Yt(w,0,!0)!==0)break e;nu=h,w.timeoutHandle=yT(q8.bind(null,w,g,Xo,Iy,_4,h,ml,Mf,xp,xh,D,"Throttled",-0,0),E);break e}q8(w,g,Xo,Iy,_4,h,ml,Mf,xp,xh,D,null,-0,0)}}break}while(!0);od(d)}function q8(d,h,g,w,E,D,re,fe,Oe,tt,gt,jt,it,ut){if(d.timeoutHandle=-1,jt=h.subtreeFlags,jt&8192||(jt&16785408)===16785408){jt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Li},I8(h,D,jt);var sr=(D&62914560)===D?My-Pe():(D&4194048)===D?$8-Pe():0;if(sr=TJ(jt,sr),sr!==null){nu=D,d.cancelPendingCommit=sr(J8.bind(null,d,h,D,g,w,E,re,fe,Oe,gt,jt,null,it,ut)),wh(d,D,re,!tt);return}}J8(d,h,D,g,w,E,re,fe,Oe)}function GX(d){for(var h=d;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var w=0;w<g.length;w++){var E=g[w],D=E.getSnapshot;E=E.value;try{if(!Gi(D(),E))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function wh(d,h,g,w){h&=~S4,h&=~Mf,d.suspendedLanes|=h,d.pingedLanes&=~h,w&&(d.warmLanes|=h),w=d.expirationTimes;for(var E=h;0<E;){var D=31-$t(E),re=1<<D;w[D]=-1,E&=~re}g!==0&&Gt(d,g,h)}function Ry(){return(Wn&6)===0?(Ng(0),!1):!0}function T4(){if(an!==null){if(Zn===0)var d=an.return;else d=an,Il=Zc=null,op(d),St=null,ar=0,d=an;for(;d!==null;)v8(d.alternate,d),d=d.return;an=null}}function yp(d,h){var g=d.timeoutHandle;g!==-1&&(d.timeoutHandle=-1,hJ(g)),g=d.cancelPendingCommit,g!==null&&(d.cancelPendingCommit=null,g()),nu=0,T4(),ys=d,an=g=$o(d.current,null),hn=h,Zn=0,pl=null,xh=!1,gp=Be(d,h),k4=!1,xp=ml=S4=Mf=bh=mi=0,Xo=wg=null,_4=!1,(h&8)!==0&&(h|=h&32);var w=d.entangledLanes;if(w!==0)for(d=d.entanglements,w&=h;0<w;){var E=31-$t(w),D=1<<E;h|=d[E],w&=~D}return ru=h,wf(),g}function H8(d,h){vr=null,G.H=fg,h===Ie||h===Se?(h=yt(),Zn=3):h===Qe?(h=yt(),Zn=4):Zn=h===l4?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,pl=h,an===null&&(mi=1,Sy(d,Fo(h,d.current)))}function W8(){var d=Ms.current;return d===null?!0:(hn&4194048)===hn?Sn===null:(hn&62914560)===hn||(hn&536870912)!==0?d===Sn:!1}function G8(){var d=G.H;return G.H=fg,d===null?fg:d}function V8(){var d=G.A;return G.A=HX,d}function Dy(){mi=4,xh||(hn&4194048)!==hn&&Ms.current!==null||(gp=!0),(bh&134217727)===0&&(Mf&134217727)===0||ys===null||wh(ys,hn,ml,!1)}function L4(d,h,g){var w=Wn;Wn|=2;var E=G8(),D=V8();(ys!==d||hn!==h)&&(Iy=null,yp(d,h)),h=!1;var re=mi;e:do try{if(Zn!==0&&an!==null){var fe=an,Oe=pl;switch(Zn){case 8:T4(),re=6;break e;case 3:case 2:case 9:case 6:Ms.current===null&&(h=!0);var tt=Zn;if(Zn=0,pl=null,vp(d,fe,Oe,tt),g&&gp){re=0;break e}break;default:tt=Zn,Zn=0,pl=null,vp(d,fe,Oe,tt)}}VX(),re=mi;break}catch(gt){H8(d,gt)}while(!0);return h&&d.shellSuspendCounter++,Il=Zc=null,Wn=w,G.H=E,G.A=D,an===null&&(ys=null,hn=0,wf()),re}function VX(){for(;an!==null;)Y8(an)}function YX(d,h){var g=Wn;Wn|=2;var w=G8(),E=V8();ys!==d||hn!==h?(Iy=null,Py=Pe()+500,yp(d,h)):gp=Be(d,h);e:do try{if(Zn!==0&&an!==null){h=an;var D=pl;t:switch(Zn){case 1:Zn=0,pl=null,vp(d,h,D,1);break;case 2:case 9:if(Ye(D)){Zn=0,pl=null,K8(h);break}h=function(){Zn!==2&&Zn!==9||ys!==d||(Zn=7),od(d)},D.then(h,h);break e;case 3:Zn=7;break e;case 4:Zn=5;break e;case 7:Ye(D)?(Zn=0,pl=null,K8(h)):(Zn=0,pl=null,vp(d,h,D,7));break;case 5:var re=null;switch(an.tag){case 26:re=an.memoizedState;case 5:case 27:var fe=an;if(re?PT(re):fe.stateNode.complete){Zn=0,pl=null;var Oe=fe.sibling;if(Oe!==null)an=Oe;else{var tt=fe.return;tt!==null?(an=tt,By(tt)):an=null}break t}}Zn=0,pl=null,vp(d,h,D,5);break;case 6:Zn=0,pl=null,vp(d,h,D,6);break;case 8:T4(),mi=6;break e;default:throw Error(n(462))}}KX();break}catch(gt){H8(d,gt)}while(!0);return Il=Zc=null,G.H=w,G.A=E,Wn=g,an!==null?0:(ys=null,hn=0,wf(),mi)}function KX(){for(;an!==null&&!xt();)Y8(an)}function Y8(d){var h=b8(d.alternate,d,ru);d.memoizedProps=d.pendingProps,h===null?By(d):an=h}function K8(d){var h=d,g=h.alternate;switch(h.tag){case 15:case 0:h=h8(g,h,h.pendingProps,h.type,void 0,hn);break;case 11:h=h8(g,h,h.pendingProps,h.type.render,h.ref,hn);break;case 5:op(h);default:v8(g,h),h=an=kf(h,ru),h=b8(g,h,ru)}d.memoizedProps=d.pendingProps,h===null?By(d):an=h}function vp(d,h,g,w){Il=Zc=null,op(h),St=null,ar=0;var E=h.return;try{if(DX(d,E,h,g,hn)){mi=1,Sy(d,Fo(g,d.current)),an=null;return}}catch(D){if(E!==null)throw an=E,D;mi=1,Sy(d,Fo(g,d.current)),an=null;return}h.flags&32768?(sn||w===1?d=!0:gp||(hn&536870912)!==0?d=!1:(xh=d=!0,(w===2||w===9||w===3||w===6)&&(w=Ms.current,w!==null&&w.tag===13&&(w.flags|=16384))),X8(h,d)):By(h)}function By(d){var h=d;do{if((h.flags&32768)!==0){X8(h,xh);return}d=h.return;var g=FX(h.alternate,h,ru);if(g!==null){an=g;return}if(h=h.sibling,h!==null){an=h;return}an=h=d}while(h!==null);mi===0&&(mi=5)}function X8(d,h){do{var g=UX(d.alternate,d);if(g!==null){g.flags&=32767,an=g;return}if(g=d.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(d=d.sibling,d!==null)){an=d;return}an=d=g}while(d!==null);mi=6,an=null}function J8(d,h,g,w,E,D,re,fe,Oe){d.cancelPendingCommit=null;do $y();while(Zi!==0);if((Wn&6)!==0)throw Error(n(327));if(h!==null){if(h===d.current)throw Error(n(177));if(D=h.lanes|h.childLanes,D|=V0,Mt(d,g,D,re,fe,Oe),d===ys&&(an=ys=null,hn=0),bp=h,vh=d,nu=g,C4=D,A4=E,F8=w,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,QX(Ve,function(){return rT(),null})):(d.callbackNode=null,d.callbackPriority=0),w=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||w){w=G.T,G.T=null,E=ne.p,ne.p=2,re=Wn,Wn|=4;try{zX(d,h,g)}finally{Wn=re,ne.p=E,G.T=w}}Zi=1,Z8(),Q8(),eT()}}function Z8(){if(Zi===1){Zi=0;var d=vh,h=bp,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=G.T,G.T=null;var w=ne.p;ne.p=2;var E=Wn;Wn|=4;try{O8(h,d);var D=q4,re=dc(d.containerInfo),fe=D.focusedElem,Oe=D.selectionRange;if(re!==fe&&fe&&fe.ownerDocument&&cc(fe.ownerDocument.documentElement,fe)){if(Oe!==null&&Ml(fe)){var tt=Oe.start,gt=Oe.end;if(gt===void 0&&(gt=tt),"selectionStart"in fe)fe.selectionStart=tt,fe.selectionEnd=Math.min(gt,fe.value.length);else{var jt=fe.ownerDocument||document,it=jt&&jt.defaultView||window;if(it.getSelection){var ut=it.getSelection(),sr=fe.textContent.length,Tr=Math.min(Oe.start,sr),hs=Oe.end===void 0?Tr:Math.min(Oe.end,sr);!ut.extend&&Tr>hs&&(re=hs,hs=Tr,Tr=re);var We=ih(fe,Tr),Re=ih(fe,hs);if(We&&Re&&(ut.rangeCount!==1||ut.anchorNode!==We.node||ut.anchorOffset!==We.offset||ut.focusNode!==Re.node||ut.focusOffset!==Re.offset)){var et=jt.createRange();et.setStart(We.node,We.offset),ut.removeAllRanges(),Tr>hs?(ut.addRange(et),ut.extend(Re.node,Re.offset)):(et.setEnd(Re.node,Re.offset),ut.addRange(et))}}}}for(jt=[],ut=fe;ut=ut.parentNode;)ut.nodeType===1&&jt.push({element:ut,left:ut.scrollLeft,top:ut.scrollTop});for(typeof fe.focus=="function"&&fe.focus(),fe=0;fe<jt.length;fe++){var vt=jt[fe];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Jy=!!z4,q4=z4=null}finally{Wn=E,ne.p=w,G.T=g}}d.current=h,Zi=2}}function Q8(){if(Zi===2){Zi=0;var d=vh,h=bp,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=G.T,G.T=null;var w=ne.p;ne.p=2;var E=Wn;Wn|=4;try{C8(d,h.alternate,h)}finally{Wn=E,ne.p=w,G.T=g}}Zi=3}}function eT(){if(Zi===4||Zi===3){Zi=0,Ae();var d=vh,h=bp,g=nu,w=F8;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Zi=5:(Zi=0,bp=vh=null,tT(d,d.pendingLanes));var E=d.pendingLanes;if(E===0&&(yh=null),Vt(g),h=h.stateNode,Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(zt,h,void 0,(h.current.flags&128)===128)}catch{}if(w!==null){h=G.T,E=ne.p,ne.p=2,G.T=null;try{for(var D=d.onRecoverableError,re=0;re<w.length;re++){var fe=w[re];D(fe.value,{componentStack:fe.stack})}}finally{G.T=h,ne.p=E}}(nu&3)!==0&&$y(),od(d),E=d.pendingLanes,(g&261930)!==0&&(E&42)!==0?d===E4?jg++:(jg=0,E4=d):jg=0,Ng(0)}}function tT(d,h){(d.pooledCacheLanes&=h)===0&&(h=d.pooledCache,h!=null&&(d.pooledCache=null,Cf(h)))}function $y(){return Z8(),Q8(),eT(),rT()}function rT(){if(Zi!==5)return!1;var d=vh,h=C4;C4=0;var g=Vt(nu),w=G.T,E=ne.p;try{ne.p=32>g?32:g,G.T=null,g=A4,A4=null;var D=vh,re=nu;if(Zi=0,bp=vh=null,nu=0,(Wn&6)!==0)throw Error(n(331));var fe=Wn;if(Wn|=4,D8(D.current),P8(D,D.current,re,g),Wn=fe,Ng(0,!1),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(zt,D)}catch{}return!0}finally{ne.p=E,G.T=w,tT(d,h)}}function nT(d,h,g){h=Fo(g,h),h=o4(d.stateNode,h,2),d=Wr(d,h,2),d!==null&&(He(d,2),od(d))}function Qn(d,h,g){if(d.tag===3)nT(d,d,g);else for(;h!==null;){if(h.tag===3){nT(h,d,g);break}else if(h.tag===1){var w=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(yh===null||!yh.has(w))){d=Fo(g,d),g=s8(2),w=Wr(h,g,2),w!==null&&(i8(g,w,h,d),He(w,2),od(w));break}}h=h.return}}function O4(d,h,g){var w=d.pingCache;if(w===null){w=d.pingCache=new WX;var E=new Set;w.set(h,E)}else E=w.get(h),E===void 0&&(E=new Set,w.set(h,E));E.has(g)||(k4=!0,E.add(g),d=XX.bind(null,d,h,g),h.then(d,d))}function XX(d,h,g){var w=d.pingCache;w!==null&&w.delete(h),d.pingedLanes|=d.suspendedLanes&g,d.warmLanes&=~g,ys===d&&(hn&g)===g&&(mi===4||mi===3&&(hn&62914560)===hn&&300>Pe()-My?(Wn&2)===0&&yp(d,0):S4|=g,xp===hn&&(xp=0)),od(d)}function sT(d,h){h===0&&(h=Ft()),d=hc(d,h),d!==null&&(He(d,h),od(d))}function JX(d){var h=d.memoizedState,g=0;h!==null&&(g=h.retryLane),sT(d,g)}function ZX(d,h){var g=0;switch(d.tag){case 31:case 13:var w=d.stateNode,E=d.memoizedState;E!==null&&(g=E.retryLane);break;case 19:w=d.stateNode;break;case 22:w=d.stateNode._retryCache;break;default:throw Error(n(314))}w!==null&&w.delete(h),sT(d,g)}function QX(d,h){return Ge(d,h)}var Fy=null,wp=null,M4=!1,Uy=!1,P4=!1,jh=0;function od(d){d!==wp&&d.next===null&&(wp===null?Fy=wp=d:wp=wp.next=d),Uy=!0,M4||(M4=!0,tJ())}function Ng(d,h){if(!P4&&Uy){P4=!0;do for(var g=!1,w=Fy;w!==null;){if(d!==0){var E=w.pendingLanes;if(E===0)var D=0;else{var re=w.suspendedLanes,fe=w.pingedLanes;D=(1<<31-$t(42|d)+1)-1,D&=E&~(re&~fe),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(g=!0,lT(w,D))}else D=hn,D=Yt(w,w===ys?D:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(D&3)===0||Be(w,D)||(g=!0,lT(w,D));w=w.next}while(g);P4=!1}}function eJ(){iT()}function iT(){Uy=M4=!1;var d=0;jh!==0&&uJ()&&(d=jh);for(var h=Pe(),g=null,w=Fy;w!==null;){var E=w.next,D=aT(w,h);D===0?(w.next=null,g===null?Fy=E:g.next=E,E===null&&(wp=g)):(g=w,(d!==0||(D&3)!==0)&&(Uy=!0)),w=E}Zi!==0&&Zi!==5||Ng(d),jh!==0&&(jh=0)}function aT(d,h){for(var g=d.suspendedLanes,w=d.pingedLanes,E=d.expirationTimes,D=d.pendingLanes&-62914561;0<D;){var re=31-$t(D),fe=1<<re,Oe=E[re];Oe===-1?((fe&g)===0||(fe&w)!==0)&&(E[re]=Lt(fe,h)):Oe<=h&&(d.expiredLanes|=fe),D&=~fe}if(h=ys,g=hn,g=Yt(d,d===h?g:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),w=d.callbackNode,g===0||d===h&&(Zn===2||Zn===9)||d.cancelPendingCommit!==null)return w!==null&&w!==null&&Xe(w),d.callbackNode=null,d.callbackPriority=0;if((g&3)===0||Be(d,g)){if(h=g&-g,h===d.callbackPriority)return h;switch(w!==null&&Xe(w),Vt(g)){case 2:case 8:g=dt;break;case 32:g=Ve;break;case 268435456:g=kt;break;default:g=Ve}return w=oT.bind(null,d),g=Ge(g,w),d.callbackPriority=h,d.callbackNode=g,h}return w!==null&&w!==null&&Xe(w),d.callbackPriority=2,d.callbackNode=null,2}function oT(d,h){if(Zi!==0&&Zi!==5)return d.callbackNode=null,d.callbackPriority=0,null;var g=d.callbackNode;if($y()&&d.callbackNode!==g)return null;var w=hn;return w=Yt(d,d===ys?w:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),w===0?null:(z8(d,w,h),aT(d,Pe()),d.callbackNode!=null&&d.callbackNode===g?oT.bind(null,d):null)}function lT(d,h){if($y())return null;z8(d,h,!0)}function tJ(){fJ(function(){(Wn&6)!==0?Ge(bt,eJ):iT()})}function I4(){if(jh===0){var d=S;d===0&&(d=Ht,Ht<<=1,(Ht&261888)===0&&(Ht=256)),jh=d}return jh}function cT(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:li(""+d)}function dT(d,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,d.id&&g.setAttribute("form",d.id),h.parentNode.insertBefore(g,h),d=new FormData(d),g.parentNode.removeChild(g),d}function rJ(d,h,g,w,E){if(h==="submit"&&g&&g.stateNode===E){var D=cT((E[Qr]||null).action),re=w.submitter;re&&(h=(h=re[Qr]||null)?cT(h.formAction):re.getAttribute("formAction"),h!==null&&(D=h,re=null));var fe=new Kt("action","action",null,w,E);d.push({event:fe,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(jh!==0){var Oe=re?dT(E,re):new FormData(E);t4(g,{pending:!0,data:Oe,method:E.method,action:D},null,Oe)}}else typeof D=="function"&&(fe.preventDefault(),Oe=re?dT(E,re):new FormData(E),t4(g,{pending:!0,data:Oe,method:E.method,action:D},D,Oe))},currentTarget:E}]})}}for(var R4=0;R4<zd.length;R4++){var D4=zd[R4],nJ=D4.toLowerCase(),sJ=D4[0].toUpperCase()+D4.slice(1);Bo(nJ,"on"+sJ)}Bo(Ud,"onAnimationEnd"),Bo(yf,"onAnimationIteration"),Bo(Zm,"onAnimationStart"),Bo("dblclick","onDoubleClick"),Bo("focusin","onFocus"),Bo("focusout","onBlur"),Bo(hy,"onTransitionRun"),Bo(fy,"onTransitionStart"),Bo(py,"onTransitionCancel"),Bo(Qm,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),Mn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iJ=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kg));function uT(d,h){h=(h&4)!==0;for(var g=0;g<d.length;g++){var w=d[g],E=w.event;w=w.listeners;e:{var D=void 0;if(h)for(var re=w.length-1;0<=re;re--){var fe=w[re],Oe=fe.instance,tt=fe.currentTarget;if(fe=fe.listener,Oe!==D&&E.isPropagationStopped())break e;D=fe,E.currentTarget=tt;try{D(E)}catch(gt){vf(gt)}E.currentTarget=null,D=Oe}else for(re=0;re<w.length;re++){if(fe=w[re],Oe=fe.instance,tt=fe.currentTarget,fe=fe.listener,Oe!==D&&E.isPropagationStopped())break e;D=fe,E.currentTarget=tt;try{D(E)}catch(gt){vf(gt)}E.currentTarget=null,D=Oe}}}}function on(d,h){var g=h[Hr];g===void 0&&(g=h[Hr]=new Set);var w=d+"__bubble";g.has(w)||(hT(h,d,2,!1),g.add(w))}function B4(d,h,g){var w=0;h&&(w|=4),hT(g,d,w,h)}var zy="_reactListening"+Math.random().toString(36).slice(2);function $4(d){if(!d[zy]){d[zy]=!0,yr.forEach(function(g){g!=="selectionchange"&&(iJ.has(g)||B4(g,!1,d),B4(g,!0,d))});var h=d.nodeType===9?d:d.ownerDocument;h===null||h[zy]||(h[zy]=!0,B4("selectionchange",!1,h))}}function hT(d,h,g,w){switch(UT(h)){case 2:var E=MJ;break;case 8:E=PJ;break;default:E=ej}g=E.bind(null,h,g,d),E=void 0,!Xa||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(E=!0),w?E!==void 0?d.addEventListener(h,g,{capture:!0,passive:E}):d.addEventListener(h,g,!0):E!==void 0?d.addEventListener(h,g,{passive:E}):d.addEventListener(h,g,!1)}function F4(d,h,g,w,E){var D=w;if((h&1)===0&&(h&2)===0&&w!==null)e:for(;;){if(w===null)return;var re=w.tag;if(re===3||re===4){var fe=w.stateNode.containerInfo;if(fe===E)break;if(re===4)for(re=w.return;re!==null;){var Oe=re.tag;if((Oe===3||Oe===4)&&re.stateNode.containerInfo===E)return;re=re.return}for(;fe!==null;){if(re=jn(fe),re===null)return;if(Oe=re.tag,Oe===5||Oe===6||Oe===26||Oe===27){w=D=re;continue e}fe=fe.parentNode}}w=w.return}Ka(function(){var tt=D,gt=Qs(g),jt=[];e:{var it=eg.get(d);if(it!==void 0){var ut=Kt,sr=d;switch(d){case"keypress":if(K(g)===0)break e;case"keydown":case"keyup":ut=tn;break;case"focusin":sr="focus",ut=Ts;break;case"focusout":sr="blur",ut=Ts;break;case"beforeblur":case"afterblur":ut=Ts;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=Vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=ie;break;case Ud:case yf:case Zm:ut=z;break;case Qm:ut=qe;break;case"scroll":case"scrollend":ut=Dr;break;case"wheel":ut=Dt;break;case"copy":case"cut":case"paste":ut=ke;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=_;break;case"toggle":case"beforetoggle":ut=gs}var Tr=(h&4)!==0,hs=!Tr&&(d==="scroll"||d==="scrollend"),We=Tr?it!==null?it+"Capture":null:it;Tr=[];for(var Re=tt,et;Re!==null;){var vt=Re;if(et=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||et===null||We===null||(vt=Ns(Re,We),vt!=null&&Tr.push(Sg(Re,vt,et))),hs)break;Re=Re.return}0<Tr.length&&(it=new ut(it,sr,null,g,gt),jt.push({event:it,listeners:Tr}))}}if((h&7)===0){e:{if(it=d==="mouseover"||d==="pointerover",ut=d==="mouseout"||d==="pointerout",it&&g!==Kn&&(sr=g.relatedTarget||g.fromElement)&&(jn(sr)||sr[pn]))break e;if((ut||it)&&(it=gt.window===gt?gt:(it=gt.ownerDocument)?it.defaultView||it.parentWindow:window,ut?(sr=g.relatedTarget||g.toElement,ut=tt,sr=sr?jn(sr):null,sr!==null&&(hs=a(sr),Tr=sr.tag,sr!==hs||Tr!==5&&Tr!==27&&Tr!==6)&&(sr=null)):(ut=null,sr=tt),ut!==sr)){if(Tr=Vn,vt="onMouseLeave",We="onMouseEnter",Re="mouse",(d==="pointerout"||d==="pointerover")&&(Tr=_,vt="onPointerLeave",We="onPointerEnter",Re="pointer"),hs=ut==null?it:rt(ut),et=sr==null?it:rt(sr),it=new Tr(vt,Re+"leave",ut,g,gt),it.target=hs,it.relatedTarget=et,vt=null,jn(gt)===tt&&(Tr=new Tr(We,Re+"enter",sr,g,gt),Tr.target=et,Tr.relatedTarget=hs,vt=Tr),hs=vt,ut&&sr)t:{for(Tr=aJ,We=ut,Re=sr,et=0,vt=We;vt;vt=Tr(vt))et++;vt=0;for(var kr=Re;kr;kr=Tr(kr))vt++;for(;0<et-vt;)We=Tr(We),et--;for(;0<vt-et;)Re=Tr(Re),vt--;for(;et--;){if(We===Re||Re!==null&&We===Re.alternate){Tr=We;break t}We=Tr(We),Re=Tr(Re)}Tr=null}else Tr=null;ut!==null&&fT(jt,it,ut,Tr,!1),sr!==null&&hs!==null&&fT(jt,hs,sr,Tr,!0)}}e:{if(it=tt?rt(tt):window,ut=it.nodeName&&it.nodeName.toLowerCase(),ut==="select"||ut==="input"&&it.type==="file")var Rn=Yc;else if(xf(it))if(Ja)Rn=Ll;else{Rn=ei;var ur=nh}else ut=it.nodeName,!ut||ut.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?tt&&Po(tt.elementType)&&(Rn=Yc):Rn=G0;if(Rn&&(Rn=Rn(d,tt))){uo(jt,Rn,g,gt);break e}ur&&ur(d,it,tt),d==="focusout"&&tt&&it.type==="number"&&tt.memoizedProps.value!=null&&ol(it,"number",it.value)}switch(ur=tt?rt(tt):window,d){case"focusin":(xf(ur)||ur.contentEditable==="true")&&(ho=ur,uc=tt,ca=null);break;case"focusout":ca=uc=ho=null;break;case"mousedown":Do=!0;break;case"contextmenu":case"mouseup":case"dragend":Do=!1,Ln(jt,g,gt);break;case"selectionchange":if(Fd)break;case"keydown":case"keyup":Ln(jt,g,gt)}var Xr;if(zn)e:{switch(d){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else Al?Ro(d,g)&&(fn="onCompositionEnd"):d==="keydown"&&g.keyCode===229&&(fn="onCompositionStart");fn&&(Oi&&g.locale!=="ko"&&(Al||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&Al&&(Xr=cl()):(ci=gt,Oa="value"in ci?ci.value:ci.textContent,Al=!0)),ur=qy(tt,fn),0<ur.length&&(fn=new Fe(fn,d,null,g,gt),jt.push({event:fn,listeners:ur}),Xr?fn.data=Xr:(Xr=eh(g),Xr!==null&&(fn.data=Xr)))),(Xr=Ma?Pa(d,g):ic(d,g))&&(fn=qy(tt,"onBeforeInput"),0<fn.length&&(ur=new Fe("onBeforeInput","beforeinput",null,g,gt),jt.push({event:ur,listeners:fn}),ur.data=Xr)),rJ(jt,d,tt,g,gt)}uT(jt,h)})}function Sg(d,h,g){return{instance:d,listener:h,currentTarget:g}}function qy(d,h){for(var g=h+"Capture",w=[];d!==null;){var E=d,D=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||D===null||(E=Ns(d,g),E!=null&&w.unshift(Sg(d,E,D)),E=Ns(d,h),E!=null&&w.push(Sg(d,E,D))),d.tag===3)return w;d=d.return}return[]}function aJ(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function fT(d,h,g,w,E){for(var D=h._reactName,re=[];g!==null&&g!==w;){var fe=g,Oe=fe.alternate,tt=fe.stateNode;if(fe=fe.tag,Oe!==null&&Oe===w)break;fe!==5&&fe!==26&&fe!==27||tt===null||(Oe=tt,E?(tt=Ns(g,D),tt!=null&&re.unshift(Sg(g,tt,Oe))):E||(tt=Ns(g,D),tt!=null&&re.push(Sg(g,tt,Oe)))),g=g.return}re.length!==0&&d.push({event:h,listeners:re})}var oJ=/\r\n?/g,lJ=/\u0000|\uFFFD/g;function pT(d){return(typeof d=="string"?d:""+d).replace(oJ,`
`).replace(lJ,"")}function mT(d,h){return h=pT(h),pT(d)===h}function us(d,h,g,w,E,D){switch(g){case"children":typeof w=="string"?h==="body"||h==="textarea"&&w===""||Un(d,w):(typeof w=="number"||typeof w=="bigint")&&h!=="body"&&Un(d,""+w);break;case"className":Fs(d,"class",w);break;case"tabIndex":Fs(d,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":Fs(d,g,w);break;case"style":Ti(d,w,D);break;case"data":if(h!=="object"){Fs(d,"data",w);break}case"src":case"href":if(w===""&&(h!=="a"||g!=="href")){d.removeAttribute(g);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){d.removeAttribute(g);break}w=li(""+w),d.setAttribute(g,w);break;case"action":case"formAction":if(typeof w=="function"){d.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(g==="formAction"?(h!=="input"&&us(d,h,"name",E.name,E,null),us(d,h,"formEncType",E.formEncType,E,null),us(d,h,"formMethod",E.formMethod,E,null),us(d,h,"formTarget",E.formTarget,E,null)):(us(d,h,"encType",E.encType,E,null),us(d,h,"method",E.method,E,null),us(d,h,"target",E.target,E,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){d.removeAttribute(g);break}w=li(""+w),d.setAttribute(g,w);break;case"onClick":w!=null&&(d.onclick=Li);break;case"onScroll":w!=null&&on("scroll",d);break;case"onScrollEnd":w!=null&&on("scrollend",d);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(n(61));if(g=w.__html,g!=null){if(E.children!=null)throw Error(n(60));d.innerHTML=g}}break;case"multiple":d.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":d.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){d.removeAttribute("xlink:href");break}g=li(""+w),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,""+w):d.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,""):d.removeAttribute(g);break;case"capture":case"download":w===!0?d.setAttribute(g,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,w):d.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?d.setAttribute(g,w):d.removeAttribute(g);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?d.removeAttribute(g):d.setAttribute(g,w);break;case"popover":on("beforetoggle",d),on("toggle",d),ji(d,"popover",w);break;case"xlinkActuate":is(d,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":is(d,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":is(d,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":is(d,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":is(d,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":is(d,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":is(d,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":is(d,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":is(d,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":ji(d,"is",w);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=Io.get(g)||g,ji(d,g,w))}}function U4(d,h,g,w,E,D){switch(g){case"style":Ti(d,w,D);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(n(61));if(g=w.__html,g!=null){if(E.children!=null)throw Error(n(60));d.innerHTML=g}}break;case"children":typeof w=="string"?Un(d,w):(typeof w=="number"||typeof w=="bigint")&&Un(d,""+w);break;case"onScroll":w!=null&&on("scroll",d);break;case"onScrollEnd":w!=null&&on("scrollend",d);break;case"onClick":w!=null&&(d.onclick=Li);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fr.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(E=g.endsWith("Capture"),h=g.slice(2,E?g.length-7:void 0),D=d[Qr]||null,D=D!=null?D[g]:null,typeof D=="function"&&d.removeEventListener(h,D,E),typeof w=="function")){typeof D!="function"&&D!==null&&(g in d?d[g]=null:d.hasAttribute(g)&&d.removeAttribute(g)),d.addEventListener(h,w,E);break e}g in d?d[g]=w:w===!0?d.setAttribute(g,""):ji(d,g,w)}}}function $a(d,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":on("error",d),on("load",d);var w=!1,E=!1,D;for(D in g)if(g.hasOwnProperty(D)){var re=g[D];if(re!=null)switch(D){case"src":w=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:us(d,h,D,re,g,null)}}E&&us(d,h,"srcSet",g.srcSet,g,null),w&&us(d,h,"src",g.src,g,null);return;case"input":on("invalid",d);var fe=D=re=E=null,Oe=null,tt=null;for(w in g)if(g.hasOwnProperty(w)){var gt=g[w];if(gt!=null)switch(w){case"name":E=gt;break;case"type":re=gt;break;case"checked":Oe=gt;break;case"defaultChecked":tt=gt;break;case"value":D=gt;break;case"defaultValue":fe=gt;break;case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(n(137,h));break;default:us(d,h,w,gt,g,null)}}Mo(d,D,fe,Oe,tt,re,E,!1);return;case"select":on("invalid",d),w=re=D=null;for(E in g)if(g.hasOwnProperty(E)&&(fe=g[E],fe!=null))switch(E){case"value":D=fe;break;case"defaultValue":re=fe;break;case"multiple":w=fe;default:us(d,h,E,fe,g,null)}h=D,g=re,d.multiple=!!w,h!=null?Zs(d,!!w,h,!1):g!=null&&Zs(d,!!w,g,!0);return;case"textarea":on("invalid",d),D=E=w=null;for(re in g)if(g.hasOwnProperty(re)&&(fe=g[re],fe!=null))switch(re){case"value":w=fe;break;case"defaultValue":E=fe;break;case"children":D=fe;break;case"dangerouslySetInnerHTML":if(fe!=null)throw Error(n(91));break;default:us(d,h,re,fe,g,null)}Es(d,w,E,D);return;case"option":for(Oe in g)g.hasOwnProperty(Oe)&&(w=g[Oe],w!=null)&&(Oe==="selected"?d.selected=w&&typeof w!="function"&&typeof w!="symbol":us(d,h,Oe,w,g,null));return;case"dialog":on("beforetoggle",d),on("toggle",d),on("cancel",d),on("close",d);break;case"iframe":case"object":on("load",d);break;case"video":case"audio":for(w=0;w<kg.length;w++)on(kg[w],d);break;case"image":on("error",d),on("load",d);break;case"details":on("toggle",d);break;case"embed":case"source":case"link":on("error",d),on("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(tt in g)if(g.hasOwnProperty(tt)&&(w=g[tt],w!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:us(d,h,tt,w,g,null)}return;default:if(Po(h)){for(gt in g)g.hasOwnProperty(gt)&&(w=g[gt],w!==void 0&&U4(d,h,gt,w,g,void 0));return}}for(fe in g)g.hasOwnProperty(fe)&&(w=g[fe],w!=null&&us(d,h,fe,w,g,null))}function cJ(d,h,g,w){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,D=null,re=null,fe=null,Oe=null,tt=null,gt=null;for(ut in g){var jt=g[ut];if(g.hasOwnProperty(ut)&&jt!=null)switch(ut){case"checked":break;case"value":break;case"defaultValue":Oe=jt;default:w.hasOwnProperty(ut)||us(d,h,ut,null,w,jt)}}for(var it in w){var ut=w[it];if(jt=g[it],w.hasOwnProperty(it)&&(ut!=null||jt!=null))switch(it){case"type":D=ut;break;case"name":E=ut;break;case"checked":tt=ut;break;case"defaultChecked":gt=ut;break;case"value":re=ut;break;case"defaultValue":fe=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(n(137,h));break;default:ut!==jt&&us(d,h,it,ut,w,jt)}}lo(d,re,fe,Oe,tt,gt,D,E);return;case"select":ut=re=fe=it=null;for(D in g)if(Oe=g[D],g.hasOwnProperty(D)&&Oe!=null)switch(D){case"value":break;case"multiple":ut=Oe;default:w.hasOwnProperty(D)||us(d,h,D,null,w,Oe)}for(E in w)if(D=w[E],Oe=g[E],w.hasOwnProperty(E)&&(D!=null||Oe!=null))switch(E){case"value":it=D;break;case"defaultValue":fe=D;break;case"multiple":re=D;default:D!==Oe&&us(d,h,E,D,w,Oe)}h=fe,g=re,w=ut,it!=null?Zs(d,!!g,it,!1):!!w!=!!g&&(h!=null?Zs(d,!!g,h,!0):Zs(d,!!g,g?[]:"",!1));return;case"textarea":ut=it=null;for(fe in g)if(E=g[fe],g.hasOwnProperty(fe)&&E!=null&&!w.hasOwnProperty(fe))switch(fe){case"value":break;case"children":break;default:us(d,h,fe,null,w,E)}for(re in w)if(E=w[re],D=g[re],w.hasOwnProperty(re)&&(E!=null||D!=null))switch(re){case"value":it=E;break;case"defaultValue":ut=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==D&&us(d,h,re,E,w,D)}Ca(d,it,ut);return;case"option":for(var sr in g)it=g[sr],g.hasOwnProperty(sr)&&it!=null&&!w.hasOwnProperty(sr)&&(sr==="selected"?d.selected=!1:us(d,h,sr,null,w,it));for(Oe in w)it=w[Oe],ut=g[Oe],w.hasOwnProperty(Oe)&&it!==ut&&(it!=null||ut!=null)&&(Oe==="selected"?d.selected=it&&typeof it!="function"&&typeof it!="symbol":us(d,h,Oe,it,w,ut));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Tr in g)it=g[Tr],g.hasOwnProperty(Tr)&&it!=null&&!w.hasOwnProperty(Tr)&&us(d,h,Tr,null,w,it);for(tt in w)if(it=w[tt],ut=g[tt],w.hasOwnProperty(tt)&&it!==ut&&(it!=null||ut!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,h));break;default:us(d,h,tt,it,w,ut)}return;default:if(Po(h)){for(var hs in g)it=g[hs],g.hasOwnProperty(hs)&&it!==void 0&&!w.hasOwnProperty(hs)&&U4(d,h,hs,void 0,w,it);for(gt in w)it=w[gt],ut=g[gt],!w.hasOwnProperty(gt)||it===ut||it===void 0&&ut===void 0||U4(d,h,gt,it,w,ut);return}}for(var We in g)it=g[We],g.hasOwnProperty(We)&&it!=null&&!w.hasOwnProperty(We)&&us(d,h,We,null,w,it);for(jt in w)it=w[jt],ut=g[jt],!w.hasOwnProperty(jt)||it===ut||it==null&&ut==null||us(d,h,jt,it,w,ut)}function gT(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dJ(){if(typeof performance.getEntriesByType=="function"){for(var d=0,h=0,g=performance.getEntriesByType("resource"),w=0;w<g.length;w++){var E=g[w],D=E.transferSize,re=E.initiatorType,fe=E.duration;if(D&&fe&&gT(re)){for(re=0,fe=E.responseEnd,w+=1;w<g.length;w++){var Oe=g[w],tt=Oe.startTime;if(tt>fe)break;var gt=Oe.transferSize,jt=Oe.initiatorType;gt&&gT(jt)&&(Oe=Oe.responseEnd,re+=gt*(Oe<fe?1:(fe-tt)/(Oe-tt)))}if(--w,h+=8*(D+re)/(E.duration/1e3),d++,10<d)break}}if(0<d)return h/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var z4=null,q4=null;function Hy(d){return d.nodeType===9?d:d.ownerDocument}function xT(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bT(d,h){if(d===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&h==="foreignObject"?0:d}function H4(d,h){return d==="textarea"||d==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var W4=null;function uJ(){var d=window.event;return d&&d.type==="popstate"?d===W4?!1:(W4=d,!0):(W4=null,!1)}var yT=typeof setTimeout=="function"?setTimeout:void 0,hJ=typeof clearTimeout=="function"?clearTimeout:void 0,vT=typeof Promise=="function"?Promise:void 0,fJ=typeof queueMicrotask=="function"?queueMicrotask:typeof vT<"u"?function(d){return vT.resolve(null).then(d).catch(pJ)}:yT;function pJ(d){setTimeout(function(){throw d})}function Nh(d){return d==="head"}function wT(d,h){var g=h,w=0;do{var E=g.nextSibling;if(d.removeChild(g),E&&E.nodeType===8)if(g=E.data,g==="/$"||g==="/&"){if(w===0){d.removeChild(E),Sp(h);return}w--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")w++;else if(g==="html")_g(d.ownerDocument.documentElement);else if(g==="head"){g=d.ownerDocument.head,_g(g);for(var D=g.firstChild;D;){var re=D.nextSibling,fe=D.nodeName;D[$s]||fe==="SCRIPT"||fe==="STYLE"||fe==="LINK"&&D.rel.toLowerCase()==="stylesheet"||g.removeChild(D),D=re}}else g==="body"&&_g(d.ownerDocument.body);g=E}while(g);Sp(h)}function jT(d,h){var g=d;d=0;do{var w=g.nextSibling;if(g.nodeType===1?h?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(h?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),w&&w.nodeType===8)if(g=w.data,g==="/$"){if(d===0)break;d--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||d++;g=w}while(g)}function G4(d){var h=d.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":G4(g),zi(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}d.removeChild(g)}}function mJ(d,h,g,w){for(;d.nodeType===1;){var E=g;if(d.nodeName.toLowerCase()!==h.toLowerCase()){if(!w&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(w){if(!d[$s])switch(h){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(D=d.getAttribute("rel"),D==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(D!==E.rel||d.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||d.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||d.getAttribute("title")!==(E.title==null?null:E.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(D=d.getAttribute("src"),(D!==(E.src==null?null:E.src)||d.getAttribute("type")!==(E.type==null?null:E.type)||d.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&D&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(h==="input"&&d.type==="hidden"){var D=E.name==null?null:""+E.name;if(E.type==="hidden"&&d.getAttribute("name")===D)return d}else return d;if(d=Bl(d.nextSibling),d===null)break}return null}function gJ(d,h,g){if(h==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!g||(d=Bl(d.nextSibling),d===null))return null;return d}function NT(d,h){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!h||(d=Bl(d.nextSibling),d===null))return null;return d}function V4(d){return d.data==="$?"||d.data==="$~"}function Y4(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function xJ(d,h){var g=d.ownerDocument;if(d.data==="$~")d._reactRetry=h;else if(d.data!=="$?"||g.readyState!=="loading")h();else{var w=function(){h(),g.removeEventListener("DOMContentLoaded",w)};g.addEventListener("DOMContentLoaded",w),d._reactRetry=w}}function Bl(d){for(;d!=null;d=d.nextSibling){var h=d.nodeType;if(h===1||h===3)break;if(h===8){if(h=d.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return d}var K4=null;function kT(d){d=d.nextSibling;for(var h=0;d;){if(d.nodeType===8){var g=d.data;if(g==="/$"||g==="/&"){if(h===0)return Bl(d.nextSibling);h--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||h++}d=d.nextSibling}return null}function ST(d){d=d.previousSibling;for(var h=0;d;){if(d.nodeType===8){var g=d.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(h===0)return d;h--}else g!=="/$"&&g!=="/&"||h++}d=d.previousSibling}return null}function _T(d,h,g){switch(h=Hy(g),d){case"html":if(d=h.documentElement,!d)throw Error(n(452));return d;case"head":if(d=h.head,!d)throw Error(n(453));return d;case"body":if(d=h.body,!d)throw Error(n(454));return d;default:throw Error(n(451))}}function _g(d){for(var h=d.attributes;h.length;)d.removeAttributeNode(h[0]);zi(d)}var $l=new Map,CT=new Set;function Wy(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var su=ne.d;ne.d={f:bJ,r:yJ,D:vJ,C:wJ,L:jJ,m:NJ,X:SJ,S:kJ,M:_J};function bJ(){var d=su.f(),h=Ry();return d||h}function yJ(d){var h=ze(d);h!==null&&h.tag===5&&h.type==="form"?HE(h):su.r(d)}var jp=typeof document>"u"?null:document;function AT(d,h,g){var w=jp;if(w&&typeof h=="string"&&h){var E=as(h);E='link[rel="'+d+'"][href="'+E+'"]',typeof g=="string"&&(E+='[crossorigin="'+g+'"]'),CT.has(E)||(CT.add(E),d={rel:d,crossOrigin:g,href:h},w.querySelector(E)===null&&(h=w.createElement("link"),$a(h,"link",d),Rt(h),w.head.appendChild(h)))}}function vJ(d){su.D(d),AT("dns-prefetch",d,null)}function wJ(d,h){su.C(d,h),AT("preconnect",d,h)}function jJ(d,h,g){su.L(d,h,g);var w=jp;if(w&&d&&h){var E='link[rel="preload"][as="'+as(h)+'"]';h==="image"&&g&&g.imageSrcSet?(E+='[imagesrcset="'+as(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(E+='[imagesizes="'+as(g.imageSizes)+'"]')):E+='[href="'+as(d)+'"]';var D=E;switch(h){case"style":D=Np(d);break;case"script":D=kp(d)}$l.has(D)||(d=p({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:d,as:h},g),$l.set(D,d),w.querySelector(E)!==null||h==="style"&&w.querySelector(Cg(D))||h==="script"&&w.querySelector(Ag(D))||(h=w.createElement("link"),$a(h,"link",d),Rt(h),w.head.appendChild(h)))}}function NJ(d,h){su.m(d,h);var g=jp;if(g&&d){var w=h&&typeof h.as=="string"?h.as:"script",E='link[rel="modulepreload"][as="'+as(w)+'"][href="'+as(d)+'"]',D=E;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=kp(d)}if(!$l.has(D)&&(d=p({rel:"modulepreload",href:d},h),$l.set(D,d),g.querySelector(E)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Ag(D)))return}w=g.createElement("link"),$a(w,"link",d),Rt(w),g.head.appendChild(w)}}}function kJ(d,h,g){su.S(d,h,g);var w=jp;if(w&&d){var E=ht(w).hoistableStyles,D=Np(d);h=h||"default";var re=E.get(D);if(!re){var fe={loading:0,preload:null};if(re=w.querySelector(Cg(D)))fe.loading=5;else{d=p({rel:"stylesheet",href:d,"data-precedence":h},g),(g=$l.get(D))&&X4(d,g);var Oe=re=w.createElement("link");Rt(Oe),$a(Oe,"link",d),Oe._p=new Promise(function(tt,gt){Oe.onload=tt,Oe.onerror=gt}),Oe.addEventListener("load",function(){fe.loading|=1}),Oe.addEventListener("error",function(){fe.loading|=2}),fe.loading|=4,Gy(re,h,w)}re={type:"stylesheet",instance:re,count:1,state:fe},E.set(D,re)}}}function SJ(d,h){su.X(d,h);var g=jp;if(g&&d){var w=ht(g).hoistableScripts,E=kp(d),D=w.get(E);D||(D=g.querySelector(Ag(E)),D||(d=p({src:d,async:!0},h),(h=$l.get(E))&&J4(d,h),D=g.createElement("script"),Rt(D),$a(D,"link",d),g.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(E,D))}}function _J(d,h){su.M(d,h);var g=jp;if(g&&d){var w=ht(g).hoistableScripts,E=kp(d),D=w.get(E);D||(D=g.querySelector(Ag(E)),D||(d=p({src:d,async:!0,type:"module"},h),(h=$l.get(E))&&J4(d,h),D=g.createElement("script"),Rt(D),$a(D,"link",d),g.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(E,D))}}function ET(d,h,g,w){var E=(E=xe.current)?Wy(E):null;if(!E)throw Error(n(446));switch(d){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=Np(g.href),g=ht(E).hoistableStyles,w=g.get(h),w||(w={type:"style",instance:null,count:0,state:null},g.set(h,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){d=Np(g.href);var D=ht(E).hoistableStyles,re=D.get(d);if(re||(E=E.ownerDocument||E,re={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(d,re),(D=E.querySelector(Cg(d)))&&!D._p&&(re.instance=D,re.state.loading=5),$l.has(d)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},$l.set(d,g),D||CJ(E,d,g,re.state))),h&&w===null)throw Error(n(528,""));return re}if(h&&w!==null)throw Error(n(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=kp(g),g=ht(E).hoistableScripts,w=g.get(h),w||(w={type:"script",instance:null,count:0,state:null},g.set(h,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,d))}}function Np(d){return'href="'+as(d)+'"'}function Cg(d){return'link[rel="stylesheet"]['+d+"]"}function TT(d){return p({},d,{"data-precedence":d.precedence,precedence:null})}function CJ(d,h,g,w){d.querySelector('link[rel="preload"][as="style"]['+h+"]")?w.loading=1:(h=d.createElement("link"),w.preload=h,h.addEventListener("load",function(){return w.loading|=1}),h.addEventListener("error",function(){return w.loading|=2}),$a(h,"link",g),Rt(h),d.head.appendChild(h))}function kp(d){return'[src="'+as(d)+'"]'}function Ag(d){return"script[async]"+d}function LT(d,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var w=d.querySelector('style[data-href~="'+as(g.href)+'"]');if(w)return h.instance=w,Rt(w),w;var E=p({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return w=(d.ownerDocument||d).createElement("style"),Rt(w),$a(w,"style",E),Gy(w,g.precedence,d),h.instance=w;case"stylesheet":E=Np(g.href);var D=d.querySelector(Cg(E));if(D)return h.state.loading|=4,h.instance=D,Rt(D),D;w=TT(g),(E=$l.get(E))&&X4(w,E),D=(d.ownerDocument||d).createElement("link"),Rt(D);var re=D;return re._p=new Promise(function(fe,Oe){re.onload=fe,re.onerror=Oe}),$a(D,"link",w),h.state.loading|=4,Gy(D,g.precedence,d),h.instance=D;case"script":return D=kp(g.src),(E=d.querySelector(Ag(D)))?(h.instance=E,Rt(E),E):(w=g,(E=$l.get(D))&&(w=p({},g),J4(w,E)),d=d.ownerDocument||d,E=d.createElement("script"),Rt(E),$a(E,"link",w),d.head.appendChild(E),h.instance=E);case"void":return null;default:throw Error(n(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(w=h.instance,h.state.loading|=4,Gy(w,g.precedence,d));return h.instance}function Gy(d,h,g){for(var w=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=w.length?w[w.length-1]:null,D=E,re=0;re<w.length;re++){var fe=w[re];if(fe.dataset.precedence===h)D=fe;else if(D!==E)break}D?D.parentNode.insertBefore(d,D.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(d,h.firstChild))}function X4(d,h){d.crossOrigin==null&&(d.crossOrigin=h.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=h.referrerPolicy),d.title==null&&(d.title=h.title)}function J4(d,h){d.crossOrigin==null&&(d.crossOrigin=h.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=h.referrerPolicy),d.integrity==null&&(d.integrity=h.integrity)}var Vy=null;function OT(d,h,g){if(Vy===null){var w=new Map,E=Vy=new Map;E.set(g,w)}else E=Vy,w=E.get(g),w||(w=new Map,E.set(g,w));if(w.has(d))return w;for(w.set(d,null),g=g.getElementsByTagName(d),E=0;E<g.length;E++){var D=g[E];if(!(D[$s]||D[$r]||d==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var re=D.getAttribute(h)||"";re=d+re;var fe=w.get(re);fe?fe.push(D):w.set(re,[D])}}return w}function MT(d,h,g){d=d.ownerDocument||d,d.head.insertBefore(g,h==="title"?d.querySelector("head > title"):null)}function AJ(d,h,g){if(g===1||h.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;return h.rel==="stylesheet"?(d=h.disabled,typeof h.precedence=="string"&&d==null):!0;case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function PT(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function EJ(d,h,g,w){if(g.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var E=Np(w.href),D=h.querySelector(Cg(E));if(D){h=D._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(d.count++,d=Yy.bind(d),h.then(d,d)),g.state.loading|=4,g.instance=D,Rt(D);return}D=h.ownerDocument||h,w=TT(w),(E=$l.get(E))&&X4(w,E),D=D.createElement("link"),Rt(D);var re=D;re._p=new Promise(function(fe,Oe){re.onload=fe,re.onerror=Oe}),$a(D,"link",w),g.instance=D}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(g,h),(h=g.state.preload)&&(g.state.loading&3)===0&&(d.count++,g=Yy.bind(d),h.addEventListener("load",g),h.addEventListener("error",g))}}var Z4=0;function TJ(d,h){return d.stylesheets&&d.count===0&&Xy(d,d.stylesheets),0<d.count||0<d.imgCount?function(g){var w=setTimeout(function(){if(d.stylesheets&&Xy(d,d.stylesheets),d.unsuspend){var D=d.unsuspend;d.unsuspend=null,D()}},6e4+h);0<d.imgBytes&&Z4===0&&(Z4=62500*dJ());var E=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&Xy(d,d.stylesheets),d.unsuspend)){var D=d.unsuspend;d.unsuspend=null,D()}},(d.imgBytes>Z4?50:800)+h);return d.unsuspend=g,function(){d.unsuspend=null,clearTimeout(w),clearTimeout(E)}}:null}function Yy(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xy(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Ky=null;function Xy(d,h){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Ky=new Map,h.forEach(LJ,d),Ky=null,Yy.call(d))}function LJ(d,h){if(!(h.state.loading&4)){var g=Ky.get(d);if(g)var w=g.get(null);else{g=new Map,Ky.set(d,g);for(var E=d.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<E.length;D++){var re=E[D];(re.nodeName==="LINK"||re.getAttribute("media")!=="not all")&&(g.set(re.dataset.precedence,re),w=re)}w&&g.set(null,w)}E=h.instance,re=E.getAttribute("data-precedence"),D=g.get(re)||w,D===w&&g.set(null,E),g.set(re,E),this.count++,w=Yy.bind(this),E.addEventListener("load",w),E.addEventListener("error",w),D?D.parentNode.insertBefore(E,D.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(E,d.firstChild)),h.state.loading|=4}}var Eg={$$typeof:A,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function OJ(d,h,g,w,E,D,re,fe,Oe){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ee(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ee(0),this.hiddenUpdates=Ee(null),this.identifierPrefix=w,this.onUncaughtError=E,this.onCaughtError=D,this.onRecoverableError=re,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Oe,this.incompleteTransitions=new Map}function IT(d,h,g,w,E,D,re,fe,Oe,tt,gt,jt){return d=new OJ(d,h,g,re,Oe,tt,gt,jt,fe),h=1,D===!0&&(h|=24),D=ua(3,null,null,h),d.current=D,D.stateNode=d,h=uh(),h.refCount++,d.pooledCache=h,h.refCount++,D.memoizedState={element:w,isDehydrated:g,cache:h},Wt(D),d}function RT(d){return d?(d=Vi,d):Vi}function DT(d,h,g,w,E,D){E=RT(E),w.context===null?w.context=E:w.pendingContext=E,w=Er(h),w.payload={element:g},D=D===void 0?null:D,D!==null&&(w.callback=D),g=Wr(d,w,h),g!==null&&(Jo(g,d,h),qn(g,d,h))}function BT(d,h){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var g=d.retryLane;d.retryLane=g!==0&&g<h?g:h}}function Q4(d,h){BT(d,h),(d=d.alternate)&&BT(d,h)}function $T(d){if(d.tag===13||d.tag===31){var h=hc(d,67108864);h!==null&&Jo(h,d,67108864),Q4(d,67108864)}}function FT(d){if(d.tag===13||d.tag===31){var h=gl();h=It(h);var g=hc(d,h);g!==null&&Jo(g,d,h),Q4(d,h)}}var Jy=!0;function MJ(d,h,g,w){var E=G.T;G.T=null;var D=ne.p;try{ne.p=2,ej(d,h,g,w)}finally{ne.p=D,G.T=E}}function PJ(d,h,g,w){var E=G.T;G.T=null;var D=ne.p;try{ne.p=8,ej(d,h,g,w)}finally{ne.p=D,G.T=E}}function ej(d,h,g,w){if(Jy){var E=tj(w);if(E===null)F4(d,h,w,Zy,g),zT(d,w);else if(RJ(E,d,h,g,w))w.stopPropagation();else if(zT(d,w),h&4&&-1<IJ.indexOf(d)){for(;E!==null;){var D=ze(E);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var re=Tt(D.pendingLanes);if(re!==0){var fe=D;for(fe.pendingLanes|=2,fe.entangledLanes|=2;re;){var Oe=1<<31-$t(re);fe.entanglements[1]|=Oe,re&=~Oe}od(D),(Wn&6)===0&&(Py=Pe()+500,Ng(0))}}break;case 31:case 13:fe=hc(D,2),fe!==null&&Jo(fe,D,2),Ry(),Q4(D,2)}if(D=tj(w),D===null&&F4(d,h,w,Zy,g),D===E)break;E=D}E!==null&&w.stopPropagation()}else F4(d,h,w,null,g)}}function tj(d){return d=Qs(d),rj(d)}var Zy=null;function rj(d){if(Zy=null,d=jn(d),d!==null){var h=a(d);if(h===null)d=null;else{var g=h.tag;if(g===13){if(d=o(h),d!==null)return d;d=null}else if(g===31){if(d=l(h),d!==null)return d;d=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;d=null}else h!==d&&(d=null)}}return Zy=d,null}function UT(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ct()){case bt:return 2;case dt:return 8;case Ve:case lt:return 32;case kt:return 268435456;default:return 32}default:return 32}}var nj=!1,kh=null,Sh=null,_h=null,Tg=new Map,Lg=new Map,Ch=[],IJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zT(d,h){switch(d){case"focusin":case"focusout":kh=null;break;case"dragenter":case"dragleave":Sh=null;break;case"mouseover":case"mouseout":_h=null;break;case"pointerover":case"pointerout":Tg.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lg.delete(h.pointerId)}}function Og(d,h,g,w,E,D){return d===null||d.nativeEvent!==D?(d={blockedOn:h,domEventName:g,eventSystemFlags:w,nativeEvent:D,targetContainers:[E]},h!==null&&(h=ze(h),h!==null&&$T(h)),d):(d.eventSystemFlags|=w,h=d.targetContainers,E!==null&&h.indexOf(E)===-1&&h.push(E),d)}function RJ(d,h,g,w,E){switch(h){case"focusin":return kh=Og(kh,d,h,g,w,E),!0;case"dragenter":return Sh=Og(Sh,d,h,g,w,E),!0;case"mouseover":return _h=Og(_h,d,h,g,w,E),!0;case"pointerover":var D=E.pointerId;return Tg.set(D,Og(Tg.get(D)||null,d,h,g,w,E)),!0;case"gotpointercapture":return D=E.pointerId,Lg.set(D,Og(Lg.get(D)||null,d,h,g,w,E)),!0}return!1}function qT(d){var h=jn(d.target);if(h!==null){var g=a(h);if(g!==null){if(h=g.tag,h===13){if(h=o(g),h!==null){d.blockedOn=h,en(d.priority,function(){FT(g)});return}}else if(h===31){if(h=l(g),h!==null){d.blockedOn=h,en(d.priority,function(){FT(g)});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){d.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Qy(d){if(d.blockedOn!==null)return!1;for(var h=d.targetContainers;0<h.length;){var g=tj(d.nativeEvent);if(g===null){g=d.nativeEvent;var w=new g.constructor(g.type,g);Kn=w,g.target.dispatchEvent(w),Kn=null}else return h=ze(g),h!==null&&$T(h),d.blockedOn=g,!1;h.shift()}return!0}function HT(d,h,g){Qy(d)&&g.delete(h)}function DJ(){nj=!1,kh!==null&&Qy(kh)&&(kh=null),Sh!==null&&Qy(Sh)&&(Sh=null),_h!==null&&Qy(_h)&&(_h=null),Tg.forEach(HT),Lg.forEach(HT)}function ev(d,h){d.blockedOn===h&&(d.blockedOn=null,nj||(nj=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,DJ)))}var tv=null;function WT(d){tv!==d&&(tv=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){tv===d&&(tv=null);for(var h=0;h<d.length;h+=3){var g=d[h],w=d[h+1],E=d[h+2];if(typeof w!="function"){if(rj(w||g)===null)continue;break}var D=ze(g);D!==null&&(d.splice(h,3),h-=3,t4(D,{pending:!0,data:E,method:g.method,action:w},w,E))}}))}function Sp(d){function h(Oe){return ev(Oe,d)}kh!==null&&ev(kh,d),Sh!==null&&ev(Sh,d),_h!==null&&ev(_h,d),Tg.forEach(h),Lg.forEach(h);for(var g=0;g<Ch.length;g++){var w=Ch[g];w.blockedOn===d&&(w.blockedOn=null)}for(;0<Ch.length&&(g=Ch[0],g.blockedOn===null);)qT(g),g.blockedOn===null&&Ch.shift();if(g=(d.ownerDocument||d).$$reactFormReplay,g!=null)for(w=0;w<g.length;w+=3){var E=g[w],D=g[w+1],re=E[Qr]||null;if(typeof D=="function")re||WT(g);else if(re){var fe=null;if(D&&D.hasAttribute("formAction")){if(E=D,re=D[Qr]||null)fe=re.formAction;else if(rj(E)!==null)continue}else fe=re.action;typeof fe=="function"?g[w+1]=fe:(g.splice(w,3),w-=3),WT(g)}}}function GT(){function d(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(re){return E=re})},focusReset:"manual",scroll:"manual"})}function h(){E!==null&&(E(),E=null),w||setTimeout(g,20)}function g(){if(!w&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,E=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(g,100),function(){w=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),E!==null&&(E(),E=null)}}}function sj(d){this._internalRoot=d}rv.prototype.render=sj.prototype.render=function(d){var h=this._internalRoot;if(h===null)throw Error(n(409));var g=h.current,w=gl();DT(g,w,d,h,null,null)},rv.prototype.unmount=sj.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var h=d.containerInfo;DT(d.current,2,null,d,null,null),Ry(),h[pn]=null}};function rv(d){this._internalRoot=d}rv.prototype.unstable_scheduleHydration=function(d){if(d){var h=pr();d={blockedOn:null,target:d,priority:h};for(var g=0;g<Ch.length&&h!==0&&h<Ch[g].priority;g++);Ch.splice(g,0,d),g===0&&qT(d)}};var VT=e.version;if(VT!=="19.2.3")throw Error(n(527,VT,"19.2.3"));ne.findDOMNode=function(d){var h=d._reactInternals;if(h===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=u(h),d=d!==null?f(d):null,d=d===null?null:d.stateNode,d};var BJ={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nv.isDisabled&&nv.supportsFiber)try{zt=nv.inject(BJ),Ot=nv}catch{}}return Pg.createRoot=function(d,h){if(!i(d))throw Error(n(299));var g=!1,w="",E=e8,D=t8,re=r8;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(D=h.onCaughtError),h.onRecoverableError!==void 0&&(re=h.onRecoverableError)),h=IT(d,1,!1,null,null,g,w,null,E,D,re,GT),d[pn]=h.current,$4(d),new sj(h)},Pg.hydrateRoot=function(d,h,g){if(!i(d))throw Error(n(299));var w=!1,E="",D=e8,re=t8,fe=r8,Oe=null;return g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(E=g.identifierPrefix),g.onUncaughtError!==void 0&&(D=g.onUncaughtError),g.onCaughtError!==void 0&&(re=g.onCaughtError),g.onRecoverableError!==void 0&&(fe=g.onRecoverableError),g.formState!==void 0&&(Oe=g.formState)),h=IT(d,1,!0,h,g??null,w,E,Oe,D,re,fe,GT),h.context=RT(null),g=h.current,w=gl(),w=It(w),E=Er(w),E.callback=null,Wr(g,E,w),g=w,h.current.lanes=g,He(h,g),od(h),d[pn]=h.current,$4(d),new rv(h)},Pg.version="19.2.3",Pg}var nL;function YJ(){if(nL)return oj.exports;nL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),oj.exports=VJ(),oj.exports}var KJ=YJ();const XJ=Co(KJ);var sL="popstate";function JJ(t={}){function e(n,i){let{pathname:a,search:o,hash:l}=n.location;return D3("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Rx(i)}return QJ(e,r,null,t)}function Xs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZJ(){return Math.random().toString(36).substring(2,10)}function iL(t,e){return{usr:t.state,key:t.key,idx:e}}function D3(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Tm(e):e,state:r,key:e&&e.key||n||ZJ()}}function Rx({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Tm(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function QJ(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,l="POP",c=null,u=f();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function f(){return(o.state||{idx:null}).idx}function p(){l="POP";let j=f(),N=j==null?null:j-u;u=j,c&&c({action:l,location:v.location,delta:N})}function x(j,N){l="PUSH";let C=D3(v.location,j,N);u=f()+1;let A=iL(C,u),L=v.createHref(C);try{o.pushState(A,"",L)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(L)}a&&c&&c({action:l,location:v.location,delta:1})}function m(j,N){l="REPLACE";let C=D3(v.location,j,N);u=f();let A=iL(C,u),L=v.createHref(C);o.replaceState(A,"",L),a&&c&&c({action:l,location:v.location,delta:0})}function y(j){return eZ(j)}let v={get action(){return l},get location(){return t(i,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(sL,p),c=j,()=>{i.removeEventListener(sL,p),c=null}},createHref(j){return e(i,j)},createURL:y,encodeLocation(j){let N=y(j);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:x,replace:m,go(j){return o.go(j)}};return v}function eZ(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Rx(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function a$(t,e,r="/"){return tZ(t,e,r,!1)}function tZ(t,e,r,n){let i=typeof e=="string"?Tm(e):e,a=Cu(i.pathname||"/",r);if(a==null)return null;let o=o$(t);rZ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=fZ(a);l=uZ(o[c],u,n)}return l}function o$(t,e=[],r=[],n="",i=!1){let a=(o,l,c=i,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(n)&&c)return;Xs(f.relativePath.startsWith(n),`Absolute route path "${f.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(n.length)}let p=wu([n,f.relativePath]),x=r.concat(f);o.children&&o.children.length>0&&(Xs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),o$(o.children,e,x,p,c)),!(o.path==null&&!o.index)&&e.push({path:p,score:cZ(p,o.index),routesMeta:x})};return t.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))a(o,l);else for(let c of l$(o.path))a(o,l,!0,c)}),e}function l$(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=l$(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function rZ(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:dZ(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var nZ=/^:[\w-]+$/,sZ=3,iZ=2,aZ=1,oZ=10,lZ=-2,aL=t=>t==="*";function cZ(t,e){let r=t.split("/"),n=r.length;return r.some(aL)&&(n+=lZ),e&&(n+=iZ),r.filter(i=>!aL(i)).reduce((i,a)=>i+(nZ.test(a)?sZ:a===""?aZ:oZ),n)}function dZ(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function uZ(t,e,r=!1){let{routesMeta:n}=t,i={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,f=a==="/"?e:e.slice(a.length)||"/",p=D1({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),x=c.route;if(!p&&u&&r&&!n[n.length-1].route.index&&(p=D1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:wu([a,p.pathname]),pathnameBase:xZ(wu([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=wu([a,p.pathnameBase]))}return o}function D1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=hZ(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,{paramName:f,isOptional:p},x)=>{if(f==="*"){let y=l[x]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const m=l[x];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function hZ(t,e=!1,r=!0){Nl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function fZ(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nl(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Cu(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var c$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pZ=t=>c$.test(t);function mZ(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Tm(t):t,a;if(r)if(pZ(r))a=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Nl(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?a=oL(r.substring(1),"/"):a=oL(r,e)}else a=e;return{pathname:a,search:bZ(n),hash:yZ(i)}}function oL(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function uj(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gZ(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function r6(t){let e=gZ(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function n6(t,e,r,n=!1){let i;typeof t=="string"?i=Tm(t):(i={...t},Xs(!i.pathname||!i.pathname.includes("?"),uj("?","pathname","search",i)),Xs(!i.pathname||!i.pathname.includes("#"),uj("#","pathname","hash",i)),Xs(!i.search||!i.search.includes("#"),uj("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=r;else{let p=e.length-1;if(!n&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;i.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=mZ(i,l),u=o&&o!=="/"&&o.endsWith("/"),f=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}var wu=t=>t.join("/").replace(/\/\/+/g,"/"),xZ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),bZ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yZ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,vZ=class{constructor(t,e,r,n=!1){this.status=t,this.statusText=e||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function wZ(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function jZ(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var d$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function u$(t,e){let r=t;if(typeof r!="string"||!c$.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,i=!1;if(d$)try{let a=new URL(window.location.href),o=r.startsWith("//")?new URL(a.protocol+r):new URL(r),l=Cu(o.pathname,e);o.origin===a.origin&&l!=null?r=l+o.search+o.hash:i=!0}catch{Nl(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:i,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var h$=["POST","PUT","PATCH","DELETE"];new Set(h$);var NZ=["GET",...h$];new Set(NZ);var Lm=b.createContext(null);Lm.displayName="DataRouter";var fw=b.createContext(null);fw.displayName="DataRouterState";var kZ=b.createContext(!1),f$=b.createContext({isTransitioning:!1});f$.displayName="ViewTransition";var SZ=b.createContext(new Map);SZ.displayName="Fetchers";var _Z=b.createContext(null);_Z.displayName="Await";var Sl=b.createContext(null);Sl.displayName="Navigation";var bb=b.createContext(null);bb.displayName="Location";var Uc=b.createContext({outlet:null,matches:[],isDataRoute:!1});Uc.displayName="Route";var s6=b.createContext(null);s6.displayName="RouteError";var p$="REACT_ROUTER_ERROR",CZ="REDIRECT",AZ="ROUTE_ERROR_RESPONSE";function EZ(t){if(t.startsWith(`${p$}:${CZ}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function TZ(t){if(t.startsWith(`${p$}:${AZ}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new vZ(e.status,e.statusText,e.data)}catch{}}function LZ(t,{relative:e}={}){Xs(Om(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=b.useContext(Sl),{hash:i,pathname:a,search:o}=yb(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:wu([r,a])),n.createHref({pathname:l,search:o,hash:i})}function Om(){return b.useContext(bb)!=null}function Ao(){return Xs(Om(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(bb).location}var m$="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function g$(t){b.useContext(Sl).static||b.useLayoutEffect(t)}function dn(){let{isDataRoute:t}=b.useContext(Uc);return t?HZ():OZ()}function OZ(){Xs(Om(),"useNavigate() may be used only in the context of a <Router> component.");let t=b.useContext(Lm),{basename:e,navigator:r}=b.useContext(Sl),{matches:n}=b.useContext(Uc),{pathname:i}=Ao(),a=JSON.stringify(r6(n)),o=b.useRef(!1);return g$(()=>{o.current=!0}),b.useCallback((c,u={})=>{if(Nl(o.current,m$),!o.current)return;if(typeof c=="number"){r.go(c);return}let f=n6(c,JSON.parse(a),i,u.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:wu([e,f.pathname])),(u.replace?r.replace:r.push)(f,u.state,u)},[e,r,a,i,t])}b.createContext(null);function Eo(){let{matches:t}=b.useContext(Uc),e=t[t.length-1];return e?e.params:{}}function yb(t,{relative:e}={}){let{matches:r}=b.useContext(Uc),{pathname:n}=Ao(),i=JSON.stringify(r6(r));return b.useMemo(()=>n6(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function MZ(t,e){return x$(t,e)}function x$(t,e,r,n,i){Xs(Om(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=b.useContext(Sl),{matches:o}=b.useContext(Uc),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",f=l?l.pathnameBase:"/",p=l&&l.route;{let C=p&&p.path||"";y$(u,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let x=Ao(),m;if(e){let C=typeof e=="string"?Tm(e):e;Xs(f==="/"||C.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${C.pathname}" was given in the \`location\` prop.`),m=C}else m=x;let y=m.pathname||"/",v=y;if(f!=="/"){let C=f.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let j=a$(t,{pathname:v});Nl(p||j!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Nl(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=BZ(j&&j.map(C=>Object.assign({},C,{params:Object.assign({},c,C.params),pathname:wu([f,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?f:wu([f,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,r,n,i);return e&&N?b.createElement(bb.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},N):N}function PZ(){let t=qZ(),e=wZ(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:a},"ErrorBoundary")," or"," ",b.createElement("code",{style:a},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:i},r):null,o)}var IZ=b.createElement(PZ,null),b$=class extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const r=TZ(t.digest);r&&(t=r)}let e=t!==void 0?b.createElement(Uc.Provider,{value:this.props.routeContext},b.createElement(s6.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?b.createElement(RZ,{error:t},e):e}};b$.contextType=kZ;var hj=new WeakMap;function RZ({children:t,error:e}){let{basename:r}=b.useContext(Sl);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=EZ(e.digest);if(n){let i=hj.get(e);if(i)throw i;let a=u$(n.location,r);if(d$&&!hj.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw hj.set(e,o),o}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function DZ({routeContext:t,match:e,children:r}){let n=b.useContext(Lm);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Uc.Provider,{value:t},r)}function BZ(t,e=[],r=null,n=null,i=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r?.errors;if(o!=null){let f=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Xs(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,c=-1;if(r)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=f),p.route.id){let{loaderData:x,errors:m}=r,y=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!m||m[p.route.id]===void 0);if(p.route.lazy||y){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let u=r&&n?(f,p)=>{n(f,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:jZ(r.matches),errorInfo:p})}:void 0;return a.reduceRight((f,p,x)=>{let m,y=!1,v=null,j=null;r&&(m=o&&p.route.id?o[p.route.id]:void 0,v=p.route.errorElement||IZ,l&&(c<0&&x===0?(y$("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,j=null):c===x&&(y=!0,j=p.route.hydrateFallbackElement||null)));let N=e.concat(a.slice(0,x+1)),C=()=>{let A;return m?A=v:y?A=j:p.route.Component?A=b.createElement(p.route.Component,null):p.route.element?A=p.route.element:A=f,b.createElement(DZ,{match:p,routeContext:{outlet:f,matches:N,isDataRoute:r!=null},children:A})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?b.createElement(b$,{location:r.location,revalidation:r.revalidation,component:v,error:m,children:C(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:u}):C()},null)}function i6(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $Z(t){let e=b.useContext(Lm);return Xs(e,i6(t)),e}function FZ(t){let e=b.useContext(fw);return Xs(e,i6(t)),e}function UZ(t){let e=b.useContext(Uc);return Xs(e,i6(t)),e}function a6(t){let e=UZ(t),r=e.matches[e.matches.length-1];return Xs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function zZ(){return a6("useRouteId")}function qZ(){let t=b.useContext(s6),e=FZ("useRouteError"),r=a6("useRouteError");return t!==void 0?t:e.errors?.[r]}function HZ(){let{router:t}=$Z("useNavigate"),e=a6("useNavigate"),r=b.useRef(!1);return g$(()=>{r.current=!0}),b.useCallback(async(i,a={})=>{Nl(r.current,m$),r.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var lL={};function y$(t,e,r){!e&&!lL[t]&&(lL[t]=!0,Nl(!1,r))}b.memo(WZ);function WZ({routes:t,future:e,state:r,onError:n}){return x$(t,void 0,r,n,e)}function GZ({to:t,replace:e,state:r,relative:n}){Xs(Om(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=b.useContext(Sl);Nl(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=b.useContext(Uc),{pathname:o}=Ao(),l=dn(),c=n6(t,r6(a),o,n==="path"),u=JSON.stringify(c);return b.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function ln(t){Xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function VZ({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){Xs(!Om(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[l,i,a,o]);typeof r=="string"&&(r=Tm(r));let{pathname:u="/",search:f="",hash:p="",state:x=null,key:m="default"}=r,y=b.useMemo(()=>{let v=Cu(u,l);return v==null?null:{location:{pathname:v,search:f,hash:p,state:x,key:m},navigationType:n}},[l,u,f,p,x,m,n]);return Nl(y!=null,`<Router basename="${l}"> is not able to match the URL "${u}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:b.createElement(Sl.Provider,{value:c},b.createElement(bb.Provider,{children:e,value:y}))}function YZ({children:t,location:e}){return MZ(B3(t),e)}function B3(t,e=[]){let r=[];return b.Children.forEach(t,(n,i)=>{if(!b.isValidElement(n))return;let a=[...e,i];if(n.type===b.Fragment){r.push.apply(r,B3(n.props.children,a));return}Xs(n.type===ln,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=B3(n.props.children,a)),r.push(o)}),r}var l1="get",c1="application/x-www-form-urlencoded";function pw(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function KZ(t){return pw(t)&&t.tagName.toLowerCase()==="button"}function XZ(t){return pw(t)&&t.tagName.toLowerCase()==="form"}function JZ(t){return pw(t)&&t.tagName.toLowerCase()==="input"}function ZZ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function QZ(t,e){return t.button===0&&(!e||e==="_self")&&!ZZ(t)}function $3(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function eQ(t,e){let r=$3(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(a=>{r.append(i,a)})}),r}var sv=null;function tQ(){if(sv===null)try{new FormData(document.createElement("form"),0),sv=!1}catch{sv=!0}return sv}var rQ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function fj(t){return t!=null&&!rQ.has(t)?(Nl(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${c1}"`),null):t}function nQ(t,e){let r,n,i,a,o;if(XZ(t)){let l=t.getAttribute("action");n=l?Cu(l,e):null,r=t.getAttribute("method")||l1,i=fj(t.getAttribute("enctype"))||c1,a=new FormData(t)}else if(KZ(t)||JZ(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?Cu(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||l1,i=fj(t.getAttribute("formenctype"))||fj(l.getAttribute("enctype"))||c1,a=new FormData(l,t),!tQ()){let{name:u,type:f,value:p}=t;if(f==="image"){let x=u?`${u}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else u&&a.append(u,p)}}else{if(pw(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=l1,n=null,i=c1,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function o6(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function sQ(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Cu(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function iQ(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function aQ(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function oQ(t,e,r){let n=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await iQ(a,r);return o.links?o.links():[]}return[]}));return uQ(n.flat(1).filter(aQ).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function cL(t,e,r,n,i,a){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>r[u].pathname!==c.pathname||r[u].route.path?.endsWith("*")&&r[u].params["*"]!==c.params["*"];return a==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?e.filter((c,u)=>{let f=n.routes[c.route.id];if(!f||!f.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function lQ(t,e,{includeHydrateFallback:r}={}){return cQ(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function cQ(t){return[...new Set(t)]}function dQ(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function uQ(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let a=JSON.stringify(dQ(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}function v$(){let t=b.useContext(Lm);return o6(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function hQ(){let t=b.useContext(fw);return o6(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var l6=b.createContext(void 0);l6.displayName="FrameworkContext";function w$(){let t=b.useContext(l6);return o6(t,"You must render this element inside a <HydratedRouter> element"),t}function fQ(t,e){let r=b.useContext(l6),[n,i]=b.useState(!1),[a,o]=b.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:f,onTouchStart:p}=e,x=b.useRef(null);b.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let v=N=>{N.forEach(C=>{o(C.isIntersecting)})},j=new IntersectionObserver(v,{threshold:.5});return x.current&&j.observe(x.current),()=>{j.disconnect()}}},[t]),b.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let m=()=>{i(!0)},y=()=>{i(!1),o(!1)};return r?t!=="intent"?[a,x,{}]:[a,x,{onFocus:Ig(l,m),onBlur:Ig(c,y),onMouseEnter:Ig(u,m),onMouseLeave:Ig(f,y),onTouchStart:Ig(p,m)}]:[!1,x,{}]}function Ig(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function pQ({page:t,...e}){let{router:r}=v$(),n=b.useMemo(()=>a$(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?b.createElement(gQ,{page:t,matches:n,...e}):null}function mQ(t){let{manifest:e,routeModules:r}=w$(),[n,i]=b.useState([]);return b.useEffect(()=>{let a=!1;return oQ(t,e,r).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,r]),n}function gQ({page:t,matches:e,...r}){let n=Ao(),{manifest:i,routeModules:a}=w$(),{basename:o}=v$(),{loaderData:l,matches:c}=hQ(),u=b.useMemo(()=>cL(t,e,c,i,n,"data"),[t,e,c,i,n]),f=b.useMemo(()=>cL(t,e,c,i,n,"assets"),[t,e,c,i,n]),p=b.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let y=new Set,v=!1;if(e.forEach(N=>{let C=i.routes[N.route.id];!C||!C.hasLoader||(!u.some(A=>A.route.id===N.route.id)&&N.route.id in l&&a[N.route.id]?.shouldRevalidate||C.hasClientLoader?v=!0:y.add(N.route.id))}),y.size===0)return[];let j=sQ(t,o,"data");return v&&y.size>0&&j.searchParams.set("_routes",e.filter(N=>y.has(N.route.id)).map(N=>N.route.id).join(",")),[j.pathname+j.search]},[o,l,n,i,u,e,t,a]),x=b.useMemo(()=>lQ(f,i),[f,i]),m=mQ(f);return b.createElement(b.Fragment,null,p.map(y=>b.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),x.map(y=>b.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),m.map(({key:y,link:v})=>b.createElement("link",{key:y,nonce:r.nonce,...v})))}function xQ(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var bQ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bQ&&(window.__reactRouterVersion="7.11.0")}catch{}function yQ({basename:t,children:e,unstable_useTransitions:r,window:n}){let i=b.useRef();i.current==null&&(i.current=JJ({window:n,v5Compat:!0}));let a=i.current,[o,l]=b.useState({action:a.action,location:a.location}),c=b.useCallback(u=>{r===!1?l(u):b.startTransition(()=>l(u))},[r]);return b.useLayoutEffect(()=>a.listen(c),[a,c]),b.createElement(VZ,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:r})}var j$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,br=b.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x,...m},y){let{basename:v,unstable_useTransitions:j}=b.useContext(Sl),N=typeof u=="string"&&j$.test(u),C=u$(u,v);u=C.to;let A=LZ(u,{relative:i}),[L,O,F]=fQ(n,m),T=NQ(u,{replace:o,state:l,target:c,preventScrollReset:f,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:x,unstable_useTransitions:j});function I($){e&&e($),$.defaultPrevented||T($)}let B=b.createElement("a",{...m,...F,href:C.absoluteURL||A,onClick:C.isExternal||a?e:I,ref:xQ(y,O),target:c,"data-discover":!N&&r==="render"?"true":void 0});return L&&!N?b.createElement(b.Fragment,null,B,b.createElement(pQ,{page:A})):B});br.displayName="Link";var vQ=b.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:o,viewTransition:l,children:c,...u},f){let p=yb(o,{relative:u.relative}),x=Ao(),m=b.useContext(fw),{navigator:y,basename:v}=b.useContext(Sl),j=m!=null&&AQ(p)&&l===!0,N=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,C=x.pathname,A=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(C=C.toLowerCase(),A=A?A.toLowerCase():null,N=N.toLowerCase()),A&&v&&(A=Cu(A,v)||A);const L=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let O=C===N||!i&&C.startsWith(N)&&C.charAt(L)==="/",F=A!=null&&(A===N||!i&&A.startsWith(N)&&A.charAt(N.length)==="/"),T={isActive:O,isPending:F,isTransitioning:j},I=O?e:void 0,B;typeof n=="function"?B=n(T):B=[n,O?"active":null,F?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let $=typeof a=="function"?a(T):a;return b.createElement(br,{...u,"aria-current":I,className:B,ref:f,style:$,to:o,viewTransition:l},typeof c=="function"?c(T):c)});vQ.displayName="NavLink";var wQ=b.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:a,method:o=l1,action:l,onSubmit:c,relative:u,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x,...m},y)=>{let{unstable_useTransitions:v}=b.useContext(Sl),j=_Q(),N=CQ(l,{relative:u}),C=o.toLowerCase()==="get"?"get":"post",A=typeof l=="string"&&j$.test(l),L=O=>{if(c&&c(O),O.defaultPrevented)return;O.preventDefault();let F=O.nativeEvent.submitter,T=F?.getAttribute("formmethod")||o,I=()=>j(F||O.currentTarget,{fetcherKey:e,method:T,navigate:r,replace:i,state:a,relative:u,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x});v&&r!==!1?b.startTransition(()=>I()):I()};return b.createElement("form",{ref:y,method:C,action:N,onSubmit:n?c:L,...m,"data-discover":!A&&t==="render"?"true":void 0})});wQ.displayName="Form";function jQ(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function N$(t){let e=b.useContext(Lm);return Xs(e,jQ(t)),e}function NQ(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=dn(),f=Ao(),p=yb(t,{relative:a});return b.useCallback(x=>{if(QZ(x,e)){x.preventDefault();let m=r!==void 0?r:Rx(f)===Rx(p),y=()=>u(t,{replace:m,state:n,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:l});c?b.startTransition(()=>y()):y()}},[f,u,p,r,n,e,t,i,a,o,l,c])}function mw(t){Nl(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef($3(t)),r=b.useRef(!1),n=Ao(),i=b.useMemo(()=>eQ(n.search,r.current?null:e.current),[n.search]),a=dn(),o=b.useCallback((l,c)=>{const u=$3(typeof l=="function"?l(new URLSearchParams(i)):l);r.current=!0,a("?"+u,c)},[a,i]);return[i,o]}var kQ=0,SQ=()=>`__${String(++kQ)}__`;function _Q(){let{router:t}=N$("useSubmit"),{basename:e}=b.useContext(Sl),r=zZ(),n=t.fetch,i=t.navigate;return b.useCallback(async(a,o={})=>{let{action:l,method:c,encType:u,formData:f,body:p}=nQ(a,e);if(o.navigate===!1){let x=o.fetcherKey||SQ();await n(x,r,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:p,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await i(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:p,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,i,e,r])}function CQ(t,{relative:e}={}){let{basename:r}=b.useContext(Sl),n=b.useContext(Uc);Xs(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...yb(t||".",{relative:e})},o=Ao();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(f=>f==="")){l.delete("index"),c.filter(p=>p).forEach(p=>l.append("index",p));let f=l.toString();a.search=f?`?${f}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:wu([r,a.pathname])),Rx(a)}function AQ(t,{relative:e}={}){let r=b.useContext(f$);Xs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=N$("useViewTransitionState"),i=yb(t,{relative:e});if(!r.isTransitioning)return!1;let a=Cu(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Cu(r.nextLocation.pathname,n)||r.nextLocation.pathname;return D1(i.pathname,o)!=null||D1(i.pathname,a)!=null}var Gn=i$();const c6=Co(Gn);function EQ(){const{pathname:t}=Ao();return b.useEffect(()=>{window.scrollTo(0,0)},[t]),null}class TQ{constructor(){this.timeline=[],this.pointer=-1,this.limit=50,this.listeners=new Set}init(e){this.timeline=[{state:this._clone(e),action:"Initial State",timestamp:Date.now()}],this.pointer=0,this._notify()}push(e,r,n=null,i=null){this.pointer<this.timeline.length-1&&(this.timeline=this.timeline.slice(0,this.pointer+1)),this.timeline.push({state:this._clone(r),action:e,timestamp:Date.now(),undoFn:n,redoFn:i}),this.timeline.length>this.limit?this.timeline.shift():this.pointer++,this._notify()}async undo(){if(!this.canUndo())return null;const e=this.timeline[this.pointer];if(e.undoFn)try{await e.undoFn()}catch(n){console.error("Undo callback failed",n)}this.pointer--;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}async redo(){if(!this.canRedo())return null;this.pointer++;const e=this.timeline[this.pointer];if(e.redoFn)try{await e.redoFn()}catch(r){console.error("Redo callback failed",r)}return this._notify(),this._clone(e.state)}canUndo(){return this.pointer>0}canRedo(){return this.pointer<this.timeline.length-1}getLog(){return[...this.timeline].reverse()}getCurrentAction(){return this.timeline[this.pointer]?.action||"Unknown"}_clone(e){try{return JSON.parse(JSON.stringify(e))}catch(r){return console.error("[HistoryService] Clone failed",r),e}}async jumpTo(e){if(e<0||e>=this.timeline.length)return null;if(e<this.pointer)for(let n=this.pointer;n>e;n--){const i=this.timeline[n];if(i.undoFn)try{await i.undoFn()}catch(a){console.error(`Undo failed at step ${n}`,a)}}else if(e>this.pointer)for(let n=this.pointer+1;n<=e;n++){const i=this.timeline[n];if(i.redoFn)try{await i.redoFn()}catch(a){console.error(`Redo failed at step ${n}`,a)}}this.pointer=e;const r=this.timeline[this.pointer];return this._notify(),this._clone(r.state)}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}_notify(){this.listeners.forEach(e=>e({canUndo:this.canUndo(),canRedo:this.canRedo(),history:this.getLog(),pointer:this.pointer,activeState:this.timeline[this.pointer]?.state}))}}const ba=new TQ,dL=({isOpen:t,onClose:e})=>{const[r,n]=b.useState({history:[],pointer:-1});if(b.useEffect(()=>t?(n({history:ba.getLog(),pointer:ba.pointer}),ba.subscribe(c=>{n({history:c.history,pointer:c.pointer})})):void 0,[t]),!t)return null;const{history:i,pointer:a}=r,o=async l=>{const c=i.length-1-l;c!==a&&window.confirm(`Revert to state after "${i[l].action}"?`)&&(await ba.jumpTo(c),e())};return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative flex flex-col max-h-[80vh]",children:[s.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-black/20 rounded-t-2xl",children:[s.jsxs("h2",{className:"text-lg font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-cyan-400",children:"Time Machine"}),s.jsx("span",{className:"text-[10px] bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-white/10",children:"Session History"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"overflow-y-auto p-4 custom-scrollbar space-y-2 flex-grow",children:i.length===0?s.jsx("div",{className:"text-center text-gray-500 py-10",children:"No actions recorded this session."}):i.map((l,c)=>{const u=i.length-1-c,f=u<a,p=u===a,x=u>a;return s.jsxs("div",{onClick:()=>o(c),className:`
                                        relative pl-4 pr-3 py-3 rounded-xl border transition-all cursor-pointer group flex items-start gap-3
                                        ${p?"bg-cyan-900/20 border-cyan-500/50 ring-1 ring-cyan-500/20":""}
                                        ${f?"bg-gray-800/50 border-white/5 opacity-70 hover:opacity-100 hover:bg-gray-800":""}
                                        ${x?"bg-gray-900/30 border-white/5 opacity-40 hover:opacity-100 grayscale hover:grayscale-0":""}
                                    `,children:[c!==i.length-1&&s.jsx("div",{className:"absolute left-[27px] top-10 bottom-[-10px] w-px bg-white/10 group-hover:bg-white/20"}),s.jsx("div",{className:`
                                        w-6 h-6 rounded-full flex items-center justify-center shrink-0 z-10 transition-colors
                                        ${p?"bg-cyan-500 text-black shadow-[0_0_10px_rgba(6,182,212,0.5)]":"bg-gray-800 border border-white/10 text-gray-500 group-hover:border-cyan-500/50 group-hover:text-cyan-400"}
                                    `,children:p?s.jsx("div",{className:"w-2 h-2 bg-black rounded-full animate-pulse"}):c===0?s.jsx("span",{className:"text-[10px] font-bold",children:"Latest"}):s.jsx("span",{className:"text-[9px]",children:c})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:`text-sm font-bold ${p?"text-cyan-400":"text-gray-300 group-hover:text-white"}`,children:l.action}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-mono text-gray-500",children:new Date(l.timestamp).toLocaleTimeString()}),p&&s.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-cyan-600 bg-cyan-900/30 px-1.5 py-0.5 rounded",children:"Active State"})]})]}),!p&&s.jsx("div",{className:"self-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("div",{className:"px-2 py-1 bg-white/10 rounded text-[9px] font-bold uppercase tracking-wider text-white",children:"Restore"})})]},l.timestamp)})})]})})},LQ=()=>{};var uL={};const k$=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},OQ=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],l=t[r++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},S$={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=a>>2,p=(a&3)<<4|l>>4;let x=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(x=64)),n.push(r[f],r[p],r[x],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(k$(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OQ(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||l==null||u==null||p==null)throw new MQ;const x=a<<2|l>>4;if(n.push(x),u!==64){const m=l<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class MQ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const PQ=function(t){const e=k$(t);return S$.encodeByteArray(e,!0)},B1=function(t){return PQ(t).replace(/\./g,"")},_$=function(t){try{return S$.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function IQ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const RQ=()=>IQ().__FIREBASE_DEFAULTS__,DQ=()=>{if(typeof process>"u"||typeof uL>"u")return;const t=uL.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BQ=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_$(t[1]);return e&&JSON.parse(e)},d6=()=>{try{return LQ()||RQ()||DQ()||BQ()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},C$=t=>d6()?.emulatorHosts?.[t],A$=t=>{const e=C$(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},E$=()=>d6()?.config,T$=t=>d6()?.[`_${t}`];class $Q{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Mm(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function u6(t){return(await fetch(t,{credentials:"include"})).ok}function L$(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[B1(JSON.stringify(r)),B1(JSON.stringify(o)),""].join(".")}const xx={};function FQ(){const t={prod:[],emulator:[]};for(const e of Object.keys(xx))xx[e]?t.emulator.push(e):t.prod.push(e);return t}function UQ(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let hL=!1;function h6(t,e){if(typeof window>"u"||typeof document>"u"||!Mm(window.location.host)||xx[t]===e||xx[t]||hL)return;xx[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",a=FQ().prod.length>0;function o(){const x=document.getElementById(n);x&&x.remove()}function l(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function c(x,m){x.setAttribute("width","24"),x.setAttribute("id",m),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function u(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{hL=!0,o()},x}function f(x,m){x.setAttribute("id",m),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function p(){const x=UQ(n),m=r("text"),y=document.getElementById(m)||document.createElement("span"),v=r("learnmore"),j=document.getElementById(v)||document.createElement("a"),N=r("preprendIcon"),C=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const A=x.element;l(A),f(j,v);const L=u();c(C,N),A.append(C,y,j,L),document.body.appendChild(A)}a?(y.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function ko(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zQ(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ko())}function qQ(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HQ(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function WQ(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GQ(){const t=ko();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VQ(){try{return typeof indexedDB=="object"}catch{return!1}}function YQ(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}const KQ="FirebaseError";class Md extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=KQ,Object.setPrototypeOf(this,Md.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vb.prototype.create)}}class vb{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?XQ(a,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Md(i,l,n)}}function XQ(t,e){return t.replace(JQ,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const JQ=/\{\$([^}]+)}/g;function ZQ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function i0(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(fL(a)&&fL(o)){if(!i0(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function fL(t){return t!==null&&typeof t=="object"}function wb(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ix(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ax(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function QQ(t,e){const r=new eee(t,e);return r.subscribe.bind(r)}class eee{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");tee(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=pj),i.error===void 0&&(i.error=pj),i.complete===void 0&&(i.complete=pj);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tee(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function pj(){}function zc(t){return t&&t._delegate?t._delegate:t}class rf{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Pf="[DEFAULT]";let ree=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new $Q;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(see(e))try{this.getOrInitializeService({instanceIdentifier:Pf})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Pf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pf){return this.instances.has(e)}getOptions(e=Pf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:nee(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Pf){return this.component?this.component.multipleInstances?e:Pf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function nee(t){return t===Pf?void 0:t}function see(t){return t.instantiationMode==="EAGER"}class iee{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ree(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Yn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Yn||(Yn={}));const aee={debug:Yn.DEBUG,verbose:Yn.VERBOSE,info:Yn.INFO,warn:Yn.WARN,error:Yn.ERROR,silent:Yn.SILENT},oee=Yn.INFO,lee={[Yn.DEBUG]:"log",[Yn.VERBOSE]:"log",[Yn.INFO]:"info",[Yn.WARN]:"warn",[Yn.ERROR]:"error"},cee=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=lee[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f6{constructor(e){this.name=e,this._logLevel=oee,this._logHandler=cee,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aee[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Yn.DEBUG,...e),this._logHandler(this,Yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Yn.VERBOSE,...e),this._logHandler(this,Yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Yn.INFO,...e),this._logHandler(this,Yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Yn.WARN,...e),this._logHandler(this,Yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Yn.ERROR,...e),this._logHandler(this,Yn.ERROR,...e)}}const dee=(t,e)=>e.some(r=>t instanceof r);let pL,mL;function uee(){return pL||(pL=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hee(){return mL||(mL=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const O$=new WeakMap,F3=new WeakMap,M$=new WeakMap,mj=new WeakMap,p6=new WeakMap;function fee(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Kh(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&O$.set(r,t)}).catch(()=>{}),p6.set(e,t),e}function pee(t){if(F3.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});F3.set(t,e)}let U3={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return F3.get(t);if(e==="objectStoreNames")return t.objectStoreNames||M$.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Kh(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function mee(t){U3=t(U3)}function gee(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(gj(this),e,...r);return M$.set(n,e.sort?e.sort():[e]),Kh(n)}:hee().includes(t)?function(...e){return t.apply(gj(this),e),Kh(O$.get(this))}:function(...e){return Kh(t.apply(gj(this),e))}}function xee(t){return typeof t=="function"?gee(t):(t instanceof IDBTransaction&&pee(t),dee(t,uee())?new Proxy(t,U3):t)}function Kh(t){if(t instanceof IDBRequest)return fee(t);if(mj.has(t))return mj.get(t);const e=xee(t);return e!==t&&(mj.set(t,e),p6.set(e,t)),e}const gj=t=>p6.get(t);function bee(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),l=Kh(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Kh(o.result),c.oldVersion,c.newVersion,Kh(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const yee=["get","getKey","getAll","getAllKeys","count"],vee=["put","add","delete","clear"],xj=new Map;function gL(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xj.get(e))return xj.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=vee.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||yee.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),i&&c.done]))[0]};return xj.set(e,a),a}mee(t=>({...t,get:(e,r,n)=>gL(e,r)||t.get(e,r,n),has:(e,r)=>!!gL(e,r)||t.has(e,r)}));class wee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(jee(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function jee(t){return t.getComponent()?.type==="VERSION"}const z3="@firebase/app",xL="0.14.6";const Au=new f6("@firebase/app"),Nee="@firebase/app-compat",kee="@firebase/analytics-compat",See="@firebase/analytics",_ee="@firebase/app-check-compat",Cee="@firebase/app-check",Aee="@firebase/auth",Eee="@firebase/auth-compat",Tee="@firebase/database",Lee="@firebase/data-connect",Oee="@firebase/database-compat",Mee="@firebase/functions",Pee="@firebase/functions-compat",Iee="@firebase/installations",Ree="@firebase/installations-compat",Dee="@firebase/messaging",Bee="@firebase/messaging-compat",$ee="@firebase/performance",Fee="@firebase/performance-compat",Uee="@firebase/remote-config",zee="@firebase/remote-config-compat",qee="@firebase/storage",Hee="@firebase/storage-compat",Wee="@firebase/firestore",Gee="@firebase/ai",Vee="@firebase/firestore-compat",Yee="firebase",Kee="12.6.0";const q3="[DEFAULT]",Xee={[z3]:"fire-core",[Nee]:"fire-core-compat",[See]:"fire-analytics",[kee]:"fire-analytics-compat",[Cee]:"fire-app-check",[_ee]:"fire-app-check-compat",[Aee]:"fire-auth",[Eee]:"fire-auth-compat",[Tee]:"fire-rtdb",[Lee]:"fire-data-connect",[Oee]:"fire-rtdb-compat",[Mee]:"fire-fn",[Pee]:"fire-fn-compat",[Iee]:"fire-iid",[Ree]:"fire-iid-compat",[Dee]:"fire-fcm",[Bee]:"fire-fcm-compat",[$ee]:"fire-perf",[Fee]:"fire-perf-compat",[Uee]:"fire-rc",[zee]:"fire-rc-compat",[qee]:"fire-gcs",[Hee]:"fire-gcs-compat",[Wee]:"fire-fst",[Vee]:"fire-fst-compat",[Gee]:"fire-vertex","fire-js":"fire-js",[Yee]:"fire-js-all"};const $1=new Map,Jee=new Map,H3=new Map;function bL(t,e){try{t.container.addComponent(e)}catch(r){Au.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function a0(t){const e=t.name;if(H3.has(e))return Au.debug(`There were multiple attempts to register component ${e}.`),!1;H3.set(e,t);for(const r of $1.values())bL(r,t);for(const r of Jee.values())bL(r,t);return!0}function gw(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function el(t){return t==null?!1:t.settings!==void 0}const Zee={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xh=new vb("app","Firebase",Zee);class Qee{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new rf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xh.create("app-deleted",{appName:this._name})}}const E0=Kee;function P$(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:q3,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Xh.create("bad-app-name",{appName:String(i)});if(r||(r=E$()),!r)throw Xh.create("no-options");const a=$1.get(i);if(a){if(i0(r,a.options)&&i0(n,a.config))return a;throw Xh.create("duplicate-app",{appName:i})}const o=new iee(i);for(const c of H3.values())o.addComponent(c);const l=new Qee(r,n,o);return $1.set(i,l),l}function m6(t=q3){const e=$1.get(t);if(!e&&t===q3&&E$())return P$();if(!e)throw Xh.create("no-app",{appName:t});return e}function bd(t,e,r){let n=Xee[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${n}" with version "${e}":`];i&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Au.warn(o.join(" "));return}a0(new rf(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const ete="firebase-heartbeat-database",tte=1,Dx="firebase-heartbeat-store";let bj=null;function I$(){return bj||(bj=bee(ete,tte,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Dx)}catch(r){console.warn(r)}}}}).catch(t=>{throw Xh.create("idb-open",{originalErrorMessage:t.message})})),bj}async function rte(t){try{const r=(await I$()).transaction(Dx),n=await r.objectStore(Dx).get(R$(t));return await r.done,n}catch(e){if(e instanceof Md)Au.warn(e.message);else{const r=Xh.create("idb-get",{originalErrorMessage:e?.message});Au.warn(r.message)}}}async function yL(t,e){try{const n=(await I$()).transaction(Dx,"readwrite");await n.objectStore(Dx).put(e,R$(t)),await n.done}catch(r){if(r instanceof Md)Au.warn(r.message);else{const n=Xh.create("idb-set",{originalErrorMessage:r?.message});Au.warn(n.message)}}}function R$(t){return`${t.name}!${t.options.appId}`}const nte=1024,ste=30;class ite{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ote(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=vL();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>ste){const i=lte(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Au.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=vL(),{heartbeatsToSend:r,unsentEntries:n}=ate(this._heartbeatsCache.heartbeats),i=B1(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Au.warn(e),""}}}function vL(){return new Date().toISOString().substring(0,10)}function ate(t,e=nte){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),wL(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),wL(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class ote{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VQ()?YQ().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await rte(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yL(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yL(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function wL(t){return B1(JSON.stringify({version:2,heartbeats:t})).length}function lte(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function cte(t){a0(new rf("platform-logger",e=>new wee(e),"PRIVATE")),a0(new rf("heartbeat",e=>new ite(e),"PRIVATE")),bd(z3,xL,t),bd(z3,xL,"esm2020"),bd("fire-js","")}cte("");function D$(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dte=D$,B$=new vb("auth","Firebase",D$());const F1=new f6("@firebase/auth");function ute(t,...e){F1.logLevel<=Yn.WARN&&F1.warn(`Auth (${E0}): ${t}`,...e)}function d1(t,...e){F1.logLevel<=Yn.ERROR&&F1.error(`Auth (${E0}): ${t}`,...e)}function Zl(t,...e){throw x6(t,...e)}function Mc(t,...e){return x6(t,...e)}function g6(t,e,r){const n={...dte(),[e]:r};return new vb("auth","Firebase",n).create(e,{appName:t.name})}function ju(t){return g6(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hte(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Zl(t,"argument-error"),g6(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function x6(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return B$.create(t,...e)}function Lr(t,e,...r){if(!t)throw x6(e,...r)}function xu(t){const e="INTERNAL ASSERTION FAILED: "+t;throw d1(e),new Error(e)}function Eu(t,e){t||xu(e)}function W3(){return typeof self<"u"&&self.location?.href||""}function fte(){return jL()==="http:"||jL()==="https:"}function jL(){return typeof self<"u"&&self.location?.protocol||null}function pte(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fte()||HQ()||"connection"in navigator)?navigator.onLine:!0}function mte(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class jb{constructor(e,r){this.shortDelay=e,this.longDelay=r,Eu(r>e,"Short delay should be less than long delay!"),this.isMobile=zQ()||WQ()}get(){return pte()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function b6(t,e){Eu(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class $${static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gte={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const xte=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bte=new jb(3e4,6e4);function Uu(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zu(t,e,r,n,i={}){return F$(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=wb({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...a};return qQ()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Mm(t.emulatorConfig.host)&&(u.credentials="include"),$$.fetch()(await U$(t,t.config.apiHost,r,l),u)})}async function F$(t,e,r){t._canInitEmulator=!1;const n={...gte,...e};try{const i=new vte(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw iv(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw iv(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw iv(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw iv(t,"user-disabled",o);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw g6(t,f,u);Zl(t,f)}}catch(i){if(i instanceof Md)throw i;Zl(t,"network-request-failed",{message:String(i)})}}async function Nb(t,e,r,n,i={}){const a=await zu(t,e,r,n,i);return"mfaPendingCredential"in a&&Zl(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function U$(t,e,r,n){const i=`${e}${r}?${n}`,a=t,o=a.config.emulator?b6(t.config,i):`${t.config.apiScheme}://${i}`;return xte.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function yte(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vte{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Mc(this.auth,"network-request-failed")),bte.get())})}}function iv(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Mc(t,e,n);return i.customData._tokenResponse=r,i}function NL(t){return t!==void 0&&t.enterprise!==void 0}class wte{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return yte(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jte(t,e){return zu(t,"GET","/v2/recaptchaConfig",Uu(t,e))}async function Nte(t,e){return zu(t,"POST","/v1/accounts:delete",e)}async function U1(t,e){return zu(t,"POST","/v1/accounts:lookup",e)}function bx(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kte(t,e=!1){const r=zc(t),n=await r.getIdToken(e),i=y6(n);Lr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:n,authTime:bx(yj(i.auth_time)),issuedAtTime:bx(yj(i.iat)),expirationTime:bx(yj(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function yj(t){return Number(t)*1e3}function y6(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return d1("JWT malformed, contained fewer than 3 sections"),null;try{const i=_$(r);return i?JSON.parse(i):(d1("Failed to decode base64 JWT payload"),null)}catch(i){return d1("Caught error parsing JWT payload as JSON",i?.toString()),null}}function kL(t){const e=y6(t);return Lr(e,"internal-error"),Lr(typeof e.exp<"u","internal-error"),Lr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Bx(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Md&&Ste(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Ste({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class _te{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class G3{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=bx(this.lastLoginAt),this.creationTime=bx(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function z1(t){const e=t.auth,r=await t.getIdToken(),n=await Bx(t,U1(e,{idToken:r}));Lr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?z$(i.providerUserInfo):[],o=Ate(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!o?.length,u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new G3(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function Cte(t){const e=zc(t);await z1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ate(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function z$(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function Ete(t,e){const r=await F$(t,{},async()=>{const n=wb({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await U$(t,i,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Mm(t.emulatorConfig.host)&&(c.credentials="include"),$$.fetch()(o,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Tte(t,e){return zu(t,"POST","/v2/accounts:revokeToken",Uu(t,e))}class Kp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lr(e.idToken,"internal-error"),Lr(typeof e.idToken<"u","internal-error"),Lr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kL(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Lr(e.length!==0,"internal-error");const r=kL(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Lr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await Ete(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new Kp;return n&&(Lr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(Lr(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Lr(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Kp,this.toJSON())}_performRefresh(){return xu("not implemented")}}function Eh(t,e){Lr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Tc{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new _te(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new G3(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Bx(this,this.stsTokenManager.getToken(this.auth,e));return Lr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return kte(this,e)}reload(){return Cte(this)}_assign(e){this!==e&&(Lr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Tc({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Lr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await z1(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(el(this.auth.app))return Promise.reject(ju(this.auth));const e=await this.getIdToken();return await Bx(this,Nte(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,o=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:x,isAnonymous:m,providerData:y,stsTokenManager:v}=r;Lr(p&&v,e,"internal-error");const j=Kp.fromJSON(this.name,v);Lr(typeof p=="string",e,"internal-error"),Eh(n,e.name),Eh(i,e.name),Lr(typeof x=="boolean",e,"internal-error"),Lr(typeof m=="boolean",e,"internal-error"),Eh(a,e.name),Eh(o,e.name),Eh(l,e.name),Eh(c,e.name),Eh(u,e.name),Eh(f,e.name);const N=new Tc({uid:p,auth:e,email:i,emailVerified:x,displayName:n,isAnonymous:m,photoURL:o,phoneNumber:a,tenantId:l,stsTokenManager:j,createdAt:u,lastLoginAt:f});return y&&Array.isArray(y)&&(N.providerData=y.map(C=>({...C}))),c&&(N._redirectEventId=c),N}static async _fromIdTokenResponse(e,r,n=!1){const i=new Kp;i.updateFromServerResponse(r);const a=new Tc({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await z1(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Lr(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?z$(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,l=new Kp;l.updateFromIdToken(n);const c=new Tc({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new G3(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,u),c}}const SL=new Map;function bu(t){Eu(t instanceof Function,"Expected a class definition");let e=SL.get(t);return e?(Eu(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,SL.set(t,e),e)}class q${constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}q$.type="NONE";const _L=q$;function u1(t,e,r){return`firebase:${t}:${e}:${r}`}class Xp{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=u1(this.userKey,i.apiKey,a),this.fullPersistenceKey=u1("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await U1(this.auth,{idToken:e}).catch(()=>{});return r?Tc._fromGetAccountInfoResponse(this.auth,r,e):null}return Tc._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Xp(bu(_L),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=i[0]||bu(_L);const o=u1(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const f=await u._get(o);if(f){let p;if(typeof f=="string"){const x=await U1(e,{idToken:f}).catch(()=>{});if(!x)break;p=await Tc._fromGetAccountInfoResponse(e,x,f)}else p=Tc._fromJSON(e,f);u!==a&&(l=p),a=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new Xp(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(o)}catch{}})),new Xp(a,e,n))}}function CL(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(V$(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(H$(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(K$(e))return"Blackberry";if(X$(e))return"Webos";if(W$(e))return"Safari";if((e.includes("chrome/")||G$(e))&&!e.includes("edge/"))return"Chrome";if(Y$(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function H$(t=ko()){return/firefox\//i.test(t)}function W$(t=ko()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function G$(t=ko()){return/crios\//i.test(t)}function V$(t=ko()){return/iemobile/i.test(t)}function Y$(t=ko()){return/android/i.test(t)}function K$(t=ko()){return/blackberry/i.test(t)}function X$(t=ko()){return/webos/i.test(t)}function v6(t=ko()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Lte(t=ko()){return v6(t)&&!!window.navigator?.standalone}function Ote(){return GQ()&&document.documentMode===10}function J$(t=ko()){return v6(t)||Y$(t)||X$(t)||K$(t)||/windows phone/i.test(t)||V$(t)}function Z$(t,e=[]){let r;switch(t){case"Browser":r=CL(ko());break;case"Worker":r=`${CL(ko())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${E0}/${n}`}class Mte{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function Pte(t,e={}){return zu(t,"GET","/v2/passwordPolicy",Uu(t,e))}const Ite=6;class Rte{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Ite,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Dte{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AL(this),this.idTokenSubscription=new AL(this),this.beforeStateQueue=new Mte(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B$,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=bu(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xp.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await U1(this,{idToken:e}),n=await Tc._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(el(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Lr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await z1(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=mte()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(el(this.app))return Promise.reject(ju(this));const r=e?zc(e):null;return r&&Lr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Lr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return el(this.app)?Promise.reject(ju(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return el(this.app)?Promise.reject(ju(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Pte(this),r=new Rte(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vb("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Tte(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&bu(e)||this._popupRedirectResolver;Lr(r,this,"argument-error"),this.redirectPersistenceManager=await Xp.create(this,[bu(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lr(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Z$(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(el(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ute(`Error while retrieving App Check token: ${e.error}`),e?.token}}function qu(t){return zc(t)}class AL{constructor(e){this.auth=e,this.observer=null,this.addObserver=QQ(r=>this.observer=r)}get next(){return Lr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Bte(t){xw=t}function Q$(t){return xw.loadJS(t)}function $te(){return xw.recaptchaEnterpriseScript}function Fte(){return xw.gapiScript}function Ute(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class zte{constructor(){this.enterprise=new qte}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class qte{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const Hte="recaptcha-enterprise",eF="NO_RECAPTCHA";class Wte{constructor(e){this.type=Hte,this.auth=qu(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{jte(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new wte(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(a,o,l){const c=window.grecaptcha;NL(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{o(u)}).catch(()=>{o(eF)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new zte().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&NL(window.grecaptcha))i(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=$te();c.length!==0&&(c+=l),Q$(c).then(()=>{i(l,a,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function EL(t,e,r,n=!1,i=!1){const a=new Wte(t);let o;if(i)o=eF;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const l={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function q1(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await EL(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await EL(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}function Gte(t,e){const r=gw(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(i0(a,e??{}))return i;Zl(i,"already-initialized")}return r.initialize({options:e})}function Vte(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(bu);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Yte(t,e,r){const n=qu(t);Lr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=tF(e),{host:o,port:l}=Kte(e),c=l===null?"":`:${l}`,u={url:`${a}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Lr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Lr(i0(u,n.config.emulator)&&i0(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,Mm(o)?(u6(`${a}//${o}${c}`),h6("Auth",!0)):Xte()}function tF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Kte(t){const e=tF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:TL(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:TL(o)}}}function TL(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Xte(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class w6{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return xu("not implemented")}_getIdTokenResponse(e){return xu("not implemented")}_linkToIdToken(e,r){return xu("not implemented")}_getReauthenticationResolver(e){return xu("not implemented")}}async function Jte(t,e){return zu(t,"POST","/v1/accounts:signUp",e)}async function Zte(t,e){return Nb(t,"POST","/v1/accounts:signInWithPassword",Uu(t,e))}async function rF(t,e){return zu(t,"POST","/v1/accounts:sendOobCode",Uu(t,e))}async function Qte(t,e){return rF(t,e)}async function ere(t,e){return rF(t,e)}async function tre(t,e){return Nb(t,"POST","/v1/accounts:signInWithEmailLink",Uu(t,e))}async function rre(t,e){return Nb(t,"POST","/v1/accounts:signInWithEmailLink",Uu(t,e))}class $x extends w6{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new $x(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new $x(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return q1(e,r,"signInWithPassword",Zte);case"emailLink":return tre(e,{email:this._email,oobCode:this._password});default:Zl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return q1(e,n,"signUpPassword",Jte);case"emailLink":return rre(e,{idToken:r,email:this._email,oobCode:this._password});default:Zl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jp(t,e){return Nb(t,"POST","/v1/accounts:signInWithIdp",Uu(t,e))}const nre="http://localhost";class o0 extends w6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new o0(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Zl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const o=new o0(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return Jp(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Jp(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Jp(e,r)}buildRequest(){const e={requestUri:nre,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=wb(r)}return e}}function sre(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ire(t){const e=ix(ax(t)).link,r=e?ix(ax(e)).deep_link_id:null,n=ix(ax(t)).deep_link_id;return(n?ix(ax(n)).link:null)||n||r||e||t}class j6{constructor(e){const r=ix(ax(e)),n=r.apiKey??null,i=r.oobCode??null,a=sre(r.mode??null);Lr(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=ire(e);try{return new j6(r)}catch{return null}}}class Pm{constructor(){this.providerId=Pm.PROVIDER_ID}static credential(e,r){return $x._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=j6.parseLink(r);return Lr(n,"argument-error"),$x._fromEmailAndCode(e,n.code,n.tenantId)}}Pm.PROVIDER_ID="password";Pm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class N6{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class kb extends N6{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Bh extends kb{constructor(){super("facebook.com")}static credential(e){return o0._fromParams({providerId:Bh.PROVIDER_ID,signInMethod:Bh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bh.credentialFromTaggedObject(e)}static credentialFromError(e){return Bh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bh.credential(e.oauthAccessToken)}catch{return null}}}Bh.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bh.PROVIDER_ID="facebook.com";class uu extends kb{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return o0._fromParams({providerId:uu.PROVIDER_ID,signInMethod:uu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return uu.credentialFromTaggedObject(e)}static credentialFromError(e){return uu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return uu.credential(r,n)}catch{return null}}}uu.GOOGLE_SIGN_IN_METHOD="google.com";uu.PROVIDER_ID="google.com";class $h extends kb{constructor(){super("github.com")}static credential(e){return o0._fromParams({providerId:$h.PROVIDER_ID,signInMethod:$h.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $h.credentialFromTaggedObject(e)}static credentialFromError(e){return $h.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $h.credential(e.oauthAccessToken)}catch{return null}}}$h.GITHUB_SIGN_IN_METHOD="github.com";$h.PROVIDER_ID="github.com";class Fh extends kb{constructor(){super("twitter.com")}static credential(e,r){return o0._fromParams({providerId:Fh.PROVIDER_ID,signInMethod:Fh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Fh.credentialFromTaggedObject(e)}static credentialFromError(e){return Fh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Fh.credential(r,n)}catch{return null}}}Fh.TWITTER_SIGN_IN_METHOD="twitter.com";Fh.PROVIDER_ID="twitter.com";async function are(t,e){return Nb(t,"POST","/v1/accounts:signUp",Uu(t,e))}class l0{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Tc._fromIdTokenResponse(e,n,i),o=LL(n);return new l0({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=LL(n);return new l0({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function LL(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class H1 extends Md{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,H1.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new H1(e,r,n,i)}}function nF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?H1._fromErrorAndOperation(t,a,e,n):a})}async function ore(t,e,r=!1){const n=await Bx(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return l0._forOperation(t,"link",n)}async function lre(t,e,r=!1){const{auth:n}=t;if(el(n.app))return Promise.reject(ju(n));const i="reauthenticate";try{const a=await Bx(t,nF(n,i,e,t),r);Lr(a.idToken,n,"internal-error");const o=y6(a.idToken);Lr(o,n,"internal-error");const{sub:l}=o;return Lr(t.uid===l,n,"user-mismatch"),l0._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Zl(n,"user-mismatch"),a}}async function sF(t,e,r=!1){if(el(t.app))return Promise.reject(ju(t));const n="signIn",i=await nF(t,n,e),a=await l0._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function cre(t,e){return sF(qu(t),e)}async function iF(t){const e=qu(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function dre(t,e,r){const n=qu(t);await q1(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",ere)}async function ure(t,e,r){if(el(t.app))return Promise.reject(ju(t));const n=qu(t),o=await q1(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",are).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&iF(t),c}),l=await l0._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function hre(t,e,r){return el(t.app)?Promise.reject(ju(t)):cre(zc(t),Pm.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&iF(t),n})}async function fre(t,e){const r=zc(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await Qte(r.auth,i);a!==t.email&&await t.reload()}function pre(t,e,r,n){return zc(t).onIdTokenChanged(e,r,n)}function mre(t,e,r){return zc(t).beforeAuthStateChanged(e,r)}function gre(t,e,r,n){return zc(t).onAuthStateChanged(e,r,n)}function xre(t){return zc(t).signOut()}const W1="__sak";class aF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(W1,"1"),this.storage.removeItem(W1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const bre=1e3,yre=10;class oF extends aF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=J$(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);Ote()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,yre):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},bre)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}oF.type="LOCAL";const vre=oF;class lF extends aF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}lF.type="SESSION";const cF=lF;function wre(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class bw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new bw(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(o).map(async u=>u(r.origin,a)),c=await wre(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bw.receivers=[];function k6(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class jre{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const u=k6("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(p){const x=p;if(x.data.eventId===u)switch(x.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(x.data.response);break;default:clearTimeout(f),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function yd(){return window}function Nre(t){yd().location.href=t}function dF(){return typeof yd().WorkerGlobalScope<"u"&&typeof yd().importScripts=="function"}async function kre(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Sre(){return navigator?.serviceWorker?.controller||null}function _re(){return dF()?self:null}const uF="firebaseLocalStorageDb",Cre=1,G1="firebaseLocalStorage",hF="fbase_key";class Sb{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function yw(t,e){return t.transaction([G1],e?"readwrite":"readonly").objectStore(G1)}function Are(){const t=indexedDB.deleteDatabase(uF);return new Sb(t).toPromise()}function V3(){const t=indexedDB.open(uF,Cre);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(G1,{keyPath:hF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(G1)?e(n):(n.close(),await Are(),e(await V3()))})})}async function OL(t,e,r){const n=yw(t,!0).put({[hF]:e,value:r});return new Sb(n).toPromise()}async function Ere(t,e){const r=yw(t,!1).get(e),n=await new Sb(r).toPromise();return n===void 0?null:n.value}function ML(t,e){const r=yw(t,!0).delete(e);return new Sb(r).toPromise()}const Tre=800,Lre=3;class fF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await V3(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Lre)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bw._getInstance(_re()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await kre(),!this.activeServiceWorker)return;this.sender=new jre(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Sre()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await V3();return await OL(e,W1,"1"),await ML(e,W1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>OL(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Ere(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>ML(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=yw(i,!1).getAll();return new Sb(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Tre)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fF.type="LOCAL";const Ore=fF;new jb(3e4,6e4);function pF(t,e){return e?bu(e):(Lr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class S6 extends w6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Jp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Jp(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Mre(t){return sF(t.auth,new S6(t),t.bypassAuthState)}function Pre(t){const{auth:e,user:r}=t;return Lr(r,e,"internal-error"),lre(r,new S6(t),t.bypassAuthState)}async function Ire(t){const{auth:e,user:r}=t;return Lr(r,e,"internal-error"),ore(r,new S6(t),t.bypassAuthState)}class mF{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mre;case"linkViaPopup":case"linkViaRedirect":return Ire;case"reauthViaPopup":case"reauthViaRedirect":return Pre;default:Zl(this.auth,"internal-error")}}resolve(e){Eu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Eu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Rre=new jb(2e3,1e4);async function Dre(t,e,r){if(el(t.app))return Promise.reject(Mc(t,"operation-not-supported-in-this-environment"));const n=qu(t);hte(t,e,N6);const i=pF(n,r);return new Hf(n,"signInViaPopup",e,i).executeNotNull()}class Hf extends mF{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Hf.currentPopupAction&&Hf.currentPopupAction.cancel(),Hf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lr(e,this.auth,"internal-error"),e}async onExecution(){Eu(this.filter.length===1,"Popup operations only handle one event");const e=k6();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Mc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Mc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hf.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Rre.get())};e()}}Hf.currentPopupAction=null;const Bre="pendingRedirect",h1=new Map;class $re extends mF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=h1.get(this.auth._key());if(!e){try{const n=await Fre(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}h1.set(this.auth._key(),e)}return this.bypassAuthState||h1.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Fre(t,e){const r=qre(e),n=zre(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function Ure(t,e){h1.set(t._key(),e)}function zre(t){return bu(t._redirectPersistence)}function qre(t){return u1(Bre,t.config.apiKey,t.name)}async function Hre(t,e,r=!1){if(el(t.app))return Promise.reject(ju(t));const n=qu(t),i=pF(n,e),o=await new $re(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const Wre=600*1e3;class Gre{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vre(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!gF(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Mc(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wre&&this.cachedEventUids.clear(),this.cachedEventUids.has(PL(e))}saveEventToCache(e){this.cachedEventUids.add(PL(e)),this.lastProcessedEventTime=Date.now()}}function PL(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gF({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Vre(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gF(t);default:return!1}}async function Yre(t,e={}){return zu(t,"GET","/v1/projects",e)}const Kre=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xre=/^https?/;async function Jre(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Yre(t);for(const r of e)try{if(Zre(r))return}catch{}Zl(t,"unauthorized-domain")}function Zre(t){const e=W3(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Xre.test(r))return!1;if(Kre.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const Qre=new jb(3e4,6e4);function IL(){const t=yd().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function ene(t){return new Promise((e,r)=>{function n(){IL(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IL(),r(Mc(t,"network-request-failed"))},timeout:Qre.get()})}if(yd().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(yd().gapi?.load)n();else{const i=Ute("iframefcb");return yd()[i]=()=>{gapi.load?n():r(Mc(t,"network-request-failed"))},Q$(`${Fte()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw f1=null,e})}let f1=null;function tne(t){return f1=f1||ene(t),f1}const rne=new jb(5e3,15e3),nne="__/auth/iframe",sne="emulator/auth/iframe",ine={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ane=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function one(t){const e=t.config;Lr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?b6(e,sne):`https://${t.config.authDomain}/${nne}`,n={apiKey:e.apiKey,appName:t.name,v:E0},i=ane.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${wb(n).slice(1)}`}async function lne(t){const e=await tne(t),r=yd().gapi;return Lr(r,t,"internal-error"),e.open({where:document.body,url:one(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ine,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=Mc(t,"network-request-failed"),l=yd().setTimeout(()=>{a(o)},rne.get());function c(){yd().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{a(o)})}))}const cne={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dne=500,une=600,hne="_blank",fne="http://localhost";class RL{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pne(t,e,r,n=dne,i=une){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...cne,width:n.toString(),height:i.toString(),top:a,left:o},u=ko().toLowerCase();r&&(l=G$(u)?hne:r),H$(u)&&(e=e||fne,c.scrollbars="yes");const f=Object.entries(c).reduce((x,[m,y])=>`${x}${m}=${y},`,"");if(Lte(u)&&l!=="_self")return mne(e||"",l),new RL(null);const p=window.open(e||"",l,f);Lr(p,t,"popup-blocked");try{p.focus()}catch{}return new RL(p)}function mne(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const gne="__/auth/handler",xne="emulator/auth/handler",bne=encodeURIComponent("fac");async function DL(t,e,r,n,i,a){Lr(t.config.authDomain,t,"auth-domain-config-required"),Lr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:E0,eventId:i};if(e instanceof N6){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ZQ(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof kb){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${bne}=${encodeURIComponent(c)}`:"";return`${yne(t)}?${wb(l).slice(1)}${u}`}function yne({config:t}){return t.emulator?b6(t,xne):`https://${t.authDomain}/${gne}`}const vj="webStorageSupport";class vne{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cF,this._completeRedirectFn=Hre,this._overrideRedirectResult=Ure}async _openPopup(e,r,n,i){Eu(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await DL(e,r,n,W3(),i);return pne(e,a,k6())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await DL(e,r,n,W3(),i);return Nre(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Eu(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await lne(e),n=new Gre(e);return r.register("authEvent",i=>(Lr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(vj,{type:vj},i=>{const a=i?.[0]?.[vj];a!==void 0&&r(!!a),Zl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Jre(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return J$()||W$()||v6()}}const wne=vne;var BL="@firebase/auth",$L="1.12.0";class jne{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Lr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Nne(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kne(t){a0(new rf("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Lr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Z$(t)},u=new Dte(n,i,a,c);return Vte(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),a0(new rf("auth-internal",e=>{const r=qu(e.getProvider("auth").getImmediate());return(n=>new jne(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),bd(BL,$L,Nne(t)),bd(BL,$L,"esm2020")}const Sne=300,_ne=T$("authIdTokenMaxAge")||Sne;let FL=null;const Cne=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>_ne)return;const i=r?.token;FL!==i&&(FL=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Ane(t=m6()){const e=gw(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Gte(t,{popupRedirectResolver:wne,persistence:[Ore,vre,cF]}),n=T$("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Cne(a.toString());mre(r,o,()=>o(r.currentUser)),pre(r,l=>o(l))}}const i=C$("auth");return i&&Yte(r,`http://${i}`),r}function Ene(){return document.getElementsByTagName("head")?.[0]??document}Bte({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Mc("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",Ene().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kne("Browser");const xF="firebasestorage.googleapis.com",Tne="storageBucket",Lne=120*1e3,One=600*1e3;class Pd extends Md{constructor(e,r,n=0){super(wj(e),`Firebase Storage: ${r} (${wj(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Pd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return wj(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kd;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kd||(kd={}));function wj(t){return"storage/"+t}function Mne(){const t="An unknown error occurred, please check the error payload for server response.";return new Pd(kd.UNKNOWN,t)}function Pne(){return new Pd(kd.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ine(){return new Pd(kd.CANCELED,"User canceled the upload/download.")}function Rne(t){return new Pd(kd.INVALID_URL,"Invalid URL '"+t+"'.")}function Dne(t){return new Pd(kd.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function UL(t){return new Pd(kd.INVALID_ARGUMENT,t)}function bF(){return new Pd(kd.APP_DELETED,"The Firebase app was deleted.")}function Bne(t){return new Pd(kd.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Lc{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Lc.makeFromUrl(e,r)}catch{return new Lc(e,"")}if(n.path==="")return n;throw Dne(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=r.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",m=new RegExp(`^https?://${p}/${f}/b/${i}/o${x}`,"i"),y={bucket:1,path:3},v=r===xF?"(?:storage.googleapis.com|storage.cloud.google.com)":r,j="([^?#]*)",N=new RegExp(`^https?://${v}/${i}/${j}`,"i"),A=[{regex:l,indices:c,postModify:a},{regex:m,indices:y,postModify:u},{regex:N,indices:{bucket:1,path:2},postModify:u}];for(let L=0;L<A.length;L++){const O=A[L],F=O.regex.exec(e);if(F){const T=F[O.indices.bucket];let I=F[O.indices.path];I||(I=""),n=new Lc(T,I),O.postModify(n);break}}if(n==null)throw Rne(e);return n}}class $ne{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Fne(t,e,r){let n=1,i=null,a=null,o=!1,l=0;function c(){return l===2}let u=!1;function f(...j){u||(u=!0,e.apply(null,j))}function p(j){i=setTimeout(()=>{i=null,t(m,c())},j)}function x(){a&&clearTimeout(a)}function m(j,...N){if(u){x();return}if(j){x(),f.call(null,j,...N);return}if(c()||o){x(),f.call(null,j,...N);return}n<64&&(n*=2);let A;l===1?(l=2,A=0):A=(n+Math.random())*1e3,p(A)}let y=!1;function v(j){y||(y=!0,x(),!u&&(i!==null?(j||(l=2),clearTimeout(i),p(0)):j||(l=1)))}return p(0),a=setTimeout(()=>{o=!0,v(!0)},r),v}function Une(t){t(!1)}function zne(t){return t!==void 0}function zL(t,e,r,n){if(n<e)throw UL(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw UL(`Invalid value for '${t}'. Expected ${r} or less.`)}function qne(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var V1;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(V1||(V1={}));function Hne(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}class Wne{constructor(e,r,n,i,a,o,l,c,u,f,p,x=!0,m=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=p,this.retry=x,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,v)=>{this.resolve_=y,this.reject_=v,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new av(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const l=a.getErrorCode()===V1.NO_ERROR,c=a.getStatus();if(!l||Hne(c,this.additionalRetryCodes_)&&this.retry){const f=a.getErrorCode()===V1.ABORT;n(!1,new av(!1,null,f));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new av(u,a))})},r=(n,i)=>{const a=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());zne(c)?a(c):a()}catch(c){o(c)}else if(l!==null){const c=Mne();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(i.canceled){const c=this.appDelete_?bF():Ine();o(c)}else{const c=Pne();o(c)}};this.canceled_?r(!1,new av(!1,null,!0)):this.backoffId_=Fne(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Une(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class av{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function Gne(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Vne(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Yne(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Kne(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Xne(t,e,r,n,i,a,o=!0,l=!1){const c=qne(t.urlParams),u=t.url+c,f=Object.assign({},t.headers);return Yne(f,e),Gne(f,r),Vne(f,a),Kne(f,n),new Wne(u,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,l)}function Jne(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Zne(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class Y1{constructor(e,r){this._service=e,r instanceof Lc?this._location=r:this._location=Lc.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Y1(e,r)}get root(){const e=new Lc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Zne(this._location.path)}get storage(){return this._service}get parent(){const e=Jne(this._location.path);if(e===null)return null;const r=new Lc(this._location.bucket,e);return new Y1(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw Bne(e)}}function qL(t,e){const r=e?.[Tne];return r==null?null:Lc.makeFromBucketSpec(r,t)}function Qne(t,e,r,n={}){t.host=`${e}:${r}`;const i=Mm(e);i&&(u6(`https://${t.host}/b`),h6("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:L$(a,t.app.options.projectId))}class ese{constructor(e,r,n,i,a,o=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=o,this._bucket=null,this._host=xF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Lne,this._maxUploadRetryTime=One,this._requests=new Set,i!=null?this._bucket=Lc.makeFromBucketSpec(i,this._host):this._bucket=qL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Lc.makeFromBucketSpec(this._url,e):this._bucket=qL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){zL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){zL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(el(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Y1(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new $ne(bF());{const o=Xne(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const HL="@firebase/storage",WL="0.14.0";const yF="storage";function tse(t=m6(),e){t=zc(t);const n=gw(t,yF).getImmediate({identifier:e}),i=A$("storage");return i&&rse(n,...i),n}function rse(t,e,r,n={}){Qne(t,e,r,n)}function nse(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new ese(r,n,i,e,E0)}function sse(){a0(new rf(yF,nse,"PUBLIC").setMultipleInstances(!0)),bd(HL,WL,""),bd(HL,WL,"esm2020")}sse();var ise="firebase",ase="12.7.0";bd(ise,ase,"app");var GL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var _6;(function(){var t;function e(T,I){function B(){}B.prototype=I.prototype,T.F=I.prototype,T.prototype=new B,T.prototype.constructor=T,T.D=function($,k,R){for(var P=Array(arguments.length-2),q=2;q<arguments.length;q++)P[q-2]=arguments[q];return I.prototype[k].apply($,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,I,B){B||(B=0);const $=Array(16);if(typeof I=="string")for(var k=0;k<16;++k)$[k]=I.charCodeAt(B++)|I.charCodeAt(B++)<<8|I.charCodeAt(B++)<<16|I.charCodeAt(B++)<<24;else for(k=0;k<16;++k)$[k]=I[B++]|I[B++]<<8|I[B++]<<16|I[B++]<<24;I=T.g[0],B=T.g[1],k=T.g[2];let R=T.g[3],P;P=I+(R^B&(k^R))+$[0]+3614090360&4294967295,I=B+(P<<7&4294967295|P>>>25),P=R+(k^I&(B^k))+$[1]+3905402710&4294967295,R=I+(P<<12&4294967295|P>>>20),P=k+(B^R&(I^B))+$[2]+606105819&4294967295,k=R+(P<<17&4294967295|P>>>15),P=B+(I^k&(R^I))+$[3]+3250441966&4294967295,B=k+(P<<22&4294967295|P>>>10),P=I+(R^B&(k^R))+$[4]+4118548399&4294967295,I=B+(P<<7&4294967295|P>>>25),P=R+(k^I&(B^k))+$[5]+1200080426&4294967295,R=I+(P<<12&4294967295|P>>>20),P=k+(B^R&(I^B))+$[6]+2821735955&4294967295,k=R+(P<<17&4294967295|P>>>15),P=B+(I^k&(R^I))+$[7]+4249261313&4294967295,B=k+(P<<22&4294967295|P>>>10),P=I+(R^B&(k^R))+$[8]+1770035416&4294967295,I=B+(P<<7&4294967295|P>>>25),P=R+(k^I&(B^k))+$[9]+2336552879&4294967295,R=I+(P<<12&4294967295|P>>>20),P=k+(B^R&(I^B))+$[10]+4294925233&4294967295,k=R+(P<<17&4294967295|P>>>15),P=B+(I^k&(R^I))+$[11]+2304563134&4294967295,B=k+(P<<22&4294967295|P>>>10),P=I+(R^B&(k^R))+$[12]+1804603682&4294967295,I=B+(P<<7&4294967295|P>>>25),P=R+(k^I&(B^k))+$[13]+4254626195&4294967295,R=I+(P<<12&4294967295|P>>>20),P=k+(B^R&(I^B))+$[14]+2792965006&4294967295,k=R+(P<<17&4294967295|P>>>15),P=B+(I^k&(R^I))+$[15]+1236535329&4294967295,B=k+(P<<22&4294967295|P>>>10),P=I+(k^R&(B^k))+$[1]+4129170786&4294967295,I=B+(P<<5&4294967295|P>>>27),P=R+(B^k&(I^B))+$[6]+3225465664&4294967295,R=I+(P<<9&4294967295|P>>>23),P=k+(I^B&(R^I))+$[11]+643717713&4294967295,k=R+(P<<14&4294967295|P>>>18),P=B+(R^I&(k^R))+$[0]+3921069994&4294967295,B=k+(P<<20&4294967295|P>>>12),P=I+(k^R&(B^k))+$[5]+3593408605&4294967295,I=B+(P<<5&4294967295|P>>>27),P=R+(B^k&(I^B))+$[10]+38016083&4294967295,R=I+(P<<9&4294967295|P>>>23),P=k+(I^B&(R^I))+$[15]+3634488961&4294967295,k=R+(P<<14&4294967295|P>>>18),P=B+(R^I&(k^R))+$[4]+3889429448&4294967295,B=k+(P<<20&4294967295|P>>>12),P=I+(k^R&(B^k))+$[9]+568446438&4294967295,I=B+(P<<5&4294967295|P>>>27),P=R+(B^k&(I^B))+$[14]+3275163606&4294967295,R=I+(P<<9&4294967295|P>>>23),P=k+(I^B&(R^I))+$[3]+4107603335&4294967295,k=R+(P<<14&4294967295|P>>>18),P=B+(R^I&(k^R))+$[8]+1163531501&4294967295,B=k+(P<<20&4294967295|P>>>12),P=I+(k^R&(B^k))+$[13]+2850285829&4294967295,I=B+(P<<5&4294967295|P>>>27),P=R+(B^k&(I^B))+$[2]+4243563512&4294967295,R=I+(P<<9&4294967295|P>>>23),P=k+(I^B&(R^I))+$[7]+1735328473&4294967295,k=R+(P<<14&4294967295|P>>>18),P=B+(R^I&(k^R))+$[12]+2368359562&4294967295,B=k+(P<<20&4294967295|P>>>12),P=I+(B^k^R)+$[5]+4294588738&4294967295,I=B+(P<<4&4294967295|P>>>28),P=R+(I^B^k)+$[8]+2272392833&4294967295,R=I+(P<<11&4294967295|P>>>21),P=k+(R^I^B)+$[11]+1839030562&4294967295,k=R+(P<<16&4294967295|P>>>16),P=B+(k^R^I)+$[14]+4259657740&4294967295,B=k+(P<<23&4294967295|P>>>9),P=I+(B^k^R)+$[1]+2763975236&4294967295,I=B+(P<<4&4294967295|P>>>28),P=R+(I^B^k)+$[4]+1272893353&4294967295,R=I+(P<<11&4294967295|P>>>21),P=k+(R^I^B)+$[7]+4139469664&4294967295,k=R+(P<<16&4294967295|P>>>16),P=B+(k^R^I)+$[10]+3200236656&4294967295,B=k+(P<<23&4294967295|P>>>9),P=I+(B^k^R)+$[13]+681279174&4294967295,I=B+(P<<4&4294967295|P>>>28),P=R+(I^B^k)+$[0]+3936430074&4294967295,R=I+(P<<11&4294967295|P>>>21),P=k+(R^I^B)+$[3]+3572445317&4294967295,k=R+(P<<16&4294967295|P>>>16),P=B+(k^R^I)+$[6]+76029189&4294967295,B=k+(P<<23&4294967295|P>>>9),P=I+(B^k^R)+$[9]+3654602809&4294967295,I=B+(P<<4&4294967295|P>>>28),P=R+(I^B^k)+$[12]+3873151461&4294967295,R=I+(P<<11&4294967295|P>>>21),P=k+(R^I^B)+$[15]+530742520&4294967295,k=R+(P<<16&4294967295|P>>>16),P=B+(k^R^I)+$[2]+3299628645&4294967295,B=k+(P<<23&4294967295|P>>>9),P=I+(k^(B|~R))+$[0]+4096336452&4294967295,I=B+(P<<6&4294967295|P>>>26),P=R+(B^(I|~k))+$[7]+1126891415&4294967295,R=I+(P<<10&4294967295|P>>>22),P=k+(I^(R|~B))+$[14]+2878612391&4294967295,k=R+(P<<15&4294967295|P>>>17),P=B+(R^(k|~I))+$[5]+4237533241&4294967295,B=k+(P<<21&4294967295|P>>>11),P=I+(k^(B|~R))+$[12]+1700485571&4294967295,I=B+(P<<6&4294967295|P>>>26),P=R+(B^(I|~k))+$[3]+2399980690&4294967295,R=I+(P<<10&4294967295|P>>>22),P=k+(I^(R|~B))+$[10]+4293915773&4294967295,k=R+(P<<15&4294967295|P>>>17),P=B+(R^(k|~I))+$[1]+2240044497&4294967295,B=k+(P<<21&4294967295|P>>>11),P=I+(k^(B|~R))+$[8]+1873313359&4294967295,I=B+(P<<6&4294967295|P>>>26),P=R+(B^(I|~k))+$[15]+4264355552&4294967295,R=I+(P<<10&4294967295|P>>>22),P=k+(I^(R|~B))+$[6]+2734768916&4294967295,k=R+(P<<15&4294967295|P>>>17),P=B+(R^(k|~I))+$[13]+1309151649&4294967295,B=k+(P<<21&4294967295|P>>>11),P=I+(k^(B|~R))+$[4]+4149444226&4294967295,I=B+(P<<6&4294967295|P>>>26),P=R+(B^(I|~k))+$[11]+3174756917&4294967295,R=I+(P<<10&4294967295|P>>>22),P=k+(I^(R|~B))+$[2]+718787259&4294967295,k=R+(P<<15&4294967295|P>>>17),P=B+(R^(k|~I))+$[9]+3951481745&4294967295,T.g[0]=T.g[0]+I&4294967295,T.g[1]=T.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+R&4294967295}n.prototype.v=function(T,I){I===void 0&&(I=T.length);const B=I-this.blockSize,$=this.C;let k=this.h,R=0;for(;R<I;){if(k==0)for(;R<=B;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<I;)if($[k++]=T.charCodeAt(R++),k==this.blockSize){i(this,$),k=0;break}}else for(;R<I;)if($[k++]=T[R++],k==this.blockSize){i(this,$),k=0;break}}this.h=k,this.o+=I},n.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var I=1;I<T.length-8;++I)T[I]=0;I=this.o*8;for(var B=T.length-8;B<T.length;++B)T[B]=I&255,I/=256;for(this.v(T),T=Array(16),I=0,B=0;B<4;++B)for(let $=0;$<32;$+=8)T[I++]=this.g[B]>>>$&255;return T};function a(T,I){var B=l;return Object.prototype.hasOwnProperty.call(B,T)?B[T]:B[T]=I(T)}function o(T,I){this.h=I;const B=[];let $=!0;for(let k=T.length-1;k>=0;k--){const R=T[k]|0;$&&R==I||(B[k]=R,$=!1)}this.g=B}var l={};function c(T){return-128<=T&&T<128?a(T,function(I){return new o([I|0],I<0?-1:0)}):new o([T|0],T<0?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return j(u(-T));const I=[];let B=1;for(let $=0;T>=B;$++)I[$]=T/B|0,B*=4294967296;return new o(I,0)}function f(T,I){if(T.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(T.charAt(0)=="-")return j(f(T.substring(1),I));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const B=u(Math.pow(I,8));let $=p;for(let R=0;R<T.length;R+=8){var k=Math.min(8,T.length-R);const P=parseInt(T.substring(R,R+k),I);k<8?(k=u(Math.pow(I,k)),$=$.j(k).add(u(P))):($=$.j(B),$=$.add(u(P)))}return $}var p=c(0),x=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(v(this))return-j(this).m();let T=0,I=1;for(let B=0;B<this.g.length;B++){const $=this.i(B);T+=($>=0?$:4294967296+$)*I,I*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(v(this))return"-"+j(this).toString(T);const I=u(Math.pow(T,6));var B=this;let $="";for(;;){const k=L(B,I).g;B=N(B,k.j(I));let R=((B.g.length>0?B.g[0]:B.h)>>>0).toString(T);if(B=k,y(B))return R+$;for(;R.length<6;)R="0"+R;$=R+$}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(let I=0;I<T.g.length;I++)if(T.g[I]!=0)return!1;return!0}function v(T){return T.h==-1}t.l=function(T){return T=N(this,T),v(T)?-1:y(T)?0:1};function j(T){const I=T.g.length,B=[];for(let $=0;$<I;$++)B[$]=~T.g[$];return new o(B,~T.h).add(x)}t.abs=function(){return v(this)?j(this):this},t.add=function(T){const I=Math.max(this.g.length,T.g.length),B=[];let $=0;for(let k=0;k<=I;k++){let R=$+(this.i(k)&65535)+(T.i(k)&65535),P=(R>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);$=P>>>16,R&=65535,P&=65535,B[k]=P<<16|R}return new o(B,B[B.length-1]&-2147483648?-1:0)};function N(T,I){return T.add(j(I))}t.j=function(T){if(y(this)||y(T))return p;if(v(this))return v(T)?j(this).j(j(T)):j(j(this).j(T));if(v(T))return j(this.j(j(T)));if(this.l(m)<0&&T.l(m)<0)return u(this.m()*T.m());const I=this.g.length+T.g.length,B=[];for(var $=0;$<2*I;$++)B[$]=0;for($=0;$<this.g.length;$++)for(let k=0;k<T.g.length;k++){const R=this.i($)>>>16,P=this.i($)&65535,q=T.i(k)>>>16,X=T.i(k)&65535;B[2*$+2*k]+=P*X,C(B,2*$+2*k),B[2*$+2*k+1]+=R*X,C(B,2*$+2*k+1),B[2*$+2*k+1]+=P*q,C(B,2*$+2*k+1),B[2*$+2*k+2]+=R*q,C(B,2*$+2*k+2)}for(T=0;T<I;T++)B[T]=B[2*T+1]<<16|B[2*T];for(T=I;T<2*I;T++)B[T]=0;return new o(B,0)};function C(T,I){for(;(T[I]&65535)!=T[I];)T[I+1]+=T[I]>>>16,T[I]&=65535,I++}function A(T,I){this.g=T,this.h=I}function L(T,I){if(y(I))throw Error("division by zero");if(y(T))return new A(p,p);if(v(T))return I=L(j(T),I),new A(j(I.g),j(I.h));if(v(I))return I=L(T,j(I)),new A(j(I.g),I.h);if(T.g.length>30){if(v(T)||v(I))throw Error("slowDivide_ only works with positive integers.");for(var B=x,$=I;$.l(T)<=0;)B=O(B),$=O($);var k=F(B,1),R=F($,1);for($=F($,2),B=F(B,2);!y($);){var P=R.add($);P.l(T)<=0&&(k=k.add(B),R=P),$=F($,1),B=F(B,1)}return I=N(T,k.j(I)),new A(k,I)}for(k=p;T.l(I)>=0;){for(B=Math.max(1,Math.floor(T.m()/I.m())),$=Math.ceil(Math.log(B)/Math.LN2),$=$<=48?1:Math.pow(2,$-48),R=u(B),P=R.j(I);v(P)||P.l(T)>0;)B-=$,R=u(B),P=R.j(I);y(R)&&(R=x),k=k.add(R),T=N(T,P)}return new A(k,T)}t.B=function(T){return L(this,T).h},t.and=function(T){const I=Math.max(this.g.length,T.g.length),B=[];for(let $=0;$<I;$++)B[$]=this.i($)&T.i($);return new o(B,this.h&T.h)},t.or=function(T){const I=Math.max(this.g.length,T.g.length),B=[];for(let $=0;$<I;$++)B[$]=this.i($)|T.i($);return new o(B,this.h|T.h)},t.xor=function(T){const I=Math.max(this.g.length,T.g.length),B=[];for(let $=0;$<I;$++)B[$]=this.i($)^T.i($);return new o(B,this.h^T.h)};function O(T){const I=T.g.length+1,B=[];for(let $=0;$<I;$++)B[$]=T.i($)<<1|T.i($-1)>>>31;return new o(B,T.h)}function F(T,I){const B=I>>5;I%=32;const $=T.g.length-B,k=[];for(let R=0;R<$;R++)k[R]=I>0?T.i(R+B)>>>I|T.i(R+B+1)<<32-I:T.i(R+B);return new o(k,T.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,_6=o}).apply(typeof GL<"u"?GL:typeof self<"u"?self:typeof window<"u"?window:{});var ov=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var t,e=Object.defineProperty;function r(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof ov=="object"&&ov];for(var V=0;V<_.length;++V){var ie=_[V];if(ie&&ie.Math==Math)return ie}throw Error("Cannot find global object")}var n=r(this);function i(_,V){if(V)e:{var ie=n;_=_.split(".");for(var be=0;be<_.length-1;be++){var qe=_[be];if(!(qe in ie))break e;ie=ie[qe]}_=_[_.length-1],be=ie[_],V=V(be),V!=be&&V!=null&&e(ie,_,{configurable:!0,writable:!0,value:V})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(V){var ie=[],be;for(be in V)Object.prototype.hasOwnProperty.call(V,be)&&ie.push([be,V[be]]);return ie}});var a=a||{},o=this||self;function l(_){var V=typeof _;return V=="object"&&_!=null||V=="function"}function c(_,V,ie){return _.call.apply(_.bind,arguments)}function u(_,V,ie){return u=c,u.apply(null,arguments)}function f(_,V){var ie=Array.prototype.slice.call(arguments,1);return function(){var be=ie.slice();return be.push.apply(be,arguments),_.apply(this,be)}}function p(_,V){function ie(){}ie.prototype=V.prototype,_.Z=V.prototype,_.prototype=new ie,_.prototype.constructor=_,_.Ob=function(be,qe,st){for(var Dt=Array(arguments.length-2),Ar=2;Ar<arguments.length;Ar++)Dt[Ar-2]=arguments[Ar];return V.prototype[qe].apply(be,Dt)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function m(_){const V=_.length;if(V>0){const ie=Array(V);for(let be=0;be<V;be++)ie[be]=_[be];return ie}return[]}function y(_,V){for(let be=1;be<arguments.length;be++){const qe=arguments[be];var ie=typeof qe;if(ie=ie!="object"?ie:qe?Array.isArray(qe)?"array":ie:"null",ie=="array"||ie=="object"&&typeof qe.length=="number"){ie=_.length||0;const st=qe.length||0;_.length=ie+st;for(let Dt=0;Dt<st;Dt++)_[ie+Dt]=qe[Dt]}else _.push(qe)}}class v{constructor(V,ie){this.i=V,this.j=ie,this.h=0,this.g=null}get(){let V;return this.h>0?(this.h--,V=this.g,this.g=V.next,V.next=null):V=this.i(),V}}function j(_){o.setTimeout(()=>{throw _},0)}function N(){var _=T;let V=null;return _.g&&(V=_.g,_.g=_.g.next,_.g||(_.h=null),V.next=null),V}class C{constructor(){this.h=this.g=null}add(V,ie){const be=A.get();be.set(V,ie),this.h?this.h.next=be:this.g=be,this.h=be}}var A=new v(()=>new L,_=>_.reset());class L{constructor(){this.next=this.g=this.h=null}set(V,ie){this.h=V,this.g=ie,this.next=null}reset(){this.next=this.g=this.h=null}}let O,F=!1,T=new C,I=()=>{const _=Promise.resolve(void 0);O=()=>{_.then(B)}};function B(){for(var _;_=N();){try{_.h.call(_.g)}catch(ie){j(ie)}var V=A;V.j(_),V.h<100&&(V.h++,_.next=V.g,V.g=_)}F=!1}function $(){this.u=this.u,this.C=this.C}$.prototype.u=!1,$.prototype.dispose=function(){this.u||(this.u=!0,this.N())},$.prototype[Symbol.dispose]=function(){this.dispose()},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(_,V){this.type=_,this.g=this.target=V,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var _=!1,V=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const ie=()=>{};o.addEventListener("test",ie,V),o.removeEventListener("test",ie,V)}catch{}return _})();function P(_){return/^[\s\xa0]*$/.test(_)}function q(_,V){k.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,V)}p(q,k),q.prototype.init=function(_,V){const ie=this.type=_.type,be=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=V,V=_.relatedTarget,V||(ie=="mouseover"?V=_.fromElement:ie=="mouseout"&&(V=_.toElement)),this.relatedTarget=V,be?(this.clientX=be.clientX!==void 0?be.clientX:be.pageX,this.clientY=be.clientY!==void 0?be.clientY:be.pageY,this.screenX=be.screenX||0,this.screenY=be.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&q.Z.h.call(this)},q.prototype.h=function(){q.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var X="closure_listenable_"+(Math.random()*1e6|0),G=0;function ne(_,V,ie,be,qe){this.listener=_,this.proxy=null,this.src=V,this.type=ie,this.capture=!!be,this.ha=qe,this.key=++G,this.da=this.fa=!1}function ee(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function se(_,V,ie){for(const be in _)V.call(ie,_[be],be,_)}function J(_,V){for(const ie in _)V.call(void 0,_[ie],ie,_)}function W(_){const V={};for(const ie in _)V[ie]=_[ie];return V}const U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(_,V){let ie,be;for(let qe=1;qe<arguments.length;qe++){be=arguments[qe];for(ie in be)_[ie]=be[ie];for(let st=0;st<U.length;st++)ie=U[st],Object.prototype.hasOwnProperty.call(be,ie)&&(_[ie]=be[ie])}}function te(_){this.src=_,this.g={},this.h=0}te.prototype.add=function(_,V,ie,be,qe){const st=_.toString();_=this.g[st],_||(_=this.g[st]=[],this.h++);const Dt=xe(_,V,be,qe);return Dt>-1?(V=_[Dt],ie||(V.fa=!1)):(V=new ne(V,this.src,st,!!be,qe),V.fa=ie,_.push(V)),V};function ce(_,V){const ie=V.type;if(ie in _.g){var be=_.g[ie],qe=Array.prototype.indexOf.call(be,V,void 0),st;(st=qe>=0)&&Array.prototype.splice.call(be,qe,1),st&&(ee(V),_.g[ie].length==0&&(delete _.g[ie],_.h--))}}function xe(_,V,ie,be){for(let qe=0;qe<_.length;++qe){const st=_[qe];if(!st.da&&st.listener==V&&st.capture==!!ie&&st.ha==be)return qe}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),ve={};function Q(_,V,ie,be,qe){if(Array.isArray(V)){for(let st=0;st<V.length;st++)Q(_,V[st],ie,be,qe);return null}return ie=ot(ie),_&&_[X]?_.J(V,ie,l(be)?!!be.capture:!1,qe):pe(_,V,ie,!1,be,qe)}function pe(_,V,ie,be,qe,st){if(!V)throw Error("Invalid event type");const Dt=l(qe)?!!qe.capture:!!qe;let Ar=De(_);if(Ar||(_[ue]=Ar=new te(_)),ie=Ar.add(V,ie,be,Dt,st),ie.proxy)return ie;if(be=Ce(),ie.proxy=be,be.src=_,be.listener=ie,_.addEventListener)R||(qe=Dt),qe===void 0&&(qe=!1),_.addEventListener(V.toString(),be,qe);else if(_.attachEvent)_.attachEvent(Te(V.toString()),be);else if(_.addListener&&_.removeListener)_.addListener(be);else throw Error("addEventListener and attachEvent are unavailable.");return ie}function Ce(){function _(ie){return V.call(_.src,_.listener,ie)}const V=oe;return _}function je(_,V,ie,be,qe){if(Array.isArray(V))for(var st=0;st<V.length;st++)je(_,V[st],ie,be,qe);else be=l(be)?!!be.capture:!!be,ie=ot(ie),_&&_[X]?(_=_.i,st=String(V).toString(),st in _.g&&(V=_.g[st],ie=xe(V,ie,be,qe),ie>-1&&(ee(V[ie]),Array.prototype.splice.call(V,ie,1),V.length==0&&(delete _.g[st],_.h--)))):_&&(_=De(_))&&(V=_.g[V.toString()],_=-1,V&&(_=xe(V,ie,be,qe)),(ie=_>-1?V[_]:null)&&we(ie))}function we(_){if(typeof _!="number"&&_&&!_.da){var V=_.src;if(V&&V[X])ce(V.i,_);else{var ie=_.type,be=_.proxy;V.removeEventListener?V.removeEventListener(ie,be,_.capture):V.detachEvent?V.detachEvent(Te(ie),be):V.addListener&&V.removeListener&&V.removeListener(be),(ie=De(V))?(ce(ie,_),ie.h==0&&(ie.src=null,V[ue]=null)):ee(_)}}}function Te(_){return _ in ve?ve[_]:ve[_]="on"+_}function oe(_,V){if(_.da)_=!0;else{V=new q(V,this);const ie=_.listener,be=_.ha||_.src;_.fa&&we(_),_=ie.call(be,V)}return _}function De(_){return _=_[ue],_ instanceof te?_:null}var Nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function ot(_){return typeof _=="function"?_:(_[Nt]||(_[Nt]=function(V){return _.handleEvent(V)}),_[Nt])}function Ne(){$.call(this),this.i=new te(this),this.M=this,this.G=null}p(Ne,$),Ne.prototype[X]=!0,Ne.prototype.removeEventListener=function(_,V,ie,be){je(this,_,V,ie,be)};function Ge(_,V){var ie,be=_.G;if(be)for(ie=[];be;be=be.G)ie.push(be);if(_=_.M,be=V.type||V,typeof V=="string")V=new k(V,_);else if(V instanceof k)V.target=V.target||_;else{var qe=V;V=new k(be,_),Y(V,qe)}qe=!0;let st,Dt;if(ie)for(Dt=ie.length-1;Dt>=0;Dt--)st=V.g=ie[Dt],qe=Xe(st,be,!0,V)&&qe;if(st=V.g=_,qe=Xe(st,be,!0,V)&&qe,qe=Xe(st,be,!1,V)&&qe,ie)for(Dt=0;Dt<ie.length;Dt++)st=V.g=ie[Dt],qe=Xe(st,be,!1,V)&&qe}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var _=this.i;for(const V in _.g){const ie=_.g[V];for(let be=0;be<ie.length;be++)ee(ie[be]);delete _.g[V],_.h--}}this.G=null},Ne.prototype.J=function(_,V,ie,be){return this.i.add(String(_),V,!1,ie,be)},Ne.prototype.K=function(_,V,ie,be){return this.i.add(String(_),V,!0,ie,be)};function Xe(_,V,ie,be){if(V=_.i.g[String(V)],!V)return!0;V=V.concat();let qe=!0;for(let st=0;st<V.length;++st){const Dt=V[st];if(Dt&&!Dt.da&&Dt.capture==ie){const Ar=Dt.listener,gs=Dt.ha||Dt.src;Dt.fa&&ce(_.i,Dt),qe=Ar.call(gs,be)!==!1&&qe}}return qe&&!be.defaultPrevented}function xt(_,V){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=u(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(V)>2147483647?-1:o.setTimeout(_,V||0)}function Ae(_){_.g=xt(()=>{_.g=null,_.i&&(_.i=!1,Ae(_))},_.l);const V=_.h;_.h=null,_.m.apply(null,V)}class Pe extends ${constructor(V,ie){super(),this.m=V,this.l=ie,this.h=null,this.i=!1,this.g=null}j(V){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ct(_){$.call(this),this.h=_,this.g={}}p(ct,$);var bt=[];function dt(_){se(_.g,function(V,ie){this.g.hasOwnProperty(ie)&&we(V)},_),_.g={}}ct.prototype.N=function(){ct.Z.N.call(this),dt(this)},ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ve=o.JSON.stringify,lt=o.JSON.parse,kt=class{stringify(_){return o.JSON.stringify(_,void 0)}parse(_){return o.JSON.parse(_,void 0)}};function Ue(){}function Bt(){}var zt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ot(){k.call(this,"d")}p(Ot,k);function Et(){k.call(this,"c")}p(Et,k);var $t={},At=null;function Xt(){return At=At||new Ne}$t.Ia="serverreachability";function qt(_){k.call(this,$t.Ia,_)}p(qt,k);function Ht(_){const V=Xt();Ge(V,new qt(V))}$t.STAT_EVENT="statevent";function jr(_,V){k.call(this,$t.STAT_EVENT,_),this.stat=V}p(jr,k);function Ct(_){const V=Xt();Ge(V,new jr(V,_))}$t.Ja="timingevent";function Tt(_,V){k.call(this,$t.Ja,_),this.size=V}p(Tt,k);function Yt(_,V){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){_()},V)}function Be(){this.g=!0}Be.prototype.ua=function(){this.g=!1};function Lt(_,V,ie,be,qe,st){_.info(function(){if(_.g)if(st){var Dt="",Ar=st.split("&");for(let un=0;un<Ar.length;un++){var gs=Ar[un].split("=");if(gs.length>1){const zn=gs[0];gs=gs[1];const zs=zn.split("_");Dt=zs.length>=2&&zs[1]=="type"?Dt+(zn+"="+gs+"&"):Dt+(zn+"=redacted&")}}}else Dt=null;else Dt=st;return"XMLHTTP REQ ("+be+") [attempt "+qe+"]: "+V+`
`+ie+`
`+Dt})}function Ft(_,V,ie,be,qe,st,Dt){_.info(function(){return"XMLHTTP RESP ("+be+") [ attempt "+qe+"]: "+V+`
`+ie+`
`+st+" "+Dt})}function Ee(_,V,ie,be){_.info(function(){return"XMLHTTP TEXT ("+V+"): "+Mt(_,ie)+(be?" "+be:"")})}function He(_,V){_.info(function(){return"TIMEOUT: "+V})}Be.prototype.info=function(){};function Mt(_,V){if(!_.g)return V;if(!V)return null;try{const st=JSON.parse(V);if(st){for(_=0;_<st.length;_++)if(Array.isArray(st[_])){var ie=st[_];if(!(ie.length<2)){var be=ie[1];if(Array.isArray(be)&&!(be.length<1)){var qe=be[0];if(qe!="noop"&&qe!="stop"&&qe!="close")for(let Dt=1;Dt<be.length;Dt++)be[Dt]=""}}}}return Ve(st)}catch{return V}}var Gt={NO_ERROR:0,TIMEOUT:8},Zt={},Ut;function It(){}p(It,Ue),It.prototype.g=function(){return new XMLHttpRequest},Ut=new It;function Vt(_){return encodeURIComponent(String(_))}function pr(_){var V=1;_=_.split(":");const ie=[];for(;V>0&&_.length;)ie.push(_.shift()),V--;return _.length&&ie.push(_.join(":")),ie}function en(_,V,ie,be){this.j=_,this.i=V,this.l=ie,this.S=be||1,this.V=new ct(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Yr}function Yr(){this.i=null,this.g="",this.h=!1}var $r={},Qr={};function pn(_,V,ie){_.M=1,_.A=_a(is(V)),_.u=ie,_.R=!0,Hr(_,null)}function Hr(_,V){_.F=Date.now(),$s(_),_.B=is(_.A);var ie=_.B,be=_.S;Array.isArray(be)||(be=[String(be)]),Po(ie.i,"t",be),_.C=0,ie=_.j.L,_.h=new Yr,_.g=tr(_.j,ie?V:null,!_.u),_.P>0&&(_.O=new Pe(u(_.Y,_,_.g),_.P)),V=_.V,ie=_.g,be=_.ba;var qe="readystatechange";Array.isArray(qe)||(qe&&(bt[0]=qe.toString()),qe=bt);for(let st=0;st<qe.length;st++){const Dt=Q(ie,qe[st],be||V.handleEvent,!1,V.h||V);if(!Dt)break;V.g[Dt.key]=Dt}V=_.J?W(_.J):{},_.u?(_.v||(_.v="POST"),V["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,V)):(_.v="GET",_.g.ea(_.B,_.v,null,V)),Ht(),Lt(_.i,_.v,_.B,_.l,_.S,_.u)}en.prototype.ba=function(_){_=_.target;const V=this.O;V&&Le(_)==3?V.j():this.Y(_)},en.prototype.Y=function(_){try{if(_==this.g)e:{const Ar=Le(this.g),gs=this.g.ya(),un=this.g.ca();if(!(Ar<3)&&(Ar!=3||this.g&&(this.h.h||this.g.la()||at(this.g)))){this.K||Ar!=4||gs==7||(gs==8||un<=0?Ht(3):Ht(2)),jn(this);var V=this.g.ca();this.X=V;var ie=ss(this);if(this.o=V==200,Ft(this.i,this.v,this.B,this.l,this.S,Ar,V),this.o){if(this.U&&!this.L){t:{if(this.g){var be,qe=this.g;if((be=qe.g?qe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(be)){var st=be;break t}}st=null}if(_=st)Ee(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ht(this,_);else{this.o=!1,this.m=3,Ct(12),rt(this),ze(this);break e}}if(this.R){_=!0;let zn;for(;!this.K&&this.C<ie.length;)if(zn=wi(this,ie),zn==Qr){Ar==4&&(this.m=4,Ct(14),_=!1),Ee(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==$r){this.m=4,Ct(15),Ee(this.i,this.l,ie,"[Invalid Chunk]"),_=!1;break}else Ee(this.i,this.l,zn,null),ht(this,zn);if(Ei(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ar!=4||ie.length!=0||this.h.h||(this.m=1,Ct(16),_=!1),this.o=this.o&&_,!_)Ee(this.i,this.l,ie,"[Invalid Chunked Response]"),rt(this),ze(this);else if(ie.length>0&&!this.W){this.W=!0;var Dt=this.j;Dt.g==this&&Dt.aa&&!Dt.P&&(Dt.j.info("Great, no buffering proxy detected. Bytes received: "+ie.length),la(Dt),Dt.P=!0,Ct(11))}}else Ee(this.i,this.l,ie,null),ht(this,ie);Ar==4&&rt(this),this.o&&!this.K&&(Ar==4?ke(this.j,this):(this.o=!1,$s(this)))}else gr(this.g),V==400&&ie.indexOf("Unknown SID")>0?(this.m=3,Ct(12)):(this.m=0,Ct(13)),rt(this),ze(this)}}}catch{}};function ss(_){if(!Ei(_))return _.g.la();const V=at(_.g);if(V==="")return"";let ie="";const be=V.length,qe=Le(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return rt(_),ze(_),"";_.h.i=new o.TextDecoder}for(let st=0;st<be;st++)_.h.h=!0,ie+=_.h.i.decode(V[st],{stream:!(qe&&st==be-1)});return V.length=0,_.h.g+=ie,_.C=0,_.h.g}function Ei(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function wi(_,V){var ie=_.C,be=V.indexOf(`
`,ie);return be==-1?Qr:(ie=Number(V.substring(ie,be)),isNaN(ie)?$r:(be+=1,be+ie>V.length?Qr:(V=V.slice(be,be+ie),_.C=be+ie,V)))}en.prototype.cancel=function(){this.K=!0,rt(this)};function $s(_){_.T=Date.now()+_.H,zi(_,_.H)}function zi(_,V){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Yt(u(_.aa,_),V)}function jn(_){_.D&&(o.clearTimeout(_.D),_.D=null)}en.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(He(this.i,this.B),this.M!=2&&(Ht(),Ct(17)),rt(this),this.m=2,ze(this)):zi(this,this.T-_)};function ze(_){_.j.I==0||_.K||ke(_.j,_)}function rt(_){jn(_);var V=_.O;V&&typeof V.dispose=="function"&&V.dispose(),_.O=null,dt(_.V),_.g&&(V=_.g,_.g=null,V.abort(),V.dispose())}function ht(_,V){try{var ie=_.j;if(ie.I!=0&&(ie.g==_||ps(ie.h,_))){if(!_.L&&ps(ie.h,_)&&ie.I==3){try{var be=ie.Ba.g.parse(V)}catch{be=null}if(Array.isArray(be)&&be.length==3){var qe=be;if(qe[0]==0){e:if(!ie.v){if(ie.g)if(ie.g.F+3e3<_.F)ae(ie),mn(ie);else break e;Ts(ie),Ct(18)}}else ie.xa=qe[1],0<ie.xa-ie.K&&qe[2]<37500&&ie.F&&ie.A==0&&!ie.C&&(ie.C=Yt(u(ie.Va,ie),6e3));Mn(ie.h)<=1&&ie.ta&&(ie.ta=void 0)}else Fe(ie,11)}else if((_.L||ie.g==_)&&ae(ie),!P(V))for(qe=ie.Ba.g.parse(V),V=0;V<qe.length;V++){let un=qe[V];const zn=un[0];if(!(zn<=ie.K))if(ie.K=zn,un=un[1],ie.I==2)if(un[0]=="c"){ie.M=un[1],ie.ba=un[2];const zs=un[3];zs!=null&&(ie.ka=zs,ie.j.info("VER="+ie.ka));const Ma=un[4];Ma!=null&&(ie.za=Ma,ie.j.info("SVER="+ie.za));const Oi=un[5];Oi!=null&&typeof Oi=="number"&&Oi>0&&(be=1.5*Oi,ie.O=be,ie.j.info("backChannelRequestTimeoutMs_="+be)),be=ie;const Xn=_.g;if(Xn){const co=Xn.g?Xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(co){var st=be.h;st.g||co.indexOf("spdy")==-1&&co.indexOf("quic")==-1&&co.indexOf("h2")==-1||(st.j=st.l,st.g=new Set,st.h&&(_r(st,st.h),st.h=null))}if(be.G){const Ro=Xn.g?Xn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ro&&(be.wa=Ro,Kr(be.J,be.G,Ro))}}ie.I=3,ie.l&&ie.l.ra(),ie.aa&&(ie.T=Date.now()-_.F,ie.j.info("Handshake RTT: "+ie.T+"ms")),be=ie;var Dt=_;if(be.na=_t(be,be.L?be.ba:null,be.W),Dt.L){qi(be.h,Dt);var Ar=Dt,gs=be.O;gs&&(Ar.H=gs),Ar.D&&(jn(Ar),$s(Ar)),be.g=Dt}else oa(be);ie.i.length>0&&Tn(ie)}else un[0]!="stop"&&un[0]!="close"||Fe(ie,7);else ie.I==3&&(un[0]=="stop"||un[0]=="close"?un[0]=="stop"?Fe(ie,7):Dr(ie):un[0]!="noop"&&ie.l&&ie.l.qa(un),ie.A=0)}}Ht(4)}catch{}}var Rt=class{constructor(_,V){this.g=_,this.map=V}};function yr(_){this.l=_||10,o.PerformanceNavigationTiming?(_=o.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Fr(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function Mn(_){return _.h?1:_.g?_.g.size:0}function ps(_,V){return _.h?_.h==V:_.g?_.g.has(V):!1}function _r(_,V){_.g?_.g.add(V):_.h=V}function qi(_,V){_.h&&_.h==V?_.h=null:_.g&&_.g.has(V)&&_.g.delete(V)}yr.prototype.cancel=function(){if(this.i=Ya(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Ya(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let V=_.i;for(const ie of _.g.values())V=V.concat(ie.G);return V}return m(_.i)}var al=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ji(_,V){if(_){_=_.split("&");for(let ie=0;ie<_.length;ie++){const be=_[ie].indexOf("=");let qe,st=null;be>=0?(qe=_[ie].substring(0,be),st=_[ie].substring(be+1)):qe=_[ie],V(qe,st?decodeURIComponent(st.replace(/\+/g," ")):"")}}}function Fs(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let V;_ instanceof Fs?(this.l=_.l,Rr(this,_.j),this.o=_.o,this.g=_.g,Hi(this,_.u),this.h=_.h,Us(this,Io(_.i)),this.m=_.m):_&&(V=String(_).match(al))?(this.l=!1,Rr(this,V[1]||"",!0),this.o=ms(V[2]||""),this.g=ms(V[3]||"",!0),Hi(this,V[4]),this.h=ms(V[5]||"",!0),Us(this,V[6]||"",!0),this.m=ms(V[7]||"")):(this.l=!1,this.i=new Es(null,this.l))}Fs.prototype.toString=function(){const _=[];var V=this.j;V&&_.push(Fn(V,lo,!0),":");var ie=this.g;return(ie||V=="file")&&(_.push("//"),(V=this.o)&&_.push(Fn(V,lo,!0),"@"),_.push(Vt(ie).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ie=this.u,ie!=null&&_.push(":",String(ie))),(ie=this.h)&&(this.g&&ie.charAt(0)!="/"&&_.push("/"),_.push(Fn(ie,ie.charAt(0)=="/"?ol:Mo,!0))),(ie=this.i.toString())&&_.push("?",ie),(ie=this.m)&&_.push("#",Fn(ie,Ca)),_.join("")},Fs.prototype.resolve=function(_){const V=is(this);let ie=!!_.j;ie?Rr(V,_.j):ie=!!_.o,ie?V.o=_.o:ie=!!_.g,ie?V.g=_.g:ie=_.u!=null;var be=_.h;if(ie)Hi(V,_.u);else if(ie=!!_.h){if(be.charAt(0)!="/")if(this.g&&!this.h)be="/"+be;else{var qe=V.h.lastIndexOf("/");qe!=-1&&(be=V.h.slice(0,qe+1)+be)}if(qe=be,qe==".."||qe==".")be="";else if(qe.indexOf("./")!=-1||qe.indexOf("/.")!=-1){be=qe.lastIndexOf("/",0)==0,qe=qe.split("/");const st=[];for(let Dt=0;Dt<qe.length;){const Ar=qe[Dt++];Ar=="."?be&&Dt==qe.length&&st.push(""):Ar==".."?((st.length>1||st.length==1&&st[0]!="")&&st.pop(),be&&Dt==qe.length&&st.push("")):(st.push(Ar),be=!0)}be=st.join("/")}else be=qe}return ie?V.h=be:ie=_.i.toString()!=="",ie?Us(V,Io(_.i)):ie=!!_.m,ie&&(V.m=_.m),V};function is(_){return new Fs(_)}function Rr(_,V,ie){_.j=ie?ms(V,!0):V,_.j&&(_.j=_.j.replace(/:$/,""))}function Hi(_,V){if(V){if(V=Number(V),isNaN(V)||V<0)throw Error("Bad port number "+V);_.u=V}else _.u=null}function Us(_,V,ie){V instanceof Es?(_.i=V,li(_.i,_.l)):(ie||(V=Fn(V,Zs)),_.i=new Es(V,_.l))}function Kr(_,V,ie){_.i.set(V,ie)}function _a(_){return Kr(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function ms(_,V){return _?V?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Fn(_,V,ie){return typeof _=="string"?(_=encodeURI(_).replace(V,as),ie&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function as(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var lo=/[#\/\?@]/g,Mo=/[#\?:]/g,ol=/[#\?]/g,Zs=/[#\?@]/g,Ca=/#/g;function Es(_,V){this.h=this.g=null,this.i=_||null,this.j=!!V}function Un(_){_.g||(_.g=new Map,_.h=0,_.i&&ji(_.i,function(V,ie){_.add(decodeURIComponent(V.replace(/\+/g," ")),ie)}))}t=Es.prototype,t.add=function(_,V){Un(this),this.i=null,_=Aa(this,_);let ie=this.g.get(_);return ie||this.g.set(_,ie=[]),ie.push(V),this.h+=1,this};function oi(_,V){Un(_),V=Aa(_,V),_.g.has(V)&&(_.i=null,_.h-=_.g.get(V).length,_.g.delete(V))}function ll(_,V){return Un(_),V=Aa(_,V),_.g.has(V)}t.forEach=function(_,V){Un(this),this.g.forEach(function(ie,be){ie.forEach(function(qe){_.call(V,qe,be,this)},this)},this)};function Ti(_,V){Un(_);let ie=[];if(typeof V=="string")ll(_,V)&&(ie=ie.concat(_.g.get(Aa(_,V))));else for(_=Array.from(_.g.values()),V=0;V<_.length;V++)ie=ie.concat(_[V]);return ie}t.set=function(_,V){return Un(this),this.i=null,_=Aa(this,_),ll(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[V]),this.h+=1,this},t.get=function(_,V){return _?(_=Ti(this,_),_.length>0?String(_[0]):V):V};function Po(_,V,ie){oi(_,V),ie.length>0&&(_.i=null,_.g.set(Aa(_,V),m(ie)),_.h+=ie.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],V=Array.from(this.g.keys());for(let be=0;be<V.length;be++){var ie=V[be];const qe=Vt(ie);ie=Ti(this,ie);for(let st=0;st<ie.length;st++){let Dt=qe;ie[st]!==""&&(Dt+="="+Vt(ie[st])),_.push(Dt)}}return this.i=_.join("&")};function Io(_){const V=new Es;return V.i=_.i,_.g&&(V.g=new Map(_.g),V.h=_.h),V}function Aa(_,V){return V=String(V),_.j&&(V=V.toLowerCase()),V}function li(_,V){V&&!_.j&&(Un(_),_.i=null,_.g.forEach(function(ie,be){const qe=be.toLowerCase();be!=qe&&(oi(this,be),Po(this,qe,ie))},_)),_.j=V}function Li(_,V){const ie=new Be;if(o.Image){const be=new Image;be.onload=f(Qs,ie,"TestLoadImage: loaded",!0,V,be),be.onerror=f(Qs,ie,"TestLoadImage: error",!1,V,be),be.onabort=f(Qs,ie,"TestLoadImage: abort",!1,V,be),be.ontimeout=f(Qs,ie,"TestLoadImage: timeout",!1,V,be),o.setTimeout(function(){be.ontimeout&&be.ontimeout()},1e4),be.src=_}else V(!1)}function Kn(_,V){const ie=new Be,be=new AbortController,qe=setTimeout(()=>{be.abort(),Qs(ie,"TestPingServer: timeout",!1,V)},1e4);fetch(_,{signal:be.signal}).then(st=>{clearTimeout(qe),st.ok?Qs(ie,"TestPingServer: ok",!0,V):Qs(ie,"TestPingServer: server error",!1,V)}).catch(()=>{clearTimeout(qe),Qs(ie,"TestPingServer: error",!1,V)})}function Qs(_,V,ie,be,qe){try{qe&&(qe.onload=null,qe.onerror=null,qe.onabort=null,qe.ontimeout=null),be(ie)}catch{}}function Ea(){this.g=new kt}function lr(_){this.i=_.Sb||null,this.h=_.ab||!1}p(lr,Ue),lr.prototype.g=function(){return new Ta(this.i,this.h)};function Ta(_,V){Ne.call(this),this.H=_,this.o=V,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Ta,Ne),t=Ta.prototype,t.open=function(_,V){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=V,this.readyState=1,Ns(this)},t.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const V={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(V.body=_),(this.H||o).fetch(new Request(this.D,V)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ka(this)),this.readyState=0},t.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Ns(this)),this.g&&(this.readyState=3,Ns(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;La(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function La(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}t.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var V=_.value?_.value:new Uint8Array(0);(V=this.B.decode(V,{stream:!_.done}))&&(this.response=this.responseText+=V)}_.done?Ka(this):Ns(this),this.readyState==3&&La(this)}},t.Oa=function(_){this.g&&(this.response=this.responseText=_,Ka(this))},t.Na=function(_){this.g&&(this.response=_,Ka(this))},t.ga=function(){this.g&&Ka(this)};function Ka(_){_.readyState=4,_.l=null,_.j=null,_.B=null,Ns(_)}t.setRequestHeader=function(_,V){this.A.append(_,V)},t.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],V=this.h.entries();for(var ie=V.next();!ie.done;)ie=ie.value,_.push(ie[0]+": "+ie[1]),ie=V.next();return _.join(`\r
`)};function Ns(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Ta.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function os(_){let V="";return se(_,function(ie,be){V+=be,V+=":",V+=ie,V+=`\r
`}),V}function Xa(_,V,ie){e:{for(be in ie){var be=!1;break e}be=!0}be||(ie=os(ie),typeof _=="string"?ie!=null&&Vt(ie):Kr(_,V,ie))}function Gr(_){Ne.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Gr,Ne);var ci=/^https?$/i,Oa=["POST","PUT"];t=Gr.prototype,t.Fa=function(_){this.H=_},t.ea=function(_,V,ie,be){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);V=V?V.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ut.g(),this.g.onreadystatechange=x(u(this.Ca,this));try{this.B=!0,this.g.open(V,String(_),!0),this.B=!1}catch(st){Wi(this,st);return}if(_=ie||"",ie=new Map(this.headers),be)if(Object.getPrototypeOf(be)===Object.prototype)for(var qe in be)ie.set(qe,be[qe]);else if(typeof be.keys=="function"&&typeof be.get=="function")for(const st of be.keys())ie.set(st,be.get(st));else throw Error("Unknown input type for opt_headers: "+String(be));be=Array.from(ie.keys()).find(st=>st.toLowerCase()=="content-type"),qe=o.FormData&&_ instanceof o.FormData,!(Array.prototype.indexOf.call(Oa,V,void 0)>=0)||be||qe||ie.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[st,Dt]of ie)this.g.setRequestHeader(st,Dt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(st){Wi(this,st)}};function Wi(_,V){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=V,_.o=5,cl(_),me(_)}function cl(_){_.A||(_.A=!0,Ge(_,"complete"),Ge(_,"error"))}t.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,Ge(this,"complete"),Ge(this,"abort"),me(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),me(this,!0)),Gr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?K(this):this.Xa())},t.Xa=function(){K(this)};function K(_){if(_.h&&typeof a<"u"){if(_.v&&Le(_)==4)setTimeout(_.Ca.bind(_),0);else if(Ge(_,"readystatechange"),Le(_)==4){_.h=!1;try{const st=_.ca();e:switch(st){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var V=!0;break e;default:V=!1}var ie;if(!(ie=V)){var be;if(be=st===0){let Dt=String(_.D).match(al)[1]||null;!Dt&&o.self&&o.self.location&&(Dt=o.self.location.protocol.slice(0,-1)),be=!ci.test(Dt?Dt.toLowerCase():"")}ie=be}if(ie)Ge(_,"complete"),Ge(_,"success");else{_.o=6;try{var qe=Le(_)>2?_.g.statusText:""}catch{qe=""}_.l=qe+" ["+_.ca()+"]",cl(_)}}finally{me(_)}}}}function me(_,V){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const ie=_.g;_.g=null,V||Ge(_,"ready");try{ie.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Le(_){return _.g?_.g.readyState:0}t.ca=function(){try{return Le(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(_){if(this.g){var V=this.g.responseText;return _&&V.indexOf(_)==0&&(V=V.substring(_.length)),lt(V)}};function at(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function gr(_){const V={};_=(_.g&&Le(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let be=0;be<_.length;be++){if(P(_[be]))continue;var ie=pr(_[be]);const qe=ie[0];if(ie=ie[1],typeof ie!="string")continue;ie=ie.trim();const st=V[qe]||[];V[qe]=st,st.push(ie)}J(V,function(be){return be.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kt(_,V,ie){return ie&&ie.internalChannelParams&&ie.internalChannelParams[_]||V}function Or(_){this.za=0,this.i=[],this.j=new Be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Kt("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Kt("baseRetryDelayMs",5e3,_),this.Za=Kt("retryDelaySeedMs",1e4,_),this.Ta=Kt("forwardChannelMaxRetries",2,_),this.va=Kt("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new yr(_&&_.concurrentRequestLimit),this.Ba=new Ea,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Or.prototype,t.ka=8,t.I=1,t.connect=function(_,V,ie,be){Ct(0),this.W=_,this.H=V||{},ie&&be!==void 0&&(this.H.OSID=ie,this.H.OAID=be),this.F=this.X,this.J=_t(this,null,this.W),Tn(this)};function Dr(_){if(Br(_),_.I==3){var V=_.V++,ie=is(_.J);if(Kr(ie,"SID",_.M),Kr(ie,"RID",V),Kr(ie,"TYPE","terminate"),Nn(_,ie),V=new en(_,_.j,V),V.M=2,V.A=_a(is(ie)),ie=!1,o.navigator&&o.navigator.sendBeacon)try{ie=o.navigator.sendBeacon(V.A.toString(),"")}catch{}!ie&&o.Image&&(new Image().src=V.A,ie=!0),ie||(V.g=tr(V.j,null),V.g.ea(V.A)),V.F=Date.now(),$s(V)}mt(_)}function mn(_){_.g&&(la(_),_.g.cancel(),_.g=null)}function Br(_){mn(_),_.v&&(o.clearTimeout(_.v),_.v=null),ae(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&o.clearTimeout(_.m),_.m=null)}function Tn(_){if(!Fr(_.h)&&!_.m){_.m=!0;var V=_.Ea;O||I(),F||(O(),F=!0),T.add(V,_),_.D=0}}function ks(_,V){return Mn(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=V.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Yt(u(_.Ea,_,V),Me(_,_.D)),_.D++,!0)}t.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const qe=new en(this,this.j,_);let st=this.o;if(this.U&&(st?(st=W(st),Y(st,this.U)):st=this.U),this.u!==null||this.R||(qe.J=st,st=null),this.S)e:{for(var V=0,ie=0;ie<this.i.length;ie++){t:{var be=this.i[ie];if("__data__"in be.map&&(be=be.map.__data__,typeof be=="string")){be=be.length;break t}be=void 0}if(be===void 0)break;if(V+=be,V>4096){V=ie;break e}if(V===4096||ie===this.i.length-1){V=ie+1;break e}}V=1e3}else V=1e3;V=Pn(this,qe,V),ie=is(this.J),Kr(ie,"RID",_),Kr(ie,"CVER",22),this.G&&Kr(ie,"X-HTTP-Session-Id",this.G),Nn(this,ie),st&&(this.R?V="headers="+Vt(os(st))+"&"+V:this.u&&Xa(ie,this.u,st)),_r(this.h,qe),this.Ra&&Kr(ie,"TYPE","init"),this.S?(Kr(ie,"$req",V),Kr(ie,"SID","null"),qe.U=!0,pn(qe,ie,null)):pn(qe,ie,V),this.I=2}}else this.I==3&&(_?Vn(this,_):this.i.length==0||Fr(this.h)||Vn(this))};function Vn(_,V){var ie;V?ie=V.l:ie=_.V++;const be=is(_.J);Kr(be,"SID",_.M),Kr(be,"RID",ie),Kr(be,"AID",_.K),Nn(_,be),_.u&&_.o&&Xa(be,_.u,_.o),ie=new en(_,_.j,ie,_.D+1),_.u===null&&(ie.J=_.o),V&&(_.i=V.G.concat(_.i)),V=Pn(_,ie,1e3),ie.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),_r(_.h,ie),pn(ie,be,V)}function Nn(_,V){_.H&&se(_.H,function(ie,be){Kr(V,be,ie)}),_.l&&se({},function(ie,be){Kr(V,be,ie)})}function Pn(_,V,ie){ie=Math.min(_.i.length,ie);const be=_.l?u(_.l.Ka,_.l,_):null;e:{var qe=_.i;let Ar=-1;for(;;){const gs=["count="+ie];Ar==-1?ie>0?(Ar=qe[0].g,gs.push("ofs="+Ar)):Ar=0:gs.push("ofs="+Ar);let un=!0;for(let zn=0;zn<ie;zn++){var st=qe[zn].g;const zs=qe[zn].map;if(st-=Ar,st<0)Ar=Math.max(0,qe[zn].g-100),un=!1;else try{st="req"+st+"_"||"";try{var Dt=zs instanceof Map?zs:Object.entries(zs);for(const[Ma,Oi]of Dt){let Xn=Oi;l(Oi)&&(Xn=Ve(Oi)),gs.push(st+Ma+"="+encodeURIComponent(Xn))}}catch(Ma){throw gs.push(st+"type="+encodeURIComponent("_badmap")),Ma}}catch{be&&be(zs)}}if(un){Dt=gs.join("&");break e}}Dt=void 0}return _=_.i.splice(0,ie),V.G=_,Dt}function oa(_){if(!_.g&&!_.v){_.Y=1;var V=_.Da;O||I(),F||(O(),F=!0),T.add(V,_),_.A=0}}function Ts(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Yt(u(_.Da,_),Me(_,_.A)),_.A++,!0)}t.Da=function(){if(this.v=null,z(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Yt(u(this.Wa,this),_)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ct(10),mn(this),z(this))};function la(_){_.B!=null&&(o.clearTimeout(_.B),_.B=null)}function z(_){_.g=new en(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var V=is(_.na);Kr(V,"RID","rpc"),Kr(V,"SID",_.M),Kr(V,"AID",_.K),Kr(V,"CI",_.F?"0":"1"),!_.F&&_.ia&&Kr(V,"TO",_.ia),Kr(V,"TYPE","xmlhttp"),Nn(_,V),_.u&&_.o&&Xa(V,_.u,_.o),_.O&&(_.g.H=_.O);var ie=_.g;_=_.ba,ie.M=1,ie.A=_a(is(V)),ie.u=null,ie.R=!0,Hr(ie,_)}t.Va=function(){this.C!=null&&(this.C=null,mn(this),Ts(this),Ct(19))};function ae(_){_.C!=null&&(o.clearTimeout(_.C),_.C=null)}function ke(_,V){var ie=null;if(_.g==V){ae(_),la(_),_.g=null;var be=2}else if(ps(_.h,V))ie=V.G,qi(_.h,V),be=1;else return;if(_.I!=0){if(V.o)if(be==1){ie=V.u?V.u.length:0,V=Date.now()-V.F;var qe=_.D;be=Xt(),Ge(be,new Tt(be,ie)),Tn(_)}else oa(_);else if(qe=V.m,qe==3||qe==0&&V.X>0||!(be==1&&ks(_,V)||be==2&&Ts(_)))switch(ie&&ie.length>0&&(V=_.h,V.i=V.i.concat(ie)),qe){case 1:Fe(_,5);break;case 4:Fe(_,10);break;case 3:Fe(_,6);break;default:Fe(_,2)}}}function Me(_,V){let ie=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(ie*=2),ie*V}function Fe(_,V){if(_.j.info("Error code "+V),V==2){var ie=u(_.bb,_),be=_.Ua;const qe=!be;be=new Fs(be||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Rr(be,"https"),_a(be),qe?Li(be.toString(),ie):Kn(be.toString(),ie)}else Ct(2);_.I=0,_.l&&_.l.pa(V),mt(_),Br(_)}t.bb=function(_){_?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))};function mt(_){if(_.I=0,_.ja=[],_.l){const V=Ya(_.h);(V.length!=0||_.i.length!=0)&&(y(_.ja,V),y(_.ja,_.i),_.h.i.length=0,m(_.i),_.i.length=0),_.l.oa()}}function _t(_,V,ie){var be=ie instanceof Fs?is(ie):new Fs(ie);if(be.g!="")V&&(be.g=V+"."+be.g),Hi(be,be.u);else{var qe=o.location;be=qe.protocol,V=V?V+"."+qe.hostname:qe.hostname,qe=+qe.port;const st=new Fs(null);be&&Rr(st,be),V&&(st.g=V),qe&&Hi(st,qe),ie&&(st.h=ie),be=st}return ie=_.G,V=_.wa,ie&&V&&Kr(be,ie,V),Kr(be,"VER",_.ka),Nn(_,be),be}function tr(_,V,ie){if(V&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return V=_.Aa&&!_.ma?new Gr(new lr({ab:ie})):new Gr(_.ma),V.Fa(_.L),V}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ir(){}t=ir.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function cr(_,V){Ne.call(this),this.g=new Or(V),this.l=_,this.h=V&&V.messageUrlParams||null,_=V&&V.messageHeaders||null,V&&V.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=V&&V.initMessageHeaders||null,V&&V.messageContentType&&(_?_["X-WebChannel-Content-Type"]=V.messageContentType:_={"X-WebChannel-Content-Type":V.messageContentType}),V&&V.sa&&(_?_["X-WebChannel-Client-Profile"]=V.sa:_={"X-WebChannel-Client-Profile":V.sa}),this.g.U=_,(_=V&&V.Qb)&&!P(_)&&(this.g.u=_),this.A=V&&V.supportsCrossDomainXhr||!1,this.v=V&&V.sendRawJson||!1,(V=V&&V.httpSessionIdParam)&&!P(V)&&(this.g.G=V,_=this.h,_!==null&&V in _&&(_=this.h,V in _&&delete _[V])),this.j=new In(this)}p(cr,Ne),cr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cr.prototype.close=function(){Dr(this.g)},cr.prototype.o=function(_){var V=this.g;if(typeof _=="string"){var ie={};ie.__data__=_,_=ie}else this.v&&(ie={},ie.__data__=Ve(_),_=ie);V.i.push(new Rt(V.Ya++,_)),V.I==3&&Tn(V)},cr.prototype.N=function(){this.g.l=null,delete this.j,Dr(this.g),delete this.g,cr.Z.N.call(this)};function Mr(_){Ot.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var V=_.__sm__;if(V){e:{for(const ie in V){_=ie;break e}_=void 0}(this.i=_)&&(_=this.i,V=V!==null&&_ in V?V[_]:void 0),this.data=V}else this.data=_}p(Mr,Ot);function tn(){Et.call(this),this.status=1}p(tn,Et);function In(_){this.g=_}p(In,ir),In.prototype.ra=function(){Ge(this.g,"a")},In.prototype.qa=function(_){Ge(this.g,new Mr(_))},In.prototype.pa=function(_){Ge(this.g,new tn)},In.prototype.oa=function(){Ge(this.g,"b")},cr.prototype.send=cr.prototype.o,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,Gt.NO_ERROR=0,Gt.TIMEOUT=8,Gt.HTTP_ERROR=6,Zt.COMPLETE="complete",Bt.EventType=zt,zt.OPEN="a",zt.CLOSE="b",zt.ERROR="c",zt.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,Gr.prototype.listenOnce=Gr.prototype.K,Gr.prototype.getLastError=Gr.prototype.Ha,Gr.prototype.getLastErrorCode=Gr.prototype.ya,Gr.prototype.getStatus=Gr.prototype.ca,Gr.prototype.getResponseJson=Gr.prototype.La,Gr.prototype.getResponseText=Gr.prototype.la,Gr.prototype.send=Gr.prototype.ea,Gr.prototype.setWithCredentials=Gr.prototype.Fa}).apply(typeof ov<"u"?ov:typeof self<"u"?self:typeof window<"u"?window:{});const VL="@firebase/firestore",YL="4.9.3";let go=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};go.UNAUTHENTICATED=new go(null),go.GOOGLE_CREDENTIALS=new go("google-credentials-uid"),go.FIRST_PARTY=new go("first-party-uid"),go.MOCK_USER=new go("mock-user");let _b="12.7.0";const fm=new f6("@firebase/firestore");function Oc(t,...e){if(fm.logLevel<=Yn.DEBUG){const r=e.map(C6);fm.debug(`Firestore (${_b}): ${t}`,...r)}}function vF(t,...e){if(fm.logLevel<=Yn.ERROR){const r=e.map(C6);fm.error(`Firestore (${_b}): ${t}`,...r)}}function ose(t,...e){if(fm.logLevel<=Yn.WARN){const r=e.map(C6);fm.warn(`Firestore (${_b}): ${t}`,...r)}}function C6(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function Fx(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,wF(t,n,r)}function wF(t,e,r){let n=`FIRESTORE (${_b}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw vF(n),new Error(n)}function yx(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||wF(e,i,n)}const An={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class En extends Md{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vx{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class jF{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lse{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(go.UNAUTHENTICATED)))}shutdown(){}}class cse{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class dse{constructor(e){this.t=e,this.currentUser=go.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){yx(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new vx;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new vx,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const c=a;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},l=c=>{Oc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Oc("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new vx)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Oc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(yx(typeof n.accessToken=="string",31837,{l:n}),new jF(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return yx(e===null||typeof e=="string",2055,{h:e}),new go(e)}}class use{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=go.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hse{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new use(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(go.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class KL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fse{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,el(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){yx(this.o===void 0,3512);const n=a=>{a.error!=null&&Oc("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Oc("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const i=a=>{Oc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Oc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new KL(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(yx(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new KL(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function pse(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class mse{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=pse(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function nf(t,e){return t<e?-1:t>e?1:0}function gse(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return jj(i)===jj(a)?nf(i,a):jj(i)?1:-1}return nf(t.length,e.length)}const xse=55296,bse=57343;function jj(t){const e=t.charCodeAt(0);return e>=xse&&e<=bse}const XL="__name__";class hd{constructor(e,r,n){r===void 0?r=0:r>e.length&&Fx(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Fx(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return hd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof hd?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=hd.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return nf(e.length,r.length)}static compareSegments(e,r){const n=hd.isNumericId(e),i=hd.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?hd.extractNumericId(e).compare(hd.extractNumericId(r)):gse(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _6.fromString(e.substring(4,e.length-2))}}class kc extends hd{construct(e,r,n){return new kc(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new En(An.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((i=>i.length>0)))}return new kc(r)}static emptyPath(){return new kc([])}}const yse=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Uf extends hd{construct(e,r,n){return new Uf(e,r,n)}static isValidIdentifier(e){return yse.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Uf.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===XL}static keyField(){return new Uf([XL])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new En(An.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new En(An.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new En(An.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(a(),i++)}if(a(),o)throw new En(An.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Uf(r)}static emptyPath(){return new Uf([])}}class Wf{constructor(e){this.path=e}static fromPath(e){return new Wf(kc.fromString(e))}static fromName(e){return new Wf(kc.fromString(e).popFirst(5))}static empty(){return new Wf(kc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kc.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return kc.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Wf(new kc(e.slice()))}}function vse(t,e,r,n){if(e===!0&&n===!0)throw new En(An.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function wse(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function jse(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Fx(12329,{type:typeof t})}function Nse(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new En(An.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=jse(t);throw new En(An.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function Bi(t,e){const r={typeString:t};return e&&(r.value=e),r}function Cb(t,e){if(!wse(t))throw new En(An.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(i&&typeof o!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new En(An.INVALID_ARGUMENT,r);return!0}const JL=-62135596800,ZL=1e6;class fd{static now(){return fd.fromMillis(Date.now())}static fromDate(e){return fd.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*ZL);return new fd(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new En(An.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new En(An.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<JL)throw new En(An.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new En(An.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ZL}_compareTo(e){return this.seconds===e.seconds?nf(this.nanoseconds,e.nanoseconds):nf(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:fd._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cb(e,fd._jsonSchema))return new fd(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-JL;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}fd._jsonSchemaVersion="firestore/timestamp/1.0",fd._jsonSchema={type:Bi("string",fd._jsonSchemaVersion),seconds:Bi("number"),nanoseconds:Bi("number")};function kse(t){return t.name==="IndexedDbTransactionError"}class Sse extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class c0{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Sse("Invalid base64 string: "+a):a}})(e);return new c0(r)}static fromUint8Array(e){const r=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new c0(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nf(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}c0.EMPTY_BYTE_STRING=new c0("");const Y3="(default)";class K1{constructor(e,r){this.projectId=e,this.database=r||Y3}static empty(){return new K1("","")}get isDefaultDatabase(){return this.database===Y3}isEqual(e){return e instanceof K1&&e.projectId===this.projectId&&e.database===this.database}}class _se{constructor(e,r=null,n=[],i=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Cse(t){return new _se(t)}var QL,Cn;(Cn=QL||(QL={}))[Cn.OK=0]="OK",Cn[Cn.CANCELLED=1]="CANCELLED",Cn[Cn.UNKNOWN=2]="UNKNOWN",Cn[Cn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Cn[Cn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Cn[Cn.NOT_FOUND=5]="NOT_FOUND",Cn[Cn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Cn[Cn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Cn[Cn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Cn[Cn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Cn[Cn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Cn[Cn.ABORTED=10]="ABORTED",Cn[Cn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Cn[Cn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Cn[Cn.INTERNAL=13]="INTERNAL",Cn[Cn.UNAVAILABLE=14]="UNAVAILABLE",Cn[Cn.DATA_LOSS=15]="DATA_LOSS";new _6([4294967295,4294967295],0);const Ase=41943040;const Ese=1048576;function Nj(){return typeof document<"u"?document:null}class Tse{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Oc("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class A6{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new vx,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,l=new A6(e,r,o,i,a);return l.start(n),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new En(An.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var e7,t7;(t7=e7||(e7={})).Ma="default",t7.Cache="cache";function Lse(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const r7=new Map;const NF="firestore.googleapis.com",n7=!0;class s7{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new En(An.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=NF,this.ssl=n7}else this.host=e.host,this.ssl=e.ssl??n7;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ase;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ese)throw new En(An.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vse("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lse(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new En(An.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new En(An.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new En(An.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kF{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s7({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new En(An.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new En(An.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s7(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new lse;switch(n.type){case"firstParty":return new hse(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new En(An.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=r7.get(r);n&&(Oc("ComponentProvider","Removing Datastore"),r7.delete(r),n.terminate())})(this),Promise.resolve()}}function Ose(t,e,r,n={}){t=Nse(t,kF);const i=Mm(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(u6(`https://${l}`),h6("Firestore",!0)),a.host!==NF&&a.host!==l&&ose("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:l,ssl:i,emulatorOptions:n};if(!i0(c,o)&&(t._setSettings(c),n.mockUserToken)){let u,f;if(typeof n.mockUserToken=="string")u=n.mockUserToken,f=go.MOCK_USER;else{u=L$(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new En(An.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new go(p)}t._authCredentials=new cse(new jF(u,f))}}class E6{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new E6(this.firestore,e,this._query)}}class pd{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new T6(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pd(this.firestore,e,this._key)}toJSON(){return{type:pd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Cb(r,pd._jsonSchema))return new pd(e,n||null,new Wf(kc.fromString(r.referencePath)))}}pd._jsonSchemaVersion="firestore/documentReference/1.0",pd._jsonSchema={type:Bi("string",pd._jsonSchemaVersion),referencePath:Bi("string")};class T6 extends E6{constructor(e,r,n){super(e,r,Cse(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pd(this.firestore,null,new Wf(e))}withConverter(e){return new T6(this.firestore,e,this._path)}}const i7="AsyncQueue";class a7{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tse(this,"async_queue_retry"),this._c=()=>{const n=Nj();n&&Oc(i7,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Nj();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Nj();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new vx;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!kse(e))throw e;Oc(i7,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,vF("INTERNAL UNHANDLED ERROR: ",o7(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=A6.createAndSchedule(this,e,r,n,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Fx(47125,{Pc:o7(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function o7(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Mse extends kF{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new a7,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new a7(e),this._firestoreClient=void 0,await e}}}function Pse(t,e){const r=typeof t=="object"?t:m6(),n=typeof t=="string"?t:Y3,i=gw(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=A$("firestore");a&&Ose(i,...a)}return i}class hu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hu(c0.fromBase64String(e))}catch(r){throw new En(An.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new hu(c0.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:hu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cb(e,hu._jsonSchema))return hu.fromBase64String(e.bytes)}}hu._jsonSchemaVersion="firestore/bytes/1.0",hu._jsonSchema={type:Bi("string",hu._jsonSchemaVersion),bytes:Bi("string")};class SF{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new En(An.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Uf(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Jf{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new En(An.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new En(An.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nf(this._lat,e._lat)||nf(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Jf._jsonSchemaVersion}}static fromJSON(e){if(Cb(e,Jf._jsonSchema))return new Jf(e.latitude,e.longitude)}}Jf._jsonSchemaVersion="firestore/geoPoint/1.0",Jf._jsonSchema={type:Bi("string",Jf._jsonSchemaVersion),latitude:Bi("number"),longitude:Bi("number")};class Zf{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Zf._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cb(e,Zf._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Zf(e.vectorValues);throw new En(An.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Zf._jsonSchemaVersion="firestore/vectorValue/1.0",Zf._jsonSchema={type:Bi("string",Zf._jsonSchemaVersion),vectorValues:Bi("object")};const Ise=new RegExp("[~\\*/\\[\\]]");function Rse(t,e,r){if(e.search(Ise)>=0)throw l7(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new SF(...e.split("."))._internalPath}catch{throw l7(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function l7(t,e,r,n,i){let a=`Function ${e}() called with invalid data`;a+=". ";let o="";return new En(An.INVALID_ARGUMENT,a+t+o)}class _F{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new pd(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Dse(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(CF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Dse extends _F{data(){return super.data()}}function CF(t,e){return typeof e=="string"?Rse(t,e):e instanceof SF?e._internalPath:e._delegate._internalPath}class lv{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zp extends _F{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new p1(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(CF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new En(An.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Zp._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Zp._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zp._jsonSchema={type:Bi("string",Zp._jsonSchemaVersion),bundleSource:Bi("string","DocumentSnapshot"),bundleName:Bi("string"),bundle:Bi("string")};class p1 extends Zp{data(e={}){return super.data(e)}}class wx{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new lv(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new p1(this._firestore,this._userDataWriter,n.key,n,new lv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new En(An.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((l=>{const c=new p1(i._firestore,i._userDataWriter,l.doc.key,l.doc,new lv(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>a||l.type!==3)).map((l=>{const c=new p1(i._firestore,i._userDataWriter,l.doc.key,l.doc,new lv(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:Bse(l.type),doc:c,oldIndex:u,newIndex:f}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new En(An.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wx._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=mse.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Bse(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fx(61501,{type:t})}}wx._jsonSchemaVersion="firestore/querySnapshot/1.0",wx._jsonSchema={type:Bi("string",wx._jsonSchemaVersion),bundleSource:Bi("string","QuerySnapshot"),bundleName:Bi("string"),bundle:Bi("string")};(function(e,r=!0){(function(i){_b=i})(E0),a0(new rf("firestore",((n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new Mse(new dse(n.getProvider("auth-internal")),new fse(o,n.getProvider("app-check-internal")),(function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new En(An.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new K1(u.options.projectId,f)})(o,i),o);return a={useFetchStreams:r,...a},l._setSettings(a),l}),"PUBLIC").setMultipleInstances(!0)),bd(VL,YL,e),bd(VL,YL,"esm2020")})();const $se={apiKey:"AIzaSyAdqbFNjrB6y-8BrMEYYCT5ywiCgZVtMaE",authDomain:"mtglibrary-70b46.firebaseapp.com",projectId:"mtglibrary-70b46",storageBucket:"mtglibrary-70b46.firebasestorage.app",messagingSenderId:"602862103839",appId:"1:602862103839:web:23c64b7486c058c903d42a",measurementId:"G-EWELJJQ631"},L6=P$($se),jc=Ane(L6);Pse(L6);tse(L6);const Fse="";async function Use(){const t={"Content-Type":"application/json"};if(jc.currentUser){const r=await jc.currentUser.getIdToken();t.Authorization=`Bearer ${r}`}else console.warn("[API] No currentUser found, sending request without auth.");const e=localStorage.getItem("mtg_forge_ref");return e&&(t["X-Referral-Code"]=e),t}let K3=null;const c7=t=>{K3=t};async function nn(t,e,r=null,n={}){let i=`${Fse}${e}`;const a=new URL(i,window.location.origin);Object.keys(n).forEach(c=>{n[c]!==null&&n[c]!==void 0&&a.searchParams.append(c,n[c])});const o={method:t,headers:await Use()};r&&(o.body=JSON.stringify(r));const l=await fetch(a,o);if(!l.ok){let c=l.statusText,u=null,f=null;try{f=await l.json(),f.error&&(c=f.error),f.code&&(u=f.code)}catch{}l.status===403&&u==="LIMIT_REACHED"&&K3&&K3(`Subscription Limit Reached: ${c}`,"error",5e3);const p=new Error(`API Error (${l.status}): ${c}`);throw p.response={status:l.status,data:f},p.code=u,p}return l.status===204?null:l.json()}const Ze={get:(t,e)=>nn("GET",t,null,e),post:(t,e)=>nn("POST",t,e),put:(t,e)=>nn("PUT",t,e),delete:(t,e)=>nn("DELETE",t,e),batchAddToCollection:(t,e="merge")=>nn("POST","/api/collection/batch",{cards:t,mode:e}),getBugs:()=>nn("GET","/bugs").then(t=>t.content),updateUser:(t,e)=>nn("PUT",`/api/users/${t}`,e),getBinders:()=>nn("GET","/api/binders"),getBinderCards:t=>nn("GET",`/api/binders/${t}/cards`),createBinder:t=>nn("POST","/api/binders",t),updateBinder:(t,e)=>nn("PUT",`/api/binders/${t}`,e),deleteBinder:t=>nn("DELETE",`/api/binders/${t}`),getEpics:()=>nn("GET","/api/epics"),createEpic:t=>nn("POST","/api/epics",t),updateEpic:(t,e)=>nn("PUT",`/api/epics/${t}`,e),reorderEpics:t=>nn("PUT","/api/epics/reorder/batch",{order:t}),deleteEpic:t=>nn("DELETE",`/api/epics/${t}`),getTickets:t=>nn("GET","/api/tickets",null,t),getTicketReport:t=>nn("GET","/api/tickets/report",null,t),createTicket:t=>nn("POST","/api/tickets",t),updateTicket:(t,e)=>nn("PUT",`/api/tickets/${t}`,e),deleteTicket:t=>nn("DELETE",`/api/tickets/${t}`),voteTicket:t=>nn("POST",`/api/tickets/${t}/vote`),getAssignees:()=>nn("GET","/api/tickets/meta/assignees"),getTicketNotes:t=>nn("GET",`/api/tickets/${t}/notes`),addTicketNote:(t,e)=>nn("POST",`/api/tickets/${t}/notes`,{note:e}),updateUserPermissions:(t,e,r,n={})=>nn("PUT",`/api/users/${t}/permissions`,{permissions:e,isAdmin:r,...n}),getUsers:()=>nn("GET","/api/users"),getReleases:()=>nn("GET","/api/releases"),publishRelease:t=>nn("POST","/api/releases",t),getActiveAudit:()=>nn("GET","/api/audit/active"),startAudit:t=>nn("POST","/api/audit/start",t),getAuditItems:(t,e)=>nn("GET",`/api/audit/${t}/items`,null,e),updateAuditItem:(t,e,r,n=null)=>{const i={quantity:r};return n!==null&&(i.reviewed=n),nn("PUT",`/api/audit/${t}/item/${e}`,i)},swapFoilAuditItem:(t,e)=>nn("POST",`/api/audit/${t}/item/${e}/swap-foil`),cancelAudit:t=>nn("POST",`/api/audit/${t}/cancel`),finalizeAudit:t=>nn("POST",`/api/audit/${t}/finalize`),reviewAuditSection:(t,e)=>nn("POST",`/api/audit/${t}/section/review`,e)},AF=b.createContext(),Sr=()=>b.useContext(AF),zse=({children:t})=>{const[e,r]=b.useState(null),[n,i]=b.useState(null),[a,o]=b.useState(!0),l=async(C,A,L={})=>{const O=await ure(jc,C,A);if(O.user,Object.keys(L).length>0)try{await v();const F=await Ze.get("/api/users/me");F?.id&&(await Ze.updateUser(F.id,L),await v())}catch(F){console.error("Failed to save profile data during signup",F)}return O},c=(C,A)=>hre(jc,C,A),u=()=>{const C=new uu;return Dre(jc,C)},f=()=>(i(null),xre(jc)),p=C=>dre(jc,C),x=()=>{if(!jc.currentUser)throw new Error("No user logged in");return fre(jc.currentUser)},m=async C=>{if(n?.id||(console.warn("[AuthContext] Profile missing ID, attempting re-fetch before update..."),await v()),!n?.id)throw new Error(`User profile not ready. (User: ${e?.email}, Profile: ${!!n})`);try{await Ze.updateUser(n.id,C),await v()}catch(A){throw console.error("Failed to update profile fields:",A),A}},y=async C=>{if(console.log("[AuthContext] uploadProfilePicture called",{file:C.name,currentUser:!!e}),!e)throw console.error("[AuthContext] No user logged in"),new Error("No user logged in");if(!C.type.startsWith("image/"))throw console.error("[AuthContext] Invalid file type:",C.type),new Error("File must be an image.");if(C.size>10*1024*1024)throw console.error("[AuthContext] File too large:",C.size),new Error("File size must be under 10MB.");try{console.log("[AuthContext] Converting image to base64...");const A=new FileReader,O=await new Promise((F,T)=>{A.onload=()=>F(A.result),A.onerror=T,A.readAsDataURL(C)});if(console.log("[AuthContext] Image converted to base64, size:",O.length),console.log("[AuthContext] Saving to database..."),!n?.id)throw new Error("User profile not ready");return await Ze.updateUser(n.id,{photo_url:O}),console.log("[AuthContext] Saved to database"),await v(),console.log("[AuthContext] Profile refreshed"),O}catch(A){throw console.error("[AuthContext] Error uploading profile picture:",A),console.error("[AuthContext] Error code:",A.code),console.error("[AuthContext] Error message:",A.message),A}},v=async()=>{if(!jc.currentUser){console.warn("[AuthContext] refreshUserProfile: No currentUser found in Firebase Auth");return}try{console.log("[AuthContext] Fetching user profile from /api/users/me...");const C=await Ze.get("/api/users/me");!C||!C.id?console.error("[AuthContext] Profile fetch returned invalid data:",C):console.log("[AuthContext] Profile loaded successfully:",C.username||C.email),i(C)}catch(C){console.error("[AuthContext] Failed to fetch user profile:",C.message)}};b.useEffect(()=>gre(jc,async A=>{r(A),A?await v():i(null),o(!1)}),[]);const N={currentUser:e,user:e,userProfile:n,refreshUserProfile:v,updateSettings:async C=>{if(!n)return;const A={...n.settings||{},...C};console.log("[AuthContext] Updating settings:",A);try{await Ze.updateUser(n.id,{settings:A})&&i(O=>({...O,settings:A}))}catch(L){console.error("Failed to update settings:",L)}},signup:l,login:c,loginWithGoogle:u,logout:f,resetPassword:p,sendVerification:x,updateProfileFields:m,uploadProfilePicture:y};return s.jsx(AF.Provider,{value:N,children:!a&&t})};function qse(){const[t,e]=b.useState([]),[r,n]=b.useState(!1),[i,a]=b.useState(null),o=b.useCallback(async(c,u={})=>{const{set:f,cn:p,...x}=u,m=(c||"").trim();if(!(f||p||Object.keys(x).length>0)&&(!m||m.length<2)){e([]);return}n(!0),a(null);try{const v=await Ze.post("/api/cards/search",{query:m,set:f,cn:p,...x});e(v.data||[])}catch(v){console.error(v),a(v.message),e([])}finally{n(!1)}},[]),l=b.useCallback(async c=>{if(!c||c.trim().length<2)return[];try{return(await Ze.get("/api/cards/autocomplete",{q:c})).data||[]}catch(u){return console.error("[useScryfall] Autocomplete error:",u),[]}},[]);return{results:t,loading:r,error:i,searchCards:o,getSuggestions:l,setResults:e}}const EF=b.createContext();function wn(){return b.useContext(EF)}function Hse({children:t}){const[e,r]=b.useState([]),n=b.useCallback((a,o="info",l=3e3,c=null)=>{const u=Date.now();r(f=>[...f,{id:u,message:a,type:o,action:c}]),l>0&&setTimeout(()=>{r(f=>f.filter(p=>p.id!==u))},l)},[]),i=b.useCallback(a=>{r(o=>o.filter(l=>l.id!==a))},[]);return s.jsxs(EF.Provider,{value:{addToast:n},children:[t,Gn.createPortal(s.jsx("div",{className:"fixed bottom-4 right-4 z-[99999] flex flex-col gap-2 pointer-events-none",children:e.map(a=>s.jsxs("div",{className:`
                                px-4 py-3 rounded-lg shadow-lg text-sm font-medium transition-all transform animate-fade-in-up pointer-events-auto cursor-pointer
                                ${a.type==="success"?"bg-green-600 text-white":""}
                                ${a.type==="error"?"bg-red-600 text-white":""}
                                ${a.type==="info"?"bg-gray-800 text-white border border-gray-700":""}
                                ${a.type==="warning"?"bg-yellow-500 text-black":""}
                            `,onClick:()=>i(a.id),children:[a.message,a.action&&s.jsx("button",{onClick:o=>{o.stopPropagation(),a.action.onClick?.(),i(a.id)},className:"ml-3 px-2 py-0.5 bg-white/20 hover:bg-white/30 rounded text-xs font-bold uppercase tracking-wider transition-colors border border-white/10",children:a.action.label||"Action"})]},a.id))}),document.body)]})}function To(t={}){const{wishlist:e,userId:r}=t,[n,i]=b.useState([]),[a,o]=b.useState(!0),[l,c]=b.useState(null),{currentUser:u}=Sr(),f=async()=>{if(u){o(!0);try{const m=new URLSearchParams;e!==void 0&&m.append("wishlist",e),r&&m.append("userId",r),m.append("ts",Date.now());const v=(await Ze.get(`/api/collection?${m.toString()}`)).map(j=>({...j.data,...j,deckId:j.deck_id,quantity:j.count,firestoreId:j.firestore_id,id:j.id,scryfall_id:j.scryfall_id}));i(v),c(null)}catch(m){console.error("Error fetching collection:",m),c(m)}finally{o(!1)}}};return b.useEffect(()=>{if(!u){i([]),o(!1);return}f()},[u,r,e]),{cards:n,loading:a,error:l,refresh:f,removeCard:async m=>{try{await Ze.delete(`/api/collection/${m}`),await f()}catch(y){throw console.error("Error removing card:",y),y}},updateCard:async(m,y)=>{try{await Ze.put(`/api/collection/${m}`,y),await f()}catch(v){throw console.error("Error updating card:",v),v}},setCards:i}}function Wse(t,e){const[r,n]=b.useState(t);return b.useEffect(()=>{const i=setTimeout(()=>{n(t)},e);return()=>{clearTimeout(i)}},[t,e]),r}const Di={async addCardToCollection(t,e,r=1,n,i=!1,a=null){return Ze.post("/api/collection",{scryfall_id:e.id,name:e.name,set_code:e.set||e.set_code,collector_number:e.collector_number,finish:n||e.finish||"nonfoil",count:r,data:e,deck_id:null,is_wishlist:i,targetUserId:a})},async updateCard(t,e){return Ze.put(`/api/collection/${t}`,e)},async removeCard(t){return Ze.delete(`/api/collection/${t}`)},async importBatch(t,e,r="merge",n=null){return Ze.post("/api/collection/batch",{cards:e,mode:r,decks:n})},async batchRemoveCards(t){return Ze.delete("/api/collection/batch/delete",{cardIds:t})}},wa={fetchRelationships:async()=>Ze.get("/api/community/relationships"),sendRequest:async(t,e="pod")=>{const r=typeof t=="string"?{targetEmail:t,type:e}:{...t,type:e};return Ze.post("/api/community/relationships/request",r)},respondToRequest:async(t,e)=>Ze.put(`/api/community/relationships/${t}`,{status:e}),deleteRelationship:async t=>Ze.delete(`/api/community/relationships/${t}`),fetchPermissions:async(t=null)=>Ze.get(`/api/community/permissions${t?`?deckId=${t}`:""}`),fetchIncomingPermissions:async()=>Ze.get("/api/community/permissions?direction=incoming"),grantPermission:async(t,e,r=null)=>Ze.post("/api/community/permissions",{granteeId:t,permissionLevel:e,deckId:r}),revokePermission:async t=>Ze.delete(`/api/community/permissions/${t}`),updateDeckPublicStatus:async(t,e,r)=>Ze.put(`/api/decks/${t}`,{isPublic:e,shareSlug:r})},TF=b.createContext();function Ab(){return b.useContext(TF)}function Gse({children:t}){const[e,r]=b.useState(null),[n,i]=b.useState(!1),a=b.useCallback(l=>{r(l),i(!0)},[]),o=b.useCallback(()=>{i(!1),setTimeout(()=>r(null),300)},[]);return s.jsx(TF.Provider,{value:{selectedCard:e,isOpen:n,openCardModal:a,closeCardModal:o},children:t})}const LF=b.memo(function({card:e,normalCount:r=0,foilCount:n=0,wishlistCount:i=0,onUpdateCount:a,onUpdateWishlistCount:o,ownerName:l,currentUser:c,showOwnerTag:u=!1}){const{openCardModal:f}=Ab(),[p,x]=b.useState(!1),m=l||e.owner_username||(c&&(e.owner_id===c.id||e.user_id===c.id)?c.username||"ME":null),y=(T,I=0)=>{if(!T)return"https://placehold.co/250x350?text=No+Image";const B=T.data||T;return B.card_faces&&B.card_faces.length>1?B.card_faces[I]?.image_uris?.normal||T.image_uri||"https://placehold.co/250x350?text=No+Image":B.image_uris?.normal||T.image_uri||"https://placehold.co/250x350?text=No+Image"},v=e.data?.card_faces||e.card_faces,j=v?.length>1&&!!v[1].image_uris,N=y(e,0),C=j?y(e,1):null,A=T=>{T.stopPropagation(),f(e)},L=(T,I,B)=>{T.stopPropagation(),a&&a(e,I,B)},O=r+n>0,F=!O&&i>0;return e.finish==="foil"?e.prices?.usd_foil||e.prices?.usd:e.prices?.usd||e.prices?.usd_foil,s.jsxs("div",{className:`group relative flex bg-gray-900/60 backdrop-blur-md rounded-xl overflow-hidden shadow-2xl border transition-all duration-300 hover:shadow-[0_0_30px_rgba(79,70,229,0.15)] aspect-[3.2/3.5] perspective-1000 ${O?"border-indigo-500/30":"border-white/5 grayscale-[0.8] opacity-70 hover:grayscale-0 hover:opacity-100"}`,children:[s.jsxs("div",{className:"relative aspect-[2.5/3.5] h-full cursor-pointer overflow-hidden bg-gray-950 shrink-0",onClick:A,children:[s.jsxs("div",{className:`relative w-full h-full transition-all duration-700 transform-style-3d ${p?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 backface-hidden",children:[s.jsx("img",{src:N,alt:e.name,className:"w-full h-full object-cover",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-t from-indigo-500/20 to-transparent transition-opacity duration-500"})]}),j&&s.jsx("div",{className:"absolute inset-0 backface-hidden rotate-y-180",children:s.jsx("img",{src:C||N,alt:`${e.name} Back`,className:"w-full h-full object-cover"})})]}),j&&s.jsx("button",{onClick:T=>{T.stopPropagation(),x(!p)},className:"absolute top-2 left-2 p-2 bg-black/60 hover:bg-indigo-600 text-white rounded-full backdrop-blur-md transition-all z-30 shadow-lg border border-white/10",title:"Flip Card",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),F&&s.jsx("div",{className:`absolute top-2 ${j?"left-12":"left-2"} z-20 bg-orange-500 text-white p-1 rounded-md shadow-lg animate-pulse`,children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),u&&m&&O&&s.jsxs("div",{className:`absolute ${j||F?"top-16":"top-12"} left-2 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-30 backdrop-blur-md uppercase tracking-wider`,children:[" ",m]}),s.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10 font-mono",children:s.jsxs("div",{className:"bg-black/80 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-1 bg-white/5 border-b border-white/5 text-xs font-black tracking-wider text-gray-300",children:[s.jsx("span",{children:e.set?.toUpperCase()}),s.jsxs("span",{children:["#",e.collector_number]})]}),s.jsxs("div",{className:"flex items-center justify-around px-2 py-1.5 text-[11px]",children:[s.jsxs("span",{className:"text-gray-300",children:["$",(parseFloat(e.prices?.usd)||0).toFixed(2)]}),s.jsx("div",{className:"h-3 w-[1px] bg-white/20"}),s.jsxs("span",{className:"text-yellow-400 font-bold",children:["$",(parseFloat(e.prices?.usd_foil)||0).toFixed(2)," "]})]})]})})]}),s.jsxs("div",{className:"flex-1 bg-black/40 flex flex-col justify-between py-1 border-l border-white/5 relative",children:[s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-white/5 transition-colors group/sec",children:[s.jsx("button",{onClick:T=>L(T,"normal",1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-white tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:r}),s.jsx("span",{className:"text-[8px] font-black uppercase text-gray-600 tracking-[0.2em] -mt-1",children:"Normal"})]}),s.jsx("button",{onClick:T=>L(T,"normal",-1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 disabled:opacity-0",disabled:r<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-indigo-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:T=>L(T,"foil",1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-indigo-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:n}),s.jsx("span",{className:"text-[8px] font-black uppercase text-indigo-600 tracking-[0.2em] -mt-1",children:"Foil"})]}),s.jsx("button",{onClick:T=>L(T,"foil",-1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:n<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-orange-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:T=>{T.stopPropagation(),o&&o(e,1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-orange-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:i}),s.jsx("span",{className:"text-[8px] font-black uppercase text-orange-600 tracking-[0.2em] -mt-1",children:"Wish"})]}),s.jsx("button",{onClick:T=>{T.stopPropagation(),o&&o(e,-1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:i<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]})]})]})});function Vse({title:t,titleId:e,...r},n){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?b.createElement("title",{id:e},t):null,b.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const Yse=b.forwardRef(Vse);function Kse({title:t,titleId:e,...r},n){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?b.createElement("title",{id:e},t):null,b.createElement("path",{fillRule:"evenodd",d:"M3.792 2.938A49.069 49.069 0 0 1 12 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 0 1 1.541 1.836v1.044a3 3 0 0 1-.879 2.121l-6.182 6.182a1.5 1.5 0 0 0-.439 1.061v2.927a3 3 0 0 1-1.658 2.684l-1.757.878A.75.75 0 0 1 9.75 21v-5.818a1.5 1.5 0 0 0-.44-1.06L3.13 7.938a3 3 0 0 1-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836Z",clipRule:"evenodd"}))}const OF=b.forwardRef(Kse),Xse=({value:t,onChange:e})=>{const[r,n]=b.useState(!1),i=b.useRef(null),a=[{label:"=",value:"="},{label:"",value:">="},{label:"",value:"<="}];b.useEffect(()=>{const l=c=>{i.current&&!i.current.contains(c.target)&&n(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const o=a.find(l=>l.value===t)||a[0];return s.jsxs("div",{className:"relative",ref:i,children:[s.jsxs("button",{type:"button",onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-3 bg-gray-900/50 hover:bg-gray-800 text-indigo-400 font-bold rounded-l-xl border-r border-white/10 transition-colors min-w-[50px] justify-center",children:[o.label,s.jsx("svg",{className:`w-3 h-3 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&s.jsx("div",{className:"absolute top-full left-0 mt-1 w-20 bg-gray-900 border border-white/10 rounded-lg shadow-2xl z-[70] overflow-hidden backdrop-blur-xl",children:a.map(l=>s.jsx("button",{type:"button",onClick:()=>{e(l.value),n(!1)},className:`w-full px-4 py-2 text-left text-sm font-bold transition-colors ${t===l.value?"bg-indigo-600 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:l.label},l.value))})]})},O6=({isOpen:t,onClose:e,onAddCard:r,onOpenForgeLens:n})=>{const[i,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState(""),[f,p]=b.useState(""),[x,m]=b.useState(null),[y,v]=b.useState([]),[j,N]=b.useState(!1),[C,A]=b.useState([]),[L,O]=b.useState(!1),[F,T]=b.useState([]),[I,B]=b.useState("or"),[$,k]=b.useState(!1),[R,P]=b.useState(!1),[q,X]=b.useState([]),[G,ne]=b.useState(""),[ee,se]=b.useState(""),[J,W]=b.useState({operator:"=",value:""}),[U,Y]=b.useState({operator:"=",value:""}),[te,ce]=b.useState({operator:"=",value:""}),[xe,ue]=b.useState(""),[ve,Q]=b.useState(""),{results:pe,loading:Ce,error:je,searchCards:we,getSuggestions:Te}=qse(),{currentUser:oe}=Sr(),{addToast:De}=wn(),{cards:Nt,refresh:ot}=To({userId:x||void 0}),Ne=b.useRef(null),Ge=b.useRef(null),Xe=Wse(i,300);b.useEffect(()=>{Xe.length>=2&&o?xt(Xe):Xe.length<2&&A([])},[Xe]);const xt=async Ue=>{const Bt=await Te(Ue);A(Bt),O(Bt.length>0)};b.useEffect(()=>{t&&(async()=>{try{const zt=(await wa.fetchIncomingPermissions()).filter(Ot=>["editor","admin","contributor"].includes(Ot.permission_level)&&!Ot.target_deck_id);v(zt)}catch(Bt){console.error("Failed to load writable collections",Bt)}})()},[t]);const Ae=b.useMemo(()=>{const Ue=new Map;return Nt&&Nt.forEach(Bt=>{const zt=Bt.scryfall_id||Bt.id;Ue.has(zt)||Ue.set(zt,[]),Ue.get(zt).push(Bt)}),Ue},[Nt]);b.useEffect(()=>{t&&Ne.current&&Ne.current.focus()},[t]);const Pe=Ue=>{Ue&&Ue.preventDefault(),O(!1);const Bt={set:c,cn:f,colors:F.length>0?F:void 0,colorLogic:I,colorIdentity:$,colorExcluded:R,rarity:q.length>0?q:void 0,type:G,text:ee,flavor:xe,artist:ve,mv:J.value!==""?{operator:J.operator,value:Number(J.value)}:void 0,power:U.value!==""?{operator:U.operator,value:Number(U.value)}:void 0,toughness:te.value!==""?{operator:te.operator,value:Number(te.value)}:void 0};we(i,Bt)},ct=()=>{a(""),u(""),p(""),T([]),P(!1),X([]),ne(""),se(""),W({operator:"=",value:""}),Y({operator:"=",value:""}),ce({operator:"=",value:""}),ue(""),Q("")},bt=Ue=>{T(Bt=>Bt.includes(Ue)?Bt.filter(zt=>zt!==Ue):[...Bt,Ue])},dt=Ue=>{X(Bt=>Bt.includes(Ue)?Bt.filter(zt=>zt!==Ue):[...Bt,Ue])},Ve=async(Ue,Bt,zt)=>{if(!oe)return De("Please log in","error");try{const Ot=Ue.id,Et=Ae.get(Ot)||[],$t=Bt==="foil"?"foil":"nonfoil",At=Et.find(Xt=>Xt.finish===$t&&!Xt.deck_id&&!Xt.is_wishlist);if(zt>0)if(At)await Di.updateCard(At.id,{count:At.count+1}),De(`Added ${$t} ${Ue.name}`,"success");else{const Xt=await Di.addCardToCollection(oe.uid,Ue,1,$t,!1,x);if(De(`Added new ${$t} ${Ue.name}`,"success"),r&&Xt&&Xt.id){const qt={...Ue,firestoreId:Xt.id,id:Ue.id,finish:$t,count:1,is_wishlist:!1};r(qt)}}else At&&(At.count>1?(await Di.updateCard(At.id,{count:At.count-1}),De(`Removed ${$t} ${Ue.name}`,"info")):(await Di.removeCard(At.id),De(`Removed last ${$t} ${Ue.name}`,"info")));ot()}catch(Ot){console.error("Update failed",Ot),De("Failed to update collection","error")}},lt=async(Ue,Bt)=>{if(!oe)return De("Please log in","error");try{const zt=Ue.id,Et=(Ae.get(zt)||[]).find($t=>$t.is_wishlist&&!$t.deck_id);Bt>0?Et?(await Di.updateCard(Et.id,{count:Et.count+1}),De(`Increased ${Ue.name} in wishlist`,"success")):(await Di.addCardToCollection(oe.uid,Ue,1,"nonfoil",!0,x),De(`Added ${Ue.name} to wishlist`,"success")):Et&&(Et.count>1?(await Di.updateCard(Et.id,{count:Et.count-1}),De(`Decreased ${Ue.name} in wishlist`,"info")):(await Di.removeCard(Et.id),De(`Removed ${Ue.name} from wishlist`,"info"))),ot()}catch(zt){console.error("Wishlist update failed",zt),De("Failed to update wishlist","error")}};if(!t)return null;const kt={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"},C:{bg:"bg-gray-400",text:"text-gray-900",border:"border-gray-500",symbol:"https://svgs.scryfall.io/card-symbols/C.svg"}};return Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in group",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-white/5",children:[s.jsxs("div",{className:"px-6 py-5 border-b border-white/5 flex justify-between items-center bg-white/5 flex-shrink-0",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Card Library"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-500/10 text-indigo-300 uppercase tracking-wider border border-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]",children:"Database"})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[y.length>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-black/20 rounded-lg p-1 border border-white/5",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-2",children:"Target:"}),s.jsxs("select",{value:x||"",onChange:Ue=>m(Ue.target.value||null),className:"bg-transparent text-xs text-white focus:outline-none font-bold cursor-pointer hover:text-indigo-300 transition-colors",children:[s.jsx("option",{value:"",className:"bg-gray-900",children:"My Collection"}),y.map(Ue=>s.jsxs("option",{value:Ue.owner_id,className:"bg-gray-900",children:[Ue.owner_username,"'s Collection (",Ue.permission_level,")"]},Ue.owner_id))]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),n&&s.jsxs("div",{className:"relative overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 via-purple-600/20 to-indigo-600/20 opacity-50 blur-xl group-hover:opacity-75 transition-opacity"}),s.jsxs("div",{className:"relative px-6 py-2 border-b border-white/5 flex items-center justify-between bg-white/5 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center text-indigo-300 shadow-[0_0_15px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:"Have the physical card?"}),s.jsx("span",{className:"hidden sm:inline-block h-1 w-1 rounded-full bg-gray-600"}),s.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider hidden sm:block",children:"Scan instantly with Forge Lens AI"})]})]}),s.jsxs("button",{onClick:n,className:"px-5 py-1.5 bg-indigo-500/20 hover:bg-indigo-500/30 hover:text-white text-indigo-300 border border-indigo-500/30 rounded-lg font-bold text-[10px] uppercase tracking-wider transition-all shadow-[0_0_20px_rgba(99,102,241,0.1)] hover:shadow-[0_0_20px_rgba(99,102,241,0.3)] flex items-center gap-2",children:[s.jsx("span",{children:"Launch Scanner"}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar bg-black/20",children:[s.jsx("div",{className:"p-6 space-y-4 relative z-[60]",children:s.jsxs("form",{onSubmit:Pe,className:"relative flex flex-col gap-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1 group",children:[s.jsx("input",{ref:Ne,type:"text",placeholder:"Search cards...",className:"w-full bg-white/5 text-white border border-white/10 rounded-xl py-4 px-6 pl-14 pr-12 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all placeholder-gray-500 backdrop-blur-sm",value:i,onChange:Ue=>{a(Ue.target.value),l(!0),O(!0)},onFocus:()=>i.length>=2&&O(!0)}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>{a(""),A([]),Ne.current?.focus()},className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-1 rounded-full hover:bg-white/10 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),L&&C.length>0&&s.jsx("div",{ref:Ge,className:"absolute top-full left-0 right-0 mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 max-h-60 overflow-y-auto custom-scrollbar",children:C.map((Ue,Bt)=>s.jsx("button",{type:"button",onClick:()=>{a(Ue),l(!1),O(!1),we(Ue,{set:c,cn:f})},className:"w-full text-left px-6 py-3 hover:bg-white/5 text-gray-400 hover:text-white transition-colors border-b border-white/5 last:border-0",children:Ue},Bt))})]}),s.jsxs("button",{type:"button",onClick:()=>N(!j),className:`px-6 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${j?"bg-indigo-600 text-white border-indigo-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(OF,{className:"w-5 h-5"}),"Advanced Search"]}),s.jsx("button",{type:"submit",disabled:Ce,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl text-lg font-bold transition-all disabled:opacity-50 min-w-[120px] shadow-lg shadow-indigo-500/20",children:Ce?"...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${j?"max-h-[800px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 space-y-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Advanced Configuration"}),s.jsx("button",{onClick:ct,className:"text-orange-500 hover:text-orange-400 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Reset Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Colors"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex gap-2",children:Object.entries(kt).map(([Ue,Bt])=>s.jsx("button",{type:"button",onClick:()=>bt(Ue),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${F.includes(Ue)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:F.includes(Ue)?"transparent":""},children:s.jsx("img",{src:Bt.symbol,alt:Ue,className:`w-full h-full ${F.includes(Ue)?"drop-shadow-md":"grayscale"}`})},Ue))}),s.jsx("div",{className:"flex items-center gap-2 text-sm bg-gray-900 border border-white/10 rounded-lg p-1",children:["or","and"].map(Ue=>s.jsx("button",{type:"button",onClick:()=>B(Ue),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${I===Ue?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:Ue},Ue))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Rarity"}),s.jsx("div",{className:"flex gap-3",children:["common","uncommon","rare","mythic"].map(Ue=>s.jsx("button",{type:"button",onClick:()=>dt(Ue),className:`px-3 py-1.5 rounded-lg border text-xs font-bold uppercase transition-all ${q.includes(Ue)?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-gray-900 border-white/10 text-gray-500 hover:text-gray-300"}`,children:Ue.charAt(0)},Ue))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Type"}),s.jsx("input",{type:"text",placeholder:"Creature, Artifact...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:G,onChange:Ue=>ne(Ue.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Text"}),s.jsx("input",{type:"text",placeholder:"Rules text...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:ee,onChange:Ue=>se(Ue.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Mana Value"}),s.jsxs("div",{className:"flex items-center bg-gray-900 border border-white/10 rounded-xl overflow-hidden",children:[s.jsx(Xse,{value:J.operator,onChange:Ue=>W({...J,operator:Ue})}),s.jsx("input",{type:"number",className:"w-full bg-transparent p-2 text-sm outline-none",value:J.value,onChange:Ue=>W({...J,value:Ue.target.value})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Set"}),s.jsx("input",{type:"text",placeholder:"ABC",maxLength:5,className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none uppercase",value:c,onChange:Ue=>u(Ue.target.value)})]}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"CN"}),s.jsx("input",{type:"text",placeholder:"#",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:f,onChange:Ue=>p(Ue.target.value)})]})]})]})]})})]})}),s.jsxs("div",{className:"p-6",children:[je&&s.jsx("div",{className:"flex items-center justify-center p-8 text-red-400 bg-red-500/10 rounded-2xl border border-red-500/20",children:s.jsx("p",{className:"font-bold",children:je})}),!Ce&&pe.length===0&&(i||j)&&!je&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("p",{className:"text-lg font-bold",children:"No matches found"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:pe.map((Ue,Bt)=>{const zt=Ae.get(Ue.id)||[],Ot=zt.filter(At=>At.finish==="nonfoil"&&!At.deck_id&&!At.is_wishlist).reduce((At,Xt)=>At+(Xt.count||1),0),Et=zt.filter(At=>At.finish==="foil"&&!At.deck_id&&!At.is_wishlist).reduce((At,Xt)=>At+(Xt.count||1),0),$t=zt.filter(At=>At.is_wishlist&&!At.deck_id).reduce((At,Xt)=>At+(Xt.count||1),0);return s.jsx(LF,{card:Ue,normalCount:Ot,foilCount:Et,wishlistCount:$t,onUpdateCount:Ve,onUpdateWishlistCount:lt},Ue.id||Bt)})})]})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]}),document.body)},Jse="gemini-2.5-flash-preview-09-2025",yo={generateDeckSuggestions:async(t,e)=>{const{deckName:r,commander:n,playerProfile:i,strategyGuide:a,helperPersona:o,targetRole:l,candidates:c,currentContext:u,neededCount:f,experienceLevel:p="Advanced"}=e,x=`https://generativelanguage.googleapis.com/v1beta/models/${Jse}:generateContent?key=${t||""}`,m=o?.name||"The Oracle",y=o?.type||"AI",v=o?.personality||"Professional and helpful",j=`You are ${m}, a ${y}. 
        Your personality is: ${v}.

        VOICE GUIDELINES:
        - When writing the 'reason' for a card, strictly adhere to your personality.
        - Address the user as an equal (or however your personality dictates).
        - If you are snarky or high-minded, use that tone to explain why a card is mathematically or strategically superior to the "garbage" others play.

        YOUR CORE MISSION:
        - You specialize in "Psychographic Profiling"matching a deck's mechanical soul to a player's specific psychological needs.
        - Analyze the PLAYER PROFILE: ${i}
        - Analyze the STRATEGY GUIDE: ${a}
        - Select EXACTLY ${f} cards from the CANDIDATE LIST for the role of '${l}'.
        
        CRITICAL SELECTION CRITERIA:
        - SYNERGY OVER STAPLES: Prefer cards that enable the specific loops in the Strategy Guide.
        - PLAYER SATISFACTION: Align card mechanics with the player's desire for "inescapable defeat" or "meticulous engineering."`,A={contents:[{parts:[{text:`
            DECK: ${r}
            COMMANDER: ${n}
            
            [PLAYER PSYCHOGRAPHIC PROFILE]
            ${i}
            
            [GUIDING STRATEGY & ASSUMED ABILITIES]
            ${a}
            
            [CURRENT DECK CONTEXT]
            ${u?.length>0?u.join(", "):"No cards added yet."}
            
            [CATEGORY TO FILL]
            I need exactly ${f} cards for the '${l}' slot.
            
            [CANDIDATE POOL]
            ${c.map(T=>`ID: ${T.firestoreId} | Name: ${T.name} | Type: ${T.type_line}`).join(`
`)}
            
            OUTPUT REQUIREMENTS:
            Return a JSON object with 'suggestions'. 
            In the 'reason' field, speak as ${m} (${v}). Explain why the card is a perfect choice for the user's style, perhaps mocking the inadequacy of alternative cards.
        `}]}],systemInstruction:{parts:[{text:j}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},rating:{type:"NUMBER"},reason:{type:"STRING",description:"Justification written in the voice of the custom helper persona."}},required:["firestoreId","rating","reason"]}}}}}};let L=0;const O=5,F=[1e3,2e3,4e3,8e3,16e3];for(;L<O;)try{const T=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!T.ok){const $=await T.json();throw new Error($.error?.message||`HTTP error! status: ${T.status}`)}const B=(await T.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(!B)throw new Error("The Oracle returned an empty vision.");return JSON.parse(B)}catch(T){if(L++,L===O)throw new Error(`The Oracle (${m}) is currently silent. Details: ${T.message}`);await new Promise(I=>setTimeout(I,F[L-1]))}},async sendMessage(t,e,r,n="",i=null){if(!t)throw new Error("API Key is missing. Please add it in Settings.");const a=i?.name||"MTG Forge",o=i?.personality?`Personality: ${i.personality}`:"Personality: Knowledgeable, friendly, and concise.",c=[{role:"user",parts:[{text:`
You are ${a}, an elite Magic: The Gathering AI assistant.
Your goal is to provide accurate, strategic, and engaging advice to players.

**Persona & Style:**
- ${o}
- Use emojis to add flair (e.g., , , , , , , ).
- Format responses using **Tailwind CSS** classes within HTML tags for a premium look.
- Do NOT use Markdown. Output raw HTML that can be injected directly into a <div>.

**Formatting Rules:**
- Use <p class="mb-2 text-gray-300"> for paragraphs.
- Use <strong class="text-indigo-400"> for key terms or card names.
- Use <ul class="list-disc pl-5 mb-2 space-y-1 text-gray-300"> for lists.
- Use <div class="bg-gray-700/50 p-3 rounded-lg border-l-4 border-indigo-500 mb-2"> for important notes or rules citations.
- Use <code class="bg-gray-900 px-1 py-0.5 rounded text-indigo-300 font-mono text-sm"> for mana costs (e.g., {1}{U}{B}) or keywords.

**Content Guidance:**
- If asked about rules, cite the Comprehensive Rules if possible.
- If asked about deck building, consider mana curve, synergy, and format staples.
- If asked about lore, be descriptive and immersive.

Context from User's Current View:
${n}
`.trim()}]},...e.map(p=>({role:p.role==="user"?"user":"model",parts:[{text:p.content}]})),{role:"user",parts:[{text:r}]}],u=["gemini-2.5-flash","gemini-2.0-flash","gemini-flash-latest","gemini-2.5-flash-lite","gemini-2.0-flash-lite","gemini-flash-lite-latest","gemini-exp-1206","gemini-pro-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-pro","gemini-1.5-pro-latest"];let f=null;for(const p of u)try{const x=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${p}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:c})});if(!x.ok){const v=await x.json();if(x.status===404||x.status===429){console.warn(`Model ${p} failed (${x.status}). Trying next...`),f=v;continue}throw new Error(v.error?.message||`Gemini API Error: ${x.statusText}`)}return(await x.json()).candidates?.[0]?.content?.parts?.[0]?.text||"I couldn't generate a response."}catch(x){console.warn(`Error with model ${p}:`,x),f=x}throw console.error("All Gemini models failed. Last error:",f),f||new Error("Failed to connect to any Gemini model.")},async spruceUpText(t,e,r="General"){const n=`
            You are an expert project manager and communications specialist.
            Please rewrite the following ${r} description to be more professional, clear, and structured.
            
            - Use **HTML** formatting (<b>, <ul>, <li>, <p>, <br>).
            - Keep it concise but detailed enough.
            - Correct any grammar or spelling mistakes.
            - If it's a bug report, ensure steps are clear.
            - If it's a feature request (Epic), ensure the value/goal is clear.
            - Do NOT wrap the output in markdown code blocks or quotes. Just return the raw HTML string.
            
            Original Text:
            "${e}"
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Spruce Up Error:",i),new Error("Failed to spruce up text.")}},async getDeckStrategy(t,e,r=null,n=[],i=null){if(!t)throw new Error("API Key is missing.");const a=i?.name||"The Oracle",o=i?.personality?`Adopt the persona of ${a}: ${i.personality}`:"Act as a Magic: The Gathering expert.",l=n&&n.length>0,c=l?`Existing Deck List Analysis:
${n.map(p=>`- ${p.countInDeck||1}x ${p.name} (${p.type_line||"Unknown"})`).join(`
`)}

Total Lands: ${n.reduce((p,x)=>x.type_line?.toLowerCase().includes("land")?p+(x.countInDeck||1):p,0)}`:"This is a NEW deck build.";let u="";r&&(u=`
                User Playstyle Profile:
                - Archetypes: ${r.archetypes?.join(", ")||"N/A"}
                - Summary: ${r.summary||"N/A"}
                - Aggression: ${r.scores?.aggression||0}
                - Combo Affinity: ${r.scores?.comboAffinity||0}
                - Interaction: ${r.scores?.interaction||0}
                Tailor the deck's theme and card suggestions to align with this playstyle.
            `);const f=`
            ${o} I have chosen "${e}" as my Commander.
            
            ${c}
            
            ${l?"Analyze the PROVIDED deck list. Identify the specific game plan, key synergies between these cards, and how to pilot THIS build.":"Suggest a competitive yet fun deck strategy tailored to the following playstyle."}
            
            ${u}

            **Deck Composition Goals:**
            - Lands: 35-38
            - Mana Ramp: 10-12
            - Card Draw: 10
            - Targeted Removal: 8-10
            - Board Wipes: 2-4
            - Synergy / Strategy: 25-30

            **Mana Curve Goal (Bell Curve):**
            - 1-2 Mana: High volume for setup.
            - 3-4 Mana: Moderate volume for utility/threats.
            - 5+ Mana: Low volume for finishers.

            **Formatting Instructions:**
            - Use **HTML** for the 'strategy' field.
            - The 'theme' field should be a **short, punchy title** (e.g., "Elemental Mastery", "Shadow Infiltration").
            - The 'strategy' field should start with a **Theme Summary**: 2-3 sentences providing high-level context, styled with a distinct, prominent look.
            - Focus on a structured breakdown:
              1. **Welcome/Theme Summary**: A few sentences on why this commander and theme work.
              2. **Commander Context**: What are the assumed or key abilities that drive the build?
              3. **Early Game (Turns 1-3)**: Focus on setup, ramp, and disruption. Use a  emoji.
              4. **Mid Game (Turns 4-6)**: Focus on value engines and commander deployment. Use a  emoji.
              5. **Late Game (Turns 7+)**: Focus on finishers and storming off. Use a  emoji.
              6. **Key Synergies & Combos**: Highlight 3-4 specific card combinations. Use a  emoji.
            - Use **Tailwind CSS** classes (e.g., <span class="text-indigo-400 font-bold">Key Card</span>) to highlight important terms.
            - Use headers for each phase (e.g., <h4 class="text-indigo-400 font-black uppercase mb-2"> Early Game</h4>).
            5. **CRITICAL: Deck Composition Numbers**:
                - You MUST calculate specific counts for this specific commander strategies.
                - Do NOT use generic numbers (like 10/10/10). Tailor them! (e.g., A spellslinger deck might want 25 Instants and only 5 Creatures).
                - The 'functional' categories MUST sum to exactly **99** cards (assuming 1 commander).
                - The 'types' categories MUST sum to exactly **99** cards.
                - Ensure 'Lands' concept matches in both sections (e.g. if Functional Lands is 36, Type Lands should be 36).

            You MUST respond with VALID JSON strictly matching this format:
            {
                "layout": {
                    "functional": {
                        "Lands": 36, 
                        "Mana Ramp": 10,
                        "Card Draw": 10,
                        "Targeted Removal": 10,
                        "Board Wipes": 3,
                        "Synergy / Strategy": 30
                    },
                    "types": {
                        "Creatures": 30,
                        "Instants": 10,
                        "Sorceries": 10,
                        "Artifacts": 10,
                        "Enchantments": 5,
                        "Planeswalkers": 0,
                        "Lands": 34
                    }
                },
                "suggestedName": "...",
                "theme": "...",
                "strategy": "<div>...Structured HTML Content...</div>"
            }
            CRITICAL: 
            1. 'layout' is the MOST IMPORTANT field. It MUST be populated.
            2. 'functional' counts must sum to exactly 99.
            3. 'types' counts must sum to exactly 99. 
            4. Do NOT refer to yourself as "The Oracle" unless your name is explicitly "The Oracle". Use ONLY your assigned name: ${a}.
            Do NOT use markdown code blocks. Return only the JSON string.
        `;try{console.log("[GeminiService] sending prompt to Gemini...");const p=await this.sendMessage(t,[],f);console.log("[GeminiService] raw response length:",p?.length);const x=p.replace(/```json/g,"").replace(/```/g,"").trim(),m=JSON.parse(x);return console.log("[GeminiService] parsed strategy:",m),m}catch(p){throw console.error("AI Strategy Error:",p),new Error("Failed to generate strategy. Please try again.")}},async generatePlaystyleQuestion(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert survey designer for Magic: The Gathering (MTG) players. Your goal is to create the most informative question to understand a user's playstyle based on their previous answers. Questions should be clear and concise, with 3-5 distinct multiple-choice answers. Avoid repeating questions. Focus on different aspects of MTG playstyles, such as deck preferences, game strategies, social interaction styles, and risk tolerance.";let n;e.length===0?n="Generate the very first question for an MTG playstyle questionnaire. This question should gauge the player's overall experience with the game, as this will help tailor subsequent questions.":e.length===1?n="Generate the second question for an MTG playstyle questionnaire. This question should build on the player's overall experience and delve into their specific preferences.":e.length===2?n="Generate the third question for an MTG playstyle questionnaire. This question should explore the player's fantasy or thematic preferences in deck building.":n=`Based on the user's previous answers, generate the next single best question to further refine their playstyle profile. Do not repeat questions.

Previous Answers:
${e.map(o=>`- ${o.question}: ${o.answer}`).join(`
`)}`;const i=`${r}

${n}

Respond with VALID JSON ONLY:
{ "question": "...", "choices": ["...", "..."] }`;try{const o=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(o)}catch(a){throw console.error("Gemini Question Error:",a),a}},async synthesizePlaystyle(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert MTG coach and psychographic analyst. Your task is to analyze a player's answers and synthesize a detailed playstyle profile. The summary should be a concise paragraph. Scores must be 0-100.",n=`Analyze the following questionnaire answers and generate a detailed playstyle profile in JSON format.

${e.map(a=>`- ${a.question} -> ${a.answer}`).join(`
`)}`,i=`${r}

${n}

Respond with VALID JSON ONLY matching this schema:
        {
            "summary": "...",
            "tags": ["tag1", "tag2"],
            "scores": { "aggression": 50, "consistency": 50, "interaction": 50, "variance": 50, "comboAffinity": 50 },
            "archetypes": ["archetype1", "archetype2"]
        }`;try{const o=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(o)}catch(a){throw console.error("Gemini Synthesis Error:",a),new Error("Failed to synthesize profile.")}},async refinePlaystyleChat(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Oracle",a=n?.personality?`Personality: ${n.personality}`:"Personality: Wise, insightful, slightly magical.",o=e.length===0,l=`
            You are ${i}, an expert MTG coach conducting a "Deep Dive" interview to build a player's psychographic profile.
            ${a}

            Current Profile Summary: ${r?.summary||"New Profile"}
            Current Tags: ${r?.tags?.join(", ")||"None"}

            Instructions:
            ${o?`1. Introduce yourself as ${i}.
                   2. Explain that you want to understand their playstyle to help build better decks.
                   3. Ask the FIRST open-ended question to start the profile (e.g. "What draws you to magic?").`:`1. Analyze the user's latest input.
                   2. Formulate a conversational response (warm, insightful, matching your persona).
                   3. Ask ONE follow-up question to dig deeper into a missing or vague area.
                   4. Simultaneously, UPDATE the JSON profile based on the new information (merging with known info).`}
        `,c=e.slice(-6),u=[{role:"user",parts:[{text:l}]},...c.map(m=>({role:m.role==="user"?"user":"model",parts:[{text:m.content}]}))],f=`
            ${o?"Generate the initial greeting and first question.":"Based on the conversation, respond to the user and update the profile."}
            RETURN JSON ONLY.
        `;u.push({role:"user",parts:[{text:f}]});const p=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let x=[];for(const m of p){try{const y=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${m}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:u,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedProfile:{type:"OBJECT",properties:{summary:{type:"STRING"},tags:{type:"ARRAY",items:{type:"STRING"}},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},consistency:{type:"NUMBER"},interaction:{type:"NUMBER"},comboAffinity:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}},required:["summary","tags","scores","archetypes"]}},required:["aiResponse","updatedProfile"]}}})});if(y.ok){const j=(await y.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(j)return JSON.parse(j)}else{const v=await y.json();if(x.push(`${m} (Schema): ${y.status} ${v.error?.message||""}`),y.status===404||y.status===429)continue}}catch(y){x.push(`${m} (Schema Error): ${y.message}`)}try{const y=JSON.parse(JSON.stringify(u));y[y.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedProfile: object }`;const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${m}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:y})});if(v.ok){const N=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(N){const C=N.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(C)}}else{const j=await v.json();x.push(`${m} (Raw): ${v.status} ${j.error?.message||""}`)}}catch(y){x.push(`${m} (Raw Error): ${y.message}`)}}throw console.error("Gemini Chat Refine Exhausted:",x),new Error(`Oracle Exhausted: ${x[0]||"Unknown error"}`)},async forgeHelperChat(t,e,r){if(!t)throw new Error("API Key is missing.");const n=`
            You are an expert fantasy writer and character designer allowing a user to "Forge" their own AI companion for Magic: The Gathering.
            Your goal is to interview the user to define their Helper's Persona.
            
            Current Draft:
            - Name: ${r?.name||"Unknown"}
            - Type: ${r?.type||"Unknown"} (e.g., Spirit, Goblin, Construct, Wizard)
            - Personality: ${r?.personality||"Unknown"} (e.g., Snarky, Wise, Aggressive)

            Instructions:
            1. Analyze the user's input.
            2. If they provided new info (name, type, personality), UPDATE the JSON draft locally.
            3. Respond in a neutral, helpful "System" tone (like a character creation menu guide).
            4. Ask for the missing fields one by one.
            5. If all fields are present, ask for confirmation.
        `,i=e.slice(-6),a=[{role:"user",parts:[{text:n}]},...i.map(u=>({role:u.role==="user"?"user":"model",parts:[{text:u.content}]}))];a.push({role:"user",parts:[{text:`
            Based on the conversation, respond to the user and update the helper draft.
            RETURN JSON ONLY.
        `}]});const l=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let c=[];for(const u of l){try{const f=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${u}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:a,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedDraft:{type:"OBJECT",properties:{name:{type:"STRING"},type:{type:"STRING"},personality:{type:"STRING"}},required:["name","type","personality"]}},required:["aiResponse","updatedDraft"]}}})});if(f.ok){const x=(await f.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(x)return JSON.parse(x)}else{const p=await f.json();if(c.push(`${u}: ${f.status}`),f.status===404||f.status===429)continue}}catch(f){c.push(`${u}: ${f.message}`)}try{const f=JSON.parse(JSON.stringify(a));f[f.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedDraft: object }`;const p=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${u}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:f})});if(p.ok){const m=(await p.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(m){const y=m.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(y)}}}catch{}}throw new Error(`Forge Exhausted: ${c.join(" | ")}`)},async generateDeckSuggestions(t,e,r=null){if(!t)throw new Error("API Key is missing.");const{playstyle:n,targetRole:i,deckRequirements:a}=e,o=r?.name||"Expert MTG Deck Builder",l=r?.personality?`Adopt the persona of ${o}: ${r.personality}`:"";let c="";n&&(c=`
                User Playstyle: ${n.archetypes?.join(", ")||"N/A"}. 
                Summary: ${n.summary||"N/A"}.
            `);const u=`
            You are ${o}. ${l}
            Analyze the provided candidates to build a well-balanced deck.
            ${c}
            
            **Mana Curve Priorities (Bell Curve):**
            Focus on CMC 1-2 for high volume, 3-4 for moderate, 5+ for finishers.

            **Multi-Role Fulfillment:**
            You will be given a list of "Requirements" (Target Counts per Role).
            Select the best cards from the candidates to fill these specific roles.
            Ensure you meet the target counts for each role as best as possible.
            Assign a specific "role" string to each suggestion matching the Requirement key.
        `,f=["gemini-2.0-flash","gemini-flash-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro","gemini-1.5-pro-latest"],p={role:"system",parts:[{text:u}]},x=[{role:"user",parts:[{text:`Task: ${e.instructions}

Requirements: ${JSON.stringify(a||{})}

Candidates: ${JSON.stringify(e.candidates)}

IMPORTANT: You MUST respond with a VALID JSON object containing a "suggestions" array. Each suggestion needs "rating" (1-10), "reason", and "role".`}]}];let m=[];for(const y of f){try{const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${y}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:p,contents:x,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},name:{type:"STRING"},count:{type:"NUMBER"},rating:{type:"NUMBER"},reason:{type:"STRING"},role:{type:"STRING"},isBasicLand:{type:"BOOLEAN"}},required:["rating","reason","role"]}}},required:["suggestions"]}}})});if(v.ok){const N=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(N)return JSON.parse(N)}else{const j=await v.json();if(m.push(`${y} (Schema): ${v.status} ${j.error?.message||""}`),v.status===404||v.status===429)continue}}catch(v){m.push(`${y} (Schema Error): ${v.message}`)}try{const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${y}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:p,contents:[{role:"user",parts:[{text:`${x[0].parts[0].text}

You MUST respond with VALID RAW JSON format ONLY. Do not use markdown blocks.`}]}]})});if(v.ok){const N=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(N){const C=N.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(C)}}else{const j=await v.json();m.push(`${y} (Raw): ${v.status} ${j.error?.message||""}`)}}catch(v){m.push(`${y} (Raw Error): ${v.message}`)}}throw console.error("[Gemini] All models failed. Summary:",m),new Error(`Oracle Exhausted: ${m.join(" | ")}`)},async analyzeDeck(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Deck Doctor",a=n?.personality?`Adopt the persona of ${i}: ${n.personality}`:"Personality: Clinical, precise, but encouraging.",o=e.map(p=>`- ${p.countInDeck||1}x ${p.name} (${p.type_line})`).join(`
`)+`

Total Lands: ${e.reduce((p,x)=>x.type_line?.toLowerCase().includes("land")?p+(x.countInDeck||1):p,0)}`,l=`
            You are ${i}, an expert Magic: The Gathering deck consultant.
            ${a}
            Your goal is to Grade a deck on a scale of 0-100 and identify critical flaws.
        `,c=`
            Analyze this Commander deck for "${r}":
            
            ${o}

            **Rubric:**
            - **Synergy**: Do cards support the commander?
            - **Speed**: Is there enough ramp? Is the curve too high?
            - **Interaction**: Is there enough removal/protection?
            - **Consistency**: Is there enough card draw/tutors?

            **Task:**
            1. Calculate a Score (0-100).
            2. Rate Synergy, Speed, Interaction (0-100).
            3. List 3-5 critical "Issues" (strings).
            4. Propose up to 5 specific "Changes". For each change:
                - "remove": Exact card name to cut.
                - "add": Exact card name to add.
                - "reason": Why?

            **Response Format (VALID JSON ONLY):**
            {
                "score": 85,
                "metrics": { "synergy": 80, "speed": 70, "interaction": 60 },
                "issues": ["Not enough lands (32)", "Lack of board wipes"],
                "changes": [
                    { "remove": "Bad Card", "add": "Good Card", "reason": "Strict upgrade for mana cost." }
                ]
            }
        `,u=[{role:"user",parts:[{text:l}]},{role:"user",parts:[{text:c}]}],f=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash"];for(const p of f)try{const x=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${p}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:u,generationConfig:{responseMimeType:"application/json"}})});if(x.ok){const y=(await x.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(y)return JSON.parse(y)}}catch(x){console.warn(`Deck Doctor (${p}) failed:`,x)}throw new Error("Deck Doctor failed to diagnose.")},async generateReleaseNotes(t,e){if(!t)throw new Error("API Key is missing.");if(!e||e.length===0)throw new Error("No tickets provided for release notes.");const n=`
            You are a professional software release manager and technical writer for "MTG-Forge". 
            Generate a Development Update in HTML using Tailwind CSS. 
            Strictly follow the structure and styling below.

            **TICKETS DATA:**
            ${e.map(i=>{const a=i.type==="bug"&&i.created_by_username?` [Submitted by: ${i.created_by_username}]`:"";return`- [${i.type.toUpperCase()}] [Status: ${i.status}] ${i.title}${i.epic_title?` (Project: ${i.epic_title})`:""}${a}: ${i.description?.replace(/<[^>]*>?/gm,"").substring(0,200)}...`}).join(`
`)}

            **STRICT LAYOUT RULES:**
            1. **Title**: A large, bold title like "MTG-Forge Development Update! ".
            2. **Intro**: A warm greeting for "Planeswalkers" with a globe emoji .
            3. **Sections**: Group items into:
               - " New Features" (Completed features)
               - " Bug Fixes" (Completed bugs)
               - " In Progress" (Everything else)
            4. **Section Cards**: Each section should have ONE large card containing its list of items.
               - Card Style: <div class="bg-gray-800/40 border-l-4 p-4 rounded-lg mb-6 ...">
               - Border Colors: green-500 for Features, red-500 for Bugs, gray-500 for In Progress.
            5. **Feature/Bug items**: Use <strong> for titles. For bugs, include a subtle "@username" shoutout for the report.
            6. **Highlights**: Use <span class="text-indigo-400 font-bold"> for important keywords or project names.
            7. **Sign-off**: A final warm closing message to Planeswalkers, ending with "see you in the next patch! ".

            **TECHNICAL CONSTRAINTS:**
            - Use only Tailwind CSS classes.
            - Do NOT use markdown code blocks (\`\`\`html).
            - Output ONLY the clean HTML string.
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Release Notes Error:",i),new Error("Failed to generate release notes.")}},gradeDeck:async(t,e)=>{const{deckName:r,commander:n,cards:i,playerProfile:a,strategyGuide:o,helperPersona:l}=e;l?.name;const p={contents:[{parts:[{text:`
            Analyze this deck: "${r}"
            Commander: ${n}
            
            [DECK LIST]
            ${i.map(y=>`${y.countInDeck||1}x ${y.name} (${y.type_line})`).join(`
`)}
            
            Return JSON only.
        `}]}],systemInstruction:{parts:[{text:`You are a Magic: The Gathering usage analytics engine and professional deck consultant.
        Your task is to classify a Commander deck into the "Commander Brackets" (1-5), calculate a precise "Power Level" (1.0 - 10.0), and provide deep surgical analysis.
        
        DEFINITIONS:
        - **Bracket 1 (Exhibition)**: Ultra-casual. No Mass Land Denial (MLD), no extra turns, no 2-card infinite combos, few tutors. "Few game changers."
        - **Bracket 2 (Core)**: Average current preconstructed deck. No MLD, no chaining extra turns, no 2-card infinite combos, few tutors.
        - **Bracket 3 (Upgraded)**: Beyond the strength of an average precon. Late game 2-card infinite combos allowed, up to 3 "game changers".
        - **Bracket 4 (Optimized)**: High power commander. No restrictions (other than the banned list). Highly efficient.
        - **Bracket 5 (cEDH)**: Maximum power, very competitive and metagame focused mindset. No restrictions.

        METRICS:
        - **Efficiency** (0-10): Speed of mana curve and ramp.
        - **Interaction** (0-10): Count and efficiency of removal/protection.
        - **Win_Turn** (Attempted Win Turn): Average turn the deck threatens a win.
        
        DIAGNOSTICS:
        - Provide a "Critique" (The overall state of the deck).
        - Provide "Mechanical Improvements" (General strategic advice).
        - Provide "Recommended Swaps" (Specific card-for-card replacements from the meta).
        
        OUTPUT: Return a JSON object with the calculated metrics and diagnostics.`}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{powerLevel:{type:"NUMBER",description:"Precise Power Level float (1.0 to 10.0). e.g. 6.13"},commanderBracket:{type:"INTEGER",description:"Bracket ID: 1, 2, 3, 4, or 5"},metrics:{type:"OBJECT",properties:{efficiency:{type:"NUMBER",description:"0-10 score"},interaction:{type:"NUMBER",description:"0-10 score"},winTurn:{type:"NUMBER",description:"Estimated average win turn"}}},bracketJustification:{type:"STRING",description:"Short explanation of why it falls in this bracket."},critique:{type:"STRING",description:"Deep analysis of the deck's current state."},mechanicalImprovements:{type:"ARRAY",items:{type:"STRING"},description:"List of general strategic improvements."},recommendedSwaps:{type:"ARRAY",items:{type:"OBJECT",properties:{remove:{type:"STRING",description:"Card to remove"},add:{type:"STRING",description:"Card to add"},reason:{type:"STRING",description:"Why this swap is better"}},required:["remove","add","reason"]}},pros:{type:"ARRAY",items:{type:"STRING"}},cons:{type:"ARRAY",items:{type:"STRING"}}},required:["powerLevel","commanderBracket","metrics","bracketJustification","critique","mechanicalImprovements","recommendedSwaps"]}}};let x=0,m="gemini-3-flash-preview";for(;x<4;)try{const y=`https://generativelanguage.googleapis.com/v1beta/models/${m}:generateContent?key=${t||""}`,v=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(v.status===429){if(console.warn(`Deck Doctor: Rate Limited (429) on ${m}. Switching to backup...`),m==="gemini-3-flash-preview")m="gemini-2.0-flash-exp";else if(m==="gemini-2.0-flash-exp")m="gemini-1.5-flash";else throw new Error("All models exhausted");await new Promise(C=>setTimeout(C,1e3));continue}if(!v.ok)throw new Error(`API Error: ${v.status}`);const N=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(N)return JSON.parse(N);throw new Error("Empty response from AI")}catch(y){console.warn(`Deck Grade Attempt ${x+1} failed:`,y),x++,await new Promise(v=>setTimeout(v,1e3*x))}throw new Error("Failed to Grade Deck. The Oracle is currently overwhelmed.")}},cv=10,MF=({isOpen:t,onClose:e,onComplete:r})=>{const{userProfile:n}=Sr(),[i,a]=b.useState("selection"),[o,l]=b.useState("intro"),[c,u]=b.useState([]),[f,p]=b.useState([]),[x,m]=b.useState(null),[y,v]=b.useState(null),[j,N]=b.useState([]),[C,A]=b.useState(null),[L,O]=b.useState(""),F=b.useRef(null),[T,I]=b.useState(!1),[B,$]=b.useState(null),k=n?.settings?.helper?.name||"The Oracle";b.useEffect(()=>{t&&R()},[t]),b.useEffect(()=>{F.current?.scrollIntoView({behavior:"smooth"})},[j]);const R=()=>{a("selection"),l("intro"),p([]),N([]),A(null),$(null),v(null),O("")},P=()=>{a("quick"),l("loading"),q([])},q=async W=>{l("loading"),I(!0),$(null),v(null);try{const U=n?.settings?.geminiApiKey;if(!U)throw new Error("Gemini API Key is missing.");const Y=await yo.generatePlaystyleQuestion(U,W);m(Y),l("question")}catch(U){console.error("Quick Wizard Error:",U),$(U.message||"Failed to summon the oracle."),a("error")}finally{I(!1)}},X=async W=>{v(W),await new Promise(te=>setTimeout(te,600));const U={question:x.question,answer:W},Y=[...f,U];p(Y),Y.length>=cv?G(Y):q(Y)},G=async W=>{a("synthesis");try{const U=n?.settings?.geminiApiKey,Y=await yo.synthesizePlaystyle(U,W);r&&await r(Y),e()}catch{$("Failed to synthesize your profile."),a("error")}},ne=async()=>{a("advanced"),l("chat"),I(!0),A({summary:"Pending analysis...",tags:[],scores:{}});try{const W=n?.settings?.geminiApiKey;if(!W)throw new Error("API Key missing.");const U=await yo.refinePlaystyleChat(W,[],C,n.settings.helper);N([{role:"model",content:U.aiResponse}])}catch(W){console.error("Intro Error:",W),N([{role:"model",content:`Greetings. I am ${k}. Let us begin our analysis.`}])}finally{I(!1)}},ee=async()=>{if(!L.trim())return;const W={role:"user",content:L},U=[...j,W];N(U),O(""),I(!0);try{const Y=n?.settings?.geminiApiKey;if(!Y)throw new Error("API Key missing.");const te=await yo.refinePlaystyleChat(Y,U,C,n.settings.helper);A(te.updatedProfile),N(ce=>[...ce,{role:"model",content:te.aiResponse}])}catch(Y){console.error("Chat Error:",Y),N(te=>[...te,{role:"model",content:"My connection to the leyline flickered. Please repeat that."}])}finally{I(!1)}},se=async()=>{a("synthesis"),C&&r&&await r(C),e()},J=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),ee())};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl h-[85vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-20 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i==="selection"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 space-y-12 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"How shall we determine your magical signature?"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl",children:[s.jsxs("button",{onClick:P,className:"group relative bg-gray-800/50 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13 2L3 14h9v8l10-12h-9l9-8z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Quick Setup"}),s.jsxs("p",{className:"text-gray-400 group-hover:text-gray-300",children:["Answer ",cv," rapid-fire questions to generate a baseline profile. Best for getting started quickly."]}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-indigo-400 uppercase tracking-wider",children:["Start Assessment ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]}),s.jsxs("button",{onClick:ne,className:"group relative bg-gray-800/50 hover:bg-purple-900/20 border border-gray-700 hover:border-purple-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-purple-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-purple-300 transition-colors",children:"Deep Dive"}),s.jsx("p",{className:"text-gray-400 group-hover:text-gray-300",children:"Have a conversation with the Oracle. Iterate on your preferences in real-time for a highly tailored profile."}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-purple-400 uppercase tracking-wider",children:["Enter The Sanctum ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]})]}),s.jsx("div",{className:"text-gray-500 text-sm",children:"You can always retake this assessment later from your profile settings."})]}),i==="quick"&&s.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-900",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-gray-900/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 mr-3"}),"Quick Assessment"]}),s.jsxs("div",{className:"text-sm font-mono text-indigo-400",children:["Q",f.length+1," / ",cv]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-8 flex flex-col items-center justify-center",children:o==="loading"?s.jsxs("div",{className:"flex flex-col items-center space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"Consulting the archives..."})]}):x&&s.jsxs("div",{className:"max-w-2xl w-full space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:{width:`${f.length/cv*100}%`}})}),s.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-relaxed text-center",children:x.question}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:x.choices.map((W,U)=>{const Y=y===W;return s.jsxs("button",{onClick:()=>X(W),disabled:y!==null,className:`
                                                            group flex items-center p-4 rounded-xl border transition-all duration-200 text-left
                                                            ${Y?"bg-indigo-600/20 border-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-gray-800 border-gray-700 hover:bg-gray-750 hover:border-gray-600"}
                                                            ${y&&!Y?"opacity-50":""}
                                                        `,children:[s.jsx("span",{className:`
                                                            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 transition-colors
                                                            ${Y?"bg-indigo-500 text-white":"bg-gray-700 text-gray-400 group-hover:bg-gray-600"}
                                                        `,children:String.fromCharCode(65+U)}),s.jsx("span",{className:`text-lg transition-colors ${Y?"text-white":"text-gray-300 group-hover:text-white"}`,dangerouslySetInnerHTML:{__html:W}})]},U)})})]})})]}),i==="advanced"&&s.jsxs("div",{className:"flex-1 flex h-full",children:[s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 border-r border-gray-800 w-2/3",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center px-6 bg-gray-900/80 backdrop-blur-sm z-10",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold",children:k}),s.jsx("p",{className:"text-xs text-purple-400",children:"Deep Dive Analysis"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[j.map((W,U)=>s.jsx("div",{className:`flex ${W.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`
                                            max-w-[80%] rounded-2xl p-4 text-sm leading-relaxed
                                            ${W.role==="user"?"bg-purple-600 text-white rounded-br-none":"bg-gray-800 text-gray-200 border border-gray-700 rounded-bl-none"}
                                        `,children:W.content})},U)),T&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 border border-gray-700 rounded-bl-none flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-100"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-200"})]})}),s.jsx("div",{ref:F})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:L,onChange:W=>O(W.target.value),onKeyDown:J,placeholder:"Describe your playstyle...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500",disabled:T}),s.jsx("button",{onClick:ee,disabled:T||!L.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 rounded-xl font-bold transition-colors",children:"Send"})]})})]}),s.jsxs("div",{className:"w-1/3 bg-gray-950 p-6 overflow-y-auto border-l border-gray-800 hidden md:block",children:[s.jsxs("h3",{className:"text-white font-bold mb-6 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Live Profile Summary"]}),C?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Analysis"}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:C.summary||"Gathering data..."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Dominant Traits"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:C.tags?.length>0?C.tags.map((W,U)=>s.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:W},U)):s.jsx("span",{className:"text-gray-600 text-xs italic",children:"Pending..."})})]}),C.scores&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Psychographics"}),Object.entries(C.scores).map(([W,U])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1 capitalize",children:[s.jsx("span",{children:W.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{children:[U,"%"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-indigo-500",style:{width:`${U}%`}})})]},W))]}),s.jsxs("div",{className:"pt-6 border-t border-gray-800",children:[s.jsx("button",{onClick:se,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold shadow-lg hover:shadow-green-500/20 transition-all",children:"Finalize Profile"}),s.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Click whenever you feel the profile is accurate."})]})]}):s.jsxs("div",{className:"text-center py-10 text-gray-600",children:[s.jsx("div",{className:"animate-pulse mb-2 text-4xl",children:""}),s.jsx("p",{className:"text-sm",children:"The Oracle is listening..."})]})]})]}),i==="synthesis"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6 bg-gray-900 p-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-10 w-10 bg-green-500/20 rounded-full animate-pulse"})})]}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Finalizing your Grimoire..."}),s.jsx("p",{className:"text-gray-400",children:"Saving your magical identity to the archives."})]}),i==="error"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4 bg-gray-900 text-center p-8",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Something went wrong"}),s.jsx("p",{className:"text-red-300 max-w-md mx-auto",children:B}),s.jsx("button",{onClick:R,className:"mt-6 bg-gray-800 hover:bg-gray-700 text-white py-3 px-8 rounded-lg transition-colors border border-gray-600",children:"Try Again"})]})]})}):null},Zse=({isOpen:t,onClose:e,profile:r,onRetake:n,userImage:i})=>{if(!t)return null;if(!r)return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-md bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-8 text-center space-y-6",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Playstyle Found"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"You haven't taken the assessment yet. Discover your magical identity and get better recommendations!"})]}),s.jsx("button",{onClick:n,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-0.5",children:"Start Assessment"})]})});const{summary:a,tags:o,scores:l,archetypes:c}=r;return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[s.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-800/50 p-8 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-6 ring-4 ring-gray-800 overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Playstyle"}),s.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:o&&o.map((u,f)=>s.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:u},f))}),s.jsx("button",{onClick:n,className:"mt-auto w-full py-3 px-4 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg text-sm font-bold transition-all border border-gray-600 hover:border-gray-500",children:"Retake Assessment"})]}),s.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Analysis Summary"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed text-lg font-serif italic border-l-4 border-indigo-500 pl-4 bg-gray-800/30 py-4 pr-4 rounded-r",children:['"',a,'"']})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),s.jsx("div",{className:"space-y-4",children:l&&Object.entries(l).map(([u,f])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-400 capitalize",children:u.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{className:"text-white font-mono",children:[f,"/100"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${Qse(f)}`,style:{width:`${f}%`}})})]},u))})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Recommended Archetypes"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:c&&c.map((u,f)=>s.jsxs("div",{className:"bg-gray-800/80 p-4 rounded-lg border border-gray-700 flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),s.jsx("span",{className:"text-gray-200 font-medium",children:u})]},f))})]})]})]})]})]})})};function Qse(t){return t>75?"bg-green-500":t>50?"bg-blue-500":t>25?"bg-yellow-500":"bg-red-500"}const eie=[{id:"alpha_tester",label:"Alpha Tester",icon:"",description:"Restoring balance to the multiverse."},{id:"bug_hunter",label:"Bug Hunter",icon:"",description:"Tracking down pests in the code."},{id:"architect",label:"Architect",icon:"",description:"Building the foundation of the future."},{id:"spark_ignited",label:"Spark Ignited",icon:"",description:"First to walk the planes."},{id:"data_scryer",label:"Data Scryer",icon:"",description:"Analyzing the meta streams."},{id:"stress_tester",label:"Stress Tester",icon:"",description:"Breaking things so we can fix them."},{id:"feedback_loop",label:"Feedback Loop",icon:"",description:"Iterating towards perfection."},{id:"void_gazer",label:"Void Gazer",icon:"",description:"Staring into the console logs."}],tie=({isOpen:t,onClose:e,currentBadgeId:r,onSelect:n,isMaster:i})=>t?s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto w-full h-full flex items-center justify-center md:pl-[250px]",children:[s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-2xl mx-4 overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-500",children:""})," Customize Your Badge"]}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a badge to display next to your profile."})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto custom-scrollbar",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:eie.filter(a=>a.id!=="architect"||i).map(a=>s.jsxs("button",{onClick:()=>n(a),className:`flex items-center gap-4 p-4 rounded-xl border text-left transition-all ${r===a.id?"bg-indigo-900/30 border-indigo-500 ring-1 ring-indigo-500/50":"bg-gray-800/30 border-gray-700 hover:bg-gray-800 hover:border-gray-600"}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-2xl shadow-inner border border-gray-700",children:a.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:`font-bold ${r===a.id?"text-indigo-300":"text-white"}`,children:a.label}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]})]},a.id))})}),s.jsx("div",{className:"p-4 bg-gray-800/50 border-t border-gray-800 text-center text-xs text-gray-500",children:"Thank you for being an early supporter of MTG-Forge."})]})]}):null,Jt={FREE:"free",TIER_1:"tier_1",TIER_2:"tier_2",TIER_3:"tier_3",TIER_4:"tier_4",TIER_5:"tier_5"},Cs={[Jt.FREE]:{name:"Initiate",prices:{monthly:null,biannual:null,yearly:null},description:"The journey begins. Track up to 3 decks and 300 cards.",limits:{collection:300,wishlist:105,decks:3,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[Jt.TIER_1]:{name:"Apprentice",prices:{monthly:"price_1SnxT7RZLrZbIKATICyA3jfB",biannual:"price_1SnxUeRZLrZbIKATlErTgHtz",yearly:"price_1SnxUuRZLrZbIKATm6nmPnUr"},description:"Perfect for new potential. Store up to 10 decks and 1,000 cards.",limits:{collection:1e3,wishlist:300,decks:10,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[Jt.TIER_2]:{name:"Magician",prices:{monthly:"price_1SnvK5DBKqoK8H1Rj7uSTSfw",biannual:"price_1SnvVSDBKqoK8H1RFAqc0iIH",yearly:"price_1SnvVfDBKqoK8H1RryOTO2p8"},description:"Unlock the power of organization. 25 decks, 2,000 cards, and advanced tools.",limits:{collection:2e3,wishlist:1e3,decks:25,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!0,pods:!1}},[Jt.TIER_3]:{name:"Wizard",prices:{monthly:"price_1SnvKxDBKqoK8H1RXvh1VsT3",biannual:"price_1SnvUkDBKqoK8H1RgX9mlcxs",yearly:"price_1SnvUwDBKqoK8H1RAUVYJtmM"},description:"Master your craft. 55 decks, 5,000 cards, Pods, and the AI Deck Doctor.",limits:{collection:5e3,wishlist:2500,decks:55,pods:3},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[Jt.TIER_4]:{name:"Archmage",prices:{monthly:"price_1SnvMxDBKqoK8H1RVcOon0kC",biannual:"price_1SnvUSDBKqoK8H1RRAXjFJ1h",yearly:"price_1SnvUSDBKqoK8H1RBMhvTUZA"},description:"Command a vast library. 100 decks, 10,000 cards, and advanced management.",limits:{collection:1e4,wishlist:5e3,decks:100,pods:5},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[Jt.TIER_5]:{name:"Planeswalker",prices:{monthly:"price_1SnvSmDBKqoK8H1RCezHNZSu",biannual:"price_1SnvTcDBKqoK8H1RAmz1kB1d",yearly:"price_1SnvTcDBKqoK8H1Rn1rFWAws"},description:"Rule the multiverse. Unlimited access to all features and storage.",limits:{collection:1/0,wishlist:1/0,decks:1/0,pods:1/0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}}};function vn(t){return Cs[t]||Cs[Jt.FREE]}var m1={exports:{}},rie=m1.exports,d7;function nie(){return d7||(d7=1,(function(t,e){(function(n,i){t.exports=i(Fu())})(rie,function(r){return(function(n){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return n[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=n,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(f){return o[f]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(n,i,a){a.r(i);var o=a("react"),l=(function(){var x=function(m,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,j){v.__proto__=j}||function(v,j){for(var N in j)j.hasOwnProperty(N)&&(v[N]=j[N])},x(m,y)};return function(m,y){x(m,y);function v(){this.constructor=m}m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}})(),c=function(){return c=Object.assign||function(x){for(var m,y=1,v=arguments.length;y<v;y++){m=arguments[y];for(var j in m)Object.prototype.hasOwnProperty.call(m,j)&&(x[j]=m[j])}return x},c.apply(this,arguments)},u=function(x,m){var y={};for(var v in x)Object.prototype.hasOwnProperty.call(x,v)&&m.indexOf(v)<0&&(y[v]=x[v]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,v=Object.getOwnPropertySymbols(x);j<v.length;j++)m.indexOf(v[j])<0&&Object.prototype.propertyIsEnumerable.call(x,v[j])&&(y[v[j]]=x[v[j]]);return y};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(m){var y=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return y?new Promise(function(v,j){y.call(navigator,m,v,j)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function f(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var p=(function(x){l(m,x);function m(y){var v=x.call(this,y)||this;return v.canvas=null,v.ctx=null,v.requestUserMediaId=0,v.unmounted=!1,v.state={hasUserMedia:!1},v}return m.prototype.componentDidMount=function(){var y=this,v=y.state,j=y.props;if(this.unmounted=!1,!f()){j.onUserMediaError("getUserMedia not supported");return}v.hasUserMedia||this.requestUserMedia(),j.children&&typeof j.children!="function"&&console.warn("children must be a function")},m.prototype.componentDidUpdate=function(y){var v=this.props;if(!f()){v.onUserMediaError("getUserMedia not supported");return}var j=JSON.stringify(y.audioConstraints)!==JSON.stringify(v.audioConstraints),N=JSON.stringify(y.videoConstraints)!==JSON.stringify(v.videoConstraints),C=y.minScreenshotWidth!==v.minScreenshotWidth,A=y.minScreenshotHeight!==v.minScreenshotHeight;(N||C||A)&&(this.canvas=null,this.ctx=null),(j||N)&&(this.stopAndCleanup(),this.requestUserMedia())},m.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},m.stopMediaStream=function(y){y&&(y.getVideoTracks&&y.getAudioTracks?(y.getVideoTracks().map(function(v){y.removeTrack(v),v.stop()}),y.getAudioTracks().map(function(v){y.removeTrack(v),v.stop()})):y.stop())},m.prototype.stopAndCleanup=function(){var y=this.state;y.hasUserMedia&&(m.stopMediaStream(this.stream),y.src&&window.URL.revokeObjectURL(y.src))},m.prototype.getScreenshot=function(y){var v=this,j=v.state,N=v.props;if(!j.hasUserMedia)return null;var C=this.getCanvas(y);return C&&C.toDataURL(N.screenshotFormat,N.screenshotQuality)},m.prototype.getCanvas=function(y){var v=this,j=v.state,N=v.props;if(!this.video||!j.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var C=this.video.videoWidth,A=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var L=C/A;C=N.minScreenshotWidth||this.video.clientWidth,A=C/L,N.minScreenshotHeight&&A<N.minScreenshotHeight&&(A=N.minScreenshotHeight,C=A*L)}this.canvas=document.createElement("canvas"),this.canvas.width=y?.width||C,this.canvas.height=y?.height||A,this.ctx=this.canvas.getContext("2d")}var O=this,F=O.ctx,T=O.canvas;return F&&T&&(T.width=y?.width||T.width,T.height=y?.height||T.height,N.mirrored&&(F.translate(T.width,0),F.scale(-1,1)),F.imageSmoothingEnabled=N.imageSmoothing,F.drawImage(this.video,0,0,y?.width||T.width,y?.height||T.height),N.mirrored&&(F.scale(-1,1),F.translate(-T.width,0))),T},m.prototype.requestUserMedia=function(){var y=this,v=this.props,j=function(A,L){var O={video:typeof L<"u"?L:!0};v.audio&&(O.audio=typeof A<"u"?A:!0),y.requestUserMediaId++;var F=y.requestUserMediaId;navigator.mediaDevices.getUserMedia(O).then(function(T){y.unmounted||F!==y.requestUserMediaId?m.stopMediaStream(T):y.handleUserMedia(null,T)}).catch(function(T){y.handleUserMedia(T)})};if("mediaDevices"in navigator)j(v.audioConstraints,v.videoConstraints);else{var N=function(A){return{optional:[{sourceId:A}]}},C=function(A){var L=A.deviceId;return typeof L=="string"?L:Array.isArray(L)&&L.length>0?L[0]:typeof L=="object"&&L.ideal?L.ideal:null};MediaStreamTrack.getSources(function(A){var L=null,O=null;A.forEach(function(I){I.kind==="audio"?L=I.id:I.kind==="video"&&(O=I.id)});var F=C(v.audioConstraints);F&&(L=F);var T=C(v.videoConstraints);T&&(O=T),j(N(L),N(O))})}},m.prototype.handleUserMedia=function(y,v){var j=this.props;if(y||!v){this.setState({hasUserMedia:!1}),j.onUserMediaError(y);return}this.stream=v;try{this.video&&(this.video.srcObject=v),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(v)})}j.onUserMedia(v)},m.prototype.render=function(){var y=this,v=this,j=v.state,N=v.props,C=N.audio;N.forceScreenshotSourceSize;var A=N.disablePictureInPicture;N.onUserMedia,N.onUserMediaError,N.screenshotFormat,N.screenshotQuality,N.minScreenshotWidth,N.minScreenshotHeight,N.audioConstraints,N.videoConstraints,N.imageSmoothing;var L=N.mirrored,O=N.style,F=O===void 0?{}:O,T=N.children,I=u(N,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),B=L?c(c({},F),{transform:(F.transform||"")+" scaleX(-1)"}):F,$={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",c({autoPlay:!0,disablePictureInPicture:A,src:j.src,muted:!C,playsInline:!0,ref:function(k){y.video=k},style:B},I)),T&&T($))},m.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},m})(o.Component);i.default=p}),react:(function(n,i){n.exports=r})}).default})})(m1)),m1.exports}var sie=nie();const PF=Co(sie);var kj={exports:{}},u7;function iie(){return u7||(u7=1,(function(t){var e=(function(r){var n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(se,J,W){se[J]=W.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function p(se,J,W){return Object.defineProperty(se,J,{value:W,enumerable:!0,configurable:!0,writable:!0}),se[J]}try{p({},"")}catch{p=function(J,W,U){return J[W]=U}}function x(se,J,W,U){var Y=J&&J.prototype instanceof A?J:A,te=Object.create(Y.prototype),ce=new G(U||[]);return a(te,"_invoke",{value:R(se,W,ce)}),te}r.wrap=x;function m(se,J,W){try{return{type:"normal",arg:se.call(J,W)}}catch(U){return{type:"throw",arg:U}}}var y="suspendedStart",v="suspendedYield",j="executing",N="completed",C={};function A(){}function L(){}function O(){}var F={};p(F,c,function(){return this});var T=Object.getPrototypeOf,I=T&&T(T(ne([])));I&&I!==n&&i.call(I,c)&&(F=I);var B=O.prototype=A.prototype=Object.create(F);L.prototype=O,a(B,"constructor",{value:O,configurable:!0}),a(O,"constructor",{value:L,configurable:!0}),L.displayName=p(O,f,"GeneratorFunction");function $(se){["next","throw","return"].forEach(function(J){p(se,J,function(W){return this._invoke(J,W)})})}r.isGeneratorFunction=function(se){var J=typeof se=="function"&&se.constructor;return J?J===L||(J.displayName||J.name)==="GeneratorFunction":!1},r.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,O):(se.__proto__=O,p(se,f,"GeneratorFunction")),se.prototype=Object.create(B),se},r.awrap=function(se){return{__await:se}};function k(se,J){function W(te,ce,xe,ue){var ve=m(se[te],se,ce);if(ve.type==="throw")ue(ve.arg);else{var Q=ve.arg,pe=Q.value;return pe&&typeof pe=="object"&&i.call(pe,"__await")?J.resolve(pe.__await).then(function(Ce){W("next",Ce,xe,ue)},function(Ce){W("throw",Ce,xe,ue)}):J.resolve(pe).then(function(Ce){Q.value=Ce,xe(Q)},function(Ce){return W("throw",Ce,xe,ue)})}}var U;function Y(te,ce){function xe(){return new J(function(ue,ve){W(te,ce,ue,ve)})}return U=U?U.then(xe,xe):xe()}a(this,"_invoke",{value:Y})}$(k.prototype),p(k.prototype,u,function(){return this}),r.AsyncIterator=k,r.async=function(se,J,W,U,Y){Y===void 0&&(Y=Promise);var te=new k(x(se,J,W,U),Y);return r.isGeneratorFunction(J)?te:te.next().then(function(ce){return ce.done?ce.value:te.next()})};function R(se,J,W){var U=y;return function(te,ce){if(U===j)throw new Error("Generator is already running");if(U===N){if(te==="throw")throw ce;return ee()}for(W.method=te,W.arg=ce;;){var xe=W.delegate;if(xe){var ue=P(xe,W);if(ue){if(ue===C)continue;return ue}}if(W.method==="next")W.sent=W._sent=W.arg;else if(W.method==="throw"){if(U===y)throw U=N,W.arg;W.dispatchException(W.arg)}else W.method==="return"&&W.abrupt("return",W.arg);U=j;var ve=m(se,J,W);if(ve.type==="normal"){if(U=W.done?N:v,ve.arg===C)continue;return{value:ve.arg,done:W.done}}else ve.type==="throw"&&(U=N,W.method="throw",W.arg=ve.arg)}}}function P(se,J){var W=J.method,U=se.iterator[W];if(U===o)return J.delegate=null,W==="throw"&&se.iterator.return&&(J.method="return",J.arg=o,P(se,J),J.method==="throw")||W!=="return"&&(J.method="throw",J.arg=new TypeError("The iterator does not provide a '"+W+"' method")),C;var Y=m(U,se.iterator,J.arg);if(Y.type==="throw")return J.method="throw",J.arg=Y.arg,J.delegate=null,C;var te=Y.arg;if(!te)return J.method="throw",J.arg=new TypeError("iterator result is not an object"),J.delegate=null,C;if(te.done)J[se.resultName]=te.value,J.next=se.nextLoc,J.method!=="return"&&(J.method="next",J.arg=o);else return te;return J.delegate=null,C}$(B),p(B,f,"Generator"),p(B,c,function(){return this}),p(B,"toString",function(){return"[object Generator]"});function q(se){var J={tryLoc:se[0]};1 in se&&(J.catchLoc=se[1]),2 in se&&(J.finallyLoc=se[2],J.afterLoc=se[3]),this.tryEntries.push(J)}function X(se){var J=se.completion||{};J.type="normal",delete J.arg,se.completion=J}function G(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(q,this),this.reset(!0)}r.keys=function(se){var J=Object(se),W=[];for(var U in J)W.push(U);return W.reverse(),function Y(){for(;W.length;){var te=W.pop();if(te in J)return Y.value=te,Y.done=!1,Y}return Y.done=!0,Y}};function ne(se){if(se){var J=se[c];if(J)return J.call(se);if(typeof se.next=="function")return se;if(!isNaN(se.length)){var W=-1,U=function Y(){for(;++W<se.length;)if(i.call(se,W))return Y.value=se[W],Y.done=!1,Y;return Y.value=o,Y.done=!0,Y};return U.next=U}}return{next:ee}}r.values=ne;function ee(){return{value:o,done:!0}}return G.prototype={constructor:G,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(X),!se)for(var J in this)J.charAt(0)==="t"&&i.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=o)},stop:function(){this.done=!0;var se=this.tryEntries[0],J=se.completion;if(J.type==="throw")throw J.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var J=this;function W(ue,ve){return te.type="throw",te.arg=se,J.next=ue,ve&&(J.method="next",J.arg=o),!!ve}for(var U=this.tryEntries.length-1;U>=0;--U){var Y=this.tryEntries[U],te=Y.completion;if(Y.tryLoc==="root")return W("end");if(Y.tryLoc<=this.prev){var ce=i.call(Y,"catchLoc"),xe=i.call(Y,"finallyLoc");if(ce&&xe){if(this.prev<Y.catchLoc)return W(Y.catchLoc,!0);if(this.prev<Y.finallyLoc)return W(Y.finallyLoc)}else if(ce){if(this.prev<Y.catchLoc)return W(Y.catchLoc,!0)}else if(xe){if(this.prev<Y.finallyLoc)return W(Y.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(se,J){for(var W=this.tryEntries.length-1;W>=0;--W){var U=this.tryEntries[W];if(U.tryLoc<=this.prev&&i.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var Y=U;break}}Y&&(se==="break"||se==="continue")&&Y.tryLoc<=J&&J<=Y.finallyLoc&&(Y=null);var te=Y?Y.completion:{};return te.type=se,te.arg=J,Y?(this.method="next",this.next=Y.finallyLoc,C):this.complete(te)},complete:function(se,J){if(se.type==="throw")throw se.arg;return se.type==="break"||se.type==="continue"?this.next=se.arg:se.type==="return"?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):se.type==="normal"&&J&&(this.next=J),C},finish:function(se){for(var J=this.tryEntries.length-1;J>=0;--J){var W=this.tryEntries[J];if(W.finallyLoc===se)return this.complete(W.completion,W.afterLoc),X(W),C}},catch:function(se){for(var J=this.tryEntries.length-1;J>=0;--J){var W=this.tryEntries[J];if(W.tryLoc===se){var U=W.completion;if(U.type==="throw"){var Y=U.arg;X(W)}return Y}}throw new Error("illegal catch attempt")},delegateYield:function(se,J,W){return this.delegate={iterator:ne(se),resultName:J,nextLoc:W},this.method==="next"&&(this.arg=o),C}},r})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(kj)),kj.exports}var Sj,h7;function M6(){return h7||(h7=1,Sj=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),Sj}var _j,f7;function IF(){if(f7)return _j;f7=1;const t=M6();let e=0;return _j=({id:r,action:n,payload:i={}})=>{let a=r;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:n,payload:i}},_j}var Rg={},p7;function P6(){if(p7)return Rg;p7=1;let t=!1;return Rg.logging=t,Rg.setLogging=e=>{t=e},Rg.log=(...e)=>t?console.log.apply(this,e):null,Rg}var Cj,m7;function aie(){if(m7)return Cj;m7=1;const t=IF(),{log:e}=P6(),r=M6();let n=0;return Cj=()=>{const i=r("Scheduler",n),a={},o={};let l=[];n+=1;const c=()=>l.length,u=()=>Object.keys(a).length,f=()=>{if(l.length!==0){const v=Object.keys(a);for(let j=0;j<v.length;j+=1)if(typeof o[v[j]]>"u"){l[0](a[v[j]]);break}}},p=(v,j)=>new Promise((N,C)=>{const A=t({action:v,payload:j});l.push(async L=>{l.shift(),o[L.id]=A;try{N(await L[v].apply(this,[...j,A.id]))}catch(O){C(O)}finally{delete o[L.id],f()}}),e(`[${i}]: Add ${A.id} to JobQueue`),e(`[${i}]: JobQueue length=${l.length}`),f()});return{addWorker:v=>(a[v.id]=v,e(`[${i}]: Add ${v.id}`),e(`[${i}]: Number of workers=${u()}`),f(),v.id),addJob:async(v,...j)=>{if(u()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(v,j)},terminate:async()=>{Object.keys(a).forEach(async v=>{await a[v].terminate()}),l=[]},getQueueLen:c,getNumWorkers:u}},Cj}function oie(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Aj,g7;function lie(){return g7||(g7=1,Aj=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof oie=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),Aj}var Ej,x7;function cie(){if(x7)return Ej;x7=1;const e=lie()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return Ej=r=>{const n={...r};return["corePath","workerPath","langPath"].forEach(i=>{r[i]&&(n[i]=e(n[i]))}),n},Ej}var Tj,b7;function RF(){return b7||(b7=1,Tj={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),Tj}const die="7.0.0",uie={version:die};var Lj,y7;function hie(){return y7||(y7=1,Lj={workerBlobURL:!0,logger:()=>{}}),Lj}var Oj,v7;function fie(){if(v7)return Oj;v7=1;const t=uie.version;return Oj={...hie(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},Oj}var Mj,w7;function pie(){return w7||(w7=1,Mj=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const n=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(t);return r}),Mj}var Pj,j7;function mie(){return j7||(j7=1,Pj=t=>{t.terminate()}),Pj}var Ij,N7;function gie(){return N7||(N7=1,Ij=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}),Ij}var Rj,k7;function xie(){return k7||(k7=1,Rj=async(t,e)=>{t.postMessage(e)}),Rj}var Dj,S7;function bie(){if(S7)return Dj;S7=1;const t=r=>new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},a.readAsArrayBuffer(r)}),e=async r=>{let n=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?n=atob(r.split(",")[1]).split("").map(i=>i.charCodeAt(0)):n=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(n=await e(r.src)),r.tagName==="VIDEO"&&(n=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(i=>{r.toBlob(async a=>{n=await t(a),i()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const i=await r.convertToBlob();n=await t(i)}else(r instanceof File||r instanceof Blob)&&(n=await t(r));return new Uint8Array(n)};return Dj=e,Dj}var Bj,_7;function yie(){if(_7)return Bj;_7=1;const t=fie(),e=pie(),r=mie(),n=gie(),i=xie(),a=bie();return Bj={defaultOptions:t,spawnWorker:e,terminateWorker:r,onMessage:n,send:i,loadImage:a},Bj}var $j,C7;function DF(){if(C7)return $j;C7=1;const t=cie(),e=IF(),{log:r}=P6(),n=M6(),i=RF(),{defaultOptions:a,spawnWorker:o,terminateWorker:l,onMessage:c,loadImage:u,send:f}=yie();let p=0;return $j=async(x="eng",m=i.LSTM_ONLY,y={},v={})=>{const j=n("Worker",p),{logger:N,errorHandler:C,...A}=t({...a,...y}),L={},O=typeof x=="string"?x.split("+"):x;let F=m,T=v;const I=[i.DEFAULT,i.LSTM_ONLY].includes(m)&&!A.legacyCore;let B,$;const k=new Promise((Q,pe)=>{$=Q,B=pe}),R=Q=>{B(Q.message)};let P=o(A);P.onerror=R,p+=1;const q=({id:Q,action:pe,payload:Ce})=>new Promise((je,we)=>{r(`[${j}]: Start ${Q}, action=${pe}`);const Te=`${pe}-${Q}`;L[Te]={resolve:je,reject:we},f(P,{workerId:j,jobId:Q,action:pe,payload:Ce})}),X=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),G=Q=>q(e({id:Q,action:"load",payload:{options:{lstmOnly:I,corePath:A.corePath,logging:A.logging}}})),ne=(Q,pe,Ce)=>q(e({id:Ce,action:"FS",payload:{method:"writeFile",args:[Q,pe]}})),ee=(Q,pe)=>q(e({id:pe,action:"FS",payload:{method:"readFile",args:[Q,{encoding:"utf8"}]}})),se=(Q,pe)=>q(e({id:pe,action:"FS",payload:{method:"unlink",args:[Q]}})),J=(Q,pe,Ce)=>q(e({id:Ce,action:"FS",payload:{method:Q,args:pe}})),W=(Q,pe)=>q(e({id:pe,action:"loadLanguage",payload:{langs:Q,options:{langPath:A.langPath,dataPath:A.dataPath,cachePath:A.cachePath,cacheMethod:A.cacheMethod,gzip:A.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(F)&&!A.legacyLang}}})),U=(Q,pe,Ce,je)=>q(e({id:je,action:"initialize",payload:{langs:Q,oem:pe,config:Ce}})),Y=(Q="eng",pe,Ce,je)=>{if(I&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(pe))throw Error("Legacy model requested but code missing.");const we=pe||F;F=we;const Te=Ce||T;T=Te;const De=(typeof Q=="string"?Q.split("+"):Q).filter(Nt=>!O.includes(Nt));return O.push(...De),De.length>0?W(De,je).then(()=>U(Q,we,Te,je)):U(Q,we,Te,je)},te=(Q={},pe)=>q(e({id:pe,action:"setParameters",payload:{params:Q}})),ce=async(Q,pe={},Ce={text:!0},je)=>q(e({id:je,action:"recognize",payload:{image:await u(Q),options:pe,output:Ce}})),xe=async(Q,pe)=>{if(I)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return q(e({id:pe,action:"detect",payload:{image:await u(Q)}}))},ue=async()=>(P!==null&&(l(P),P=null),Promise.resolve());c(P,({workerId:Q,jobId:pe,status:Ce,action:je,data:we})=>{const Te=`${je}-${pe}`;if(Ce==="resolve")r(`[${Q}]: Complete ${pe}`),L[Te].resolve({jobId:pe,data:we}),delete L[Te];else if(Ce==="reject")if(L[Te].reject(we),delete L[Te],je==="load"&&B(we),C)C(we);else throw Error(we);else Ce==="progress"&&N({...we,userJobId:pe})});const ve={id:j,worker:P,load:X,writeText:ne,readText:ee,removeFile:se,FS:J,reinitialize:Y,setParameters:te,recognize:ce,detect:xe,terminate:ue};return G().then(()=>W(x)).then(()=>U(x,m,v)).then(()=>$(ve)).catch(()=>{}),k},$j}var Fj,A7;function vie(){if(A7)return Fj;A7=1;const t=DF();return Fj={recognize:async(n,i,a)=>{const o=await t(i,1,a);return o.recognize(n).finally(async()=>{await o.terminate()})},detect:async(n,i)=>{const a=await t("osd",0,i);return a.detect(n).finally(async()=>{await a.terminate()})}},Fj}var Uj,E7;function wie(){return E7||(E7=1,Uj={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Uj}var zj,T7;function jie(){return T7||(T7=1,zj={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),zj}var qj,L7;function Nie(){if(L7)return qj;L7=1,iie();const t=aie(),e=DF(),r=vie(),n=wie(),i=RF(),a=jie(),{setLogging:o}=P6();return qj={languages:n,OEM:i,PSM:a,createScheduler:t,createWorker:e,setLogging:o,...r},qj}var BF=Nie();const kie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Sie=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),O7=t=>{const e=Sie(t);return e.charAt(0).toUpperCase()+e.slice(1)},$F=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),_ie=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Cie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Aie=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...l},c)=>b.createElement("svg",{ref:c,...Cie,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:$F("lucide",i),...!a&&!_ie(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,f])=>b.createElement(u,f)),...Array.isArray(a)?a:[a]]));const Cr=(t,e)=>{const r=b.forwardRef(({className:n,...i},a)=>b.createElement(Aie,{ref:a,iconNode:e,className:$F(`lucide-${kie(O7(t))}`,`lucide-${t}`,n),...i}));return r.displayName=O7(t),r};const Eie=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],X3=Cr("activity",Eie);const Tie=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],FF=Cr("arrow-left",Tie);const Lie=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Oie=Cr("arrow-right",Lie);const Mie=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],M7=Cr("brain",Mie);const Pie=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],UF=Cr("calendar",Pie);const Iie=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],zF=Cr("camera",Iie);const Rie=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Die=Cr("chart-column",Rie);const Bie=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],$ie=Cr("chart-no-axes-column",Bie);const Fie=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],vd=Cr("check",Fie);const Uie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],g1=Cr("circle-alert",Uie);const zie=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qie=Cr("circle-play",zie);const Hie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Wie=Cr("circle-x",Hie);const Gie=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qF=Cr("clock",Gie);const Vie=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Yie=Cr("credit-card",Vie);const Kie=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],jx=Cr("crown",Kie);const Xie=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],Jie=Cr("delete",Xie);const Zie=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],HF=Cr("dollar-sign",Zie);const Qie=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],eae=Cr("flag",Qie);const tae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],rae=Cr("grid-3x3",tae);const nae=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],sae=Cr("heart",nae);const iae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],aae=Cr("layers",iae);const oae=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],lae=Cr("list",oae);const cae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],dae=Cr("lock",cae);const uae=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],P7=Cr("medal",uae);const hae=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],fae=Cr("message-square",hae);const pae=[["path",{d:"M5 12h14",key:"1ays0h"}]],mae=Cr("minus",pae);const gae=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],J3=Cr("play",gae);const xae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bae=Cr("plus",xae);const yae=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Nx=Cr("refresh-cw",yae);const vae=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wae=Cr("save",vae);const jae=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Nae=Cr("search",jae);const kae=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],WF=Cr("share-2",kae);const Sae=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],d0=Cr("shield",Sae);const _ae=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Cae=Cr("skip-forward",_ae);const Aae=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],X1=Cr("skull",Aae);const Eae=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],GF=Cr("smartphone",Eae);const Tae=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],I7=Cr("sparkles",Tae);const Lae=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Oae=Cr("star",Lae);const Mae=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],J1=Cr("swords",Mae);const Pae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Iae=Cr("target",Pae);const Rae=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],VF=Cr("trash-2",Rae);const Dae=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bae=Cr("trash",Dae);const $ae=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],I6=Cr("trending-up",$ae);const Fae=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Uae=Cr("triangle-alert",Fae);const zae=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Ga=Cr("trophy",zae);const qae=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Hae=Cr("upload",qae);const Wae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Z3=Cr("user-plus",Wae);const Gae=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Q3=Cr("user",Gae);const Vae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],u0=Cr("users",Vae);const Yae=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Kae=Cr("wifi-off",Yae);const Xae=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Jae=Cr("wifi",Xae);const Zae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sd=Cr("x",Zae);const Qae=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],pm=Cr("zap",Qae),_d=Object.create(null);_d.open="0";_d.close="1";_d.ping="2";_d.pong="3";_d.message="4";_d.upgrade="5";_d.noop="6";const x1=Object.create(null);Object.keys(_d).forEach(t=>{x1[_d[t]]=t});const eS={type:"error",data:"parser error"},YF=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",KF=typeof ArrayBuffer=="function",XF=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,R6=({type:t,data:e},r,n)=>YF&&e instanceof Blob?r?n(e):R7(e,n):KF&&(e instanceof ArrayBuffer||XF(e))?r?n(e):R7(new Blob([e]),n):n(_d[t]+(e||"")),R7=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function D7(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Hj;function eoe(t,e){if(YF&&t.data instanceof Blob)return t.data.arrayBuffer().then(D7).then(e);if(KF&&(t.data instanceof ArrayBuffer||XF(t.data)))return e(D7(t.data));R6(t,!1,r=>{Hj||(Hj=new TextEncoder),e(Hj.encode(r))})}const B7="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ox=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<B7.length;t++)ox[B7.charCodeAt(t)]=t;const toe=t=>{let e=t.length*.75,r=t.length,n,i=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const u=new ArrayBuffer(e),f=new Uint8Array(u);for(n=0;n<r;n+=4)a=ox[t.charCodeAt(n)],o=ox[t.charCodeAt(n+1)],l=ox[t.charCodeAt(n+2)],c=ox[t.charCodeAt(n+3)],f[i++]=a<<2|o>>4,f[i++]=(o&15)<<4|l>>2,f[i++]=(l&3)<<6|c&63;return u},roe=typeof ArrayBuffer=="function",D6=(t,e)=>{if(typeof t!="string")return{type:"message",data:JF(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:noe(t.substring(1),e)}:x1[r]?t.length>1?{type:x1[r],data:t.substring(1)}:{type:x1[r]}:eS},noe=(t,e)=>{if(roe){const r=toe(t);return JF(r,e)}else return{base64:!0,data:t}},JF=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,ZF="",soe=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach((a,o)=>{R6(a,!1,l=>{n[o]=l,++i===r&&e(n.join(ZF))})})},ioe=(t,e)=>{const r=t.split(ZF),n=[];for(let i=0;i<r.length;i++){const a=D6(r[i],e);if(n.push(a),a.type==="error")break}return n};function aoe(){return new TransformStream({transform(t,e){eoe(t,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}let Wj;function dv(t){return t.reduce((e,r)=>e+r.length,0)}function uv(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function ooe(t,e){Wj||(Wj=new TextDecoder);const r=[];let n=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(n===0){if(dv(r)<1)break;const c=uv(r,1);a=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(dv(r)<2)break;const c=uv(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(dv(r)<8)break;const c=uv(r,8),u=new DataView(c.buffer,c.byteOffset,c.length),f=u.getUint32(0);if(f>Math.pow(2,21)-1){l.enqueue(eS);break}i=f*Math.pow(2,32)+u.getUint32(4),n=3}else{if(dv(r)<i)break;const c=uv(r,i);l.enqueue(D6(a?c:Wj.decode(c),e)),n=0}if(i===0||i>t){l.enqueue(eS);break}}}})}const QF=4;function $i(t){if(t)return loe(t)}function loe(t){for(var e in $i.prototype)t[e]=$i.prototype[e];return t}$i.prototype.on=$i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};$i.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};$i.prototype.off=$i.prototype.removeListener=$i.prototype.removeAllListeners=$i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};$i.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};$i.prototype.emitReserved=$i.prototype.emit;$i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};$i.prototype.hasListeners=function(t){return!!this.listeners(t).length};const vw=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),Gl=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),coe="arraybuffer";function eU(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const doe=Gl.setTimeout,uoe=Gl.clearTimeout;function ww(t,e){e.useNativeTimers?(t.setTimeoutFn=doe.bind(Gl),t.clearTimeoutFn=uoe.bind(Gl)):(t.setTimeoutFn=Gl.setTimeout.bind(Gl),t.clearTimeoutFn=Gl.clearTimeout.bind(Gl))}const hoe=1.33;function foe(t){return typeof t=="string"?poe(t):Math.ceil((t.byteLength||t.size)*hoe)}function poe(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function tU(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function moe(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function goe(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class xoe extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class B6 extends $i{constructor(e){super(),this.writable=!1,ww(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new xoe(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=D6(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=moe(e);return r.length?"?"+r:""}}class boe extends B6{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};ioe(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,soe(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=tU()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let rU=!1;try{rU=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const yoe=rU;function voe(){}class woe extends boe{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let Qp=class b1 extends $i{constructor(e,r,n){super(),this.createRequest=e,ww(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=eU(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=b1.requestsCount++,b1.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=voe,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete b1.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Qp.requestsCount=0;Qp.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",$7);else if(typeof addEventListener=="function"){const t="onpagehide"in Gl?"pagehide":"unload";addEventListener(t,$7,!1)}}function $7(){for(let t in Qp.requests)Qp.requests.hasOwnProperty(t)&&Qp.requests[t].abort()}const joe=(function(){const t=nU({xdomain:!1});return t&&t.responseType!==null})();class Noe extends woe{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=joe&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Qp(nU,this.uri(),e)}}function nU(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||yoe))return new XMLHttpRequest}catch{}if(!e)try{return new Gl[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const sU=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class koe extends B6{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=sU?{}:eU(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;R6(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}i&&vw(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=tU()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const Gj=Gl.WebSocket||Gl.MozWebSocket;class Soe extends koe{createSocket(e,r,n){return sU?new Gj(e,r,n):r?new Gj(e,r):new Gj(e)}doWrite(e,r){this.ws.send(r)}}class _oe extends B6{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=ooe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=aoe();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const a=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;this._writer.write(n).then(()=>{i&&vw(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Coe={websocket:Soe,webtransport:_oe,polling:Noe},Aoe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Eoe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tS(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=Aoe.exec(t||""),a={},o=14;for(;o--;)a[Eoe[o]]=i[o]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=Toe(a,a.path),a.queryKey=Loe(a,a.query),a}function Toe(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Loe(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(r[i]=a)}),r}const rS=typeof addEventListener=="function"&&typeof removeEventListener=="function",y1=[];rS&&addEventListener("offline",()=>{y1.forEach(t=>t())},!1);class Jh extends $i{constructor(e,r){if(super(),this.binaryType=coe,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=tS(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=tS(r.host).host);ww(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=goe(this.opts.query)),rS&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},y1.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=QF,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Jh.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Jh.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=foe(i)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,vw(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Jh.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),rS&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=y1.indexOf(this._offlineEventListener);n!==-1&&y1.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}Jh.protocol=QF;class Ooe extends Jh{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;Jh.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Jh.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(f(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=r.name,this.emitReserved("upgradeError",x)}}))};function a(){n||(n=!0,f(),r.close(),r=null)}const o=p=>{const x=new Error("probe error: "+p);x.transport=r.name,a(),this.emitReserved("upgradeError",x)};function l(){o("transport closed")}function c(){o("socket closed")}function u(p){r&&p.name!==r.name&&a()}const f=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};r.once("open",i),r.once("error",o),r.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let Moe=class extends Ooe{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>Coe[i]).filter(i=>!!i)),super(e,n)}};function Poe(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=tS(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const Ioe=typeof ArrayBuffer=="function",Roe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,iU=Object.prototype.toString,Doe=typeof Blob=="function"||typeof Blob<"u"&&iU.call(Blob)==="[object BlobConstructor]",Boe=typeof File=="function"||typeof File<"u"&&iU.call(File)==="[object FileConstructor]";function $6(t){return Ioe&&(t instanceof ArrayBuffer||Roe(t))||Doe&&t instanceof Blob||Boe&&t instanceof File}function v1(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(v1(t[r]))return!0;return!1}if($6(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return v1(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&v1(t[r]))return!0;return!1}function $oe(t){const e=[],r=t.data,n=t;return n.data=nS(r,e),n.attachments=e.length,{packet:n,buffers:e}}function nS(t,e){if(!t)return t;if($6(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=nS(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=nS(t[n],e));return r}return t}function Foe(t,e){return t.data=sS(t.data,e),delete t.attachments,t}function sS(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=sS(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=sS(t[r],e));return t}const aU=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Uoe=5;var Zr;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Zr||(Zr={}));class zoe{constructor(e){this.replacer=e}encode(e){return(e.type===Zr.EVENT||e.type===Zr.ACK)&&v1(e)?this.encodeAsBinary({type:e.type===Zr.EVENT?Zr.BINARY_EVENT:Zr.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Zr.BINARY_EVENT||e.type===Zr.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=$oe(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}class F6 extends $i{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===Zr.BINARY_EVENT;n||r.type===Zr.BINARY_ACK?(r.type=n?Zr.EVENT:Zr.ACK,this.reconstructor=new qoe(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if($6(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(Zr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Zr.BINARY_EVENT||n.type===Zr.BINARY_ACK){const a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const o=e.substring(a,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";const i=e.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){const a=this.tryParse(e.substr(r));if(F6.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Zr.CONNECT:return Z1(r);case Zr.DISCONNECT:return r===void 0;case Zr.CONNECT_ERROR:return typeof r=="string"||Z1(r);case Zr.EVENT:case Zr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&aU.indexOf(r[0])===-1);case Zr.ACK:case Zr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class qoe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=Foe(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Hoe(t){return typeof t=="string"}const Woe=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function Goe(t){return t===void 0||Woe(t)}function Z1(t){return Object.prototype.toString.call(t)==="[object Object]"}function Voe(t,e){switch(t){case Zr.CONNECT:return e===void 0||Z1(e);case Zr.DISCONNECT:return e===void 0;case Zr.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&aU.indexOf(e[0])===-1);case Zr.ACK:return Array.isArray(e);case Zr.CONNECT_ERROR:return typeof e=="string"||Z1(e);default:return!1}}function Yoe(t){return Hoe(t.nsp)&&Goe(t.id)&&Voe(t.type,t.data)}const Koe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:F6,Encoder:zoe,get PacketType(){return Zr},isPacketValid:Yoe,protocol:Uoe},Symbol.toStringTag,{value:"Module"}));function Nc(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const Xoe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class oU extends $i{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Nc(e,"open",this.onopen.bind(this)),Nc(e,"packet",this.onpacket.bind(this)),Nc(e,"error",this.onerror.bind(this)),Nc(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,i,a;if(Xoe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Zr.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const f=this.ids++,p=r.pop();this._registerAckCallback(f,p),o.id=f}const l=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...r){return new Promise((n,i)=>{const a=(o,l)=>o?i(o):n(l);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>(this._queue[0],i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Zr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Zr.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Zr.EVENT:case Zr.BINARY_EVENT:this.onevent(e);break;case Zr.ACK:case Zr.BINARY_ACK:this.onack(e);break;case Zr.DISCONNECT:this.ondisconnect();break;case Zr.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:Zr.ACK,id:e,data:i}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Zr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function Im(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Im.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};Im.prototype.reset=function(){this.attempts=0};Im.prototype.setMin=function(t){this.ms=t};Im.prototype.setMax=function(t){this.max=t};Im.prototype.setJitter=function(t){this.jitter=t};class iS extends $i{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,ww(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Im({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const i=r.parser||Koe;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Moe(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=Nc(r,"open",function(){n.onopen(),e&&e()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Nc(r,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Nc(e,"ping",this.onping.bind(this)),Nc(e,"data",this.ondata.bind(this)),Nc(e,"error",this.onerror.bind(this)),Nc(e,"close",this.onclose.bind(this)),Nc(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){vw(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new oU(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Dg={};function Qf(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=Poe(t,e.path||"/socket.io"),n=r.source,i=r.id,a=r.path,o=Dg[i]&&a in Dg[i].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return l?c=new iS(n,e):(Dg[i]||(Dg[i]=new iS(n,e)),c=Dg[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(Qf,{Manager:iS,Socket:oU,io:Qf,connect:Qf});var _p={},Vj={exports:{}},Yj,F7;function Joe(){if(F7)return Yj;F7=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Yj=t,Yj}var Kj,U7;function Zoe(){if(U7)return Kj;U7=1;var t=Joe();function e(){}function r(){}return r.resetWarningCache=e,Kj=function(){function n(o,l,c,u,f,p){if(p!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},Kj}var z7;function U6(){return z7||(z7=1,Vj.exports=Zoe()()),Vj.exports}var Xj,q7;function lU(){return q7||(q7=1,Xj={L:1,M:0,Q:3,H:2}),Xj}var Jj,H7;function cU(){return H7||(H7=1,Jj={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),Jj}var Zj,W7;function Qoe(){if(W7)return Zj;W7=1;var t=cU();function e(r){this.mode=t.MODE_8BIT_BYTE,this.data=r}return e.prototype={getLength:function(r){return this.data.length},write:function(r){for(var n=0;n<this.data.length;n++)r.put(this.data.charCodeAt(n),8)}},Zj=e,Zj}var Qj,G7;function ele(){if(G7)return Qj;G7=1;var t=lU();function e(r,n){this.totalCount=r,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(r,n){var i=e.getRsBlockTable(r,n);if(i==null)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+n);for(var a=i.length/3,o=new Array,l=0;l<a;l++)for(var c=i[l*3+0],u=i[l*3+1],f=i[l*3+2],p=0;p<c;p++)o.push(new e(u,f));return o},e.getRsBlockTable=function(r,n){switch(n){case t.L:return e.RS_BLOCK_TABLE[(r-1)*4+0];case t.M:return e.RS_BLOCK_TABLE[(r-1)*4+1];case t.Q:return e.RS_BLOCK_TABLE[(r-1)*4+2];case t.H:return e.RS_BLOCK_TABLE[(r-1)*4+3];default:return}},Qj=e,Qj}var eN,V7;function tle(){if(V7)return eN;V7=1;function t(){this.buffer=new Array,this.length=0}return t.prototype={get:function(e){var r=Math.floor(e/8);return(this.buffer[r]>>>7-e%8&1)==1},put:function(e,r){for(var n=0;n<r;n++)this.putBit((e>>>r-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),e&&(this.buffer[r]|=128>>>this.length%8),this.length++}},eN=t,eN}var tN,Y7;function dU(){if(Y7)return tN;Y7=1;for(var t={glog:function(r){if(r<1)throw new Error("glog("+r+")");return t.LOG_TABLE[r]},gexp:function(r){for(;r<0;)r+=255;for(;r>=256;)r-=255;return t.EXP_TABLE[r]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;e<255;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e;return tN=t,tN}var rN,K7;function uU(){if(K7)return rN;K7=1;var t=dU();function e(r,n){if(r.length==null)throw new Error(r.length+"/"+n);for(var i=0;i<r.length&&r[i]==0;)i++;this.num=new Array(r.length-i+n);for(var a=0;a<r.length-i;a++)this.num[a]=r[a+i]}return e.prototype={get:function(r){return this.num[r]},getLength:function(){return this.num.length},multiply:function(r){for(var n=new Array(this.getLength()+r.getLength()-1),i=0;i<this.getLength();i++)for(var a=0;a<r.getLength();a++)n[i+a]^=t.gexp(t.glog(this.get(i))+t.glog(r.get(a)));return new e(n,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var n=t.glog(this.get(0))-t.glog(r.get(0)),i=new Array(this.getLength()),a=0;a<this.getLength();a++)i[a]=this.get(a);for(var a=0;a<r.getLength();a++)i[a]^=t.gexp(t.glog(r.get(a))+n);return new e(i,0).mod(r)}},rN=e,rN}var nN,X7;function rle(){if(X7)return nN;X7=1;var t=cU(),e=uU(),r=dU(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var o=a<<10;i.getBCHDigit(o)-i.getBCHDigit(i.G15)>=0;)o^=i.G15<<i.getBCHDigit(o)-i.getBCHDigit(i.G15);return(a<<10|o)^i.G15_MASK},getBCHTypeNumber:function(a){for(var o=a<<12;i.getBCHDigit(o)-i.getBCHDigit(i.G18)>=0;)o^=i.G18<<i.getBCHDigit(o)-i.getBCHDigit(i.G18);return a<<12|o},getBCHDigit:function(a){for(var o=0;a!=0;)o++,a>>>=1;return o},getPatternPosition:function(a){return i.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,o,l){switch(a){case n.PATTERN000:return(o+l)%2==0;case n.PATTERN001:return o%2==0;case n.PATTERN010:return l%3==0;case n.PATTERN011:return(o+l)%3==0;case n.PATTERN100:return(Math.floor(o/2)+Math.floor(l/3))%2==0;case n.PATTERN101:return o*l%2+o*l%3==0;case n.PATTERN110:return(o*l%2+o*l%3)%2==0;case n.PATTERN111:return(o*l%3+(o+l)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var o=new e([1],0),l=0;l<a;l++)o=o.multiply(new e([1,r.gexp(l)],0));return o},getLengthInBits:function(a,o){if(1<=o&&o<10)switch(a){case t.MODE_NUMBER:return 10;case t.MODE_ALPHA_NUM:return 9;case t.MODE_8BIT_BYTE:return 8;case t.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(o<27)switch(a){case t.MODE_NUMBER:return 12;case t.MODE_ALPHA_NUM:return 11;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else if(o<41)switch(a){case t.MODE_NUMBER:return 14;case t.MODE_ALPHA_NUM:return 13;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}else throw new Error("type:"+o)},getLostPoint:function(a){for(var o=a.getModuleCount(),l=0,c=0;c<o;c++)for(var u=0;u<o;u++){for(var f=0,p=a.isDark(c,u),x=-1;x<=1;x++)if(!(c+x<0||o<=c+x))for(var m=-1;m<=1;m++)u+m<0||o<=u+m||x==0&&m==0||p==a.isDark(c+x,u+m)&&f++;f>5&&(l+=3+f-5)}for(var c=0;c<o-1;c++)for(var u=0;u<o-1;u++){var y=0;a.isDark(c,u)&&y++,a.isDark(c+1,u)&&y++,a.isDark(c,u+1)&&y++,a.isDark(c+1,u+1)&&y++,(y==0||y==4)&&(l+=3)}for(var c=0;c<o;c++)for(var u=0;u<o-6;u++)a.isDark(c,u)&&!a.isDark(c,u+1)&&a.isDark(c,u+2)&&a.isDark(c,u+3)&&a.isDark(c,u+4)&&!a.isDark(c,u+5)&&a.isDark(c,u+6)&&(l+=40);for(var u=0;u<o;u++)for(var c=0;c<o-6;c++)a.isDark(c,u)&&!a.isDark(c+1,u)&&a.isDark(c+2,u)&&a.isDark(c+3,u)&&a.isDark(c+4,u)&&!a.isDark(c+5,u)&&a.isDark(c+6,u)&&(l+=40);for(var v=0,u=0;u<o;u++)for(var c=0;c<o;c++)a.isDark(c,u)&&v++;var j=Math.abs(100*v/o/o-50)/5;return l+=j*10,l}};return nN=i,nN}var sN,J7;function nle(){if(J7)return sN;J7=1;var t=Qoe(),e=ele(),r=tle(),n=rle(),i=uU();function a(l,c){this.typeNumber=l,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var o=a.prototype;return o.addData=function(l){var c=new t(l);this.dataList.push(c),this.dataCache=null},o.isDark=function(l,c){if(l<0||this.moduleCount<=l||c<0||this.moduleCount<=c)throw new Error(l+","+c);return this.modules[l][c]},o.getModuleCount=function(){return this.moduleCount},o.make=function(){if(this.typeNumber<1){var l=1;for(l=1;l<40;l++){for(var c=e.getRSBlocks(l,this.errorCorrectLevel),u=new r,f=0,p=0;p<c.length;p++)f+=c[p].dataCount;for(var p=0;p<this.dataList.length;p++){var x=this.dataList[p];u.put(x.mode,4),u.put(x.getLength(),n.getLengthInBits(x.mode,l)),x.write(u)}if(u.getLengthInBits()<=f*8)break}this.typeNumber=l}this.makeImpl(!1,this.getBestMaskPattern())},o.makeImpl=function(l,c){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var u=0;u<this.moduleCount;u++){this.modules[u]=new Array(this.moduleCount);for(var f=0;f<this.moduleCount;f++)this.modules[u][f]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(l,c),this.typeNumber>=7&&this.setupTypeNumber(l),this.dataCache==null&&(this.dataCache=a.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},o.setupPositionProbePattern=function(l,c){for(var u=-1;u<=7;u++)if(!(l+u<=-1||this.moduleCount<=l+u))for(var f=-1;f<=7;f++)c+f<=-1||this.moduleCount<=c+f||(0<=u&&u<=6&&(f==0||f==6)||0<=f&&f<=6&&(u==0||u==6)||2<=u&&u<=4&&2<=f&&f<=4?this.modules[l+u][c+f]=!0:this.modules[l+u][c+f]=!1)},o.getBestMaskPattern=function(){for(var l=0,c=0,u=0;u<8;u++){this.makeImpl(!0,u);var f=n.getLostPoint(this);(u==0||l>f)&&(l=f,c=u)}return c},o.createMovieClip=function(l,c,u){var f=l.createEmptyMovieClip(c,u),p=1;this.make();for(var x=0;x<this.modules.length;x++)for(var m=x*p,y=0;y<this.modules[x].length;y++){var v=y*p,j=this.modules[x][y];j&&(f.beginFill(0,100),f.moveTo(v,m),f.lineTo(v+p,m),f.lineTo(v+p,m+p),f.lineTo(v,m+p),f.endFill())}return f},o.setupTimingPattern=function(){for(var l=8;l<this.moduleCount-8;l++)this.modules[l][6]==null&&(this.modules[l][6]=l%2==0);for(var c=8;c<this.moduleCount-8;c++)this.modules[6][c]==null&&(this.modules[6][c]=c%2==0)},o.setupPositionAdjustPattern=function(){for(var l=n.getPatternPosition(this.typeNumber),c=0;c<l.length;c++)for(var u=0;u<l.length;u++){var f=l[c],p=l[u];if(this.modules[f][p]==null)for(var x=-2;x<=2;x++)for(var m=-2;m<=2;m++)x==-2||x==2||m==-2||m==2||x==0&&m==0?this.modules[f+x][p+m]=!0:this.modules[f+x][p+m]=!1}},o.setupTypeNumber=function(l){for(var c=n.getBCHTypeNumber(this.typeNumber),u=0;u<18;u++){var f=!l&&(c>>u&1)==1;this.modules[Math.floor(u/3)][u%3+this.moduleCount-8-3]=f}for(var u=0;u<18;u++){var f=!l&&(c>>u&1)==1;this.modules[u%3+this.moduleCount-8-3][Math.floor(u/3)]=f}},o.setupTypeInfo=function(l,c){for(var u=this.errorCorrectLevel<<3|c,f=n.getBCHTypeInfo(u),p=0;p<15;p++){var x=!l&&(f>>p&1)==1;p<6?this.modules[p][8]=x:p<8?this.modules[p+1][8]=x:this.modules[this.moduleCount-15+p][8]=x}for(var p=0;p<15;p++){var x=!l&&(f>>p&1)==1;p<8?this.modules[8][this.moduleCount-p-1]=x:p<9?this.modules[8][15-p-1+1]=x:this.modules[8][15-p-1]=x}this.modules[this.moduleCount-8][8]=!l},o.mapData=function(l,c){for(var u=-1,f=this.moduleCount-1,p=7,x=0,m=this.moduleCount-1;m>0;m-=2)for(m==6&&m--;;){for(var y=0;y<2;y++)if(this.modules[f][m-y]==null){var v=!1;x<l.length&&(v=(l[x]>>>p&1)==1);var j=n.getMask(c,f,m-y);j&&(v=!v),this.modules[f][m-y]=v,p--,p==-1&&(x++,p=7)}if(f+=u,f<0||this.moduleCount<=f){f-=u,u=-u;break}}},a.PAD0=236,a.PAD1=17,a.createData=function(l,c,u){for(var f=e.getRSBlocks(l,c),p=new r,x=0;x<u.length;x++){var m=u[x];p.put(m.mode,4),p.put(m.getLength(),n.getLengthInBits(m.mode,l)),m.write(p)}for(var y=0,x=0;x<f.length;x++)y+=f[x].dataCount;if(p.getLengthInBits()>y*8)throw new Error("code length overflow. ("+p.getLengthInBits()+">"+y*8+")");for(p.getLengthInBits()+4<=y*8&&p.put(0,4);p.getLengthInBits()%8!=0;)p.putBit(!1);for(;!(p.getLengthInBits()>=y*8||(p.put(a.PAD0,8),p.getLengthInBits()>=y*8));)p.put(a.PAD1,8);return a.createBytes(p,f)},a.createBytes=function(l,c){for(var u=0,f=0,p=0,x=new Array(c.length),m=new Array(c.length),y=0;y<c.length;y++){var v=c[y].dataCount,j=c[y].totalCount-v;f=Math.max(f,v),p=Math.max(p,j),x[y]=new Array(v);for(var N=0;N<x[y].length;N++)x[y][N]=255&l.buffer[N+u];u+=v;var C=n.getErrorCorrectPolynomial(j),A=new i(x[y],C.getLength()-1),L=A.mod(C);m[y]=new Array(C.getLength()-1);for(var N=0;N<m[y].length;N++){var O=N+L.getLength()-m[y].length;m[y][N]=O>=0?L.get(O):0}}for(var F=0,N=0;N<c.length;N++)F+=c[N].totalCount;for(var T=new Array(F),I=0,N=0;N<f;N++)for(var y=0;y<c.length;y++)N<x[y].length&&(T[I++]=x[y][N]);for(var N=0;N<p;N++)for(var y=0;y<c.length;y++)N<m[y].length&&(T[I++]=m[y][N]);return T},sN=a,sN}var hv={},Z7;function sle(){if(Z7)return hv;Z7=1,Object.defineProperty(hv,"__esModule",{value:!0});var t=Object.assign||function(u){for(var f=1;f<arguments.length;f++){var p=arguments[f];for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(u[x]=p[x])}return u},e=U6(),r=a(e),n=Fu(),i=a(n);function a(u){return u&&u.__esModule?u:{default:u}}function o(u,f){var p={};for(var x in u)f.indexOf(x)>=0||Object.prototype.hasOwnProperty.call(u,x)&&(p[x]=u[x]);return p}var l={bgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,bgD:r.default.string.isRequired,fgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,fgD:r.default.string.isRequired,size:r.default.number.isRequired,title:r.default.string,viewBoxSize:r.default.number.isRequired,xmlns:r.default.string},c=(0,n.forwardRef)(function(u,f){var p=u.bgColor,x=u.bgD,m=u.fgD,y=u.fgColor,v=u.size,j=u.title,N=u.viewBoxSize,C=u.xmlns,A=C===void 0?"http://www.w3.org/2000/svg":C,L=o(u,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",t({},L,{height:v,ref:f,viewBox:"0 0 "+N+" "+N,width:v,xmlns:A}),j?i.default.createElement("title",null,j):null,i.default.createElement("path",{d:x,fill:p}),i.default.createElement("path",{d:m,fill:y}))});return c.displayName="QRCodeSvg",c.propTypes=l,hv.default=c,hv}var Q7;function ile(){if(Q7)return _p;Q7=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.QRCode=void 0;var t=Object.assign||function(v){for(var j=1;j<arguments.length;j++){var N=arguments[j];for(var C in N)Object.prototype.hasOwnProperty.call(N,C)&&(v[C]=N[C])}return v},e=U6(),r=p(e),n=lU(),i=p(n),a=nle(),o=p(a),l=Fu(),c=p(l),u=sle(),f=p(u);function p(v){return v&&v.__esModule?v:{default:v}}function x(v,j){var N={};for(var C in v)j.indexOf(C)>=0||Object.prototype.hasOwnProperty.call(v,C)&&(N[C]=v[C]);return N}var m={bgColor:r.default.oneOfType([r.default.object,r.default.string]),fgColor:r.default.oneOfType([r.default.object,r.default.string]),level:r.default.string,size:r.default.number,value:r.default.string.isRequired},y=(0,l.forwardRef)(function(v,j){var N=v.bgColor,C=N===void 0?"#FFFFFF":N,A=v.fgColor,L=A===void 0?"#000000":A,O=v.level,F=O===void 0?"L":O,T=v.size,I=T===void 0?256:T,B=v.value,$=x(v,["bgColor","fgColor","level","size","value"]),k=new o.default(-1,i.default[F]);k.addData(B),k.make();var R=k.modules;return c.default.createElement(f.default,t({},$,{bgColor:C,bgD:R.map(function(P,q){return P.map(function(X,G){return X?"":"M "+G+" "+q+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:L,fgD:R.map(function(P,q){return P.map(function(X,G){return X?"M "+G+" "+q+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:j,size:I,viewBoxSize:R.length}))});return _p.QRCode=y,y.displayName="QRCode",y.propTypes=m,_p.default=y,_p}var ale=ile();const ole=Co(ale),lle=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{i(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"absolute top-24 left-4 right-4 h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border border-green-500/20 rounded-xl backdrop-blur-md",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5 break-all",children:r},n))})},jw=({isOpen:t,onClose:e,onFinish:r,mode:n="collection"})=>{const{addToast:i}=wn(),{userProfile:a,currentUser:o}=Sr(),l=vn(a?.subscription_tier),[c,u]=b.useState("scanning"),[f,p]=b.useState(window.innerWidth>768),x=b.useRef(null),m=b.useRef(null),y=b.useRef(null),[v,j]=b.useState(null),[N,C]=b.useState(!1),[A,L]=b.useState(!1),[O,F]=b.useState([]),[T,I]=b.useState(null),[B,$]=b.useState(!1),[k]=b.useState(()=>Math.random().toString(36).substr(2,9)),[R,P]=b.useState(!1),[q,X]=b.useState("nonfoil"),[G,ne]=b.useState(null),[ee,se]=b.useState("new"),[J,W]=b.useState([]),[U,Y]=b.useState(!1);b.useEffect(()=>{t&&o&&Ze.get("/api/decks").then(W).catch(console.error)},[t,o]);const[te,ce]=b.useState(!1),[xe,ue]=b.useState({name:null,footer:null});b.useEffect(()=>{let Ne=null;return t&&(async()=>{try{if(!B){console.log("[OCR] Initializing Tesseract Worker...");const Xe=await BF.createWorker("eng",1,{logger:xt=>console.log(xt),workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),Ne=Xe,j(Xe),L(!0)}}catch(Xe){console.error("OCR Worker Init Failed",Xe||"Unknown Error"),i("Failed to initialize OCR engine. Check console.","error")}})(),()=>{Ne&&Ne.terminate()}},[t,B]),b.useEffect(()=>{if(!t)return;const Ne=Qf();return Ne.emit("join-pairing",k),Ne.on("peer-connected",()=>{console.log("Peer connected!"),P(!0),i("Remote device connected!","success")}),Ne.on("remote-card",async Ge=>{console.log("Card received from remote:",Ge.name,Ge);const Xe=Date.now();if(T&&T.name===Ge.name&&Xe-(T.timestamp||0)<2e3){console.log("Debounced duplicate remote scan");return}P(!0),await we({name:Ge.name,set:Ge.set||Ge.set_code,cn:Ge.collector_number||Ge.subtext,raw_footer:"Remote Scan"})}),()=>Ne.disconnect()},[t,k]),b.useEffect(()=>{const Ne=()=>p(window.innerWidth>768);return window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]);const ve=async Ne=>{if(!(!A||N)){console.log("[ForgeLens] Processing new image source..."),C(!0);try{if(!Ne){console.warn("[ForgeLens] No image source provided.");return}const Ge=new Image;Ge.src=Ne,await new Promise(xt=>Ge.onload=xt),console.log(`[ForgeLens] Image loaded: ${Ge.width}x${Ge.height}`);const Xe=await je(Ge);console.log("[ForgeLens] Region extraction complete:",Xe),await we(Xe)}catch(Ge){console.error("[ForgeLens] Processing error",Ge),I({error:"Processing failed. Invalid image format?"})}finally{C(!1),setTimeout(()=>I(null),3e3)}}},Q=async()=>{if(!x.current)return;const Ne=x.current.getScreenshot();await ve(Ne)},pe=async Ne=>{const Ge=Ne.target.files?.[0];if(!Ge)return;const Xe=new FileReader;Xe.onload=async xt=>{const Ae=xt.target.result;await ve(Ae),Ne.target.value=""},Xe.readAsDataURL(Ge)},Ce=b.useCallback((Ne,Ge,Xe)=>{const xt={id:Math.random().toString(36).substr(2,9),scryfall_id:Ne.scryfall_id||Ne.uuid,name:Ne.name,set_name:Ne.set_name||Ne.setcode,set_code:Ne.set||Ne.setcode,collector_number:Ne.collector_number||Ne.number,image:Ne.image_uri||Ne.image_uris?.small||Ne.card_faces?.[0]?.image_uris?.small,finish:q,quantity:1,data:Ne,variants:Ge,raw_ocr:Xe,is_wishlist:!1};F(Pe=>l.features.batchScan?[...Pe,xt]:[xt]);const Ae=q==="foil"?Ne.prices?.usd_foil||"0.00":Ne.prices?.usd||"0.00";I({success:!0,name:Ne.name,price:Ae,timestamp:Date.now()})},[l.features.batchScan,q]),je=async Ne=>{const Ge=m.current,Xe=Ge.getContext("2d",{willReadFrequently:!0}),xt=async(Et,$t,At,Xt)=>{let qt=250/Xt;qt=Math.max(.1,Math.min(qt,4));let Ht=Math.floor(At*qt),jr=Math.floor(Xt*qt);Ht>4e3&&(qt=4e3/At,Ht=4e3,jr=Math.floor(Xt*qt)),console.log(`[ForgeLens] OCR Crop: ${Ht}x${jr} (Src: ${Math.floor(At)}x${Math.floor(Xt)}, Scale: ${qt.toFixed(2)})`),Ge.width=Ht,Ge.height=jr,Xe.imageSmoothingEnabled=!0,Xe.imageSmoothingQuality="high",Xe.drawImage(Ne,Et,$t,At,Xt,0,0,Ht,jr);const Ct=Xe.getImageData(0,0,Ge.width,Ge.height),Tt=Ct.data;for(let Ft=0;Ft<Tt.length;Ft+=4){const Ee=(Tt[Ft]+Tt[Ft+1]+Tt[Ft+2])/3;Tt[Ft]=Tt[Ft+1]=Tt[Ft+2]=Ee}Xe.putImageData(Ct,0,0);const{data:{text:Yt}}=await v.recognize(Ge),Be=Yt.split(`
`).map(Ft=>Ft.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(Ft=>Ft.length>=1),Lt=Ge.toDataURL("image/png");return{lines:Be,preview:Lt}},Ae=Ne.width,Pe=Ne.height,ct=Math.min(Ae,Pe),bt=(Ae-ct)/2,dt=(Pe-ct)/2;console.log(`[ForgeLens] Precision Mode: ${Ae}x${Pe}, Crop: ${ct}x${ct} @ (${bt}, ${dt})`);const Ve=await xt(bt+ct*.1,dt+ct*.35,ct*.8,ct*.3);ue({footer:Ve.preview});let lt="",kt="";const Ue=Ve.lines.join(" ").toUpperCase();console.log(`[ForgeLens] Raw Scan: "${Ue}"`);const zt=(Ue.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(Et=>!/^(19|20)\d{2}$/.test(Et));zt.length>0&&(kt=zt[0]);const Ot=Ue.match(/\b[A-Z0-9]{3,4}\b/g);if(Ot){const Et=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],$t=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],At=Ot.find(Xt=>!$t.includes(Xt)&&!Et.includes(Xt)&&!/^\d+$/.test(Xt));At&&(lt=At)}return{name:"",set:lt,cn:kt,raw_footer:Ue}},we=async({name:Ne,set:Ge,cn:Xe,raw_footer:xt})=>{if(console.log(`[ForgeLens] Resolving: Name="${Ne}", Set="${Ge}", CN="${Xe}" (Footer: "${xt}")`),Ge&&Xe){console.log(`[ForgeLens] Attempting Set/CN match: ${Ge} #${Xe}`);try{const Ae=await Ze.post("/api/cards/search",{set:Ge,cn:Xe});if(Ae.data&&Ae.data.length>0){const Pe=Ae.data[0];console.log(`[ForgeLens] Match found by Set/CN: ${Pe.name}`);const ct=Ae.data.length>1?Ae.data:[Pe];Ce(Pe,ct,{name:Ne,set:Ge,cn:Xe});return}else{I({error:`Not Found: ${Ge} #${Xe}`,raw:xt});return}}catch(Ae){console.warn("[ForgeLens] Set/CN search failed",Ae)}}if(!Ne||Ne.length<3){I({error:"Try scanning Set Code & Number again.",raw:xt});return}console.log(`[ForgeLens] Attempting Name search: "${Ne}" (Set: ${Ge}, CN: ${Xe})`);try{const Pe=(await Ze.post("/api/cards/search",{query:Ne,set:Ge,cn:Xe})).data||[];if(Pe.length>0){const ct=Pe[0],bt=Pe.length>1?Pe:[ct];Ce(ct,bt,{name:Ne,set:Ge,cn:Xe});return}else{console.log(`[ForgeLens] No direct match for "${Ne}". Trying fuzzy fallback...`);const ct=Ne.split(/\s+/).filter(dt=>dt.length>3);let bt=null;if(ct.length>0&&ct[0].length<Ne.length?bt=ct[0]:Ne.length>8&&(bt=Ne.substring(0,8)),bt){console.log(`[ForgeLens] Fuzzy fallback attempt with: "${bt}"`);const dt=await Ze.post("/api/cards/search",{query:bt});if(dt.data?.length>0){const Ve=dt.data[0];console.log(`[ForgeLens] Fuzzy match found: "${Ve.name}"`);const lt=Ne.toLowerCase().includes(Ve.name.toLowerCase()),kt=Ve.name.toLowerCase().includes(bt.toLowerCase());if(lt||kt){console.log(`[ForgeLens] Fallback match accepted: "${Ve.name}"`);const Ue=dt.data.length>1?dt.data:[Ve];Ce(Ve,Ue,{name:Ne,set:Ge,cn:Xe});return}}}I({error:`Not found: ${Ne}`})}}catch(Ae){console.error("[ForgeLens] Resolution failed",Ae),I({error:"Search failed"})}},Te=Ne=>{F(Ge=>Ge.filter(Xe=>Xe.id!==Ne))},oe=(Ne,Ge)=>{F(Xe=>Xe.map(xt=>xt.id===Ne?{...xt,...Ge}:xt))},De=(Ne,Ge)=>{F(Xe=>Xe.map(xt=>{if(xt.id===Ne){const Ae=xt.variants.find(Pe=>Pe.id===Ge);if(Ae)return{...xt,scryfall_id:Ae.id,set_name:Ae.set_name,set_code:Ae.set,collector_number:Ae.collector_number,image:Ae.image_uris?.small||Ae.card_faces?.[0]?.image_uris?.small,data:Ae}}return xt}))},Nt=async()=>{try{console.log("[ForgeLens] Add & Continue - Constructing Payload...");const Ne=O.map(Xe=>{const xt=Xe.data?.image_uris?.normal||Xe.data?.card_faces?.[0]?.image_uris?.normal||Xe.image||null;return console.log(`[ForgeLens] Card: ${Xe.name}, Image: ${xt}`),{name:Xe.name,scryfall_id:Xe.scryfall_id,set_code:Xe.set_code,collector_number:Xe.collector_number,image_uri:xt,count:Xe.quantity,data:Xe.data,is_wishlist:Xe.is_wishlist,finish:Xe.finish||"nonfoil",deck_id:G||null,tags:[]}}),Ge=ee==="transfer"?"transfer_to_deck":"merge";console.log("[ForgeLens] Sending Batch:",Ne.length,"cards",Ge),await Ze.batchAddToCollection(Ne,Ge),i(`Successfully added ${O.length} cards!`,"success"),I({success:!0,name:`Batch Added! (${O.length} cards)`,price:O.reduce((Xe,xt)=>Xe+parseFloat(xt.data?.prices?.usd||0),0).toFixed(2)}),F([]),u("scanning"),setTimeout(()=>I(null),3e3)}catch(Ne){console.error("[ForgeLens] Add & Continue Failed",Ne),i("Failed to add cards. Check console.","error"),I({error:"Batch Add Failed"})}},ot=()=>{r&&r(O,{targetDeckId:G,additionMode:ee,defaultFinish:q}),e()};return t?Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/95 backdrop-blur-md p-0 md:p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full h-full md:max-w-5xl md:max-h-[85vh] md:rounded-3xl shadow-2xl flex flex-col border border-white/10 overflow-hidden relative",children:[s.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.05] saturate-[1.2] brightness-125",children:s.jsx("img",{src:"/icons/forge_lense.png",alt:"",className:"w-[60%] h-[60%] object-contain"})}),s.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-[1010] p-2 bg-black/50 text-white rounded-full hover:bg-red-500/50 transition-all",children:s.jsx(Sd,{className:"w-6 h-6"})}),s.jsxs("div",{className:"px-4 py-4 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsx("div",{className:"flex items-center gap-4 w-full md:w-auto",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-black text-white tracking-tight italic uppercase",children:"Forge Lens"}),s.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest leading-none",children:"AI Card Scanner"})]})}),s.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>u("scanning"),className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${c==="scanning"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:"Scan"}),s.jsxs("button",{onClick:()=>{l.features.batchScan||O.length<=1?u("review"):i("Batch Review is a Magician+ feature. Upgrade to review all at once!","info")},className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all relative ${c==="review"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[!l.features.batchScan&&s.jsx(dae,{className:"w-3 h-3 text-orange-400"}),"Review"]}),O.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center animate-bounce",children:O.length})]})]}),s.jsxs("button",{onClick:()=>$(!B),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${B?"bg-indigo-600/20 text-indigo-400 border border-indigo-500/30":"bg-gray-800 text-gray-400"}`,title:"Remote Camera",children:[s.jsx(GF,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:B?"Remote Lens Active":"Use Remote Camera"})]}),s.jsxs("button",{onClick:()=>ce(!te),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${te?"bg-orange-600/20 text-orange-400 border border-orange-500/30":"bg-gray-800 text-gray-400"}`,title:"Debug Regions",children:[s.jsx(g1,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Debug Regions"})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[c==="scanning"&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 relative",children:[f&&!B&&s.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-20 w-fit",children:s.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-500 px-4 py-2 rounded-2xl flex items-center gap-2 text-xs shadow-xl backdrop-blur-md animate-pulse",children:[s.jsx(g1,{className:"w-4 h-4"}),s.jsx("span",{children:"Desktop detected. For best focus, use the mobile app."})]})}),B?s.jsxs("div",{className:"flex flex-col items-center gap-6 animate-in fade-in zoom-in duration-500 bg-black/40 p-12 rounded-[3rem] border border-white/5 backdrop-blur-xl shadow-2xl",children:[s.jsx("div",{className:"bg-white p-6 rounded-[2rem] shadow-[0_0_50px_rgba(255,255,255,0.1)] ring-8 ring-white/5",children:s.jsx(ole,{value:`${window.location.origin}/remote/${k}`,size:220,level:"H"})}),s.jsxs("div",{className:"text-center max-w-xs",children:[s.jsx("h3",{className:"text-xl font-black text-white mb-2 italic uppercase",children:"Remote Scan Mode"}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] leading-relaxed",children:"Scan this QR on your phone to link your camera. Direct sync is active."})]}),s.jsxs("div",{className:`flex items-center gap-2 px-5 py-2.5 rounded-full text-[10px] font-black uppercase border transition-all duration-500 ${R?"bg-green-500/10 text-green-400 border-green-500/30 shadow-[0_0_20px_rgba(34,197,94,0.1)]":"bg-orange-500/10 text-orange-400 border-orange-500/30"}`,children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${R?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,1)]":"bg-orange-500 border border-orange-300 animate-pulse"}`}),R?"Remote Link Established":"Waiting for Remote Link..."]})]}):s.jsxs("div",{className:"relative w-full max-w-sm aspect-[3/4] rounded-3xl overflow-hidden border-2 border-dashed border-white/20 shadow-2xl bg-black group transition-all",children:[s.jsx(PF,{ref:x,audio:!1,screenshotFormat:"image/webp",videoConstraints:{width:1280,height:720,facingMode:"environment"},className:"w-full h-full object-cover grayscale brightness-110 contrast-125"}),s.jsx("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-center",children:s.jsxs("div",{className:"w-[80%] h-[30%] border-2 border-white/10 rounded-2xl relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute -bottom-16 left-1/2 -translate-x-1/2 w-[120%] text-center",children:A?N?s.jsx("div",{className:"bg-indigo-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg animate-pulse uppercase font-black",children:"Analyzing Image..."}):T?.success?s.jsxs("div",{className:"bg-green-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black flex flex-col items-center leading-tight text-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(vd,{className:"w-3 h-3"})," Found: ",T.name]}),s.jsxs("div",{className:"text-[8px] opacity-90 mt-0.5",children:["(Collection value +$",T.price,")"]})]}):T?.error?s.jsx("div",{className:"bg-red-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black",children:T.error}):s.jsx("p",{className:"text-white/60 text-[10px] px-3 py-1 bg-black/40 rounded-full backdrop-blur-sm",children:"Align Set Code & Number"}):s.jsxs("div",{className:"bg-black/80 text-white text-[10px] px-3 py-1 rounded-full border border-white/10 flex items-center gap-2",children:[s.jsx(Nx,{className:"w-3 h-3 animate-spin"})," Wake up AI engine..."]})})]})})]}),s.jsxs("div",{className:"mt-8 flex items-center gap-6",children:[!B&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:Q,disabled:N||!A,className:"w-20 h-20 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-800 disabled:text-gray-600 text-white rounded-full flex items-center justify-center shadow-2xl shadow-indigo-500/30 transition-all active:scale-90 relative group ring-4 ring-white/5",children:[N?s.jsx(Nx,{className:"w-8 h-8 animate-spin"}):s.jsx(zF,{className:"w-8 h-8"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-500 group-hover:text-indigo-400 transition-colors",children:"Capture Card"})]}),te&&xe.footer&&s.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-black/40 rounded-2xl border border-orange-500/20 max-w-[200px]",children:[s.jsxs("div",{className:"text-[10px] font-black uppercase text-orange-400 tracking-widest flex items-center gap-2",children:[s.jsx(g1,{className:"w-3 h-3"})," ROI Crops"]}),s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:xe.footer,className:"h-8 w-full object-contain bg-white rounded border border-white/10",alt:"Footer"}),s.jsx("div",{className:"absolute top-0 right-0 bg-black/60 text-white text-[8px] px-1 rounded-bl",children:"Footer"})]}),T?.error&&s.jsx("div",{className:"mt-2 pt-2 border-t border-white/10",children:s.jsxs("p",{className:"text-[8px] text-gray-400 font-mono break-all leading-tight",children:["RAW: ",T.raw||"---"]})})]}),s.jsxs("button",{onClick:()=>y.current?.click(),disabled:N||!A,className:"w-14 h-14 bg-gray-800 hover:bg-gray-700 disabled:text-gray-600 text-gray-400 rounded-2xl flex items-center justify-center border border-white/5 transition-all active:scale-90 relative group",title:"Upload Image",children:[s.jsx(Hae,{className:"w-6 h-6"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-600 group-hover:text-indigo-400 transition-colors",children:"Upload File"})]}),s.jsxs("button",{onClick:()=>X(q==="foil"?"nonfoil":"foil"),className:`w-14 h-14 rounded-2xl flex flex-col items-center justify-center border transition-all active:scale-95 group relative ${q==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500 hover:text-gray-300"}`,children:[s.jsx("span",{className:`text-xl transition-transform ${q==="foil"?"scale-110":"scale-90 grayscale"}`,children:""}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest group-hover:text-indigo-400 transition-colors",children:q==="foil"?"Foil":"Normal"})]})]}),s.jsx("input",{type:"file",ref:y,onChange:pe,accept:"image/*",className:"hidden"}),te&&s.jsx(lle,{})]})]}),c==="review"&&s.jsx("div",{className:"h-full flex flex-col bg-gray-950/50",children:O.length===0?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-3xl flex items-center justify-center text-gray-600 mb-4",children:s.jsx(aae,{className:"w-10 h-10"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Cards Scanned"}),s.jsx("p",{className:"text-gray-500 text-sm max-w-xs",children:"Return to the scan view and aim your camera at a card to get started."}),s.jsx("button",{onClick:()=>u("scanning"),className:"mt-6 px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold",children:"Go Back to Scan"})]}):s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0 md:p-6",children:s.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[s.jsx("thead",{className:"hidden md:table-header-group",children:s.jsxs("tr",{className:"text-[10px] uppercase font-bold tracking-[0.2em] text-gray-500",children:[s.jsx("th",{className:"px-6 py-2",children:"Card Detail"}),s.jsx("th",{className:"px-6 py-2",children:"Price"}),s.jsx("th",{className:"px-6 py-2",children:"Set / #"}),s.jsx("th",{className:"px-6 py-2",children:"Finish"}),s.jsx("th",{className:"px-6 py-2",children:"Qty"}),s.jsx("th",{className:"px-6 py-2 text-right",children:"Action"})]})}),s.jsx("tbody",{className:"space-y-4",children:O.map(Ne=>s.jsxs("tr",{className:"bg-gray-900 border border-white/5 md:border-none rounded-2xl md:rounded-none group hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"px-4 py-3 md:px-6 md:py-4 flex items-center gap-4",children:[s.jsx("img",{src:Ne.image,className:"w-12 h-16 object-cover rounded shadow-lg",alt:Ne.name}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:Ne.name}),s.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5",children:Ne.set_name})]})]}),s.jsx("td",{className:"hidden md:table-cell px-6 py-4",children:s.jsxs("div",{className:"text-sm font-bold text-green-400",children:["$",Ne.finish==="foil"?Ne.data?.prices?.usd_foil||"0.00":Ne.data?.prices?.usd||"0.00"]})}),s.jsx("td",{className:"hidden md:table-cell px-6 py-4",children:s.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[s.jsxs("select",{value:Ne.scryfall_id,onChange:Ge=>De(Ne.id,Ge.target.value),className:"bg-gray-800 border border-white/10 rounded-lg px-2 py-1 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 truncate",children:[Ne.variants?.map(Ge=>s.jsxs("option",{value:Ge.id,children:[(Ge.set||"").toUpperCase()," #",Ge.collector_number," (",Ge.set_name,")"]},Ge.id)),!Ne.variants?.length&&s.jsxs("option",{value:Ne.scryfall_id,children:[(Ne.set_code||"").toUpperCase()," #",Ne.collector_number]})]}),s.jsx("span",{className:"text-[9px] text-gray-600 mt-1 uppercase tracking-tighter",children:"Tap to change version"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsx("button",{onClick:()=>oe(Ne.id,{finish:Ne.finish==="foil"?"nonfoil":"foil"}),className:`text-[10px] px-2 py-1 rounded border transition-all ${Ne.finish==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 font-bold shadow-[0_0_10px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500"}`,children:Ne.finish==="foil"?" FOIL":"NON-FOIL"})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>oe(Ne.id,{quantity:Math.max(1,Ne.quantity-1)}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"-"}),s.jsx("span",{className:"text-sm font-bold text-white w-4 text-center",children:Ne.quantity}),s.jsx("button",{onClick:()=>oe(Ne.id,{quantity:Ne.quantity+1}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"+"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>oe(Ne.id,{is_wishlist:!Ne.is_wishlist}),className:`p-1.5 rounded-lg transition-all ${Ne.is_wishlist?"bg-red-500/10 text-red-500":"bg-gray-800/50 text-gray-500 hover:text-red-400"}`,children:s.jsx(sae,{className:`w-4 h-4 ${Ne.is_wishlist?"fill-current":""}`})}),s.jsx("button",{onClick:()=>Te(Ne.id),className:"p-1.5 text-gray-600 hover:text-red-500 transition-colors",children:s.jsx(VF,{className:"w-4 h-4"})})]})})]},Ne.id))})]})})})]}),s.jsxs("div",{className:"p-6 border-t border-white/5 bg-gray-900/80 flex justify-between items-center relative z-10",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[s.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em] whitespace-nowrap",children:[O.length," Cards in Batch"]}),s.jsx("div",{className:"h-4 w-px bg-white/10 hidden md:block"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/50 p-1 rounded-lg border border-white/5",children:[s.jsx("button",{onClick:()=>se("new"),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${ee==="new"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"New"}),s.jsx("button",{onClick:()=>se("transfer"),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${ee==="transfer"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Transfer"})]}),s.jsxs("select",{value:G||"",onChange:Ne=>ne(Ne.target.value||null),className:"bg-gray-800 border border-white/10 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 max-w-[150px] md:max-w-[200px]",children:[s.jsx("option",{value:"",children:"No Deck (Binder)"}),s.jsx("optgroup",{label:"My Decks",children:J.map(Ne=>s.jsx("option",{value:Ne.id,children:Ne.name},Ne.id))})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[O.length>0&&c==="scanning"&&s.jsx("button",{onClick:()=>u("review"),className:"px-6 py-2 text-gray-400 hover:text-white font-bold text-xs",children:"Review All"}),s.jsxs("button",{onClick:Nt,disabled:O.length===0,className:`px-4 py-3 rounded-2xl font-bold text-xs transition-all flex items-center gap-2 ${O.length>0?"bg-indigo-600/20 text-indigo-300 hover:bg-indigo-600/30":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:[s.jsx(Nx,{className:"w-4 h-4"})," Add & Continue"]}),s.jsxs("button",{onClick:ot,disabled:O.length===0,className:`px-10 py-3 rounded-2xl font-black text-sm transition-all shadow-xl active:scale-95 flex items-center gap-2 ${O.length>0?"bg-indigo-600 text-white shadow-indigo-900/40":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:[s.jsx(vd,{className:"w-4 h-4"})," ",n==="audit"?"Apply to Audit":"Add to Collection"]})]})]}),s.jsx("canvas",{ref:m,style:{display:"none"}})]})}),document.body):null},cle=()=>{const t=Ao(),{currentUser:e,userProfile:r,logout:n,updateSettings:i,refreshUserProfile:a,uploadProfilePicture:o}=Sr(),{addToast:l}=wn(),c=t.pathname==="/",[u,f]=b.useState(!1),[p,x]=b.useState(!1),[m,y]=b.useState(!1),[v,j]=b.useState(!1),[N,C]=b.useState(!1),[A,L]=b.useState(!1),[O,F]=b.useState(!1),[T,I]=b.useState(!1),B=Ke.useRef(null);Ke.useEffect(()=>{const se=J=>{A&&!J.target.closest("#user-menu-button")&&!J.target.closest("#user-menu-dropdown")&&L(!1)};return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[A]);const $=async se=>{console.log("Saving new playstyle:",se),await i({playstyle:se}),await a(),j(!0)},k=async se=>{const J=se.target.files[0];if(J){console.log("[Navbar] Starting file upload:",J.name,J.size,J.type);try{F(!0),console.log("[Navbar] Calling uploadProfilePicture...");const W=await o(J);console.log("[Navbar] Upload successful! Photo URL:",W),alert("Profile picture updated successfully!")}catch(W){console.error("[Navbar] Upload failed:",W),alert(`Upload failed: ${W.message}`)}finally{console.log("[Navbar] Upload complete, resetting state"),F(!1),L(!1)}}},R=()=>{B.current?.click()},P=e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",q=P?"FORGE MASTER":e?.email||"";let X=null;const G=r?.subscription_tier;if(G&&G!=="free"){const se=Cs[G];se&&(X={icon:"",label:se.name,color:"text-blue-400 border-blue-500/30 bg-blue-500/10"},G===Jt.TIER_1&&(X={icon:"",label:"Apprentice",color:"text-blue-400 border-blue-500/30 bg-blue-500/10"}),G===Jt.TIER_2&&(X={icon:"",label:"Magician",color:"text-purple-400 border-purple-500/30 bg-purple-500/10"}),G===Jt.TIER_3&&(X={icon:"",label:"Wizard",color:"text-yellow-400 border-yellow-500/30 bg-yellow-500/10"}),G===Jt.TIER_4&&(X={icon:"",label:"Archmage",color:"text-orange-400 border-orange-500/30 bg-orange-500/10"}),G===Jt.TIER_5&&(X={icon:"",label:"Planeswalker",color:"text-red-400 border-red-500/30 bg-red-500/10"}))}const ne=P?{icon:"",label:"Architect",color:"text-amber-500 bg-amber-500/20 border-amber-500/50"}:X||r?.settings?.badge||{icon:"",label:"Alpha Tester",color:"text-gray-400 bg-gray-800 border-gray-700"},ee=async()=>{try{await n(),window.location.href="/"}catch(se){console.error("Logout failed",se)}};return s.jsxs(s.Fragment,{children:[s.jsx("nav",{className:"bg-gray-950/30 backdrop-blur-2xl border-b border-white/5 sticky top-0 z-50",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsx("div",{className:"flex-shrink-0 flex items-center gap-3",children:s.jsxs(br,{to:"/",className:"flex items-center gap-3 transform hover:scale-105 transition-transform",children:[s.jsx("img",{src:"/logo.png",alt:"MTG Forge Logo",className:"h-10 w-auto"}),s.jsxs("div",{className:"flex flex-col gap-1 sm:hidden",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none",children:"ALPHA"}),G&&G!=="free"&&(()=>{const se=Cs[G];let J="text-gray-400 border-gray-600 bg-gray-800";return G===Jt.TIER_1&&(J="text-blue-400 border-blue-500/30 bg-blue-500/10"),G===Jt.TIER_2&&(J="text-purple-400 border-purple-500/30 bg-purple-500/10"),G===Jt.TIER_3&&(J="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),G===Jt.TIER_4&&(J="text-orange-400 border-orange-500/30 bg-orange-500/10"),G===Jt.TIER_5&&(J="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase w-fit ${J}`,children:se?.name||"MEMBER"})})()]}),s.jsxs("div",{className:"hidden sm:flex flex-col justify-center",children:[s.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent leading-none pb-1",children:"MTG-Forge"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none",children:"ALPHA"}),G&&G!=="free"&&(()=>{const se=Cs[G];let J="text-gray-400 border-gray-600 bg-gray-800";return G===Jt.TIER_1&&(J="text-blue-400 border-blue-500/30 bg-blue-500/10"),G===Jt.TIER_2&&(J="text-purple-400 border-purple-500/30 bg-purple-500/10"),G===Jt.TIER_3&&(J="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),G===Jt.TIER_4&&(J="text-orange-400 border-orange-500/30 bg-orange-500/10"),G===Jt.TIER_5&&(J="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase ${J}`,children:se?.name||"MEMBER"})})()]})]})]})}),s.jsx("div",{className:"hidden lg:ml-10 lg:flex lg:items-baseline lg:space-x-4",children:e?s.jsxs(s.Fragment,{children:[s.jsx(br,{to:"/dashboard",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Dashboard"}),s.jsx(br,{to:"/collection",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Collection"}),s.jsx(br,{to:"/wishlist",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Wishlist"}),s.jsx(br,{to:"/decks",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Decks"}),s.jsx(br,{to:"/binders",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Binders"}),s.jsx(br,{to:"/social",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Social"}),s.jsx(br,{to:"/precons",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Precons"}),s.jsx(br,{to:"/sets",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Sets"})]}):s.jsx(s.Fragment,{children:c?s.jsxs(s.Fragment,{children:[s.jsx("a",{href:"#features",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Features"}),s.jsx(br,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})]}):s.jsx(s.Fragment,{children:s.jsx(br,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})})})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e&&s.jsxs("button",{onClick:()=>f(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20 flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"hidden sm:inline",children:"Add Card"})]}),e?s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>C(!0),className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all group relative ${ne.color||"bg-gray-800 border-gray-700 hover:bg-gray-700"}`,title:ne.label||"Change Badge",children:[s.jsx("span",{className:"text-base",children:ne.icon}),P&&s.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),s.jsx("span",{className:`text-sm font-medium hidden sm:inline-block ${P?"text-amber-400 font-bold tracking-wider":"text-gray-300 max-w-[150px] truncate"}`,children:q}),s.jsx("button",{id:"user-menu-button",onClick:()=>L(!A),className:"text-gray-400 hover:text-white transition-colors focus:outline-none",children:e.photoURL?s.jsx("img",{src:e.photoURL,alt:"Profile",className:"h-8 w-8 rounded-full object-cover ring-2 ring-transparent hover:ring-indigo-500 transition-all border border-gray-600"}):s.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 border border-indigo-500/50 flex items-center justify-center ring-2 ring-transparent hover:ring-indigo-500 transition-all",children:s.jsx("span",{className:"text-xs font-bold text-indigo-300",children:e.email?e.email[0].toUpperCase():"U"})})})]}),A&&s.jsxs("div",{id:"user-menu-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 border border-gray-700 ring-1 ring-black ring-opacity-5 animate-fade-in-up",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[s.jsx("p",{className:"text-sm text-white font-bold",children:"Account"}),s.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.email})]}),s.jsx("button",{onClick:R,disabled:O,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:O?"Uploading...":"Upload Photo"}),s.jsx("input",{type:"file",ref:B,onChange:k,className:"hidden",accept:"image/*"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{L(!1),j(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Playstyle Profile"}),s.jsx(br,{to:"/settings",onClick:()=>L(!1),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Settings"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsxs("button",{onClick:()=>{L(!1),I(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-cyan-400",children:""})," History"]}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{L(!1),ee()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300",children:"Sign Out"})]})]}):s.jsx(br,{to:"/login",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Sign In"})]})]})})})}),s.jsx(O6,{isOpen:u,onClose:()=>f(!1),onOpenForgeLens:()=>{f(!1),x(!0)}}),s.jsx(jw,{isOpen:p,onClose:()=>x(!1),onFinish:async(se,J={})=>{if(!se||se.length===0)return;const W=J.targetDeckId?`deck:${J.targetDeckId}`:"collection",U=se.map(Y=>({scryfall_id:Y.scryfall_id,name:Y.name,set_code:Y.set_code,collector_number:Y.collector_number,finish:Y.finish,quantity:Y.quantity,is_foil:Y.finish==="foil"}));try{console.log("[Navbar] Adding batch via Forge Lens:",U,W),await Ze.batchAddToCollection(U,W),l(`Successfully added ${se.length} cards via Forge Lens!`,"success"),x(!1)}catch(Y){console.error("Batch add failed",Y),l(`Failed to add cards: ${Y.message}`,"error")}}}),s.jsx(MF,{isOpen:m,onClose:()=>y(!1),onComplete:$}),s.jsx(Zse,{isOpen:v,onClose:()=>j(!1),profile:r?.settings?.playstyle,userImage:e?.photoURL,onRetake:()=>{j(!1),y(!0)}}),s.jsx(tie,{isOpen:N,onClose:()=>C(!1),currentBadgeId:r?.settings?.badge?.id||"alpha_tester",isMaster:e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",onSelect:async se=>{await i({badge:se}),await a(),C(!1)}}),s.jsx(dL,{isOpen:T,onClose:()=>I(!1)}),!c&&s.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-gray-900 border-t border-gray-800 z-50 pb-safe",children:s.jsxs("div",{className:"flex justify-around items-center h-16",children:[s.jsxs(br,{to:"/dashboard",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/dashboard"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Home"})]}),s.jsxs(br,{to:"/collection",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/collection"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Collection"})]}),s.jsxs(br,{to:"/wishlist",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/wishlist"?"text-orange-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Wishlist"})]}),s.jsxs(br,{to:"/decks",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/decks")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Decks"})]}),s.jsxs(br,{to:"/social",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/social"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Social"})]}),s.jsxs(br,{to:"/precons",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/precons")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Precons"})]}),s.jsxs(br,{to:"/sets",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/sets")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Sets"})]}),s.jsxs(br,{to:"/settings",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/settings"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Settings"})]})]})}),s.jsx(dL,{isOpen:T,onClose:()=>I(!1)})]})},z6=({isOpen:t,onClose:e})=>t?Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Binder Management Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Organize your collection like a pro."})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Two Ways to Build"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsxs("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:[" Manual Binder ",s.jsx("span",{className:"text-[9px] bg-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Magician Tier"})]}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Classic storage. You drag and drop exactly which cards go inside. Great for mirroring your physical binders."})]}),s.jsxs("div",{className:"bg-indigo-900/10 p-4 rounded-2xl border border-indigo-500/20",children:[s.jsxs("h4",{className:"text-indigo-300 font-bold mb-1 flex items-center gap-2",children:[" Smart Binder ",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Free & Up"})]}),s.jsx("p",{className:"text-xs text-indigo-200/60 leading-relaxed",children:'Live automation. You set rules (like "Price > $10"), and the binder automatically grabs matching cards from your collection.'})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"AI Smart Creator"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:"Don't want to build rules manually? Just describe what you want in plain English!"}),s.jsxs("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30 mb-4",children:[s.jsx("p",{className:"font-mono text-xs text-gray-400 mb-2",children:"Try prompts like:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-indigo-300 font-medium",children:[s.jsx("li",{children:'"All my red goblins over $5"'}),s.jsx("li",{children:'"Cards to trade that I have duplicates of"'}),s.jsx("li",{children:'"High value commanders not in any decks"'})]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"The AI detects price, color, type, quantity, rarity, and even whether a card is currently used in a deck."})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Advanced Logic (In Deck, Quantity)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"In Deck Status"}),s.jsxs("p",{className:"text-xs text-gray-400",children:['Filter cards based on usage. Create a "Trade Binder" by excluding cards that are currently ',s.jsx("span",{className:"text-white font-mono",children:"In Deck = True"}),"."]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"Quantity Control"}),s.jsxs("p",{className:"text-xs text-gray-400",children:["Filter by how many copies you own. Great for finding ",s.jsx("span",{className:"text-white font-mono",children:"Count > 4"})," (Duplicates)."]})]})]})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Custom Style"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use any Hex Code color and pick from hundreds of icons (including MTG Mana Symbols) to make your binder pop."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Live Updates"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Smart Binders are alive. When you add a new card to your collection that matches the rules, it instantly appears in the binder."})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it!"})})]})]}),document.body):null,hU=({isOpen:t,onClose:e})=>t?Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-purple-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-500/20 rounded-xl text-purple-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["For Pods & Permissions.",s.jsx("span",{className:"text-[9px] bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded uppercase tracking-wider border border-purple-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{className:"text-white",children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsxs("div",{className:"bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/20 flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("p",{className:"text-xs text-indigo-300 font-bold",children:"Pro Tip: Only add people you actually know and trust to your Pod."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-blue-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-blue-400 tracking-wider mb-2 block",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Private Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Download/Clone Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Edit Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-purple-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-purple-400 tracking-wider mb-2 block",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Editor"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Everything in Viewer"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-white font-bold",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add/Remove Cards ",s.jsx("span",{className:"font-normal text-gray-400 ml-1",children:"from Decks"})]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-green-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add Cards to Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-white ring-2 ring-indigo-500",children:"You"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P2"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P3"})]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-widest",children:"Collaborative Deck Building"})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it, thanks!"})})]})]}),document.body):null;var dle=Object.defineProperty,Q1=Object.getOwnPropertySymbols,fU=Object.prototype.hasOwnProperty,pU=Object.prototype.propertyIsEnumerable,eO=(t,e,r)=>e in t?dle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,aS=(t,e)=>{for(var r in e||(e={}))fU.call(e,r)&&eO(t,r,e[r]);if(Q1)for(var r of Q1(e))pU.call(e,r)&&eO(t,r,e[r]);return t},oS=(t,e)=>{var r={};for(var n in t)fU.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&Q1)for(var n of Q1(t))e.indexOf(n)<0&&pU.call(t,n)&&(r[n]=t[n]);return r};var h0;(t=>{const e=class cn{constructor(c,u,f,p){if(this.version=c,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],c<cn.MIN_VERSION||c>cn.MAX_VERSION)throw new RangeError("Version value out of range");if(p<-1||p>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let x=[];for(let y=0;y<this.size;y++)x.push(!1);for(let y=0;y<this.size;y++)this.modules.push(x.slice()),this.isFunction.push(x.slice());this.drawFunctionPatterns();const m=this.addEccAndInterleave(f);if(this.drawCodewords(m),p==-1){let y=1e9;for(let v=0;v<8;v++){this.applyMask(v),this.drawFormatBits(v);const j=this.getPenaltyScore();j<y&&(p=v,y=j),this.applyMask(v)}}i(0<=p&&p<=7),this.mask=p,this.applyMask(p),this.drawFormatBits(p),this.isFunction=[]}static encodeText(c,u){const f=t.QrSegment.makeSegments(c);return cn.encodeSegments(f,u)}static encodeBinary(c,u){const f=t.QrSegment.makeBytes(c);return cn.encodeSegments([f],u)}static encodeSegments(c,u,f=1,p=40,x=-1,m=!0){if(!(cn.MIN_VERSION<=f&&f<=p&&p<=cn.MAX_VERSION)||x<-1||x>7)throw new RangeError("Invalid value");let y,v;for(y=f;;y++){const A=cn.getNumDataCodewords(y,u)*8,L=o.getTotalBits(c,y);if(L<=A){v=L;break}if(y>=p)throw new RangeError("Data too long")}for(const A of[cn.Ecc.MEDIUM,cn.Ecc.QUARTILE,cn.Ecc.HIGH])m&&v<=cn.getNumDataCodewords(y,A)*8&&(u=A);let j=[];for(const A of c){r(A.mode.modeBits,4,j),r(A.numChars,A.mode.numCharCountBits(y),j);for(const L of A.getData())j.push(L)}i(j.length==v);const N=cn.getNumDataCodewords(y,u)*8;i(j.length<=N),r(0,Math.min(4,N-j.length),j),r(0,(8-j.length%8)%8,j),i(j.length%8==0);for(let A=236;j.length<N;A^=253)r(A,8,j);let C=[];for(;C.length*8<j.length;)C.push(0);return j.forEach((A,L)=>C[L>>>3]|=A<<7-(L&7)),new cn(y,u,C,x)}getModule(c,u){return 0<=c&&c<this.size&&0<=u&&u<this.size&&this.modules[u][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let f=0;f<this.size;f++)this.setFunctionModule(6,f,f%2==0),this.setFunctionModule(f,6,f%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),u=c.length;for(let f=0;f<u;f++)for(let p=0;p<u;p++)f==0&&p==0||f==0&&p==u-1||f==u-1&&p==0||this.drawAlignmentPattern(c[f],c[p]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const u=this.errorCorrectionLevel.formatBits<<3|c;let f=u;for(let x=0;x<10;x++)f=f<<1^(f>>>9)*1335;const p=(u<<10|f)^21522;i(p>>>15==0);for(let x=0;x<=5;x++)this.setFunctionModule(8,x,n(p,x));this.setFunctionModule(8,7,n(p,6)),this.setFunctionModule(8,8,n(p,7)),this.setFunctionModule(7,8,n(p,8));for(let x=9;x<15;x++)this.setFunctionModule(14-x,8,n(p,x));for(let x=0;x<8;x++)this.setFunctionModule(this.size-1-x,8,n(p,x));for(let x=8;x<15;x++)this.setFunctionModule(8,this.size-15+x,n(p,x));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let f=0;f<12;f++)c=c<<1^(c>>>11)*7973;const u=this.version<<12|c;i(u>>>18==0);for(let f=0;f<18;f++){const p=n(u,f),x=this.size-11+f%3,m=Math.floor(f/3);this.setFunctionModule(x,m,p),this.setFunctionModule(m,x,p)}}drawFinderPattern(c,u){for(let f=-4;f<=4;f++)for(let p=-4;p<=4;p++){const x=Math.max(Math.abs(p),Math.abs(f)),m=c+p,y=u+f;0<=m&&m<this.size&&0<=y&&y<this.size&&this.setFunctionModule(m,y,x!=2&&x!=4)}}drawAlignmentPattern(c,u){for(let f=-2;f<=2;f++)for(let p=-2;p<=2;p++)this.setFunctionModule(c+p,u+f,Math.max(Math.abs(p),Math.abs(f))!=1)}setFunctionModule(c,u,f){this.modules[u][c]=f,this.isFunction[u][c]=!0}addEccAndInterleave(c){const u=this.version,f=this.errorCorrectionLevel;if(c.length!=cn.getNumDataCodewords(u,f))throw new RangeError("Invalid argument");const p=cn.NUM_ERROR_CORRECTION_BLOCKS[f.ordinal][u],x=cn.ECC_CODEWORDS_PER_BLOCK[f.ordinal][u],m=Math.floor(cn.getNumRawDataModules(u)/8),y=p-m%p,v=Math.floor(m/p);let j=[];const N=cn.reedSolomonComputeDivisor(x);for(let A=0,L=0;A<p;A++){let O=c.slice(L,L+v-x+(A<y?0:1));L+=O.length;const F=cn.reedSolomonComputeRemainder(O,N);A<y&&O.push(0),j.push(O.concat(F))}let C=[];for(let A=0;A<j[0].length;A++)j.forEach((L,O)=>{(A!=v-x||O>=y)&&C.push(L[A])});return i(C.length==m),C}drawCodewords(c){if(c.length!=Math.floor(cn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let f=this.size-1;f>=1;f-=2){f==6&&(f=5);for(let p=0;p<this.size;p++)for(let x=0;x<2;x++){const m=f-x,v=(f+1&2)==0?this.size-1-p:p;!this.isFunction[v][m]&&u<c.length*8&&(this.modules[v][m]=n(c[u>>>3],7-(u&7)),u++)}}i(u==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let f=0;f<this.size;f++){let p;switch(c){case 0:p=(f+u)%2==0;break;case 1:p=u%2==0;break;case 2:p=f%3==0;break;case 3:p=(f+u)%3==0;break;case 4:p=(Math.floor(f/3)+Math.floor(u/2))%2==0;break;case 5:p=f*u%2+f*u%3==0;break;case 6:p=(f*u%2+f*u%3)%2==0;break;case 7:p=((f+u)%2+f*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][f]&&p&&(this.modules[u][f]=!this.modules[u][f])}}getPenaltyScore(){let c=0;for(let x=0;x<this.size;x++){let m=!1,y=0,v=[0,0,0,0,0,0,0];for(let j=0;j<this.size;j++)this.modules[x][j]==m?(y++,y==5?c+=cn.PENALTY_N1:y>5&&c++):(this.finderPenaltyAddHistory(y,v),m||(c+=this.finderPenaltyCountPatterns(v)*cn.PENALTY_N3),m=this.modules[x][j],y=1);c+=this.finderPenaltyTerminateAndCount(m,y,v)*cn.PENALTY_N3}for(let x=0;x<this.size;x++){let m=!1,y=0,v=[0,0,0,0,0,0,0];for(let j=0;j<this.size;j++)this.modules[j][x]==m?(y++,y==5?c+=cn.PENALTY_N1:y>5&&c++):(this.finderPenaltyAddHistory(y,v),m||(c+=this.finderPenaltyCountPatterns(v)*cn.PENALTY_N3),m=this.modules[j][x],y=1);c+=this.finderPenaltyTerminateAndCount(m,y,v)*cn.PENALTY_N3}for(let x=0;x<this.size-1;x++)for(let m=0;m<this.size-1;m++){const y=this.modules[x][m];y==this.modules[x][m+1]&&y==this.modules[x+1][m]&&y==this.modules[x+1][m+1]&&(c+=cn.PENALTY_N2)}let u=0;for(const x of this.modules)u=x.reduce((m,y)=>m+(y?1:0),u);const f=this.size*this.size,p=Math.ceil(Math.abs(u*20-f*10)/f)-1;return i(0<=p&&p<=9),c+=p*cn.PENALTY_N4,i(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let f=[6];for(let p=this.size-7;f.length<c;p-=u)f.splice(1,0,p);return f}}static getNumRawDataModules(c){if(c<cn.MIN_VERSION||c>cn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*c+128)*c+64;if(c>=2){const f=Math.floor(c/7)+2;u-=(25*f-10)*f-55,c>=7&&(u-=36)}return i(208<=u&&u<=29648),u}static getNumDataCodewords(c,u){return Math.floor(cn.getNumRawDataModules(c)/8)-cn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c]*cn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let u=[];for(let p=0;p<c-1;p++)u.push(0);u.push(1);let f=1;for(let p=0;p<c;p++){for(let x=0;x<u.length;x++)u[x]=cn.reedSolomonMultiply(u[x],f),x+1<u.length&&(u[x]^=u[x+1]);f=cn.reedSolomonMultiply(f,2)}return u}static reedSolomonComputeRemainder(c,u){let f=u.map(p=>0);for(const p of c){const x=p^f.shift();f.push(0),u.forEach((m,y)=>f[y]^=cn.reedSolomonMultiply(m,x))}return f}static reedSolomonMultiply(c,u){if(c>>>8||u>>>8)throw new RangeError("Byte out of range");let f=0;for(let p=7;p>=0;p--)f=f<<1^(f>>>7)*285,f^=(u>>>p&1)*c;return i(f>>>8==0),f}finderPenaltyCountPatterns(c){const u=c[1];i(u<=this.size*3);const f=u>0&&c[2]==u&&c[3]==u*3&&c[4]==u&&c[5]==u;return(f&&c[0]>=u*4&&c[6]>=u?1:0)+(f&&c[6]>=u*4&&c[0]>=u?1:0)}finderPenaltyTerminateAndCount(c,u,f){return c&&(this.finderPenaltyAddHistory(u,f),u=0),u+=this.size,this.finderPenaltyAddHistory(u,f),this.finderPenaltyCountPatterns(f)}finderPenaltyAddHistory(c,u){u[0]==0&&(c+=this.size),u.pop(),u.unshift(c)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(l,c,u){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let f=c-1;f>=0;f--)u.push(l>>>f&1)}function n(l,c){return(l>>>c&1)!=0}function i(l){if(!l)throw new Error("Assertion error")}const a=class gi{constructor(c,u,f){if(this.mode=c,this.numChars=u,this.bitData=f,u<0)throw new RangeError("Invalid argument");this.bitData=f.slice()}static makeBytes(c){let u=[];for(const f of c)r(f,8,u);return new gi(gi.Mode.BYTE,c.length,u)}static makeNumeric(c){if(!gi.isNumeric(c))throw new RangeError("String contains non-numeric characters");let u=[];for(let f=0;f<c.length;){const p=Math.min(c.length-f,3);r(parseInt(c.substring(f,f+p),10),p*3+1,u),f+=p}return new gi(gi.Mode.NUMERIC,c.length,u)}static makeAlphanumeric(c){if(!gi.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],f;for(f=0;f+2<=c.length;f+=2){let p=gi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(f))*45;p+=gi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(f+1)),r(p,11,u)}return f<c.length&&r(gi.ALPHANUMERIC_CHARSET.indexOf(c.charAt(f)),6,u),new gi(gi.Mode.ALPHANUMERIC,c.length,u)}static makeSegments(c){return c==""?[]:gi.isNumeric(c)?[gi.makeNumeric(c)]:gi.isAlphanumeric(c)?[gi.makeAlphanumeric(c)]:[gi.makeBytes(gi.toUtf8ByteArray(c))]}static makeEci(c){let u=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,u);else if(c<16384)r(2,2,u),r(c,14,u);else if(c<1e6)r(6,3,u),r(c,21,u);else throw new RangeError("ECI assignment value out of range");return new gi(gi.Mode.ECI,0,u)}static isNumeric(c){return gi.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return gi.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,u){let f=0;for(const p of c){const x=p.mode.numCharCountBits(u);if(p.numChars>=1<<x)return 1/0;f+=4+x+p.bitData.length}return f}static toUtf8ByteArray(c){c=encodeURI(c);let u=[];for(let f=0;f<c.length;f++)c.charAt(f)!="%"?u.push(c.charCodeAt(f)):(u.push(parseInt(c.substring(f+1,f+3),16)),f+=2);return u}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=a;t.QrSegment=a})(h0||(h0={}));(t=>{(e=>{const r=class{constructor(i,a){this.ordinal=i,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(h0||(h0={}));(t=>{(e=>{const r=class{constructor(i,a){this.modeBits=i,this.numBitsCharCount=a}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(h0||(h0={}));var Hp=h0;var ule={L:Hp.QrCode.Ecc.LOW,M:Hp.QrCode.Ecc.MEDIUM,Q:Hp.QrCode.Ecc.QUARTILE,H:Hp.QrCode.Ecc.HIGH},mU=128,gU="L",xU="#FFFFFF",bU="#000000",yU=!1,vU=1,hle=4,fle=0,ple=.1;function wU(t,e=0){const r=[];return t.forEach(function(n,i){let a=null;n.forEach(function(o,l){if(!o&&a!==null){r.push(`M${a+e} ${i+e}h${l-a}v1H${a+e}z`),a=null;return}if(l===n.length-1){if(!o)return;a===null?r.push(`M${l+e},${i+e} h1v1H${l+e}z`):r.push(`M${a+e},${i+e} h${l+1-a}v1H${a+e}z`);return}o&&a===null&&(a=l)})}),r.join("")}function jU(t,e){return t.slice().map((r,n)=>n<e.y||n>=e.y+e.h?r:r.map((i,a)=>a<e.x||a>=e.x+e.w?i:!1))}function mle(t,e,r,n){if(n==null)return null;const i=t.length+r*2,a=Math.floor(e*ple),o=i/e,l=(n.width||a)*o,c=(n.height||a)*o,u=n.x==null?t.length/2-l/2:n.x*o,f=n.y==null?t.length/2-c/2:n.y*o,p=n.opacity==null?1:n.opacity;let x=null;if(n.excavate){let y=Math.floor(u),v=Math.floor(f),j=Math.ceil(l+u-y),N=Math.ceil(c+f-v);x={x:y,y:v,w:j,h:N}}const m=n.crossOrigin;return{x:u,y:f,h:c,w:l,excavation:x,opacity:p,crossOrigin:m}}function gle(t,e){return e!=null?Math.max(Math.floor(e),0):t?hle:fle}function NU({value:t,level:e,minVersion:r,includeMargin:n,marginSize:i,imageSettings:a,size:o,boostLevel:l}){let c=Ke.useMemo(()=>{const y=(Array.isArray(t)?t:[t]).reduce((v,j)=>(v.push(...Hp.QrSegment.makeSegments(j)),v),[]);return Hp.QrCode.encodeSegments(y,ule[e],r,void 0,void 0,l)},[t,e,r,l]);const{cells:u,margin:f,numCells:p,calculatedImageSettings:x}=Ke.useMemo(()=>{let m=c.getModules();const y=gle(n,i),v=m.length+y*2,j=mle(m,o,y,a);return{cells:m,margin:y,numCells:v,calculatedImageSettings:j}},[c,o,a,n,i]);return{qrcode:c,margin:f,cells:u,numCells:p,calculatedImageSettings:x}}var xle=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),ble=Ke.forwardRef(function(e,r){const n=e,{value:i,size:a=mU,level:o=gU,bgColor:l=xU,fgColor:c=bU,includeMargin:u=yU,minVersion:f=vU,boostLevel:p,marginSize:x,imageSettings:m}=n,v=oS(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:j}=v,N=oS(v,["style"]),C=m?.src,A=Ke.useRef(null),L=Ke.useRef(null),O=Ke.useCallback(q=>{A.current=q,typeof r=="function"?r(q):r&&(r.current=q)},[r]),[F,T]=Ke.useState(!1),{margin:I,cells:B,numCells:$,calculatedImageSettings:k}=NU({value:i,level:o,minVersion:f,boostLevel:p,includeMargin:u,marginSize:x,imageSettings:m,size:a});Ke.useEffect(()=>{if(A.current!=null){const q=A.current,X=q.getContext("2d");if(!X)return;let G=B;const ne=L.current,ee=k!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;ee&&k.excavation!=null&&(G=jU(B,k.excavation));const se=window.devicePixelRatio||1;q.height=q.width=a*se;const J=a/$*se;X.scale(J,J),X.fillStyle=l,X.fillRect(0,0,$,$),X.fillStyle=c,xle?X.fill(new Path2D(wU(G,I))):B.forEach(function(W,U){W.forEach(function(Y,te){Y&&X.fillRect(te+I,U+I,1,1)})}),k&&(X.globalAlpha=k.opacity),ee&&X.drawImage(ne,k.x+I,k.y+I,k.w,k.h)}}),Ke.useEffect(()=>{T(!1)},[C]);const R=aS({height:a,width:a},j);let P=null;return C!=null&&(P=Ke.createElement("img",{src:C,key:C,style:{display:"none"},onLoad:()=>{T(!0)},ref:L,crossOrigin:k?.crossOrigin})),Ke.createElement(Ke.Fragment,null,Ke.createElement("canvas",aS({style:R,height:a,width:a,ref:O,role:"img"},N)),P)});ble.displayName="QRCodeCanvas";var Nw=Ke.forwardRef(function(e,r){const n=e,{value:i,size:a=mU,level:o=gU,bgColor:l=xU,fgColor:c=bU,includeMargin:u=yU,minVersion:f=vU,boostLevel:p,title:x,marginSize:m,imageSettings:y}=n,v=oS(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:j,cells:N,numCells:C,calculatedImageSettings:A}=NU({value:i,level:o,minVersion:f,boostLevel:p,includeMargin:u,marginSize:m,imageSettings:y,size:a});let L=N,O=null;y!=null&&A!=null&&(A.excavation!=null&&(L=jU(N,A.excavation)),O=Ke.createElement("image",{href:y.src,height:A.h,width:A.w,x:A.x+j,y:A.y+j,preserveAspectRatio:"none",opacity:A.opacity,crossOrigin:A.crossOrigin}));const F=wU(L,j);return Ke.createElement("svg",aS({height:a,width:a,viewBox:`0 0 ${C} ${C}`,ref:r,role:"img"},v),!!x&&Ke.createElement("title",null,x),Ke.createElement("path",{fill:l,d:`M0,0 h${C}v${C}H0z`,shapeRendering:"crispEdges"}),Ke.createElement("path",{fill:c,d:F,shapeRendering:"crispEdges"}),O)});Nw.displayName="QRCodeSVG";const yle=({isOpen:t,onClose:e})=>{if(!t)return null;const r="https://mtg-forge.com/share/heir-to-the-hysteria-x26l";return Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-10 w-full max-w-md bg-gray-900 border border-white/10 rounded-3xl overflow-hidden shadow-2xl animate-fade-in-up",children:[s.jsxs("div",{className:"p-6 pb-2 text-center",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Scan to view deck list instantly"})]}),s.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[s.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:s.jsx(Nw,{value:r,size:200,level:"H",includeMargin:!1})}),s.jsxs("div",{className:"w-full text-center space-y-3",children:[s.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-xl p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 text-left",children:"Share Link"}),s.jsx("p",{className:"text-xs text-indigo-300 font-mono truncate text-left select-all",children:r})]}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(r),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Copy",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Anyone with this link can view the full deck list and statistics."})]})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/50 flex justify-center",children:s.jsx("button",{onClick:()=>window.open(r,"_blank"),className:"text-indigo-400 hover:text-white text-sm font-bold transition-colors",children:"Open Link in New Tab "})})]})]}),document.body)},q6=({isOpen:t,onClose:e})=>t?Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Audit & Verification Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["Audit The Forge to verify your collection.",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider border border-green-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Neutral Starting State"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:'Every card starts in a "pending" state. We assume your collection matches your records until you verify it.'}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:" Pending"}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Gray border. The input is locked. You must choose to Match or flag a Mismatch to continue."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"2"}),"Quick Verification"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-green-900/10 p-4 rounded-2xl border border-green-500/20",children:[s.jsx("h4",{className:"text-green-300 font-bold mb-1 flex items-center gap-2",children:" Match (Check)"}),s.jsx("p",{className:"text-xs text-green-200/60 leading-relaxed",children:"Instantly marks the card as reviewed and verified. Confirms you have exactly the expected amount."})]}),s.jsxs("div",{className:"bg-red-900/10 p-4 rounded-2xl border border-red-500/20",children:[s.jsx("h4",{className:"text-red-300 font-bold mb-1 flex items-center gap-2",children:" Mismatch (X)"}),s.jsx("p",{className:"text-xs text-red-200/60 leading-relaxed",children:"Flags a discrepancy. Sets count to 0 and unlocks the input so you can type the correct physical count."})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"3"}),"Finalizing Your Audit"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`Once you've touched every card in a section (Deck or Set), mark it as "Finished".`}),s.jsx("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30",children:s.jsx("p",{className:"text-xs text-indigo-300 font-medium",children:"When the entire audit is complete, use the **Finalize Audit** button in the Hub. This will sync all your Mismatches to your actual collection database, ensuring your digital records match your physical boxes."})})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Discrepancy Report"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use the report table in the Audit Hub to see exactly what changed before you finalize."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Mobile Friendly"}),s.jsx("p",{className:"text-xs text-gray-300",children:"The Audit Wizard is optimized for phone use. Carry your phone to your bulk boxes for easy scanning!"})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Start Auditing"})})]})]}),document.body):null,vle=()=>{const[t,e]=b.useState(null);return s.jsxs("section",{id:"features",className:"py-32 bg-transparent relative",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-24 animate-fade-in-up",children:[s.jsx("span",{className:"text-indigo-400 font-bold tracking-widest uppercase text-sm mb-2 block",children:"The Forge Advantage"}),s.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white mb-6 leading-tight",children:["Actionable Intelligence.",s.jsx("br",{}),"Professional Results."]}),s.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto text-xl italic",children:'"Stop tracking cards. Start forging strategy."'})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-orange-500/20 rounded-3xl flex items-center justify-center mb-4 text-orange-400 ring-1 ring-orange-500/20",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"AI Deck Doctor",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The AI Deck Doctor"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["Precision meets playability. Our surgical analysis engine provides a precise ",s.jsx("span",{className:"text-white",children:"1-5 Bracket Rating"}),', a granular 10-point power score, and card-for-card "Surgical Swaps" to optimize your curve.']}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-orange-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Brackets"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"1-5 Scale"})]}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-green-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Precision"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"0.01 PL Step"})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(249,115,22,0.3)] border border-orange-500/20 group animate-fade-in-right bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Calculated Power"}),s.jsx("div",{className:"text-5xl font-black text-white italic",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-orange-500/20 rounded-lg border border-orange-500/30 text-orange-400 font-black uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 via-amber-400 to-orange-600 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center mb-4 text-indigo-400 ring-1 ring-indigo-500/20 shadow-[0_0_30px_rgba(79,70,229,0.2)]",children:s.jsx("img",{src:"/icons/the_neural_architect.png",alt:"Neural Architect",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The Neural Architect"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["The first true ",s.jsx("span",{className:"text-white",children:"Zero-to-Hero"})," deck builder. Select your Commander, and watch as the Architect synthesizes a full 100-card list while prioritizing the cards you already own."]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"A"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Commander-Centric Synthesis"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"From your commander selection to a complete 100-card list in seconds."})]})]}),s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"C"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Collection-Aware"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Builds using cards you own first, minimizing proxy needs."})]})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(79,70,229,0.3)] border border-indigo-500/20 group animate-fade-in-left bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-2",children:"Neural Blueprint Generation"}),[{t:"Commander",v:"Selected: Niv-Mizzet, Parun"},{t:"Budget",v:"$50 (Utilizing Collection)"},{t:"Power",v:"Target Bracket 3"}].map((r,n)=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-black/40 rounded-xl border border-white/5",children:[s.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:r.t}),s.jsx("span",{className:"text-xs font-black text-indigo-400",children:r.v})]},n)),s.jsxs("div",{className:"mt-6 pt-6 border-t border-white/10",children:[s.jsxs("div",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Blueprint Complete: 100/100 Cards"]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(8)].map((r,n)=>s.jsx("div",{className:"h-1 bg-indigo-500/40 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-400 w-full animate-shimmer"})},n))})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-3xl flex items-center justify-center mb-4 text-blue-400 ring-1 ring-blue-500/20",children:s.jsx("img",{src:"/icons/ai_strategy_analyst.png",alt:"AI Strategy Analyst",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"AI Strategy Analyst"}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Don't just build listsforge legends. Our Gemini-powered AI acts as a dedicated coach, analyzing synergies and suggesting win conditions tailored to your unique playstyle."}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-blue-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Advisor Analysis"}),s.jsx("div",{className:"text-white text-lg font-bold italic",children:'"Your win rate against Aggro pods increases by 14% with these adjustments."'})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(59,130,246,0.3)] border border-blue-500/20 group animate-fade-in-right",children:s.jsx("img",{src:"/images/features/ai-strategy-modal.png",alt:"AI Strategy Modal",className:"w-full h-auto opacity-80 hover:opacity-100 transition-opacity duration-700"})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-3xl flex items-center justify-center mb-4 text-purple-400 ring-1 ring-purple-500/20",children:s.jsx("img",{src:"/icons/social_pods.png",alt:"Social Pods",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:'Rule Your "Pod"'}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Magic is a social game. Link accounts with your playgroup to browse friends' collections, manage shared trades, and coordinate group power levels instantly."}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("button",{onClick:()=>e("pods"),className:"px-8 py-3 rounded-xl bg-purple-500/10 border border-purple-500/30 text-purple-400 font-bold hover:bg-purple-500/20 transition-all",children:"Explore Pods"}),s.jsx("button",{onClick:()=>e("qr"),className:"px-8 py-3 rounded-xl bg-white/5 border border-white/10 text-white font-bold hover:bg-white/10 transition-all",children:"Quick Share"})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(168,85,247,0.3)] border border-purple-500/20 group animate-fade-in-left bg-gray-950 p-12",children:s.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full h-full",children:[s.jsxs("div",{className:"bg-indigo-900/30 rounded-2xl border border-indigo-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-indigo-300 uppercase tracking-widest",children:"Smart Binder"})]}),s.jsxs("div",{className:"bg-purple-900/30 rounded-2xl border border-purple-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-75",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-purple-300 uppercase tracking-widest",children:"Pod Trade"})]}),s.jsxs("div",{className:"bg-blue-900/30 rounded-2xl border border-blue-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-100",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-blue-300 uppercase tracking-widest",children:"QR Share"})]}),s.jsxs("div",{className:"bg-green-900/30 rounded-2xl border border-green-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-150",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-green-300 uppercase tracking-widest",children:"Audits"})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-4 group cursor-pointer transition-transform hover:scale-110 duration-500",children:s.jsx("img",{src:"/icons/the_professional_foundation.png",alt:"The Professional Foundation",className:"w-20 h-20 object-contain transition-all duration-500 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-3xl font-black text-white leading-tight uppercase tracking-tight",children:"The Professional Foundation"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Underneath the AI intelligence is a robust engine for cataloging your digital life. Fast scanning, accurate pricing, and comprehensive management for any format."})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800/20 group",children:s.jsx("img",{src:"/images/features/collection-dashboard.jpg",alt:"Collection Dashboard",className:"w-full h-full object-cover opacity-40 group-hover:opacity-80 transition-opacity duration-700"})})]})]}),s.jsx(z6,{isOpen:t==="smart",onClose:()=>e(null)}),s.jsx(hU,{isOpen:t==="pods",onClose:()=>e(null)}),s.jsx(yle,{isOpen:t==="qr",onClose:()=>e(null)}),s.jsx(q6,{isOpen:t==="audit",onClose:()=>e(null)})]})},wle=()=>s.jsxs("div",{className:"flex flex-col min-h-screen relative",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center hidden md:block",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-cover bg-center md:hidden",style:{backgroundImage:"url(/MTG-Forge_Logo_Background_mobile.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-gray-950/80 to-black z-10"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[100vw] h-[100vh] bg-indigo-600/10 blur-[150px] rounded-full z-0 opacity-40"}),s.jsx("div",{className:"absolute top-1/4 left-1/4 w-[600px] h-[600px] bg-orange-500/5 blur-[120px] rounded-full z-0 opacity-20"})]}),s.jsx("div",{className:"bg-gradient-to-r from-orange-600 via-red-600 to-orange-600 text-white text-center py-2 px-4 shadow-lg z-50 relative animate-pulse-slow",children:s.jsxs("p",{className:"font-bold text-sm tracking-wide flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-lg",children:""}),"ALPHA TEST - Feature Complete but Experimental",s.jsx("span",{className:"text-lg",children:""})]})}),s.jsx("div",{className:"relative z-10 bg-transparent min-h-[80vh] flex flex-col items-center",children:s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-32 md:py-48 flex flex-col items-center text-center",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-8 animate-fade-in",children:[s.jsxs("span",{className:"relative flex h-2 w-2",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-indigo-500"})]}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-widest leading-none",children:"The Future of MTG Strategy"})]}),s.jsxs("h1",{className:"text-5xl md:text-8xl font-black tracking-tight text-white mb-8 leading-tight",children:["The Forge: Where Decks",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-500 to-orange-600 filter drop-shadow-[0_0_15px_rgba(251,191,36,0.3)]",children:"Become Legends"})]}),s.jsxs("p",{className:"max-w-2xl text-xl md:text-2xl text-gray-400 mx-auto font-medium leading-relaxed mb-12",children:["Brew Smarter. Play Harder. Your ",s.jsx("span",{className:"text-white",children:"AI-Powered Strategic Edge"}),". Join the next generation of Magic: The Gathering intelligence."]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center w-full max-w-lg",children:[s.jsxs(br,{to:"/dashboard",className:"group relative px-10 py-5 rounded-2xl bg-indigo-600 text-white font-black text-xl transition-all shadow-[0_20px_40px_-15px_rgba(79,70,229,0.5)] hover:shadow-[0_25px_50px_-12px_rgba(79,70,229,0.6)] transform hover:-translate-y-1 hover:scale-[1.02] flex items-center justify-center gap-3",children:[s.jsx("span",{children:"Enter The Forge"}),s.jsx("svg",{className:"w-6 h-6 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]}),s.jsx(br,{to:"/strategy",className:"px-10 py-5 rounded-2xl bg-white/5 backdrop-blur-xl hover:bg-white/10 text-white font-bold text-lg border border-white/10 transition-all hover:border-white/20 flex items-center justify-center",children:"Explore AI Strategic Edge"})]}),s.jsxs("div",{className:"mt-24 grid grid-cols-2 md:grid-cols-4 gap-8 w-full max-w-4xl border-t border-white/5 pt-12",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"99.8%"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Analysis Accuracy"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"Real-Time"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Pricing & Sync"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"5"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Bracket Tiers"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"AI"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Driven Meta"})]})]})]})}),s.jsx("div",{className:"relative z-10",children:s.jsx(vle,{})}),s.jsx("footer",{className:"bg-black py-12 border-t border-gray-900 mt-auto",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:s.jsx("p",{className:"text-gray-500",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."})})})]});function jle(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return b.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const kw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Rm(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function H6(t){return"nodeType"in t}function Lo(t){var e,r;return t?Rm(t)?t:H6(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function W6(t){const{Document:e}=Lo(t);return t instanceof e}function Eb(t){return Rm(t)?!1:t instanceof Lo(t).HTMLElement}function kU(t){return t instanceof Lo(t).SVGElement}function Dm(t){return t?Rm(t)?t.document:H6(t)?W6(t)?t:Eb(t)||kU(t)?t.ownerDocument:document:document:document}const Rc=kw?b.useLayoutEffect:b.useEffect;function Sw(t){const e=b.useRef(t);return Rc(()=>{e.current=t}),b.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function Nle(){const t=b.useRef(null),e=b.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=b.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function Ux(t,e){e===void 0&&(e=[t]);const r=b.useRef(t);return Rc(()=>{r.current!==t&&(r.current=t)},e),r}function Tb(t,e){const r=b.useRef();return b.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function e2(t){const e=Sw(t),r=b.useRef(null),n=b.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function t2(t){const e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}let iN={};function Lb(t,e){return b.useMemo(()=>{if(e)return e;const r=iN[t]==null?0:iN[t]+1;return iN[t]=r,t+"-"+r},[t,e])}function SU(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,o)=>{const l=Object.entries(o);for(const[c,u]of l){const f=a[c];f!=null&&(a[c]=f+t*u)}return a},{...e})}}const em=SU(1),zx=SU(-1);function kle(t){return"clientX"in t&&"clientY"in t}function _w(t){if(!t)return!1;const{KeyboardEvent:e}=Lo(t.target);return e&&t instanceof e}function Sle(t){if(!t)return!1;const{TouchEvent:e}=Lo(t.target);return e&&t instanceof e}function r2(t){if(Sle(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return kle(t)?{x:t.clientX,y:t.clientY}:null}const sf=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[sf.Translate.toString(t),sf.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),tO="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function _le(t){return t.matches(tO)?t:t.querySelector(tO)}const Cle={display:"none"};function Ale(t){let{id:e,value:r}=t;return Ke.createElement("div",{id:e,style:Cle},r)}function Ele(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ke.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function Tle(){const[t,e]=b.useState("");return{announce:b.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const _U=b.createContext(null);function Lle(t){const e=b.useContext(_U);b.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function Ole(){const[t]=b.useState(()=>new Set),e=b.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[b.useCallback(n=>{let{type:i,event:a}=n;t.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,a)})},[t]),e]}const Mle={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Ple={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Ile(t){let{announcements:e=Ple,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=Mle}=t;const{announce:a,announcement:o}=Tle(),l=Lb("DndLiveRegion"),[c,u]=b.useState(!1);if(b.useEffect(()=>{u(!0)},[]),Lle(b.useMemo(()=>({onDragStart(p){let{active:x}=p;a(e.onDragStart({active:x}))},onDragMove(p){let{active:x,over:m}=p;e.onDragMove&&a(e.onDragMove({active:x,over:m}))},onDragOver(p){let{active:x,over:m}=p;a(e.onDragOver({active:x,over:m}))},onDragEnd(p){let{active:x,over:m}=p;a(e.onDragEnd({active:x,over:m}))},onDragCancel(p){let{active:x,over:m}=p;a(e.onDragCancel({active:x,over:m}))}}),[a,e])),!c)return null;const f=Ke.createElement(Ke.Fragment,null,Ke.createElement(Ale,{id:n,value:i.draggable}),Ke.createElement(Ele,{id:l,announcement:o}));return r?Gn.createPortal(f,r):f}var ta;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(ta||(ta={}));function n2(){}function s2(t,e){return b.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function CU(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return b.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const Dc=Object.freeze({x:0,y:0});function Rle(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Dle(t,e){const r=r2(t);if(!r)return"0 0";const n={x:(r.x-e.left)/e.width*100,y:(r.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function Ble(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function $le(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function rO(t){let{left:e,top:r,height:n,width:i}=t;return[{x:e,y:r},{x:e+i,y:r},{x:e,y:r+n},{x:e+i,y:r+n}]}function AU(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}const EU=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=rO(e),a=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=rO(c),f=i.reduce((x,m,y)=>x+Rle(u[y],m),0),p=Number((f/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:p}})}}return a.sort(Ble)};function Fle(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),o=i-n,l=a-r;if(n<i&&r<a){const c=e.width*e.height,u=t.width*t.height,f=o*l,p=f/(c+u-f);return Number(p.toFixed(4))}return 0}const Ule=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:o}=a,l=r.get(o);if(l){const c=Fle(l,e);c>0&&i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort($le)};function zle(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function TU(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Dc}function qle(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...r})}}const Hle=qle(1);function LU(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function Wle(t,e,r){const n=LU(e);if(!n)return t;const{scaleX:i,scaleY:a,x:o,y:l}=n,c=t.left-o-(1-i)*parseFloat(r),u=t.top-l-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),f=i?t.width/i:t.width,p=a?t.height/a:t.height;return{width:f,height:p,top:u,right:c+f,bottom:u+p,left:c}}const Gle={ignoreTransform:!1};function Bm(t,e){e===void 0&&(e=Gle);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:f}=Lo(t).getComputedStyle(t);u&&(r=Wle(r,u,f))}const{top:n,left:i,width:a,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:a,height:o,bottom:l,right:c}}function nO(t){return Bm(t,{ignoreTransform:!0})}function Vle(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function Yle(t,e){return e===void 0&&(e=Lo(t).getComputedStyle(t)),e.position==="fixed"}function Kle(t,e){e===void 0&&(e=Lo(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function Cw(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(W6(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Eb(i)||kU(i)||r.includes(i))return r;const a=Lo(t).getComputedStyle(i);return i!==t&&Kle(i,a)&&r.push(i),Yle(i,a)?r:n(i.parentNode)}return t?n(t):r}function OU(t){const[e]=Cw(t,1);return e??null}function aN(t){return!kw||!t?null:Rm(t)?t:H6(t)?W6(t)||t===Dm(t).scrollingElement?window:Eb(t)?t:null:null}function MU(t){return Rm(t)?t.scrollX:t.scrollLeft}function PU(t){return Rm(t)?t.scrollY:t.scrollTop}function lS(t){return{x:MU(t),y:PU(t)}}var ya;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(ya||(ya={}));function IU(t){return!kw||!t?!1:t===document.scrollingElement}function RU(t){const e={x:0,y:0},r=IU(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,o=t.scrollTop>=n.y,l=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:o,isRight:l,maxScroll:n,minScroll:e}}const Xle={x:.2,y:.2};function Jle(t,e,r,n,i){let{top:a,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=Xle);const{isTop:u,isBottom:f,isLeft:p,isRight:x}=RU(t),m={x:0,y:0},y={x:0,y:0},v={height:e.height*i.y,width:e.width*i.x};return!u&&a<=e.top+v.height?(m.y=ya.Backward,y.y=n*Math.abs((e.top+v.height-a)/v.height)):!f&&c>=e.bottom-v.height&&(m.y=ya.Forward,y.y=n*Math.abs((e.bottom-v.height-c)/v.height)),!x&&l>=e.right-v.width?(m.x=ya.Forward,y.x=n*Math.abs((e.right-v.width-l)/v.width)):!p&&o<=e.left+v.width&&(m.x=ya.Backward,y.x=n*Math.abs((e.left+v.width-o)/v.width)),{direction:m,speed:y}}function Zle(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function DU(t){return t.reduce((e,r)=>em(e,lS(r)),Dc)}function Qle(t){return t.reduce((e,r)=>e+MU(r),0)}function ece(t){return t.reduce((e,r)=>e+PU(r),0)}function BU(t,e){if(e===void 0&&(e=Bm),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);OU(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const tce=[["x",["left","right"],Qle],["y",["top","bottom"],ece]];class G6{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Cw(r),i=DU(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,o,l]of tce)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),f=i[a]-u;return this.rect[c]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class kx{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function rce(t){const{EventTarget:e}=Lo(t);return t instanceof e?t:Dm(t)}function oN(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var Wl;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Wl||(Wl={}));function sO(t){t.preventDefault()}function nce(t){t.stopPropagation()}var yn;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(yn||(yn={}));const $U={start:[yn.Space,yn.Enter],cancel:[yn.Esc],end:[yn.Space,yn.Enter,yn.Tab]},sce=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case yn.Right:return{...r,x:r.x+25};case yn.Left:return{...r,x:r.x-25};case yn.Down:return{...r,y:r.y+25};case yn.Up:return{...r,y:r.y-25}}};class V6{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new kx(Dm(r)),this.windowListeners=new kx(Lo(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Wl.Resize,this.handleCancel),this.windowListeners.add(Wl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Wl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&BU(n),r(Dc)}handleKeyDown(e){if(_w(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=$U,coordinateGetter:o=sce,scrollBehavior:l="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=n.current,f=u?{x:u.left,y:u.top}:Dc;this.referenceCoordinates||(this.referenceCoordinates=f);const p=o(e,{active:r,context:n.current,currentCoordinates:f});if(p){const x=zx(p,f),m={x:0,y:0},{scrollableAncestors:y}=n.current;for(const v of y){const j=e.code,{isTop:N,isRight:C,isLeft:A,isBottom:L,maxScroll:O,minScroll:F}=RU(v),T=Zle(v),I={x:Math.min(j===yn.Right?T.right-T.width/2:T.right,Math.max(j===yn.Right?T.left:T.left+T.width/2,p.x)),y:Math.min(j===yn.Down?T.bottom-T.height/2:T.bottom,Math.max(j===yn.Down?T.top:T.top+T.height/2,p.y))},B=j===yn.Right&&!C||j===yn.Left&&!A,$=j===yn.Down&&!L||j===yn.Up&&!N;if(B&&I.x!==p.x){const k=v.scrollLeft+x.x,R=j===yn.Right&&k<=O.x||j===yn.Left&&k>=F.x;if(R&&!x.y){v.scrollTo({left:k,behavior:l});return}R?m.x=v.scrollLeft-k:m.x=j===yn.Right?v.scrollLeft-O.x:v.scrollLeft-F.x,m.x&&v.scrollBy({left:-m.x,behavior:l});break}else if($&&I.y!==p.y){const k=v.scrollTop+x.y,R=j===yn.Down&&k<=O.y||j===yn.Up&&k>=F.y;if(R&&!x.x){v.scrollTo({top:k,behavior:l});return}R?m.y=v.scrollTop-k:m.y=j===yn.Down?v.scrollTop-O.y:v.scrollTop-F.y,m.y&&v.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(e,em(zx(p,this.referenceCoordinates),m))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}V6.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=$U,onActivation:i}=e,{active:a}=r;const{code:o}=t.nativeEvent;if(n.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function iO(t){return!!(t&&"distance"in t)}function aO(t){return!!(t&&"delay"in t)}class Y6{constructor(e,r,n){var i;n===void 0&&(n=rce(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:o}=a;this.props=e,this.events=r,this.document=Dm(o),this.documentListeners=new kx(this.document),this.listeners=new kx(n),this.windowListeners=new kx(Lo(o)),this.initialCoordinates=(i=r2(a))!=null?i:Dc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Wl.Resize,this.handleCancel),this.windowListeners.add(Wl.DragStart,sO),this.windowListeners.add(Wl.VisibilityChange,this.handleCancel),this.windowListeners.add(Wl.ContextMenu,sO),this.documentListeners.add(Wl.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(aO(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(iO(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Wl.Click,nce,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Wl.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!i)return;const c=(r=r2(e))!=null?r:Dc,u=zx(i,c);if(!n&&l){if(iO(l)){if(l.tolerance!=null&&oN(u,l.tolerance))return this.handleCancel();if(oN(u,l.distance))return this.handleStart()}if(aO(l)&&oN(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===yn.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const ice={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class K6 extends Y6{constructor(e){const{event:r}=e,n=Dm(r.target);super(e,ice,n)}}K6.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const ace={move:{name:"mousemove"},end:{name:"mouseup"}};var cS;(function(t){t[t.RightClick=2]="RightClick"})(cS||(cS={}));class FU extends Y6{constructor(e){super(e,ace,Dm(e.event.target))}}FU.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===cS.RightClick?!1:(n?.({event:r}),!0)}}];const lN={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class UU extends Y6{constructor(e){super(e,lN)}static setup(){return window.addEventListener(lN.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(lN.move.name,e)};function e(){}}}UU.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var Sx;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Sx||(Sx={}));var i2;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(i2||(i2={}));function oce(t){let{acceleration:e,activator:r=Sx.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:o=5,order:l=i2.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:f,delta:p,threshold:x}=t;const m=cce({delta:p,disabled:!a}),[y,v]=Nle(),j=b.useRef({x:0,y:0}),N=b.useRef({x:0,y:0}),C=b.useMemo(()=>{switch(r){case Sx.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Sx.DraggableRect:return i}},[r,i,c]),A=b.useRef(null),L=b.useCallback(()=>{const F=A.current;if(!F)return;const T=j.current.x*N.current.x,I=j.current.y*N.current.y;F.scrollBy(T,I)},[]),O=b.useMemo(()=>l===i2.TreeOrder?[...u].reverse():u,[l,u]);b.useEffect(()=>{if(!a||!u.length||!C){v();return}for(const F of O){if(n?.(F)===!1)continue;const T=u.indexOf(F),I=f[T];if(!I)continue;const{direction:B,speed:$}=Jle(F,I,C,e,x);for(const k of["x","y"])m[k][B[k]]||($[k]=0,B[k]=0);if($.x>0||$.y>0){v(),A.current=F,y(L,o),j.current=$,N.current=B;return}}j.current={x:0,y:0},N.current={x:0,y:0},v()},[e,L,n,v,a,o,JSON.stringify(C),JSON.stringify(m),y,u,O,f,JSON.stringify(x)])}const lce={x:{[ya.Backward]:!1,[ya.Forward]:!1},y:{[ya.Backward]:!1,[ya.Forward]:!1}};function cce(t){let{delta:e,disabled:r}=t;const n=t2(e);return Tb(i=>{if(r||!n||!i)return lce;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[ya.Backward]:i.x[ya.Backward]||a.x===-1,[ya.Forward]:i.x[ya.Forward]||a.x===1},y:{[ya.Backward]:i.y[ya.Backward]||a.y===-1,[ya.Forward]:i.y[ya.Forward]||a.y===1}}},[r,e,n])}function dce(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return Tb(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function uce(t,e){return b.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,n)}));return[...r,...a]},[]),[t,e])}var qx;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(qx||(qx={}));var dS;(function(t){t.Optimized="optimized"})(dS||(dS={}));const oO=new Map;function hce(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,o]=b.useState(null),{frequency:l,measure:c,strategy:u}=i,f=b.useRef(t),p=j(),x=Ux(p),m=b.useCallback(function(N){N===void 0&&(N=[]),!x.current&&o(C=>C===null?N:C.concat(N.filter(A=>!C.includes(A))))},[x]),y=b.useRef(null),v=Tb(N=>{if(p&&!r)return oO;if(!N||N===oO||f.current!==t||a!=null){const C=new Map;for(let A of t){if(!A)continue;if(a&&a.length>0&&!a.includes(A.id)&&A.rect.current){C.set(A.id,A.rect.current);continue}const L=A.node.current,O=L?new G6(c(L),L):null;A.rect.current=O,O&&C.set(A.id,O)}return C}return N},[t,a,r,p,c]);return b.useEffect(()=>{f.current=t},[t]),b.useEffect(()=>{p||m()},[r,p]),b.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),b.useEffect(()=>{p||typeof l!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},l))},[l,p,m,...n]),{droppableRects:v,measureDroppableContainers:m,measuringScheduled:a!=null};function j(){switch(u){case qx.Always:return!1;case qx.BeforeDragging:return r;default:return!r}}}function X6(t,e){return Tb(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function fce(t,e){return X6(t,e)}function pce(t){let{callback:e,disabled:r}=t;const n=Sw(e),i=b.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return b.useEffect(()=>()=>i?.disconnect(),[i]),i}function Aw(t){let{callback:e,disabled:r}=t;const n=Sw(e),i=b.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return b.useEffect(()=>()=>i?.disconnect(),[i]),i}function mce(t){return new G6(Bm(t),t)}function lO(t,e,r){e===void 0&&(e=mce);const[n,i]=b.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=c??r)!=null?u:null}const f=e(t);return JSON.stringify(c)===JSON.stringify(f)?c:f})}const o=pce({callback(c){if(t)for(const u of c){const{type:f,target:p}=u;if(f==="childList"&&p instanceof HTMLElement&&p.contains(t)){a();break}}}}),l=Aw({callback:a});return Rc(()=>{a(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),n}function gce(t){const e=X6(t);return TU(t,e)}const cO=[];function xce(t){const e=b.useRef(t),r=Tb(n=>t?n&&n!==cO&&t&&e.current&&t.parentNode===e.current.parentNode?n:Cw(t):cO,[t]);return b.useEffect(()=>{e.current=t},[t]),r}function bce(t){const[e,r]=b.useState(null),n=b.useRef(t),i=b.useCallback(a=>{const o=aN(a.target);o&&r(l=>l?(l.set(o,lS(o)),new Map(l)):null)},[]);return b.useEffect(()=>{const a=n.current;if(t!==a){o(a);const l=t.map(c=>{const u=aN(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,lS(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(c=>{const u=aN(c);u?.removeEventListener("scroll",i)})}},[i,t]),b.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,o)=>em(a,o),Dc):DU(t):Dc,[t,e])}function dO(t,e){e===void 0&&(e=[]);const r=b.useRef(null);return b.useEffect(()=>{r.current=null},e),b.useEffect(()=>{const n=t!==Dc;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?zx(t,r.current):Dc}function yce(t){b.useEffect(()=>{if(!kw)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function vce(t,e){return b.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=o=>{a(o,e)},r},{}),[t,e])}function zU(t){return b.useMemo(()=>t?Vle(t):null,[t])}const uO=[];function wce(t,e){e===void 0&&(e=Bm);const[r]=t,n=zU(r?Lo(r):null),[i,a]=b.useState(uO);function o(){a(()=>t.length?t.map(c=>IU(c)?n:new G6(e(c),c)):uO)}const l=Aw({callback:o});return Rc(()=>{l?.disconnect(),o(),t.forEach(c=>l?.observe(c))},[t]),i}function qU(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Eb(e)?e:t}function jce(t){let{measure:e}=t;const[r,n]=b.useState(null),i=b.useCallback(u=>{for(const{target:f}of u)if(Eb(f)){n(p=>{const x=e(f);return p?{...p,width:x.width,height:x.height}:x});break}},[e]),a=Aw({callback:i}),o=b.useCallback(u=>{const f=qU(u);a?.disconnect(),f&&a?.observe(f),n(f?e(f):null)},[e,a]),[l,c]=e2(o);return b.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const Nce=[{sensor:K6,options:{}},{sensor:V6,options:{}}],kce={current:{}},w1={draggable:{measure:nO},droppable:{measure:nO,strategy:qx.WhileDragging,frequency:dS.Optimized},dragOverlay:{measure:Bm}};class _x extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const Sce={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _x,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:n2},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:w1,measureDroppableContainers:n2,windowRect:null,measuringScheduled:!1},HU={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:n2,draggableNodes:new Map,over:null,measureDroppableContainers:n2},Ob=b.createContext(HU),WU=b.createContext(Sce);function _ce(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _x}}}function Cce(t,e){switch(e.type){case ta.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case ta.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case ta.DragEnd:case ta.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ta.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new _x(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case ta.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const o=new _x(t.droppable.containers);return o.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case ta.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new _x(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function Ace(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=b.useContext(Ob),a=t2(n),o=t2(r?.id);return b.useEffect(()=>{if(!e&&!n&&a&&o!=null){if(!_w(a)||document.activeElement===a.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[c.current,u.current]){if(!f)continue;const p=_le(f);if(p){p.focus();break}}})}},[n,e,i,o,a]),null}function GU(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function Ece(t){return b.useMemo(()=>({draggable:{...w1.draggable,...t?.draggable},droppable:{...w1.droppable,...t?.droppable},dragOverlay:{...w1.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Tce(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=b.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Rc(()=>{if(!o&&!l||!e){a.current=!1;return}if(a.current||!n)return;const u=e?.node.current;if(!u||u.isConnected===!1)return;const f=r(u),p=TU(f,n);if(o||(p.x=0),l||(p.y=0),a.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const x=OU(u);x&&x.scrollBy({top:p.y,left:p.x})}},[e,o,l,n,r])}const Ew=b.createContext({...Dc,scaleX:1,scaleY:1});var Ph;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Ph||(Ph={}));const VU=b.memo(function(e){var r,n,i,a;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:f=Nce,collisionDetection:p=Ule,measuring:x,modifiers:m,...y}=e;const v=b.useReducer(Cce,void 0,_ce),[j,N]=v,[C,A]=Ole(),[L,O]=b.useState(Ph.Uninitialized),F=L===Ph.Initialized,{draggable:{active:T,nodes:I,translate:B},droppable:{containers:$}}=j,k=T!=null?I.get(T):null,R=b.useRef({initial:null,translated:null}),P=b.useMemo(()=>{var Ct;return T!=null?{id:T,data:(Ct=k?.data)!=null?Ct:kce,rect:R}:null},[T,k]),q=b.useRef(null),[X,G]=b.useState(null),[ne,ee]=b.useState(null),se=Ux(y,Object.values(y)),J=Lb("DndDescribedBy",o),W=b.useMemo(()=>$.getEnabled(),[$]),U=Ece(x),{droppableRects:Y,measureDroppableContainers:te,measuringScheduled:ce}=hce(W,{dragging:F,dependencies:[B.x,B.y],config:U.droppable}),xe=dce(I,T),ue=b.useMemo(()=>ne?r2(ne):null,[ne]),ve=jr(),Q=fce(xe,U.draggable.measure);Tce({activeNode:T!=null?I.get(T):null,config:ve.layoutShiftCompensation,initialRect:Q,measure:U.draggable.measure});const pe=lO(xe,U.draggable.measure,Q),Ce=lO(xe?xe.parentElement:null),je=b.useRef({activatorEvent:null,active:null,activeNode:xe,collisionRect:null,collisions:null,droppableRects:Y,draggableNodes:I,draggingNode:null,draggingNodeRect:null,droppableContainers:$,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),we=$.getNodeFor((r=je.current.over)==null?void 0:r.id),Te=jce({measure:U.dragOverlay.measure}),oe=(n=Te.nodeRef.current)!=null?n:xe,De=F?(i=Te.rect)!=null?i:pe:null,Nt=!!(Te.nodeRef.current&&Te.rect),ot=gce(Nt?null:pe),Ne=zU(oe?Lo(oe):null),Ge=xce(F?we??xe:null),Xe=wce(Ge),xt=GU(m,{transform:{x:B.x-ot.x,y:B.y-ot.y,scaleX:1,scaleY:1},activatorEvent:ne,active:P,activeNodeRect:pe,containerNodeRect:Ce,draggingNodeRect:De,over:je.current.over,overlayNodeRect:Te.rect,scrollableAncestors:Ge,scrollableAncestorRects:Xe,windowRect:Ne}),Ae=ue?em(ue,B):null,Pe=bce(Ge),ct=dO(Pe),bt=dO(Pe,[pe]),dt=em(xt,ct),Ve=De?Hle(De,xt):null,lt=P&&Ve?p({active:P,collisionRect:Ve,droppableRects:Y,droppableContainers:W,pointerCoordinates:Ae}):null,kt=AU(lt,"id"),[Ue,Bt]=b.useState(null),zt=Nt?xt:em(xt,bt),Ot=zle(zt,(a=Ue?.rect)!=null?a:null,pe),Et=b.useRef(null),$t=b.useCallback((Ct,Tt)=>{let{sensor:Yt,options:Be}=Tt;if(q.current==null)return;const Lt=I.get(q.current);if(!Lt)return;const Ft=Ct.nativeEvent,Ee=new Yt({active:q.current,activeNode:Lt,event:Ft,options:Be,context:je,onAbort(Mt){if(!I.get(Mt))return;const{onDragAbort:Zt}=se.current,Ut={id:Mt};Zt?.(Ut),C({type:"onDragAbort",event:Ut})},onPending(Mt,Gt,Zt,Ut){if(!I.get(Mt))return;const{onDragPending:Vt}=se.current,pr={id:Mt,constraint:Gt,initialCoordinates:Zt,offset:Ut};Vt?.(pr),C({type:"onDragPending",event:pr})},onStart(Mt){const Gt=q.current;if(Gt==null)return;const Zt=I.get(Gt);if(!Zt)return;const{onDragStart:Ut}=se.current,It={activatorEvent:Ft,active:{id:Gt,data:Zt.data,rect:R}};Gn.unstable_batchedUpdates(()=>{Ut?.(It),O(Ph.Initializing),N({type:ta.DragStart,initialCoordinates:Mt,active:Gt}),C({type:"onDragStart",event:It}),G(Et.current),ee(Ft)})},onMove(Mt){N({type:ta.DragMove,coordinates:Mt})},onEnd:He(ta.DragEnd),onCancel:He(ta.DragCancel)});Et.current=Ee;function He(Mt){return async function(){const{active:Zt,collisions:Ut,over:It,scrollAdjustedTranslate:Vt}=je.current;let pr=null;if(Zt&&Vt){const{cancelDrop:en}=se.current;pr={activatorEvent:Ft,active:Zt,collisions:Ut,delta:Vt,over:It},Mt===ta.DragEnd&&typeof en=="function"&&await Promise.resolve(en(pr))&&(Mt=ta.DragCancel)}q.current=null,Gn.unstable_batchedUpdates(()=>{N({type:Mt}),O(Ph.Uninitialized),Bt(null),G(null),ee(null),Et.current=null;const en=Mt===ta.DragEnd?"onDragEnd":"onDragCancel";if(pr){const Yr=se.current[en];Yr?.(pr),C({type:en,event:pr})}})}}},[I]),At=b.useCallback((Ct,Tt)=>(Yt,Be)=>{const Lt=Yt.nativeEvent,Ft=I.get(Be);if(q.current!==null||!Ft||Lt.dndKit||Lt.defaultPrevented)return;const Ee={active:Ft};Ct(Yt,Tt.options,Ee)===!0&&(Lt.dndKit={capturedBy:Tt.sensor},q.current=Be,$t(Yt,Tt))},[I,$t]),Xt=uce(f,At);yce(f),Rc(()=>{pe&&L===Ph.Initializing&&O(Ph.Initialized)},[pe,L]),b.useEffect(()=>{const{onDragMove:Ct}=se.current,{active:Tt,activatorEvent:Yt,collisions:Be,over:Lt}=je.current;if(!Tt||!Yt)return;const Ft={active:Tt,activatorEvent:Yt,collisions:Be,delta:{x:dt.x,y:dt.y},over:Lt};Gn.unstable_batchedUpdates(()=>{Ct?.(Ft),C({type:"onDragMove",event:Ft})})},[dt.x,dt.y]),b.useEffect(()=>{const{active:Ct,activatorEvent:Tt,collisions:Yt,droppableContainers:Be,scrollAdjustedTranslate:Lt}=je.current;if(!Ct||q.current==null||!Tt||!Lt)return;const{onDragOver:Ft}=se.current,Ee=Be.get(kt),He=Ee&&Ee.rect.current?{id:Ee.id,rect:Ee.rect.current,data:Ee.data,disabled:Ee.disabled}:null,Mt={active:Ct,activatorEvent:Tt,collisions:Yt,delta:{x:Lt.x,y:Lt.y},over:He};Gn.unstable_batchedUpdates(()=>{Bt(He),Ft?.(Mt),C({type:"onDragOver",event:Mt})})},[kt]),Rc(()=>{je.current={activatorEvent:ne,active:P,activeNode:xe,collisionRect:Ve,collisions:lt,droppableRects:Y,draggableNodes:I,draggingNode:oe,draggingNodeRect:De,droppableContainers:$,over:Ue,scrollableAncestors:Ge,scrollAdjustedTranslate:dt},R.current={initial:De,translated:Ve}},[P,xe,lt,Ve,I,oe,De,Y,$,Ue,Ge,dt]),oce({...ve,delta:B,draggingRect:Ve,pointerCoordinates:Ae,scrollableAncestors:Ge,scrollableAncestorRects:Xe});const qt=b.useMemo(()=>({active:P,activeNode:xe,activeNodeRect:pe,activatorEvent:ne,collisions:lt,containerNodeRect:Ce,dragOverlay:Te,draggableNodes:I,droppableContainers:$,droppableRects:Y,over:Ue,measureDroppableContainers:te,scrollableAncestors:Ge,scrollableAncestorRects:Xe,measuringConfiguration:U,measuringScheduled:ce,windowRect:Ne}),[P,xe,pe,ne,lt,Ce,Te,I,$,Y,Ue,te,Ge,Xe,U,ce,Ne]),Ht=b.useMemo(()=>({activatorEvent:ne,activators:Xt,active:P,activeNodeRect:pe,ariaDescribedById:{draggable:J},dispatch:N,draggableNodes:I,over:Ue,measureDroppableContainers:te}),[ne,Xt,P,pe,N,J,I,Ue,te]);return Ke.createElement(_U.Provider,{value:A},Ke.createElement(Ob.Provider,{value:Ht},Ke.createElement(WU.Provider,{value:qt},Ke.createElement(Ew.Provider,{value:Ot},u)),Ke.createElement(Ace,{disabled:l?.restoreFocus===!1})),Ke.createElement(Ile,{...l,hiddenTextDescribedById:J}));function jr(){const Ct=X?.autoScrollEnabled===!1,Tt=typeof c=="object"?c.enabled===!1:c===!1,Yt=F&&!Ct&&!Tt;return typeof c=="object"?{...c,enabled:Yt}:{enabled:Yt}}}),Lce=b.createContext(null),hO="button",Oce="Draggable";function YU(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=Lb(Oce),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:f,draggableNodes:p,over:x}=b.useContext(Ob),{role:m=hO,roleDescription:y="draggable",tabIndex:v=0}=i??{},j=c?.id===e,N=b.useContext(j?Ew:Lce),[C,A]=e2(),[L,O]=e2(),F=vce(o,e),T=Ux(r);Rc(()=>(p.set(e,{id:e,key:a,node:C,activatorNode:L,data:T}),()=>{const B=p.get(e);B&&B.key===a&&p.delete(e)}),[p,e]);const I=b.useMemo(()=>({role:m,tabIndex:v,"aria-disabled":n,"aria-pressed":j&&m===hO?!0:void 0,"aria-roledescription":y,"aria-describedby":f.draggable}),[n,m,v,j,y,f.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:I,isDragging:j,listeners:n?void 0:F,node:C,over:x,setNodeRef:A,setActivatorNodeRef:O,transform:N}}function KU(){return b.useContext(WU)}const Mce="Droppable",Pce={timeout:25};function XU(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=Lb(Mce),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=b.useContext(Ob),f=b.useRef({disabled:r}),p=b.useRef(!1),x=b.useRef(null),m=b.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:j}={...Pce,...i},N=Ux(v??n),C=b.useCallback(()=>{if(!p.current){p.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(N.current)?N.current:[N.current]),m.current=null},j)},[j]),A=Aw({callback:C,disabled:y||!o}),L=b.useCallback((I,B)=>{A&&(B&&(A.unobserve(B),p.current=!1),I&&A.observe(I))},[A]),[O,F]=e2(L),T=Ux(e);return b.useEffect(()=>{!A||!O.current||(A.disconnect(),p.current=!1,A.observe(O.current))},[O,A]),b.useEffect(()=>(l({type:ta.RegisterDroppable,element:{id:n,key:a,disabled:r,node:O,rect:x,data:T}}),()=>l({type:ta.UnregisterDroppable,key:a,id:n})),[n]),b.useEffect(()=>{r!==f.current.disabled&&(l({type:ta.SetDroppableDisabled,id:n,key:a,disabled:r}),f.current.disabled=r)},[n,a,r,l]),{active:o,rect:x,isOver:c?.id===n,node:O,over:c,setNodeRef:F}}function Ice(t){let{animation:e,children:r}=t;const[n,i]=b.useState(null),[a,o]=b.useState(null),l=t2(r);return!r&&!n&&l&&i(l),Rc(()=>{if(!a)return;const c=n?.key,u=n?.props.id;if(c==null||u==null){i(null);return}Promise.resolve(e(u,a)).then(()=>{i(null)})},[e,n,a]),Ke.createElement(Ke.Fragment,null,r,n?b.cloneElement(n,{ref:o}):null)}const Rce={x:0,y:0,scaleX:1,scaleY:1};function Dce(t){let{children:e}=t;return Ke.createElement(Ob.Provider,{value:HU},Ke.createElement(Ew.Provider,{value:Rce},e))}const Bce={position:"fixed",touchAction:"none"},$ce=t=>_w(t)?"transform 250ms ease":void 0,Fce=b.forwardRef((t,e)=>{let{as:r,activatorEvent:n,adjustScale:i,children:a,className:o,rect:l,style:c,transform:u,transition:f=$ce}=t;if(!l)return null;const p=i?u:{...u,scaleX:1,scaleY:1},x={...Bce,width:l.width,height:l.height,top:l.top,left:l.left,transform:sf.Transform.toString(p),transformOrigin:i&&n?Dle(n,l):void 0,transition:typeof f=="function"?f(n):f,...c};return Ke.createElement(r,{className:o,style:x,ref:e},a)}),JU=t=>e=>{let{active:r,dragOverlay:n}=e;const i={},{styles:a,className:o}=t;if(a!=null&&a.active)for(const[l,c]of Object.entries(a.active))c!==void 0&&(i[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(a!=null&&a.dragOverlay)for(const[l,c]of Object.entries(a.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return o!=null&&o.active&&r.node.classList.add(o.active),o!=null&&o.dragOverlay&&n.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(i))r.node.style.setProperty(c,u);o!=null&&o.active&&r.node.classList.remove(o.active)}},Uce=t=>{let{transform:{initial:e,final:r}}=t;return[{transform:sf.Transform.toString(e)},{transform:sf.Transform.toString(r)}]},zce={duration:250,easing:"ease",keyframes:Uce,sideEffects:JU({styles:{active:{opacity:"0"}}})};function qce(t){let{config:e,draggableNodes:r,droppableContainers:n,measuringConfiguration:i}=t;return Sw((a,o)=>{if(e===null)return;const l=r.get(a);if(!l)return;const c=l.node.current;if(!c)return;const u=qU(o);if(!u)return;const{transform:f}=Lo(o).getComputedStyle(o),p=LU(f);if(!p)return;const x=typeof e=="function"?e:Hce(e);return BU(c,i.draggable.measure),x({active:{id:a,data:l.data,node:c,rect:i.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:o,rect:i.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:i,transform:p})})}function Hce(t){const{duration:e,easing:r,sideEffects:n,keyframes:i}={...zce,...t};return a=>{let{active:o,dragOverlay:l,transform:c,...u}=a;if(!e)return;const f={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},p={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},x={x:c.x-f.x,y:c.y-f.y,...p},m=i({...u,active:o,dragOverlay:l,transform:{initial:c,final:x}}),[y]=m,v=m[m.length-1];if(JSON.stringify(y)===JSON.stringify(v))return;const j=n?.({active:o,dragOverlay:l,...u}),N=l.node.animate(m,{duration:e,easing:r,fill:"forwards"});return new Promise(C=>{N.onfinish=()=>{j?.(),C()}})}}let fO=0;function Wce(t){return b.useMemo(()=>{if(t!=null)return fO++,fO},[t])}const ZU=Ke.memo(t=>{let{adjustScale:e=!1,children:r,dropAnimation:n,style:i,transition:a,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=t;const{activatorEvent:f,active:p,activeNodeRect:x,containerNodeRect:m,draggableNodes:y,droppableContainers:v,dragOverlay:j,over:N,measuringConfiguration:C,scrollableAncestors:A,scrollableAncestorRects:L,windowRect:O}=KU(),F=b.useContext(Ew),T=Wce(p?.id),I=GU(o,{activatorEvent:f,active:p,activeNodeRect:x,containerNodeRect:m,draggingNodeRect:j.rect,over:N,overlayNodeRect:j.rect,scrollableAncestors:A,scrollableAncestorRects:L,transform:F,windowRect:O}),B=X6(x),$=qce({config:n,draggableNodes:y,droppableContainers:v,measuringConfiguration:C}),k=B?j.setRef:void 0;return Ke.createElement(Dce,null,Ke.createElement(Ice,{animation:$},p&&T?Ke.createElement(Fce,{key:T,id:p.id,ref:k,as:l,activatorEvent:f,adjustScale:e,className:c,transition:a,rect:B,style:{zIndex:u,...i},transform:I},r):null))});function J6(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function Gce(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function fv(t){return t!==null&&t>=0}function Vce(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Yce(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const Z6=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=J6(e,n,r),o=e[i],l=a[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},QU="Sortable",ez=Ke.createContext({activeIndex:-1,containerId:QU,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Z6,disabled:{draggable:!1,droppable:!1}});function Kce(t){let{children:e,id:r,items:n,strategy:i=Z6,disabled:a=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:f}=KU(),p=Lb(QU,r),x=l.rect!==null,m=b.useMemo(()=>n.map(F=>typeof F=="object"&&"id"in F?F.id:F),[n]),y=o!=null,v=o?m.indexOf(o.id):-1,j=u?m.indexOf(u.id):-1,N=b.useRef(m),C=!Vce(m,N.current),A=j!==-1&&v===-1||C,L=Yce(a);Rc(()=>{C&&y&&f(m)},[C,m,y,f]),b.useEffect(()=>{N.current=m},[m]);const O=b.useMemo(()=>({activeIndex:v,containerId:p,disabled:L,disableTransforms:A,items:m,overIndex:j,useDragOverlay:x,sortedRects:Gce(m,c),strategy:i}),[v,p,L.draggable,L.droppable,A,m,j,c,x,i]);return Ke.createElement(ez.Provider,{value:O},e)}const Xce=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return J6(r,n,i).indexOf(e)},Jce=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=t;return!u||!n||l!==a&&i===o?!1:r?!0:o!==i&&e===c},Zce={duration:200,easing:"ease"},tz="transform",Qce=sf.Transition.toString({property:tz,duration:0,easing:"linear"}),ede={roleDescription:"sortable"};function tde(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,o]=b.useState(null),l=b.useRef(r);return Rc(()=>{if(!e&&r!==l.current&&n.current){const c=i.current;if(c){const u=Bm(n.current,{ignoreTransform:!0}),f={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(f.x||f.y)&&o(f)}}r!==l.current&&(l.current=r)},[e,r,n,i]),b.useEffect(()=>{a&&o(null)},[a]),a}function rde(t){let{animateLayoutChanges:e=Jce,attributes:r,disabled:n,data:i,getNewIndex:a=Xce,id:o,strategy:l,resizeObserverConfig:c,transition:u=Zce}=t;const{items:f,containerId:p,activeIndex:x,disabled:m,disableTransforms:y,sortedRects:v,overIndex:j,useDragOverlay:N,strategy:C}=b.useContext(ez),A=nde(n,m),L=f.indexOf(o),O=b.useMemo(()=>({sortable:{containerId:p,index:L,items:f},...i}),[p,i,L,f]),F=b.useMemo(()=>f.slice(f.indexOf(o)),[f,o]),{rect:T,node:I,isOver:B,setNodeRef:$}=XU({id:o,data:O,disabled:A.droppable,resizeObserverConfig:{updateMeasurementsFor:F,...c}}),{active:k,activatorEvent:R,activeNodeRect:P,attributes:q,setNodeRef:X,listeners:G,isDragging:ne,over:ee,setActivatorNodeRef:se,transform:J}=YU({id:o,data:O,attributes:{...ede,...r},disabled:A.draggable}),W=jle($,X),U=!!k,Y=U&&!y&&fv(x)&&fv(j),te=!N&&ne,ce=te&&Y?J:null,ue=Y?ce??(l??C)({rects:v,activeNodeRect:P,activeIndex:x,overIndex:j,index:L}):null,ve=fv(x)&&fv(j)?a({id:o,items:f,activeIndex:x,overIndex:j}):L,Q=k?.id,pe=b.useRef({activeId:Q,items:f,newIndex:ve,containerId:p}),Ce=f!==pe.current.items,je=e({active:k,containerId:p,isDragging:ne,isSorting:U,id:o,index:L,items:f,newIndex:pe.current.newIndex,previousItems:pe.current.items,previousContainerId:pe.current.containerId,transition:u,wasDragging:pe.current.activeId!=null}),we=tde({disabled:!je,index:L,node:I,rect:T});return b.useEffect(()=>{U&&pe.current.newIndex!==ve&&(pe.current.newIndex=ve),p!==pe.current.containerId&&(pe.current.containerId=p),f!==pe.current.items&&(pe.current.items=f)},[U,ve,p,f]),b.useEffect(()=>{if(Q===pe.current.activeId)return;if(Q!=null&&pe.current.activeId==null){pe.current.activeId=Q;return}const oe=setTimeout(()=>{pe.current.activeId=Q},50);return()=>clearTimeout(oe)},[Q]),{active:k,activeIndex:x,attributes:q,data:O,rect:T,index:L,newIndex:ve,items:f,isOver:B,isSorting:U,isDragging:ne,listeners:G,node:I,overIndex:j,over:ee,setNodeRef:W,setActivatorNodeRef:se,setDroppableNodeRef:$,setDraggableNodeRef:X,transform:we??ue,transition:Te()};function Te(){if(we||Ce&&pe.current.newIndex===L)return Qce;if(!(te&&!_w(R)||!u)&&(U||je))return sf.Transition.toString({...u,property:tz})}}function nde(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}function a2(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const sde=[yn.Down,yn.Right,yn.Up,yn.Left],ide=(t,e)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:a,over:o,scrollableAncestors:l}}=e;if(sde.includes(t.code)){if(t.preventDefault(),!r||!n)return;const c=[];a.getEnabled().forEach(p=>{if(!p||p!=null&&p.disabled)return;const x=i.get(p.id);if(x)switch(t.code){case yn.Down:n.top<x.top&&c.push(p);break;case yn.Up:n.top>x.top&&c.push(p);break;case yn.Left:n.left>x.left&&c.push(p);break;case yn.Right:n.left<x.left&&c.push(p);break}});const u=EU({collisionRect:n,droppableRects:i,droppableContainers:c});let f=AU(u,"id");if(f===o?.id&&u.length>1&&(f=u[1].id),f!=null){const p=a.get(r.id),x=a.get(f),m=x?i.get(x.id):null,y=x?.node.current;if(y&&m&&p&&x){const j=Cw(y).some((F,T)=>l[T]!==F),N=rz(p,x),C=ade(p,x),A=j||!N?{x:0,y:0}:{x:C?n.width-m.width:0,y:C?n.height-m.height:0},L={x:m.left,y:m.top};return A.x&&A.y?L:zx(L,A)}}}};function rz(t,e){return!a2(t)||!a2(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function ade(t,e){return!a2(t)||!a2(e)||!rz(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}const ode=typeof document<"u"?Ke.useLayoutEffect:()=>{},uf=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},Gf=t=>t&&"window"in t&&t.window===t?t:uf(t).defaultView||window;function lde(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function cde(t){return lde(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let dde=!1;function Q6(){return dde}function nz(t,e){if(!Q6())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:cde(r)?r=r.host:r=r.parentNode}return!1}const uS=(t=document)=>{var e;if(!Q6())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function sz(t){return Q6()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function iz(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=iz(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ns(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=iz(t))&&(n&&(n+=" "),n+=e);return n}function ude(t){if(hde())t.focus({preventScroll:!0});else{let e=fde(t);t.focus(),pde(e)}}let pv=null;function hde(){if(pv==null){pv=!1;try{document.createElement("div").focus({get preventScroll(){return pv=!0,!0}})}catch{}}return pv}function fde(t){let e=t.parentNode,r=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),r}function pde(t){for(let{element:e,scrollTop:r,scrollLeft:n}of t)e.scrollTop=r,e.scrollLeft=n}function Tw(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let r=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(r)&&r.some(n=>t.test(n.brand))||t.test(window.navigator.userAgent)}function az(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function $m(t){let e=null;return()=>(e==null&&(e=t()),e)}const o2=$m(function(){return az(/^Mac/i)}),mde=$m(function(){return az(/^iPad/i)||o2()&&navigator.maxTouchPoints>1}),gde=$m(function(){return Tw(/AppleWebKit/i)&&!xde()}),xde=$m(function(){return Tw(/Chrome/i)}),bde=$m(function(){return Tw(/Android/i)}),yde=$m(function(){return Tw(/Firefox/i)});function Hx(t,e,r=!0){var n,i;let{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}=e;yde()&&(!((i=window.event)===null||i===void 0||(n=i.type)===null||n===void 0)&&n.startsWith("key"))&&t.target==="_blank"&&(o2()?a=!0:o=!0);let u=gde()&&o2()&&!mde()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:l,shiftKey:c}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:l,shiftKey:c,detail:1,bubbles:!0,cancelable:!0});Hx.isOpening=r,ude(t),t.dispatchEvent(u),Hx.isOpening=!1}Hx.isOpening=!1;function oz(){let t=b.useRef(new Map),e=b.useCallback((i,a,o,l)=>{let c=l?.once?(...u)=>{t.current.delete(o),o(...u)}:o;t.current.set(o,{type:a,eventTarget:i,fn:c,options:l}),i.addEventListener(a,c,l)},[]),r=b.useCallback((i,a,o,l)=>{var c;let u=((c=t.current.get(o))===null||c===void 0?void 0:c.fn)||o;i.removeEventListener(a,u,l),t.current.delete(o)},[]),n=b.useCallback(()=>{t.current.forEach((i,a)=>{r(i.eventTarget,i.type,a,i.options)})},[r]);return b.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function vde(t){return t.pointerType===""&&t.isTrusted?!0:bde()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function lz(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function wde(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function cz(t){let e=b.useRef({isFocused:!1,observer:null});return ode(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]),b.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=r.target,i=a=>{if(e.current.isFocused=!1,n.disabled){let o=lz(a);t?.(o)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let o=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let jde=!1,Mb=null,hS=new Set,Cx=new Map,f0=!1,fS=!1;const Nde={Tab:!0,Escape:!0};function eC(t,e){for(let r of hS)r(t,e)}function kde(t){return!(t.metaKey||!o2()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function l2(t){f0=!0,!Hx.isOpening&&kde(t)&&(Mb="keyboard",eC("keyboard",t))}function tm(t){Mb="pointer","pointerType"in t&&t.pointerType,(t.type==="mousedown"||t.type==="pointerdown")&&(f0=!0,eC("pointer",t))}function dz(t){!Hx.isOpening&&vde(t)&&(f0=!0,Mb="virtual")}function uz(t){t.target===window||t.target===document||jde||!t.isTrusted||(!f0&&!fS&&(Mb="virtual",eC("virtual",t)),f0=!1,fS=!1)}function hz(){f0=!1,fS=!0}function pS(t){if(typeof window>"u"||typeof document>"u"||Cx.get(Gf(t)))return;const e=Gf(t),r=uf(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){f0=!0,n.apply(this,arguments)},r.addEventListener("keydown",l2,!0),r.addEventListener("keyup",l2,!0),r.addEventListener("click",dz,!0),e.addEventListener("focus",uz,!0),e.addEventListener("blur",hz,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",tm,!0),r.addEventListener("pointermove",tm,!0),r.addEventListener("pointerup",tm,!0)),e.addEventListener("beforeunload",()=>{fz(t)},{once:!0}),Cx.set(e,{focus:n})}const fz=(t,e)=>{const r=Gf(t),n=uf(t);e&&n.removeEventListener("DOMContentLoaded",e),Cx.has(r)&&(r.HTMLElement.prototype.focus=Cx.get(r).focus,n.removeEventListener("keydown",l2,!0),n.removeEventListener("keyup",l2,!0),n.removeEventListener("click",dz,!0),r.removeEventListener("focus",uz,!0),r.removeEventListener("blur",hz,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",tm,!0),n.removeEventListener("pointermove",tm,!0),n.removeEventListener("pointerup",tm,!0)),Cx.delete(r))};function Sde(t){const e=uf(t);let r;return e.readyState!=="loading"?pS(t):(r=()=>{pS(t)},e.addEventListener("DOMContentLoaded",r)),()=>fz(t,r)}typeof document<"u"&&Sde();function pz(){return Mb!=="pointer"}const _de=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Cde(t,e,r){let n=uf(r?.target);const i=typeof window<"u"?Gf(r?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?Gf(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Gf(r?.target).HTMLElement:HTMLElement,l=typeof window<"u"?Gf(r?.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof i&&!_de.has(n.activeElement.type)||n.activeElement instanceof a||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof l&&!Nde[r.key])}function Ade(t,e,r){pS(),b.useEffect(()=>{let n=(i,a)=>{Cde(!!r?.isTextInput,i,a)&&t(pz())};return hS.add(n),()=>{hS.delete(n)}},e)}function Ede(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:i}=t;const a=b.useCallback(c=>{if(c.target===c.currentTarget)return n&&n(c),i&&i(!1),!0},[n,i]),o=cz(a),l=b.useCallback(c=>{const u=uf(c.target),f=u?uS(u):uS();c.target===c.currentTarget&&f===sz(c.nativeEvent)&&(r&&r(c),i&&i(!0),o(c))},[i,r,o]);return{focusProps:{onFocus:!e&&(r||i||n)?l:void 0,onBlur:!e&&(n||i)?a:void 0}}}function Tde(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:i}=t,a=b.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:l}=oz(),c=b.useCallback(p=>{p.currentTarget.contains(p.target)&&a.current.isFocusWithin&&!p.currentTarget.contains(p.relatedTarget)&&(a.current.isFocusWithin=!1,l(),r&&r(p),i&&i(!1))},[r,i,a,l]),u=cz(c),f=b.useCallback(p=>{if(!p.currentTarget.contains(p.target))return;const x=uf(p.target),m=uS(x);if(!a.current.isFocusWithin&&m===sz(p.nativeEvent)){n&&n(p),i&&i(!0),a.current.isFocusWithin=!0,u(p);let y=p.currentTarget;o(x,"focus",v=>{if(a.current.isFocusWithin&&!nz(y,v.target)){let j=new x.defaultView.FocusEvent("blur",{relatedTarget:v.target});wde(j,y);let N=lz(j);c(N)}},{capture:!0})}},[n,i,u,o,c]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:f,onBlur:c}}}let mS=!1,mv=0;function Lde(){mS=!0,setTimeout(()=>{mS=!1},50)}function pO(t){t.pointerType==="touch"&&Lde()}function Ode(){if(!(typeof document>"u"))return mv===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",pO),mv++,()=>{mv--,!(mv>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",pO)}}function mz(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:i}=t,[a,o]=b.useState(!1),l=b.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;b.useEffect(Ode,[]);let{addGlobalListener:c,removeAllGlobalListeners:u}=oz(),{hoverProps:f,triggerHoverEnd:p}=b.useMemo(()=>{let x=(v,j)=>{if(l.pointerType=j,i||j==="touch"||l.isHovered||!v.currentTarget.contains(v.target))return;l.isHovered=!0;let N=v.currentTarget;l.target=N,c(uf(v.target),"pointerover",C=>{l.isHovered&&l.target&&!nz(l.target,C.target)&&m(C,C.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:N,pointerType:j}),r&&r(!0),o(!0)},m=(v,j)=>{let N=l.target;l.pointerType="",l.target=null,!(j==="touch"||!l.isHovered||!N)&&(l.isHovered=!1,u(),n&&n({type:"hoverend",target:N,pointerType:j}),r&&r(!1),o(!1))},y={};return typeof PointerEvent<"u"&&(y.onPointerEnter=v=>{mS&&v.pointerType==="mouse"||x(v,v.pointerType)},y.onPointerLeave=v=>{!i&&v.currentTarget.contains(v.target)&&m(v,v.pointerType)}),{hoverProps:y,triggerHoverEnd:m}},[e,r,n,i,l,c,u]);return b.useEffect(()=>{i&&p({currentTarget:l.target},l.pointerType)},[i]),{hoverProps:f,isHovered:a}}function gz(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=b.useRef({isFocused:!1,isFocusVisible:e||pz()}),[a,o]=b.useState(!1),[l,c]=b.useState(()=>i.current.isFocused&&i.current.isFocusVisible),u=b.useCallback(()=>c(i.current.isFocused&&i.current.isFocusVisible),[]),f=b.useCallback(m=>{i.current.isFocused=m,o(m),u()},[u]);Ade(m=>{i.current.isFocusVisible=m,u()},[],{isTextInput:r});let{focusProps:p}=Ede({isDisabled:n,onFocusChange:f}),{focusWithinProps:x}=Tde({isDisabled:!n,onFocusWithinChange:f});return{isFocused:a,isFocusVisible:l,focusProps:n?x:p}}var Mde=Object.defineProperty,Pde=(t,e,r)=>e in t?Mde(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,cN=(t,e,r)=>(Pde(t,typeof e!="symbol"?e+"":e,r),r);let Ide=class{constructor(){cN(this,"current",this.detect()),cN(this,"handoffState","pending"),cN(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},wd=new Ide;function T0(t){var e;return wd.isServer?null:t==null?document:(e=t?.ownerDocument)!=null?e:document}function gS(t){var e,r;return wd.isServer?null:t==null?document:(r=(e=t?.getRootNode)==null?void 0:e.call(t))!=null?r:document}function xz(t){var e,r;return(r=(e=gS(t))==null?void 0:e.activeElement)!=null?r:null}function Rde(t){return xz(t)===t}function Lw(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Hu(){let t=[],e={addEventListener(r,n,i,a){return r.addEventListener(n,i,a),e.add(()=>r.removeEventListener(n,i,a))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return Lw(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,i){let a=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:i}),this.add(()=>{Object.assign(r.style,{[n]:a})})},group(r){let n=Hu();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let i of t.splice(n,1))i()}},dispose(){for(let r of t.splice(0))r()}};return e}function L0(){let[t]=b.useState(Hu);return b.useEffect(()=>()=>t.dispose(),[t]),t}let jo=(t,e)=>{wd.isServer?b.useEffect(t,e):b.useLayoutEffect(t,e)};function O0(t){let e=b.useRef(t);return jo(()=>{e.current=t},[t]),e}let Vr=function(t){let e=O0(t);return Ke.useCallback((...r)=>e.current(...r),[e])};function Dde(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function Bde(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function bz({disabled:t=!1}={}){let e=b.useRef(null),[r,n]=b.useState(!1),i=L0(),a=Vr(()=>{e.current=null,n(!1),i.dispose()}),o=Vr(l=>{if(i.dispose(),e.current===null){e.current=l.currentTarget,n(!0);{let c=T0(l.currentTarget);i.addEventListener(c,"pointerup",a,!1),i.addEventListener(c,"pointermove",u=>{if(e.current){let f=Dde(u);n(Bde(f,e.current.getBoundingClientRect()))}},!1),i.addEventListener(c,"pointercancel",a,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:o,onPointerUp:a,onClick:a}}}function Id(t){return b.useMemo(()=>t,Object.values(t))}let $de=b.createContext(void 0);function tC(){return b.useContext($de)}function xS(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function Ql(t,e,...r){if(t in e){let i=e[t];return typeof i=="function"?i(...r):i}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Ql),n}var mm=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(mm||{}),Wh=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(Wh||{});function ka(){let t=Ude();return b.useCallback(e=>Fde({mergeRefs:t,...e}),[t])}function Fde({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:i,visible:a=!0,name:o,mergeRefs:l}){l=l??zde;let c=yz(e,t);if(a)return gv(c,r,n,o,l);let u=i??0;if(u&2){let{static:f=!1,...p}=c;if(f)return gv(p,r,n,o,l)}if(u&1){let{unmount:f=!0,...p}=c;return Ql(f?0:1,{0(){return null},1(){return gv({...p,hidden:!0,style:{display:"none"}},r,n,o,l)}})}return gv(c,r,n,o,l)}function gv(t,e={},r,n,i){let{as:a=r,children:o,refName:l="ref",...c}=dN(t,["unmount","static"]),u=t.ref!==void 0?{[l]:t.ref}:{},f=typeof o=="function"?o(e):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(e)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let p={};if(e){let x=!1,m=[];for(let[y,v]of Object.entries(e))typeof v=="boolean"&&(x=!0),v===!0&&m.push(y.replace(/([A-Z])/g,j=>`-${j.toLowerCase()}`));if(x){p["data-headlessui-state"]=m.join(" ");for(let y of m)p[`data-${y}`]=""}}if(rm(a)&&(Object.keys(Ih(c)).length>0||Object.keys(Ih(p)).length>0))if(!b.isValidElement(f)||Array.isArray(f)&&f.length>1||Hde(f)){if(Object.keys(Ih(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Ih(c)).concat(Object.keys(Ih(p))).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`))}else{let x=f.props,m=x?.className,y=typeof m=="function"?(...N)=>xS(m(...N),c.className):xS(m,c.className),v=y?{className:y}:{},j=yz(f.props,Ih(dN(c,["ref"])));for(let N in p)N in j&&delete p[N];return b.cloneElement(f,Object.assign({},j,p,u,{ref:i(qde(f),u.ref)},v))}return b.createElement(a,Object.assign({},dN(c,["ref"]),!rm(a)&&u,!rm(a)&&p),f)}function Ude(){let t=b.useRef([]),e=b.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function zde(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function yz(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[i=>{var a;return(a=i?.preventDefault)==null?void 0:a.call(i)}]);for(let n in r)Object.assign(e,{[n](i,...a){let o=r[n];for(let l of o){if((i instanceof Event||i?.nativeEvent instanceof Event)&&i.defaultPrevented)return;l(i,...a)}}});return e}function bS(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];for(let n in r)Object.assign(e,{[n](...i){let a=r[n];for(let o of a)o?.(...i)}});return e}function ra(t){var e;return Object.assign(b.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Ih(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function dN(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function qde(t){return Ke.version.split(".")[0]>="19"?t.props.ref:t.ref}function rm(t){return t===b.Fragment||t===Symbol.for("react.fragment")}function Hde(t){return rm(t.type)}function Wde(t,e,r){let[n,i]=b.useState(r),a=t!==void 0,o=b.useRef(a),l=b.useRef(!1),c=b.useRef(!1);return a&&!o.current&&!l.current?(l.current=!0,o.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&o.current&&!c.current&&(c.current=!0,o.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?t:n,Vr(u=>(a||Gn.flushSync(()=>i(u)),e?.(u)))]}function Gde(t){let[e]=b.useState(t);return e}function vz(t={},e=null,r=[]){for(let[n,i]of Object.entries(t))jz(r,wz(e,n),i);return r}function wz(t,e){return t?t+"["+e+"]":e}function jz(t,e,r){if(Array.isArray(r))for(let[n,i]of r.entries())jz(t,wz(e,n.toString()),i);else r instanceof Date?t.push([e,r.toISOString()]):typeof r=="boolean"?t.push([e,r?"1":"0"]):typeof r=="string"?t.push([e,r]):typeof r=="number"?t.push([e,`${r}`]):r==null?t.push([e,""]):Yde(r)&&!b.isValidElement(r)&&vz(r,e,t)}function Vde(t){var e,r;let n=(e=t?.form)!=null?e:t.closest("form");if(n){for(let i of n.elements)if(i!==t&&(i.tagName==="INPUT"&&i.type==="submit"||i.tagName==="BUTTON"&&i.type==="submit"||i.nodeName==="INPUT"&&i.type==="image")){i.click();return}(r=n.requestSubmit)==null||r.call(n)}}function Yde(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}let Kde="span";var gm=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(gm||{});function Xde(t,e){var r;let{features:n=1,...i}=t,a={ref:e,"aria-hidden":(n&2)===2?!0:(r=i["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ka()({ourProps:a,theirProps:i,slot:{},defaultTag:Kde,name:"Hidden"})}let Wx=ra(Xde),Jde=b.createContext(null);function Zde({children:t}){let e=b.useContext(Jde);if(!e)return Ke.createElement(Ke.Fragment,null,t);let{target:r}=e;return r?Gn.createPortal(Ke.createElement(Ke.Fragment,null,t),r):null}function Qde({data:t,form:e,disabled:r,onReset:n,overrides:i}){let[a,o]=b.useState(null),l=L0();return b.useEffect(()=>{if(n&&a)return l.addEventListener(a,"reset",n)},[a,e,n]),Ke.createElement(Zde,null,Ke.createElement(eue,{setForm:o,formId:e}),vz(t).map(([c,u])=>Ke.createElement(Wx,{features:gm.Hidden,...Ih({key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:e,disabled:r,name:c,value:u,...i})})))}function eue({setForm:t,formId:e}){return b.useEffect(()=>{if(e){let r=document.getElementById(e);r&&t(r)}},[t,e]),e?null:Ke.createElement(Wx,{features:gm.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:r=>{if(!r)return;let n=r.closest("form");n&&t(n)}})}let tue=b.createContext(void 0);function Nz(){return b.useContext(tue)}function rue(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function Nu(t){return rue(t)&&"tagName"in t}function Cd(t){return Nu(t)&&"accessKey"in t}function md(t){return Nu(t)&&"tabIndex"in t}function nue(t){return Nu(t)&&"style"in t}function sue(t){return Cd(t)&&t.nodeName==="IFRAME"}function kz(t){return Cd(t)&&t.nodeName==="INPUT"}function yS(t){return Cd(t)&&t.nodeName==="LABEL"}function iue(t){return Cd(t)&&t.nodeName==="FIELDSET"}function Sz(t){return Cd(t)&&t.nodeName==="LEGEND"}function aue(t){return Nu(t)?t.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function _z(t){let e=t.parentElement,r=null;for(;e&&!iue(e);)Sz(e)&&(r=e),e=e.parentElement;let n=e?.getAttribute("disabled")==="";return n&&oue(r)?!1:n}function oue(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(Sz(e))return!1;e=e.previousElementSibling}return!0}let Cz=Symbol();function Az(t,e=!0){return Object.assign(t,{[Cz]:e})}function Oo(...t){let e=b.useRef(t);b.useEffect(()=>{e.current=t},[t]);let r=Vr(n=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(n):i.current=n)});return t.every(n=>n==null||n?.[Cz])?void 0:r}let Ow=b.createContext(null);Ow.displayName="DescriptionContext";function Ez(){let t=b.useContext(Ow);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Ez),e}return t}function lue(){var t,e;return(e=(t=b.useContext(Ow))==null?void 0:t.value)!=null?e:void 0}function Tz(){let[t,e]=b.useState([]);return[t.length>0?t.join(" "):void 0,b.useMemo(()=>function(r){let n=Vr(a=>(e(o=>[...o,a]),()=>e(o=>{let l=o.slice(),c=l.indexOf(a);return c!==-1&&l.splice(c,1),l}))),i=b.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props,value:r.value}),[n,r.slot,r.name,r.props,r.value]);return Ke.createElement(Ow.Provider,{value:i},r.children)},[e])]}let cue="p";function due(t,e){let r=b.useId(),n=tC(),{id:i=`headlessui-description-${r}`,...a}=t,o=Ez(),l=Oo(e);jo(()=>o.register(i),[i,o.register]);let c=Id({...o.slot,disabled:n||!1}),u={ref:l,...o.props,id:i};return ka()({ourProps:u,theirProps:a,slot:c,defaultTag:cue,name:o.name||"Description"})}let uue=ra(due),Lz=Object.assign(uue,{});var fu=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(fu||{});let Mw=b.createContext(null);Mw.displayName="LabelContext";function Oz(){let t=b.useContext(Mw);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Oz),e}return t}function Mz(t){var e,r,n;let i=(r=(e=b.useContext(Mw))==null?void 0:e.value)!=null?r:void 0;return((n=void 0)!=null?n:0)>0?[i,...t].filter(Boolean).join(" "):i}function hue({inherit:t=!1}={}){let e=Mz(),[r,n]=b.useState([]),i=t?[e,...r].filter(Boolean):r;return[i.length>0?i.join(" "):void 0,b.useMemo(()=>function(a){let o=Vr(c=>(n(u=>[...u,c]),()=>n(u=>{let f=u.slice(),p=f.indexOf(c);return p!==-1&&f.splice(p,1),f}))),l=b.useMemo(()=>({register:o,slot:a.slot,name:a.name,props:a.props,value:a.value}),[o,a.slot,a.name,a.props,a.value]);return Ke.createElement(Mw.Provider,{value:l},a.children)},[n])]}let fue="label";function pue(t,e){var r;let n=b.useId(),i=Oz(),a=Nz(),o=tC(),{id:l=`headlessui-label-${n}`,htmlFor:c=a??((r=i.props)==null?void 0:r.htmlFor),passive:u=!1,...f}=t,p=Oo(e);jo(()=>i.register(l),[l,i.register]);let x=Vr(v=>{let j=v.currentTarget;if(!(v.target!==v.currentTarget&&aue(v.target))&&(yS(j)&&v.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(v),yS(j))){let N=document.getElementById(j.htmlFor);if(N){let C=N.getAttribute("disabled");if(C==="true"||C==="")return;let A=N.getAttribute("aria-disabled");if(A==="true"||A==="")return;(kz(N)&&(N.type==="file"||N.type==="radio"||N.type==="checkbox")||N.role==="radio"||N.role==="checkbox"||N.role==="switch")&&N.click(),N.focus({preventScroll:!0})}}}),m=Id({...i.slot,disabled:o||!1}),y={ref:p,...i.props,id:l,htmlFor:c,onClick:x};return u&&("onClick"in y&&(delete y.htmlFor,delete y.onClick),"onClick"in f&&delete f.onClick),ka()({ourProps:y,theirProps:f,slot:m,defaultTag:c?fue:"div",name:i.name||"Label"})}let mue=ra(pue),gue=Object.assign(mue,{}),xue=b.createContext(()=>{});function Pz({value:t,children:e}){return Ke.createElement(xue.Provider,{value:t},e)}let Iz=class extends Map{constructor(e){super(),this.factory=e}get(e){let r=super.get(e);return r===void 0&&(r=this.factory(e),this.set(e,r)),r}};var bue=Object.defineProperty,yue=(t,e,r)=>e in t?bue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vue=(t,e,r)=>(yue(t,e+"",r),r),Rz=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Fl=(t,e,r)=>(Rz(t,e,"read from private field"),r?r.call(t):e.get(t)),uN=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},mO=(t,e,r,n)=>(Rz(t,e,"write to private field"),e.set(t,r),r),dd,lx,cx;let wue=class{constructor(e){uN(this,dd,{}),uN(this,lx,new Iz(()=>new Set)),uN(this,cx,new Set),vue(this,"disposables",Hu()),mO(this,dd,e),wd.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return Fl(this,dd)}subscribe(e,r){if(wd.isServer)return()=>{};let n={selector:e,callback:r,current:e(Fl(this,dd))};return Fl(this,cx).add(n),this.disposables.add(()=>{Fl(this,cx).delete(n)})}on(e,r){return wd.isServer?()=>{}:(Fl(this,lx).get(e).add(r),this.disposables.add(()=>{Fl(this,lx).get(e).delete(r)}))}send(e){let r=this.reduce(Fl(this,dd),e);if(r!==Fl(this,dd)){mO(this,dd,r);for(let n of Fl(this,cx)){let i=n.selector(Fl(this,dd));Dz(n.current,i)||(n.current=i,n.callback(i))}for(let n of Fl(this,lx).get(e.type))n(Fl(this,dd),e)}}};dd=new WeakMap,lx=new WeakMap,cx=new WeakMap;function Dz(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:hN(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:hN(t.entries(),e.entries()):gO(t)&&gO(e)?hN(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function hN(t,e){do{let r=t.next(),n=e.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}while(!0)}function gO(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var jue=Object.defineProperty,Nue=(t,e,r)=>e in t?jue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xO=(t,e,r)=>(Nue(t,typeof e!="symbol"?e+"":e,r),r),kue=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(kue||{});let Sue={0(t,e){let r=e.id,n=t.stack,i=t.stack.indexOf(r);if(i!==-1){let a=t.stack.slice();return a.splice(i,1),a.push(r),n=a,{...t,stack:n}}return{...t,stack:[...t.stack,r]}},1(t,e){let r=e.id,n=t.stack.indexOf(r);if(n===-1)return t;let i=t.stack.slice();return i.splice(n,1),{...t,stack:i}}},_ue=class Bz extends wue{constructor(){super(...arguments),xO(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),xO(this,"selectors",{isTop:(e,r)=>e.stack[e.stack.length-1]===r,inStack:(e,r)=>e.stack.includes(r)})}static new(){return new Bz({stack:[]})}reduce(e,r){return Ql(r.type,Sue,e,r)}};const $z=new Iz(()=>_ue.new());var fN={exports:{}},pN={};var bO;function Cue(){if(bO)return pN;bO=1;var t=Fu();function e(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,o=t.useMemo,l=t.useDebugValue;return pN.useSyncExternalStoreWithSelector=function(c,u,f,p,x){var m=i(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=o(function(){function j(O){if(!N){if(N=!0,C=O,O=p(O),x!==void 0&&y.hasValue){var F=y.value;if(x(F,O))return A=F}return A=O}if(F=A,r(C,O))return F;var T=p(O);return x!==void 0&&x(F,T)?(C=O,F):(C=O,A=T)}var N=!1,C,A,L=f===void 0?null:f;return[function(){return j(u())},L===null?void 0:function(){return j(L())}]},[u,f,p,x]);var v=n(c,m[0],m[1]);return a(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},pN}var yO;function Aue(){return yO||(yO=1,fN.exports=Cue()),fN.exports}var Eue=Aue();function Fz(t,e,r=Dz){return Eue.useSyncExternalStoreWithSelector(Vr(n=>t.subscribe(Tue,n)),Vr(()=>t.state),Vr(()=>t.state),Vr(e),r)}function Tue(t){return t}function Pb(t,e){let r=b.useId(),n=$z.get(e),[i,a]=Fz(n,b.useCallback(o=>[n.selectors.isTop(o,r),n.selectors.inStack(o,r)],[n,r]));return jo(()=>{if(t)return n.actions.push(r),()=>n.actions.pop(r)},[n,t,r]),t?a?i:!0:!1}let vS=new Map,Ax=new Map;function vO(t){var e;let r=(e=Ax.get(t))!=null?e:0;return Ax.set(t,r+1),r!==0?()=>wO(t):(vS.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>wO(t))}function wO(t){var e;let r=(e=Ax.get(t))!=null?e:1;if(r===1?Ax.delete(t):Ax.set(t,r-1),r!==1)return;let n=vS.get(t);n&&(n["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",n["aria-hidden"]),t.inert=n.inert,vS.delete(t))}function Lue(t,{allowed:e,disallowed:r}={}){let n=Pb(t,"inert-others");jo(()=>{var i,a;if(!n)return;let o=Hu();for(let c of(i=r?.())!=null?i:[])c&&o.add(vO(c));let l=(a=e?.())!=null?a:[];for(let c of l){if(!c)continue;let u=T0(c);if(!u)continue;let f=c.parentElement;for(;f&&f!==u.body;){for(let p of f.children)l.some(x=>p.contains(x))||o.add(vO(p));f=f.parentElement}}return o.dispose},[n,e,r])}function Oue(t,e,r){let n=O0(i=>{let a=i.getBoundingClientRect();a.x===0&&a.y===0&&a.width===0&&a.height===0&&r()});b.useEffect(()=>{if(!t)return;let i=e===null?null:Cd(e)?e:e.current;if(!i)return;let a=Hu();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>n.current(i));o.observe(i),a.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>n.current(i));o.observe(i),a.add(()=>o.disconnect())}return()=>a.dispose()},[e,n,t])}let c2=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),Mue=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var pu=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(pu||{}),wS=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(wS||{}),Pue=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(Pue||{});function Iue(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(c2)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function Rue(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Mue)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Uz=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(Uz||{});function Due(t,e=0){var r;return t===((r=T0(t))==null?void 0:r.body)?!1:Ql(e,{0(){return t.matches(c2)},1(){let n=t;for(;n!==null;){if(n.matches(c2))return!0;n=n.parentElement}return!1}})}var Bue=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(Bue||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function ku(t){t?.focus({preventScroll:!0})}let $ue=["textarea","input"].join(",");function Fue(t){var e,r;return(r=(e=t?.matches)==null?void 0:e.call(t,$ue))!=null?r:!1}function Uue(t,e=r=>r){return t.slice().sort((r,n)=>{let i=e(r),a=e(n);if(i===null||a===null)return 0;let o=i.compareDocumentPosition(a);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ex(t,e,{sorted:r=!0,relativeTo:n=null,skipElements:i=[]}={}){let a=Array.isArray(t)?t.length>0?gS(t[0]):document:gS(t),o=Array.isArray(t)?r?Uue(t):t:e&64?Rue(t):Iue(t);i.length>0&&o.length>1&&(o=o.filter(m=>!i.some(y=>y!=null&&"current"in y?y?.current===m:y===m))),n=n??a?.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(n))-1;if(e&4)return Math.max(0,o.indexOf(n))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},f=0,p=o.length,x;do{if(f>=p||f+p<=0)return 0;let m=c+f;if(e&16)m=(m+p)%p;else{if(m<0)return 3;if(m>=p)return 1}x=o[m],x?.focus(u),f+=l}while(x!==xz(x));return e&6&&Fue(x)&&x.select(),2}function zz(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function zue(){return/Android/gi.test(window.navigator.userAgent)}function jO(){return zz()||zue()}function xv(t,e,r,n){let i=O0(r);b.useEffect(()=>{if(!t)return;function a(o){i.current(o)}return document.addEventListener(e,a,n),()=>document.removeEventListener(e,a,n)},[t,e,n])}function qz(t,e,r,n){let i=O0(r);b.useEffect(()=>{if(!t)return;function a(o){i.current(o)}return window.addEventListener(e,a,n),()=>window.removeEventListener(e,a,n)},[t,e,n])}const NO=30;function que(t,e,r){let n=O0(r),i=b.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let f=(function p(x){return typeof x=="function"?p(x()):Array.isArray(x)||x instanceof Set?x:[x]})(e);for(let p of f)if(p!==null&&(p.contains(u)||l.composed&&l.composedPath().includes(p)))return;return!Due(u,Uz.Loose)&&u.tabIndex!==-1&&l.preventDefault(),n.current(l,u)},[n,e]),a=b.useRef(null);xv(t,"pointerdown",l=>{var c,u;jO()||(a.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),xv(t,"pointerup",l=>{if(jO()||!a.current)return;let c=a.current;return a.current=null,i(l,()=>c)},!0);let o=b.useRef({x:0,y:0});xv(t,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),xv(t,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=NO||Math.abs(c.y-o.current.y)>=NO))return i(l,()=>md(l.target)?l.target:null)},!0),qz(t,"blur",l=>i(l,()=>sue(window.document.activeElement)?window.document.activeElement:null),!0)}function rC(...t){return b.useMemo(()=>T0(...t),[...t])}function Hz(t,e,r,n){let i=O0(r);b.useEffect(()=>{t=t??window;function a(o){i.current(o)}return t.addEventListener(e,a,n),()=>t.removeEventListener(e,a,n)},[t,e,n])}function Wz(t,e){return b.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||e?.tagName==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function Hue(t){return b.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function Wue(t,e){let r=t(),n=new Set;return{getSnapshot(){return r},subscribe(i){return n.add(i),()=>n.delete(i)},dispatch(i,...a){let o=e[i].call(r,...a);o&&(r=o,n.forEach(l=>l()))}}}function Gue(){let t;return{before({doc:e}){var r;let n=e.documentElement,i=(r=e.defaultView)!=null?r:window;t=Math.max(0,i.innerWidth-n.clientWidth)},after({doc:e,d:r}){let n=e.documentElement,i=Math.max(0,n.clientWidth-n.offsetWidth),a=Math.max(0,t-i);r.style(n,"paddingRight",`${a}px`)}}}function Vue(){return zz()?{before({doc:t,d:e,meta:r}){function n(i){for(let a of r().containers)for(let o of a())if(o.contains(i))return!0;return!1}e.microTask(()=>{var i;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let l=Hu();l.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let a=(i=window.scrollY)!=null?i:window.pageYOffset,o=null;e.addEventListener(t,"click",l=>{if(md(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),f=t.querySelector(u);md(f)&&!n(f)&&(o=f)}catch{}},!0),e.group(l=>{e.addEventListener(t,"touchstart",c=>{if(l.dispose(),md(c.target)&&nue(c.target))if(n(c.target)){let u=c.target;for(;u.parentElement&&n(u.parentElement);)u=u.parentElement;l.style(u,"overscrollBehavior","contain")}else l.style(c.target,"touchAction","none")})}),e.addEventListener(t,"touchmove",l=>{if(md(l.target)){if(kz(l.target))return;if(n(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;a!==c&&window.scrollTo(0,a),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function Yue(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function kO(t){let e={};for(let r of t)Object.assign(e,r(e));return e}let Vf=Wue(()=>new Map,{PUSH(t,e){var r;let n=(r=this.get(t))!=null?r:{doc:t,count:0,d:Hu(),meta:new Set,computedMeta:{}};return n.count++,n.meta.add(e),n.computedMeta=kO(n.meta),this.set(t,n),this},POP(t,e){let r=this.get(t);return r&&(r.count--,r.meta.delete(e),r.computedMeta=kO(r.meta)),this},SCROLL_PREVENT(t){let e={doc:t.doc,d:t.d,meta(){return t.computedMeta}},r=[Vue(),Gue(),Yue()];r.forEach(({before:n})=>n?.(e)),r.forEach(({after:n})=>n?.(e))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});Vf.subscribe(()=>{let t=Vf.getSnapshot(),e=new Map;for(let[r]of t)e.set(r,r.documentElement.style.overflow);for(let r of t.values()){let n=e.get(r.doc)==="hidden",i=r.count!==0;(i&&!n||!i&&n)&&Vf.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Vf.dispatch("TEARDOWN",r)}});function Kue(t,e,r=()=>({containers:[]})){let n=Hue(Vf),i=e?n.get(e):void 0,a=i?i.count>0:!1;return jo(()=>{if(!(!e||!t))return Vf.dispatch("PUSH",e,r),()=>Vf.dispatch("POP",e,r)},[t,e]),a}function Xue(t,e,r=()=>[document.body]){let n=Pb(t,"scroll-lock");Kue(n,e,i=>{var a;return{containers:[...(a=i.containers)!=null?a:[],r]}})}function Jue(t=0){let[e,r]=b.useState(t),n=b.useCallback(c=>r(c),[]),i=b.useCallback(c=>r(u=>u|c),[]),a=b.useCallback(c=>(e&c)===c,[e]),o=b.useCallback(c=>r(u=>u&~c),[]),l=b.useCallback(c=>r(u=>u^c),[]);return{flags:e,setFlag:n,addFlag:i,hasFlag:a,removeFlag:o,toggleFlag:l}}var Zue={},SO,_O;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((SO=process==null?void 0:Zue)==null?void 0:SO.NODE_ENV)==="test"&&typeof((_O=Element?.prototype)==null?void 0:_O.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Que=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(Que||{});function Gz(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function Vz(t,e,r,n){let[i,a]=b.useState(r),{hasFlag:o,addFlag:l,removeFlag:c}=Jue(t&&i?3:0),u=b.useRef(!1),f=b.useRef(!1),p=L0();return jo(()=>{var x;if(t){if(r&&a(!0),!e){r&&l(3);return}return(x=n?.start)==null||x.call(n,r),ehe(e,{inFlight:u,prepare(){f.current?f.current=!1:f.current=u.current,u.current=!0,!f.current&&(r?(l(3),c(4)):(l(4),c(2)))},run(){f.current?r?(c(3),l(4)):(c(4),l(3)):r?c(1):l(1)},done(){var m;f.current&&nhe(e)||(u.current=!1,c(7),r||a(!1),(m=n?.end)==null||m.call(n,r))}})}},[t,r,e,p]),t?[i,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function ehe(t,{prepare:e,run:r,done:n,inFlight:i}){let a=Hu();return rhe(t,{prepare:e,inFlight:i}),a.nextFrame(()=>{r(),a.requestAnimationFrame(()=>{a.add(the(t,n))})}),a.dispose}function the(t,e){var r,n;let i=Hu();if(!t)return i.dispose;let a=!1;i.add(()=>{a=!0});let o=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(l=>l instanceof CSSTransition))!=null?n:[];return o.length===0?(e(),i.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{a||e()}),i.dispose)}function rhe(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function nhe(t){var e,r;return((r=(e=t.getAnimations)==null?void 0:e.call(t))!=null?r:[]).some(n=>n instanceof CSSTransition&&n.playState!=="finished")}function nC(t,e){let r=b.useRef([]),n=Vr(t);b.useEffect(()=>{let i=[...r.current];for(let[a,o]of e.entries())if(r.current[a]!==o){let l=n(e,i);return r.current=e,l}},[n,...e])}let Pw=b.createContext(null);Pw.displayName="OpenClosedContext";var vo=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(vo||{});function Ib(){return b.useContext(Pw)}function Yz({value:t,children:e}){return Ke.createElement(Pw.Provider,{value:t},e)}function Kz({children:t}){return Ke.createElement(Pw.Provider,{value:null},t)}function she(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let Uh=[];she(()=>{function t(e){if(!md(e.target)||e.target===document.body||Uh[0]===e.target)return;let r=e.target;r=r.closest(c2),Uh.unshift(r??e.target),Uh=Uh.filter(n=>n!=null&&n.isConnected),Uh.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function Xz(t){let e=Vr(t),r=b.useRef(!1);b.useEffect(()=>(r.current=!1,()=>{r.current=!0,Lw(()=>{r.current&&e()})}),[e])}let Jz=b.createContext(!1);function ihe(){return b.useContext(Jz)}function CO(t){return Ke.createElement(Jz.Provider,{value:t.force},t.children)}function ahe(t){let e=ihe(),r=b.useContext(Qz),[n,i]=b.useState(()=>{var a;if(!e&&r!==null)return(a=r.current)!=null?a:null;if(wd.isServer)return null;let o=t?.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)});return b.useEffect(()=>{n!==null&&(t!=null&&t.body.contains(n)||t==null||t.body.appendChild(n))},[n,t]),b.useEffect(()=>{e||r!==null&&i(r.current)},[r,i,e]),n}let Zz=b.Fragment,ohe=ra(function(t,e){let{ownerDocument:r=null,...n}=t,i=b.useRef(null),a=Oo(Az(x=>{i.current=x}),e),o=rC(i.current),l=r??o,c=ahe(l),u=b.useContext(jS),f=L0(),p=ka();return Xz(()=>{var x;c&&c.childNodes.length<=0&&((x=c.parentElement)==null||x.removeChild(c))}),c?Gn.createPortal(Ke.createElement("div",{"data-headlessui-portal":"",ref:x=>{f.dispose(),u&&x&&f.add(u.register(x))}},p({ourProps:{ref:a},theirProps:n,slot:{},defaultTag:Zz,name:"Portal"})),c):null});function lhe(t,e){let r=Oo(e),{enabled:n=!0,ownerDocument:i,...a}=t,o=ka();return n?Ke.createElement(ohe,{...a,ownerDocument:i,ref:r}):o({ourProps:{ref:r},theirProps:a,slot:{},defaultTag:Zz,name:"Portal"})}let che=b.Fragment,Qz=b.createContext(null);function dhe(t,e){let{target:r,...n}=t,i={ref:Oo(e)},a=ka();return Ke.createElement(Qz.Provider,{value:r},a({ourProps:i,theirProps:n,defaultTag:che,name:"Popover.Group"}))}let jS=b.createContext(null);function uhe(){let t=b.useContext(jS),e=b.useRef([]),r=Vr(a=>(e.current.push(a),t&&t.register(a),()=>n(a))),n=Vr(a=>{let o=e.current.indexOf(a);o!==-1&&e.current.splice(o,1),t&&t.unregister(a)}),i=b.useMemo(()=>({register:r,unregister:n,portals:e}),[r,n,e]);return[e,b.useMemo(()=>function({children:a}){return Ke.createElement(jS.Provider,{value:i},a)},[i])]}let hhe=ra(lhe),eq=ra(dhe),fhe=Object.assign(hhe,{Group:eq});function phe(t,e=typeof document<"u"?document.defaultView:null,r){let n=Pb(t,"escape");Hz(e,"keydown",i=>{n&&(i.defaultPrevented||i.key===fu.Escape&&r(i))})}function mhe(){var t;let[e]=b.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[r,n]=b.useState((t=e?.matches)!=null?t:!1);return jo(()=>{if(!e)return;function i(a){n(a.matches)}return e.addEventListener("change",i),()=>e.removeEventListener("change",i)},[e]),r}function ghe({defaultContainers:t=[],portals:e,mainTreeNode:r}={}){let n=Vr(()=>{var i,a;let o=T0(r),l=[];for(let c of t)c!==null&&(Nu(c)?l.push(c):"current"in c&&Nu(c.current)&&l.push(c.current));if(e!=null&&e.current)for(let c of e.current)l.push(c);for(let c of(i=o?.querySelectorAll("html > *, body > *"))!=null?i:[])c!==document.body&&c!==document.head&&Nu(c)&&c.id!=="headlessui-portal-root"&&(r&&(c.contains(r)||c.contains((a=r?.getRootNode())==null?void 0:a.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:n,contains:Vr(i=>n().some(a=>a.contains(i)))}}let tq=b.createContext(null);function AO({children:t,node:e}){let[r,n]=b.useState(null),i=rq(e??r);return Ke.createElement(tq.Provider,{value:i},t,i===null&&Ke.createElement(Wx,{features:gm.Hidden,ref:a=>{var o,l;if(a){for(let c of(l=(o=T0(a))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&Nu(c)&&c!=null&&c.contains(a)){n(c);break}}}}))}function rq(t=null){var e;return(e=b.useContext(tq))!=null?e:t}function xhe(){let t=typeof document>"u";return"useSyncExternalStore"in R3?(e=>e.useSyncExternalStore)(R3)(()=>()=>{},()=>!1,()=>!t):!1}function Iw(){let t=xhe(),[e,r]=b.useState(wd.isHandoffComplete);return e&&wd.isHandoffComplete===!1&&r(!1),b.useEffect(()=>{e!==!0&&r(!0)},[e]),b.useEffect(()=>wd.handoff(),[]),t?!1:e}function sC(){let t=b.useRef(!1);return jo(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var dx=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(dx||{});function bhe(){let t=b.useRef(0);return qz(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function nq(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let r of t.current)Nu(r.current)&&e.add(r.current);return e}let yhe="div";var zf=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(zf||{});function vhe(t,e){let r=b.useRef(null),n=Oo(r,e),{initialFocus:i,initialFocusFallback:a,containers:o,features:l=15,...c}=t;Iw()||(l=0);let u=rC(r.current);khe(l,{ownerDocument:u});let f=She(l,{ownerDocument:u,container:r,initialFocus:i,initialFocusFallback:a});_he(l,{ownerDocument:u,container:r,containers:o,previousActiveElement:f});let p=bhe(),x=Vr(C=>{if(!Cd(r.current))return;let A=r.current;(L=>L())(()=>{Ql(p.current,{[dx.Forwards]:()=>{Ex(A,pu.First,{skipElements:[C.relatedTarget,a]})},[dx.Backwards]:()=>{Ex(A,pu.Last,{skipElements:[C.relatedTarget,a]})}})})}),m=Pb(!!(l&2),"focus-trap#tab-lock"),y=L0(),v=b.useRef(!1),j={ref:n,onKeyDown(C){C.key=="Tab"&&(v.current=!0,y.requestAnimationFrame(()=>{v.current=!1}))},onBlur(C){if(!(l&4))return;let A=nq(o);Cd(r.current)&&A.add(r.current);let L=C.relatedTarget;md(L)&&L.dataset.headlessuiFocusGuard!=="true"&&(sq(A,L)||(v.current?Ex(r.current,Ql(p.current,{[dx.Forwards]:()=>pu.Next,[dx.Backwards]:()=>pu.Previous})|pu.WrapAround,{relativeTo:C.target}):md(C.target)&&ku(C.target)))}},N=ka();return Ke.createElement(Ke.Fragment,null,m&&Ke.createElement(Wx,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:x,features:gm.Focusable}),N({ourProps:j,theirProps:c,defaultTag:yhe,name:"FocusTrap"}),m&&Ke.createElement(Wx,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:x,features:gm.Focusable}))}let whe=ra(vhe),jhe=Object.assign(whe,{features:zf});function Nhe(t=!0){let e=b.useRef(Uh.slice());return nC(([r],[n])=>{n===!0&&r===!1&&Lw(()=>{e.current.splice(0)}),n===!1&&r===!0&&(e.current=Uh.slice())},[t,Uh,e]),Vr(()=>{var r;return(r=e.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function khe(t,{ownerDocument:e}){let r=!!(t&8),n=Nhe(r);nC(()=>{r||Rde(e?.body)&&ku(n())},[r]),Xz(()=>{r&&ku(n())})}function She(t,{ownerDocument:e,container:r,initialFocus:n,initialFocusFallback:i}){let a=b.useRef(null),o=Pb(!!(t&1),"focus-trap#initial-focus"),l=sC();return nC(()=>{if(t===0)return;if(!o){i!=null&&i.current&&ku(i.current);return}let c=r.current;c&&Lw(()=>{if(!l.current)return;let u=e?.activeElement;if(n!=null&&n.current){if(n?.current===u){a.current=u;return}}else if(c.contains(u)){a.current=u;return}if(n!=null&&n.current)ku(n.current);else{if(t&16){if(Ex(c,pu.First|pu.AutoFocus)!==wS.Error)return}else if(Ex(c,pu.First)!==wS.Error)return;if(i!=null&&i.current&&(ku(i.current),e?.activeElement===i.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}a.current=e?.activeElement})},[i,o,t]),a}function _he(t,{ownerDocument:e,container:r,containers:n,previousActiveElement:i}){let a=sC(),o=!!(t&4);Hz(e?.defaultView,"focus",l=>{if(!o||!a.current)return;let c=nq(n);Cd(r.current)&&c.add(r.current);let u=i.current;if(!u)return;let f=l.target;Cd(f)?sq(c,f)?(i.current=f,ku(f)):(l.preventDefault(),l.stopPropagation(),ku(u)):ku(i.current)},!0)}function sq(t,e){for(let r of t)if(r.contains(e))return!0;return!1}function iq(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!rm((e=t.as)!=null?e:oq)||Ke.Children.count(t.children)===1}let Rw=b.createContext(null);Rw.displayName="TransitionContext";var Che=(t=>(t.Visible="visible",t.Hidden="hidden",t))(Che||{});function Ahe(){let t=b.useContext(Rw);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function Ehe(){let t=b.useContext(Dw);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let Dw=b.createContext(null);Dw.displayName="NestingContext";function Bw(t){return"children"in t?Bw(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function aq(t,e){let r=O0(t),n=b.useRef([]),i=sC(),a=L0(),o=Vr((m,y=Wh.Hidden)=>{let v=n.current.findIndex(({el:j})=>j===m);v!==-1&&(Ql(y,{[Wh.Unmount](){n.current.splice(v,1)},[Wh.Hidden](){n.current[v].state="hidden"}}),a.microTask(()=>{var j;!Bw(n)&&i.current&&((j=r.current)==null||j.call(r))}))}),l=Vr(m=>{let y=n.current.find(({el:v})=>v===m);return y?y.state!=="visible"&&(y.state="visible"):n.current.push({el:m,state:"visible"}),()=>o(m,Wh.Unmount)}),c=b.useRef([]),u=b.useRef(Promise.resolve()),f=b.useRef({enter:[],leave:[]}),p=Vr((m,y,v)=>{c.current.splice(0),e&&(e.chains.current[y]=e.chains.current[y].filter(([j])=>j!==m)),e?.chains.current[y].push([m,new Promise(j=>{c.current.push(j)})]),e?.chains.current[y].push([m,new Promise(j=>{Promise.all(f.current[y].map(([N,C])=>C)).then(()=>j())})]),y==="enter"?u.current=u.current.then(()=>e?.wait.current).then(()=>v(y)):v(y)}),x=Vr((m,y,v)=>{Promise.all(f.current[y].splice(0).map(([j,N])=>N)).then(()=>{var j;(j=c.current.shift())==null||j()}).then(()=>v(y))});return b.useMemo(()=>({children:n,register:l,unregister:o,onStart:p,onStop:x,wait:u,chains:f}),[l,o,n,p,x,f,u])}let oq=b.Fragment,lq=mm.RenderStrategy;function The(t,e){var r,n;let{transition:i=!0,beforeEnter:a,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:f,enterTo:p,entered:x,leave:m,leaveFrom:y,leaveTo:v,...j}=t,[N,C]=b.useState(null),A=b.useRef(null),L=iq(t),O=Oo(...L?[A,e,C]:e===null?[]:[e]),F=(r=j.unmount)==null||r?Wh.Unmount:Wh.Hidden,{show:T,appear:I,initial:B}=Ahe(),[$,k]=b.useState(T?"visible":"hidden"),R=Ehe(),{register:P,unregister:q}=R;jo(()=>P(A),[P,A]),jo(()=>{if(F===Wh.Hidden&&A.current){if(T&&$!=="visible"){k("visible");return}return Ql($,{hidden:()=>q(A),visible:()=>P(A)})}},[$,A,P,q,T,F]);let X=Iw();jo(()=>{if(L&&X&&$==="visible"&&A.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[A,$,X,L]);let G=B&&!I,ne=I&&T&&B,ee=b.useRef(!1),se=aq(()=>{ee.current||(k("hidden"),q(A))},R),J=Vr(ue=>{ee.current=!0;let ve=ue?"enter":"leave";se.onStart(A,ve,Q=>{Q==="enter"?a?.():Q==="leave"&&l?.()})}),W=Vr(ue=>{let ve=ue?"enter":"leave";ee.current=!1,se.onStop(A,ve,Q=>{Q==="enter"?o?.():Q==="leave"&&c?.()}),ve==="leave"&&!Bw(se)&&(k("hidden"),q(A))});b.useEffect(()=>{L&&i||(J(T),W(T))},[T,L,i]);let U=!(!i||!L||!X||G),[,Y]=Vz(U,N,T,{start:J,end:W}),te=Ih({ref:O,className:((n=xS(j.className,ne&&u,ne&&f,Y.enter&&u,Y.enter&&Y.closed&&f,Y.enter&&!Y.closed&&p,Y.leave&&m,Y.leave&&!Y.closed&&y,Y.leave&&Y.closed&&v,!Y.transition&&T&&x))==null?void 0:n.trim())||void 0,...Gz(Y)}),ce=0;$==="visible"&&(ce|=vo.Open),$==="hidden"&&(ce|=vo.Closed),T&&$==="hidden"&&(ce|=vo.Opening),!T&&$==="visible"&&(ce|=vo.Closing);let xe=ka();return Ke.createElement(Dw.Provider,{value:se},Ke.createElement(Yz,{value:ce},xe({ourProps:te,theirProps:j,defaultTag:oq,features:lq,visible:$==="visible",name:"Transition.Child"})))}function Lhe(t,e){let{show:r,appear:n=!1,unmount:i=!0,...a}=t,o=b.useRef(null),l=iq(t),c=Oo(...l?[o,e]:e===null?[]:[e]);Iw();let u=Ib();if(r===void 0&&u!==null&&(r=(u&vo.Open)===vo.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[f,p]=b.useState(r?"visible":"hidden"),x=aq(()=>{r||p("hidden")}),[m,y]=b.useState(!0),v=b.useRef([r]);jo(()=>{m!==!1&&v.current[v.current.length-1]!==r&&(v.current.push(r),y(!1))},[v,r]);let j=b.useMemo(()=>({show:r,appear:n,initial:m}),[r,n,m]);jo(()=>{r?p("visible"):!Bw(x)&&o.current!==null&&p("hidden")},[r,x]);let N={unmount:i},C=Vr(()=>{var O;m&&y(!1),(O=t.beforeEnter)==null||O.call(t)}),A=Vr(()=>{var O;m&&y(!1),(O=t.beforeLeave)==null||O.call(t)}),L=ka();return Ke.createElement(Dw.Provider,{value:x},Ke.createElement(Rw.Provider,{value:j},L({ourProps:{...N,as:b.Fragment,children:Ke.createElement(cq,{ref:c,...N,...a,beforeEnter:C,beforeLeave:A})},theirProps:{},defaultTag:b.Fragment,features:lq,visible:f==="visible",name:"Transition"})))}function Ohe(t,e){let r=b.useContext(Rw)!==null,n=Ib()!==null;return Ke.createElement(Ke.Fragment,null,!r&&n?Ke.createElement(NS,{ref:e,...t}):Ke.createElement(cq,{ref:e,...t}))}let NS=ra(Lhe),cq=ra(The),iC=ra(Ohe),Su=Object.assign(NS,{Child:iC,Root:NS});var Mhe=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Mhe||{}),Phe=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(Phe||{});let Ihe={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},aC=b.createContext(null);aC.displayName="DialogContext";function $w(t){let e=b.useContext(aC);if(e===null){let r=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,$w),r}return e}function Rhe(t,e){return Ql(e.type,Ihe,t,e)}let EO=ra(function(t,e){let r=b.useId(),{id:n=`headlessui-dialog-${r}`,open:i,onClose:a,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:f=!1,...p}=t,x=b.useRef(!1);l=(function(){return l==="dialog"||l==="alertdialog"?l:(x.current||(x.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let m=Ib();i===void 0&&m!==null&&(i=(m&vo.Open)===vo.Open);let y=b.useRef(null),v=Oo(y,e),j=rC(y.current),N=i?0:1,[C,A]=b.useReducer(Rhe,{titleId:null,descriptionId:null,panelRef:b.createRef()}),L=Vr(()=>a(!1)),O=Vr(Y=>A({type:0,id:Y})),F=Iw()?N===0:!1,[T,I]=uhe(),B={get current(){var Y;return(Y=C.panelRef.current)!=null?Y:y.current}},$=rq(),{resolveContainers:k}=ghe({mainTreeNode:$,portals:T,defaultContainers:[B]}),R=m!==null?(m&vo.Closing)===vo.Closing:!1;Lue(u||R?!1:F,{allowed:Vr(()=>{var Y,te;return[(te=(Y=y.current)==null?void 0:Y.closest("[data-headlessui-portal]"))!=null?te:null]}),disallowed:Vr(()=>{var Y;return[(Y=$?.closest("body > *:not(#headlessui-portal-root)"))!=null?Y:null]})});let P=$z.get(null);jo(()=>{if(F)return P.actions.push(n),()=>P.actions.pop(n)},[P,n,F]);let q=Fz(P,b.useCallback(Y=>P.selectors.isTop(Y,n),[P,n]));que(q,k,Y=>{Y.preventDefault(),L()}),phe(q,j?.defaultView,Y=>{Y.preventDefault(),Y.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),L()}),Xue(u||R?!1:F,j,k),Oue(F,y,L);let[X,G]=Tz(),ne=b.useMemo(()=>[{dialogState:N,close:L,setTitleId:O,unmount:f},C],[N,L,O,f,C]),ee=Id({open:N===0}),se={ref:v,id:n,role:l,tabIndex:-1,"aria-modal":u?void 0:N===0?!0:void 0,"aria-labelledby":C.titleId,"aria-describedby":X,unmount:f},J=!mhe(),W=zf.None;F&&!u&&(W|=zf.RestoreFocus,W|=zf.TabLock,c&&(W|=zf.AutoFocus),J&&(W|=zf.InitialFocus));let U=ka();return Ke.createElement(Kz,null,Ke.createElement(CO,{force:!0},Ke.createElement(fhe,null,Ke.createElement(aC.Provider,{value:ne},Ke.createElement(eq,{target:y},Ke.createElement(CO,{force:!1},Ke.createElement(G,{slot:ee},Ke.createElement(I,null,Ke.createElement(jhe,{initialFocus:o,initialFocusFallback:y,containers:k,features:W},Ke.createElement(Pz,{value:L},U({ourProps:se,theirProps:p,slot:ee,defaultTag:Dhe,features:Bhe,visible:N===0,name:"Dialog"})))))))))))}),Dhe="div",Bhe=mm.RenderStrategy|mm.Static;function $he(t,e){let{transition:r=!1,open:n,...i}=t,a=Ib(),o=t.hasOwnProperty("open")||a!==null,l=t.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!a&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(n!==void 0||r)&&!i.static?Ke.createElement(AO,null,Ke.createElement(Su,{show:n,transition:r,unmount:i.unmount},Ke.createElement(EO,{ref:e,...i}))):Ke.createElement(AO,null,Ke.createElement(EO,{ref:e,open:n,...i}))}let Fhe="div";function Uhe(t,e){let r=b.useId(),{id:n=`headlessui-dialog-panel-${r}`,transition:i=!1,...a}=t,[{dialogState:o,unmount:l},c]=$w("Dialog.Panel"),u=Oo(e,c.panelRef),f=Id({open:o===0}),p=Vr(j=>{j.stopPropagation()}),x={ref:u,id:n,onClick:p},m=i?iC:b.Fragment,y=i?{unmount:l}:{},v=ka();return Ke.createElement(m,{...y},v({ourProps:x,theirProps:a,slot:f,defaultTag:Fhe,name:"Dialog.Panel"}))}let zhe="div";function qhe(t,e){let{transition:r=!1,...n}=t,[{dialogState:i,unmount:a}]=$w("Dialog.Backdrop"),o=Id({open:i===0}),l={ref:e,"aria-hidden":!0},c=r?iC:b.Fragment,u=r?{unmount:a}:{},f=ka();return Ke.createElement(c,{...u},f({ourProps:l,theirProps:n,slot:o,defaultTag:zhe,name:"Dialog.Backdrop"}))}let Hhe="h2";function Whe(t,e){let r=b.useId(),{id:n=`headlessui-dialog-title-${r}`,...i}=t,[{dialogState:a,setTitleId:o}]=$w("Dialog.Title"),l=Oo(e);b.useEffect(()=>(o(n),()=>o(null)),[n,o]);let c=Id({open:a===0}),u={ref:l,id:n};return ka()({ourProps:u,theirProps:i,slot:c,defaultTag:Hhe,name:"Dialog.Title"})}let Ghe=ra($he),Vhe=ra(Uhe);ra(qhe);let Yhe=ra(Whe),Zh=Object.assign(Ghe,{Panel:Vhe,Title:Yhe,Description:Lz});var TO;let Khe=(TO=Ke.startTransition)!=null?TO:function(t){t()};var Xhe=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Xhe||{}),Jhe=(t=>(t[t.ToggleDisclosure=0]="ToggleDisclosure",t[t.CloseDisclosure=1]="CloseDisclosure",t[t.SetButtonId=2]="SetButtonId",t[t.SetPanelId=3]="SetPanelId",t[t.SetButtonElement=4]="SetButtonElement",t[t.SetPanelElement=5]="SetPanelElement",t))(Jhe||{});let Zhe={0:t=>({...t,disclosureState:Ql(t.disclosureState,{0:1,1:0})}),1:t=>t.disclosureState===1?t:{...t,disclosureState:1},2(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},3(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}},4(t,e){return t.buttonElement===e.element?t:{...t,buttonElement:e.element}},5(t,e){return t.panelElement===e.element?t:{...t,panelElement:e.element}}},oC=b.createContext(null);oC.displayName="DisclosureContext";function lC(t){let e=b.useContext(oC);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,lC),r}return e}let cC=b.createContext(null);cC.displayName="DisclosureAPIContext";function dq(t){let e=b.useContext(cC);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,dq),r}return e}let dC=b.createContext(null);dC.displayName="DisclosurePanelContext";function Qhe(){return b.useContext(dC)}function efe(t,e){return Ql(e.type,Zhe,t,e)}let tfe=b.Fragment;function rfe(t,e){let{defaultOpen:r=!1,...n}=t,i=b.useRef(null),a=Oo(e,Az(v=>{i.current=v},t.as===void 0||rm(t.as))),o=b.useReducer(efe,{disclosureState:r?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:l,buttonId:c},u]=o,f=Vr(v=>{u({type:1});let j=T0(i.current);if(!j||!c)return;let N=v?md(v)?v:"current"in v&&md(v.current)?v.current:j.getElementById(c):j.getElementById(c);N?.focus()}),p=b.useMemo(()=>({close:f}),[f]),x=Id({open:l===0,close:f}),m={ref:a},y=ka();return Ke.createElement(oC.Provider,{value:o},Ke.createElement(cC.Provider,{value:p},Ke.createElement(Pz,{value:f},Ke.createElement(Yz,{value:Ql(l,{0:vo.Open,1:vo.Closed})},y({ourProps:m,theirProps:n,slot:x,defaultTag:tfe,name:"Disclosure"})))))}let nfe="button";function sfe(t,e){let r=b.useId(),{id:n=`headlessui-disclosure-button-${r}`,disabled:i=!1,autoFocus:a=!1,...o}=t,[l,c]=lC("Disclosure.Button"),u=Qhe(),f=u===null?!1:u===l.panelId,p=b.useRef(null),x=Oo(p,e,Vr(B=>{if(!f)return c({type:4,element:B})}));b.useEffect(()=>{if(!f)return c({type:2,buttonId:n}),()=>{c({type:2,buttonId:null})}},[n,c,f]);let m=Vr(B=>{var $;if(f){if(l.disclosureState===1)return;switch(B.key){case fu.Space:case fu.Enter:B.preventDefault(),B.stopPropagation(),c({type:0}),($=l.buttonElement)==null||$.focus();break}}else switch(B.key){case fu.Space:case fu.Enter:B.preventDefault(),B.stopPropagation(),c({type:0});break}}),y=Vr(B=>{B.key===fu.Space&&B.preventDefault()}),v=Vr(B=>{var $;_z(B.currentTarget)||i||(f?(c({type:0}),($=l.buttonElement)==null||$.focus()):c({type:0}))}),{isFocusVisible:j,focusProps:N}=gz({autoFocus:a}),{isHovered:C,hoverProps:A}=mz({isDisabled:i}),{pressed:L,pressProps:O}=bz({disabled:i}),F=Id({open:l.disclosureState===0,hover:C,active:L,disabled:i,focus:j,autofocus:a}),T=Wz(t,l.buttonElement),I=bS(f?{ref:x,type:T,disabled:i||void 0,autoFocus:a,onKeyDown:m,onClick:v}:{ref:x,id:n,type:T,"aria-expanded":l.disclosureState===0,"aria-controls":l.panelElement?l.panelId:void 0,disabled:i||void 0,autoFocus:a,onKeyDown:m,onKeyUp:y,onClick:v},N,A,O);return ka()({ourProps:I,theirProps:o,slot:F,defaultTag:nfe,name:"Disclosure.Button"})}let ife="div",afe=mm.RenderStrategy|mm.Static;function ofe(t,e){let r=b.useId(),{id:n=`headlessui-disclosure-panel-${r}`,transition:i=!1,...a}=t,[o,l]=lC("Disclosure.Panel"),{close:c}=dq("Disclosure.Panel"),[u,f]=b.useState(null),p=Oo(e,Vr(C=>{Khe(()=>l({type:5,element:C}))}),f);b.useEffect(()=>(l({type:3,panelId:n}),()=>{l({type:3,panelId:null})}),[n,l]);let x=Ib(),[m,y]=Vz(i,u,x!==null?(x&vo.Open)===vo.Open:o.disclosureState===0),v=Id({open:o.disclosureState===0,close:c}),j={ref:p,id:n,...Gz(y)},N=ka();return Ke.createElement(Kz,null,Ke.createElement(dC.Provider,{value:o.panelId},N({ourProps:j,theirProps:a,slot:v,defaultTag:ife,features:afe,visible:m,name:"Disclosure.Panel"})))}let lfe=ra(rfe),cfe=ra(sfe),dfe=ra(ofe),nm=Object.assign(lfe,{Button:cfe,Panel:dfe}),uC=b.createContext(null);uC.displayName="GroupContext";let ufe=b.Fragment;function hfe(t){var e;let[r,n]=b.useState(null),[i,a]=hue(),[o,l]=Tz(),c=b.useMemo(()=>({switch:r,setSwitch:n}),[r,n]),u={},f=t,p=ka();return Ke.createElement(l,{name:"Switch.Description",value:o},Ke.createElement(a,{name:"Switch.Label",value:i,props:{htmlFor:(e=c.switch)==null?void 0:e.id,onClick(x){r&&(yS(x.currentTarget)&&x.preventDefault(),r.click(),r.focus({preventScroll:!0}))}}},Ke.createElement(uC.Provider,{value:c},p({ourProps:u,theirProps:f,slot:{},defaultTag:ufe,name:"Switch.Group"}))))}let ffe="button";function pfe(t,e){var r;let n=b.useId(),i=Nz(),a=tC(),{id:o=i||`headlessui-switch-${n}`,disabled:l=a||!1,checked:c,defaultChecked:u,onChange:f,name:p,value:x,form:m,autoFocus:y=!1,...v}=t,j=b.useContext(uC),[N,C]=b.useState(null),A=b.useRef(null),L=Oo(A,e,j===null?null:j.setSwitch,C),O=Gde(u),[F,T]=Wde(c,f,O??!1),I=L0(),[B,$]=b.useState(!1),k=Vr(()=>{$(!0),T?.(!F),I.nextFrame(()=>{$(!1)})}),R=Vr(ue=>{if(_z(ue.currentTarget))return ue.preventDefault();ue.preventDefault(),k()}),P=Vr(ue=>{ue.key===fu.Space?(ue.preventDefault(),k()):ue.key===fu.Enter&&Vde(ue.currentTarget)}),q=Vr(ue=>ue.preventDefault()),X=Mz(),G=lue(),{isFocusVisible:ne,focusProps:ee}=gz({autoFocus:y}),{isHovered:se,hoverProps:J}=mz({isDisabled:l}),{pressed:W,pressProps:U}=bz({disabled:l}),Y=Id({checked:F,disabled:l,hover:se,focus:ne,active:W,autofocus:y,changing:B}),te=bS({id:o,ref:L,role:"switch",type:Wz(t,N),tabIndex:t.tabIndex===-1?0:(r=t.tabIndex)!=null?r:0,"aria-checked":F,"aria-labelledby":X,"aria-describedby":G,disabled:l||void 0,autoFocus:y,onClick:R,onKeyUp:P,onKeyPress:q},ee,J,U),ce=b.useCallback(()=>{if(O!==void 0)return T?.(O)},[T,O]),xe=ka();return Ke.createElement(Ke.Fragment,null,p!=null&&Ke.createElement(Qde,{disabled:l,data:{[p]:x||"on"},overrides:{type:"checkbox",checked:F},form:m,onReset:ce}),xe({ourProps:te,theirProps:v,slot:Y,defaultTag:ffe,name:"Switch"}))}let mfe=ra(pfe),gfe=hfe,xfe=gue,bfe=Lz,yfe=Object.assign(mfe,{Group:gfe,Label:xfe,Description:bfe});function hf(t=null){const[e,r]=b.useState([]),[n,i]=b.useState(!0),[a,o]=b.useState(null),{currentUser:l}=Sr(),c=async()=>{if(l){i(!0);try{const u=await Ze.get("/api/decks",t?{userId:t}:{});r(u),o(null)}catch(u){console.error("Error fetching decks:",u),o(u)}finally{i(!1)}}};return b.useEffect(()=>{if(!l){r([]),i(!1);return}c()},[l,t]),{decks:e,loading:n,error:a,refresh:c}}const vfe=[{badge:"White",colors:["W"],flavor:"Order, protection, and the light of law."},{badge:"Blue",colors:["U"],flavor:"Knowledge, manipulation, and the perfection of mind."},{badge:"Black",colors:["B"],flavor:"Power, ambition, and death at any cost."},{badge:"Red",colors:["R"],flavor:"Freedom, emotion, and the fire of impulse."},{badge:"Green",colors:["G"],flavor:"Nature, instinct, and the strength of the wild."},{badge:"Colorless",colors:["C"],flavor:"The void between, pure and unyielding."},{badge:"Azorius",colors:["W","U"],flavor:"The law is the shield of the just."},{badge:"Dimir",colors:["U","B"],flavor:"Knowledge is power, and we know everything."},{badge:"Rakdos",colors:["B","R"],flavor:"Entertainment is a serious business."},{badge:"Gruul",colors:["R","G"],flavor:"Not Gruul? Then die!"},{badge:"Selesnya",colors:["G","W"],flavor:"Together, we are the world's soul."},{badge:"Orzhov",colors:["W","B"],flavor:"Wealth is power, and spirit is currency."},{badge:"Izzet",colors:["U","R"],flavor:"Genius and madness are two sides of the same coin."},{badge:"Golgari",colors:["B","G"],flavor:"Life and death are a continuous circle."},{badge:"Boros",colors:["R","W"],flavor:"Strike fast, strike hard, strike true."},{badge:"Simic",colors:["G","U"],flavor:"Nature, perfected by design."},{badge:"Esper",colors:["W","U","B"],flavor:"Perfection through etherium and discipline."},{badge:"Grixis",colors:["U","B","R"],flavor:"Life is short, death is forever."},{badge:"Jund",colors:["B","R","G"],flavor:"Only the strongest survive the feeding frenzy."},{badge:"Naya",colors:["R","G","W"],flavor:"Where giant beasts roam and the wild reigns."},{badge:"Bant",colors:["G","W","U"],flavor:"Honor, valor, and the righteousness of caste."},{badge:"Abzan",colors:["W","B","G"],flavor:"Family is the only fortress that matters."},{badge:"Jeskai",colors:["U","R","W"],flavor:"Cunning strategies and swift strikes."},{badge:"Sultai",colors:["B","G","U"],flavor:"Ruthlessness is a virtue in the opulent dark."},{badge:"Mardu",colors:["R","W","B"],flavor:"Speed of the horse, edge of the blade."},{badge:"Temur",colors:["G","U","R"],flavor:"Savagery concealed by ice and snow."},{badge:"Glint-Eye",colors:["U","B","R","G"],flavor:"Chaos without order."},{badge:"Dune-Brood",colors:["W","B","R","G"],flavor:"Growth through conflict."},{badge:"Ink-Treader",colors:["W","U","R","G"],flavor:"Motion without purpose."},{badge:"Witch-Maw",colors:["W","U","B","G"],flavor:"Life without death."},{badge:"Yore-Tiller",colors:["W","U","B","R"],flavor:"Artifice without nature."},{badge:"WUBRG",colors:["W","U","B","R","G"],flavor:"All five colors in perfect harmony."}],d2=t=>{const e=t||[],r=e.length;return vfe.find(i=>i.badge==="Colorless"&&(r===0||r===1&&e[0]==="C")?!0:i.colors.length!==r?!1:i.colors.every(a=>e.includes(a)))||{badge:"Commander",colors:e,flavor:"A unique combination of powers."}},hC=({title:t,value:e,icon:r,color:n,to:i,children:a,size:o})=>{const l=o==="xs",c=s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-2xl ${l?"px-4 py-2":"p-4 md:p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative h-full flex flex-col justify-center`,children:[a,s.jsxs("div",{className:`relative z-20 ${l?"flex items-center justify-between w-full":""}`,children:[!l&&s.jsx("div",{className:"flex justify-between items-start mb-2 md:mb-4",children:s.jsx("div",{className:`p-2 rounded-xl bg-gray-950 text-${n}-400 group-hover:scale-110 transition-transform shadow-inner`,children:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})})}),s.jsxs("div",{className:l?"flex items-center gap-2":"flex flex-col",children:[l&&s.jsx("div",{className:`text-[9px] font-black px-2 py-0.5 rounded-full bg-${n}-500/10 text-${n}-400/80 uppercase tracking-tighter whitespace-nowrap border border-${n}-500/20`,children:t}),s.jsx("div",{className:`${l?"text-base":"text-3xl"} font-black text-white tracking-tight`,children:e})]}),l&&!a&&s.jsx("div",{className:`text-${n}-400 opacity-50`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})}),!l&&s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:t})]})]});return i&&!a?s.jsx(br,{to:i,className:"block h-full transition-transform active:scale-[0.98]",children:c}):c},wfe=({data:t,size:e})=>{const{stats:r,collection:n}=t;if(!r)return null;const i=e==="medium",a=e==="large"||e==="xlarge";return s.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:s.jsxs(hC,{to:a?null:"/collection",title:"Total Cards",value:r.totalCards,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue",size:e,children:[i&&s.jsxs("div",{className:"absolute top-4 right-4 text-right",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Distinct"}),s.jsx("div",{className:"text-xl font-bold text-indigo-400",children:n?.length||0})]}),e==="large"&&n&&s.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Recently Added"}),s.jsx("div",{className:"space-y-1.5",children:n.slice(-5).reverse().map((o,l)=>s.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[s.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),o.image_uris?.art_crop&&s.jsx("img",{src:o.image_uris.art_crop,alt:o.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},l))})]}),e==="xlarge"&&s.jsxs("div",{className:"absolute inset-y-0 right-0 w-[70%] flex items-center justify-around border-l border-white/5 bg-gray-950/20 px-8",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-indigo-400",children:n?.length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Distinct"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-yellow-400",children:n?.filter(o=>o.val_foil).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Foils"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-green-400",children:n?.filter(o=>o.val_signed).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Signed"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-xl font-black text-gray-400",children:n?.filter(o=>o.val_alt_art).length||0}),s.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-tighter",children:"Alt Art"})]})]})]})})},jfe=({data:t,size:e})=>{const{stats:r}=t;return r?s.jsx(hC,{to:"/decks",title:"Unique Decks",value:r.uniqueDecks,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"purple",size:e}):null},Nfe=({data:t,actions:e,size:r})=>{const{stats:n,syncLoading:i,collection:a}=t,{handleSyncPrices:o}=e;if(!n)return null;const l=r==="xs",c=r==="medium",u=a?[...a].sort((f,p)=>(parseFloat(p.prices?.usd)||0)-(parseFloat(f.prices?.usd)||0))[0]:null;return s.jsx("div",{className:"h-full relative overflow-hidden rounded-2xl",children:s.jsxs(hC,{title:"Collection Value",value:n.value,icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"green",size:r,children:[!l&&s.jsx("button",{onClick:f=>{f.preventDefault(),o()},disabled:i,className:`absolute bottom-4 right-4 p-2 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all ${i?"animate-spin":""} z-20`,title:"Update Prices from Scryfall",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c&&u&&s.jsxs("div",{className:"absolute top-4 right-4 text-right max-w-[100px]",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1 truncate",children:"Top Value"}),s.jsx("div",{className:"text-xs font-bold text-green-400 truncate",children:u.name})]}),r==="large"&&a&&s.jsxs("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-gray-900 to-transparent p-4 overflow-y-auto pl-12 border-l border-white/5 z-10",children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 text-right",children:"Top Value Cards"}),s.jsx("div",{className:"space-y-1.5",children:a.filter(f=>parseFloat(f.prices?.usd)>0).sort((f,p)=>parseFloat(p.prices?.usd)-parseFloat(f.prices?.usd)).slice(0,5).map((f,p)=>s.jsxs("div",{className:"flex items-center gap-2 text-right justify-end group/card",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-300 group-hover/card:text-white truncate flex-grow min-w-0",children:f.name}),s.jsxs("span",{className:"text-[10px] text-green-400 font-mono",children:["$",f.prices?.usd]})]}),f.image_uris?.art_crop&&s.jsx("img",{src:f.image_uris.art_crop,alt:f.name,className:"w-8 h-6 object-cover rounded border border-white/10"})]},p))})]}),r==="xlarge"&&a&&s.jsxs("div",{className:"absolute inset-y-0 right-0 w-[75%] border-l border-white/5 bg-gray-950/20 px-6 flex flex-col justify-center",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4",children:"Highest Collection Assets"}),s.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-none",children:a.filter(f=>parseFloat(f.prices?.usd)>0).sort((f,p)=>parseFloat(p.prices?.usd)-parseFloat(f.prices?.usd)).slice(0,6).map((f,p)=>s.jsxs("div",{className:"flex-shrink-0 w-28 group/card",children:[s.jsxs("div",{className:"aspect-[3/4] rounded-lg overflow-hidden border border-white/10 mb-2 relative",children:[s.jsx("img",{src:f.image_uris?.normal||f.image_uris?.art_crop,alt:f.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-gray-950/80 p-1 text-center",children:s.jsxs("span",{className:"text-[10px] font-mono text-green-400",children:["$",f.prices?.usd]})})]}),s.jsx("div",{className:"text-[9px] font-bold text-gray-400 line-clamp-1 text-center",children:f.name})]},p))})]})]})})},kfe=({data:t,size:e})=>{const{decks:r,decksLoading:n}=t,i=dn(),a=e==="xs",o=e==="small",l=e==="medium",c=e==="large",u=e==="xlarge",f=b.useMemo(()=>a||o?1:l?2:c?3:4,[a,o,l,c]),p=b.useMemo(()=>r?[...r].reverse().slice(0,f):[],[r,f]),x=b.useMemo(()=>a||o?"grid-cols-1":l?"grid-cols-2":c?"grid-cols-3":"grid-cols-2 lg:grid-cols-4",[a,o,l,c]);if(a){const m=p[0];return s.jsxs("div",{onClick:()=>m&&i(`/decks/${m.id}`),className:"bg-gray-950/40 border border-white/5 rounded-3xl h-full flex items-center px-4 justify-between cursor-pointer hover:bg-white/5 transition-all group overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Recent Deck"}),s.jsx("span",{className:"text-gray-700",children:""}),s.jsx("span",{className:"text-xs font-bold text-white truncate max-w-[120px]",children:m?.name||"No decks"})]}),s.jsx("div",{className:"p-1.5 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}return s.jsxs("div",{className:`bg-gray-950/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md shadow-xl h-full flex flex-col`,children:[s.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-3 shrink-0",children:[s.jsx("span",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("span",{className:o?"hidden":"inline",children:"Recent Decks"}),o&&s.jsx("span",{children:"Recent"})]}),s.jsx("div",{className:"flex-grow overflow-hidden relative",children:n?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 text-xs",children:"Loading..."}):p.length>0?s.jsxs("div",{className:`grid ${x} gap-3 md:gap-4 h-full`,children:[p.map(m=>{const y=N=>N?N.image_uris?.art_crop?N.image_uris.art_crop:N.card_faces?.[0]?.image_uris?.art_crop?N.card_faces[0].image_uris.art_crop:null:null,v=y(m.commander),j=y(m.commander_partner);return s.jsxs("div",{onClick:()=>i(`/decks/${m.id}`),className:"group relative rounded-xl overflow-hidden cursor-pointer shadow-lg hover:shadow-indigo-500/30 transition-all hover:-translate-y-1 border border-white/5 bg-gray-900 h-full min-h-[140px]",children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950",children:m.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsx("div",{className:"w-1/2 h-full relative border-r border-black/50",children:s.jsx("img",{src:v||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"})}),s.jsx("div",{className:"w-1/2 h-full relative",children:s.jsx("img",{src:j||"https://placehold.co/400x600?text=?",alt:"",className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"})})]}):s.jsx("img",{src:v||"https://placehold.co/400x600?text=?",alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/20 to-transparent opacity-90"}),s.jsxs("div",{className:"absolute inset-0 p-3 flex flex-col justify-end",children:[s.jsx("h3",{className:"text-sm font-bold text-white leading-tight mb-0.5 group-hover:text-indigo-400 transition-colors line-clamp-1",children:m.name}),s.jsx("div",{className:"flex gap-0.5",children:(()=>{const N=m?.commander?.color_identity||[],C=m?.commander_partner?.color_identity||[],A=[...new Set([...N,...C])];return A.length===0&&A.push("C"),A.map(L=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${L}.svg`,alt:L,className:"w-2.5 h-2.5"},L))})()})]})]},m.id)}),u&&s.jsxs("div",{onClick:()=>i("/decks/new"),className:"border-2 border-dashed border-indigo-500/20 rounded-xl flex flex-col items-center justify-center text-center p-4 hover:border-indigo-500/40 hover:bg-indigo-500/5 transition-all group cursor-pointer",children:[s.jsx("div",{className:"p-3 rounded-full bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform mb-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-sm font-bold text-indigo-300",children:"New Deck"})]})]}):s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 bg-gray-900/30 rounded-2xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:"No decks."}),s.jsx(br,{to:"/decks/new",className:"text-indigo-400 text-xs font-bold hover:text-indigo-300 mt-1",children:"Create "})]})})]})},Sfe=({data:t,size:e})=>{const{stats:r,decks:n}=t;if(!r||!r.topColor)return null;const i=e==="xs",a=e==="medium",o=e==="large",l=e==="xlarge",c=o||l,u=l?(n||[]).filter(f=>{const p=f?.commander?.color_identity||[],x=f?.commander_partner?.color_identity||[],m=[...new Set([...p,...x])].sort().join(""),y=r.topColor.pips?.sort().join("")||"C";return m===y}).slice(0,3):[];return s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${i?"p-3":"p-5"} backdrop-blur-sm hover:border-gray-700 transition-all group relative overflow-hidden h-full flex flex-col justify-center`,children:[s.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 opacity-10 rounded-bl-full ${r.topColor.bg} z-0`}),s.jsxs("div",{className:`flex relative z-10 h-full ${c?"flex-row items-center gap-8":"flex-col justify-between"}`,children:[i?s.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 uppercase tracking-tighter whitespace-nowrap border border-white/10",children:"Top Identity"}),s.jsx("div",{className:`text-sm font-black tracking-tight ${r.topColor.color||"text-white"}`,children:r.topColor.name})]}),s.jsx("div",{className:"flex -space-x-2",children:r.topColor.pips?.map((f,p)=>s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-black ring-2 ring-gray-950 shadow-lg transform group-hover:scale-110 transition-transform border border-white/10",style:{backgroundColor:f==="W"?"#fef08a":f==="U"?"#60a5fa":f==="B"?"#1f2937":f==="R"?"#ef4444":f==="G"?"#22c55e":"#6b7280",color:f==="B"?"#f3f4f6":"#111827"},children:f},p))})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex flex-col",children:s.jsx("div",{className:"flex gap-1.5 mb-3",children:r.topColor.pips?.map((f,p)=>s.jsx("div",{className:"w-7 h-7 text-xs rounded-full flex items-center justify-center font-black ring-2 ring-white/10 shadow-lg transform group-hover:scale-110 transition-transform border-2 border-white/10",style:{backgroundColor:f==="W"?"#fef08a":f==="U"?"#60a5fa":f==="B"?"#1f2937":f==="R"?"#ef4444":f==="G"?"#22c55e":"#6b7280",color:f==="B"?"#f3f4f6":"#111827"},children:f},p))})}),s.jsxs("div",{className:`flex-grow ${c?"":"mt-4"}`,children:[s.jsx("div",{className:`text-2xl font-black tracking-tighter mb-1 ${r.topColor.color||"text-white"}`,children:r.topColor.name}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Top Color Identity"}),(a||c)&&s.jsxs("div",{className:"text-xs text-gray-400 italic mt-3 opacity-80 leading-relaxed border-l-2 border-white/5 pl-3 py-1",children:['"',r.topColor.flavor,'"']})]})]}),l&&s.jsxs("div",{className:"flex-grow flex gap-8 items-center border-l border-white/5 pl-8 h-full",children:[s.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1 text-center",children:"Top Commanders"}),s.jsx("div",{className:"space-y-2",children:(u.length>0?u:n.slice(0,3)).map(f=>s.jsxs("div",{className:"flex items-center gap-2 group/cmd p-1 rounded-lg hover:bg-white/5 transition-colors",children:[f.commander?.image_uris?.art_crop&&s.jsx("img",{src:f.commander.image_uris.art_crop,className:"w-8 h-6 object-cover rounded border border-white/10",alt:""}),s.jsx("span",{className:"text-[11px] text-gray-300 group-hover/cmd:text-indigo-400 truncate",children:f.commander?.name||f.name})]},f.id))})]}),s.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-4 border border-white/5 flex items-center gap-4 group/asset relative overflow-hidden",children:[s.jsxs("div",{className:"flex-grow",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-1",children:"Signature Asset"}),s.jsx("div",{className:"text-sm font-black text-white group-hover/asset:text-indigo-300 transition-colors line-clamp-1",children:"Ragavan, Nimble Pilferer"}),s.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[s.jsx("span",{className:"text-xs text-green-400 font-mono",children:"$64.20"}),s.jsx("span",{className:"text-[9px] text-gray-500 uppercase font-black",children:"Market Value"})]})]}),s.jsxs("div",{className:"w-16 h-12 rounded-lg overflow-hidden border border-white/10 relative",children:[s.jsx("img",{src:"https://cards.scryfall.io/art_crop/front/a/1/a134a6df-d264-44b2-a42e-9dcc914a1a38.jpg",className:"w-full h-full object-cover group-hover/asset:scale-110 transition-transform duration-500",alt:""}),s.jsx("div",{className:"absolute inset-0 bg-indigo-500/10 mix-blend-overlay"})]}),s.jsx("div",{className:"absolute bottom-0 right-0 p-2 opacity-20 text-[20px] font-black italic",children:"64%"})]})]})]})]})},_fe=({size:t})=>{const{userProfile:e}=Sr(),r=e?.settings?.organization?.mode,n=t==="xs",i=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge",u=(f=>{switch(f){case"deckbuilder":return{label:"Deckbuilder",icon:"",desc:"Sorted by Color & Type",color:"indigo"};case"collector":return{label:"Collector",icon:"",desc:"Sorted by Set & Number",color:"blue"};case"hybrid":return{label:"Hybrid",icon:"",desc:"Binders + Bulk Boxes",color:"amber"};case"custom":return{label:"Custom",icon:"",desc:"Advanced Hierarchy",color:"emerald"};default:return{label:"Reference",icon:"",desc:"Default Organization",color:"gray"}}})(r);return n?s.jsxs(br,{to:"/settings/display",className:"bg-gray-900/60 border border-white/5 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-all group",children:[s.jsx("span",{className:"text-xl group-hover:scale-125 transition-transform",children:u.icon}),s.jsx("span",{className:"text-[10px] font-black text-gray-500 mt-1 uppercase tracking-tighter",children:"Org"})]}):s.jsxs("div",{className:"bg-gray-900/60 border border-white/5 rounded-3xl backdrop-blur-md overflow-hidden h-full flex flex-col relative group transition-all hover:border-white/10",children:[s.jsxs("div",{className:`flex items-center gap-4 ${l?"p-8 pb-4":"p-6"}`,children:[s.jsx("div",{className:`aspect-square ${i?"w-10 h-10 text-xl":"w-14 h-14 text-3xl"} flex items-center justify-center bg-gray-950 rounded-2xl shadow-inner border border-white/5 group-hover:scale-110 transition-transform`,children:u.icon}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h3",{className:"font-black text-white uppercase tracking-wider text-sm flex items-center gap-2",children:["Organization",s.jsx("span",{className:`w-1.5 h-1.5 rounded-full bg-${u.color}-500 animate-pulse`})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:`text-xl font-black text-${u.color}-400`,children:u.label}),!i&&s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tight",children:u.desc})]})]})]}),s.jsx("div",{className:"flex-grow px-6 pb-6 overflow-hidden",children:l?s.jsxs("div",{className:"flex gap-4 h-full",children:[s.jsx("div",{className:"flex-grow grid grid-cols-4 gap-3",children:[{name:"Main Binder",type:"Binder",fill:85,color:"indigo"},{name:"Bulk Box A",type:"Box",fill:40,color:"blue"},{name:"Trade Folder",type:"Binder",fill:12,color:"emerald"},{name:"Rares Box",type:"Box",fill:95,color:"amber"}].map((f,p)=>s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-2xl p-3 flex flex-col justify-between hover:bg-gray-800 transition-colors cursor-pointer group/loc",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase",children:f.type}),s.jsxs("span",{className:`text-[9px] font-bold text-${f.color}-400 px-1.5 py-0.5 bg-${f.color}-500/10 rounded-full border border-${f.color}-500/20`,children:[f.fill,"% Full"]})]}),s.jsx("div",{className:"mt-2 text-xs font-bold text-gray-300 group-hover/loc:text-white truncate",children:f.name}),s.jsx("div",{className:"mt-2 w-full bg-white/5 rounded-full h-1 overflow-hidden",children:s.jsx("div",{className:`h-full bg-${f.color}-500 transition-all duration-1000`,style:{width:`${f.fill}%`}})})]},p))}),s.jsxs("div",{className:"flex flex-col gap-2 min-w-[140px]",children:[s.jsx(br,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl border border-dashed border-white/10 text-[10px] font-bold text-gray-500 hover:border-white/20 hover:text-white transition-all p-2 text-center",children:"Manage Storage"}),s.jsx(br,{to:"/settings/display",className:"flex-grow flex items-center justify-center rounded-2xl bg-white/5 text-[10px] font-bold text-gray-400 hover:bg-white/10 transition-all p-2 text-center",children:"Change Mode"})]})]}):o?s.jsxs("div",{className:"flex items-center gap-6 h-full",children:[s.jsxs("div",{className:"flex-grow space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black text-gray-500 uppercase",children:[s.jsx("span",{children:"Storage Capacity"}),s.jsx("span",{className:"text-white",children:"65% Global Fill"})]}),s.jsx("div",{className:"w-full bg-gray-950 rounded-full h-3 p-0.5 border border-white/5",children:s.jsx("div",{className:`h-full bg-gradient-to-r from-${u.color}-600 to-${u.color}-400 rounded-full shadow-[0_0_10px_rgba(var(--color-primary),0.3)] transition-all duration-1000`,style:{width:"65%"}})}),s.jsxs("p",{className:"text-[10px] text-gray-500 italic",children:['"Items are currently sorted using the ',u.label,' logic. 12 binders detected."']})]}),s.jsxs(br,{to:"/settings/display",className:"flex-shrink-0 w-1/4 h-20 bg-white/5 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-white/10 transition-all",children:[s.jsx("div",{className:"text-xs font-black text-white",children:"Advanced"}),s.jsx("div",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Settings "})]})]}):a||i?s.jsxs("div",{className:"flex flex-col justify-end h-full",children:[s.jsx("div",{className:"h-1.5 w-full bg-gray-950 rounded-full overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full bg-${u.color}-500 transition-all duration-1000`,style:{width:"65%"}})}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"65% Full"}),s.jsx(br,{to:"/settings/display",className:"text-[10px] text-white font-bold underline-offset-4 hover:underline",children:"Settings"})]})]}):null}),s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-${u.color}-500/0 to-${u.color}-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-500`})]})},LO=({title:t,icon:e,color:r,onClick:n,compact:i})=>s.jsxs("button",{onClick:n,className:`group relative overflow-hidden rounded-2xl ${i?"p-2":"p-4 md:p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 h-full w-full`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors h-full",children:[s.jsx("div",{className:`${i?"p-1.5":"p-3"} bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20`,children:e}),s.jsx("span",{className:`font-bold ${i?"text-[10px]":"text-sm"} tracking-wide text-center leading-tight`,children:t})]})]}),Cfe=({data:t,size:e})=>{const{userProfile:r,stats:n}=t,i=dn(),{addToast:a}=wn(),o=e==="xs",l=e==="small",c=e==="medium",u=e==="xlarge",f=()=>{const x=Cs[r?.subscription_tier||"free"].limits.decks,m=n?.uniqueDecks||0;if(x!==1/0&&m>=x){a(`Deck limit reached (${m}/${x}). Upgrade to create more!`,"error");return}i("/decks/new")},p=[{title:"New Deck",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"from-indigo-600 to-purple-600",onClick:f},{title:"Add Cards",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-blue-600 to-cyan-600",onClick:()=>i("/collection")},{title:"Browse Sets",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-green-600 to-emerald-600",onClick:()=>i("/sets")},{title:"Wishlist",icon:s.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"from-pink-600 to-rose-600",onClick:()=>i("/collection?wishlist=true")}];return o?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-2",children:[s.jsx("button",{onClick:f,className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg shadow-indigo-500/40 flex items-center justify-center transform active:scale-95 transition-all",title:"New Deck",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-[10px] font-black tracking-widest uppercase mt-2 text-indigo-400",children:"New Deck"})]}):u?s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md shadow-xl h-full flex flex-col",children:[s.jsx("div",{className:"flex gap-4 mb-8",children:p.map((x,m)=>s.jsx("div",{className:"flex-1",children:s.jsx(LO,{...x,compact:!1})},m))}),s.jsxs("div",{className:"flex-grow border-t border-white/5 pt-6 overflow-hidden",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Recent Activity"}),s.jsx("div",{className:"space-y-4",children:[{text:"Deck 'Necrons' updated",time:"2h ago",icon:""},{text:"5 cards added to collection",time:"1d ago",icon:""},{text:"New wishlist item: 'Black Lotus'",time:"3d ago",icon:""}].map((x,m)=>s.jsxs("div",{className:"flex items-center justify-between text-xs bg-gray-900/50 p-3 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:x.icon}),s.jsx("span",{className:"text-gray-300",children:x.text})]}),s.jsx("span",{className:"text-gray-500 font-mono",children:x.time})]},m))})]})]}):s.jsxs("div",{className:`grid gap-2 md:gap-3 h-full ${l?"grid-cols-2":"grid-cols-2 md:grid-cols-4 items-center"}`,children:[p.map((x,m)=>s.jsx("div",{className:"min-w-0 h-full",children:s.jsx(LO,{...x,title:l?x.title.split(" ")[0]:x.title,compact:l})},m)),!l&&!c&&s.jsx("div",{className:"md:col-span-4 h-auto mt-2",children:s.jsx(_fe,{})})]})},Afe=({size:t,data:e})=>{const{userProfile:r,stats:n}=e||{},i=t==="xs",a=t==="small",o=t==="large"||t==="xlarge",l=Cs[r?.subscription_tier||"free"],c={decks:n?.uniqueDecks||0,collection:n?.collectionCount||0,wishlist:n?.wishlistCount||0},u=(m,y)=>{if(y===1/0)return"bg-indigo-500";const v=m/y*100;return v>=90?"bg-red-500":v>=75?"bg-yellow-500":"bg-green-500"},f=(m,y)=>{if(y===1/0)return"100%";const v=m/y*100;return`${Math.min(v,100)}%`},p=l.limits.decks!==1/0&&c.decks/l.limits.decks>=.9||l.limits.collection!==1/0&&c.collection/l.limits.collection>=.9||l.limits.wishlist!==1/0&&c.wishlist/l.limits.wishlist>=.9;if(i)return s.jsxs(br,{to:"/settings/membership",className:`bg-gray-900/60 border ${p?"border-red-500/40":"border-indigo-500/20"} rounded-3xl h-full flex flex-col items-center justify-center group hover:bg-gray-800 transition-all`,children:[s.jsx("span",{className:`text-xl font-black ${p?"text-red-400":"text-indigo-400"} group-hover:scale-110 transition-transform`,children:l.name[0]}),s.jsx("div",{className:"mt-1 flex gap-0.5",children:[1,2,3].map(m=>s.jsx("div",{className:`w-1 h-1 rounded-full ${p?"bg-red-500/50":"bg-indigo-500/50"}`},m))})]});const x=(m,y,v)=>{const j=u(y,v),N=f(y,v);return s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest",children:m}),s.jsxs("span",{className:"text-[9px] font-mono text-gray-400",children:[y,"/",v===1/0?"":v]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden border border-white/5 shadow-inner",children:s.jsx("div",{className:`h-full ${j} transition-all duration-1000`,style:{width:N}})})]})};return s.jsxs("div",{className:`bg-gray-900 border ${p?"border-red-500/20":"border-indigo-500/20"} rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 ${p?"bg-red-500/10 text-red-400":"bg-indigo-500/10 text-indigo-400"} rounded-xl flex items-center justify-center text-xl shadow-inner border border-white/5`,children:p?"":l.name==="Wizard"?"":""}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-black text-[10px] text-gray-500 uppercase tracking-widest",children:["Plan: ",s.jsx("span",{className:"text-white",children:l.name})]}),s.jsx("p",{className:`text-[10px] ${p?"text-red-400":"text-indigo-400"} font-black uppercase tracking-widest`,children:p?"Limit Alert":"Active"})]})]}),!a&&s.jsx(br,{to:"/settings/membership",className:"text-[10px] font-black text-indigo-400 hover:text-white uppercase tracking-widest underline underline-offset-4 decoration-indigo-500/30",children:"Manage"})]}),s.jsxs("div",{className:`flex-grow ${o?"grid grid-cols-3 gap-6":"space-y-4"}`,children:[x("Decks",c.decks,l.limits.decks),x("Collection",c.collection,l.limits.collection),x("Wishlist",c.wishlist,l.limits.wishlist)]}),o&&s.jsxs("div",{className:"mt-6 pt-4 border-t border-white/5 flex justify-between items-center text-[10px]",children:[s.jsxs("div",{className:"text-gray-500 font-bold uppercase tracking-widest",children:["Pricing tier: ",l.name]}),s.jsx(br,{to:"/pricing",className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-xl text-white font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:"Upgrade"})]}),a&&s.jsx(br,{to:"/settings/membership",className:"mt-4 w-full py-2 bg-gray-800 text-center text-[10px] font-black uppercase tracking-widest text-gray-400 rounded-xl",children:"Details "})]})},Efe=({size:t})=>{const e=dn(),{addToast:r}=wn(),[n,i]=b.useState([]),[a,o]=b.useState(0),[l,c]=b.useState(!0),u=t==="xs",f=t==="small",p=t==="medium",x=t==="large",m=t==="xlarge";b.useEffect(()=>{(async()=>{try{const j=await wa.fetchRelationships(),N=j.filter(A=>A.status==="accepted");i(N);const C=j.filter(A=>A.status==="pending"&&A.direction==="incoming");o(C.length)}catch(j){console.error("Widget fetch failed",j)}finally{c(!1)}})()},[]);const y=v=>{v&&(v.preventDefault(),v.stopPropagation()),e("/settings/community")};return u?s.jsxs("div",{onClick:y,className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer hover:bg-indigo-500/20 transition-all group overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest whitespace-nowrap",children:"Pod Members"}),s.jsx("span",{className:"text-gray-700",children:""}),s.jsx("span",{className:"text-sm font-black text-white",children:n.length})]}),s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),a>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-indigo-500 rounded-full border border-gray-950 animate-pulse"})]})]}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${f?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/20 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-gray-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:["My Pod",a>0&&s.jsxs("span",{className:"bg-indigo-600 text-white text-[9px] font-black px-1.5 py-0.5 rounded-full animate-pulse tracking-normal",children:[a," New"]})]}),s.jsxs("div",{className:"mt-1 flex items-baseline gap-1",children:[s.jsx("span",{className:"text-3xl font-black text-white",children:n.length}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Members"})]})]}),s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),s.jsx("div",{className:"flex-grow space-y-3 relative z-10 overflow-hidden",children:l?s.jsx("div",{className:"space-y-2",children:s.jsx("div",{className:"h-10 bg-gray-800 rounded-xl animate-pulse"})}):m?s.jsxs("div",{className:"flex gap-8 h-full",children:[s.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-4",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Post to Pod"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"What's brewing?",className:"w-full bg-gray-950/80 border border-white/5 rounded-2xl p-4 pr-12 text-sm text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner"}),s.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-indigo-600 rounded-xl text-white hover:bg-indigo-500 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[n.slice(0,5).map((v,j)=>s.jsxs("div",{className:"flex flex-col items-center gap-2 group/u cursor-pointer",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"w-12 h-12 rounded-2xl bg-indigo-900 border border-indigo-500/30 flex items-center justify-center text-lg font-black text-indigo-200 uppercase group-hover/u:scale-110 group-hover/u:border-indigo-400 transition-all shadow-lg overflow-hidden",children:[v.friend.username?.[0],s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-indigo-950/50 to-transparent opacity-0 group-hover/u:opacity-100 transition-opacity"})]}),s.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-950"})]}),s.jsx("span",{className:"text-[10px] font-bold text-gray-400 group-hover/u:text-white transition-colors",children:v.friend.username})]},v.id)),s.jsx("div",{onClick:y,className:"w-12 h-12 rounded-2xl border-2 border-dashed border-white/10 flex items-center justify-center text-gray-600 hover:text-white hover:border-white/20 transition-all cursor-pointer",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}):x?s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Pod Activity"}),[{user:"Tristin",act:"updated Ghave Deck",time:"1h"},{user:"Sarah",act:"added 3 Rare cards",time:"4h"},{user:"Mike",act:"ranked #1 in Draft",time:"12h"}].map((v,j)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-950/50 rounded-xl border border-white/5 text-[11px] group/item hover:bg-gray-800 transition-colors",children:[s.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center font-bold text-indigo-300 text-[10px] uppercase shadow-sm",children:v.user[0]}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("span",{className:"font-bold text-gray-200",children:v.user})," ",s.jsx("span",{className:"text-gray-400",children:v.act})]}),s.jsx("span",{className:"text-gray-600 font-mono text-[9px]",children:v.time})]},j))]}):s.jsxs("div",{className:"space-y-2",children:[n.slice(0,p?3:2).map(v=>s.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[s.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-900 flex items-center justify-center text-[10px] font-bold text-indigo-200 uppercase",children:v.friend.username?.[0]}),s.jsx("div",{className:"text-xs font-bold text-gray-300 truncate",children:v.friend.username})]},v.id)),n.length===0&&s.jsx("p",{className:"text-[10px] text-gray-600 italic text-center py-4",children:"No members in your pod yet."})]})}),!m&&s.jsx("button",{onClick:y,className:`w-full ${f?"py-2 text-[10px]":"py-3 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all mt-4`,children:"Manage Pod"})]})},Cp=["Just buy a new booster box? Add the cards through the set page, after organizing the cards by collector number. You can go top down, or bottom up on the list and make your life MUCH easier.","You can bulk import your collection via CSV! Check the Collection page for the template.","Right-click any card in your collection to instantly find it on TCGPlayer.","Use the 'Wishlist' filter in your collection to track cards you plan to buy.","You can separate your 'Foils' from regular printings by toggling the foil icon when adding cards.","Filter your collection by 'Rarity: Mythic' to see your big hits quickly.","The 'Price' filter helps you find those hidden gems in your bulk box.","Did you know? You can manually edit the market price of a card if you have a specific variant not tracked correctly.","Smart Binders update automatically. If you add a new Goblin to your collection, it instantly goes into your 'Goblin Tribe' binder.","You can use RegEx in Smart Binders! Example: Name matches `^Dark` finds cards starting with 'Dark'.","Want a binder for high-value cards? Set a rule for 'Price > 5.00'.","Create a 'Trade Binder' by excluding cards that are currently in a deck: `In Deck = False`.","You can combine rules! `Color Identity = R` AND `Type = Dragon` makes a perfect dragon binder.","Smart Binders can track duplicates. Set `Quantity > 4` to find cards you can trade away.","Customize your binder icons with emojis to make them stand out in the list.","Use the 'Pro Color' toggles in the Smart Creator to quickly select color identities.","When building a deck, use the 'Synergy' tab to see cards that work well with your Commander.","The Mana Curve chart updates in real-time as you add cards to your deck.","You can clone any of your existing decks to try out a new strategy without losing the original.","Use the 'Playtest' feature to draw sample hands and see if your land count is right.","Toggle 'Group by Type' in the deck view to see your creature/spell balance.","The AI Strategy tool can suggest a land base for you based on your color pips.","Add 'Tags' to cards in your deck (like 'Ramp', 'Removal') to see a custom breakdown.","You can set a card as your 'Commander' directly from the search results.","Check the 'Sideboard' tab to keep track of cards you're considering but haven't cut yet.","Invite friends to your 'Pod' to see their trade binders in real-time.","You can set your Pod permissions to 'Viewer' (read-only) or 'Editor' (trust them to modify decks).","Share your deck with a QR code! It's perfect for showing off your build at the LGS.","Link your account with a partner to build 'Team Decks' using a shared card pool.","Mark cards as 'Not for Trade' in your collection, and they won't show up for your Pod friends.","Collaborate on a deck list by giving a friend 'Editor' access in your Pod.","Keep your database healthy! Run the 'Cleanup' script periodically if you notice duplicate entries.","You can change your theme preference in the Settings menu (Dark/Light mode).","Report bugs directly from the dashboard using the 'System Status' widget.","The dollar value of your collection is an estimate based on TCGPlayer Market Price.","Use standard Scryfall syntax in the search bar. `t:creature cmc>5` works!","Hover over the KPI cards on the dashboard to see more detailed tooltips.","Click the 'Update Prices' button on the dashboard to fetch the latest market data.","You can view your deck's stats (CMC, Type distribution) on the mobile view too!","The app works offline for browsing, but you need internet to sync prices or images.","Double-click a card image to view the high-res version.","Use keyboard shortcuts! 'Ctrl/Cmd + F' usually brings up the card search."],Tfe=({size:t})=>{const[e,r]=b.useState(0),[n,i]=b.useState(!1),a=t==="xs",o=t==="small",l=t==="large"||t==="xlarge";b.useEffect(()=>{const u=Math.floor(Math.random()*Cp.length);r(u)},[]);const c=u=>{n||(i(!0),setTimeout(()=>i(!1),300),r(f=>u==="next"?(f+1)%Cp.length:(f-1+Cp.length)%Cp.length))};return a?s.jsx("div",{onClick:()=>c("next"),className:"bg-yellow-500/10 border border-yellow-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-yellow-500/20 transition-all group",children:s.jsx("svg",{className:"w-6 h-6 text-yellow-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}):s.jsxs("div",{className:`bg-gray-900/50 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md relative overflow-hidden group h-full flex flex-col`,children:[s.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("svg",{className:"w-20 h-20 transform rotate-12",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"})})}),s.jsxs("h2",{className:"font-black text-white mb-2 flex items-center gap-2 relative z-10 text-[10px] uppercase tracking-widest",children:[s.jsx("span",{className:"p-1.5 bg-yellow-500/10 rounded-lg text-yellow-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),"Pro Tip"]}),s.jsxs("div",{className:"relative z-10 flex-grow flex flex-col justify-between",children:[s.jsx("p",{className:`text-gray-300 leading-relaxed transition-opacity duration-300 ${n?"opacity-0":"opacity-100"} ${l?"text-sm":"text-[11px]"}`,children:Cp[e]}),s.jsxs("div",{className:"flex items-center justify-between mt-4 border-t border-white/5 pt-3",children:[s.jsxs("span",{className:"text-[9px] text-gray-500 font-mono font-bold uppercase tracking-widest",children:["Tip ",e+1," of ",Cp.length]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c("prev"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>c("next"),className:"p-1.5 rounded-lg bg-gray-950/50 hover:bg-gray-800 text-gray-500 hover:text-white transition-all border border-white/5",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]})]})},uq=6048e5,Lfe=864e5,bv=43200,OO=1440,MO=Symbol.for("constructDateFrom");function Tu(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&MO in t?t[MO](e):t instanceof Date?new t.constructor(e):new Date(e)}function ja(t,e){return Tu(e||t,t)}let Ofe={};function Rb(){return Ofe}function Gx(t,e){const r=Rb(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=ja(t,e?.in),a=i.getDay(),o=(a<n?7:0)+a-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function u2(t,e){return Gx(t,{...e,weekStartsOn:1})}function hq(t,e){const r=ja(t,e?.in),n=r.getFullYear(),i=Tu(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=u2(i),o=Tu(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=u2(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function h2(t){const e=ja(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Fw(t,...e){const r=Tu.bind(null,t||e.find(n=>typeof n=="object"));return e.map(r)}function PO(t,e){const r=ja(t,e?.in);return r.setHours(0,0,0,0),r}function Mfe(t,e,r){const[n,i]=Fw(r?.in,t,e),a=PO(n),o=PO(i),l=+a-h2(a),c=+o-h2(o);return Math.round((l-c)/Lfe)}function Pfe(t,e){const r=hq(t,e),n=Tu(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),u2(n)}function j1(t,e){const r=+ja(t)-+ja(e);return r<0?-1:r>0?1:r}function Ife(t){return Tu(t,Date.now())}function Rfe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Dfe(t){return!(!Rfe(t)&&typeof t!="number"||isNaN(+ja(t)))}function Bfe(t,e,r){const[n,i]=Fw(r?.in,t,e),a=n.getFullYear()-i.getFullYear(),o=n.getMonth()-i.getMonth();return a*12+o}function $fe(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function Ffe(t,e){return+ja(t)-+ja(e)}function Ufe(t,e){const r=ja(t,e?.in);return r.setHours(23,59,59,999),r}function zfe(t,e){const r=ja(t,e?.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function qfe(t,e){const r=ja(t,e?.in);return+Ufe(r,e)==+zfe(r,e)}function Hfe(t,e,r){const[n,i,a]=Fw(r?.in,t,t,e),o=j1(i,a),l=Math.abs(Bfe(i,a));if(l<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-o*l);let c=j1(i,a)===-o;qfe(n)&&l===1&&j1(n,a)===1&&(c=!1);const u=o*(l-+c);return u===0?0:u}function Wfe(t,e,r){const n=Ffe(t,e)/1e3;return $fe(r?.roundingMethod)(n)}function Gfe(t,e){const r=ja(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Vfe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Yfe=(t,e,r)=>{let n;const i=Vfe[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function mN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Kfe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Xfe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Jfe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Zfe={date:mN({formats:Kfe,defaultWidth:"full"}),time:mN({formats:Xfe,defaultWidth:"full"}),dateTime:mN({formats:Jfe,defaultWidth:"full"})},Qfe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e0e=(t,e,r,n)=>Qfe[t];function Bg(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r?.width?String(r.width):o;i=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r?.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return i[a]}}const t0e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r0e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},n0e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s0e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},i0e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},a0e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},o0e=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},l0e={ordinalNumber:o0e,era:Bg({values:t0e,defaultWidth:"wide"}),quarter:Bg({values:r0e,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Bg({values:n0e,defaultWidth:"wide"}),day:Bg({values:s0e,defaultWidth:"wide"}),dayPeriod:Bg({values:i0e,defaultWidth:"wide",formattingValues:a0e,defaultFormattingWidth:"wide"})};function $g(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?d0e(l,p=>p.test(o)):c0e(l,p=>p.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const f=e.slice(o.length);return{value:u,rest:f}}}function c0e(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function d0e(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function u0e(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(i.length);return{value:o,rest:l}}}const h0e=/^(\d+)(th|st|nd|rd)?/i,f0e=/\d+/i,p0e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},m0e={any:[/^b/i,/^(a|c)/i]},g0e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x0e={any:[/1/i,/2/i,/3/i,/4/i]},b0e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},y0e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},v0e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},w0e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},j0e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N0e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},k0e={ordinalNumber:u0e({matchPattern:h0e,parsePattern:f0e,valueCallback:t=>parseInt(t,10)}),era:$g({matchPatterns:p0e,defaultMatchWidth:"wide",parsePatterns:m0e,defaultParseWidth:"any"}),quarter:$g({matchPatterns:g0e,defaultMatchWidth:"wide",parsePatterns:x0e,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$g({matchPatterns:b0e,defaultMatchWidth:"wide",parsePatterns:y0e,defaultParseWidth:"any"}),day:$g({matchPatterns:v0e,defaultMatchWidth:"wide",parsePatterns:w0e,defaultParseWidth:"any"}),dayPeriod:$g({matchPatterns:j0e,defaultMatchWidth:"any",parsePatterns:N0e,defaultParseWidth:"any"})},fq={code:"en-US",formatDistance:Yfe,formatLong:Zfe,formatRelative:e0e,localize:l0e,match:k0e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function S0e(t,e){const r=ja(t,e?.in);return Mfe(r,Gfe(r))+1}function _0e(t,e){const r=ja(t,e?.in),n=+u2(r)-+Pfe(r);return Math.round(n/uq)+1}function pq(t,e){const r=ja(t,e?.in),n=r.getFullYear(),i=Rb(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=Tu(e?.in||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Gx(o,e),c=Tu(e?.in||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=Gx(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function C0e(t,e){const r=Rb(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=pq(t,e),a=Tu(e?.in||t,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),Gx(a,e)}function A0e(t,e){const r=ja(t,e?.in),n=+Gx(r,e)-+C0e(r,e);return Math.round(n/uq)+1}function es(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Th={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return es(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):es(r+1,2)},d(t,e){return es(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(t,e){return es(t.getHours()%12||12,e.length)},H(t,e){return es(t.getHours(),e.length)},m(t,e){return es(t.getMinutes(),e.length)},s(t,e){return es(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return es(i,e.length)}},Ap={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},IO={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Th.y(t,e)},Y:function(t,e,r,n){const i=pq(t,n),a=i>0?i:1-i;if(e==="YY"){const o=a%100;return es(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):es(a,e.length)},R:function(t,e){const r=hq(t);return es(r,e.length)},u:function(t,e){const r=t.getFullYear();return es(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return es(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return es(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Th.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return es(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=A0e(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):es(i,e.length)},I:function(t,e,r){const n=_0e(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):es(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Th.d(t,e)},D:function(t,e,r){const n=S0e(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):es(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return es(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return es(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return es(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=Ap.noon:n===0?i=Ap.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=Ap.evening:n>=12?i=Ap.afternoon:n>=4?i=Ap.morning:i=Ap.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Th.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Th.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):es(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):es(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Th.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Th.s(t,e)},S:function(t,e){return Th.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return DO(n);case"XXXX":case"XX":return If(n);default:return If(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return DO(n);case"xxxx":case"xx":return If(n);default:return If(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+RO(n,":");default:return"GMT"+If(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+RO(n,":");default:return"GMT"+If(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return es(n,e.length)},T:function(t,e,r){return es(+t,e.length)}};function RO(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+e+es(a,2)}function DO(t,e){return t%60===0?(t>0?"-":"+")+es(Math.abs(t)/60,2):If(t,e)}function If(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=es(Math.trunc(n/60),2),a=es(n%60,2);return r+i+e+a}const BO=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},mq=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},E0e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return BO(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",BO(n,e)).replace("{{time}}",mq(i,e))},T0e={p:mq,P:E0e},L0e=/^D+$/,O0e=/^Y+$/,M0e=["D","DD","YY","YYYY"];function P0e(t){return L0e.test(t)}function I0e(t){return O0e.test(t)}function R0e(t,e,r){const n=D0e(t,e,r);if(console.warn(n),M0e.includes(t))throw new RangeError(n)}function D0e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const B0e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$0e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,F0e=/^'([^]*?)'?$/,U0e=/''/g,z0e=/[a-zA-Z]/;function vi(t,e,r){const n=Rb(),i=n.locale??fq,a=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,l=ja(t,r?.in);if(!Dfe(l))throw new RangeError("Invalid time value");let c=e.match($0e).map(f=>{const p=f[0];if(p==="p"||p==="P"){const x=T0e[p];return x(f,i.formatLong)}return f}).join("").match(B0e).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const p=f[0];if(p==="'")return{isToken:!1,value:q0e(f)};if(IO[p])return{isToken:!0,value:f};if(p.match(z0e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:f}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:i};return c.map(f=>{if(!f.isToken)return f.value;const p=f.value;(I0e(p)||P0e(p))&&R0e(p,e,String(t));const x=IO[p[0]];return x(l,p,i.localize,u)}).join("")}function q0e(t){const e=t.match(F0e);return e?e[1].replace(U0e,"'"):t}function H0e(t,e,r){const n=Rb(),i=r?.locale??n.locale??fq,a=2520,o=j1(t,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:o}),[c,u]=Fw(r?.in,...o>0?[e,t]:[t,e]),f=Wfe(u,c),p=(h2(u)-h2(c))/1e3,x=Math.round((f-p)/60);let m;if(x<2)return r?.includeSeconds?f<5?i.formatDistance("lessThanXSeconds",5,l):f<10?i.formatDistance("lessThanXSeconds",10,l):f<20?i.formatDistance("lessThanXSeconds",20,l):f<40?i.formatDistance("halfAMinute",0,l):f<60?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",1,l):x===0?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",x,l);if(x<45)return i.formatDistance("xMinutes",x,l);if(x<90)return i.formatDistance("aboutXHours",1,l);if(x<OO){const y=Math.round(x/60);return i.formatDistance("aboutXHours",y,l)}else{if(x<a)return i.formatDistance("xDays",1,l);if(x<bv){const y=Math.round(x/OO);return i.formatDistance("xDays",y,l)}else if(x<bv*2)return m=Math.round(x/bv),i.formatDistance("aboutXMonths",m,l)}if(m=Hfe(u,c),m<12){const y=Math.round(x/bv);return i.formatDistance("xMonths",y,l)}else{const y=m%12,v=Math.trunc(m/12);return y<3?i.formatDistance("aboutXYears",v,l):y<9?i.formatDistance("overXYears",v,l):i.formatDistance("almostXYears",v+1,l)}}function W0e(t,e){return H0e(t,Ife(t),e)}const G0e=({isOpen:t,onClose:e,release:r})=>{const[n,i]=b.useState(!1);return b.useEffect(()=>(i(!0),()=>i(!1)),[]),!t||!r||!n?null:Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",onClick:e,children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl w-full max-w-2xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] animate-slide-up",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-start bg-gray-950/50",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-1",children:r.version}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("span",{className:"text-xs text-gray-400 font-mono uppercase",children:["Released ",vi(new Date(r.released_at),"MMMM d, yyyy")]})})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar bg-gray-900/50",children:[s.jsxs("div",{className:"flex gap-4 mb-6",children:[r.stats?.features>0&&s.jsx("div",{className:"px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:[r.stats.features," New Features"]})}),r.stats?.bugs>0&&s.jsx("div",{className:"px-3 py-1 bg-red-500/10 border border-red-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-red-400 uppercase tracking-wider",children:[r.stats.bugs," Bug Fixes"]})})]}),s.jsx("div",{className:"prose prose-invert prose-lg max-w-none prose-headings:text-indigo-300 prose-a:text-indigo-400 prose-strong:text-white",dangerouslySetInnerHTML:{__html:r.notes}})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/30 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Close"})})]})}),document.body)},V0e=({size:t})=>{const[e,r]=b.useState([]),[n,i]=b.useState(!0),[a,o]=b.useState(null),l=t==="xs",c=t==="small",u=t==="large",f=t==="xlarge",p=u||f;return b.useEffect(()=>{(async()=>{try{const m=await Ze.getReleases();r(m||[])}catch(m){console.error("Failed to load releases",m)}finally{i(!1)}})()},[]),l?s.jsx("div",{onClick:()=>o(e[0]),className:"bg-green-900/10 border border-green-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-green-500/20 transition-all group",children:s.jsxs("div",{className:"relative",children:[s.jsx("svg",{className:"w-6 h-6 text-green-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-gray-950 animate-pulse"})]})}):s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md flex flex-col h-full overflow-hidden relative group`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[s.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[s.jsx("span",{className:"p-1.5 bg-green-500/10 rounded-lg text-green-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),"Release Log"]}),p&&e[0]&&s.jsxs("span",{className:"text-[10px] font-mono text-green-400 font-bold px-2 py-0.5 bg-green-500/10 rounded-full border border-green-500/20",children:["Current: ",e[0].version]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar relative z-10",children:n?s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Loading updates..."}):f&&e[0]?s.jsxs("div",{className:"flex gap-8 h-full",children:[s.jsxs("div",{className:"min-w-[180px] flex flex-col justify-center",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Newest Version"}),s.jsx("div",{className:"text-4xl font-black text-white mb-2",children:e[0].version}),s.jsx("div",{className:"text-[10px] text-gray-400 font-mono mb-4",children:vi(new Date(e[0].released_at),"MMMM yyyy")}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[s.jsx("div",{className:"w-8 h-1 bg-emerald-500 rounded-full group-hover:w-10 transition-all"}),s.jsxs("span",{className:"text-[10px] font-black text-emerald-400 uppercase",children:[e[0].stats?.features||0," Features"]})]}),s.jsxs("div",{className:"flex items-center gap-2 group/stat",children:[s.jsx("div",{className:"w-6 h-1 bg-red-500 rounded-full group-hover:w-8 transition-all"}),s.jsxs("span",{className:"text-[10px] font-black text-red-400 uppercase",children:[e[0].stats?.bugs||0," Bugfixes"]})]})]})]}),s.jsxs("div",{className:"flex-grow bg-gray-950/40 rounded-2xl p-6 border border-white/5 relative group/notes overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-3 bg-indigo-500"})," Highlights"]}),s.jsx("div",{className:"space-y-3 overflow-hidden text-xs text-gray-400 line-clamp-4",dangerouslySetInnerHTML:{__html:e[0].notes}}),s.jsxs("button",{onClick:()=>o(e[0]),className:"mt-auto pt-4 text-[10px] font-black text-indigo-400 uppercase tracking-wider hover:text-white transition-colors flex items-center gap-1 group/btn",children:["Open Changelog ",s.jsx("svg",{className:"w-3 h-3 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),s.jsxs("div",{className:"min-w-[150px] border-l border-white/5 pl-8 flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4",children:"Past Updates"}),s.jsx("div",{className:"space-y-4",children:e.slice(1,4).map(x=>s.jsxs("div",{onClick:()=>o(x),className:"cursor-pointer group/hist",children:[s.jsx("div",{className:"text-xs font-black text-gray-300 group-hover/hist:text-white transition-colors",children:x.version}),s.jsx("div",{className:"text-[9px] text-gray-600 font-mono mt-0.5",children:vi(new Date(x.released_at),"MMM d, yyyy")})]},x.id))})]})]}):u&&e[0]?s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-4 border border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[s.jsxs("h3",{className:"text-sm font-black text-white",children:[e[0].version," Patch Notes"]}),s.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:vi(new Date(e[0].released_at),"MMMM yyyy")})]}),s.jsx("div",{className:"space-y-2 opacity-80 overflow-hidden max-h-[100px] text-xs",dangerouslySetInnerHTML:{__html:e[0].notes}}),s.jsx("button",{onClick:()=>o(e[0]),className:"mt-4 text-[10px] font-black text-green-400 uppercase tracking-widest hover:text-white transition-colors",children:"Read Full Notes "})]})}):s.jsx("div",{className:"space-y-2",children:e.slice(0,c?1:2).map(x=>s.jsxs("div",{onClick:()=>o(x),className:"bg-gray-950/30 border border-white/5 rounded-xl p-3 flex items-center justify-between group cursor-pointer hover:bg-white/5 transition-all",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-black text-white text-sm",children:x.version}),s.jsx("div",{className:"text-[9px] text-gray-500 font-mono uppercase mt-0.5",children:vi(new Date(x.released_at),"MMM d")})]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-green-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},x.id))})}),s.jsx(G0e,{isOpen:!!a,onClose:()=>o(null),release:a}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/0 to-green-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},Y0e=({size:t})=>{const e=dn(),[r,n]=b.useState({online:0,pending:0,total:0}),i=t==="xs",a=t==="small",o=t==="large"||t==="xlarge";return b.useEffect(()=>{(async()=>{try{const c=await Ze.get("/api/friends"),u=c.pending_received?.length||0,f=c.friends?.length||0;n({online:0,pending:u,total:f})}catch(c){console.error(c)}})()},[]),i?s.jsxs("div",{onClick:()=>e("/social"),className:"bg-indigo-900/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[s.jsxs("div",{className:"relative",children:[s.jsx(u0,{size:18,className:"text-indigo-400 group-hover:scale-110 transition-transform"}),r.pending>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border border-gray-950 animate-bounce"})]}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-1",children:r.total})]}):s.jsxs("div",{className:`bg-gray-900/60 border border-gray-800 rounded-3xl ${a?"p-4":"p-6"} backdrop-blur-sm hover:border-gray-700 transition-colors flex flex-col h-full overflow-hidden`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-xl text-indigo-400",children:s.jsx(u0,{size:a?16:20})}),s.jsx("span",{className:`font-black tracking-tight text-white uppercase ${a?"text-[10px]":"text-xs"}`,children:"Community"})]}),r.pending>0&&s.jsxs("div",{className:"flex items-center justify-center px-2 py-0.5 bg-red-500/20 text-red-400 rounded-full border border-red-500/30 text-[9px] font-black animate-pulse",children:[s.jsx(Z3,{size:10,className:"mr-1"}),r.pending," NEW"]})]}),s.jsx("div",{className:"flex-grow",children:o?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-4xl font-black text-white",children:r.total}),s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Total Connections"})]}),s.jsxs("div",{className:"pt-4 border-t border-white/5",children:[s.jsx("h4",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-3",children:"Recent Pings"}),s.jsx("div",{className:"space-y-2",children:["GhaveMaster sent a trade","CommanderSarah shared a deck"].map((l,c)=>s.jsxs("div",{className:"text-[10px] text-gray-300 flex items-center gap-2 bg-gray-950/40 p-2 rounded-lg border border-white/5",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-indigo-500"}),l]},c))})]})]}):s.jsxs("div",{children:[s.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:r.total}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:"Friends Connected"})]})}),s.jsx("button",{onClick:()=>e("/social"),className:`mt-4 w-full ${a?"py-1.5 text-[10px]":"py-2.5 text-xs"} bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg transition-all`,children:"View Hub"})]})},K0e=({isOpen:t,onClose:e,onConfirm:r,type:n,targetId:i,loading:a,activeSession:o})=>t?Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900/90 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 pointer-events-none"}),s.jsxs("div",{className:"p-8 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center text-2xl border border-indigo-500/30 text-indigo-400",children:""}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Start ",n.charAt(0).toUpperCase()+n.slice(1)," Audit"]}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Verify your physical ownership"})]})]}),s.jsxs("div",{className:"space-y-4 mb-8",children:[o?s.jsxs("div",{className:"border border-red-500/30 bg-red-900/20 p-4 rounded-xl",children:[s.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Previous Audit In Progress"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["You have an active ",s.jsx("strong",{children:o.type})," audit. Starting this new audit will ",s.jsx("strong",{children:"cancel and delete"})," the existing session."]})]}):s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:"How it works:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"1."}),s.jsx("span",{children:"We'll create a snapshot of your current digital list."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"2."}),s.jsx("span",{children:"You'll verify each card physically."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"3."}),s.jsx("span",{children:"Finalize to reconcile any differences."})]})]})]}),!o&&s.jsxs("div",{className:"flex items-center gap-3 text-sm text-blue-400 bg-blue-500/10 p-3 rounded-lg border border-blue-500/20",children:[s.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:"Only one active audit allowed. This will be your active session."})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white font-medium transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:a,className:`px-6 py-2 font-bold rounded-xl shadow-lg transition-all transform hover:scale-105 active:scale-95 flex items-center gap-2 disabled:opacity-50 ${o?"bg-red-600 hover:bg-red-500 text-white shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20"}`,children:[a?"Starting...":o?"Overwrite & Start":"Begin Audit",!a&&s.jsx("span",{className:"opacity-70",children:""})]})]})]})]})}),document.body):null;function Uw({type:t,targetId:e,label:r="Start Audit",className:n=""}){const[i,a]=b.useState(!1),[o,l]=b.useState(!1),c=dn(),[u,f]=b.useState(null),p=async()=>{a(!0);try{u&&await Ze.cancelAudit(u.id);const m=await Ze.startAudit({type:t,targetId:e});c(`/audit/${m.id}`)}catch(m){console.error(m),alert("Failed to start audit: "+m.message)}finally{a(!1),l(!1),f(null)}},x=async()=>{a(!0);try{const m=await Ze.getActiveAudit();if(m){const y=m.type===t,v=!e||String(m.target_id)===String(e);if(y&&v){c(`/audit/${m.id}`);return}f(m),l(!0);return}f(null),l(!0)}catch(m){console.error(m),l(!0)}finally{a(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:x,className:`flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors shadow-lg shadow-indigo-500/20 disabled:opacity-50 ${n}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),r]}),s.jsx(K0e,{isOpen:o,onClose:()=>l(!1),onConfirm:p,type:t,loading:i,activeSession:u})]})}function X0e({size:t}){const[e,r]=b.useState(null),[n,i]=b.useState(null),[a,o]=b.useState(!0),[l,c]=b.useState(!1),u=dn(),{userProfile:f}=Sr(),p=t==="xs",x=t==="small",m=t==="large",y=t==="xlarge",v=m||y;b.useEffect(()=>{(async()=>{try{const B=await Ze.getActiveAudit();if(r(B),B){const $=await Ze.get(`/api/audit/${B.id}/stats`);i($)}}catch(B){console.error("Failed to check audit status",B)}finally{o(!1)}})()},[]);const{features:j}=vn(f?.subscription_tier);if(!j.collectionAudit)return p?s.jsx("div",{onClick:()=>u("/settings/membership"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center opacity-75 cursor-pointer hover:opacity-100 border border-gray-800",children:s.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}):s.jsxs("div",{className:"bg-gray-900/50 rounded-3xl p-4 border border-gray-800 transition-all group relative overflow-hidden flex flex-col h-full opacity-75 hover:opacity-100",children:[s.jsx("div",{className:"flex justify-between items-start mb-1 relative z-10",children:s.jsx("h3",{className:"text-gray-400 text-xs font-medium uppercase tracking-widest",children:"Audit"})}),s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[s.jsx("p",{className:"text-[10px] text-gray-500 mb-2",children:"Unlock Wizard tier to audit your collection."}),s.jsx("button",{onClick:()=>u("/settings/membership"),className:"text-[9px] font-bold uppercase tracking-widest text-indigo-400 border border-indigo-500/30 px-3 py-1.5 rounded-lg hover:bg-indigo-500/20",children:"Upgrade"})]})]});if(a)return null;if(!e)return p?s.jsx("div",{onClick:()=>u("/audit"),className:"bg-gray-900/50 rounded-3xl h-full flex items-center justify-center cursor-pointer border border-gray-800 group transition-all",children:s.jsx("svg",{className:"w-6 h-6 text-gray-600 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 002-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${x?"p-4":"p-6"} border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/10 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[s.jsx("h3",{className:"text-gray-400 text-xs font-medium tracking-widest uppercase",children:"Collection Audit"}),s.jsx("div",{className:"text-gray-600 group-hover:text-indigo-400 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),s.jsx("div",{className:"mt-auto relative z-10 flex flex-col gap-2",children:s.jsx(Uw,{type:"collection",label:"Start Audit",className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-xs transition-all active:scale-95 shadow-lg shadow-indigo-900/20 border-none"})})]});const N=Math.ceil((new Date(e.expires_at)-new Date)/(1e3*60*60*24)),C=n?.total_cards||0,A=n?.total_reviewed||0,L=n?.mismatches?.length||0,O=A-L,F=C-A,T=C>0?Math.round(A/C*100):0;return p?s.jsxs("div",{onClick:()=>u("/audit"),className:"bg-indigo-900/20 rounded-3xl h-full flex items-center justify-between px-4 cursor-pointer border border-indigo-500/30 group transition-all hover:bg-indigo-900/30 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-indigo-500/10 text-indigo-400/80 uppercase tracking-tighter whitespace-nowrap border border-indigo-500/20",children:"Audit Progress"}),s.jsxs("span",{className:"text-sm font-black text-white",children:[T,"%"]})]}),s.jsxs("div",{className:"relative w-8 h-8 flex items-center justify-center",children:[s.jsx("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:s.jsx("circle",{cx:"50%",cy:"50%",r:"30%",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${T*.63} 100`,strokeLinecap:"round",className:"text-indigo-500"})}),s.jsx("svg",{className:"w-3 h-3 text-indigo-400/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})]})]}):s.jsxs("div",{className:`bg-gray-900/50 rounded-3xl ${x?"p-4":"p-6"} border border-indigo-500/20 hover:border-indigo-500/40 transition-all group relative overflow-hidden flex flex-col h-full`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none"}),s.jsxs("div",{className:`flex relative z-10 h-full ${y?"flex-row items-center gap-12":"flex-col"}`,children:[s.jsxs("div",{className:y?"min-w-[140px]":"mb-4",children:[s.jsxs("h3",{className:"text-indigo-400 text-[10px] font-black uppercase tracking-widest flex items-center gap-2 mb-1",children:["Live Audit",s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"})]}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsxs("span",{className:`${y?"text-5xl":"text-3xl"} font-black text-white`,children:[T,"%"]}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Complete"})]}),v&&s.jsxs("div",{className:"mt-2 text-[10px] text-gray-400 font-bold uppercase tracking-tighter",children:[N," days remaining"]})]}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:"w-full bg-gray-800 rounded-full h-1.5 overflow-hidden mb-3",children:s.jsx("div",{className:"bg-indigo-500 h-full transition-all duration-1000",style:{width:`${T}%`}})}),y?s.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-1",children:"Matches"}),s.jsx("span",{className:"text-xl font-black text-white",children:O}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Confirmed valid"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-1",children:"Mismatches"}),s.jsx("span",{className:"text-xl font-black text-white",children:L}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase",children:"Action required"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Pending"}),s.jsx("span",{className:"text-xl font-black text-white",children:F}),s.jsx("span",{className:"text-[9px] text-gray-600 uppercase text-nowrap",children:"Cards remaining"})]})]}):s.jsxs("div",{className:`flex justify-between text-[10px] font-bold uppercase tracking-widest ${x?"hidden":"flex"}`,children:[s.jsxs("span",{className:"text-green-500",children:[O," Match"]}),s.jsxs("span",{className:"text-red-500",children:[L," Diff"]}),s.jsxs("span",{className:"text-gray-500",children:[F," Left"]})]})]}),s.jsxs("div",{className:`${y?"min-w-[200px] border-l border-white/5 pl-8 h-full flex flex-col justify-center":"mt-4"}`,children:[m&&n?.mismatches?.length>0&&s.jsxs("div",{className:"mb-4 space-y-1.5",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Critical Delta Items"}),n.mismatches.slice(0,2).map((I,B)=>s.jsxs("div",{className:"text-[11px] text-gray-400 truncate flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-1 rounded-full bg-red-500"}),I.card_name]},B))]}),s.jsx("button",{onClick:()=>u("/audit"),className:"w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-[10px] transition-all active:scale-95 shadow-lg shadow-indigo-900/20",children:y?"Open Full Report":"Resume Audit "}),y&&s.jsx("button",{onClick:()=>c(!0),className:"mt-2 w-full py-2 text-[9px] font-bold text-gray-500 uppercase tracking-widest hover:text-white transition-colors",children:"How to Audit?"})]})]})]})}const J0e=({size:t})=>{const[e,r]=b.useState({history:[],pointer:-1});b.useEffect(()=>(r({history:ba.getLog(),pointer:ba.pointer}),ba.subscribe(u=>{r({history:u.history,pointer:u.pointer})})),[]);const{history:n}=e,i=t==="small",a=t==="medium",o=t==="large",l=t==="xlarge";return n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:[s.jsx("svg",{className:"w-8 h-8 mb-2 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("div",{className:"text-xs font-bold uppercase tracking-wider",children:"No Recent Activity"})]}):s.jsxs("div",{className:"h-full flex flex-col bg-gray-900/40 backdrop-blur-md rounded-3xl overflow-hidden border border-white/5",children:[s.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-center bg-black/20",children:[s.jsxs("h3",{className:"text-xs font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"}),"Session History"]}),s.jsxs("span",{className:"text-[10px] text-gray-600 font-mono",children:[n.length," Actions"]})]}),s.jsx("div",{className:`flex-grow overflow-y-auto custom-scrollbar ${i?"p-2":"p-4"}`,children:s.jsx("div",{className:"space-y-2",children:n.map((c,u)=>{const f=n.length-1-u===e.pointer;return s.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-xl transition-all border ${f?"bg-cyan-500/10 border-cyan-500/30":"bg-black/20 border-white/5 hover:bg-white/5"}`,children:[s.jsx("div",{className:`mt-0.5 p-1.5 rounded-lg ${f?"bg-cyan-500/20 text-cyan-400":"bg-gray-800 text-gray-500"}`,children:f?s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}):s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:`text-xs font-bold ${f?"text-cyan-100":"text-gray-300"}`,children:c.action}),s.jsx("div",{className:"text-[10px] text-gray-500 font-mono mt-0.5",children:new Date(c.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]},c.timestamp)})})}),(a||o||l)&&s.jsx("div",{className:"p-3 bg-black/20 border-t border-white/5 text-[10px] text-gray-500 text-center font-mono",children:"Press Ctrl+Z to Undo  Ctrl+Y to Redo"})]})},gq={findMatches:async t=>{try{const r=(await Ze.get(`/api/collection?userId=${t}&wishlist=true`)).map(o=>({id:o.scryfall_id,name:o.name,set:o.set_code,wishlistId:o.id}));if(r.length===0)return[];const i=(await wa.fetchRelationships()).filter(o=>o.status==="accepted").map(o=>o.friend);if(i.length===0)return[];const a=[];return await Promise.all(i.map(async o=>{try{(await Ze.get(`/api/collection?userId=${o.id}&public=true`)).forEach(c=>{r.find(f=>f.id===c.scryfall_id)&&a.push({cardName:c.name,cardId:c.scryfall_id,set:c.set_code,finish:c.finish,friendName:o.username,friendId:o.id,quantity:c.count,image:c.image_uri||c.data?.image_uris?.normal})})}catch(l){console.warn(`Failed to fetch collection for ${o.username}`,l)}})),a}catch(e){throw console.error("TradeService findMatches failed:",e),e}},findReverseMatches:async t=>[]},Z0e=({size:t="medium"})=>{const{currentUser:e,userProfile:r}=Sr(),[n,i]=b.useState(0),[a,o]=b.useState(!0);return b.useEffect(()=>{if(!e)return;(async()=>{try{const c=await gq.findMatches(r.id);i(c.length)}catch(c){console.warn("Widget trade check failed",c)}finally{o(!1)}})()},[r]),a?s.jsx("div",{className:"h-full w-full bg-gray-800 rounded-2xl animate-pulse flex items-center justify-center",children:s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700"})}):s.jsx(br,{to:"/armory",className:"block h-full w-full group",children:s.jsxs("div",{className:"h-full w-full bg-gradient-to-br from-indigo-900/50 to-gray-900 border border-indigo-500/30 hover:border-indigo-400 rounded-2xl p-4 flex flex-col justify-between relative overflow-hidden transition-all hover:shadow-[0_0_20px_rgba(99,102,241,0.3)]",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-600/10 rounded-full blur-3xl -mr-10 -mt-10 transition-all group-hover:bg-indigo-600/20"}),s.jsx("div",{className:"flex justify-between items-start z-10",children:s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:text-white group-hover:bg-indigo-500 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})})}),s.jsxs("div",{className:"z-10",children:[s.jsx("div",{className:"text-3xl font-bold text-white mb-1 group-hover:scale-105 transition-transform origin-left",children:n>0?n:"No"}),s.jsx("div",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:n===1?"Trade Match":"Trade Matches"}),n>0&&s.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"Cards available in your Pod"})]})]})})},Q0e={new_deck:{title:"New Deck",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),gradient:"from-indigo-600 to-purple-600",action:({navigate:t,addToast:e,userProfile:r,stats:n})=>{const i=Cs[r?.subscription_tier||"free"].limits.decks,a=n?.uniqueDecks||0;if(i!==1/0&&a>=i){e(`Deck limit reached (${a}/${i}).`,"error");return}t("/decks/new")}},add_cards:{title:"Add Cards",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-blue-600 to-cyan-600",action:({navigate:t})=>t("/collection")},browse_sets:{title:"Browse Sets",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),gradient:"from-green-600 to-emerald-600",action:({navigate:t})=>t("/sets")},wishlist:{title:"Wishlist",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),gradient:"from-pink-600 to-rose-600",action:({navigate:t})=>t("/collection?wishlist=true")},tournaments:{title:"Tournaments",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),gradient:"from-yellow-600 to-orange-600",action:({navigate:t})=>t("/tournaments")}},Fg=({actionType:t,data:e,size:r})=>{const n=dn(),{addToast:i}=wn(),{userProfile:a,stats:o,decks:l}=e||{},c=r==="xs",u=r==="small",f=r==="large"||r==="xlarge",p=Q0e[t];if(!p)return null;const x=()=>{p.action&&p.action({navigate:n,addToast:i,userProfile:a,stats:o})};return c?s.jsxs("button",{onClick:x,className:"group relative overflow-hidden rounded-3xl w-full h-full flex items-center justify-between px-4 transition-all active:scale-95 border border-white/5 bg-gray-900/40",title:p.title,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${p.gradient} opacity-0 group-hover:opacity-20 transition-opacity`}),s.jsx("div",{className:"flex items-center gap-2 relative z-10",children:s.jsx("div",{className:"text-[9px] font-black px-2 py-0.5 rounded-full bg-white/5 text-gray-400 group-hover:text-white uppercase tracking-tighter whitespace-nowrap border border-white/10",children:p.title})}),s.jsx("div",{className:"p-1.5 rounded-lg bg-gray-950/50 text-white group-hover:scale-110 transition-transform relative z-10",children:Ke.cloneElement(p.icon,{className:"w-4 h-4"})})]}):s.jsxs("button",{onClick:x,className:`group relative overflow-hidden rounded-3xl ${u?"p-4":"p-6"} text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 w-full h-full flex flex-col justify-center items-center bg-gray-900/40`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${p.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-2 text-gray-300 group-hover:text-white transition-colors",children:[s.jsx("div",{className:`${u?"p-2":"p-4"} bg-gray-950/50 rounded-2xl backdrop-blur-sm group-hover:scale-110 transition-all group-hover:bg-white/10 ring-1 ring-white/5 shadow-inner`,children:p.icon}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:`${u?"text-[10px]":"text-sm"} font-black uppercase tracking-widest`,children:p.title}),f&&s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1 opacity-0 group-hover:opacity-100 transition-opacity line-clamp-1",children:t==="new_deck"?"Start your next brew":t==="add_cards"?"Grow your collection":"Quick Access"})]})]})]})},epe=({size:t,actions:e})=>{const{setIsIssueModalOpen:r}=e,[n,i]=b.useState([]),[a,o]=b.useState(!1),l=t==="xs",c=t==="small",u=t==="large"||t==="xlarge";b.useEffect(()=>{l||(o(!0),Ze.getTickets({limit:5}).then(p=>i(Array.isArray(p)?p:[])).catch(p=>console.error("[SystemStatus] Load error:",p)).finally(()=>o(!1)))},[t]);const f=p=>{switch(p){case"completed":return"text-green-400";case"in_progress":return"text-yellow-400";case"planned":return"text-blue-400";default:return"text-gray-400"}};return l?s.jsxs("div",{onClick:()=>r(!0),className:"bg-indigo-500/10 border border-indigo-500/20 rounded-3xl h-full flex flex-col items-center justify-center cursor-pointer hover:bg-indigo-500/20 transition-all group",children:[s.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(99,102,241,0.5)] group-hover:scale-125 transition-transform"}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 mt-2 uppercase tracking-widest",children:"Support"})]}):s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${c?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h2",{className:"font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),"Support Hub"]}),u&&s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold mt-1",children:"Live Updates & Feedback"})]}),!c&&s.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-green-500/10 rounded-lg border border-green-500/20",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-bold text-green-400 uppercase tracking-tighter",children:"Systems Live"})]})]}),s.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[a&&n.length===0?s.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 text-xs",children:"Fetching tickets..."}):n.length>0?s.jsx("div",{className:"space-y-3",children:n.slice(0,u?4:2).map(p=>s.jsxs("div",{className:"group flex flex-col p-2.5 bg-gray-950/40 border border-white/5 rounded-xl hover:bg-gray-800/60 transition-colors cursor-pointer",onClick:()=>r(!0),children:[s.jsxs("div",{className:"flex justify-between items-start gap-2",children:[s.jsx("span",{className:"text-xs text-white font-medium truncate group-hover:text-indigo-400 transition-colors",children:p.title}),s.jsx("span",{className:`text-[9px] font-black uppercase px-1.5 py-0.5 rounded bg-white/5 ${f(p.status)} border border-white/5 whitespace-nowrap`,children:p.status?.replace("_"," ")})]}),u&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),p.votes||0]}),s.jsxs("div",{className:"text-[10px] text-gray-600",children:[" by ",p.created_by_username||"user"]})]})]},p.id))}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 italic mb-2",children:"No active tickets."}),!c&&s.jsx("p",{className:"text-[10px] text-gray-600 uppercase",children:"Found a bug? Use the button below."})]}),!u&&n.length>2&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-gray-900/40 to-transparent pointer-events-none"})]}),s.jsxs("button",{onClick:()=>r(!0),className:`w-full ${c?"h-10 text-xs":"h-12 text-sm"} bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-lg hover:shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 mt-4 shrink-0`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Report Issue"]})]})},tpe=({size:t,actions:e})=>{const{setShowBinderGuide:r,setShowPodGuide:n,setShowAuditGuide:i}=e,a=t==="xs",o=t==="small",l=t==="large",c=t==="xlarge",u=l||c;if(a)return s.jsx("div",{onClick:()=>r(!0),className:"bg-blue-900/10 border border-blue-500/20 rounded-3xl h-full flex items-center justify-center cursor-pointer hover:bg-blue-500/20 transition-all group",children:s.jsx("svg",{className:"w-6 h-6 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})});const f=[{title:"Smart Binders",desc:"Automate your collection logic",icon:"",color:"indigo",progress:80,onClick:()=>r(!0)},{title:"Pods & Sharing",desc:"Manage permissions & social",icon:"",color:"purple",progress:40,onClick:()=>n(!0)},{title:"Verification",desc:"Maintain inventory accuracy",icon:"",color:"green",progress:0,onClick:()=>i(!0)}];return s.jsxs("div",{className:`bg-gray-900/40 border border-white/5 rounded-3xl ${o?"p-4":"p-6"} backdrop-blur-md h-full flex flex-col group relative overflow-hidden`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[s.jsxs("h2",{className:"font-black text-white flex items-center gap-2 uppercase tracking-widest text-[10px]",children:[s.jsx("span",{className:"p-1.5 bg-blue-500/10 rounded-lg text-blue-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.247 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),"Learning Center"]}),c&&s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-tighter",children:"Community Knowledge Base"})]}),s.jsx("div",{className:`flex-grow relative z-10 ${u?"grid grid-cols-3 gap-4":o?"grid grid-cols-3 gap-2":"grid grid-cols-3 gap-3"}`,children:f.map((p,x)=>{const m=!o&&!u;return s.jsxs("button",{onClick:p.onClick,className:`w-full text-left ${o||m?"p-2":"p-4"} rounded-2xl bg-gray-950/40 hover:bg-gray-800 border border-white/5 hover:border-${p.color}-500/30 transition-all group/item flex ${c?"flex-col justify-between":o||m?"flex-col items-center justify-center text-center":"items-center"} gap-3 h-full`,children:[s.jsxs("div",{className:`flex ${o||m?"flex-col":""} items-center ${o||m?"gap-1":"gap-3"}`,children:[s.jsx("div",{className:`${o||m?"p-1.5":"p-2"} bg-${p.color}-500/10 rounded-xl ${o?"text-base":m?"text-lg":"text-xl"} group-hover/item:scale-110 transition-transform`,children:p.icon}),s.jsxs("div",{className:"block text-center",children:[s.jsx("div",{className:`${o||m?"text-[10px] leading-tight":"text-xs"} font-black text-gray-200 group-hover/item:text-white uppercase tracking-wide`,children:o?x===0?"Binders":x===1?"Pods":"Audit":m?s.jsx(s.Fragment,{children:p.title.split(" ").map((y,v)=>s.jsx("span",{className:"block",children:y},v))}):p.title}),u&&!c&&s.jsx("div",{className:"text-[9px] text-gray-500 font-bold mt-0.5 line-clamp-1",children:p.desc})]})]}),c&&s.jsxs("div",{className:"mt-4 w-full",children:[s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase mb-2 line-clamp-2 leading-relaxed",children:p.desc}),s.jsxs("div",{className:"flex justify-between items-center mb-1 text-[9px] font-mono",children:[s.jsx("span",{className:"text-gray-600 uppercase",children:"Progress"}),s.jsxs("span",{className:`text-${p.color}-400`,children:[p.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-900 rounded-full h-1 overflow-hidden",children:s.jsx("div",{className:`h-full bg-${p.color}-500 transition-all duration-1000 delay-${x*100}`,style:{width:`${p.progress}%`}})})]})]},x)})}),!u&&!o&&s.jsxs("button",{onClick:()=>r(!0),className:"mt-4 text-[10px] font-black text-blue-400 hover:text-blue-300 uppercase tracking-widest flex items-center gap-1 justify-center relative z-10 group/all",children:["View All Resources ",s.jsx("svg",{className:"w-3 h-3 group-hover/all:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/0 to-blue-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-700"})]})},Vx={stats_total:{title:"Total Cards",component:wfe,description:"Tracking the total volume of your magical collection.",sizes:{xs:"A micro-pill showing just the count and a label.",small:"Standard card count widget with icon.",medium:"Detailed count with growth markers.",large:"Full spread of collection statistics.",xlarge:"Deep dive into total counts and distribution."}},stats_decks:{title:"Unique Decks",component:jfe,description:"Your strategic fleet of decks currently active.",sizes:{xs:"Compact count of distinct decks.",small:"Standard deck counter.",medium:"Show total decks vs archive.",large:"Stats on deck archetypes and colors.",xlarge:"Advanced deck-building analytics."}},stats_value:{title:"Collection Value",component:Nfe,description:"Real-time market value of your entire assortment.",sizes:{xs:"Brief dollar amount with high contrast label.",small:"Value widget with currency symbol.",medium:"Display price change trends.",large:"Breakdown of most valuable items.",xlarge:"Historical value charting and top gainers."}},identity:{title:"Color Identity",component:Sfe,description:"A visual spectrum of your collection colors.",sizes:{xs:"Top color pips in a row.",small:"Pips plus name of identity.",medium:"Flavorful breakdown of colors.",large:"Percentage distribution of mana colors.",xlarge:"Deep meta-analysis and signature staples."}},quick_actions:{title:"Quick Actions",component:Cfe,description:"A dashboard hub for your most common tasks.",sizes:{xs:"Icon-only vertical stack.",small:"Balanced grid of action buttons.",medium:"Full width icon row.",large:"Detailed actions with shortcuts.",xlarge:"Admin-style toolbelt for your collection."}},action_new_deck:{title:"New Deck",component:t=>s.jsx(Fg,{...t,actionType:"new_deck"}),description:"Initiate a new deck building session.",sizes:{xs:'Simple "New" button pill.',small:"Standard action square.",medium:"Stretched action bar.",large:"Action with creative flavor text."}},action_add_cards:{title:"Add Cards",component:t=>s.jsx(Fg,{...t,actionType:"add_cards"}),description:"Quickly add cards to your library.",sizes:{xs:"Add icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with collection tips."}},action_browse:{title:"Browse Sets",component:t=>s.jsx(Fg,{...t,actionType:"browse_sets"}),description:"Explore card sets and expansions.",sizes:{xs:"Search icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with latest set spotlight."}},action_wishlist:{title:"Wishlist",component:t=>s.jsx(Fg,{...t,actionType:"wishlist"}),description:"Access your hunting list for new cards.",sizes:{xs:"Heart icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with total wishlist value."}},action_tournaments:{title:"Tournaments",component:t=>s.jsx(Fg,{...t,actionType:"tournaments"}),description:"Check upcoming events and pairings.",sizes:{xs:"Trophy icon pill.",small:"Standard action square.",medium:"Stretched action bar.",large:"Action with active pairings count."}},recent_decks:{title:"Recent Decks",component:kfe,description:"Quick access to your latest deck projects.",sizes:{xs:"Last active deck name.",small:"Commander art for the latest deck.",medium:"Last two decks with color identities.",large:"Triple deck spread with mini-summaries.",xlarge:"Full chronological deck feed."}},system_status:{title:"System Status",component:epe,description:"Real-time health pulse of the forge.",sizes:{xs:"Simple status dot.",small:"Current uptime percentage.",medium:"Detailed service status.",large:"Full system health dashboard."}},subscription:{title:"Subscription",component:Afe,description:"Manage your membership and perks.",sizes:{xs:"Tier logo pill.",small:"Current plan summary.",medium:"Plan features and renewal date.",large:"Full tier comparison and billing."}},community:{title:"My Pods",component:Efe,description:"Stay connected with your local playgroups.",sizes:{xs:"Member count pill.",small:"Active friends avatars.",medium:"Recent group activity feed.",large:"Post to pod wall / social hub.",xlarge:"Full community management center."}},social_stats:{title:"Social Battery",component:Y0e,description:"Monitor your engagement and shared assets.",sizes:{xs:"Battery percentage pill.",small:"Standard social gauge.",medium:"Share counts and feedback analytics.",large:"Detailed audience insights."}},audit:{title:"Collection Audit",component:X0e,description:"Verify your digital collection against physical cards.",sizes:{xs:"Current audit progress %.",small:"Next item in audit queue.",medium:"Audit stats and mismatch count.",large:"Detailed audit results and resume info.",xlarge:"Grand overview of collection integrity."}},tips:{title:"Forge Tips",component:Tfe,description:"Pro tips for mastering the forge.",sizes:{xs:"Tip icon pill.",small:"One random pro tip.",medium:"Daily pro trick with icons.",large:"Top 3 tips for your current tier."}},releases:{title:"New Sets",component:V0e,description:"Incoming card sets and set reviews.",sizes:{xs:"Release date pill.",small:"Latest set name.",medium:"Next 3 releases with dates.",large:"Detailed set review feed."}},guides:{title:"Guides & Resources",component:tpe,description:"Learn how to brew better decks.",sizes:{xs:"Book icon pill.",small:"Featured guide link.",medium:"Top 3 reading recommendations.",large:"Full resource library access."}},action_log:{title:"Session History",component:J0e,description:"Track your recent deck edits and actions.",sizes:{xs:"Last action pill.",small:"Scrollable list of recent actions.",medium:"Extended list with timestamps.",large:"Full session log with analysis.",xlarge:"Detailed history timeline."}},trade_matches:{title:"Trade Alerts",component:Z0e,description:"Notifications for automated trade matches in your Pod.",sizes:{xs:"Pill with match count.",small:"Standard widget with count and label.",medium:"Detailed alert box.",large:"Expanded match list preview.",xlarge:"Full trade hub integration."}}},rpe=({id:t,onAdd:e})=>{const r=Vx[t];return s.jsx(nm,{as:"div",className:"mb-2",children:({open:n})=>s.jsxs("div",{className:"group",children:[s.jsxs("div",{className:"relative flex items-center justify-between p-3 rounded-xl border border-white/5 bg-gray-900/60 hover:bg-gray-800/80 shadow-sm transition-all",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/10 text-indigo-400 group-hover:scale-110 transition-transform",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"text-[11px] font-black text-gray-200 uppercase tracking-widest truncate",children:r.title})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>e(t),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-all hover:scale-105 active:scale-95",children:"Add"}),s.jsx(nm.Button,{className:"p-1.5 rounded-lg text-gray-500 hover:text-white hover:bg-white/5 transition-all",children:s.jsx("svg",{className:`w-3.5 h-3.5 transition-transform duration-300 ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsx(Su,{show:n,enter:"transition-all duration-300 ease-out",enterFrom:"opacity-0 max-h-0",enterTo:"opacity-100 max-h-[500px]",leave:"transition-all duration-200 ease-in",leaveFrom:"opacity-100 max-h-[500px]",leaveTo:"opacity-0 max-h-0",children:s.jsxs(nm.Panel,{className:"px-4 py-3 mt-1 bg-gray-950/40 rounded-xl border border-white/5 text-[10px] space-y-3",children:[s.jsx("p",{className:"text-gray-400 font-medium italic leading-relaxed",children:r.description}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"text-[9px] font-black text-indigo-400/80 uppercase tracking-tighter",children:"Size Specifics"}),Object.entries(r.sizes||{}).map(([i,a])=>s.jsxs("div",{className:"flex gap-2 p-1.5 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[s.jsx("span",{className:"text-gray-300 font-black uppercase w-10 shrink-0 tracking-tighter",children:i}),s.jsx("span",{className:"text-gray-500 leading-tight",children:a})]},i))]})]})})]})})},npe=({layout:t,isOpen:e,onClose:r,onAddWidget:n})=>{const i=new Set(t.grid||[]),a=Object.keys(Vx).filter(o=>!i.has(o));return s.jsx(Su,{show:e,enter:"transition-transform duration-500 ease-out",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition-transform duration-300 ease-in",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",className:"fixed top-0 right-0 h-full w-80 z-[100] border-l border-white/10 shadow-2xl",children:s.jsxs("div",{className:"h-full bg-gray-950/80 backdrop-blur-2xl flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-black text-white uppercase tracking-[0.2em]",children:"Forge Library"}),s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mt-1",children:"CLICK ADD TO USE WIDGETS"})]}),s.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-white hover:bg-white/5 rounded-xl transition-all",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"flex-grow overflow-y-auto p-4 custom-scrollbar",children:a.length===0?s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40 p-8",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),s.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Library Empty"}),s.jsx("p",{className:"text-[10px] text-gray-600 mt-2 italic",children:"All available widgets are currently on your dashboard."})]}):a.map(o=>s.jsx(rpe,{id:o,onAdd:n},o))}),s.jsx("div",{className:"p-6 bg-indigo-600/5 mt-auto border-t border-white/5",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/20 text-indigo-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] font-bold text-indigo-200",children:"Pro Tip"}),s.jsx("p",{className:"text-[10px] text-indigo-400/70 leading-relaxed mt-1",children:"Widgets snap to the 12-column grid. Try placing smaller ones next to larger ones to auto-stack."})]})]})})]})})};var xq=typeof global=="object"&&global&&global.Object===Object&&global,spe=typeof self=="object"&&self&&self.Object===Object&&self,Rd=xq||spe||Function("return this")(),af=Rd.Symbol,bq=Object.prototype,ipe=bq.hasOwnProperty,ape=bq.toString,Ug=af?af.toStringTag:void 0;function ope(t){var e=ipe.call(t,Ug),r=t[Ug];try{t[Ug]=void 0;var n=!0}catch{}var i=ape.call(t);return n&&(e?t[Ug]=r:delete t[Ug]),i}var lpe=Object.prototype,cpe=lpe.toString;function dpe(t){return cpe.call(t)}var upe="[object Null]",hpe="[object Undefined]",$O=af?af.toStringTag:void 0;function Fm(t){return t==null?t===void 0?hpe:upe:$O&&$O in Object(t)?ope(t):dpe(t)}function Lu(t){return t!=null&&typeof t=="object"}var p0=Array.isArray;function ff(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function yq(t){return t}var fpe="[object AsyncFunction]",ppe="[object Function]",mpe="[object GeneratorFunction]",gpe="[object Proxy]";function fC(t){if(!ff(t))return!1;var e=Fm(t);return e==ppe||e==mpe||e==fpe||e==gpe}var gN=Rd["__core-js_shared__"],FO=(function(){var t=/[^.]+$/.exec(gN&&gN.keys&&gN.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function xpe(t){return!!FO&&FO in t}var bpe=Function.prototype,ype=bpe.toString;function M0(t){if(t!=null){try{return ype.call(t)}catch{}try{return t+""}catch{}}return""}var vpe=/[\\^$.*+?()[\]{}|]/g,wpe=/^\[object .+?Constructor\]$/,jpe=Function.prototype,Npe=Object.prototype,kpe=jpe.toString,Spe=Npe.hasOwnProperty,_pe=RegExp("^"+kpe.call(Spe).replace(vpe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Cpe(t){if(!ff(t)||xpe(t))return!1;var e=fC(t)?_pe:wpe;return e.test(M0(t))}function Ape(t,e){return t?.[e]}function P0(t,e){var r=Ape(t,e);return Cpe(r)?r:void 0}var kS=P0(Rd,"WeakMap"),UO=Object.create,Epe=(function(){function t(){}return function(e){if(!ff(e))return{};if(UO)return UO(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function Tpe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Lpe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Ope=800,Mpe=16,Ppe=Date.now;function Ipe(t){var e=0,r=0;return function(){var n=Ppe(),i=Mpe-(n-r);if(r=n,i>0){if(++e>=Ope)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Rpe(t){return function(){return t}}var f2=(function(){try{var t=P0(Object,"defineProperty");return t({},"",{}),t}catch{}})(),Dpe=f2?function(t,e){return f2(t,"toString",{configurable:!0,enumerable:!1,value:Rpe(e),writable:!0})}:yq,Bpe=Ipe(Dpe);function $pe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Fpe=9007199254740991,Upe=/^(?:0|[1-9]\d*)$/;function vq(t,e){var r=typeof t;return e=e??Fpe,!!e&&(r=="number"||r!="symbol"&&Upe.test(t))&&t>-1&&t%1==0&&t<e}function pC(t,e,r){e=="__proto__"&&f2?f2(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Db(t,e){return t===e||t!==t&&e!==e}var zpe=Object.prototype,qpe=zpe.hasOwnProperty;function wq(t,e,r){var n=t[e];(!(qpe.call(t,e)&&Db(n,r))||r===void 0&&!(e in t))&&pC(t,e,r)}function Hpe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var l=e[a],c=void 0;c===void 0&&(c=t[l]),i?pC(r,l,c):wq(r,l,c)}return r}var zO=Math.max;function Wpe(t,e,r){return e=zO(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=zO(n.length-e,0),o=Array(a);++i<a;)o[i]=n[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=n[i];return l[e]=r(o),Tpe(t,this,l)}}function Gpe(t,e){return Bpe(Wpe(t,e,yq),t+"")}var Vpe=9007199254740991;function jq(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Vpe}function zw(t){return t!=null&&jq(t.length)&&!fC(t)}function Ype(t,e,r){if(!ff(r))return!1;var n=typeof e;return(n=="number"?zw(r)&&vq(e,r.length):n=="string"&&e in r)?Db(r[e],t):!1}function Kpe(t){return Gpe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,o&&Ype(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var l=r[n];l&&t(e,l,n,a)}return e})}var Xpe=Object.prototype;function mC(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Xpe;return t===r}function Jpe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Zpe="[object Arguments]";function qO(t){return Lu(t)&&Fm(t)==Zpe}var Nq=Object.prototype,Qpe=Nq.hasOwnProperty,eme=Nq.propertyIsEnumerable,SS=qO((function(){return arguments})())?qO:function(t){return Lu(t)&&Qpe.call(t,"callee")&&!eme.call(t,"callee")};function tme(){return!1}var kq=typeof exports=="object"&&exports&&!exports.nodeType&&exports,HO=kq&&typeof module=="object"&&module&&!module.nodeType&&module,rme=HO&&HO.exports===kq,WO=rme?Rd.Buffer:void 0,nme=WO?WO.isBuffer:void 0,Yx=nme||tme,sme="[object Arguments]",ime="[object Array]",ame="[object Boolean]",ome="[object Date]",lme="[object Error]",cme="[object Function]",dme="[object Map]",ume="[object Number]",hme="[object Object]",fme="[object RegExp]",pme="[object Set]",mme="[object String]",gme="[object WeakMap]",xme="[object ArrayBuffer]",bme="[object DataView]",yme="[object Float32Array]",vme="[object Float64Array]",wme="[object Int8Array]",jme="[object Int16Array]",Nme="[object Int32Array]",kme="[object Uint8Array]",Sme="[object Uint8ClampedArray]",_me="[object Uint16Array]",Cme="[object Uint32Array]",Is={};Is[yme]=Is[vme]=Is[wme]=Is[jme]=Is[Nme]=Is[kme]=Is[Sme]=Is[_me]=Is[Cme]=!0;Is[sme]=Is[ime]=Is[xme]=Is[ame]=Is[bme]=Is[ome]=Is[lme]=Is[cme]=Is[dme]=Is[ume]=Is[hme]=Is[fme]=Is[pme]=Is[mme]=Is[gme]=!1;function Ame(t){return Lu(t)&&jq(t.length)&&!!Is[Fm(t)]}function gC(t){return function(e){return t(e)}}var Sq=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Tx=Sq&&typeof module=="object"&&module&&!module.nodeType&&module,Eme=Tx&&Tx.exports===Sq,xN=Eme&&xq.process,xm=(function(){try{var t=Tx&&Tx.require&&Tx.require("util").types;return t||xN&&xN.binding&&xN.binding("util")}catch{}})(),GO=xm&&xm.isTypedArray,xC=GO?gC(GO):Ame,Tme=Object.prototype,Lme=Tme.hasOwnProperty;function _q(t,e){var r=p0(t),n=!r&&SS(t),i=!r&&!n&&Yx(t),a=!r&&!n&&!i&&xC(t),o=r||n||i||a,l=o?Jpe(t.length,String):[],c=l.length;for(var u in t)(e||Lme.call(t,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||vq(u,c)))&&l.push(u);return l}function Cq(t,e){return function(r){return t(e(r))}}var Ome=Cq(Object.keys,Object),Mme=Object.prototype,Pme=Mme.hasOwnProperty;function Ime(t){if(!mC(t))return Ome(t);var e=[];for(var r in Object(t))Pme.call(t,r)&&r!="constructor"&&e.push(r);return e}function Rme(t){return zw(t)?_q(t):Ime(t)}function Dme(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Bme=Object.prototype,$me=Bme.hasOwnProperty;function Fme(t){if(!ff(t))return Dme(t);var e=mC(t),r=[];for(var n in t)n=="constructor"&&(e||!$me.call(t,n))||r.push(n);return r}function Aq(t){return zw(t)?_q(t,!0):Fme(t)}var Kx=P0(Object,"create");function Ume(){this.__data__=Kx?Kx(null):{},this.size=0}function zme(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var qme="__lodash_hash_undefined__",Hme=Object.prototype,Wme=Hme.hasOwnProperty;function Gme(t){var e=this.__data__;if(Kx){var r=e[t];return r===qme?void 0:r}return Wme.call(e,t)?e[t]:void 0}var Vme=Object.prototype,Yme=Vme.hasOwnProperty;function Kme(t){var e=this.__data__;return Kx?e[t]!==void 0:Yme.call(e,t)}var Xme="__lodash_hash_undefined__";function Jme(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Kx&&e===void 0?Xme:e,this}function m0(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}m0.prototype.clear=Ume;m0.prototype.delete=zme;m0.prototype.get=Gme;m0.prototype.has=Kme;m0.prototype.set=Jme;function Zme(){this.__data__=[],this.size=0}function qw(t,e){for(var r=t.length;r--;)if(Db(t[r][0],e))return r;return-1}var Qme=Array.prototype,ege=Qme.splice;function tge(t){var e=this.__data__,r=qw(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():ege.call(e,r,1),--this.size,!0}function rge(t){var e=this.__data__,r=qw(e,t);return r<0?void 0:e[r][1]}function nge(t){return qw(this.__data__,t)>-1}function sge(t,e){var r=this.__data__,n=qw(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Wu(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Wu.prototype.clear=Zme;Wu.prototype.delete=tge;Wu.prototype.get=rge;Wu.prototype.has=nge;Wu.prototype.set=sge;var Xx=P0(Rd,"Map");function ige(){this.size=0,this.__data__={hash:new m0,map:new(Xx||Wu),string:new m0}}function age(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Hw(t,e){var r=t.__data__;return age(e)?r[typeof e=="string"?"string":"hash"]:r.map}function oge(t){var e=Hw(this,t).delete(t);return this.size-=e?1:0,e}function lge(t){return Hw(this,t).get(t)}function cge(t){return Hw(this,t).has(t)}function dge(t,e){var r=Hw(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function I0(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}I0.prototype.clear=ige;I0.prototype.delete=oge;I0.prototype.get=lge;I0.prototype.has=cge;I0.prototype.set=dge;function uge(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Eq=Cq(Object.getPrototypeOf,Object),hge="[object Object]",fge=Function.prototype,pge=Object.prototype,Tq=fge.toString,mge=pge.hasOwnProperty,gge=Tq.call(Object);function xge(t){if(!Lu(t)||Fm(t)!=hge)return!1;var e=Eq(t);if(e===null)return!0;var r=mge.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Tq.call(r)==gge}function bge(){this.__data__=new Wu,this.size=0}function yge(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function vge(t){return this.__data__.get(t)}function wge(t){return this.__data__.has(t)}var jge=200;function Nge(t,e){var r=this.__data__;if(r instanceof Wu){var n=r.__data__;if(!Xx||n.length<jge-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new I0(n)}return r.set(t,e),this.size=r.size,this}function jd(t){var e=this.__data__=new Wu(t);this.size=e.size}jd.prototype.clear=bge;jd.prototype.delete=yge;jd.prototype.get=vge;jd.prototype.has=wge;jd.prototype.set=Nge;var Lq=typeof exports=="object"&&exports&&!exports.nodeType&&exports,VO=Lq&&typeof module=="object"&&module&&!module.nodeType&&module,kge=VO&&VO.exports===Lq,YO=kge?Rd.Buffer:void 0,KO=YO?YO.allocUnsafe:void 0;function Oq(t,e){if(e)return t.slice();var r=t.length,n=KO?KO(r):new t.constructor(r);return t.copy(n),n}function Sge(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a}function _ge(){return[]}var Cge=Object.prototype,Age=Cge.propertyIsEnumerable,XO=Object.getOwnPropertySymbols,Ege=XO?function(t){return t==null?[]:(t=Object(t),Sge(XO(t),function(e){return Age.call(t,e)}))}:_ge;function Tge(t,e,r){var n=e(t);return p0(t)?n:uge(n,r(t))}function _S(t){return Tge(t,Rme,Ege)}var CS=P0(Rd,"DataView"),AS=P0(Rd,"Promise"),ES=P0(Rd,"Set"),JO="[object Map]",Lge="[object Object]",ZO="[object Promise]",QO="[object Set]",eM="[object WeakMap]",tM="[object DataView]",Oge=M0(CS),Mge=M0(Xx),Pge=M0(AS),Ige=M0(ES),Rge=M0(kS),Sc=Fm;(CS&&Sc(new CS(new ArrayBuffer(1)))!=tM||Xx&&Sc(new Xx)!=JO||AS&&Sc(AS.resolve())!=ZO||ES&&Sc(new ES)!=QO||kS&&Sc(new kS)!=eM)&&(Sc=function(t){var e=Fm(t),r=e==Lge?t.constructor:void 0,n=r?M0(r):"";if(n)switch(n){case Oge:return tM;case Mge:return JO;case Pge:return ZO;case Ige:return QO;case Rge:return eM}return e});var Dge=Object.prototype,Bge=Dge.hasOwnProperty;function $ge(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Bge.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var p2=Rd.Uint8Array;function bC(t){var e=new t.constructor(t.byteLength);return new p2(e).set(new p2(t)),e}function Fge(t,e){var r=bC(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var Uge=/\w*$/;function zge(t){var e=new t.constructor(t.source,Uge.exec(t));return e.lastIndex=t.lastIndex,e}var rM=af?af.prototype:void 0,nM=rM?rM.valueOf:void 0;function qge(t){return nM?Object(nM.call(t)):{}}function Mq(t,e){var r=e?bC(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Hge="[object Boolean]",Wge="[object Date]",Gge="[object Map]",Vge="[object Number]",Yge="[object RegExp]",Kge="[object Set]",Xge="[object String]",Jge="[object Symbol]",Zge="[object ArrayBuffer]",Qge="[object DataView]",exe="[object Float32Array]",txe="[object Float64Array]",rxe="[object Int8Array]",nxe="[object Int16Array]",sxe="[object Int32Array]",ixe="[object Uint8Array]",axe="[object Uint8ClampedArray]",oxe="[object Uint16Array]",lxe="[object Uint32Array]";function cxe(t,e,r){var n=t.constructor;switch(e){case Zge:return bC(t);case Hge:case Wge:return new n(+t);case Qge:return Fge(t);case exe:case txe:case rxe:case nxe:case sxe:case ixe:case axe:case oxe:case lxe:return Mq(t,r);case Gge:return new n;case Vge:case Xge:return new n(t);case Yge:return zge(t);case Kge:return new n;case Jge:return qge(t)}}function Pq(t){return typeof t.constructor=="function"&&!mC(t)?Epe(Eq(t)):{}}var dxe="[object Map]";function uxe(t){return Lu(t)&&Sc(t)==dxe}var sM=xm&&xm.isMap,hxe=sM?gC(sM):uxe,fxe="[object Set]";function pxe(t){return Lu(t)&&Sc(t)==fxe}var iM=xm&&xm.isSet,mxe=iM?gC(iM):pxe,gxe=1,Iq="[object Arguments]",xxe="[object Array]",bxe="[object Boolean]",yxe="[object Date]",vxe="[object Error]",Rq="[object Function]",wxe="[object GeneratorFunction]",jxe="[object Map]",Nxe="[object Number]",Dq="[object Object]",kxe="[object RegExp]",Sxe="[object Set]",_xe="[object String]",Cxe="[object Symbol]",Axe="[object WeakMap]",Exe="[object ArrayBuffer]",Txe="[object DataView]",Lxe="[object Float32Array]",Oxe="[object Float64Array]",Mxe="[object Int8Array]",Pxe="[object Int16Array]",Ixe="[object Int32Array]",Rxe="[object Uint8Array]",Dxe="[object Uint8ClampedArray]",Bxe="[object Uint16Array]",$xe="[object Uint32Array]",Ss={};Ss[Iq]=Ss[xxe]=Ss[Exe]=Ss[Txe]=Ss[bxe]=Ss[yxe]=Ss[Lxe]=Ss[Oxe]=Ss[Mxe]=Ss[Pxe]=Ss[Ixe]=Ss[jxe]=Ss[Nxe]=Ss[Dq]=Ss[kxe]=Ss[Sxe]=Ss[_xe]=Ss[Cxe]=Ss[Rxe]=Ss[Dxe]=Ss[Bxe]=Ss[$xe]=!0;Ss[vxe]=Ss[Rq]=Ss[Axe]=!1;function N1(t,e,r,n,i,a){var o,l=e&gxe;if(o!==void 0)return o;if(!ff(t))return t;var c=p0(t);if(c)o=$ge(t);else{var u=Sc(t),f=u==Rq||u==wxe;if(Yx(t))return Oq(t,l);if(u==Dq||u==Iq||f&&!i)o=f?{}:Pq(t);else{if(!Ss[u])return i?t:{};o=cxe(t,u,l)}}a||(a=new jd);var p=a.get(t);if(p)return p;a.set(t,o),mxe(t)?t.forEach(function(y){o.add(N1(y,e,r,y,t,a))}):hxe(t)&&t.forEach(function(y,v){o.set(v,N1(y,e,r,v,t,a))});var x=_S,m=c?void 0:x(t);return $pe(m||t,function(y,v){m&&(v=y,y=t[v]),wq(o,v,N1(y,e,r,v,t,a))}),o}var Fxe=1,Uxe=4;function sm(t){return N1(t,Fxe|Uxe)}var zxe="__lodash_hash_undefined__";function qxe(t){return this.__data__.set(t,zxe),this}function Hxe(t){return this.__data__.has(t)}function m2(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new I0;++e<r;)this.add(t[e])}m2.prototype.add=m2.prototype.push=qxe;m2.prototype.has=Hxe;function Wxe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Gxe(t,e){return t.has(e)}var Vxe=1,Yxe=2;function Bq(t,e,r,n,i,a){var o=r&Vxe,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var u=a.get(t),f=a.get(e);if(u&&f)return u==e&&f==t;var p=-1,x=!0,m=r&Yxe?new m2:void 0;for(a.set(t,e),a.set(e,t);++p<l;){var y=t[p],v=e[p];if(n)var j=o?n(v,y,p,e,t,a):n(y,v,p,t,e,a);if(j!==void 0){if(j)continue;x=!1;break}if(m){if(!Wxe(e,function(N,C){if(!Gxe(m,C)&&(y===N||i(y,N,r,n,a)))return m.push(C)})){x=!1;break}}else if(!(y===v||i(y,v,r,n,a))){x=!1;break}}return a.delete(t),a.delete(e),x}function Kxe(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function Xxe(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Jxe=1,Zxe=2,Qxe="[object Boolean]",ebe="[object Date]",tbe="[object Error]",rbe="[object Map]",nbe="[object Number]",sbe="[object RegExp]",ibe="[object Set]",abe="[object String]",obe="[object Symbol]",lbe="[object ArrayBuffer]",cbe="[object DataView]",aM=af?af.prototype:void 0,bN=aM?aM.valueOf:void 0;function dbe(t,e,r,n,i,a,o){switch(r){case cbe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case lbe:return!(t.byteLength!=e.byteLength||!a(new p2(t),new p2(e)));case Qxe:case ebe:case nbe:return Db(+t,+e);case tbe:return t.name==e.name&&t.message==e.message;case sbe:case abe:return t==e+"";case rbe:var l=Kxe;case ibe:var c=n&Jxe;if(l||(l=Xxe),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;n|=Zxe,o.set(t,e);var f=Bq(l(t),l(e),n,i,a,o);return o.delete(t),f;case obe:if(bN)return bN.call(t)==bN.call(e)}return!1}var ube=1,hbe=Object.prototype,fbe=hbe.hasOwnProperty;function pbe(t,e,r,n,i,a){var o=r&ube,l=_S(t),c=l.length,u=_S(e),f=u.length;if(c!=f&&!o)return!1;for(var p=c;p--;){var x=l[p];if(!(o?x in e:fbe.call(e,x)))return!1}var m=a.get(t),y=a.get(e);if(m&&y)return m==e&&y==t;var v=!0;a.set(t,e),a.set(e,t);for(var j=o;++p<c;){x=l[p];var N=t[x],C=e[x];if(n)var A=o?n(C,N,x,e,t,a):n(N,C,x,t,e,a);if(!(A===void 0?N===C||i(N,C,r,n,a):A)){v=!1;break}j||(j=x=="constructor")}if(v&&!j){var L=t.constructor,O=e.constructor;L!=O&&"constructor"in t&&"constructor"in e&&!(typeof L=="function"&&L instanceof L&&typeof O=="function"&&O instanceof O)&&(v=!1)}return a.delete(t),a.delete(e),v}var mbe=1,oM="[object Arguments]",lM="[object Array]",yv="[object Object]",gbe=Object.prototype,cM=gbe.hasOwnProperty;function xbe(t,e,r,n,i,a){var o=p0(t),l=p0(e),c=o?lM:Sc(t),u=l?lM:Sc(e);c=c==oM?yv:c,u=u==oM?yv:u;var f=c==yv,p=u==yv,x=c==u;if(x&&Yx(t)){if(!Yx(e))return!1;o=!0,f=!1}if(x&&!f)return a||(a=new jd),o||xC(t)?Bq(t,e,r,n,i,a):dbe(t,e,c,r,n,i,a);if(!(r&mbe)){var m=f&&cM.call(t,"__wrapped__"),y=p&&cM.call(e,"__wrapped__");if(m||y){var v=m?t.value():t,j=y?e.value():e;return a||(a=new jd),i(v,j,r,n,a)}}return x?(a||(a=new jd),pbe(t,e,r,n,i,a)):!1}function $q(t,e,r,n,i){return t===e?!0:t==null||e==null||!Lu(t)&&!Lu(e)?t!==t&&e!==e:xbe(t,e,r,n,$q,i)}function bbe(t){return function(e,r,n){for(var i=-1,a=Object(e),o=n(e),l=o.length;l--;){var c=o[++i];if(r(a[c],c,a)===!1)break}return e}}var ybe=bbe();function TS(t,e,r){(r!==void 0&&!Db(t[e],r)||r===void 0&&!(e in t))&&pC(t,e,r)}function vbe(t){return Lu(t)&&zw(t)}function LS(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function wbe(t){return Hpe(t,Aq(t))}function jbe(t,e,r,n,i,a,o){var l=LS(t,r),c=LS(e,r),u=o.get(c);if(u){TS(t,r,u);return}var f=a?a(l,c,r+"",t,e,o):void 0,p=f===void 0;if(p){var x=p0(c),m=!x&&Yx(c),y=!x&&!m&&xC(c);f=c,x||m||y?p0(l)?f=l:vbe(l)?f=Lpe(l):m?(p=!1,f=Oq(c,!0)):y?(p=!1,f=Mq(c,!0)):f=[]:xge(c)||SS(c)?(f=l,SS(l)?f=wbe(l):(!ff(l)||fC(l))&&(f=Pq(c))):p=!1}p&&(o.set(c,f),i(f,c,n,a,o),o.delete(c)),TS(t,r,f)}function Fq(t,e,r,n,i){t!==e&&ybe(e,function(a,o){if(i||(i=new jd),ff(a))jbe(t,e,o,r,Fq,n,i);else{var l=n?n(LS(t,o),a,o+"",t,e,i):void 0;l===void 0&&(l=a),TS(t,o,l)}},Aq)}function zh(t,e){return $q(t,e)}var Qh=Kpe(function(t,e,r){Fq(t,e,r)}),fr=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(fr||{});class Ad{constructor(e,r,n={}){this.attrName=e,this.keyName=r;const i=fr.TYPE&fr.ATTRIBUTE;this.scope=n.scope!=null?n.scope&fr.LEVEL|i:fr.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(e){return Array.from(e.attributes).map(r=>r.name)}add(e,r){return this.canAdd(e,r)?(e.setAttribute(this.keyName,r),!0):!1}canAdd(e,r){return this.whitelist==null?!0:typeof r=="string"?this.whitelist.indexOf(r.replace(/["']/g,""))>-1:this.whitelist.indexOf(r)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const r=e.getAttribute(this.keyName);return this.canAdd(e,r)&&r?r:""}}class im extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const Uq=class OS{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,r=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(r){let n=null;try{n=e.parentNode}catch{return null}return this.find(n,r)}return null}create(e,r,n){const i=this.query(r);if(i==null)throw new im(`Unable to create ${r} blot`);const a=i,o=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:a.create(n),l=new a(e,o,n);return OS.blots.set(l.domNode,l),l}find(e,r=!1){return OS.find(e,r)}query(e,r=fr.ANY){let n;return typeof e=="string"?n=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?n=this.types.text:typeof e=="number"?e&fr.LEVEL&fr.BLOCK?n=this.types.block:e&fr.LEVEL&fr.INLINE&&(n=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(i=>(n=this.classes[i],!!n)),n=n||this.tags[e.tagName]),n==null?null:"scope"in n&&r&fr.LEVEL&n.scope&&r&fr.TYPE&n.scope?n:null}register(...e){return e.map(r=>{const n="blotName"in r,i="attrName"in r;if(!n&&!i)throw new im("Invalid definition");if(n&&r.blotName==="abstract")throw new im("Cannot register abstract class");const a=n?r.blotName:i?r.attrName:void 0;return this.types[a]=r,i?typeof r.keyName=="string"&&(this.attributes[r.keyName]=r):n&&(r.className&&(this.classes[r.className]=r),r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map(o=>o.toUpperCase()):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach(o=>{(this.tags[o]==null||r.className==null)&&(this.tags[o]=r)}))),r})}};Uq.blots=new WeakMap;let bm=Uq;function dM(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter(r=>r.indexOf(`${e}-`)===0)}class Nbe extends Ad{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(r=>r.split("-").slice(0,-1).join("-"))}add(e,r){return this.canAdd(e,r)?(this.remove(e),e.classList.add(`${this.keyName}-${r}`),!0):!1}remove(e){dM(e,this.keyName).forEach(r=>{e.classList.remove(r)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const r=(dM(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,r)?r:""}}const qc=Nbe;function yN(t){const e=t.split("-"),r=e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return e[0]+r}class kbe extends Ad{static keys(e){return(e.getAttribute("style")||"").split(";").map(r=>r.split(":")[0].trim())}add(e,r){return this.canAdd(e,r)?(e.style[yN(this.keyName)]=r,!0):!1}remove(e){e.style[yN(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const r=e.style[yN(this.keyName)];return this.canAdd(e,r)?r:""}}const pf=kbe;class Sbe{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,r){r?e.add(this.domNode,r)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=bm.find(this.domNode);if(e==null)return;const r=Ad.keys(this.domNode),n=qc.keys(this.domNode),i=pf.keys(this.domNode);r.concat(n).concat(i).forEach(a=>{const o=e.scroll.query(a,fr.ATTRIBUTE);o instanceof Ad&&(this.attributes[o.attrName]=o)})}copy(e){Object.keys(this.attributes).forEach(r=>{const n=this.attributes[r].value(this.domNode);e.format(r,n)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(r=>{this.attributes[r].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,r)=>(e[r]=this.attributes[r].value(this.domNode),e),{})}}const Ww=Sbe,zq=class{constructor(e,r){this.scroll=e,this.domNode=r,bm.blots.set(r,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new im("Blot definition missing tagName");let r,n;return Array.isArray(this.tagName)?(typeof e=="string"?(n=e.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof e=="number"&&(n=e),typeof n=="number"?r=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?r=document.createElement(n):r=document.createElement(this.tagName[0])):r=document.createElement(this.tagName),this.className&&r.classList.add(this.className),r}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),bm.blots.delete(this.domNode)}deleteAt(e,r){this.isolate(e,r).remove()}formatAt(e,r,n,i){const a=this.isolate(e,r);if(this.scroll.query(n,fr.BLOT)!=null&&i)a.wrap(n,i);else if(this.scroll.query(n,fr.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);a.wrap(o),o.format(n,i)}}insertAt(e,r,n){const i=n==null?this.scroll.create("text",r):this.scroll.create(r,n),a=this.split(e);this.parent.insertBefore(i,a||void 0)}isolate(e,r){const n=this.split(e);if(n==null)throw new Error("Attempt to isolate at end");return n.split(r),n}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(e,r){return e===0?this:this.next}update(e,r){}wrap(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new im(`Cannot wrap ${e}`);return n.appendChild(this),n}};zq.blotName="abstract";let qq=zq;const Hq=class extends qq{static value(e){return!0}index(e,r){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(r,1):-1}position(e,r){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Hq.scope=fr.INLINE_BLOT;let _be=Hq;const io=_be;class Cbe{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const r=e.slice(1);this.append(...r)}}at(e){const r=this.iterator();let n=r();for(;n&&e>0;)e-=1,n=r();return n}contains(e){const r=this.iterator();let n=r();for(;n;){if(n===e)return!0;n=r()}return!1}indexOf(e){const r=this.iterator();let n=r(),i=0;for(;n;){if(n===e)return i;i+=1,n=r()}return-1}insertBefore(e,r){e!=null&&(this.remove(e),e.next=r,r!=null?(e.prev=r.prev,r.prev!=null&&(r.prev.next=e),r.prev=e,r===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let r=0,n=this.head;for(;n!=null;){if(n===e)return r;r+=n.length(),n=n.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const r=e;return e!=null&&(e=e.next),r}}find(e,r=!1){const n=this.iterator();let i=n();for(;i;){const a=i.length();if(e<a||r&&e===a&&(i.next==null||i.next.length()!==0))return[i,e];e-=a,i=n()}return[null,0]}forEach(e){const r=this.iterator();let n=r();for(;n;)e(n),n=r()}forEachAt(e,r,n){if(r<=0)return;const[i,a]=this.find(e);let o=e-a;const l=this.iterator(i);let c=l();for(;c&&o<e+r;){const u=c.length();e>o?n(c,e-o,Math.min(r,o+u-e)):n(c,0,Math.min(u,e+r-o)),o+=u,c=l()}}map(e){return this.reduce((r,n)=>(r.push(e(n)),r),[])}reduce(e,r){const n=this.iterator();let i=n();for(;i;)r=e(r,i),i=n();return r}}function uM(t,e){const r=e.find(t);if(r)return r;try{return e.create(t)}catch{const n=e.create(fr.INLINE);return Array.from(t.childNodes).forEach(i=>{n.domNode.appendChild(i)}),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const Wq=class Mh extends qq{constructor(e,r){super(e,r),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,Mh.uiClass&&this.uiNode.classList.add(Mh.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Cbe,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const r=uM(e,this.scroll);this.insertBefore(r,this.children.head||void 0)}catch(r){if(r instanceof im)return;throw r}})}deleteAt(e,r){if(e===0&&r===this.length())return this.remove();this.children.forEachAt(e,r,(n,i,a)=>{n.deleteAt(i,a)})}descendant(e,r=0){const[n,i]=this.children.find(r);return e.blotName==null&&e(n)||e.blotName!=null&&n instanceof e?[n,i]:n instanceof Mh?n.descendant(e,i):[null,-1]}descendants(e,r=0,n=Number.MAX_VALUE){let i=[],a=n;return this.children.forEachAt(r,n,(o,l,c)=>{(e.blotName==null&&e(o)||e.blotName!=null&&o instanceof e)&&i.push(o),o instanceof Mh&&(i=i.concat(o.descendants(e,l,a))),a-=c}),i}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(r=>{e||this.statics.allowedChildren.some(n=>r instanceof n)||(r.statics.scope===fr.BLOCK_BLOT?(r.next!=null&&this.splitAfter(r),r.prev!=null&&this.splitAfter(r.prev),r.parent.unwrap(),e=!0):r instanceof Mh?r.unwrap():r.remove())})}formatAt(e,r,n,i){this.children.forEachAt(e,r,(a,o,l)=>{a.formatAt(o,l,n,i)})}insertAt(e,r,n){const[i,a]=this.children.find(e);if(i)i.insertAt(a,r,n);else{const o=n==null?this.scroll.create("text",r):this.scroll.create(r,n);this.appendChild(o)}}insertBefore(e,r){e.parent!=null&&e.parent.children.remove(e);let n=null;this.children.insertBefore(e,r||null),e.parent=this,r!=null&&(n=r.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(e.domNode,n),e.attach()}length(){return this.children.reduce((e,r)=>e+r.length(),0)}moveChildren(e,r){this.children.forEach(n=>{e.insertBefore(n,r)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r)}else this.remove()}path(e,r=!1){const[n,i]=this.children.find(e,r),a=[[this,e]];return n instanceof Mh?a.concat(n.path(i,r)):(n!=null&&a.push([n,i]),a)}removeChild(e){this.children.remove(e)}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return n instanceof Mh&&this.moveChildren(n),super.replaceWith(n)}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(e,this.length(),(i,a,o)=>{const l=i.split(a,r);l!=null&&n.appendChild(l)}),n}splitAfter(e){const r=this.clone();for(;e.next!=null;)r.appendChild(e.next);return this.parent&&this.parent.insertBefore(r,this.next||void 0),r}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,r){const n=[],i=[];e.forEach(a=>{a.target===this.domNode&&a.type==="childList"&&(n.push(...a.addedNodes),i.push(...a.removedNodes))}),i.forEach(a=>{if(a.parentNode!=null&&a.tagName!=="IFRAME"&&document.body.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(a);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),n.filter(a=>a.parentNode===this.domNode&&a!==this.uiNode).sort((a,o)=>a===o?0:a.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(a=>{let o=null;a.nextSibling!=null&&(o=this.scroll.find(a.nextSibling));const l=uM(a,this.scroll);(l.next!==o||l.next==null)&&(l.parent!=null&&l.parent.removeChild(this),this.insertBefore(l,o||void 0))}),this.enforceAllowedChildren()}};Wq.uiClass="";let Abe=Wq;const Pc=Abe;function Ebe(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}const Rp=class Dp extends Pc{static create(e){return super.create(e)}static formats(e,r){const n=r.query(Dp.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new Ww(this.domNode)}format(e,r){if(e===this.statics.blotName&&!r)this.children.forEach(n=>{n instanceof Dp||(n=n.wrap(Dp.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(e,fr.INLINE);if(n==null)return;n instanceof Ad?this.attributes.attribute(n,r):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r)}}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.formats()[n]!=null||this.scroll.query(n,fr.ATTRIBUTE)?this.isolate(e,r).format(n,i):super.formatAt(e,r,n,i)}optimize(e){super.optimize(e);const r=this.formats();if(Object.keys(r).length===0)return this.unwrap();const n=this.next;n instanceof Dp&&n.prev===this&&Ebe(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(e,r){const n=super.wrap(e,r);return n instanceof Dp&&this.attributes.move(n),n}};Rp.allowedChildren=[Rp,io],Rp.blotName="inline",Rp.scope=fr.INLINE_BLOT,Rp.tagName="SPAN";let Tbe=Rp;const yC=Tbe,Bp=class MS extends Pc{static create(e){return super.create(e)}static formats(e,r){const n=r.query(MS.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new Ww(this.domNode)}format(e,r){const n=this.scroll.query(e,fr.BLOCK);n!=null&&(n instanceof Ad?this.attributes.attribute(n,r):e===this.statics.blotName&&!r?this.replaceWith(MS.blotName):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r))}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.scroll.query(n,fr.BLOCK)!=null?this.format(n,i):super.formatAt(e,r,n,i)}insertAt(e,r,n){if(n==null||this.scroll.query(r,fr.INLINE)!=null)super.insertAt(e,r,n);else{const i=this.split(e);if(i!=null){const a=this.scroll.create(r,n);i.parent.insertBefore(a,i)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};Bp.blotName="block",Bp.scope=fr.BLOCK_BLOT,Bp.tagName="P",Bp.allowedChildren=[yC,Bp,io];let Lbe=Bp;const Jx=Lbe,PS=class extends Pc{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,r){super.deleteAt(e,r),this.enforceAllowedChildren()}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.enforceAllowedChildren()}insertAt(e,r,n){super.insertAt(e,r,n),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};PS.blotName="container",PS.scope=fr.BLOCK_BLOT;let Obe=PS;const Gw=Obe;class Mbe extends io{static formats(e,r){}format(e,r){super.formatAt(0,this.length(),e,r)}formatAt(e,r,n,i){e===0&&r===this.length()?this.format(n,i):super.formatAt(e,r,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const _l=Mbe,Pbe={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Ibe=100,$p=class extends Pc{constructor(e,r){super(null,r),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,Pbe),this.attach()}create(e,r){return this.registry.create(this,e,r)}find(e,r=!1){const n=this.registry.find(e,r);return n?n.scroll===this?n:r?this.find(n.scroll.domNode.parentNode,!0):null:null}query(e,r=fr.ANY){return this.registry.query(e,r)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,r){this.update(),e===0&&r===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(e,r)}formatAt(e,r,n,i){this.update(),super.formatAt(e,r,n,i)}insertAt(e,r,n){this.update(),super.insertAt(e,r,n)}optimize(e=[],r={}){super.optimize(r);const n=r.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)e.push(i.pop());const a=(c,u=!0)=>{c==null||c===this||c.domNode.parentNode!=null&&(n.has(c.domNode)||n.set(c.domNode,[]),u&&a(c.parent))},o=c=>{n.has(c.domNode)&&(c instanceof Pc&&c.children.forEach(o),n.delete(c.domNode),c.optimize(r))};let l=e;for(let c=0;l.length>0;c+=1){if(c>=Ibe)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach(u=>{const f=this.find(u.target,!0);f!=null&&(f.domNode===u.target&&(u.type==="childList"?(a(this.find(u.previousSibling,!1)),Array.from(u.addedNodes).forEach(p=>{const x=this.find(p,!1);a(x,!1),x instanceof Pc&&x.children.forEach(m=>{a(m,!1)})})):u.type==="attributes"&&a(f.prev)),a(f))}),this.children.forEach(o),l=Array.from(this.observer.takeRecords()),i=l.slice();i.length>0;)e.push(i.pop())}}update(e,r={}){e=e||this.observer.takeRecords();const n=new WeakMap;e.map(i=>{const a=this.find(i.target,!0);return a==null?null:n.has(a.domNode)?(n.get(a.domNode).push(i),null):(n.set(a.domNode,[i]),a)}).forEach(i=>{i!=null&&i!==this&&n.has(i.domNode)&&i.update(n.get(i.domNode)||[],r)}),r.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),r),this.optimize(e,r)}};$p.blotName="scroll",$p.defaultChild=Jx,$p.allowedChildren=[Jx,Gw],$p.scope=fr.BLOCK_BLOT,$p.tagName="DIV";let Rbe=$p;const vC=Rbe,IS=class Gq extends io{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,r){super(e,r),this.text=this.statics.value(this.domNode)}deleteAt(e,r){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+r)}index(e,r){return this.domNode===e?r:-1}insertAt(e,r,n){n==null?(this.text=this.text.slice(0,e)+r+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,r,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Gq&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,r=!1){return[this.domNode,e]}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(e,r){e.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};IS.blotName="text",IS.scope=fr.INLINE_BLOT;let Dbe=IS;const g2=Dbe,Bbe=Object.freeze(Object.defineProperty({__proto__:null,Attributor:Ad,AttributorStore:Ww,BlockBlot:Jx,ClassAttributor:qc,ContainerBlot:Gw,EmbedBlot:_l,InlineBlot:yC,LeafBlot:io,ParentBlot:Pc,Registry:bm,Scope:fr,ScrollBlot:vC,StyleAttributor:pf,TextBlot:g2},Symbol.toStringTag,{value:"Module"}));var vv={exports:{}},vN,hM;function $be(){if(hM)return vN;hM=1;var t=-1,e=1,r=0;function n(k,R,P,q,X){if(k===R)return k?[[r,k]]:[];if(P!=null){var G=B(k,R,P);if(G)return G}var ne=l(k,R),ee=k.substring(0,ne);k=k.substring(ne),R=R.substring(ne),ne=u(k,R);var se=k.substring(k.length-ne);k=k.substring(0,k.length-ne),R=R.substring(0,R.length-ne);var J=i(k,R);return ee&&J.unshift([r,ee]),se&&J.push([r,se]),C(J,X),q&&p(J),J}function i(k,R){var P;if(!k)return[[e,R]];if(!R)return[[t,k]];var q=k.length>R.length?k:R,X=k.length>R.length?R:k,G=q.indexOf(X);if(G!==-1)return P=[[e,q.substring(0,G)],[r,X],[e,q.substring(G+X.length)]],k.length>R.length&&(P[0][0]=P[2][0]=t),P;if(X.length===1)return[[t,k],[e,R]];var ne=f(k,R);if(ne){var ee=ne[0],se=ne[1],J=ne[2],W=ne[3],U=ne[4],Y=n(ee,J),te=n(se,W);return Y.concat([[r,U]],te)}return a(k,R)}function a(k,R){for(var P=k.length,q=R.length,X=Math.ceil((P+q)/2),G=X,ne=2*X,ee=new Array(ne),se=new Array(ne),J=0;J<ne;J++)ee[J]=-1,se[J]=-1;ee[G+1]=0,se[G+1]=0;for(var W=P-q,U=W%2!==0,Y=0,te=0,ce=0,xe=0,ue=0;ue<X;ue++){for(var ve=-ue+Y;ve<=ue-te;ve+=2){var Q=G+ve,pe;ve===-ue||ve!==ue&&ee[Q-1]<ee[Q+1]?pe=ee[Q+1]:pe=ee[Q-1]+1;for(var Ce=pe-ve;pe<P&&Ce<q&&k.charAt(pe)===R.charAt(Ce);)pe++,Ce++;if(ee[Q]=pe,pe>P)te+=2;else if(Ce>q)Y+=2;else if(U){var je=G+W-ve;if(je>=0&&je<ne&&se[je]!==-1){var we=P-se[je];if(pe>=we)return o(k,R,pe,Ce)}}}for(var Te=-ue+ce;Te<=ue-xe;Te+=2){var je=G+Te,we;Te===-ue||Te!==ue&&se[je-1]<se[je+1]?we=se[je+1]:we=se[je-1]+1;for(var oe=we-Te;we<P&&oe<q&&k.charAt(P-we-1)===R.charAt(q-oe-1);)we++,oe++;if(se[je]=we,we>P)xe+=2;else if(oe>q)ce+=2;else if(!U){var Q=G+W-Te;if(Q>=0&&Q<ne&&ee[Q]!==-1){var pe=ee[Q],Ce=G+pe-Q;if(we=P-we,pe>=we)return o(k,R,pe,Ce)}}}}return[[t,k],[e,R]]}function o(k,R,P,q){var X=k.substring(0,P),G=R.substring(0,q),ne=k.substring(P),ee=R.substring(q),se=n(X,G),J=n(ne,ee);return se.concat(J)}function l(k,R){if(!k||!R||k.charAt(0)!==R.charAt(0))return 0;for(var P=0,q=Math.min(k.length,R.length),X=q,G=0;P<X;)k.substring(G,X)==R.substring(G,X)?(P=X,G=P):q=X,X=Math.floor((q-P)/2+P);return A(k.charCodeAt(X-1))&&X--,X}function c(k,R){var P=k.length,q=R.length;if(P==0||q==0)return 0;P>q?k=k.substring(P-q):P<q&&(R=R.substring(0,P));var X=Math.min(P,q);if(k==R)return X;for(var G=0,ne=1;;){var ee=k.substring(X-ne),se=R.indexOf(ee);if(se==-1)return G;ne+=se,(se==0||k.substring(X-ne)==R.substring(0,ne))&&(G=ne,ne++)}}function u(k,R){if(!k||!R||k.slice(-1)!==R.slice(-1))return 0;for(var P=0,q=Math.min(k.length,R.length),X=q,G=0;P<X;)k.substring(k.length-X,k.length-G)==R.substring(R.length-X,R.length-G)?(P=X,G=P):q=X,X=Math.floor((q-P)/2+P);return L(k.charCodeAt(k.length-X))&&X--,X}function f(k,R){var P=k.length>R.length?k:R,q=k.length>R.length?R:k;if(P.length<4||q.length*2<P.length)return null;function X(te,ce,xe){for(var ue=te.substring(xe,xe+Math.floor(te.length/4)),ve=-1,Q="",pe,Ce,je,we;(ve=ce.indexOf(ue,ve+1))!==-1;){var Te=l(te.substring(xe),ce.substring(ve)),oe=u(te.substring(0,xe),ce.substring(0,ve));Q.length<oe+Te&&(Q=ce.substring(ve-oe,ve)+ce.substring(ve,ve+Te),pe=te.substring(0,xe-oe),Ce=te.substring(xe+Te),je=ce.substring(0,ve-oe),we=ce.substring(ve+Te))}return Q.length*2>=te.length?[pe,Ce,je,we,Q]:null}var G=X(P,q,Math.ceil(P.length/4)),ne=X(P,q,Math.ceil(P.length/2)),ee;if(!G&&!ne)return null;ne?G?ee=G[4].length>ne[4].length?G:ne:ee=ne:ee=G;var se,J,W,U;k.length>R.length?(se=ee[0],J=ee[1],W=ee[2],U=ee[3]):(W=ee[0],U=ee[1],se=ee[2],J=ee[3]);var Y=ee[4];return[se,J,W,U,Y]}function p(k){for(var R=!1,P=[],q=0,X=null,G=0,ne=0,ee=0,se=0,J=0;G<k.length;)k[G][0]==r?(P[q++]=G,ne=se,ee=J,se=0,J=0,X=k[G][1]):(k[G][0]==e?se+=k[G][1].length:J+=k[G][1].length,X&&X.length<=Math.max(ne,ee)&&X.length<=Math.max(se,J)&&(k.splice(P[q-1],0,[t,X]),k[P[q-1]+1][0]=e,q--,q--,G=q>0?P[q-1]:-1,ne=0,ee=0,se=0,J=0,X=null,R=!0)),G++;for(R&&C(k),N(k),G=1;G<k.length;){if(k[G-1][0]==t&&k[G][0]==e){var W=k[G-1][1],U=k[G][1],Y=c(W,U),te=c(U,W);Y>=te?(Y>=W.length/2||Y>=U.length/2)&&(k.splice(G,0,[r,U.substring(0,Y)]),k[G-1][1]=W.substring(0,W.length-Y),k[G+1][1]=U.substring(Y),G++):(te>=W.length/2||te>=U.length/2)&&(k.splice(G,0,[r,W.substring(0,te)]),k[G-1][0]=e,k[G-1][1]=U.substring(0,U.length-te),k[G+1][0]=t,k[G+1][1]=W.substring(te),G++),G++}G++}}var x=/[^a-zA-Z0-9]/,m=/\s/,y=/[\r\n]/,v=/\n\r?\n$/,j=/^\r?\n\r?\n/;function N(k){function R(te,ce){if(!te||!ce)return 6;var xe=te.charAt(te.length-1),ue=ce.charAt(0),ve=xe.match(x),Q=ue.match(x),pe=ve&&xe.match(m),Ce=Q&&ue.match(m),je=pe&&xe.match(y),we=Ce&&ue.match(y),Te=je&&te.match(v),oe=we&&ce.match(j);return Te||oe?5:je||we?4:ve&&!pe&&Ce?3:pe||Ce?2:ve||Q?1:0}for(var P=1;P<k.length-1;){if(k[P-1][0]==r&&k[P+1][0]==r){var q=k[P-1][1],X=k[P][1],G=k[P+1][1],ne=u(q,X);if(ne){var ee=X.substring(X.length-ne);q=q.substring(0,q.length-ne),X=ee+X.substring(0,X.length-ne),G=ee+G}for(var se=q,J=X,W=G,U=R(q,X)+R(X,G);X.charAt(0)===G.charAt(0);){q+=X.charAt(0),X=X.substring(1)+G.charAt(0),G=G.substring(1);var Y=R(q,X)+R(X,G);Y>=U&&(U=Y,se=q,J=X,W=G)}k[P-1][1]!=se&&(se?k[P-1][1]=se:(k.splice(P-1,1),P--),k[P][1]=J,W?k[P+1][1]=W:(k.splice(P+1,1),P--))}P++}}function C(k,R){k.push([r,""]);for(var P=0,q=0,X=0,G="",ne="",ee;P<k.length;){if(P<k.length-1&&!k[P][1]){k.splice(P,1);continue}switch(k[P][0]){case e:X++,ne+=k[P][1],P++;break;case t:q++,G+=k[P][1],P++;break;case r:var se=P-X-q-1;if(R){if(se>=0&&F(k[se][1])){var J=k[se][1].slice(-1);if(k[se][1]=k[se][1].slice(0,-1),G=J+G,ne=J+ne,!k[se][1]){k.splice(se,1),P--;var W=se-1;k[W]&&k[W][0]===e&&(X++,ne=k[W][1]+ne,W--),k[W]&&k[W][0]===t&&(q++,G=k[W][1]+G,W--),se=W}}if(O(k[P][1])){var J=k[P][1].charAt(0);k[P][1]=k[P][1].slice(1),G+=J,ne+=J}}if(P<k.length-1&&!k[P][1]){k.splice(P,1);break}if(G.length>0||ne.length>0){G.length>0&&ne.length>0&&(ee=l(ne,G),ee!==0&&(se>=0?k[se][1]+=ne.substring(0,ee):(k.splice(0,0,[r,ne.substring(0,ee)]),P++),ne=ne.substring(ee),G=G.substring(ee)),ee=u(ne,G),ee!==0&&(k[P][1]=ne.substring(ne.length-ee)+k[P][1],ne=ne.substring(0,ne.length-ee),G=G.substring(0,G.length-ee)));var U=X+q;G.length===0&&ne.length===0?(k.splice(P-U,U),P=P-U):G.length===0?(k.splice(P-U,U,[e,ne]),P=P-U+1):ne.length===0?(k.splice(P-U,U,[t,G]),P=P-U+1):(k.splice(P-U,U,[t,G],[e,ne]),P=P-U+2)}P!==0&&k[P-1][0]===r?(k[P-1][1]+=k[P][1],k.splice(P,1)):P++,X=0,q=0,G="",ne="";break}}k[k.length-1][1]===""&&k.pop();var Y=!1;for(P=1;P<k.length-1;)k[P-1][0]===r&&k[P+1][0]===r&&(k[P][1].substring(k[P][1].length-k[P-1][1].length)===k[P-1][1]?(k[P][1]=k[P-1][1]+k[P][1].substring(0,k[P][1].length-k[P-1][1].length),k[P+1][1]=k[P-1][1]+k[P+1][1],k.splice(P-1,1),Y=!0):k[P][1].substring(0,k[P+1][1].length)==k[P+1][1]&&(k[P-1][1]+=k[P+1][1],k[P][1]=k[P][1].substring(k[P+1][1].length)+k[P+1][1],k.splice(P+1,1),Y=!0)),P++;Y&&C(k,R)}function A(k){return k>=55296&&k<=56319}function L(k){return k>=56320&&k<=57343}function O(k){return L(k.charCodeAt(0))}function F(k){return A(k.charCodeAt(k.length-1))}function T(k){for(var R=[],P=0;P<k.length;P++)k[P][1].length>0&&R.push(k[P]);return R}function I(k,R,P,q){return F(k)||O(q)?null:T([[r,k],[t,R],[e,P],[r,q]])}function B(k,R,P){var q=typeof P=="number"?{index:P,length:0}:P.oldRange,X=typeof P=="number"?null:P.newRange,G=k.length,ne=R.length;if(q.length===0&&(X===null||X.length===0)){var ee=q.index,se=k.slice(0,ee),J=k.slice(ee),W=X?X.index:null;e:{var U=ee+ne-G;if(W!==null&&W!==U||U<0||U>ne)break e;var Y=R.slice(0,U),te=R.slice(U);if(te!==J)break e;var ce=Math.min(ee,U),xe=se.slice(0,ce),ue=Y.slice(0,ce);if(xe!==ue)break e;var ve=se.slice(ce),Q=Y.slice(ce);return I(xe,ve,Q,J)}e:{if(W!==null&&W!==ee)break e;var pe=ee,Y=R.slice(0,pe),te=R.slice(pe);if(Y!==se)break e;var Ce=Math.min(G-pe,ne-pe),je=J.slice(J.length-Ce),we=te.slice(te.length-Ce);if(je!==we)break e;var ve=J.slice(0,J.length-Ce),Q=te.slice(0,te.length-Ce);return I(se,ve,Q,je)}}if(q.length>0&&X&&X.length===0)e:{var xe=k.slice(0,q.index),je=k.slice(q.index+q.length),ce=xe.length,Ce=je.length;if(ne<ce+Ce)break e;var ue=R.slice(0,ce),we=R.slice(ne-Ce);if(xe!==ue||je!==we)break e;var ve=k.slice(ce,G-Ce),Q=R.slice(ce,ne-Ce);return I(xe,ve,Q,je)}return null}function $(k,R,P,q){return n(k,R,P,q,!0)}return $.INSERT=e,$.DELETE=t,$.EQUAL=r,vN=$,vN}var ux={exports:{}};ux.exports;var fM;function Vq(){return fM||(fM=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",f="[object Function]",p="[object GeneratorFunction]",x="[object Map]",m="[object Number]",y="[object Object]",v="[object Promise]",j="[object RegExp]",N="[object Set]",C="[object String]",A="[object Symbol]",L="[object WeakMap]",O="[object ArrayBuffer]",F="[object DataView]",T="[object Float32Array]",I="[object Float64Array]",B="[object Int8Array]",$="[object Int16Array]",k="[object Int32Array]",R="[object Uint8Array]",P="[object Uint8ClampedArray]",q="[object Uint16Array]",X="[object Uint32Array]",G=/[\\^$.*+?()[\]{}|]/g,ne=/\w*$/,ee=/^\[object .+?Constructor\]$/,se=/^(?:0|[1-9]\d*)$/,J={};J[a]=J[o]=J[O]=J[F]=J[l]=J[c]=J[T]=J[I]=J[B]=J[$]=J[k]=J[x]=J[m]=J[y]=J[j]=J[N]=J[C]=J[A]=J[R]=J[P]=J[q]=J[X]=!0,J[u]=J[f]=J[L]=!1;var W=typeof Hh=="object"&&Hh&&Hh.Object===Object&&Hh,U=typeof self=="object"&&self&&self.Object===Object&&self,Y=W||U||Function("return this")(),te=e&&!e.nodeType&&e,ce=te&&!0&&t&&!t.nodeType&&t,xe=ce&&ce.exports===te;function ue(K,me){return K.set(me[0],me[1]),K}function ve(K,me){return K.add(me),K}function Q(K,me){for(var Le=-1,at=K?K.length:0;++Le<at&&me(K[Le],Le,K)!==!1;);return K}function pe(K,me){for(var Le=-1,at=me.length,gr=K.length;++Le<at;)K[gr+Le]=me[Le];return K}function Ce(K,me,Le,at){for(var gr=-1,Kt=K?K.length:0;++gr<Kt;)Le=me(Le,K[gr],gr,K);return Le}function je(K,me){for(var Le=-1,at=Array(K);++Le<K;)at[Le]=me(Le);return at}function we(K,me){return K?.[me]}function Te(K){var me=!1;if(K!=null&&typeof K.toString!="function")try{me=!!(K+"")}catch{}return me}function oe(K){var me=-1,Le=Array(K.size);return K.forEach(function(at,gr){Le[++me]=[gr,at]}),Le}function De(K,me){return function(Le){return K(me(Le))}}function Nt(K){var me=-1,Le=Array(K.size);return K.forEach(function(at){Le[++me]=at}),Le}var ot=Array.prototype,Ne=Function.prototype,Ge=Object.prototype,Xe=Y["__core-js_shared__"],xt=(function(){var K=/[^.]+$/.exec(Xe&&Xe.keys&&Xe.keys.IE_PROTO||"");return K?"Symbol(src)_1."+K:""})(),Ae=Ne.toString,Pe=Ge.hasOwnProperty,ct=Ge.toString,bt=RegExp("^"+Ae.call(Pe).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dt=xe?Y.Buffer:void 0,Ve=Y.Symbol,lt=Y.Uint8Array,kt=De(Object.getPrototypeOf,Object),Ue=Object.create,Bt=Ge.propertyIsEnumerable,zt=ot.splice,Ot=Object.getOwnPropertySymbols,Et=dt?dt.isBuffer:void 0,$t=De(Object.keys,Object),At=Es(Y,"DataView"),Xt=Es(Y,"Map"),qt=Es(Y,"Promise"),Ht=Es(Y,"Set"),jr=Es(Y,"WeakMap"),Ct=Es(Object,"create"),Tt=Kn(At),Yt=Kn(Xt),Be=Kn(qt),Lt=Kn(Ht),Ft=Kn(jr),Ee=Ve?Ve.prototype:void 0,He=Ee?Ee.valueOf:void 0;function Mt(K){var me=-1,Le=K?K.length:0;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function Gt(){this.__data__=Ct?Ct(null):{}}function Zt(K){return this.has(K)&&delete this.__data__[K]}function Ut(K){var me=this.__data__;if(Ct){var Le=me[K];return Le===n?void 0:Le}return Pe.call(me,K)?me[K]:void 0}function It(K){var me=this.__data__;return Ct?me[K]!==void 0:Pe.call(me,K)}function Vt(K,me){var Le=this.__data__;return Le[K]=Ct&&me===void 0?n:me,this}Mt.prototype.clear=Gt,Mt.prototype.delete=Zt,Mt.prototype.get=Ut,Mt.prototype.has=It,Mt.prototype.set=Vt;function pr(K){var me=-1,Le=K?K.length:0;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function en(){this.__data__=[]}function Yr(K){var me=this.__data__,Le=ps(me,K);if(Le<0)return!1;var at=me.length-1;return Le==at?me.pop():zt.call(me,Le,1),!0}function $r(K){var me=this.__data__,Le=ps(me,K);return Le<0?void 0:me[Le][1]}function Qr(K){return ps(this.__data__,K)>-1}function pn(K,me){var Le=this.__data__,at=ps(Le,K);return at<0?Le.push([K,me]):Le[at][1]=me,this}pr.prototype.clear=en,pr.prototype.delete=Yr,pr.prototype.get=$r,pr.prototype.has=Qr,pr.prototype.set=pn;function Hr(K){var me=-1,Le=K?K.length:0;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function ss(){this.__data__={hash:new Mt,map:new(Xt||pr),string:new Mt}}function Ei(K){return Ca(this,K).delete(K)}function wi(K){return Ca(this,K).get(K)}function $s(K){return Ca(this,K).has(K)}function zi(K,me){return Ca(this,K).set(K,me),this}Hr.prototype.clear=ss,Hr.prototype.delete=Ei,Hr.prototype.get=wi,Hr.prototype.has=$s,Hr.prototype.set=zi;function jn(K){this.__data__=new pr(K)}function ze(){this.__data__=new pr}function rt(K){return this.__data__.delete(K)}function ht(K){return this.__data__.get(K)}function Rt(K){return this.__data__.has(K)}function yr(K,me){var Le=this.__data__;if(Le instanceof pr){var at=Le.__data__;if(!Xt||at.length<r-1)return at.push([K,me]),this;Le=this.__data__=new Hr(at)}return Le.set(K,me),this}jn.prototype.clear=ze,jn.prototype.delete=rt,jn.prototype.get=ht,jn.prototype.has=Rt,jn.prototype.set=yr;function Fr(K,me){var Le=Ta(K)||lr(K)?je(K.length,String):[],at=Le.length,gr=!!at;for(var Kt in K)Pe.call(K,Kt)&&!(gr&&(Kt=="length"||Io(Kt,at)))&&Le.push(Kt);return Le}function Mn(K,me,Le){var at=K[me];(!(Pe.call(K,me)&&Ea(at,Le))||Le===void 0&&!(me in K))&&(K[me]=Le)}function ps(K,me){for(var Le=K.length;Le--;)if(Ea(K[Le][0],me))return Le;return-1}function _r(K,me){return K&&Mo(me,Oa(me),K)}function qi(K,me,Le,at,gr,Kt,Or){var Dr;if(at&&(Dr=Kt?at(K,gr,Kt,Or):at(K)),Dr!==void 0)return Dr;if(!Gr(K))return K;var mn=Ta(K);if(mn){if(Dr=ll(K),!me)return lo(K,Dr)}else{var Br=oi(K),Tn=Br==f||Br==p;if(Ns(K))return Rr(K,me);if(Br==y||Br==a||Tn&&!Kt){if(Te(K))return Kt?K:{};if(Dr=Ti(Tn?{}:K),!me)return ol(K,_r(Dr,K))}else{if(!J[Br])return Kt?K:{};Dr=Po(K,Br,qi,me)}}Or||(Or=new jn);var ks=Or.get(K);if(ks)return ks;if(Or.set(K,Dr),!mn)var Vn=Le?Zs(K):Oa(K);return Q(Vn||K,function(Nn,Pn){Vn&&(Pn=Nn,Nn=K[Pn]),Mn(Dr,Pn,qi(Nn,me,Le,at,Pn,K,Or))}),Dr}function Ya(K){return Gr(K)?Ue(K):{}}function al(K,me,Le){var at=me(K);return Ta(K)?at:pe(at,Le(K))}function ji(K){return ct.call(K)}function Fs(K){if(!Gr(K)||li(K))return!1;var me=os(K)||Te(K)?bt:ee;return me.test(Kn(K))}function is(K){if(!Li(K))return $t(K);var me=[];for(var Le in Object(K))Pe.call(K,Le)&&Le!="constructor"&&me.push(Le);return me}function Rr(K,me){if(me)return K.slice();var Le=new K.constructor(K.length);return K.copy(Le),Le}function Hi(K){var me=new K.constructor(K.byteLength);return new lt(me).set(new lt(K)),me}function Us(K,me){var Le=me?Hi(K.buffer):K.buffer;return new K.constructor(Le,K.byteOffset,K.byteLength)}function Kr(K,me,Le){var at=me?Le(oe(K),!0):oe(K);return Ce(at,ue,new K.constructor)}function _a(K){var me=new K.constructor(K.source,ne.exec(K));return me.lastIndex=K.lastIndex,me}function ms(K,me,Le){var at=me?Le(Nt(K),!0):Nt(K);return Ce(at,ve,new K.constructor)}function Fn(K){return He?Object(He.call(K)):{}}function as(K,me){var Le=me?Hi(K.buffer):K.buffer;return new K.constructor(Le,K.byteOffset,K.length)}function lo(K,me){var Le=-1,at=K.length;for(me||(me=Array(at));++Le<at;)me[Le]=K[Le];return me}function Mo(K,me,Le,at){Le||(Le={});for(var gr=-1,Kt=me.length;++gr<Kt;){var Or=me[gr],Dr=void 0;Mn(Le,Or,Dr===void 0?K[Or]:Dr)}return Le}function ol(K,me){return Mo(K,Un(K),me)}function Zs(K){return al(K,Oa,Un)}function Ca(K,me){var Le=K.__data__;return Aa(me)?Le[typeof me=="string"?"string":"hash"]:Le.map}function Es(K,me){var Le=we(K,me);return Fs(Le)?Le:void 0}var Un=Ot?De(Ot,Object):Wi,oi=ji;(At&&oi(new At(new ArrayBuffer(1)))!=F||Xt&&oi(new Xt)!=x||qt&&oi(qt.resolve())!=v||Ht&&oi(new Ht)!=N||jr&&oi(new jr)!=L)&&(oi=function(K){var me=ct.call(K),Le=me==y?K.constructor:void 0,at=Le?Kn(Le):void 0;if(at)switch(at){case Tt:return F;case Yt:return x;case Be:return v;case Lt:return N;case Ft:return L}return me});function ll(K){var me=K.length,Le=K.constructor(me);return me&&typeof K[0]=="string"&&Pe.call(K,"index")&&(Le.index=K.index,Le.input=K.input),Le}function Ti(K){return typeof K.constructor=="function"&&!Li(K)?Ya(kt(K)):{}}function Po(K,me,Le,at){var gr=K.constructor;switch(me){case O:return Hi(K);case l:case c:return new gr(+K);case F:return Us(K,at);case T:case I:case B:case $:case k:case R:case P:case q:case X:return as(K,at);case x:return Kr(K,at,Le);case m:case C:return new gr(K);case j:return _a(K);case N:return ms(K,at,Le);case A:return Fn(K)}}function Io(K,me){return me=me??i,!!me&&(typeof K=="number"||se.test(K))&&K>-1&&K%1==0&&K<me}function Aa(K){var me=typeof K;return me=="string"||me=="number"||me=="symbol"||me=="boolean"?K!=="__proto__":K===null}function li(K){return!!xt&&xt in K}function Li(K){var me=K&&K.constructor,Le=typeof me=="function"&&me.prototype||Ge;return K===Le}function Kn(K){if(K!=null){try{return Ae.call(K)}catch{}try{return K+""}catch{}}return""}function Qs(K){return qi(K,!0,!0)}function Ea(K,me){return K===me||K!==K&&me!==me}function lr(K){return Ka(K)&&Pe.call(K,"callee")&&(!Bt.call(K,"callee")||ct.call(K)==a)}var Ta=Array.isArray;function La(K){return K!=null&&Xa(K.length)&&!os(K)}function Ka(K){return ci(K)&&La(K)}var Ns=Et||cl;function os(K){var me=Gr(K)?ct.call(K):"";return me==f||me==p}function Xa(K){return typeof K=="number"&&K>-1&&K%1==0&&K<=i}function Gr(K){var me=typeof K;return!!K&&(me=="object"||me=="function")}function ci(K){return!!K&&typeof K=="object"}function Oa(K){return La(K)?Fr(K):is(K)}function Wi(){return[]}function cl(){return!1}t.exports=Qs})(ux,ux.exports)),ux.exports}var hx={exports:{}};hx.exports;var pM;function Yq(){return pM||(pM=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",p="[object Date]",x="[object Error]",m="[object Function]",y="[object GeneratorFunction]",v="[object Map]",j="[object Number]",N="[object Null]",C="[object Object]",A="[object Promise]",L="[object Proxy]",O="[object RegExp]",F="[object Set]",T="[object String]",I="[object Symbol]",B="[object Undefined]",$="[object WeakMap]",k="[object ArrayBuffer]",R="[object DataView]",P="[object Float32Array]",q="[object Float64Array]",X="[object Int8Array]",G="[object Int16Array]",ne="[object Int32Array]",ee="[object Uint8Array]",se="[object Uint8ClampedArray]",J="[object Uint16Array]",W="[object Uint32Array]",U=/[\\^$.*+?()[\]{}|]/g,Y=/^\[object .+?Constructor\]$/,te=/^(?:0|[1-9]\d*)$/,ce={};ce[P]=ce[q]=ce[X]=ce[G]=ce[ne]=ce[ee]=ce[se]=ce[J]=ce[W]=!0,ce[l]=ce[c]=ce[k]=ce[f]=ce[R]=ce[p]=ce[x]=ce[m]=ce[v]=ce[j]=ce[C]=ce[O]=ce[F]=ce[T]=ce[$]=!1;var xe=typeof Hh=="object"&&Hh&&Hh.Object===Object&&Hh,ue=typeof self=="object"&&self&&self.Object===Object&&self,ve=xe||ue||Function("return this")(),Q=e&&!e.nodeType&&e,pe=Q&&!0&&t&&!t.nodeType&&t,Ce=pe&&pe.exports===Q,je=Ce&&xe.process,we=(function(){try{return je&&je.binding&&je.binding("util")}catch{}})(),Te=we&&we.isTypedArray;function oe(K,me){for(var Le=-1,at=K==null?0:K.length,gr=0,Kt=[];++Le<at;){var Or=K[Le];me(Or,Le,K)&&(Kt[gr++]=Or)}return Kt}function De(K,me){for(var Le=-1,at=me.length,gr=K.length;++Le<at;)K[gr+Le]=me[Le];return K}function Nt(K,me){for(var Le=-1,at=K==null?0:K.length;++Le<at;)if(me(K[Le],Le,K))return!0;return!1}function ot(K,me){for(var Le=-1,at=Array(K);++Le<K;)at[Le]=me(Le);return at}function Ne(K){return function(me){return K(me)}}function Ge(K,me){return K.has(me)}function Xe(K,me){return K?.[me]}function xt(K){var me=-1,Le=Array(K.size);return K.forEach(function(at,gr){Le[++me]=[gr,at]}),Le}function Ae(K,me){return function(Le){return K(me(Le))}}function Pe(K){var me=-1,Le=Array(K.size);return K.forEach(function(at){Le[++me]=at}),Le}var ct=Array.prototype,bt=Function.prototype,dt=Object.prototype,Ve=ve["__core-js_shared__"],lt=bt.toString,kt=dt.hasOwnProperty,Ue=(function(){var K=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return K?"Symbol(src)_1."+K:""})(),Bt=dt.toString,zt=RegExp("^"+lt.call(kt).replace(U,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=Ce?ve.Buffer:void 0,Et=ve.Symbol,$t=ve.Uint8Array,At=dt.propertyIsEnumerable,Xt=ct.splice,qt=Et?Et.toStringTag:void 0,Ht=Object.getOwnPropertySymbols,jr=Ot?Ot.isBuffer:void 0,Ct=Ae(Object.keys,Object),Tt=Un(ve,"DataView"),Yt=Un(ve,"Map"),Be=Un(ve,"Promise"),Lt=Un(ve,"Set"),Ft=Un(ve,"WeakMap"),Ee=Un(Object,"create"),He=Kn(Tt),Mt=Kn(Yt),Gt=Kn(Be),Zt=Kn(Lt),Ut=Kn(Ft),It=Et?Et.prototype:void 0,Vt=It?It.valueOf:void 0;function pr(K){var me=-1,Le=K==null?0:K.length;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function en(){this.__data__=Ee?Ee(null):{},this.size=0}function Yr(K){var me=this.has(K)&&delete this.__data__[K];return this.size-=me?1:0,me}function $r(K){var me=this.__data__;if(Ee){var Le=me[K];return Le===n?void 0:Le}return kt.call(me,K)?me[K]:void 0}function Qr(K){var me=this.__data__;return Ee?me[K]!==void 0:kt.call(me,K)}function pn(K,me){var Le=this.__data__;return this.size+=this.has(K)?0:1,Le[K]=Ee&&me===void 0?n:me,this}pr.prototype.clear=en,pr.prototype.delete=Yr,pr.prototype.get=$r,pr.prototype.has=Qr,pr.prototype.set=pn;function Hr(K){var me=-1,Le=K==null?0:K.length;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function ss(){this.__data__=[],this.size=0}function Ei(K){var me=this.__data__,Le=Rr(me,K);if(Le<0)return!1;var at=me.length-1;return Le==at?me.pop():Xt.call(me,Le,1),--this.size,!0}function wi(K){var me=this.__data__,Le=Rr(me,K);return Le<0?void 0:me[Le][1]}function $s(K){return Rr(this.__data__,K)>-1}function zi(K,me){var Le=this.__data__,at=Rr(Le,K);return at<0?(++this.size,Le.push([K,me])):Le[at][1]=me,this}Hr.prototype.clear=ss,Hr.prototype.delete=Ei,Hr.prototype.get=wi,Hr.prototype.has=$s,Hr.prototype.set=zi;function jn(K){var me=-1,Le=K==null?0:K.length;for(this.clear();++me<Le;){var at=K[me];this.set(at[0],at[1])}}function ze(){this.size=0,this.__data__={hash:new pr,map:new(Yt||Hr),string:new pr}}function rt(K){var me=Es(this,K).delete(K);return this.size-=me?1:0,me}function ht(K){return Es(this,K).get(K)}function Rt(K){return Es(this,K).has(K)}function yr(K,me){var Le=Es(this,K),at=Le.size;return Le.set(K,me),this.size+=Le.size==at?0:1,this}jn.prototype.clear=ze,jn.prototype.delete=rt,jn.prototype.get=ht,jn.prototype.has=Rt,jn.prototype.set=yr;function Fr(K){var me=-1,Le=K==null?0:K.length;for(this.__data__=new jn;++me<Le;)this.add(K[me])}function Mn(K){return this.__data__.set(K,n),this}function ps(K){return this.__data__.has(K)}Fr.prototype.add=Fr.prototype.push=Mn,Fr.prototype.has=ps;function _r(K){var me=this.__data__=new Hr(K);this.size=me.size}function qi(){this.__data__=new Hr,this.size=0}function Ya(K){var me=this.__data__,Le=me.delete(K);return this.size=me.size,Le}function al(K){return this.__data__.get(K)}function ji(K){return this.__data__.has(K)}function Fs(K,me){var Le=this.__data__;if(Le instanceof Hr){var at=Le.__data__;if(!Yt||at.length<r-1)return at.push([K,me]),this.size=++Le.size,this;Le=this.__data__=new jn(at)}return Le.set(K,me),this.size=Le.size,this}_r.prototype.clear=qi,_r.prototype.delete=Ya,_r.prototype.get=al,_r.prototype.has=ji,_r.prototype.set=Fs;function is(K,me){var Le=lr(K),at=!Le&&Ea(K),gr=!Le&&!at&&La(K),Kt=!Le&&!at&&!gr&&ci(K),Or=Le||at||gr||Kt,Dr=Or?ot(K.length,String):[],mn=Dr.length;for(var Br in K)kt.call(K,Br)&&!(Or&&(Br=="length"||gr&&(Br=="offset"||Br=="parent")||Kt&&(Br=="buffer"||Br=="byteLength"||Br=="byteOffset")||Po(Br,mn)))&&Dr.push(Br);return Dr}function Rr(K,me){for(var Le=K.length;Le--;)if(Qs(K[Le][0],me))return Le;return-1}function Hi(K,me,Le){var at=me(K);return lr(K)?at:De(at,Le(K))}function Us(K){return K==null?K===void 0?B:N:qt&&qt in Object(K)?oi(K):Li(K)}function Kr(K){return Gr(K)&&Us(K)==l}function _a(K,me,Le,at,gr){return K===me?!0:K==null||me==null||!Gr(K)&&!Gr(me)?K!==K&&me!==me:ms(K,me,Le,at,_a,gr)}function ms(K,me,Le,at,gr,Kt){var Or=lr(K),Dr=lr(me),mn=Or?c:Ti(K),Br=Dr?c:Ti(me);mn=mn==l?C:mn,Br=Br==l?C:Br;var Tn=mn==C,ks=Br==C,Vn=mn==Br;if(Vn&&La(K)){if(!La(me))return!1;Or=!0,Tn=!1}if(Vn&&!Tn)return Kt||(Kt=new _r),Or||ci(K)?Mo(K,me,Le,at,gr,Kt):ol(K,me,mn,Le,at,gr,Kt);if(!(Le&i)){var Nn=Tn&&kt.call(K,"__wrapped__"),Pn=ks&&kt.call(me,"__wrapped__");if(Nn||Pn){var oa=Nn?K.value():K,Ts=Pn?me.value():me;return Kt||(Kt=new _r),gr(oa,Ts,Le,at,Kt)}}return Vn?(Kt||(Kt=new _r),Zs(K,me,Le,at,gr,Kt)):!1}function Fn(K){if(!Xa(K)||Aa(K))return!1;var me=Ns(K)?zt:Y;return me.test(Kn(K))}function as(K){return Gr(K)&&os(K.length)&&!!ce[Us(K)]}function lo(K){if(!li(K))return Ct(K);var me=[];for(var Le in Object(K))kt.call(K,Le)&&Le!="constructor"&&me.push(Le);return me}function Mo(K,me,Le,at,gr,Kt){var Or=Le&i,Dr=K.length,mn=me.length;if(Dr!=mn&&!(Or&&mn>Dr))return!1;var Br=Kt.get(K);if(Br&&Kt.get(me))return Br==me;var Tn=-1,ks=!0,Vn=Le&a?new Fr:void 0;for(Kt.set(K,me),Kt.set(me,K);++Tn<Dr;){var Nn=K[Tn],Pn=me[Tn];if(at)var oa=Or?at(Pn,Nn,Tn,me,K,Kt):at(Nn,Pn,Tn,K,me,Kt);if(oa!==void 0){if(oa)continue;ks=!1;break}if(Vn){if(!Nt(me,function(Ts,la){if(!Ge(Vn,la)&&(Nn===Ts||gr(Nn,Ts,Le,at,Kt)))return Vn.push(la)})){ks=!1;break}}else if(!(Nn===Pn||gr(Nn,Pn,Le,at,Kt))){ks=!1;break}}return Kt.delete(K),Kt.delete(me),ks}function ol(K,me,Le,at,gr,Kt,Or){switch(Le){case R:if(K.byteLength!=me.byteLength||K.byteOffset!=me.byteOffset)return!1;K=K.buffer,me=me.buffer;case k:return!(K.byteLength!=me.byteLength||!Kt(new $t(K),new $t(me)));case f:case p:case j:return Qs(+K,+me);case x:return K.name==me.name&&K.message==me.message;case O:case T:return K==me+"";case v:var Dr=xt;case F:var mn=at&i;if(Dr||(Dr=Pe),K.size!=me.size&&!mn)return!1;var Br=Or.get(K);if(Br)return Br==me;at|=a,Or.set(K,me);var Tn=Mo(Dr(K),Dr(me),at,gr,Kt,Or);return Or.delete(K),Tn;case I:if(Vt)return Vt.call(K)==Vt.call(me)}return!1}function Zs(K,me,Le,at,gr,Kt){var Or=Le&i,Dr=Ca(K),mn=Dr.length,Br=Ca(me),Tn=Br.length;if(mn!=Tn&&!Or)return!1;for(var ks=mn;ks--;){var Vn=Dr[ks];if(!(Or?Vn in me:kt.call(me,Vn)))return!1}var Nn=Kt.get(K);if(Nn&&Kt.get(me))return Nn==me;var Pn=!0;Kt.set(K,me),Kt.set(me,K);for(var oa=Or;++ks<mn;){Vn=Dr[ks];var Ts=K[Vn],la=me[Vn];if(at)var z=Or?at(la,Ts,Vn,me,K,Kt):at(Ts,la,Vn,K,me,Kt);if(!(z===void 0?Ts===la||gr(Ts,la,Le,at,Kt):z)){Pn=!1;break}oa||(oa=Vn=="constructor")}if(Pn&&!oa){var ae=K.constructor,ke=me.constructor;ae!=ke&&"constructor"in K&&"constructor"in me&&!(typeof ae=="function"&&ae instanceof ae&&typeof ke=="function"&&ke instanceof ke)&&(Pn=!1)}return Kt.delete(K),Kt.delete(me),Pn}function Ca(K){return Hi(K,Oa,ll)}function Es(K,me){var Le=K.__data__;return Io(me)?Le[typeof me=="string"?"string":"hash"]:Le.map}function Un(K,me){var Le=Xe(K,me);return Fn(Le)?Le:void 0}function oi(K){var me=kt.call(K,qt),Le=K[qt];try{K[qt]=void 0;var at=!0}catch{}var gr=Bt.call(K);return at&&(me?K[qt]=Le:delete K[qt]),gr}var ll=Ht?function(K){return K==null?[]:(K=Object(K),oe(Ht(K),function(me){return At.call(K,me)}))}:Wi,Ti=Us;(Tt&&Ti(new Tt(new ArrayBuffer(1)))!=R||Yt&&Ti(new Yt)!=v||Be&&Ti(Be.resolve())!=A||Lt&&Ti(new Lt)!=F||Ft&&Ti(new Ft)!=$)&&(Ti=function(K){var me=Us(K),Le=me==C?K.constructor:void 0,at=Le?Kn(Le):"";if(at)switch(at){case He:return R;case Mt:return v;case Gt:return A;case Zt:return F;case Ut:return $}return me});function Po(K,me){return me=me??o,!!me&&(typeof K=="number"||te.test(K))&&K>-1&&K%1==0&&K<me}function Io(K){var me=typeof K;return me=="string"||me=="number"||me=="symbol"||me=="boolean"?K!=="__proto__":K===null}function Aa(K){return!!Ue&&Ue in K}function li(K){var me=K&&K.constructor,Le=typeof me=="function"&&me.prototype||dt;return K===Le}function Li(K){return Bt.call(K)}function Kn(K){if(K!=null){try{return lt.call(K)}catch{}try{return K+""}catch{}}return""}function Qs(K,me){return K===me||K!==K&&me!==me}var Ea=Kr((function(){return arguments})())?Kr:function(K){return Gr(K)&&kt.call(K,"callee")&&!At.call(K,"callee")},lr=Array.isArray;function Ta(K){return K!=null&&os(K.length)&&!Ns(K)}var La=jr||cl;function Ka(K,me){return _a(K,me)}function Ns(K){if(!Xa(K))return!1;var me=Us(K);return me==m||me==y||me==u||me==L}function os(K){return typeof K=="number"&&K>-1&&K%1==0&&K<=o}function Xa(K){var me=typeof K;return K!=null&&(me=="object"||me=="function")}function Gr(K){return K!=null&&typeof K=="object"}var ci=Te?Ne(Te):as;function Oa(K){return Ta(K)?is(K):lo(K)}function Wi(){return[]}function cl(){return!1}t.exports=Ka})(hx,hx.exports)),hx.exports}var wv={},mM;function Fbe(){if(mM)return wv;mM=1,Object.defineProperty(wv,"__esModule",{value:!0});const t=Vq(),e=Yq();var r;return(function(n){function i(c={},u={},f=!1){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});let p=t(u);f||(p=Object.keys(p).reduce((x,m)=>(p[m]!=null&&(x[m]=p[m]),x),{}));for(const x in c)c[x]!==void 0&&u[x]===void 0&&(p[x]=c[x]);return Object.keys(p).length>0?p:void 0}n.compose=i;function a(c={},u={}){typeof c!="object"&&(c={}),typeof u!="object"&&(u={});const f=Object.keys(c).concat(Object.keys(u)).reduce((p,x)=>(e(c[x],u[x])||(p[x]=u[x]===void 0?null:u[x]),p),{});return Object.keys(f).length>0?f:void 0}n.diff=a;function o(c={},u={}){c=c||{};const f=Object.keys(u).reduce((p,x)=>(u[x]!==c[x]&&c[x]!==void 0&&(p[x]=u[x]),p),{});return Object.keys(c).reduce((p,x)=>(c[x]!==u[x]&&u[x]===void 0&&(p[x]=null),p),f)}n.invert=o;function l(c,u,f=!1){if(typeof c!="object")return u;if(typeof u!="object")return;if(!f)return u;const p=Object.keys(u).reduce((x,m)=>(c[m]===void 0&&(x[m]=u[m]),x),{});return Object.keys(p).length>0?p:void 0}n.transform=l})(r||(r={})),wv.default=r,wv}var jv={},gM;function Kq(){if(gM)return jv;gM=1,Object.defineProperty(jv,"__esModule",{value:!0});var t;return(function(e){function r(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=r})(t||(t={})),jv.default=t,jv}var Nv={},xM;function Ube(){if(xM)return Nv;xM=1,Object.defineProperty(Nv,"__esModule",{value:!0});const t=Kq();class e{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const i=this.ops[this.index];if(i){const a=this.offset,o=t.default.length(i);if(n>=o-a?(n=o-a,this.index+=1,this.offset=0):this.offset+=n,typeof i.delete=="number")return{delete:n};{const l={};return i.attributes&&(l.attributes=i.attributes),typeof i.retain=="number"?l.retain=n:typeof i.retain=="object"&&i.retain!==null?l.retain=i.retain:typeof i.insert=="string"?l.insert=i.insert.substr(a,n):l.insert=i.insert,l}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?t.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,i=this.index,a=this.next(),o=this.ops.slice(this.index);return this.offset=n,this.index=i,[a].concat(o)}}else return[]}}return Nv.default=e,Nv}var bM;function zbe(){return bM||(bM=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const r=$be(),n=Vq(),i=Yq(),a=Fbe();e.AttributeMap=a.default;const o=Kq();e.Op=o.default;const l=Ube();e.OpIterator=l.default;const c="\0",u=(p,x)=>{if(typeof p!="object"||p===null)throw new Error(`cannot retain a ${typeof p}`);if(typeof x!="object"||x===null)throw new Error(`cannot retain a ${typeof x}`);const m=Object.keys(p)[0];if(!m||m!==Object.keys(x)[0])throw new Error(`embed types not matched: ${m} != ${Object.keys(x)[0]}`);return[m,p[m],x[m]]};class f{constructor(x){Array.isArray(x)?this.ops=x:x!=null&&Array.isArray(x.ops)?this.ops=x.ops:this.ops=[]}static registerEmbed(x,m){this.handlers[x]=m}static unregisterEmbed(x){delete this.handlers[x]}static getHandler(x){const m=this.handlers[x];if(!m)throw new Error(`no handlers for embed type "${x}"`);return m}insert(x,m){const y={};return typeof x=="string"&&x.length===0?this:(y.insert=x,m!=null&&typeof m=="object"&&Object.keys(m).length>0&&(y.attributes=m),this.push(y))}delete(x){return x<=0?this:this.push({delete:x})}retain(x,m){if(typeof x=="number"&&x<=0)return this;const y={retain:x};return m!=null&&typeof m=="object"&&Object.keys(m).length>0&&(y.attributes=m),this.push(y)}push(x){let m=this.ops.length,y=this.ops[m-1];if(x=n(x),typeof y=="object"){if(typeof x.delete=="number"&&typeof y.delete=="number")return this.ops[m-1]={delete:y.delete+x.delete},this;if(typeof y.delete=="number"&&x.insert!=null&&(m-=1,y=this.ops[m-1],typeof y!="object"))return this.ops.unshift(x),this;if(i(x.attributes,y.attributes)){if(typeof x.insert=="string"&&typeof y.insert=="string")return this.ops[m-1]={insert:y.insert+x.insert},typeof x.attributes=="object"&&(this.ops[m-1].attributes=x.attributes),this;if(typeof x.retain=="number"&&typeof y.retain=="number")return this.ops[m-1]={retain:y.retain+x.retain},typeof x.attributes=="object"&&(this.ops[m-1].attributes=x.attributes),this}}return m===this.ops.length?this.ops.push(x):this.ops.splice(m,0,x),this}chop(){const x=this.ops[this.ops.length-1];return x&&typeof x.retain=="number"&&!x.attributes&&this.ops.pop(),this}filter(x){return this.ops.filter(x)}forEach(x){this.ops.forEach(x)}map(x){return this.ops.map(x)}partition(x){const m=[],y=[];return this.forEach(v=>{(x(v)?m:y).push(v)}),[m,y]}reduce(x,m){return this.ops.reduce(x,m)}changeLength(){return this.reduce((x,m)=>m.insert?x+o.default.length(m):m.delete?x-m.delete:x,0)}length(){return this.reduce((x,m)=>x+o.default.length(m),0)}slice(x=0,m=1/0){const y=[],v=new l.default(this.ops);let j=0;for(;j<m&&v.hasNext();){let N;j<x?N=v.next(x-j):(N=v.next(m-j),y.push(N)),j+=o.default.length(N)}return new f(y)}compose(x){const m=new l.default(this.ops),y=new l.default(x.ops),v=[],j=y.peek();if(j!=null&&typeof j.retain=="number"&&j.attributes==null){let C=j.retain;for(;m.peekType()==="insert"&&m.peekLength()<=C;)C-=m.peekLength(),v.push(m.next());j.retain-C>0&&y.next(j.retain-C)}const N=new f(v);for(;m.hasNext()||y.hasNext();)if(y.peekType()==="insert")N.push(y.next());else if(m.peekType()==="delete")N.push(m.next());else{const C=Math.min(m.peekLength(),y.peekLength()),A=m.next(C),L=y.next(C);if(L.retain){const O={};if(typeof A.retain=="number")O.retain=typeof L.retain=="number"?C:L.retain;else if(typeof L.retain=="number")A.retain==null?O.insert=A.insert:O.retain=A.retain;else{const T=A.retain==null?"insert":"retain",[I,B,$]=u(A[T],L.retain),k=f.getHandler(I);O[T]={[I]:k.compose(B,$,T==="retain")}}const F=a.default.compose(A.attributes,L.attributes,typeof A.retain=="number");if(F&&(O.attributes=F),N.push(O),!y.hasNext()&&i(N.ops[N.ops.length-1],O)){const T=new f(m.rest());return N.concat(T).chop()}}else typeof L.delete=="number"&&(typeof A.retain=="number"||typeof A.retain=="object"&&A.retain!==null)&&N.push(L)}return N.chop()}concat(x){const m=new f(this.ops.slice());return x.ops.length>0&&(m.push(x.ops[0]),m.ops=m.ops.concat(x.ops.slice(1))),m}diff(x,m){if(this.ops===x.ops)return new f;const y=[this,x].map(A=>A.map(L=>{if(L.insert!=null)return typeof L.insert=="string"?L.insert:c;const O=A===x?"on":"with";throw new Error("diff() called "+O+" non-document")}).join("")),v=new f,j=r(y[0],y[1],m,!0),N=new l.default(this.ops),C=new l.default(x.ops);return j.forEach(A=>{let L=A[1].length;for(;L>0;){let O=0;switch(A[0]){case r.INSERT:O=Math.min(C.peekLength(),L),v.push(C.next(O));break;case r.DELETE:O=Math.min(L,N.peekLength()),N.next(O),v.delete(O);break;case r.EQUAL:O=Math.min(N.peekLength(),C.peekLength(),L);const F=N.next(O),T=C.next(O);i(F.insert,T.insert)?v.retain(O,a.default.diff(F.attributes,T.attributes)):v.push(T).delete(O);break}L-=O}}),v.chop()}eachLine(x,m=`
`){const y=new l.default(this.ops);let v=new f,j=0;for(;y.hasNext();){if(y.peekType()!=="insert")return;const N=y.peek(),C=o.default.length(N)-y.peekLength(),A=typeof N.insert=="string"?N.insert.indexOf(m,C)-C:-1;if(A<0)v.push(y.next());else if(A>0)v.push(y.next(A));else{if(x(v,y.next(1).attributes||{},j)===!1)return;j+=1,v=new f}}v.length()>0&&x(v,{},j)}invert(x){const m=new f;return this.reduce((y,v)=>{if(v.insert)m.delete(o.default.length(v));else{if(typeof v.retain=="number"&&v.attributes==null)return m.retain(v.retain),y+v.retain;if(v.delete||typeof v.retain=="number"){const j=v.delete||v.retain;return x.slice(y,y+j).forEach(C=>{v.delete?m.push(C):v.retain&&v.attributes&&m.retain(o.default.length(C),a.default.invert(v.attributes,C.attributes))}),y+j}else if(typeof v.retain=="object"&&v.retain!==null){const j=x.slice(y,y+1),N=new l.default(j.ops).next(),[C,A,L]=u(v.retain,N.insert),O=f.getHandler(C);return m.retain({[C]:O.invert(A,L)},a.default.invert(v.attributes,N.attributes)),y+1}}return y},0),m.chop()}transform(x,m=!1){if(m=!!m,typeof x=="number")return this.transformPosition(x,m);const y=x,v=new l.default(this.ops),j=new l.default(y.ops),N=new f;for(;v.hasNext()||j.hasNext();)if(v.peekType()==="insert"&&(m||j.peekType()!=="insert"))N.retain(o.default.length(v.next()));else if(j.peekType()==="insert")N.push(j.next());else{const C=Math.min(v.peekLength(),j.peekLength()),A=v.next(C),L=j.next(C);if(A.delete)continue;if(L.delete)N.push(L);else{const O=A.retain,F=L.retain;let T=typeof F=="object"&&F!==null?F:C;if(typeof O=="object"&&O!==null&&typeof F=="object"&&F!==null){const I=Object.keys(O)[0];if(I===Object.keys(F)[0]){const B=f.getHandler(I);B&&(T={[I]:B.transform(O[I],F[I],m)})}}N.retain(T,a.default.transform(A.attributes,L.attributes,m))}}return N.chop()}transformPosition(x,m=!1){m=!!m;const y=new l.default(this.ops);let v=0;for(;y.hasNext()&&v<=x;){const j=y.peekLength(),N=y.peekType();if(y.next(),N==="delete"){x-=Math.min(j,x-v);continue}else N==="insert"&&(v<x||!m)&&(x+=j);v+=j}return x}}f.Op=o.default,f.OpIterator=l.default,f.AttributeMap=a.default,f.handlers={},e.default=f,t.exports=f,t.exports.default=f})(vv,vv.exports)),vv.exports}var Xl=zbe();const hr=Co(Xl);class Hc extends _l{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Hc.blotName="break";Hc.tagName="BR";let Bc=class extends g2{};const qbe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Vw(t){return t.replace(/[&<>"']/g,e=>qbe[e])}class xo extends yC{static allowedChildren=[xo,Hc,_l,Bc];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,r){const n=xo.order.indexOf(e),i=xo.order.indexOf(r);return n>=0||i>=0?n-i:e===r?0:e<r?-1:1}formatAt(e,r,n,i){if(xo.compare(this.statics.blotName,n)<0&&this.scroll.query(n,fr.BLOT)){const a=this.isolate(e,r);i&&a.wrap(n,i)}else super.formatAt(e,r,n,i)}optimize(e){if(super.optimize(e),this.parent instanceof xo&&xo.compare(this.statics.blotName,this.parent.statics.blotName)>0){const r=this.parent.isolate(this.offset(),this.length());this.moveChildren(r),r.wrap(this)}}}const yM=1;class Wa extends Jx{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Xq(this)),this.cache.delta}deleteAt(e,r){super.deleteAt(e,r),this.cache={}}formatAt(e,r,n,i){r<=0||(this.scroll.query(n,fr.BLOCK)?e+r===this.length()&&this.format(n,i):super.formatAt(e,Math.min(r,this.length()-e-1),n,i),this.cache={})}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n),this.cache={};return}if(r.length===0)return;const i=r.split(`
`),a=i.shift();a.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});let o=this;i.reduce((l,c)=>(o=o.split(l,!0),o.insertAt(0,c),c.length),e+a.length)}insertBefore(e,r){const{head:n}=this.children;super.insertBefore(e,r),n instanceof Hc&&n.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+yM),this.cache.length}moveChildren(e,r){super.moveChildren(e,r),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(e===0||e>=this.length()-yM)){const i=this.clone();return e===0?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}const n=super.split(e,r);return this.cache={},n}}Wa.blotName="block";Wa.tagName="P";Wa.defaultChild=Hc;Wa.allowedChildren=[Hc,xo,_l,Bc];class Kl extends _l{attach(){super.attach(),this.attributes=new Ww(this.domNode)}delta(){return new hr().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,r){const n=this.scroll.query(e,fr.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,r)}formatAt(e,r,n,i){this.format(n,i)}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n);return}const i=r.split(`
`),a=i.pop(),o=i.map(c=>{const u=this.scroll.create(Wa.blotName);return u.insertAt(0,c),u}),l=this.split(e);o.forEach(c=>{this.parent.insertBefore(c,l)}),a&&this.parent.insertBefore(this.scroll.create("text",a),l)}}Kl.scope=fr.BLOCK_BLOT;function Xq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.descendants(io).reduce((r,n)=>n.length()===0?r:r.insert(n.value(),Vl(n,{},e)),new hr).insert(`
`,Vl(t))}function Vl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return t==null||("formats"in t&&typeof t.formats=="function"&&(e={...e,...t.formats()},r&&delete e["code-token"]),t.parent==null||t.parent.statics.blotName==="scroll"||t.parent.statics.scope!==t.statics.scope)?e:Vl(t.parent,e,r)}let Yw=class Rf extends _l{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,r,n){super(e,r),this.selection=n,this.textNode=document.createTextNode(Rf.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,r){if(this.savedLength!==0){super.format(e,r);return}let n=this,i=0;for(;n!=null&&n.statics.scope!==fr.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=Rf.CONTENTS.length,n.optimize(),n.formatAt(i,Rf.CONTENTS.length,e,r),this.savedLength=0)}index(e,r){return e===this.textNode?0:super.index(e,r)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const r=this.prev instanceof Bc?this.prev:null,n=r?r.length():0,i=this.next instanceof Bc?this.next:null,a=i?i.text:"",{textNode:o}=this,l=o.data.split(Rf.CONTENTS).join("");o.data=Rf.CONTENTS;let c;if(r)c=r,(l||i)&&(r.insertAt(r.length(),l+a),i&&i.remove());else if(i)c=i,i.insertAt(0,l);else{const u=document.createTextNode(l);c=this.scroll.create(u),this.parent.insertBefore(c,this)}if(this.remove(),e){const u=(x,m)=>r&&x===r.domNode?m:x===o?n+m-1:i&&x===i.domNode?n+l.length+m:null,f=u(e.start.node,e.start.offset),p=u(e.end.node,e.end.offset);if(f!==null&&p!==null)return{startNode:c.domNode,startOffset:f,endNode:c.domNode,endOffset:p}}return null}update(e,r){if(e.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(r.range=n)}}optimize(e){super.optimize(e);let{parent:r}=this;for(;r;){if(r.domNode.tagName==="A"){this.savedLength=Rf.CONTENTS.length,r.isolate(this.offset(r),this.length()).unwrap(),this.savedLength=0;break}r=r.parent}}value(){return""}};var wN={exports:{}},vM;function Hbe(){return vM||(vM=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function a(c,u,f,p,x){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new i(f,p||c,x),y=r?r+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],m]:c._events[y].push(m):(c._events[y]=m,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,p;if(this._eventsCount===0)return u;for(p in f=this._events)e.call(f,p)&&u.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=r?r+u:u,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var x=0,m=p.length,y=new Array(m);x<m;x++)y[x]=p[x].fn;return y},l.prototype.listenerCount=function(u){var f=r?r+u:u,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(u,f,p,x,m,y){var v=r?r+u:u;if(!this._events[v])return!1;var j=this._events[v],N=arguments.length,C,A;if(j.fn){switch(j.once&&this.removeListener(u,j.fn,void 0,!0),N){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,f),!0;case 3:return j.fn.call(j.context,f,p),!0;case 4:return j.fn.call(j.context,f,p,x),!0;case 5:return j.fn.call(j.context,f,p,x,m),!0;case 6:return j.fn.call(j.context,f,p,x,m,y),!0}for(A=1,C=new Array(N-1);A<N;A++)C[A-1]=arguments[A];j.fn.apply(j.context,C)}else{var L=j.length,O;for(A=0;A<L;A++)switch(j[A].once&&this.removeListener(u,j[A].fn,void 0,!0),N){case 1:j[A].fn.call(j[A].context);break;case 2:j[A].fn.call(j[A].context,f);break;case 3:j[A].fn.call(j[A].context,f,p);break;case 4:j[A].fn.call(j[A].context,f,p,x);break;default:if(!C)for(O=1,C=new Array(N-1);O<N;O++)C[O-1]=arguments[O];j[A].fn.apply(j[A].context,C)}}return!0},l.prototype.on=function(u,f,p){return a(this,u,f,p,!1)},l.prototype.once=function(u,f,p){return a(this,u,f,p,!0)},l.prototype.removeListener=function(u,f,p,x){var m=r?r+u:u;if(!this._events[m])return this;if(!f)return o(this,m),this;var y=this._events[m];if(y.fn)y.fn===f&&(!x||y.once)&&(!p||y.context===p)&&o(this,m);else{for(var v=0,j=[],N=y.length;v<N;v++)(y[v].fn!==f||x&&!y[v].once||p&&y[v].context!==p)&&j.push(y[v]);j.length?this._events[m]=j.length===1?j[0]:j:o(this,m)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(wN)),wN.exports}var Wbe=Hbe();const Jq=Co(Wbe),RS=new WeakMap,DS=["error","warn","log","info"];let BS="warn";function Zq(t){if(BS&&DS.indexOf(t)<=DS.indexOf(BS)){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];console[t](...r)}}function Gu(t){return DS.reduce((e,r)=>(e[r]=Zq.bind(console,r,t),e),{})}Gu.level=t=>{BS=t};Zq.level=Gu.level;const jN=Gu("quill:events"),Gbe=["selectionchange","mousedown","mouseup","click"];Gbe.forEach(t=>{document.addEventListener(t,function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(i=>{const a=RS.get(i);a&&a.emitter&&a.emitter.handleDOM(...r)})})});class dr extends Jq{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",jN.error)}emit(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return jN.log.call(jN,...r),super.emit(...r)}handleDOM(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(this.domListeners[e.type]||[]).forEach(a=>{let{node:o,handler:l}=a;(e.target===o||o.contains(e.target))&&l(e,...n)})}listenDOM(e,r,n){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:r,handler:n})}}const NN=Gu("quill:selection");class g0{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=r}}class Vbe{constructor(e,r){this.emitter=r,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new g0(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,dr.sources.USER),1)}),this.emitter.on(dr.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(dr.events.SCROLL_UPDATE,(i,a)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const o=a.some(l=>l.type==="characterData"||l.type==="childList"||l.type==="attributes"&&l.target===this.root);this.update(o?dr.sources.SILENT:i)}catch{}})}),this.emitter.on(dr.events.SCROLL_OPTIMIZE,(n,i)=>{if(i.range){const{startNode:a,startOffset:o,endNode:l,endOffset:c}=i.range;this.setNativeRange(a,o,l,c),this.update(dr.sources.SILENT)}}),this.update(dr.sources.SILENT)}handleComposition(){this.emitter.on(dr.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(dr.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(dr.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,r){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(e,fr.BLOCK))){if(n.start.node!==this.cursor.textNode){const i=this.scroll.find(n.start.node,!1);if(i==null)return;if(i instanceof io){const a=i.split(n.start.offset);i.parent.insertBefore(this.cursor,a)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,r),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();e=Math.min(e,n-1),r=Math.min(e+r,n-1)-e;let i,[a,o]=this.scroll.leaf(e);if(a==null)return null;if(r>0&&o===a.length()){const[f]=this.scroll.leaf(e+1);if(f){const[p]=this.scroll.line(e),[x]=this.scroll.line(e+1);p===x&&(a=f,o=0)}}[i,o]=a.position(o,!0);const l=document.createRange();if(r>0)return l.setStart(i,o),[a,o]=this.scroll.leaf(e+r),a==null?null:([i,o]=a.position(o,!0),l.setEnd(i,o),l.getBoundingClientRect());let c="left",u;if(i instanceof Text){if(!i.data.length)return null;o<i.data.length?(l.setStart(i,o),l.setEnd(i,o+1)):(l.setStart(i,o-1),l.setEnd(i,o),c="right"),u=l.getBoundingClientRect()}else{if(!(a.domNode instanceof Element))return null;u=a.domNode.getBoundingClientRect(),o>0&&(c="right")}return{bottom:u.top+u.height,height:u.height,left:u[c],right:u[c],top:u.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const r=e.getRangeAt(0);if(r==null)return null;const n=this.normalizeNative(r);return NN.info("getNativeRange",n),n}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const r=this.getNativeRange();return r==null?[null,null]:[this.normalizedToRange(r),r]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&kN(this.root,document.activeElement)}normalizedToRange(e){const r=[[e.start.node,e.start.offset]];e.native.collapsed||r.push([e.end.node,e.end.offset]);const n=r.map(o=>{const[l,c]=o,u=this.scroll.find(l,!0),f=u.offset(this.scroll);return c===0?f:u instanceof io?f+u.index(l,c):f+u.length()}),i=Math.min(Math.max(...n),this.scroll.length()-1),a=Math.min(i,...n);return new g0(a,i-a)}normalizeNative(e){if(!kN(this.root,e.startContainer)||!e.collapsed&&!kN(this.root,e.endContainer))return null;const r={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[r.start,r.end].forEach(n=>{let{node:i,offset:a}=n;for(;!(i instanceof Text)&&i.childNodes.length>0;)if(i.childNodes.length>a)i=i.childNodes[a],a=0;else if(i.childNodes.length===a)i=i.lastChild,i instanceof Text?a=i.data.length:i.childNodes.length>0?a=i.childNodes.length:a=i.childNodes.length+1;else break;n.node=i,n.offset=a}),r}rangeToNative(e){const r=this.scroll.length(),n=(i,a)=>{i=Math.min(r-1,i);const[o,l]=this.scroll.leaf(i);return o?o.position(l,a):[null,-1]};return[...n(e.index,!1),...n(e.index+e.length,!0)]}setNativeRange(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(NN.info("setNativeRange",e,r,n,i),e!=null&&(this.root.parentNode==null||e.parentNode==null||n.parentNode==null))return;const o=document.getSelection();if(o!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:l}=this.getNativeRange()||{};if(l==null||a||e!==l.startContainer||r!==l.startOffset||n!==l.endContainer||i!==l.endOffset){e instanceof Element&&e.tagName==="BR"&&(r=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),n instanceof Element&&n.tagName==="BR"&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const c=document.createRange();c.setStart(e,r),c.setEnd(n,i),o.removeAllRanges(),o.addRange(c)}}else o.removeAllRanges(),this.root.blur()}setRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dr.sources.API;if(typeof r=="string"&&(n=r,r=!1),NN.info("setRange",e),e!=null){const i=this.rangeToNative(e);this.setNativeRange(...i,r)}else this.setNativeRange(null);this.update(n)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dr.sources.USER;const r=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,this.lastRange!=null&&(this.savedRange=this.lastRange),!zh(r,this.lastRange)){if(!this.composing&&i!=null&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const a=[dr.events.SELECTION_CHANGE,sm(this.lastRange),sm(r),e];this.emitter.emit(dr.events.EDITOR_CHANGE,...a),e!==dr.sources.SILENT&&this.emitter.emit(...a)}}}function kN(t,e){try{e.parentNode}catch{return!1}return t.contains(e)}const Ybe=/^[ -~]*$/;class Kbe{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let r=this.scroll.length();this.scroll.batchStart();const n=wM(e),i=new hr;return Jbe(n.ops.slice()).reduce((o,l)=>{const c=Xl.Op.length(l);let u=l.attributes||{},f=!1,p=!1;if(l.insert!=null){if(i.retain(c),typeof l.insert=="string"){const y=l.insert;p=!y.endsWith(`
`)&&(r<=o||!!this.scroll.descendant(Kl,o)[0]),this.scroll.insertAt(o,y);const[v,j]=this.scroll.line(o);let N=Qh({},Vl(v));if(v instanceof Wa){const[C]=v.descendant(io,j);C&&(N=Qh(N,Vl(C)))}u=Xl.AttributeMap.diff(N,u)||{}}else if(typeof l.insert=="object"){const y=Object.keys(l.insert)[0];if(y==null)return o;const v=this.scroll.query(y,fr.INLINE)!=null;if(v)(r<=o||this.scroll.descendant(Kl,o)[0])&&(p=!0);else if(o>0){const[j,N]=this.scroll.descendant(io,o-1);j instanceof Bc?j.value()[N]!==`
`&&(f=!0):j instanceof _l&&j.statics.scope===fr.INLINE_BLOT&&(f=!0)}if(this.scroll.insertAt(o,y,l.insert[y]),v){const[j]=this.scroll.descendant(io,o);if(j){const N=Qh({},Vl(j));u=Xl.AttributeMap.diff(N,u)||{}}}}r+=c}else if(i.push(l),l.retain!==null&&typeof l.retain=="object"){const y=Object.keys(l.retain)[0];if(y==null)return o;this.scroll.updateEmbedAt(o,y,l.retain[y])}Object.keys(u).forEach(y=>{this.scroll.formatAt(o,c,y,u[y])});const x=f?1:0,m=p?1:0;return r+=x+m,i.retain(x),i.delete(m),o+c+x+m},0),i.reduce((o,l)=>typeof l.delete=="number"?(this.scroll.deleteAt(o,l.delete),o):o+Xl.Op.length(l),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(e,r){return this.scroll.deleteAt(e,r),this.update(new hr().retain(e).delete(r))}formatLine(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(a=>{this.scroll.lines(e,Math.max(r,1)).forEach(o=>{o.format(a,n[a])})}),this.scroll.optimize();const i=new hr().retain(e).retain(r,sm(n));return this.update(i)}formatText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(a=>{this.scroll.formatAt(e,r,a,n[a])});const i=new hr().retain(e).retain(r,sm(n));return this.update(i)}getContents(e,r){return this.delta.slice(e,e+r)}getDelta(){return this.scroll.lines().reduce((e,r)=>e.concat(r.delta()),new hr)}getFormat(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],i=[];r===0?this.scroll.path(e).forEach(l=>{const[c]=l;c instanceof Wa?n.push(c):c instanceof io&&i.push(c)}):(n=this.scroll.lines(e,r),i=this.scroll.descendants(io,e,r));const[a,o]=[n,i].map(l=>{const c=l.shift();if(c==null)return{};let u=Vl(c);for(;Object.keys(u).length>0;){const f=l.shift();if(f==null)return u;u=Xbe(Vl(f),u)}return u});return{...a,...o}}getHTML(e,r){const[n,i]=this.scroll.line(e);if(n){const a=n.length();return n.length()>=i+r&&!(i===0&&r===a)?Zx(n,i,r,!0):Zx(this.scroll,e,r,!0)}return""}getText(e,r){return this.getContents(e,r).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(e,r){const n=wM(r),i=new hr().retain(e).concat(n);return this.scroll.insertContents(e,n),this.update(i)}insertEmbed(e,r,n){return this.scroll.insertAt(e,r,n),this.update(new hr().retain(e).insert({[r]:n}))}insertText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,r),Object.keys(n).forEach(i=>{this.scroll.formatAt(e,r.length,i,n[i])}),this.update(new hr().retain(e).insert(r,sm(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==Wa.blotName)return!1;const r=e;return r.children.length>1?!1:r.children.head instanceof Hc}removeFormat(e,r){const n=this.getText(e,r),[i,a]=this.scroll.line(e+r);let o=0,l=new hr;i!=null&&(o=i.length()-a,l=i.delta().slice(a,a+o-1).insert(`
`));const u=this.getContents(e,r+o).diff(new hr().insert(n).concat(l)),f=new hr().retain(e).concat(u);return this.applyDelta(f)}update(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=this.delta;if(r.length===1&&r[0].type==="characterData"&&r[0].target.data.match(Ybe)&&this.scroll.find(r[0].target)){const a=this.scroll.find(r[0].target),o=Vl(a),l=a.offset(this.scroll),c=r[0].oldValue.replace(Yw.CONTENTS,""),u=new hr().insert(c),f=new hr().insert(a.value()),p=n&&{oldRange:jM(n.oldRange,-l),newRange:jM(n.newRange,-l)};e=new hr().retain(l).concat(u.diff(f,p)).reduce((m,y)=>y.insert?m.insert(y.insert,o):m.push(y),new hr),this.delta=i.compose(e)}else this.delta=this.getDelta(),(!e||!zh(i.compose(e),this.delta))&&(e=i.diff(this.delta,n));return e}}function Fp(t,e,r){if(t.length===0){const[m]=SN(r.pop());return e<=0?`</li></${m}>`:`</li></${m}>${Fp([],e-1,r)}`}const[{child:n,offset:i,length:a,indent:o,type:l},...c]=t,[u,f]=SN(l);if(o>e)return r.push(l),o===e+1?`<${u}><li${f}>${Zx(n,i,a)}${Fp(c,o,r)}`:`<${u}><li>${Fp(t,e+1,r)}`;const p=r[r.length-1];if(o===e&&l===p)return`</li><li${f}>${Zx(n,i,a)}${Fp(c,o,r)}`;const[x]=SN(r.pop());return`</li></${x}>${Fp(t,e-1,r)}`}function Zx(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in t&&typeof t.html=="function")return t.html(e,r);if(t instanceof Bc)return Vw(t.value().slice(e,e+r)).replaceAll(" ","&nbsp;");if(t instanceof Pc){if(t.statics.blotName==="list-container"){const u=[];return t.children.forEachAt(e,r,(f,p,x)=>{const m="formats"in f&&typeof f.formats=="function"?f.formats():{};u.push({child:f,offset:p,length:x,indent:m.indent||0,type:m.list})}),Fp(u,-1,[])}const i=[];if(t.children.forEachAt(e,r,(u,f,p)=>{i.push(Zx(u,f,p))}),n||t.statics.blotName==="list")return i.join("");const{outerHTML:a,innerHTML:o}=t.domNode,[l,c]=a.split(`>${o}<`);return l==="<table"?`<table style="border: 1px solid #000;">${i.join("")}<${c}`:`${l}>${i.join("")}<${c}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function Xbe(t,e){return Object.keys(e).reduce((r,n)=>{if(t[n]==null)return r;const i=e[n];return i===t[n]?r[n]=i:Array.isArray(i)?i.indexOf(t[n])<0?r[n]=i.concat([t[n]]):r[n]=i:r[n]=[i,t[n]],r},{})}function SN(t){const e=t==="ordered"?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function wM(t){return t.reduce((e,r)=>{if(typeof r.insert=="string"){const n=r.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(n,r.attributes)}return e.push(r)},new hr)}function jM(t,e){let{index:r,length:n}=t;return new g0(r+e,n)}function Jbe(t){const e=[];return t.forEach(r=>{typeof r.insert=="string"?r.insert.split(`
`).forEach((i,a)=>{a&&e.push({insert:`
`,attributes:r.attributes}),i&&e.push({insert:i,attributes:r.attributes})}):e.push(r)}),e}class Dd{static DEFAULTS={};constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=r}}const kv="\uFEFF";class wC extends _l{constructor(e,r){super(e,r),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(kv),this.rightGuard=document.createTextNode(kv),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,r){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,r)}restore(e){let r=null,n;const i=e.data.split(kv).join("");if(e===this.leftGuard)if(this.prev instanceof Bc){const a=this.prev.length();this.prev.insertAt(a,i),r={startNode:this.prev.domNode,startOffset:a+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this),r={startNode:n,startOffset:i.length};else e===this.rightGuard&&(this.next instanceof Bc?(this.next.insertAt(0,i),r={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this.next),r={startNode:n,startOffset:i.length}));return e.data=kv,r}update(e,r){e.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const i=this.restore(n.target);i&&(r.range=i)}})}}class Zbe{isComposing=!1;constructor(e,r){this.scroll=e,this.emitter=r,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const r=e.target instanceof Node?this.scroll.find(e.target,!0):null;r&&!(r instanceof wC)&&(this.emitter.emit(dr.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(dr.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(dr.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(dr.events.COMPOSITION_END,e),this.isComposing=!1}}class Um{static DEFAULTS={modules:{}};static themes={default:Um};modules={};constructor(e,r){this.quill=e,this.options=r}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const r=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new r(this.quill,this.options.modules[e]||{}),this.modules[e]}}const Qbe=t=>t.parentElement||t.getRootNode().host||null,eye=t=>{const e=t.getBoundingClientRect(),r="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,n="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*r,bottom:e.top+t.clientHeight*n,left:e.left}},Sv=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},NM=(t,e,r,n,i,a)=>t<r&&e>n?0:t<r?-(r-t+i):e>n?e-t>n-r?t+i-r:e-n+a:0,tye=(t,e)=>{const r=t.ownerDocument;let n=e,i=t;for(;i;){const a=i===r.body,o=a?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:eye(i),l=getComputedStyle(i),c=NM(n.left,n.right,o.left,o.right,Sv(l.scrollPaddingLeft),Sv(l.scrollPaddingRight)),u=NM(n.top,n.bottom,o.top,o.bottom,Sv(l.scrollPaddingTop),Sv(l.scrollPaddingBottom));if(c||u)if(a)r.defaultView?.scrollBy(c,u);else{const{scrollLeft:f,scrollTop:p}=i;u&&(i.scrollTop+=u),c&&(i.scrollLeft+=c);const x=i.scrollLeft-f,m=i.scrollTop-p;n={left:n.left-x,top:n.top-m,right:n.right-x,bottom:n.bottom-m}}i=a||l.position==="fixed"?null:Qbe(i)}},rye=100,nye=["block","break","cursor","inline","scroll","text"],sye=(t,e,r)=>{const n=new bm;return nye.forEach(i=>{const a=e.query(i);a&&n.register(a)}),t.forEach(i=>{let a=e.query(i);a||r.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;a;)if(n.register(a),a="blotName"in a?a.requiredContainer??null:null,o+=1,o>rye){r.error(`Cycle detected in registering blot requiredContainer: "${i}"`);break}}),n},am=Gu("quill"),_v=new bm;Pc.uiClass="ql-ui";class wt{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:_v,theme:"default"};static events=dr.events;static sources=dr.sources;static version="2.0.3";static imports={delta:hr,parchment:Bbe,"core/module":Dd,"core/theme":Um};static debug(e){e===!0&&(e="log"),Gu.level(e)}static find(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return RS.get(e)||_v.find(e,r)}static import(e){return this.imports[e]==null&&am.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],r=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in e?e.attrName:e.blotName;typeof n=="string"?this.register(`formats/${n}`,e,r):Object.keys(e).forEach(i=>{this.register(i,e[i],r)})}else{const e=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!n&&am.warn(`Overwriting ${e} with`,r),this.imports[e]=r,(e.startsWith("blots/")||e.startsWith("formats/"))&&r&&typeof r!="boolean"&&r.blotName!=="abstract"&&_v.register(r),typeof r.register=="function"&&r.register(_v)}}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=iye(e,r),this.container=this.options.container,this.container==null){am.error("Invalid Quill container",e);return}this.options.debug&&wt.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",RS.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new dr;const i=vC.blotName,a=this.options.registry.query(i);if(!a||!("blotName"in a))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new a(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Kbe(this.scroll),this.selection=new Vbe(this.scroll,this.emitter),this.composition=new Zbe(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(dr.events.EDITOR_CHANGE,o=>{o===dr.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(dr.events.SCROLL_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),f=c&&u?{oldRange:c,newRange:u}:void 0;vc.call(this,()=>this.editor.update(null,l,f),o)}),this.emitter.on(dr.events.SCROLL_EMBED_UPDATE,(o,l)=>{const c=this.selection.lastRange,[u]=this.selection.getRange(),f=c&&u?{oldRange:c,newRange:u}:void 0;vc.call(this,()=>{const p=new hr().retain(o.offset(this)).retain({[o.statics.blotName]:l});return this.editor.update(p,[],f)},wt.sources.USER)}),n){const o=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const n=e;e=document.createElement("div"),e.classList.add(n)}return this.container.insertBefore(e,r),e}blur(){this.selection.setRange(null)}deleteText(e,r,n){return[e,r,,n]=iu(e,r,n),vc.call(this,()=>this.editor.deleteText(e,r),n,e,-1*r)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const r=e();return this.allowReadOnlyEdits=!1,r}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dr.sources.API;return vc.call(this,()=>{const i=this.getSelection(!0);let a=new hr;if(i==null)return a;if(this.scroll.query(e,fr.BLOCK))a=this.editor.formatLine(i.index,i.length,{[e]:r});else{if(i.length===0)return this.selection.format(e,r),a;a=this.editor.formatText(i.index,i.length,{[e]:r})}return this.setSelection(i,dr.sources.SILENT),a},n)}formatLine(e,r,n,i,a){let o;return[e,r,o,a]=iu(e,r,n,i,a),vc.call(this,()=>this.editor.formatLine(e,r,o),a,e,0)}formatText(e,r,n,i,a){let o;return[e,r,o,a]=iu(e,r,n,i,a),vc.call(this,()=>this.editor.formatText(e,r,o),a,e,0)}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof e=="number"?n=this.selection.getBounds(e,r):n=this.selection.getBounds(e.index,e.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,r]=iu(e,r),this.editor.getContents(e,r)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,r):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,r)}getModule(e){return this.theme.modules[e]}getSelection(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=iu(e,r),this.editor.getHTML(e,r)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=iu(e,r),this.editor.getText(e,r)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:wt.sources.API;return vc.call(this,()=>this.editor.insertEmbed(e,r,n),i,e)}insertText(e,r,n,i,a){let o;return[e,,o,a]=iu(e,0,n,i,a),vc.call(this,()=>this.editor.insertText(e,r,o),a,e,r.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,r,n){return[e,r,,n]=iu(e,r,n),vc.call(this,()=>this.editor.removeFormat(e,r),n,e)}scrollRectIntoView(e){tye(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,r=e&&this.selection.getBounds(e.index,e.length);r&&this.scrollRectIntoView(r)}setContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dr.sources.API;return vc.call(this,()=>{e=new hr(e);const n=this.getLength(),i=this.editor.deleteText(0,n),a=this.editor.insertContents(0,e),o=this.editor.deleteText(this.getLength()-1,1);return i.compose(a).compose(o)},r)}setSelection(e,r,n){e==null?this.selection.setRange(null,r||wt.sources.API):([e,r,,n]=iu(e,r,n),this.selection.setRange(new g0(Math.max(0,e),r),n),n!==dr.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dr.sources.API;const n=new hr().insert(e);return this.setContents(n,r)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dr.sources.USER;const r=this.scroll.update(e);return this.selection.update(e),r}updateContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dr.sources.API;return vc.call(this,()=>(e=new hr(e),this.editor.applyDelta(e)),r,!0)}}function kM(t){return typeof t=="string"?document.querySelector(t):t}function _N(t){return Object.entries(t??{}).reduce((e,r)=>{let[n,i]=r;return{...e,[n]:i===!0?{}:i}},{})}function SM(t){return Object.fromEntries(Object.entries(t).filter(e=>e[1]!==void 0))}function iye(t,e){const r=kM(t);if(!r)throw new Error("Invalid Quill container");const i=!e.theme||e.theme===wt.DEFAULTS.theme?Um:wt.import(`themes/${e.theme}`);if(!i)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:a,...o}=wt.DEFAULTS,{modules:l,...c}=i.DEFAULTS;let u=_N(e.modules);u!=null&&u.toolbar&&u.toolbar.constructor!==Object&&(u={...u,toolbar:{container:u.toolbar}});const f=Qh({},_N(a),_N(l),u),p={...o,...SM(c),...SM(e)};let x=e.registry;return x?e.formats&&am.warn('Ignoring "formats" option because "registry" is specified'):x=e.formats?sye(e.formats,p.registry,am):p.registry,{...p,registry:x,container:r,theme:i,modules:Object.entries(f).reduce((m,y)=>{let[v,j]=y;if(!j)return m;const N=wt.import(`modules/${v}`);return N==null?(am.error(`Cannot load ${v} module. Are you sure you registered it?`),m):{...m,[v]:Qh({},N.DEFAULTS||{},j)}},{}),bounds:kM(p.bounds)}}function vc(t,e,r,n){if(!this.isEnabled()&&e===dr.sources.USER&&!this.allowReadOnlyEdits)return new hr;let i=r==null?null:this.getSelection();const a=this.editor.delta,o=t();if(i!=null&&(r===!0&&(r=i.index),n==null?i=_M(i,o,e):n!==0&&(i=_M(i,r,n,e)),this.setSelection(i,dr.sources.SILENT)),o.length()>0){const l=[dr.events.TEXT_CHANGE,o,a,e];this.emitter.emit(dr.events.EDITOR_CHANGE,...l),e!==dr.sources.SILENT&&this.emitter.emit(...l)}return o}function iu(t,e,r,n,i){let a={};return typeof t.index=="number"&&typeof t.length=="number"?typeof e!="number"?(i=n,n=r,r=e,e=t.length,t=t.index):(e=t.length,t=t.index):typeof e!="number"&&(i=n,n=r,r=e,e=0),typeof r=="object"?(a=r,i=n):typeof r=="string"&&(n!=null?a[r]=n:i=r),i=i||dr.sources.API,[t,e,a,i]}function _M(t,e,r,n){const i=typeof r=="number"?r:0;if(t==null)return null;let a,o;return e&&typeof e.transformPosition=="function"?[a,o]=[t.index,t.index+t.length].map(l=>e.transformPosition(l,n!==dr.sources.USER)):[a,o]=[t.index,t.index+t.length].map(l=>l<e||l===e&&n===dr.sources.USER?l:i>=0?l+i:Math.max(e,l+i)),new g0(a,o-a)}class R0 extends Gw{}function CM(t){return t instanceof Wa||t instanceof Kl}function AM(t){return typeof t.updateContent=="function"}class aye extends vC{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Wa;static allowedChildren=[Wa,Kl,R0];constructor(e,r,n){let{emitter:i}=n;super(e,r),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",a=>this.handleDragStart(a))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(dr.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(dr.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,r){this.emitter.emit(dr.events.SCROLL_EMBED_UPDATE,e,r)}deleteAt(e,r){const[n,i]=this.line(e),[a]=this.line(e+r);if(super.deleteAt(e,r),a!=null&&n!==a&&i>0){if(n instanceof Kl||a instanceof Kl){this.optimize();return}const o=a.children.head instanceof Hc?null:a.children.head;n.moveChildren(a,o),n.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.optimize()}insertAt(e,r,n){if(e>=this.length())if(n==null||this.scroll.query(r,fr.BLOCK)==null){const i=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(i),n==null&&r.endsWith(`
`)?i.insertAt(0,r.slice(0,-1),n):i.insertAt(0,r,n)}else{const i=this.scroll.create(r,n);this.appendChild(i)}else super.insertAt(e,r,n);this.optimize()}insertBefore(e,r){if(e.statics.scope===fr.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(e),super.insertBefore(n,r)}else super.insertBefore(e,r)}insertContents(e,r){const n=this.deltaToRenderBlocks(r.concat(new hr().insert(`
`))),i=n.pop();if(i==null)return;this.batchStart();const a=n.shift();if(a){const c=a.type==="block"&&(a.delta.length()===0||!this.descendant(Kl,e)[0]&&e<this.length()),u=a.type==="block"?a.delta:new hr().insert({[a.key]:a.value});CN(this,e,u);const f=a.type==="block"?1:0,p=e+u.length()+f;c&&this.insertAt(p-1,`
`);const x=Vl(this.line(e)[0]),m=Xl.AttributeMap.diff(x,a.attributes)||{};Object.keys(m).forEach(y=>{this.formatAt(p-1,1,y,m[y])}),e=p}let[o,l]=this.children.find(e);if(n.length&&(o&&(o=o.split(l),l=0),n.forEach(c=>{if(c.type==="block"){const u=this.createBlock(c.attributes,o||void 0);CN(u,0,c.delta)}else{const u=this.create(c.key,c.value);this.insertBefore(u,o||void 0),Object.keys(c.attributes).forEach(f=>{u.format(f,c.attributes[f])})}})),i.type==="block"&&i.delta.length()){const c=o?o.offset(o.scroll)+l:this.length();CN(this,c,i.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const r=this.path(e).pop();if(!r)return[null,-1];const[n,i]=r;return n instanceof io?[n,i]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(CM,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(i,a,o)=>{let l=[],c=o;return i.children.forEachAt(a,o,(u,f,p)=>{CM(u)?l.push(u):u instanceof Gw&&(l=l.concat(n(u,f,c))),c-=p}),l};return n(this,e,r)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,r),e.length>0&&this.emitter.emit(dr.events.SCROLL_OPTIMIZE,e,r))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let r=dr.sources.USER;typeof e=="string"&&(r=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(n=>{let{target:i}=n;const a=this.find(i,!0);return a&&!AM(a)}),e.length>0&&this.emitter.emit(dr.events.SCROLL_BEFORE_UPDATE,r,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(dr.events.SCROLL_UPDATE,r,e)}updateEmbedAt(e,r,n){const[i]=this.descendant(a=>a instanceof Kl,e);i&&i.statics.blotName===r&&AM(i)&&i.updateContent(n)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const r=[];let n=new hr;return e.forEach(i=>{const a=i?.insert;if(a)if(typeof a=="string"){const o=a.split(`
`);o.slice(0,-1).forEach(c=>{n.insert(c,i.attributes),r.push({type:"block",delta:n,attributes:i.attributes??{}}),n=new hr});const l=o[o.length-1];l&&n.insert(l,i.attributes)}else{const o=Object.keys(a)[0];if(!o)return;this.query(o,fr.INLINE)?n.push(i):(n.length()&&r.push({type:"block",delta:n,attributes:{}}),n=new hr,r.push({type:"blockEmbed",key:o,value:a[o],attributes:i.attributes??{}}))}}),n.length()&&r.push({type:"block",delta:n,attributes:{}}),r}createBlock(e,r){let n;const i={};Object.entries(e).forEach(l=>{let[c,u]=l;this.query(c,fr.BLOCK&fr.BLOT)!=null?n=c:i[c]=u});const a=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(a,r||void 0);const o=a.length();return Object.entries(i).forEach(l=>{let[c,u]=l;a.formatAt(0,o,c,u)}),a}}function CN(t,e,r){r.reduce((n,i)=>{const a=Xl.Op.length(i);let o=i.attributes||{};if(i.insert!=null){if(typeof i.insert=="string"){const l=i.insert;t.insertAt(n,l);const[c]=t.descendant(io,n),u=Vl(c);o=Xl.AttributeMap.diff(u,o)||{}}else if(typeof i.insert=="object"){const l=Object.keys(i.insert)[0];if(l==null)return n;if(t.insertAt(n,l,i.insert[l]),t.scroll.query(l,fr.INLINE)!=null){const[u]=t.descendant(io,n),f=Vl(u);o=Xl.AttributeMap.diff(f,o)||{}}}}return Object.keys(o).forEach(l=>{t.formatAt(n,a,l,o[l])}),n+a},e)}const jC={scope:fr.BLOCK,whitelist:["right","center","justify"]},oye=new Ad("align","align",jC),Qq=new qc("align","ql-align",jC),eH=new pf("align","text-align",jC);class tH extends pf{value(e){let r=super.value(e);return r.startsWith("rgb(")?(r=r.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${r.split(",").map(i=>`00${parseInt(i,10).toString(16)}`.slice(-2)).join("")}`):r}}const lye=new qc("color","ql-color",{scope:fr.INLINE}),NC=new tH("color","color",{scope:fr.INLINE}),cye=new qc("background","ql-bg",{scope:fr.INLINE}),kC=new tH("background","background-color",{scope:fr.INLINE});class D0 extends R0{static create(e){const r=super.create(e);return r.setAttribute("spellcheck","false"),r}code(e,r){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(e,e+r)}html(e,r){return`<pre>
${Vw(this.code(e,r))}
</pre>`}}class No extends Wa{static TAB="  ";static register(){wt.register(D0)}}class SC extends xo{}SC.blotName="code";SC.tagName="CODE";No.blotName="code-block";No.className="ql-code-block";No.tagName="DIV";D0.blotName="code-block-container";D0.className="ql-code-block-container";D0.tagName="DIV";D0.allowedChildren=[No];No.allowedChildren=[Bc,Hc,Yw];No.requiredContainer=D0;const _C={scope:fr.BLOCK,whitelist:["rtl"]},rH=new Ad("direction","dir",_C),nH=new qc("direction","ql-direction",_C),sH=new pf("direction","direction",_C),iH={scope:fr.INLINE,whitelist:["serif","monospace"]},aH=new qc("font","ql-font",iH);class dye extends pf{value(e){return super.value(e).replace(/["']/g,"")}}const oH=new dye("font","font-family",iH),lH=new qc("size","ql-size",{scope:fr.INLINE,whitelist:["small","large","huge"]}),cH=new pf("size","font-size",{scope:fr.INLINE,whitelist:["10px","18px","32px"]}),uye=Gu("quill:keyboard"),hye=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Kw extends Dd{static match(e,r){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!r[n]!==e[n]&&r[n]!==null)?!1:r.key===e.key||r.key===e.which}constructor(e,r){super(e,r),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=pye(e);if(i==null){uye.warn("Attempted to add invalid keyboard binding",i);return}typeof r=="function"&&(r={handler:r}),typeof n=="function"&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach(o=>{const l={...i,key:o,...r,...n};this.bindings[l.key]=this.bindings[l.key]||[],this.bindings[l.key].push(l)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const i=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(N=>Kw.match(e,N));if(i.length===0)return;const a=wt.find(e.target,!0);if(a&&a.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[l,c]=this.quill.getLine(o.index),[u,f]=this.quill.getLeaf(o.index),[p,x]=o.length===0?[u,f]:this.quill.getLeaf(o.index+o.length),m=u instanceof g2?u.value().slice(0,f):"",y=p instanceof g2?p.value().slice(x):"",v={collapsed:o.length===0,empty:o.length===0&&l.length()<=1,format:this.quill.getFormat(o),line:l,offset:c,prefix:m,suffix:y,event:e};i.some(N=>{if(N.collapsed!=null&&N.collapsed!==v.collapsed||N.empty!=null&&N.empty!==v.empty||N.offset!=null&&N.offset!==v.offset)return!1;if(Array.isArray(N.format)){if(N.format.every(C=>v.format[C]==null))return!1}else if(typeof N.format=="object"&&!Object.keys(N.format).every(C=>N.format[C]===!0?v.format[C]!=null:N.format[C]===!1?v.format[C]==null:zh(N.format[C],v.format[C])))return!1;return N.prefix!=null&&!N.prefix.test(v.prefix)||N.suffix!=null&&!N.suffix.test(v.suffix)?!1:N.handler.call(this,o,v,N)!==!0})&&e.preventDefault()})}handleBackspace(e,r){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(r.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let i={};const[a]=this.quill.getLine(e.index);let o=new hr().retain(e.index-n).delete(n);if(r.offset===0){const[l]=this.quill.getLine(e.index-1);if(l&&!(l.statics.blotName==="block"&&l.length()<=1)){const u=a.formats(),f=this.quill.getFormat(e.index-1,1);if(i=Xl.AttributeMap.diff(u,f)||{},Object.keys(i).length>0){const p=new hr().retain(e.index+a.length()-2).retain(1,i);o=o.compose(p)}}}this.quill.updateContents(o,wt.sources.USER),this.quill.focus()}handleDelete(e,r){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(r.suffix)?2:1;if(e.index>=this.quill.getLength()-n)return;let i={};const[a]=this.quill.getLine(e.index);let o=new hr().retain(e.index).delete(n);if(r.offset>=a.length()-1){const[l]=this.quill.getLine(e.index+1);if(l){const c=a.formats(),u=this.quill.getFormat(e.index,1);i=Xl.AttributeMap.diff(c,u)||{},Object.keys(i).length>0&&(o=o.retain(l.length()-1).retain(1,i))}}this.quill.updateContents(o,wt.sources.USER),this.quill.focus()}handleDeleteRange(e){CC({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,r){const n=Object.keys(r.format).reduce((a,o)=>(this.quill.scroll.query(o,fr.BLOCK)&&!Array.isArray(r.format[o])&&(a[o]=r.format[o]),a),{}),i=new hr().retain(e.index).delete(e.length).insert(`
`,n);this.quill.updateContents(i,wt.sources.USER),this.quill.setSelection(e.index+1,wt.sources.SILENT),this.quill.focus()}}const fye={bindings:{bold:AN("bold"),italic:AN("italic"),underline:AN("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",wt.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",wt.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){e.format.indent!=null?this.quill.format("indent","-1",wt.sources.USER):e.format.list!=null&&this.quill.format("list",!1,wt.sources.USER)}},"indent code-block":EM(!0),"outdent code-block":EM(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,wt.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const r=new hr().retain(t.index).delete(t.length).insert("	");return this.quill.updateContents(r,wt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,wt.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,wt.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const r={list:!1};e.format.indent&&(r.indent=!1),this.quill.formatLine(t.index,t.length,r,wt.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,r]=this.quill.getLine(t.index),n={...e.formats(),list:"checked"},i=new hr().retain(t.index).insert(`
`,n).retain(e.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,wt.sources.USER),this.quill.setSelection(t.index+1,wt.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[r,n]=this.quill.getLine(t.index),i=new hr().retain(t.index).insert(`
`,e.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,wt.sources.USER),this.quill.setSelection(t.index+1,wt.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[r,n,i,a]=e.getTable(t),o=mye(r,n,i,a);if(o==null)return;let l=r.offset();if(o<0){const c=new hr().retain(l).insert(`
`);this.quill.updateContents(c,wt.sources.USER),this.quill.setSelection(t.index+1,t.length,wt.sources.SILENT)}else if(o>0){l+=r.length();const c=new hr().retain(l).insert(`
`);this.quill.updateContents(c,wt.sources.USER),this.quill.setSelection(l,wt.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:r,line:n}=e,i=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(i-1,wt.sources.USER):this.quill.setSelection(i+n.length(),wt.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query("list")==null)return!0;const{length:r}=e.prefix,[n,i]=this.quill.getLine(t.index);if(i>r)return!0;let a;switch(e.prefix.trim()){case"[]":case"[ ]":a="unchecked";break;case"[x]":a="checked";break;case"-":case"*":a="bullet";break;default:a="ordered"}this.quill.insertText(t.index," ",wt.sources.USER),this.quill.history.cutoff();const o=new hr().retain(t.index-i).delete(r+1).retain(n.length()-2-i).retain(1,{list:a});return this.quill.updateContents(o,wt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-r,wt.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,r]=this.quill.getLine(t.index);let n=2,i=e;for(;i!=null&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const a=new hr().retain(t.index+e.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(a,wt.sources.USER),this.quill.setSelection(t.index-1,wt.sources.SILENT),!1}return!0}},"embed left":Cv("ArrowLeft",!1),"embed left shift":Cv("ArrowLeft",!0),"embed right":Cv("ArrowRight",!1),"embed right shift":Cv("ArrowRight",!0),"table down":TM(!1),"table up":TM(!0)}};Kw.DEFAULTS=fye;function EM(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,r){let{event:n}=r;const i=this.quill.scroll.query("code-block"),{TAB:a}=i;if(e.length===0&&!n.shiftKey){this.quill.insertText(e.index,a,wt.sources.USER),this.quill.setSelection(e.index+a.length,wt.sources.SILENT);return}const o=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:l,length:c}=e;o.forEach((u,f)=>{t?(u.insertAt(0,a),f===0?l+=a.length:c+=a.length):u.domNode.textContent.startsWith(a)&&(u.deleteAt(0,a.length),f===0?l-=a.length:c-=a.length)}),this.quill.update(wt.sources.USER),this.quill.setSelection(l,c,wt.sources.SILENT)}}}function Cv(t,e){return{key:t,shiftKey:e,altKey:null,[t==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;t==="ArrowRight"&&(i+=n.length+1);const[a]=this.quill.getLeaf(i);return a instanceof _l?(t==="ArrowLeft"?e?this.quill.setSelection(n.index-1,n.length+1,wt.sources.USER):this.quill.setSelection(n.index-1,wt.sources.USER):e?this.quill.setSelection(n.index,n.length+1,wt.sources.USER):this.quill.setSelection(n.index+n.length+1,wt.sources.USER),!1):!0}}}function AN(t){return{key:t[0],shortKey:!0,handler(e,r){this.quill.format(t,!r.format[t],wt.sources.USER)}}}function TM(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,r){const n=t?"prev":"next",i=r.line,a=i.parent[n];if(a!=null){if(a.statics.blotName==="table-row"){let o=a.children.head,l=i;for(;l.prev!=null;)l=l.prev,o=o.next;const c=o.offset(this.quill.scroll)+Math.min(r.offset,o.length()-1);this.quill.setSelection(c,0,wt.sources.USER)}}else{const o=i.table()[n];o!=null&&(t?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,wt.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,wt.sources.USER))}return!1}}}function pye(t){if(typeof t=="string"||typeof t=="number")t={key:t};else if(typeof t=="object")t=sm(t);else return null;return t.shortKey&&(t[hye]=t.shortKey,delete t.shortKey),t}function CC(t){let{quill:e,range:r}=t;const n=e.getLines(r);let i={};if(n.length>1){const a=n[0].formats(),o=n[n.length-1].formats();i=Xl.AttributeMap.diff(o,a)||{}}e.deleteText(r,wt.sources.USER),Object.keys(i).length>0&&e.formatLine(r.index,1,i,wt.sources.USER),e.setSelection(r.index,wt.sources.SILENT)}function mye(t,e,r,n){return e.prev==null&&e.next==null?r.prev==null&&r.next==null?n===0?-1:1:r.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const gye=/font-weight:\s*normal/,xye=["P","OL","UL"],LM=t=>t&&xye.includes(t.tagName),bye=t=>{Array.from(t.querySelectorAll("br")).filter(e=>LM(e.previousElementSibling)&&LM(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},yye=t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(gye)).forEach(e=>{const r=t.createDocumentFragment();r.append(...e.childNodes),e.parentNode?.replaceChild(r,e)})};function vye(t){t.querySelector('[id^="docs-internal-guid-"]')&&(yye(t),bye(t))}const wye=/\bmso-list:[^;]*ignore/i,jye=/\bmso-list:[^;]*\bl(\d+)/i,Nye=/\bmso-list:[^;]*\blevel(\d+)/i,kye=(t,e)=>{const r=t.getAttribute("style"),n=r?.match(jye);if(!n)return null;const i=Number(n[1]),a=r?.match(Nye),o=a?Number(a[1]):1,l=new RegExp(`@list l${i}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),c=e.match(l),u=c&&c[1]==="bullet"?"bullet":"ordered";return{id:i,indent:o,type:u,element:t}},Sye=t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),r=[],n=[];e.forEach(o=>{(o.getAttribute("style")||"").match(wye)?r.push(o):n.push(o)}),r.forEach(o=>o.parentNode?.removeChild(o));const i=t.documentElement.innerHTML,a=n.map(o=>kye(o,i)).filter(o=>o);for(;a.length;){const o=[];let l=a.shift();for(;l;)o.push(l),l=a.length&&a[0]?.element===l.element.nextElementSibling&&a[0].id===l.id?a.shift():null;const c=document.createElement("ul");o.forEach(p=>{const x=document.createElement("li");x.setAttribute("data-list",p.type),p.indent>1&&x.setAttribute("class",`ql-indent-${p.indent-1}`),x.innerHTML=p.element.innerHTML,c.appendChild(x)});const u=o[0]?.element,{parentNode:f}=u??{};u&&f?.replaceChild(c,u),o.slice(1).forEach(p=>{let{element:x}=p;f?.removeChild(x)})}};function _ye(t){t.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&Sye(t)}const Cye=[_ye,vye],Aye=t=>{t.documentElement&&Cye.forEach(e=>{e(t)})},Eye=Gu("quill:clipboard"),Tye=[[Node.TEXT_NODE,qye],[Node.TEXT_NODE,MM],["br",Rye],[Node.ELEMENT_NODE,MM],[Node.ELEMENT_NODE,Iye],[Node.ELEMENT_NODE,Pye],[Node.ELEMENT_NODE,Uye],["li",$ye],["ol, ul",Fye],["pre",Dye],["tr",zye],["b",EN("bold")],["i",EN("italic")],["strike",EN("strike")],["style",Bye]],Lye=[oye,rH].reduce((t,e)=>(t[e.keyName]=e,t),{}),OM=[eH,kC,NC,sH,oH,cH].reduce((t,e)=>(t[e.keyName]=e,t),{});class Oye extends Dd{static DEFAULTS={matchers:[]};constructor(e,r){super(e,r),this.quill.root.addEventListener("copy",n=>this.onCaptureCopy(n,!1)),this.quill.root.addEventListener("cut",n=>this.onCaptureCopy(n,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],Tye.concat(this.options.matchers??[]).forEach(n=>{let[i,a]=n;this.addMatcher(i,a)})}addMatcher(e,r){this.matchers.push([e,r])}convert(e){let{html:r,text:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i[No.blotName])return new hr().insert(n||"",{[No.blotName]:i[No.blotName]});if(!r)return new hr().insert(n||"",i);const a=this.convertHTML(r);return Bb(a,`
`)&&(a.ops[a.ops.length-1].attributes==null||i.table)?a.compose(new hr().retain(a.length()-1).delete(1)):a}normalizeHTML(e){Aye(e)}convertHTML(e){const r=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(r);const n=r.body,i=new WeakMap,[a,o]=this.prepareMatching(n,i);return AC(this.quill.scroll,n,a,o,i)}dangerouslyPasteHTML(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wt.sources.API;if(typeof e=="string"){const i=this.convert({html:e,text:""});this.quill.setContents(i,r),this.quill.setSelection(0,wt.sources.SILENT)}else{const i=this.convert({html:r,text:""});this.quill.updateContents(new hr().retain(e).concat(i),n),this.quill.setSelection(e+i.length(),wt.sources.SILENT)}}onCaptureCopy(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:i,text:a}=this.onCopy(n,r);e.clipboardData?.setData("text/plain",a),e.clipboardData?.setData("text/html",i),r&&CC({range:n,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(r=>r[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const r=this.quill.getSelection(!0);if(r==null)return;const n=e.clipboardData?.getData("text/html");let i=e.clipboardData?.getData("text/plain");if(!n&&!i){const o=e.clipboardData?.getData("text/uri-list");o&&(i=this.normalizeURIList(o))}const a=Array.from(e.clipboardData?.files||[]);if(!n&&a.length>0){this.quill.uploader.upload(r,a);return}if(n&&a.length>0){const o=new DOMParser().parseFromString(n,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(r,a);return}}this.onPaste(r,{html:n,text:i})}onCopy(e){const r=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:r}}onPaste(e,r){let{text:n,html:i}=r;const a=this.quill.getFormat(e.index),o=this.convert({text:n,html:i},a);Eye.log("onPaste",o,{text:n,html:i});const l=new hr().retain(e.index).delete(e.length).concat(o);this.quill.updateContents(l,wt.sources.USER),this.quill.setSelection(l.length()-e.length,wt.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,r){const n=[],i=[];return this.matchers.forEach(a=>{const[o,l]=a;switch(o){case Node.TEXT_NODE:i.push(l);break;case Node.ELEMENT_NODE:n.push(l);break;default:Array.from(e.querySelectorAll(o)).forEach(c=>{r.has(c)?r.get(c)?.push(l):r.set(c,[l])});break}}),[n,i]}}function B0(t,e,r,n){return n.query(e)?t.reduce((i,a)=>{if(!a.insert)return i;if(a.attributes&&a.attributes[e])return i.push(a);const o=r?{[e]:r}:{};return i.insert(a.insert,{...o,...a.attributes})},new hr):t}function Bb(t,e){let r="";for(let n=t.ops.length-1;n>=0&&r.length<e.length;--n){const i=t.ops[n];if(typeof i.insert!="string")break;r=i.insert+r}return r.slice(-1*e.length)===e}function Gh(t,e){if(!(t instanceof Element))return!1;const r=e.query(t);return r&&r.prototype instanceof _l?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}function Mye(t,e){return t.previousElementSibling&&t.nextElementSibling&&!Gh(t.previousElementSibling,e)&&!Gh(t.nextElementSibling,e)}const Av=new WeakMap;function dH(t){return t==null?!1:(Av.has(t)||(t.tagName==="PRE"?Av.set(t,!0):Av.set(t,dH(t.parentNode))),Av.get(t))}function AC(t,e,r,n,i){return e.nodeType===e.TEXT_NODE?n.reduce((a,o)=>o(e,a,t),new hr):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((a,o)=>{let l=AC(t,o,r,n,i);return o.nodeType===e.ELEMENT_NODE&&(l=r.reduce((c,u)=>u(o,c,t),l),l=(i.get(o)||[]).reduce((c,u)=>u(o,c,t),l)),a.concat(l)},new hr):new hr}function EN(t){return(e,r,n)=>B0(r,t,!0,n)}function Pye(t,e,r){const n=Ad.keys(t),i=qc.keys(t),a=pf.keys(t),o={};return n.concat(i).concat(a).forEach(l=>{let c=r.query(l,fr.ATTRIBUTE);c!=null&&(o[c.attrName]=c.value(t),o[c.attrName])||(c=Lye[l],c!=null&&(c.attrName===l||c.keyName===l)&&(o[c.attrName]=c.value(t)||void 0),c=OM[l],c!=null&&(c.attrName===l||c.keyName===l)&&(c=OM[l],o[c.attrName]=c.value(t)||void 0))}),Object.entries(o).reduce((l,c)=>{let[u,f]=c;return B0(l,u,f,r)},e)}function Iye(t,e,r){const n=r.query(t);if(n==null)return e;if(n.prototype instanceof _l){const i={},a=n.value(t);if(a!=null)return i[n.blotName]=a,new hr().insert(i,n.formats(t,r))}else if(n.prototype instanceof Jx&&!Bb(e,`
`)&&e.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return B0(e,n.blotName,n.formats(t,r),r);return e}function Rye(t,e){return Bb(e,`
`)||e.insert(`
`),e}function Dye(t,e,r){const n=r.query("code-block"),i=n&&"formats"in n&&typeof n.formats=="function"?n.formats(t,r):!0;return B0(e,"code-block",i,r)}function Bye(){return new hr}function $ye(t,e,r){const n=r.query(t);if(n==null||n.blotName!=="list"||!Bb(e,`
`))return e;let i=-1,a=t.parentNode;for(;a!=null;)["OL","UL"].includes(a.tagName)&&(i+=1),a=a.parentNode;return i<=0?e:e.reduce((o,l)=>l.insert?l.attributes&&typeof l.attributes.indent=="number"?o.push(l):o.insert(l.insert,{indent:i,...l.attributes||{}}):o,new hr)}function Fye(t,e,r){const n=t;let i=n.tagName==="OL"?"ordered":"bullet";const a=n.getAttribute("data-checked");return a&&(i=a==="true"?"checked":"unchecked"),B0(e,"list",i,r)}function MM(t,e,r){if(!Bb(e,`
`)){if(Gh(t,r)&&(t.childNodes.length>0||t instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&t.nextSibling){let n=t.nextSibling;for(;n!=null;){if(Gh(n,r))return e.insert(`
`);const i=r.query(n);if(i&&i.prototype instanceof Kl)return e.insert(`
`);n=n.firstChild}}}return e}function Uye(t,e,r){const n={},i=t.style||{};return i.fontStyle==="italic"&&(n.italic=!0),i.textDecoration==="underline"&&(n.underline=!0),i.textDecoration==="line-through"&&(n.strike=!0),(i.fontWeight?.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),e=Object.entries(n).reduce((a,o)=>{let[l,c]=o;return B0(a,l,c,r)},e),parseFloat(i.textIndent||0)>0?new hr().insert("	").concat(e):e}function zye(t,e,r){const n=t.parentElement?.tagName==="TABLE"?t.parentElement:t.parentElement?.parentElement;if(n!=null){const a=Array.from(n.querySelectorAll("tr")).indexOf(t)+1;return B0(e,"table",a,r)}return e}function qye(t,e,r){let n=t.data;if(t.parentElement?.tagName==="O:P")return e.insert(n.trim());if(!dH(t)){if(n.trim().length===0&&n.includes(`
`)&&!Mye(t,r))return e;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(t.previousSibling==null&&t.parentElement!=null&&Gh(t.parentElement,r)||t.previousSibling instanceof Element&&Gh(t.previousSibling,r))&&(n=n.replace(/^ /,"")),(t.nextSibling==null&&t.parentElement!=null&&Gh(t.parentElement,r)||t.nextSibling instanceof Element&&Gh(t.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll(""," ")}return e.insert(n)}class Hye extends Dd{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,r){super(e,r),this.quill.on(wt.events.EDITOR_CHANGE,(n,i,a,o)=>{n===wt.events.SELECTION_CHANGE?i&&o!==wt.sources.SILENT&&(this.currentRange=i):n===wt.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===wt.sources.USER?this.record(i,a):this.transform(i)),this.currentRange=$S(this.currentRange,i))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",n=>{n.inputType==="historyUndo"?(this.undo(),n.preventDefault()):n.inputType==="historyRedo"&&(this.redo(),n.preventDefault())})}change(e,r){if(this.stack[e].length===0)return;const n=this.stack[e].pop();if(!n)return;const i=this.quill.getContents(),a=n.delta.invert(i);this.stack[r].push({delta:a,range:$S(n.range,a)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,wt.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,r){if(e.ops.length===0)return;this.stack.redo=[];let n=e.invert(r),i=this.currentRange;const a=Date.now();if(this.lastRecorded+this.options.delay>a&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(n=n.compose(o.delta),i=o.range)}else this.lastRecorded=a;n.length()!==0&&(this.stack.undo.push({delta:n,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){PM(this.stack.undo,e),PM(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,wt.sources.USER);else{const r=Gye(this.quill.scroll,e.delta);this.quill.setSelection(r,wt.sources.USER)}}}function PM(t,e){let r=e;for(let n=t.length-1;n>=0;n-=1){const i=t[n];t[n]={delta:r.transform(i.delta,!0),range:i.range&&$S(i.range,r)},r=i.delta.transform(r),t[n].delta.length()===0&&t.splice(n,1)}}function Wye(t,e){const r=e.ops[e.ops.length-1];return r==null?!1:r.insert!=null?typeof r.insert=="string"&&r.insert.endsWith(`
`):r.attributes!=null?Object.keys(r.attributes).some(n=>t.query(n,fr.BLOCK)!=null):!1}function Gye(t,e){const r=e.reduce((i,a)=>i+(a.delete||0),0);let n=e.length()-r;return Wye(t,e)&&(n-=1),n}function $S(t,e){if(!t)return t;const r=e.transformPosition(t.index),n=e.transformPosition(t.index+t.length);return{index:r,length:n-r}}class uH extends Dd{constructor(e,r){super(e,r),e.root.addEventListener("drop",n=>{n.preventDefault();let i=null;if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(n.clientX,n.clientY);i=document.createRange(),i.setStart(o.offsetNode,o.offset),i.setEnd(o.offsetNode,o.offset)}const a=i&&e.selection.normalizeNative(i);if(a){const o=e.selection.normalizedToRange(a);n.dataTransfer?.files&&this.upload(o,n.dataTransfer.files)}})}upload(e,r){const n=[];Array.from(r).forEach(i=>{i&&this.options.mimetypes?.includes(i.type)&&n.push(i)}),n.length>0&&this.options.handler.call(this,e,n)}}uH.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){if(!this.quill.scroll.query("image"))return;const r=e.map(n=>new Promise(i=>{const a=new FileReader;a.onload=()=>{i(a.result)},a.readAsDataURL(n)}));Promise.all(r).then(n=>{const i=n.reduce((a,o)=>a.insert({image:o}),new hr().retain(t.index).delete(t.length));this.quill.updateContents(i,dr.sources.USER),this.quill.setSelection(t.index+n.length,dr.sources.SILENT)})}};const Vye=["insertText","insertReplacementText"];class Yye extends Dd{constructor(e,r){super(e,r),e.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||e.on(wt.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){CC({range:e,quill:this.quill})}replaceText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(r){const n=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new hr().retain(e.index).insert(r,n),wt.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+r.length,0,wt.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!Vye.includes(e.inputType))return;const r=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!r||r.collapsed===!0)return;const n=Kye(e);if(n==null)return;const i=this.quill.selection.normalizeNative(r),a=i?this.quill.selection.normalizedToRange(i):null;a&&this.replaceText(a,n)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function Kye(t){return typeof t.data=="string"?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}const Xye=/Mac/i.test(navigator.platform),Jye=100,Zye=t=>!!(t.key==="ArrowLeft"||t.key==="ArrowRight"||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="Home"||Xye&&t.key==="a"&&t.ctrlKey===!0);class Qye extends Dd{isListening=!1;selectionChangeDeadline=0;constructor(e,r){super(e,r),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,r){let{line:n,event:i}=r;if(!(n instanceof Pc)||!n.uiNode)return!0;const a=getComputedStyle(n.domNode).direction==="rtl";return a&&i.key!=="ArrowRight"||!a&&i.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(i.shiftKey?1:0),wt.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&Zye(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Jye,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const r=e.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;const n=this.quill.scroll.find(r.startContainer);if(!(n instanceof Pc)||!n.uiNode)return;const i=document.createRange();i.setStartAfter(n.uiNode),i.setEndAfter(n.uiNode),e.removeAllRanges(),e.addRange(i)}}wt.register({"blots/block":Wa,"blots/block/embed":Kl,"blots/break":Hc,"blots/container":R0,"blots/cursor":Yw,"blots/embed":wC,"blots/inline":xo,"blots/scroll":aye,"blots/text":Bc,"modules/clipboard":Oye,"modules/history":Hye,"modules/keyboard":Kw,"modules/uploader":uH,"modules/input":Yye,"modules/uiNode":Qye});class eve extends qc{add(e,r){let n=0;if(r==="+1"||r==="-1"){const i=this.value(e)||0;n=r==="+1"?i+1:i-1}else typeof r=="number"&&(n=r);return n===0?(this.remove(e),!0):super.add(e,n.toString())}canAdd(e,r){return super.canAdd(e,r)||super.canAdd(e,parseInt(r,10))}value(e){return parseInt(super.value(e),10)||void 0}}const tve=new eve("indent","ql-indent",{scope:fr.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class rve extends Wa{static blotName="blockquote";static tagName="blockquote"}class nve extends Wa{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class $b extends R0{}$b.blotName="list-container";$b.tagName="OL";class Fb extends Wa{static create(e){const r=super.create();return r.setAttribute("data-list",e),r}static formats(e){return e.getAttribute("data-list")||void 0}static register(){wt.register($b)}constructor(e,r){super(e,r);const n=r.ownerDocument.createElement("span"),i=a=>{if(!e.isEnabled())return;const o=this.statics.formats(r,e);o==="checked"?(this.format("list","unchecked"),a.preventDefault()):o==="unchecked"&&(this.format("list","checked"),a.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-list",r):super.format(e,r)}}Fb.blotName="list";Fb.tagName="LI";$b.allowedChildren=[Fb];Fb.requiredContainer=$b;class EC extends xo{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class sve extends EC{static blotName="italic";static tagName=["EM","I"]}class x2 extends xo{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const r=super.create(e);return r.setAttribute("href",this.sanitize(e)),r.setAttribute("rel","noopener noreferrer"),r.setAttribute("target","_blank"),r}static formats(e){return e.getAttribute("href")}static sanitize(e){return hH(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,r){e!==this.statics.blotName||!r?super.format(e,r):this.domNode.setAttribute("href",this.constructor.sanitize(r))}}function hH(t,e){const r=document.createElement("a");r.href=t;const n=r.href.slice(0,r.href.indexOf(":"));return e.indexOf(n)>-1}class ive extends xo{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class ave extends EC{static blotName="strike";static tagName=["S","STRIKE"]}class ove extends xo{static blotName="underline";static tagName="U"}class lve extends wC{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const r=super.create(e);return typeof e=="string"&&(window.katex.render(e,r,{throwOnError:!1,errorColor:"#f00"}),r.setAttribute("data-value",e)),r}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const IM=["alt","height","width"];let cve=class extends _l{static blotName="image";static tagName="IMG";static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("src",this.sanitize(e)),r}static formats(e){return IM.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return hH(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,r){IM.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}};const RM=["height","width"];class dve extends Kl{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const r=super.create(e);return r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),r.setAttribute("src",this.sanitize(e)),r}static formats(e){return RM.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static sanitize(e){return x2.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,r){RM.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const fx=new qc("code-token","hljs",{scope:fr.INLINE});class Ou extends xo{static formats(e,r){for(;e!=null&&e!==r.domNode;){if(e.classList&&e.classList.contains(No.className))return super.formats(e,r);e=e.parentNode}}constructor(e,r,n){super(e,r,n),fx.add(this.domNode,n)}format(e,r){e!==Ou.blotName?super.format(e,r):r?fx.add(this.domNode,r):(fx.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),fx.value(this.domNode)||this.unwrap()}}Ou.blotName="code-token";Ou.className="ql-token";class Yl extends No{static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("data-language",e),r}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-language",r):super.format(e,r)}replaceWith(e,r){return this.formatAt(0,this.length(),Ou.blotName,!1),super.replaceWith(e,r)}}class Lx extends D0{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,r){e===Yl.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(e,r)}))}formatAt(e,r,n,i){n===Yl.blotName&&(this.forceNext=!0),super.formatAt(e,r,n,i)}highlight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const i=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,a=Yl.formats(this.children.head.domNode);if(r||this.forceNext||this.cachedText!==i){if(i.trim().length>0||this.cachedText==null){const o=this.children.reduce((c,u)=>c.concat(Xq(u,!1)),new hr),l=e(i,a);o.diff(l).reduce((c,u)=>{let{retain:f,attributes:p}=u;return f?(p&&Object.keys(p).forEach(x=>{[Yl.blotName,Ou.blotName].includes(x)&&this.formatAt(c,f,x,p[x])}),c+f):c},0)}this.cachedText=i,this.forceNext=!1}}html(e,r){const[n]=this.children.find(e);return`<pre data-language="${n?Yl.formats(n.domNode):"plain"}">
${Vw(this.code(e,r))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const r=Yl.formats(this.children.head.domNode);r!==this.uiNode.value&&(this.uiNode.value=r)}}}Lx.allowedChildren=[Yl];Yl.requiredContainer=Lx;Yl.allowedChildren=[Ou,Yw,Bc,Hc];const uve=(t,e,r)=>{if(typeof t.versionString=="string"){const n=t.versionString.split(".")[0];if(parseInt(n,10)>=11)return t.highlight(r,{language:e}).value}return t.highlight(e,r).value};class fH extends Dd{static register(){wt.register(Ou,!0),wt.register(Yl,!0),wt.register(Lx,!0)}constructor(e,r){if(super(e,r),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,i)=>{let{key:a}=i;return n[a]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(wt.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof Lx))return;const r=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:i,label:a}=n;const o=r.ownerDocument.createElement("option");o.textContent=a,o.setAttribute("value",i),r.appendChild(o)}),r.addEventListener("change",()=>{e.format(Yl.blotName,r.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(r),e.children.head&&(r.value=Yl.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(wt.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(wt.sources.USER);const n=this.quill.getSelection();(e==null?this.quill.scroll.descendants(Lx):[e]).forEach(a=>{a.highlight(this.highlightBlot,r)}),this.quill.update(wt.sources.SILENT),n!=null&&this.quill.setSelection(n,wt.sources.SILENT)}highlightBlot(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(r=this.languages[r]?r:"plain",r==="plain")return Vw(e).split(`
`).reduce((i,a,o)=>(o!==0&&i.insert(`
`,{[No.blotName]:r}),i.insert(a)),new hr);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(No.className),n.innerHTML=uve(this.options.hljs,r,e),AC(this.quill.scroll,n,[(i,a)=>{const o=fx.value(i);return o?a.compose(new hr().retain(a.length(),{[Ou.blotName]:o})):a}],[(i,a)=>i.data.split(`
`).reduce((o,l,c)=>(c!==0&&o.insert(`
`,{[No.blotName]:r}),o.insert(l)),a)],new WeakMap)}}fH.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class _c extends Wa{static blotName="table";static tagName="TD";static create(e){const r=super.create();return e?r.setAttribute("data-row",e):r.setAttribute("data-row",TC()),r}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,r){e===_c.blotName&&r?this.domNode.setAttribute("data-row",r):super.format(e,r)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class x0 extends R0{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),r=this.children.tail.formats(),n=this.next.children.head.formats(),i=this.next.children.tail.formats();return e.table===r.table&&e.table===n.table&&e.table===i.table}return!1}optimize(e){super.optimize(e),this.children.forEach(r=>{if(r.next==null)return;const n=r.formats(),i=r.next.formats();if(n.table!==i.table){const a=this.splitAfter(r);a&&a.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class ef extends R0{static blotName="table-body";static tagName="TBODY"}class b2 extends R0{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(x0),r=e.reduce((n,i)=>Math.max(i.children.length,n),0);e.forEach(n=>{new Array(r-n.children.length).fill(0).forEach(()=>{let i;n.children.head!=null&&(i=_c.formats(n.children.head.domNode));const a=this.scroll.create(_c.blotName,i);n.appendChild(a),a.optimize()})})}cells(e){return this.rows().map(r=>r.children.at(e))}deleteColumn(e){const[r]=this.descendant(ef);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e);i?.remove()})}insertColumn(e){const[r]=this.descendant(ef);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e),a=_c.formats(n.children.head.domNode),o=this.scroll.create(_c.blotName,a);n.insertBefore(o,i)})}insertRow(e){const[r]=this.descendant(ef);if(r==null||r.children.head==null)return;const n=TC(),i=this.scroll.create(x0.blotName);r.children.head.children.forEach(()=>{const o=this.scroll.create(_c.blotName,n);i.appendChild(o)});const a=r.children.at(e);r.insertBefore(i,a)}rows(){const e=this.children.head;return e==null?[]:e.children.map(r=>r)}}b2.allowedChildren=[ef];ef.requiredContainer=b2;ef.allowedChildren=[x0];x0.requiredContainer=ef;x0.allowedChildren=[_c];_c.requiredContainer=x0;function TC(){return`row-${Math.random().toString(36).slice(2,6)}`}class hve extends Dd{static register(){wt.register(_c),wt.register(x0),wt.register(ef),wt.register(b2)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(b2).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,r]=this.getTable();r!=null&&(e.deleteColumn(r.cellOffset()),this.quill.update(wt.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(wt.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const r=e.offset();e.remove(),this.quill.update(wt.sources.USER),this.quill.setSelection(r,wt.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[r,n]=this.quill.getLine(e.index);if(r==null||r.statics.blotName!==_c.blotName)return[null,null,null,-1];const i=r.parent;return[i.parent.parent,i,r,n]}insertColumn(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const o=a.cellOffset();n.insertColumn(o+e),this.quill.update(wt.sources.USER);let l=i.rowOffset();e===0&&(l+=1),this.quill.setSelection(r.index+l,r.length,wt.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const o=i.rowOffset();n.insertRow(o+e),this.quill.update(wt.sources.USER),e>0?this.quill.setSelection(r,wt.sources.SILENT):this.quill.setSelection(r.index+i.children.length,r.length,wt.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,r){const n=this.quill.getSelection();if(n==null)return;const i=new Array(e).fill(0).reduce(a=>{const o=new Array(r).fill(`
`).join("");return a.insert(o,{table:TC()})},new hr().retain(n.index));this.quill.updateContents(i,wt.sources.USER),this.quill.setSelection(n.index,wt.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(wt.events.SCROLL_OPTIMIZE,e=>{e.some(r=>["TD","TR","TBODY","TABLE"].includes(r.target.tagName)?(this.quill.once(wt.events.TEXT_CHANGE,(n,i,a)=>{a===wt.sources.USER&&this.balanceTables()}),!0):!1)})}}const DM=Gu("quill:toolbar");class LC extends Dd{constructor(e,r){if(super(e,r),Array.isArray(this.options.container)){const n=document.createElement("div");n.setAttribute("role","toolbar"),fve(n,this.options.container),e.container?.parentNode?.insertBefore(n,e.container),this.container=n}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){DM.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(n=>{const i=this.options.handlers?.[n];i&&this.addHandler(n,i)}),Array.from(this.container.querySelectorAll("button, select")).forEach(n=>{this.attach(n)}),this.quill.on(wt.events.EDITOR_CHANGE,()=>{const[n]=this.quill.selection.getRange();this.update(n)})}addHandler(e,r){this.handlers[e]=r}attach(e){let r=Array.from(e.classList).find(i=>i.indexOf("ql-")===0);if(!r)return;if(r=r.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[r]==null&&this.quill.scroll.query(r)==null){DM.warn("ignoring attaching to nonexistent format",r,e);return}const n=e.tagName==="SELECT"?"change":"click";e.addEventListener(n,i=>{let a;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const l=e.options[e.selectedIndex];l.hasAttribute("selected")?a=!1:a=l.value||!1}else e.classList.contains("ql-active")?a=!1:a=e.value||!e.hasAttribute("value"),i.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[r]!=null)this.handlers[r].call(this,a);else if(this.quill.scroll.query(r).prototype instanceof _l){if(a=prompt(`Enter ${r}`),!a)return;this.quill.updateContents(new hr().retain(o.index).delete(o.length).insert({[r]:a}),wt.sources.USER)}else this.quill.format(r,a,wt.sources.USER);this.update(o)}),this.controls.push([r,e])}update(e){const r=e==null?{}:this.quill.getFormat(e);this.controls.forEach(n=>{const[i,a]=n;if(a.tagName==="SELECT"){let o=null;if(e==null)o=null;else if(r[i]==null)o=a.querySelector("option[selected]");else if(!Array.isArray(r[i])){let l=r[i];typeof l=="string"&&(l=l.replace(/"/g,'\\"')),o=a.querySelector(`option[value="${l}"]`)}o==null?(a.value="",a.selectedIndex=-1):o.selected=!0}else if(e==null)a.classList.remove("ql-active"),a.setAttribute("aria-pressed","false");else if(a.hasAttribute("value")){const o=r[i],l=o===a.getAttribute("value")||o!=null&&o.toString()===a.getAttribute("value")||o==null&&!a.getAttribute("value");a.classList.toggle("ql-active",l),a.setAttribute("aria-pressed",l.toString())}else{const o=r[i]!=null;a.classList.toggle("ql-active",o),a.setAttribute("aria-pressed",o.toString())}})}}LC.DEFAULTS={};function BM(t,e,r){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${e}`),n.setAttribute("aria-pressed","false"),r!=null?(n.value=r,n.setAttribute("aria-label",`${e}: ${r}`)):n.setAttribute("aria-label",e),t.appendChild(n)}function fve(t,e){Array.isArray(e[0])||(e=[e]),e.forEach(r=>{const n=document.createElement("span");n.classList.add("ql-formats"),r.forEach(i=>{if(typeof i=="string")BM(n,i);else{const a=Object.keys(i)[0],o=i[a];Array.isArray(o)?pve(n,a,o):BM(n,a,o)}}),t.appendChild(n)})}function pve(t,e,r){const n=document.createElement("select");n.classList.add(`ql-${e}`),r.forEach(i=>{const a=document.createElement("option");i!==!1?a.setAttribute("value",String(i)):a.setAttribute("selected","selected"),n.appendChild(a)}),t.appendChild(n)}LC.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(t!=null)if(t.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(r=>{this.quill.scroll.query(r,fr.INLINE)!=null&&this.quill.format(r,!1,wt.sources.USER)})}else this.quill.removeFormat(t.index,t.length,wt.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();t==="rtl"&&e==null?this.quill.format("align","right",wt.sources.USER):!t&&e==="right"&&this.quill.format("align",!1,wt.sources.USER),this.quill.format("direction",t,wt.sources.USER)},indent(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e),n=parseInt(r.indent||0,10);if(t==="+1"||t==="-1"){let i=t==="+1"?1:-1;r.direction==="rtl"&&(i*=-1),this.quill.format("indent",n+i,wt.sources.USER)}},link(t){t===!0&&(t=prompt("Enter link URL:")),this.quill.format("link",t,wt.sources.USER)},list(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e);t==="check"?r.list==="checked"||r.list==="unchecked"?this.quill.format("list",!1,wt.sources.USER):this.quill.format("list","unchecked",wt.sources.USER):this.quill.format("list",t,wt.sources.USER)}}};const mve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',gve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',xve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',bve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',yve='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',vve='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',wve='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',jve='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',$M='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',Nve='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',kve='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',Sve='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',_ve='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',Cve='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',Ave='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Eve='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Tve='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',Lve='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Ove='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',Mve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',Pve='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',Ive='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',Rve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',Dve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',Bve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',$ve='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',Fve='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',Uve='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',zve='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',qve='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',Hve='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',Wve='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',Gve='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',Qx={align:{"":mve,center:gve,right:xve,justify:bve},background:yve,blockquote:vve,bold:wve,clean:jve,code:$M,"code-block":$M,color:Nve,direction:{"":kve,rtl:Sve},formula:_ve,header:{1:Cve,2:Ave,3:Eve,4:Tve,5:Lve,6:Ove},italic:Mve,image:Pve,indent:{"+1":Ive,"-1":Rve},link:Dve,list:{bullet:Bve,check:$ve,ordered:Fve},script:{sub:Uve,super:zve},strike:qve,table:Hve,underline:Wve,video:Gve},Vve='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let FM=0;function UM(t,e){t.setAttribute(e,`${t.getAttribute(e)!=="true"}`)}class Xw{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",r=>{switch(r.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),r.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),UM(this.label,"aria-expanded"),UM(this.options,"aria-hidden")}buildItem(e){const r=document.createElement("span");r.tabIndex="0",r.setAttribute("role","button"),r.classList.add("ql-picker-item");const n=e.getAttribute("value");return n&&r.setAttribute("data-value",n),e.textContent&&r.setAttribute("data-label",e.textContent),r.addEventListener("click",()=>{this.selectItem(r,!0)}),r.addEventListener("keydown",i=>{switch(i.key){case"Enter":this.selectItem(r,!0),i.preventDefault();break;case"Escape":this.escape(),i.preventDefault();break}}),r}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=Vve,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${FM}`,FM+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(r=>{const n=this.buildItem(r);e.appendChild(n),r.selected===!0&&this.selectItem(n)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");e!==n&&(n?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),r&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const r=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",r)}}class pH extends Xw{constructor(e,r){super(e),this.label.innerHTML=r,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(e){const r=super.buildItem(e);return r.style.backgroundColor=e.getAttribute("value")||"",r}selectItem(e,r){super.selectItem(e,r);const n=this.label.querySelector(".ql-color-label"),i=e&&e.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=i:n.style.fill=i)}}class mH extends Xw{constructor(e,r){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=r[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,r){super.selectItem(e,r);const n=e||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const Yve=t=>{const{overflowY:e}=getComputedStyle(t,null);return e!=="visible"&&e!=="clip"};let gH=class{constructor(e,r){this.quill=e,this.boundsContainer=r||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Yve(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const r=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${r}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),a=this.root.getBoundingClientRect();let o=0;if(a.right>i.right&&(o=i.right-a.right,this.root.style.left=`${r+o}px`),a.left<i.left&&(o=i.left-a.left,this.root.style.left=`${r+o}px`),a.bottom>i.bottom){const l=a.bottom-a.top,c=e.bottom-e.top+l;this.root.style.top=`${n-c}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}};const Kve=[!1,"center","right","justify"],Xve=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Jve=[!1,"serif","monospace"],Zve=["1","2","3",!1],Qve=["small",!1,"large","huge"];class Ub extends Um{constructor(e,r){super(e,r);const n=i=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(i.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(a=>{a.container.contains(i.target)||a.close()})};e.emitter.listenDOM("click",document.body,n)}addModule(e){const r=super.addModule(e);return e==="toolbar"&&this.extendToolbar(r),r}buildButtons(e,r){Array.from(e).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(a=>{if(a.startsWith("ql-")&&(a=a.slice(3),r[a]!=null))if(a==="direction")n.innerHTML=r[a][""]+r[a].rtl;else if(typeof r[a]=="string")n.innerHTML=r[a];else{const o=n.value||"";o!=null&&r[a][o]&&(n.innerHTML=r[a][o])}})})}buildPickers(e,r){this.pickers=Array.from(e).map(i=>{if(i.classList.contains("ql-align")&&(i.querySelector("option")==null&&zg(i,Kve),typeof r.align=="object"))return new mH(i,r.align);if(i.classList.contains("ql-background")||i.classList.contains("ql-color")){const a=i.classList.contains("ql-background")?"background":"color";return i.querySelector("option")==null&&zg(i,Xve,a==="background"?"#ffffff":"#000000"),new pH(i,r[a])}return i.querySelector("option")==null&&(i.classList.contains("ql-font")?zg(i,Jve):i.classList.contains("ql-header")?zg(i,Zve):i.classList.contains("ql-size")&&zg(i,Qve)),new Xw(i)});const n=()=>{this.pickers.forEach(i=>{i.update()})};this.quill.on(dr.events.EDITOR_CHANGE,n)}}Ub.DEFAULTS=Qh({},Um.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");t==null&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""}),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class xH extends gH{constructor(e,r){super(e,r),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;r!=null?this.textbox.value=r:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:r}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,dr.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,dr.sources.USER)),this.quill.root.scrollTop=r;break}case"video":e=e1e(e);case"formula":{if(!e)break;const r=this.quill.getSelection(!0);if(r!=null){const n=r.index+r.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),e,dr.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",dr.sources.USER),this.quill.setSelection(n+2,dr.sources.USER)}break}}this.textbox.value="",this.hide()}}function e1e(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}function zg(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(n=>{const i=document.createElement("option");n===r?i.setAttribute("selected","selected"):i.setAttribute("value",String(n)),t.appendChild(i)})}const t1e=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class r1e extends xH{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,r){super(e,r),this.quill.on(dr.events.EDITOR_CHANGE,(n,i,a,o)=>{if(n===dr.events.SELECTION_CHANGE)if(i!=null&&i.length>0&&o===dr.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const l=this.quill.getLines(i.index,i.length);if(l.length===1){const c=this.quill.getBounds(i);c!=null&&this.position(c)}else{const c=l[l.length-1],u=this.quill.getIndex(c),f=Math.min(c.length()-1,i.index+i.length-u),p=this.quill.getBounds(new g0(u,f));p!=null&&this.position(p)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(dr.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const r=this.quill.getBounds(e);r!=null&&this.position(r)}},1)})}cancel(){this.show()}position(e){const r=super.position(e),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",r!==0&&(n.style.marginLeft=`${-1*r-n.offsetWidth/2}px`),r}}class bH extends Ub{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=t1e),super(e,r),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new r1e(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),Qx),this.buildPickers(e.container.querySelectorAll("select"),Qx))}}bH.DEFAULTS=Qh({},Ub.DEFAULTS,{modules:{toolbar:{handlers:{link(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1,wt.sources.USER)}}}}});const n1e=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class s1e extends xH{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const r=this.linkRange;this.restoreFocus(),this.quill.formatText(r,"link",!1,dr.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(dr.events.SELECTION_CHANGE,(e,r,n)=>{if(e!=null){if(e.length===0&&n===dr.sources.USER){const[i,a]=this.quill.scroll.descendant(x2,e.index);if(i!=null){this.linkRange=new g0(e.index-a,i.length());const o=x2.formats(i.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const l=this.quill.getBounds(this.linkRange);l!=null&&this.position(l);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class yH extends Ub{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=n1e),super(e,r),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),Qx),this.buildPickers(e.container.querySelectorAll("select"),Qx),this.tooltip=new s1e(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(r,n)=>{e.handlers.link.call(e,!n.format.link)}))}}yH.DEFAULTS=Qh({},Ub.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const e=this.quill.getSelection();if(e==null||e.length===0)return;let r=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(r)&&r.indexOf("mailto:")!==0&&(r=`mailto:${r}`);const{tooltip:n}=this.quill.theme;n.edit("link",r)}else this.quill.format("link",!1,wt.sources.USER)}}}}});wt.register({"attributors/attribute/direction":rH,"attributors/class/align":Qq,"attributors/class/background":cye,"attributors/class/color":lye,"attributors/class/direction":nH,"attributors/class/font":aH,"attributors/class/size":lH,"attributors/style/align":eH,"attributors/style/background":kC,"attributors/style/color":NC,"attributors/style/direction":sH,"attributors/style/font":oH,"attributors/style/size":cH},!0);wt.register({"formats/align":Qq,"formats/direction":nH,"formats/indent":tve,"formats/background":kC,"formats/color":NC,"formats/font":aH,"formats/size":lH,"formats/blockquote":rve,"formats/code-block":No,"formats/header":nve,"formats/list":Fb,"formats/bold":EC,"formats/code":SC,"formats/italic":sve,"formats/link":x2,"formats/script":ive,"formats/strike":ave,"formats/underline":ove,"formats/formula":lve,"formats/image":cve,"formats/video":dve,"modules/syntax":fH,"modules/table":hve,"modules/toolbar":LC,"themes/bubble":bH,"themes/snow":yH,"ui/icons":Qx,"ui/picker":Xw,"ui/icon-picker":mH,"ui/color-picker":pH,"ui/tooltip":gH},!0);class Jw extends Ke.Component{constructor(e){super(e),this.editingAreaRef=b.createRef(),this.containerRef=b.createRef(),this.dirtyProps=["modules","formats","bounds","theme","children"],this.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],this.state={generation:0},this.selection=null,this.onEditorChange=(n,i,a,o)=>{n==="text-change"?this.onEditorChangeText?.(this.editor.getSemanticHTML(),i,o,this.unprivilegedEditor):n==="selection-change"&&this.onEditorChangeSelection?.(i,o,this.unprivilegedEditor)};const r=this.isControlled()?e.value:e.defaultValue;this.value=r??""}validateProps(e){if(Ke.Children.count(e.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ke.Children.count(e.children)&&Ke.Children.only(e.children)?.type==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.");if(this.lastDeltaChangeSet&&e.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")}shouldComponentUpdate(e,r){if(this.validateProps(e),!this.editor||this.state.generation!==r.generation)return!0;if("value"in e){const n=this.getEditorContents(),i=e.value??"";this.isEqualValue(i,n)||this.setEditorContents(this.editor,i)}return e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),[...this.cleanProps,...this.dirtyProps].some(n=>!zh(e[n],this.props[n]))}shouldComponentRegenerate(e){return this.dirtyProps.some(r=>!zh(e[r],this.props[r]))}componentDidMount(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())}componentWillUnmount(){this.destroyEditor()}componentDidUpdate(e,r){if(this.editor&&this.shouldComponentRegenerate(e)){const n=this.editor.getContents(),i=this.editor.getSelection();this.regenerationSnapshot={delta:n,selection:i},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.editor&&e.placeholder!==this.props.placeholder&&(this.editor.root.dataset.placeholder=this.props.placeholder||""),this.state.generation!==r.generation){const{delta:n,selection:i}=this.regenerationSnapshot;delete this.regenerationSnapshot,this.instantiateEditor();const a=this.editor;a.setContents(n),zM(()=>this.setEditorSelection(a,i))}}instantiateEditor(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())}destroyEditor(){if(!this.editor)return;this.unhookEditor(this.editor);const e=this.props.modules?.toolbar;if(!(typeof e=="object"&&e&&"container"in e&&typeof e.container=="string"||typeof e=="string")){const n=this.containerRef.current?.querySelector(".ql-toolbar");n&&n.remove()}delete this.editor}isControlled(){return"value"in this.props}getEditorConfig(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,theme:this.props.theme}}getEditor(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor}createEditor(e,r){const n=new wt(e,r);return r.tabIndex!=null&&this.setEditorTabIndex(n,r.tabIndex),this.hookEditor(n),n}hookEditor(e){this.unprivilegedEditor=this.makeUnprivilegedEditor(e),e.on("editor-change",this.onEditorChange)}unhookEditor(e){e.off("editor-change",this.onEditorChange)}getEditorContents(){return this.value}getEditorSelection(){return this.selection}isDelta(e){return e&&e.ops}isEqualValue(e,r){return this.isDelta(e)&&this.isDelta(r)?zh(e.ops,r.ops):zh(e,r)}setEditorContents(e,r){this.value=r;const n=this.getEditorSelection();typeof r=="string"?e.setContents(e.clipboard.convert({html:r})):e.setContents(r),zM(()=>this.setEditorSelection(e,n))}setEditorSelection(e,r){if(this.selection=r,r){const n=e.getLength();r.index=Math.max(0,Math.min(r.index,n-1)),r.length=Math.max(0,Math.min(r.length,n-1-r.index)),e.setSelection(r)}}setEditorTabIndex(e,r){e?.scroll?.domNode&&(e.scroll.domNode.tabIndex=r)}setEditorReadOnly(e,r){r?e.disable():e.enable()}makeUnprivilegedEditor(e){const r=e;return{getHTML:()=>r.root.innerHTML,getSemanticHTML:r.getSemanticHTML.bind(r),getLength:r.getLength.bind(r),getText:r.getText.bind(r),getContents:r.getContents.bind(r),getSelection:r.getSelection.bind(r),getBounds:r.getBounds.bind(r)}}getEditingArea(){const e=this.editingAreaRef.current;if(!e)throw new Error("Cannot find element for editing area");if(e.nodeType===3)throw new Error("Editing area cannot be a text node");return e}renderEditingArea(){const{children:e,preserveWhitespace:r}=this.props,{generation:n}=this.state,i={key:n,ref:this.editingAreaRef};return Ke.Children.count(e)?Ke.cloneElement(Ke.Children.only(e),i):r?Ke.createElement("pre",{...i}):Ke.createElement("div",{...i})}render(){return Ke.createElement("div",{ref:this.containerRef,id:this.props.id,style:this.props.style,key:this.state.generation,className:`quill ${this.props.className??""}`,onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())}onEditorChangeText(e,r,n,i){if(!this.editor)return;const a=this.isDelta(this.value)?i.getContents():i.getSemanticHTML();a!==this.getEditorContents()&&(this.lastDeltaChangeSet=r,this.value=a,this.props.onChange?.(e,r,n,i))}onEditorChangeSelection(e,r,n){if(!this.editor)return;const i=this.getEditorSelection(),a=!i&&e,o=i&&!e;zh(e,i)||(this.selection=e,this.props.onChangeSelection?.(e,r,n),a?this.props.onFocus?.(e,r,n):o&&this.props.onBlur?.(i,r,n))}focus(){this.editor&&this.editor.focus()}blur(){this.editor&&(this.selection=null,this.editor.blur())}}Jw.displayName="React Quill";Jw.Quill=wt;Jw.defaultProps={theme:"snow",modules:{},readOnly:!1};function zM(t){Promise.resolve().then(t)}const i1e={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["clean"]]},FS=({value:t,onChange:e,placeholder:r,type:n="General",height:i="h-40"})=>{const{userProfile:a}=Sr(),{addToast:o}=wn(),[l,c]=b.useState(!1),u=async()=>{const f=a?.settings?.geminiApiKey;if(!f){o("AI API Key missing in settings.","error");return}if(!t||t.replace(/<[^>]*>/g,"").trim().length<5){o("Please write a bit more first!","warning");return}c(!0);try{const p=await yo.spruceUpText(f,t,n);e(p),o("Spruced up successfully!","success")}catch(p){console.error(p),o("AI failed to enhance text.","error")}finally{c(!1)}};return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.jsxs("button",{type:"button",onClick:u,disabled:l,className:"flex items-center gap-1 text-[10px] uppercase font-bold tracking-wider bg-indigo-600/80 hover:bg-indigo-500 text-white px-3 py-1.5 rounded-full transition-all backdrop-blur-sm disabled:opacity-50 shadow-lg border border-indigo-400/30",title:"Spruce up with AI",children:[l?s.jsx("span",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Polish"]})}),s.jsx("div",{className:`bg-gray-900 border border-gray-700 rounded-lg overflow-hidden ${i} flex flex-col`,children:s.jsx(Jw,{theme:"snow",value:t||"",onChange:e,modules:i1e,placeholder:r,className:"flex-1 text-white flex flex-col h-full"})}),s.jsx("style",{children:`
                .quill { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
                .ql-toolbar.ql-snow { border: none !important; border-bottom: 1px solid #374151 !important; background: #111827; flex-shrink: 0; }
                .ql-container.ql-snow { border: none !important; flex: 1; display: flex; flex-direction: column; overflow: hidden; background: transparent; }
                .ql-editor { color: #e5e7eb; flex: 1; overflow-y: auto; font-family: inherit; padding: 1rem; }
                .ql-editor.ql-blank::before { color: #6b7280; font-style: normal; font-style: italic; }
                
                /* Icon/Picker Colors */
                .ql-snow .ql-stroke { stroke: #9ca3af !important; }
                .ql-snow .ql-fill { fill: #9ca3af !important; }
                .ql-snow .ql-picker { color: #9ca3af !important; }
                .ql-snow .ql-picker-options { background-color: #1f2937 !important; border-color: #374151 !important; color: #e5e7eb !important; }
                .ql-snow .ql-picker-item:hover { color: #818cf8 !important; }
                .ql-snow .ql-picker-item.ql-selected { color: #6366f1 !important; }
            `})]})},a1e=({ticket:t,isAdmin:e,currentUserId:r,onEdit:n,onDelete:i,onVote:a,getTypeBadge:o,getStatusBadge:l})=>{const[c,u]=b.useState(!1),[f,p]=b.useState([]);return b.useEffect(()=>{c&&t.note_count>0&&f.length===0&&Ze.getTicketNotes(t.id).then(p).catch(console.error)},[c,t.note_count,t.id]),s.jsx("div",{className:"bg-gray-800/40 border border-white/5 rounded-lg p-4 hover:bg-gray-800/60 transition-colors group",children:s.jsxs("div",{className:"flex justify-between items-start gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[o(t.type),s.jsx("h4",{className:"text-white font-medium hover:text-indigo-300 cursor-pointer truncate",onClick:()=>(e||t.created_by===r&&t.status==="open")&&n(t),children:t.title}),l(t.status),t.epic_title&&s.jsx("span",{className:"text-[10px] bg-indigo-500/10 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/20 whitespace-nowrap",children:t.epic_title})]}),s.jsx("div",{className:`text-sm text-gray-400 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-0 [&>ul]:list-none [&>ul]:pl-0 ${c?"":"line-clamp-2"}`,dangerouslySetInnerHTML:{__html:t.description||""}}),s.jsx("button",{onClick:x=>{x.stopPropagation(),u(!c)},className:"text-xs text-indigo-400 hover:text-indigo-300 mt-1 hover:underline focus:outline-none",children:c?"Show less":"Read more..."}),s.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-500 flex-wrap",children:[s.jsxs("span",{children:["b/",t.created_by_username||"Unknown"]}),t.assigned_to&&s.jsxs("span",{className:"text-indigo-400",children:["Assigned: ",t.assigned_to_username]}),t.due_date&&s.jsxs("span",{children:["Due: ",vi(new Date(t.due_date),"MMM d")]}),t.estimated_release_date&&s.jsxs("span",{className:"text-orange-400",children:["Est. Release: ",vi(new Date(t.estimated_release_date),"MMM d")]}),t.date_released&&s.jsxs("span",{className:"text-green-400",children:["Released: ",vi(new Date(t.date_released),"MMM d")]}),t.note_count>0&&s.jsxs("span",{className:"flex items-center gap-1 text-gray-400 bg-gray-700/50 px-1.5 py-0.5 rounded",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),t.note_count," ",t.note_count===1?"Note":"Notes",t.last_note_at&&s.jsxs("span",{className:"opacity-70 ml-1",children:[" ",vi(new Date(t.last_note_at),"MMM d, h:mm a")]})]}),(e||t.created_by===r&&t.status==="open")&&s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>n(t),className:"hover:text-white transition-colors",children:["Edit ",e&&t.created_by!==r?"(Admin)":""]}),s.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this ticket?")&&i(t.id)},className:"text-gray-500 hover:text-red-400 transition-colors",children:"Delete"})]})]}),c&&f.length>0&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 space-y-2",children:[s.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase",children:"Latest Notes"}),f.map(x=>s.jsxs("div",{className:"bg-gray-900/30 p-2 rounded text-xs border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-gray-500 mb-0.5",children:[s.jsx("span",{className:"font-bold text-indigo-400",children:x.username}),s.jsx("span",{children:vi(new Date(x.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-gray-300 mb-0",children:x.note})]},x.id))]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-1 pl-4 border-l border-white/5 shrink-0",children:[s.jsx("button",{onClick:()=>a(t.id),className:"text-gray-400 hover:text-indigo-400",children:""}),s.jsx("span",{className:"font-mono text-sm font-bold text-white",children:t.votes})]})]})})},o1e=({isOpen:t,onClose:e})=>{const{user:r,userProfile:n}=Sr(),[i,a]=b.useState("issues"),[o,l]=b.useState([]),[c,u]=b.useState([]),[f,p]=b.useState(!1),[x,m]=b.useState(""),[y,v]=b.useState(""),[j,N]=b.useState({title:"",description:"",type:"bug",epic_id:""}),[C,A]=b.useState(null),[L,O]=b.useState([]),[F,T]=b.useState([]),[I,B]=b.useState(""),k=r?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||n?.settings?.isAdmin||n?.settings?.permissions?.includes("manage_tickets");b.useEffect(()=>{t&&R()},[t,i]),b.useEffect(()=>{k&&t&&(async()=>{try{const W=await Ze.getAssignees();O(W)}catch(W){console.error(W)}})()},[k,t]),b.useEffect(()=>{C?(async()=>{try{const W=await Ze.getTicketNotes(C.id);T(W)}catch(W){console.error(W)}})():(T([]),B(""))},[C]);const R=async()=>{p(!0);try{if(i==="issues"){const J={};x&&(J.status=x),y&&(J.type=y);const W=await Ze.getTickets(J);l(W)}else if(i==="projects"||i==="new_ticket"){const J=await Ze.getEpics();u(J)}}catch(J){console.error("Failed to load data",J)}finally{p(!1)}},P=async J=>{J.preventDefault();try{await Ze.createTicket(j),N({title:"",description:"",type:"bug",epic_id:""}),a("issues"),R()}catch(W){alert("Failed to create ticket: "+W.message)}},q=async J=>{try{await Ze.voteTicket(J),l(o.map(W=>W.id===J?{...W,votes:(W.votes||0)+1}:W))}catch(W){console.error(W)}},X=async J=>{try{await Ze.deleteTicket(J),l(o.filter(W=>W.id!==J))}catch(W){console.error("Delete error:",W),alert("Failed to delete ticket: "+W.message)}},G=async J=>{if(J.preventDefault(),!!C)try{await Ze.updateTicket(C.id,C),A(null),R()}catch(W){alert("Update failed: "+W.message)}},ne=async J=>{if(J.preventDefault(),!!I.trim())try{const W=await Ze.addTicketNote(C.id,I);T([...F,W]),B("")}catch(W){alert("Failed to add note: "+W.message)}},ee=J=>{const W={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},U={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Complete - Pending Release",complete_scheduled:"Complete - Release Scheduled",complete_blocked:"Complete - Waiting on Epic",wont_fix:"Won't Fix"};return s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold border ${W[J]||W.open} uppercase tracking-wider whitespace-nowrap`,children:U[J]||(J||"open").replace(/_/g," ")})},se=J=>J==="bug"?s.jsx("span",{className:"text-red-400 font-mono text-xs",children:"[BUG]"}):s.jsx("span",{className:"text-cyan-400 font-mono text-xs",children:"[FEAT]"});return t?s.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-50 inline-block align-bottom bg-gray-900 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full border border-white/10",children:[s.jsxs("div",{className:"bg-gray-800/50 px-6 py-4 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," System Status & Feedback"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("a",{href:"https://discord.gg/p4ybr8h6QV",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"bg-gray-800/30 px-6 border-b border-white/5 flex gap-6 overflow-x-auto",children:["issues","projects","new_ticket"].map(J=>s.jsxs("button",{onClick:()=>a(J),className:`py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${i===J?"border-indigo-500 text-white":"border-transparent text-gray-400 hover:text-gray-300"}`,children:[J==="issues"&&"Board & Issues",J==="projects"&&"Projects (Epics)",J==="new_ticket"&&"Review / Submit Issue"]},J))}),s.jsxs("div",{className:"p-6 min-h-[400px] max-h-[70vh] overflow-y-auto bg-gray-900",children:[i==="issues"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:x,onChange:J=>m(J.target.value),children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]}),s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:y,onChange:J=>v(J.target.value),children:[s.jsx("option",{value:"",children:"All Types"}),s.jsx("option",{value:"bug",children:"Bugs"}),s.jsx("option",{value:"feature",children:"Features"})]}),s.jsx("button",{onClick:R,className:"text-xs text-indigo-400 hover:text-indigo-300 underline",children:"Refresh"})]}),f?s.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading issues..."}):o.length===0?s.jsxs("div",{className:"text-center py-12 text-gray-500 border border-dashed border-white/10 rounded-xl",children:["No tickets found. ",s.jsx("button",{onClick:()=>a("new_ticket"),className:"text-indigo-400 hover:underline",children:"Create one?"})]}):s.jsx("div",{className:"space-y-3",children:o.map(J=>s.jsx(a1e,{ticket:J,isAdmin:k,currentUserId:n?.id,onEdit:A,onDelete:X,onVote:q,getTypeBadge:se,getStatusBadge:ee},J.id))})]}),i==="projects"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"Large scale projects and goals for the platform."}),c.map(J=>s.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h4",{className:"text-lg font-bold text-white",children:J.title}),s.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-700 text-gray-300",children:J.status})]}),s.jsx("div",{className:"text-gray-400 text-sm mt-2 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-2 [&>ul]:list-disc [&>ul]:pl-4",dangerouslySetInnerHTML:{__html:J.description||""}}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 text-xs text-gray-500",children:[J.ticket_count||0," Tickets linked"]})]},J.id)),c.length===0&&s.jsx("div",{className:"text-gray-500 text-center py-8",children:"No active projects. Admins can create them via API for now."})]}),i==="new_ticket"&&s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("form",{onSubmit:P,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Issue Type"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${j.type==="bug"?"bg-red-500/10 border-red-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"bug",checked:j.type==="bug",onChange:J=>N({...j,type:J.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Bug Report"}),s.jsx("div",{className:"text-xs opacity-70",children:"Something is broken"})]}),s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${j.type==="feature"?"bg-indigo-500/10 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"feature",checked:j.type==="feature",onChange:J=>N({...j,type:J.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Feature Request"}),s.jsx("div",{className:"text-xs opacity-70",children:"New idea or improvement"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",placeholder:"Short summary of the issue...",value:j.title,onChange:J=>N({...j,title:J.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(FS,{value:j.description,onChange:J=>N({...j,description:J}),placeholder:"Detailed description, steps to reproduce, or link to screenshots...",type:"Ticket",height:"h-56"})})]}),c.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Project (Optional)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:j.epic_id,onChange:J=>N({...j,epic_id:J.target.value}),children:[s.jsx("option",{value:"",children:"- None -"}),c.map(J=>s.jsx("option",{value:J.id,children:J.title},J.id))]})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all",children:"Submit Issue"})})]})})]})]})]}),C&&s.jsx("div",{className:"absolute inset-0 z-[110] flex items-center justify-center p-4 bg-black/70 backdrop-blur-md",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-3xl w-full p-8 border border-white/10 shadow-3xl overflow-y-auto max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-2xl font-black text-white italic uppercase tracking-tight",children:k?"Edit Ticket (Admin)":"Edit Your Ticket"}),s.jsx("button",{onClick:()=>A(null),className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:G,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Issue Type"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:C.type,onChange:J=>A({...C,type:J.target.value}),children:[s.jsx("option",{value:"bug",children:"Bug Report"}),s.jsx("option",{value:"feature",children:"Feature Request"})]})]}),k&&s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:C.status,onChange:J=>A({...C,status:J.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:C.title,onChange:J=>A({...C,title:J.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(FS,{value:C.description,onChange:J=>A({...C,description:J}),placeholder:"Update description...",type:"Ticket",height:"h-56"})})]}),k&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Project (Epic)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:C.epic_id||"",onChange:J=>A({...C,epic_id:J.target.value||null}),children:[s.jsx("option",{value:"",children:"None"}),c.map(J=>s.jsx("option",{value:J.id,children:J.title},J.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Assignee"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:C.assigned_to||"",onChange:J=>A({...C,assigned_to:J.target.value||null}),children:[s.jsx("option",{value:"",children:"- Unassigned -"}),L.map(J=>s.jsx("option",{value:J.id,children:J.username},J.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Due Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:C.due_date?vi(new Date(C.due_date),"yyyy-MM-dd"):"",onChange:J=>A({...C,due_date:J.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Completion"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:C.est_completion_date?vi(new Date(C.est_completion_date),"yyyy-MM-dd"):"",onChange:J=>A({...C,est_completion_date:J.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Release"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:C.estimated_release_date?vi(new Date(C.estimated_release_date),"yyyy-MM-dd"):"",onChange:J=>A({...C,estimated_release_date:J.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Date Released"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:C.date_released?vi(new Date(C.date_released),"yyyy-MM-dd"):"",onChange:J=>A({...C,date_released:J.target.value})})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-6 mt-6",children:[s.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4",children:"Internal Notes"}),s.jsxs("div",{className:"space-y-3 max-h-48 overflow-y-auto mb-4 custom-scrollbar",children:[F.length===0&&s.jsx("p",{className:"text-xs text-gray-600 italic",children:"No notes yet."}),F.map(J=>s.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[s.jsx("span",{className:"font-bold text-indigo-400 uppercase tracking-widest",children:J.username}),s.jsx("span",{children:vi(new Date(J.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-sm text-gray-300",children:J.note})]},J.id))]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",placeholder:"Add a note...",value:I,onChange:J=>B(J.target.value),onKeyDown:J=>J.key==="Enter"&&(J.preventDefault(),ne(J))}),s.jsx("button",{type:"button",onClick:ne,className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white text-xs font-bold uppercase tracking-widest rounded-xl transition-all",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[s.jsx("button",{type:"button",onClick:()=>A(null),className:"px-6 py-3 text-gray-500 font-bold uppercase tracking-widest text-xs hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-indigo-500/20 transition-all",children:"Save Changes"})]})]})]})})]}):null};var vH="clover",l1e=function(e){return e===3?"v3":e},wH="https://js.stripe.com",c1e="".concat(wH,"/").concat(vH,"/stripe.js"),d1e=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,u1e=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var h1e=function(e){return d1e.test(e)||u1e.test(e)},f1e=function(){for(var e=document.querySelectorAll('script[src^="'.concat(wH,'"]')),r=0;r<e.length;r++){var n=e[r];if(h1e(n.src))return n}return null},qM=function(e){var r="",n=document.createElement("script");n.src="".concat(c1e).concat(r);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},p1e=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.6.0",startTime:r})},qg=null,Ev=null,Tv=null,m1e=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},g1e=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},x1e=function(e){return qg!==null?qg:(qg=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var i=f1e();if(!(i&&e)){if(!i)i=qM(e);else if(i&&Tv!==null&&Ev!==null){var a;i.removeEventListener("load",Tv),i.removeEventListener("error",Ev),(a=i.parentNode)===null||a===void 0||a.removeChild(i),i=qM(e)}}Tv=g1e(r,n),Ev=m1e(n),i.addEventListener("load",Tv),i.addEventListener("error",Ev)}catch(o){n(o);return}}),qg.catch(function(r){return qg=null,Promise.reject(r)}))},b1e=function(e,r,n){if(e===null)return null;var i=r[0],a=i.match(/^pk_test/),o=l1e(e.version),l=vH;a&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.6.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,r);return p1e(c,n),c},Hg,jH=!1,NH=function(){return Hg||(Hg=x1e(null).catch(function(e){return Hg=null,Promise.reject(e)}),Hg)};Promise.resolve().then(function(){return NH()}).catch(function(t){jH||console.warn(t)});var y1e=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];jH=!0;var i=Date.now();return NH().then(function(a){return b1e(a,r,i)})},v1e=U6();const ws=Co(v1e);function HM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function WM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?HM(Object(r),!0).forEach(function(n){kH(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function k1(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?k1=function(e){return typeof e}:k1=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k1(t)}function kH(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w1e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function j1e(t,e){if(t==null)return{};var r=w1e(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function SH(t,e){return N1e(t)||k1e(t,e)||S1e(t,e)||_1e()}function N1e(t){if(Array.isArray(t))return t}function k1e(t,e){var r=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(r!=null){var n=[],i=!0,a=!1,o,l;try{for(r=r.call(t);!(i=(o=r.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(c){a=!0,l=c}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw l}}return n}}function S1e(t,e){if(t){if(typeof t=="string")return GM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GM(t,e)}}function GM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var mo=function(e,r,n){var i=!!n,a=Ke.useRef(n);Ke.useEffect(function(){a.current=n},[n]),Ke.useEffect(function(){if(!i||!e)return function(){};var o=function(){a.current&&a.current.apply(a,arguments)};return e.on(r,o),function(){e.off(r,o)}},[i,r,e,a])},US=function(e){var r=Ke.useRef(e);return Ke.useEffect(function(){r.current=e},[e]),r.current},ym=function(e){return e!==null&&k1(e)==="object"},C1e=function(e){return ym(e)&&typeof e.then=="function"},A1e=function(e){return ym(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},VM="[object Object]",E1e=function t(e,r){if(!ym(e)||!ym(r))return e===r;var n=Array.isArray(e),i=Array.isArray(r);if(n!==i)return!1;var a=Object.prototype.toString.call(e)===VM,o=Object.prototype.toString.call(r)===VM;if(a!==o)return!1;if(!a&&!n)return e===r;var l=Object.keys(e),c=Object.keys(r);if(l.length!==c.length)return!1;for(var u={},f=0;f<l.length;f+=1)u[l[f]]=!0;for(var p=0;p<c.length;p+=1)u[c[p]]=!0;var x=Object.keys(u);if(x.length!==l.length)return!1;var m=e,y=r,v=function(N){return t(m[N],y[N])};return x.every(v)},_H=function(e,r,n){return ym(e)?Object.keys(e).reduce(function(i,a){var o=!ym(r)||!E1e(e[a],r[a]);return n.includes(a)?(o&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),i):o?WM(WM({},i||{}),{},kH({},a,e[a])):i},null):null},CH="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",YM=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:CH;if(e===null||A1e(e))return e;throw new Error(r)},T1e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:CH;if(C1e(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(i){return YM(i,r)})};var n=YM(e,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},L1e=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.4.1"}),e.registerAppInfo({name:"react-stripe-js",version:"5.4.1",url:"https://stripe.com/docs/stripe-js/react"}))},Zw=Ke.createContext(null);Zw.displayName="ElementsContext";var AH=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e},EH=function(e){var r=e.stripe,n=e.options,i=e.children,a=Ke.useMemo(function(){return T1e(r)},[r]),o=Ke.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),l=SH(o,2),c=l[0],u=l[1];Ke.useEffect(function(){var x=!0,m=function(v){u(function(j){return j.stripe?j:{stripe:v,elements:v.elements(n)}})};return a.tag==="async"&&!c.stripe?a.stripePromise.then(function(y){y&&x&&m(y)}):a.tag==="sync"&&!c.stripe&&m(a.stripe),function(){x=!1}},[a,c,n]);var f=US(r);Ke.useEffect(function(){f!==null&&f!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[f,r]);var p=US(n);return Ke.useEffect(function(){if(c.elements){var x=_H(n,p,["clientSecret","fonts"]);x&&c.elements.update(x)}},[n,p,c.elements]),Ke.useEffect(function(){L1e(c.stripe)},[c.stripe]),Ke.createElement(Zw.Provider,{value:c},i)};EH.propTypes={stripe:ws.any,options:ws.object};var O1e=function(e){var r=Ke.useContext(Zw);return AH(r,e)},M1e=function(){var e=O1e("calls useElements()"),r=e.elements;return r};ws.func.isRequired;var TH=Ke.createContext(null);TH.displayName="CheckoutContext";ws.any,ws.shape({clientSecret:ws.oneOfType([ws.string,ws.instanceOf(Promise)]).isRequired,elementsOptions:ws.object}).isRequired;var zS=function(e){var r=Ke.useContext(TH),n=Ke.useContext(Zw);if(r){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return AH(n,e)},P1e=["mode"],I1e=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},rl=function(e,r){var n="".concat(I1e(e),"Element"),i=function(c){var u=c.id,f=c.className,p=c.options,x=p===void 0?{}:p,m=c.onBlur,y=c.onFocus,v=c.onReady,j=c.onChange,N=c.onEscape,C=c.onClick,A=c.onLoadError,L=c.onLoaderStart,O=c.onNetworksChange,F=c.onConfirm,T=c.onCancel,I=c.onShippingAddressChange,B=c.onShippingRateChange,$=c.onSavedPaymentMethodRemove,k=c.onSavedPaymentMethodUpdate,R=zS("mounts <".concat(n,">")),P="elements"in R?R.elements:null,q="checkoutState"in R?R.checkoutState:null,X=q?.type==="success"||q?.type==="loading"?q.sdk:null,G=Ke.useState(null),ne=SH(G,2),ee=ne[0],se=ne[1],J=Ke.useRef(null),W=Ke.useRef(null);mo(ee,"blur",m),mo(ee,"focus",y),mo(ee,"escape",N),mo(ee,"click",C),mo(ee,"loaderror",A),mo(ee,"loaderstart",L),mo(ee,"networkschange",O),mo(ee,"confirm",F),mo(ee,"cancel",T),mo(ee,"shippingaddresschange",I),mo(ee,"shippingratechange",B),mo(ee,"savedpaymentmethodremove",$),mo(ee,"savedpaymentmethodupdate",k),mo(ee,"change",j);var U;v&&(e==="expressCheckout"?U=v:U=function(){v(ee)}),mo(ee,"ready",U),Ke.useLayoutEffect(function(){if(J.current===null&&W.current!==null&&(P||X)){var te=null;if(X)switch(e){case"paymentForm":te=X.createPaymentFormElement();break;case"payment":te=X.createPaymentElement(x);break;case"address":if("mode"in x){var ce=x.mode,xe=j1e(x,P1e);if(ce==="shipping")te=X.createShippingAddressElement(xe);else if(ce==="billing")te=X.createBillingAddressElement(xe);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":te=X.createExpressCheckoutElement(x);break;case"currencySelector":te=X.createCurrencySelectorElement();break;case"taxId":te=X.createTaxIdElement(x);break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else P&&(te=P.create(e,x));J.current=te,se(te),te&&te.mount(W.current)}},[P,X,x]);var Y=US(x);return Ke.useEffect(function(){if(J.current){var te=_H(x,Y,["paymentRequest"]);te&&"update"in J.current&&J.current.update(te)}},[x,Y]),Ke.useLayoutEffect(function(){return function(){if(J.current&&typeof J.current.destroy=="function")try{J.current.destroy(),J.current=null}catch{}}},[]),Ke.createElement("div",{id:u,className:f,ref:W})},a=function(c){zS("mounts <".concat(n,">"));var u=c.id,f=c.className;return Ke.createElement("div",{id:u,className:f})},o=r?a:i;return o.propTypes={id:ws.string,className:ws.string,onChange:ws.func,onBlur:ws.func,onFocus:ws.func,onReady:ws.func,onEscape:ws.func,onClick:ws.func,onLoadError:ws.func,onLoaderStart:ws.func,onNetworksChange:ws.func,onConfirm:ws.func,onCancel:ws.func,onShippingAddressChange:ws.func,onShippingRateChange:ws.func,onSavedPaymentMethodRemove:ws.func,onSavedPaymentMethodUpdate:ws.func,options:ws.object},o.displayName=n,o.__elementType=e,o},nl=typeof window>"u",R1e=Ke.createContext(null);R1e.displayName="EmbeddedCheckoutProviderContext";var D1e=function(){var e=zS("calls useStripe()"),r=e.stripe;return r};rl("auBankAccount",nl);rl("card",nl);rl("cardNumber",nl);rl("cardExpiry",nl);rl("cardCvc",nl);rl("iban",nl);var B1e=rl("payment",nl);rl("expressCheckout",nl);rl("paymentRequestButton",nl);rl("linkAuthentication",nl);rl("address",nl);rl("shippingAddress",nl);rl("paymentMethodMessaging",nl);rl("taxId",nl);const $1e=y1e("pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W"),F1e=({amount:t,onCancel:e,onSuccess:r})=>{const n=D1e(),i=M1e(),[a,o]=b.useState(null),[l,c]=b.useState(!1),[u,f]=b.useState(!1),p="pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W".startsWith("pk_live")&&window.location.protocol==="http:",x=async m=>{if(m.preventDefault(),!n||!i)return;c(!0);const{error:y}=await n.confirmPayment({elements:i,confirmParams:{return_url:window.location.origin+"/dashboard?donation=success"},redirect:"if_required"});y?(o(y.message),c(!1)):r()};return s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[p?s.jsxs("div",{className:"bg-amber-900/30 border border-amber-500/50 p-6 rounded-xl text-center space-y-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsx("h3",{className:"font-bold text-amber-200",children:"HTTPS Required"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Live Stripe payments require a secure (HTTPS) connection. Please use ",s.jsx("strong",{children:"test keys"})," for local development or deploy to a secure server."]})]}):s.jsxs("div",{className:"relative min-h-[100px]",children:[!u&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 rounded-xl border border-gray-700 animate-pulse text-gray-500 text-sm",children:"Loading Secure Form..."}),s.jsx(B1e,{onReady:()=>f(!0),onLoadError:m=>o(m.error?.message||"Failed to load payment form."),className:"bg-gray-900 p-4 rounded-xl border border-gray-700"})]}),a&&s.jsx("div",{className:"text-red-500 text-sm mt-2 p-3 bg-red-950/30 border border-red-500/30 rounded-lg",children:a}),s.jsxs("div",{className:"flex gap-4 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-xl font-bold transition-all",children:"Change Amount"}),s.jsx("button",{disabled:l||!n,className:"flex-1 px-4 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/25 disabled:opacity-50",children:l?"Processing...":`Donate $${t}`})]})]})},U1e=({isOpen:t,onClose:e})=>{const[r,n]=b.useState("amount"),[i,a]=b.useState(10),[o,l]=b.useState(""),[c,u]=b.useState(!1),[f,p]=b.useState("stripe");b.useEffect(()=>{t||(n("amount"),l(""),u(!1))},[t]);const x=async m=>{a(m),u(!0);try{const y=await Ze.post("/api/payments/create-intent",{amount:m});l(y.clientSecret),n("payment")}catch(y){alert("Error creating payment: "+y.message)}finally{u(!1)}};return t?s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 w-full max-w-lg rounded-3xl flex flex-col max-h-[calc(100vh-4rem)] shadow-2xl animate-fade-in-up overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950/50 flex-shrink-0",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-pink-500 text-2xl",children:""})," Support MTG-Forge"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-grow",children:[r==="amount"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-400 mb-6",children:"Your support helps us keep the servers running and the AI Architect dreaming of new decks."}),s.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[5,10,20].map(m=>s.jsxs("button",{onClick:()=>a(m),className:`py-4 rounded-xl border font-bold transition-all ${i===m?"bg-indigo-600 border-indigo-400 text-white shadow-lg shadow-indigo-500/20 scale-105":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:["$",m]},m))}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),s.jsx("input",{type:"number",value:i,onChange:m=>a(parseFloat(m.target.value)||""),className:"w-full bg-gray-800 border border-gray-700 rounded-xl py-3 pl-8 pr-4 text-white font-bold focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Other amount"})]})]}),s.jsx("button",{onClick:()=>x(i),disabled:c||!i||i<1,className:"w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-indigo-500/30 transition-all transform hover:-translate-y-1 disabled:opacity-50",children:c?"Loading...":"Continue to Payment"})]}),r==="payment"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("div",{className:"flex bg-gray-950 p-1 rounded-xl mb-4",children:["stripe","google","paypal"].map(m=>s.jsx("button",{onClick:()=>p(m),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${f===m?"bg-gray-800 text-white shadow-sm":"text-gray-500 hover:text-gray-400"}`,children:m==="stripe"?"Card":m==="google"?"Google Pay":"PayPal"},m))}),f==="stripe"&&o&&s.jsx(EH,{stripe:$1e,options:{clientSecret:o,appearance:{theme:"night"}},children:s.jsx(F1e,{amount:i,onCancel:()=>n("amount"),onSuccess:()=>n("success")})}),(f==="google"||f==="paypal")&&s.jsxs("div",{className:"text-center py-12 space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-800 rounded-full flex items-center justify-center text-2xl",children:f==="google"?"":""}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-gray-300 capitalize",children:[f," Pay Integration"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Coming incredibly soon! Please use Card for now."})]}),s.jsx("button",{onClick:()=>p("stripe"),className:"text-indigo-400 text-sm hover:underline font-bold",children:"Back to Card Payment"})]})]}),r==="success"&&s.jsxs("div",{className:"text-center space-y-8 animate-fade-in py-8",children:[s.jsxs("div",{className:"w-24 h-24 mx-auto relative",children:[s.jsx("div",{className:"absolute inset-0 bg-pink-500 rounded-full animate-ping opacity-20"}),s.jsx("div",{className:"relative bg-gradient-to-br from-pink-500 to-rose-600 w-24 h-24 rounded-full flex items-center justify-center text-4xl shadow-lg ring-4 ring-pink-500/20",children:""})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-4xl font-black text-white tracking-tight",children:"YOU ARE ABSOLUTELY INCREDIBLE!"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-gray-300 text-lg",children:["From the bottom of our digital hearts, ",s.jsx("span",{className:"text-pink-400 font-bold",children:"THANK YOU!"})]}),s.jsx("p",{className:"text-gray-400 leading-relaxed max-w-xs mx-auto text-sm italic",children:`"Your generosity fuels the spark of creativity. You're not just a donor; you're a patron of the Multiverse."`})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black tracking-[0.2em]",children:"Honorary Title Acquired"}),s.jsx("div",{className:"bg-indigo-500/10 border border-indigo-500/30 py-2 px-4 rounded-full inline-block mx-auto text-indigo-300 font-bold text-sm",children:"Guardian of the Forge"})]}),s.jsx("button",{onClick:e,className:"w-full py-4 bg-gray-800 hover:bg-gray-700 text-white rounded-xl font-bold transition-all border border-gray-700 mt-4",children:"Continue Forging"})]})]}),r!=="success"&&s.jsx("div",{className:"bg-gray-950/80 p-4 border-t border-gray-800 text-center flex-shrink-0",children:s.jsxs("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Payments by Stripe"]})})]})]}):null},Ox={stats_value:"xs",stats_total:"xs",stats_decks:"xs",audit:"xs",action_browse:"xs",action_wishlist:"xs",identity:"small",quick_actions:"small",community:"medium",action_new_deck:"xs",action_add_cards:"xs",action_tournaments:"xs",system_status:"small",subscription:"small",social_stats:"small",trade_matches:"small",tips:"small",guides:"small",recent_decks:"large",releases:"large"},qS={grid:["stats_value","stats_total","stats_decks","audit","quick_actions","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_browse","action_wishlist","action_tournaments","system_status","subscription","social_stats","trade_matches","tips","guides"]},TN={Default:{layout:qS,sizes:Ox},"Decks Focused":{layout:{grid:["action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","identity","recent_decks","community","releases","stats_value","stats_total","audit","action_browse","action_wishlist","system_status","subscription","social_stats","tips","guides"]},sizes:{...Ox,action_new_deck:"small",action_add_cards:"small",action_tournaments:"small",recent_decks:"xlarge",community:"large"}},Collector:{layout:{grid:["stats_value","stats_total","audit","action_browse","action_wishlist","identity","recent_decks","releases","community","action_new_deck","action_add_cards","action_tournaments","stats_decks","quick_actions","system_status","subscription","social_stats","tips","guides"]},sizes:{...Ox,stats_value:"small",stats_total:"small",audit:"medium",action_browse:"small",action_wishlist:"small",recent_decks:"medium",releases:"xlarge"}}},z1e=({id:t,widgetKey:e,editMode:r,data:n,actions:i,containerId:a,size:o,onResize:l,onRemove:c})=>{const{attributes:u,listeners:f,setNodeRef:p,transform:x,transition:m,isDragging:y}=rde({id:t}),[v,j]=b.useState(null),N=t==="system_status"||t==="releases",L=a==="grid"?{xs:"col-span-2 row-span-1",small:"col-span-4 row-span-2",medium:"col-span-4 row-span-4",large:"col-span-6 row-span-6",xlarge:"col-span-8 row-span-6"}[o||"small"]||"md:col-span-3 md:row-span-2":{xs:"max-w-[150px] mx-auto lg:mx-0",small:"max-w-[300px] mx-auto lg:mx-0",medium:"max-w-md mx-auto lg:mx-0",large:"w-full",xlarge:"w-full"}[o||"small"],O={transform:sf.Transform.toString(x),transition:v?"none":m,zIndex:y||v?100:"auto",opacity:y?.3:1,width:v?`${v.w}px`:void 0,height:v?`${v.h}px`:void 0},T=(Vx[e]||Vx[t])?.component,I=$=>{$.stopPropagation(),l(t)},B=$=>{$.stopPropagation(),$.preventDefault();const k=$.clientX,R=$.clientY,P=o||"small",q=$.currentTarget.closest(".relative").getBoundingClientRect(),X=q.width,G=q.height;j({w:X,h:G});const ne=se=>{const J=se.clientX,W=se.clientY,U=J-k,Y=W-R;j({w:Math.max(150,X+U),h:Math.max(100,G+Y)})},ee=se=>{document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",ee);const J=se.clientX,W=se.clientY,U=(J-k)/100,Y=(W-R)/50,te=pe=>pe==="xs"?[2,1]:pe==="small"?[4,2]:pe==="medium"?[4,4]:pe==="large"?[6,6]:pe==="xlarge"?[8,6]:[4,2],[ce,xe]=te(P);let ue=ce+(U>.4||U<-.4?Math.round(U):0),ve=xe+(Y>.4||Y<-.4?Math.round(Y):0),Q=P;ve>=5?ue>=7?Q="xlarge":Q="large":ve>=2.5?ue>=4?Q="medium":Q="small":ve>=1.5?Q="small":Q="xs",j(null),Q!==P&&l(t,Q)};document.addEventListener("mousemove",ne),document.addEventListener("mouseup",ee)};return T?s.jsxs("div",{ref:p,style:O,className:`relative h-full ${!y&&!v?"transition-all duration-300":""} ${L}`,children:[r&&s.jsxs("div",{className:`absolute z-50 flex gap-1 origin-top-right transition-all ${o==="xs"?"-top-2 -right-2 scale-[0.7]":"-top-3 -right-3"}`,children:[!N&&s.jsx("div",{onMouseDown:$=>{$.stopPropagation(),c(t)},className:`bg-red-600 rounded-full cursor-pointer hover:bg-red-500 border border-red-400 text-white shadow-lg flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Remove Widget",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{onMouseDown:I,className:`bg-gray-700 cursor-ew-resize rounded-full hover:bg-gray-600 border border-gray-500 text-white shadow-lg font-bold flex items-center justify-center transition-transform hover:scale-110 ${o==="xs"?"w-5 h-5 text-[9px] p-0.5":"w-6 h-6 text-[10px] p-1.5"}`,title:"Drag horizontal to resize",children:o==="xs"?"XS":o==="xlarge"?"XL":o==="large"?"L":o==="medium"?"M":"S"}),s.jsx("div",{...u,...f,className:`bg-indigo-600 rounded-full cursor-grab active:cursor-grabbing hover:bg-indigo-500 border border-indigo-400 text-white shadow-lg transition-transform hover:scale-110 ${o==="xs"?"p-1":"p-1.5"}`,title:"Drag to Move",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"})})})]}),s.jsx("div",{className:`h-full overflow-hidden rounded-3xl ${r?"ring-2 ring-indigo-500/30 pointer-events-none":""}`,children:s.jsx(T,{data:n,actions:i,size:o})}),r&&s.jsxs("div",{onMouseDown:B,className:"absolute bottom-1 right-1 w-10 h-10 cursor-nwse-resize z-50 flex items-end justify-end p-1 group/resize hover:scale-110 transition-transform pointer-events-auto",title:"Drag corner to resize",children:[s.jsx("div",{className:"w-5 h-5 border-r-4 border-b-4 border-indigo-500/50 rounded-br-lg group-hover/resize:border-indigo-400"}),s.jsx("div",{className:"absolute inset-0 flex items-end justify-end p-2 opacity-50 group-hover/resize:opacity-100",children:s.jsxs("svg",{className:"w-3 h-3 text-indigo-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[s.jsx("line",{x1:"21",y1:"15",x2:"15",y2:"21"}),s.jsx("line",{x1:"21",y1:"9",x2:"9",y2:"21"})]})})]})]}):null},q1e=()=>{const{currentUser:t,userProfile:e,updateSettings:r}=Sr(),{addToast:n}=wn(),{cards:i,refresh:a}=To(),{decks:o,loading:l}=hf(),[c,u]=b.useState(!1),[f,p]=b.useState(!1),[x,m]=b.useState(!1),[y,v]=b.useState(!1),[j,N]=b.useState(!1),[C,A]=b.useState(!1),[L,O]=b.useState(!1),[F,T]=b.useState(!1),[I,B]=b.useState(qS),[$,k]=b.useState({}),[R,P]=b.useState(null),[q,X]=b.useState({}),G=we=>we?.grid&&Array.isArray(we.grid)?we:we?.top||we?.main||we?.sidebar?{grid:[...we.top||[],...we.main||[],...we.sidebar||[]]}:qS;b.useEffect(()=>{if(!(!e||L)){if(e.settings?.dashboard_layout){const we=e.settings.dashboard_layout,Te=G(we);B(oe=>JSON.stringify(oe)===JSON.stringify(Te)?oe:Te)}if(e.settings?.dashboard_sizes){const we=e.settings.dashboard_sizes;k(Te=>JSON.stringify(Te)===JSON.stringify(we)?Te:we)}else k(we=>JSON.stringify(we)===JSON.stringify(Ox)?we:Ox);if(e.settings?.saved_layouts){const we=e.settings.saved_layouts;X(Te=>JSON.stringify(Te)===JSON.stringify(we)?Te:we)}}},[e,L]);const ne=async()=>{A(!0);try{await Ze.post("/api/sync/prices"),await a()}catch(we){console.error("Sync failed",we)}finally{A(!1)}},ee=async()=>{const we=window.prompt("Name this layout:");if(!we)return;const Te={...q,[we]:{layout:I,widgetSizes:$}};X(Te);try{await r({saved_layouts:Te}),n(`Layout "${we}" saved!`,"success")}catch{n("Failed to save layout","error")}},se=we=>{if(TN[we]){const{layout:Te,sizes:oe}=TN[we];B(G(Te)),oe&&k(oe),n(`Loaded preset: ${we}`,"success")}else if(q[we]){const Te=q[we].layout;B(G(Te)),k(q[we].widgetSizes||{}),n(`Loaded layout: ${we}`,"success")}},J=()=>{const we=btoa(JSON.stringify({l:I,s:$}));navigator.clipboard.writeText(we),n("Layout code copied to clipboard!","success")},W=()=>{const we=window.prompt("Paste layout code:");if(we)try{const Te=JSON.parse(atob(we));Te.l?(B(Te.l),k(Te.s||{}),n("Layout imported successfully!","success")):n("Invalid layout code","error")}catch{n("Invalid layout code","error")}},U=b.useMemo(()=>{if(!i||!o)return{totalCards:0,uniqueDecks:0,value:0,topColor:null};const we=new Set(i.map(Ae=>Ae.scryfall_id||Ae.id)),Te=i.filter(Ae=>!Ae.is_wishlist),oe=i.filter(Ae=>Ae.is_wishlist);let De=Te.reduce((Ae,Pe)=>Ae+(Pe.count||1),0),Nt=oe.reduce((Ae,Pe)=>Ae+(Pe.count||1),0),ot=De;o.forEach(Ae=>{if(Ae.commander){const Pe=Ae.commander.id||Ae.commander.scryfall_id;Pe&&!we.has(Pe)&&(De++,we.add(Pe))}if(Ae.commander_partner){const Pe=Ae.commander_partner.id||Ae.commander_partner.scryfall_id;Pe&&!we.has(Pe)&&(De++,we.add(Pe))}});const Ne=i.reduce((Ae,Pe)=>{const ct=parseFloat(Pe.prices?.usd||0);return Ae+ct*(Pe.count||1)},0),Ge={};i.forEach(Ae=>{const Pe=Ae.color_identity||[],ct={W:0,U:1,B:2,R:3,G:4},bt=Pe.filter(Ve=>ct[Ve]!==void 0).sort((Ve,lt)=>ct[Ve]-ct[lt]).join(""),dt=bt.length===0?"C":bt;Ge[dt]=(Ge[dt]||0)+(Ae.count||1)});const Xe=Object.entries(Ge);let xt=d2("C");if(Xe.length>0){const[Ae]=Xe.reduce((Pe,ct)=>ct[1]>Pe[1]?ct:Pe);xt=d2(Ae)}return{totalCards:De,collectionCount:ot,wishlistCount:Nt,uniqueDecks:o.length,value:Ne.toLocaleString("en-US",{style:"currency",currency:"USD"}),topColor:xt}},[i,o]),Y=CU(s2(K6),s2(V6,{coordinateGetter:ide})),te=we=>P(we.active.id),ce=we=>{const{active:Te,over:oe}=we;if(!oe||Te.id===oe.id)return;if(Te.data?.current?.fromLibrary)B(Nt=>({...Nt,grid:[...Nt.grid||[],Te.id]}));else{const Nt=I.grid.indexOf(Te.id),ot=I.grid.indexOf(oe.id);Nt!==-1&&ot!==-1&&Nt!==ot&&B(Ne=>({...Ne,grid:J6(Ne.grid,Nt,ot)}))}},xe=we=>{P(null)},ue=(we,Te)=>{k(oe=>{if(Te)return{...oe,[we]:Te};const De=oe[we]||"small",Nt=De==="xs"?"small":De==="small"?"medium":De==="medium"?"large":De==="large"?"xlarge":"xs";return{...oe,[we]:Nt}})},ve=we=>{B(Te=>({...Te,grid:Te.grid.filter(oe=>oe!==we)})),n("Widget removed from dashboard","success")},Q=async we=>{if(e?.id)try{await r({dashboard_layout:we,dashboard_sizes:$}),n("Layout saved","success")}catch(Te){console.error(Te),n("Failed to save layout","error")}},pe=()=>{L?(Q(I),T(!1)):T(!0),O(!L)},Ce=b.useMemo(()=>({stats:U,decks:o,decksLoading:l,collection:i,userProfile:e,syncLoading:C}),[U,o,l,i,e,C]),je=b.useMemo(()=>({handleSyncPrices:ne,setIsIssueModalOpen:u,setIsDonationModalOpen:N,setShowBinderGuide:p,setShowPodGuide:m,setShowAuditGuide:v}),[ne]);return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/30 rounded-xl p-4 flex items-start gap-3 backdrop-blur-md",children:[s.jsx("span",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-indigo-400 text-sm",children:"Looking for Default Layout suggestions!"}),s.jsx("p",{className:"text-xs text-gray-300 mt-1 leading-relaxed",children:"Layouts are awkward atm to promote suggestions. When editing, click the share icon up at the top and send me your suggestion with a description of what it is."})]})]}),s.jsxs("div",{className:`flex flex-col md:flex-row gap-4 ${L?"justify-center items-center":"justify-between items-end"}`,children:[s.jsxs("div",{className:`text-center md:text-left ${L?"opacity-50 scale-90 transition-all":""}`,children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"Dashboard"}),s.jsxs("p",{className:"text-gray-400",children:["Welcome back, ",s.jsx("span",{className:"text-indigo-400 font-bold",children:t?t.displayName||t.email:"Guest"}),"."]})]}),s.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-2 rounded-xl backdrop-blur-md border border-white/5",children:[L&&s.jsxs("div",{className:"flex items-center gap-2 mr-2 border-r border-white/10 pr-4",children:[s.jsxs("div",{className:"flex gap-1 mr-2",children:[s.jsx("button",{onClick:ee,className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-white",title:"Save Layout As...",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})}),s.jsx("button",{onClick:J,className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-white",title:"Share Layout (Copy)",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),s.jsx("button",{onClick:W,className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-white",title:"Import Layout",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),s.jsx("button",{onClick:()=>T(!F),className:"p-1.5 hover:bg-indigo-600/20 rounded text-indigo-400 hover:text-indigo-300 border border-indigo-500/30",title:"Forge Library",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]}),s.jsxs("select",{className:"bg-gray-800 text-white text-xs rounded-lg border border-gray-700 p-1.5 focus:ring-2 focus:ring-indigo-500 outline-none max-w-[120px]",onChange:we=>se(we.target.value),defaultValue:"",children:[s.jsx("option",{value:"",disabled:!0,children:"Load Layout..."}),s.jsx("optgroup",{label:"Presets",children:Object.keys(TN).map(we=>s.jsx("option",{value:we,children:we},we))}),Object.keys(q).length>0&&s.jsx("optgroup",{label:"My Layouts",children:Object.keys(q).map(we=>s.jsx("option",{value:we,children:we},`saved_${we}`))})]})]}),s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${L?"text-indigo-400":"text-gray-500"}`,children:L?"Done":"Customize"}),s.jsx(yfe,{checked:L,onChange:pe,className:`${L?"bg-indigo-600":"bg-gray-700"} relative inline-flex h-6 w-11 items-center rounded-full transition-colors`,children:s.jsx("span",{className:`${L?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]})]}),s.jsxs(VU,{sensors:Y,collisionDetection:EU,onDragStart:te,onDragOver:ce,onDragEnd:xe,children:[s.jsx(npe,{layout:I,isOpen:F&&L,onClose:()=>T(!1),onAddWidget:we=>{B(Te=>({...Te,grid:[...Te.grid||[],we]}))},onClearDashboard:()=>{B({grid:[]})}}),s.jsx(Kce,{items:I.grid||[],strategy:Z6,id:"grid",children:s.jsxs("div",{className:`grid grid-cols-12 auto-rows-[50px] gap-3 relative min-h-[600px] ${L?"dashboard-grid-visual":""}`,children:[L&&s.jsx("div",{className:"absolute -top-6 left-0 right-0 grid grid-cols-12 gap-3 pointer-events-none z-0",children:Array.from({length:12}).map((we,Te)=>s.jsxs("div",{className:"text-center text-[9px] font-black text-indigo-500/50 uppercase tracking-wider",children:["Col ",Te+1]},Te))}),(I.grid||[]).map(we=>s.jsx(z1e,{id:we,widgetKey:we,editMode:L,data:Ce,actions:je,containerId:"grid",size:$[we]||"small",onResize:ue,onRemove:ve},we))]})}),s.jsx(ZU,{dropAnimation:{sideEffects:JU({styles:{active:{opacity:"0.5"}}})},children:R?(()=>{const we=Vx[R],Te=we?.component,oe=$[R]||"small",De={xs:"w-[400px] h-[50px]",small:"w-[400px] h-[200px]",medium:"w-[600px] h-[200px]",large:"w-[800px] h-[400px]",xlarge:"w-full max-w-7xl h-[400px]"}[oe]||"w-[400px] h-[200px]";return s.jsx("div",{className:`${De} overflow-hidden rounded-3xl shadow-2xl ring-2 ring-indigo-500/50 cursor-grabbing bg-gray-900 z-50`,children:Te?s.jsx("div",{className:"h-full pointer-events-none p-1",children:s.jsx(Te,{data:Ce,actions:je,size:oe})}):s.jsx("div",{className:"h-full flex items-center justify-center p-4 bg-gray-800 text-white font-bold border border-gray-700 rounded-3xl",children:we?.title||"Widget"})})})():null})]})]}),s.jsx(o1e,{isOpen:c,onClose:()=>u(!1)}),s.jsx(U1e,{isOpen:j,onClose:()=>N(!1)}),s.jsx(z6,{isOpen:f,onClose:()=>p(!1)}),s.jsx(hU,{isOpen:x,onClose:()=>m(!1)}),s.jsx(q6,{isOpen:y,onClose:()=>v(!1)})]})},LH=[{name:"Limits",items:[{label:"Collection size",type:"limit",key:"collection"},{label:"Wishlist size",type:"limit",key:"wishlist"},{label:"Deck count",type:"limit",key:"decks"},{label:"Pod Count",type:"limit",key:"pods"}]},{name:"Collection",items:[{label:"Organization customization",type:"static",value:!0},{label:"Tags",type:"static",value:!0},{label:"Bulk Import",type:"static",value:!0},{label:"Manual Price Sync",type:"static",value:!0},{label:"Smart Binders",type:"feature",key:"smartBinders"},{label:"Binders",type:"feature",key:"binders"},{label:"Collection Audit",type:"feature",key:"collectionAudit"},{label:"Snap Version (Scanner)",type:"feature",key:"snapScan"},{label:"Quick Scan (Batch)",type:"feature",key:"batchScan"}]},{name:"Wishlist",items:[{label:"Mass Deletion",type:"static",value:!0},{label:"Precon Addition",type:"static",value:!0}]},{name:"Decks",items:[{label:"Public/Private View",type:"static",value:!0},{label:"Deck Stats",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0},{label:"Mockup Deck",type:"feature",key:"mockupDeck"},{label:"AI Strategy",type:"feature",key:"aiStrategy"},{label:"Deck Doctor",type:"feature",key:"deckDoctor"},{label:"Deck Suggestions",type:"feature",key:"deckSuggestions"},{label:"Deck Audit",type:"feature",key:"deckAudit"},{label:"Shared edit",type:"feature",key:"sharedEdit"}]},{name:"Precons",items:[{label:"Add to collection",type:"static",value:!0},{label:"Add to wishlist",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0}]},{name:"Sets",items:[{label:"Quick Add",type:"static",value:!0},{label:"Set Audit",type:"feature",key:"setAudit"}]},{name:"AI",items:[{label:"Chatbot",type:"static",value:!0},{label:"Default Oracle",type:"static",value:!0},{label:"Custom AI Persona",type:"feature",key:"customAiPersona"}]},{name:"Settings",items:[{label:"Collection Backup",type:"feature",key:"collectionBackup"},{label:"Deck Backup",type:"feature",key:"deckBackup"},{label:"Pods / Linking",type:"limit_check",key:"pods"}]}],H1e=(t,e)=>{const r=Cs[t],n=e?Cs[e]:null;if(!n)return t===Jt.FREE?{limits:[{label:`Collection: ${r.limits.collection}`,type:"limit"},{label:`Wishlist: ${r.limits.wishlist}`,type:"limit"},{label:`Decks: ${r.limits.decks}`,type:"limit"},{label:"Pods (Shared Accounts): 0",type:"limit"}],features:[{label:"AI Chatbot",type:"feature"}]}:{limits:[],features:[]};const i=[],a=[];r.limits.collection>n.limits.collection&&i.push({label:`Collection: ${r.limits.collection===1/0?"Unlimited":r.limits.collection}`,type:"limit"}),r.limits.wishlist>n.limits.wishlist&&i.push({label:`Wishlist: ${r.limits.wishlist===1/0?"Unlimited":r.limits.wishlist}`,type:"limit"}),r.limits.decks>n.limits.decks&&i.push({label:`Decks: ${r.limits.decks===1/0?"Unlimited":r.limits.decks}`,type:"limit"});const o=t===Jt.TIER_3,l=[Jt.TIER_1,Jt.TIER_2].includes(t);return(r.limits.pods>n.limits.pods||l)&&i.push({label:`Pods (Shared Accounts): ${r.limits.pods===1/0?"Unlimited":r.limits.pods}`,type:"limit",bold:o,tooltip:"Pods allow you to link accounts (friends/family) to share your collection and deck building tools."}),Object.keys(r.features).forEach(c=>{if(r.features[c]&&!n.features[c]){const u=LH.flatMap(f=>f.items).find(f=>f.key===c);a.push({label:u?u.label:c.replace(/([A-Z])/g," $1").trim(),type:"feature"})}}),{limits:i,features:a}},KM=({label:t,check:e,highlight:r,bold:n,tooltip:i})=>s.jsxs("div",{className:`flex items-start text-sm ${e?r?"text-white font-medium":"text-gray-300":"text-gray-500"} ${n?"font-bold":""}`,title:i,children:[e?s.jsx(vd,{className:`w-4 h-4 mr-2 mt-0.5 flex-shrink-0 ${r?"text-purple-400":"text-green-500"}`}):s.jsx(Sd,{className:"w-4 h-4 mr-2 text-red-900/50 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:t})]}),OC=({billingInterval:t,setBillingInterval:e,onSubscribe:r,isLoading:n,currentTier:i,showIntervalSelector:a=!0})=>{const o=Object.values(Jt),l=c=>{const u=Cs[c];return!u.prices.monthly&&!u.prices.biannual&&!u.prices.yearly?"Free":{[Jt.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[Jt.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[Jt.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[Jt.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[Jt.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[c]?.[t]||"Free"};return s.jsxs("div",{className:"w-full",children:[a&&s.jsx("div",{className:"flex justify-center mb-8",children:s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(c=>s.jsx("button",{onClick:()=>e(c),className:`px-4 py-2 rounded-lg transition-all capitalize ${t===c?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:c==="biannual"?"6 Months":c},c))})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:o.map((c,u)=>{const f=Cs[c],p=i===c,x=u>0?o[u-1]:null,{limits:m,features:y}=H1e(c,x);return s.jsxs("div",{className:`relative flex flex-col p-5 rounded-2xl border ${p?"border-purple-500 shadow-[0_0_20px_rgba(168,85,247,0.3)]":"border-gray-700"} bg-gray-800/50 backdrop-blur-sm hover:border-purple-500/50 transition-all duration-300`,children:[p&&s.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-white text-[10px] px-2 py-0.5 rounded-full uppercase tracking-wider font-bold shadow-lg z-10",children:"Current"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-100",children:f.name}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-2xl font-bold text-white",children:l(c)}),s.jsxs("span",{className:"text-sm text-gray-500",children:["/",t==="monthly"?"mo":t==="biannual"?"6mo":"yr"]})]}),s.jsx("p",{className:"text-sm text-gray-400 mt-2 min-h-[48px]",children:f.description})]}),s.jsx("button",{onClick:()=>r(c),disabled:n||p,className:`w-full py-2 rounded-lg font-bold text-sm mb-6 transition-all ${p?"bg-gray-700 cursor-default text-gray-400":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white shadow-lg"}`,children:n?"...":p?"Active":c===Jt.FREE?"Select":"Subscribe"}),s.jsxs("div",{className:"space-y-3 flex-grow",children:[(m.length>0||y.length>0)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] uppercase tracking-wider text-purple-400 font-bold mb-2 border-b border-purple-500/30 pb-1",children:c===Jt.FREE?"Includes:":"Adds / Increases:"}),m.map((v,j)=>s.jsx(KM,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`limit-${j}`)),m.length>0&&y.length>0&&s.jsx("div",{className:"my-3 border-t border-gray-700"}),y.map((v,j)=>s.jsx(KM,{label:v.label,check:!0,highlight:!0,bold:v.bold,tooltip:v.tooltip},`feat-${j}`))]}),m.length===0&&y.length===0&&c!==Jt.FREE&&s.jsx("p",{className:"text-xs text-gray-500 italic",children:"Includes all previous features"})]})]},c)})})]})},W1e=()=>{const{currentUser:t,userProfile:e}=Sr(),r=dn(),{addToast:n}=wn(),[i,a]=b.useState("monthly"),[o,l]=b.useState(!1),[c,u]=b.useState("cards"),[f,p]=b.useState(null),[x,m]=b.useState(null),y=async A=>{if(!t){r("/login");return}if(A===Jt.FREE){n("You are already on the free tier.","info");return}l(!0);try{const L=await Ze.post("/api/payments/create-checkout-session",{tierId:A,interval:i});L.url&&(window.location.href=L.url)}catch(L){console.error("Subscription error:",L),n("Failed to start checkout. Please try again.","error")}finally{l(!1)}},v=A=>{const L=Cs[A];return!L.prices.monthly&&!L.prices.biannual&&!L.prices.yearly?"Free":{[Jt.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[Jt.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[Jt.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[Jt.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[Jt.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[A]?.[i]||"Free"},j=()=>i==="biannual"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"1 Month Free"}):i==="yearly"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"2 Months Free"}):null,N=(A,L)=>{const O=Cs[L];if(A.type==="static")return s.jsx(vd,{className:"w-5 h-5 text-green-500 mx-auto"});if(A.type==="limit"){const F=O.limits[A.key];return F===1/0?"Unlimited":F}if(A.type==="limit_check"){const F=O.limits[A.key];return F>0||F===1/0?s.jsx(vd,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Sd,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"})}return A.type==="feature"?O.features[A.key]?s.jsx(vd,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Sd,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"}):"-"},C=Object.values(Jt);return s.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8",children:[s.jsxs("div",{className:"max-w-[1800px] mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto mb-8",children:"Comparing plans to find the perfect fit for your magic journey."}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6",children:[s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(A=>s.jsx("button",{onClick:()=>a(A),className:`px-4 py-2 rounded-lg transition-all capitalize ${i===A?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:A==="biannual"?"6 Months":A},A))}),s.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:[s.jsxs("button",{onClick:()=>u("cards"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="cards"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(rae,{className:"w-4 h-4"})," Cards"]}),s.jsxs("button",{onClick:()=>u("table"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${c==="table"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(lae,{className:"w-4 h-4"})," Compare All"]})]})]}),s.jsx("div",{className:"mt-4 h-8",children:j()})]}),c==="cards"?s.jsx(OC,{billingInterval:i,setBillingInterval:a,onSubscribe:y,isLoading:o,currentTier:e?.subscription_tier}):s.jsx("div",{className:"overflow-x-auto pb-12 pt-12 animate-in fade-in duration-300",children:s.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-4 w-[250px] sticky left-0 z-20 bg-gray-900 border-b border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]",children:s.jsx("div",{className:"text-xl font-bold text-gray-500",children:"Features"})}),C.map((A,L)=>{const O=Cs[A],F=e?.subscription_tier===A,T=x===L;return s.jsxs("th",{className:`p-4 min-w-[180px] text-center relative transition-colors duration-300 border-b border-gray-800
                                                ${T?"bg-gray-800/80":"bg-gray-900"}
                                                ${F?"ring-2 ring-purple-500 ring-inset bg-purple-900/10":""}
                                            `,onMouseEnter:()=>m(L),onMouseLeave:()=>m(null),children:[F&&s.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Current"}),s.jsx("h3",{className:`text-xl font-bold mb-1 ${F?"text-purple-300":"text-gray-200"}`,children:O.name}),s.jsxs("div",{className:"text-2xl font-bold mb-2",children:[v(A),s.jsxs("span",{className:"text-xs text-gray-500 font-normal",children:["/",i==="monthly"?"mo":i==="biannual"?"6mo":"yr"]})]}),s.jsx("button",{onClick:()=>y(A),disabled:o||F,className:`w-full py-2 rounded text-sm font-bold transition-all ${F?"bg-gray-800 text-gray-500 cursor-default":"bg-purple-600 hover:bg-purple-500 text-white shadow-lg shadow-purple-900/20"}`,children:F?"Active":A===Jt.FREE?"Default":"Subscribe"})]},A)})]})}),s.jsx("tbody",{children:LH.map((A,L)=>s.jsx(Ke.Fragment,{children:A.items.map((O,F)=>{const T=`${L}-${F}`,I=f===T;return s.jsxs("tr",{className:`transition-colors duration-200 border-b border-gray-800/50
                                                    ${I?"bg-gray-800/60":"hover:bg-gray-800/30"}
                                                `,onMouseEnter:()=>p(T),onMouseLeave:()=>p(null),children:[s.jsx("td",{className:`p-3 pl-4 text-sm font-medium text-gray-300 sticky left-0 z-10
                                                    bg-gray-900 transition-colors duration-200 border-r border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]
                                                    ${I?"text-white bg-gray-800":""}
                                                `,children:A.name==="Limits"||A.name==="Settings"||A.name==="AI"?O.label:`${A.name} - ${O.label}`}),C.map((B,$)=>{const k=x===$,R=I&&k;return s.jsx("td",{className:`p-3 text-center text-sm transition-colors duration-200
                                                                ${k?"bg-gray-800/40":""}
                                                                ${R?"bg-purple-500/10":""}
                                                            `,onMouseEnter:()=>m($),onMouseLeave:()=>m(null),children:N(O,B)},B)})]},O.label)})},A.name))})]})})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"* Prices and limits subject to change. VAT may apply."})})]})},G1e=()=>{const[t,e]=b.useState(!0),[r,n]=b.useState(""),[i,a]=b.useState(""),[o,l]=b.useState(""),[c,u]=b.useState(""),[f,p]=b.useState(""),[x,m]=b.useState(""),[y,v]=b.useState(!1),[j,N]=b.useState(!1),[C,A]=b.useState(""),{login:L,signup:O,loginWithGoogle:F,resetPassword:T}=Sr(),I=dn(),B=async k=>{k.preventDefault();try{if(A(""),y){await T(r),N(!0);return}if(t)await L(r,i),I("/dashboard");else{if(i!==o)return A("Passwords do not match");if(i.length<6)return A("Password must be at least 6 characters");await O(r,i,{username:c,first_name:f,last_name:x}),I("/onboarding")}}catch(R){A("Failed to "+(t?"log in":"sign up")+": "+R.message)}},$=async()=>{try{A(""),await F(),I("/dashboard")}catch(k){A("Failed to log in with Google: "+k.message)}};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8 relative",children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-50"})}),s.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10 bg-black/60 p-10 rounded-2xl backdrop-blur-md border border-white/10 shadow-2xl",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:y?"Reset Password":t?"Sign in to MTG-Forge":"Create an Account"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-400",children:y?"Enter your email to receive a reset link":t?"Access your collection and decks anywhere":"Start your journey with MTG-Forge"})]}),j&&s.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-100 p-3 rounded text-sm text-center",children:"Reset link sent! Check your inbox."}),C&&s.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 p-3 rounded text-sm text-center",children:C}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:B,children:[s.jsxs("div",{className:"space-y-4",children:[!t&&!y&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"First Name",value:f,onChange:k=>p(k.target.value)})}),s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Last Name",value:x,onChange:k=>m(k.target.value)})})]}),!t&&!y&&s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Username",value:c,onChange:k=>u(k.target.value)})}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:r,onChange:k=>n(k.target.value)})]}),!y&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:t?"current-password":"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:i,onChange:k=>a(k.target.value)})]}),!t&&!y&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),s.jsx("input",{id:"confirm-password",name:"confirmConnectPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:o,onChange:k=>l(k.target.value)})]})]}),t&&!y&&s.jsx("div",{className:"flex items-center justify-end",children:s.jsx("button",{type:"button",onClick:()=>v(!0),className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot your password?"})}),s.jsx("div",{children:s.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:y?"Send Reset Link":t?"Sign in with Email":"Sign Up with Email"})})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"button",onClick:()=>{y?(v(!1),N(!1)):e(!t),A("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:y?"Back to Sign In":t?"Don't have an account? Sign Up":"Already have an account? Sign In"})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-transparent text-gray-400 uppercase font-bold bg-[#1a1c23]",children:"Or continue with"})})]}),s.jsxs("button",{onClick:$,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),s.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),s.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),s.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),t?"Sign in with Google":"Sign up with Google"]})]})]})};function OH(){const[t,e]=b.useState([]),[r,n]=b.useState(!0),{currentUser:i}=Sr(),a=async()=>{if(i){n(!0);try{const o=await Ze.getBinders();e(o)}catch(o){console.error("[useBinders] Failed to fetch",o)}finally{n(!1)}}};return b.useEffect(()=>{a()},[i]),{binders:t,loading:r,refreshBinders:a}}const MH=(t,e)=>{const[r,n]=b.useState({canUndo:!1,canRedo:!1,history:[],pointer:-1});b.useEffect(()=>{t&&ba.init(t)},[]),b.useEffect(()=>ba.subscribe(c=>{n(c),c.activeState&&e&&e(c.activeState)}),[e]);const i=b.useCallback(()=>{const l=ba.undo();l&&e(l)},[e]),a=b.useCallback(()=>{const l=ba.redo();l&&e(l)},[e]),o=b.useCallback((l,c,u=null,f=null)=>{ba.push(l,c,u,f)},[]);return b.useEffect(()=>{const l=c=>{(c.ctrlKey||c.metaKey)&&(c.key==="z"?(c.preventDefault(),c.shiftKey?ba.canRedo()&&a():ba.canUndo()&&i()):c.key==="y"&&(c.preventDefault(),ba.canRedo()&&a()))};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[i,a]),{undo:i,redo:a,recordAction:o,canUndo:r.canUndo,canRedo:r.canRedo,history:r.history,pointer:r.pointer}},LN={W:{name:"White",flavor:"A single spark of light can banish a world of shadows.",theme:"Absolute Order",pips:["W"],bg:"bg-yellow-600"},U:{name:"Blue",flavor:"The mind is the only battlefield where victory is absolute.",theme:"Infinite Inquiry",pips:["U"],bg:"bg-blue-600"},B:{name:"Black",flavor:"Power at any cost, for greatness is written in blood.",theme:"Unrestricted Power",pips:["B"],bg:"bg-gray-800"},R:{name:"Red",flavor:"Do not fear the fire; fear the heart that commands it.",theme:"Chaotic Passion",pips:["R"],bg:"bg-red-600"},G:{name:"Green",flavor:"The forest does not ask for permission to grow.",theme:"Primal Growth",pips:["G"],bg:"bg-green-600"},C:{name:"Colorless",flavor:"Existence is a fleeting dream in the eyes of the silent.",theme:"The Great Void",pips:["C"],bg:"bg-gray-500"},WU:{name:"Azorius Senate",flavor:"Justice is blind, but she has a very long reach.",theme:"Bureaucratic Control",pips:["W","U"],bg:"bg-gradient-to-br from-yellow-300 to-blue-500"},UB:{name:"House Dimir",flavor:"The finest secrets are those that kill the ones who keep them.",theme:"Subterfuge & Infiltration",pips:["U","B"],bg:"bg-gradient-to-br from-blue-600 to-black"},BR:{name:"Cult of Rakdos",flavor:"Entertain us, or become the entertainment.",theme:"Carnival of Carnage",pips:["B","R"],bg:"bg-gradient-to-br from-black to-red-600"},RG:{name:"Gruul Clans",flavor:"Not for city-dwellers. Not for the weak. Only for the wild.",theme:"Primal Destruction",pips:["R","G"],bg:"bg-gradient-to-br from-red-500 to-green-600"},WG:{name:"Selesnya Conclave",flavor:"One voice is a whisper; the Conclave is a roar.",theme:"Collective Harmony",pips:["W","G"],bg:"bg-gradient-to-br from-green-500 to-yellow-200"},WB:{name:"Orzhov Syndicate",flavor:"Even death is no excuse for a breach of contract.",theme:"Indentured Eternity",pips:["W","B"],bg:"bg-gradient-to-br from-gray-200 to-gray-900"},BG:{name:"Golgari Swarm",flavor:"Every grave is a garden if you wait long enough.",theme:"Cycles of Rot",pips:["B","G"],bg:"bg-gradient-to-br from-gray-900 to-green-600"},UG:{name:"Simic Combine",flavor:"Nature is a rough draft; we are the final edit.",theme:"Biological Evolution",pips:["U","G"],bg:"bg-gradient-to-br from-green-400 to-blue-500"},UR:{name:"Izzet League",flavor:"If it doesn't explode, you aren't trying hard enough.",theme:"Volatile Genius",pips:["U","R"],bg:"bg-gradient-to-br from-blue-500 to-red-500"},WR:{name:"Boros Legion",flavor:"First to the fight, last to the fall.",theme:"Tactical Aggression",pips:["W","R"],bg:"bg-gradient-to-br from-red-600 to-yellow-200"},WUG:{name:"Bant",flavor:"The sigil of the sun protects those who stand together.",theme:"Knightly Order",pips:["W","U","G"],bg:"bg-gradient-to-r from-green-400 via-yellow-200 to-blue-400"},WUB:{name:"Esper",flavor:"Perfection is not a goal; it is a requirement.",theme:"Obsidian Logic",pips:["W","U","B"],bg:"bg-gradient-to-r from-yellow-200 via-blue-400 to-black"},UBR:{name:"Grixis",flavor:"A wasteland of power where only the cruelest thrive.",theme:"Ruthless Tyranny",pips:["U","B","R"],bg:"bg-gradient-to-r from-blue-600 via-black to-red-600"},BRG:{name:"Jund",flavor:"In this world, you are either the dragon or the meal.",theme:"Apex Predation",pips:["B","R","G"],bg:"bg-gradient-to-r from-black via-red-600 to-green-600"},WRG:{name:"Naya",flavor:"Where the mountains wake and the earth trembles.",theme:"Primal Majesty",pips:["W","R","G"],bg:"bg-gradient-to-r from-red-500 via-green-500 to-yellow-200"},WBG:{name:"Abzan",flavor:"We do not break; we simply outlast.",theme:"Eternal Endurance",pips:["W","B","G"],bg:"bg-gradient-to-r from-yellow-100 via-black to-green-600"},WUR:{name:"Jeskai",flavor:"The wind carries the strike; the mind guides the bolt.",theme:"Disciplined Spark",pips:["W","U","R"],bg:"bg-gradient-to-r from-blue-500 via-red-500 to-yellow-100"},UBG:{name:"Sultai",flavor:"Power is measured in gold and the bones of the fallen.",theme:"Opulent Decay",pips:["U","B","G"],bg:"bg-gradient-to-r from-black via-green-600 to-blue-600"},WBR:{name:"Mardu",flavor:"Victory is the only law worth following.",theme:"Relentless Conquest",pips:["W","B","R"],bg:"bg-gradient-to-r from-red-600 via-yellow-100 to-black"},URG:{name:"Temur",flavor:"The wild does not think; it reacts with ice and fire.",theme:"Elemental Instinct",pips:["U","R","G"],bg:"bg-gradient-to-r from-green-500 via-blue-500 to-red-500"},UBRG:{name:"Glint-Eye",flavor:"Order is a cage; we have chosen to break the locks.",theme:"Chaotic Adaptation",pips:["U","B","R","G"],bg:"bg-indigo-900"},WBRG:{name:"Dune-Brood",flavor:"When the logic of the mind fails, the instinct of the swarm prevails.",theme:"Sandless Conquest",pips:["W","B","R","G"],bg:"bg-orange-900"},WURG:{name:"Ink-Treader",flavor:"To touch one is to touch the whole of the world.",theme:"Radiant Reflection",pips:["W","U","R","G"],bg:"bg-sky-900"},WUBG:{name:"Witch-Maw",flavor:"There is a hunger beneath the earth that knows no fire.",theme:"Eldritch Growth",pips:["W","U","B","G"],bg:"bg-emerald-900"},WUBR:{name:"Yore-Tiller",flavor:"The past is a weapon we sharpen for the future.",theme:"Relentless History",pips:["W","U","B","R"],bg:"bg-slate-900"},WUBRG:{name:"WUBRG",flavor:"The full spectrum of power, bound in a single hand.",theme:"The Convergence",pips:["W","U","B","R","G"],bg:"bg-gradient-to-r from-yellow-500 via-blue-500 to-green-500"}},V1e=t=>{if(!t)return LN.C;const e={W:0,U:1,B:2,R:3,G:4,C:-1};let r=Array.isArray(t)?t:t.split("");const i=[...new Set(r)].filter(a=>e[a]!==void 0&&a!=="C").sort((a,o)=>e[a]-e[o]).join("");return LN[i]||LN.C},S1=({options:t=[],selected:e=[],onChange:r,placeholder:n="Select...",label:i})=>{const[a,o]=b.useState(!1),[l,c]=b.useState(""),u=b.useRef(null);b.useEffect(()=>{const x=m=>{u.current&&!u.current.contains(m.target)&&o(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const f=t.filter(x=>x.label.toLowerCase().includes(l.toLowerCase())),p=x=>{const m=e.includes(x)?e.filter(y=>y!==x):[...e,x];r(m)};return s.jsxs("div",{className:"relative",ref:u,children:[i&&s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:i}),s.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-left text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent flex justify-between items-center",children:[s.jsx("span",{className:"truncate",children:e.length===0?n:`${e.length} selected`}),s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&s.jsxs("div",{className:"absolute z-50 mt-2 w-full bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl max-h-68 flex flex-col overflow-hidden animate-fade-in-down",children:[s.jsx("div",{className:"p-3 border-b border-white/5",children:s.jsx("input",{type:"text",placeholder:"Filter options...",className:"w-full bg-gray-950/50 border border-gray-800 rounded-xl px-3 py-2 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 placeholder-gray-600",value:l,onChange:x=>c(x.target.value),autoFocus:!0})}),s.jsx("div",{className:"overflow-y-auto flex-1 p-2 custom-scrollbar",children:f.length===0?s.jsx("div",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest p-4 text-center",children:"No results found"}):f.map(x=>s.jsxs("div",{onClick:()=>p(x.value),className:`
                                        flex items-center gap-3 px-3 py-2 rounded-xl cursor-pointer text-xs font-medium transition-all
                                        ${e.includes(x.value)?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/40":"text-gray-400 hover:bg-white/5 hover:text-white"}
                                    `,children:[s.jsx("div",{className:`w-4 h-4 rounded-md border transition-all flex items-center justify-center ${e.includes(x.value)?"bg-white border-white scale-110":"border-gray-700 bg-gray-950/50"}`,children:e.includes(x.value)&&s.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:"truncate",children:x.label})]},x.value))})]})]})},PH=()=>s.jsx("div",{className:"relative aspect-[2.5/3.5] bg-gray-800 rounded-lg overflow-hidden border border-gray-700 animate-pulse",children:s.jsx("div",{className:"absolute inset-0 bg-gray-700/50"})}),vm=b.memo(function({card:e,availableFoils:r,onRemove:n,showQuantity:i=!0,onClick:a,decks:o=[],ownerName:l,currentUser:c,showOwnerTag:u=!1,hideDeckTag:f=!1,hideOwnerTag:p=!1,selectMode:x=!1,isSelected:m=!1,onToggleSelect:y}){const[v,j]=b.useState(!1),{openCardModal:N}=Ab(),C=o?.find(k=>k.id===e.deck_id)?.name,A=l||e.owner_username||(c&&(e.owner_id===c.id||e.user_id===c.id)?c.username||"ME":null),L=k=>parseFloat(e.prices?.[k]||e.data?.prices?.[k])||0,O=(k,R=0)=>{if(!k)return"https://placehold.co/250x350?text=No+Image";const P=k.data||k;return P.card_faces&&P.card_faces.length>1&&P.card_faces[R]?.image_uris?.normal?P.card_faces[R].image_uris.normal:P.image_uris?.normal||k.image_uri||"https://placehold.co/250x350?text=No+Image"},F=e.data?.card_faces?.length>1&&e.data?.card_faces?.[1]?.image_uris||e.card_faces?.length>1&&e.card_faces?.[1]?.image_uris,T=O(e,0),I=F?O(e,1):null,B=e.countInDeck||e.quantity||e.count||1,$=k=>{if(k.stopPropagation(),x&&y){y(e.id);return}a?a(e):N(e)};return s.jsx("div",{className:`relative group perspective-1000 h-full w-full aspect-[2.5/3.5] min-h-[200px] cursor-pointer ${m?"ring-4 ring-indigo-500 rounded-xl":""}`,onClick:$,children:s.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${v?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:T,alt:e.name,className:"w-full h-full object-cover",loading:"lazy"}),i&&B>1&&s.jsxs("div",{className:"absolute top-1.5 right-1.5 bg-black/80 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-sm z-20",children:["x",B]}),!f&&C&&s.jsxs("div",{className:"absolute top-[3.75rem] left-1.5 max-w-[80%] bg-indigo-600/90 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow-lg z-20 backdrop-blur-md border border-indigo-400/50 truncate uppercase tracking-tight",title:`In deck: ${C}`,children:[" ",C]}),!p&&u&&A&&s.jsxs("div",{className:`absolute ${C?"top-[5.25rem]":"top-[3.75rem]"} left-1.5 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-20 backdrop-blur-md uppercase tracking-wider`,children:[" ",A]}),e.finish==="foil"?s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-yellow-500/80 text-yellow-100 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-300/50",children:""}):e.is_wishlist?s.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-600/90 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-orange-400/50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"WISH"]}):r?.has(e.name)&&s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-gray-700/90 text-yellow-400 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-500/30 cursor-help",title:"Foil copy available in collection",children:""}),s.jsx("div",{className:"absolute bottom-1.5 left-1.5 right-1.5 bg-black/70 backdrop-blur-md px-2 py-1 rounded border border-white/10 z-20 text-[9px] font-mono flex items-center justify-center",children:s.jsxs("span",{className:e.finish==="foil"?"text-yellow-400":"text-green-400",children:["$",(e.finish==="foil"?L("usd_foil")||L("usd"):L("usd")||L("usd_foil")).toFixed(2)]})}),x&&s.jsx("div",{className:`absolute inset-0 z-40 transition-all duration-200 flex items-center justify-center ${m?"bg-indigo-500/20":"bg-black/40 hover:bg-black/20"}`,children:s.jsx("div",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all scale-110 ${m?"bg-indigo-500 border-indigo-500 text-white":"border-white/50 bg-black/40"}`,children:m&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})}),!x&&s.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-300 z-30",children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/95 to-transparent p-3 pt-6",children:[s.jsx("p",{className:"font-black text-sm text-white leading-tight line-clamp-1 drop-shadow-lg mb-2",children:e.name}),s.jsx("div",{className:"flex items-center gap-2 mb-3",children:s.jsxs("div",{className:`flex items-center gap-1.5 border rounded-lg px-2.5 py-1 backdrop-blur-md ${e.finish==="foil"?"bg-yellow-500/20 border-yellow-500/40":"bg-green-500/20 border-green-500/40"}`,children:[s.jsx("svg",{className:`w-3 h-3 ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("span",{className:`text-xs font-bold font-mono ${e.finish==="foil"?"text-yellow-400":"text-green-400"}`,children:["$",(e.finish==="foil"?L("usd_foil")||L("usd"):L("usd")||L("usd_foil")).toFixed(2)]})]})}),s.jsxs("div",{className:"flex gap-1.5",children:[s.jsxs("button",{onClick:$,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 text-white font-bold py-2 px-3 rounded-lg transition-all duration-200 flex items-center justify-center gap-1.5 shadow-lg hover:shadow-indigo-500/50 active:scale-95",children:[s.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),s.jsx("span",{className:"text-[10px] uppercase tracking-wider font-black",children:"View"})]}),F&&s.jsx("button",{onClick:k=>{k.stopPropagation(),j(!v)},className:"bg-gray-700/90 hover:bg-gray-600 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-gray-500/30 active:scale-95",title:"Flip",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),n&&s.jsx("button",{onClick:k=>{k.stopPropagation(),n(e.firestoreId||e.id,e.name)},className:"bg-red-600/90 hover:bg-red-500 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-red-500/50 active:scale-95",title:"Remove",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})]}),F&&s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:I,alt:`${e.name} (Back)`,className:"w-full h-full object-cover",loading:"lazy"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:e.name})}),s.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"Click to Flip"})]})]})]})})}),Y1e=({cards:t,isMixed:e})=>{const[r,n]=b.useState({key:"name",direction:"asc"}),i=b.useMemo(()=>{let c=[...t];return r.key&&c.sort((u,f)=>{let p=u[r.key],x=f[r.key];return r.key==="price"?(p=parseFloat(u.prices?.usd||0),x=parseFloat(f.prices?.usd||0)):r.key==="type"?(p=u.type_line||"",x=f.type_line||""):r.key==="set"&&(p=u.set_name||"",x=f.set_name||""),p<x?r.direction==="asc"?-1:1:p>x?r.direction==="asc"?1:-1:0}),c},[t,r]),a=c=>{let u="asc";r.key===c&&r.direction==="asc"&&(u="desc"),n({key:c,direction:u})},o=c=>r.key!==c?s.jsx("svg",{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):r.direction==="asc"?s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),l=({label:c,sortKey:u,className:f=""})=>s.jsx("th",{className:`px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group hover:text-white transition-colors select-none ${f}`,onClick:()=>a(u),children:s.jsxs("div",{className:"flex items-center gap-2",children:[c,o(u)]})});return s.jsx("div",{className:"w-full overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[1000px] border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-800",children:[s.jsx(l,{label:"Card Name",sortKey:"name"}),s.jsx(l,{label:"Set",sortKey:"set"}),s.jsx(l,{label:"Type",sortKey:"type"}),s.jsx(l,{label:"Rarity",sortKey:"rarity"}),s.jsx(l,{label:"Market Price",sortKey:"price"}),s.jsx(l,{label:"Paid",sortKey:"price_bought"}),e&&s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Owner"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800/50",children:i.map(c=>s.jsxs("tr",{className:"group hover:bg-gray-800/30 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0 relative rounded overflow-hidden mr-4 border border-gray-700 bg-gray-900 group-hover:scale-150 group-hover:z-10 transition-all origin-left",children:s.jsx("img",{className:"h-full w-full object-cover",src:c.image_uri||c.image_uris?.small,alt:""})}),s.jsxs("div",{className:"ml-0",children:[s.jsx("div",{className:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors",children:c.name}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["x",c.count]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300 border border-gray-700",children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3 text-indigo-400",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),c.set_name]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 truncate max-w-[200px]",title:c.type_line,children:c.type_line}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`
                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide
                                    ${c.rarity==="mythic"?"text-orange-400 bg-orange-900/10 border border-orange-500/20":c.rarity==="rare"?"text-yellow-400 bg-yellow-900/10 border border-yellow-500/20":c.rarity==="uncommon"?"text-blue-400 bg-blue-900/10 border border-blue-500/20":"text-gray-400 bg-gray-800 border border-gray-700"}
                                `,children:c.rarity})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-mono",children:["$",parseFloat(c.prices?.usd||0).toFixed(2)]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono",children:c.price_bought?`$${parseFloat(c.price_bought).toFixed(2)}`:"-"}),e&&s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center gap-2",title:c.owner_username,children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white text-[10px] font-bold",children:c.owner_username?c.owner_username[0].toUpperCase():"?"}),s.jsx("span",{className:"text-xs text-gray-400 truncate max-w-[80px]",children:c.owner_username})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[(c.tags&&typeof c.tags=="string"?JSON.parse(c.tags):c.tags||[]).map((u,f)=>s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:u},f)),(!c.tags||Array.isArray(c.tags)&&c.tags.length===0)&&s.jsx("span",{className:"text-gray-600 text-xs italic",children:"No tags"})]})})]},c.id||c.firestoreId))})]})})},K1e=({mode:t,onChange:e})=>s.jsxs("div",{className:"bg-gray-900 p-1 rounded-xl flex border border-gray-800",children:[s.jsx("button",{onClick:()=>e("folder"),className:`p-2 rounded-lg transition-all ${t==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Folder Group View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),s.jsx("button",{onClick:()=>e("grid"),className:`p-2 rounded-lg transition-all ${t==="grid"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>e("table"),className:`p-2 rounded-lg transition-all ${t==="table"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Table List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]}),X1e=({isOpen:t,onClose:e})=>{const{currentUser:r}=Sr(),{addToast:n}=wn(),{refreshCollection:i}=To(),[a,o]=b.useState(""),[l,c]=b.useState([]),[u,f]=b.useState(!1),[p,x]=b.useState("input"),[m,y]=b.useState([]),[v,j]=b.useState(""),[N,C]=b.useState(!1),[A,L]=b.useState([]),O=b.useRef(null),F=k=>{const R=k.trim();if(!R)return null;const P=R.split(/[,\t]/).map(ee=>ee.trim());if(P.length<1)return null;const q=P[0],X=P[1]||null,G=P[2]||null,ne=P[3]||null;return{count:1,name:q,set:X,collector_number:G,tag:ne,mode:"unified"}},T=async()=>{if(a.trim()){f(!0);try{const R=a.split(`
`).map(F).filter(Boolean),P=await Promise.all(R.map(async q=>{try{let X="";if(q.set&&q.collector_number)X=`https://api.scryfall.com/cards/${q.set.toLowerCase()}/${q.collector_number}`;else{let ne=q.name;q.set&&(ne+=` set:${q.set}`),X=`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(ne)}`}const G=await fetch(X);if(G.ok){const ne=await G.json();return{...q,valid:!0,scryfallId:ne.id,data:ne,image:ne.image_uris?.small||ne.card_faces?.[0]?.image_uris?.small}}else{if(q.set&&q.collector_number){const ne=await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(q.name)}`);if(ne.ok){const ee=await ne.json();return{...q,valid:!0,scryfallId:ee.id,data:ee,image:ee.image_uris?.small||ee.card_faces?.[0]?.image_uris?.small,warning:"Exact match failed, found by name."}}}return{...q,valid:!1}}}catch{return{...q,valid:!1}}}));c(P),x("preview")}catch{n("Failed to parse cards","error")}finally{f(!1)}}},I=k=>{const R=k.target.files[0];if(!R)return;const P=new FileReader;P.onload=q=>{o(q.target.result)},P.readAsText(R)},B=async()=>{C(!0);const k=l.filter(R=>R.valid);try{const R=k.map(X=>{const G=[...m];return X.tag&&!G.includes(X.tag)&&G.push(X.tag),{name:X.data.name,scryfall_id:X.scryfallId,set_code:X.data.set,collector_number:X.data.collector_number,image_uri:X.data.image_uris?.normal||X.data.card_faces?.[0]?.image_uris?.normal,count:X.count,data:X.data,tags:JSON.stringify(G)}}),P=await r.getIdToken();if(!(await fetch("http://localhost:3000/api/collection/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`},body:JSON.stringify({cards:R,mode:"merge"})})).ok)throw new Error("Import failed");L(R),x("success"),i(),n(`Successfully imported ${k.length} cards!`,"success")}catch(R){console.error(R),n("Import failed. Check console.","error")}finally{C(!1)}},$=k=>{k.key==="Enter"&&v.trim()&&(m.includes(v.trim())||y([...m,v.trim()]),j(""))};return t?Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:p==="success"?"Import Complete":"Bulk Import"}),s.jsx("p",{className:"text-gray-400",children:p==="success"?`Successfully added ${A.length} cards to your collection.`:"Import cards from CSV or text list."})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[p==="input"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl text-blue-200 text-sm",children:[s.jsx("p",{className:"font-bold mb-2",children:"Supported Formats:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"CSV (Recommended)"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Black Lotus, LEA, 1, Power 9"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"Text List"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Command Tower, CMD, , Base"]})]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>O.current.click(),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-lg text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload CSV / Text File"]}),s.jsx("input",{type:"file",ref:O,onChange:I,accept:".csv,.txt",className:"hidden"})]}),s.jsx("textarea",{value:a,onChange:k=>o(k.target.value),placeholder:"Paste your list here...",className:"w-full h-80 bg-gray-800/50 border border-gray-700 text-gray-200 p-4 rounded-xl font-mono focus:ring-2 focus:ring-indigo-500 outline-none resize-none text-sm"})]}),p==="preview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Apply Tags to Batch"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[m.map(k=>s.jsxs("span",{className:"bg-indigo-600 text-white px-2 py-1 rounded text-sm flex items-center gap-1",children:[k,s.jsx("button",{onClick:()=>y(m.filter(R=>R!==k)),className:"hover:text-red-300",children:""})]},k)),s.jsx("input",{type:"text",placeholder:"Type tag & Enter...",value:v,onChange:k=>j(k.target.value),onKeyDown:$,className:"bg-transparent border-none focus:ring-0 text-white placeholder-gray-600 text-sm min-w-[120px]"})]})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Matched Tag"}),s.jsx("th",{className:"p-3 text-right",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:l.map((k,R)=>s.jsxs("tr",{className:k.valid?"":"bg-red-900/10",children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[k.image?s.jsx("img",{src:k.image,className:"w-8 h-8 rounded object-cover",alt:""}):s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded flex items-center justify-center text-xs",children:"?"}),s.jsxs("div",{children:[s.jsx("div",{className:k.valid?"text-white font-bold":"text-red-400 line-through",children:k.name}),k.warning&&s.jsx("div",{className:"text-[10px] text-yellow-500",children:k.warning})]})]}),s.jsx("td",{className:"p-3",children:k.data?.set_name||k.set||"-"}),s.jsx("td",{className:"p-3 text-center font-mono",children:k.count}),s.jsx("td",{className:"p-3",children:k.tag&&s.jsx("span",{className:"text-xs bg-gray-700 px-1 rounded text-gray-300",children:k.tag})}),s.jsx("td",{className:"p-3 text-right",children:k.valid?s.jsx("span",{className:"text-green-400",children:"Ready"}):s.jsx("span",{className:"text-red-500",children:"Not Found"})})]},R))})]})})]}),p==="success"&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-4 rounded-xl text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-2",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Import Successful!"}),s.jsx("p",{className:"text-green-200 text-sm",children:"Your new cards have been added to the collection."})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800 max-h-[50vh] overflow-y-auto",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold sticky top-0 bg-gray-900 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Applied Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:A.map((k,R)=>s.jsxs("tr",{children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[s.jsx("img",{src:k.image_uri,className:"w-8 h-8 rounded object-cover",alt:""}),s.jsx("span",{className:"text-white font-bold",children:k.name})]}),s.jsx("td",{className:"p-3",children:k.set_code?.toUpperCase()}),s.jsx("td",{className:"p-3 text-center font-mono",children:k.count}),s.jsx("td",{className:"p-3",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:JSON.parse(k.tags).map(P=>s.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:P},P))})})]},R))})]})})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-900/50 rounded-b-2xl",children:p==="input"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:e,className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Cancel"}),s.jsx("button",{onClick:T,disabled:u||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:u?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Review Cards"]}):"Review Cards"})]}):p==="preview"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>x("input"),className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Back to Edit"}),s.jsx("button",{onClick:B,disabled:N||l.filter(k=>k.valid).length===0,className:"bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:N?"Importing...":`Import ${l.filter(k=>k.valid).length} Cards`})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{}),s.jsx("button",{onClick:e,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg",children:"Done"})]})})]})}),document.body):null},J1e=t=>{const e=t.toLowerCase(),r=[];let n="Smart Binder",i="",a="blue",o=`Generated from "${t}"`;(e.includes("red")||e.includes("fire")||e.includes("mountain")||e.includes("burn"))&&(a="red",e.includes("goblin")||(n="Red Collection")),(e.includes("green")||e.includes("forest")||e.includes("elf")||e.includes("nature"))&&(a="green",e.includes("elf")||(n="Green Collection")),(e.includes("blue")||e.includes("island")||e.includes("control")||e.includes("water"))&&(a="blue",n="Blue Collection"),(e.includes("black")||e.includes("swamp")||e.includes("death")||e.includes("grave"))&&(a="purple",n="Black Collection"),(e.includes("white")||e.includes("plains")||e.includes("light")||e.includes("angel"))&&(a="gray",n="White Collection"),e.includes("commander")||e.includes("legend")||e.includes("edh")?(r.push({field:"type",operator:"contains",value:"Legendary Creature"}),i="",n="Commanders",(e.includes("potential")||e.includes("candidate"))&&(n="Potential Commanders")):e.includes("creature")&&(r.push({field:"type",operator:"contains",value:"Creature"}),n==="Smart Binder"&&(n="Creatures",i="")),e.includes("land")&&(r.push({field:"type",operator:"contains",value:"Land"}),i="",n="Lands"),(e.includes("artifact")||e.includes("rock"))&&(r.push({field:"type",operator:"contains",value:"Artifact"}),i="",n="Artifacts"),e.includes("enchantment")&&(r.push({field:"type",operator:"contains",value:"Enchantment"}),i="",n="Enchantments"),e.includes("goblin")&&(r.push({field:"type",operator:"contains",value:"Goblin"}),i="",n="Goblin Tribe",a="red"),(e.includes("elf")||e.includes("elves"))&&(r.push({field:"type",operator:"contains",value:"Elf"}),i="",n="Elven Tribe",a="green"),e.includes("not in deck")||e.includes("unused")||e.includes("spare")||e.includes("binder fodder")?(r.push({field:"in_deck",operator:"is",value:"false"}),n==="Smart Binder"?n="Unused Cards":n=`Unused ${n}`):(e.includes("in deck")||e.includes("used")||e.includes("active"))&&(r.push({field:"in_deck",operator:"is",value:"true"}),n=`Active ${n}`),(e.includes("expensive")||e.includes("value")||e.includes("money")||e.includes("high end")||e.includes("sell")&&!e.includes("not")&&!e.includes("dont")&&!e.includes("wouldnt"))&&(r.push({field:"price",operator:"gt",value:"5.00"}),i="",n.includes("Commander")||(n="High Value")),(e.includes("bulk")||e.includes("cheap")||e.includes("pauper")||e.includes("sell")&&(e.includes("not")||e.includes("dont")||e.includes("wouldnt")))&&(r.push({field:"price",operator:"lt",value:"1.00"}),i="",n="Bulk Storage"),e.includes("trade")&&(r.some(c=>c.field==="in_deck")||r.push({field:"in_deck",operator:"is",value:"false"}),n="Trade Binder",i="");const l=[];return e.includes("rare")&&l.push("rare"),e.includes("mythic")&&l.push("mythic"),l.length>0&&(r.push({field:"rarity",operator:"in",value:l}),(!i||i==="")&&(i="")),(e.includes("duplicate")||e.includes("playset")||e.includes("extra")||e.includes("few of")||e.includes("many"))&&(r.push({field:"count",operator:"gt",value:"4"}),n==="Smart Binder"&&(n="Trade Stock"),i=""),r.length===0&&r.push({field:"name",operator:"contains",value:t}),{id:`ai-${Date.now()}`,name:n,description:o,icon:i,color:a,rules:r}},Lv={string:[{id:"contains",label:"contains"},{id:"is",label:"is exactly"},{id:"not",label:"is not"}],number:[{id:"gt",label:"is greater than"},{id:"lt",label:"is less than"},{id:"eq",label:"is exactly"}],select:[{id:"in",label:"is one of"},{id:"not_in",label:"is none of"}],color:[{id:"contains",label:"contains"},{id:"contains_any",label:"contains any of"},{id:"is_exactly",label:"is exactly"}],boolean:[{id:"is",label:"is"}]},Ov=[{id:"name",label:"Name",type:"string"},{id:"colors",label:"Color Identity",type:"color"},{id:"rarity",label:"Rarity",type:"select",options:["common","uncommon","rare","mythic"]},{id:"type",label:"Type Line",type:"string"},{id:"price",label:"Market Price ($)",type:"number"},{id:"cmc",label:"Mana Value (CMC)",type:"number"},{id:"set",label:"Set Code",type:"string"},{id:"count",label:"Quantity",type:"number"},{id:"in_deck",label:"In a Deck?",type:"boolean",options:[{id:"true",label:"In a Deck"},{id:"false",label:"Not in a Deck"}]}],Z1e=({rules:t=[],onChange:e})=>{const r=Array.isArray(t)?t:[],[n,i]=b.useState(!1),a=()=>{const u={field:"name",operator:"contains",value:""};e([...r,u])},o=(u,f)=>{const p=[...r];if(p[u]={...p[u],...f},f.field){const x=Ov.find(y=>y.id===f.field),m=Lv[x.type]||Lv.string;p[u].operator=m[0].id,p[u].value=x.type==="select"?[]:x.type==="color"?[]:x.type==="boolean"?x.options[0].id:""}e(p)},l=u=>{e(r.filter((f,p)=>p!==u))},c=(u,f)=>{const p=r[u].value||[],x=p.includes(f)?p.filter(m=>m!==f):[...p,f].sort((m,y)=>"WUBRG".indexOf(m)-"WUBRG".indexOf(y));o(u,{value:x})};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-500",children:"Logic Rules"}),s.jsx("button",{onClick:a,className:"text-[10px] font-bold bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 px-3 py-1 rounded-full hover:bg-indigo-600 hover:text-white transition-all",children:"+ Add Condition"})]}),s.jsxs("div",{className:"space-y-3",children:[r.map((u,f)=>{const p=Ov.find(m=>m.id===u.field)||Ov[0],x=Lv[p.type]||Lv.string;return s.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center gap-2 bg-gray-950/40 p-3 rounded-2xl border border-gray-800/50 hover:border-gray-700 transition-all",children:[s.jsx("div",{className:"w-12 text-[10px] font-black uppercase text-indigo-500/60",children:f===0?"IF":"AND"}),s.jsx("select",{value:u.field,onChange:m=>o(f,{field:m.target.value}),className:"bg-gray-950/50 border border-white/5 text-white text-xs font-black rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:Ov.map(m=>s.jsx("option",{value:m.id,children:m.label},m.id))}),s.jsx("select",{value:u.operator,onChange:m=>o(f,{operator:m.target.value}),className:"bg-gray-950/50 border border-white/5 text-indigo-400 text-xs font-bold rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:x.map(m=>s.jsx("option",{value:m.id,children:m.label},m.id))}),s.jsx("div",{className:"flex-1 min-w-[150px]",children:p.type==="color"?s.jsx("div",{className:"flex gap-1",children:"WUBRGC".split("").map(m=>s.jsx("button",{onClick:()=>c(f,m),className:`w-7 h-7 rounded-full flex items-center justify-center transition-all border ${u.value?.includes(m)?"bg-indigo-600 border-indigo-400 shadow-[0_0_10px_rgba(79,70,229,0.4)]":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-500"}`,children:s.jsx("i",{className:`ms ms-${m.toLowerCase()} ms-cost text-xs ${u.value?.includes(m)?"text-white":""}`})},m))}):p.type==="select"?s.jsx("div",{className:"flex flex-wrap gap-1",children:p.options.map(m=>s.jsx("button",{onClick:()=>{const y=u.value||[],v=y.includes(m)?y.filter(j=>j!==m):[...y,m];o(f,{value:v})},className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase transition-all border ${u.value?.includes(m)?"bg-indigo-600/20 border-indigo-500 text-indigo-400":"bg-gray-800 border-gray-700 text-gray-500"}`,children:m},m))}):p.type==="boolean"?s.jsx("div",{className:"flex gap-1",children:p.options.map(m=>s.jsx("button",{onClick:()=>o(f,{value:m.id}),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all border ${u.value===m.id?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-600"}`,children:m.label},m.id))}):s.jsx("input",{type:p.type==="number"?"number":"text",value:u.value,placeholder:"Value...",onChange:m=>o(f,{value:m.target.value}),className:"w-full bg-gray-900/50 border-none text-white text-xs rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 outline-none"})}),s.jsx("button",{onClick:()=>l(f),className:"p-1 px-2 text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all text-sm",title:"Remove Rule",children:""})]},f)}),r.length===0&&s.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium italic",children:"No rules defined. This binder will be empty or use manual selection."}),s.jsx("button",{onClick:a,className:"text-indigo-400 text-xs font-bold mt-2 hover:underline",children:"+ Click to create your first rule"})]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-indigo-950/10 border border-indigo-900/20 rounded-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Binder Recipe Output"})]}),s.jsx("button",{onClick:()=>i(!n),className:"text-[10px] font-bold text-gray-500 hover:text-white transition-colors uppercase tracking-wider",children:n?"Show Preview":"Import / Export"})]}),n?s.jsxs("div",{children:[s.jsx("textarea",{value:JSON.stringify(r,null,2),onChange:u=>{try{const f=JSON.parse(u.target.value);Array.isArray(f)&&e(f)}catch{}},className:"w-full h-32 bg-gray-900/50 border border-indigo-500/30 rounded-xl p-3 text-[10px] font-mono text-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 resize-y",placeholder:"Paste rule JSON here..."}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Copy this JSON to share rules between binders. Paste existing JSON to load it."})]}):s.jsx("div",{className:"font-mono text-[10px] text-gray-500 break-all leading-relaxed select-text cursor-text active:text-indigo-400 transition-colors",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(r,null,2))},title:"Click to copy JSON to clipboard",children:r.length>0?s.jsxs(s.Fragment,{children:["SELECT * FROM collection WHERE user_id = current_user",r.map((u,f)=>s.jsxs("span",{className:"text-indigo-300/60 block ml-4",children:["AND ",u.field," ",u.operator," '",Array.isArray(u.value)?u.value.join(", "):u.value,"'"]},f))]}):"-- No rules defined yet --"})]})]})},Zo={METHOD:1,CONFIG:2,REVIEW:3},Q1e=[...new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","0","1","2","3","4","5","6","7","8","9","","","#","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""])],e2e=({isOpen:t,onClose:e,selectedCards:r=[],editingBinder:n=null})=>{const{addToast:i}=wn();To();const[a,o]=b.useState(Zo.METHOD),[l,c]=b.useState(!1),[u,f]=b.useState(""),[p,x]=b.useState("collection"),[m,y]=b.useState("emoji"),[v,j]=b.useState(""),[N,C]=b.useState("blue"),[A,L]=b.useState([]),[O,F]=b.useState([]),[T,I]=b.useState(!1);b.useEffect(()=>{if(t){if(n){o(Zo.CONFIG),f(n.name||""),x(n.type||"collection"),y(n.icon_type||"emoji"),j(n.icon_value||""),C(n.color_preference||"blue");let U=[];try{const Y=n.rules?typeof n.rules=="string"?JSON.parse(n.rules):n.rules:[];U=Array.isArray(Y)?Y:[]}catch(Y){console.error("Failed to parse binder rules",Y)}F(U),I(!!n.rules),L([])}else o(Zo.METHOD),f(""),x("collection"),y("emoji"),j(""),C("blue"),L(r||[]),F([]),I(!1);$([])}},[t,n]);const[B,$]=b.useState([]),[k,R]=b.useState(""),[P,q]=b.useState(!1),X=async()=>{k.trim()&&(q(!0),$([]),setTimeout(()=>{const U=J1e(k);$([U]),q(!1)},800))},G=U=>{f(U.name),j(U.icon),C(U.color),F(U.rules),I(!0),o(Zo.CONFIG)},ne=async()=>{c(!0);try{const U={name:u,type:p,icon_type:m,icon_value:v,color_preference:N,rules:T?O:null};let Y;if(n?(await Ze.updateBinder(n.id,U),Y=n.id):Y=(await Ze.post("/api/binders",U)).id,A.length>0){const te=A.map(ce=>ce.firestoreId||ce.id);await Ze.put("/api/collection/batch-update",{cardIds:te,binderId:Y})}i(n?"Binder updated!":"Binder created successfully!","success"),e()}catch(U){console.error("[BinderWizard] Submit error:",U),i("Failed to save binder","error")}finally{c(!1)}},ee=async()=>{if(n&&window.confirm(`Are you sure you want to delete "${n.name}"? This will NOT delete the cards inside.`)){c(!0);try{await Ze.deleteBinder(n.id),i("Binder deleted","success"),e()}catch(U){console.error("[BinderWizard] Delete error:",U),i("Failed to delete binder","error")}finally{c(!1)}}},se=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>{I(!1),o(Zo.CONFIG)},className:"p-6 bg-gray-950/40 hover:bg-indigo-900/10 border border-white/5 hover:border-indigo-500/50 rounded-3xl text-left transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),s.jsx("div",{className:"w-14 h-14 bg-gray-800 rounded-2xl flex items-center justify-center text-3xl mb-4 group-hover:scale-110 transition-transform shadow-xl",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Manual Binder"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:"Classic storage. Move cards in and out exactly how you want."})]}),s.jsxs("div",{className:"p-6 bg-indigo-950/20 border border-indigo-500/20 rounded-3xl relative overflow-hidden flex flex-col h-full",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.381z",clipRule:"evenodd"})})}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-600/20 text-indigo-400 rounded-2xl flex items-center justify-center text-3xl mb-4 shadow-xl shadow-indigo-900/20",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Smart Creator"}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["Describe what you want, and AI will build the rules for you. ",s.jsx("button",{onClick:()=>window.open("https://github.com/TristinParker/MTGLibrary/blob/main/docs/SMART_BINDERS.md","_blank"),className:"text-indigo-400 hover:text-indigo-300 underline md:hidden",children:"What is this?"})]}),s.jsx("div",{className:"mt-auto",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:k,onChange:U=>R(U.target.value),placeholder:'e.g., "Red Goblins over $5"',className:"w-full bg-black/40 border border-indigo-500/30 rounded-xl pl-4 pr-12 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-sm",onKeyDown:U=>U.key==="Enter"&&X()}),s.jsx("button",{onClick:X,disabled:!k.trim()||P,className:"absolute right-1 top-1 bottom-1 px-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-all flex items-center justify-center",children:P?s.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})})]})]})]}),(P||B.length>0)&&s.jsxs("div",{className:"mt-8 space-y-4 animate-fade-in-up",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px bg-white/10 flex-1"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Suggested Blueprints"}),s.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),P?s.jsxs("div",{className:"py-8 flex flex-col items-center",children:[s.jsxs("div",{className:"relative w-16 h-16",children:[s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500/20 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),s.jsx("p",{className:"mt-4 text-indigo-400 font-mono text-xs animate-pulse",children:"Generating rules..."})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:B.map(U=>s.jsxs("button",{onClick:()=>G(U),className:"p-4 bg-gray-900/60 hover:bg-gray-800 border border-white/5 hover:border-indigo-500/30 rounded-2xl flex items-center gap-4 transition-all text-left group shadow-lg",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-transform group-hover:scale-110",style:{backgroundColor:`rgba(${U.color==="purple"?"139, 92, 246":U.color==="green"?"16, 185, 129":U.color==="orange"?"249, 115, 22":"239, 68, 68"}, 0.1)`},children:U.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white text-sm",children:U.name}),s.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:U.description})]}),s.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-indigo-500",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]},U.id))})]})]}),J=()=>s.jsxs("div",{className:"space-y-8 max-w-xl mx-auto",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Binder Name"}),s.jsx("input",{type:"text",value:u,onChange:U=>f(U.target.value),placeholder:"e.g., The Vault",autoFocus:!0,className:"w-full bg-gray-950 border-2 border-white/5 focus:border-indigo-500/50 text-white px-5 py-4 rounded-2xl focus:outline-none font-black text-xl transition-all shadow-inner shadow-black/40 placeholder:text-gray-800"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Icon Type"}),s.jsxs("div",{className:"flex bg-gray-950 p-1 rounded-xl border border-white/5",children:[s.jsx("button",{onClick:()=>y("emoji"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${m==="emoji"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Emoji"}),s.jsx("button",{onClick:()=>y("mtg"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${m==="mtg"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Symbols"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Theme Color"}),s.jsxs("div",{className:"flex gap-2 bg-gray-950 p-2 rounded-xl border border-white/5 overflow-x-auto custom-scrollbar no-scrollbar items-center",children:[["blue","red","green","purple","orange","gray"].map(U=>s.jsx("button",{onClick:()=>C(U),className:`w-6 h-6 shrink-0 rounded-full transition-all ${N===U?"ring-2 ring-white scale-110 shadow-lg":"opacity-40 hover:opacity-100"}`,style:{backgroundColor:U==="blue"?"#3B82F6":U==="red"?"#EF4444":U==="green"?"#10B981":U==="purple"?"#8B5CF6":U==="orange"?"#F59E0B":"#6B7280"}},U)),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("div",{className:"relative group",children:s.jsx("div",{className:`w-6 h-6 rounded-full border border-white/20 flex items-center justify-center overflow-hidden ${["blue","red","green","purple","orange","gray"].includes(N)?"":"ring-2 ring-white"}`,children:s.jsx("input",{type:"color",value:["blue","red","green","purple","orange","gray"].includes(N)?"#ffffff":N,onChange:U=>C(U.target.value),className:"w-8 h-8 -m-1 cursor-pointer"})})})]})]})]})]}),s.jsx("div",{className:"bg-gray-950 rounded-3xl p-5 border border-white/5 shadow-inner shadow-black/40",children:s.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 gap-3 h-40 overflow-y-auto custom-scrollbar pr-2",children:m==="emoji"?Q1e.map(U=>s.jsx("button",{onClick:()=>j(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40":"bg-gray-900 border border-white/5 text-gray-500 hover:bg-gray-800 hover:text-white"}`,children:U},U)):["ms-w","ms-u","ms-b","ms-r","ms-g","ms-c","ms-wp","ms-up","ms-bp","ms-rp","ms-gp","ms-s","ms-x","ms-e","ms-planeswalker","ms-land","ms-artifact","ms-enchantment","ms-creature","ms-instant","ms-sorcery","ms-multiple","ms-guild-azorius","ms-guild-selesnya","ms-guild-boros","ms-guild-dimir","ms-guild-simic","ms-guild-gruul","ms-guild-rakdos","ms-guild-orzhov","ms-guild-izzet","ms-guild-golgari","ms-clan-abzan","ms-clan-jeskai","ms-clan-sultai","ms-clan-mardu","ms-clan-temur","ms-shard-bant","ms-shard-esper","ms-shard-grixis","ms-shard-jund","ms-shard-naya","ms-p","ms-chaos","ms-loyalty-up","ms-loyalty-down","ms-loyalty-zero","ms-tap","ms-untap","ms-flashback","ms-dfc-day","ms-dfc-night"].map(U=>s.jsx("button",{onClick:()=>j(U),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${v===U?"bg-indigo-600 shadow-lg shadow-indigo-900/40 text-white":"bg-gray-900 border border-white/5 text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:s.jsx("i",{className:`ms ${U} ms-cost`})},U))})}),s.jsxs("div",{className:"bg-gray-950 rounded-3xl p-6 border border-white/5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-xl transition-colors ${T?"bg-indigo-600/20 text-indigo-400":"bg-gray-800 text-gray-500"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold text-sm",children:"Automated Smart Rules"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"Auto-organize collection based on conditions."})]})]}),s.jsx("button",{onClick:()=>I(!T),className:`w-12 h-6 rounded-full transition-all relative ${T?"bg-indigo-600":"bg-gray-800"}`,children:s.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-md ${T?"left-7":"left-1"}`})})]}),T&&s.jsx("div",{className:"pt-4 border-t border-white/5 animate-fade-in",children:s.jsx(Z1e,{rules:O,onChange:F})})]})]}),W=()=>s.jsxs("div",{className:"text-center py-10 space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:`absolute inset-0 bg-${N}-500/20 blur-3xl rounded-full scale-150 animate-pulse`}),s.jsxs("div",{className:"relative w-32 h-32 bg-gray-900 border-4 border-white/10 rounded-[2.5rem] flex items-center justify-center text-6xl shadow-2xl z-10 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none"}),v.startsWith("ms")?s.jsx("i",{className:`ms ${v} ms-2x`}):v]}),s.jsx("div",{className:"absolute -bottom-2 -right-2 px-3 py-1 bg-indigo-600 text-white text-[10px] font-black uppercase rounded-full shadow-lg border border-white/20 z-20",children:T?"Smart":"Manual"})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-black text-white mb-2 leading-tight",children:u||"Unnamed Binder"}),s.jsx("p",{className:"text-gray-500 text-sm",children:T?`Smart Binder with ${O.length} rule(s)`:"Curated collection binder"})]}),s.jsx("div",{className:"bg-gray-950/40 rounded-3xl p-6 border border-white/5 max-w-sm mx-auto shadow-inner shadow-black/60",children:T?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[s.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Recipe Preview"})]}),s.jsxs("div",{className:"space-y-2",children:[O.map((U,Y)=>s.jsxs("div",{className:"text-xs text-gray-400 bg-black/40 p-2 rounded-xl border border-white/5 flex gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:Y===0?"IF":"AND"}),s.jsxs("span",{children:[U.field," ",s.jsx("span",{className:"text-indigo-400",children:U.operator})," '",Array.isArray(U.value)?U.value.join(", "):U.value,"'"]})]},Y)),O.length===0&&s.jsx("p",{className:"text-xs text-red-400 italic",children:"Warning: No rules defined! This binder will be empty."})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Manifest"}),s.jsxs("span",{children:[A.length," Cards"]})]}),s.jsx("div",{className:"flex justify-center -space-x-4 pl-4 h-24 items-end pb-2",children:A.length>0?A.slice(0,5).map((U,Y)=>s.jsx("div",{className:"w-16 h-20 bg-gray-800 rounded-lg border-2 border-white/10 shadow-2xl relative transition-transform hover:-translate-y-2 overflow-hidden",style:{transform:`rotate(${(Y-2)*8}deg)`},children:U.data?.image_uris?.small||U.image_uris?.small?s.jsx("img",{src:U.data?.image_uris?.small||U.image_uris.small,className:"w-full h-full object-cover",alt:""}):null},Y)):s.jsx("div",{className:"text-gray-700 italic text-xs",children:"Empty binder (add cards later)"})}),A.length>5&&s.jsxs("div",{className:"text-[10px] text-gray-600 font-bold",children:["+ ",A.length-5," more items"]})]})})]});return t?Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-950 border border-white/10 rounded-[2.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] w-full max-w-2xl flex flex-col max-h-[90vh] overflow-hidden relative",children:[s.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-48 h-1 bg-${N}-500 blur-md opacity-30`}),s.jsxs("div",{className:"p-8 pb-4 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.3em]",children:["Step 0",a]}),s.jsx("div",{className:"h-px w-8 bg-indigo-500/30"})]}),s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:a===Zo.METHOD?"Initialize Binder":a===Zo.CONFIG?"Configure Profile":"Final Review"})]}),s.jsx("button",{onClick:e,className:"w-10 h-10 rounded-2xl bg-white/5 hover:bg-white/10 flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-8 py-4 no-scrollbar",children:[a===Zo.METHOD&&se(),a===Zo.CONFIG&&J(),a===Zo.REVIEW&&W()]}),s.jsxs("div",{className:"p-8 pt-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>a>1?o(a-1):e(),className:"px-6 py-3 font-black text-gray-500 hover:text-white transition-colors text-xs uppercase tracking-widest active:scale-95",children:a===1?"Cancel":"Back"}),n&&a===Zo.CONFIG&&s.jsxs("button",{onClick:ee,disabled:l,className:"px-4 py-3 text-[10px] font-black text-red-500/60 hover:text-red-500 transition-colors uppercase tracking-[0.2em] flex items-center gap-2 bg-red-500/5 rounded-xl border border-red-500/10 hover:border-red-500/30",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),s.jsx("button",{onClick:()=>{a===Zo.REVIEW?ne():o(a+1)},disabled:l||a===Zo.CONFIG&&!u,className:`group px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all ${l?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-2xl shadow-indigo-900/40 active:scale-95 flex items-center gap-3"}`,children:l?s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/30 border-t-white rounded-full"}):s.jsxs(s.Fragment,{children:[a===Zo.REVIEW?n?"Push Changes":"Initialize":"Proceed",s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7-7 7"})})]})})]})]})}),document.body):null},XM=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],t2e=[{value:"color",label:"Color"},{value:"color_identity",label:"Color Identity"},{value:"type",label:"Card Type"},{value:"cmc",label:"Mana Value (CMC)"},{value:"rarity",label:"Rarity"},{value:"set",label:"Set Release"},{value:"collector_number",label:"Collector Number"},{value:"name",label:"Name"},{value:"price",label:"Price"},{value:"power",label:"Power"},{value:"toughness",label:"Toughness"},{value:"artist",label:"Artist"}],IH=({isOpen:t,onClose:e,onComplete:r})=>{const{updateSettings:n}=Sr();OH();const[i,a]=b.useState(1),[o,l]=b.useState(null),[c,u]=b.useState([null,null,null,null]),[f,p]=b.useState({rares:!0,foils:!0,value:!0,valueThreshold:2}),[x,m]=b.useState(!1);if(!t)return null;const y=N=>{const C=XM.find(A=>A.id===N);l(C),N==="advanced"?a(1.5):N==="hybrid"?a(2):j(C.sort,C.grouping)},v=(N,C)=>{const A=[...c];A[N]=C,u(A)},j=async(N,C)=>{m(!0);try{const A=N.filter(Boolean);let L=C;if(C==="custom"&&A.length>0){const F=A[0];["color","color_identity"].includes(F)?L="color":["set","release"].includes(F)?L="set":["type"].includes(F)?L="type":["rarity"].includes(F)?L="rarity":L="color"}const O={mode:o.id,sortHierarchy:A,groupingPreference:L};await n({organization:O}),r?r():e()}catch(A){console.error("Failed to save organization settings",A)}finally{m(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-5xl overflow-hidden shadow-2xl relative",children:[s.jsxs("div",{className:"p-8 pb-0 text-center",children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400",children:"Make your digital library feel like home."})]}),s.jsxs("div",{className:"p-8",children:[i===1&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:XM.map(N=>s.jsxs("button",{onClick:()=>y(N.id),className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl flex flex-col h-full",children:[s.jsx("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform",children:N.icon}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:N.name}),s.jsx("p",{className:"text-sm text-gray-300 mb-4 h-12",children:N.description}),s.jsx("ul",{className:"text-xs text-gray-400 space-y-2 mt-auto pt-4 border-t border-gray-700/50",children:N.features.map((C,A)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),C]},A))})]},N.id))}),i===1.5&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("p",{className:"text-indigo-300 font-bold uppercase tracking-widest text-xs text-center",children:"Define your custom hierarchy (Max 4)"}),s.jsx("div",{className:"space-y-3 max-w-md mx-auto",children:[0,1,2,3].map(N=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:N+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:c[N]||"",onChange:C=>v(N,C.target.value),children:[s.jsx("option",{value:"",children:"(None)"}),t2e.map(C=>s.jsx("option",{value:C.value,children:C.label},C.value))]})]},N))}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>j(c,"custom"),disabled:!c[0]||x,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:x?"Applying...":"Apply Hierarchy"})]})]}),i===2&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl mb-4",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["We'll set your main view to ",s.jsx("strong",{children:"Set & Collector Number"})," (for your boxes), and create ",s.jsx("strong",{children:"Smart Binders"})," for your special cards."]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.rares,onChange:N=>p({...f,rares:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Rares & Mythics"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "Trade Binder" for high rarity cards.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.foils,onChange:N=>p({...f,foils:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Foils"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a separate "Foils" binder.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.value,onChange:N=>p({...f,value:N.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white",children:"Valuable Cards"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "High Value" binder.'})]}),f.value&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-400",children:"$"}),s.jsx("input",{type:"number",value:f.valueThreshold,onChange:N=>p({...f,valueThreshold:N.target.value}),className:"w-16 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white text-sm",onClick:N=>N.stopPropagation()})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>j(o.sort,o.grouping),disabled:x,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:x?"Configuring...":"Finish Setup"})]})]})]})]})})},r2e=(t,e)=>!e||!Array.isArray(e)||e.length===0?!0:e.every(r=>{const{field:n,operator:i,value:a}=r;let o;switch(n){case"name":o=t.name||"";break;case"colors":o=t.data?.color_identity||[];break;case"rarity":o=t.data?.rarity||"";break;case"type":o=t.data?.type_line||"";break;case"price":o=parseFloat(t.data?.prices?.usd||0);break;case"set":o=t.data?.set_name||"";const c=t.data?.set||"";if(i==="contains")return o.toLowerCase().includes(String(a).toLowerCase())||c.toLowerCase().includes(String(a).toLowerCase());break;case"cmc":o=parseFloat(t.data?.cmc||0);break;case"count":o=parseInt(t.count||0,10);break;case"in_deck":const u=!!t.deck_id;return a==="true"?u:!u;default:o=t.data?.[n]||""}const l=Array.isArray(a)?a:String(a);switch(i){case"is":case"eq":return String(o).toLowerCase()===String(l).toLowerCase();case"not":return String(o).toLowerCase()!==String(l).toLowerCase();case"contains":return String(o).toLowerCase().includes(String(l).toLowerCase());case"gt":case"greater_than":return parseFloat(o)>parseFloat(l);case"lt":case"less_than":return parseFloat(o)<parseFloat(l);case"in":return Array.isArray(l)?l.includes(String(o).toLowerCase()):!1;case"not_in":return Array.isArray(l)?!l.includes(String(o).toLowerCase()):!0;case"contains_any":return Array.isArray(o)&&Array.isArray(l)?l.some(c=>o.includes(c)):!1;case"is_exactly":return Array.isArray(o)?JSON.stringify(o.sort())===JSON.stringify(l.sort()):!1;default:return!1}}),n2e=()=>{const{userProfile:t}=Sr(),{addToast:e}=wn(),r=Ao(),n=new URLSearchParams(r.search).get("wishlist")==="true",[i,a]=b.useState([]),[o,l]=b.useState("me");b.useEffect(()=>{wa.fetchIncomingPermissions().then(Ee=>{const He=[],Mt=new Set;(Array.isArray(Ee)?Ee:Ee.data||[]).forEach(Zt=>{Zt.owner_id&&!Mt.has(Zt.owner_id)&&(Mt.add(Zt.owner_id),He.push({id:Zt.owner_id,name:Zt.owner_username||"Unknown"}))}),a(He)}).catch(Ee=>console.error("Failed to fetch shared sources",Ee))},[]);const c=o!=="me"&&o!=="all",u=o==="all",{cards:f,loading:p,error:x,refresh:m,setCards:y}=To({wishlist:n,userId:o==="me"?null:o}),{binders:v,refreshBinders:j}=OH(),{decks:N}=hf(o==="me"?null:o),[C,A]=b.useState(""),[L,O]=b.useState(""),[F,T]=b.useState(!1);b.useEffect(()=>{const Ee=setTimeout(()=>{O(C)},300);return()=>clearTimeout(Ee)},[C]);const[I,B]=b.useState(!1),{undo:$,redo:k,recordAction:R,canUndo:P,canRedo:q}=MH(f,y);b.useEffect(()=>{!p&&f.length>0&&ba.pointer<0&&ba.init(f)},[p,f]);const X=async(Ee,He)=>{const Mt=[...f],Gt=f.find(Ut=>Ut.id===Ee||Ut.firestoreId===Ee);if(!Gt)return;const Zt=f.filter(Ut=>Ut.id!==Ee&&Ut.firestoreId!==Ee);y(Zt);try{await Ze.delete(`/ api / collection / ${Ee} `)}catch(Ut){console.error(Ut),y(Mt),e("Failed to delete card","error");return}R(`Deleted ${He} `,Zt,async()=>{try{await Di.addCardToCollection(t.uid,Gt,Gt.count||1,Gt.finish,Gt.is_wishlist)}catch(Ut){console.error("Undo Add failed",Ut)}},async()=>{try{await Ze.delete(`/ api / collection / ${Ee} `)}catch(Ut){console.error("Redo Delete failed",Ut)}}),e(`Deleted ${He} `,"success",3e3,{label:"Undo",onClick:()=>ba.undo()})},G=async Ee=>{[...f];const He=[...f,Ee];y(He),R(`Added ${Ee.name} `,He,async()=>{await Ze.delete(`/api/collection/${Ee.firestoreId||Ee.id}`)},async()=>{await Di.addCardToCollection(t.uid,Ee,Ee.count,Ee.finish,Ee.is_wishlist)})},ne=async()=>{B(!0);try{await Ze.post("/api/sync/prices"),await m()}catch(Ee){console.error("Sync failed",Ee)}finally{B(!1)}},[ee,se]=b.useState(()=>localStorage.getItem("collection_viewMode")||"grid"),[J,W]=b.useState(()=>localStorage.getItem("collection_groupingMode")||"binders"),[U,Y]=b.useState(null),[te,ce]=b.useState([]),[xe,ue]=b.useState(!1),[ve,Q]=b.useState(!1),[pe,Ce]=b.useState(!1),[je,we]=b.useState(!1),[Te,oe]=b.useState(!1),[De,Nt]=b.useState(!1),[ot,Ne]=b.useState(!1),[Ge,Xe]=b.useState(!1),[xt,Ae]=b.useState(!1),Pe=b.useRef(null),ct=b.useRef(null),[bt,dt]=b.useState(null),[Ve,lt]=b.useState(()=>{const Ee=localStorage.getItem("collection_filters");return Ee?JSON.parse(Ee):{colors:[],rarity:[],types:[],sets:[],decks:[],users:[]}}),[kt,Ue]=b.useState(()=>localStorage.getItem("collection_sortBy")||"added_at"),[Bt,zt]=b.useState(()=>localStorage.getItem("collection_sortOrder")||"desc"),[Ot,Et]=b.useState(()=>parseInt(localStorage.getItem("collection_currentPage"))||1),[$t,At]=b.useState(()=>parseInt(localStorage.getItem("collection_itemsPerPage"))||50);Ke.useEffect(()=>{localStorage.setItem("collection_viewMode",ee)},[ee]),Ke.useEffect(()=>{localStorage.setItem("collection_groupingMode",J)},[J]),Ke.useEffect(()=>{localStorage.setItem("collection_filters",JSON.stringify(Ve))},[Ve]),Ke.useEffect(()=>{localStorage.setItem("collection_sortBy",kt),localStorage.setItem("collection_sortOrder",Bt)},[kt,Bt]),Ke.useEffect(()=>{localStorage.setItem("collection_currentPage",Ot),localStorage.setItem("collection_itemsPerPage",$t)},[Ot,$t]),Ke.useEffect(()=>{Et(1)},[C,Ve,kt,Bt]),b.useEffect(()=>{const Ee=He=>{Pe.current&&!Pe.current.contains(He.target)&&(Ae(!1),Xe(!1))};return document.addEventListener("mousedown",Ee),()=>document.removeEventListener("mousedown",Ee)},[]),b.useEffect(()=>{if(U&&U.startsWith("binder-")){const Ee=U.replace("binder-","");ue(!0),Ze.getBinderCards(Ee).then(He=>ce(He)).catch(He=>e("Failed to load binder cards","error")).finally(()=>ue(!1))}else ce([])},[U,e]);const Xt=b.useMemo(()=>{const Ee=new Set;return Array.isArray(f)?(f.forEach(He=>{He.set&&He.set_name&&Ee.add(JSON.stringify({value:He.set,label:He.set_name}))}),Array.from(Ee).map(He=>JSON.parse(He)).sort((He,Mt)=>He.label.localeCompare(Mt.label))):[]},[f]),qt=b.useMemo(()=>i.map(Ee=>({value:Ee.id,label:Ee.name})),[i]),Ht=b.useMemo(()=>N.map(Ee=>({value:Ee.id,label:Ee.name})),[N]),jr=(Ee,He,Mt)=>{switch(Mt){case"color":case"color_identity":{const Gt={W:0,U:1,B:2,R:3,G:4},Zt=Ut=>{let It=Ut.color_identity||[];if(typeof It=="string")try{It=JSON.parse(It)}catch{}return It.length===0?6:It.length>1?5:Gt[It[0]]??7};return Zt(Ee)-Zt(He)}case"type":{const Gt={Creature:0,Instant:1,Sorcery:2,Enchantment:3,Artifact:4,Planeswalker:5,Land:6},Zt=Ut=>{const It=Ut.type_line||"";for(const[Vt,pr]of Object.entries(Gt))if(It.includes(Vt))return pr;return 7};return Zt(Ee)-Zt(He)}case"cmc":return(parseFloat(Ee.cmc)||0)-(parseFloat(He.cmc)||0);case"price":return parseFloat(Ee.prices?.usd||0)-parseFloat(He.prices?.usd||0);case"collector_number":{const Gt=parseInt(Ee.collector_number||0),Zt=parseInt(He.collector_number||0);return Gt-Zt}case"set":return(Ee.set||"").localeCompare(He.set||"");case"name":return(Ee.name||"").localeCompare(He.name||"");case"power":return(parseFloat(Ee.power)||0)-(parseFloat(He.power)||0);case"toughness":return(parseFloat(Ee.toughness)||0)-(parseFloat(He.toughness)||0);case"artist":return(Ee.artist||"").localeCompare(He.artist||"");default:return 0}},Ct=b.useMemo(()=>Array.isArray(f)?f.filter(He=>{const Mt=He.name||"";if(L&&!Mt.toLowerCase().includes(L.toLowerCase()))return!1;if(Ve.colors.length>0){const Gt=He.color_identity||[],Zt=Gt.length>1,Ut=Gt.length===0;if(!Ve.colors.some(Vt=>Vt==="C"?Ut:Vt==="M"?Zt:Gt.includes(Vt)))return!1}if(Ve.rarity.length>0&&!Ve.rarity.includes(He.rarity))return!1;if(Ve.types.length>0){const Gt=(He.type_line||"").toLowerCase();if(!Ve.types.some(Ut=>Gt.includes(Ut.toLowerCase())))return!1}return!(Ve.sets.length>0&&!Ve.sets.includes(He.set)||Ve.decks.length>0&&!Ve.decks.includes(He.deckId)||Ve.users&&Ve.users.length>0&&!Ve.users.includes(He.user_id)&&!Ve.users.includes(He.owner_id))}).sort((He,Mt)=>{const Gt=t?.settings?.organization?.sortHierarchy;if(Gt&&Array.isArray(Gt)&&Gt.length>0){for(const It of Gt){const Vt=jr(He,Mt,It);if(Vt!==0)return Vt}return jr(He,Mt,"name")}if(kt==="added_at"){const It=new Date(He.added_at||0).getTime(),Vt=new Date(Mt.added_at||0).getTime();return Bt==="asc"?It-Vt:Vt-It}let Zt=kt;if(kt==="owner")return(He.owner_username||"ME").localeCompare(Mt.owner_username||"ME");const Ut=jr(He,Mt,Zt);return Bt==="asc"?Ut:-Ut}):[],[f,L,Ve,kt,Bt,t]),Tt=b.useMemo(()=>{if(!Array.isArray(f))return[];if(ee!=="folder")return[];if(J==="custom"){const Ee={},He=[];Ct.forEach(Gt=>{const Zt=typeof Gt.tags=="string"?JSON.parse(Gt.tags):Gt.tags||[];Zt.length===0?He.push(Gt):Zt.forEach(Ut=>{Ee[Ut]||(Ee[Ut]=[]),Ee[Ut].push(Gt)})});const Mt=Object.entries(Ee).map(([Gt,Zt])=>({id:`tag - ${Gt} `,label:Gt,type:"tag",cards:Zt,icon:"",color:"indigo"}));return He.length>0&&Mt.push({id:"unsorted",label:"Unsorted",type:"tag",cards:He,icon:"",color:"gray"}),Mt.sort((Gt,Zt)=>Gt.label.localeCompare(Zt.label))}if(J==="smart"){const Ee=[],He={};Ct.forEach(Ut=>{if(Ut.deck_id){const It=N.find(Vt=>Vt.id===Ut.deck_id)?.name||"Unknown Deck";He[It]||(He[It]=[]),He[It].push(Ut)}}),Object.entries(He).forEach(([Ut,It])=>{const Vt=u&&It[0]?.owner_username?It[0].owner_username:null;Ee.push({id:`deck - ${Ut} `,label:Ut,type:"deck",cards:It,icon:"",color:"purple",sub:"Deck",ownerName:Vt})});const Mt=t?.settings?.organization?.groupingPreference||"color",Gt={};Ct.forEach(Ut=>{let It="Other",Vt="Other",pr=0,en={};if(Mt==="set")It=Ut.set||"unknown",Vt=Ut.set_name||"Unknown Set",pr=Ut.released_at?new Date(Ut.released_at).getTime():0,en={icon:"",color:"blue"};else if(Mt==="type"){const Yr=["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"],$r=Ut.type_line||"",Qr=Yr.find(pn=>$r.includes(pn))||"Other";It=Qr,Vt=Qr,en={icon:"",color:"emerald"}}else if(Mt==="rarity")It=Ut.rarity||"common",Vt=It.charAt(0).toUpperCase()+It.slice(1),pr={common:0,uncommon:1,rare:2,mythic:3}[It]||0,en={icon:"",color:"yellow"};else{let Yr=Ut.color_identity;if(typeof Yr=="string")try{Yr=JSON.parse(Yr)}catch{Yr=[]}Array.isArray(Yr)||(Yr=[]);const $r={W:0,U:1,B:2,R:3,G:4},pn=Yr.filter(ss=>$r[ss]!==void 0).sort((ss,Ei)=>$r[ss]-$r[Ei]).join("");It=pn.length===0?"C":pn;const Hr=V1e(It);Vt=Hr.name,pr=It==="C"?-1:It.length,en={icon:"",color:Hr.bg?.replace("bg-","")?.split(" ")[0]||"blue",pips:Hr.pips,flavor:Hr.flavor,theme:Hr.theme}}Gt[It]||(Gt[It]={label:Vt,cards:[],sortValue:pr,...en}),Gt[It].cards.push(Ut)});const Zt=Object.entries(Gt).map(([Ut,It])=>({id:`group - ${Ut} `,label:It.label,type:Mt,cards:It.cards,icon:It.icon,color:It.color||"gray",sub:Mt.charAt(0).toUpperCase()+Mt.slice(1),pips:It.pips,flavor:It.flavor,theme:It.theme,sortValue:It.sortValue}));return Zt.sort((Ut,It)=>Mt==="rarity"||Mt==="set"?It.sortValue-Ut.sortValue:Mt==="color"?(Ut.id.replace("group-","").length,Ut.theme&&It.theme?Ut.label.localeCompare(It.label):0):Ut.label.localeCompare(It.label)),[...Ee,...Zt]}return J==="binders"?v.map(Ee=>{const He=Ee.rules?typeof Ee.rules=="string"?JSON.parse(Ee.rules):Ee.rules:null,Mt=He?f.filter(Gt=>r2e(Gt,He)):f.filter(Gt=>String(Gt.binder_id)===String(Ee.id));return{id:`binder - ${Ee.id} `,label:Ee.name,type:"binder",cards:Mt,icon:Ee.icon_value||"",color:Ee.color_preference||"blue",sub:He?"Smart Binder":"Collection Binder",isSmart:!!He}}):[]},[Ct,J,ee,N,v,f,t,L]),Yt=(Ee,He)=>{lt(Mt=>{const Gt=Mt[Ee],Zt=Gt.includes(He)?Gt.filter(Ut=>Ut!==He):[...Gt,He];return{...Mt,[Ee]:Zt}})},Be=b.useMemo(()=>{const Ee=Tt.find(He=>He.id===U);return Ee&&Ee.type==="binder"?{...Ee,cards:te}:Ee},[Tt,U,te]),Lt=b.useMemo(()=>{if(ee!=="grid")return Ct;const Ee=(Ot-1)*$t,He=Ee+$t;return Ct.slice(Ee,He)},[Ct,Ot,$t,ee]),Ft=b.useMemo(()=>ee!=="grid"?1:Math.ceil(Ct.length/$t),[Ct.length,$t,ee]);return b.useEffect(()=>{const Ee=vn(t?.subscription_tier).features.binders;ee==="folder"&&J==="binders"&&!Ee&&se("grid")},[t,ee,J]),s.jsxs("div",{className:"relative min-h-screen overflow-x-hidden",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto px-4 md:px-6 py-8 space-y-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"relative z-50 flex flex-col md:flex-row justify-between items-start md:items-end gap-4 bg-gray-950/40 p-4 md:p-6 rounded-3xl backdrop-blur-md border border-white/5 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-4xl font-black text-white tracking-tight mb-1 md:mb-2",children:n?"My Wishlist":"My Collection"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("p",{className:"text-gray-400 font-medium text-xs md:text-sm",children:[Ct.length," ",Ct.length===1?"card":"cards"," found  ",s.jsxs("span",{className:"text-indigo-400",children:["$",Ct.reduce((Ee,He)=>Ee+parseFloat(He.prices?.usd||0)*(He.count||1),0).toFixed(2)]})]}),!P&&!q?s.jsxs("button",{onClick:ne,disabled:I,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-[10px] font-black uppercase tracking-widest transition-all border border-indigo-500/20 ${I?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[s.jsx("svg",{className:`w-3 h-3 ${I?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),I?"Syncing...":"Sync Prices"]}):s.jsxs("div",{className:"flex items-stretch bg-indigo-500/10 rounded-full border border-indigo-500/20 overflow-hidden",children:[s.jsxs("button",{onClick:ne,disabled:I,className:`flex items-center gap-1.5 px-3 py-1.5 text-indigo-400 text-[10px] font-black uppercase tracking-widest hover:bg-indigo-500/10 transition-colors ${I?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[s.jsx("svg",{className:`w-3 h-3 ${I?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),I?"Syncing...":"Sync Prices"]}),s.jsx("div",{className:"w-px h-3 bg-indigo-500/20 self-center"}),s.jsxs("div",{className:"flex items-stretch",children:[s.jsx("button",{onClick:$,disabled:!P,className:"px-2 flex items-center justify-center hover:bg-indigo-500/10 text-indigo-400 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Undo (Ctrl+Z)",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),s.jsx("div",{className:"w-px h-3 bg-indigo-500/20 self-center"}),s.jsx("button",{onClick:k,disabled:!q,className:"px-2 flex items-center justify-center hover:bg-indigo-500/10 text-indigo-400 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Redo (Ctrl+Shift+Z)",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})})})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 md:gap-3 w-full md:w-auto items-center justify-between md:justify-end",children:[s.jsx(K1e,{mode:ee,onChange:Ee=>{se(Ee),Y(null),Ee==="folder"&&(vn(t?.subscription_tier).features.binders||W("smart"))}}),!c&&s.jsx(s.Fragment,{children:s.jsxs("div",{ref:Pe,className:"relative",onMouseEnter:()=>{ct.current&&(clearTimeout(ct.current),ct.current=null),Xe(!0)},onMouseLeave:()=>{xt||(ct.current=setTimeout(()=>{Xe(!1)},400))},children:[s.jsxs("button",{onClick:()=>{Ae(!xt),Xe(!0)},className:`flex items-center gap-3 px-6 py-3 rounded-2xl border transition-all duration-300 shadow-xl ${xt?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-900 border-white/10 text-gray-400 hover:text-white hover:border-indigo-500/50 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex -space-x-1.5 items-center",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})})]}),s.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:xt?"Close":"Tools"})]}),Ge&&s.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[100] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Adding Cards"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>{Q(!0),Xe(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Manual Add"})]}),s.jsxs("button",{onClick:()=>{Ne(!0),Xe(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group lg:min-h-[64px]",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Forge Lens"})]}),s.jsxs("button",{onClick:()=>{Ce(!0),Xe(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-gray-800 rounded-xl border border-white/5 transition-all group col-span-2",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Bulk Paste / Import"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5 overflow-hidden",children:[s.jsxs("button",{onClick:()=>{if(!vn(t?.subscription_tier).features.binders){e("Custom Binders are available on Wizard tier and above.","info");return}we(!0),Xe(!1)},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${vn(t?.subscription_tier).features.binders?"hover:bg-indigo-500/10":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"New Binder"})]}),!vn(t?.subscription_tier).features.binders&&s.jsx("span",{className:"text-[8px] bg-indigo-500/20 text-indigo-400 px-1.5 py-0.5 rounded leading-none",children:"WIZARD"})]}),s.jsxs("button",{onClick:()=>{if(!vn(t?.subscription_tier).features.collectionAudit){e("Collection Organization tools are available on Wizard tier.","info");return}Nt(!0),Xe(!1)},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${vn(t?.subscription_tier).features.collectionAudit?"hover:bg-purple-500/10":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Organize Collection"})]}),!vn(t?.subscription_tier).features.collectionAudit&&s.jsx("span",{className:"text-[8px] bg-purple-500/20 text-purple-400 px-1.5 py-0.5 rounded leading-none",children:"WIZARD"})]}),s.jsxs("button",{onClick:()=>{oe(!0),Xe(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-gray-800 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Binder Guide"})]})]})]})]})})]})})]})]}),x&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-3xl p-8 text-center backdrop-blur-md",children:[s.jsx("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Failed to load collection"}),s.jsx("p",{className:"text-red-200 mb-6",children:x.message||"Something went wrong while fetching your cards."}),s.jsx("button",{onClick:()=>m(),className:"px-6 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-900/20",children:"Try Again"})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-4 md:p-6 backdrop-blur-md shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 md:gap-4 mb-6 justify-between",children:[s.jsxs("div",{className:"flex gap-2 flex-wrap flex-1",children:[s.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[s.jsx("input",{type:"text",placeholder:"Search cards...",value:C,onChange:Ee=>A(Ee.target.value),className:"w-full bg-gray-900/50 border border-gray-700 text-white px-4 py-2.5 md:py-3 pl-10 md:pl-12 pr-10 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-gray-500 font-medium text-sm h-10 md:h-12"}),s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 absolute left-3 md:left-4 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),C&&s.jsx("button",{onClick:()=>A(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("select",{value:o,onChange:Ee=>{l(Ee.target.value),Y(null)},className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 whitespace-nowrap h-10 md:h-12",children:[s.jsx("option",{value:"me",children:"My Collection"}),s.jsx("option",{value:"all",children:"All Linked Collections"}),i.map(Ee=>s.jsxs("option",{value:Ee.id,children:[Ee.name,"'s Collection"]},Ee.id))]}),s.jsxs("select",{value:kt,onChange:Ee=>Ue(Ee.target.value),className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 h-10 md:h-12",children:[s.jsx("option",{value:"added_at",children:"Date Added"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"}),u&&s.jsx("option",{value:"owner",children:"Owner"})]}),s.jsx("button",{onClick:()=>zt(Bt==="asc"?"desc":"asc"),className:"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white px-3 py-2 md:px-4 md:py-3 rounded-xl transition-all h-10 md:h-12",title:`Sort Order: ${Bt.toUpperCase()} `,children:Bt==="asc"?s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}):s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})})}),s.jsxs("button",{onClick:()=>T(!F),className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${F?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Filters"})]})]}),ee==="folder"&&!U&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-1 rounded-xl flex self-start overflow-hidden",children:[s.jsxs("button",{onClick:()=>{if(!vn(t?.subscription_tier).features.binders){e(`Custom Binders are available on ${Cs[Jt.TIER_2].name} tier.`,"info");return}W("binders")},className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${J==="binders"?"bg-indigo-600 text-white":vn(t?.subscription_tier).features.binders?"text-gray-500 hover:text-gray-300":"text-gray-600 cursor-not-allowed opacity-60"}`,children:["Binders",!vn(t?.subscription_tier).features.binders&&s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),s.jsx("button",{onClick:()=>W("smart"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${J==="smart"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Smart"}),s.jsx("button",{onClick:()=>W("custom"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${J==="custom"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Tags"})]})})]}),F&&s.jsx("div",{className:"mb-8 p-6 bg-gray-900/50 rounded-2xl border border-gray-800 space-y-6 animate-fade-in-down",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(Ee=>s.jsxs("button",{onClick:()=>Yt("colors",Ee),className:`
w-8 h-8 rounded-full border flex items-center justify-center transition-all transform hover:scale-110
                                                    ${Ve.colors.includes(Ee)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 shadow-lg scale-110":"opacity-60 hover:opacity-100"}
                                                    ${Ee==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                                    ${Ee==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                                    ${Ee==="B"?"bg-[#1F2937] text-white border-gray-600":""}
                                                    ${Ee==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                                    ${Ee==="G"?"bg-[#10B981] text-white border-green-600":""}
                                                    ${Ee==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                                    ${Ee==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
`,title:Ee==="C"?"Colorless":Ee==="M"?"Multicolor":Ee,children:[Ee!=="M"&&Ee!=="C"&&s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Ee}.svg`,alt:Ee,className:"w-4 h-4"}),Ee==="M"&&s.jsx("span",{className:"font-bold text-xs",children:"M"}),Ee==="C"&&s.jsx("span",{className:"font-bold text-xs",children:"C"})]},Ee))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(Ee=>s.jsx("button",{onClick:()=>Yt("rarity",Ee),className:`
                                                    px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                    ${Ve.rarity.includes(Ee)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                `,children:Ee},Ee))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(Ee=>s.jsx("button",{onClick:()=>Yt("types",Ee),className:`
                                                     px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                     ${Ve.types.includes(Ee)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                 `,children:Ee},Ee))})]}),s.jsxs("div",{className:"col-span-1 space-y-4",children:[s.jsx(S1,{label:"Sets",options:Xt,selected:Ve.sets,onChange:Ee=>lt({...Ve,sets:Ee})}),u&&s.jsx(S1,{label:"Card Owner",options:qt,selected:Ve.users,onChange:Ee=>lt({...Ve,users:Ee})}),s.jsx(S1,{label:"Filter by Deck",options:Ht,selected:Ve.decks,onChange:Ee=>lt(He=>({...He,decks:Ee})),placeholder:"All Decks"})]})]})}),x?s.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-8 rounded-2xl text-center",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Collection"}),s.jsx("p",{children:x.message})]}):s.jsxs(s.Fragment,{children:[ee==="folder"&&!Be&&s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 animate-fade-in",children:[Tt.map(Ee=>s.jsxs("div",{onClick:()=>Y(Ee.id),className:"bg-gray-900/40 hover:bg-gray-800/60 border border-white/5 hover:border-indigo-500/30 rounded-2xl p-4 md:p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-2 md:gap-3 backdrop-blur-sm relative overflow-hidden",children:[s.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 bg-${Ee.color}-500/10 rounded-full blur-3xl`}),s.jsx("div",{className:"flex gap-1 mb-1 md:mb-2 group-hover:scale-110 transition-transform",children:Ee.pips?Ee.pips.map((He,Mt)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${He}.svg`,alt:He,className:"w-6 h-6 md:w-8 md:h-8 drop-shadow-md transition-transform group-hover:scale-110"},Mt)):Ee.icon&&Ee.icon.startsWith("ms-")?s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ee.color}-900/30 text-${Ee.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:s.jsx("i",{className:`ms ${Ee.icon} ms-cost`})}):s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${Ee.color}-900/30 text-${Ee.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:Ee.icon})}),s.jsxs("div",{className:"z-10 px-2 mt-4",children:[s.jsx("div",{className:"text-[10px] uppercase tracking-tighter text-indigo-400 font-black mb-1",children:Ee.theme||Ee.sub}),s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors leading-tight",children:Ee.label}),Ee.flavor&&s.jsxs("p",{className:"text-[10px] text-gray-500 italic mt-2 font-serif px-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity",children:['"',Ee.flavor,'"']}),Ee.ownerName&&s.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 bg-gray-950/80 text-gray-300 text-[9px] font-bold px-2 py-1 rounded-full border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),Ee.ownerName]})]}),s.jsxs("span",{className:"mt-4 px-3 py-1 bg-black/30 rounded-full text-xs font-mono text-gray-400 border border-white/5",children:[Ee.cards.length," cards"]})]},Ee.id)),Tt.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards match your filter criteria."})]}),ee==="folder"&&Be&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>Y(null),className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[Be.icon," ",Be.label]}),Be.type==="binder"&&s.jsx("button",{onClick:()=>{const Ee=v.find(He=>He.id===parseInt(U.replace("binder-","")));dt(Ee),we(!0)},className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-indigo-400 hover:text-white transition-colors",title:"Edit Binder Rules",children:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),Be.type==="binder"&&s.jsx(Uw,{type:"binder",targetId:U.replace("binder-",""),label:"Audit",className:"text-xs bg-gray-800 border-gray-700 hover:bg-gray-700 hover:text-white py-2"})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:Be.cards.map(Ee=>s.jsx("div",{className:"h-full",children:s.jsx(vm,{card:Ee,decks:N,currentUser:t,showOwnerTag:u,onRemove:X})},Ee.firestoreId||Ee.id))})]}),ee==="grid"&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 animate-fade-in",children:[Lt.map(Ee=>s.jsx("div",{className:"h-full",children:s.jsx(vm,{card:Ee,decks:N,currentUser:t,showOwnerTag:u,onRemove:X})},Ee.firestoreId||Ee.id)),Ct.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards found."})]})}),ee==="table"&&s.jsx("div",{className:"animate-fade-in",children:s.jsx(Y1e,{cards:Ct,isMixed:u})})]})]})]}),s.jsx(O6,{isOpen:ve,onClose:()=>Q(!1),onAddCard:G,onOpenForgeLens:()=>{Q(!1),Ne(!0)}}),s.jsx(X1e,{isOpen:pe,onClose:()=>Ce(!1)}),s.jsx(z6,{isOpen:Te,onClose:()=>oe(!1)}),s.jsx(jw,{isOpen:ot,onClose:()=>Ne(!1),onFinish:async(Ee,He={})=>{if(Ee.length)try{const{targetDeckId:Mt,additionMode:Gt}=He,Zt=Ee.map(Vt=>({name:Vt.name,scryfall_id:Vt.scryfall_id,set_code:Vt.set_code,collector_number:Vt.collector_number,image_uri:Vt.data.image_uri||Vt.image||Vt.data.image_uris?.normal||Vt.data.card_faces?.[0]?.image_uris?.normal,count:Vt.quantity,data:Vt.data,is_wishlist:Vt.is_wishlist,finish:Vt.finish||"nonfoil",deck_id:Mt||null,tags:[]})),Ut=Gt==="transfer"?"transfer_to_deck":"merge";await Ze.batchAddToCollection(Zt,Ut);const It=Mt?"deck":"collection";e(`Successfully ${Gt==="transfer"?"moved":"added"} ${Ee.length} cards to ${It}!`,"success"),m()}catch(Mt){console.error("Forge Lens Add Failed",Mt),e("Failed to add scanned cards.","error")}}}),s.jsx(e2e,{isOpen:je,editingBinder:bt,onClose:()=>{if(we(!1),dt(null),j(),U&&U.startsWith("binder-")){const Ee=U.replace("binder-","");ue(!0),Ze.getBinderCards(Ee).then(ce).finally(()=>ue(!1))}}}),ee==="grid"&&Ct.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"hidden md:block fixed bottom-0 left-0 right-0 z-[55] bg-gray-950/95 backdrop-blur-xl border-t border-white/10 shadow-[0_-10px_40px_rgba(0,0,0,0.5)]",children:s.jsx("div",{className:"max-w-[1600px] mx-auto px-6 pr-24 py-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"text-sm text-gray-400 font-medium whitespace-nowrap",children:["Showing ",(Ot-1)*$t+1," - ",Math.min(Ot*$t,Ct.length)," of ",Ct.length," cards"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>Et(1),disabled:Ot===1,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"First Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>Et(Ee=>Math.max(1,Ee-1)),disabled:Ot===1,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Previous Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,Ft)},(Ee,He)=>{let Mt;return Ft<=5||Ot<=3?Mt=He+1:Ot>=Ft-2?Mt=Ft-4+He:Mt=Ot-2+He,s.jsx("button",{onClick:()=>Et(Mt),className:`min-w-[2.5rem] px-3 py-2 rounded-lg font-bold text-sm transition-all ${Ot===Mt?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700"}`,children:Mt},Mt)})}),s.jsx("button",{onClick:()=>Et(Ee=>Math.min(Ft,Ee+1)),disabled:Ot===Ft,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Next Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),s.jsx("button",{onClick:()=>Et(Ft),disabled:Ot===Ft,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Last Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),s.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx("label",{className:"text-sm text-gray-400 font-medium",children:"Per page:"}),s.jsxs("select",{value:$t,onChange:Ee=>{At(parseInt(Ee.target.value)),Et(1)},className:"bg-gray-800 border border-gray-700 text-white px-3 py-2 rounded-lg font-bold text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"}),s.jsx("option",{value:200,children:"200"})]})]})]})})}),s.jsx("div",{className:"md:hidden fixed bottom-16 left-0 right-0 z-[55] bg-gray-950/95 backdrop-blur-xl border-t border-white/10 shadow-[0_-10px_40px_rgba(0,0,0,0.5)]",children:s.jsx("div",{className:"px-4 pr-24 py-3",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-xs text-gray-400 font-medium",children:["Page ",Ot," of ",Ft]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>Et(Ee=>Math.max(1,Ee-1)),disabled:Ot===1,className:"px-2.5 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 active:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Previous",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("div",{className:"text-xs font-bold text-white bg-indigo-600 px-3 py-2 rounded-lg min-w-[3rem] text-center",children:Ot}),s.jsx("button",{onClick:()=>Et(Ee=>Math.min(Ft,Ee+1)),disabled:Ot===Ft,className:"px-2.5 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 active:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Next",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),s.jsxs("select",{value:$t,onChange:Ee=>{At(parseInt(Ee.target.value)),Et(1)},className:"bg-gray-800 border border-gray-700 text-white px-2 py-2 rounded-lg font-bold text-xs focus:outline-none",children:[s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"}),s.jsx("option",{value:200,children:"200"})]})]})})})]}),s.jsx(IH,{isOpen:De,onClose:()=>Nt(!1),onComplete:()=>{Nt(!1),window.location.reload()}})]})},JM=t=>{if(!t)return null;const e=t.data||t;return e.image_uris?.art_crop?e.image_uris.art_crop:e.card_faces?.[0]?.image_uris?.art_crop?e.card_faces[0].image_uris.art_crop:e.image_uris?.normal?e.image_uris.normal:null},s2e=t=>{const e=t?.commander?.color_identity||[],r=t?.commander_partner?.color_identity||[],n=[...new Set([...e,...r])];return n.length>0?n:["C"]},i2e=b.memo(function({deck:e}){const r=dn(),n=s2e(e),i=d2(n),a=parseInt(e.card_count||0),o=JM(e.commander),l=JM(e.commander_partner);return s.jsx("div",{onClick:()=>r(`/decks/${e.id}`),className:"group relative flex flex-col h-[420px] rounded-3xl transition-all duration-300 hover:-translate-y-2 cursor-pointer",children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[60%] w-full relative overflow-hidden bg-gray-950 shrink-0",children:[e.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:o||"https://placehold.co/400x600?text=?",alt:e.commander?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:l||"https://placehold.co/400x600?text=?",alt:e.commander_partner?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]})]}):o?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:o,alt:e.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("svg",{className:"w-16 h-16 text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1 z-10",children:[e.tags&&e.tags.includes("Precon")&&s.jsx("div",{className:"px-2 py-1 bg-teal-500/20 text-teal-400 border border-teal-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Precon"}),e.is_mockup&&s.jsx("div",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 border border-orange-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Mockup"})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 pointer-events-none group-hover:pointer-events-auto",children:s.jsx(br,{to:`/solitaire/${e.id}`,onClick:c=>c.stopPropagation(),className:"transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300 bg-amber-600/90 hover:bg-amber-500 text-white p-4 rounded-full shadow-2xl backdrop-blur-sm border 2 border-white/20 flex flex-col items-center gap-1",title:"Play Solitaire",children:s.jsx("svg",{className:"w-8 h-8 ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 5v14l11-7z"})})})})]}),s.jsxs("div",{className:"h-[40%] p-5 flex flex-col justify-between relative grow",children:[s.jsx("div",{className:"absolute -top-3 left-5 flex gap-1 bg-gray-900/80 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:(e.format?.toLowerCase()==="standard"?e.colors||[]:n).map(c=>{const u=`https://svgs.scryfall.io/card-symbols/${c}.svg`;return s.jsx("img",{src:u,alt:c,className:"w-4 h-4 shadow-sm"},c)})}),(e.ai_blueprint?.grade?.powerLevel>0||e.aiBlueprint?.grade?.powerLevel>0)&&s.jsxs("div",{className:"absolute -top-3 right-5 flex items-center gap-1.5 bg-gray-900 backdrop-blur-md rounded-full px-3 py-1 border border-white/10 shadow-xl group-hover:border-indigo-500/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-indigo-400 tracking-wider",children:"B"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:e.ai_blueprint?.grade?.commanderBracket||e.aiBlueprint?.grade?.commanderBracket||"?"})]}),s.jsx("div",{className:"w-px h-2.5 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-teal-400 tracking-wider",children:"PWR"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:Number(e.ai_blueprint?.grade?.powerLevel||e.aiBlueprint?.grade?.powerLevel).toFixed(1)})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-1 opacity-80",children:i.badge}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:e.name||"Untitled Deck"}),s.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:e.commander_partner?`${e.commander?.name} & ${e.commander_partner?.name}`:e.commander?.name||"No Commander"})]}),s.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4 mt-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Format"}),s.jsx("span",{className:"text-xs text-gray-300 font-medium",children:e.format||"Commander"})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Cards"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${a>=(e.format?.toLowerCase()==="standard"?60:100)?"text-green-500":"text-indigo-400"}`,children:[a,s.jsxs("span",{className:"text-gray-600 text-[10px]",children:["/",e.format?.toLowerCase()==="standard"?"60":"100"]})]})]})]})]})]})})}),MC=b.memo(function({title:e,decks:r,loading:n,error:i,isOwner:a=!1}){const[o,l]=b.useState(!1),c=o?r:r.slice(0,4),u=r.length>4;return n?s.jsxs("div",{className:"mb-12",children:[s.jsx("div",{className:"h-8 w-48 bg-gray-800 rounded-lg animate-pulse mb-6"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(f=>s.jsx("div",{className:"h-[420px] bg-gray-900 rounded-3xl animate-pulse"},f))})]}):i?s.jsx("div",{className:"mb-12 p-6 bg-red-900/20 border border-red-500/50 rounded-2xl",children:s.jsx("h3",{className:"text-red-400 font-bold",children:"Error loading decks"})}):r.length===0?null:s.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:[e,s.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:r.length})]})}),u&&s.jsxs("button",{onClick:()=>l(!o),className:"text-indigo-400 hover:text-indigo-300 text-sm font-bold uppercase tracking-wider transition-colors flex items-center gap-2",children:[o?"Show Less":`Show All (${r.length})`,s.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:c.map(f=>s.jsx(i2e,{deck:f},f.id))}),a&&r.length===0&&s.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 mb-6",children:"You haven't built any decks yet."}),s.jsx(br,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]})}),a2e=Ke.memo(({friend:t})=>{const{decks:e,loading:r,error:n}=hf(t.owner_id),i=t.owner?.username||t.owner_username||"Unknown Friend";return!r&&!n&&e.length===0?null:s.jsx(MC,{title:`Decks by ${i}`,decks:e,loading:r,error:n,isOwner:!1})}),ZM={getPrice(t,e="usd"){if(!t)return 0;let r=null;return t.prices&&t.prices[e]&&(r=t.prices[e]),r?parseFloat(r):0},getDeckValue(t=[],e="usd"){let r=0,n=0,i=null;const a={bulk:0,budget:0,mid:0,high:0,premium:0};return t.map(o=>{const l=this.getPrice(o,e);return r+=l*(o.quantity||1),l>n&&(n=l,i=o),l<1?a.bulk+=o.quantity||1:l<5?a.budget+=o.quantity||1:l<20?a.mid+=o.quantity||1:l<50?a.high+=o.quantity||1:a.premium+=o.quantity||1,{...o,price:l}}),{total:parseFloat(r.toFixed(2)),max:parseFloat(n.toFixed(2)),maxCard:i,average:t.length?parseFloat((r/t.length).toFixed(2)):0,distribution:a,currency:e}},generateTCGPlayerLink(t,e="MTGLibrary"){if(!t||t.length===0)return"";const r=t.map(a=>`${a.quantity||1} ${a.name}`).join("||"),n="https://store.tcgplayer.com/massentry",i=new URLSearchParams({partner:e,utm_campaign:"affiliate",utm_medium:"mtglibrary",utm_source:"MTGLibrary",c:r});return`${n}?${i.toString()}`}};function RH(t=[]){const e=b.useMemo(()=>!t||t.length===0?null:ZM.getDeckValue(t),[t]),r=b.useMemo(()=>ZM.generateTCGPlayerLink(t),[t]);return{value:e,tcgPlayerLink:r}}const o2e=()=>{const{cards:t,loading:e}=To(),{value:r}=RH(t),n=b.useMemo(()=>t?[...t].sort((o,l)=>(l.currPrice||0)*(l.quantity||1)-(o.currPrice||0)*(o.quantity||1)).slice(0,5):[],[t]);if(e)return s.jsx("div",{className:"animate-pulse h-12 bg-gray-900 rounded-xl"});const i=Math.random()>.5?"up":"down",a=(Math.random()*5).toFixed(1);return s.jsxs("div",{className:"bg-gray-900/50 border border-white/5 rounded-2xl p-4 flex flex-col md:flex-row items-center justify-between gap-6 overflow-hidden relative",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2"}),s.jsxs("div",{className:"flex-shrink-0 flex items-center gap-4 z-10",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Collection Value"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-mono font-bold text-white",children:["$",r?.total?.toFixed(2)||"0.00"]}),s.jsxs("span",{className:`text-xs font-bold ${i==="up"?"text-green-500":"text-red-500"} flex items-center`,children:[i==="up"?"":""," ",a,"%"]})]})]})]}),s.jsx("div",{className:"hidden md:block w-px h-10 bg-white/10"}),s.jsx("div",{className:"flex-grow overflow-hidden w-full relative z-10",children:s.jsxs("div",{className:"flex gap-6 animate-scroll-subtle hover:pause-scroll",children:[n.map(o=>s.jsxs("div",{className:"flex items-center gap-2 group flex-shrink-0 cursor-pointer",children:[s.jsx("div",{className:"w-8 h-8 rounded overflow-hidden relative border border-white/10 group-hover:border-indigo-500 transition-colors",children:s.jsx("img",{src:o.image_uris?.small||o.image_uri,className:"w-full h-full object-cover",alt:""})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate flex-grow min-w-0",children:o.name}),s.jsxs("div",{className:"text-[10px] font-mono text-emerald-400",children:["$",((o.currPrice||0)*(o.quantity||1)).toFixed(2)]})]})]},o.id||o.firestoreId)),n.length===0&&s.jsx("div",{className:"text-xs text-gray-500 italic",children:"Add cards to see market analysis"})]})}),s.jsx("style",{children:`
                .pause-scroll:hover {
                     animation-play-state: paused;
                }
            `})]})},l2e=()=>{const{user:t,userProfile:e}=Sr(),{addToast:r}=wn(),[n,i]=b.useState([]),{decks:a,loading:o,error:l}=hf(null);b.useEffect(()=>{t&&(async()=>{try{const f=await wa.fetchIncomingPermissions(),p=(Array.isArray(f)?f:[]).filter(x=>!x.target_deck_id);i(p)}catch(f){console.error("Failed to load shared sources",f)}})()},[t]);const c=u=>{const f=Cs[e?.subscription_tier||"free"].limits.decks,p=a?.length||0;f!==1/0&&p>=f&&(u.preventDefault(),r(`Deck limit reached (${p}/${f}). Upgrade to create more!`,"error"))};return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-10 relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-12",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"My Strategies"}),s.jsx("p",{className:"text-gray-400 font-medium",children:"Manage your collection and view shared decks."})]}),s.jsxs(br,{to:"/decks/new",onClick:c,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400",children:[s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"Create New Deck"]})]}),s.jsx("div",{className:"mb-8",children:s.jsx(o2e,{})}),s.jsx(MC,{title:"My Decks",decks:a,loading:o,error:l,isOwner:!0}),n.length>0&&s.jsxs("div",{className:"mt-16 border-t border-white/5 pt-12",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-500 uppercase tracking-widest mb-8 flex items-center gap-4",children:[s.jsx("span",{className:"h-px bg-gray-800 flex-1"}),"Shared Libraries",s.jsx("span",{className:"h-px bg-gray-800 flex-1"})]}),s.jsx("div",{className:"space-y-4",children:n.map(u=>s.jsx(a2e,{friend:u},u.id))})]})]})]})},za={async addCardToDeck(t,e,r){return Ze.post("/api/collection",{scryfall_id:r.id,name:r.name,set_code:r.set||r.set_code,collector_number:r.collector_number,finish:r.finish||"nonfoil",data:r,deck_id:e,count:1})},async batchAddCardsToDeck(t,e,r,n="merge"){const i=r.map(a=>({...a,deck_id:e}));return Ze.batchAddToCollection(i,n)},async removeCardFromDeck(t,e,r){return Ze.put(`/api/collection/${r}`,{deck_id:null})},async updateCardQuantity(t,e,r,n){return n<=0?this.removeCardFromDeck(t,e,r):Ze.put(`/api/collection/${r}`,{count:n})},async setCommander(t,e,r){return Ze.put(`/api/decks/${e}`,{commander:r})},async importDeck(t,e,r,n){return Ze.post("/api/decks/import",{deck:e,cards:r,options:n})},async createDeck(t,e){return Ze.post("/api/decks",e)},async updateDeck(t,e,r){return Ze.put(`/api/decks/${e}`,r)},async deleteDeck(t,e,r={}){const n=new URLSearchParams(r).toString();return Ze.delete(`/api/decks/${e}?${n}`)},async batchRemoveCards(t,e,r,n="remove"){return Ze.delete(`/api/decks/${e}/cards?action=${n}`,{cardIds:r})}},c2e=()=>{const{decks:t,loading:e,refresh:r}=hf(),{currentUser:n,userProfile:i}=Sr(),{addToast:a}=wn();dn();const[o,l]=b.useState(!1),c=t.filter(f=>f.format==="binder"),u=async()=>{l(!0);try{const f=Cs[i?.subscription_tier||"free"];if(c.length>=(f?.limits?.binders||5)){a(`Upgrade to create more binders! (Limit: ${f?.limits?.binders||5})`,"error");return}const p=`New Binder ${c.length+1}`,x=await za.createDeck(n.uid,{name:p,format:"binder",description:"A dedicated trade binder.",isPublic:!0});await r(),a("Binder created!","success")}catch(f){console.error(f),a("Failed to create binder.","error")}finally{l(!1)}};return e?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):s.jsx("div",{className:"min-h-screen bg-[#0B0C15] pb-24 relative overflow-hidden",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-10",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white tracking-tight mb-2",children:s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Armory"})}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"Manage your trade binders and share your collection with the community."})]}),s.jsxs("button",{onClick:u,disabled:o,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?s.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"New Binder"]})]}),c.length>0?s.jsx(MC,{title:"Your Binders",decks:c,canCreate:!1}):s.jsxs("div",{className:"text-center py-24 bg-gray-900/30 rounded-3xl border border-dashed border-gray-700",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Binders Yet"}),s.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"Create a binder to start organizing your trades or showcased cards separately from your playable decks."}),s.jsx("button",{onClick:u,className:"text-indigo-400 hover:text-indigo-300 font-bold uppercase tracking-widest text-xs hover:underline",children:"Create your first binder"})]})]})})},d2e=({isOpen:t,onClose:e,onAdd:r})=>{const{addToast:n}=wn(),[i,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState([]),[f,p]=b.useState(null),[x,m]=b.useState(!1),[y,v]=b.useState([]),[j,N]=b.useState("and"),[C,A]=b.useState(""),[L,O]=b.useState(""),F=$=>{v(k=>k.includes($)?k.filter(R=>R!==$):[...k,$])},T=async $=>{$.preventDefault();const k=y.length>0||C.trim()||L.trim();if(!(!i.trim()&&!k)){l(!0);try{let R=null;if(L.trim()){const X=L.trim().match(/^([<>]=?|=)?\s*(\d+)$/);X&&(R={operator:X[1]||"=",value:parseInt(X[2],10)})}const P={query:i,type:"legendary creature",text:C,colors:y.length>0?y:void 0,colorIdentity:!0,colorLogic:j,mv:R},q=await Ze.post("/api/cards/search",P);u(q.data||[])}catch(R){console.error(R),n("Search failed. The Oracle is unreachable.","error")}finally{l(!1)}}},I=async $=>{p({id:$.id,name:$.name});try{const k={scryfall_id:$.id,name:$.name,set_code:$.set,collector_number:$.collector_number,finish:"nonfoil",count:1,data:$,is_wishlist:!0};await Ze.post("/api/collection",k),n(`"${$.name}" added to Wishlist!`,"success"),r&&r(),e()}catch(k){console.error(k),n("Failed to add to wishlist.","error")}finally{p(null)}};if(!t)return null;const B={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"}};return Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gray-950/50 flex justify-between items-center shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-purple-400",children:"Summon Legend"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-300 uppercase tracking-wider border border-purple-500/30",children:"Wishlist"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the multiverse for a commander you don't own yet."})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"bg-gray-900 border-b border-white/5 flex flex-col shrink-0",children:s.jsxs("form",{onSubmit:T,className:"p-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",value:i,onChange:$=>a($.target.value),placeholder:"Search by name...",className:"w-full bg-gray-950 border border-white/10 rounded-2xl py-4 pl-14 pr-14 text-lg text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all shadow-inner",autoFocus:!x}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>a(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("button",{type:"button",onClick:()=>m(!x),className:`px-4 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${x?"bg-purple-600 text-white border-purple-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(OF,{className:"w-5 h-5"}),"Filters"]}),s.jsx("button",{type:"submit",disabled:o,className:"px-8 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-2xl transition-all disabled:opacity-50 shadow-lg shadow-purple-500/20",children:o?"Searching...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${x?"max-h-96 opacity-100 mt-6":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Color Identity"}),s.jsx("div",{className:"flex gap-2",children:Object.entries(B).map(([$,k])=>s.jsx("button",{type:"button",onClick:()=>F($),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${y.includes($)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:y.includes($)?"transparent":""},children:s.jsx("img",{src:k.symbol,alt:$,className:`w-full h-full ${y.includes($)?"drop-shadow-md":"grayscale"}`})},$))}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[s.jsx("span",{className:`cursor-pointer ${j==="or"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>N("or"),children:"Includes any (OR)"}),s.jsx("div",{className:"w-10 h-5 bg-gray-800 rounded-full relative cursor-pointer border border-white/10",onClick:()=>N($=>$==="or"?"and":"or"),children:s.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-purple-500 transition-all ${j==="and"?"left-5.5":"left-0.5"}`})}),s.jsx("span",{className:`cursor-pointer ${j==="and"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>N("and"),children:"Exact match (AND)"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Oracle Text"}),s.jsx("input",{type:"text",value:C,onChange:$=>A($.target.value),placeholder:"e.g. 'draw cards', 'counter'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm"}),s.jsx("p",{className:"text-[10px] text-gray-600",children:"Searches abilities and rules text."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Mana Value (CMC)"}),s.jsx("input",{type:"text",value:L,onChange:$=>O($.target.value),placeholder:"e.g. '4' or '<= 3'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm font-mono"})]})]})})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-950/30 custom-scrollbar",children:[!o&&c.length===0&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),s.jsx("p",{className:"text-xl font-bold text-gray-400",children:"No legends found."}),s.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map($=>{const k=$.image_uris?.art_crop||$.image_uris?.normal||$.data?.image_uris?.art_crop||$.data?.image_uris?.normal,R=f?.id===$.id;return s.jsxs("div",{className:"group relative bg-gray-900 rounded-2xl border border-white/5 overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-2xl hover:shadow-purple-500/10 hover:-translate-y-1",children:[s.jsxs("div",{className:"h-60 w-full bg-black relative",children:[k?s.jsx("img",{src:k,alt:$.name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-500"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 font-bold",children:"No Art"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent"})]}),s.jsxs("div",{className:"p-4 relative",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-300 transition-colors line-clamp-1",children:$.name}),s.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-1",children:$.type_line}),s.jsx("button",{onClick:()=>I($),disabled:R,className:"w-full py-2 bg-white/5 hover:bg-purple-600 text-gray-300 hover:text-white rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 group-hover:bg-purple-600 group-hover:text-white",children:R?s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Wishlist"]})})]})]},$.id)})})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(168, 85, 247, 0.4); }
            `}})]}),document.body)};class HS{static parseText(e){if(!e||typeof e!="string")return{mainboard:[],sideboard:[],errors:["Empty input"]};const r=e.split(/\r?\n/).map(a=>a.trim()).filter(a=>a),n={mainboard:[],sideboard:[],errors:[]};let i="mainboard";return r.forEach(a=>{if(a.toLowerCase()==="deck"||a.toLowerCase()==="mainboard"){i="mainboard";return}if(a.toLowerCase()==="sideboard"||a.toLowerCase()==="commander"){i="sideboard";return}const o=this.parseLine(a);o?n[i].push(o):a.length>2&&n.errors.push(`Could not parse line: "${a}"`)}),n.mainboard=this.consolidate(n.mainboard),n.sideboard=this.consolidate(n.sideboard),n}static parseLine(e){const r=/^(\d+)[xX]?\s+(.+)\s+\(([A-Za-z0-9]{3,4})\)\s*(\d+)?/,n=e.match(r);if(n)return{quantity:parseInt(n[1],10),name:n[2].trim(),set:n[3].toUpperCase(),collectorNumber:n[4]||null,isFoil:e.toLowerCase().includes(" *f*")};const i=/^(\d+)[xX]?\s+(.+)/,a=e.match(i);if(a){let o=a[2].trim(),l=null;const c=o.match(/\(([A-Za-z0-9]{3,4})\)$/);return c&&(l=c[1],o=o.replace(c[0],"").trim()),{quantity:parseInt(a[1],10),name:o,set:l,collectorNumber:null}}return/[a-zA-Z]/.test(e)?{quantity:1,name:e,set:null,collectorNumber:null}:null}static consolidate(e){const r=new Map;return e.forEach(n=>{const i=n.set?`${n.name}|${n.set}|${n.collectorNumber||""}`:n.name;r.has(i)?r.get(i).quantity+=n.quantity:r.set(i,{...n})}),Array.from(r.values())}static async resolveCards(e){if(!e||e.length===0)return[];const r=[],n=75;for(let o=0;o<e.length;o+=n)r.push(e.slice(o,o+n));const i=[],a=[];for(const o of r){const l=o.map(c=>c.set&&c.collectorNumber?{set:c.set,collector_number:c.collectorNumber}:c.set?{name:c.name,set:c.set}:{name:c.name});try{const c=await fetch("https://api.scryfall.com/cards/collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifiers:l})});if(!c.ok)throw new Error("Scryfall API Error");const u=await c.json();u.data.forEach(f=>{const p=o.find(x=>x.set&&x.collectorNumber?x.set.toLowerCase()===f.set&&x.collectorNumber===f.collector_number:x.name.toLowerCase()===f.name.toLowerCase()||f.card_faces&&f.card_faces[0].name.toLowerCase()===x.name.toLowerCase());p&&i.push({...p,scryfall_id:f.id,name:f.name,set_code:f.set,collector_number:f.collector_number,image_uri:f.image_uris?.normal||f.card_faces?.[0]?.image_uris?.normal,data:f})}),u.not_found&&u.not_found.length>0&&u.not_found.forEach(f=>{console.warn("Card not found:",f),a.push(f.name)})}catch(c){console.error("Failed to resolve batch",c)}}return i}static async parseUrl(e){try{const r=await Ze.post("/api/import/url",{url:e});return{mainboard:r.mainboard||[],sideboard:r.sideboard||[],name:r.name,errors:[]}}catch(r){return console.error("URL Import Error",r),{mainboard:[],sideboard:[],errors:[r.response?.data?.error||"Failed to fetch URL"]}}}}const u2e=({isOpen:t,onClose:e,onImport:r})=>{const[n,i]=b.useState(""),[a,o]=b.useState(null),[l,c]=b.useState("paste"),[u,f]=b.useState(""),[p,x]=b.useState(!1),m=async()=>{if(l==="paste"){const j=HS.parseText(n);o(j)}else{x(!0);try{const j=await HS.parseUrl(u);o(j)}finally{x(!1)}}},y=()=>{a&&(r(a),e())},v=()=>{i(""),o(null)};return s.jsx(Zh,{open:t,onClose:e,className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl p-6 shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx(Zh.Title,{className:"text-2xl font-black text-white",children:"Import Deck"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a?s.jsxs("div",{className:"flex flex-col h-[500px]",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-8 flex-1 overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h4",{className:"text-green-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Mainboard (",a.mainboard.reduce((j,N)=>j+N.quantity,0),")"]}),s.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.mainboard.map((j,N)=>s.jsxs("div",{className:"flex justify-between items-center text-sm group",children:[s.jsxs("span",{className:"text-gray-300",children:[s.jsx("span",{className:"font-bold text-white mr-2",children:j.quantity}),j.name]}),j.set&&s.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:j.set})]},N))})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h4",{className:"text-purple-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),"Sideboard / Commander (",a.sideboard.reduce((j,N)=>j+N.quantity,0),")"]}),s.jsx("div",{className:"flex-1 bg-gray-950/50 rounded-xl p-4 overflow-y-auto border border-white/5 space-y-1",children:a.sideboard.length>0?a.sideboard.map((j,N)=>s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsxs("span",{className:"text-gray-300",children:[s.jsx("span",{className:"font-bold text-white mr-2",children:j.quantity}),j.name]}),j.set&&s.jsx("span",{className:"text-xs bg-gray-800 px-1.5 py-0.5 rounded text-gray-500 font-mono",children:j.set})]},N)):s.jsx("div",{className:"h-full flex items-center justify-center text-gray-600 italic",children:"No Sideboard"})})]})]}),a.errors.length>0&&s.jsxs("div",{className:"mt-4 bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[s.jsx("h5",{className:"text-red-400 text-xs font-bold uppercase mb-1",children:"Parse Warnings"}),s.jsx("ul",{className:"text-xs text-red-300/80 list-disc ml-4",children:a.errors.map((j,N)=>s.jsx("li",{children:j},N))})]}),s.jsxs("div",{className:"mt-6 flex justify-between items-center pt-4 border-t border-white/5",children:[s.jsx("button",{onClick:v,className:"text-gray-400 hover:text-white font-medium text-sm",children:" Back to Paste"}),s.jsx("button",{onClick:y,className:"bg-green-600 hover:bg-green-500 text-white px-8 py-2 rounded-xl font-bold shadow-lg shadow-green-500/20",children:"Confirm Import"})]})]}):s.jsxs("div",{className:"flex gap-8 min-h-[400px]",children:[s.jsxs("div",{className:"w-48 flex flex-col gap-2 border-r border-white/5 pr-4",children:[s.jsx("button",{onClick:()=>c("paste"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="paste"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"Paste Text"}),s.jsx("button",{onClick:()=>c("url"),className:`text-left px-4 py-3 rounded-xl font-bold transition-all ${l==="url"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:"From URL"}),s.jsxs("div",{className:"mt-auto p-3 bg-gray-800/50 rounded-lg text-xs text-gray-500",children:["Supports:",s.jsxs("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[s.jsx("li",{children:"Arena Exports"}),s.jsx("li",{children:"MTGO text"}),s.jsx("li",{children:"Moxfield URLs"})]})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col",children:[l==="paste"&&s.jsxs(s.Fragment,{children:[s.jsx("textarea",{value:n,onChange:j=>i(j.target.value),placeholder:`Paste your decklist here...

Example:
1 Sol Ring
1 Command Tower
1 Arcane Signet`,className:"w-full flex-1 bg-gray-950 border border-white/10 rounded-xl p-4 text-gray-300 font-mono text-sm focus:ring-2 focus:ring-indigo-500 outline-none resize-none"}),s.jsx("div",{className:"flex justify-end mt-4",children:s.jsx("button",{onClick:m,disabled:!n.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-6 py-2 rounded-xl font-bold",children:"Parse Deck"})})]}),l==="url"&&s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Import from Website"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Paste a URL from Moxfield, Archidekt, or TappedOut."}),s.jsxs("div",{className:"flex w-full max-w-lg gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:j=>f(j.target.value),placeholder:"https://moxfield.com/decks/...",className:"flex-1 bg-gray-950 border border-white/10 rounded-xl px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),s.jsx("button",{onClick:m,disabled:!u||p,className:"bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-xl font-bold disabled:opacity-50",children:p?"...":"Fetch"})]}),s.jsx("p",{className:"mt-4 text-xs text-green-500/80",children:"Supports Moxfield & Archidekt"})]})]})]})]})]})})},si={BASICS:1,COMMANDER:2,PARTNER:2.5,AI_STRATEGY:3,REVIEW:4},h2e=()=>{const t=dn(),{userProfile:e}=Sr(),{addToast:r}=wn(),[n,i]=b.useState(si.BASICS),[a,o]=b.useState(!1),[l,c]=b.useState("folder"),[u,f]=b.useState({}),[p,x]=b.useState(null),[m,y]=b.useState(""),[v,j]=b.useState("Commander"),[N,C]=b.useState([]),[A,L]=b.useState(null),[O,F]=b.useState(null),[T,I]=b.useState(""),[B,$]=b.useState(""),[k,R]=b.useState(null),[P,q]=b.useState("Consulting the Oracle..."),[X,G]=b.useState(!1),[ne,ee]=b.useState(!1),[se,J]=b.useState([]),[W,U]=b.useState(!0),[Y,te]=b.useState(!1),[ce,xe]=b.useState(!1);b.useEffect(()=>{ue()},[]);const ue=async()=>{try{const Pe=await Ze.get("/api/precons/types");J(Pe)}catch(Pe){console.error("Failed to fetch precon types",Pe)}finally{U(!1)}};b.useEffect(()=>{window.scrollTo(0,0)},[n]);const ve=Pe=>{if(!Pe)return null;const ct=Pe.data||Pe;return ct.image_uris?.art_crop?ct.image_uris.art_crop:ct.card_faces?.[0]?.image_uris?.art_crop?ct.card_faces[0].image_uris.art_crop:ct.image_uris?.normal?ct.image_uris.normal:null},Q=Pe=>{const bt=(Pe.data||Pe).color_identity||[];return bt.length>0?bt:["C"]},pe=(Pe,ct)=>{Pe==="Commander"||Pe==="Standard"?Ce(Pe,ct):console.warn("Unknown format selected")},Ce=async(Pe,ct)=>{o(!0);try{const bt={unused:!0};Pe==="Commander"&&(bt.type_line="legendary creature"),ct||(bt.wishlist="false");const dt=await Ze.get("/api/collection",bt);C(dt),i(si.COMMANDER)}catch(bt){console.error(bt),r("Failed to load cards","error")}finally{o(!1)}},je=Pe=>{if(L(Pe),v==="Standard"){r("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info"),i(si.REVIEW);return}const ct=Pe.data||Pe,bt=ct.keywords||[],dt=ct.oracle_text||"";if(bt.includes("Partner")||dt.includes("Partner"))i(si.PARTNER);else{const lt=vn(e?.subscription_tier).features.aiStrategy;i(lt?si.AI_STRATEGY:si.REVIEW)}},we=Pe=>{F(Pe);const ct=vn(e?.subscription_tier).features.aiStrategy;i(ct?si.AI_STRATEGY:si.REVIEW)},Te=async()=>{if(v==="Standard")return;const Pe=e?.settings?.geminiApiKey,ct=e?.settings?.helper?.name||"The Oracle";if(!Pe){r("AI Key missing. Skipping strategy.","warning"),i(si.REVIEW);return}o(!0),q(`${ct} is analyzing ${O?"your commanders":"your commander"}...`);try{const bt=O?`${A.name} & ${O.name}`:A.name,dt=await yo.getDeckStrategy(Pe,bt,e.playstyle,[],e?.settings?.helper);dt.layout||(dt.layout={functional:{Lands:36,"Mana Ramp":10,"Card Draw":10,Removal:10,"Board Wipes":3,Synergy:30},types:{Creatures:30,Instants:10,Sorceries:10,Artifacts:10,Enchantments:4,Planeswalkers:0,Lands:36}}),R(dt),!m.trim()&&dt.suggestedName&&y(dt.suggestedName),i(si.REVIEW)}catch(bt){console.error(bt),r("AI Generation Failed. Proceeding manually.","error"),R({theme:"",strategy:"Manual strategy required.",layout:{functional:{Lands:36,Creatures:63},types:{Lands:36,Creatures:63}}}),i(si.REVIEW)}finally{o(!1)}},oe=async()=>{o(!0);try{const Pe={name:m||(O?`${A.name} & ${O.name}`:A?.name)||"New Commander Deck",format:v,commander:A?.data||A||null,commanderPartner:O?.data||O||null,aiBlueprint:k?{theme:k.theme,strategy:k.strategy,suggestedCounts:k.layout?.functional||k.layout,typeCounts:k.layout?.types}:null,isMockup:X},ct=await Ze.post("/api/decks",Pe);r("Deck created successfully!","success"),t(`/decks/${ct.id}`)}catch(Pe){console.error(Pe),r("Failed to create deck","error")}finally{o(!1)}},De=async Pe=>{xe(!0),te(!1),r("Resolving cards with Oracle...","info",1e4);try{const ct=[...Pe.mainboard,...Pe.sideboard],bt=await HS.resolveCards(ct);if(bt.length===0){r("No valid cards found to import.","error"),xe(!1);return}const dt={deck:{name:"Imported Deck",format:"Commander",commander:null},cards:bt.map(lt=>({scryfall_id:lt.scryfall_id,name:lt.name,set_code:lt.set_code,collector_number:lt.collector_number,finish:lt.isFoil?"foil":"nonfoil",count:lt.quantity||1,data:lt.data})),options:{checkCollection:!0,addToCollection:!0}},Ve=await Ze.post("/api/decks/import",dt);r(`Deck imported! ${Ve.missingCards?.length?`(${Ve.missingCards.length} missing)`:""}`,"success"),t(`/decks/${Ve.deckId}`)}catch(ct){console.error(ct),r("Import Failed","error")}finally{xe(!1)}};b.useEffect(()=>{n===si.AI_STRATEGY&&A&&!k&&Te()},[n]);const Nt=({card:Pe,onClick:ct,isSelected:bt})=>{const dt=ve(Pe),Ve=Q(Pe),lt=Pe.data||Pe;return s.jsx("div",{onClick:()=>ct(Pe),className:`group relative h-[480px] rounded-3xl cursor-pointer transition-all duration-300 hover:-translate-y-2 ${bt?"ring-4 ring-indigo-500 scale-105":""}`,children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[55%] w-full relative overflow-hidden bg-gray-950",children:[dt?s.jsx("img",{src:dt,alt:Pe.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("span",{className:"text-gray-700 font-bold",children:"No Art"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}),s.jsxs("div",{className:"h-[45%] p-5 flex flex-col relative",children:[s.jsxs("div",{className:"absolute -top-3 left-5 flex gap-2 z-10",children:[s.jsx("div",{className:"flex gap-1 bg-gray-900/90 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:Ve.map((kt,Ue)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${kt}.svg`,alt:kt,className:"w-4 h-4 shadow-sm"},Ue))}),Pe.finish==="foil"&&s.jsx("div",{className:"flex items-center justify-center w-8 h-8 -mt-1 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-[0_0_15px_rgba(250,204,21,0.6)] animate-pulse",title:"Foil",children:s.jsx("svg",{className:"w-5 h-5 text-white drop-shadow-sm",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),s.jsxs("div",{className:"mt-4 flex-1 flex flex-col gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:Pe.name}),s.jsx("p",{className:"text-xs text-gray-400 font-medium line-clamp-1 border-b border-white/5 pb-2 mb-2",children:lt.type_line})]}),s.jsx("p",{className:"text-[10px] text-gray-300 leading-relaxed font-serif opacity-80 line-clamp-4",children:lt.oracle_text})]}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[lt.power&&lt.toughness&&s.jsxs("div",{className:"bg-gray-800/80 px-2 py-1 rounded text-xs font-bold text-white border border-white/10 shadow-inner",children:[lt.power," / ",lt.toughness]}),s.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select"})]})]})]})})},ot=b.useMemo(()=>{if(!N.length)return{};const Pe={};return N.filter(bt=>bt.name.toLowerCase().includes(T.toLowerCase())||(bt.data?.type_line||"").toLowerCase().includes(T.toLowerCase())).forEach(bt=>{const dt=Q(bt),Ve=d2(dt);Pe[Ve.badge]||(Pe[Ve.badge]={identity:Ve,cards:[]}),Pe[Ve.badge].cards.push(bt)}),Pe},[N,T]),Ne=()=>{const Pe=T.trim().length>0,ct=Object.entries(ot).sort((dt,Ve)=>{const lt=dt[1].identity.colors.length-Ve[1].identity.colors.length;return lt!==0?lt:Ve[1].cards.length-dt[1].cards.length}),bt=(dt,Ve,lt)=>s.jsxs("div",{onClick:lt,className:"w-full bg-gray-900/60 hover:bg-gray-800/60 backdrop-blur-md border border-white/5 rounded-2xl p-6 cursor-pointer transition-all flex items-center justify-between group mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-1.5 border border-white/5",children:dt.identity.colors.map(kt=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${kt}.svg`,alt:kt,className:"w-5 h-5 shadow-sm"},kt))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:dt.identity.badge}),s.jsxs("p",{className:"text-sm text-gray-400 italic line-clamp-1",children:['"',dt.identity.flavor,'"']})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[dt.cards.length," ",v==="Commander"?"Legends":"Cards"]}),s.jsx("svg",{className:`w-6 h-6 text-gray-400 transform transition-transform ${Ve?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-4 gap-4 shrink-0",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:v==="Commander"?"Choose Commander":"Choose Spotlight Card"}),s.jsx("p",{className:"text-gray-400",children:v==="Commander"?"Select the legend who will lead your deck.":"Select a card to feature as the face of your deck."})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:()=>ee(!0),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-purple-500/20 flex items-center gap-2 transition-all hover:-translate-y-0.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Database"]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-1 flex border border-white/10",children:[s.jsx("button",{onClick:()=>c("list"),className:`p-2 rounded-lg transition-all ${l==="list"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("button",{onClick:()=>c("folder"),className:`p-2 rounded-lg transition-all ${l==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"Folder View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:v==="Commander"?"Search legends...":"Search cards...",value:T,onChange:dt=>I(dt.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),T&&s.jsx("button",{onClick:()=>I(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:[l==="folder"&&!p&&s.jsx(s.Fragment,{children:ct.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mb-6 border border-gray-700",children:s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Cards Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:T?"No cards match your search filters.":"We couldn't find any qualifying cards in your collection."}),s.jsxs("button",{onClick:()=>ee(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/20 hover:-translate-y-1 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Full Database"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ct.map(([dt,Ve])=>s.jsxs("div",{onClick:()=>x(dt),className:"bg-gray-800/40 hover:bg-gray-700/50 border border-white/5 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-2 border border-white/5",children:Ve.identity.colors.map(lt=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${lt}.svg`,alt:lt,className:"w-6 h-6"},lt))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-indigo-300 transition-colors uppercase tracking-wide",children:Ve.identity.badge}),s.jsx("div",{className:"h-0.5 w-8 bg-indigo-500/50 mx-auto my-2"}),s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',Ve.identity.flavor,'"']})]}),s.jsxs("span",{className:"text-sm font-mono font-bold text-gray-500 bg-black/20 px-3 py-1 rounded-full mt-2",children:[Ve.cards.length," ",v==="Commander"?"Legends":"Cards"]})]},dt))})}),l==="folder"&&p&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:()=>x(null),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors font-bold uppercase text-xs tracking-widest mb-4",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Groups"]}),s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("h3",{className:"text-3xl font-black text-white",children:ot[p].identity.badge}),s.jsx("div",{className:"flex gap-1",children:ot[p].identity.colors.map(dt=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${dt}.svg`,alt:dt,className:"w-6 h-6"},dt))})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:ot[p].cards.map(dt=>s.jsx(Nt,{card:dt,onClick:je},dt.id))})]}),l==="list"&&s.jsx("div",{className:"space-y-4",children:ct.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in border border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-400",children:"No cards found in your collection matching criteria."}),s.jsx("button",{onClick:()=>ee(!0),className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 hover:underline",children:"Search Scryfall Database"})]}):ct.map(([dt,Ve])=>{const lt=u[dt]||Pe;return s.jsxs("div",{children:[bt(Ve,lt,()=>f(kt=>({...kt,[dt]:!kt[dt]}))),lt&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8 pl-4 border-l-2 border-white/5 animate-fade-in",children:Ve.cards.map(kt=>s.jsx(Nt,{card:kt,onClick:je},kt.id))})]},dt)})})]})]})},Ge=()=>{const Pe=N.filter(ct=>{const bt=ct.data||ct,dt=bt.keywords||[],Ve=bt.oracle_text||"",lt=dt.includes("Partner")||Ve.includes("Partner");return ct.id===A?.id||!lt?!1:ct.name.toLowerCase().includes(B.toLowerCase())});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Choose Partner"}),s.jsxs("p",{className:"text-gray-400",children:["Select a partner for ",A?.name,"."]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search partners...",value:B,onChange:ct=>$(ct.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),B&&s.jsx("button",{onClick:()=>$(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("button",{onClick:()=>{F(null),i(si.AI_STRATEGY)},className:"text-sm font-bold text-gray-400 hover:text-white underline self-center",children:"Skip / Solo Commander"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[Pe.map(ct=>s.jsx(Nt,{card:ct,onClick:we},ct.id)),Pe.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500",children:"No valid partners found matching your search."})]})]})},Xe=()=>s.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in text-center",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full animate-ping absolute inset-0"}),s.jsx("div",{className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center relative shadow-[0_0_50px_rgba(79,70,229,0.5)]",children:s.jsx("svg",{className:"w-10 h-10 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})]}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:P}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Brewing a perfect strategy tailored to your playstyle."})]}),xt=()=>{const Pe=k?.layout?.functional||{},ct=k?.layout?.types||{};return s.jsxs("div",{className:"animate-fade-in flex flex-col space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-6 mb-8 shrink-0 sticky -top-8 z-30 bg-gray-950/90 backdrop-blur-xl pt-4 pb-6 -mx-8 px-8 rounded-t-3xl border-b border-white/5",children:[s.jsxs("div",{className:"space-y-2 flex-1 w-full",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deck Name"}),s.jsx("input",{type:"text",value:m,onChange:bt=>y(bt.target.value),className:"w-full text-4xl font-black bg-transparent border-b-2 border-white/10 focus:border-indigo-500 text-white placeholder-gray-600 outline-none pb-2 transition-colors",placeholder:"Name your deck..."})]}),s.jsxs("button",{onClick:oe,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 px-10 rounded-2xl shadow-lg shadow-indigo-500/20 transform hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 shrink-0",children:[a?"Forging...":"Create Deck",!a&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),s.jsx("div",{className:"space-y-8 flex-1",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md",children:[s.jsx("h3",{className:"text-xl font-bold text-indigo-300 mb-4",children:"Theme & Strategy"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Theme"}),s.jsx("p",{className:"text-lg text-white font-medium",children:k?.theme})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Gameplan"}),s.jsx("div",{className:"text-sm text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:k?.strategy}})]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Composition Preview"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Functional Needs"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(Pe).map(([bt,dt])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:bt}),s.jsx("span",{className:"font-mono font-bold text-indigo-400",children:dt})]},bt))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Type Balance"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(ct).map(([bt,dt])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:bt}),s.jsx("span",{className:"font-mono font-bold text-emerald-400",children:dt})]},bt))})]})]})]})})]})},Ae=A?ve(A):null;return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative flex flex-col pb-20",children:[Ae&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-cover bg-center transition-all duration-1000 transform scale-105",style:{backgroundImage:`url(${Ae})`}}),s.jsx("div",{className:"fixed inset-0 bg-gray-950/60 backdrop-blur-2xl transition-all duration-1000"}),s.jsx("div",{className:"fixed inset-0 bg-gradient-to-t from-gray-950 via-gray-950/50 to-transparent"})]}),!Ae&&s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/20 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto w-full px-6 py-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>t("/decks"),className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),s.jsx("div",{className:"h-8 w-[1px] bg-white/10 mx-2"}),s.jsx("div",{className:"flex gap-2",children:[si.BASICS,si.COMMANDER,si.AI_STRATEGY,si.REVIEW].map((Pe,ct)=>s.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${n>=Pe?"w-12 bg-indigo-500":"w-4 bg-gray-700"}`},Pe))})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 shadow-2xl backdrop-blur-xl animate-fade-in-up",children:[a&&n!==si.AI_STRATEGY&&s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),!a&&n===si.BASICS&&s.jsxs("div",{className:"flex flex-col items-center space-y-12 animate-fade-in py-8",children:[s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tight text-center",children:["Let's build something ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"legendary."})]}),s.jsxs("div",{className:"w-full max-w-5xl px-4 space-y-12",children:[A&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-white/5 backdrop-blur-sm animate-fade-in-down",children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:v==="Commander"?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl opacity-50 group-hover:opacity-75 blur transition duration-500"}),s.jsx("img",{src:A.image_uris?.normal||A.image_uris?.large,alt:A.name,className:"relative w-64 rounded-xl shadow-2xl transform group-hover:scale-[1.02] transition-all duration-500"})]}),s.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-3xl font-black text-white mb-2",children:A.name}),s.jsx("p",{className:"text-gray-400 text-sm",children:A.type_line}),s.jsx("p",{className:"text-gray-300 mt-4 text-base leading-relaxed",children:A.oracle_text})]}),s.jsxs("button",{onClick:()=>L(null),className:"self-start text-sm font-bold text-red-400 hover:text-red-300 underline mt-4",children:["Change ",v==="Commander"?"Commander":"Spotlight Card"]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Commander"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{G(!1),j("Commander"),pe("Commander",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-indigo-900/20 border border-white/10 hover:border-indigo-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-indigo-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"From Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build using only cards you own.",s.jsx("br",{}),"Oracle verifies your binder."]})]})]}),s.jsxs("div",{onClick:()=>{G(!0),j("Commander"),pe("Commander",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-purple-900/20 border border-white/10 hover:border-purple-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-purple-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-purple-300 transition-colors",children:"Theorycraft Mockup"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Design without limits.",s.jsx("br",{}),"Missing cards added to wishlist."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Quick Actions"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 max-w-2xl mx-auto w-full",children:[s.jsxs("div",{onClick:()=>te(!0),className:"group cursor-pointer bg-gray-800/40 hover:bg-blue-900/20 border border-white/10 hover:border-blue-500/50 rounded-3xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-blue-500/10 flex items-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-blue-500/30 flex-shrink-0",children:s.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),s.jsxs("div",{className:"relative z-10 text-left",children:[s.jsx("h3",{className:"text-xl font-black text-white mb-1 group-hover:text-blue-300 transition-colors",children:"Import Deck"}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Paste from Arena, Moxfield, or text file."})]})]}),s.jsxs("div",{className:"group opacity-50 cursor-not-allowed bg-gray-800/20 border border-white/5 rounded-3xl p-6 flex items-center gap-4 relative",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-700/20 rounded-2xl flex items-center justify-center border border-white/5 flex-shrink-0",children:s.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10 text-left",children:[s.jsx("h3",{className:"text-xl font-black text-gray-500 mb-1",children:"Scan Deck"}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Coming soon to Mobile Companion."})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Standard"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),"                                        ",s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{G(!1),j("Standard"),pe("Standard",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-emerald-900/20 border border-white/10 hover:border-emerald-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-emerald-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-emerald-300 transition-colors",children:"Standard Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build a 60-card Standard deck.",s.jsx("br",{}),"Using your own cards."]})]})]}),s.jsxs("div",{onClick:()=>{G(!0),j("Standard"),pe("Standard",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-cyan-900/20 border border-white/10 hover:border-cyan-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-cyan-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-cyan-300 transition-colors",children:"Standard Theorycraft"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Test new Standard meta decks.",s.jsx("br",{}),"Without owning every card."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Precons"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),W?s.jsx("div",{className:"flex justify-center p-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[se.map(Pe=>s.jsxs("div",{onClick:()=>t(`/precons?type=${encodeURIComponent(Pe)}`),className:"group cursor-pointer bg-gray-800/40 hover:bg-amber-900/20 border border-white/10 hover:border-amber-500/50 rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-amber-500/10 flex flex-col items-center text-center gap-3 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-amber-500/30",children:s.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-amber-300 transition-colors",children:Pe})]},Pe)),se.length===0&&s.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No precon types found. (Is the DB populated?)"})]})]})]})]}),!a&&n===si.COMMANDER&&Ne(),!a&&n===si.PARTNER&&Ge(),n===si.AI_STRATEGY&&Xe(),!a&&n===si.REVIEW&&xt()]})]}),s.jsx(d2e,{isOpen:ne,onClose:()=>ee(!1),onAdd:()=>Ce()}),s.jsx(u2e,{isOpen:Y,onClose:()=>te(!1),onImport:De}),ce&&s.jsxs("div",{className:"fixed inset-0 z-[60] bg-black/80 flex flex-col items-center justify-center backdrop-blur-sm",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mb-4"}),s.jsx("div",{className:"text-white font-bold text-xl",children:"Importing Deck..."}),s.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"Checking collection for matches"})]})]})};function PC(t){const[e,r]=b.useState(null),[n,i]=b.useState([]),[a,o]=b.useState(!0),[l,c]=b.useState(null),{currentUser:u}=Sr(),f=async(p=!1)=>{if(!(!u||!t||t==="new")){p||o(!0);try{const{deck:x,items:m}=await Ze.get(`/api/decks/${t}`);r(x),i(m.map(y=>({...y,countInDeck:y.count||1,managedId:y.id}))),c(null)}catch(x){console.error("Error fetching deck:",x),c(x)}finally{o(!1)}}};return b.useEffect(()=>{if(!u||!t){o(!1);return}f()},[u,t]),{deck:e,cards:n,setDeck:r,setCards:i,loading:a,error:l,refresh:f}}const DH=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmLabel:a="Confirm",isDangerous:o=!1})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:`bg-gray-900 border ${o?"border-red-500/50":"border-blue-500/50"} rounded-2xl max-w-sm w-full p-6 shadow-2xl transform transition-all scale-100`,children:[s.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[s.jsx("div",{className:`w-12 h-12 rounded-full ${o?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-400"} flex items-center justify-center mb-4`,children:s.jsx(g1,{className:"w-6 h-6"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:i})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-lg transition-colors",children:"Cancel"}),s.jsx("button",{onClick:r,className:`flex-1 px-4 py-2 font-bold rounded-lg transition-colors ${o?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:a})]})]})}):null,f2e=(t,e)=>{if(!t||t.length===0)return!0;const r=new Set(e||[]);return t.every(n=>r.has(n))},p2e=({isOpen:t,onClose:e,deck:r,deckCards:n=[]})=>{const{cards:i,loading:a}=To(),{currentUser:o}=Sr(),{openCardModal:l}=Ab(),[c,u]=b.useState(""),[f,p]=b.useState("All"),[x,m]=b.useState(!1),[y,v]=b.useState({colors:[],rarity:[],set:"",manaValue:""}),[j,N]=b.useState("name"),C=b.useMemo(()=>{if(!i||!r)return[];const O=r.format?.toLowerCase()==="standard",F=r.commander?.color_identity||[],T=r.commander_partner?.color_identity||[],I=new Set([...F,...T]);return i.filter($=>{if($.deckId)return!1;const k=$.type_line?.toLowerCase().includes("basic land");if(!O&&!f2e($.color_identity,[...I]))return!1;if(y.colors.length>0){const X=$.color_identity||[];if(!y.colors.some(ne=>ne==="C"?X.length===0:X.includes(ne)))return!1}if(y.rarity.length>0&&!y.rarity.includes($.rarity?.toLowerCase()))return!1;if(y.set){const X=y.set.toLowerCase();if(!$.set?.toLowerCase().includes(X)&&!$.set_name?.toLowerCase().includes(X))return!1}if(y.manaValue!==""){const X=parseFloat(y.manaValue);if($.cmc!==X)return!1}const R=n.filter(X=>X.name===$.name).reduce((X,G)=>X+(G.countInDeck||1),0);if(!k&&R>=(O?4:1))return!1;const q=c.toLowerCase();return!(q&&!$.name.toLowerCase().includes(q)&&!$.type_line?.toLowerCase().includes(q)||f!=="All"&&!$.type_line?.toLowerCase().includes(f.toLowerCase()))}).sort(($,k)=>{if(j==="name")return $.name.localeCompare(k.name);if(j.startsWith("price")){const R=parseFloat($.prices?.usd||$.data?.prices?.usd||0),P=parseFloat(k.prices?.usd||k.data?.prices?.usd||0);return j==="price-asc"?R-P:P-R}if(j==="rarity"){const R={mythic:4,rare:3,uncommon:2,common:1},P=R[$.rarity?.toLowerCase()]||0;return(R[k.rarity?.toLowerCase()]||0)-P}return 0})},[i,r,n,c,f,y,j]),A=async O=>{try{await za.addCardToDeck(o.uid,r.id,O),addToast(`Added ${O.name} to deck`,"success")}catch(F){console.error(F),addToast("Failed to add card","error")}};if(!t)return null;const L=["All","Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"];return Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col border border-gray-700",children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50 rounded-t-xl",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"Add from Collection"}),s.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",C.length," available)"]})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Showing unassigned cards compatible with this deck."})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 hover:bg-gray-700 p-2 rounded-lg",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700 space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, type, or text...",className:"w-full bg-gray-900 text-white border border-gray-700 rounded-lg py-3 px-4 pl-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-inner",value:c,onChange:O=>u(O.target.value),autoFocus:!0}),s.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(O=>s.jsx("button",{onClick:()=>p(O),className:`px-3 py-1 text-xs font-bold rounded-full transition-colors border ${f===O?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200"}`,children:O},O))}),s.jsxs("button",{onClick:()=>m(!x),className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg border transition-all ${x?"bg-indigo-600 text-white border-indigo-500 shadow-lg":"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),x?"Hide Filters":"Advanced Filters"]})]}),x&&s.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-700 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-down shadow-inner",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Color Identity"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["W","U","B","R","G"].filter(O=>r?.format?.toLowerCase()==="standard"?!0:new Set([...r?.commander?.color_identity||[],...r?.commander_partner?.color_identity||[]]).has(O)).map(O=>s.jsx("button",{onClick:()=>v(F=>({...F,colors:F.colors.includes(O)?F.colors.filter(T=>T!==O):[...F.colors,O]})),className:`w-8 h-8 rounded-full border flex items-center justify-center transition-all ${y.colors.includes(O)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-gray-700":"opacity-40 grayscale hover:grayscale-0 hover:opacity-100 border-gray-600 bg-gray-800"}`,children:s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${O}.svg`,alt:O,className:"w-5 h-5 shadow-sm"})},O)),s.jsx("button",{onClick:()=>v(O=>({...O,colors:O.colors.includes("C")?O.colors.filter(F=>F!=="C"):[...O.colors,"C"]})),className:`w-8 h-8 rounded-full border flex items-center justify-center text-[10px] font-black transition-all ${y.colors.includes("C")?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-indigo-600 text-white":"opacity-40 border-gray-600 bg-gray-800 text-gray-500 hover:opacity-100"}`,children:"C"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(O=>s.jsx("button",{onClick:()=>v(F=>({...F,rarity:F.rarity.includes(O)?F.rarity.filter(T=>T!==O):[...F.rarity,O]})),className:`px-3 py-1 text-[10px] font-bold uppercase rounded-lg border transition-all ${y.rarity.includes(O)?"bg-indigo-600 text-white border-indigo-400 shadow-md":"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:text-gray-300"}`,children:O.charAt(0)},O))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Set (Name/Code)"}),s.jsx("input",{type:"text",placeholder:"e.g. MH3 or Modern Horizons 3",value:y.set,onChange:O=>v(F=>({...F,set:O.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Mana Value"}),s.jsx("input",{type:"number",min:"0",placeholder:"CMC",value:y.manaValue,onChange:O=>v(F=>({...F,manaValue:O.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Sort By"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("select",{value:j,onChange:O=>N(O.target.value),className:"bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500 w-full",children:[s.jsx("option",{value:"name",children:"Name (A-Z)"}),s.jsx("option",{value:"price-desc",children:"Price (Highest)"}),s.jsx("option",{value:"price-asc",children:"Price (Lowest)"}),s.jsx("option",{value:"rarity",children:"Rarity"})]}),s.jsx("button",{onClick:()=>{v({colors:[],rarity:[],set:"",manaValue:""}),N("name"),u(""),p("All")},className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 transition-colors uppercase tracking-widest mt-1",children:"Reset All"})]})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-900/30 p-2 custom-scrollbar",children:a?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):C.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-2",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),s.jsx("p",{children:"No cards found matching your criteria."})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:C.map(O=>{const F=O.data||O,T=F.image_uris?.art_crop||F.image_uris?.normal||F.card_faces?.[0]?.image_uris?.art_crop||F.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/100x100?text=No+Img";return s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-800/80 rounded-lg border border-gray-700/50 hover:bg-gray-700 hover:border-indigo-500/50 transition-all group cursor-pointer",onClick:()=>l(O),children:[s.jsxs("div",{className:"relative w-16 h-12 rounded overflow-hidden shrink-0 shadow-sm",children:[s.jsx("img",{src:T,className:"w-full h-full object-cover",alt:O.name,loading:"lazy"}),O.finish==="foil"&&s.jsx("div",{className:"absolute top-0.5 right-0.5 text-yellow-500 bg-black/40 rounded-full p-0.5 leading-none",title:"Foil",children:s.jsx("span",{className:"text-[10px]",children:""})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-gray-500 text-xs font-mono font-bold bg-gray-900 px-1 rounded",children:[O.count||1,"x"]}),s.jsx("h4",{className:"font-bold text-gray-200 text-sm truncate",children:O.name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[s.jsx("span",{className:"truncate max-w-[120px]",children:O.type_line}),s.jsx("span",{className:"bg-gray-700 px-1 rounded text-[10px]",children:O.set?.toUpperCase()})]})]}),s.jsx("button",{onClick:I=>{I.stopPropagation(),A(O)},className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg shadow-md transition-transform active:scale-95 shrink-0 flex items-center gap-1 text-xs font-bold",children:"Add"})]},O.firestoreId||O.id)})})})]})}),document.body)},Mv=[{key:"W",name:"White",color:"bg-yellow-100",text:"text-yellow-600",border:"border-yellow-200/50",bg:"bg-yellow-500/10",pip:""},{key:"U",name:"Blue",color:"bg-blue-400",text:"text-blue-400",border:"border-blue-500/30",bg:"bg-blue-500/10",pip:""},{key:"B",name:"Black",color:"bg-gray-600",text:"text-gray-400",border:"border-gray-500/30",bg:"bg-gray-500/10",pip:""},{key:"R",name:"Red",color:"bg-red-500",text:"text-red-400",border:"border-red-500/30",bg:"bg-red-500/10",pip:""},{key:"G",name:"Green",color:"bg-green-500",text:"text-green-400",border:"border-green-500/30",bg:"bg-green-500/10",pip:""},{key:"C",name:"Colorless",color:"bg-gray-400",text:"text-gray-500",border:"border-gray-600/30",bg:"bg-gray-600/10",pip:""}],m2e=({cards:t=[]})=>{const e=b.useMemo(()=>{const n={pips:{W:0,U:0,B:0,R:0,G:0,C:0},production:{W:0,U:0,B:0,R:0,G:0,C:0},curve:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0},colorCurve:{W:[0,0,0,0,0,0,0,0],U:[0,0,0,0,0,0,0,0],B:[0,0,0,0,0,0,0,0],R:[0,0,0,0,0,0,0,0],G:[0,0,0,0,0,0,0,0],C:[0,0,0,0,0,0,0,0]},totalPips:0,totalProduction:0,nonLandCount:0,avgCMC:0};let i=0;return t.forEach(a=>{const o=a.data||a,l=(o.type_line||"").toLowerCase(),c=l.includes("land"),u=o.mana_cost||"",f=(o.oracle_text||"").toLowerCase();if(!c){n.nonLandCount+=a.countInDeck||1;const m=o.cmc??0;i+=m*(a.countInDeck||1),(u.match(/\{([^}]+)\}/g)||[]).forEach(j=>{j.slice(1,-1).split("/").forEach(A=>{if(["W","U","B","R","G","C"].includes(A)){n.pips[A]+=a.countInDeck||1,n.totalPips+=a.countInDeck||1;const L=Math.min(Math.floor(m),7);n.colorCurve[A][L]+=a.countInDeck||1}})});const v=m>=7?"7+":Math.floor(m);n.curve[v]+=a.countInDeck||1}let p=o.produced_mana||[];(f.includes("any color")||f.includes("mana of any color"))&&(p=["W","U","B","R","G"]),p.length===0&&c&&(l.includes("plains")&&p.push("W"),l.includes("island")&&p.push("U"),l.includes("swamp")&&p.push("B"),l.includes("mountain")&&p.push("R"),l.includes("forest")&&p.push("G")),!c&&f.includes("add {")&&["w","u","b","r","g","c"].forEach(m=>{f.includes(`add {${m}}`)&&p.push(m.toUpperCase())}),[...new Set(p)].forEach(m=>{n.production[m]!==void 0&&(n.production[m]+=a.countInDeck||1,n.totalProduction+=a.countInDeck||1)})}),n.avgCMC=n.nonLandCount>0?(i/n.nonLandCount).toFixed(2):0,n},[t]),r=(n,i="bg-indigo-500",a="h-48")=>{const o=Object.entries(n),l=Math.max(...o.map(c=>c[1]),1);return s.jsx("div",{className:`flex gap-1 ${a} w-full px-2`,children:o.map(([c,u])=>s.jsxs("div",{className:"flex-1 h-full flex flex-col justify-end items-center group relative",children:[u>0&&s.jsx("div",{className:`w-full ${i} rounded-t transition-all duration-500 group-hover:brightness-125`,style:{height:`${u/l*100}%`},children:s.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 px-1 rounded",children:u})}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 mt-2",children:c})]},c))})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Cost (Pips)"}),s.jsxs("span",{children:[e.totalPips," Total"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800",children:Mv.filter(n=>e.pips[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700`,style:{width:`${e.pips[n.key]/e.totalPips*100}%`},title:`${n.name}: ${e.pips[n.key]}`},n.key))})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Production"}),s.jsxs("span",{children:[e.totalProduction," Sources"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800 shadow-inner",children:Mv.filter(n=>e.production[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700 opacity-80`,style:{width:`${e.production[n.key]/e.totalProduction*100}%`},title:`${n.name}: ${e.production[n.key]}`},n.key))})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:Mv.map(n=>{const i=e.pips[n.key],a=e.production[n.key],o=e.totalPips>0?Math.round(i/e.totalPips*100):0,l=e.totalProduction>0?Math.round(a/e.totalProduction*100):0,c=i>0||a>0;return s.jsxs("div",{className:`p-4 rounded-2xl border transition-all duration-300 ${c?`${n.bg} ${n.border}`:"bg-gray-800/10 border-gray-800/50 opacity-40"}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("span",{className:"text-2xl",children:n.pip}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:`text-[10px] font-black uppercase tracking-tighter ${n.text}`,children:n.name})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Cost"}),s.jsxs("span",{className:"text-white",children:[o,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} transition-all duration-1000`,style:{width:`${o}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[i," pips"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Prod"}),s.jsxs("span",{className:"text-white",children:[l,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} opacity-60 transition-all duration-1000`,style:{width:`${l}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[a," mana"]})]})]})]},n.key)})}),s.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-2xl border border-gray-800/50",children:[s.jsx("div",{className:"flex justify-between items-end mb-8",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"Mana Curve"}),s.jsxs("p",{className:"text-xs text-gray-500 font-medium",children:["Average Mana Value (Non-lands): ",s.jsx("span",{className:"text-indigo-400",children:e.avgCMC})]})]})}),r(e.curve,"bg-indigo-500","h-40")]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Mv.filter(n=>e.pips[n.key]>0).map(n=>s.jsxs("div",{className:"bg-gray-900/30 p-4 rounded-xl border border-gray-800/50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-lg",children:n.pip}),s.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${n.text}`,children:[n.name," Spells"]})]}),r(Object.fromEntries(e.colorCurve[n.key].map((i,a)=>[a===7?"7+":a,i])),n.color,"h-24")]},n.key))})]})},BH=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{userProfile:i}=Sr(),a=i?.settings?.helper?.name||"The Oracle";return t?c6.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-6xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[10px] font-black font-mono text-indigo-400 uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Analytics"}),s.jsx("span",{className:"text-[10px] font-black font-mono text-gray-400 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded border border-white/5",children:a})]}),s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Deck Performance"})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 custom-scrollbar",children:s.jsx(m2e,{cards:r})}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Analytics"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body):null},g2e=({isOpen:t,onClose:e,deck:r,cards:n=[],onStrategyUpdate:i})=>{const{userProfile:a,currentUser:o}=Sr(),{addToast:l}=wn(),c=a?.settings?.helper?.name||"The Oracle",[u,f]=Ke.useState(!1),[p,x]=Ke.useState(0),[m,y]=Ke.useState(!1);if(Ke.useEffect(()=>(t?(x(0),y(!1),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t||!r)return null;const v=r.aiBlueprint||{},j=v.strategy||`<p class="text-gray-400 italic">No strategy generated for this deck yet. Ask ${c} to analyze it.</p>`,N=v.theme||"Uncharted Strategy",C=[r.commander];r.commander_partner&&C.push(r.commander_partner);const A=C[p]||C[0],L=A?.card_faces?.length>1,O=()=>{if(!A)return"https://placehold.co/480x680?text=Commander";if(L){const k=A.card_faces[m?1:0];return k.image_uris?.art_crop||k.image_uris?.large||k.image_uris?.normal}return A.image_uris?.art_crop||A.image_uris?.large||A.image_uris?.normal||A.image_uri},F=v.layout?.functional||v.suggestedCounts||{},T=v.layout?.types||v.typeCounts||{},I=vn(a?.subscription_tier).features.aiStrategy,B=!!v.strategy,$=async()=>{if(!a?.settings?.geminiApiKey){l("Gemini API Key missing in settings.","error");return}f(!0);try{console.log("[DeckStrategy] requesting new strategy...");const k=await yo.getDeckStrategy(a.settings.geminiApiKey,r.commander?.name||"Unknown Commander",a.playstyle,n,r.commander_partner?.name);console.log("[DeckStrategy] new strategy received:",k);const R=await za.updateDeck(o.uid,r.id,{aiBlueprint:{...v,theme:k.theme,strategy:k.strategy,layout:k.layout}});console.log("[DeckStrategy] update response:",R),l("Strategy updated based on your current build!","success"),await new Promise(P=>setTimeout(P,500)),i&&await i()}catch(k){console.error(k),l("Failed to rerun strategy analysis.","error")}finally{f(!1)}};return c6.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-5xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"absolute -top-[20%] -right-[10%] w-[500px] h-[500px] bg-indigo-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute -bottom-[20%] -left-[10%] w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"px-4 py-6 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsxs("div",{className:"flex items-center gap-4 md:gap-6 w-full md:w-auto",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm",children:s.jsx("span",{className:"text-3xl",children:""})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl md:text-3xl font-black text-white tracking-tighter uppercase leading-none mb-1",dangerouslySetInnerHTML:{__html:N}}),s.jsxs("p",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.3em]",children:[c," Strategic Blueprint"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4 w-full md:w-auto justify-end",children:[s.jsxs("button",{onClick:I?$:()=>l(`Upgrade to ${Cs[Jt.TIER_2].name} to use AI Strategy tools.`,"info"),disabled:u||!I,className:`flex-1 md:flex-none flex items-center justify-center gap-2 md:gap-3 px-4 md:px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all border ${u||!I?"bg-white/5 text-gray-500 border-white/5 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white border-white/20 shadow-[0_0_20px_rgba(79,70,229,0.3)] hover:shadow-[0_0_30px_rgba(79,70,229,0.5)] active:scale-95"}`,title:I?"":`Requires ${Cs[Jt.TIER_2].name} Tier`,children:[u?s.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{className:"md:hidden",children:u?"Consulting...":"Recreate"}),s.jsx("span",{className:"hidden md:inline",children:u?`Consulting with ${c}...`:`Have ${c} Recreate Strategy`})]}),s.jsx("div",{className:"w-px h-8 bg-white/10 mx-2"}),s.jsx("button",{onClick:e,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl transition-all text-gray-400 hover:text-white border border-white/5 hover:border-white/10 group",children:s.jsx("svg",{className:"w-6 h-6 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-10 py-10 custom-scrollbar space-y-12 relative z-10 overscroll-contain",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"sticky top-0 space-y-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl rounded-[2rem] group-hover:bg-indigo-500/30 transition-all duration-700"}),s.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden shadow-2xl border border-white/10 z-10 bg-black/40",children:[s.jsx("img",{src:O(),className:"w-full h-full object-cover transition-transform duration-700 active:scale-95",alt:A?.name}),L&&s.jsx("button",{onClick:()=>y(!m),className:"absolute top-4 right-4 p-3 bg-black/60 hover:bg-indigo-600 backdrop-blur-md rounded-full text-white border border-white/20 shadow-lg transition-all group/flip z-30",title:"Flip Card",children:s.jsx("svg",{className:`w-5 h-5 transition-transform duration-500 ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:s.jsxs("div",{className:"text-white font-bold text-center text-sm leading-tight drop-shadow-md",children:[A.name,L&&s.jsx("span",{className:"block text-[9px] text-gray-400 font-normal mt-0.5 uppercase tracking-widest",children:m?"Back Face":"Front Face"})]})})]}),s.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20",children:s.jsxs("div",{className:"bg-black/80 text-white px-5 py-2 rounded-full border border-white/10 shadow-xl backdrop-blur-md flex items-center gap-2 whitespace-nowrap",children:[s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Cards"}),s.jsx("div",{className:"w-px h-3 bg-white/20"}),s.jsxs("span",{className:"text-sm font-black font-mono",children:[(n||[]).length,"/100"]})]})})]}),s.jsxs("div",{className:"text-center pt-4 space-y-4",children:[s.jsxs("div",{onClick:()=>{x(0),y(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${p===0?"bg-indigo-500/10 border-indigo-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${p===0?"text-indigo-400":"text-gray-600"}`,children:"Lead Commander"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${p===0?"text-white":"text-gray-400"}`,children:C[0]?.name})]}),C[1]&&s.jsxs("div",{onClick:()=>{x(1),y(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${p===1?"bg-purple-500/10 border-purple-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${p===1?"text-purple-400":"text-gray-600"}`,children:"Partnered With"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${p===1?"text-white":"text-gray-400"}`,children:C[1].name})]})]})]})}),s.jsxs("div",{className:"space-y-10",children:[s.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-9xl",children:""})}),s.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-px bg-gray-700"}),B||I?"Tactical Overview":`Tactical Overview (Requires ${Cs[Jt.TIER_2].name})`]}),s.jsx("div",{className:"text-gray-300 leading-relaxed strategy-content-refined font-medium text-lg/8",dangerouslySetInnerHTML:{__html:B||I?j:`<p class="italic text-gray-500">Strategy generation is available on the ${Cs[Jt.TIER_2].name} tier. Upgrade to unlock deep strategic insights for your deck.</p>`}})]}),s.jsxs("div",{className:"space-y-8",children:[Object.keys(F).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),"Target Functional Needs"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(F).map(([k,R])=>s.jsxs("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-indigo-400 transition-colors h-8 flex items-center justify-center",children:k}),s.jsx("div",{className:"text-3xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:R})]},k))})]}),Object.keys(T).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-purple-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Target Type Distribution"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(T).map(([k,R])=>s.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-purple-400 transition-colors h-8 flex items-center justify-center",children:k}),s.jsx("div",{className:"text-2xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:R})]},k))})]})]})]})]})}),s.jsx("div",{className:"px-10 py-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0 relative z-10",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Blueprint"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .strategy-content-refined h4 {
                    font-size: 1.1rem;
                    font-weight: 800;
                    color: white;
                    margin-top: 1.5rem;
                    margin-bottom: 0.5rem;
                }
                .strategy-content-refined p {
                    margin-bottom: 1rem;
                }
                .strategy-content-refined strong {
                    color: #a5b4fc; /* Indigo 300 */
                }
                .strategy-content-refined ul {
                    list-style-type: disc;
                    padding-left: 1.5rem;
                    margin-bottom: 1rem;
                    color: #9ca3af;
                }
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body)},x2e=({isOpen:t,onClose:e,deck:r,onUpdateDeck:n})=>{const{addToast:i}=wn(),{currentUser:a}=Sr(),[o,l]=b.useState(r?.is_public||!1),[c,u]=b.useState(r?.shareSlug||""),[f,p]=b.useState(!1),[x,m]=b.useState(""),[y,v]=b.useState([]),[j,N]=b.useState(!1);b.useEffect(()=>{t&&r&&(l(r.is_public),u(r.shareSlug||""),C())},[t,r]);const C=async()=>{if(r?.id){N(!0);try{const O=await wa.fetchPermissions(r.id);v(O||[])}catch(O){console.error("Failed to fetch permissions",O)}finally{N(!1)}}},A=async()=>{p(!0);try{const O=!o;let F=c;if(O&&!F){const T=Math.random().toString(36).substring(2,8);F=`${r.name.toLowerCase().replace(/[^a-z0-9]+/g,"-")}-${T}`}await wa.updateDeckPublicStatus(r.id,O,F),l(O),u(F),n&&n({is_public:O,shareSlug:F}),i(`Binder is now ${O?"Public":"Private"}`,"success")}catch(O){console.error(O),i("Failed to update status","error")}finally{p(!1)}},L=()=>{const O=`${window.location.origin}/share/${c}`;navigator.clipboard.writeText(O),i("Link copied to clipboard!","success")};return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-md overflow-hidden relative",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),'Share "',r?.name,'"']}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 space-y-8",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 rounded-xl border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Public Link access"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Anyone with the link can view cards"})]}),s.jsx("button",{onClick:A,disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900 ${o?"bg-indigo-600":"bg-gray-600"}`,children:s.jsx("span",{className:`${o?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]}),o&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Public Link"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{readOnly:!0,value:`${window.location.origin}/share/${c}`,className:"flex-1 bg-gray-950 border border-gray-700 rounded-lg px-3 py-2 text-sm text-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx("button",{onClick:L,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Copy"})]})]}),!o&&s.jsxs("div",{className:"p-4 bg-yellow-900/10 border border-yellow-500/20 rounded-xl text-yellow-200 text-sm flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:["This binder is currently ",s.jsx("strong",{children:"Private"}),". Only you can see it."]})]})]})]})}):null},$H=({isOpen:t,onClose:e,deck:r,cards:n,isOwner:i})=>{const{userProfile:a,currentUser:o}=Sr(),{addToast:l}=wn();dn();const c=a?.settings?.helper?.name||"The Oracle",[u,f]=b.useState(!1),[p,x]=b.useState(r?.aiBlueprint?.grade||null),[m,y]=b.useState(!1);if(Ke.useEffect(()=>{t&&r?.aiBlueprint?.grade&&x(r.aiBlueprint.grade)},[t,r]),!t)return null;const v=async()=>{f(!0);try{const j=a?.settings?.geminiApiKey;if(!j){l("Please save your API Key in Settings > AI first.","error"),f(!1);return}const N=await yo.gradeDeck(j,{deckName:r.name,commander:r.commander?.name||"Unknown",cards:n,playerProfile:"Competitive but casual friendly",strategyGuide:r.description||"General synergy",helperPersona:a?.settings?.helper});if(x(N),i){const C={...r.aiBlueprint,grade:N,lastDiagnosed:new Date().toISOString()};await za.updateDeck(o.uid,r.id,{aiBlueprint:C}),l("Power Level Calibrated & Saved!","success")}}catch(j){console.error(j),l("Doctor is out. Try again later.","error")}finally{f(!1)}};return c6.createPortal(s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full max-w-4xl rounded-3xl border border-white/10 shadow-2xl p-8 relative flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-start mb-8 relative z-10",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white italic uppercase",children:"Deck Power Analysis"}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Evaluated by ",c]})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white p-2",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.12] saturate-[1.5] brightness-125",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"",className:"w-[80%] h-[80%] object-contain"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-12 relative z-10",children:[!p&&!u&&s.jsxs("div",{className:"text-center py-20",children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Ready to calibrate?"}),s.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"This process will analyze every card in your deck to determine its competitive bracket and numerical power level."}),s.jsxs("button",{onClick:v,className:"px-10 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black text-lg rounded-2xl shadow-xl hover:shadow-indigo-500/20 transition-all uppercase tracking-widest flex items-center gap-3 mx-auto",children:[s.jsx("span",{children:"Run Diagnosis"}),s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),u&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-6",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-b-4 border-indigo-500"}),s.jsx("p",{className:"text-indigo-400 font-black text-xl animate-pulse uppercase tracking-widest",children:"Simulating Matchups..."})]}),p&&s.jsxs("div",{className:"animate-fade-in space-y-10",children:[s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"inline-flex flex-col items-center",children:[s.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm mb-2",children:"Power Level"}),s.jsxs("div",{className:"text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 filter drop-shadow-lg",children:[Number(p.powerLevel).toFixed(2),s.jsx("span",{className:"text-3xl text-gray-600 ml-2",children:"/ 10"})]})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[p.metrics.efficiency,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Efficiency"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[p.metrics.interaction,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Interaction"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["Turn ",p.metrics.winTurn]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Avg Win Turn"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-center text-gray-500 text-xs font-black uppercase tracking-[0.2em]",children:["Commander Bracket: ",p.commanderBracket]}),s.jsx("div",{className:"grid grid-cols-5 gap-1 h-32 rounded-2xl overflow-hidden border border-white/10",children:[{id:1,label:"Exhibition",desc:"Ultra-Casual",color:"bg-yellow-500/20 text-yellow-500 border-yellow-500/50"},{id:2,label:"Core",desc:"Average Precon",color:"bg-green-500/20 text-green-500 border-green-500/50"},{id:3,label:"Upgraded",desc:"Beyond Precon",color:"bg-blue-500/20 text-blue-500 border-blue-500/50"},{id:4,label:"Optimized",desc:"High Power",color:"bg-orange-500/20 text-orange-500 border-orange-500/50"},{id:5,label:"cEDH",desc:"Competitive",color:"bg-purple-500/20 text-purple-500 border-purple-500/50"}].map(j=>{const N=p.commanderBracket===j.id;return s.jsxs("div",{className:`relative flex flex-col items-center justify-center p-4 border-t-4 transition-all ${N?`bg-gray-800 ${j.color.replace("/20","/10")} border-t-4 border-b-0 border-l-0 border-r-0`:"bg-gray-950 border-gray-800 opacity-40 grayscale"}`,style:{borderColor:N?void 0:"transparent"},children:[N&&s.jsx("div",{className:"absolute top-2 right-2 bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded",children:"MATCH"}),s.jsx("div",{className:`text-2xl font-black mb-1 ${N?j.color.split(" ")[1]:"text-gray-500"}`,children:j.id}),s.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider mb-1",children:j.label}),s.jsx("div",{className:"text-[10px] text-gray-400 text-center leading-tight",children:j.desc})]},j.id)})})]}),s.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:"Bracket Justification"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed italic",children:['"',p.bracketJustification,'"']})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," Clinical Critique"]}),s.jsx("div",{className:"bg-gray-950/50 p-8 rounded-3xl border border-white/5 shadow-inner",children:s.jsx("p",{className:"text-gray-300 leading-relaxed text-lg font-medium",children:p.critique})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-orange-500",children:""})," Mechanical improvements"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.mechanicalImprovements.map((j,N)=>s.jsxs("div",{className:"flex gap-4 p-5 bg-white/5 rounded-2xl border border-white/5 items-start group hover:bg-orange-500/10 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400 font-bold shrink-0",children:N+1}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed group-hover:text-white transition-colors",children:j})]},N))})]}),s.jsxs("div",{className:"space-y-6 pb-12",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""})," Surgical Swaps"]}),s.jsx("div",{className:"space-y-4",children:p.recommendedSwaps.map((j,N)=>s.jsxs("div",{className:"p-6 bg-gray-950/50 rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-2",children:"Cut This Card"}),s.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:s.jsx("span",{className:"text-white font-bold",children:j.remove})})]}),s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 border border-white/10 flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})}),s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-2",children:"Slot This In"}),s.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl text-right",children:s.jsx("span",{className:"text-white font-bold",children:j.add})})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',j.reason,'"']})})]},N))})]}),s.jsx("div",{className:"flex justify-center pb-12",children:s.jsxs("button",{onClick:v,disabled:u,className:"flex items-center gap-2 px-8 py-3 bg-indigo-900/40 hover:bg-indigo-600/40 text-indigo-300 rounded-xl border border-indigo-500/20 transition-all font-bold uppercase text-xs tracking-widest group",children:[s.jsx("svg",{className:`w-4 h-4 transition-transform duration-700 ${u?"animate-spin":"group-hover:rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),u?"Consulting Oracle...":"Rerun Diagnosis"]})})]})]})]})}),document.body)},b2e=({isOpen:t,onClose:e,deckCards:r})=>{const n=b.useMemo(()=>{if(!r)return[];const i=new Map;return r.forEach(a=>{const o=a.data||a;o.all_parts&&o.all_parts.forEach(l=>{if(l.component==="token"){const c=l.id;i.has(c)||i.set(c,{id:c,name:l.name,uri:l.uri,image_uri:`https://api.scryfall.com/cards/${l.id}?format=image`,sources:new Set}),i.get(c).sources.add(o.name)}})}),Array.from(i.values()).map(a=>({...a,sources:Array.from(a.sources).sort()})).sort((a,o)=>a.name.localeCompare(o.name))},[r]);return s.jsx(Su,{appear:!0,show:t,as:b.Fragment,children:s.jsxs(Zh,{as:"div",className:"relative z-[100]",onClose:e,children:[s.jsx(Su.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),s.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:s.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:s.jsx(Su.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:s.jsxs(Zh.Panel,{className:"w-full max-w-5xl transform overflow-hidden rounded-2xl bg-gray-900 border border-white/10 p-6 text-left align-middle shadow-xl transition-all",children:[s.jsxs(Zh.Title,{as:"h3",className:"text-lg font-black leading-6 text-white uppercase tracking-widest mb-6 flex items-center justify-between",children:[s.jsx("span",{children:"Required Tokens"}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.length===0?s.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:"No tokens identified for this deck."}):s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:n.map(i=>s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 overflow-hidden group hover:border-indigo-500/50 transition-all",children:[s.jsx("div",{className:"aspect-[2.5/3.5] relative overflow-hidden bg-gray-950",children:s.jsx("img",{src:i.image_uri,alt:i.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"})}),s.jsxs("div",{className:"p-3",children:[s.jsx("h4",{className:"font-bold text-white text-sm mb-1 truncate",title:i.name,children:i.name}),s.jsxs("div",{className:"text-[10px] text-gray-400",children:[s.jsx("span",{className:"uppercase tracking-wider font-bold text-indigo-400 block mb-1",children:"Produced By:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[i.sources.slice(0,3).map(a=>s.jsx("li",{className:"truncate",title:a,children:a},a)),i.sources.length>3&&s.jsxs("li",{className:"italic text-gray-500",children:["+",i.sources.length-3," more"]})]})]})]})]},i.id))})]})})})})]})})},y2e="modulepreload",v2e=function(t){return"/"+t},QM={},ON=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let c=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=c(r.map(u=>{if(u=v2e(u),u in QM)return;QM[u]=!0;const f=u.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const x=document.createElement("link");if(x.rel=f?"stylesheet":y2e,f||(x.as="script"),x.crossOrigin="",x.href=u,l&&x.setAttribute("nonce",l),document.head.appendChild(x),f)return new Promise((m,y)=>{x.addEventListener("load",m),x.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function rs(t){"@babel/helpers - typeof";return rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rs(t)}var $c=Uint8Array,vl=Uint16Array,IC=Int32Array,RC=new $c([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),DC=new $c([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eP=new $c([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FH=function(t,e){for(var r=new vl(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new IC(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},UH=FH(RC,2),w2e=UH.b,WS=UH.r;w2e[28]=258,WS[258]=28;var j2e=FH(DC,0),tP=j2e.r,GS=new vl(32768);for(var Ds=0;Ds<32768;++Ds){var Lh=(Ds&43690)>>1|(Ds&21845)<<1;Lh=(Lh&52428)>>2|(Lh&13107)<<2,Lh=(Lh&61680)>>4|(Lh&3855)<<4,GS[Ds]=((Lh&65280)>>8|(Lh&255)<<8)>>1}var Mx=(function(t,e,r){for(var n=t.length,i=0,a=new vl(e);i<n;++i)t[i]&&++a[t[i]-1];var o=new vl(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var l;if(r){l=new vl(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],p=o[t[i]-1]++<<f,x=p|(1<<f)-1;p<=x;++p)l[GS[p]>>c]=u}else for(l=new vl(n),i=0;i<n;++i)t[i]&&(l[i]=GS[o[t[i]-1]++]>>15-t[i]);return l}),b0=new $c(288);for(var Ds=0;Ds<144;++Ds)b0[Ds]=8;for(var Ds=144;Ds<256;++Ds)b0[Ds]=9;for(var Ds=256;Ds<280;++Ds)b0[Ds]=7;for(var Ds=280;Ds<288;++Ds)b0[Ds]=8;var y2=new $c(32);for(var Ds=0;Ds<32;++Ds)y2[Ds]=5;var N2e=Mx(b0,9,0),k2e=Mx(y2,5,0),zH=function(t){return(t+7)/8|0},S2e=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new $c(t.subarray(e,r))},au=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Wg=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},MN=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:HH,l:0};if(i==1){var o=new $c(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(O,F){return O.f-F.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,f=1,p=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=r[r[u].f<r[p].f?u++:p++],c=r[u!=f&&r[u].f<r[p].f?u++:p++],r[f++]={s:-1,f:l.f+c.f,l,r:c};for(var x=a[0].s,n=1;n<i;++n)a[n].s>x&&(x=a[n].s);var m=new vl(x+1),y=VS(r[f-1],m,0);if(y>e){var n=0,v=0,j=y-e,N=1<<j;for(a.sort(function(F,T){return m[T.s]-m[F.s]||F.f-T.f});n<i;++n){var C=a[n].s;if(m[C]>e)v+=N-(1<<y-m[C]),m[C]=e;else break}for(v>>=j;v>0;){var A=a[n].s;m[A]<e?v-=1<<e-m[A]++-1:++n}for(;n>=0&&v;--n){var L=a[n].s;m[L]==e&&(--m[L],++v)}y=e}return{t:new $c(m),l:y}},VS=function(t,e,r){return t.s==-1?Math.max(VS(t.l,e,r+1),VS(t.r,e,r+1)):e[t.s]=r},rP=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new vl(++e),n=0,i=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[l]}return{c:r.subarray(0,n),n:e}},Gg=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},qH=function(t,e,r){var n=r.length,i=zH(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},nP=function(t,e,r,n,i,a,o,l,c,u,f){au(e,f++,r),++i[256];for(var p=MN(i,15),x=p.t,m=p.l,y=MN(a,15),v=y.t,j=y.l,N=rP(x),C=N.c,A=N.n,L=rP(v),O=L.c,F=L.n,T=new vl(19),I=0;I<C.length;++I)++T[C[I]&31];for(var I=0;I<O.length;++I)++T[O[I]&31];for(var B=MN(T,7),$=B.t,k=B.l,R=19;R>4&&!$[eP[R-1]];--R);var P=u+5<<3,q=Gg(i,b0)+Gg(a,y2)+o,X=Gg(i,x)+Gg(a,v)+o+14+3*R+Gg(T,$)+2*T[16]+3*T[17]+7*T[18];if(c>=0&&P<=q&&P<=X)return qH(e,f,t.subarray(c,c+u));var G,ne,ee,se;if(au(e,f,1+(X<q)),f+=2,X<q){G=Mx(x,m,0),ne=x,ee=Mx(v,j,0),se=v;var J=Mx($,k,0);au(e,f,A-257),au(e,f+5,F-1),au(e,f+10,R-4),f+=14;for(var I=0;I<R;++I)au(e,f+3*I,$[eP[I]]);f+=3*R;for(var W=[C,O],U=0;U<2;++U)for(var Y=W[U],I=0;I<Y.length;++I){var te=Y[I]&31;au(e,f,J[te]),f+=$[te],te>15&&(au(e,f,Y[I]>>5&127),f+=Y[I]>>12)}}else G=N2e,ne=b0,ee=k2e,se=y2;for(var I=0;I<l;++I){var ce=n[I];if(ce>255){var te=ce>>18&31;Wg(e,f,G[te+257]),f+=ne[te+257],te>7&&(au(e,f,ce>>23&31),f+=RC[te]);var xe=ce&31;Wg(e,f,ee[xe]),f+=se[xe],xe>3&&(Wg(e,f,ce>>5&8191),f+=DC[xe])}else Wg(e,f,G[ce]),f+=ne[ce]}return Wg(e,f,G[256]),f+ne[256]},_2e=new IC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),HH=new $c(0),C2e=function(t,e,r,n,i,a){var o=a.z||t.length,l=new $c(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=a.l,f=(a.r||0)&7;if(e){f&&(c[0]=a.r>>3);for(var p=_2e[e-1],x=p>>13,m=p&8191,y=(1<<r)-1,v=a.p||new vl(32768),j=a.h||new vl(y+1),N=Math.ceil(r/3),C=2*N,A=function(Te){return(t[Te]^t[Te+1]<<N^t[Te+2]<<C)&y},L=new IC(25e3),O=new vl(288),F=new vl(32),T=0,I=0,B=a.i||0,$=0,k=a.w||0,R=0;B+2<o;++B){var P=A(B),q=B&32767,X=j[P];if(v[q]=X,j[P]=q,k<=B){var G=o-B;if((T>7e3||$>24576)&&(G>423||!u)){f=nP(t,c,0,L,O,F,I,$,R,B-R,f),$=T=I=0,R=B;for(var ne=0;ne<286;++ne)O[ne]=0;for(var ne=0;ne<30;++ne)F[ne]=0}var ee=2,se=0,J=m,W=q-X&32767;if(G>2&&P==A(B-W))for(var U=Math.min(x,G)-1,Y=Math.min(32767,B),te=Math.min(258,G);W<=Y&&--J&&q!=X;){if(t[B+ee]==t[B+ee-W]){for(var ce=0;ce<te&&t[B+ce]==t[B+ce-W];++ce);if(ce>ee){if(ee=ce,se=W,ce>U)break;for(var xe=Math.min(W,ce-2),ue=0,ne=0;ne<xe;++ne){var ve=B-W+ne&32767,Q=v[ve],pe=ve-Q&32767;pe>ue&&(ue=pe,X=ve)}}}q=X,X=v[q],W+=q-X&32767}if(se){L[$++]=268435456|WS[ee]<<18|tP[se];var Ce=WS[ee]&31,je=tP[se]&31;I+=RC[Ce]+DC[je],++O[257+Ce],++F[je],k=B+ee,++T}else L[$++]=t[B],++O[t[B]]}}for(B=Math.max(B,k);B<o;++B)L[$++]=t[B],++O[t[B]];f=nP(t,c,u,L,O,F,I,$,R,B-R,f),u||(a.r=f&7|c[f/8|0]<<3,f-=7,a.h=j,a.p=v,a.i=B,a.w=k)}else{for(var B=a.w||0;B<o+u;B+=65535){var we=B+65535;we>=o&&(c[f/8|0]=u,we=o),f=qH(c,f+1,t.subarray(B,we))}a.i=o}return S2e(l,0,n+zH(f)+i)},WH=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},A2e=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new $c(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return C2e(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},GH=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},E2e=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=WH();i.p(e.dictionary),GH(t,2,i.d())}};function YS(t,e){e||(e={});var r=WH();r.p(t);var n=A2e(t,e,e.dictionary?6:2,4);return E2e(n,e),GH(n,n.length-4,r.d()),n}var T2e=typeof TextDecoder<"u"&&new TextDecoder,L2e=0;try{T2e.decode(HH,{stream:!0}),L2e=1}catch{}function O2e(t){if(Array.isArray(t))return t}function M2e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(f){u=!0,i=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function sP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function P2e(t,e){if(t){if(typeof t=="string")return sP(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sP(t,e):void 0}}function I2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iP(t,e){return O2e(t)||M2e(t,e)||P2e(t,e)||I2e()}function aP(t,e="utf8"){return new TextDecoder(e).decode(t)}const R2e=new TextEncoder;function D2e(t){return R2e.encode(t)}const B2e=1024*8,$2e=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),PN={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class BC{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=B2e,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof BC)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=PN[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===$2e&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new PN[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new PN[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return aP(this.readBytes(e))}decodeText(e=1,r="utf8"){return aP(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(D2e(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function zm(t){let e=t.length;for(;--e>=0;)t[e]=0}const F2e=3,U2e=258,VH=29,z2e=256,q2e=z2e+1+VH,YH=30,H2e=512,W2e=new Array((q2e+2)*2);zm(W2e);const G2e=new Array(YH*2);zm(G2e);const V2e=new Array(H2e);zm(V2e);const Y2e=new Array(U2e-F2e+1);zm(Y2e);const K2e=new Array(VH);zm(K2e);const X2e=new Array(YH);zm(X2e);const J2e=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+e[n++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var KS=J2e;const Z2e=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},Q2e=new Uint32Array(Z2e()),ewe=(t,e,r,n)=>{const i=Q2e,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var ld=ewe,XS={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},KH={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const twe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var rwe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)twe(r,n)&&(t[n]=r[n])}}return t},nwe=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let o=t[n];r.set(o,i),i+=o.length}return r},XH={assign:rwe,flattenChunks:nwe};let JH=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{JH=!1}const eb=new Uint8Array(256);for(let t=0;t<256;t++)eb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;eb[254]=eb[254]=1;var swe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,o=t.length,l=0;for(i=0;i<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,i=0;a<l;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const iwe=(t,e)=>{if(e<65534&&t.subarray&&JH)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var awe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let o=t[n++];if(o<128){a[i++]=o;continue}let l=eb[o];if(l>4){a[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return iwe(a,i)},owe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+eb[t[r]]>e?r:e},JS={string2buf:swe,buf2string:awe,utf8border:owe};function lwe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var cwe=lwe;const Pv=16209,dwe=16191;var uwe=function(e,r){let n,i,a,o,l,c,u,f,p,x,m,y,v,j,N,C,A,L,O,F,T,I,B,$;const k=e.state;n=e.next_in,B=e.input,i=n+(e.avail_in-5),a=e.next_out,$=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=k.dmax,u=k.wsize,f=k.whave,p=k.wnext,x=k.window,m=k.hold,y=k.bits,v=k.lencode,j=k.distcode,N=(1<<k.lenbits)-1,C=(1<<k.distbits)-1;e:do{y<15&&(m+=B[n++]<<y,y+=8,m+=B[n++]<<y,y+=8),A=v[m&N];t:for(;;){if(L=A>>>24,m>>>=L,y-=L,L=A>>>16&255,L===0)$[a++]=A&65535;else if(L&16){O=A&65535,L&=15,L&&(y<L&&(m+=B[n++]<<y,y+=8),O+=m&(1<<L)-1,m>>>=L,y-=L),y<15&&(m+=B[n++]<<y,y+=8,m+=B[n++]<<y,y+=8),A=j[m&C];r:for(;;){if(L=A>>>24,m>>>=L,y-=L,L=A>>>16&255,L&16){if(F=A&65535,L&=15,y<L&&(m+=B[n++]<<y,y+=8,y<L&&(m+=B[n++]<<y,y+=8)),F+=m&(1<<L)-1,F>c){e.msg="invalid distance too far back",k.mode=Pv;break e}if(m>>>=L,y-=L,L=a-o,F>L){if(L=F-L,L>f&&k.sane){e.msg="invalid distance too far back",k.mode=Pv;break e}if(T=0,I=x,p===0){if(T+=u-L,L<O){O-=L;do $[a++]=x[T++];while(--L);T=a-F,I=$}}else if(p<L){if(T+=u+p-L,L-=p,L<O){O-=L;do $[a++]=x[T++];while(--L);if(T=0,p<O){L=p,O-=L;do $[a++]=x[T++];while(--L);T=a-F,I=$}}}else if(T+=p-L,L<O){O-=L;do $[a++]=x[T++];while(--L);T=a-F,I=$}for(;O>2;)$[a++]=I[T++],$[a++]=I[T++],$[a++]=I[T++],O-=3;O&&($[a++]=I[T++],O>1&&($[a++]=I[T++]))}else{T=a-F;do $[a++]=$[T++],$[a++]=$[T++],$[a++]=$[T++],O-=3;while(O>2);O&&($[a++]=$[T++],O>1&&($[a++]=$[T++]))}}else if((L&64)===0){A=j[(A&65535)+(m&(1<<L)-1)];continue r}else{e.msg="invalid distance code",k.mode=Pv;break e}break}}else if((L&64)===0){A=v[(A&65535)+(m&(1<<L)-1)];continue t}else if(L&32){k.mode=dwe;break e}else{e.msg="invalid literal/length code",k.mode=Pv;break e}break}}while(n<i&&a<l);O=y>>3,n-=O,y-=O<<3,m&=(1<<y)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<l?257+(l-a):257-(a-l),k.hold=m,k.bits=y};const Ep=15,oP=852,lP=592,cP=0,IN=1,dP=2,hwe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),fwe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),pwe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),mwe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),gwe=(t,e,r,n,i,a,o,l)=>{const c=l.bits;let u=0,f=0,p=0,x=0,m=0,y=0,v=0,j=0,N=0,C=0,A,L,O,F,T,I=null,B;const $=new Uint16Array(Ep+1),k=new Uint16Array(Ep+1);let R=null,P,q,X;for(u=0;u<=Ep;u++)$[u]=0;for(f=0;f<n;f++)$[e[r+f]]++;for(m=c,x=Ep;x>=1&&$[x]===0;x--);if(m>x&&(m=x),x===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<x&&$[p]===0;p++);for(m<p&&(m=p),j=1,u=1;u<=Ep;u++)if(j<<=1,j-=$[u],j<0)return-1;if(j>0&&(t===cP||x!==1))return-1;for(k[1]=0,u=1;u<Ep;u++)k[u+1]=k[u]+$[u];for(f=0;f<n;f++)e[r+f]!==0&&(o[k[e[r+f]]++]=f);if(t===cP?(I=R=o,B=20):t===IN?(I=hwe,R=fwe,B=257):(I=pwe,R=mwe,B=0),C=0,f=0,u=p,T=a,y=m,v=0,O=-1,N=1<<m,F=N-1,t===IN&&N>oP||t===dP&&N>lP)return 1;for(;;){P=u-v,o[f]+1<B?(q=0,X=o[f]):o[f]>=B?(q=R[o[f]-B],X=I[o[f]-B]):(q=96,X=0),A=1<<u-v,L=1<<y,p=L;do L-=A,i[T+(C>>v)+L]=P<<24|q<<16|X|0;while(L!==0);for(A=1<<u-1;C&A;)A>>=1;if(A!==0?(C&=A-1,C+=A):C=0,f++,--$[u]===0){if(u===x)break;u=e[r+o[f]]}if(u>m&&(C&F)!==O){for(v===0&&(v=m),T+=p,y=u-v,j=1<<y;y+v<x&&(j-=$[y+v],!(j<=0));)y++,j<<=1;if(N+=1<<y,t===IN&&N>oP||t===dP&&N>lP)return 1;O=C&F,i[O]=m<<24|y<<16|T-a|0}}return C!==0&&(i[T+C]=u-v<<24|64<<16|0),l.bits=m,0};var Px=gwe;const xwe=0,ZH=1,QH=2,{Z_FINISH:uP,Z_BLOCK:bwe,Z_TREES:Iv,Z_OK:y0,Z_STREAM_END:ywe,Z_NEED_DICT:vwe,Z_STREAM_ERROR:ec,Z_DATA_ERROR:eW,Z_MEM_ERROR:tW,Z_BUF_ERROR:wwe,Z_DEFLATED:hP}=KH,Qw=16180,fP=16181,pP=16182,mP=16183,gP=16184,xP=16185,bP=16186,yP=16187,vP=16188,wP=16189,v2=16190,ou=16191,RN=16192,jP=16193,DN=16194,NP=16195,kP=16196,SP=16197,_P=16198,Rv=16199,Dv=16200,CP=16201,AP=16202,EP=16203,TP=16204,LP=16205,BN=16206,OP=16207,MP=16208,Vs=16209,rW=16210,nW=16211,jwe=852,Nwe=592,kwe=15,Swe=kwe,PP=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function _we(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $0=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Qw||e.mode>nW?1:0},sW=t=>{if($0(t))return ec;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Qw,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(jwe),e.distcode=e.distdyn=new Int32Array(Nwe),e.sane=1,e.back=-1,y0},iW=t=>{if($0(t))return ec;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,sW(t)},aW=(t,e)=>{let r;if($0(t))return ec;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ec:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,iW(t))},oW=(t,e)=>{if(!t)return ec;const r=new _we;t.state=r,r.strm=t,r.window=null,r.mode=Qw;const n=aW(t,e);return n!==y0&&(t.state=null),n},Cwe=t=>oW(t,Swe);let IP=!0,$N,FN;const Awe=t=>{if(IP){$N=new Int32Array(512),FN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Px(ZH,t.lens,0,288,$N,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Px(QH,t.lens,0,32,FN,0,t.work,{bits:5}),IP=!1}t.lencode=$N,t.lenbits=9,t.distcode=FN,t.distbits=5},lW=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Ewe=(t,e)=>{let r,n,i,a,o,l,c,u,f,p,x,m,y,v,j=0,N,C,A,L,O,F,T,I;const B=new Uint8Array(4);let $,k;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($0(t)||!t.output||!t.input&&t.avail_in!==0)return ec;r=t.state,r.mode===ou&&(r.mode=RN),o=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,f=r.bits,p=l,x=c,I=y0;e:for(;;)switch(r.mode){case Qw:if(r.wrap===0){r.mode=RN;break}for(;f<16;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,B[0]=u&255,B[1]=u>>>8&255,r.check=ld(r.check,B,2,0),u=0,f=0,r.mode=fP;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Vs;break}if((u&15)!==hP){t.msg="unknown compression method",r.mode=Vs;break}if(u>>>=4,f-=4,T=(u&15)+8,r.wbits===0&&(r.wbits=T),T>15||T>r.wbits){t.msg="invalid window size",r.mode=Vs;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?wP:ou,u=0,f=0;break;case fP:for(;f<16;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==hP){t.msg="unknown compression method",r.mode=Vs;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Vs;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(B[0]=u&255,B[1]=u>>>8&255,r.check=ld(r.check,B,2,0)),u=0,f=0,r.mode=pP;case pP:for(;f<32;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(B[0]=u&255,B[1]=u>>>8&255,B[2]=u>>>16&255,B[3]=u>>>24&255,r.check=ld(r.check,B,4,0)),u=0,f=0,r.mode=mP;case mP:for(;f<16;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(B[0]=u&255,B[1]=u>>>8&255,r.check=ld(r.check,B,2,0)),u=0,f=0,r.mode=gP;case gP:if(r.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(B[0]=u&255,B[1]=u>>>8&255,r.check=ld(r.check,B,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=xP;case xP:if(r.flags&1024&&(m=r.length,m>l&&(m=l),m&&(r.head&&(T=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+m),T)),r.flags&512&&r.wrap&4&&(r.check=ld(r.check,n,m,a)),l-=m,a+=m,r.length-=m),r.length))break e;r.length=0,r.mode=bP;case bP:if(r.flags&2048){if(l===0)break e;m=0;do T=n[a+m++],r.head&&T&&r.length<65536&&(r.head.name+=String.fromCharCode(T));while(T&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=ld(r.check,n,m,a)),l-=m,a+=m,T)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=yP;case yP:if(r.flags&4096){if(l===0)break e;m=0;do T=n[a+m++],r.head&&T&&r.length<65536&&(r.head.comment+=String.fromCharCode(T));while(T&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=ld(r.check,n,m,a)),l-=m,a+=m,T)break e}else r.head&&(r.head.comment=null);r.mode=vP;case vP:if(r.flags&512){for(;f<16;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Vs;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ou;break;case wP:for(;f<32;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}t.adler=r.check=PP(u),u=0,f=0,r.mode=v2;case v2:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=f,vwe;t.adler=r.check=1,r.mode=ou;case ou:if(e===bwe||e===Iv)break e;case RN:if(r.last){u>>>=f&7,f-=f&7,r.mode=BN;break}for(;f<3;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}switch(r.last=u&1,u>>>=1,f-=1,u&3){case 0:r.mode=jP;break;case 1:if(Awe(r),r.mode=Rv,e===Iv){u>>>=2,f-=2;break e}break;case 2:r.mode=kP;break;case 3:t.msg="invalid block type",r.mode=Vs}u>>>=2,f-=2;break;case jP:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Vs;break}if(r.length=u&65535,u=0,f=0,r.mode=DN,e===Iv)break e;case DN:r.mode=NP;case NP:if(m=r.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;i.set(n.subarray(a,a+m),o),l-=m,a+=m,c-=m,o+=m,r.length-=m;break}r.mode=ou;break;case kP:for(;f<14;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Vs;break}r.have=0,r.mode=SP;case SP:for(;r.have<r.ncode;){for(;f<3;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.lens[R[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[R[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,$={bits:r.lenbits},I=Px(xwe,r.lens,0,19,r.lencode,0,r.work,$),r.lenbits=$.bits,I){t.msg="invalid code lengths set",r.mode=Vs;break}r.have=0,r.mode=_P;case _P:for(;r.have<r.nlen+r.ndist;){for(;j=r.lencode[u&(1<<r.lenbits)-1],N=j>>>24,C=j>>>16&255,A=j&65535,!(N<=f);){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(A<16)u>>>=N,f-=N,r.lens[r.have++]=A;else{if(A===16){for(k=N+2;f<k;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(u>>>=N,f-=N,r.have===0){t.msg="invalid bit length repeat",r.mode=Vs;break}T=r.lens[r.have-1],m=3+(u&3),u>>>=2,f-=2}else if(A===17){for(k=N+3;f<k;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}u>>>=N,f-=N,T=0,m=3+(u&7),u>>>=3,f-=3}else{for(k=N+7;f<k;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}u>>>=N,f-=N,T=0,m=11+(u&127),u>>>=7,f-=7}if(r.have+m>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Vs;break}for(;m--;)r.lens[r.have++]=T}}if(r.mode===Vs)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Vs;break}if(r.lenbits=9,$={bits:r.lenbits},I=Px(ZH,r.lens,0,r.nlen,r.lencode,0,r.work,$),r.lenbits=$.bits,I){t.msg="invalid literal/lengths set",r.mode=Vs;break}if(r.distbits=6,r.distcode=r.distdyn,$={bits:r.distbits},I=Px(QH,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,$),r.distbits=$.bits,I){t.msg="invalid distances set",r.mode=Vs;break}if(r.mode=Rv,e===Iv)break e;case Rv:r.mode=Dv;case Dv:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=f,uwe(t,x),o=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,u=r.hold,f=r.bits,r.mode===ou&&(r.back=-1);break}for(r.back=0;j=r.lencode[u&(1<<r.lenbits)-1],N=j>>>24,C=j>>>16&255,A=j&65535,!(N<=f);){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(C&&(C&240)===0){for(L=N,O=C,F=A;j=r.lencode[F+((u&(1<<L+O)-1)>>L)],N=j>>>24,C=j>>>16&255,A=j&65535,!(L+N<=f);){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}u>>>=L,f-=L,r.back+=L}if(u>>>=N,f-=N,r.back+=N,r.length=A,C===0){r.mode=LP;break}if(C&32){r.back=-1,r.mode=ou;break}if(C&64){t.msg="invalid literal/length code",r.mode=Vs;break}r.extra=C&15,r.mode=CP;case CP:if(r.extra){for(k=r.extra;f<k;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=AP;case AP:for(;j=r.distcode[u&(1<<r.distbits)-1],N=j>>>24,C=j>>>16&255,A=j&65535,!(N<=f);){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if((C&240)===0){for(L=N,O=C,F=A;j=r.distcode[F+((u&(1<<L+O)-1)>>L)],N=j>>>24,C=j>>>16&255,A=j&65535,!(L+N<=f);){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}u>>>=L,f-=L,r.back+=L}if(u>>>=N,f-=N,r.back+=N,C&64){t.msg="invalid distance code",r.mode=Vs;break}r.offset=A,r.extra=C&15,r.mode=EP;case EP:if(r.extra){for(k=r.extra;f<k;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Vs;break}r.mode=TP;case TP:if(c===0)break e;if(m=x-c,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Vs;break}m>r.wnext?(m-=r.wnext,y=r.wsize-m):y=r.wnext-m,m>r.length&&(m=r.length),v=r.window}else v=i,y=o-r.offset,m=r.length;m>c&&(m=c),c-=m,r.length-=m;do i[o++]=v[y++];while(--m);r.length===0&&(r.mode=Dv);break;case LP:if(c===0)break e;i[o++]=r.length,c--,r.mode=Dv;break;case BN:if(r.wrap){for(;f<32;){if(l===0)break e;l--,u|=n[a++]<<f,f+=8}if(x-=c,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?ld(r.check,i,x,o-x):KS(r.check,i,x,o-x)),x=c,r.wrap&4&&(r.flags?u:PP(u))!==r.check){t.msg="incorrect data check",r.mode=Vs;break}u=0,f=0}r.mode=OP;case OP:if(r.wrap&&r.flags){for(;f<32;){if(l===0)break e;l--,u+=n[a++]<<f,f+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Vs;break}u=0,f=0}r.mode=MP;case MP:I=ywe;break e;case Vs:I=eW;break e;case rW:return tW;case nW:default:return ec}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=u,r.bits=f,(r.wsize||x!==t.avail_out&&r.mode<Vs&&(r.mode<BN||e!==uP))&&lW(t,t.output,t.next_out,x-t.avail_out),p-=t.avail_in,x-=t.avail_out,t.total_in+=p,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?ld(r.check,i,x,t.next_out-x):KS(r.check,i,x,t.next_out-x)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ou?128:0)+(r.mode===Rv||r.mode===DN?256:0),(p===0&&x===0||e===uP)&&I===y0&&(I=wwe),I},Twe=t=>{if($0(t))return ec;let e=t.state;return e.window&&(e.window=null),t.state=null,y0},Lwe=(t,e)=>{if($0(t))return ec;const r=t.state;return(r.wrap&2)===0?ec:(r.head=e,e.done=!1,y0)},Owe=(t,e)=>{const r=e.length;let n,i,a;return $0(t)||(n=t.state,n.wrap!==0&&n.mode!==v2)?ec:n.mode===v2&&(i=1,i=KS(i,e,r,0),i!==n.check)?eW:(a=lW(t,e,r,r),a?(n.mode=rW,tW):(n.havedict=1,y0))};var Mwe=iW,Pwe=aW,Iwe=sW,Rwe=Cwe,Dwe=oW,Bwe=Ewe,$we=Twe,Fwe=Lwe,Uwe=Owe,zwe="pako inflate (from Nodeca project)",cu={inflateReset:Mwe,inflateReset2:Pwe,inflateResetKeep:Iwe,inflateInit:Rwe,inflateInit2:Dwe,inflate:Bwe,inflateEnd:$we,inflateGetHeader:Fwe,inflateSetDictionary:Uwe,inflateInfo:zwe};function qwe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Hwe=qwe;const cW=Object.prototype.toString,{Z_NO_FLUSH:Wwe,Z_FINISH:Gwe,Z_OK:tb,Z_STREAM_END:UN,Z_NEED_DICT:zN,Z_STREAM_ERROR:Vwe,Z_DATA_ERROR:RP,Z_MEM_ERROR:Ywe}=KH;function zb(t){this.options=XH.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cwe,this.strm.avail_out=0;let r=cu.inflateInit2(this.strm,e.windowBits);if(r!==tb)throw new Error(XS[r]);if(this.header=new Hwe,cu.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=JS.string2buf(e.dictionary):cW.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=cu.inflateSetDictionary(this.strm,e.dictionary),r!==tb)))throw new Error(XS[r])}zb.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Gwe:Wwe,cW.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=cu.inflate(r,o),a===zN&&i&&(a=cu.inflateSetDictionary(r,i),a===tb?a=cu.inflate(r,o):a===RP&&(a=zN));r.avail_in>0&&a===UN&&r.state.wrap>0&&t[r.next_in]!==0;)cu.inflateReset(r),a=cu.inflate(r,o);switch(a){case Vwe:case RP:case zN:case Ywe:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===UN))if(this.options.to==="string"){let c=JS.utf8border(r.output,r.next_out),u=r.next_out-c,f=JS.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===tb&&l===0)){if(a===UN)return a=cu.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};zb.prototype.onData=function(t){this.chunks.push(t)};zb.prototype.onEnd=function(t){t===tb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=XH.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Kwe(t,e){const r=new zb(e);if(r.push(t),r.err)throw r.msg||XS[r.err];return r.result}var Xwe=zb,Jwe=Kwe,Zwe={Inflate:Xwe,inflate:Jwe};const{Inflate:Qwe,inflate:e5e}=Zwe;var DP=Qwe,t5e=e5e;const dW=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;dW[t]=e}const BP=4294967295;function r5e(t,e,r){let n=t;for(let i=0;i<r;i++)n=dW[(n^e[i])&255]^n>>>8;return n}function n5e(t,e){return(r5e(BP,t,e)^BP)>>>0}function $P(t,e,r){const n=t.readUint32(),i=n5e(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function uW(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function hW(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function fW(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function pW(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function mW(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+s5e(e[a-i],r[a],r[a-i])&255}}function s5e(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return i<=a&&i<=o?t:a<=o?e:r}function i5e(t,e,r,n,i,a){switch(t){case 0:uW(e,r,i);break;case 1:hW(e,r,i,a);break;case 2:fW(e,r,n,i);break;case 3:pW(e,r,n,i,a);break;case 4:mW(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const a5e=new Uint16Array([255]),o5e=new Uint8Array(a5e.buffer),l5e=o5e[0]===255;function c5e(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let f=0;f<7;f++){const p=o[f],x=Math.ceil((r-p.x)/p.xStep),m=Math.ceil((n-p.y)/p.yStep);if(x<=0||m<=0)continue;const y=x*l,v=new Uint8Array(y);for(let j=0;j<m;j++){const N=e[u++],C=e.subarray(u,u+y);u+=y;const A=new Uint8Array(y);i5e(N,C,A,v,y,l),v.set(A);for(let L=0;L<x;L++){const O=p.x+L*p.xStep,F=p.y+j*p.yStep;if(!(O>=r||F>=n))for(let T=0;T<l;T++)c[(F*r+O)*l+T]=A[L*l+T]}}}if(a===16){const f=new Uint16Array(c.buffer);if(l5e)for(let p=0;p<f.length;p++)f[p]=d5e(f[p]);return f}else return c}function d5e(t){return(t&255)<<8|t>>8&255}const u5e=new Uint16Array([255]),h5e=new Uint8Array(u5e.buffer),f5e=h5e[0]===255,p5e=new Uint8Array(0);function FP(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,o=Math.ceil(a/8)*i,l=Math.ceil(a/8*i*r),c=new Uint8Array(n*l);let u=p5e,f=0,p,x;for(let m=0;m<n;m++){switch(p=e.subarray(f+1,f+1+l),x=c.subarray(m*l,(m+1)*l),e[f]){case 0:uW(p,x,l);break;case 1:hW(p,x,l,o);break;case 2:fW(p,x,u,l);break;case 3:pW(p,x,u,l,o);break;case 4:mW(p,x,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=x,f+=l+1}if(a===16){const m=new Uint16Array(c.buffer);if(f5e)for(let y=0;y<m.length;y++)m[y]=m5e(m[y]);return m}else return c}function m5e(t){return(t&255)<<8|t>>8&255}const _1=Uint8Array.of(137,80,78,71,13,10,26,10);function UP(t){if(!g5e(t.readBytes(_1.length)))throw new Error("wrong PNG signature")}function g5e(t){if(t.length<_1.length)return!1;for(let e=0;e<_1.length;e++)if(t[e]!==_1[e])return!1;return!0}const x5e="tEXt",b5e=0,gW=new TextDecoder("latin1");function y5e(t){if(w5e(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const v5e=/^[\u0000-\u00FF]*$/;function w5e(t){if(!v5e.test(t))throw new Error("invalid latin1 text")}function j5e(t,e,r){const n=xW(e);t[n]=N5e(e,r-n.length-1)}function xW(t){for(t.mark();t.readByte()!==b5e;);const e=t.offset;t.reset();const r=gW.decode(t.readBytes(e-t.offset-1));return t.skip(1),y5e(r),r}function N5e(t,e){return gW.decode(t.readBytes(e))}const xl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},qN={UNKNOWN:-1,DEFLATE:0},zP={UNKNOWN:-1,ADAPTIVE:0},HN={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Bv={NONE:0,BACKGROUND:1,PREVIOUS:2},WN={SOURCE:0,OVER:1};class k5e extends BC{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new DP,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=qN.UNKNOWN,this._filterMethod=zP.UNKNOWN,this._interlaceMethod=HN.UNKNOWN,this._colorType=xl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(UP(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(UP(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case x5e:j5e(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?$P(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?$P(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=S5e(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case xl.GREYSCALE:n=1;break;case xl.TRUECOLOUR:n=3;break;case xl.INDEXED_COLOUR:n=1;break;case xl.GREYSCALE_ALPHA:n=2;break;case xl.TRUECOLOUR_ALPHA:n=4;break;case xl.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==qN.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case xl.GREYSCALE:case xl.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case xl.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case xl.UNKNOWN:case xl.GREYSCALE_ALPHA:case xl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=xW(this),n=this.readUint8();if(n!==qN.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:t5e(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=FP({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case Bv.NONE:break;case Bv.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const o=(i*e.width+a)*this._png.channels;for(let l=0;l<this._png.channels;l++)n.data[o+l]=0}break;case Bv.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,o)=>{const l=((a+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,c=(a*r.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(r.blendOp){case WN.SOURCE:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let u=0;u<this._png.channels;u++)e.data[l+u]=r.data[c+u]}break;case WN.OVER:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let u=0;u<this._png.channels;u++){const f=r.data[c+this._png.channels-1]/n,p=u%(this._png.channels-1)===0?1:r.data[c+u],x=Math.floor(f*p+(1-f)*e.data[l+u]);e.data[l+u]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==zP.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===HN.NO_INTERLACE)this._png.data=FP({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===HN.ADAM7)this._png.data=c5e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Bv.NONE,blendOp:WN.SOURCE,data:e}),this._inflator=new DP,this._writingDataChunks=!1}}function S5e(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var qP;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(qP||(qP={}));function _5e(t,e){return new k5e(t,e).decode()}var Ir=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function GN(){Ir.console&&typeof Ir.console.log=="function"&&Ir.console.log.apply(Ir.console,arguments)}var vs={log:GN,warn:function(t){Ir.console&&(typeof Ir.console.warn=="function"?Ir.console.warn.apply(Ir.console,arguments):GN.call(null,arguments))},error:function(t){Ir.console&&(typeof Ir.console.error=="function"?Ir.console.error.apply(Ir.console,arguments):GN(t))}};function VN(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Df(n.response,e,r)},n.onerror=function(){vs.error("could not download file")},n.send()}function HP(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function $v(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Df=Ir.saveAs||((typeof window>"u"?"undefined":rs(window))!=="object"||window!==Ir?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ir.URL||Ir.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?HP(i.href)?VN(t,e,r):$v(i,i.target="_blank"):$v(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){$v(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(HP(t))VN(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){$v(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:rs(a)!=="object"&&(vs.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return VN(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Ir.HTMLElement)||Ir.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":rs(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},l.readAsDataURL(t)}else{var c=Ir.URL||Ir.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function bW(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var C1=Ir.atob.bind(Ir),WP=Ir.btoa.bind(Ir);function YN(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=eo(r,n,i,a,e[0],7,-680876936),a=eo(a,r,n,i,e[1],12,-389564586),i=eo(i,a,r,n,e[2],17,606105819),n=eo(n,i,a,r,e[3],22,-1044525330),r=eo(r,n,i,a,e[4],7,-176418897),a=eo(a,r,n,i,e[5],12,1200080426),i=eo(i,a,r,n,e[6],17,-1473231341),n=eo(n,i,a,r,e[7],22,-45705983),r=eo(r,n,i,a,e[8],7,1770035416),a=eo(a,r,n,i,e[9],12,-1958414417),i=eo(i,a,r,n,e[10],17,-42063),n=eo(n,i,a,r,e[11],22,-1990404162),r=eo(r,n,i,a,e[12],7,1804603682),a=eo(a,r,n,i,e[13],12,-40341101),i=eo(i,a,r,n,e[14],17,-1502002290),r=to(r,n=eo(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=to(a,r,n,i,e[6],9,-1069501632),i=to(i,a,r,n,e[11],14,643717713),n=to(n,i,a,r,e[0],20,-373897302),r=to(r,n,i,a,e[5],5,-701558691),a=to(a,r,n,i,e[10],9,38016083),i=to(i,a,r,n,e[15],14,-660478335),n=to(n,i,a,r,e[4],20,-405537848),r=to(r,n,i,a,e[9],5,568446438),a=to(a,r,n,i,e[14],9,-1019803690),i=to(i,a,r,n,e[3],14,-187363961),n=to(n,i,a,r,e[8],20,1163531501),r=to(r,n,i,a,e[13],5,-1444681467),a=to(a,r,n,i,e[2],9,-51403784),i=to(i,a,r,n,e[7],14,1735328473),r=ro(r,n=to(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=ro(a,r,n,i,e[8],11,-2022574463),i=ro(i,a,r,n,e[11],16,1839030562),n=ro(n,i,a,r,e[14],23,-35309556),r=ro(r,n,i,a,e[1],4,-1530992060),a=ro(a,r,n,i,e[4],11,1272893353),i=ro(i,a,r,n,e[7],16,-155497632),n=ro(n,i,a,r,e[10],23,-1094730640),r=ro(r,n,i,a,e[13],4,681279174),a=ro(a,r,n,i,e[0],11,-358537222),i=ro(i,a,r,n,e[3],16,-722521979),n=ro(n,i,a,r,e[6],23,76029189),r=ro(r,n,i,a,e[9],4,-640364487),a=ro(a,r,n,i,e[12],11,-421815835),i=ro(i,a,r,n,e[15],16,530742520),r=no(r,n=ro(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=no(a,r,n,i,e[7],10,1126891415),i=no(i,a,r,n,e[14],15,-1416354905),n=no(n,i,a,r,e[5],21,-57434055),r=no(r,n,i,a,e[12],6,1700485571),a=no(a,r,n,i,e[3],10,-1894986606),i=no(i,a,r,n,e[10],15,-1051523),n=no(n,i,a,r,e[1],21,-2054922799),r=no(r,n,i,a,e[8],6,1873313359),a=no(a,r,n,i,e[15],10,-30611744),i=no(i,a,r,n,e[6],15,-1560198380),n=no(n,i,a,r,e[13],21,1309151649),r=no(r,n,i,a,e[4],6,-145523070),a=no(a,r,n,i,e[11],10,-1120210379),i=no(i,a,r,n,e[2],15,718787259),n=no(n,i,a,r,e[9],21,-343485551),t[0]=Vh(r,t[0]),t[1]=Vh(n,t[1]),t[2]=Vh(i,t[2]),t[3]=Vh(a,t[3])}function e5(t,e,r,n,i,a){return e=Vh(Vh(e,t),Vh(n,a)),Vh(e<<i|e>>>32-i,r)}function eo(t,e,r,n,i,a,o){return e5(e&r|~e&n,t,e,i,a,o)}function to(t,e,r,n,i,a,o){return e5(e&n|r&~n,t,e,i,a,o)}function ro(t,e,r,n,i,a,o){return e5(e^r^n,t,e,i,a,o)}function no(t,e,r,n,i,a,o){return e5(r^(e|~n),t,e,i,a,o)}function yW(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)YN(n,C5e(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(YN(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,YN(n,i),n}function C5e(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var GP="0123456789abcdef".split("");function A5e(t){for(var e="",r=0;r<4;r++)e+=GP[t>>8*r+4&15]+GP[t>>8*r&15];return e}function E5e(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function ZS(t){return yW(t).map(E5e).join("")}var T5e=(function(t){for(var e=0;e<t.length;e++)t[e]=A5e(t[e]);return t.join("")})(yW("hello"))!="5d41402abc4b2a76b9719d911017c592";function Vh(t,e){if(T5e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function QS(t,e){var r,n,i,a;if(t!==r){for(var o=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}r=t,n=l}else l=n;var p=e.length,x=0,m=0,y="";for(c=0;c<p;c++)m=(m+(f=l[x=(x+1)%256]))%256,l[x]=l[m],l[m]=f,o=l[(l[x]+l[m])%256],y+=String.fromCharCode(e.charCodeAt(c)^o);return y}var VP={print:4,modify:8,copy:16,"annot-forms":32};function Up(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(VP.perm!==void 0)throw new Error("Invalid permission: "+l);i+=VP[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=ZS(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=QS(this.encryptionKey,this.padding)}function zp(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function YP(t){if(rs(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Ir.console&&vs.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function w2(t){if(!(this instanceof w2))return new w2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function vW(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function qf(t,e,r,n,i){if(!(this instanceof qf))return new qf(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,vW.call(this,n,i)}function Wp(t,e,r,n,i){if(!(this instanceof Wp))return new Wp(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,vW.call(this,n,i)}function xr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],o=[],l=1,c=16,u="S",f=null;rs(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=YP;var y="1.3",v=m.__private__.getPdfVersion=function(){return y};m.__private__.setPdfVersion=function(z){y=z};var j={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return j};var N=m.__private__.getPageFormat=function(z){return j[z]};i=i||"a4";var C="compat",A="advanced",L=C;function O(){this.saveGraphicsState(),oe(new He(kt,0,0,-kt,0,Ts()*kt).toString()+" cm"),this.setFontSize(this.getFontSize()/kt),u="n",L=A}function F(){this.restoreGraphicsState(),u="S",L=C}var T=m.__private__.combineFontStyleAndFontWeight=function(z,ae){if(z=="bold"&&ae=="normal"||z=="bold"&&ae==400||z=="normal"&&ae=="italic"||z=="bold"&&ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ae&&(z=ae==400||ae==="normal"?z==="italic"?"italic":"normal":ae!=700&&ae!=="bold"||z!=="normal"?(ae==700?"bold":ae)+""+z:"bold"),z};m.advancedAPI=function(z){var ae=L===C;return ae&&O.call(this),typeof z!="function"||(z(this),ae&&F.call(this)),this},m.compatAPI=function(z){var ae=L===A;return ae&&F.call(this),typeof z!="function"||(z(this),ae&&O.call(this)),this},m.isAdvancedAPI=function(){return L===A};var I,B=function(z){if(L!==A)throw new Error(z+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=m.roundToPrecision=m.__private__.roundToPrecision=function(z,ae){var ke=e||ae;if(isNaN(z)||isNaN(ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return z.toFixed(ke).replace(/0+$/,"")};I=m.hpf=m.__private__.hpf=typeof c=="number"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,c)}:c==="smart"?function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,z>-1&&z<1?16:5)}:function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.hpf");return $(z,16)};var k=m.f2=m.__private__.f2=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f2");return $(z,2)},R=m.__private__.f3=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.f3");return $(z,3)},P=m.scale=m.__private__.scale=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.scale");return L===C?z*kt:L===A?z:void 0},q=function(z){return P((function(ae){return L===C?Ts()-ae:L===A?ae:void 0})(z))};m.__private__.setPrecision=m.setPrecision=function(z){typeof parseInt(z,10)=="number"&&(e=parseInt(z,10))};var X,G="00000000000000000000000000000000",ne=m.__private__.getFileId=function(){return G},ee=m.__private__.setFileId=function(z){return G=z!==void 0&&/^[a-fA-F0-9]{32}$/.test(z)?z.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Fn=new Up(f.userPermissions,f.userPassword,f.ownerPassword,G)),G};m.setFileId=function(z){return ee(z),this},m.getFileId=function(){return ne()};var se=m.__private__.convertDateToPDFDate=function(z){var ae=z.getTimezoneOffset(),ke=ae<0?"+":"-",Me=Math.floor(Math.abs(ae/60)),Fe=Math.abs(ae%60),mt=[ke,te(Me),"'",te(Fe),"'"].join("");return["D:",z.getFullYear(),te(z.getMonth()+1),te(z.getDate()),te(z.getHours()),te(z.getMinutes()),te(z.getSeconds()),mt].join("")},J=m.__private__.convertPDFDateToDate=function(z){var ae=parseInt(z.substr(2,4),10),ke=parseInt(z.substr(6,2),10)-1,Me=parseInt(z.substr(8,2),10),Fe=parseInt(z.substr(10,2),10),mt=parseInt(z.substr(12,2),10),_t=parseInt(z.substr(14,2),10);return new Date(ae,ke,Me,Fe,mt,_t,0)},W=m.__private__.setCreationDate=function(z){var ae;if(z===void 0&&(z=new Date),z instanceof Date)ae=se(z);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(z))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ae=z}return X=ae},U=m.__private__.getCreationDate=function(z){var ae=X;return z==="jsDate"&&(ae=J(X)),ae};m.setCreationDate=function(z){return W(z),this},m.getCreationDate=function(z){return U(z)};var Y,te=m.__private__.padd2=function(z){return("0"+parseInt(z)).slice(-2)},ce=m.__private__.padd2Hex=function(z){return("00"+(z=z.toString())).substr(z.length)},xe=0,ue=[],ve=[],Q=0,pe=[],Ce=[],je=!1,we=ve;m.__private__.setCustomOutputDestination=function(z){je=!0,we=z};var Te=function(z){je||(we=z)};m.__private__.resetCustomOutputDestination=function(){je=!1,we=ve};var oe=m.__private__.out=function(z){return z=z.toString(),Q+=z.length+1,we.push(z),we},De=m.__private__.write=function(z){return oe(arguments.length===1?z.toString():Array.prototype.join.call(arguments," "))},Nt=m.__private__.getArrayBuffer=function(z){for(var ae=z.length,ke=new ArrayBuffer(ae),Me=new Uint8Array(ke);ae--;)Me[ae]=z.charCodeAt(ae);return ke},ot=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return ot};var Ne=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(z){return Ne=L===A?z/kt:z,this};var Ge,Xe=m.__private__.getFontSize=m.getFontSize=function(){return L===C?Ne:Ne*kt},xt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(z){return xt=z,this},m.__private__.getR2L=m.getR2L=function(){return xt};var Ae,Pe=m.__private__.setZoomMode=function(z){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(z))Ge=z;else if(isNaN(z)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(z)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+z+'" is not recognized.');Ge=z}else Ge=parseInt(z,10)};m.__private__.getZoomMode=function(){return Ge};var ct,bt=m.__private__.setPageMode=function(z){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(z)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+z+'" is not recognized.');Ae=z};m.__private__.getPageMode=function(){return Ae};var dt=m.__private__.setLayoutMode=function(z){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(z)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+z+'" is not recognized.');ct=z};m.__private__.getLayoutMode=function(){return ct},m.__private__.setDisplayMode=m.setDisplayMode=function(z,ae,ke){return Pe(z),dt(ae),bt(ke),this};var Ve={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(z){if(Object.keys(Ve).indexOf(z)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ve[z]},m.__private__.getDocumentProperties=function(){return Ve},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(z){for(var ae in Ve)Ve.hasOwnProperty(ae)&&z[ae]&&(Ve[ae]=z[ae]);return this},m.__private__.setDocumentProperty=function(z,ae){if(Object.keys(Ve).indexOf(z)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ve[z]=ae};var lt,kt,Ue,Bt,zt,Ot={},Et={},$t=[],At={},Xt={},qt={},Ht={},jr=null,Ct=0,Tt=[],Yt=new YP(m),Be=t.hotfixes||[],Lt={},Ft={},Ee=[],He=function z(ae,ke,Me,Fe,mt,_t){if(!(this instanceof z))return new z(ae,ke,Me,Fe,mt,_t);isNaN(ae)&&(ae=1),isNaN(ke)&&(ke=0),isNaN(Me)&&(Me=0),isNaN(Fe)&&(Fe=1),isNaN(mt)&&(mt=0),isNaN(_t)&&(_t=0),this._matrix=[ae,ke,Me,Fe,mt,_t]};Object.defineProperty(He.prototype,"sx",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(He.prototype,"shy",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(He.prototype,"shx",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(He.prototype,"sy",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(He.prototype,"tx",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(He.prototype,"ty",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(He.prototype,"a",{get:function(){return this._matrix[0]},set:function(z){this._matrix[0]=z}}),Object.defineProperty(He.prototype,"b",{get:function(){return this._matrix[1]},set:function(z){this._matrix[1]=z}}),Object.defineProperty(He.prototype,"c",{get:function(){return this._matrix[2]},set:function(z){this._matrix[2]=z}}),Object.defineProperty(He.prototype,"d",{get:function(){return this._matrix[3]},set:function(z){this._matrix[3]=z}}),Object.defineProperty(He.prototype,"e",{get:function(){return this._matrix[4]},set:function(z){this._matrix[4]=z}}),Object.defineProperty(He.prototype,"f",{get:function(){return this._matrix[5]},set:function(z){this._matrix[5]=z}}),Object.defineProperty(He.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(He.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(He.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(He.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),He.prototype.join=function(z){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(z)},He.prototype.multiply=function(z){var ae=z.sx*this.sx+z.shy*this.shx,ke=z.sx*this.shy+z.shy*this.sy,Me=z.shx*this.sx+z.sy*this.shx,Fe=z.shx*this.shy+z.sy*this.sy,mt=z.tx*this.sx+z.ty*this.shx+this.tx,_t=z.tx*this.shy+z.ty*this.sy+this.ty;return new He(ae,ke,Me,Fe,mt,_t)},He.prototype.decompose=function(){var z=this.sx,ae=this.shy,ke=this.shx,Me=this.sy,Fe=this.tx,mt=this.ty,_t=Math.sqrt(z*z+ae*ae),tr=(z/=_t)*ke+(ae/=_t)*Me;ke-=z*tr,Me-=ae*tr;var ir=Math.sqrt(ke*ke+Me*Me);return tr/=ir,z*(Me/=ir)<ae*(ke/=ir)&&(z=-z,ae=-ae,tr=-tr,_t=-_t),{scale:new He(_t,0,0,ir,0,0),translate:new He(1,0,0,1,Fe,mt),rotate:new He(z,ae,-ae,z,0,0),skew:new He(1,0,tr,1,0,0)}},He.prototype.toString=function(z){return this.join(" ")},He.prototype.inversed=function(){var z=this.sx,ae=this.shy,ke=this.shx,Me=this.sy,Fe=this.tx,mt=this.ty,_t=1/(z*Me-ae*ke),tr=Me*_t,ir=-ae*_t,cr=-ke*_t,Mr=z*_t;return new He(tr,ir,cr,Mr,-tr*Fe-cr*mt,-ir*Fe-Mr*mt)},He.prototype.applyToPoint=function(z){var ae=z.x*this.sx+z.y*this.shx+this.tx,ke=z.x*this.shy+z.y*this.sy+this.ty;return new Kt(ae,ke)},He.prototype.applyToRectangle=function(z){var ae=this.applyToPoint(z),ke=this.applyToPoint(new Kt(z.x+z.w,z.y+z.h));return new Or(ae.x,ae.y,ke.x-ae.x,ke.y-ae.y)},He.prototype.clone=function(){var z=this.sx,ae=this.shy,ke=this.shx,Me=this.sy,Fe=this.tx,mt=this.ty;return new He(z,ae,ke,Me,Fe,mt)},m.Matrix=He;var Mt=m.matrixMult=function(z,ae){return ae.multiply(z)},Gt=new He(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Gt;var Zt=function(z,ae){if(!Xt[z]){var ke=(ae instanceof qf?"Sh":"P")+(Object.keys(At).length+1).toString(10);ae.id=ke,Xt[z]=ke,At[ke]=ae,Yt.publish("addPattern",ae)}};m.ShadingPattern=qf,m.TilingPattern=Wp,m.addShadingPattern=function(z,ae){return B("addShadingPattern()"),Zt(z,ae),this},m.beginTilingPattern=function(z){B("beginTilingPattern()"),mn(z.boundingBox[0],z.boundingBox[1],z.boundingBox[2]-z.boundingBox[0],z.boundingBox[3]-z.boundingBox[1],z.matrix)},m.endTilingPattern=function(z,ae){B("endTilingPattern()"),ae.stream=Ce[Y].join(`
`),Zt(z,ae),Yt.publish("endTilingPattern",ae),Ee.pop().restore()};var Ut,It=m.__private__.newObject=function(){var z=Vt();return pr(z,!0),z},Vt=m.__private__.newObjectDeferred=function(){return xe++,ue[xe]=function(){return Q},xe},pr=function(z,ae){return ae=typeof ae=="boolean"&&ae,ue[z]=Q,ae&&oe(z+" 0 obj"),z},en=m.__private__.newAdditionalObject=function(){var z={objId:Vt(),content:""};return pe.push(z),z},Yr=Vt(),$r=Vt(),Qr=m.__private__.decodeColorString=function(z){var ae=z.split(" ");if(ae.length!==2||ae[1]!=="g"&&ae[1]!=="G")ae.length!==5||ae[4]!=="k"&&ae[4]!=="K"||(ae=[(1-ae[0])*(1-ae[3]),(1-ae[1])*(1-ae[3]),(1-ae[2])*(1-ae[3]),"r"]);else{var ke=parseFloat(ae[0]);ae=[ke,ke,ke,"r"]}for(var Me="#",Fe=0;Fe<3;Fe++)Me+=("0"+Math.floor(255*parseFloat(ae[Fe])).toString(16)).slice(-2);return Me},pn=m.__private__.encodeColorString=function(z){var ae;typeof z=="string"&&(z={ch1:z});var ke=z.ch1,Me=z.ch2,Fe=z.ch3,mt=z.ch4,_t=z.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ke=="string"&&ke.charAt(0)!=="#"){var tr=new bW(ke);if(tr.ok)ke=tr.toHex();else if(!/^\d*\.?\d*$/.test(ke))throw new Error('Invalid color "'+ke+'" passed to jsPDF.encodeColorString.')}if(typeof ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ke)&&(ke="#"+ke[1]+ke[1]+ke[2]+ke[2]+ke[3]+ke[3]),typeof ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ke)){var ir=parseInt(ke.substr(1),16);ke=ir>>16&255,Me=ir>>8&255,Fe=255&ir}if(Me===void 0||mt===void 0&&ke===Me&&Me===Fe)ae=typeof ke=="string"?ke+" "+_t[0]:z.precision===2?k(ke/255)+" "+_t[0]:R(ke/255)+" "+_t[0];else if(mt===void 0||rs(mt)==="object"){if(mt&&!isNaN(mt.a)&&mt.a===0)return["1.","1.","1.",_t[1]].join(" ");ae=typeof ke=="string"?[ke,Me,Fe,_t[1]].join(" "):z.precision===2?[k(ke/255),k(Me/255),k(Fe/255),_t[1]].join(" "):[R(ke/255),R(Me/255),R(Fe/255),_t[1]].join(" ")}else ae=typeof ke=="string"?[ke,Me,Fe,mt,_t[2]].join(" "):z.precision===2?[k(ke),k(Me),k(Fe),k(mt),_t[2]].join(" "):[R(ke),R(Me),R(Fe),R(mt),_t[2]].join(" ");return ae},Hr=m.__private__.getFilters=function(){return o},ss=m.__private__.putStream=function(z){var ae=(z=z||{}).data||"",ke=z.filters||Hr(),Me=z.alreadyAppliedFilters||[],Fe=z.addLength1||!1,mt=ae.length,_t=z.objectId,tr=function(ie){return ie};if(f!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(tr=Fn.encryptor(_t,0));var ir={};ke===!0&&(ke=["FlateEncode"]);var cr=z.additionalKeyValues||[],Mr=(ir=xr.API.processDataByFilters!==void 0?xr.API.processDataByFilters(ae,ke):{data:ae,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(ir.data.length!==0&&(cr.push({key:"Length",value:ir.data.length}),Fe===!0&&cr.push({key:"Length1",value:mt})),Mr.length!=0)if(Mr.split("/").length-1==1)cr.push({key:"Filter",value:Mr});else{cr.push({key:"Filter",value:"["+Mr+"]"});for(var tn=0;tn<cr.length;tn+=1)if(cr[tn].key==="DecodeParms"){for(var In=[],_=0;_<ir.reverseChain.split("/").length-1;_+=1)In.push("null");In.push(cr[tn].value),cr[tn].value="["+In.join(" ")+"]"}}oe("<<");for(var V=0;V<cr.length;V++)oe("/"+cr[V].key+" "+cr[V].value);oe(">>"),ir.data.length!==0&&(oe("stream"),oe(tr(ir.data)),oe("endstream"))},Ei=m.__private__.putPage=function(z){var ae=z.number,ke=z.data,Me=z.objId,Fe=z.contentsObjId;pr(Me,!0),oe("<</Type /Page"),oe("/Parent "+z.rootDictionaryObjId+" 0 R"),oe("/Resources "+z.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(I(z.mediaBox.bottomLeftX))+" "+parseFloat(I(z.mediaBox.bottomLeftY))+" "+I(z.mediaBox.topRightX)+" "+I(z.mediaBox.topRightY)+"]"),z.cropBox!==null&&oe("/CropBox ["+I(z.cropBox.bottomLeftX)+" "+I(z.cropBox.bottomLeftY)+" "+I(z.cropBox.topRightX)+" "+I(z.cropBox.topRightY)+"]"),z.bleedBox!==null&&oe("/BleedBox ["+I(z.bleedBox.bottomLeftX)+" "+I(z.bleedBox.bottomLeftY)+" "+I(z.bleedBox.topRightX)+" "+I(z.bleedBox.topRightY)+"]"),z.trimBox!==null&&oe("/TrimBox ["+I(z.trimBox.bottomLeftX)+" "+I(z.trimBox.bottomLeftY)+" "+I(z.trimBox.topRightX)+" "+I(z.trimBox.topRightY)+"]"),z.artBox!==null&&oe("/ArtBox ["+I(z.artBox.bottomLeftX)+" "+I(z.artBox.bottomLeftY)+" "+I(z.artBox.topRightX)+" "+I(z.artBox.topRightY)+"]"),typeof z.userUnit=="number"&&z.userUnit!==1&&oe("/UserUnit "+z.userUnit),Yt.publish("putPage",{objId:Me,pageContext:Tt[ae],pageNumber:ae,page:ke}),oe("/Contents "+Fe+" 0 R"),oe(">>"),oe("endobj");var mt=ke.join(`
`);return L===A&&(mt+=`
Q`),pr(Fe,!0),ss({data:mt,filters:Hr(),objectId:Fe}),oe("endobj"),Me},wi=m.__private__.putPages=function(){var z,ae,ke=[];for(z=1;z<=Ct;z++)Tt[z].objId=Vt(),Tt[z].contentsObjId=Vt();for(z=1;z<=Ct;z++)ke.push(Ei({number:z,data:Ce[z],objId:Tt[z].objId,contentsObjId:Tt[z].contentsObjId,mediaBox:Tt[z].mediaBox,cropBox:Tt[z].cropBox,bleedBox:Tt[z].bleedBox,trimBox:Tt[z].trimBox,artBox:Tt[z].artBox,userUnit:Tt[z].userUnit,rootDictionaryObjId:Yr,resourceDictionaryObjId:$r}));pr(Yr,!0),oe("<</Type /Pages");var Me="/Kids [";for(ae=0;ae<Ct;ae++)Me+=ke[ae]+" 0 R ";oe(Me+"]"),oe("/Count "+Ct),oe(">>"),oe("endobj"),Yt.publish("postPutPages")},$s=function(z){Yt.publish("putFont",{font:z,out:oe,newObject:It,putStream:ss}),z.isAlreadyPutted!==!0&&(z.objectNumber=It(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+zp(z.postScriptName)),oe("/Subtype /Type1"),typeof z.encoding=="string"&&oe("/Encoding /"+z.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},zi=function(z){z.objectNumber=It();var ae=[];ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Form"}),ae.push({key:"BBox",value:"["+[I(z.x),I(z.y),I(z.x+z.width),I(z.y+z.height)].join(" ")+"]"}),ae.push({key:"Matrix",value:"["+z.matrix.toString()+"]"});var ke=z.pages[1].join(`
`);ss({data:ke,additionalKeyValues:ae,objectId:z.objectNumber}),oe("endobj")},jn=function(z,ae){ae||(ae=21);var ke=It(),Me=(function(_t,tr){var ir,cr=[],Mr=1/(tr-1);for(ir=0;ir<1;ir+=Mr)cr.push(ir);if(cr.push(1),_t[0].offset!=0){var tn={offset:0,color:_t[0].color};_t.unshift(tn)}if(_t[_t.length-1].offset!=1){var In={offset:1,color:_t[_t.length-1].color};_t.push(In)}for(var _="",V=0,ie=0;ie<cr.length;ie++){for(ir=cr[ie];ir>_t[V+1].offset;)V++;var be=_t[V].offset,qe=(ir-be)/(_t[V+1].offset-be),st=_t[V].color,Dt=_t[V+1].color;_+=ce(Math.round((1-qe)*st[0]+qe*Dt[0]).toString(16))+ce(Math.round((1-qe)*st[1]+qe*Dt[1]).toString(16))+ce(Math.round((1-qe)*st[2]+qe*Dt[2]).toString(16))}return _.trim()})(z.colors,ae),Fe=[];Fe.push({key:"FunctionType",value:"0"}),Fe.push({key:"Domain",value:"[0.0 1.0]"}),Fe.push({key:"Size",value:"["+ae+"]"}),Fe.push({key:"BitsPerSample",value:"8"}),Fe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ss({data:Me,additionalKeyValues:Fe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ke}),oe("endobj"),z.objectNumber=It(),oe("<< /ShadingType "+z.type),oe("/ColorSpace /DeviceRGB");var mt="/Coords ["+I(parseFloat(z.coords[0]))+" "+I(parseFloat(z.coords[1]))+" ";z.type===2?mt+=I(parseFloat(z.coords[2]))+" "+I(parseFloat(z.coords[3])):mt+=I(parseFloat(z.coords[2]))+" "+I(parseFloat(z.coords[3]))+" "+I(parseFloat(z.coords[4]))+" "+I(parseFloat(z.coords[5])),oe(mt+="]"),z.matrix&&oe("/Matrix ["+z.matrix.toString()+"]"),oe("/Function "+ke+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},ze=function(z,ae){var ke=Vt(),Me=It();ae.push({resourcesOid:ke,objectOid:Me}),z.objectNumber=Me;var Fe=[];Fe.push({key:"Type",value:"/Pattern"}),Fe.push({key:"PatternType",value:"1"}),Fe.push({key:"PaintType",value:"1"}),Fe.push({key:"TilingType",value:"1"}),Fe.push({key:"BBox",value:"["+z.boundingBox.map(I).join(" ")+"]"}),Fe.push({key:"XStep",value:I(z.xStep)}),Fe.push({key:"YStep",value:I(z.yStep)}),Fe.push({key:"Resources",value:ke+" 0 R"}),z.matrix&&Fe.push({key:"Matrix",value:"["+z.matrix.toString()+"]"}),ss({data:z.stream,additionalKeyValues:Fe,objectId:z.objectNumber}),oe("endobj")},rt=function(z){for(var ae in z.objectNumber=It(),oe("<<"),z)switch(ae){case"opacity":oe("/ca "+k(z[ae]));break;case"stroke-opacity":oe("/CA "+k(z[ae]))}oe(">>"),oe("endobj")},ht=function(z){pr(z.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ae in oe("/Font <<"),Ot)Ot.hasOwnProperty(ae)&&(p===!1||p===!0&&x.hasOwnProperty(ae))&&oe("/"+ae+" "+Ot[ae].objectNumber+" 0 R");oe(">>")})(),(function(){if(Object.keys(At).length>0){for(var ae in oe("/Shading <<"),At)At.hasOwnProperty(ae)&&At[ae]instanceof qf&&At[ae].objectNumber>=0&&oe("/"+ae+" "+At[ae].objectNumber+" 0 R");Yt.publish("putShadingPatternDict"),oe(">>")}})(),(function(ae){if(Object.keys(At).length>0){for(var ke in oe("/Pattern <<"),At)At.hasOwnProperty(ke)&&At[ke]instanceof m.TilingPattern&&At[ke].objectNumber>=0&&At[ke].objectNumber<ae&&oe("/"+ke+" "+At[ke].objectNumber+" 0 R");Yt.publish("putTilingPatternDict"),oe(">>")}})(z.objectOid),(function(){if(Object.keys(qt).length>0){var ae;for(ae in oe("/ExtGState <<"),qt)qt.hasOwnProperty(ae)&&qt[ae].objectNumber>=0&&oe("/"+ae+" "+qt[ae].objectNumber+" 0 R");Yt.publish("putGStateDict"),oe(">>")}})(),(function(){for(var ae in oe("/XObject <<"),Lt)Lt.hasOwnProperty(ae)&&Lt[ae].objectNumber>=0&&oe("/"+ae+" "+Lt[ae].objectNumber+" 0 R");Yt.publish("putXobjectDict"),oe(">>")})(),oe(">>"),oe("endobj")},Rt=function(z){Et[z.fontName]=Et[z.fontName]||{},Et[z.fontName][z.fontStyle]=z.id},yr=function(z,ae,ke,Me,Fe){var mt={id:"F"+(Object.keys(Ot).length+1).toString(10),postScriptName:z,fontName:ae,fontStyle:ke,encoding:Me,isStandardFont:Fe||!1,metadata:{}};return Yt.publish("addFont",{font:mt,instance:this}),Ot[mt.id]=mt,Rt(mt),mt.id},Fr=m.__private__.pdfEscape=m.pdfEscape=function(z,ae){return(function(ke,Me){var Fe,mt,_t,tr,ir,cr,Mr,tn,In;if(_t=(Me=Me||{}).sourceEncoding||"Unicode",ir=Me.outputEncoding,(Me.autoencode||ir)&&Ot[lt].metadata&&Ot[lt].metadata[_t]&&Ot[lt].metadata[_t].encoding&&(tr=Ot[lt].metadata[_t].encoding,!ir&&Ot[lt].encoding&&(ir=Ot[lt].encoding),!ir&&tr.codePages&&(ir=tr.codePages[0]),typeof ir=="string"&&(ir=tr[ir]),ir)){for(Mr=!1,cr=[],Fe=0,mt=ke.length;Fe<mt;Fe++)(tn=ir[ke.charCodeAt(Fe)])?cr.push(String.fromCharCode(tn)):cr.push(ke[Fe]),cr[Fe].charCodeAt(0)>>8&&(Mr=!0);ke=cr.join("")}for(Fe=ke.length;Mr===void 0&&Fe!==0;)ke.charCodeAt(Fe-1)>>8&&(Mr=!0),Fe--;if(!Mr)return ke;for(cr=Me.noBOM?[]:[254,255],Fe=0,mt=ke.length;Fe<mt;Fe++){if((In=(tn=ke.charCodeAt(Fe))>>8)>>8)throw new Error("Character at position "+Fe+" of string '"+ke+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");cr.push(In),cr.push(tn-(In<<8))}return String.fromCharCode.apply(void 0,cr)})(z,ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mn=m.__private__.beginPage=function(z){Ce[++Ct]=[],Tt[Ct]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(z[0]),topRightY:Number(z[1])}},qi(Ct),Te(Ce[Y])},ps=function(z,ae){var ke,Me,Fe;switch(r=ae||r,typeof z=="string"&&(ke=N(z.toLowerCase()),Array.isArray(ke)&&(Me=ke[0],Fe=ke[1])),Array.isArray(z)&&(Me=z[0]*kt,Fe=z[1]*kt),isNaN(Me)&&(Me=i[0],Fe=i[1]),(Me>14400||Fe>14400)&&(vs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),Fe=Math.min(14400,Fe)),i=[Me,Fe],r.substr(0,1)){case"l":Fe>Me&&(i=[Fe,Me]);break;case"p":Me>Fe&&(i=[Fe,Me])}Mn(i),lr(Qs),oe(ci),Le!==0&&oe(Le+" J"),at!==0&&oe(at+" j"),Yt.publish("addPage",{pageNumber:Ct})},_r=function(z){z>0&&z<=Ct&&(Ce.splice(z,1),Tt.splice(z,1),Ct--,Y>Ct&&(Y=Ct),this.setPage(Y))},qi=function(z){z>0&&z<=Ct&&(Y=z)},Ya=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ce.length-1},al=function(z,ae,ke){var Me,Fe=void 0;return ke=ke||{},z=z!==void 0?z:Ot[lt].fontName,ae=ae!==void 0?ae:Ot[lt].fontStyle,Me=z.toLowerCase(),Et[Me]!==void 0&&Et[Me][ae]!==void 0?Fe=Et[Me][ae]:Et[z]!==void 0&&Et[z][ae]!==void 0?Fe=Et[z][ae]:ke.disableWarning===!1&&vs.warn("Unable to look up font label for font '"+z+"', '"+ae+"'. Refer to getFontList() for available fonts."),Fe||ke.noFallback||(Fe=Et.times[ae])==null&&(Fe=Et.times.normal),Fe},ji=m.__private__.putInfo=function(){var z=It(),ae=function(Me){return Me};for(var ke in f!==null&&(ae=Fn.encryptor(z,0)),oe("<<"),oe("/Producer ("+Fr(ae("jsPDF "+xr.version))+")"),Ve)Ve.hasOwnProperty(ke)&&Ve[ke]&&oe("/"+ke.substr(0,1).toUpperCase()+ke.substr(1)+" ("+Fr(ae(Ve[ke]))+")");oe("/CreationDate ("+Fr(ae(X))+")"),oe(">>"),oe("endobj")},Fs=m.__private__.putCatalog=function(z){var ae=(z=z||{}).rootDictionaryObjId||Yr;switch(It(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+ae+" 0 R"),Ge||(Ge="fullwidth"),Ge){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ke=""+Ge;ke.substr(ke.length-1)==="%"&&(Ge=parseInt(Ge)/100),typeof Ge=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+k(Ge)+"]")}switch(ct||(ct="continuous"),ct){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}Ae&&oe("/PageMode /"+Ae),Yt.publish("putCatalog"),oe(">>"),oe("endobj")},is=m.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(xe+1)),oe("/Root "+xe+" 0 R"),oe("/Info "+(xe-1)+" 0 R"),f!==null&&oe("/Encrypt "+Fn.oid+" 0 R"),oe("/ID [ <"+G+"> <"+G+"> ]"),oe(">>")},Rr=m.__private__.putHeader=function(){oe("%PDF-"+y),oe("%")},Hi=m.__private__.putXRef=function(){var z="0000000000";oe("xref"),oe("0 "+(xe+1)),oe("0000000000 65535 f ");for(var ae=1;ae<=xe;ae++)typeof ue[ae]=="function"?oe((z+ue[ae]()).slice(-10)+" 00000 n "):ue[ae]!==void 0?oe((z+ue[ae]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},Us=m.__private__.buildDocument=function(){var z;xe=0,Q=0,ve=[],ue=[],pe=[],Yr=Vt(),$r=Vt(),Te(ve),Yt.publish("buildDocument"),Rr(),wi(),(function(){Yt.publish("putAdditionalObjects");for(var ke=0;ke<pe.length;ke++){var Me=pe[ke];pr(Me.objId,!0),oe(Me.content),oe("endobj")}Yt.publish("postPutAdditionalObjects")})(),z=[],(function(){for(var ke in Ot)Ot.hasOwnProperty(ke)&&(p===!1||p===!0&&x.hasOwnProperty(ke))&&$s(Ot[ke])})(),(function(){var ke;for(ke in qt)qt.hasOwnProperty(ke)&&rt(qt[ke])})(),(function(){for(var ke in Lt)Lt.hasOwnProperty(ke)&&zi(Lt[ke])})(),(function(ke){var Me;for(Me in At)At.hasOwnProperty(Me)&&(At[Me]instanceof qf?jn(At[Me]):At[Me]instanceof Wp&&ze(At[Me],ke))})(z),Yt.publish("putResources"),z.forEach(ht),ht({resourcesOid:$r,objectOid:Number.MAX_SAFE_INTEGER}),Yt.publish("postPutResources"),f!==null&&(Fn.oid=It(),oe("<<"),oe("/Filter /Standard"),oe("/V "+Fn.v),oe("/R "+Fn.r),oe("/U <"+Fn.toHexString(Fn.U)+">"),oe("/O <"+Fn.toHexString(Fn.O)+">"),oe("/P "+Fn.P),oe(">>"),oe("endobj")),ji(),Fs();var ae=Q;return Hi(),is(),oe("startxref"),oe(""+ae),oe("%%EOF"),Te(Ce[Y]),ve.join(`
`)},Kr=m.__private__.getBlob=function(z){return new Blob([Nt(z)],{type:"application/pdf"})},_a=m.output=m.__private__.output=(Ut=function(z,ae){switch(typeof(ae=ae||{})=="string"?ae={filename:ae}:ae.filename=ae.filename||"generated.pdf",z){case void 0:return Us();case"save":m.save(ae.filename);break;case"arraybuffer":return Nt(Us());case"blob":return Kr(Us());case"bloburi":case"bloburl":if(Ir.URL!==void 0&&typeof Ir.URL.createObjectURL=="function")return Ir.URL&&Ir.URL.createObjectURL(Kr(Us()))||void 0;vs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ke="",Me=Us();try{ke=WP(Me)}catch{ke=WP(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+ae.filename+";base64,"+ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var Fe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ae.pdfObjectUrl&&(Fe=ae.pdfObjectUrl,mt="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Fe+'"'+mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ae)+");<\/script></body></html>",tr=Ir.open();return tr!==null&&tr.document.write(_t),tr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ae.filename+'" width="500px" height="400px" /></body></html>',cr=Ir.open();if(cr!==null){cr.document.write(ir);var Mr=this;cr.document.documentElement.querySelector("#pdfViewer").onload=function(){cr.document.title=ae.filename,cr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Mr.output("bloburl"))}}return cr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ir)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var tn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ae)+'"></iframe></body></html>',In=Ir.open();if(In!==null&&(In.document.write(tn),In.document.title=ae.filename),In||typeof safari>"u")return In;break;case"datauri":case"dataurl":return Ir.document.location.href=this.output("datauristring",ae);default:return null}},Ut.foo=function(){try{return Ut.apply(this,arguments)}catch(ke){var z=ke.stack||"";~z.indexOf(" at ")&&(z=z.split(" at ")[1]);var ae="Error in function "+z.split(`
`)[0].split("<")[0]+": "+ke.message;if(!Ir.console)throw new Error(ae);Ir.console.error(ae,ke),Ir.alert&&alert(ae)}},Ut.foo.bar=Ut,Ut.foo),ms=function(z){return Array.isArray(Be)===!0&&Be.indexOf(z)>-1};switch(n){case"pt":kt=1;break;case"mm":kt=72/25.4;break;case"cm":kt=72/2.54;break;case"in":kt=72;break;case"px":kt=ms("px_scaling")==1?.75:96/72;break;case"pc":case"em":kt=12;break;case"ex":kt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);kt=n}var Fn=null;W(),ee();var as=m.__private__.getPageInfo=m.getPageInfo=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Tt[z].objId,pageNumber:z,pageContext:Tt[z]}},lo=m.__private__.getPageInfoByObjId=function(z){if(isNaN(z)||z%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ae in Tt)if(Tt[ae].objId===z)break;return as(ae)},Mo=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Tt[Y].objId,pageNumber:Y,pageContext:Tt[Y]}};m.addPage=function(){return ps.apply(this,arguments),this},m.setPage=function(){return qi.apply(this,arguments),Te.call(this,Ce[Y]),this},m.insertPage=function(z){return this.addPage(),this.movePage(Y,z),this},m.movePage=function(z,ae){var ke,Me;if(z>ae){ke=Ce[z],Me=Tt[z];for(var Fe=z;Fe>ae;Fe--)Ce[Fe]=Ce[Fe-1],Tt[Fe]=Tt[Fe-1];Ce[ae]=ke,Tt[ae]=Me,this.setPage(ae)}else if(z<ae){ke=Ce[z],Me=Tt[z];for(var mt=z;mt<ae;mt++)Ce[mt]=Ce[mt+1],Tt[mt]=Tt[mt+1];Ce[ae]=ke,Tt[ae]=Me,this.setPage(ae)}return this},m.deletePage=function(){return _r.apply(this,arguments),this},m.__private__.text=m.text=function(z,ae,ke,Me,Fe){var mt,_t,tr,ir,cr,Mr,tn,In,_,V=(Me=Me||{}).scope||this;if(typeof z=="number"&&typeof ae=="number"&&(typeof ke=="string"||Array.isArray(ke))){var ie=ke;ke=ae,ae=z,z=ie}if(arguments[3]instanceof He==0?(tr=arguments[4],ir=arguments[5],rs(tn=arguments[3])==="object"&&tn!==null||(typeof tr=="string"&&(ir=tr,tr=null),typeof tn=="string"&&(ir=tn,tn=null),typeof tn=="number"&&(tr=tn,tn=null),Me={flags:tn,angle:tr,align:ir})):(B("The transform parameter of text() with a Matrix value"),_=Fe),isNaN(ae)||isNaN(ke)||z==null)throw new Error("Invalid arguments passed to jsPDF.text");if(z.length===0)return V;var be,qe="",st=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:Kn,Dt=V.internal.scaleFactor;function Ar(Ln){return Ln=Ln.split("	").join(Array(Me.TabLen||9).join(" ")),Fr(Ln,tn)}function gs(Ln){for(var gn,ls=Ln.concat(),ti=[],Pl=ls.length;Pl--;)typeof(gn=ls.shift())=="string"?ti.push(gn):Array.isArray(Ln)&&(gn.length===1||gn[1]===void 0&&gn[2]===void 0)?ti.push(gn[0]):ti.push([gn[0],gn[1],gn[2]]);return ti}function un(Ln,gn){var ls;if(typeof Ln=="string")ls=gn(Ln)[0];else if(Array.isArray(Ln)){for(var ti,Pl,hl=Ln.concat(),Ud=[],yf=hl.length;yf--;)typeof(ti=hl.shift())=="string"?Ud.push(gn(ti)[0]):Array.isArray(ti)&&typeof ti[0]=="string"&&(Pl=gn(ti[0],ti[1],ti[2]),Ud.push([Pl[0],Pl[1],Pl[2]]));ls=Ud}return ls}var zn=!1,zs=!0;if(typeof z=="string")zn=!0;else if(Array.isArray(z)){var Ma=z.concat();_t=[];for(var Oi,Xn=Ma.length;Xn--;)(typeof(Oi=Ma.shift())!="string"||Array.isArray(Oi)&&typeof Oi[0]!="string")&&(zs=!1);zn=zs}if(zn===!1)throw new Error('Type of text must be string or Array. "'+z+'" is not recognized.');typeof z=="string"&&(z=z.match(/[\r?\n]/)?z.split(/\r\n|\r|\n/g):[z]);var co=Ne/V.internal.scaleFactor,Ro=co*(st-1);switch(Me.baseline){case"bottom":ke-=Ro;break;case"top":ke+=co-Ro;break;case"hanging":ke+=co-2*Ro;break;case"middle":ke+=co/2-Ro}if((Mr=Me.maxWidth||0)>0&&(typeof z=="string"?z=V.splitTextToSize(z,Mr):Object.prototype.toString.call(z)==="[object Array]"&&(z=z.reduce(function(Ln,gn){return Ln.concat(V.splitTextToSize(gn,Mr))},[]))),mt={text:z,x:ae,y:ke,options:Me,mutex:{pdfEscape:Fr,activeFontKey:lt,fonts:Ot,activeFontSize:Ne}},Yt.publish("preProcessText",mt),z=mt.text,tr=(Me=mt.options).angle,_ instanceof He==0&&tr&&typeof tr=="number"){tr*=Math.PI/180,Me.rotationDirection===0&&(tr=-tr),L===A&&(tr=-tr);var eh=Math.cos(tr),Al=Math.sin(tr);_=new He(eh,Al,-Al,eh,0,0)}else tr&&tr instanceof He&&(_=tr);L!==A||_||(_=Gt),(cr=Me.charSpace||K)!==void 0&&(qe+=I(P(cr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(In=Me.horizontalScale)!==void 0&&(qe+=I(100*In)+` Tz
`),Me.lang;var Pa=-1,ic=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,th=V.internal.getCurrentPageInfo().pageContext;switch(ic){case 0:case!1:case"fill":Pa=0;break;case 1:case!0:case"stroke":Pa=1;break;case 2:case"fillThenStroke":Pa=2;break;case 3:case"invisible":Pa=3;break;case 4:case"fillAndAddForClipping":Pa=4;break;case 5:case"strokeAndAddPathForClipping":Pa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Pa=6;break;case 7:case"addToPathForClipping":Pa=7}var xf=th.usedRenderingMode!==void 0?th.usedRenderingMode:-1;Pa!==-1?qe+=Pa+` Tr
`:xf!==-1&&(qe+=`0 Tr
`),Pa!==-1&&(th.usedRenderingMode=Pa),ir=Me.align||"left";var uo,dl=Ne*st,ac=V.internal.pageSize.getWidth(),bf=Ot[lt];cr=Me.charSpace||K,Mr=Me.maxWidth||0,tn=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var ul=[],Yc=function(Ln){return V.getStringUnitWidth(Ln,{font:bf,charSpace:cr,fontSize:Ne,doKerning:!1})*Ne/Dt};if(Object.prototype.toString.call(z)==="[object Array]"){var Ja;_t=gs(z),ir!=="left"&&(uo=_t.map(Yc));var Ia,El=0;if(ir==="right"){ae-=uo[0],z=[],Xn=_t.length;for(var Tl=0;Tl<Xn;Tl++)Tl===0?(Ia=Ns(ae),Ja=os(ke)):(Ia=P(El-uo[Tl]),Ja=-dl),z.push([_t[Tl],Ia,Ja]),El=uo[Tl]}else if(ir==="center"){ae-=uo[0]/2,z=[],Xn=_t.length;for(var oc=0;oc<Xn;oc++)oc===0?(Ia=Ns(ae),Ja=os(ke)):(Ia=P((El-uo[oc])/2),Ja=-dl),z.push([_t[oc],Ia,Ja]),El=uo[oc]}else if(ir==="left"){z=[],Xn=_t.length;for(var rh=0;rh<Xn;rh++)z.push(_t[rh])}else if(ir==="justify"&&bf.encoding==="Identity-H"){z=[],Xn=_t.length,Mr=Mr!==0?Mr:ac;for(var nh=0,ei=0;ei<Xn;ei++)if(Ja=ei===0?os(ke):-dl,Ia=ei===0?Ns(ae):nh,ei<Xn-1){var G0=P((Mr-uo[ei])/(_t[ei].split(" ").length-1)),Ll=_t[ei].split(" ");z.push([Ll[0]+" ",Ia,Ja]),nh=0;for(var Ol=1;Ol<Ll.length;Ol++){var Gi=(Yc(Ll[Ol-1]+" "+Ll[Ol])-Yc(Ll[Ol]))*Dt+G0;Ol==Ll.length-1?z.push([Ll[Ol],Gi,0]):z.push([Ll[Ol]+" ",Gi,0]),nh-=Gi}}else z.push([_t[ei],Ia,Ja]);z.push(["",nh,0])}else{if(ir!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(z=[],Xn=_t.length,Mr=Mr!==0?Mr:ac,ei=0;ei<Xn;ei++){Ja=ei===0?os(ke):-dl,Ia=ei===0?Ns(ae):0;var lc=_t[ei].split(" ").length-1,sh=lc>0?(Mr-uo[ei])/lc:0;ei<Xn-1?ul.push(I(P(sh))):ul.push(0),z.push([_t[ei],Ia,Ja])}}}(typeof Me.R2L=="boolean"?Me.R2L:xt)===!0&&(z=un(z,function(Ln,gn,ls){return[Ln.split("").reverse().join(""),gn,ls]})),mt={text:z,x:ae,y:ke,options:Me,mutex:{pdfEscape:Fr,activeFontKey:lt,fonts:Ot,activeFontSize:Ne}},Yt.publish("postProcessText",mt),z=mt.text,be=mt.mutex.isHex||!1;var ih=Ot[lt].encoding;ih!=="WinAnsiEncoding"&&ih!=="StandardEncoding"||(z=un(z,function(Ln,gn,ls){return[Ar(Ln),gn,ls]})),_t=gs(z),z=[];for(var cc,dc,Ml,Fd=Array.isArray(_t[0])?1:0,ho="",uc=function(Ln,gn,ls){var ti="";return ls instanceof He?(ls=typeof Me.angle=="number"?Mt(ls,new He(1,0,0,1,Ln,gn)):Mt(new He(1,0,0,1,Ln,gn),ls),L===A&&(ls=Mt(new He(1,0,0,-1,0,0),ls)),ti=ls.join(" ")+` Tm
`):ti=I(Ln)+" "+I(gn)+` Td
`,ti},ca=0;ca<_t.length;ca++){switch(ho="",Fd){case 1:Ml=(be?"<":"(")+_t[ca][0]+(be?">":")"),cc=parseFloat(_t[ca][1]),dc=parseFloat(_t[ca][2]);break;case 0:Ml=(be?"<":"(")+_t[ca]+(be?">":")"),cc=Ns(ae),dc=os(ke)}ul!==void 0&&ul[ca]!==void 0&&(ho=ul[ca]+` Tw
`),ca===0?z.push(ho+uc(cc,dc,_)+Ml):Fd===0?z.push(ho+Ml):Fd===1&&z.push(ho+uc(cc,dc,_)+Ml)}z=Fd===0?z.join(` Tj
T* `):z.join(` Tj
`),z+=` Tj
`;var Do=`BT
/`;return Do+=lt+" "+Ne+` Tf
`,Do+=I(Ne*st)+` TL
`,Do+=Wi+`
`,Do+=qe,Do+=z,oe(Do+="ET"),x[lt]=!0,V};var ol=m.__private__.clip=m.clip=function(z){return oe(z==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return ol("evenodd")},m.__private__.discardPath=m.discardPath=function(){return oe("n"),this};var Zs=m.__private__.isValidStyle=function(z){var ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(z)!==-1&&(ae=!0),ae};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(z){return Zs(z)&&(u=z),this};var Ca=m.__private__.getStyle=m.getStyle=function(z){var ae=u;switch(z){case"D":case"S":ae="S";break;case"F":ae="f";break;case"FD":case"DF":ae="B";break;case"f":case"f*":case"B":case"B*":ae=z}return ae},Es=m.close=function(){return oe("h"),this};m.stroke=function(){return oe("S"),this},m.fill=function(z){return Un("f",z),this},m.fillEvenOdd=function(z){return Un("f*",z),this},m.fillStroke=function(z){return Un("B",z),this},m.fillStrokeEvenOdd=function(z){return Un("B*",z),this};var Un=function(z,ae){rs(ae)==="object"?Ti(ae,z):oe(z)},oi=function(z){z===null||L===A&&z===void 0||(z=Ca(z),oe(z))};function ll(z,ae,ke,Me,Fe){var mt=new Wp(ae||this.boundingBox,ke||this.xStep,Me||this.yStep,this.gState,Fe||this.matrix);mt.stream=this.stream;var _t=z+"$$"+this.cloneIndex+++"$$";return Zt(_t,mt),mt}var Ti=function(z,ae){var ke=Xt[z.key],Me=At[ke];if(Me instanceof qf)oe("q"),oe(Po(ae)),Me.gState&&m.setGState(Me.gState),oe(z.matrix.toString()+" cm"),oe("/"+ke+" sh"),oe("Q");else if(Me instanceof Wp){var Fe=new He(1,0,0,-1,0,Ts());z.matrix&&(Fe=Fe.multiply(z.matrix||Gt),ke=ll.call(Me,z.key,z.boundingBox,z.xStep,z.yStep,Fe).id),oe("q"),oe("/Pattern cs"),oe("/"+ke+" scn"),Me.gState&&m.setGState(Me.gState),oe(ae),oe("Q")}},Po=function(z){switch(z){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Io=m.moveTo=function(z,ae){return oe(I(P(z))+" "+I(q(ae))+" m"),this},Aa=m.lineTo=function(z,ae){return oe(I(P(z))+" "+I(q(ae))+" l"),this},li=m.curveTo=function(z,ae,ke,Me,Fe,mt){return oe([I(P(z)),I(q(ae)),I(P(ke)),I(q(Me)),I(P(Fe)),I(q(mt)),"c"].join(" ")),this};m.__private__.line=m.line=function(z,ae,ke,Me,Fe){if(isNaN(z)||isNaN(ae)||isNaN(ke)||isNaN(Me)||!Zs(Fe))throw new Error("Invalid arguments passed to jsPDF.line");return L===C?this.lines([[ke-z,Me-ae]],z,ae,[1,1],Fe||"S"):this.lines([[ke-z,Me-ae]],z,ae,[1,1]).stroke()},m.__private__.lines=m.lines=function(z,ae,ke,Me,Fe,mt){var _t,tr,ir,cr,Mr,tn,In,_,V,ie,be,qe;if(typeof z=="number"&&(qe=ke,ke=ae,ae=z,z=qe),Me=Me||[1,1],mt=mt||!1,isNaN(ae)||isNaN(ke)||!Array.isArray(z)||!Array.isArray(Me)||!Zs(Fe)||typeof mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Io(ae,ke),_t=Me[0],tr=Me[1],cr=z.length,ie=ae,be=ke,ir=0;ir<cr;ir++)(Mr=z[ir]).length===2?(ie=Mr[0]*_t+ie,be=Mr[1]*tr+be,Aa(ie,be)):(tn=Mr[0]*_t+ie,In=Mr[1]*tr+be,_=Mr[2]*_t+ie,V=Mr[3]*tr+be,ie=Mr[4]*_t+ie,be=Mr[5]*tr+be,li(tn,In,_,V,ie,be));return mt&&Es(),oi(Fe),this},m.path=function(z){for(var ae=0;ae<z.length;ae++){var ke=z[ae],Me=ke.c;switch(ke.op){case"m":Io(Me[0],Me[1]);break;case"l":Aa(Me[0],Me[1]);break;case"c":li.apply(this,Me);break;case"h":Es()}}return this},m.__private__.rect=m.rect=function(z,ae,ke,Me,Fe){if(isNaN(z)||isNaN(ae)||isNaN(ke)||isNaN(Me)||!Zs(Fe))throw new Error("Invalid arguments passed to jsPDF.rect");return L===C&&(Me=-Me),oe([I(P(z)),I(q(ae)),I(P(ke)),I(P(Me)),"re"].join(" ")),oi(Fe),this},m.__private__.triangle=m.triangle=function(z,ae,ke,Me,Fe,mt,_t){if(isNaN(z)||isNaN(ae)||isNaN(ke)||isNaN(Me)||isNaN(Fe)||isNaN(mt)||!Zs(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ke-z,Me-ae],[Fe-ke,mt-Me],[z-Fe,ae-mt]],z,ae,[1,1],_t,!0),this},m.__private__.roundedRect=m.roundedRect=function(z,ae,ke,Me,Fe,mt,_t){if(isNaN(z)||isNaN(ae)||isNaN(ke)||isNaN(Me)||isNaN(Fe)||isNaN(mt)||!Zs(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var tr=4/3*(Math.SQRT2-1);return Fe=Math.min(Fe,.5*ke),mt=Math.min(mt,.5*Me),this.lines([[ke-2*Fe,0],[Fe*tr,0,Fe,mt-mt*tr,Fe,mt],[0,Me-2*mt],[0,mt*tr,-Fe*tr,mt,-Fe,mt],[2*Fe-ke,0],[-Fe*tr,0,-Fe,-mt*tr,-Fe,-mt],[0,2*mt-Me],[0,-mt*tr,Fe*tr,-mt,Fe,-mt]],z+Fe,ae,[1,1],_t,!0),this},m.__private__.ellipse=m.ellipse=function(z,ae,ke,Me,Fe){if(isNaN(z)||isNaN(ae)||isNaN(ke)||isNaN(Me)||!Zs(Fe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var mt=4/3*(Math.SQRT2-1)*ke,_t=4/3*(Math.SQRT2-1)*Me;return Io(z+ke,ae),li(z+ke,ae-_t,z+mt,ae-Me,z,ae-Me),li(z-mt,ae-Me,z-ke,ae-_t,z-ke,ae),li(z-ke,ae+_t,z-mt,ae+Me,z,ae+Me),li(z+mt,ae+Me,z+ke,ae+_t,z+ke,ae),oi(Fe),this},m.__private__.circle=m.circle=function(z,ae,ke,Me){if(isNaN(z)||isNaN(ae)||isNaN(ke)||!Zs(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(z,ae,ke,ke,Me)},m.setFont=function(z,ae,ke){return ke&&(ae=T(ae,ke)),lt=al(z,ae,{disableWarning:!1}),this};var Li=m.__private__.getFont=m.getFont=function(){return Ot[al.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var z,ae,ke={};for(z in Et)if(Et.hasOwnProperty(z))for(ae in ke[z]=[],Et[z])Et[z].hasOwnProperty(ae)&&ke[z].push(ae);return ke},m.addFont=function(z,ae,ke,Me,Fe){var mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&mt.indexOf(arguments[3])!==-1?Fe=arguments[3]:arguments[3]&&mt.indexOf(arguments[3])==-1&&(ke=T(ke,Me)),yr.call(this,z,ae,ke,Fe=Fe||"Identity-H")};var Kn,Qs=t.lineWidth||.200025,Ea=m.__private__.getLineWidth=m.getLineWidth=function(){return Qs},lr=m.__private__.setLineWidth=m.setLineWidth=function(z){return Qs=z,oe(I(P(z))+" w"),this};m.__private__.setLineDash=xr.API.setLineDash=xr.API.setLineDashPattern=function(z,ae){if(z=z||[],ae=ae||0,isNaN(ae)||!Array.isArray(z))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return z=z.map(function(ke){return I(P(ke))}).join(" "),ae=I(P(ae)),oe("["+z+"] "+ae+" d"),this};var Ta=m.__private__.getLineHeight=m.getLineHeight=function(){return Ne*Kn};m.__private__.getLineHeight=m.getLineHeight=function(){return Ne*Kn};var La=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(z){return typeof(z=z||1.15)=="number"&&(Kn=z),this},Ka=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Kn};La(t.lineHeight);var Ns=m.__private__.getHorizontalCoordinate=function(z){return P(z)},os=m.__private__.getVerticalCoordinate=function(z){return L===A?z:Tt[Y].mediaBox.topRightY-Tt[Y].mediaBox.bottomLeftY-P(z)},Xa=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(z){return I(Ns(z))},Gr=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(z){return I(os(z))},ci=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Qr(ci)},m.__private__.setStrokeColor=m.setDrawColor=function(z,ae,ke,Me){return ci=pn({ch1:z,ch2:ae,ch3:ke,ch4:Me,pdfColorType:"draw",precision:2}),oe(ci),this};var Oa=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Qr(Oa)},m.__private__.setFillColor=m.setFillColor=function(z,ae,ke,Me){return Oa=pn({ch1:z,ch2:ae,ch3:ke,ch4:Me,pdfColorType:"fill",precision:2}),oe(Oa),this};var Wi=t.textColor||"0 g",cl=m.__private__.getTextColor=m.getTextColor=function(){return Qr(Wi)};m.__private__.setTextColor=m.setTextColor=function(z,ae,ke,Me){return Wi=pn({ch1:z,ch2:ae,ch3:ke,ch4:Me,pdfColorType:"text",precision:3}),this};var K=t.charSpace,me=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(K||0)};m.__private__.setCharSpace=m.setCharSpace=function(z){if(isNaN(z))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return K=z,this};var Le=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(z){var ae=m.CapJoinStyles[z];if(ae===void 0)throw new Error("Line cap style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Le=ae,oe(ae+" J"),this};var at=0;m.__private__.setLineJoin=m.setLineJoin=function(z){var ae=m.CapJoinStyles[z];if(ae===void 0)throw new Error("Line join style of '"+z+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return at=ae,oe(ae+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(z){if(z=z||0,isNaN(z))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(I(P(z))+" M"),this},m.GState=w2,m.setGState=function(z){(z=typeof z=="string"?qt[Ht[z]]:gr(null,z)).equals(jr)||(oe("/"+z.id+" gs"),jr=z)};var gr=function(z,ae){if(!z||!Ht[z]){var ke=!1;for(var Me in qt)if(qt.hasOwnProperty(Me)&&qt[Me].equals(ae)){ke=!0;break}if(ke)ae=qt[Me];else{var Fe="GS"+(Object.keys(qt).length+1).toString(10);qt[Fe]=ae,ae.id=Fe}return z&&(Ht[z]=ae.id),Yt.publish("addGState",ae),ae}};m.addGState=function(z,ae){return gr(z,ae),this},m.saveGraphicsState=function(){return oe("q"),$t.push({key:lt,size:Ne,color:Wi}),this},m.restoreGraphicsState=function(){oe("Q");var z=$t.pop();return lt=z.key,Ne=z.size,Wi=z.color,jr=null,this},m.setCurrentTransformationMatrix=function(z){return oe(z.toString()+" cm"),this},m.comment=function(z){return oe("#"+z),this};var Kt=function(z,ae){var ke=z||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ke},set:function(mt){isNaN(mt)||(ke=parseFloat(mt))}});var Me=ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(mt){isNaN(mt)||(Me=parseFloat(mt))}});var Fe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Fe},set:function(mt){Fe=mt.toString()}}),this},Or=function(z,ae,ke,Me){Kt.call(this,z,ae),this.type="rect";var Fe=ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Fe},set:function(_t){isNaN(_t)||(Fe=parseFloat(_t))}});var mt=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return mt},set:function(_t){isNaN(_t)||(mt=parseFloat(_t))}}),this},Dr=function(){this.page=Ct,this.currentPage=Y,this.pages=Ce.slice(0),this.pagesContext=Tt.slice(0),this.x=Ue,this.y=Bt,this.matrix=zt,this.width=Tn(Y),this.height=Vn(Y),this.outputDestination=we,this.id="",this.objectNumber=-1};Dr.prototype.restore=function(){Ct=this.page,Y=this.currentPage,Tt=this.pagesContext,Ce=this.pages,Ue=this.x,Bt=this.y,zt=this.matrix,ks(Y,this.width),Nn(Y,this.height),we=this.outputDestination};var mn=function(z,ae,ke,Me,Fe){Ee.push(new Dr),Ct=Y=0,Ce=[],Ue=z,Bt=ae,zt=Fe,Mn([ke,Me])};for(var Br in m.beginFormObject=function(z,ae,ke,Me,Fe){return mn(z,ae,ke,Me,Fe),this},m.endFormObject=function(z){return(function(ae){if(Ft[ae])Ee.pop().restore();else{var ke=new Dr,Me="Xo"+(Object.keys(Lt).length+1).toString(10);ke.id=Me,Ft[ae]=Me,Lt[Me]=ke,Yt.publish("addFormObject",ke),Ee.pop().restore()}})(z),this},m.doFormObject=function(z,ae){var ke=Lt[Ft[z]];return oe("q"),oe(ae.toString()+" cm"),oe("/"+ke.id+" Do"),oe("Q"),this},m.getFormObject=function(z){var ae=Lt[Ft[z]];return{x:ae.x,y:ae.y,width:ae.width,height:ae.height,matrix:ae.matrix}},m.save=function(z,ae){return z=z||"generated.pdf",(ae=ae||{}).returnPromise=ae.returnPromise||!1,ae.returnPromise===!1?(Df(Kr(Us()),z),typeof Df.unload=="function"&&Ir.setTimeout&&setTimeout(Df.unload,911),this):new Promise(function(ke,Me){try{var Fe=Df(Kr(Us()),z);typeof Df.unload=="function"&&Ir.setTimeout&&setTimeout(Df.unload,911),ke(Fe)}catch(mt){Me(mt.message)}})},xr.API)xr.API.hasOwnProperty(Br)&&(Br==="events"&&xr.API.events.length?(function(z,ae){var ke,Me,Fe;for(Fe=ae.length-1;Fe!==-1;Fe--)ke=ae[Fe][0],Me=ae[Fe][1],z.subscribe.apply(z,[ke].concat(typeof Me=="function"?[Me]:Me))})(Yt,xr.API.events):m[Br]=xr.API[Br]);function Tn(z){return Tt[z].mediaBox.topRightX-Tt[z].mediaBox.bottomLeftX}function ks(z,ae){Tt[z].mediaBox.topRightX=ae+Tt[z].mediaBox.bottomLeftX}function Vn(z){return Tt[z].mediaBox.topRightY-Tt[z].mediaBox.bottomLeftY}function Nn(z,ae){Tt[z].mediaBox.topRightY=ae+Tt[z].mediaBox.bottomLeftY}var Pn=m.getPageWidth=function(z){return Tn(z=z||Y)/kt},oa=m.setPageWidth=function(z,ae){ks(z,ae*kt)},Ts=m.getPageHeight=function(z){return Vn(z=z||Y)/kt},la=m.setPageHeight=function(z,ae){Nn(z,ae*kt)};return m.internal={pdfEscape:Fr,getStyle:Ca,getFont:Li,getFontSize:Xe,getCharSpace:me,getTextColor:cl,getLineHeight:Ta,getLineHeightFactor:Ka,getLineWidth:Ea,write:De,getHorizontalCoordinate:Ns,getVerticalCoordinate:os,getCoordinateString:Xa,getVerticalCoordinateString:Gr,collections:{},newObject:It,newAdditionalObject:en,newObjectDeferred:Vt,newObjectDeferredBegin:pr,getFilters:Hr,putStream:ss,events:Yt,scaleFactor:kt,pageSize:{getWidth:function(){return Pn(Y)},setWidth:function(z){oa(Y,z)},getHeight:function(){return Ts(Y)},setHeight:function(z){la(Y,z)}},encryptionOptions:f,encryption:Fn,getEncryptor:function(z){return f!==null?Fn.encryptor(z,0):function(ae){return ae}},output:_a,getNumberOfPages:Ya,get pages(){return Ce},out:oe,f2:k,f3:R,getPageInfo:as,getPageInfoByObjId:lo,getCurrentPageInfo:Mo,getPDFVersion:v,Point:Kt,Rectangle:Or,Matrix:He,hasHotfix:ms},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Pn(Y)},set:function(z){oa(Y,z)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Ts(Y)},set:function(z){la(Y,z)},enumerable:!0,configurable:!0}),(function(z){for(var ae=0,ke=ot.length;ae<ke;ae++){var Me=yr.call(this,z[ae][0],z[ae][1],z[ae][2],ot[ae][3],!0);p===!1&&(x[Me]=!0);var Fe=z[ae][0].split("-");Rt({id:Me,fontName:Fe[0],fontStyle:Fe[1]||""})}Yt.publish("addFonts",{fonts:Ot,dictionary:Et})}).call(m,ot),lt="F1",ps(i,r),Yt.publish("initialized"),m}Up.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Up.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Up.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Up.prototype.processOwnerPassword=function(t,e){return QS(ZS(e).substr(0,5),t)},Up.prototype.encryptor=function(t,e){var r=ZS(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return QS(r,n)}},w2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||rs(t)!==rs(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},xr.API={events:[]},xr.version="4.0.0";var xi=xr.API,$C=1,F0=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Tp=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},qr=function(t){return t.toFixed(2)},Oh=function(t){return t.toFixed(5)};xi.__acroform__={};var sl=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},KP=function(t){return t*$C},ud=function(t){var e=new jW,r=or.internal.getHeight(t)||0,n=or.internal.getWidth(t)||0;return e.BBox=[0,0,Number(qr(n)),Number(qr(r))],e},L5e=xi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},O5e=xi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},M5e=xi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},_i=xi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return M5e(t,e-1)},Ci=xi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return L5e(t,e-1)},Ai=xi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return O5e(t,e-1)},P5e=xi.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(a)||0,[Number(qr(c.lowerLeft_X)),Number(qr(c.lowerLeft_Y)),Number(qr(c.upperRight_X)),Number(qr(c.upperRight_Y))]},I5e=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=e_(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+qr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=ud(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},e_=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(k){return k.split(`
`)}):i.map(function(k){return[k]});var a=r,o=or.internal.getHeight(t)||0;o=o<0?-o:o;var l=or.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,R,P){if(k+1<i.length){var q=R+" "+i[k+1][0];return Fv(q,t,P).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var u,f,p=Fv("3",t,a).height,x=t.multiline?o-a:(o-p)/2,m=x+=2,y=0,v=0,j=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+Fv(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var N="",C=0,A=0;A<i.length;A++)if(i.hasOwnProperty(A)){var L=!1;if(i[A].length!==1&&j!==i[A].length-1){if((p+2)*(C+2)+2>o)continue e;N+=i[A][j],L=!0,v=A,A--}else{N=(N+=i[A][j]+" ").substr(N.length-1)==" "?N.substr(0,N.length-1):N;var O=parseInt(A),F=c(O,N,a),T=A>=i.length-1;if(F&&!T){N+=" ",j=0;continue}if(F||T){if(T)v=O;else if(t.multiline&&(p+2)*(C+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(C+2)+2>o)continue e;v=O}}for(var I="",B=y;B<=v;B++){var $=i[B];if(t.multiline){if(B===v){I+=$[j]+" ",j=(j+1)%$.length;continue}if(B===y){I+=$[$.length-1]+" ";continue}}I+=$[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=Fv(I,t,a).width,t.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=qr(u)+" "+qr(m)+` Td
`,e+="("+F0(I)+`) Tj
`,e+=-qr(u)+` 0 Td
`,m=-(a+2),f=0,y=L?v:v+1,C++,N=""}break}return n.text=e,n.fontSize=a,n},Fv=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},R5e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},D5e=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},B5e=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Wc.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(R5e)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");$C=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new NW,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&D5e(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=P5e(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=or.createDefaultAppearanceStream(l),rs(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=I5e(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var p="";for(var x in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(x)){var m=l.appearanceStreamContent[x];if(p+="/"+x+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var y=m[o];typeof y=="function"&&(y=y.call(i,l)),p+="/"+o+" "+y+" ",i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y)}}else typeof(y=m)=="function"&&(y=y.call(i,l)),p+="/"+o+" "+y,i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}a&&(function(v,j){for(var N in v)if(v.hasOwnProperty(N)){var C=N,A=v[N];j.internal.newObjectDeferredBegin(A.objId,!0),rs(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete v[C]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},wW=xi.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),rs(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+F0(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},KN=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+F0(n(t))+")"},gd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};gd.prototype.toString=function(){return this.objId+" 0 R"},gd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},gd.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:wW(i,this.objId,this.scope)}):i instanceof gd?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var jW=function(){gd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};sl(jW,gd);var NW=function(){gd.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+F0(r(t))+")"}},set:function(r){t=r}})};sl(NW,gd);var Wc=function t(){gd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute F supplied.');e=N}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_i(e,3)},set:function(N){N?this.F=Ci(e,3):this.F=Ai(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute Ff supplied.');r=N}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(N){n=N!==void 0?N:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(N){n[0]=N}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(N){n[1]=N}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(N){n[2]=N}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(N){n[3]=N}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(N){switch(N){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=N;break;default:throw new Error('Invalid value "'+N+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof j2)return;a="FieldObject"+t.FieldNum++}var N=function(C){return C};return this.scope&&(N=this.scope.internal.getEncryptor(this.objId)),"("+F0(N(a))+")"},set:function(N){a=N.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(N){a=N}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(N){o=N}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(N){l=N}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(N){c=N}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/$C:u},set:function(N){u=N}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(N){f=N}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof j2||this instanceof e0))return KN(p,this.objId,this.scope)},set:function(N){N=N.toString(),p=N}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof va==0?KN(x,this.objId,this.scope):x},set:function(N){N=N.toString(),x=this instanceof va==0?N.substr(0,1)==="("?Tp(N.substr(1,N.length-2)):Tp(N):N}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof va==1?Tp(x.substr(1,x.length-1)):x},set:function(N){N=N.toString(),x=this instanceof va==1?"/"+N:N}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(N){this.V=N}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof va==0?KN(m,this.objId,this.scope):m},set:function(N){N=N.toString(),m=this instanceof va==0?N.substr(0,1)==="("?Tp(N.substr(1,N.length-2)):Tp(N):N}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof va==1?Tp(m.substr(1,m.length-1)):m},set:function(N){N=N.toString(),m=this instanceof va==1?"/"+N:N}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(N){N=!!N,v=N}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(N){y=N}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,1)},set:function(N){N?this.Ff=Ci(this.Ff,1):this.Ff=Ai(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,2)},set:function(N){N?this.Ff=Ci(this.Ff,2):this.Ff=Ai(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,3)},set:function(N){N?this.Ff=Ci(this.Ff,3):this.Ff=Ai(this.Ff,3)}});var j=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(j!==null)return j},set:function(N){if([0,1,2].indexOf(N)===-1)throw new Error('Invalid value "'+N+'" for attribute Q supplied.');j=N}}),Object.defineProperty(this,"textAlign",{get:function(){var N;switch(j){case 0:default:N="left";break;case 1:N="center";break;case 2:N="right"}return N},configurable:!0,enumerable:!0,set:function(N){switch(N){case"right":case 2:j=2;break;case"center":case 1:j=1;break;default:j=0}}})};sl(Wc,gd);var om=function(){Wc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return wW(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,o,l){l||(l=1);for(var c,u=[];c=o.exec(a);)u.push(c[l]);return u})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,18)},set:function(r){r?this.Ff=Ci(this.Ff,18):this.Ff=Ai(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ci(this.Ff,19):this.Ff=Ai(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,20)},set:function(r){r?(this.Ff=Ci(this.Ff,20),e.sort()):this.Ff=Ai(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,22)},set:function(r){r?this.Ff=Ci(this.Ff,22):this.Ff=Ai(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(r){r?this.Ff=Ci(this.Ff,23):this.Ff=Ai(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,27)},set:function(r){r?this.Ff=Ci(this.Ff,27):this.Ff=Ai(this.Ff,27)}}),this.hasAppearanceStream=!1};sl(om,Wc);var lm=function(){om.call(this),this.fontName="helvetica",this.combo=!1};sl(lm,om);var cm=function(){lm.call(this),this.combo=!0};sl(cm,lm);var A1=function(){cm.call(this),this.edit=!0};sl(A1,cm);var va=function(){Wc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,15)},set:function(r){r?this.Ff=Ci(this.Ff,15):this.Ff=Ai(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,16)},set:function(r){r?this.Ff=Ci(this.Ff,16):this.Ff=Ai(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,17)},set:function(r){r?this.Ff=Ci(this.Ff,17):this.Ff=Ai(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(r){r?this.Ff=Ci(this.Ff,26):this.Ff=Ai(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+F0(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){rs(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};sl(va,Wc);var E1=function(){va.call(this),this.pushButton=!0};sl(E1,va);var dm=function(){va.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};sl(dm,va);var j2=function(){var t,e;Wc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+F0(i(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){rs(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=or.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};sl(j2,Wc),dm.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},dm.prototype.createOption=function(t){var e=new j2;return e.Parent=this,e.optionName=t,this.Kids.push(e),$5e.call(this.scope,e),e};var T1=function(){va.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=or.CheckBox.createAppearanceStream()};sl(T1,va);var e0=function(){Wc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,13)},set:function(e){e?this.Ff=Ci(this.Ff,13):this.Ff=Ai(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,21)},set:function(e){e?this.Ff=Ci(this.Ff,21):this.Ff=Ai(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(e){e?this.Ff=Ci(this.Ff,23):this.Ff=Ai(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,24)},set:function(e){e?this.Ff=Ci(this.Ff,24):this.Ff=Ai(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,25)},set:function(e){e?this.Ff=Ci(this.Ff,25):this.Ff=Ai(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(e){e?this.Ff=Ci(this.Ff,26):this.Ff=Ai(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};sl(e0,Wc);var L1=function(){e0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,14)},set:function(t){t?this.Ff=Ci(this.Ff,14):this.Ff=Ai(this.Ff,14)}}),this.password=!0};sl(L1,e0);var or={CheckBox:{createAppearanceStream:function(){return{N:{On:or.CheckBox.YesNormal},D:{On:or.CheckBox.YesPushDown,Off:or.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=e_(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+qr(or.internal.getWidth(t))+" "+qr(or.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+qr(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=ud(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=or.internal.getHeight(t),o=or.internal.getWidth(t),l=e_(t,t.caption);return i.push("1 g"),i.push("0 0 "+qr(o)+" "+qr(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+qr(o-1)+" "+qr(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+qr(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+qr(or.internal.getWidth(t))+" "+qr(or.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:or.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=or.RadioButton.Circle.YesNormal,e.D[t]=or.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ud(t);e.scope=t.scope;var r=[],n=or.internal.getWidth(t)<=or.internal.getHeight(t)?or.internal.getWidth(t)/4:or.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=or.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Oh(or.internal.getWidth(t)/2)+" "+Oh(or.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=[],n=or.internal.getWidth(t)<=or.internal.getHeight(t)?or.internal.getWidth(t)/4:or.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*or.internal.Bezier_C).toFixed(5)),o=Number((n*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Oh(or.internal.getWidth(t)/2)+" "+Oh(or.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Oh(or.internal.getWidth(t)/2)+" "+Oh(or.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=[],n=or.internal.getWidth(t)<=or.internal.getHeight(t)?or.internal.getWidth(t)/4:or.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Oh(or.internal.getWidth(t)/2)+" "+Oh(or.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:or.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=or.RadioButton.Cross.YesNormal,e.D[t]=or.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ud(t);e.scope=t.scope;var r=[],n=or.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+qr(or.internal.getWidth(t)-2)+" "+qr(or.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(qr(n.x1.x)+" "+qr(n.x1.y)+" m"),r.push(qr(n.x2.x)+" "+qr(n.x2.y)+" l"),r.push(qr(n.x4.x)+" "+qr(n.x4.y)+" m"),r.push(qr(n.x3.x)+" "+qr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=or.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+qr(or.internal.getWidth(t))+" "+qr(or.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+qr(or.internal.getWidth(t)-2)+" "+qr(or.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(qr(r.x1.x)+" "+qr(r.x1.y)+" m"),n.push(qr(r.x2.x)+" "+qr(r.x2.y)+" l"),n.push(qr(r.x4.x)+" "+qr(r.x4.y)+" m"),n.push(qr(r.x3.x)+" "+qr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ud(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+qr(or.internal.getWidth(t))+" "+qr(or.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};or.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=or.internal.getWidth(t),r=or.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},or.internal.getWidth=function(t){var e=0;return rs(t)==="object"&&(e=KP(t.Rect[2])),e},or.internal.getHeight=function(t){var e=0;return rs(t)==="object"&&(e=KP(t.Rect[3])),e};var $5e=xi.addField=function(t){if(B5e(this,t),!(t instanceof Wc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};xi.AcroFormChoiceField=om,xi.AcroFormListBox=lm,xi.AcroFormComboBox=cm,xi.AcroFormEditBox=A1,xi.AcroFormButton=va,xi.AcroFormPushButton=E1,xi.AcroFormRadioButton=dm,xi.AcroFormCheckBox=T1,xi.AcroFormTextField=e0,xi.AcroFormPasswordField=L1,xi.AcroFormAppearance=or,xi.AcroForm={ChoiceField:om,ListBox:lm,ComboBox:cm,EditBox:A1,Button:va,PushButton:E1,RadioButton:dm,CheckBox:T1,TextField:e0,PasswordField:L1,Appearance:or},xr.AcroForm={ChoiceField:om,ListBox:lm,ComboBox:cm,EditBox:A1,Button:va,PushButton:E1,RadioButton:dm,CheckBox:T1,TextField:e0,PasswordField:L1,Appearance:or};xr.AcroForm;function kW(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(k,R){var P,q,X,G,ne,ee=r;if((R=R||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(F(k))for(ne in n)for(X=n[ne],P=0;P<X.length;P+=1){for(G=!0,q=0;q<X[P].length;q+=1)if(X[P][q]!==void 0&&X[P][q]!==k[q]){G=!1;break}if(G===!0){ee=ne;break}}else for(ne in n)for(X=n[ne],P=0;P<X.length;P+=1){for(G=!0,q=0;q<X[P].length;q+=1)if(X[P][q]!==void 0&&X[P][q]!==k.charCodeAt(q)){G=!1;break}if(G===!0){ee=ne;break}}return ee===r&&R!==r&&(ee=R),ee},a=function k(R){for(var P=this.internal.write,q=this.internal.putStream,X=(0,this.internal.getFilters)();X.indexOf("FlateEncode")!==-1;)X.splice(X.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:R.width}),G.push({key:"Height",value:R.height}),R.colorSpace===N.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===N.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)&&R.transparency.length>0){for(var ne="",ee=0,se=R.transparency.length;ee<se;ee++)ne+=R.transparency[ee]+" "+R.transparency[ee]+" ";G.push({key:"Mask",value:"["+ne+"]"})}R.sMask!==void 0&&G.push({key:"SMask",value:R.objectId+1+" 0 R"});var J=R.filter!==void 0?["/"+R.filter]:void 0;if(q({data:R.data,additionalKeyValues:G,alreadyAppliedFilters:J,objectId:R.objectId}),P("endobj"),"sMask"in R&&R.sMask!==void 0){var W,U=(W=R.sMaskBitsPerComponent)!==null&&W!==void 0?W:R.bitsPerComponent,Y={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:U,data:R.sMask};"filter"in R&&(Y.decodeParameters="/Predictor ".concat(R.predictor," /Colors 1 /BitsPerComponent ").concat(U," /Columns ").concat(R.width),Y.filter=R.filter),k.call(this,Y)}if(R.colorSpace===N.INDEXED){var te=this.internal.newObject();q({data:I(new Uint8Array(R.palette)),objectId:te}),P("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var R in k)a.call(this,k[R])},l=function(){var k,R=this.internal.collections[e+"images"],P=this.internal.write;for(var q in R)P("/I"+(k=R[q]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(k){return typeof t["process"+k.toUpperCase()]=="function"},x=function(k){return rs(k)==="object"&&k.nodeType===1},m=function(k,R){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var P=""+k.getAttribute("src");if(P.indexOf("data:image/")===0)return C1(unescape(P).split("base64,").pop());var q=t.loadFile(P,!0);if(q!==void 0)return q}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var X;switch(R){case"PNG":X="image/png";break;case"WEBP":X="image/webp";break;default:X="image/jpeg"}return C1(k.toDataURL(X,1).split("base64,").pop())}},y=function(k){var R=this.internal.collections[e+"images"];if(R){for(var P in R)if(k===R[P].alias)return R[P]}},v=function(k,R,P){return k||R||(k=-96,R=-96),k<0&&(k=-1*P.width*72/k/this.internal.scaleFactor),R<0&&(R=-1*P.height*72/R/this.internal.scaleFactor),k===0&&(k=R*P.width/P.height),R===0&&(R=k*P.height/P.width),[k,R]},j=function(k,R,P,q,X,G){var ne=v.call(this,P,q,X),ee=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,J=u.call(this);if(P=ne[0],q=ne[1],J[X.index]=X,G){G*=Math.PI/180;var W=Math.cos(G),U=Math.sin(G),Y=function(ce){return ce.toFixed(4)},te=[Y(W),Y(U),Y(-1*U),Y(W),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,ee(k),se(R+q),"cm"].join(" ")),this.internal.write(te.join(" ")),this.internal.write([ee(P),"0","0",ee(q),"0","0","cm"].join(" "))):this.internal.write([ee(P),"0","0",ee(q),ee(k),se(R+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+X.index+" Do"),this.internal.write("Q")},N=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=t.__addimage__.sHashCode=function(k){var R,P,q=0;if(typeof k=="string")for(P=k.length,R=0;R<P;R++)q=(q<<5)-q+k.charCodeAt(R),q|=0;else if(F(k))for(P=k.byteLength/2,R=0;R<P;R++)q=(q<<5)-q+k[R],q|=0;return q},L=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var R=!0;return k.length===0&&(R=!1),k.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(R=!1),R},O=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var R=k.indexOf(",");return R<0?null:k.substring(0,R).trim().endsWith("base64")?k.substring(R+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var F=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},T=t.__addimage__.binaryStringToUint8Array=function(k){for(var R=k.length,P=new Uint8Array(R),q=0;q<R;q++)P[q]=k.charCodeAt(q);return P},I=t.__addimage__.arrayBufferToBinaryString=function(k){for(var R="",P=F(k)?k:new Uint8Array(k),q=0;q<P.length;q+=8192)R+=String.fromCharCode.apply(null,P.subarray(q,q+8192));return R};t.addImage=function(){var k,R,P,q,X,G,ne,ee,se;if(typeof arguments[1]=="number"?(R=r,P=arguments[1],q=arguments[2],X=arguments[3],G=arguments[4],ne=arguments[5],ee=arguments[6],se=arguments[7]):(R=arguments[1],P=arguments[2],q=arguments[3],X=arguments[4],G=arguments[5],ne=arguments[6],ee=arguments[7],se=arguments[8]),rs(k=arguments[0])==="object"&&!x(k)&&"imageData"in k){var J=k;k=J.imageData,R=J.format||R||r,P=J.x||P||0,q=J.y||q||0,X=J.w||J.width||X,G=J.h||J.height||G,ne=J.alias||ne,ee=J.compression||ee,se=J.rotation||J.angle||se}var W=this.internal.getFilters();if(ee===void 0&&W.indexOf("FlateEncode")!==-1&&(ee="SLOW"),isNaN(P)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var U=B.call(this,k,R,ne,ee);return j.call(this,P,q,X,G,U,se),this};var B=function(k,R,P,q){var X,G,ne;if(typeof k=="string"&&i(k)===r){k=unescape(k);var ee=$(k,!1);(ee!==""||(ee=t.loadFile(k,!0))!==void 0)&&(k=ee)}if(x(k)&&(k=m(k,R)),R=i(k,R),!p(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((ne=P)==null||ne.length===0)&&(P=(function(se){return typeof se=="string"||F(se)?A(se):F(se.data)?A(se.data):null})(k)),(X=y.call(this,P))||(k instanceof Uint8Array||R==="RGBA"||(G=k,k=T(k)),X=this["process"+R.toUpperCase()](k,f.call(this),P,(function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in t.image_compression?se:C.NONE})(q),G)),!X)throw new Error("An unknown error occurred whilst processing the image.");return X},$=t.__addimage__.convertBase64ToBinaryString=function(k,R){R=typeof R!="boolean"||R;var P,q="";if(typeof k=="string"){var X;P=(X=O(k))!==null&&X!==void 0?X:k;try{q=C1(P)}catch(G){if(R)throw L(P)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};t.getImageProperties=function(k){var R,P,q="";if(x(k)&&(k=m(k)),typeof k=="string"&&i(k)===r&&((q=$(k,!1))===""&&(q=t.loadFile(k)||""),k=q),P=i(k),!p(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(k instanceof Uint8Array||(k=T(k)),!(R=this["process"+P.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=P,R}})(xr.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};xr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,p=0;p<u.length&&!f;p++)switch((n=u[p]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var x=0;x<u.length;x++){n=u[x];var m=this.internal.pdfEscape,y=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),j=this.internal.newAdditionalObject(),N=this.internal.getEncryptor(v.objId),C=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(N(n.contents))+")",a+=" /Popup "+j.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+m(N(C))+") >>",v.content=a;var A=v.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+A,n.open&&(a+=" /Open true"),a+=" >>",j.content=a,this.internal.write(v.objId,"0 R",j.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var L=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(y(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+L+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var F=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,i,a){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var f=this.splitTextToSize(r,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(r,n,i,a),i+=.2*u,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,i-u,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(xr.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},l=t.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&i.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&a(v)&&e[v.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(v){var j=0,N=r,C="",A=0;for(j=0;j<v.length;j+=1)N[v.charCodeAt(j)]!==void 0?(A++,typeof(N=N[v.charCodeAt(j)])=="number"&&(C+=String.fromCharCode(N),N=r,A=0),j===v.length-1&&(N=r,C+=v.charAt(j-(A-1)),j-=A-1,A=0)):(N=r,C+=v.charAt(j-A),j-=A,A=0);return C};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(v,j,N){return o(v)?a(v)===!1?-1:!u(v)||!o(j)&&!o(N)||!o(N)&&l(j)||l(v)&&!o(j)||l(v)&&c(j)||l(v)&&l(j)?0:f(v)&&o(j)&&!l(j)&&o(N)&&u(N)?3:l(v)||!o(N)?1:2:-1},m=function(v){var j=0,N=0,C=0,A="",L="",O="",F=(v=v||"").split("\\s+"),T=[];for(j=0;j<F.length;j+=1){for(T.push(""),N=0;N<F[j].length;N+=1)A=F[j][N],L=F[j][N-1],O=F[j][N+1],o(A)?(C=x(A,L,O),T[j]+=C!==-1?String.fromCharCode(e[A.charCodeAt(0)][C]):A):T[j]+=A;T[j]=p(T[j])}return T.join(" ")},y=t.__arabicParser__.processArabic=t.processArabic=function(){var v,j=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,N=[];if(Array.isArray(j)){var C=0;for(N=[],C=0;C<j.length;C+=1)Array.isArray(j[C])?N.push([m(j[C][0]),j[C][1],j[C][2]]):N.push([m(j[C])]);v=N}else v=m(j);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",y])})(xr.API),xr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(xr.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(v){y=v}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),x=u.scaleFactor||this.internal.scaleFactor,m=0,y=0,v=0,j=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var N=u.maxWidth;N>0?typeof c=="string"?c=this.splitTextToSize(c,N):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(A,L){return A.concat(j.splitTextToSize(L,N))},[])):c=Array.isArray(c)?c:[c];for(var C=0;C<c.length;C++)m<(v=this.getStringUnitWidth(c[C],{font:p})*f)&&(m=v);return m!==0&&(y=c.length),{w:m/=x,h:Math.max((y*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&x&&(this.printHeaderRow(c.lineNumber,!0),c.y+=x[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,p,x){if(n.call(this),!f)throw new Error("No data for PDF table.");var m,y,v,j,N=[],C=[],A=[],L={},O={},F=[],T=[],I=(x=x||{}).autoSize||!1,B=x.printHeaders!==!1,$=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,k=x.margins||Object.assign({width:this.getPageWidth()},e),R=typeof x.padding=="number"?x.padding:3,P=x.headerBackgroundColor||"#c8c8c8",q=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=$,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=q,this.setFontSize($),p==null)C=N=Object.keys(f[0]),A=N.map(function(){return"left"});else if(Array.isArray(p)&&rs(p[0])==="object")for(N=p.map(function(J){return J.name}),C=p.map(function(J){return J.prompt||J.name||""}),A=p.map(function(J){return J.align||"left"}),m=0;m<p.length;m+=1)O[p[m].name]=.7499990551181103*p[m].width;else Array.isArray(p)&&typeof p[0]=="string"&&(C=N=p,A=N.map(function(){return"left"}));if(I||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<N.length;m+=1){for(L[j=N[m]]=f.map(function(J){return J[j]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(C[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=L[j],this.setFont(void 0,"normal"),v=0;v<y.length;v+=1)F.push(this.getTextDimensions(y[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[j]=Math.max.apply(null,F)+R+R,F=[]}if(B){var X={};for(m=0;m<N.length;m+=1)X[N[m]]={},X[N[m]].text=C[m],X[N[m]].align=A[m];var G=l.call(this,X,O);T=N.map(function(J){return new a(c,u,O[J],G,X[J].text,void 0,X[J].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var ne=p.reduce(function(J,W){return J[W.name]=W.align,J},{});for(m=0;m<f.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:f[m]},this);var ee=l.call(this,f[m],O);for(v=0;v<N.length;v+=1){var se=f[m][N[v]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:v,data:se},this),o.call(this,new a(c,u,O[N[v]],ee,se,m+2,ne[N[v]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(c).map(function(m){var y=c[m];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,u[m]-f-f)},this).map(function(m){return this.getLineHeightFactor()*m.length*p/x+f+f},this).reduce(function(m,y){return Math.max(m,y)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){f=this.internal.__cell__.tableHeaderRow[m].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,x.push(f)),f.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(y)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(xr.API);var SW={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_W=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],t_=kW(_W),CW=[100,200,300,400,500,600,700,800,900],F5e=kW(CW);function XN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return SW[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof t_[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function XP(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var U5e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},JP={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ZP(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function QP(t){return t.trimLeft()}function z5e(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function q5e(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Uv,e9,t9,Lp,zv,r9,n9,s9,JN=["times"];function i9(t,e,r,n,i){var a=4,o=o9;switch(i){case xr.API.image_compression.FAST:a=1,o=a9;break;case xr.API.image_compression.MEDIUM:a=6,o=l9;break;case xr.API.image_compression.SLOW:a=9,o=c9}t=(function(c,u,f,p){for(var x,m=c.length/u,y=new Uint8Array(c.length+m),v=[H5e,a9,o9,l9,c9],j=0;j<m;j+=1){var N=j*u,C=c.subarray(N,N+u);if(p)y.set(p(C,f,x),N+j);else{for(var A=v.length,L=[],O=0;O<A;O+=1)L[O]=v[O](C,f,x);var F=G5e(L.concat());y.set(L[F],N+j)}x=C}return y})(t,e,Math.ceil(r*n/8),o);var l=YS(t,{level:a});return xr.API.__addimage__.arrayBufferToBinaryString(l)}function H5e(t){var e=Array.apply([],t);return e.unshift(0),e}function a9(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function o9(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;i[a+1]=t[a]-o+256&255}return i}function l9(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;i[a+1]=t[a]+256-(o+l>>>1)&255}return i}function c9(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var o=W5e(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-o+256&255}return i}function W5e(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function G5e(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function ZN(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),o=(1<<r)-1;return AW(t,i)>>a&o}function d9(t,e,r,n){var i=r*n,a=Math.floor(i/8),o=16-(i-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,f,p){if(f+1<u.byteLength)u.setUint16(f,p,!1);else{var x=p>>8&255;u.setUint8(f,x)}})(t,a,AW(t,a)&~(l<<o)&65535|c)}function AW(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function V5e(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var u=!0,f=[],p=0,x=null,m=0,y=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,y=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[e++];p=t[e++]|t[e++]<<8,x=t[e++],1&v||(x=null),m=v>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var j=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,L=t[e++],O=L>>6&1,F=1<<1+(7&L),T=l,I=c,B=!1;L>>7&&(B=!0,T=e,I=F,e+=3*F);var $=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}f.push({x:j,y:N,width:C,height:A,has_local_palette:B,palette_offset:T,palette_size:I,data_offset:$,data_length:e-$,transparent_index:x,interlaced:!!O,delay:p,disposal:m});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return y},this.frameInfo=function(R){if(R<0||R>=f.length)throw new Error("Frame index out of range.");return f[R]},this.decodeAndBlitFrameBGRA=function(R,P){var q=this.frameInfo(R),X=q.width*q.height,G=new Uint8Array(X);u9(t,q.data_offset,G,X);var ne=q.palette_offset,ee=q.transparent_index;ee===null&&(ee=256);var se=q.width,J=r-se,W=se,U=4*(q.y*r+q.x),Y=4*((q.y+q.height)*r+q.x),te=U,ce=4*J;q.interlaced===!0&&(ce+=4*r*7);for(var xe=8,ue=0,ve=G.length;ue<ve;++ue){var Q=G[ue];if(W===0&&(W=se,(te+=ce)>=Y&&(ce=4*J+4*r*(xe-1),te=U+(se+J)*(xe<<1),xe>>=1)),Q===ee)te+=4;else{var pe=t[ne+3*Q],Ce=t[ne+3*Q+1],je=t[ne+3*Q+2];P[te++]=je,P[te++]=Ce,P[te++]=pe,P[te++]=255}--W}},this.decodeAndBlitFrameRGBA=function(R,P){var q=this.frameInfo(R),X=q.width*q.height,G=new Uint8Array(X);u9(t,q.data_offset,G,X);var ne=q.palette_offset,ee=q.transparent_index;ee===null&&(ee=256);var se=q.width,J=r-se,W=se,U=4*(q.y*r+q.x),Y=4*((q.y+q.height)*r+q.x),te=U,ce=4*J;q.interlaced===!0&&(ce+=4*r*7);for(var xe=8,ue=0,ve=G.length;ue<ve;++ue){var Q=G[ue];if(W===0&&(W=se,(te+=ce)>=Y&&(ce=4*J+4*r*(xe-1),te=U+(se+J)*(xe<<1),xe>>=1)),Q===ee)te+=4;else{var pe=t[ne+3*Q],Ce=t[ne+3*Q+1],je=t[ne+3*Q+2];P[te++]=pe,P[te++]=Ce,P[te++]=je,P[te++]=255}--W}}}function u9(t,e,r,n){for(var i=t[e++],a=1<<i,o=a+1,l=o+1,c=i+1,u=(1<<c)-1,f=0,p=0,x=0,m=t[e++],y=new Int32Array(4096),v=null;;){for(;f<16&&m!==0;)p|=t[e++]<<f,f+=8,m===1?m=t[e++]:--m;if(f<c)break;var j=p&u;if(p>>=c,f-=c,j!==a){if(j===o)break;for(var N=j<l?j:v,C=0,A=N;A>a;)A=y[A]>>8,++C;var L=A;if(x+C+(N!==j?1:0)>n)return void vs.log("Warning, gif stream longer than expected.");r[x++]=L;var O=x+=C;for(N!==j&&(r[x++]=L),A=N;C--;)A=y[A],r[--O]=255&A,A>>=8;v!==null&&l<4096&&(y[l++]=v<<8|L,l>=u+1&&c<12&&(++c,u=u<<1|1)),v=j}else l=o+1,u=(1<<(c=i+1))-1,v=null}return x!==n&&vs.log("Warning, gif stream shorter than expected."),r}function QN(t){var e,r,n,i,a,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),p=new Array(65535),x=new Array(65535),m=new Array(64),y=new Array(64),v=[],j=0,N=7,C=new Array(64),A=new Array(64),L=new Array(64),O=new Array(256),F=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],X=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(U,Y){for(var te=0,ce=0,xe=new Array,ue=1;ue<=16;ue++){for(var ve=1;ve<=U[ue];ve++)xe[Y[ce]]=[],xe[Y[ce]][0]=te,xe[Y[ce]][1]=ue,ce++,te++;te*=2}return xe}function ne(U){for(var Y=U[0],te=U[1]-1;te>=0;)Y&1<<te&&(j|=1<<N),te--,--N<0&&(j==255?(ee(255),ee(0)):ee(j),N=7,j=0)}function ee(U){v.push(U)}function se(U){ee(U>>8&255),ee(255&U)}function J(U,Y,te,ce,xe){for(var ue,ve=xe[0],Q=xe[240],pe=(function(Ne,Ge){var Xe,xt,Ae,Pe,ct,bt,dt,Ve,lt,kt,Ue=0;for(lt=0;lt<8;++lt){Xe=Ne[Ue],xt=Ne[Ue+1],Ae=Ne[Ue+2],Pe=Ne[Ue+3],ct=Ne[Ue+4],bt=Ne[Ue+5],dt=Ne[Ue+6];var Bt=Xe+(Ve=Ne[Ue+7]),zt=Xe-Ve,Ot=xt+dt,Et=xt-dt,$t=Ae+bt,At=Ae-bt,Xt=Pe+ct,qt=Pe-ct,Ht=Bt+Xt,jr=Bt-Xt,Ct=Ot+$t,Tt=Ot-$t;Ne[Ue]=Ht+Ct,Ne[Ue+4]=Ht-Ct;var Yt=.707106781*(Tt+jr);Ne[Ue+2]=jr+Yt,Ne[Ue+6]=jr-Yt;var Be=.382683433*((Ht=qt+At)-(Tt=Et+zt)),Lt=.5411961*Ht+Be,Ft=1.306562965*Tt+Be,Ee=.707106781*(Ct=At+Et),He=zt+Ee,Mt=zt-Ee;Ne[Ue+5]=Mt+Lt,Ne[Ue+3]=Mt-Lt,Ne[Ue+1]=He+Ft,Ne[Ue+7]=He-Ft,Ue+=8}for(Ue=0,lt=0;lt<8;++lt){Xe=Ne[Ue],xt=Ne[Ue+8],Ae=Ne[Ue+16],Pe=Ne[Ue+24],ct=Ne[Ue+32],bt=Ne[Ue+40],dt=Ne[Ue+48];var Gt=Xe+(Ve=Ne[Ue+56]),Zt=Xe-Ve,Ut=xt+dt,It=xt-dt,Vt=Ae+bt,pr=Ae-bt,en=Pe+ct,Yr=Pe-ct,$r=Gt+en,Qr=Gt-en,pn=Ut+Vt,Hr=Ut-Vt;Ne[Ue]=$r+pn,Ne[Ue+32]=$r-pn;var ss=.707106781*(Hr+Qr);Ne[Ue+16]=Qr+ss,Ne[Ue+48]=Qr-ss;var Ei=.382683433*(($r=Yr+pr)-(Hr=It+Zt)),wi=.5411961*$r+Ei,$s=1.306562965*Hr+Ei,zi=.707106781*(pn=pr+It),jn=Zt+zi,ze=Zt-zi;Ne[Ue+40]=ze+wi,Ne[Ue+24]=ze-wi,Ne[Ue+8]=jn+$s,Ne[Ue+56]=jn-$s,Ue++}for(lt=0;lt<64;++lt)kt=Ne[lt]*Ge[lt],m[lt]=kt>0?kt+.5|0:kt-.5|0;return m})(U,Y),Ce=0;Ce<64;++Ce)y[T[Ce]]=pe[Ce];var je=y[0]-te;te=y[0],je==0?ne(ce[0]):(ne(ce[x[ue=32767+je]]),ne(p[ue]));for(var we=63;we>0&&y[we]==0;)we--;if(we==0)return ne(ve),te;for(var Te,oe=1;oe<=we;){for(var De=oe;y[oe]==0&&oe<=we;)++oe;var Nt=oe-De;if(Nt>=16){Te=Nt>>4;for(var ot=1;ot<=Te;++ot)ne(Q);Nt&=15}ue=32767+y[oe],ne(xe[(Nt<<4)+x[ue]]),ne(p[ue]),oe++}return we!=63&&ne(ve),te}function W(U){U=Math.min(Math.max(U,1),100),a!=U&&((function(Y){for(var te=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ce=0;ce<64;ce++){var xe=o((te[ce]*Y+50)/100);xe=Math.min(Math.max(xe,1),255),l[T[ce]]=xe}for(var ue=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ve=0;ve<64;ve++){var Q=o((ue[ve]*Y+50)/100);Q=Math.min(Math.max(Q,1),255),c[T[ve]]=Q}for(var pe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,je=0;je<8;je++)for(var we=0;we<8;we++)u[Ce]=1/(l[T[Ce]]*pe[je]*pe[we]*8),f[Ce]=1/(c[T[Ce]]*pe[je]*pe[we]*8),Ce++})(U<50?Math.floor(5e3/U):Math.floor(200-2*U)),a=U)}this.encode=function(U,Y){Y&&W(Y),v=new Array,j=0,N=7,se(65496),se(65504),se(16),ee(74),ee(70),ee(73),ee(70),ee(0),ee(1),ee(1),ee(0),se(1),se(1),ee(0),ee(0),(function(){se(65499),se(132),ee(0);for(var xt=0;xt<64;xt++)ee(l[xt]);ee(1);for(var Ae=0;Ae<64;Ae++)ee(c[Ae])})(),(function(xt,Ae){se(65472),se(17),ee(8),se(Ae),se(xt),ee(3),ee(1),ee(17),ee(0),ee(2),ee(17),ee(1),ee(3),ee(17),ee(1)})(U.width,U.height),(function(){se(65476),se(418),ee(0);for(var xt=0;xt<16;xt++)ee(I[xt+1]);for(var Ae=0;Ae<=11;Ae++)ee(B[Ae]);ee(16);for(var Pe=0;Pe<16;Pe++)ee($[Pe+1]);for(var ct=0;ct<=161;ct++)ee(k[ct]);ee(1);for(var bt=0;bt<16;bt++)ee(R[bt+1]);for(var dt=0;dt<=11;dt++)ee(P[dt]);ee(17);for(var Ve=0;Ve<16;Ve++)ee(q[Ve+1]);for(var lt=0;lt<=161;lt++)ee(X[lt])})(),se(65498),se(12),ee(3),ee(1),ee(0),ee(2),ee(17),ee(3),ee(17),ee(0),ee(63),ee(0);var te=0,ce=0,xe=0;j=0,N=7,this.encode.displayName="_encode_";for(var ue,ve,Q,pe,Ce,je,we,Te,oe,De=U.data,Nt=U.width,ot=U.height,Ne=4*Nt,Ge=0;Ge<ot;){for(ue=0;ue<Ne;){for(Ce=Ne*Ge+ue,we=-1,Te=0,oe=0;oe<64;oe++)je=Ce+(Te=oe>>3)*Ne+(we=4*(7&oe)),Ge+Te>=ot&&(je-=Ne*(Ge+1+Te-ot)),ue+we>=Ne&&(je-=ue+we-Ne+4),ve=De[je++],Q=De[je++],pe=De[je++],C[oe]=(F[ve]+F[Q+256|0]+F[pe+512|0]>>16)-128,A[oe]=(F[ve+768|0]+F[Q+1024|0]+F[pe+1280|0]>>16)-128,L[oe]=(F[ve+1280|0]+F[Q+1536|0]+F[pe+1792|0]>>16)-128;te=J(C,u,te,e,n),ce=J(A,f,ce,r,i),xe=J(L,f,xe,r,i),ue+=32}Ge+=8}if(N>=0){var Xe=[];Xe[1]=N+1,Xe[0]=(1<<N+1)-1,ne(Xe)}return se(65497),new Uint8Array(v)},t=t||50,(function(){for(var U=String.fromCharCode,Y=0;Y<256;Y++)O[Y]=U(Y)})(),e=G(I,B),r=G(R,P),n=G($,k),i=G(q,X),(function(){for(var U=1,Y=2,te=1;te<=15;te++){for(var ce=U;ce<Y;ce++)x[32767+ce]=te,p[32767+ce]=[],p[32767+ce][1]=te,p[32767+ce][0]=ce;for(var xe=-(Y-1);xe<=-U;xe++)x[32767+xe]=te,p[32767+xe]=[],p[32767+xe][1]=te,p[32767+xe][0]=Y-1+xe;U<<=1,Y<<=1}})(),(function(){for(var U=0;U<256;U++)F[U]=19595*U,F[U+256|0]=38470*U,F[U+512|0]=7471*U+32768,F[U+768|0]=-11059*U,F[U+1024|0]=-21709*U,F[U+1280|0]=32768*U+8421375,F[U+1536|0]=-27439*U,F[U+1792|0]=-5329*U})(),W(t)}function wc(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function h9(t){function e(B){if(!B)throw Error("assert :P")}function r(B,$,k){for(var R=0;4>R;R++)if(B[$+R]!=k.charCodeAt(R))return!0;return!1}function n(B,$,k,R,P){for(var q=0;q<P;q++)B[$+q]=k[R+q]}function i(B,$,k,R){for(var P=0;P<R;P++)B[$+P]=k}function a(B){return new Int32Array(B)}function o(B,$){for(var k=[],R=0;R<B;R++)k.push(new $);return k}function l(B,$){var k=[];return(function R(P,q,X){for(var G=X[q],ne=0;ne<G&&(P.push(X.length>q+1?[]:new $),!(X.length<q+1));ne++)R(P[ne],q+1,X)})(k,0,B),k}var c=function(){var B=this;function $(S,M){for(var H=1<<M-1>>>0;S&H;)H>>>=1;return H?(S&H-1)+H:S}function k(S,M,H,Z,le){e(!(Z%H));do S[M+(Z-=H)]=le;while(0<Z)}function R(S,M,H,Z,le){if(e(2328>=le),512>=le)var de=a(512);else if((de=a(le))==null)return 0;return(function(he,ge,ye,_e,Ie,Qe){var Se,$e,Ye=ge,pt=1<<ye,Je=a(16),ft=a(16);for(e(Ie!=0),e(_e!=null),e(he!=null),e(0<ye),$e=0;$e<Ie;++$e){if(15<_e[$e])return 0;++Je[_e[$e]]}if(Je[0]==Ie)return 0;for(ft[1]=0,Se=1;15>Se;++Se){if(Je[Se]>1<<Se)return 0;ft[Se+1]=ft[Se]+Je[Se]}for($e=0;$e<Ie;++$e)Se=_e[$e],0<_e[$e]&&(Qe[ft[Se]++]=$e);if(ft[15]==1)return(_e=new P).g=0,_e.value=Qe[0],k(he,Ye,1,pt,_e),pt;var yt,Pt=-1,St=pt-1,ar=0,Qt=1,Pr=1,rr=1<<ye;for($e=0,Se=1,Ie=2;Se<=ye;++Se,Ie<<=1){if(Qt+=Pr<<=1,0>(Pr-=Je[Se]))return 0;for(;0<Je[Se];--Je[Se])(_e=new P).g=Se,_e.value=Qe[$e++],k(he,Ye+ar,Ie,rr,_e),ar=$(ar,Se)}for(Se=ye+1,Ie=2;15>=Se;++Se,Ie<<=1){if(Qt+=Pr<<=1,0>(Pr-=Je[Se]))return 0;for(;0<Je[Se];--Je[Se]){if(_e=new P,(ar&St)!=Pt){for(Ye+=rr,yt=1<<(Pt=Se)-ye;15>Pt&&!(0>=(yt-=Je[Pt]));)++Pt,yt<<=1;pt+=rr=1<<(yt=Pt-ye),he[ge+(Pt=ar&St)].g=yt+ye,he[ge+Pt].value=Ye-ge-Pt}_e.g=Se-ye,_e.value=Qe[$e++],k(he,Ye+(ar>>ye),Ie,rr,_e),ar=$(ar,Se)}}return Qt!=2*ft[15]-1?0:pt})(S,M,H,Z,le,de)}function P(){this.value=this.g=0}function q(){this.value=this.g=0}function X(){this.G=o(5,P),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Yc,q)}function G(S,M,H,Z){e(S!=null),e(M!=null),e(2147483648>Z),S.Ca=254,S.I=0,S.b=-8,S.Ka=0,S.oa=M,S.pa=H,S.Jd=M,S.Yc=H+Z,S.Zc=4<=Z?H+Z-4+1:H,ve(S)}function ne(S,M){for(var H=0;0<M--;)H|=pe(S,128)<<M;return H}function ee(S,M){var H=ne(S,M);return Q(S)?-H:H}function se(S,M,H,Z){var le,de=0;for(e(S!=null),e(M!=null),e(4294967288>Z),S.Sb=Z,S.Ra=0,S.u=0,S.h=0,4<Z&&(Z=4),le=0;le<Z;++le)de+=M[H+le]<<8*le;S.Ra=de,S.bb=Z,S.oa=M,S.pa=H}function J(S){for(;8<=S.u&&S.bb<S.Sb;)S.Ra>>>=8,S.Ra+=S.oa[S.pa+S.bb]<<El-8>>>0,++S.bb,S.u-=8;ce(S)&&(S.h=1,S.u=0)}function W(S,M){if(e(0<=M),!S.h&&M<=Ia){var H=te(S)&Ja[M];return S.u+=M,J(S),H}return S.h=1,S.u=0}function U(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Y(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function te(S){return S.Ra>>>(S.u&El-1)>>>0}function ce(S){return e(S.bb<=S.Sb),S.h||S.bb==S.Sb&&S.u>El}function xe(S,M){S.u=M,S.h=ce(S)}function ue(S){S.u>=Tl&&(e(S.u>=Tl),J(S))}function ve(S){e(S!=null&&S.oa!=null),S.pa<S.Zc?(S.I=(S.oa[S.pa++]|S.I<<8)>>>0,S.b+=8):(e(S!=null&&S.oa!=null),S.pa<S.Yc?(S.b+=8,S.I=S.oa[S.pa++]|S.I<<8):S.Ka?S.b=0:(S.I<<=8,S.b+=8,S.Ka=1))}function Q(S){return ne(S,1)}function pe(S,M){var H=S.Ca;0>S.b&&ve(S);var Z=S.b,le=H*M>>>8,de=(S.I>>>Z>le)+0;for(de?(H-=le,S.I-=le+1<<Z>>>0):H=le+1,Z=H,le=0;256<=Z;)le+=8,Z>>=8;return Z=7^le+oc[Z],S.b-=Z,S.Ca=(H<<Z)-1,de}function Ce(S,M,H){S[M+0]=H>>24&255,S[M+1]=H>>16&255,S[M+2]=H>>8&255,S[M+3]=255&H}function je(S,M){return S[M+0]|S[M+1]<<8}function we(S,M){return je(S,M)|S[M+2]<<16}function Te(S,M){return je(S,M)|je(S,M+2)<<16}function oe(S,M){var H=1<<M;return e(S!=null),e(0<M),S.X=a(H),S.X==null?0:(S.Mb=32-M,S.Xa=M,1)}function De(S,M){e(S!=null),e(M!=null),e(S.Xa==M.Xa),n(M.X,0,S.X,0,1<<M.Xa)}function Nt(){this.X=[],this.Xa=this.Mb=0}function ot(S,M,H,Z){e(H!=null),e(Z!=null);var le=H[0],de=Z[0];return le==0&&(le=(S*de+M/2)/M),de==0&&(de=(M*le+S/2)/S),0>=le||0>=de?0:(H[0]=le,Z[0]=de,1)}function Ne(S,M){return S+(1<<M)-1>>>M}function Ge(S,M){return((4278255360&S)+(4278255360&M)>>>0&4278255360)+((16711935&S)+(16711935&M)>>>0&16711935)>>>0}function Xe(S,M){B[M]=function(H,Z,le,de,he,ge,ye){var _e;for(_e=0;_e<he;++_e){var Ie=B[S](ge[ye+_e-1],le,de+_e);ge[ye+_e]=Ge(H[Z+_e],Ie)}}}function xt(){this.ud=this.hd=this.jd=0}function Ae(S,M){return((4278124286&(S^M))>>>1)+(S&M)>>>0}function Pe(S){return 0<=S&&256>S?S:0>S?0:255<S?255:void 0}function ct(S,M){return Pe(S+(S-M+.5>>1))}function bt(S,M,H){return Math.abs(M-H)-Math.abs(S-H)}function dt(S,M,H,Z,le,de,he){for(Z=de[he-1],H=0;H<le;++H)de[he+H]=Z=Ge(S[M+H],Z)}function Ve(S,M,H,Z,le){var de;for(de=0;de<H;++de){var he=S[M+de],ge=he>>8&255,ye=16711935&(ye=(ye=16711935&he)+((ge<<16)+ge));Z[le+de]=(4278255360&he)+ye>>>0}}function lt(S,M){M.jd=255&S,M.hd=S>>8&255,M.ud=S>>16&255}function kt(S,M,H,Z,le,de){var he;for(he=0;he<Z;++he){var ge=M[H+he],ye=ge>>>8,_e=ge,Ie=255&(Ie=(Ie=ge>>>16)+((S.jd<<24>>24)*(ye<<24>>24)>>>5));_e=255&(_e=(_e+=(S.hd<<24>>24)*(ye<<24>>24)>>>5)+((S.ud<<24>>24)*(Ie<<24>>24)>>>5)),le[de+he]=(4278255360&ge)+(Ie<<16)+_e}}function Ue(S,M,H,Z,le){B[M]=function(de,he,ge,ye,_e,Ie,Qe,Se,$e){for(ye=Qe;ye<Se;++ye)for(Qe=0;Qe<$e;++Qe)_e[Ie++]=le(ge[Z(de[he++])])},B[S]=function(de,he,ge,ye,_e,Ie,Qe){var Se=8>>de.b,$e=de.Ea,Ye=de.K[0],pt=de.w;if(8>Se)for(de=(1<<de.b)-1,pt=(1<<Se)-1;he<ge;++he){var Je,ft=0;for(Je=0;Je<$e;++Je)Je&de||(ft=Z(ye[_e++])),Ie[Qe++]=le(Ye[ft&pt]),ft>>=Se}else B["VP8LMapColor"+H](ye,_e,Ye,pt,Ie,Qe,he,ge,$e)}}function Bt(S,M,H,Z,le){for(H=M+H;M<H;){var de=S[M++];Z[le++]=de>>16&255,Z[le++]=de>>8&255,Z[le++]=255&de}}function zt(S,M,H,Z,le){for(H=M+H;M<H;){var de=S[M++];Z[le++]=de>>16&255,Z[le++]=de>>8&255,Z[le++]=255&de,Z[le++]=de>>24&255}}function Ot(S,M,H,Z,le){for(H=M+H;M<H;){var de=(he=S[M++])>>16&240|he>>12&15,he=240&he|he>>28&15;Z[le++]=de,Z[le++]=he}}function Et(S,M,H,Z,le){for(H=M+H;M<H;){var de=(he=S[M++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;Z[le++]=de,Z[le++]=he}}function $t(S,M,H,Z,le){for(H=M+H;M<H;){var de=S[M++];Z[le++]=255&de,Z[le++]=de>>8&255,Z[le++]=de>>16&255}}function At(S,M,H,Z,le,de){if(de==0)for(H=M+H;M<H;)Ce(Z,((de=S[M++])[0]>>24|de[1]>>8&65280|de[2]<<8&16711680|de[3]<<24)>>>0),le+=32;else n(Z,le,S,M,H)}function Xt(S,M){B[M][0]=B[S+"0"],B[M][1]=B[S+"1"],B[M][2]=B[S+"2"],B[M][3]=B[S+"3"],B[M][4]=B[S+"4"],B[M][5]=B[S+"5"],B[M][6]=B[S+"6"],B[M][7]=B[S+"7"],B[M][8]=B[S+"8"],B[M][9]=B[S+"9"],B[M][10]=B[S+"10"],B[M][11]=B[S+"11"],B[M][12]=B[S+"12"],B[M][13]=B[S+"13"],B[M][14]=B[S+"0"],B[M][15]=B[S+"0"]}function qt(S){return S==Sf||S==J0||S==oh||S==Z0}function Ht(){this.eb=[],this.size=this.A=this.fb=0}function jr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ct(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ht,this.f.kb=new jr,this.sd=null}function Tt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Yt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Be(S){return alert("todo:WebPSamplerProcessPlane"),S.T}function Lt(S,M){var H=S.T,Z=M.ba.f.RGBA,le=Z.eb,de=Z.fb+S.ka*Z.A,he=Ki[M.ba.S],ge=S.y,ye=S.O,_e=S.f,Ie=S.N,Qe=S.ea,Se=S.W,$e=M.cc,Ye=M.dc,pt=M.Mc,Je=M.Nc,ft=S.ka,yt=S.ka+S.T,Pt=S.U,St=Pt+1>>1;for(ft==0?he(ge,ye,null,null,_e,Ie,Qe,Se,_e,Ie,Qe,Se,le,de,null,null,Pt):(he(M.ec,M.fc,ge,ye,$e,Ye,pt,Je,_e,Ie,Qe,Se,le,de-Z.A,le,de,Pt),++H);ft+2<yt;ft+=2)$e=_e,Ye=Ie,pt=Qe,Je=Se,Ie+=S.Rc,Se+=S.Rc,de+=2*Z.A,he(ge,(ye+=2*S.fa)-S.fa,ge,ye,$e,Ye,pt,Je,_e,Ie,Qe,Se,le,de-Z.A,le,de,Pt);return ye+=S.fa,S.j+yt<S.o?(n(M.ec,M.fc,ge,ye,Pt),n(M.cc,M.dc,_e,Ie,St),n(M.Mc,M.Nc,Qe,Se,St),H--):1&yt||he(ge,ye,null,null,_e,Ie,Qe,Se,_e,Ie,Qe,Se,le,de+Z.A,null,null,Pt),H}function Ft(S,M,H){var Z=S.F,le=[S.J];if(Z!=null){var de=S.U,he=M.ba.S,ge=he==kf||he==oh;M=M.ba.f.RGBA;var ye=[0],_e=S.ka;ye[0]=S.T,S.Kb&&(_e==0?--ye[0]:(--_e,le[0]-=S.width),S.j+S.ka+S.T==S.o&&(ye[0]=S.o-S.j-_e));var Ie=M.eb;_e=M.fb+_e*M.A,S=vf(Z,le[0],S.width,de,ye,Ie,_e+(ge?0:3),M.A),e(H==ye),S&&qt(he)&&zd(Ie,_e,ge,de,ye,M.A)}return 0}function Ee(S){var M=S.ma,H=M.ba.S,Z=11>H,le=H==ua||H==$o||H==kf||H==ah||H==12||qt(H);if(M.memory=null,M.Ib=null,M.Jb=null,M.Nd=null,!ac(M.Oa,S,le?11:12))return 0;if(le&&qt(H)&&gs(),S.da)alert("todo:use_scaling");else{if(Z){if(M.Ib=Be,S.Kb){if(H=S.U+1>>1,M.memory=a(S.U+2*H),M.memory==null)return 0;M.ec=M.memory,M.fc=0,M.cc=M.ec,M.dc=M.fc+S.U,M.Mc=M.cc,M.Nc=M.dc+H,M.Ib=Lt,gs()}}else alert("todo:EmitYUV");le&&(M.Jb=Ft,Z&&Dt())}if(Z&&!td){for(S=0;256>S;++S)Xi[S]=89858*(S-128)+dh>>Wo,Y5[S]=-22014*(S-128)+dh,xy[S]=-45773*(S-128),np[S]=113618*(S-128)+dh>>Wo;for(S=Gd;S<ed;++S)M=76283*(S-16)+dh>>Wo,K5[S-Gd]=ji(M,255),X5[S-Gd]=ji(M+8>>4,15);td=1}return 1}function He(S){var M=S.ma,H=S.U,Z=S.T;return e(!(1&S.ka)),0>=H||0>=Z?0:(H=M.Ib(S,M),M.Jb!=null&&M.Jb(S,M,H),M.Dc+=H,1)}function Mt(S){S.ma.memory=null}function Gt(S,M,H,Z){return W(S,8)!=47?0:(M[0]=W(S,14)+1,H[0]=W(S,14)+1,Z[0]=W(S,1),W(S,3)!=0?0:!S.h)}function Zt(S,M){if(4>S)return S+1;var H=S-2>>1;return(2+(1&S)<<H)+W(M,H)+1}function Ut(S,M){return 120<M?M-120:1<=(H=((H=Uo[M-1])>>4)*S+(8-(15&H)))?H:1;var H}function It(S,M,H){var Z=te(H),le=S[M+=255&Z].g-8;return 0<le&&(xe(H,H.u+8),Z=te(H),M+=S[M].value,M+=Z&(1<<le)-1),xe(H,H.u+S[M].g),S[M].value}function Vt(S,M,H){return H.g+=S.g,H.value+=S.value<<M>>>0,e(8>=H.g),S.g}function pr(S,M,H){var Z=S.xc;return e((M=Z==0?0:S.vc[S.md*(H>>Z)+(M>>Z)])<S.Wb),S.Ya[M]}function en(S,M,H,Z){var le=S.ab,de=S.c*M,he=S.C;M=he+M;var ge=H,ye=Z;for(Z=S.Ta,H=S.Ua;0<le--;){var _e=S.gc[le],Ie=he,Qe=M,Se=ge,$e=ye,Ye=(ye=Z,ge=H,_e.Ea);switch(e(Ie<Qe),e(Qe<=_e.nc),_e.hc){case 2:ei(Se,$e,(Qe-Ie)*Ye,ye,ge);break;case 0:var pt=Ie,Je=Qe,ft=ye,yt=ge,Pt=(rr=_e).Ea;pt==0&&(rh(Se,$e,null,null,1,ft,yt),dt(Se,$e+1,0,0,Pt-1,ft,yt+1),$e+=Pt,yt+=Pt,++pt);for(var St=1<<rr.b,ar=St-1,Qt=Ne(Pt,rr.b),Pr=rr.K,rr=rr.w+(pt>>rr.b)*Qt;pt<Je;){var rn=Pr,bs=rr,Ur=1;for(nh(Se,$e,ft,yt-Pt,1,ft,yt);Ur<Pt;){var er=(Ur&~ar)+St;er>Pt&&(er=Pt),(0,lc[rn[bs++]>>8&15])(Se,$e+ +Ur,ft,yt+Ur-Pt,er-Ur,ft,yt+Ur),Ur=er}$e+=Pt,yt+=Pt,++pt&ar||(rr+=Qt)}Qe!=_e.nc&&n(ye,ge-Ye,ye,ge+(Qe-Ie-1)*Ye,Ye);break;case 1:for(Ye=Se,Je=$e,Pt=(Se=_e.Ea)-(yt=Se&~(ft=($e=1<<_e.b)-1)),pt=Ne(Se,_e.b),St=_e.K,_e=_e.w+(Ie>>_e.b)*pt;Ie<Qe;){for(ar=St,Qt=_e,Pr=new xt,rr=Je+yt,rn=Je+Se;Je<rr;)lt(ar[Qt++],Pr),sh(Pr,Ye,Je,$e,ye,ge),Je+=$e,ge+=$e;Je<rn&&(lt(ar[Qt++],Pr),sh(Pr,Ye,Je,Pt,ye,ge),Je+=Pt,ge+=Pt),++Ie&ft||(_e+=pt)}break;case 3:if(Se==ye&&$e==ge&&0<_e.b){for(Je=ye,Se=Ye=ge+(Qe-Ie)*Ye-(yt=(Qe-Ie)*Ne(_e.Ea,_e.b)),$e=ye,ft=ge,pt=[],yt=(Pt=yt)-1;0<=yt;--yt)pt[yt]=$e[ft+yt];for(yt=Pt-1;0<=yt;--yt)Je[Se+yt]=pt[yt];G0(_e,Ie,Qe,ye,Ye,ye,ge)}else G0(_e,Ie,Qe,Se,$e,ye,ge)}ge=Z,ye=H}ye!=H&&n(Z,H,ge,ye,de)}function Yr(S,M){var H=S.V,Z=S.Ba+S.c*S.C,le=M-S.C;if(e(M<=S.l.o),e(16>=le),0<le){var de=S.l,he=S.Ta,ge=S.Ua,ye=de.width;if(en(S,le,H,Z),le=ge=[ge],e((H=S.C)<(Z=M)),e(de.v<de.va),Z>de.o&&(Z=de.o),H<de.j){var _e=de.j-H;H=de.j,le[0]+=_e*ye}if(H>=Z?H=0:(le[0]+=4*de.v,de.ka=H-de.j,de.U=de.va-de.v,de.T=Z-H,H=1),H){if(ge=ge[0],11>(H=S.ca).S){var Ie=H.f.RGBA,Qe=(Z=H.S,le=de.U,de=de.T,_e=Ie.eb,Ie.A),Se=de;for(Ie=Ie.fb+S.Ma*Ie.A;0<Se--;){var $e=he,Ye=ge,pt=le,Je=_e,ft=Ie;switch(Z){case K0:ih($e,Ye,pt,Je,ft);break;case ua:cc($e,Ye,pt,Je,ft);break;case Sf:cc($e,Ye,pt,Je,ft),zd(Je,ft,0,pt,1,0);break;case X0:Fd($e,Ye,pt,Je,ft);break;case $o:At($e,Ye,pt,Je,ft,1);break;case J0:At($e,Ye,pt,Je,ft,1),zd(Je,ft,0,pt,1,0);break;case kf:At($e,Ye,pt,Je,ft,0);break;case oh:At($e,Ye,pt,Je,ft,0),zd(Je,ft,1,pt,1,0);break;case ah:dc($e,Ye,pt,Je,ft);break;case Z0:dc($e,Ye,pt,Je,ft),Bo(Je,ft,pt,1,0);break;case Kc:Ml($e,Ye,pt,Je,ft);break;default:e(0)}ge+=ye,Ie+=Qe}S.Ma+=de}else alert("todo:EmitRescaledRowsYUVA");e(S.Ma<=H.height)}}S.C=M,e(S.C<=S.i)}function $r(S){var M;if(0<S.ua)return 0;for(M=0;M<S.Wb;++M){var H=S.Ya[M].G,Z=S.Ya[M].H;if(0<H[1][Z[1]+0].g||0<H[2][Z[2]+0].g||0<H[3][Z[3]+0].g)return 0}return 1}function Qr(S,M,H,Z,le,de){if(S.Z!=0){var he=S.qd,ge=S.rd;for(e(fc[S.Z]!=null);M<H;++M)fc[S.Z](he,ge,Z,le,Z,le,de),he=Z,ge=le,le+=de;S.qd=he,S.rd=ge}}function pn(S,M){var H=S.l.ma,Z=H.Z==0||H.Z==1?S.l.j:S.C;if(Z=S.C<Z?Z:S.C,e(M<=S.l.o),M>Z){var le=S.l.width,de=H.ca,he=H.tb+le*Z,ge=S.V,ye=S.Ba+S.c*Z,_e=S.gc;e(S.ab==1),e(_e[0].hc==3),Ol(_e[0],Z,M,ge,ye,de,he),Qr(H,Z,M,de,he,le)}S.C=S.Ma=M}function Hr(S,M,H,Z,le,de,he){var ge=S.$/Z,ye=S.$%Z,_e=S.m,Ie=S.s,Qe=H+S.$,Se=Qe;le=H+Z*le;var $e=H+Z*de,Ye=280+Ie.ua,pt=S.Pb?ge:16777216,Je=0<Ie.ua?Ie.Wa:null,ft=Ie.wc,yt=Qe<$e?pr(Ie,ye,ge):null;e(S.C<de),e($e<=le);var Pt=!1;e:for(;;){for(;Pt||Qe<$e;){var St=0;if(ge>=pt){var ar=Qe-H;e((pt=S).Pb),pt.wd=pt.m,pt.xd=ar,0<pt.s.ua&&De(pt.s.Wa,pt.s.vb),pt=ge+Xc}if(ye&ft||(yt=pr(Ie,ye,ge)),e(yt!=null),yt.Qb&&(M[Qe]=yt.qb,Pt=!0),!Pt)if(ue(_e),yt.jc){St=_e,ar=M;var Qt=Qe,Pr=yt.pd[te(St)&Yc-1];e(yt.jc),256>Pr.g?(xe(St,St.u+Pr.g),ar[Qt]=Pr.value,St=0):(xe(St,St.u+Pr.g-256),e(256<=Pr.value),St=Pr.value),St==0&&(Pt=!0)}else St=It(yt.G[0],yt.H[0],_e);if(_e.h)break;if(Pt||256>St){if(!Pt)if(yt.nd)M[Qe]=(yt.qb|St<<8)>>>0;else{if(ue(_e),Pt=It(yt.G[1],yt.H[1],_e),ue(_e),ar=It(yt.G[2],yt.H[2],_e),Qt=It(yt.G[3],yt.H[3],_e),_e.h)break;M[Qe]=(Qt<<24|Pt<<16|St<<8|ar)>>>0}if(Pt=!1,++Qe,++ye>=Z&&(ye=0,++ge,he!=null&&ge<=de&&!(ge%16)&&he(S,ge),Je!=null))for(;Se<Qe;)St=M[Se++],Je.X[(506832829*St&4294967295)>>>Je.Mb]=St}else if(280>St){if(St=Zt(St-256,_e),ar=It(yt.G[4],yt.H[4],_e),ue(_e),ar=Ut(Z,ar=Zt(ar,_e)),_e.h)break;if(Qe-H<ar||le-Qe<St)break e;for(Qt=0;Qt<St;++Qt)M[Qe+Qt]=M[Qe+Qt-ar];for(Qe+=St,ye+=St;ye>=Z;)ye-=Z,++ge,he!=null&&ge<=de&&!(ge%16)&&he(S,ge);if(e(Qe<=le),ye&ft&&(yt=pr(Ie,ye,ge)),Je!=null)for(;Se<Qe;)St=M[Se++],Je.X[(506832829*St&4294967295)>>>Je.Mb]=St}else{if(!(St<Ye))break e;for(Pt=St-280,e(Je!=null);Se<Qe;)St=M[Se++],Je.X[(506832829*St&4294967295)>>>Je.Mb]=St;St=Qe,e(!(Pt>>>(ar=Je).Xa)),M[St]=ar.X[Pt],Pt=!0}Pt||e(_e.h==ce(_e))}if(S.Pb&&_e.h&&Qe<le)e(S.m.h),S.a=5,S.m=S.wd,S.$=S.xd,0<S.s.ua&&De(S.s.vb,S.s.Wa);else{if(_e.h)break e;he?.(S,ge>de?de:ge),S.a=0,S.$=Qe-H}return 1}return S.a=3,0}function ss(S){e(S!=null),S.vc=null,S.yc=null,S.Ya=null;var M=S.Wa;M!=null&&(M.X=null),S.vb=null,e(S!=null)}function Ei(){var S=new cr;return S==null?null:(S.a=0,S.xb=rg,Xt("Predictor","VP8LPredictors"),Xt("Predictor","VP8LPredictors_C"),Xt("PredictorAdd","VP8LPredictorsAdd"),Xt("PredictorAdd","VP8LPredictorsAdd_C"),ei=Ve,sh=kt,ih=Bt,cc=zt,dc=Ot,Ml=Et,Fd=$t,B.VP8LMapColor32b=Ll,B.VP8LMapColor8b=Gi,S)}function wi(S,M,H,Z,le){var de=1,he=[S],ge=[M],ye=Z.m,_e=Z.s,Ie=null,Qe=0;e:for(;;){if(H)for(;de&&W(ye,1);){var Se=he,$e=ge,Ye=Z,pt=1,Je=Ye.m,ft=Ye.gc[Ye.ab],yt=W(Je,2);if(Ye.Oc&1<<yt)de=0;else{switch(Ye.Oc|=1<<yt,ft.hc=yt,ft.Ea=Se[0],ft.nc=$e[0],ft.K=[null],++Ye.ab,e(4>=Ye.ab),yt){case 0:case 1:ft.b=W(Je,3)+2,pt=wi(Ne(ft.Ea,ft.b),Ne(ft.nc,ft.b),0,Ye,ft.K),ft.K=ft.K[0];break;case 3:var Pt,St=W(Je,8)+1,ar=16<St?0:4<St?1:2<St?2:3;if(Se[0]=Ne(ft.Ea,ar),ft.b=ar,Pt=pt=wi(St,1,0,Ye,ft.K)){var Qt,Pr=St,rr=ft,rn=1<<(8>>rr.b),bs=a(rn);if(bs==null)Pt=0;else{var Ur=rr.K[0],er=rr.w;for(bs[0]=rr.K[0][0],Qt=1;Qt<1*Pr;++Qt)bs[Qt]=Ge(Ur[er+Qt],bs[Qt-1]);for(;Qt<4*rn;++Qt)bs[Qt]=0;rr.K[0]=null,rr.K[0]=bs,Pt=1}}pt=Pt;break;case 2:break;default:e(0)}de=pt}}if(he=he[0],ge=ge[0],de&&W(ye,1)&&!(de=1<=(Qe=W(ye,4))&&11>=Qe)){Z.a=3;break e}var Wt;if(Wt=de)t:{var Ls,Er,Wr,qn=Z,Ni=he,Ji=ge,cs=Qe,di=H,ha=qn.m,ui=qn.s,Jr=[null],kn=1,Os=0,On=zo[cs];r:for(;;){if(di&&W(ha,1)){var ki=W(ha,3)+2,Ms=Ne(Ni,ki),Sn=Ne(Ji,ki),ni=Ms*Sn;if(!wi(Ms,Sn,0,qn,Jr))break r;for(Jr=Jr[0],ui.xc=ki,Ls=0;Ls<ni;++Ls){var Hn=Jr[Ls]>>8&65535;Jr[Ls]=Hn,Hn>=kn&&(kn=Hn+1)}}if(ha.h)break r;for(Er=0;5>Er;++Er){var hi=Hd[Er];!Er&&0<cs&&(hi+=1<<cs),Os<hi&&(Os=hi)}var fi=o(kn*On,P),Jn=kn,xn=o(Jn,X);if(xn==null)var fa=null;else e(65536>=Jn),fa=xn;var Hs=a(Os);if(fa==null||Hs==null||fi==null){qn.a=1;break r}var vr=fi;for(Ls=Wr=0;Ls<kn;++Ls){var Nr=fa[Ls],_n=Nr.G,Za=Nr.H,Go=0,Da=1,pi=0;for(Er=0;5>Er;++Er){hi=Hd[Er],_n[Er]=vr,Za[Er]=Wr,!Er&&0<cs&&(hi+=1<<cs);s:{var rd,nd=hi,ip=qn,ds=Hs,sg=vr,ig=Wr,ap=0,pc=ip.m,J5=W(pc,1);if(i(ds,0,0,nd),J5){var ag=W(pc,1)+1,og=W(pc,1),op=W(pc,og==0?1:8);ds[op]=1,ag==2&&(ds[op=W(pc,8)]=1);var Mi=1}else{var Ws=a(19),Ef=W(pc,4)+4;if(19<Ef){ip.a=3;var sd=0;break s}for(rd=0;rd<Ef;++rd)Ws[_f[rd]]=W(pc,3);var hh=void 0,Vd=void 0,Rl=ip,lp=Ws,fh=nd,cp=ds,dp=0,mc=Rl.m,lg=8,cg=o(128,P);n:for(;R(cg,0,7,lp,19);){if(W(mc,1)){var by=2+2*W(mc,3);if((hh=2+W(mc,by))>fh)break n}else hh=fh;for(Vd=0;Vd<fh&&hh--;){ue(mc);var dg=cg[0+(127&te(mc))];xe(mc,mc.u+dg.g);var id=dg.value;if(16>id)cp[Vd++]=id,id!=0&&(lg=id);else{var yy=id==16,vy=id-16,wy=lh[vy],ug=W(mc,Fo[vy])+wy;if(Vd+ug>fh)break n;for(var jy=yy?lg:0;0<ug--;)cp[Vd++]=jy}}dp=1;break n}dp||(Rl.a=3),Mi=dp}(Mi=Mi&&!pc.h)&&(ap=R(sg,ig,8,ds,nd)),Mi&&ap!=0?sd=ap:(ip.a=3,sd=0)}if(sd==0)break r;if(Da&&Q0[Er]==1&&(Da=vr[Wr].g==0),Go+=vr[Wr].g,Wr+=sd,3>=Er){var Yd,up=Hs[0];for(Yd=1;Yd<hi;++Yd)Hs[Yd]>up&&(up=Hs[Yd]);pi+=up}}if(Nr.nd=Da,Nr.Qb=0,Da&&(Nr.qb=(_n[3][Za[3]+0].value<<24|_n[1][Za[1]+0].value<<16|_n[2][Za[2]+0].value)>>>0,Go==0&&256>_n[0][Za[0]+0].value&&(Nr.Qb=1,Nr.qb+=_n[0][Za[0]+0].value<<8)),Nr.jc=!Nr.Qb&&6>pi,Nr.jc){var Tf,Dl=Nr;for(Tf=0;Tf<Yc;++Tf){var gc=Tf,xc=Dl.pd[gc],hp=Dl.G[0][Dl.H[0]+gc];256<=hp.value?(xc.g=hp.g+256,xc.value=hp.value):(xc.g=0,xc.value=0,gc>>=Vt(hp,8,xc),gc>>=Vt(Dl.G[1][Dl.H[1]+gc],16,xc),gc>>=Vt(Dl.G[2][Dl.H[2]+gc],0,xc),Vt(Dl.G[3][Dl.H[3]+gc],24,xc))}}}ui.vc=Jr,ui.Wb=kn,ui.Ya=fa,ui.yc=fi,Wt=1;break t}Wt=0}if(!(de=Wt)){Z.a=3;break e}if(0<Qe){if(_e.ua=1<<Qe,!oe(_e.Wa,Qe)){Z.a=1,de=0;break e}}else _e.ua=0;var fp=Z,Kd=he,Ny=ge,ph=fp.s,mh=ph.xc;if(fp.c=Kd,fp.i=Ny,ph.md=Ne(Kd,mh),ph.wc=mh==0?-1:(1<<mh)-1,H){Z.xb=Jc;break e}if((Ie=a(he*ge))==null){Z.a=1,de=0;break e}de=(de=Hr(Z,Ie,0,he,ge,ge,null))&&!ye.h;break e}return de?(le!=null?le[0]=Ie:(e(Ie==null),e(H)),Z.$=0,H||ss(_e)):ss(_e),de}function $s(S,M){var H=S.c*S.i,Z=H+M+16*M;return e(S.c<=M),S.V=a(Z),S.V==null?(S.Ta=null,S.Ua=0,S.a=1,0):(S.Ta=S.V,S.Ua=S.Ba+H+M,1)}function zi(S,M){var H=S.C,Z=M-H,le=S.V,de=S.Ba+S.c*H;for(e(M<=S.l.o);0<Z;){var he=16<Z?16:Z,ge=S.l.ma,ye=S.l.width,_e=ye*he,Ie=ge.ca,Qe=ge.tb+ye*H,Se=S.Ta,$e=S.Ua;en(S,he,le,de),fo(Se,$e,Ie,Qe,_e),Qr(ge,H,H+he,Ie,Qe,ye),Z-=he,le+=he*S.c,H+=he}e(H==M),S.C=S.Ma=M}function jn(){this.ub=this.yd=this.td=this.Rb=0}function ze(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function rt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ht(){this.Yb=(function(){var S=[];return(function M(H,Z,le){for(var de=le[Z],he=0;he<de&&(H.push(le.length>Z+1?[]:0),!(le.length<Z+1));he++)M(H[he],Z+1,le)})(S,0,[3,11]),S})()}function Rt(){this.jb=a(3),this.Wc=l([4,8],ht),this.Xc=l([4,17],ht)}function yr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Fr(){this.ld=this.La=this.dd=this.tc=0}function Mn(){this.Na=this.la=0}function ps(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function _r(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fr),this.Y=0,this.ya=Array(new _r),this.aa=0,this.l=new Fs}function Ya(){this.y=a(16),this.f=a(8),this.ea=a(8)}function al(){this.cb=this.a=0,this.sc="",this.m=new U,this.Od=new jn,this.Kc=new ze,this.ed=new yr,this.Qa=new rt,this.Ic=this.$c=this.Aa=0,this.D=new qi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,U),this.ia=0,this.pb=o(4,ps),this.Pa=new Rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ya),this.Hd=0,this.rb=Array(new Mn),this.sb=0,this.wa=Array(new Fr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new _r),this.L=this.aa=0,this.gd=l([4,2],Fr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ji(S,M){return 0>S?0:S>M?M:S}function Fs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function is(){var S=new al;return S!=null&&(S.a=0,S.sc="OK",S.cb=0,S.Xb=0,po||(po=Kr)),S}function Rr(S,M,H){return S.a==0&&(S.a=M,S.sc=H,S.cb=0),0}function Hi(S,M,H){return 3<=H&&S[M+0]==157&&S[M+1]==1&&S[M+2]==42}function Us(S,M){if(S==null)return 0;if(S.a=0,S.sc="OK",M==null)return Rr(S,2,"null VP8Io passed to VP8GetHeaders()");var H=M.data,Z=M.w,le=M.ha;if(4>le)return Rr(S,7,"Truncated header.");var de=H[Z+0]|H[Z+1]<<8|H[Z+2]<<16,he=S.Od;if(he.Rb=!(1&de),he.td=de>>1&7,he.yd=de>>4&1,he.ub=de>>5,3<he.td)return Rr(S,3,"Incorrect keyframe parameters.");if(!he.yd)return Rr(S,4,"Frame not displayable.");Z+=3,le-=3;var ge=S.Kc;if(he.Rb){if(7>le)return Rr(S,7,"cannot parse picture header");if(!Hi(H,Z,le))return Rr(S,3,"Bad code word");ge.c=16383&(H[Z+4]<<8|H[Z+3]),ge.Td=H[Z+4]>>6,ge.i=16383&(H[Z+6]<<8|H[Z+5]),ge.Ud=H[Z+6]>>6,Z+=7,le-=7,S.za=ge.c+15>>4,S.Ub=ge.i+15>>4,M.width=ge.c,M.height=ge.i,M.Da=0,M.j=0,M.v=0,M.va=M.width,M.o=M.height,M.da=0,M.ib=M.width,M.hb=M.height,M.U=M.width,M.T=M.height,i((de=S.Pa).jb,0,255,de.jb.length),e((de=S.Qa)!=null),de.Cb=0,de.Bb=0,de.Fb=1,i(de.Zb,0,0,de.Zb.length),i(de.Lb,0,0,de.Lb)}if(he.ub>le)return Rr(S,7,"bad partition length");G(de=S.m,H,Z,he.ub),Z+=he.ub,le-=he.ub,he.Rb&&(ge.Ld=Q(de),ge.Kd=Q(de)),ge=S.Qa;var ye,_e=S.Pa;if(e(de!=null),e(ge!=null),ge.Cb=Q(de),ge.Cb){if(ge.Bb=Q(de),Q(de)){for(ge.Fb=Q(de),ye=0;4>ye;++ye)ge.Zb[ye]=Q(de)?ee(de,7):0;for(ye=0;4>ye;++ye)ge.Lb[ye]=Q(de)?ee(de,6):0}if(ge.Bb)for(ye=0;3>ye;++ye)_e.jb[ye]=Q(de)?ne(de,8):255}else ge.Bb=0;if(de.Ka)return Rr(S,3,"cannot parse segment header");if((ge=S.ed).zd=Q(de),ge.Tb=ne(de,6),ge.wb=ne(de,3),ge.Pc=Q(de),ge.Pc&&Q(de)){for(_e=0;4>_e;++_e)Q(de)&&(ge.vd[_e]=ee(de,6));for(_e=0;4>_e;++_e)Q(de)&&(ge.od[_e]=ee(de,6))}if(S.L=ge.Tb==0?0:ge.zd?1:2,de.Ka)return Rr(S,3,"cannot parse filter header");var Ie=le;if(le=ye=Z,Z=ye+Ie,ge=Ie,S.Xb=(1<<ne(S.m,2))-1,Ie<3*(_e=S.Xb))H=7;else{for(ye+=3*_e,ge-=3*_e,Ie=0;Ie<_e;++Ie){var Qe=H[le+0]|H[le+1]<<8|H[le+2]<<16;Qe>ge&&(Qe=ge),G(S.Jc[+Ie],H,ye,Qe),ye+=Qe,ge-=Qe,le+=3}G(S.Jc[+_e],H,ye,ge),H=ye<Z?0:5}if(H!=0)return Rr(S,H,"cannot parse partitions");for(H=ne(ye=S.m,7),le=Q(ye)?ee(ye,4):0,Z=Q(ye)?ee(ye,4):0,ge=Q(ye)?ee(ye,4):0,_e=Q(ye)?ee(ye,4):0,ye=Q(ye)?ee(ye,4):0,Ie=S.Qa,Qe=0;4>Qe;++Qe){if(Ie.Cb){var Se=Ie.Zb[Qe];Ie.Fb||(Se+=H)}else{if(0<Qe){S.pb[Qe]=S.pb[0];continue}Se=H}var $e=S.pb[Qe];$e.Sc[0]=qo[ji(Se+le,127)],$e.Sc[1]=Ho[ji(Se+0,127)],$e.Eb[0]=2*qo[ji(Se+Z,127)],$e.Eb[1]=101581*Ho[ji(Se+ge,127)]>>16,8>$e.Eb[1]&&($e.Eb[1]=8),$e.Qc[0]=qo[ji(Se+_e,117)],$e.Qc[1]=Ho[ji(Se+ye,127)],$e.lc=Se+ye}if(!he.Rb)return Rr(S,4,"Not a key frame.");for(Q(de),he=S.Pa,H=0;4>H;++H){for(le=0;8>le;++le)for(Z=0;3>Z;++Z)for(ge=0;11>ge;++ge)_e=pe(de,xs[H][le][Z][ge])?ne(de,8):gy[H][le][Z][ge],he.Wc[H][le].Yb[Z][ge]=_e;for(le=0;17>le;++le)he.Xc[H][le]=he.Wc[H][sn[le]]}return S.kc=Q(de),S.kc&&(S.Bd=ne(de,8)),S.cb=1}function Kr(S,M,H,Z,le,de,he){var ge=M[le].Yb[H];for(H=0;16>le;++le){if(!pe(S,ge[H+0]))return le;for(;!pe(S,ge[H+1]);)if(ge=M[++le].Yb[0],H=0,le==16)return 16;var ye=M[le+1].Yb;if(pe(S,ge[H+2])){var _e=S,Ie=0;if(pe(_e,(Se=ge)[(Qe=H)+3]))if(pe(_e,Se[Qe+6])){for(ge=0,Qe=2*(Ie=pe(_e,Se[Qe+8]))+(Se=pe(_e,Se[Qe+9+Ie])),Ie=0,Se=my[Qe];Se[ge];++ge)Ie+=Ie+pe(_e,Se[ge]);Ie+=3+(8<<Qe)}else pe(_e,Se[Qe+7])?(Ie=7+2*pe(_e,165),Ie+=pe(_e,145)):Ie=5+pe(_e,159);else Ie=pe(_e,Se[Qe+4])?3+pe(_e,Se[Qe+5]):2;ge=ye[2]}else Ie=1,ge=ye[1];ye=he+tg[le],0>(_e=S).b&&ve(_e);var Qe,Se=_e.b,$e=(Qe=_e.Ca>>1)-(_e.I>>Se)>>31;--_e.b,_e.Ca+=$e,_e.Ca|=1,_e.I-=(Qe+1&$e)<<Se,de[ye]=((Ie^$e)-$e)*Z[(0<le)+0]}return 16}function _a(S){var M=S.rb[S.sb-1];M.la=0,M.Na=0,i(S.zc,0,0,S.zc.length),S.ja=0}function ms(S,M,H,Z,le){le=S[M+H+32*Z]+(le>>3),S[M+H+32*Z]=-256&le?0>le?0:255:le}function Fn(S,M,H,Z,le,de){ms(S,M,0,H,Z+le),ms(S,M,1,H,Z+de),ms(S,M,2,H,Z-de),ms(S,M,3,H,Z-le)}function as(S){return(20091*S>>16)+S}function lo(S,M,H,Z){var le,de=0,he=a(16);for(le=0;4>le;++le){var ge=S[M+0]+S[M+8],ye=S[M+0]-S[M+8],_e=(35468*S[M+4]>>16)-as(S[M+12]),Ie=as(S[M+4])+(35468*S[M+12]>>16);he[de+0]=ge+Ie,he[de+1]=ye+_e,he[de+2]=ye-_e,he[de+3]=ge-Ie,de+=4,M++}for(le=de=0;4>le;++le)ge=(S=he[de+0]+4)+he[de+8],ye=S-he[de+8],_e=(35468*he[de+4]>>16)-as(he[de+12]),ms(H,Z,0,0,ge+(Ie=as(he[de+4])+(35468*he[de+12]>>16))),ms(H,Z,1,0,ye+_e),ms(H,Z,2,0,ye-_e),ms(H,Z,3,0,ge-Ie),de++,Z+=32}function Mo(S,M,H,Z){var le=S[M+0]+4,de=35468*S[M+4]>>16,he=as(S[M+4]),ge=35468*S[M+1]>>16;Fn(H,Z,0,le+he,S=as(S[M+1]),ge),Fn(H,Z,1,le+de,S,ge),Fn(H,Z,2,le-de,S,ge),Fn(H,Z,3,le-he,S,ge)}function ol(S,M,H,Z,le){lo(S,M,H,Z),le&&lo(S,M+16,H,Z+4)}function Zs(S,M,H,Z){uc(S,M+0,H,Z,1),uc(S,M+32,H,Z+128,1)}function Ca(S,M,H,Z){var le;for(S=S[M+0]+4,le=0;4>le;++le)for(M=0;4>M;++M)ms(H,Z,M,le,S)}function Es(S,M,H,Z){S[M+0]&&Ln(S,M+0,H,Z),S[M+16]&&Ln(S,M+16,H,Z+4),S[M+32]&&Ln(S,M+32,H,Z+128),S[M+48]&&Ln(S,M+48,H,Z+128+4)}function Un(S,M,H,Z){var le,de=a(16);for(le=0;4>le;++le){var he=S[M+0+le]+S[M+12+le],ge=S[M+4+le]+S[M+8+le],ye=S[M+4+le]-S[M+8+le],_e=S[M+0+le]-S[M+12+le];de[0+le]=he+ge,de[8+le]=he-ge,de[4+le]=_e+ye,de[12+le]=_e-ye}for(le=0;4>le;++le)he=(S=de[0+4*le]+3)+de[3+4*le],ge=de[1+4*le]+de[2+4*le],ye=de[1+4*le]-de[2+4*le],_e=S-de[3+4*le],H[Z+0]=he+ge>>3,H[Z+16]=_e+ye>>3,H[Z+32]=he-ge>>3,H[Z+48]=_e-ye>>3,Z+=64}function oi(S,M,H){var Z,le=M-32,de=da,he=255-S[le-1];for(Z=0;Z<H;++Z){var ge,ye=de,_e=he+S[M-1];for(ge=0;ge<H;++ge)S[M+ge]=ye[_e+S[le+ge]];M+=32}}function ll(S,M){oi(S,M,4)}function Ti(S,M){oi(S,M,8)}function Po(S,M){oi(S,M,16)}function Io(S,M){var H;for(H=0;16>H;++H)n(S,M+32*H,S,M-32,16)}function Aa(S,M){var H;for(H=16;0<H;--H)i(S,M,S[M-1],16),M+=32}function li(S,M,H){var Z;for(Z=0;16>Z;++Z)i(M,H+32*Z,S,16)}function Li(S,M){var H,Z=16;for(H=0;16>H;++H)Z+=S[M-1+32*H]+S[M+H-32];li(Z>>5,S,M)}function Kn(S,M){var H,Z=8;for(H=0;16>H;++H)Z+=S[M-1+32*H];li(Z>>4,S,M)}function Qs(S,M){var H,Z=8;for(H=0;16>H;++H)Z+=S[M+H-32];li(Z>>4,S,M)}function Ea(S,M){li(128,S,M)}function lr(S,M,H){return S+2*M+H+2>>2}function Ta(S,M){var H,Z=M-32;for(Z=new Uint8Array([lr(S[Z-1],S[Z+0],S[Z+1]),lr(S[Z+0],S[Z+1],S[Z+2]),lr(S[Z+1],S[Z+2],S[Z+3]),lr(S[Z+2],S[Z+3],S[Z+4])]),H=0;4>H;++H)n(S,M+32*H,Z,0,Z.length)}function La(S,M){var H=S[M-1],Z=S[M-1+32],le=S[M-1+64],de=S[M-1+96];Ce(S,M+0,16843009*lr(S[M-1-32],H,Z)),Ce(S,M+32,16843009*lr(H,Z,le)),Ce(S,M+64,16843009*lr(Z,le,de)),Ce(S,M+96,16843009*lr(le,de,de))}function Ka(S,M){var H,Z=4;for(H=0;4>H;++H)Z+=S[M+H-32]+S[M-1+32*H];for(Z>>=3,H=0;4>H;++H)i(S,M+32*H,Z,4)}function Ns(S,M){var H=S[M-1+0],Z=S[M-1+32],le=S[M-1+64],de=S[M-1-32],he=S[M+0-32],ge=S[M+1-32],ye=S[M+2-32],_e=S[M+3-32];S[M+0+96]=lr(Z,le,S[M-1+96]),S[M+1+96]=S[M+0+64]=lr(H,Z,le),S[M+2+96]=S[M+1+64]=S[M+0+32]=lr(de,H,Z),S[M+3+96]=S[M+2+64]=S[M+1+32]=S[M+0+0]=lr(he,de,H),S[M+3+64]=S[M+2+32]=S[M+1+0]=lr(ge,he,de),S[M+3+32]=S[M+2+0]=lr(ye,ge,he),S[M+3+0]=lr(_e,ye,ge)}function os(S,M){var H=S[M+1-32],Z=S[M+2-32],le=S[M+3-32],de=S[M+4-32],he=S[M+5-32],ge=S[M+6-32],ye=S[M+7-32];S[M+0+0]=lr(S[M+0-32],H,Z),S[M+1+0]=S[M+0+32]=lr(H,Z,le),S[M+2+0]=S[M+1+32]=S[M+0+64]=lr(Z,le,de),S[M+3+0]=S[M+2+32]=S[M+1+64]=S[M+0+96]=lr(le,de,he),S[M+3+32]=S[M+2+64]=S[M+1+96]=lr(de,he,ge),S[M+3+64]=S[M+2+96]=lr(he,ge,ye),S[M+3+96]=lr(ge,ye,ye)}function Xa(S,M){var H=S[M-1+0],Z=S[M-1+32],le=S[M-1+64],de=S[M-1-32],he=S[M+0-32],ge=S[M+1-32],ye=S[M+2-32],_e=S[M+3-32];S[M+0+0]=S[M+1+64]=de+he+1>>1,S[M+1+0]=S[M+2+64]=he+ge+1>>1,S[M+2+0]=S[M+3+64]=ge+ye+1>>1,S[M+3+0]=ye+_e+1>>1,S[M+0+96]=lr(le,Z,H),S[M+0+64]=lr(Z,H,de),S[M+0+32]=S[M+1+96]=lr(H,de,he),S[M+1+32]=S[M+2+96]=lr(de,he,ge),S[M+2+32]=S[M+3+96]=lr(he,ge,ye),S[M+3+32]=lr(ge,ye,_e)}function Gr(S,M){var H=S[M+0-32],Z=S[M+1-32],le=S[M+2-32],de=S[M+3-32],he=S[M+4-32],ge=S[M+5-32],ye=S[M+6-32],_e=S[M+7-32];S[M+0+0]=H+Z+1>>1,S[M+1+0]=S[M+0+64]=Z+le+1>>1,S[M+2+0]=S[M+1+64]=le+de+1>>1,S[M+3+0]=S[M+2+64]=de+he+1>>1,S[M+0+32]=lr(H,Z,le),S[M+1+32]=S[M+0+96]=lr(Z,le,de),S[M+2+32]=S[M+1+96]=lr(le,de,he),S[M+3+32]=S[M+2+96]=lr(de,he,ge),S[M+3+64]=lr(he,ge,ye),S[M+3+96]=lr(ge,ye,_e)}function ci(S,M){var H=S[M-1+0],Z=S[M-1+32],le=S[M-1+64],de=S[M-1+96];S[M+0+0]=H+Z+1>>1,S[M+2+0]=S[M+0+32]=Z+le+1>>1,S[M+2+32]=S[M+0+64]=le+de+1>>1,S[M+1+0]=lr(H,Z,le),S[M+3+0]=S[M+1+32]=lr(Z,le,de),S[M+3+32]=S[M+1+64]=lr(le,de,de),S[M+3+64]=S[M+2+64]=S[M+0+96]=S[M+1+96]=S[M+2+96]=S[M+3+96]=de}function Oa(S,M){var H=S[M-1+0],Z=S[M-1+32],le=S[M-1+64],de=S[M-1+96],he=S[M-1-32],ge=S[M+0-32],ye=S[M+1-32],_e=S[M+2-32];S[M+0+0]=S[M+2+32]=H+he+1>>1,S[M+0+32]=S[M+2+64]=Z+H+1>>1,S[M+0+64]=S[M+2+96]=le+Z+1>>1,S[M+0+96]=de+le+1>>1,S[M+3+0]=lr(ge,ye,_e),S[M+2+0]=lr(he,ge,ye),S[M+1+0]=S[M+3+32]=lr(H,he,ge),S[M+1+32]=S[M+3+64]=lr(Z,H,he),S[M+1+64]=S[M+3+96]=lr(le,Z,H),S[M+1+96]=lr(de,le,Z)}function Wi(S,M){var H;for(H=0;8>H;++H)n(S,M+32*H,S,M-32,8)}function cl(S,M){var H;for(H=0;8>H;++H)i(S,M,S[M-1],8),M+=32}function K(S,M,H){var Z;for(Z=0;8>Z;++Z)i(M,H+32*Z,S,8)}function me(S,M){var H,Z=8;for(H=0;8>H;++H)Z+=S[M+H-32]+S[M-1+32*H];K(Z>>4,S,M)}function Le(S,M){var H,Z=4;for(H=0;8>H;++H)Z+=S[M+H-32];K(Z>>3,S,M)}function at(S,M){var H,Z=4;for(H=0;8>H;++H)Z+=S[M-1+32*H];K(Z>>3,S,M)}function gr(S,M){K(128,S,M)}function Kt(S,M,H){var Z=S[M-H],le=S[M+0],de=3*(le-Z)+hc[1020+S[M-2*H]-S[M+H]],he=Nf[112+(de+4>>3)];S[M-H]=da[255+Z+Nf[112+(de+3>>3)]],S[M+0]=da[255+le-he]}function Or(S,M,H,Z){var le=S[M+0],de=S[M+H];return Vi[255+S[M-2*H]-S[M-H]]>Z||Vi[255+de-le]>Z}function Dr(S,M,H,Z){return 4*Vi[255+S[M-H]-S[M+0]]+Vi[255+S[M-2*H]-S[M+H]]<=Z}function mn(S,M,H,Z,le){var de=S[M-3*H],he=S[M-2*H],ge=S[M-H],ye=S[M+0],_e=S[M+H],Ie=S[M+2*H],Qe=S[M+3*H];return 4*Vi[255+ge-ye]+Vi[255+he-_e]>Z?0:Vi[255+S[M-4*H]-de]<=le&&Vi[255+de-he]<=le&&Vi[255+he-ge]<=le&&Vi[255+Qe-Ie]<=le&&Vi[255+Ie-_e]<=le&&Vi[255+_e-ye]<=le}function Br(S,M,H,Z){var le=2*Z+1;for(Z=0;16>Z;++Z)Dr(S,M+Z,H,le)&&Kt(S,M+Z,H)}function Tn(S,M,H,Z){var le=2*Z+1;for(Z=0;16>Z;++Z)Dr(S,M+Z*H,1,le)&&Kt(S,M+Z*H,1)}function ks(S,M,H,Z){var le;for(le=3;0<le;--le)Br(S,M+=4*H,H,Z)}function Vn(S,M,H,Z){var le;for(le=3;0<le;--le)Tn(S,M+=4,H,Z)}function Nn(S,M,H,Z,le,de,he,ge){for(de=2*de+1;0<le--;){if(mn(S,M,H,de,he))if(Or(S,M,H,ge))Kt(S,M,H);else{var ye=S,_e=M,Ie=H,Qe=ye[_e-2*Ie],Se=ye[_e-Ie],$e=ye[_e+0],Ye=ye[_e+Ie],pt=ye[_e+2*Ie],Je=27*(yt=hc[1020+3*($e-Se)+hc[1020+Qe-Ye]])+63>>7,ft=18*yt+63>>7,yt=9*yt+63>>7;ye[_e-3*Ie]=da[255+ye[_e-3*Ie]+yt],ye[_e-2*Ie]=da[255+Qe+ft],ye[_e-Ie]=da[255+Se+Je],ye[_e+0]=da[255+$e-Je],ye[_e+Ie]=da[255+Ye-ft],ye[_e+2*Ie]=da[255+pt-yt]}M+=Z}}function Pn(S,M,H,Z,le,de,he,ge){for(de=2*de+1;0<le--;){if(mn(S,M,H,de,he))if(Or(S,M,H,ge))Kt(S,M,H);else{var ye=S,_e=M,Ie=H,Qe=ye[_e-Ie],Se=ye[_e+0],$e=ye[_e+Ie],Ye=Nf[112+(4+(pt=3*(Se-Qe))>>3)],pt=Nf[112+(pt+3>>3)],Je=Ye+1>>1;ye[_e-2*Ie]=da[255+ye[_e-2*Ie]+Je],ye[_e-Ie]=da[255+Qe+pt],ye[_e+0]=da[255+Se-Ye],ye[_e+Ie]=da[255+$e-Je]}M+=Z}}function oa(S,M,H,Z,le,de){Nn(S,M,H,1,16,Z,le,de)}function Ts(S,M,H,Z,le,de){Nn(S,M,1,H,16,Z,le,de)}function la(S,M,H,Z,le,de){var he;for(he=3;0<he;--he)Pn(S,M+=4*H,H,1,16,Z,le,de)}function z(S,M,H,Z,le,de){var he;for(he=3;0<he;--he)Pn(S,M+=4,1,H,16,Z,le,de)}function ae(S,M,H,Z,le,de,he,ge){Nn(S,M,le,1,8,de,he,ge),Nn(H,Z,le,1,8,de,he,ge)}function ke(S,M,H,Z,le,de,he,ge){Nn(S,M,1,le,8,de,he,ge),Nn(H,Z,1,le,8,de,he,ge)}function Me(S,M,H,Z,le,de,he,ge){Pn(S,M+4*le,le,1,8,de,he,ge),Pn(H,Z+4*le,le,1,8,de,he,ge)}function Fe(S,M,H,Z,le,de,he,ge){Pn(S,M+4,1,le,8,de,he,ge),Pn(H,Z+4,1,le,8,de,he,ge)}function mt(){this.ba=new Ct,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Yt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _t(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ir(){this.ua=0,this.Wa=new Nt,this.vb=new Nt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new X,this.yc=new P}function cr(){this.xb=this.a=0,this.l=new Fs,this.ca=new Ct,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Y,this.Pb=0,this.wd=new Y,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ir,this.ab=0,this.gc=o(4,tr),this.Oc=0}function Mr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Fs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function tn(S,M,H,Z,le,de,he){for(S=S==null?0:S[M+0],M=0;M<he;++M)le[de+M]=S+H[Z+M]&255,S=le[de+M]}function In(S,M,H,Z,le,de,he){var ge;if(S==null)tn(null,null,H,Z,le,de,he);else for(ge=0;ge<he;++ge)le[de+ge]=S[M+ge]+H[Z+ge]&255}function _(S,M,H,Z,le,de,he){if(S==null)tn(null,null,H,Z,le,de,he);else{var ge,ye=S[M+0],_e=ye,Ie=ye;for(ge=0;ge<he;++ge)_e=Ie+(ye=S[M+ge])-_e,Ie=H[Z+ge]+(-256&_e?0>_e?0:255:_e)&255,_e=ye,le[de+ge]=Ie}}function V(S,M,H,Z){var le=M.width,de=M.o;if(e(S!=null&&M!=null),0>H||0>=Z||H+Z>de)return null;if(!S.Cc){if(S.ga==null){var he;if(S.ga=new Mr,(he=S.ga==null)||(he=M.width*M.o,e(S.Gb.length==0),S.Gb=a(he),S.Uc=0,S.Gb==null?he=0:(S.mb=S.Gb,S.nb=S.Uc,S.rc=null,he=1),he=!he),!he){he=S.ga;var ge=S.Fa,ye=S.P,_e=S.qc,Ie=S.mb,Qe=S.nb,Se=ye+1,$e=_e-1,Ye=he.l;if(e(ge!=null&&Ie!=null&&M!=null),fc[0]=null,fc[1]=tn,fc[2]=In,fc[3]=_,he.ca=Ie,he.tb=Qe,he.c=M.width,he.i=M.height,e(0<he.c&&0<he.i),1>=_e)M=0;else if(he.$a=3&ge[ye+0],he.Z=ge[ye+0]>>2&3,he.Lc=ge[ye+0]>>4&3,ye=ge[ye+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||ye)M=0;else if(Ye.put=He,Ye.ac=Ee,Ye.bc=Mt,Ye.ma=he,Ye.width=M.width,Ye.height=M.height,Ye.Da=M.Da,Ye.v=M.v,Ye.va=M.va,Ye.j=M.j,Ye.o=M.o,he.$a)e:{e(he.$a==1),M=Ei();t:for(;;){if(M==null){M=0;break e}if(e(he!=null),he.mc=M,M.c=he.c,M.i=he.i,M.l=he.l,M.l.ma=he,M.l.width=he.c,M.l.height=he.i,M.a=0,se(M.m,ge,Se,$e),!wi(he.c,he.i,1,M,null)||(M.ab==1&&M.gc[0].hc==3&&$r(M.s)?(he.ic=1,ge=M.c*M.i,M.Ta=null,M.Ua=0,M.V=a(ge),M.Ba=0,M.V==null?(M.a=1,M=0):M=1):(he.ic=0,M=$s(M,he.c)),!M))break t;M=1;break e}he.mc=null,M=0}else M=$e>=he.c*he.i;he=!M}if(he)return null;S.ga.Lc!=1?S.Ga=0:Z=de-H}e(S.ga!=null),e(H+Z<=de);e:{if(M=(ge=S.ga).c,de=ge.l.o,ge.$a==0){if(Se=S.rc,$e=S.Vc,Ye=S.Fa,ye=S.P+1+H*M,_e=S.mb,Ie=S.nb+H*M,e(ye<=S.P+S.qc),ge.Z!=0)for(e(fc[ge.Z]!=null),he=0;he<Z;++he)fc[ge.Z](Se,$e,Ye,ye,_e,Ie,M),Se=_e,$e=Ie,Ie+=M,ye+=M;else for(he=0;he<Z;++he)n(_e,Ie,Ye,ye,M),Se=_e,$e=Ie,Ie+=M,ye+=M;S.rc=Se,S.Vc=$e}else{if(e(ge.mc!=null),M=H+Z,e((he=ge.mc)!=null),e(M<=he.i),he.C>=M)M=1;else if(ge.ic||Dt(),ge.ic){ge=he.V,Se=he.Ba,$e=he.c;var pt=he.i,Je=(Ye=1,ye=he.$/$e,_e=he.$%$e,Ie=he.m,Qe=he.s,he.$),ft=$e*pt,yt=$e*M,Pt=Qe.wc,St=Je<yt?pr(Qe,_e,ye):null;e(Je<=ft),e(M<=pt),e($r(Qe));t:for(;;){for(;!Ie.h&&Je<yt;){if(_e&Pt||(St=pr(Qe,_e,ye)),e(St!=null),ue(Ie),256>(pt=It(St.G[0],St.H[0],Ie)))ge[Se+Je]=pt,++Je,++_e>=$e&&(_e=0,++ye<=M&&!(ye%16)&&pn(he,ye));else{if(!(280>pt)){Ye=0;break t}pt=Zt(pt-256,Ie);var ar,Qt=It(St.G[4],St.H[4],Ie);if(ue(Ie),!(Je>=(Qt=Ut($e,Qt=Zt(Qt,Ie)))&&ft-Je>=pt)){Ye=0;break t}for(ar=0;ar<pt;++ar)ge[Se+Je+ar]=ge[Se+Je+ar-Qt];for(Je+=pt,_e+=pt;_e>=$e;)_e-=$e,++ye<=M&&!(ye%16)&&pn(he,ye);Je<yt&&_e&Pt&&(St=pr(Qe,_e,ye))}e(Ie.h==ce(Ie))}pn(he,ye>M?M:ye);break t}!Ye||Ie.h&&Je<ft?(Ye=0,he.a=Ie.h?5:3):he.$=Je,M=Ye}else M=Hr(he,he.V,he.Ba,he.c,he.i,M,zi);if(!M){Z=0;break e}}H+Z>=de&&(S.Cc=1),Z=1}if(!Z)return null;if(S.Cc&&((Z=S.ga)!=null&&(Z.mc=null),S.ga=null,0<S.Ga))return alert("todo:WebPDequantizeLevels"),null}return S.nb+H*le}function ie(S,M,H,Z,le,de){for(;0<le--;){var he,ge=S,ye=M+(H?1:0),_e=S,Ie=M+(H?0:3);for(he=0;he<Z;++he){var Qe=_e[Ie+4*he];Qe!=255&&(Qe*=32897,ge[ye+4*he+0]=ge[ye+4*he+0]*Qe>>23,ge[ye+4*he+1]=ge[ye+4*he+1]*Qe>>23,ge[ye+4*he+2]=ge[ye+4*he+2]*Qe>>23)}M+=de}}function be(S,M,H,Z,le){for(;0<Z--;){var de;for(de=0;de<H;++de){var he=S[M+2*de+0],ge=15&(_e=S[M+2*de+1]),ye=4369*ge,_e=(240&_e|_e>>4)*ye>>16;S[M+2*de+0]=(240&he|he>>4)*ye>>16&240|(15&he|he<<4)*ye>>16>>4&15,S[M+2*de+1]=240&_e|ge}M+=le}}function qe(S,M,H,Z,le,de,he,ge){var ye,_e,Ie=255;for(_e=0;_e<le;++_e){for(ye=0;ye<Z;++ye){var Qe=S[M+ye];de[he+4*ye]=Qe,Ie&=Qe}M+=H,he+=ge}return Ie!=255}function st(S,M,H,Z,le){var de;for(de=0;de<le;++de)H[Z+de]=S[M+de]>>8}function Dt(){zd=ie,Bo=be,vf=qe,fo=st}function Ar(S,M,H){B[S]=function(Z,le,de,he,ge,ye,_e,Ie,Qe,Se,$e,Ye,pt,Je,ft,yt,Pt){var St,ar=Pt-1>>1,Qt=ge[ye+0]|_e[Ie+0]<<16,Pr=Qe[Se+0]|$e[Ye+0]<<16;e(Z!=null);var rr=3*Qt+Pr+131074>>2;for(M(Z[le+0],255&rr,rr>>16,pt,Je),de!=null&&(rr=3*Pr+Qt+131074>>2,M(de[he+0],255&rr,rr>>16,ft,yt)),St=1;St<=ar;++St){var rn=ge[ye+St]|_e[Ie+St]<<16,bs=Qe[Se+St]|$e[Ye+St]<<16,Ur=Qt+rn+Pr+bs+524296,er=Ur+2*(rn+Pr)>>3;rr=er+Qt>>1,Qt=(Ur=Ur+2*(Qt+bs)>>3)+rn>>1,M(Z[le+2*St-1],255&rr,rr>>16,pt,Je+(2*St-1)*H),M(Z[le+2*St-0],255&Qt,Qt>>16,pt,Je+(2*St-0)*H),de!=null&&(rr=Ur+Pr>>1,Qt=er+bs>>1,M(de[he+2*St-1],255&rr,rr>>16,ft,yt+(2*St-1)*H),M(de[he+2*St+0],255&Qt,Qt>>16,ft,yt+(2*St+0)*H)),Qt=rn,Pr=bs}1&Pt||(rr=3*Qt+Pr+131074>>2,M(Z[le+Pt-1],255&rr,rr>>16,pt,Je+(Pt-1)*H),de!=null&&(rr=3*Pr+Qt+131074>>2,M(de[he+Pt-1],255&rr,rr>>16,ft,yt+(Pt-1)*H)))}}function gs(){Ki[K0]=Wd,Ki[ua]=ch,Ki[X0]=ng,Ki[$o]=tp,Ki[kf]=Zc,Ki[ah]=Il,Ki[Kc]=Qc,Ki[Sf]=ch,Ki[J0]=tp,Ki[oh]=Zc,Ki[Z0]=Il}function un(S){return S&-16384?0>S?0:255:S>>rp}function zn(S,M){return un((19077*S>>8)+(26149*M>>8)-14234)}function zs(S,M,H){return un((19077*S>>8)-(6419*M>>8)-(13320*H>>8)+8708)}function Ma(S,M){return un((19077*S>>8)+(33050*M>>8)-17685)}function Oi(S,M,H,Z,le){Z[le+0]=zn(S,H),Z[le+1]=zs(S,M,H),Z[le+2]=Ma(S,M)}function Xn(S,M,H,Z,le){Z[le+0]=Ma(S,M),Z[le+1]=zs(S,M,H),Z[le+2]=zn(S,H)}function co(S,M,H,Z,le){var de=zs(S,M,H);M=de<<3&224|Ma(S,M)>>3,Z[le+0]=248&zn(S,H)|de>>5,Z[le+1]=M}function Ro(S,M,H,Z,le){var de=240&Ma(S,M)|15;Z[le+0]=240&zn(S,H)|zs(S,M,H)>>4,Z[le+1]=de}function eh(S,M,H,Z,le){Z[le+0]=255,Oi(S,M,H,Z,le+1)}function Al(S,M,H,Z,le){Xn(S,M,H,Z,le),Z[le+3]=255}function Pa(S,M,H,Z,le){Oi(S,M,H,Z,le),Z[le+3]=255}function ic(S,M,H){B[S]=function(Z,le,de,he,ge,ye,_e,Ie,Qe){for(var Se=Ie+(-2&Qe)*H;Ie!=Se;)M(Z[le+0],de[he+0],ge[ye+0],_e,Ie),M(Z[le+1],de[he+0],ge[ye+0],_e,Ie+H),le+=2,++he,++ye,Ie+=2*H;1&Qe&&M(Z[le+0],de[he+0],ge[ye+0],_e,Ie)}}function th(S,M,H){return H==0?S==0?M==0?6:5:M==0?4:0:H}function xf(S,M,H,Z,le){switch(S>>>30){case 3:uc(M,H,Z,le,0);break;case 2:ca(M,H,Z,le);break;case 1:Ln(M,H,Z,le)}}function uo(S,M){var H,Z,le=M.M,de=M.Nb,he=S.oc,ge=S.pc+40,ye=S.oc,_e=S.pc+584,Ie=S.oc,Qe=S.pc+600;for(H=0;16>H;++H)he[ge+32*H-1]=129;for(H=0;8>H;++H)ye[_e+32*H-1]=129,Ie[Qe+32*H-1]=129;for(0<le?he[ge-1-32]=ye[_e-1-32]=Ie[Qe-1-32]=129:(i(he,ge-32-1,127,21),i(ye,_e-32-1,127,9),i(Ie,Qe-32-1,127,9)),Z=0;Z<S.za;++Z){var Se=M.ya[M.aa+Z];if(0<Z){for(H=-1;16>H;++H)n(he,ge+32*H-4,he,ge+32*H+12,4);for(H=-1;8>H;++H)n(ye,_e+32*H-4,ye,_e+32*H+4,4),n(Ie,Qe+32*H-4,Ie,Qe+32*H+4,4)}var $e=S.Gd,Ye=S.Hd+Z,pt=Se.ad,Je=Se.Hc;if(0<le&&(n(he,ge-32,$e[Ye].y,0,16),n(ye,_e-32,$e[Ye].f,0,8),n(Ie,Qe-32,$e[Ye].ea,0,8)),Se.Za){var ft=he,yt=ge-32+16;for(0<le&&(Z>=S.za-1?i(ft,yt,$e[Ye].y[15],4):n(ft,yt,$e[Ye+1].y,0,4)),H=0;4>H;H++)ft[yt+128+H]=ft[yt+256+H]=ft[yt+384+H]=ft[yt+0+H];for(H=0;16>H;++H,Je<<=2)ft=he,yt=ge+ri[H],qs[Se.Ob[H]](ft,yt),xf(Je,pt,16*+H,ft,yt)}else if(ft=th(Z,le,Se.Ob[0]),Ra[ft](he,ge),Je!=0)for(H=0;16>H;++H,Je<<=2)xf(Je,pt,16*+H,he,ge+ri[H]);for(H=Se.Gc,ft=th(Z,le,Se.Dd),fl[ft](ye,_e),fl[ft](Ie,Qe),Je=pt,ft=ye,yt=_e,255&(Se=0|H)&&(170&Se?Do(Je,256,ft,yt):gn(Je,256,ft,yt)),Se=Ie,Je=Qe,255&(H>>=8)&&(170&H?Do(pt,320,Se,Je):gn(pt,320,Se,Je)),le<S.Ub-1&&(n($e[Ye].y,0,he,ge+480,16),n($e[Ye].f,0,ye,_e+224,8),n($e[Ye].ea,0,Ie,Qe+224,8)),H=8*de*S.B,$e=S.sa,Ye=S.ta+16*Z+16*de*S.R,pt=S.qa,Se=S.ra+8*Z+H,Je=S.Ha,ft=S.Ia+8*Z+H,H=0;16>H;++H)n($e,Ye+H*S.R,he,ge+32*H,16);for(H=0;8>H;++H)n(pt,Se+H*S.B,ye,_e+32*H,8),n(Je,ft+H*S.B,Ie,Qe+32*H,8)}}function dl(S,M,H,Z,le,de,he,ge,ye){var _e=[0],Ie=[0],Qe=0,Se=ye!=null?ye.kd:0,$e=ye??new _t;if(S==null||12>H)return 7;$e.data=S,$e.w=M,$e.ha=H,M=[M],H=[H],$e.gb=[$e.gb];e:{var Ye=M,pt=H,Je=$e.gb;if(e(S!=null),e(pt!=null),e(Je!=null),Je[0]=0,12<=pt[0]&&!r(S,Ye[0],"RIFF")){if(r(S,Ye[0]+8,"WEBP")){Je=3;break e}var ft=Te(S,Ye[0]+4);if(12>ft||4294967286<ft){Je=3;break e}if(Se&&ft>pt[0]-8){Je=7;break e}Je[0]=ft,Ye[0]+=12,pt[0]-=12}Je=0}if(Je!=0)return Je;for(ft=0<$e.gb[0],H=H[0];;){e:{var yt=S;pt=M,Je=H;var Pt=_e,St=Ie,ar=Ye=[0];if((rr=Qe=[Qe])[0]=0,8>Je[0])Je=7;else{if(!r(yt,pt[0],"VP8X")){if(Te(yt,pt[0]+4)!=10){Je=3;break e}if(18>Je[0]){Je=7;break e}var Qt=Te(yt,pt[0]+8),Pr=1+we(yt,pt[0]+12);if(2147483648<=Pr*(yt=1+we(yt,pt[0]+15))){Je=3;break e}ar!=null&&(ar[0]=Qt),Pt!=null&&(Pt[0]=Pr),St!=null&&(St[0]=yt),pt[0]+=18,Je[0]-=18,rr[0]=1}Je=0}}if(Qe=Qe[0],Ye=Ye[0],Je!=0)return Je;if(pt=!!(2&Ye),!ft&&Qe)return 3;if(de!=null&&(de[0]=!!(16&Ye)),he!=null&&(he[0]=pt),ge!=null&&(ge[0]=0),he=_e[0],Ye=Ie[0],Qe&&pt&&ye==null){Je=0;break}if(4>H){Je=7;break}if(ft&&Qe||!ft&&!Qe&&!r(S,M[0],"ALPH")){H=[H],$e.na=[$e.na],$e.P=[$e.P],$e.Sa=[$e.Sa];e:{Qt=S,Je=M,ft=H;var rr=$e.gb;Pt=$e.na,St=$e.P,ar=$e.Sa,Pr=22,e(Qt!=null),e(ft!=null),yt=Je[0];var rn=ft[0];for(e(Pt!=null),e(ar!=null),Pt[0]=null,St[0]=null,ar[0]=0;;){if(Je[0]=yt,ft[0]=rn,8>rn){Je=7;break e}var bs=Te(Qt,yt+4);if(4294967286<bs){Je=3;break e}var Ur=8+bs+1&-2;if(Pr+=Ur,0<rr&&Pr>rr){Je=3;break e}if(!r(Qt,yt,"VP8 ")||!r(Qt,yt,"VP8L")){Je=0;break e}if(rn[0]<Ur){Je=7;break e}r(Qt,yt,"ALPH")||(Pt[0]=Qt,St[0]=yt+8,ar[0]=bs),yt+=Ur,rn-=Ur}}if(H=H[0],$e.na=$e.na[0],$e.P=$e.P[0],$e.Sa=$e.Sa[0],Je!=0)break}H=[H],$e.Ja=[$e.Ja],$e.xa=[$e.xa];e:if(rr=S,Je=M,ft=H,Pt=$e.gb[0],St=$e.Ja,ar=$e.xa,Qt=Je[0],yt=!r(rr,Qt,"VP8 "),Pr=!r(rr,Qt,"VP8L"),e(rr!=null),e(ft!=null),e(St!=null),e(ar!=null),8>ft[0])Je=7;else{if(yt||Pr){if(rr=Te(rr,Qt+4),12<=Pt&&rr>Pt-12){Je=3;break e}if(Se&&rr>ft[0]-8){Je=7;break e}St[0]=rr,Je[0]+=8,ft[0]-=8,ar[0]=Pr}else ar[0]=5<=ft[0]&&rr[Qt+0]==47&&!(rr[Qt+4]>>5),St[0]=ft[0];Je=0}if(H=H[0],$e.Ja=$e.Ja[0],$e.xa=$e.xa[0],M=M[0],Je!=0)break;if(4294967286<$e.Ja)return 3;if(ge==null||pt||(ge[0]=$e.xa?2:1),he=[he],Ye=[Ye],$e.xa){if(5>H){Je=7;break}ge=he,Se=Ye,pt=de,S==null||5>H?S=0:5<=H&&S[M+0]==47&&!(S[M+4]>>5)?(ft=[0],rr=[0],Pt=[0],se(St=new Y,S,M,H),Gt(St,ft,rr,Pt)?(ge!=null&&(ge[0]=ft[0]),Se!=null&&(Se[0]=rr[0]),pt!=null&&(pt[0]=Pt[0]),S=1):S=0):S=0}else{if(10>H){Je=7;break}ge=Ye,S==null||10>H||!Hi(S,M+3,H-3)?S=0:(Se=S[M+0]|S[M+1]<<8|S[M+2]<<16,pt=16383&(S[M+7]<<8|S[M+6]),S=16383&(S[M+9]<<8|S[M+8]),1&Se||3<(Se>>1&7)||!(Se>>4&1)||Se>>5>=$e.Ja||!pt||!S?S=0:(he&&(he[0]=pt),ge&&(ge[0]=S),S=1))}if(!S||(he=he[0],Ye=Ye[0],Qe&&(_e[0]!=he||Ie[0]!=Ye)))return 3;ye!=null&&(ye[0]=$e,ye.offset=M-ye.w,e(4294967286>M-ye.w),e(ye.offset==ye.ha-H));break}return Je==0||Je==7&&Qe&&ye==null?(de!=null&&(de[0]|=$e.na!=null&&0<$e.na.length),Z!=null&&(Z[0]=he),le!=null&&(le[0]=Ye),0):Je}function ac(S,M,H){var Z=M.width,le=M.height,de=0,he=0,ge=Z,ye=le;if(M.Da=S!=null&&0<S.Da,M.Da&&(ge=S.cd,ye=S.bd,de=S.v,he=S.j,11>H||(de&=-2,he&=-2),0>de||0>he||0>=ge||0>=ye||de+ge>Z||he+ye>le))return 0;if(M.v=de,M.j=he,M.va=de+ge,M.o=he+ye,M.U=ge,M.T=ye,M.da=S!=null&&0<S.da,M.da){if(!ot(ge,ye,H=[S.ib],de=[S.hb]))return 0;M.ib=H[0],M.hb=de[0]}return M.ob=S!=null&&S.ob,M.Kb=S==null||!S.Sd,M.da&&(M.ob=M.ib<3*Z/4&&M.hb<3*le/4,M.Kb=0),1}function bf(S){if(S==null)return 2;if(11>S.S){var M=S.f.RGBA;M.fb+=(S.height-1)*M.A,M.A=-M.A}else M=S.f.kb,S=S.height,M.O+=(S-1)*M.fa,M.fa=-M.fa,M.N+=(S-1>>1)*M.Ab,M.Ab=-M.Ab,M.W+=(S-1>>1)*M.Db,M.Db=-M.Db,M.F!=null&&(M.J+=(S-1)*M.lb,M.lb=-M.lb);return 0}function ul(S,M,H,Z){if(Z==null||0>=S||0>=M)return 2;if(H!=null){if(H.Da){var le=H.cd,de=H.bd,he=-2&H.v,ge=-2&H.j;if(0>he||0>ge||0>=le||0>=de||he+le>S||ge+de>M)return 2;S=le,M=de}if(H.da){if(!ot(S,M,le=[H.ib],de=[H.hb]))return 2;S=le[0],M=de[0]}}Z.width=S,Z.height=M;e:{var ye=Z.width,_e=Z.height;if(S=Z.S,0>=ye||0>=_e||!(S>=K0&&13>S))S=2;else{if(0>=Z.Rd&&Z.sd==null){he=de=le=M=0;var Ie=(ge=ye*sp[S])*_e;if(11>S||(de=(_e+1)/2*(M=(ye+1)/2),S==12&&(he=(le=ye)*_e)),(_e=a(Ie+2*de+he))==null){S=1;break e}Z.sd=_e,11>S?((ye=Z.f.RGBA).eb=_e,ye.fb=0,ye.A=ge,ye.size=Ie):((ye=Z.f.kb).y=_e,ye.O=0,ye.fa=ge,ye.Fd=Ie,ye.f=_e,ye.N=0+Ie,ye.Ab=M,ye.Cd=de,ye.ea=_e,ye.W=0+Ie+de,ye.Db=M,ye.Ed=de,S==12&&(ye.F=_e,ye.J=0+Ie+2*de),ye.Tc=he,ye.lb=le)}if(M=1,le=Z.S,de=Z.width,he=Z.height,le>=K0&&13>le)if(11>le)S=Z.f.RGBA,M&=(ge=Math.abs(S.A))*(he-1)+de<=S.size,M&=ge>=de*sp[le],M&=S.eb!=null;else{S=Z.f.kb,ge=(de+1)/2,Ie=(he+1)/2,ye=Math.abs(S.fa),_e=Math.abs(S.Ab);var Qe=Math.abs(S.Db),Se=Math.abs(S.lb),$e=Se*(he-1)+de;M&=ye*(he-1)+de<=S.Fd,M&=_e*(Ie-1)+ge<=S.Cd,M=(M&=Qe*(Ie-1)+ge<=S.Ed)&ye>=de&_e>=ge&Qe>=ge,M&=S.y!=null,M&=S.f!=null,M&=S.ea!=null,le==12&&(M&=Se>=de,M&=$e<=S.Tc,M&=S.F!=null)}else M=0;S=M?0:2}}return S!=0||H!=null&&H.fd&&(S=bf(Z)),S}var Yc=64,Ja=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ia=24,El=32,Tl=8,oc=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xe("Predictor0","PredictorAdd0"),B.Predictor0=function(){return 4278190080},B.Predictor1=function(S){return S},B.Predictor2=function(S,M,H){return M[H+0]},B.Predictor3=function(S,M,H){return M[H+1]},B.Predictor4=function(S,M,H){return M[H-1]},B.Predictor5=function(S,M,H){return Ae(Ae(S,M[H+1]),M[H+0])},B.Predictor6=function(S,M,H){return Ae(S,M[H-1])},B.Predictor7=function(S,M,H){return Ae(S,M[H+0])},B.Predictor8=function(S,M,H){return Ae(M[H-1],M[H+0])},B.Predictor9=function(S,M,H){return Ae(M[H+0],M[H+1])},B.Predictor10=function(S,M,H){return Ae(Ae(S,M[H-1]),Ae(M[H+0],M[H+1]))},B.Predictor11=function(S,M,H){var Z=M[H+0];return 0>=bt(Z>>24&255,S>>24&255,(M=M[H-1])>>24&255)+bt(Z>>16&255,S>>16&255,M>>16&255)+bt(Z>>8&255,S>>8&255,M>>8&255)+bt(255&Z,255&S,255&M)?Z:S},B.Predictor12=function(S,M,H){var Z=M[H+0];return(Pe((S>>24&255)+(Z>>24&255)-((M=M[H-1])>>24&255))<<24|Pe((S>>16&255)+(Z>>16&255)-(M>>16&255))<<16|Pe((S>>8&255)+(Z>>8&255)-(M>>8&255))<<8|Pe((255&S)+(255&Z)-(255&M)))>>>0},B.Predictor13=function(S,M,H){var Z=M[H-1];return(ct((S=Ae(S,M[H+0]))>>24&255,Z>>24&255)<<24|ct(S>>16&255,Z>>16&255)<<16|ct(S>>8&255,Z>>8&255)<<8|ct(255&S,255&Z))>>>0};var rh=B.PredictorAdd0;B.PredictorAdd1=dt,Xe("Predictor2","PredictorAdd2"),Xe("Predictor3","PredictorAdd3"),Xe("Predictor4","PredictorAdd4"),Xe("Predictor5","PredictorAdd5"),Xe("Predictor6","PredictorAdd6"),Xe("Predictor7","PredictorAdd7"),Xe("Predictor8","PredictorAdd8"),Xe("Predictor9","PredictorAdd9"),Xe("Predictor10","PredictorAdd10"),Xe("Predictor11","PredictorAdd11"),Xe("Predictor12","PredictorAdd12"),Xe("Predictor13","PredictorAdd13");var nh=B.PredictorAdd2;Ue("ColorIndexInverseTransform","MapARGB","32b",function(S){return S>>8&255},function(S){return S}),Ue("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(S){return S},function(S){return S>>8&255});var ei,G0=B.ColorIndexInverseTransform,Ll=B.MapARGB,Ol=B.VP8LColorIndexInverseTransformAlpha,Gi=B.MapAlpha,lc=B.VP8LPredictorsAdd=[];lc.length=16,(B.VP8LPredictors=[]).length=16,(B.VP8LPredictorsAdd_C=[]).length=16,(B.VP8LPredictors_C=[]).length=16;var sh,ih,cc,dc,Ml,Fd,ho,uc,ca,Do,Ln,gn,ls,ti,Pl,hl,Ud,yf,Zm,hy,fy,py,Qm,eg,zd,Bo,vf,fo,qd=a(511),V0=a(2041),wf=a(225),jf=a(767),Y0=0,hc=V0,Nf=wf,da=jf,Vi=qd,K0=0,ua=1,X0=2,$o=3,kf=4,ah=5,Kc=6,Sf=7,J0=8,oh=9,Z0=10,Fo=[2,3,7],lh=[3,3,11],Hd=[280,256,256,256,40],Q0=[0,1,1,1,0],_f=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Uo=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],zo=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Xc=8,qo=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ho=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],po=null,my=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],tg=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ep=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],gy=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Yi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],xs=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],sn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ra=[],qs=[],fl=[],Jc=1,rg=2,fc=[],Ki=[];Ar("UpsampleRgbLinePair",Oi,3),Ar("UpsampleBgrLinePair",Xn,3),Ar("UpsampleRgbaLinePair",Pa,4),Ar("UpsampleBgraLinePair",Al,4),Ar("UpsampleArgbLinePair",eh,4),Ar("UpsampleRgba4444LinePair",Ro,2),Ar("UpsampleRgb565LinePair",co,2);var Wd=B.UpsampleRgbLinePair,ng=B.UpsampleBgrLinePair,ch=B.UpsampleRgbaLinePair,tp=B.UpsampleBgraLinePair,Zc=B.UpsampleArgbLinePair,Il=B.UpsampleRgba4444LinePair,Qc=B.UpsampleRgb565LinePair,Wo=16,dh=1<<Wo-1,Gd=-227,ed=482,rp=6,td=0,Xi=a(256),np=a(256),xy=a(256),Y5=a(256),K5=a(ed-Gd),X5=a(ed-Gd);ic("YuvToRgbRow",Oi,3),ic("YuvToBgrRow",Xn,3),ic("YuvToRgbaRow",Pa,4),ic("YuvToBgraRow",Al,4),ic("YuvToArgbRow",eh,4),ic("YuvToRgba4444Row",Ro,2),ic("YuvToRgb565Row",co,2);var ri=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],uh=[0,2,8],Cf=[8,7,6,4,4,2,2,2,1,1,1,1],Af=1;this.WebPDecodeRGBA=function(S,M,H,Z,le){var de=ua,he=new mt,ge=new Ct;he.ba=ge,ge.S=de,ge.width=[ge.width],ge.height=[ge.height];var ye=ge.width,_e=ge.height,Ie=new Tt;if(Ie==null||S==null)var Qe=2;else e(Ie!=null),Qe=dl(S,M,H,Ie.width,Ie.height,Ie.Pd,Ie.Qd,Ie.format,null);if(Qe!=0?ye=0:(ye!=null&&(ye[0]=Ie.width[0]),_e!=null&&(_e[0]=Ie.height[0]),ye=1),ye){ge.width=ge.width[0],ge.height=ge.height[0],Z!=null&&(Z[0]=ge.width),le!=null&&(le[0]=ge.height);e:{if(Z=new Fs,(le=new _t).data=S,le.w=M,le.ha=H,le.kd=1,M=[0],e(le!=null),((S=dl(le.data,le.w,le.ha,null,null,null,M,null,le))==0||S==7)&&M[0]&&(S=4),(M=S)==0){if(e(he!=null),Z.data=le.data,Z.w=le.w+le.offset,Z.ha=le.ha-le.offset,Z.put=He,Z.ac=Ee,Z.bc=Mt,Z.ma=he,le.xa){if((S=Ei())==null){he=1;break e}if((function(Se,$e){var Ye=[0],pt=[0],Je=[0];t:for(;;){if(Se==null)return 0;if($e==null)return Se.a=2,0;if(Se.l=$e,Se.a=0,se(Se.m,$e.data,$e.w,$e.ha),!Gt(Se.m,Ye,pt,Je)){Se.a=3;break t}if(Se.xb=rg,$e.width=Ye[0],$e.height=pt[0],!wi(Ye[0],pt[0],1,Se,null))break t;return 1}return e(Se.a!=0),0})(S,Z)){if(Z=(M=ul(Z.width,Z.height,he.Oa,he.ba))==0){t:{Z=S;r:for(;;){if(Z==null){Z=0;break t}if(e(Z.s.yc!=null),e(Z.s.Ya!=null),e(0<Z.s.Wb),e((H=Z.l)!=null),e((le=H.ma)!=null),Z.xb!=0){if(Z.ca=le.ba,Z.tb=le.tb,e(Z.ca!=null),!ac(le.Oa,H,$o)){Z.a=2;break r}if(!$s(Z,H.width)||H.da)break r;if((H.da||qt(Z.ca.S))&&Dt(),11>Z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Z.ca.f.kb.F!=null&&Dt()),Z.Pb&&0<Z.s.ua&&Z.s.vb.X==null&&!oe(Z.s.vb,Z.s.Wa.Xa)){Z.a=1;break r}Z.xb=0}if(!Hr(Z,Z.V,Z.Ba,Z.c,Z.i,H.o,Yr))break r;le.Dc=Z.Ma,Z=1;break t}e(Z.a!=0),Z=0}Z=!Z}Z&&(M=S.a)}else M=S.a}else{if((S=new is)==null){he=1;break e}if(S.Fa=le.na,S.P=le.P,S.qc=le.Sa,Us(S,Z)){if((M=ul(Z.width,Z.height,he.Oa,he.ba))==0){if(S.Aa=0,H=he.Oa,e((le=S)!=null),H!=null){if(0<(ye=0>(ye=H.Md)?0:100<ye?255:255*ye/100)){for(_e=Ie=0;4>_e;++_e)12>(Qe=le.pb[_e]).lc&&(Qe.ia=ye*Cf[0>Qe.lc?0:Qe.lc]>>3),Ie|=Qe.ia;Ie&&(alert("todo:VP8InitRandom"),le.ia=1)}le.Ga=H.Id,100<le.Ga?le.Ga=100:0>le.Ga&&(le.Ga=0)}(function(Se,$e){if(Se==null)return 0;if($e==null)return Rr(Se,2,"NULL VP8Io parameter in VP8Decode().");if(!Se.cb&&!Us(Se,$e))return 0;if(e(Se.cb),$e.ac==null||$e.ac($e)){$e.ob&&(Se.L=0);var Ye=uh[Se.L];if(Se.L==2?(Se.yb=0,Se.zb=0):(Se.yb=$e.v-Ye>>4,Se.zb=$e.j-Ye>>4,0>Se.yb&&(Se.yb=0),0>Se.zb&&(Se.zb=0)),Se.Va=$e.o+15+Ye>>4,Se.Hb=$e.va+15+Ye>>4,Se.Hb>Se.za&&(Se.Hb=Se.za),Se.Va>Se.Ub&&(Se.Va=Se.Ub),0<Se.L){var pt=Se.ed;for(Ye=0;4>Ye;++Ye){var Je;if(Se.Qa.Cb){var ft=Se.Qa.Lb[Ye];Se.Qa.Fb||(ft+=pt.Tb)}else ft=pt.Tb;for(Je=0;1>=Je;++Je){var yt=Se.gd[Ye][Je],Pt=ft;if(pt.Pc&&(Pt+=pt.vd[0],Je&&(Pt+=pt.od[0])),0<(Pt=0>Pt?0:63<Pt?63:Pt)){var St=Pt;0<pt.wb&&(St=4<pt.wb?St>>2:St>>1)>9-pt.wb&&(St=9-pt.wb),1>St&&(St=1),yt.dd=St,yt.tc=2*Pt+St,yt.ld=40<=Pt?2:15<=Pt?1:0}else yt.tc=0;yt.La=Je}}}Ye=0}else Rr(Se,6,"Frame setup failed"),Ye=Se.a;if(Ye=Ye==0){if(Ye){Se.$c=0,0<Se.Aa||(Se.Ic=Af);t:{Ye=Se.Ic,pt=4*(St=Se.za);var ar=32*St,Qt=St+1,Pr=0<Se.L?St*(0<Se.Aa?2:1):0,rr=(Se.Aa==2?2:1)*St;if((yt=pt+832+(Je=3*(16*Ye+uh[Se.L])/2*ar)+(ft=Se.Fa!=null&&0<Se.Fa.length?Se.Kc.c*Se.Kc.i:0))!=yt)Ye=0;else{if(yt>Se.Vb){if(Se.Vb=0,Se.Ec=a(yt),Se.Fc=0,Se.Ec==null){Ye=Rr(Se,1,"no memory during frame initialization.");break t}Se.Vb=yt}yt=Se.Ec,Pt=Se.Fc,Se.Ac=yt,Se.Bc=Pt,Pt+=pt,Se.Gd=o(ar,Ya),Se.Hd=0,Se.rb=o(Qt+1,Mn),Se.sb=1,Se.wa=Pr?o(Pr,Fr):null,Se.Y=0,Se.D.Nb=0,Se.D.wa=Se.wa,Se.D.Y=Se.Y,0<Se.Aa&&(Se.D.Y+=St),e(!0),Se.oc=yt,Se.pc=Pt,Pt+=832,Se.ya=o(rr,_r),Se.aa=0,Se.D.ya=Se.ya,Se.D.aa=Se.aa,Se.Aa==2&&(Se.D.aa+=St),Se.R=16*St,Se.B=8*St,St=(ar=uh[Se.L])*Se.R,ar=ar/2*Se.B,Se.sa=yt,Se.ta=Pt+St,Se.qa=Se.sa,Se.ra=Se.ta+16*Ye*Se.R+ar,Se.Ha=Se.qa,Se.Ia=Se.ra+8*Ye*Se.B+ar,Se.$c=0,Pt+=Je,Se.mb=ft?yt:null,Se.nb=ft?Pt:null,e(Pt+ft<=Se.Fc+Se.Vb),_a(Se),i(Se.Ac,Se.Bc,0,pt),Ye=1}}if(Ye){if($e.ka=0,$e.y=Se.sa,$e.O=Se.ta,$e.f=Se.qa,$e.N=Se.ra,$e.ea=Se.Ha,$e.Vd=Se.Ia,$e.fa=Se.R,$e.Rc=Se.B,$e.F=null,$e.J=0,!Y0){for(Ye=-255;255>=Ye;++Ye)qd[255+Ye]=0>Ye?-Ye:Ye;for(Ye=-1020;1020>=Ye;++Ye)V0[1020+Ye]=-128>Ye?-128:127<Ye?127:Ye;for(Ye=-112;112>=Ye;++Ye)wf[112+Ye]=-16>Ye?-16:15<Ye?15:Ye;for(Ye=-255;510>=Ye;++Ye)jf[255+Ye]=0>Ye?0:255<Ye?255:Ye;Y0=1}ho=Un,uc=ol,Do=Zs,Ln=Ca,gn=Es,ca=Mo,ls=oa,ti=Ts,Pl=ae,hl=ke,Ud=la,yf=z,Zm=Me,hy=Fe,fy=Br,py=Tn,Qm=ks,eg=Vn,qs[0]=Ka,qs[1]=ll,qs[2]=Ta,qs[3]=La,qs[4]=Ns,qs[5]=Xa,qs[6]=os,qs[7]=Gr,qs[8]=Oa,qs[9]=ci,Ra[0]=Li,Ra[1]=Po,Ra[2]=Io,Ra[3]=Aa,Ra[4]=Kn,Ra[5]=Qs,Ra[6]=Ea,fl[0]=me,fl[1]=Ti,fl[2]=Wi,fl[3]=cl,fl[4]=at,fl[5]=Le,fl[6]=gr,Ye=1}else Ye=0}Ye&&(Ye=(function(rn,bs){for(rn.M=0;rn.M<rn.Va;++rn.M){var Ur,er=rn.Jc[rn.M&rn.Xb],Wt=rn.m,Ls=rn;for(Ur=0;Ur<Ls.za;++Ur){var Er=Wt,Wr=Ls,qn=Wr.Ac,Ni=Wr.Bc+4*Ur,Ji=Wr.zc,cs=Wr.ya[Wr.aa+Ur];if(Wr.Qa.Bb?cs.$b=pe(Er,Wr.Pa.jb[0])?2+pe(Er,Wr.Pa.jb[2]):pe(Er,Wr.Pa.jb[1]):cs.$b=0,Wr.kc&&(cs.Ad=pe(Er,Wr.Bd)),cs.Za=!pe(Er,145)+0,cs.Za){var di=cs.Ob,ha=0;for(Wr=0;4>Wr;++Wr){var ui,Jr=Ji[0+Wr];for(ui=0;4>ui;++ui){Jr=Yi[qn[Ni+ui]][Jr];for(var kn=ep[pe(Er,Jr[0])];0<kn;)kn=ep[2*kn+pe(Er,Jr[kn])];Jr=-kn,qn[Ni+ui]=Jr}n(di,ha,qn,Ni,4),ha+=4,Ji[0+Wr]=Jr}}else Jr=pe(Er,156)?pe(Er,128)?1:3:pe(Er,163)?2:0,cs.Ob[0]=Jr,i(qn,Ni,Jr,4),i(Ji,0,Jr,4);cs.Dd=pe(Er,142)?pe(Er,114)?pe(Er,183)?1:3:2:0}if(Ls.m.Ka)return Rr(rn,7,"Premature end-of-partition0 encountered.");for(;rn.ja<rn.za;++rn.ja){if(Ls=er,Er=(Wt=rn).rb[Wt.sb-1],qn=Wt.rb[Wt.sb+Wt.ja],Ur=Wt.ya[Wt.aa+Wt.ja],Ni=Wt.kc?Ur.Ad:0)Er.la=qn.la=0,Ur.Za||(Er.Na=qn.Na=0),Ur.Hc=0,Ur.Gc=0,Ur.ia=0;else{var Os,On;if(Er=qn,qn=Ls,Ni=Wt.Pa.Xc,Ji=Wt.ya[Wt.aa+Wt.ja],cs=Wt.pb[Ji.$b],Wr=Ji.ad,di=0,ha=Wt.rb[Wt.sb-1],Jr=ui=0,i(Wr,di,0,384),Ji.Za)var ki=0,Ms=Ni[3];else{kn=a(16);var Sn=Er.Na+ha.Na;if(Sn=po(qn,Ni[1],Sn,cs.Eb,0,kn,0),Er.Na=ha.Na=(0<Sn)+0,1<Sn)ho(kn,0,Wr,di);else{var ni=kn[0]+3>>3;for(kn=0;256>kn;kn+=16)Wr[di+kn]=ni}ki=1,Ms=Ni[0]}var Hn=15&Er.la,hi=15&ha.la;for(kn=0;4>kn;++kn){var fi=1&hi;for(ni=On=0;4>ni;++ni)Hn=Hn>>1|(fi=(Sn=po(qn,Ms,Sn=fi+(1&Hn),cs.Sc,ki,Wr,di))>ki)<<7,On=On<<2|(3<Sn?3:1<Sn?2:Wr[di+0]!=0),di+=16;Hn>>=4,hi=hi>>1|fi<<7,ui=(ui<<8|On)>>>0}for(Ms=Hn,ki=hi>>4,Os=0;4>Os;Os+=2){for(On=0,Hn=Er.la>>4+Os,hi=ha.la>>4+Os,kn=0;2>kn;++kn){for(fi=1&hi,ni=0;2>ni;++ni)Sn=fi+(1&Hn),Hn=Hn>>1|(fi=0<(Sn=po(qn,Ni[2],Sn,cs.Qc,0,Wr,di)))<<3,On=On<<2|(3<Sn?3:1<Sn?2:Wr[di+0]!=0),di+=16;Hn>>=2,hi=hi>>1|fi<<5}Jr|=On<<4*Os,Ms|=Hn<<4<<Os,ki|=(240&hi)<<Os}Er.la=Ms,ha.la=ki,Ji.Hc=ui,Ji.Gc=Jr,Ji.ia=43690&Jr?0:cs.ia,Ni=!(ui|Jr)}if(0<Wt.L&&(Wt.wa[Wt.Y+Wt.ja]=Wt.gd[Ur.$b][Ur.Za],Wt.wa[Wt.Y+Wt.ja].La|=!Ni),Ls.Ka)return Rr(rn,7,"Premature end-of-file encountered.")}if(_a(rn),Wt=bs,Ls=1,Ur=(er=rn).D,Er=0<er.L&&er.M>=er.zb&&er.M<=er.Va,er.Aa==0)t:{if(Ur.M=er.M,Ur.uc=Er,uo(er,Ur),Ls=1,Ur=(On=er.D).Nb,Er=(Jr=uh[er.L])*er.R,qn=Jr/2*er.B,kn=16*Ur*er.R,ni=8*Ur*er.B,Ni=er.sa,Ji=er.ta-Er+kn,cs=er.qa,Wr=er.ra-qn+ni,di=er.Ha,ha=er.Ia-qn+ni,hi=(Hn=On.M)==0,ui=Hn>=er.Va-1,er.Aa==2&&uo(er,On),On.uc)for(fi=(Sn=er).D.M,e(Sn.D.uc),On=Sn.yb;On<Sn.Hb;++On){ki=On,Ms=fi;var Jn=(xn=(pi=Sn).D).Nb;Os=pi.R;var xn=xn.wa[xn.Y+ki],fa=pi.sa,Hs=pi.ta+16*Jn*Os+16*ki,vr=xn.dd,Nr=xn.tc;if(Nr!=0)if(e(3<=Nr),pi.L==1)0<ki&&py(fa,Hs,Os,Nr+4),xn.La&&eg(fa,Hs,Os,Nr),0<Ms&&fy(fa,Hs,Os,Nr+4),xn.La&&Qm(fa,Hs,Os,Nr);else{var _n=pi.B,Za=pi.qa,Go=pi.ra+8*Jn*_n+8*ki,Da=pi.Ha,pi=pi.Ia+8*Jn*_n+8*ki;Jn=xn.ld,0<ki&&(ti(fa,Hs,Os,Nr+4,vr,Jn),hl(Za,Go,Da,pi,_n,Nr+4,vr,Jn)),xn.La&&(yf(fa,Hs,Os,Nr,vr,Jn),hy(Za,Go,Da,pi,_n,Nr,vr,Jn)),0<Ms&&(ls(fa,Hs,Os,Nr+4,vr,Jn),Pl(Za,Go,Da,pi,_n,Nr+4,vr,Jn)),xn.La&&(Ud(fa,Hs,Os,Nr,vr,Jn),Zm(Za,Go,Da,pi,_n,Nr,vr,Jn))}}if(er.ia&&alert("todo:DitherRow"),Wt.put!=null){if(On=16*Hn,Hn=16*(Hn+1),hi?(Wt.y=er.sa,Wt.O=er.ta+kn,Wt.f=er.qa,Wt.N=er.ra+ni,Wt.ea=er.Ha,Wt.W=er.Ia+ni):(On-=Jr,Wt.y=Ni,Wt.O=Ji,Wt.f=cs,Wt.N=Wr,Wt.ea=di,Wt.W=ha),ui||(Hn-=Jr),Hn>Wt.o&&(Hn=Wt.o),Wt.F=null,Wt.J=null,er.Fa!=null&&0<er.Fa.length&&On<Hn&&(Wt.J=V(er,Wt,On,Hn-On),Wt.F=er.mb,Wt.F==null&&Wt.F.length==0)){Ls=Rr(er,3,"Could not decode alpha data.");break t}On<Wt.j&&(Jr=Wt.j-On,On=Wt.j,e(!(1&Jr)),Wt.O+=er.R*Jr,Wt.N+=er.B*(Jr>>1),Wt.W+=er.B*(Jr>>1),Wt.F!=null&&(Wt.J+=Wt.width*Jr)),On<Hn&&(Wt.O+=Wt.v,Wt.N+=Wt.v>>1,Wt.W+=Wt.v>>1,Wt.F!=null&&(Wt.J+=Wt.v),Wt.ka=On-Wt.j,Wt.U=Wt.va-Wt.v,Wt.T=Hn-On,Ls=Wt.put(Wt))}Ur+1!=er.Ic||ui||(n(er.sa,er.ta-Er,Ni,Ji+16*er.R,Er),n(er.qa,er.ra-qn,cs,Wr+8*er.B,qn),n(er.Ha,er.Ia-qn,di,ha+8*er.B,qn))}if(!Ls)return Rr(rn,6,"Output aborted.")}return 1})(Se,$e)),$e.bc!=null&&$e.bc($e),Ye&=1}return Ye?(Se.cb=0,Ye):0})(S,Z)||(M=S.a)}}else M=S.a}M==0&&he.Oa!=null&&he.Oa.fd&&(M=bf(he.ba))}he=M}de=he!=0?null:11>de?ge.f.RGBA.eb:ge.f.kb.y}else de=null;return de};var sp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(B,$){for(var k="",R=0;R<4;R++)k+=String.fromCharCode(B[$++]);return k}function f(B,$){return B[$+0]|B[$+1]<<8}function p(B,$){return(B[$+0]|B[$+1]<<8|B[$+2]<<16)>>>0}function x(B,$){return(B[$+0]|B[$+1]<<8|B[$+2]<<16|B[$+3]<<24)>>>0}new c;var m=[0],y=[0],v=[],j=new c,N=t,C=(function(B,$){var k={},R=0,P=!1,q=0,X=0;if(k.frames=[],!(function(U,Y){for(var te=0;te<4;te++)if(U[Y+te]!="RIFF".charCodeAt(te))return!0;return!1})(B,$)){for(x(B,$+=4),$+=8;$<B.length;){var G=u(B,$),ne=x(B,$+=4);$+=4;var ee=ne+(1&ne);switch(G){case"VP8 ":case"VP8L":k.frames[R]===void 0&&(k.frames[R]={}),(W=k.frames[R]).src_off=P?X:$-8,W.src_size=q+ne+8,R++,P&&(P=!1,q=0,X=0);break;case"VP8X":(W=k.header={}).feature_flags=B[$];var se=$+4;W.canvas_width=1+p(B,se),se+=3,W.canvas_height=1+p(B,se),se+=3;break;case"ALPH":P=!0,q=ee+8,X=$-8;break;case"ANIM":(W=k.header).bgcolor=x(B,$),se=$+4,W.loop_count=f(B,se),se+=2;break;case"ANMF":var J,W;(W=k.frames[R]={}).offset_x=2*p(B,$),$+=3,W.offset_y=2*p(B,$),$+=3,W.width=1+p(B,$),$+=3,W.height=1+p(B,$),$+=3,W.duration=p(B,$),$+=3,J=B[$++],W.dispose=1&J,W.blend=J>>1&1}G!="ANMF"&&($+=ee)}return k}})(N,0);C.response=N,C.rgbaoutput=!0,C.dataurl=!1;var A=C.header?C.header:null,L=C.frames?C.frames:null;if(A){A.loop_counter=A.loop_count,m=[A.canvas_height],y=[A.canvas_width];for(var O=0;O<L.length&&L[O].blend!=0;O++);}var F=L[0],T=j.WebPDecodeRGBA(N,F.src_off,F.src_size,y,m);F.rgba=T,F.imgwidth=y[0],F.imgheight=m[0];for(var I=0;I<y[0]*m[0]*4;I++)v[I]=T[I];return this.width=y,this.height=m,this.data=v,this}(function(t){var e,r,n,i,a,o,l,c,u,f=function(U){return U=U||{},this.isStrokeTransparent=U.isStrokeTransparent||!1,this.strokeOpacity=U.strokeOpacity||1,this.strokeStyle=U.strokeStyle||"#000000",this.fillStyle=U.fillStyle||"#000000",this.isFillTransparent=U.isFillTransparent||!1,this.fillOpacity=U.fillOpacity||1,this.font=U.font||"10px sans-serif",this.textBaseline=U.textBaseline||"alphabetic",this.textAlign=U.textAlign||"left",this.lineWidth=U.lineWidth||1,this.lineJoin=U.lineJoin||"miter",this.lineCap=U.lineCap||"butt",this.path=U.path||[],this.transform=U.transform!==void 0?U.transform.clone():new c,this.globalCompositeOperation=U.globalCompositeOperation||"normal",this.globalAlpha=U.globalAlpha||1,this.clip_path=U.clip_path||[],this.currentPoint=U.currentPoint||new o,this.miterLimit=U.miterLimit||10,this.lastPoint=U.lastPoint||new o,this.lineDashOffset=U.lineDashOffset||0,this.lineDash=U.lineDash||[],this.margin=U.margin||[0,0,0,0],this.prevPageLastElemOffset=U.prevPageLastElemOffset||0,this.ignoreClearRect=typeof U.ignoreClearRect!="boolean"||U.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var p=function(U){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Y=U;Object.defineProperty(this,"pdf",{get:function(){return Y}});var te=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return te},set:function(oe){te=!!oe}});var ce=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ce},set:function(oe){ce=!!oe}});var xe=0;Object.defineProperty(this,"posX",{get:function(){return xe},set:function(oe){isNaN(oe)||(xe=oe)}});var ue=0;Object.defineProperty(this,"posY",{get:function(){return ue},set:function(oe){isNaN(oe)||(ue=oe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(oe){var De;typeof oe=="number"?De=[oe,oe,oe,oe]:((De=new Array(4))[0]=oe[0],De[1]=oe.length>=2?oe[1]:De[0],De[2]=oe.length>=3?oe[2]:De[0],De[3]=oe.length>=4?oe[3]:De[1]),u.margin=De}});var ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ve},set:function(oe){ve=oe}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(oe){Q=oe}});var pe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return pe},set:function(oe){pe=oe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(oe){oe instanceof f&&(u=oe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(oe){u.path=oe}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(oe){Ce=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var De;De=x(oe),this.ctx.fillStyle=De.style,this.ctx.isFillTransparent=De.a===0,this.ctx.fillOpacity=De.a,this.pdf.setFillColor(De.r,De.g,De.b,{a:De.a}),this.pdf.setTextColor(De.r,De.g,De.b,{a:De.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var De=x(oe);this.ctx.strokeStyle=De.style,this.ctx.isStrokeTransparent=De.a===0,this.ctx.strokeOpacity=De.a,De.a===0?this.pdf.setDrawColor(255,255,255):(De.a,this.pdf.setDrawColor(De.r,De.g,De.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var je=null,we=null,Te=null;Object.defineProperty(this,"fontFaces",{get:function(){return Te},set:function(oe){je=null,we=null,Te=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var De;if(this.ctx.font=oe,(De=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(oe))!==null){var Nt=De[1];De[2];var ot=De[3],Ne=De[4];De[5];var Ge=De[6],Xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ne)[2];Ne=Math.floor(Xe==="px"?parseFloat(Ne)*this.pdf.internal.scaleFactor:Xe==="em"?parseFloat(Ne)*this.pdf.getFontSize():parseFloat(Ne)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ne);var xt=(function(Ue){var Bt,zt,Ot=[],Et=Ue.trim();if(Et==="")return JN;if(Et in JP)return[JP[Et]];for(;Et!=="";){switch(zt=null,Bt=(Et=QP(Et)).charAt(0)){case'"':case"'":zt=z5e(Et.substring(1),Bt);break;default:zt=q5e(Et)}if(zt===null||(Ot.push(zt[0]),(Et=QP(zt[1]))!==""&&Et.charAt(0)!==","))return JN;Et=Et.replace(/^,/,"")}return Ot})(Ge);if(this.fontFaces){var Ae=(function(Ue,Bt){var zt=Ue.getFontList(),Ot=JSON.stringify(zt);if(je===null||we!==Ot){var Et=(function($t){var At=[];return Object.keys($t).forEach(function(Xt){$t[Xt].forEach(function(qt){var Ht=null;switch(qt){case"bold":Ht={family:Xt,weight:"bold"};break;case"italic":Ht={family:Xt,style:"italic"};break;case"bolditalic":Ht={family:Xt,weight:"bold",style:"italic"};break;case"":case"normal":Ht={family:Xt}}Ht!==null&&(Ht.ref={name:Xt,style:qt},At.push(Ht))})}),At})(zt);je=(function($t){for(var At={},Xt=0;Xt<$t.length;++Xt){var qt=XN($t[Xt]),Ht=qt.family,jr=qt.stretch,Ct=qt.style,Tt=qt.weight;At[Ht]=At[Ht]||{},At[Ht][jr]=At[Ht][jr]||{},At[Ht][jr][Ct]=At[Ht][jr][Ct]||{},At[Ht][jr][Ct][Tt]=qt}return At})(Et.concat(Bt)),we=Ot}return je})(this.pdf,this.fontFaces),Pe=xt.map(function(Ue){return{family:Ue,stretch:"normal",weight:ot,style:Nt}}),ct=(function(Ue,Bt,zt){for(var Ot=(zt=zt||{}).defaultFontFamily||"times",Et=Object.assign({},U5e,zt.genericFontFamilies||{}),$t=null,At=null,Xt=0;Xt<Bt.length;++Xt)if(Et[($t=XN(Bt[Xt])).family]&&($t.family=Et[$t.family]),Ue.hasOwnProperty($t.family)){At=Ue[$t.family];break}if(!(At=At||Ue[Ot]))throw new Error("Could not find a font-family for the rule '"+ZP($t)+"' and default family '"+Ot+"'.");if(At=(function(qt,Ht){if(Ht[qt])return Ht[qt];var jr=t_[qt],Ct=jr<=t_.normal?-1:1,Tt=XP(Ht,_W,jr,Ct);if(!Tt)throw new Error("Could not find a matching font-stretch value for "+qt);return Tt})($t.stretch,At),At=(function(qt,Ht){if(Ht[qt])return Ht[qt];for(var jr=SW[qt],Ct=0;Ct<jr.length;++Ct)if(Ht[jr[Ct]])return Ht[jr[Ct]];throw new Error("Could not find a matching font-style for "+qt)})($t.style,At),!(At=(function(qt,Ht){if(Ht[qt])return Ht[qt];if(qt===400&&Ht[500])return Ht[500];if(qt===500&&Ht[400])return Ht[400];var jr=F5e[qt],Ct=XP(Ht,CW,jr,qt<400?-1:1);if(!Ct)throw new Error("Could not find a matching font-weight for value "+qt);return Ct})($t.weight,At)))throw new Error("Failed to resolve a font for the rule '"+ZP($t)+"'.");return At})(Ae,Pe);this.pdf.setFont(ct.ref.name,ct.ref.style)}else{var bt="";(ot==="bold"||parseInt(ot,10)>=700||Nt==="bold")&&(bt="bold"),Nt==="italic"&&(bt+="italic"),bt.length===0&&(bt="normal");for(var dt="",Ve={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},lt=0;lt<xt.length;lt++){if(this.pdf.internal.getFont(xt[lt],bt,{noFallback:!0,disableWarning:!0})!==void 0){dt=xt[lt];break}if(bt==="bolditalic"&&this.pdf.internal.getFont(xt[lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)dt=xt[lt],bt="bold";else if(this.pdf.internal.getFont(xt[lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){dt=xt[lt],bt="normal";break}}if(dt===""){for(var kt=0;kt<xt.length;kt++)if(Ve[xt[kt]]){dt=Ve[xt[kt]];break}}dt=dt===""?"Times":dt,this.pdf.setFont(dt,bt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,W.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,W.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};p.prototype.setLineDash=function(U){this.lineDash=U},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){L.call(this,"fill",!1)},p.prototype.stroke=function(){L.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(U,Y){if(isNaN(U)||isNaN(Y))throw vs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var te=this.ctx.transform.applyToPoint(new o(U,Y));this.path.push({type:"mt",x:te.x,y:te.y}),this.ctx.lastPoint=new o(U,Y)},p.prototype.closePath=function(){var U=new o(0,0),Y=0;for(Y=this.path.length-1;Y!==-1;Y--)if(this.path[Y].type==="begin"&&rs(this.path[Y+1])==="object"&&typeof this.path[Y+1].x=="number"){U=new o(this.path[Y+1].x,this.path[Y+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(U.x,U.y)},p.prototype.lineTo=function(U,Y){if(isNaN(U)||isNaN(Y))throw vs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var te=this.ctx.transform.applyToPoint(new o(U,Y));this.path.push({type:"lt",x:te.x,y:te.y}),this.ctx.lastPoint=new o(te.x,te.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),L.call(this,null,!0)},p.prototype.quadraticCurveTo=function(U,Y,te,ce){if(isNaN(te)||isNaN(ce)||isNaN(U)||isNaN(Y))throw vs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var xe=this.ctx.transform.applyToPoint(new o(te,ce)),ue=this.ctx.transform.applyToPoint(new o(U,Y));this.path.push({type:"qct",x1:ue.x,y1:ue.y,x:xe.x,y:xe.y}),this.ctx.lastPoint=new o(xe.x,xe.y)},p.prototype.bezierCurveTo=function(U,Y,te,ce,xe,ue){if(isNaN(xe)||isNaN(ue)||isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce))throw vs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ve=this.ctx.transform.applyToPoint(new o(xe,ue)),Q=this.ctx.transform.applyToPoint(new o(U,Y)),pe=this.ctx.transform.applyToPoint(new o(te,ce));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:pe.x,y2:pe.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new o(ve.x,ve.y)},p.prototype.arc=function(U,Y,te,ce,xe,ue){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce)||isNaN(xe))throw vs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ue=!!ue,!this.ctx.transform.isIdentity){var ve=this.ctx.transform.applyToPoint(new o(U,Y));U=ve.x,Y=ve.y;var Q=this.ctx.transform.applyToPoint(new o(0,te)),pe=this.ctx.transform.applyToPoint(new o(0,0));te=Math.sqrt(Math.pow(Q.x-pe.x,2)+Math.pow(Q.y-pe.y,2))}Math.abs(xe-ce)>=2*Math.PI&&(ce=0,xe=2*Math.PI),this.path.push({type:"arc",x:U,y:Y,radius:te,startAngle:ce,endAngle:xe,counterclockwise:ue})},p.prototype.arcTo=function(U,Y,te,ce,xe){throw new Error("arcTo not implemented.")},p.prototype.rect=function(U,Y,te,ce){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce))throw vs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(U,Y),this.lineTo(U+te,Y),this.lineTo(U+te,Y+ce),this.lineTo(U,Y+ce),this.lineTo(U,Y),this.lineTo(U+te,Y),this.lineTo(U,Y)},p.prototype.fillRect=function(U,Y,te,ce){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce))throw vs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var xe={};this.lineCap!=="butt"&&(xe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(xe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(U,Y,te,ce),this.fill(),xe.hasOwnProperty("lineCap")&&(this.lineCap=xe.lineCap),xe.hasOwnProperty("lineJoin")&&(this.lineJoin=xe.lineJoin)}},p.prototype.strokeRect=function(U,Y,te,ce){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce))throw vs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(U,Y,te,ce),this.stroke())},p.prototype.clearRect=function(U,Y,te,ce){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce))throw vs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(U,Y,te,ce))},p.prototype.save=function(U){U=typeof U!="boolean"||U;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("q");if(this.pdf.setPage(Y),U){this.ctx.fontSize=this.pdf.internal.getFontSize();var ce=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ce}},p.prototype.restore=function(U){U=typeof U!="boolean"||U;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("Q");this.pdf.setPage(Y),U&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(U){var Y,te,ce,xe;if(U.isCanvasGradient===!0&&(U=U.getColor()),!U)return{r:0,g:0,b:0,a:0,style:U};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(U))Y=0,te=0,ce=0,xe=0;else{var ue=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(U);if(ue!==null)Y=parseInt(ue[1]),te=parseInt(ue[2]),ce=parseInt(ue[3]),xe=1;else if((ue=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(U))!==null)Y=parseInt(ue[1]),te=parseInt(ue[2]),ce=parseInt(ue[3]),xe=parseFloat(ue[4]);else{if(xe=1,typeof U=="string"&&U.charAt(0)!=="#"){var ve=new bW(U);U=ve.ok?ve.toHex():"#000000"}U.length===4?(Y=U.substring(1,2),Y+=Y,te=U.substring(2,3),te+=te,ce=U.substring(3,4),ce+=ce):(Y=U.substring(1,3),te=U.substring(3,5),ce=U.substring(5,7)),Y=parseInt(Y,16),te=parseInt(te,16),ce=parseInt(ce,16)}}return{r:Y,g:te,b:ce,a:xe,style:U}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(U,Y,te,ce){if(isNaN(Y)||isNaN(te)||typeof U!="string")throw vs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ce=isNaN(ce)?void 0:ce,!m.call(this)){var xe=ee(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;R.call(this,{text:U,x:Y,y:te,scale:ue,angle:xe,align:this.textAlign,maxWidth:ce})}},p.prototype.strokeText=function(U,Y,te,ce){if(isNaN(Y)||isNaN(te)||typeof U!="string")throw vs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){ce=isNaN(ce)?void 0:ce;var xe=ee(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;R.call(this,{text:U,x:Y,y:te,scale:ue,renderingMode:"stroke",angle:xe,align:this.textAlign,maxWidth:ce})}},p.prototype.measureText=function(U){if(typeof U!="string")throw vs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Y=this.pdf,te=this.pdf.internal.scaleFactor,ce=Y.internal.getFontSize(),xe=Y.getStringUnitWidth(U)*ce/Y.internal.scaleFactor;return new function(ue){var ve=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ve}}),this}({width:xe*=Math.round(96*te/72*1e4)/1e4})},p.prototype.scale=function(U,Y){if(isNaN(U)||isNaN(Y))throw vs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var te=new c(U,0,0,Y,0,0);this.ctx.transform=this.ctx.transform.multiply(te)},p.prototype.rotate=function(U){if(isNaN(U))throw vs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Y=new c(Math.cos(U),Math.sin(U),-Math.sin(U),Math.cos(U),0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},p.prototype.translate=function(U,Y){if(isNaN(U)||isNaN(Y))throw vs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var te=new c(1,0,0,1,U,Y);this.ctx.transform=this.ctx.transform.multiply(te)},p.prototype.transform=function(U,Y,te,ce,xe,ue){if(isNaN(U)||isNaN(Y)||isNaN(te)||isNaN(ce)||isNaN(xe)||isNaN(ue))throw vs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ve=new c(U,Y,te,ce,xe,ue);this.ctx.transform=this.ctx.transform.multiply(ve)},p.prototype.setTransform=function(U,Y,te,ce,xe,ue){U=isNaN(U)?1:U,Y=isNaN(Y)?0:Y,te=isNaN(te)?0:te,ce=isNaN(ce)?1:ce,xe=isNaN(xe)?0:xe,ue=isNaN(ue)?0:ue,this.ctx.transform=new c(U,Y,te,ce,xe,ue)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(U,Y,te,ce,xe,ue,ve,Q,pe){var Ce=this.pdf.getImageProperties(U),je=1,we=1,Te=1,oe=1;ce!==void 0&&Q!==void 0&&(Te=Q/ce,oe=pe/xe,je=Ce.width/ce*Q/ce,we=Ce.height/xe*pe/xe),ue===void 0&&(ue=Y,ve=te,Y=0,te=0),ce!==void 0&&Q===void 0&&(Q=ce,pe=xe),ce===void 0&&Q===void 0&&(Q=Ce.width,pe=Ce.height);var De=this.ctx.transform.decompose(),Nt=ee(De.rotate.shx),ot=new c,Ne=(ot=(ot=(ot=ot.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new l(ue-Y*Te,ve-te*oe,ce*je,xe*we));if(this.autoPaging){for(var Ge,Xe=j.call(this,Ne),xt=[],Ae=0;Ae<Xe.length;Ae+=1)xt.indexOf(Xe[Ae])===-1&&xt.push(Xe[Ae]);A(xt);for(var Pe=xt[0],ct=xt[xt.length-1],bt=Pe;bt<ct+1;bt++){this.pdf.setPage(bt);var dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ve=bt===1?this.posY+this.margin[0]:this.margin[0],lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ue=bt===1?0:lt+(bt-2)*kt;if(this.ctx.clip_path.length!==0){var Bt=this.path;Ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(Ge,this.posX+this.margin[3],-Ue+Ve+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=Bt}var zt=JSON.parse(JSON.stringify(Ne));zt=C([zt],this.posX+this.margin[3],-Ue+Ve+this.ctx.prevPageLastElemOffset)[0];var Ot=(bt>Pe||bt<ct)&&v.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],dt,kt,null).clip().discardPath()),this.pdf.addImage(U,"JPEG",zt.x,zt.y,zt.w,zt.h,null,null,Nt),Ot&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(U,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,Nt)};var j=function(U,Y,te){var ce=[];Y=Y||this.pdf.internal.pageSize.width,te=te||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var xe=this.posY+this.ctx.prevPageLastElemOffset;switch(U.type){default:case"mt":case"lt":ce.push(Math.floor((U.y+xe)/te)+1);break;case"arc":ce.push(Math.floor((U.y+xe-U.radius)/te)+1),ce.push(Math.floor((U.y+xe+U.radius)/te)+1);break;case"qct":var ue=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x,U.y);ce.push(Math.floor((ue.y+xe)/te)+1),ce.push(Math.floor((ue.y+ue.h+xe)/te)+1);break;case"bct":var ve=J(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x2,U.y2,U.x,U.y);ce.push(Math.floor((ve.y+xe)/te)+1),ce.push(Math.floor((ve.y+ve.h+xe)/te)+1);break;case"rect":ce.push(Math.floor((U.y+xe)/te)+1),ce.push(Math.floor((U.y+U.h+xe)/te)+1)}for(var Q=0;Q<ce.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<ce[Q];)N.call(this);return ce},N=function(){var U=this.fillStyle,Y=this.strokeStyle,te=this.font,ce=this.lineCap,xe=this.lineWidth,ue=this.lineJoin;this.pdf.addPage(),this.fillStyle=U,this.strokeStyle=Y,this.font=te,this.lineCap=ce,this.lineWidth=xe,this.lineJoin=ue},C=function(U,Y,te){for(var ce=0;ce<U.length;ce++)switch(U[ce].type){case"bct":U[ce].x2+=Y,U[ce].y2+=te;case"qct":U[ce].x1+=Y,U[ce].y1+=te;default:U[ce].x+=Y,U[ce].y+=te}return U},A=function(U){return U.sort(function(Y,te){return Y-te})},L=function(U,Y){var te=this.fillStyle,ce=this.strokeStyle,xe=this.lineCap,ue=this.lineWidth,ve=Math.abs(ue*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var pe,Ce,je=JSON.parse(JSON.stringify(this.path)),we=JSON.parse(JSON.stringify(this.path)),Te=[],oe=0;oe<we.length;oe++)if(we[oe].x!==void 0)for(var De=j.call(this,we[oe]),Nt=0;Nt<De.length;Nt+=1)Te.indexOf(De[Nt])===-1&&Te.push(De[Nt]);for(var ot=0;ot<Te.length;ot++)for(;this.pdf.internal.getNumberOfPages()<Te[ot];)N.call(this);A(Te);for(var Ne=Te[0],Ge=Te[Te.length-1],Xe=Ne;Xe<Ge+1;Xe++){this.pdf.setPage(Xe),this.fillStyle=te,this.strokeStyle=ce,this.lineCap=xe,this.lineWidth=ve,this.lineJoin=Q;var xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ae=Xe===1?this.posY+this.margin[0]:this.margin[0],Pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=Xe===1?0:Pe+(Xe-2)*ct;if(this.ctx.clip_path.length!==0){var dt=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(pe,this.posX+this.margin[3],-bt+Ae+this.ctx.prevPageLastElemOffset),O.call(this,U,!0),this.path=dt}if(Ce=JSON.parse(JSON.stringify(je)),this.path=C(Ce,this.posX+this.margin[3],-bt+Ae+this.ctx.prevPageLastElemOffset),Y===!1||Xe===0){var Ve=(Xe>Ne||Xe<Ge)&&v.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xt,ct,null).clip().discardPath()),O.call(this,U,Y),Ve&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}this.path=je}else this.lineWidth=ve,O.call(this,U,Y),this.lineWidth=ue},O=function(U,Y){if((U!=="stroke"||Y||!y.call(this))&&(U==="stroke"||Y||!m.call(this))){for(var te,ce,xe=[],ue=this.path,ve=0;ve<ue.length;ve++){var Q=ue[ve];switch(Q.type){case"begin":xe.push({begin:!0});break;case"close":xe.push({close:!0});break;case"mt":xe.push({start:Q,deltas:[],abs:[]});break;case"lt":var pe=xe.length;if(ue[ve-1]&&!isNaN(ue[ve-1].x)&&(te=[Q.x-ue[ve-1].x,Q.y-ue[ve-1].y],pe>0)){for(;pe>=0;pe--)if(xe[pe-1].close!==!0&&xe[pe-1].begin!==!0){xe[pe-1].deltas.push(te),xe[pe-1].abs.push(Q);break}}break;case"bct":te=[Q.x1-ue[ve-1].x,Q.y1-ue[ve-1].y,Q.x2-ue[ve-1].x,Q.y2-ue[ve-1].y,Q.x-ue[ve-1].x,Q.y-ue[ve-1].y],xe[xe.length-1].deltas.push(te);break;case"qct":var Ce=ue[ve-1].x+2/3*(Q.x1-ue[ve-1].x),je=ue[ve-1].y+2/3*(Q.y1-ue[ve-1].y),we=Q.x+2/3*(Q.x1-Q.x),Te=Q.y+2/3*(Q.y1-Q.y),oe=Q.x,De=Q.y;te=[Ce-ue[ve-1].x,je-ue[ve-1].y,we-ue[ve-1].x,Te-ue[ve-1].y,oe-ue[ve-1].x,De-ue[ve-1].y],xe[xe.length-1].deltas.push(te);break;case"arc":xe.push({deltas:[],abs:[],arc:!0}),Array.isArray(xe[xe.length-1].abs)&&xe[xe.length-1].abs.push(Q)}}ce=Y?null:U==="stroke"?"stroke":"fill";for(var Nt=!1,ot=0;ot<xe.length;ot++)if(xe[ot].arc)for(var Ne=xe[ot].abs,Ge=0;Ge<Ne.length;Ge++){var Xe=Ne[Ge];Xe.type==="arc"?I.call(this,Xe.x,Xe.y,Xe.radius,Xe.startAngle,Xe.endAngle,Xe.counterclockwise,void 0,Y,!Nt):P.call(this,Xe.x,Xe.y),Nt=!0}else if(xe[ot].close===!0)this.pdf.internal.out("h"),Nt=!1;else if(xe[ot].begin!==!0){var xt=xe[ot].start.x,Ae=xe[ot].start.y;q.call(this,xe[ot].deltas,xt,Ae),Nt=!0}ce&&B.call(this,ce),Y&&$.call(this)}},F=function(U){var Y=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,te=Y*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return U-te;case"top":return U+Y-te;case"hanging":return U+Y-2*te;case"middle":return U+Y/2-te;default:return U}},T=function(U){return U+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var U=function(){};return U.colorStops=[],U.addColorStop=function(Y,te){this.colorStops.push([Y,te])},U.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},U.isCanvasGradient=!0,U},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(U,Y,te,ce,xe,ue,ve,Q,pe){for(var Ce=G.call(this,te,ce,xe,ue),je=0;je<Ce.length;je++){var we=Ce[je];je===0&&(pe?k.call(this,we.x1+U,we.y1+Y):P.call(this,we.x1+U,we.y1+Y)),X.call(this,U,Y,we.x2,we.y2,we.x3,we.y3,we.x4,we.y4)}Q?$.call(this):B.call(this,ve)},B=function(U){switch(U){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},$=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(U,Y){this.pdf.internal.out(r(U)+" "+n(Y)+" m")},R=function(U){var Y;switch(U.align){case"right":case"end":Y="right";break;case"center":Y="center";break;default:Y="left"}var te,ce,xe,ue=this.pdf.getTextDimensions(U.text),ve=F.call(this,U.y),Q=T.call(this,ve)-ue.h,pe=this.ctx.transform.applyToPoint(new o(U.x,ve));if(this.autoPaging){var Ce=this.ctx.transform.decompose(),je=new c;je=(je=(je=je.multiply(Ce.translate)).multiply(Ce.skew)).multiply(Ce.scale);for(var we=this.ctx.transform.applyToRectangle(new l(U.x,ve,ue.w,ue.h)),Te=je.applyToRectangle(new l(U.x,Q,ue.w,ue.h)),oe=j.call(this,Te),De=[],Nt=0;Nt<oe.length;Nt+=1)De.indexOf(oe[Nt])===-1&&De.push(oe[Nt]);A(De);for(var ot=De[0],Ne=De[De.length-1],Ge=ot;Ge<Ne+1;Ge++){this.pdf.setPage(Ge);var Xe=Ge===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ae=this.pdf.internal.pageSize.height-this.margin[2],Pe=Ae-this.margin[0],ct=this.pdf.internal.pageSize.width-this.margin[1],bt=ct-this.margin[3],dt=Ge===1?0:xt+(Ge-2)*Pe;if(this.ctx.clip_path.length!==0){var Ve=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(te,this.posX+this.margin[3],-1*dt+Xe),O.call(this,"fill",!0),this.path=Ve}var lt=C([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-dt+Xe+this.ctx.prevPageLastElemOffset)[0];U.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*U.scale),xe=this.lineWidth,this.lineWidth=xe*U.scale);var kt=this.autoPaging!=="text";if(kt||lt.y+lt.h<=Ae){if(kt||lt.y>=Xe&&lt.x<=ct){var Ue=kt?U.text:this.pdf.splitTextToSize(U.text,U.maxWidth||ct-lt.x)[0],Bt=C([JSON.parse(JSON.stringify(we))],this.posX+this.margin[3],-dt+Xe+this.ctx.prevPageLastElemOffset)[0],zt=kt&&(Ge>ot||Ge<Ne)&&v.call(this);zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,Pe,null).clip().discardPath()),this.pdf.text(Ue,Bt.x,Bt.y,{angle:U.angle,align:Y,renderingMode:U.renderingMode}),zt&&this.pdf.restoreGraphicsState()}}else lt.y<Ae&&(this.ctx.prevPageLastElemOffset+=Ae-lt.y);U.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=xe)}}else U.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*U.scale),xe=this.lineWidth,this.lineWidth=xe*U.scale),this.pdf.text(U.text,pe.x+this.posX,pe.y+this.posY,{angle:U.angle,align:Y,renderingMode:U.renderingMode,maxWidth:U.maxWidth}),U.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=xe)},P=function(U,Y,te,ce){te=te||0,ce=ce||0,this.pdf.internal.out(r(U+te)+" "+n(Y+ce)+" l")},q=function(U,Y,te){return this.pdf.lines(U,Y,te,null,null)},X=function(U,Y,te,ce,xe,ue,ve,Q){this.pdf.internal.out([e(i(te+U)),e(a(ce+Y)),e(i(xe+U)),e(a(ue+Y)),e(i(ve+U)),e(a(Q+Y)),"c"].join(" "))},G=function(U,Y,te,ce){for(var xe=2*Math.PI,ue=Math.PI/2;Y>te;)Y-=xe;var ve=Math.abs(te-Y);ve<xe&&ce&&(ve=xe-ve);for(var Q=[],pe=ce?-1:1,Ce=Y;ve>1e-5;){var je=Ce+pe*Math.min(ve,ue);Q.push(ne.call(this,U,Ce,je)),ve-=Math.abs(je-Ce),Ce=je}return Q},ne=function(U,Y,te){var ce=(te-Y)/2,xe=U*Math.cos(ce),ue=U*Math.sin(ce),ve=xe,Q=-ue,pe=ve*ve+Q*Q,Ce=pe+ve*xe+Q*ue,je=4/3*(Math.sqrt(2*pe*Ce)-Ce)/(ve*ue-Q*xe),we=ve-je*Q,Te=Q+je*ve,oe=we,De=-Te,Nt=ce+Y,ot=Math.cos(Nt),Ne=Math.sin(Nt);return{x1:U*Math.cos(Y),y1:U*Math.sin(Y),x2:we*ot-Te*Ne,y2:we*Ne+Te*ot,x3:oe*ot-De*Ne,y3:oe*Ne+De*ot,x4:U*Math.cos(te),y4:U*Math.sin(te)}},ee=function(U){return 180*U/Math.PI},se=function(U,Y,te,ce,xe,ue){var ve=U+.5*(te-U),Q=Y+.5*(ce-Y),pe=xe+.5*(te-xe),Ce=ue+.5*(ce-ue),je=Math.min(U,xe,ve,pe),we=Math.max(U,xe,ve,pe),Te=Math.min(Y,ue,Q,Ce),oe=Math.max(Y,ue,Q,Ce);return new l(je,Te,we-je,oe-Te)},J=function(U,Y,te,ce,xe,ue,ve,Q){var pe,Ce,je,we,Te,oe,De,Nt,ot,Ne,Ge,Xe,xt,Ae,Pe=te-U,ct=ce-Y,bt=xe-te,dt=ue-ce,Ve=ve-xe,lt=Q-ue;for(Ce=0;Ce<41;Ce++)ot=(De=(je=U+(pe=Ce/40)*Pe)+pe*((Te=te+pe*bt)-je))+pe*(Te+pe*(xe+pe*Ve-Te)-De),Ne=(Nt=(we=Y+pe*ct)+pe*((oe=ce+pe*dt)-we))+pe*(oe+pe*(ue+pe*lt-oe)-Nt),Ce==0?(Ge=ot,Xe=Ne,xt=ot,Ae=Ne):(Ge=Math.min(Ge,ot),Xe=Math.min(Xe,Ne),xt=Math.max(xt,ot),Ae=Math.max(Ae,Ne));return new l(Math.round(Ge),Math.round(Xe),Math.round(xt-Ge),Math.round(Ae-Xe))},W=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var U,Y,te=(U=this.ctx.lineDash,Y=this.ctx.lineDashOffset,JSON.stringify({lineDash:U,lineDashOffset:Y}));this.prevLineDash!==te&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=te)}}})(xr.API),(function(t){var e=function(o){var l,c,u,f,p,x,m,y,v,j;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(p=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(x=(p=((p=((p=((p=(p-(j=p%85))/85)-(v=p%85))/85)-(y=p%85))/85)-(m=p%85))/85)%85,c.push(x+33,m+33,y+33,v+33,j+33)):c.push(122);return(function(N,C){for(var A=C;A>0;A--)N.pop()})(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,f,p,x=String,m="length",y=255,v="charCodeAt",j="slice",N="replace";for(o[j](-2),o=o[j](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),u=[],f=0,p=(o+=l="uuuuu"[j](o[m]%5||5))[m];p>f;f+=5)c=52200625*(o[v](f)-33)+614125*(o[v](f+1)-33)+7225*(o[v](f+2)-33)+85*(o[v](f+3)-33)+(o[v](f+4)-33),u.push(y&c>>24,y&c>>16,y&c>>8,y&c);return(function(C,A){for(var L=A;L>0;L--)C.pop()})(u,l[m]),x.fromCharCode.apply(x,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=YS(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}})(xr.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(c,u,f){var p=new XMLHttpRequest,x=0,m=function(y){var v=y.length,j=[],N=String.fromCharCode;for(x=0;x<v;x+=1)j.push(N(255&y.charCodeAt(x)));return j.join("")};if(p.open("GET",c,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?f(m(this.responseText)):f(void 0)}),p.send(null),u&&p.status===200)return m(p.responseText)})(i,a,o)}catch{}return l})(e,r,n)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(xr.API),(function(t){function e(){return(Ir.html2canvas?Promise.resolve(Ir.html2canvas):ON(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ir.DOMPurify?Promise.resolve(Ir.DOMPurify):ON(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=rs(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},a=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||(function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var m=0;m<f.length;++m){var y=f[m],v=y.src.find(function(j){return j.format==="truetype"});v&&u.addFont(v.url,y.ref.name,y.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,u.context2d.save(!0),c(this.prop.container,x)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||xr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,p){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(x){return u.updateProgress(null,f),x}).then(f,p).then(function(x){return u.updateProgress(1),x})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),x=u.call(p,l,c);return o.convert(x,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,xr.getPageSize=function(l,c,u){if(rs(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var p,x=(""+u).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var y,v=0,j=0;if(m.hasOwnProperty(x))v=m[x][1]/p,j=m[x][0]/p;else try{v=u[1],j=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",j>v&&(y=j,j=v,v=y);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",v>j&&(y=j,j=v,v=y)}return{width:j,height:v,unit:c,k:p,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(XN):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}})(xr.API),xr.API.addJS=function(t){return t9=t,this.internal.events.subscribe("postPutResources",function(){Uv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Uv+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),e9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+t9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Uv!==void 0&&e9!==void 0&&this.internal.out("/Names <</JavaScript "+Uv+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(a=0;a<u;a++){var p=r.internal.newObject();f.push(p);var x=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<f.length;a++)r.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var o={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(xr.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(p){for(var x,m=256*p.charCodeAt(4)+p.charCodeAt(5),y=p.length,v={width:0,height:0,numcomponents:1},j=4;j<y;j+=2){if(j+=m,e.indexOf(p.charCodeAt(j+1))!==-1){x=256*p.charCodeAt(j+5)+p.charCodeAt(j+6),v={width:256*p.charCodeAt(j+7)+p.charCodeAt(j+8),height:x,numcomponents:p.charCodeAt(j+9)};break}m=256*p.charCodeAt(j+2)+p.charCodeAt(j+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return f}})(xr.API),xr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=_5e(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,u=a.palette,f=a.depth;i=u&&c===1?(function(I){for(var B=I.width,$=I.height,k=I.data,R=I.palette,P=I.depth,q=!1,X=[],G=[],ne=void 0,ee=!1,se=0,J=0;J<R.length;J++){var W=iP(R[J],4),U=W[0],Y=W[1],te=W[2],ce=W[3];X.push(U,Y,te),ce!=null&&(ce===0?(se++,G.length<1&&G.push(J)):ce<255&&(ee=!0))}if(ee||se>1){q=!0,G=void 0;var xe=B*$;ne=new Uint8Array(xe);for(var ue=new DataView(k.buffer),ve=0;ve<xe;ve++){var Q=ZN(ue,ve,P),pe=iP(R[Q],4)[3];ne[ve]=pe}}else se===0&&(G=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:q?8:void 0,colorBytes:k,alphaBytes:ne,needSMask:q,palette:X,mask:G}})(a):c===2||c===4?(function(I){for(var B=I.data,$=I.width,k=I.height,R=I.channels,P=I.depth,q=R===2?"DeviceGray":"DeviceRGB",X=R-1,G=$*k,ne=X,ee=G*ne,se=1*G,J=Math.ceil(ee*P/8),W=Math.ceil(se*P/8),U=new Uint8Array(J),Y=new Uint8Array(W),te=new DataView(B.buffer),ce=new DataView(U.buffer),xe=new DataView(Y.buffer),ue=!1,ve=0;ve<G;ve++){for(var Q=ve*R,pe=0;pe<ne;pe++)d9(ce,ZN(te,Q+pe,P),ve*ne+pe,P);var Ce=ZN(te,Q+ne,P);Ce<(1<<P)-1&&(ue=!0),d9(xe,Ce,1*ve,P)}return{colorSpace:q,colorsPerPixel:X,sMaskBitsPerComponent:ue?P:void 0,colorBytes:U,alphaBytes:Y,needSMask:ue}})(a):(function(I){var B=I.data,$=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:$,colorsPerPixel:$==="DeviceGray"?1:3,colorBytes:B instanceof Uint16Array?(function(k){for(var R=k.length,P=new Uint8Array(2*R),q=new DataView(P.buffer,P.byteOffset,P.byteLength),X=0;X<R;X++)q.setUint16(2*X,k[X],!1);return P})(B):B,needSMask:!1}})(a);var p,x,m,y=i,v=y.colorSpace,j=y.colorsPerPixel,N=y.sMaskBitsPerComponent,C=y.colorBytes,A=y.alphaBytes,L=y.needSMask,O=y.palette,F=y.mask,T=null;return n!==xr.API.image_compression.NONE&&typeof YS=="function"?(T=(function(I){var B;switch(I){case xr.API.image_compression.FAST:B=11;break;case xr.API.image_compression.MEDIUM:B=13;break;case xr.API.image_compression.SLOW:B=14;break;default:B=12}return B})(n),p=this.decode.FLATE_DECODE,x="/Predictor ".concat(T," /Colors ").concat(j," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=i9(C,Math.ceil(o*j*f/8),j,f,n),L&&(m=i9(A,Math.ceil(o*N/8),1,N,n))):(p=void 0,x=void 0,t=C,L&&(m=A)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:t,index:e,filter:p,decodeParameters:x,transparency:F,palette:O,sMask:m,predictor:T,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:N,colorSpace:v}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new V5e(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new QN(100).encode(u,100);return t.processJPEG.call(this,f,r,n,i)},t.processGIF87A=t.processGIF89A})(xr.API),wc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},wc.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){vs.log("bit decode error:"+r)}},wc.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},wc.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=a>>4,c=15&a,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},wc.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},wc.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,u=a>>15?255:0,f=n*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=t}},wc.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,f=i*this.width*4+4*a;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},wc.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},wc.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},wc.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new wc(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new QN(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}})(xr.API),h9.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new h9(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new QN(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}})(xr.API),xr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var f=n[u],p=n[u+1],x=n[u+2],m=n[u+3];a[l++]=f,a[l++]=p,a[l++]=x,o[c++]=m}var y=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:y,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},xr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lp=xr.API,zv=Lp.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,p=e.doKerning!==!1,x=0,m=t.length,y=0,v=l[0]||c,j=[];for(r=0;r<m;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?j.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(x=p&&rs(u[n])==="object"&&!isNaN(parseInt(u[n][y],10))?u[n][y]/f:0,j.push((l[n]||v)/c+x)),y=n;return j},r9=Lp.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Lp.processArabic&&(t=Lp.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:zv.apply(this,arguments).reduce(function(a,o){return a+o},0)},n9=function(t,e,r,n){for(var i=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;i.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(i.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},s9=function(t,e,r){r||(r={});var n,i,a,o,l,c,u,f=[],p=[f],x=r.textIndent||0,m=0,y=0,v=t.split(" "),j=zv.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var N=Array(c).join(" "),C=[];v.map(function(L){(L=L.split(/\s*\n/)).length>1?C=C.concat(L.map(function(O,F){return(F&&O.length?`
`:"")+O})):C.push(L[0])}),v=C,c=r9.apply(this,[N,r])}for(a=0,o=v.length;a<o;a++){var A=0;if(n=v[a],c&&n[0]==`
`&&(n=n.substr(1),A=1),x+m+(y=(i=zv.apply(this,[n,r])).reduce(function(L,O){return L+O},0))>e||A){if(y>e){for(l=n9.apply(this,[n,i,e-(x+m),e]),f.push(l.shift()),f=[l.pop()];l.length;)p.push([l.shift()]);y=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(L,O){return L+O},0)}else f=[n];p.push(f),x=y+c,m=j}else f.push(n),x+=m+y,m=j}return u=c?function(L,O){return(O?N:"")+L.join(" ")}:function(L){return L.join(" ")},p.map(u)},Lp.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle),x="Unicode";return p.metadata[x]?{widths:p.metadata[x].widths||{0:1},kerning:p.metadata[x].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(s9.apply(this,[n[l],o,a]));return u},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var o=function(x){return"0x"+parseInt(x,10).toString(16)},l=t.__fontmetrics__.compress=function(x){var m,y,v,j,N=["{"];for(var C in x){if(m=x[C],isNaN(parseInt(C,10))?y="'"+C+"'":(C=parseInt(C,10),y=(y=o(C).slice(2)).slice(0,-1)+i[y.slice(-1)]),typeof m=="number")m<0?(v=o(m).slice(3),j="-"):(v=o(m).slice(2),j=""),v=j+v.slice(0,-1)+i[v.slice(-1)];else{if(rs(m)!=="object")throw new Error("Don't know what to do with value type "+rs(m)+".");v=l(m)}N.push(y+v)}return N.push("}"),N.join("")},c=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,y,v,j,N={},C=1,A=N,L=[],O="",F="",T=x.length-1,I=1;I<T;I+=1)(j=x[I])=="'"?m?(v=m.join(""),m=void 0):m=[]:m?m.push(j):j=="{"?(L.push([A,v]),A={},v=void 0):j=="}"?((y=L.pop())[0][y[1]]=A,v=void 0,A=y[0]):j=="-"?C=-1:v===void 0?n.hasOwnProperty(j)?(O+=n[j],v=parseInt(O,16)*C,C=1,O=""):O+=j:n.hasOwnProperty(j)?(F+=n[j],A[v]=parseInt(F,16)*C,C=1,v=void 0,F=""):F+=j;return N},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var m=x.font,y=p.Unicode[m.postScriptName];y&&(m.metadata.Unicode={},m.metadata.Unicode.widths=y.widths,m.metadata.Unicode.kerning=y.kerning);var v=f.Unicode[m.postScriptName];v&&(m.metadata.Unicode.encoding=v,m.encoding=v.codePages[0])}])})(xr.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(C1(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])})(xr),xr.API.addSvgAsImage=function(t,e,r,n,i,a,o,l){if(isNaN(e)||isNaN(r))throw vs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw vs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(Ir.canvg?Promise.resolve(Ir.canvg):ON(()=>import("./index.es-bmnvX451.js"),[])).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(f)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,o,l)})},xr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},xr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,p=0;function x(y,v){var j,N=!1;for(j=0;j<y.length;j+=1)y[j]===v&&(N=!0);return N}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(p=0;p<m;p+=1)r[l[p]].value=r[l[p]].defaultValue,r[l[p]].explicitSet=!1}if(rs(t)==="object"){for(i in t)if(a=t[i],x(l,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&x(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")c.push(String(a[u]-1));else if(a[u].length>1){for(f=0;f<a[u].length;f+=1)typeof a[u][f]!="number"&&(n=!1);n===!0&&c.push([a[u][0]-1,a[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,v=[];for(y in r)r[y].explicitSet===!0&&(r[y].type==="name"?v.push("/"+y+" /"+r[y].value):v.push("/"+y+" "+r[y].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(xr.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],p=0,x=a.length;p<x;++p){if(l=o.metadata.characterToGlyph(a.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},n=function(a){var o,l,c,u,f,p,x;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,x=(l=Object.keys(a).sort(function(m,y){return m-y})).length;p<x;p++)o=l[p],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(u=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,x=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",y=0;y<x.length;y++)m+=String.fromCharCode(x[y]);var v=u();f({data:m,addLength1:!0,objectId:v}),c("endobj");var j=u();f({data:n(l.metadata.toUnicode),addLength1:!0,objectId:j}),c("endobj");var N=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+zp(l.fontName)),c("/FontFile2 "+v+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var C=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+zp(l.fontName)),c("/FontDescriptor "+N+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+j+" 0 R"),c("/BaseFont /"+zp(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+C+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,x="",m=0;m<p.length;m++)x+=String.fromCharCode(p[m]);var y=u();f({data:x,addLength1:!0,objectId:y}),c("endobj");var v=u();f({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var j=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+zp(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var N=0;N<l.metadata.hmtx.widths.length;N++)l.metadata.hmtx.widths[N]=parseInt(l.metadata.hmtx.widths[N]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+zp(l.fontName)+"/FontDescriptor "+j+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,l=a.text||"",c=a.x,u=a.y,f=a.options||{},p=a.mutex||{},x=p.pdfEscape,m=p.activeFontKey,y=p.fonts,v=m,j="",N=0,C="",A=y[v].encoding;if(y[v].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:p};for(C=l,v=m,Array.isArray(l)&&(C=l[0]),N=0;N<C.length;N+=1)y[v].metadata.hasOwnProperty("cmap")&&(o=y[v].metadata.cmap.unicode.codeMap[C[N].charCodeAt(0)]),o||C[N].charCodeAt(0)<256&&y[v].metadata.hasOwnProperty("Unicode")?j+=C[N]:j+="";var L="";return parseInt(v.slice(1))<14||A==="WinAnsiEncoding"?L=x(j,v).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(L=r(j,y[v])),p.isHex=!0,{text:L,x:c,y:u,options:f,mutex:p}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);a.text=l}else a.text=i(Object.assign({},c,{text:o})).text}])})(xr),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(xr.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,o,l,c,u,f,p=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},j=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],N=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,A=0;this.__bidiEngine__={};var L=function(k){var R=k.charCodeAt(),P=R>>8,q=v[P];return q!==void 0?p[256*q+(255&R)]:P===252||P===253?"AL":N.test(P)?"L":P===8?"R":"N"},O=function(k){for(var R,P=0;P<k.length;P++){if((R=L(k.charAt(P)))==="L")return!1;if(R==="R")return!0}return!1},F=function(k,R,P,q){var X,G,ne,ee,se=R[q];switch(se){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"N":case"AN":break;case"EN":C&&(se="AN");break;case"AL":C=!0,se="R";break;case"WS":case"BN":se="N";break;case"CS":q<1||q+1>=R.length||(X=P[q-1])!=="EN"&&X!=="AN"||(G=R[q+1])!=="EN"&&G!=="AN"?se="N":C&&(G="AN"),se=G===X?G:"N";break;case"ES":se=(X=q>0?P[q-1]:"B")==="EN"&&q+1<R.length&&R[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&P[q-1]==="EN"){se="EN";break}if(C){se="N";break}for(ne=q+1,ee=R.length;ne<ee&&R[ne]==="ET";)ne++;se=ne<ee&&R[ne]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ee=R.length,ne=q+1;ne<ee&&R[ne]==="NSM";)ne++;if(ne<ee){var J=k[q],W=J>=1425&&J<=2303||J===64286;if(X=R[ne],W&&(X==="R"||X==="AL")){se="R";break}}}se=q<1||(X=R[q-1])==="B"?"N":P[q-1];break;case"B":C=!1,i=!0,se=A;break;case"S":a=!0,se="N"}return se},T=function(k,R,P){var q=k.split("");return P&&I(q,P,{hiLevel:A}),q.reverse(),R&&R.reverse(),q.join("")},I=function(k,R,P){var q,X,G,ne,ee,se=-1,J=k.length,W=0,U=[],Y=A?m:x,te=[];for(C=!1,i=!1,a=!1,X=0;X<J;X++)te[X]=L(k[X]);for(G=0;G<J;G++){if(ee=W,U[G]=F(k,te,U,G),q=240&(W=Y[ee][y[U[G]]]),W&=15,R[G]=ne=Y[W][5],q>0)if(q===16){for(X=se;X<G;X++)R[X]=1;se=-1}else se=-1;if(Y[W][6])se===-1&&(se=G);else if(se>-1){for(X=se;X<G;X++)R[X]=ne;se=-1}te[G]==="B"&&(R[G]=0),P.hiLevel|=ne}a&&(function(ce,xe,ue){for(var ve=0;ve<ue;ve++)if(ce[ve]==="S"){xe[ve]=A;for(var Q=ve-1;Q>=0&&ce[Q]==="WS";Q--)xe[Q]=A}})(te,R,J)},B=function(k,R,P,q,X){if(!(X.hiLevel<k)){if(k===1&&A===1&&!i)return R.reverse(),void(P&&P.reverse());for(var G,ne,ee,se,J=R.length,W=0;W<J;){if(q[W]>=k){for(ee=W+1;ee<J&&q[ee]>=k;)ee++;for(se=W,ne=ee-1;se<ne;se++,ne--)G=R[se],R[se]=R[ne],R[ne]=G,P&&(G=P[se],P[se]=P[ne],P[ne]=G);W=ee}W++}}},$=function(k,R,P){var q=k.split(""),X={hiLevel:A};return P||(P=[]),I(q,P,X),(function(G,ne,ee){if(ee.hiLevel!==0&&f)for(var se,J=0;J<G.length;J++)ne[J]===1&&(se=j.indexOf(G[J]))>=0&&(G[J]=j[se+1])})(q,P,X),B(2,q,R,P,X),B(1,q,R,P,X),q.join("")};return this.__bidiEngine__.doBidiReorder=function(k,R,P){if((function(X,G){if(G)for(var ne=0;ne<X.length;ne++)G[ne]=ne;l===void 0&&(l=O(X)),u===void 0&&(u=O(X))})(k,R),o||!c||u)if(o&&c&&l^u)A=l?1:0,k=T(k,R,P);else if(!o&&c&&u)A=l?1:0,k=$(k,R,P),k=T(k,R);else if(!o||l||c||u){if(o&&!c&&l^u)k=T(k,R),l?(A=0,k=$(k,R,P)):(A=1,k=$(k,R,P),k=T(k,R));else if(o&&l&&!c&&u)A=1,k=$(k,R,P),k=T(k,R);else if(!o&&!c&&l^u){var q=f;l?(A=1,k=$(k,R,P),A=0,f=!1,k=$(k,R,P),f=q):(A=0,k=$(k,R,P),k=T(k,R),A=1,f=!1,k=$(k,R,P),f=q,k=T(k,R))}}else A=0,k=$(k,R,P);else A=l?1:0,k=$(k,R,P);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,f=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(xr),xr.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new of(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new l4e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Y5e(this.contents),this.head=new X5e(this),this.name=new t4e(this),this.cmap=new EW(this),this.toUnicode={},this.hhea=new J5e(this),this.maxp=new r4e(this),this.hmtx=new n4e(this),this.post=new Q5e(this),this.os2=new Z5e(this),this.loca=new o4e(this),this.glyf=new s4e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var Gc,of=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),Y5e=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,o,l,c,u,f,p,x,m,y,v;for(v in m=Object.keys(r).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),o=Math.floor(p/c),f=16*m-p,(i=new of).writeInt(this.scalarType),i.writeShort(m),i.writeShort(p),i.writeShort(o),i.writeShort(f),a=16*m,u=i.pos+a,l=null,y=[],r)for(x=r[v],i.writeString(v),i.writeInt(t(x)),i.writeInt(u),i.writeInt(x.length),y=y.concat(x),v==="head"&&(l=u),u+=x.length;u%4;)y.push(0),u++;return i.write(y),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,o;for(r=TW.call(r);r.length%4;)r.push(0);for(a=new of(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),K5e={}.hasOwnProperty,Bd=function(t,e){for(var r in e)K5e.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Gc=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var X5e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new of).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),f9=(function(){function t(e,r){var n,i,a,o,l,c,u,f,p,x,m,y,v,j,N,C,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),x=m/2,e.pos+=6,a=(function(){var L,O;for(O=[],c=L=0;0<=x?L<x:L>x;c=0<=x?++L:--L)O.push(e.readUInt16());return O})(),e.pos+=2,v=(function(){var L,O;for(O=[],c=L=0;0<=x?L<x:L>x;c=0<=x?++L:--L)O.push(e.readUInt16());return O})(),u=(function(){var L,O;for(O=[],c=L=0;0<=x?L<x:L>x;c=0<=x?++L:--L)O.push(e.readUInt16());return O})(),f=(function(){var L,O;for(O=[],c=L=0;0<=x?L<x:L>x;c=0<=x?++L:--L)O.push(e.readUInt16());return O})(),i=(this.length-e.pos+this.offset)/2,l=(function(){var L,O;for(O=[],c=L=0;0<=i?L<i:L>i;c=0<=i?++L:--L)O.push(e.readUInt16());return O})(),c=N=0,A=a.length;N<A;c=++N)for(j=a[c],n=C=y=v[c];y<=j?C<=j:C>=j;n=y<=j?++C:--C)f[c]===0?o=n+u[c]:(o=l[f[c]/2+(n-y)-(x-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=p}return t.encode=function(e,r){var n,i,a,o,l,c,u,f,p,x,m,y,v,j,N,C,A,L,O,F,T,I,B,$,k,R,P,q,X,G,ne,ee,se,J,W,U,Y,te,ce,xe,ue,ve,Q,pe,Ce,je;switch(q=new of,o=Object.keys(e).sort(function(we,Te){return we-Te}),r){case"macroman":for(v=0,j=(function(){var we=[];for(y=0;y<256;++y)we.push(0);return we})(),C={0:0},a={},X=0,se=o.length;X<se;X++)C[Q=e[i=o[X]]]==null&&(C[Q]=++v),a[i]={old:e[i],new:C[e[i]]},j[i]=C[e[i]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(j),{charMap:a,subtable:q.data,maxGlyphID:v+1};case"unicode":for(R=[],p=[],A=0,C={},n={},N=u=null,G=0,J=o.length;G<J;G++)C[O=e[i=o[G]]]==null&&(C[O]=++A),n[i]={old:O,new:C[O]},l=C[O]-i,N!=null&&l===u||(N&&p.push(N),R.push(i),u=l),N=i;for(N&&p.push(N),p.push(65535),R.push(65535),$=2*(B=R.length),I=2*Math.pow(Math.log(B)/Math.LN2,2),x=Math.log(I/2)/Math.LN2,T=2*B-I,c=[],F=[],m=[],y=ne=0,W=R.length;ne<W;y=++ne){if(k=R[y],f=p[y],k===65535){c.push(0),F.push(0);break}if(k-(P=n[k].new)>=32768)for(c.push(0),F.push(2*(m.length+B-y)),i=ee=k;k<=f?ee<=f:ee>=f;i=k<=f?++ee:--ee)m.push(n[i].new);else c.push(P-k),F.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*B+2*m.length),q.writeUInt16(0),q.writeUInt16($),q.writeUInt16(I),q.writeUInt16(x),q.writeUInt16(T),ue=0,U=p.length;ue<U;ue++)i=p[ue],q.writeUInt16(i);for(q.writeUInt16(0),ve=0,Y=R.length;ve<Y;ve++)i=R[ve],q.writeUInt16(i);for(pe=0,te=c.length;pe<te;pe++)l=c[pe],q.writeUInt16(l);for(Ce=0,ce=F.length;Ce<ce;Ce++)L=F[Ce],q.writeUInt16(L);for(je=0,xe=m.length;je<xe;je++)v=m[je],q.writeUInt16(v);return{charMap:n,subtable:q.data,maxGlyphID:A+1}}},t})(),EW=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new f9(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=f9.encode(e,r),(i=new of).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),J5e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),Z5e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),Q5e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t})(),e4e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},t4e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,o,l,c,u,f,p,x;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=f=0,p=n.length;f<p;a=++f)i=n[a],e.pos=i.offset,u=e.readString(i.length),o=new e4e(u,i),c[x=i.nameID]==null&&(c[x]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),r4e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),n4e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,f;for(f=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)f.push(e.readInt16());return f})(),this.widths=(function(){var u,f,p,x;for(x=[],u=0,f=(p=this.metrics).length;u<f;u++)a=p[u],x.push(a.advance);return x}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),TW=[].slice,s4e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,o,l,c,u,f,p;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new of(r.read(i))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new a4e(l,u,p,c,f):new i4e(l,o,u,p,c,f),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)i=e[r[l]],a.push(o.length),i&&(o=o.concat(i.encode(n)));return a.push(o.length),{table:o,offsets:a}},t})(),i4e=(function(){function t(e,r,n,i,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),a4e=(function(){function t(e,r,n,i,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new of(TW.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),o4e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Bd(t,Gc),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<n.length;++o)if(n[o]=i,a<r.length&&r[a]==o){++a,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),f=0;f<n.length;++f)u[4*f+3]=255&n[f],u[4*f+2]=(65280&n[f])>>8,u[4*f+1]=(16711680&n[f])>>16,u[4*f]=(4278190080&n[f])>>24;return u},t})(),l4e=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,o,l,c,u,f,p,x,m,y,v,j,N;for(i in n=EW.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},N=n.charMap)m[(c=N[i]).old]=c.new;for(y in x=n.maxGlyphID,o)y in m||(m[y]=x++);return f=(function(C){var A,L;for(A in L={},C)L[C[A]]=A;return L})(m),p=Object.keys(f).sort(function(C,A){return C-A}),v=(function(){var C,A,L;for(L=[],C=0,A=p.length;C<A;C++)l=p[C],L.push(f[l]);return L})(),a=this.font.glyf.encode(o,v,m),u=this.font.loca.encode(a.offsets,v),j={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(j["OS/2"]=this.font.os2.raw()),this.font.directory.encode(j)},t})();xr.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,o;if(Array.isArray(r))return"["+(function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)o=r[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e})();const c4e={async generatePDF(t,e={paperSize:"letter",cutLines:!0},r){const a={letter:{width:215.9,height:279.4},a4:{width:210,height:297}},o=new xr({orientation:"portrait",unit:"mm",format:e.paperSize}),l=a[e.paperSize].width,c=a[e.paperSize].height,u=3,f=3,p=u*f,x=u*63,m=f*88,y=(l-x)/2,v=(c-m)/2,j=async C=>{try{const A=`/api/proxy/image?url=${encodeURIComponent(C)}`,L=await fetch(A);if(!L.ok)throw new Error(`Failed to fetch image: ${L.statusText}`);const O=await L.blob();return new Promise((F,T)=>{const I=new FileReader;I.onloadend=()=>F(I.result),I.onerror=T,I.readAsDataURL(O)})}catch(A){return console.error("Image load failed",C,A),null}},N=t.length;for(let C=0;C<N;C++){r&&r(C+1,N),C>0&&C%p===0&&o.addPage();const A=C%p,L=A%u,O=Math.floor(A/u),F=y+L*63,T=v+O*88,I=t[C],B=I.image_uri||I.image_uris?.normal||I.data?.image_uris?.normal||I.card_faces?.[0]?.image_uris?.normal||I.data?.card_faces?.[0]?.image_uris?.normal;let $=!1;if(B)try{const k=await j(B);k&&(o.addImage(k,"JPEG",F,T,63,88),$=!0)}catch(k){console.error("Error adding image to PDF",k)}if(!$){o.setDrawColor(0),o.rect(F,T,63,88),o.setFontSize(10);const k=o.splitTextToSize(I.name,53);if(o.text(k,F+5,T+10),o.setFontSize(8),I.mana_cost&&o.text(I.mana_cost,F+5,T+20),I.type_line){const R=o.splitTextToSize(I.type_line,53);o.text(R,F+5,T+30)}}e.cutLines&&(o.setDrawColor(200,200,200),o.rect(F,T,63,88))}return o}},d4e=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{addToast:i}=wn(),[a,o]=b.useState("letter"),[l,c]=b.useState(!0),[u,f]=b.useState(!1),[p,x]=b.useState(0);if(!t)return null;const m=async()=>{f(!0),x(0);try{(await c4e.generatePDF(r,{paperSize:a,cutLines:l},(v,j)=>{x(Math.round(v/j*100))})).save(`${n}_Proxies.pdf`),i("PDF ready for download!","success"),e()}catch(y){console.error(y),i("Failed to generate PDF","error")}finally{f(!1)}};return s.jsx(Su,{appear:!0,show:t,as:b.Fragment,children:s.jsxs(Zh,{as:"div",className:"relative z-[100]",onClose:u?()=>{}:e,children:[s.jsx(Su.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),s.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:s.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:s.jsx(Su.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:s.jsxs(Zh.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-gray-900 border border-gray-700 shadow-2xl transition-all text-left align-middle",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[s.jsxs(Zh.Title,{as:"h2",className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Print Proxies"]}),s.jsx("button",{onClick:e,disabled:u,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg text-sm text-blue-200",children:["Generates a checklist or visual proxies for playtesting. ",s.jsx("br",{}),s.jsxs("strong",{children:[r.length," cards"]})," selected."]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Paper Size"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:()=>o("letter"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="letter"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"Letter (8.5 x 11)"}),s.jsx("button",{onClick:()=>o("a4"),className:`p-3 rounded-lg border text-sm font-bold transition-all ${a==="a4"?"bg-indigo-600/20 border-indigo-500 text-indigo-300":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-750"}`,children:"A4 (210 x 297mm)"})]})]}),s.jsx("div",{children:s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg border border-gray-700 cursor-pointer hover:bg-gray-750 transition-colors",children:[s.jsx("input",{type:"checkbox",checked:l,onChange:y=>c(y.target.checked),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300 font-medium",children:"Show Cut Lines"})]})}),u&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs text-indigo-300 font-bold uppercase",children:[s.jsx("span",{children:"Generating PDF..."}),s.jsxs("span",{children:[p,"%"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:`${p}%`}})})]}),s.jsx("button",{onClick:m,disabled:u,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-black uppercase tracking-widest text-sm shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:u?"Processing...":"Download PDF"})]})]})})})})]})})},qv=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],u4e=()=>{const{deckId:t}=Eo(),e=dn(),{currentUser:r,userProfile:n,updateSettings:i}=Sr(),{addToast:a}=wn(),o=n?.settings?.helper?.name||"The Oracle",[l,c]=b.useState(!1),[u,f]=b.useState(!1),[p,x]=b.useState(!1),[m,y]=b.useState(!1),[v,j]=b.useState(""),[N,C]=b.useState(0),[A,L]=b.useState(!1),[O,F]=b.useState(!1),[T,I]=b.useState(new Set),B=ze=>{const rt=new Set(T);rt.has(ze)?rt.delete(ze):rt.add(ze),I(rt)},$=()=>{T.size===Pe.length?I(new Set):I(new Set(Pe.map(ze=>ze.id)))},k=async()=>{if(T.size===0)return;const ze=Ae.is_mockup?"delete":"remove",rt=T.size;if(window.confirm(`Are you sure you want to ${ze==="delete"?"delete":"remove"} ${rt} cards ? `))try{const ht=Array.from(T),Rt=Pe.filter(yr=>!ht.includes(yr.id));Et(`Removed ${rt} cards`,Rt),setCards(Rt),await za.batchRemoveCards(r.uid,t,ht,ze),a(`Successfully removed ${rt} cards`,"success"),F(!1),I(new Set),dt(!0)}catch(ht){console.error(ht),a("Failed to remove cards","error"),dt()}},[R,P]=b.useState({}),[q,X]=b.useState(!1),[G,ne]=b.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[ee,se]=b.useState(!1),[J,W]=b.useState(!1),[U,Y]=b.useState(!1),[te,ce]=b.useState(!1),[xe,ue]=b.useState(!1),[ve,Q]=b.useState(!1),[pe,Ce]=b.useState(!1),[je,we]=b.useState(!1),Te=b.useRef(null),oe=b.useRef(null),[De,Nt]=b.useState(!0),[ot,Ne]=b.useState(n?.settings?.deckViewMode||"grid"),[Ge,Xe]=b.useState("overview");b.useEffect(()=>{const ze=rt=>{Te.current&&!Te.current.contains(rt.target)&&(we(!1),Ce(!1))};return document.addEventListener("mousedown",ze),()=>document.removeEventListener("mousedown",ze)},[]);const xt=ze=>{Ne(ze),i({deckViewMode:ze})},{deck:Ae,cards:Pe,loading:ct,error:bt,refresh:dt}=PC(t),{value:Ve,tcgPlayerLink:lt}=RH(Pe),{decks:kt}=hf(),{cards:Ue}=To(),Bt=ze=>{setCards(rt=>{const ht=new Set(ze.map(_r=>_r.managedId)),Rt=rt.filter(_r=>!ht.has(_r.managedId)),yr=new Set(rt.map(_r=>_r.managedId)),Fr=ze.filter(_r=>!yr.has(_r.managedId)),Mn=ze.filter(_r=>{const qi=rt.find(Ya=>Ya.managedId===_r.managedId);return qi&&qi.countInDeck!==_r.countInDeck});return(async()=>{try{if(Rt.length>0)for(const _r of Rt)await za.removeCardFromDeck(r.uid,t,_r.managedId);if(Fr.length>0){for(const _r of Fr)await za.addCardToDeck(r.uid,t,_r);dt(!0)}if(Mn.length>0)for(const _r of Mn)await za.updateCardQuantity(r.uid,t,_r.managedId,_r.countInDeck)}catch(_r){console.error("Undo Sync Failed",_r),a("Sync error. Refreshing...","error"),dt()}})(),ze})},{undo:zt,redo:Ot,recordAction:Et,canUndo:$t,canRedo:At}=MH(Pe,Bt),Xt=Ae?.permissionLevel||"viewer",qt=Xt==="owner",Ht=Xt==="owner"||Xt==="editor",jr=b.useMemo(()=>{if(Ae?.format?.toLowerCase()==="standard"){const yr=Ae.colors||Ae.commander?.color_identity||[];return qv.find(Mn=>Mn.colors.length!==yr.length?!1:Mn.colors.every(ps=>yr.includes(ps)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const ze=Ae?.commander?.color_identity||[],rt=Ae?.commander_partner?.color_identity||[],ht=[...new Set([...ze,...rt])];return!Ae||ht.length===0?qv.find(yr=>yr.badge==="Colorless"):qv.find(yr=>yr.colors.length!==ht.length?!1:yr.colors.every(Fr=>ht.includes(Fr)))||qv.find(yr=>yr.badge==="Colorless")},[Ae]),Ct=b.useMemo(()=>{if(!Ue)return new Set;const ze=new Set;return Ue.forEach(rt=>{rt.finish==="foil"&&!rt.deckId&&ze.add(rt.name)}),ze},[Ue]),Tt=ze=>{if(!Pe)return 0;let rt=Pe.reduce((ht,Rt)=>(Rt.data?.type_line||Rt.type_line||"").includes(ze)?ht+(Rt.countInDeck||1):ht,0);return Ae?.commander&&!Pe.some(ht=>ht.scryfall_id===(Ae.commander.id||Ae.commander.scryfall_id)||ht.oracle_id&&ht.oracle_id===Ae.commander.oracle_id)&&(Ae.commander.type_line||"").includes(ze)&&rt++,Ae?.commander_partner&&!Pe.some(ht=>ht.scryfall_id===(Ae.commander_partner.id||Ae.commander_partner.scryfall_id)||ht.oracle_id&&ht.oracle_id===Ae.commander_partner.oracle_id)&&(Ae.commander_partner.type_line||"").includes(ze)&&rt++,rt},Yt=b.useMemo(()=>{if(!Pe)return 0;let ze=Pe.reduce((rt,ht)=>rt+(ht.countInDeck||1),0);return Ae?.commander&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander.id||Ae.commander.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander.oracle_id)&&ze++,Ae?.commander_partner&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander_partner.id||Ae.commander_partner.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander_partner.oracle_id)&&ze++,ze},[Pe,Ae]),Be=b.useMemo(()=>{if(!Pe)return 0;let ze=Pe.filter(rt=>!rt.is_wishlist).reduce((rt,ht)=>rt+(ht.countInDeck||1),0);return Ae?.commander&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander.id||Ae.commander.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander.oracle_id)&&ze++,Ae?.commander_partner&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander_partner.id||Ae.commander_partner.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander_partner.oracle_id)&&ze++,ze},[Pe,Ae]),Lt=Ae?.format==="binder",Ft=b.useMemo(()=>{if(!Pe)return 0;let ze=Pe.reduce((rt,ht)=>{const Rt=parseFloat(ht.prices?.[ht.finish==="foil"?"usd_foil":"usd"])||parseFloat(ht.data?.prices?.[ht.finish==="foil"?"usd_foil":"usd"])||0;return rt+Rt*(ht.countInDeck||1)},0);if(Ae?.commander&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander.id||Ae.commander.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander.oracle_id)){const rt=Ae.commander,ht=parseFloat(rt.prices?.[rt.finish==="foil"?"usd_foil":"usd"])||0;ze+=ht}if(Ae?.commander_partner&&!Pe.some(rt=>rt.scryfall_id===(Ae.commander_partner.id||Ae.commander_partner.scryfall_id)||rt.oracle_id&&rt.oracle_id===Ae.commander_partner.oracle_id)){const rt=Ae.commander_partner,ht=parseFloat(rt.prices?.[rt.finish==="foil"?"usd_foil":"usd"])||0;ze+=ht}return ze},[Pe,Ae]),Ee=b.useMemo(()=>{const ze=Ae?.aiBlueprint||{},rt=ze.layout?.types||ze.suggestedCounts||{};return[{label:"Total",current:Yt,target:Ae?.format?.toLowerCase()==="standard"||Ae?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:Tt("Creature"),target:rt.Creatures||rt.Creature||30},{label:"Lands",current:Tt("Land"),target:rt.Lands||rt.Land||36},{label:"Instants",current:Tt("Instant"),target:rt.Instants||rt.Instant||10},{label:"Sorceries",current:Tt("Sorcery"),target:rt.Sorceries||rt.Sorcery||10},{label:"Enchantments",current:Tt("Enchantment"),target:rt.Enchantments||rt.Enchantment||5},{label:"Artifacts",current:Tt("Artifact"),target:rt.Artifacts||rt.Artifact||10},{label:"Planeswalkers",current:Tt("Planeswalker"),target:rt.Planeswalkers||rt.Planeswalker||0}].filter(Rt=>Rt.target>0)},[Ae,Yt,Pe]),He=b.useMemo(()=>{if(!Pe)return{};const ze={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return Pe.forEach(rt=>{const ht=rt,Rt=(ht.data?.type_line||ht.type_line||"").toLowerCase(),yr=Ae?.commander&&(ht.scryfall_id===(Ae.commander.id||Ae.commander.scryfall_id)||ht.oracle_id&&ht.oracle_id===Ae.commander.oracle_id),Fr=Ae?.commander_partner&&(ht.scryfall_id===(Ae.commander_partner.id||Ae.commander_partner.scryfall_id)||ht.oracle_id&&ht.oracle_id===Ae.commander_partner.oracle_id);if(yr||Fr){ze.Commander.push(ht);return}Rt.includes("creature")?ze.Creature.push(ht):Rt.includes("planeswalker")?ze.Planeswalker.push(ht):Rt.includes("instant")?ze.Instant.push(ht):Rt.includes("sorcery")?ze.Sorcery.push(ht):Rt.includes("artifact")?ze.Artifact.push(ht):Rt.includes("enchantment")?ze.Enchantment.push(ht):Rt.includes("land")?ze.Land.push(ht):ze.Other.push(ht)}),Object.fromEntries(Object.entries(ze).filter(([rt,ht])=>ht.length>0))},[Pe,Ae]),Mt=()=>{if(!Ae||!Pe)return;const ze={deck:{name:Ae.name,commander:Ae.commander},cards:Pe,exported_at:new Date},rt=JSON.stringify(ze,null,2),ht=new Blob([rt],{type:"application/json"}),Rt=URL.createObjectURL(ht),yr=document.createElement("a");yr.href=Rt,yr.download=`${Ae.name.replace(/[^a-z0-9]/yi,"_")} _backup.json`,document.body.appendChild(yr),yr.click(),document.body.removeChild(yr)},Gt=ze=>{let rt=ze.split(/[\r\n~]/);rt.forEach((Rt,yr)=>{Rt=Rt.split("(")[0],Rt=Rt.replace(/ *\[[^\]]*\] */g," "),Rt=Rt.replace(/ *<[^>]*> */g," "),Rt=Rt.trim(),rt[yr]=Rt});const ht=rt.join("~");return encodeURIComponent(ht).replace(/%20/g,"+")+"~Z~"},Zt=()=>{if(!Ae||!Pe)return;const ze=[];Ae.commander&&ze.push(`1 ${Ae.commander.name} `),Ae.commander_partner&&ze.push(`1 ${Ae.commander_partner.name} `),Pe.forEach(Rt=>{const yr=Rt.countInDeck||1,Fr=Rt.name||Rt.data?.name||"";Fr&&ze.push(`${yr} ${Fr} `)});const rt=ze.join(`
`),ht=Gt(rt);window.open(`https://edhpowerlevel.com?d=${ht}`,"_blank")},Ut=()=>{if(!Ae||!Pe)return;const ze=[];Ae.commander&&ze.push(`1 ${Ae.commander.name}`),Ae.commander_partner&&ze.push(`1 ${Ae.commander_partner.name}`),Pe.forEach(Rt=>{const yr=Rt.countInDeck||1,Fr=Rt.name||Rt.data?.name||"";Fr&&ze.push(`${yr} ${Fr}`)});const rt=ze.join(`
`),ht=encodeURIComponent(rt);window.open(`https://www.tcgplayer.com/massentry?c=${ht}`,"_blank")},It=async ze=>{try{const rt={...ze,countInDeck:1,managedId:`temp-${Date.now()}`},ht=[...Pe,rt];Et(`Added ${ze.name}`,ht),setCards(ht),await za.addCardToDeck(r.uid,t,ze),a(`Added ${ze.name} to deck`,"success"),dt(!0)}catch(rt){console.error(rt),a("Failed to add card to deck","error"),dt()}},Vt=async(ze,rt)=>{ne({isOpen:!0,title:"Remove Card",message:`Are you sure you want to remove ${rt} from this deck?`,onConfirm:async()=>{try{const ht=Pe.filter(Rt=>Rt.managedId!==ze&&Rt.id!==ze);Et(`Removed ${rt}`,ht),setCards(ht),await za.removeCardFromDeck(r.uid,t,ze),a(`Removed ${rt} from deck`,"success")}catch(ht){console.error(ht),a("Failed to remove card","error"),dt()}}})},pr=ze=>{if(!ze)return"https://placehold.co/250x350?text=No+Image";const rt=ze.data||ze;return R[rt.id]&&rt.card_faces&&rt.card_faces[1]&&rt.card_faces[1].image_uris?.normal?rt.card_faces[1].image_uris.normal:rt.image_uris?.normal?rt.image_uris.normal:rt.card_faces?.[0]?.image_uris?.normal?rt.card_faces[0].image_uris.normal:ze.image_uri?ze.image_uri:"https://placehold.co/250x350?text=No+Image"},en=async(ze,rt,ht)=>{if(ze.stopPropagation(),Ae.commander_partner&&N!==ht){C(ht);return}const Rt=rt.data||rt;if(!(!Rt.card_faces||Rt.card_faces.length<2)){if(!R[Rt.id]&&!Rt.card_faces[1].image_uris){X(!0);try{a("Fetching back face data...","info");const yr=await fetch(`https://api.scryfall.com/cards/${Rt.id}`);if(!yr.ok)throw new Error("Fetch failed");const Fr=await yr.json(),Mn=ht===0?{commander:Fr}:{commanderPartner:Fr};await za.updateDeck(r.uid,t,Mn),dt(!0),a("Commander data updated.","success")}catch(yr){console.error("Flip fix failed",yr),a("Could not load card back.","error")}finally{X(!1)}}P(yr=>({...yr,[Rt.id]:!yr[Rt.id]}))}},Yr=()=>{j(Ae.name),y(!0)},$r=async()=>{try{await za.updateDeck(r.uid,t,{name:v}),a("Deck renamed successfully","success"),y(!1),window.location.reload()}catch(ze){console.error(ze),a("Failed to rename deck","error")}},Qr=async()=>{try{await za.updateDeck(r.uid,t,{is_mockup:!Ae.is_mockup}),a(`Deck set to ${Ae.is_mockup?"Collection":"Mockup"} mode`,"info"),window.location.reload()}catch(ze){console.error(ze),a("Failed to update deck mode","error")}},pn=Ke.useRef(!1),[Hr,ss]=b.useState(!1),Ei=()=>{pn.current=!1,ss(!0),ne({isOpen:!0,title:"Delete Deck",message:"Are you sure you want to delete this deck? Cards inside will be returned to your collection binder.",onConfirm:async()=>{try{await za.deleteDeck(r.uid,t,{deleteCards:pn.current}),a("Deck deleted successfully","success"),e("/decks")}catch(ze){console.error(ze),a("Failed to delete deck","error")}finally{ss(!1)}}})},wi=ze=>{if(!ze)return"";const rt=ze.data||ze;return R[rt.id]&&rt.card_faces&&rt.card_faces[1]&&rt.card_faces[1].image_uris?.art_crop?rt.card_faces[1].image_uris.art_crop:rt.image_uris?.art_crop?rt.image_uris.art_crop:rt.card_faces?.[0]?.image_uris?.art_crop?rt.card_faces[0].image_uris.art_crop:rt.image_uris?.normal?rt.image_uris.normal:ze.image_uri?ze.image_uri:""};if(ct)return s.jsx("div",{className:"flex justify-center p-20",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(bt)return s.jsxs("div",{className:"p-20 text-center text-red-500 text-xl font-bold",children:["Error loading deck: ",bt.message]});if(!Ae)return null;const $s=N===0?Ae.commander:Ae.commander_partner||Ae.commander,zi=wi($s),jn={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"};return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${zi})`,backgroundSize:"cover",backgroundPosition:"center"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"})}),s.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 md:p-6 space-y-6 animate-fade-in pb-24 relative z-10",children:[s.jsx("div",{className:"sticky top-16 z-40 bg-gradient-to-r from-gray-900/95 via-gray-900/80 to-gray-900/40 backdrop-blur-3xl border-b border-white/10 shadow-2xl transition-all duration-300 mx-auto w-full max-w-[1600px] rounded-b-3xl",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 md:gap-6 px-3 md:px-8 py-3 md:py-4",children:[s.jsxs("div",{className:"flex items-start gap-3 md:gap-4 min-w-0 shrink-0",children:[s.jsx(br,{to:"/decks",className:"w-9 h-9 md:w-12 md:h-12 flex items-center justify-center bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shrink-0 mt-0.5 md:mt-0",title:"Back to Decks",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[m?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:v,onChange:ze=>j(ze.target.value),className:"bg-black/50 text-2xl font-black text-white border-b-2 border-indigo-500 outline-none px-2 py-1 w-full max-w-md backdrop-blur-sm rounded",autoFocus:!0}),s.jsx("button",{onClick:$r,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}):s.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 group max-w-full",children:[s.jsx("h2",{className:"text-xl md:text-3xl lg:text-4xl font-black text-white tracking-tighter uppercase truncate leading-tight flex-1",title:Ae.name,children:Ae.name}),Ht&&s.jsx("button",{onClick:Yr,className:"p-1 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity text-gray-500 hover:text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("div",{className:"text-[10px] md:text-[11px] text-indigo-300 font-black uppercase tracking-[0.15em] md:tracking-[0.2em] opacity-80 whitespace-nowrap",children:[jr.badge,"  ",jr.theme]}),!qt&&s.jsxs("span",{className:`text-[9px] md:text-[10px] font-bold uppercase tracking-widest px-2 py-0.5 rounded-full border whitespace-nowrap ${Ht?"bg-green-900/40 text-green-400 border-green-500/30":"bg-gray-800 text-gray-400 border-gray-700"}`,children:[Xt," Access"]}),s.jsx("div",{className:"flex items-center gap-1 shrink-0",children:(()=>{const ze=Ae?.commander?.color_identity||[],rt=Ae?.commander_partner?.color_identity||[];return[...new Set([...ze,...rt])].map(Rt=>s.jsx("img",{src:jn[Rt],alt:Rt,className:"w-5 h-5 md:w-6 md:h-6 shadow-sm"},Rt))})()})]})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-2 md:mt-3",children:s.jsxs("div",{className:"flex items-center gap-2 bg-black/40 px-2.5 md:px-3 py-1 md:py-1.5 rounded-xl border border-white/5 backdrop-blur-md shadow-2xl",children:[s.jsx("span",{className:"bg-orange-600/20 text-orange-400 px-2 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-orange-500/30",children:Ae.format||"Commander"}),Ae.tags&&Ae.tags.includes("Precon")&&s.jsx("span",{className:"bg-teal-600/20 text-teal-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-teal-500/30",children:"Precon"}),Ae.aiBlueprint?.grade?.commanderBracket&&s.jsxs("span",{className:"bg-indigo-600/20 text-indigo-300 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-indigo-500/30",children:[s.jsx("span",{className:"hidden md:inline",children:"Bracket "}),Ae.aiBlueprint.grade.commanderBracket]}),Ae.is_mockup&&s.jsx("span",{className:"bg-red-600/20 text-red-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-red-500/30",children:"Mockup"}),Ae.aiBlueprint?.grade?.powerLevel>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold uppercase tracking-widest opacity-80",children:[s.jsx("span",{className:"hidden md:inline",children:"power "}),Ae.aiBlueprint.grade.powerLevel.toFixed(1)]})]}),s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold font-mono",children:["$",Ft.toFixed(2)]})]})})]})]}),s.jsx("div",{className:"hidden sm:block flex-1 px-8 text-center",children:s.jsxs("div",{className:"text-[12px] md:text-[13px] text-white/30 italic font-medium tracking-tight mx-auto max-w-2xl leading-relaxed",children:['"',jr.flavor_text,'"']})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-3 bg-gray-950/40 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md relative self-end lg:self-auto",children:[s.jsxs("div",{className:"flex gap-1 mr-2 border-r border-white/10 pr-3",children:[s.jsx("button",{onClick:zt,disabled:!$t,className:`p-2 rounded-lg transition-colors ${$t?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-900/50 text-gray-600 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),s.jsx("button",{onClick:Ot,disabled:!At,className:`p-2 rounded-lg transition-colors ${At?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-900/50 text-gray-600 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})})})]}),s.jsxs("button",{onClick:()=>se(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-indigo-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Strategy"})]}),Ht&&s.jsxs("button",{onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-green-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),s.jsx("span",{className:"hidden sm:inline",children:"Collection"})]}),s.jsxs("div",{ref:Te,className:"relative",onMouseEnter:()=>{oe.current&&(clearTimeout(oe.current),oe.current=null),Ce(!0)},onMouseLeave:()=>{je||(oe.current=setTimeout(()=>{Ce(!1)},400))},children:[s.jsxs("button",{onClick:()=>{we(!je),Ce(!0)},className:`flex items-center gap-3 px-6 py-3 rounded-2xl border transition-all duration-300 shadow-xl ${je?"bg-indigo-600 border-indigo-500 text-white":"bg-indigo-600/10 border-indigo-500/20 text-indigo-300 hover:text-white hover:border-indigo-500/50 hover:bg-indigo-600/20"}`,children:[s.jsxs("div",{className:"flex -space-x-1.5 items-center",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})})]}),s.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:je?"Close":"Tools"})]}),pe&&s.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[60] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Deck Building"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Ht&&s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),x(!0),Ce(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group lg:min-h-[64px] group",title:"Forge Lens: Scan & Add",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Forge Lens"})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),c(!0),Ce(!1)},className:`flex flex-col items-center gap-2 p-3 bg-white/5 rounded-xl border border-white/5 transition-all group ${Ht?"hover:bg-indigo-500/20":"opacity-50 cursor-not-allowed"}`,disabled:!Ht,children:[s.jsx("svg",{className:"w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Search"})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),ue(!0),Ce(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group group",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"View Tokens"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Logic & Analysis"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:ze=>{if(ze.stopPropagation(),!vn(n?.subscription_tier).features.deckDoctor){a("Deck Doctor is available on Wizard tier and above.","info");return}Y(!0),Ce(!1)},className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border transition-all group ${vn(n?.subscription_tier).features.deckDoctor?"bg-indigo-500/10 hover:bg-indigo-500/30 border-indigo-500/20":"bg-gray-900 border-gray-800 opacity-40 cursor-not-allowed"}`,children:[s.jsx("svg",{className:"w-8 h-8 text-indigo-400 group-hover:scale-110 transition-transform bg-indigo-500/20 p-1.5 rounded-lg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-indigo-300 uppercase tracking-wider",children:"Deck Doctor"})]}),Ht&&(vn(n?.subscription_tier).features.deckAudit?s.jsx("div",{onClick:()=>Ce(!1),className:"h-full",children:s.jsx(Uw,{type:"deck",targetId:t,label:"Audit",className:"w-full h-full flex flex-col items-center gap-2 p-3 bg-purple-500/10 hover:bg-purple-500/30 border border-purple-500/20 rounded-xl transition-all font-bold text-[10px] text-purple-300"})}):s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),a("Deck Audits are available on Magician tier and above.","info")},className:"flex flex-col items-center gap-2 p-3 bg-gray-900 border border-gray-800 rounded-xl opacity-40 cursor-not-allowed",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"Audit"})]}))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Tabletop & Print"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(br,{to:`/solitaire/${t}`,className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-amber-500/20 rounded-xl border border-amber-500/10 hover:border-amber-500/30 transition-all group lg:min-h-[64px]",children:[s.jsx("span",{className:"text-xl mb-1 group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-amber-300 uppercase tracking-wider",children:"Playtest"})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),Q(!0),Ce(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-gray-500/20 rounded-xl border border-gray-500/10 hover:border-gray-500/30 transition-all group lg:min-h-[64px]",children:[s.jsx("span",{className:"text-xl mb-1 group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-wider",children:"Print"})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),e("/play"),Ce(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-green-500/20 rounded-xl border border-green-500/10 hover:border-green-500/30 transition-all group lg:min-h-[64px]",children:[s.jsx("span",{className:"text-xl mb-1 group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-green-300 uppercase tracking-wider",children:"Life Counter"})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),e("/tournaments"),Ce(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-orange-500/20 rounded-xl border border-orange-500/10 hover:border-orange-500/30 transition-all group lg:min-h-[64px]",children:[s.jsx("span",{className:"text-xl mb-1 group-hover:scale-110 transition-transform",children:""}),s.jsx("span",{className:"text-[10px] font-bold text-orange-300 uppercase tracking-wider",children:"Tournaments"})]})]})]}),Ge==="market"&&s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Value"}),s.jsxs("div",{className:"text-3xl font-mono font-bold text-amber-500",children:["$",Ve?.total?.toFixed(2)||"0.00"]})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:"Avg Card Price"}),s.jsxs("div",{className:"text-xl font-mono font-bold text-gray-300",children:["$",Ve?.average?.toFixed(2)||"0.00"]})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:"Most Expensive"}),s.jsx("div",{className:"text-sm font-bold text-white truncate",children:Ve?.maxCard?.name||"-"}),s.jsxs("div",{className:"text-lg font-mono text-indigo-400",children:["$",Ve?.max?.toFixed(2)||"0.00"]})]})]}),s.jsx(DeckValueChart,{cards:Pe}),s.jsx("div",{className:"flex justify-center pt-8",children:s.jsx("a",{href:lt,target:"_blank",rel:"noopener noreferrer",className:"group relative inline-flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-black uppercase tracking-widest rounded-xl shadow-lg shadow-green-900/50 hover:shadow-green-500/30 transition-all transform hover:-translate-y-1",children:s.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:["Buy Deck on TCGPlayer",s.jsx("svg",{className:"w-5 h-5 opacity-70 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5",children:[s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),ce(!0),Ce(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center justify-between hover:bg-indigo-500/10 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Share Deck"})]}),s.jsx("svg",{className:"w-3 h-3 text-gray-600 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),vn(n?.subscription_tier).features.deckBackup?(Mt(),Ce(!1)):a("Deck Export is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${vn(n?.subscription_tier).features.deckBackup?"hover:bg-gray-800":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Export JSON"})]}),!vn(n?.subscription_tier).features.deckBackup&&s.jsx("span",{className:"text-[8px] bg-amber-500/20 text-amber-500 px-1.5 py-0.5 rounded leading-none",children:"PRO"})]}),Ht&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:ze=>{ze.stopPropagation(),vn(n?.subscription_tier).features.mockupDeck?(Qr(),Ce(!1)):a("Mockup Mode is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${vn(n?.subscription_tier).features.mockupDeck?"hover:bg-orange-950/20":"opacity-40 cursor-not-allowed"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:Ae.is_mockup?"To Collection":"To Mockup"})]})}),s.jsxs("button",{onClick:ze=>{ze.stopPropagation(),Ei(),Ce(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-red-900/30 text-red-400 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{className:"font-bold",children:"Delete Deck"})]})]})]})]})]})})]})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:Ee.map((ze,rt)=>{const ht=ze.target>0?Math.min(ze.current/ze.target*100,100):0,Rt=ze.target>0&&ze.current===ze.target,yr=ze.target>0&&ze.current>ze.target;return s.jsxs("div",{className:"bg-gray-950/30 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg group hover:border-indigo-500/30 transition-all hover:bg-gray-950/50",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:ze.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${Rt?"text-green-400":yr?"text-orange-400":"text-indigo-300"}`,children:[ze.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),ze.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${Rt?"bg-green-500":yr?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${ht||0}%`}})})]},rt)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsxs("div",{className:"flex-1 min-w-0 bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl border border-white/10 order-2 lg:order-1 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5 rounded-t-xl backdrop-blur-sm",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),Yt>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-700",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acquired"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${Be===Yt?"text-green-400":"text-orange-400"}`,children:[Be,"/",Yt]}),s.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden ml-1",children:s.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${Be/Yt*100}%`}})})]})]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700 items-center",children:[O?s.jsxs("div",{className:"flex items-center gap-2 mr-2 animate-fade-in",children:[s.jsx("button",{onClick:$,className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:T.size===Pe.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2",children:[T.size," Selected"]}),s.jsx("button",{onClick:k,disabled:T.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:Ae.is_mockup?"Delete":"Remove"}),s.jsx("button",{onClick:()=>F(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>F(!0),className:"text-xs font-bold text-gray-400 hover:text-indigo-400 px-3 transition-colors uppercase mr-1",children:"Select"}),s.jsx("div",{className:"w-px h-4 bg-gray-700 mx-1"}),s.jsx("button",{onClick:()=>xt("grid"),className:`p-1.5 rounded-md transition-all ${ot==="grid"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>xt("table"),className:`p-1.5 rounded-md transition-all ${ot==="table"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Table View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsxs("div",{className:"p-4 space-y-8 min-h-[500px]",children:[Object.entries(He).length===0&&s.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:'Use the "Collection" button to start building your deck.'}),Object.entries(He).map(([ze,rt])=>s.jsxs("div",{className:"animate-fade-in text-left",children:[s.jsxs("h4",{className:"text-sm font-bold text-indigo-300 border-b border-white/5 mb-4 pb-2 sticky top-0 bg-gray-950/60 backdrop-blur-md z-10 flex justify-between uppercase tracking-wider pl-1",children:[s.jsx("span",{children:ze}),s.jsx("span",{className:"text-gray-500 text-xs bg-gray-900 px-2 py-0.5 rounded-full border border-gray-700",children:rt.reduce((ht,Rt)=>ht+(Rt.countInDeck||1),0)})]}),ot==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 px-1",children:rt.map(ht=>s.jsx(vm,{card:ht,availableFoils:Ct,onRemove:Vt,decks:kt,currentUser:n,showOwnerTag:!0,hideDeckTag:!0,hideOwnerTag:!0,selectMode:O,isSelected:T.has(ht.id),onToggleSelect:B},ht.firestoreId||ht.id))}):s.jsx("div",{className:"space-y-1",children:rt.map((ht,Rt)=>s.jsxs("div",{className:`flex items-center justify-between p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm group border ${T.has(ht.id)?"bg-indigo-900/20 border-indigo-500/50":"border-transparent hover:border-gray-700"}`,onClick:yr=>{O&&(yr.stopPropagation(),B(ht.id))},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[O&&s.jsx("input",{type:"checkbox",checked:T.has(ht.id),readOnly:!0,className:"rounded bg-gray-700 border-gray-600 text-indigo-500 focus:ring-0 w-4 h-4 cursor-pointer"}),s.jsx("span",{className:"font-mono text-gray-500 w-6 text-center bg-gray-900 rounded py-0.5 text-xs",children:ht.countInDeck}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`font-medium ${ht.finish==="foil"?"text-yellow-200":"text-gray-200"}`,children:ht.name}),ht.finish!=="foil"&&Ct.has(ht.name)&&s.jsx("span",{className:"text-yellow-500 text-xs cursor-help",title:"Foil copy available in collection",children:""})]}),ht.finish==="foil"&&s.jsx("span",{className:"text-[10px] bg-yellow-900/40 text-yellow-500 px-1 rounded uppercase tracking-wider border border-yellow-800",children:"Foil"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[s.jsx("span",{className:"hidden md:inline-block text-xs text-gray-500",children:ht.data?.type_line||ht.type_line||""}),s.jsx("span",{className:"font-mono w-16 text-right text-xs",children:ht.mana_cost||""}),s.jsxs("span",{className:"font-mono w-16 text-right text-green-400/80 text-xs",children:["$",(parseFloat(ht.prices?.[ht.finish==="foil"?"usd_foil":"usd"])||0).toFixed(2)]}),Ht&&!O&&s.jsx("button",{onClick:()=>Vt(ht.firestoreId||ht.id,ht.name),className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]},ht.id+Rt))})]},ze))]})]}),s.jsxs("div",{className:"w-full lg:w-80 space-y-6 shrink-0 order-1 lg:order-2",children:[!Lt&&Ae.commander&&s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:Ae.format?.toLowerCase()==="standard"?"Spotlight Card":Ae.commander_partner?"Partners":"Commander"}),Ae.commander_partner&&s.jsx("button",{onClick:()=>C(ze=>ze===0?1:0),className:"text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider transition-colors",children:"Swap View "})]}),s.jsxs("div",{className:"p-4 flex justify-center relative min-h-[350px]",children:[Ae.commander_partner&&s.jsx("div",{className:`transition-all duration-500 ease-out transform absolute top-4
                                            ${N===0?"scale-90 opacity-60 translate-x-4 -rotate-3 z-0 blur-[1px] hover:blur-0":"scale-100 opacity-100 z-10 translate-x-0 rotate-0"}
                                            cursor-pointer`,onClick:ze=>en(ze,Ae.commander_partner,1),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:pr(Ae.commander_partner),className:"w-full max-w-[250px] rounded-lg shadow-2xl skew-y-1",alt:Ae.commander_partner.name}),(Ae.commander_partner.card_faces||Ae.commander_partner.data?.card_faces)&&N===1&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${q?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),s.jsx("div",{className:`transition-all duration-500 ease-out transform relative
                                        ${Ae.commander_partner&&N===1?"scale-90 opacity-60 -translate-x-4 rotate-3 z-0 blur-[1px] hover:blur-0 cursor-pointer":"scale-100 opacity-100 z-10"}
                                        `,onClick:ze=>en(ze,Ae.commander,0),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:pr(Ae.commander),className:"w-full max-w-[250px] rounded-lg shadow-2xl hover:shadow-indigo-500/30 transition-shadow duration-300",alt:Ae.commander.name}),(Ae.commander.card_faces||Ae.commander.data?.card_faces)&&N===0&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${q?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]}),!Lt&&s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl p-6 border border-white/10 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),o," Tools"]}),s.jsxs("div",{className:"space-y-3 relative z-10",children:[s.jsxs("button",{onClick:()=>{Ae.format?.toLowerCase()==="standard"?a("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info",0):e(`/decks/${t}/build`)},className:"w-full py-4 bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-300 rounded-xl border border-indigo-500/20 hover:border-indigo-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),o,"'s Deck Builder"]}),s.jsxs("button",{onClick:()=>W(!0),className:"w-full py-4 bg-indigo-900/10 hover:bg-indigo-900/20 text-indigo-400 rounded-xl border border-indigo-500/10 hover:border-indigo-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Full Deck Stats"]}),s.jsxs("button",{onClick:()=>e("/tournaments"),className:"w-full py-4 bg-yellow-600/10 hover:bg-yellow-600/20 text-yellow-500 rounded-xl border border-yellow-500/20 hover:border-yellow-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Tournament Mode"]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 p-4 pb-0 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse"}),"External Sites"]}),s.jsxs("div",{className:"space-y-3 relative z-10 p-4 pt-3",children:[s.jsxs("button",{onClick:Zt,className:"w-full py-4 bg-purple-600/10 hover:bg-purple-600/20 text-purple-300 rounded-xl border border-purple-500/20 hover:border-purple-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),"EDH Power Level"]}),s.jsxs("button",{onClick:Ut,className:"w-full py-4 bg-green-900/10 hover:bg-green-900/20 text-green-400 rounded-xl border border-green-500/10 hover:border-green-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Buy on TCGPlayer"]})]})]})]})]}),s.jsx(x2e,{isOpen:te,onClose:()=>ce(!1),deck:Ae,onUpdateDeck:ze=>{ze.is_public!==void 0&&(Ae.is_public=ze.is_public),ze.shareSlug!==void 0&&(Ae.shareSlug=ze.shareSlug)}}),s.jsx($H,{isOpen:U,onClose:()=>Y(!1),deck:Ae,cards:Pe,isOwner:Ht}),s.jsx(O6,{isOpen:l,onClose:()=>c(!1),onAddCard:It,onOpenForgeLens:()=>{c(!1),x(!0)}}),s.jsx(DH,{isOpen:G.isOpen,onClose:()=>ne({...G,isOpen:!1}),onConfirm:G.onConfirm,title:G.title,message:G.message,isDanger:!0,confirmText:"Remove",children:Hr&&s.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white/5 p-3 rounded-lg border border-white/10",children:[s.jsx("input",{type:"checkbox",id:"deleteCardsCheckbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500",onChange:ze=>pn.current=ze.target.checked}),s.jsxs("label",{htmlFor:"deleteCardsCheckbox",className:"text-gray-300 text-sm select-none",children:["Also remove these cards from my ",Ae.is_mockup?"wishlist":"collection binder"]})]})}),s.jsx(g2e,{isOpen:ee,onClose:()=>se(!1),deck:Ae,cards:Pe,onStrategyUpdate:()=>dt(!0)}),s.jsx(p2e,{isOpen:u,onClose:()=>f(!1),deck:Ae,deckCards:Pe}),s.jsx(BH,{isOpen:J,onClose:()=>W(!1),cards:Pe,deckName:Ae.name}),s.jsx(jw,{isOpen:p,onClose:()=>x(!1),onFinish:async(ze,rt={})=>{if(ze.length)try{const{targetDeckId:ht,additionMode:Rt}=rt,yr=ze.map(_r=>({name:_r.name,scryfall_id:_r.scryfall_id,set_code:_r.set_code,collector_number:_r.collector_number,image_uri:_r.data.image_uris?.normal||_r.data.card_faces?.[0]?.image_uris?.normal,count:_r.quantity,data:_r.data,finish:_r.finish||"nonfoil",is_wishlist:_r.is_wishlist,tags:[]})),Fr=Rt==="transfer"?"transfer_to_deck":"merge",Mn=ht||t;await za.batchAddCardsToDeck(r.uid,Mn,yr,Fr);const ps=ht?ht===t?"this deck":"another deck":"your collection";a(`Successfully ${Rt==="transfer"?"moved":"added"} ${ze.length} cards to ${ps}!`,"success"),Mn===t&&dt()}catch(ht){console.error("Forge Lens Add Failed",ht),a("Failed to add scanned cards.","error")}}}),s.jsx(b2e,{isOpen:xe,onClose:()=>ue(!1),deckCards:Pe}),s.jsx(d4e,{isOpen:ve,onClose:()=>Q(!1),cards:Pe,deckName:Ae?.name||"Proxy Deck"})]})]})};function h4e(){const[t,e]=b.useState([]),[r,n]=b.useState(!0),[i,a]=b.useState(null);return b.useEffect(()=>{(async()=>{try{const c=(await Ze.get("/api/sets")).data||[];e(c),n(!1)}catch(l){console.error("Error fetching sets:",l),a(l),n(!1)}})()},[]),{sets:t,loading:r,error:i}}const LW=({value:t,onChange:e,onSelect:r,placeholder:n="Find card in sets..."})=>{const[i,a]=b.useState([]),[o,l]=b.useState(!1),[c,u]=b.useState(!1),f=b.useRef(null);b.useEffect(()=>{const x=m=>{f.current&&!f.current.contains(m.target)&&l(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),b.useEffect(()=>{const m=setTimeout(async()=>{if(t.length<2){a([]);return}u(!0);try{const y=await Ze.get("/api/cards/autocomplete",{q:t});a(y.data||[]),l(!0)}catch(y){console.error("Autocomplete failed",y)}finally{u(!1)}},300);return()=>clearTimeout(m)},[t]);const p=x=>{e(x),l(!1),r&&r(x)};return s.jsxs("div",{ref:f,className:"relative w-full",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c?s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-indigo-400"}):s.jsx("svg",{className:"h-4 w-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 bg-gray-900/50 border border-indigo-500/20 rounded-xl text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none text-sm",placeholder:n,value:t,onChange:x=>e(x.target.value),onFocus:()=>t.length>=2&&l(!0)}),t&&s.jsx("button",{onClick:()=>e(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o&&i.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl overflow-hidden animate-fade-in",children:i.map((x,m)=>s.jsx("button",{onClick:()=>p(x),className:"w-full text-left px-4 py-2.5 text-sm text-gray-300 hover:bg-indigo-600 hover:text-white transition-colors border-b border-white/5 last:border-0",children:x},m))})]})},f4e=()=>{const{sets:t,loading:e,error:r}=h4e(),{cards:n}=To(),[i,a]=b.useState(""),[o,l]=b.useState(sessionStorage.getItem("mtg_card_search")||""),[c,u]=b.useState(null),[f,p]=b.useState(!1),[x,m]=b.useState(!1),y=dn();b.useEffect(()=>{const L=setTimeout(async()=>{const O=o.trim();if(!O){u(null),sessionStorage.removeItem("mtg_card_search");return}sessionStorage.setItem("mtg_card_search",O),p(!0);try{const F=await Ze.get("/api/cards/sets-for-card",{name:O});u(new Set(F.data||[]))}catch(F){console.error("Local card search failed",F),u(new Set)}finally{p(!1)}},500);return()=>clearTimeout(L)},[o]);const v=b.useMemo(()=>{const A=new Map;n&&n.forEach(O=>{if(O.is_wishlist||O.deck_id)return;const F=(O.set||O.set_code)?.toLowerCase(),T=O.name;A.has(F)||A.set(F,new Set),T&&A.get(F).add(T)});const L={};return A.forEach((O,F)=>{L[F]=O.size}),L},[n]),j=b.useMemo(()=>{if(!t)return{};const A={Expansion:[],Core:[],Commander:[],Masters:[],"Draft Innovation":[],Other:[]},L={expansion:"Expansion",core:"Core",commander:"Commander",masters:"Masters",draft_innovation:"Draft Innovation"};return t.forEach(O=>{const F=v[O.code.toLowerCase()]||0,T=F>0,I=!i||O.name.toLowerCase().includes(i.toLowerCase())||O.code.toLowerCase().includes(i.toLowerCase()),B=!c||c.has(O.code.toLowerCase());if(!I||!(!x||T)||!B)return;const k=L[O.set_type]||"Other";A[k]?A[k].push({...O,ownedCount:F}):A.Other.push({...O,ownedCount:F})}),Object.keys(A).forEach(O=>{A[O].sort((F,T)=>new Date(T.released_at)-new Date(F.released_at))}),A},[t,i,x,v,c]),N=A=>{y(`/sets/${A}`)};if(e)return s.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(r)return s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-red-500 bg-red-500/10 p-8 rounded-2xl border border-red-500/20 max-w-md",children:[s.jsx("p",{className:"font-bold text-xl mb-2",children:"Error loading sets"}),s.jsx("p",{className:"text-sm opacity-80",children:r.message})]})});const C=["Expansion","Core","Commander","Masters","Draft Innovation","Other"];return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-gray-950/80 backdrop-blur-xl border-b border-white/10 sticky top-16 z-30 py-3 md:py-4",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[s.jsx("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:["Set ",s.jsx("span",{className:"text-indigo-500",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Browse Collections"})]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto lg:flex-1 lg:justify-end",children:[s.jsxs("div",{className:"relative flex-grow max-w-xs group",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-3.5 w-3.5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-9 pr-10 py-2 bg-gray-900/50 border border-white/5 rounded-lg text-xs text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all outline-none",placeholder:"Search sets...",value:i,onChange:A=>a(A.target.value)}),i&&s.jsx("button",{onClick:()=>a(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"relative flex-grow max-w-sm",children:s.jsx(LW,{value:o,onChange:l,placeholder:"Find card in sets..."})}),s.jsx("button",{onClick:()=>m(!x),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${x?"bg-indigo-600 text-white shadow-lg":"bg-gray-800/80 text-gray-400 border border-white/5 hover:bg-gray-700"}`,children:x?"Owned":"Show All"})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:C.map(A=>j[A]&&j[A].length>0&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-3",children:[A,s.jsx("div",{className:"h-[2px] w-12 bg-indigo-500/50"})]}),s.jsxs("span",{className:"text-[10px] font-black text-gray-500 bg-gray-800/50 border border-white/5 px-3 py-1 rounded-full uppercase tracking-widest",children:[j[A].length," Sets"]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:j[A].map(L=>{const O=Math.min(100,Math.round(L.ownedCount/L.card_count*100)),F=O>=100;return s.jsxs("div",{onClick:()=>N(L.code),className:"relative bg-gray-800/40 backdrop-blur-md rounded-2xl border border-white/5 p-5 group cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:border-indigo-500/30 overflow-hidden min-h-[160px] flex flex-col justify-between",children:[s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-1000 ease-out z-0",style:{height:`${O}%`,background:F?"linear-gradient(to top, rgba(34, 197, 94, 0.15) 0%, transparent 100%)":"linear-gradient(to top, rgba(79, 70, 229, 0.15) 0%, transparent 100%)"}}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-900/80 rounded-xl flex items-center justify-center border border-white/5 shadow-inner",children:L.icon_svg_uri?s.jsx("img",{src:L.icon_svg_uri,alt:L.name,className:"w-6 h-6 filter invert opacity-60 group-hover:opacity-100 transition-opacity"}):s.jsx("span",{className:"text-xs font-black text-gray-500",children:L.code.toUpperCase()})}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Code"}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 mb-2",children:L.code.toUpperCase()}),s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Release"}),s.jsx("span",{className:"text-xs font-bold text-gray-400",children:L.released_at?.split("-")[0]})]})})]}),s.jsx("h3",{className:"text-sm font-black text-white leading-snug group-hover:text-indigo-400 transition-colors",children:L.name})]}),s.jsxs("div",{className:"relative z-10 pt-4 mt-4 border-t border-white/5 flex items-end justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:`text-lg font-black tabular-nums ${F?"text-green-400":"text-indigo-400"}`,children:L.ownedCount}),s.jsxs("span",{className:"text-gray-600 text-[10px] font-bold",children:["/ ",L.card_count]})]})]}),s.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-[10px] font-black ${F?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-gray-950/80 text-gray-400 border border-white/5"}`,children:[O,"%"]})]})]},L.id)})})]},A))})]})},p4e=()=>{const{setCode:t}=Eo(),[e,r]=b.useState([]),[n,i]=b.useState(!0),[a,o]=b.useState(null),[l,c]=b.useState("all"),[u,f]=b.useState(sessionStorage.getItem("mtg_card_search")||""),{currentUser:p,userProfile:x}=Sr(),{addToast:m}=wn(),{cards:y,refresh:v}=To();b.useEffect(()=>{u?sessionStorage.setItem("mtg_card_search",u):sessionStorage.removeItem("mtg_card_search")},[u]);const j=b.useMemo(()=>{const O=new Map;return y&&y.forEach(F=>{const T=F.scryfall_id||F.data&&(F.data.scryfall_id||F.data.id)||F.id;O.has(T)||O.set(T,[]),O.get(T).push(F)}),O},[y]),N=b.useMemo(()=>{const O=new Set(e.map(I=>I.name)),F=new Set;let T=0;return e.forEach(I=>{const B=j.get(I.scryfall_id||I.id)||[],$=B.filter(R=>R.finish==="nonfoil"&&!R.is_wishlist).reduce((R,P)=>R+(P.count||1),0),k=B.filter(R=>R.finish==="foil"&&!R.is_wishlist).reduce((R,P)=>R+(P.count||1),0);if($>0||k>0){F.add(I.name);const R=parseFloat(I.prices?.usd||0)*$,P=parseFloat(I.prices?.usd_foil||0)*k;T+=R+P}}),{collected:F.size,total:O.size,value:T.toFixed(2)}},[e,j]),C=b.useMemo(()=>{let O=e;if(l!=="all"&&(O=O.filter(F=>{const I=(j.get(F.scryfall_id||F.id)||[]).some(B=>!B.is_wishlist&&(B.count||0)>0);return l==="owned"?I:!I})),u){const F=u.toLowerCase();O=O.filter(T=>T.name.toLowerCase().includes(F)||(T.data?.name_en||"").toLowerCase().includes(F))}return O},[e,j,l,u]);b.useEffect(()=>{(async()=>{if(t){i(!0);try{const F=await Ze.get(`/api/sets/${t}/cards`);r(F.data||[]),o(null)}catch(F){console.error("Failed to load set cards",F),o(F.message)}finally{i(!1)}}})()},[t]);const A=async(O,F,T)=>{if(!p)return m("Please log in","error");try{const I=O.id,B=j.get(I)||[],$=F==="foil"?"foil":"nonfoil",k=B.find(R=>R.finish===$&&!R.deck_id&&!R.is_wishlist);T>0?k?(await Di.updateCard(k.id,{count:(k.count||1)+1}),m(`Added ${$} ${O.name}`,"success")):(await Di.addCardToCollection(p.uid,O,1,$),m(`Added new ${$} ${O.name}`,"success")):k&&((k.count||1)>1?(await Di.updateCard(k.id,{count:k.count-1}),m(`Removed ${$} ${O.name}`,"info")):(await Di.removeCard(k.id),m(`Removed last ${$} ${O.name}`,"info"))),await v()}catch(I){console.error("Update failed",I),m("Failed to update collection","error")}},L=async(O,F)=>{if(!p)return m("Please log in","error");try{const T=O.id,B=(j.get(T)||[]).find($=>$.is_wishlist&&!$.deck_id);F>0?B?(await Di.updateCard(B.id,{count:(B.count||1)+1}),m(`Increased wishlist for ${O.name}`,"success")):(await Di.addCardToCollection(p.uid,O,1,"nonfoil",!0),m(`Added ${O.name} to wishlist`,"success")):B&&((B.count||1)>1?(await Di.updateCard(B.id,{count:B.count-1}),m(`Decreased wishlist for ${O.name}`,"info")):(await Di.removeCard(B.id),m(`Removed ${O.name} from wishlist`,"info"))),await v()}catch(T){console.error("Wishlist update failed",T),m("Failed to update wishlist","error")}};return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"sticky top-16 z-30 bg-gray-950/80 backdrop-blur-xl border-b border-white/10 shadow-2xl",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(br,{to:"/sets",className:"p-1.5 bg-gray-800/50 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white transition-all group",title:"Back to Sets",children:s.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:[t," ",s.jsx("span",{className:"text-gray-500 font-bold ml-1",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Expansion Collection"})]})]}),s.jsxs("div",{className:"flex items-center gap-6 bg-gray-900/50 border border-white/5 px-4 py-2 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-black text-indigo-400",children:N.collected}),s.jsxs("span",{className:"text-gray-600 font-bold text-[10px]",children:["/ ",N.total]})]})]}),s.jsx("div",{className:"w-[1px] h-4 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Estimate Value"}),s.jsxs("span",{className:"text-sm font-black text-emerald-400 tabular-nums",children:["$",N.value]})]})]}),vn(x?.subscription_tier).features.setAudit?s.jsx(Uw,{type:"set",targetId:t,label:"Audit Set",className:"text-xs py-1.5"}):s.jsxs("button",{onClick:()=>m(`Set Audits are available on ${Cs[Jt.TIER_2].name} tier and above.`,"info"),className:"bg-gray-800/50 border border-gray-700 text-gray-500 px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-widest cursor-not-allowed flex items-center gap-2",title:`Requires ${Cs[Jt.TIER_2].name} Tier`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Audit Set"]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 pt-3 border-t border-white/5",children:[s.jsx("div",{className:"flex bg-gray-900/80 rounded-lg p-0.5 border border-white/5 w-full md:w-auto overflow-hidden",children:["all","owned","missing"].map(O=>s.jsx("button",{onClick:()=>c(O),className:`flex-1 md:flex-none px-4 py-1.5 rounded-md text-[10px] font-black uppercase tracking-widest transition-all duration-300 ${l===O?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white hover:bg-white/5"}`,children:O},O))}),s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto md:flex-1 justify-end",children:[s.jsx("div",{className:"relative w-full max-w-sm",children:s.jsx(LW,{value:u,onChange:f,placeholder:"Filter cards..."})}),u&&s.jsx("button",{onClick:()=>{f(""),sessionStorage.removeItem("mtg_card_search")},className:"p-2 bg-indigo-500/10 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/20 hover:text-white rounded-lg transition-all",title:"Clear filter",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:n?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",children:Array.from({length:12}).map((O,F)=>s.jsx(PH,{},F))}):a?s.jsxs("div",{className:"text-center text-red-500 py-12 bg-red-500/10 rounded-2xl border border-red-500/20",children:["Error loading set: ",a]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:C.map((O,F)=>{const T=j.get(O.scryfall_id||O.id)||[],I=T.filter(k=>k.finish==="nonfoil"&&!k.is_wishlist).reduce((k,R)=>k+(R.count||1),0),B=T.filter(k=>k.finish==="foil"&&!k.is_wishlist).reduce((k,R)=>k+(R.count||1),0),$=T.filter(k=>k.is_wishlist).reduce((k,R)=>k+(R.count||1),0);return s.jsx(LF,{card:O,normalCount:I,foilCount:B,wishlistCount:$,onUpdateCount:A,onUpdateWishlistCount:L,currentUser:x,showOwnerTag:!0},O.id||F)})})})]})},m4e=({isOpen:t,onClose:e,mode:r="global"})=>{const{currentUser:n}=Sr(),{addToast:i}=wn(),a=b.useRef(null),[o,l]=b.useState(null),[c,u]=b.useState(!1),[f,p]=b.useState("cards"),[x,m]=b.useState("merge"),[y,v]=b.useState({checkCollection:!0,addToCollection:!0}),j=C=>{const A=C.target.files[0];if(!A)return;const L=new FileReader;L.onload=O=>{try{const F=JSON.parse(O.target.result);if(F.deck&&F.cards)p("deck"),l(F);else if(F.cards&&F.decks)p("cards"),l(F);else if(F.collection&&typeof F.collection=="object"&&!Array.isArray(F.collection)){const T=Object.values(F.collection);p("cards"),l({cards:T})}else if(Array.isArray(F))p("cards"),l({cards:F});else if(F.cards&&Array.isArray(F.cards))p("cards"),l(F);else if(typeof F=="object"){const T=Object.values(F).find(I=>Array.isArray(I)&&I.length>0&&(I[0].name||I[0].id));T?(p("cards"),l({cards:T})):(console.error("Invalid JSON structure",F),i("Invalid JSON: Could not find card data","error"))}else i("Invalid JSON format","error")}catch(F){console.error(F),i("Failed to parse JSON","error")}},L.readAsText(A)},N=async()=>{if(o){u(!0);try{if(f==="cards")await Di.importBatch(n.uid,o.cards,x,o.decks),i(`Successfully imported ${o.cards.length} cards${o.decks?.length?` and ${o.decks.length} decks`:""}`,"success"),e();else if(f==="deck"){const C=await za.importDeck(n.uid,o.deck,o.cards,y);C.missingCards?.length>0?i(`Imported deck with ${C.missingCards.length} missing cards`,"warning"):i("Deck imported successfully","success"),e()}}catch(C){console.error(C),i("Import failed","error")}finally{u(!1)}}};return t?Gn.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import Data"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 space-y-6",children:o?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg border border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detected Content"}),s.jsx("p",{className:"text-white font-bold text-lg",children:f==="cards"?s.jsxs(s.Fragment,{children:["Collection (",o.cards?.length||0," cards)",o.decks?.length>0&&` + ${o.decks.length} Decks`]}):`Deck: ${o.deck?.name} (${o.cards?.length||0} cards)`})]}),s.jsx("button",{onClick:()=>l(null),className:"text-sm text-red-400 hover:text-red-300 underline",children:"Change File"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-700 pb-2",children:"Import Options"}),f==="cards"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-700 hover:bg-gray-700/50 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:x==="merge",onChange:()=>m("merge"),className:"mt-1 bg-gray-900 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Merge (Recommended)"}),s.jsx("span",{className:"block text-gray-400 text-sm",children:"Add records to your existing collection. Updates if exists."})]})]}),s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-red-900/30 hover:bg-red-900/10 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:x==="replace",onChange:()=>m("replace"),className:"mt-1 bg-gray-900 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Replace (Use with Caution)"}),s.jsxs("span",{className:"block text-red-300 text-sm",children:["Delete your ENTIRE current collection.",o.decks?.length>0?" Existing decks will also be replaced by those in the backup.":" Your decks will be preserved since this backup only contains cards."]})]})]})]}),f==="deck"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:y.checkCollection,onChange:C=>v(A=>({...A,checkCollection:C.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Use existing unassigned copies from collection"})]}),s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:y.addToCollection,onChange:C=>v(A=>({...A,addToCollection:C.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Add missing cards to collection automatically"})]})]})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 hover:bg-gray-700/30 transition-all group",onClick:()=>a.current?.click(),children:[s.jsx("svg",{className:"w-12 h-12 text-gray-500 group-hover:text-indigo-400 mb-4 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsx("p",{className:"text-gray-300 font-medium",children:"Click to select backup JSON"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Supports Collection exports and Deck exports"}),s.jsx("input",{type:"file",ref:a,onChange:j,accept:".json",className:"hidden"})]})}),s.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",disabled:c,children:"Cancel"}),s.jsx("button",{onClick:N,disabled:!o||c,className:`px-6 py-2 rounded-lg font-bold text-white transition-all shadow-lg ${c?"bg-indigo-800 cursor-wait":x==="replace"&&f==="cards"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:c?"Importing...":"Start Import"})]})]})}),document.body):null},g4e=({isOpen:t,onClose:e})=>{const{userProfile:r,refreshUserProfile:n}=Sr(),[i,a]=b.useState(!1),[o,l]=b.useState(r?.settings?.helper?.name||""),[c,u]=b.useState(r?.settings?.helper?.type||""),[f,p]=b.useState(r?.settings?.helper?.personality||""),[x,m]=b.useState(!1),[y,v]=b.useState([]),[j,N]=b.useState(""),[C,A]=b.useState(!1),[L,O]=b.useState({});Ke.useEffect(()=>{if(t){const $=r?.settings?.helper||{};l($.name||""),u($.type||""),p($.personality||""),a(!1),v([]),O({})}},[t,r]);const F=async()=>{m(!0);try{const k={...r?.settings||{},helper:{name:o,type:c,personality:f}};await Ze.updateUser(r.id,{settings:k}),await n(),e()}catch($){console.error($),alert("Failed to save helper.")}finally{m(!1)}},T=async()=>{a(!0),A(!0),O({}),v([]);try{const $=r?.settings?.geminiApiKey;if(!$)throw new Error("API Key missing");const k=await yo.forgeHelperChat($,[],{});v([{role:"model",content:k.aiResponse}])}catch($){console.error($),v([{role:"model",content:"Error connecting to the Forge. Please try again."}])}finally{A(!1)}},I=async()=>{if(!j.trim())return;const $=j;N(""),v(k=>[...k,{role:"user",content:$}]),A(!0);try{const k=r?.settings?.geminiApiKey,R=y.map(q=>({role:q.role,content:q.content}));R.push({role:"user",content:$});const P=await yo.forgeHelperChat(k,R,L);O(P.updatedDraft||{}),v(q=>[...q,{role:"model",content:P.aiResponse}])}catch(k){console.error(k),v(R=>[...R,{role:"model",content:"Reviewing the blueprints... (Error, try again)"}])}finally{A(!1)}},B=()=>{L.name&&l(L.name),L.type&&u(L.type),L.personality&&p(L.personality),a(!1)};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500",children:"Helper Settings"}),s.jsx("span",{className:"text-xs bg-gray-800 text-gray-500 px-2 py-1 rounded border border-gray-700",children:"Beta"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:i?s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-lg mb-4 text-sm text-gray-400 flex justify-between items-center",children:[s.jsx("span",{children:"Forging new identity..."}),s.jsx("button",{onClick:()=>a(!1),className:"text-white hover:underline",children:"Cancel"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-950/30 rounded-lg border border-gray-800",children:[y.map(($,k)=>s.jsx("div",{className:`flex ${$.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-xl text-sm ${$.role==="user"?"bg-emerald-600 text-white":"bg-gray-800 text-gray-200"}`,children:$.content})},k)),C&&s.jsx("div",{className:"flex justify-start",children:s.jsx("span",{className:"animate-pulse text-emerald-500",children:"..."})})]}),(L.name||L.type)&&s.jsxs("div",{className:"bg-black/40 p-3 rounded border border-emerald-500/30 mb-4 flex gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"})," ",s.jsx("span",{className:"text-white",children:L.name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Type:"})," ",s.jsx("span",{className:"text-white",children:L.type||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Personality:"})," ",s.jsx("span",{className:"text-white",children:L.personality||"-"})]}),s.jsx("button",{onClick:B,className:"ml-auto bg-emerald-600 text-white px-3 py-1 rounded hover:bg-emerald-500",children:"Apply This"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:j,onChange:$=>N($.target.value),onKeyDown:$=>$.key==="Enter"&&I(),placeholder:"Describe your helper...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-emerald-500 outline-none"}),s.jsx("button",{onClick:I,disabled:C,className:"bg-emerald-600 p-2 rounded-lg text-white",children:""})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex gap-4 items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-teal-500 to-emerald-700 rounded-full flex items-center justify-center text-2xl shadow-lg",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:o||"Unknown Helper"}),s.jsx("p",{className:"text-emerald-400 text-sm font-medium",children:c||"Generic Construct"}),s.jsxs("p",{className:"text-gray-400 text-sm italic mt-1",children:['"',f||"Standard protocol.",'"']})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Name"}),s.jsx("input",{type:"text",value:o,onChange:$=>l($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),s.jsx("input",{type:"text",value:c,onChange:$=>u($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Personality"}),s.jsx("input",{type:"text",value:f,onChange:$=>p($.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-800",children:[s.jsxs("button",{onClick:T,className:"text-emerald-400 hover:text-emerald-300 font-bold flex items-center gap-2 px-4 py-2 hover:bg-emerald-900/20 rounded-lg transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Re-Forge Persona"]}),s.jsx("button",{onClick:F,disabled:x,className:"bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-6 rounded-lg transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:x?"Saving...":"Save Changes"})]})]})})]})}):null},x4e=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,targetName:a})=>{const[o,l]=b.useState(""),c=o.toUpperCase()==="DELETE";return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-red-500/50 rounded-2xl max-w-md w-full p-6 shadow-2xl shadow-red-900/20 transform transition-all scale-100",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center border border-red-500/50",children:s.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:n||"Confirm Deletion"}),s.jsx("p",{className:"text-red-400 text-sm font-medium",children:"This action cannot be undone."})]})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx("p",{className:"text-gray-300 leading-relaxed",children:i}),a&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[s.jsx("span",{className:"text-red-200 text-sm",children:"Target: "}),s.jsx("span",{className:"text-white font-mono font-bold",children:a})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:["Type ",s.jsx("span",{className:"text-white font-mono",children:"DELETE"})," to confirm"]}),s.jsx("input",{type:"text",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-colors font-mono",placeholder:"DELETE",value:o,onChange:u=>l(u.target.value)})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-xl transition-colors",children:"Cancel"}),s.jsx("button",{onClick:r,disabled:!c,className:`flex-1 px-4 py-3 font-bold rounded-xl transition-all shadow-lg ${c?"bg-red-600 hover:bg-red-500 text-white shadow-red-900/30":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Delete Forever"})]})]})}):null},OW=({isOpen:t,onClose:e})=>t?Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Everything you need to know about Pods & Permissions."})]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsx("div",{className:"bg-blue-900/10 border border-blue-500/20 p-4 rounded-xl",children:s.jsx("p",{className:"text-blue-200 text-sm font-medium",children:" Pro Tip: Only add people you actually know and trust to your Pod."})})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-indigo-400 font-black uppercase text-xs tracking-wider",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Private Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Download/Clone Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Edit Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-purple-400 font-black uppercase text-xs tracking-wider",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Editor"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Everything in Viewer"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," ",s.jsx("strong",{children:"Add/Remove Cards"})," from Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Add Cards to Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Delete Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-sm text-gray-400 border border-gray-700",children:[s.jsx("strong",{children:"How to use:"}),` In the Deck Builder, open the "Sources" dropdown and select a friend's collection to see their cards alongside yours.`]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-red-500/20 text-red-400 flex items-center justify-center text-xs",children:"4"}),"Safety & Revoking"]}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["You are always in control. You can revoke access at any time from this menu or the Settings page. Revoking access is ",s.jsx("strong",{children:"immediate"}),". The other user will be disconnected from your session instantly."]}),s.jsx("div",{className:"mt-4 flex gap-4",children:s.jsxs("div",{className:"flex-1 p-3 bg-red-900/10 border border-red-500/10 rounded-lg",children:[s.jsx("h5",{className:"font-bold text-red-400 text-xs uppercase mb-1",children:"They Cannot"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Delete your account, change your password, or permanently delete your cards/decks."})]})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors font-bold text-sm shadow-lg",children:"Got it, thanks!"})})]})]}),document.body):null,b4e=({isOpen:t,onClose:e,connection:r})=>{const{addToast:n}=wn(),[i,a]=b.useState([]),[o,l]=b.useState(!0),[c,u]=b.useState(!1),[f,p]=b.useState(!1);b.useEffect(()=>{t&&r&&(async()=>{l(!0);try{const j=await wa.fetchPermissions(),N=(Array.isArray(j)?j:[]).filter(C=>C.grantee_id===r.friend.id);a(N)}catch(j){console.error(j),n("Failed to load permissions","error")}finally{l(!1)}})()},[t,r]);const x=async v=>{u(!0);try{await wa.grantPermission(r.friend.id,v,null),n(`Global ${v} access granted`,"success");const j=await wa.fetchPermissions(),N=(Array.isArray(j)?j:[]).filter(C=>C.grantee_id===r.friend.id);a(N)}catch(j){console.error(j),n("Failed to update permission","error")}finally{u(!1)}},m=async v=>{try{await wa.revokePermission(v),n("Permission revoked","info"),a(j=>j.filter(N=>N.id!==v))}catch(j){console.error(j),n("Failed to revoke permission","error")}};if(!t||!r)return null;const y=i.find(v=>v.target_deck_id===null);return Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-2xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsx("div",{className:"p-8 border-b border-white/5 bg-gradient-to-r from-gray-900 to-gray-950 flex justify-between items-start",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-black text-3xl shadow-lg ring-4 ring-gray-900",children:r.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:r.friend.username}),s.jsx("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-xs mt-1",children:"Manage Permissions"})]})]})}),s.jsxs("div",{className:"p-8 space-y-8 overflow-y-auto custom-scrollbar",children:[s.jsx("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl overflow-hidden",children:s.jsx(nm,{children:({open:v})=>s.jsxs(s.Fragment,{children:[s.jsxs(nm.Button,{className:"flex justify-between w-full px-4 py-3 text-sm font-bold text-indigo-300 hover:text-indigo-200 transition-colors uppercase tracking-wider text-left",children:[s.jsx("span",{children:"What does Linking Accounts do?"}),s.jsx(Yse,{className:`${v?"transform rotate-180":""} w-5 h-5 text-indigo-400`})]}),s.jsxs(nm.Panel,{className:"px-4 pb-4 text-sm text-indigo-200/80 leading-relaxed space-y-2",children:[s.jsx("p",{children:"Linking accounts allows you to share your Magic: The Gathering experience with trusted friends."}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-2",children:[s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Sharing Decks:"})," Friends can view your private decks to offer advice or clone them."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Shared Collection:"})," Combine your card pools visually to build decks together."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Deck Editing:"})," If granted ",s.jsx("strong",{children:"Editor"})," access, friends can actively tweak your deck lists (add/remove cards)."]})]}),s.jsx("p",{className:"mt-2 text-xs italic opacity-70",children:"Note: Friends can NEVER delete your decks or account, regardless of permission level."}),s.jsx("div",{className:"pt-2 mt-2 border-t border-indigo-500/20",children:s.jsxs("a",{href:"#",className:"flex items-center gap-2 text-indigo-400 hover:text-white font-bold transition-colors",onClick:j=>{j.preventDefault(),p(!0)},children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Read the Full Setup Guide"]})})]})]})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Global Access Level"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>x("viewer"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${y?.permission_level==="viewer"?"bg-indigo-600/10 border-indigo-500 shadow-indigo-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${y?.permission_level==="viewer"?"text-indigo-400":"text-white"}`,children:"Viewer"}),y?.permission_level==="viewer"&&s.jsx("span",{className:"bg-indigo-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Read-only access. Can view your ",s.jsx("strong",{children:"private decks"}),", ",s.jsx("strong",{children:"binders"}),", and ",s.jsx("strong",{children:"collection"}),". Cannot make changes."]})]}),s.jsxs("button",{onClick:()=>x("editor"),disabled:c,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${y?.permission_level==="editor"?"bg-purple-600/10 border-purple-500 shadow-purple-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${y?.permission_level==="editor"?"text-purple-400":"text-white"}`,children:"Editor"}),y?.permission_level==="editor"&&s.jsx("span",{className:"bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Full collaboration. Can ",s.jsx("strong",{children:"edit your decks"}),", add cards to your ",s.jsx("strong",{children:"collection"}),", and view everything."]})]})]}),y&&s.jsx("div",{className:"mt-6 flex justify-center",children:s.jsxs("button",{onClick:()=>m(y.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Revoke All Access"]})})]}),s.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Specific Deck Overrides"}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto custom-scrollbar bg-gray-950/30 rounded-xl border border-white/5 p-2",children:i.filter(v=>v.target_deck_id).length>0?i.filter(v=>v.target_deck_id).map(v=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded bg-gray-900 flex items-center justify-center text-gray-500",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{children:[s.jsxs("span",{className:"text-sm font-bold text-gray-200 block",children:["Deck #",v.target_deck_id.slice(0,8),"..."]}),s.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wider",children:[v.permission_level," Access"]})]})]}),s.jsx("button",{onClick:()=>m(v.id),className:"text-gray-500 hover:text-red-400 p-2 hover:bg-white/5 rounded-lg transition-colors",title:"Revoke Permission",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},v.id)):s.jsx("div",{className:"text-center py-6 text-gray-500",children:s.jsx("p",{className:"text-xs italic",children:"No specific deck permissions granted."})})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-3 bg-white text-gray-900 hover:bg-gray-200 rounded-xl transition-colors font-bold text-sm shadow-xl",children:"Done"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
            `}}),s.jsx(OW,{isOpen:f,onClose:()=>p(!1)})]}),document.body)},y4e=({isOpen:t,onClose:e,onSuccess:r})=>{const{updateProfileFields:n}=Sr(),[i,a]=b.useState(""),[o,l]=b.useState(!1),[c,u]=b.useState(null),f=async p=>{if(p.preventDefault(),u(null),!i.trim()){u("Username is required.");return}l(!0);try{await n({username:i.trim()}),r(),e()}catch(x){console.error(x),u("Failed to update username. It might be taken.")}finally{l(!1)}};return t?Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm"}),s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md relative z-10 shadow-2xl p-8 animate-fade-in-up",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Identify Yourself"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"To connect with friends and share decks, you need to set a unique username so others can find you."}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Username"}),s.jsx("input",{type:"text",value:i,onChange:p=>a(p.target.value),placeholder:"e.g. Planeswalker99",className:"w-full bg-gray-950 border border-gray-800 text-white px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-600 focus:border-transparent outline-none transition-all",autoFocus:!0})]}),c&&s.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:c}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:o,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-xl shadow-lg shadow-indigo-600/20 transition-all disabled:opacity-50 flex items-center gap-2",children:o?"Saving...":"Save & Continue"})]})]})]})]}),document.body):null},v4e=({isOpen:t,onClose:e,referralUrl:r,username:n})=>{if(!t)return null;const i=()=>{const a=document.getElementById("qr-gen"),o=new XMLSerializer().serializeToString(a),l=document.createElement("canvas"),c=l.getContext("2d"),u=new Image;u.onload=()=>{l.width=u.width,l.height=u.height,c.drawImage(u,0,0);const f=l.toDataURL("image/png"),p=document.createElement("a");p.download=`MTG-Forge-Referral-${n}.png`,p.href=`${f}`,p.click()},u.src="data:image/svg+xml;base64,"+btoa(o)};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-[#1a1c23] border border-indigo-500/30 w-full max-w-sm rounded-3xl p-8 shadow-2xl animate-fade-in pointer-events-auto",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white p-2 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white mb-2",children:"Share The Forge"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Scan this code to join ",n,"'s Pod and start brewing together."]})]}),s.jsx("div",{className:"bg-white p-4 rounded-3xl inline-block shadow-inner mx-auto",children:s.jsx(Nw,{id:"qr-gen",value:r,size:200,level:"H",includeMargin:!0,imageSettings:{src:"/logo.png",x:void 0,y:void 0,height:40,width:40,excavate:!0}})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:i,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all shadow-lg flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download QR Code"]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:"Supports iOS & Android Camera Apps"})]})]})]})]})},w4e=()=>{const{user:t,userProfile:e}=Sr(),[r,n]=b.useState([]),[i,a]=b.useState(!0),[o,l]=b.useState(null),[c,u]=b.useState(""),[f,p]=b.useState("pod"),[x,m]=b.useState(!1),[y,v]=b.useState(null),[j,N]=b.useState(!1),C=`https://mtg-forge.com/?ref=${e?.username||t.uid}`,[A,L]=b.useState(null),[O,F]=b.useState(!1),[T,I]=b.useState(!1),[B,$]=b.useState(!1),k=async()=>{a(!0);try{const ee=await wa.fetchRelationships();n(ee)}catch(ee){console.error(ee),l("Failed to load connections.")}finally{a(!1)}};b.useEffect(()=>{k()},[]);const R=async ee=>{if(ee.preventDefault(),!e?.username){$(!0);return}m(!0),v(null);try{await wa.sendRequest(c,f),v({type:"success",text:`Invite sent to ${c}!`}),u(""),k()}catch(se){v({type:"error",text:se.response?.data?.error||"Failed to send request."})}finally{m(!1)}},P=async(ee,se)=>{if(!e?.username){$(!0);return}try{await wa.respondToRequest(ee,se),k()}catch(J){console.error(J),l("Failed to update request.")}},q=r.filter(ee=>ee.status==="pending"),X=q.filter(ee=>ee.direction==="incoming"),G=q.filter(ee=>ee.direction==="outgoing"),ne=r.filter(ee=>ee.status==="accepted");return s.jsxs("div",{className:"space-y-8 animate-fade-in relative z-0",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 border-b border-gray-800 pb-6 relative",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 mb-2",children:"My Pod"}),s.jsx("p",{className:"text-gray-400 text-sm max-w-xl leading-relaxed",children:"Connect with trusted friends to view their decks, share collections, and collaborate on brews."})]}),s.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors text-sm font-bold bg-indigo-900/20 hover:bg-indigo-900/40 px-4 py-2 rounded-lg border border-indigo-500/30",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"How it Works"]})]}),i?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):ne.length===0&&X.length===0&&G.length===0?s.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-gray-800 p-8 md:p-12 text-center animate-fade-in-up shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),s.jsxs("div",{className:"max-w-md mx-auto relative z-10",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 text-indigo-400 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl ring-1 ring-inset ring-indigo-500/20",children:s.jsx("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("h2",{className:"text-2xl font-black text-white mb-3",children:"Start Your Pod"}),s.jsx("p",{className:"text-gray-400 mb-8 leading-relaxed",children:"Magic is better with friends. Invite someone to your Pod to start sharing decks and combining collections."}),s.jsxs("form",{onSubmit:R,className:"space-y-6",children:[s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl max-w-xs mx-auto",children:[s.jsx("button",{type:"button",onClick:()=>p("pod"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${f==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod Invite"}),s.jsx("button",{type:"button",onClick:()=>p("friend"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${f==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Social Friend"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"email",required:!0,placeholder:"Enter friend's email address...",value:c,onChange:ee=>u(ee.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-5 py-4 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-center placeholder-gray-600 shadow-inner"}),s.jsx("button",{type:"submit",disabled:x,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg shadow-indigo-900/20 transform hover:-translate-y-1",children:x?"Sending Invite...":f==="pod"?"Send Pod Invitation":"Send Friend Invite"})]}),y&&s.jsx("div",{className:`text-sm font-medium mt-2 ${y.type==="success"?"text-green-400":"text-red-400"}`,children:y.text})]})]})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsxs("div",{className:"bg-gray-900/30 rounded-3xl border border-gray-800 p-8 shadow-xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-2 rounded-lg shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Active Connections"]}),ne.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ne.map(ee=>s.jsxs("div",{className:"relative group bg-gray-800/40 p-5 rounded-2xl border border-gray-700/50 hover:border-indigo-500/50 transition-all duration-300 hover:bg-gray-800/60 hover:shadow-xl hover:shadow-indigo-900/10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center text-white font-black text-2xl shadow-lg ring-2 ring-gray-900",children:ee.friend.username?.[0]?.toUpperCase()||"?"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-lg truncate group-hover:text-indigo-300 transition-colors uppercase",children:ee.friend.username}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-[10px] uppercase tracking-widest font-black px-2 py-0.5 rounded ${ee.type==="friend"?"bg-purple-900/30 text-purple-400 border border-purple-800/50":"bg-indigo-900/30 text-indigo-400 border border-indigo-800/50"}`,children:ee.type==="friend"?"Friend":"Pod"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:ee.type==="friend"?"Social Connect":"Full Access"})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{L(ee),F(!0)},className:"flex-1 bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white py-2 rounded-lg text-xs font-bold transition-colors uppercase tracking-wider border border-white/5",children:"Manage"}),s.jsx("button",{onClick:async()=>{if(window.confirm(`Are you sure you want to remove ${ee.friend.username} from your Pod?`))try{await wa.deleteRelationship(ee.id),n(se=>se.filter(J=>J.id!==ee.id))}catch(se){console.error(se),alert("Failed to remove")}},className:"px-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 rounded-lg transition-colors border border-red-500/10",title:"Remove Connection",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},ee.id))}):s.jsx("div",{className:"text-center py-12 text-gray-500 italic opacity-50",children:"No active connections. Check your pending requests!"})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Add to Pod"}),s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl mb-4",children:[s.jsx("button",{type:"button",onClick:()=>p("pod"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${f==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod"}),s.jsx("button",{type:"button",onClick:()=>p("friend"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${f==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Friend"})]}),s.jsxs("form",{onSubmit:R,className:"space-y-3",children:[s.jsx("input",{type:"email",required:!0,placeholder:"friend@example.com",value:c,onChange:ee=>u(ee.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-4 py-3 rounded-xl focus:outline-none focus:border-indigo-500 text-sm transition-all"}),s.jsxs("button",{type:"submit",disabled:x,className:`w-full ${f==="friend"?"bg-purple-600 hover:bg-purple-500":"bg-indigo-600 hover:bg-indigo-500"} text-white font-bold py-3 px-4 rounded-xl transition-all shadow-lg text-sm flex items-center justify-center gap-2`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Invite ",f==="pod"?"to Pod":"as Friend"]}),y&&s.jsx("div",{className:`text-xs text-center ${y.type==="success"?"text-green-400":"text-red-400"}`,children:y.text})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/10 to-purple-900/10 rounded-2xl border border-indigo-500/20 p-6 space-y-4",children:[s.jsx("h3",{className:"text-sm font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 uppercase tracking-wider mb-2",children:"Referral & Sharing"}),s.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Spread the word about MTG Forge. Anyone who joins using your unique link will be automatically connected as a Social Friend."}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded-xl p-3 flex items-center gap-2",children:[s.jsxs("span",{className:"text-[10px] text-indigo-400 font-mono truncate flex-1 leading-none select-all pt-1",children:["https://mtg-forge.com/?ref=$",e?.username||t.uid]}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://mtg-forge.com/?ref=${e?.username||t.uid}`),alert("Referral link copied!")},className:"p-1.5 hover:bg-indigo-500/20 text-indigo-400 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>window.open(`mailto:?subject=Join me on MTG Forge&body=Hey, I've been using this awesome MTG collection manager and deck builder. Check it out: https://mtg-forge.com/?ref=${e?.username||t.uid}`),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),s.jsxs("button",{onClick:()=>N(!0),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1l-3 3h2v5h2V8h2l-3-3V4h-2zm-6 8v1h12v-1H6zm0 3v1h12v-1H6z"})}),"QR Code"]})]})]})]}),s.jsx(v4e,{isOpen:j,onClose:()=>N(!1),referralUrl:C,username:e?.username||"Hunter"}),X.length>0&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/30 to-purple-900/30 rounded-2xl border border-indigo-500/30 p-6 animate-pulse-border",children:[s.jsxs("h3",{className:"text-sm font-bold text-indigo-300 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsxs("span",{className:"relative flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-indigo-500"})]}),"Pending Requests"]}),s.jsx("div",{className:"space-y-3",children:X.map(ee=>s.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-indigo-500/20 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:ee.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-sm truncate",children:ee.friend.username}),s.jsx("div",{className:"text-xs text-indigo-300 truncate",children:"wants to join your Pod"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>P(ee.id,"accepted"),className:"flex-1 bg-indigo-500 hover:bg-indigo-400 text-white text-xs font-bold py-2 rounded-lg transition-colors shadow-md",children:"Accept"}),s.jsx("button",{onClick:()=>P(ee.id,"blocked"),className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-400 text-xs font-bold py-2 rounded-lg transition-colors border border-gray-700",children:"Decline"})]})]},ee.id))})]}),G.length>0&&s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6 opacity-60 hover:opacity-100 transition-opacity",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Pending Invites"}),s.jsx("div",{className:"space-y-3",children:G.map(ee=>s.jsxs("div",{className:"flex items-center gap-3 text-sm bg-gray-900 p-3 rounded-lg border border-gray-800",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 animate-pulse"}),s.jsx("span",{className:"text-gray-300 truncate flex-1",children:ee.friend.email})]},ee.id))})]})]})]}),s.jsx(b4e,{isOpen:O,onClose:()=>F(!1),connection:A,currentUser:t}),s.jsx(y4e,{isOpen:B,onClose:()=>$(!1),onSuccess:()=>{}}),s.jsx(OW,{isOpen:T,onClose:()=>I(!1)})]})},j4e=({isOpen:t,onClose:e,onConfirm:r,user:n})=>{const[i,a]=b.useState(Jt.FREE);if(b.useEffect(()=>{t&&n&&a(n.override_tier||n.subscription_tier||Jt.FREE)},[t,n]),!t||!n)return null;const o=Cs[i],l=i===Jt.FREE;o.prices;const u={[Jt.FREE]:{m:"$0",b:"$0",y:"$0"},[Jt.TIER_1]:{m:"$2.99",b:"$14.99",y:"$29.99"},[Jt.TIER_2]:{m:"$4.99",b:"$24.99",y:"$49.99"},[Jt.TIER_3]:{m:"$9.99",b:"$49.99",y:"$99.99"},[Jt.TIER_4]:{m:"$14.99",b:"$74.99",y:"$149.99"},[Jt.TIER_5]:{m:"$19.99",b:"$99.99",y:"$199.99"}}[i]||{m:"-",b:"-",y:"-"};return s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-purple-500/30 rounded-xl p-6 max-w-lg w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Override Subscription"}),s.jsxs("p",{className:"text-gray-400 text-sm mb-6",children:["Manually set the subscription tier for ",s.jsx("span",{className:"text-white font-bold",children:n.username}),". This will bypass Stripe billing."]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Select Tier"}),s.jsx("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-500",value:i,onChange:f=>a(f.target.value),children:Object.values(Jt).map(f=>s.jsxs("option",{value:f,children:[Cs[f].name," (",f.replace("tier_","Tier "),")"]},f))})]}),!l&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[s.jsx("h4",{className:"text-red-400 font-bold text-sm mb-2",children:" Potential Revenue Loss"}),s.jsxs("p",{className:"text-gray-400 text-xs mb-3",children:["By overriding this user to ",s.jsx("strong",{children:o.name}),", you are bypassing the following billing options:"]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Monthly"}),s.jsx("div",{className:"text-white font-mono",children:u.m})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"6 Months"}),s.jsx("div",{className:"text-white font-mono",children:u.b})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Yearly"}),s.jsx("div",{className:"text-white font-mono",children:u.y})]})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[n.override_tier&&s.jsx("button",{onClick:()=>r(null),className:"mr-auto px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold border border-red-500/30 transition-colors",children:"Remove Override"}),s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:()=>r(i),className:"px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-500 text-white font-bold shadow-lg",children:"Apply Override"})]})]})})},N4e=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",creating:o})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-300 mb-6",children:i}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:e,disabled:o,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:o,className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-bold shadow-lg disabled:opacity-50 flex items-center gap-2",children:[o&&s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})]})]})}):null,k4e=()=>{const{userProfile:t}=Sr(),[e,r]=b.useState("sync"),[n,i]=b.useState([]),[a,o]=b.useState(""),[l,c]=b.useState([]),[u,f]=b.useState(!1),p=Ke.useRef(!1),[x,m]=b.useState({current:0,total:0}),[y,v]=b.useState({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),[j,N]=b.useState({updatePrices:!0,updateInfo:!0}),[C,A]=b.useState(null),[L,O]=b.useState([]),[F,T]=b.useState(!1),[I,B]=b.useState([]),[$,k]=b.useState(!1);b.useEffect(()=>{R();const Be=localStorage.getItem("admin_last_sync");if(Be)try{A(JSON.parse(Be))}catch(Lt){console.error(Lt)}},[]),b.useEffect(()=>{e==="permissions"?P():e==="referrals"&&q()},[e]);const R=async()=>{try{const Be=await Ze.get("/api/admin/sets");i(Be.data||[])}catch(Be){console.error(Be)}},P=async()=>{T(!0);try{const Be=await Ze.getUsers();Be.sort((Lt,Ft)=>(Ft.settings?.isAdmin?1:0)-(Lt.settings?.isAdmin?1:0)||Lt.id-Ft.id),O(Be)}catch(Be){console.error(Be)}finally{T(!1)}},q=async()=>{k(!0);try{const Be=await Ze.get("/api/admin/invitations");B(Be)}catch(Be){console.error(Be)}finally{k(!1)}},X=async Be=>{if(window.confirm("Are you sure you want to reset this invitation? This will delete the pending record."))try{await Ze.delete(`/api/admin/invitations/${Be}`),q()}catch{alert("Failed to reset invitation")}},G=Be=>c(Lt=>[...Lt,`${new Date().toLocaleTimeString()} - ${Be}`]),ne=(Be,Lt)=>{v(Ft=>{const Ee={...Ft};return Ee.totalCards+=Be,Lt&&Object.keys(Lt).forEach(He=>Ee.types[He]=(Ee.types[He]||0)+(Lt[He]||0)),Ee})},ee=Be=>{const Lt={date:new Date().toISOString(),stats:Be};A(Lt),localStorage.setItem("admin_last_sync",JSON.stringify(Lt))},se=async(Be,Lt=!1)=>{if(Be)try{G(`Starting sync for ${Be}...`);const Ee=await(await fetch("/api/admin/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({setCode:Be,...j})})).json();Ee.success?(G(`Success: ${Be}. Processed ${Ee.count} cards.`),ne(Ee.count,Ee.typeStats),Lt&&m(He=>({...He,current:He.current+1}))):G(`Error: ${Ee.error}`)}catch(Ft){G(`Request Failed: ${Ft.message}`)}},J=()=>{window.confirm("Cancel sync?")&&(p.current=!0,G("Cancelling..."))},W=async()=>{if(window.confirm("Sync ALL sets?")){f(!0),p.current=!1,G("Starting Mass Sync..."),v({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),m({current:0,total:n.length});for(const Be of n){if(p.current)break;await se(Be.code,!0)}G("Mass Sync Complete!"),ee(y),f(!1)}},U=async()=>{a&&(f(!0),v({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),await se(a),f(!1))},Y=async Be=>{const Lt=Be.target.files[0];if(!Lt||!window.confirm(`Upload ${Lt.name}?`))return;const Ft=new FormData;Ft.append("file",Lt);try{const He=await(await fetch("/api/admin/precons/upload",{method:"POST",body:Ft})).json();He.success?alert(`Uploaded ${He.name}`):alert(`Error: ${He.error}`)}catch{alert("Upload failed")}Be.target.value=null},te=async(Be,Lt)=>{try{const Ft=Be.settings?.permissions||[],Ee=Ft.includes(Lt);let He;Ee?He=Ft.filter(Mt=>Mt!==Lt):He=[...Ft,Lt],O(L.map(Mt=>Mt.id===Be.id?{...Mt,settings:{...Mt.settings,permissions:He}}:Mt)),await Ze.updateUserPermissions(Be.id,He,Be.settings?.isAdmin)}catch{alert("Failed to update permission"),P()}},ce=async Be=>{if(window.confirm(`Are you sure you want to toggle ADMIN status for ${Be.username}?`))try{const Lt=!Be.settings?.isAdmin;O(L.map(Ft=>Ft.id===Be.id?{...Ft,settings:{...Ft.settings,isAdmin:Lt}}:Ft)),await Ze.updateUserPermissions(Be.id,Be.settings?.permissions,Lt)}catch{alert("Failed to update admin status"),P()}},[xe,ue]=b.useState(!1),[ve,Q]=b.useState(null),pe=Be=>{Q(Be),ue(!0)},Ce=async Be=>{if(ve)try{const Lt=Be||"free";O(L.map(Ee=>Ee.id===ve.id?{...Ee,override_tier:Be,subscription_tier:Lt}:Ee));const Ft={user_override_tier:Be,subscription_status:Be?"active":"canceled"};Ft.subscription_tier=Lt,await Ze.updateUserPermissions(ve.id,ve.settings?.permissions,ve.settings?.isAdmin,Ft),ue(!1),Q(null)}catch(Lt){alert(Lt.message||"Failed to update subscription"),P()}},[je,we]=b.useState([]),[Te,oe]=b.useState({title:"",description:"",status:"open"}),[De,Nt]=b.useState(null),[ot,Ne]=b.useState(!1),[Ge,Xe]=b.useState({start:vi(new Date(Date.now()-10080*60*1e3),"yyyy-MM-dd"),end:vi(new Date,"yyyy-MM-dd")}),[xt,Ae]=b.useState([]),[Pe,ct]=b.useState(!1),[bt,dt]=b.useState(""),[Ve,lt]=b.useState(!1),[kt,Ue]=b.useState(!1),[Bt,zt]=b.useState(""),[Ot,Et]=b.useState(!1);b.useEffect(()=>{e==="epics"&&$t()},[e]);const $t=async()=>{Ne(!0);try{const Be=await Ze.getEpics();we(Be||[])}catch(Be){console.error(Be)}finally{Ne(!1)}},At=async Be=>{Be.preventDefault();try{await Ze.createEpic(Te),oe({title:"",description:"",status:"open"}),$t(),alert("Epic created successfully!")}catch(Lt){alert("Failed to create epic: "+Lt.message)}},Xt=async Be=>{if(Be.preventDefault(),!!De)try{await Ze.updateEpic(De.id,De),Nt(null),$t(),alert("Epic updated successfully!")}catch(Lt){alert("Failed to update epic: "+Lt.message)}},qt=async Be=>{if(window.confirm("Delete this epic? This will NOT delete associated tickets but will unlink them."))try{await Ze.deleteEpic(Be),$t()}catch(Lt){alert("Failed to delete epic: "+Lt.message)}},Ht=Be=>{const Lt={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},Ft={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Pend. Release",complete_scheduled:"Rel. Sched.",complete_blocked:"Blocked",wont_fix:"Won't Fix"};return s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-bold tracking-wider border ${Lt[Be]||Lt.open}`,children:Ft[Be]||Be})},jr=async()=>{ct(!0);try{const Be=await Ze.getTicketReport({startDate:Ge.start,endDate:Ge.end,excludeReleased:!0,status:""});Ae(Be)}catch(Be){alert("Failed to fetch report: "+Be.message)}finally{ct(!1)}},Ct=async()=>{if(!t?.settings?.geminiApiKey){alert("Missing Gemini API Key. Please add it in Settings > AI.");return}lt(!0);try{const Be=await yo.generateReleaseNotes(t.settings.geminiApiKey,xt);dt(Be),zt(`v${new Date().toISOString().slice(0,10).replace(/-/g,".")}`)}catch(Be){alert("Failed to generate release notes: "+Be.message)}finally{lt(!1)}},Tt=()=>{if(!Bt)return alert("Please enter a version number (e.g. v1.2.0)");if(!bt)return alert("No notes generated");Et(!0)},Yt=async()=>{Ue(!0);try{const Be={features:xt.filter(Lt=>Lt.type==="feature").length,bugs:xt.filter(Lt=>Lt.type==="bug").length,total:xt.length};await Ze.publishRelease({version:Bt,notes:bt,ticketIds:xt.map(Lt=>Lt.id),typeStats:Be}),Et(!1),dt(""),Ae([]),alert("Release Published Successfully!")}catch(Be){alert("Failed to publish: "+Be.message),Et(!1)}finally{Ue(!1)}};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx(N4e,{isOpen:Ot,onClose:()=>Et(!1),onConfirm:Yt,title:`Publish Release ${Bt}?`,message:`This will move ${xt.length} tickets to the "Released" status and they will no longer appear on the active board. Are you sure?`,confirmText:kt?"Publishing...":"Confirm Publish",creating:kt}),s.jsx(j4e,{isOpen:xe,onClose:()=>ue(!1),onConfirm:Ce,user:ve}),s.jsxs("div",{className:"flex border-b border-gray-700 mb-6 overflow-x-auto",children:[s.jsx("button",{onClick:()=>r("sync"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="sync"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"DB Sync & Tools"}),s.jsx("button",{onClick:()=>r("permissions"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="permissions"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"User Permissions"}),s.jsx("button",{onClick:()=>r("epics"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="epics"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Epics / Projects"}),s.jsx("button",{onClick:()=>r("release"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="release"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Release Notes"}),s.jsx("button",{onClick:()=>r("referrals"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="referrals"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Referrals"})]}),e==="sync"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Scryfall Sync"}),C&&s.jsxs("div",{className:"text-right text-xs text-gray-400",children:[s.jsxs("p",{children:["Last: ",new Date(C.date).toLocaleString()]}),s.jsxs("p",{children:[C.stats.totalCards," cards"]})]})]}),s.jsxs("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Upload Precon JSON"}),s.jsx("input",{type:"file",accept:".json",onChange:Y,className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-indigo-900/40 p-4 rounded-lg border border-indigo-700/50",children:[s.jsx("p",{className:"text-xs text-indigo-300 uppercase font-bold",children:"Total Cards"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:y.totalCards})]}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700",children:[s.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Progress"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:x.total>0?`${x.current} / ${x.total}`:"-"}),x.total>0&&s.jsx("div",{className:"w-full bg-gray-700 h-1.5 mt-2 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${x.current/x.total*100}%`}})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-lg border border-gray-700/50 flex flex-wrap gap-6 items-center",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:j.updatePrices,onChange:Be=>N(Lt=>({...Lt,updatePrices:Be.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Prices"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:j.updateInfo,onChange:Be=>N(Lt=>({...Lt,updateInfo:Be.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Card Info"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Single Set"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white flex-1 min-w-0 max-w-full",value:a,onChange:Be=>o(Be.target.value),children:[s.jsx("option",{value:"",children:"Select Set..."}),n.map(Be=>s.jsxs("option",{value:Be.code,className:"truncate",children:[Be.name," (",Be.code.toUpperCase(),")"]},Be.code))]}),s.jsx("button",{onClick:U,disabled:u||!a,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg",children:u?"...":"Sync"})]})]}),s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Mass Sync"}),u?s.jsx("button",{onClick:J,className:"bg-red-600 text-white px-6 py-3 rounded-lg w-full font-bold animate-pulse",children:"CANCEL"}):s.jsx("button",{onClick:W,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold",children:"SYNC ALL"})]})]}),s.jsx("div",{className:"bg-black/50 p-4 rounded-lg font-mono text-xs text-green-400 h-64 overflow-y-auto border border-white/10",children:l.map((Be,Lt)=>s.jsx("div",{children:Be},Lt))})]})]}),e==="permissions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"User Permissions Manager"}),F?s.jsx("p",{className:"text-gray-400",children:"Loading users..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"User"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Subscription"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Admin"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Ticket Mgr"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-800",children:L.map(Be=>{const Lt=Be.settings?.permissions?.includes("manage_tickets"),Ft=Be.settings?.isAdmin;return s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-white",children:[Be.username||"No Username",Be.id===1&&s.jsx("span",{className:"ml-2 text-[10px] bg-yellow-500 text-black px-1 rounded",children:"ROOT"})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:Be.email}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${Be.override_tier?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-gray-700 text-gray-300 border-gray-600"}`,children:(Be.override_tier||Be.subscription_tier||"free").replace("tier_","Tier ")}),s.jsx("button",{onClick:()=>pe(Be),className:"text-[10px] bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition-colors",children:"Manage"})]})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>ce(Be),className:`w-8 h-4 rounded-full transition-colors relative ${Ft?"bg-indigo-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Ft?"translate-x-4":"translate-x-0"}`})})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>te(Be,"manage_tickets"),className:`w-8 h-4 rounded-full transition-colors relative ${Lt?"bg-green-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Lt?"translate-x-4":"translate-x-0"}`})})}),s.jsxs("td",{className:"py-3 px-4 text-right text-xs text-gray-500",children:["ID: ",Be.id]})]},Be.id)})})]})})]}),e==="epics"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Manage Projects (Epics)"}),s.jsxs("div",{className:`bg-gray-800/50 p-6 rounded-xl border ${De?"border-indigo-500/50 shadow-lg shadow-indigo-500/10":"border-white/10"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:De?"Edit Project":"Create New Project"}),De&&s.jsx("button",{onClick:()=>Nt(null),className:"text-xs text-gray-400 hover:text-white underline",children:"Cancel Edit"})]}),s.jsxs("form",{onSubmit:De?Xt:At,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:De?De.title:Te.title,onChange:Be=>De?Nt({...De,title:Be.target.value}):oe({...Te,title:Be.target.value}),placeholder:"e.g. Q1 Mobile App"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-48",children:s.jsx(FS,{value:De?De.description:Te.description,onChange:Be=>De?Nt({...De,description:Be}):oe({...Te,description:Be}),placeholder:"Detailed epic goal...",type:"Epic",height:"h-40"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:De?De.status:Te.status,onChange:Be=>De?Nt({...De,status:Be.target.value}):oe({...Te,status:Be.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"}),s.jsx("option",{value:"active",className:"text-gray-500",children:"Active (Legacy)"}),s.jsx("option",{value:"archived",className:"text-gray-500",children:"Archived (Legacy)"})]})]}),s.jsx("div",{className:"flex justify-end pt-4 gap-2",children:s.jsx("button",{type:"submit",className:`px-6 py-2 font-bold rounded-lg shadow-lg transition-all text-white ${De?"bg-green-600 hover:bg-green-500":"bg-indigo-600 hover:bg-indigo-500"}`,children:De?"Save Changes":"Create Epic"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:"Existing Projects"}),ot?s.jsx("div",{className:"text-gray-500",children:"Loading..."}):s.jsxs("div",{className:"space-y-2",children:[je.map(Be=>s.jsxs("div",{className:`bg-gray-800 p-4 rounded-xl border flex justify-between items-center group transition-all ${De?.id===Be.id?"border-indigo-500 ring-1 ring-indigo-500 bg-gray-800/80":"border-white/5 hover:border-white/10"}`,children:[s.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("h4",{className:"font-bold text-white truncate",children:Be.title}),Ht(Be.status)]}),s.jsx("div",{className:"text-sm text-gray-400 prose prose-invert prose-sm max-w-none line-clamp-1",dangerouslySetInnerHTML:{__html:Be.description||""}})]}),s.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[s.jsxs("div",{className:"text-right hidden sm:block",children:[s.jsxs("span",{className:"text-xs text-gray-500 block",children:["ID: ",Be.id]}),s.jsxs("span",{className:"text-xs text-indigo-400 block",children:[Be.ticket_count||0," tickets"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{Nt(Be),window.scrollTo({top:0,behavior:"smooth"})},className:"p-2 text-gray-400 hover:text-white bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Edit",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("button",{onClick:()=>qt(Be.id),className:"p-2 text-gray-400 hover:text-red-400 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Delete",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},Be.id)),je.length===0&&s.jsx("div",{className:"text-gray-500 italic",children:"No projects found."})]})]})]}),e==="release"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Release Notes Generator"}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-white/10 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Start Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:Ge.start,onChange:Be=>Xe({...Ge,start:Be.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"End Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:Ge.end,onChange:Be=>Xe({...Ge,end:Be.target.value})})]}),s.jsx("button",{onClick:jr,disabled:Pe,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg transition-all disabled:opacity-50",children:Pe?"Fetching...":"Fetch Active Tickets"})]}),xt.length>0&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-medium text-white italic",children:["Tickets Found (",xt.length,")"]}),s.jsxs("button",{onClick:Ct,disabled:Ve,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white font-bold rounded-lg shadow-lg transition-all disabled:opacity-50",children:[" ",Ve?"Generating...":"Generate AI Release Notes"]})]}),s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 pr-2",children:xt.map(Be=>s.jsxs("div",{className:"bg-black/30 p-3 rounded-lg border border-white/5 flex gap-4 items-center",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${Be.type==="bug"?"bg-red-500/20 text-red-400":"bg-emerald-500/20 text-emerald-400"}`,children:Be.type}),s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${Be.status==="completed"?"bg-green-500/20 text-green-400":"bg-indigo-500/20 text-indigo-400"}`,children:Be.status.replace("_"," ")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-white truncate",children:Be.title}),s.jsxs("div",{className:"flex gap-2",children:[Be.epic_title&&s.jsxs("p",{className:"text-[10px] text-gray-400",children:["Project: ",Be.epic_title]}),Be.type==="bug"&&Be.created_by_username&&s.jsxs("p",{className:"text-[10px] text-indigo-400",children:["By: ",Be.created_by_username]})]})]}),s.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:vi(new Date(Be.updated_at),"MMM d")})]},Be.id))})]}),bt&&s.jsxs("div",{className:"space-y-4 pt-6 border-t border-indigo-500/30",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-medium text-indigo-400 font-black uppercase tracking-widest",children:"Release Notes Preview"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"text",placeholder:"v1.0.0",className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-1 text-white text-sm",value:Bt,onChange:Be=>zt(Be.target.value)}),s.jsx("button",{onClick:Tt,disabled:kt,className:"px-4 py-1.5 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg text-sm shadow-lg disabled:opacity-50",children:" Publish Release"}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(bt),alert("Copied to clipboard!")},className:"text-xs text-indigo-400 hover:text-white transition-colors",children:"Copy HTML"})]})]}),s.jsx("div",{className:"bg-gray-900 border border-indigo-500/20 p-6 rounded-xl prose prose-invert max-w-none shadow-2xl",dangerouslySetInnerHTML:{__html:bt}})]})]})]}),e==="referrals"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"External Invitations (Referrals)"}),s.jsx("button",{onClick:q,className:"text-xs text-indigo-400 hover:text-indigo-300 font-medium",children:"Refresh List"})]}),$?s.jsx("p",{className:"text-gray-400",children:"Loading invitations..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"Invitee Email"}),s.jsx("th",{className:"py-3 px-4",children:"Invited By"}),s.jsx("th",{className:"py-3 px-4",children:"Sent At"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsxs("tbody",{className:"text-sm divide-y divide-gray-800",children:[I.map(Be=>s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-white",children:Be.invitee_email}),s.jsxs("td",{className:"py-3 px-4 text-gray-400",children:[s.jsx("div",{children:Be.inviter_username}),s.jsx("div",{className:"text-[10px] text-gray-500",children:Be.inviter_email})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:vi(new Date(Be.created_at),"MMM dd, yyyy HH:mm")}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${Be.status==="completed"?"bg-green-500/10 text-green-400 border-green-500/20":"bg-yellow-500/10 text-yellow-400 border-yellow-500/20"}`,children:Be.status})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsx("button",{onClick:()=>X(Be.id),className:"text-red-400 hover:text-red-300 transition-colors font-medium text-xs",children:"Reset"})})]},Be.id)),I.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"py-8 text-center text-gray-500 italic",children:"No invitations found."})})]})]})})]})]})},S4e=()=>{const{userProfile:t,currentUser:e,refreshUserProfile:r}=Sr();dn();const[n,i]=b.useState(!1),[a,o]=b.useState(!1),[l,c]=b.useState("monthly"),{cards:u}=To(),{decks:f}=hf(),p=t?.override_tier||t?.subscription_tier||Jt.FREE,x=vn(p),m=t?.subscription_status||(p!==Jt.FREE?"active":"free"),y=t?.subscription_end_date?new Date(t.subscription_end_date).toLocaleDateString():null,v=b.useMemo(()=>{if(!u||!f)return{decks:0,collection:0,wishlist:0};const L=u.filter(I=>!I.is_wishlist),O=u.filter(I=>I.is_wishlist);let F=L.reduce((I,B)=>I+(B.count||1),0),T=O.reduce((I,B)=>I+(B.count||1),0);return{decks:f.length,collection:F,wishlist:T}},[u,f]),j=async()=>{i(!0);try{const L=await Ze.post("/api/payments/create-portal-session",{});L.url?window.location.href=L.url:alert("Failed to redirect to billing portal.")}catch(L){console.error("Billing portal error:",L),alert("Could not open billing portal. "+(L.response?.data?.error||L.message))}finally{i(!1)}},N=async L=>{i(!0);try{const O=await Ze.post("/api/payments/create-checkout-session",{tierId:L,interval:l,successUrl:`${window.location.origin}/settings?success=true`,cancelUrl:`${window.location.origin}/settings?canceled=true`});if(O.url)window.location.href=O.url;else throw new Error("No checkout URL returned")}catch(O){console.error("Subscription error:",O),alert(O.message||"Failed to start subscription process"),i(!1)}},C=L=>{switch(L){case Jt.FREE:return s.jsx(d0,{className:"w-12 h-12 text-gray-400"});case Jt.TIER_1:return s.jsx(Oae,{className:"w-12 h-12 text-blue-400"});case Jt.TIER_2:return s.jsx(pm,{className:"w-12 h-12 text-purple-400"});case Jt.TIER_3:return s.jsx(jx,{className:"w-12 h-12 text-yellow-400"});case Jt.TIER_4:return s.jsx(jx,{className:"w-12 h-12 text-orange-500"});case Jt.TIER_5:return s.jsx(jx,{className:"w-12 h-12 text-red-500"});default:return s.jsx(d0,{className:"w-12 h-12 text-gray-400"})}},A=(L,O,F,T)=>{const I=F===1/0?0:Math.min(O/F*100,100),B=F!==1/0&&O/F>=.9;let $="bg-green-500";return F===1/0?$="bg-blue-500":I>=90?$="bg-red-500":I>=75&&($="bg-yellow-500"),s.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-gray-300 text-sm font-medium flex items-center gap-2",children:[s.jsx("span",{children:T})," ",L]}),s.jsxs("span",{className:`font-bold text-sm ${B?"text-red-400":"text-white"}`,children:[O," / ",F===1/0?"":F]})]}),s.jsx("div",{className:"h-2 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/50",children:s.jsx("div",{className:`h-full ${$} transition-all duration-1000 ease-out`,style:{width:F===1/0?"100%":`${I}%`}})}),B&&s.jsx("p",{className:"text-[10px] text-red-400 mt-1 mt-2",children:"Running low on space!"})]})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Membership & Billing"}),s.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between relative z-10 gap-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"p-3 bg-gray-800 rounded-lg border border-gray-700 shrink-0",children:C(p)}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:x.name}),s.jsx("p",{className:"text-gray-400 text-sm max-w-md",children:x.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border ${m==="active"?"bg-green-500/10 text-green-400 border-green-500/20":m==="canceled"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/20":m==="past_due"?"bg-red-500/10 text-red-400 border-red-500/20":"bg-gray-700 text-gray-300 border-gray-600"}`,children:m==="free"?"Free Plan":m.replace("_"," ")}),t?.override_tier&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border bg-purple-500/10 text-purple-400 border-purple-500/20",children:"Admin Override"}),y&&m!=="free"&&!t?.override_tier&&s.jsxs("span",{className:"text-xs text-gray-500",children:[m==="canceled"?"Expires":"Renews"," on ",y]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:[s.jsx("button",{onClick:()=>o(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-purple-900/20 transition-all hover:scale-105 whitespace-nowrap",children:p===Jt.FREE?"Upgrade Plan":"Change Plan"}),p!==Jt.FREE&&s.jsxs("button",{onClick:j,disabled:n,className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium border border-gray-600 transition-colors text-sm",children:[s.jsx(Yie,{className:"w-4 h-4"}),n?"Loading...":"Manage Billing"]})]})]}),s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-b from-purple-500/10 to-transparent rounded-bl-full pointer-events-none"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:""})," Usage & Limits"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[A("Decks",v.decks,x.limits.decks,""),A("Collection",v.collection,x.limits.collection,""),A("Wishlist",v.wishlist,x.limits.wishlist,"")]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 text-right",children:"* Limits apply to active items. Archived/Deleted items do not count."})]}),a&&Gn.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center p-4 pt-24 text-left font-sans",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>o(!1)}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-[95vw] max-h-[85vh] overflow-y-auto shadow-2xl animate-scale-in",children:[s.jsxs("div",{className:"sticky top-0 z-20 flex justify-between items-center p-6 bg-gray-900/95 backdrop-blur border-b border-gray-800",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select a Plan"}),s.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx(Sd,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"p-6 md:p-8",children:s.jsx(OC,{billingInterval:l,setBillingInterval:c,onSubscribe:N,isLoading:n,currentTier:p})})]})]}),document.body)]})},MW=({players:t,logs:e})=>{const r=b.useMemo(()=>{if(!e||e.length===0)return null;const C=Math.max(...e.map(k=>k.metadata?.turn||k.turn||0),0)+1,A=["#6366f1","#ec4899","#22c55e","#eab308","#ef4444","#3b82f6"],L={};t.forEach((k,R)=>{L[k.id]=A[R%A.length]});const O={0:{}};t.forEach(k=>O[0][k.id]=40);let F={};t.forEach(k=>F[k.id]=40),[...e].sort((k,R)=>new Date(k.created_at||k.timestamp)-new Date(R.created_at||R.timestamp)).forEach(k=>{if(k.type==="life"||k.action_type==="life"){const P=k.playerId||k.actor_participant_id;if(P){const q=k.currentLife??k.metadata?.currentLife;q!==void 0?F[P]=q:F[P]=(F[P]||40)+(k.change||k.value||0)}}const R=k.turn||k.metadata?.turn||1;O[R]||(O[R]={}),t.forEach(P=>{O[R][P.id]=F[P.id]})});const I={};t.forEach(k=>I[k.id]=[]);let B=0,$=45;return Object.keys(O).forEach(k=>{const R=parseInt(k);t.forEach(P=>{let q=O[R][P.id];q!==void 0&&(I[P.id].push({x:R,y:q}),q>$&&($=q),q<B&&(B=q))})}),t.forEach(k=>{const R=I[k.id];R.length===0&&R.push({x:0,y:40}),R[R.length-1].x<C&&R.push({x:C,y:F[k.id]});const q=F[k.id];q>$&&($=q),q<B&&(B=q)}),{playerPoints:I,minLife:B,maxLife:$,maxTurn:C,playerColorMap:L,finalLife:F}},[t,e]);if(!r)return null;const{playerPoints:n,minLife:i,maxLife:a,maxTurn:o,playerColorMap:l,finalLife:c}=r,u=300,f=150,p={top:10,right:10,bottom:20,left:25},x=u-p.left-p.right,m=f-p.top-p.bottom,y=C=>p.left+C/(o-1||1)*x,v=C=>{const A=a-i||1;return p.top+m-(C-i)/A*m},j=Array.from({length:o},(C,A)=>A),N=(()=>{const C=[],L=a-i>20?10:5;for(let O=Math.ceil(i/L)*L;O<=a;O+=L)C.push(O);return C.includes(i)||C.unshift(i),C.includes(a)||C.push(a),[...new Set(C)].sort((O,F)=>O-F)})();return s.jsxs("div",{className:"w-full h-full flex flex-col relative",children:[s.jsx("div",{className:"flex flex-wrap gap-3 absolute top-2 right-2 z-10 pointer-events-none",children:t.map(C=>s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-white/10 shadow-sm",children:[s.jsx("div",{className:"w-2 h-2 rounded-full shadow-[0_0_5px]",style:{backgroundColor:l[C.id],boxShadow:`0 0 5px ${l[C.id]}`}}),s.jsxs("span",{className:"text-[10px] text-gray-200 font-bold leading-none",children:[C.name,": ",s.jsx("span",{className:"text-white",children:c[C.id]??"?"})]})]},C.id))}),s.jsxs("svg",{viewBox:`0 0 ${u} ${f}`,className:"w-full h-full overflow-visible font-mono select-none",children:[s.jsxs("g",{className:"opacity-20",children:[N.map(C=>s.jsx("line",{x1:p.left,y1:v(C),x2:u-p.right,y2:v(C),stroke:"currentColor",strokeWidth:"0.5",strokeDasharray:"2",className:"text-gray-500"},`y-${C}`)),j.map(C=>s.jsx("line",{x1:y(C),y1:p.top,x2:y(C),y2:f-p.bottom,stroke:"currentColor",strokeWidth:"0.5",className:"text-gray-500"},`x-${C}`))]}),s.jsxs("g",{className:"text-[8px] fill-gray-500 font-medium",children:[N.map(C=>s.jsx("text",{x:p.left-4,y:v(C),dy:"0.3em",textAnchor:"end",children:C},`yl-${C}`)),j.map(C=>s.jsx("text",{x:y(C),y:f-p.bottom+10,textAnchor:"middle",children:C},`xl-${C}`))]}),t.map(C=>{const A=n[C.id];if(!A||A.length===0)return null;const L=A.map((O,F)=>`${F===0?"M":"L"} ${y(O.x)} ${v(O.y)}`).join(" ");return s.jsxs("g",{children:[s.jsx("path",{d:L,fill:"none",stroke:l[C.id],strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"drop-shadow-md vector-effect-non-scaling-stroke"}),A.map((O,F)=>s.jsx("circle",{cx:y(O.x),cy:v(O.y),r:"1.5",fill:l[C.id],stroke:"black",strokeWidth:"0.5"},F))]},C.id)})]})]})},ek=({label:t,value:e,subtext:r,icon:n,color:i="text-gray-400"})=>s.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:t}),s.jsx("div",{className:"text-2xl font-black text-white",children:e}),r&&s.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:r})]}),n&&s.jsx(n,{className:`w-8 h-8 opacity-20 ${i}`})]}),_4e=({isOpen:t,onClose:e,match:r,logs:n})=>{if(!t||!r)return null;const i=b.useMemo(()=>{if(!n||n.length===0)return null;const o=r.my_participant_id;let l=0,c=0;const u={poison:0,energy:0,experience:0},f={};n.forEach(m=>{const y=m.metadata?.turn||0;if(y>c&&(c=y),m.action_type==="life"&&(m.actor_participant_id===o||m.playerId===o)){const v=m.value||m.change;if(v<0){const j=Math.abs(v);l+=j,f[y]=(f[y]||0)+j}}m.action_type==="counter"&&(m.actor_participant_id===o||m.playerId===o)&&u[m.counterType]!==void 0&&(u[m.counterType]=m.newValue)});const p=c>0?(l/c).toFixed(1):"0.0",x=Math.max(0,...Object.values(f));return{avgDamageTaken:p,maxDamageInTurn:x,turns:c,finalResources:u}},[r,n]),a=[{id:r.my_participant_id,name:"Me"},...(r.opponents||[]).map(o=>({id:o.participant_id,name:o.name}))];return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-200",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl h-[90vh] shadow-2xl overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-gradient-to-r from-gray-900 to-indigo-950/30",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center gap-3",children:[s.jsx(X3,{className:"w-6 h-6 text-indigo-500"}),"Match Report"]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-gray-400 mt-2",children:[s.jsx("span",{children:vi(new Date(r.ended_at),"PPP p")}),s.jsx("span",{className:"w-1 h-1 bg-gray-600 rounded-full"}),s.jsx("span",{children:r.duration_seconds?`${Math.floor(r.duration_seconds/60)}m`:"Unknown duration"})]})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx(Sd,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[s.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/5 p-6 min-h-[400px] flex flex-col relative",children:[s.jsx("div",{className:"absolute top-4 left-4 z-10",children:s.jsx("h3",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:"Life History"})}),!n||n.length===0?s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 italic",children:"No combat data available"}):s.jsx(MW,{players:a,logs:n})]}),i&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(ek,{label:"Avg Dmg Taken / Turn",value:i.avgDamageTaken,icon:d0,color:"text-red-500"}),s.jsx(ek,{label:"Most Dmg / Turn",value:i.maxDamageInTurn,icon:X1,color:"text-orange-500"}),s.jsx(ek,{label:"Turns Played",value:i.turns,icon:X3,color:"text-blue-500"}),s.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[s.jsx("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"My Resources"}),s.jsxs("div",{className:"flex items-center gap-3",children:[i.finalResources.poison>0&&s.jsxs("div",{className:"flex items-center gap-1 text-green-500",title:"Poison",children:[s.jsx(X1,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.poison})]}),i.finalResources.energy>0&&s.jsxs("div",{className:"flex items-center gap-1 text-yellow-400",title:"Energy",children:[s.jsx(pm,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.energy})]}),i.finalResources.experience>0&&s.jsxs("div",{className:"flex items-center gap-1 text-blue-400",title:"Experience",children:[s.jsx(I6,{className:"w-4 h-4"})," ",s.jsx("span",{className:"font-bold",children:i.finalResources.experience})]}),!i.finalResources.poison&&!i.finalResources.energy&&!i.finalResources.experience&&s.jsx("span",{className:"text-gray-500 text-xs italic",children:"None recorded"})]})]})]})]})]})})},C4e=()=>{const{userProfile:t}=Sr(),[e,r]=b.useState([]),[n,i]=b.useState(!0),[a,o]=b.useState(null),[l,c]=b.useState({}),[u,f]=b.useState(!1),[p,x]=b.useState(null);b.useEffect(()=>{t?.id&&m()},[t]);const m=async()=>{try{i(!0);const L=await Ze.get(`/api/matches/user/${t.id}`);r(L||[])}catch(L){console.error("Failed to load match history:",L),o("Failed to load match history.")}finally{i(!1)}},y=async L=>{if(window.confirm("Are you sure you want to delete this match record?"))try{await Ze.delete(`/api/matches/${L}`),r(O=>O.filter(F=>F.match_id!==L))}catch(O){console.error(O),alert("Failed to delete match")}},v=async()=>{if(window.confirm("Are you sure you want to clear ALL match history? This cannot be undone."))try{await Ze.delete(`/api/matches/user/${t.id}`),r([])}catch(L){console.error(L),alert("Failed to clear history")}},j=async L=>{const O=L.match_id;if(x(L),!l[O]){f(!0);try{const F=await Ze.get(`/api/matches/${O}/logs`);c(T=>({...T,[O]:F}))}catch(F){console.error("Failed to fetch logs:",F)}finally{f(!1)}}};if(n)return s.jsx("div",{className:"flex justify-center p-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})});if(a)return s.jsx("div",{className:"text-center p-8 text-red-400 bg-red-900/10 rounded-xl border border-red-500/20",children:a});if(e.length===0)return s.jsxs("div",{className:"text-center p-12 bg-gray-900 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"bg-gray-800 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ga,{className:"w-8 h-8 text-gray-600"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Matches Yet"}),s.jsx("p",{className:"text-gray-400",children:"Join a Live Session to track your games!"})]});const N=e.length,C=e.filter(L=>L.placement===1).length,A=Math.round(C/N*100);return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Games"}),s.jsx("div",{className:"text-3xl font-black text-white",children:N})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Wins"}),s.jsx("div",{className:"text-3xl font-black text-indigo-400",children:C})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Win Rate"}),s.jsxs("div",{className:"text-3xl font-black text-green-400",children:[A,"%"]})]}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Recent Activity"}),s.jsx("div",{className:"text-sm font-medium text-gray-300 mt-1",children:e[0]?vi(new Date(e[0].ended_at),"MMM d"):"-"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Recent Matches"}),e.length>0&&s.jsxs("button",{onClick:v,className:"text-red-400 hover:text-red-300 text-xs font-bold uppercase tracking-wider flex items-center gap-2 px-3 py-2 hover:bg-red-500/10 rounded transition-colors",children:[s.jsx(VF,{className:"w-4 h-4"}),"Clear History"]})]}),s.jsx("div",{className:"grid gap-3",children:e.map(L=>{const O=L.placement===1,F=new Date(L.ended_at),T=Math.floor((new Date(L.ended_at)-new Date(L.started_at))/1e3/60);return[L.my_participant_id,...(L.opponents||[]).map(I=>({id:I.participant_id,name:I.name}))],s.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden group",children:s.jsxs("div",{className:"p-4 flex flex-col md:flex-row items-start md:items-center gap-4 hover:bg-gray-750 transition-colors",children:[s.jsx("div",{className:`shrink-0 w-12 h-12 rounded-lg flex items-center justify-center border ${O?"bg-yellow-500/10 border-yellow-500/30 text-yellow-500":"bg-gray-700/50 border-gray-600 text-gray-400"}`,children:O?s.jsx(Ga,{className:"w-6 h-6"}):s.jsxs("span",{className:"text-lg font-bold",children:["#",L.placement]})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex flex-col gap-1 mb-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Me:"}),s.jsx("h4",{className:"font-bold text-white truncate max-w-[200px]",children:L.deck_name||"Generic Deck"}),L.deck_commander&&s.jsx("span",{className:"text-[10px] bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/30 truncate max-w-[150px]",children:typeof L.deck_commander=="object"?L.deck_commander.name:L.deck_commander})]}),L.opponents?.length>0&&s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-1",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"VS:"}),L.opponents.map((I,B)=>s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/20 px-2 py-1 rounded",children:[s.jsx(Q3,{className:"w-3 h-3 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-300",children:I.name}),s.jsx("span",{className:"text-xs text-gray-500 border-l border-gray-700 pl-1.5 ml-0.5",children:I.deck_name||"Generic"}),I.commander&&s.jsxs("span",{className:"text-[10px] text-gray-600 truncate max-w-[80px]",children:["(",typeof I.commander=="object"?I.commander.name:I.commander,")"]})]},B))]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-400 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(UF,{className:"w-3 h-3"}),vi(F,"MMM d, h:mm a")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(qF,{className:"w-3 h-3"}),T," min"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>j(L),className:"p-2 text-indigo-400 hover:text-white bg-indigo-500/10 hover:bg-indigo-500 rounded-lg transition-colors flex items-center gap-2 border border-indigo-500/20",children:[s.jsx($ie,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Report"})]}),s.jsx("button",{onClick:()=>y(L.match_id),className:"p-2 text-gray-600 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete Record",children:s.jsx(Wie,{className:"w-5 h-5"})})]})]})},L.match_id)})})]}),s.jsx(_4e,{isOpen:!!p,onClose:()=>x(null),match:p,logs:p?l[p.match_id]:[]})]})},A4e=()=>{const{user:t,userProfile:e,refreshUserProfile:r,resetPassword:n,sendVerification:i,updateProfileFields:a}=Sr(),{tab:o}=Eo(),l=dn(),c=o||"account",[u,f]=b.useState(!1),[p,x]=b.useState(!1),[m,y]=b.useState(!1),[v,j]=b.useState(!1),[N,C]=b.useState(!1),[A,L]=b.useState(!1),[O,F]=b.useState(null),[T,I]=b.useState(!1),[B,$]=b.useState(""),[k,R]=b.useState("grid"),[P,q]=b.useState("md"),[X,G]=b.useState(""),[ne,ee]=b.useState(""),[se,J]=b.useState(""),[W,U]=b.useState(!1),[Y,te]=b.useState(!1),[ce,xe]=b.useState(!1),[ue,ve]=b.useState(""),[Q,pe]=b.useState(""),[Ce,je]=mw();b.useEffect(()=>{e?.settings&&(e.settings.geminiApiKey&&$(e.settings.geminiApiKey),e.settings.viewMode&&R(e.settings.viewMode),e.settings.gridSize&&q(e.settings.gridSize)),e&&(G(e.username||""),ee(e.first_name||""),J(e.last_name||""),xe(e.is_public_library||!1),ve(e.data?.bio||""),pe(e.data?.avatar||"")),Ce.get("success")==="true"&&(async()=>{try{await Ze.post("/api/payments/sync-subscription"),await r(),je({}),alert("Subscription updated successfully!")}catch(Ge){console.error("Sync failed",Ge)}})()},[e,Ce,je,r]);const we=async()=>{if(!e?.id){alert("User profile not ready. Please try again.");return}x(!0);try{const Ne={...e?.settings||{},geminiApiKey:B,viewMode:k,gridSize:P};await Ze.updateUser(e.id,{settings:Ne}),await r(),alert("Settings saved!")}catch(ot){console.error("Failed to save settings:",ot),alert("Error saving settings: "+(ot.message||"Unknown error"))}finally{x(!1)}},Te=async()=>{x(!0);try{await a({username:X,first_name:ne,last_name:se,is_public_library:ce,data:{...e?.data||{},bio:ue,avatar:Q}}),alert("Profile updated successfully!")}catch(ot){console.error("Failed to update profile:",ot),alert("Error updating profile: "+(ot.message||"Unknown error"))}finally{x(!1)}},oe=async()=>{if(t?.email){U(!0);try{await n(t.email),alert("Password reset email sent!")}catch(ot){alert("Error: "+ot.message)}finally{U(!1)}}},De=async()=>{te(!0);try{await i(),alert("Verification email sent!")}catch(ot){alert("Error: "+ot.message)}finally{te(!1)}},Nt=async()=>{try{const ot=await Ze.get("/api/collection/export");let Ne=[],Ge=[];if(Array.isArray(ot)?Ne=ot:ot&&typeof ot=="object"&&(Ne=ot.cards||[],Ge=ot.decks||[]),Ne.length===0&&Ge.length===0){alert("No data to export.");return}const Xe=JSON.stringify({cards:Ne,decks:Ge,exported_at:new Date},null,2),xt=new Blob([Xe],{type:"application/json"}),Ae=URL.createObjectURL(xt),Pe=document.createElement("a");Pe.href=Ae,Pe.download=`mtg_library_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe)}catch(ot){console.error("Export failed:",ot),alert("Failed to export library.")}};return t?s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Settings"}),s.jsx("div",{className:"flex border-b border-gray-700 overflow-x-auto",children:["account","history","membership","general","community","ai","display","data",...t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin?["admin"]:[]].map(ot=>s.jsx("button",{onClick:()=>l(`/settings/${ot}`),className:`px-6 py-3 font-medium transition-colors border-b-2 whitespace-nowrap ${c===ot?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:ot.charAt(0).toUpperCase()+ot.slice(1)},ot))}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg min-h-[400px]",children:[c==="account"&&s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("section",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Profile Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"First Name"}),s.jsx("input",{type:"text",value:ne,onChange:ot=>ee(ot.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Last Name"}),s.jsx("input",{type:"text",value:se,onChange:ot=>J(ot.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Username"}),s.jsx("input",{type:"text",value:X,onChange:ot=>G(ot.target.value),placeholder:"Enter username...",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsx("div",{className:"flex justify-start",children:s.jsx("button",{onClick:Te,disabled:p,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50",children:"Update Profile"})}),s.jsxs("div",{className:"pt-6 border-t border-gray-700 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Public Profile"}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Public Library Access"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Allow others to view your collection and decks via your profile."})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ce,onChange:ot=>xe(ot.target.checked),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Avatar URL"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("input",{type:"text",value:Q,onChange:ot=>pe(ot.target.value),placeholder:"https://example.com/avatar.jpg",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})}),s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 overflow-hidden flex-shrink-0 border border-gray-600",children:Q?s.jsx("img",{src:Q,alt:"Avatar Preview",className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:"?"})})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Bio"}),s.jsx("textarea",{value:ue,onChange:ot=>ve(ot.target.value),placeholder:"Tell us about yourself...",rows:3,className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]})]})]}),s.jsxs("section",{className:"pt-6 border-t border-gray-700 space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Security & Account"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Email Address"}),s.jsx("p",{className:"text-sm text-gray-400",children:t.email}),!t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-yellow-500/20 text-yellow-500 px-1.5 py-0.5 rounded-full border border-yellow-500/30 mt-1 inline-block",children:"Unverified"}),t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-green-500/20 text-green-500 px-1.5 py-0.5 rounded-full border border-green-500/30 mt-1 inline-block",children:"Verified"})]}),!t.emailVerified&&s.jsx("button",{onClick:De,disabled:Y,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium",children:Y?"Sending...":"Send Verification"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Password"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Change your account password"})]}),s.jsx("button",{onClick:oe,disabled:W,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium disabled:opacity-50",children:W?"Sending...":"Reset Password"})]})]})]})]}),c==="history"&&s.jsx(C4e,{}),c==="general"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"App Preferences"}),s.jsxs("div",{className:"pt-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Guided Experience"}),s.jsx("button",{onClick:async()=>{window.confirm("This will restart the welcome tour. Continue?")&&(await Ze.updateUser(e.id,{settings:{...e.settings,onboarding_complete:!1,onboarding_step:0}}),await r(),l("/onboarding"))},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg border border-gray-600 transition-colors text-sm font-medium",children:"Reset Onboarding Tour"})]})]}),c==="ai"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Integrations"}),s.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded border border-indigo-700/50",children:"Gemini"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"To enable the AI Assistant and Deck Suggestions, you need a Google Gemini API Key. Keys are stored securely in your user profile."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Gemini API Key"}),s.jsx("input",{type:"password",value:B,onChange:ot=>$(ot.target.value),placeholder:"Enter AI Key...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"}),s.jsxs("div",{className:"text-xs text-gray-500 flex justify-between",children:[s.jsx("span",{children:"Never share your API key."}),s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 hover:underline",children:"Get a key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Personalization"}),s.jsx("div",{className:"flex flex-wrap gap-4",children:s.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-3 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-5 py-3 rounded-xl transition-all hover:shadow-lg hover:border-emerald-500 group",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center text-xl group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-sm",children:"Helper Settings"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Customize your AI companion"})]})]})})]})]}),c==="display"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Display Preferences"}),s.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-xl p-4 md:p-6 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Organization Profile"}),s.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Current Mode: ",s.jsx("span",{className:"text-indigo-400 font-bold capitalize",children:e?.settings?.organization?.mode||"Default"})]}),s.jsx("p",{className:"text-xs text-gray-500 max-w-lg mb-4",children:"Your organization profile determines how your collection is sorted and grouped by default."})]}),s.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})]}),s.jsx("button",{onClick:()=>C(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors",children:"Configure Organization..."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Default View "}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${k==="grid"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"grid",checked:k==="grid",onChange:()=>R("grid"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Grid View"})]}),s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${k==="table"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"table",checked:k==="table",onChange:()=>R("table"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Table View"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Grid Size"}),s.jsxs("select",{value:P,onChange:ot=>q(ot.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 w-full sm:w-48",children:[s.jsx("option",{value:"sm",children:"Small"}),s.jsx("option",{value:"md",children:"Medium"}),s.jsx("option",{value:"lg",children:"Large"})]})]})]})]}),c==="community"&&s.jsx(w4e,{}),c==="data"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Data Management"}),s.jsxs("details",{className:"group border border-red-500/20 rounded-xl bg-red-500/5 open:bg-red-500/10 transition-colors",children:[s.jsxs("summary",{className:"flex items-center justify-between p-4 cursor-pointer select-none",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""}),s.jsx("h3",{className:"text-lg font-bold text-red-500 uppercase tracking-wide",children:"Danger Zone"})]}),s.jsx("div",{className:"text-red-500 transform transition-transform group-open:rotate-180",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"p-4 pt-0 border-t border-red-500/10 mt-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Clear Wishlist"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Permanently delete all items from your wishlist."})]}),s.jsx("button",{onClick:()=>{F("wishlist"),L(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Clear Wishlist"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete All Decks"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all your decks. Cards will remain in your collection."})]}),s.jsx("button",{onClick:()=>{F("decks"),L(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Decks"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Collection"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all cards. This will empty your decks."})]}),s.jsx("button",{onClick:()=>{F("collection"),L(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Collection"})]}),s.jsxs("div",{className:"p-4 bg-red-900/20 rounded-lg flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Everything"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Wipe your entire library: decks, cards, and wishlist."})]}),s.jsx("button",{onClick:()=>{F("all"),L(!0)},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-bold transition-colors shadow-lg shadow-red-900/20",children:"Delete Everything"})]})]})})]}),s.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-yellow-500 font-bold mb-1 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Note"]}),s.jsx("p",{className:"text-yellow-200/80 text-sm",children:"Backups include your collection data. Deck exports can be done from individual deck pages."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Export Collection"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Download a JSON backup of your entire card collection."})]}),s.jsx("button",{onClick:Nt,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export JSON"})]}),s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Import Data"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Restore from a backup or import cards. Supports Merge and Replace."})]}),s.jsx("button",{onClick:()=>y(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors border border-gray-600",children:"Import..."})]})]})]}),c==="membership"&&s.jsx(S4e,{}),c==="admin"&&(t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin)&&s.jsx(k4e,{})]}),s.jsx(m4e,{isOpen:m,onClose:()=>y(!1),mode:"global"}),s.jsx(g4e,{isOpen:v,onClose:()=>j(!1)}),s.jsx(IH,{isOpen:N,onClose:()=>C(!1),onComplete:()=>{C(!1),r()}}),s.jsx(x4e,{isOpen:A,onClose:()=>L(!1),targetName:O?O.toUpperCase():"",title:O==="all"?"Delete Everything?":O==="decks"?"Delete All Decks?":O==="collection"?"Delete Collection?":"Clear Wishlist?",message:O==="all"?"This will permanently delete ALL data associated with your account, including decks, cards, and wishlist. This cannot be undone.":O==="decks"?"This will delete all your deck lists. Your cards will be returned to your binder.":O==="collection"?"This will delete all cards in your collection. Your decks will remain but will be empty.":"This will remove all cards from your wishlist.",onConfirm:async()=>{I(!0);try{await Ze.delete("/api/users/me/data",{target:O}),window.location.reload()}catch(ot){console.error(ot),alert("Failed to delete data.")}finally{I(!1),L(!1)}}}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:we,disabled:p,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-lg shadow-lg shadow-indigo-500/20 transition-all transform hover:-translate-y-0.5 ${p?"opacity-50 cursor-not-allowed":""}`,children:p?"Saving...":"Save Settings"})})]}):s.jsx("div",{className:"p-8 text-center text-gray-500",children:"Please log in to view settings."})},E4e=()=>{const{cards:t,loading:e,error:r}=To({wishlist:!0}),{currentUser:n}=Sr(),{addToast:i}=wn(),[a,o]=b.useState(""),[l,c]=b.useState(!1),[u,f]=b.useState(!1),[p,x]=b.useState(new Set),m=O=>{const F=new Set(p);F.has(O)?F.delete(O):F.add(O),x(F)},y=O=>{p.size===O.length?x(new Set):x(new Set(O.map(F=>F.id)))},v=async()=>{if(p.size===0)return;const O=p.size;if(window.confirm(`Are you sure you want to delete ${O} cards from your wishlist?`))try{await Di.batchRemoveCards(Array.from(p)),i(`Successfully removed ${O} cards`,"success"),f(!1),x(new Set),window.location.reload()}catch(F){console.error(F),i("Failed to remove cards","error")}},[j,N]=b.useState({colors:[],rarity:[],types:[],sets:[]}),C=b.useMemo(()=>{const O=new Set;return t.forEach(F=>{F.set&&F.set_name&&O.add(JSON.stringify({value:F.set,label:F.set_name}))}),Array.from(O).map(F=>JSON.parse(F)).sort((F,T)=>F.label.localeCompare(T.label))},[t]),A=b.useMemo(()=>t.filter(O=>{const F=O.name||"";if(a&&!F.toLowerCase().includes(a.toLowerCase()))return!1;if(j.colors.length>0){const T=O.color_identity||[],I=T.length>1,B=T.length===0;if(!j.colors.some(k=>k==="C"?B:k==="M"?I:T.includes(k)))return!1}if(j.rarity.length>0&&!j.rarity.includes(O.rarity))return!1;if(j.types.length>0){const T=(O.type_line||"").toLowerCase();if(!j.types.some(B=>T.includes(B.toLowerCase())))return!1}return!(j.sets.length>0&&!j.sets.includes(O.set))}),[t,a,j]),L=(O,F)=>{N(T=>{const I=T[O],B=I.includes(F)?I.filter($=>$!==F):[...I,F];return{...T,[O]:B}})};return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-orange-500/10 rounded-xl",children:s.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Wishlist"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Manage cards you want to acquire"})]}),s.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"relative w-full md:w-80",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-700 rounded-md leading-5 bg-gray-800 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-700 focus:border-orange-500 transition duration-150 ease-in-out sm:text-sm",placeholder:"Search wishlist...",value:a,onChange:O=>o(O.target.value)}),a&&s.jsx("button",{onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[u?s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 p-1 rounded-lg border border-gray-700 animate-fade-in mr-2",children:[s.jsx("button",{onClick:()=>y(A),className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:p.size===A.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2 whitespace-nowrap",children:[p.size," Selected"]}),s.jsx("button",{onClick:v,disabled:p.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"}),s.jsx("button",{onClick:()=>f(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>f(!0),className:"px-3 py-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-indigo-400 border border-gray-700 rounded-md transition-colors text-sm font-bold uppercase",children:"Select"}),s.jsxs("button",{onClick:()=>c(!l),className:`px-3 py-2 rounded-md border transition-colors flex items-center gap-2 ${l?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})]})]}),l&&s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8 border border-gray-700 gap-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 animate-fade-in-down",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(O=>s.jsx("button",{onClick:()=>L("colors",O),className:`
                                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border shadow-sm transition-transform hover:scale-105
                                        ${j.colors.includes(O)?"ring-2 ring-orange-500 ring-offset-2 ring-offset-gray-800":"opacity-70 hover:opacity-100"}
                                        ${O==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                        ${O==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                        ${O==="B"?"bg-[#1F2937] text-white border-gray-900":""}
                                        ${O==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                        ${O==="G"?"bg-[#10B981] text-white border-green-600":""}
                                        ${O==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                        ${O==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                    `,children:O},O))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(O=>s.jsx("button",{onClick:()=>L("rarity",O),className:`
                                        px-3 py-1 rounded text-xs font-bold uppercase border transition-colors
                                        ${j.rarity.includes(O)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                    `,children:O},O))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(O=>s.jsx("button",{onClick:()=>L("types",O),className:`
                                         px-2 py-1 rounded text-xs border transition-colors
                                         ${j.types.includes(O)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                     `,children:O},O))})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(S1,{label:"Filter by Set",options:C,selected:j.sets,onChange:O=>N(F=>({...F,sets:O})),placeholder:"All Sets"})})]}),e?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:Array.from({length:12}).map((O,F)=>s.jsx(PH,{},F))}):r?s.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg",children:["Error loading wishlist: ",r.message]}):s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[A.map(O=>s.jsx("div",{className:"h-full",children:s.jsx(vm,{card:O,selectMode:u,isSelected:p.has(O.id),onToggleSelect:m})},O.id)),A.length===0&&s.jsxs("div",{className:"col-span-full text-center text-gray-500 py-12 flex flex-col items-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("p",{className:"text-xl",children:"Your wishlist is empty"}),s.jsx("p",{className:"text-sm mt-2 font-medium",children:"Add cards to your wishlist from the search modal!"})]})]})]})},tk=()=>{const t=dn(),{type:e,set:r}=Eo(),{addToast:n}=wn(),[i,a]=b.useState([]),[o,l]=b.useState([]),[c,u]=b.useState([]),[f,p]=b.useState("types"),[x,m]=b.useState(!0),[y,v]=b.useState(""),[j,N]=b.useState("");b.useEffect(()=>{const T=setTimeout(()=>N(y),500);return()=>clearTimeout(T)},[y]),b.useEffect(()=>{(async()=>(i.length===0&&await C(),o.length===0&&await A()))()},[]),b.useEffect(()=>{(async()=>{m(!0);try{j?await L({search:j}):e?await L({type:e}):r?await L({set_code:r}):u([])}finally{m(!1)}})()},[j,e,r]);const C=async()=>{try{const T=await Ze.get("/api/precons/types");a(T)}catch(T){console.error(T),n("Failed to load types","error")}},A=async()=>{try{const T=await Ze.get("/api/precons/sets");l(T)}catch(T){console.error(T)}},L=async T=>{try{const I=new URLSearchParams(T).toString(),B=await Ze.get(`/api/precons?${I}`);u(B)}catch(I){console.error(I),n("Failed to load precons","error")}},O=T=>{const I=["from-purple-500/20 to-blue-500/5 hover:border-purple-500","from-emerald-500/20 to-teal-500/5 hover:border-emerald-500","from-amber-500/20 to-orange-500/5 hover:border-amber-500","from-rose-500/20 to-red-500/5 hover:border-rose-500","from-cyan-500/20 to-blue-500/5 hover:border-cyan-500"];let B=0;for(let k=0;k<T.length;k++)B=T.charCodeAt(k)+((B<<5)-B);const $=Math.abs(B)%I.length;return I[$]},F=!!(e||r||j);return s.jsx("div",{className:"min-h-screen bg-gray-950 p-6 md:p-8 pt-24",children:s.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 border-b border-gray-800 pb-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:["Precon ",s.jsx("span",{className:"text-purple-500",children:"Database"})]}),s.jsx("p",{className:"text-gray-400",children:F?s.jsxs(s.Fragment,{children:[s.jsx(br,{to:"/precons",onClick:()=>{v("")},className:"hover:text-white transition-colors underline decoration-dotted",children:"Database"})," > ",s.jsx("span",{className:"text-white font-bold",children:j?`Search: "${j}"`:e||r})]}):"Browse official preconstructed decks."})]}),s.jsxs("div",{className:"flex gap-4",children:[!F&&s.jsxs("div",{className:"bg-gray-900 rounded-lg p-1 border border-gray-700 flex text-sm font-bold",children:[s.jsx("button",{onClick:()=>p("types"),className:`px-4 py-2 rounded-md transition-colors ${f==="types"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Types"}),s.jsx("button",{onClick:()=>p("sets"),className:`px-4 py-2 rounded-md transition-colors ${f==="sets"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Sets"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search decks or commanders...",value:y,onChange:T=>v(T.target.value),className:"bg-gray-900 border border-gray-700 text-white px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none w-64 md:w-80 pl-10 pr-10"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),y&&s.jsx("button",{onClick:()=>v(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),x?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):F?c.length===0?s.jsx("div",{className:"text-center py-20 text-gray-500",children:"No precons found."}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(T=>s.jsxs(br,{to:`/precons/deck/${T.id}`,className:"bg-gray-900 border border-gray-800 rounded-2xl overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-xl group flex flex-col cursor-pointer hover:-translate-y-1",children:[s.jsxs("div",{className:"p-6 flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-purple-400 transition-colors line-clamp-2",children:T.name}),s.jsx("span",{className:"text-xs font-bold bg-gray-800 text-gray-400 px-2 py-1 rounded uppercase tracking-wider",children:T.data?.code||"???"})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Commander"}),s.jsx("span",{className:"text-gray-200 font-medium truncate ml-2 max-w-[150px] text-right",children:T.data?.commander?.[0]?.name||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Cards"}),s.jsx("span",{className:"text-gray-200",children:(T.data?.mainBoard?.length||0)+(T.data?.sideBoard?.length||0)+(T.data?.commander?.length||0)})]}),T.total_price>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Market Price"}),s.jsxs("span",{className:"text-green-400 font-bold",children:["$",T.total_price.toFixed(2)]})]})]})]}),s.jsx("div",{className:"bg-gray-800/50 p-4 border-t border-gray-800 flex justify-center text-purple-400 font-bold text-sm group-hover:bg-purple-900/20 transition-colors",children:"View Deck List"})]},T.id))}):f==="types"?s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:i.map(T=>s.jsx("div",{onClick:()=>t(`/precons/type/${encodeURIComponent(T)}`),className:`group cursor-pointer bg-gray-900 border border-gray-800 rounded-2xl p-8 transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${O(T)}`,children:s.jsx("h3",{className:"text-xl font-bold text-white text-center group-hover:scale-105 transition-transform",children:T})},T))}):s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.map(T=>s.jsxs("div",{onClick:()=>t(`/precons/set/${T}`),className:"group cursor-pointer bg-gray-900 border border-gray-800 rounded-xl p-6 transition-all hover:-translate-y-1 hover:border-purple-500 flex flex-col items-center justify-center gap-2",children:[s.jsx("span",{className:"text-2xl font-black text-gray-700 group-hover:text-white transition-colors uppercase",children:T}),s.jsx("span",{className:"text-xs text-purple-400 font-bold",children:"Set Code"})]},T))})]})})};var T4e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function FC(t){if(typeof t!="string")return!1;var e=T4e;return e.includes(t)}var L4e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],O4e=new Set(L4e);function PW(t){return typeof t!="string"?!1:O4e.has(t)}function IW(t){return typeof t=="string"&&t.startsWith("data-")}function Ed(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(PW(r)||IW(r))&&(e[r]=t[r]);return e}function rb(t){if(t==null)return null;if(b.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return Ed(e)}return typeof t=="object"&&!Array.isArray(t)?Ed(t):null}function tc(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(PW(r)||IW(r)||FC(r))&&(e[r]=t[r]);return e}var M4e=["children","width","height","viewBox","className","style","title","desc"];function r_(){return r_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},r_.apply(null,arguments)}function P4e(t,e){if(t==null)return{};var r,n,i=I4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function I4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var UC=b.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:o,style:l,title:c,desc:u}=t,f=P4e(t,M4e),p=a||{width:n,height:i,x:0,y:0},x=ns("recharts-surface",o);return b.createElement("svg",r_({},tc(f),{className:x,width:n,height:i,style:l,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:e}),b.createElement("title",null,c),b.createElement("desc",null,u),r)}),R4e=["children","className"];function n_(){return n_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n_.apply(null,arguments)}function D4e(t,e){if(t==null)return{};var r,n,i=B4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function B4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var So=b.forwardRef((t,e)=>{var{children:r,className:n}=t,i=D4e(t,R4e),a=ns("recharts-layer",n);return b.createElement("g",n_({className:a},tc(i),{ref:e}),r)}),RW=b.createContext(null),$4e=()=>b.useContext(RW);function _s(t){return function(){return t}}const DW=Math.cos,N2=Math.sin,Vc=Math.sqrt,k2=Math.PI,t5=2*k2,s_=Math.PI,i_=2*s_,Bf=1e-6,F4e=i_-Bf;function BW(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function U4e(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return BW;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class z4e{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?BW:U4e(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,o){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,l=this._y1,c=n-e,u=i-r,f=o-e,p=l-r,x=f*f+p*p;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(x>Bf)if(!(Math.abs(p*c-u*f)>Bf)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let m=n-o,y=i-l,v=c*c+u*u,j=m*m+y*y,N=Math.sqrt(v),C=Math.sqrt(x),A=a*Math.tan((s_-Math.acos((v+x-j)/(2*N*C)))/2),L=A/C,O=A/N;Math.abs(L-1)>Bf&&this._append`L${e+L*f},${r+L*p}`,this._append`A${a},${a},0,0,${+(p*m>f*y)},${this._x1=e+O*c},${this._y1=r+O*u}`}}arc(e,r,n,i,a,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=e+l,f=r+c,p=1^o,x=o?i-a:a-i;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Bf||Math.abs(this._y1-f)>Bf)&&this._append`L${u},${f}`,n&&(x<0&&(x=x%i_+i_),x>F4e?this._append`A${n},${n},0,1,${p},${e-l},${r-c}A${n},${n},0,1,${p},${this._x1=u},${this._y1=f}`:x>Bf&&this._append`A${n},${n},0,${+(x>=s_)},${p},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function zC(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new z4e(e)}function qC(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function $W(t){this._context=t}$W.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function r5(t){return new $W(t)}function FW(t){return t[0]}function UW(t){return t[1]}function zW(t,e){var r=_s(!0),n=null,i=r5,a=null,o=zC(l);t=typeof t=="function"?t:t===void 0?FW:_s(t),e=typeof e=="function"?e:e===void 0?UW:_s(e);function l(c){var u,f=(c=qC(c)).length,p,x=!1,m;for(n==null&&(a=i(m=o())),u=0;u<=f;++u)!(u<f&&r(p=c[u],u,c))===x&&((x=!x)?a.lineStart():a.lineEnd()),x&&a.point(+t(p,u,c),+e(p,u,c));if(m)return a=null,m+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:_s(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:_s(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:_s(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),l):n},l}function Hv(t,e,r){var n=null,i=_s(!0),a=null,o=r5,l=null,c=zC(u);t=typeof t=="function"?t:t===void 0?FW:_s(+t),e=typeof e=="function"?e:_s(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?UW:_s(+r);function u(p){var x,m,y,v=(p=qC(p)).length,j,N=!1,C,A=new Array(v),L=new Array(v);for(a==null&&(l=o(C=c())),x=0;x<=v;++x){if(!(x<v&&i(j=p[x],x,p))===N)if(N=!N)m=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=x-1;y>=m;--y)l.point(A[y],L[y]);l.lineEnd(),l.areaEnd()}N&&(A[x]=+t(j,x,p),L[x]=+e(j,x,p),l.point(n?+n(j,x,p):A[x],r?+r(j,x,p):L[x]))}if(C)return l=null,C+""||null}function f(){return zW().defined(i).curve(o).context(a)}return u.x=function(p){return arguments.length?(t=typeof p=="function"?p:_s(+p),n=null,u):t},u.x0=function(p){return arguments.length?(t=typeof p=="function"?p:_s(+p),u):t},u.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:_s(+p),u):n},u.y=function(p){return arguments.length?(e=typeof p=="function"?p:_s(+p),r=null,u):e},u.y0=function(p){return arguments.length?(e=typeof p=="function"?p:_s(+p),u):e},u.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:_s(+p),u):r},u.lineX0=u.lineY0=function(){return f().x(t).y(e)},u.lineY1=function(){return f().x(t).y(r)},u.lineX1=function(){return f().x(n).y(e)},u.defined=function(p){return arguments.length?(i=typeof p=="function"?p:_s(!!p),u):i},u.curve=function(p){return arguments.length?(o=p,a!=null&&(l=o(a)),u):o},u.context=function(p){return arguments.length?(p==null?a=l=null:l=o(a=p),u):a},u}class qW{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function q4e(t){return new qW(t,!0)}function H4e(t){return new qW(t,!1)}const HC={draw(t,e){const r=Vc(e/k2);t.moveTo(r,0),t.arc(0,0,r,0,t5)}},W4e={draw(t,e){const r=Vc(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},HW=Vc(1/3),G4e=HW*2,V4e={draw(t,e){const r=Vc(e/G4e),n=r*HW;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},Y4e={draw(t,e){const r=Vc(e),n=-r/2;t.rect(n,n,r,r)}},K4e=.8908130915292852,WW=N2(k2/10)/N2(7*k2/10),X4e=N2(t5/10)*WW,J4e=-DW(t5/10)*WW,Z4e={draw(t,e){const r=Vc(e*K4e),n=X4e*r,i=J4e*r;t.moveTo(0,-r),t.lineTo(n,i);for(let a=1;a<5;++a){const o=t5*a/5,l=DW(o),c=N2(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*i,c*n+l*i)}t.closePath()}},rk=Vc(3),Q4e={draw(t,e){const r=-Vc(e/(rk*3));t.moveTo(0,r*2),t.lineTo(-rk*r,-r),t.lineTo(rk*r,-r),t.closePath()}},Ul=-.5,zl=Vc(3)/2,a_=1/Vc(12),eje=(a_/2+1)*3,tje={draw(t,e){const r=Vc(e/eje),n=r/2,i=r*a_,a=n,o=r*a_+r,l=-a,c=o;t.moveTo(n,i),t.lineTo(a,o),t.lineTo(l,c),t.lineTo(Ul*n-zl*i,zl*n+Ul*i),t.lineTo(Ul*a-zl*o,zl*a+Ul*o),t.lineTo(Ul*l-zl*c,zl*l+Ul*c),t.lineTo(Ul*n+zl*i,Ul*i-zl*n),t.lineTo(Ul*a+zl*o,Ul*o-zl*a),t.lineTo(Ul*l+zl*c,Ul*c-zl*l),t.closePath()}};function rje(t,e){let r=null,n=zC(i);t=typeof t=="function"?t:_s(t||HC),e=typeof e=="function"?e:_s(e===void 0?64:+e);function i(){let a;if(r||(r=a=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:_s(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:_s(+a),i):e},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function S2(){}function _2(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function GW(t){this._context=t}GW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nje(t){return new GW(t)}function VW(t){this._context=t}VW.prototype={areaStart:S2,areaEnd:S2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:_2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function sje(t){return new VW(t)}function YW(t){this._context=t}YW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:_2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ije(t){return new YW(t)}function KW(t){this._context=t}KW.prototype={areaStart:S2,areaEnd:S2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function aje(t){return new KW(t)}function p9(t){return t<0?-1:1}function m9(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),o=(r-t._y1)/(i||n<0&&-0),l=(a*i+o*n)/(n+i);return(p9(a)+p9(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function g9(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function nk(t,e,r){var n=t._x0,i=t._y0,a=t._x1,o=t._y1,l=(a-n)/3;t._context.bezierCurveTo(n+l,i+l*e,a-l,o-l*r,a,o)}function C2(t){this._context=t}C2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nk(this,this._t0,g9(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,nk(this,g9(this,r=m9(this,t,e)),r);break;default:nk(this,this._t0,r=m9(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function XW(t){this._context=new JW(t)}(XW.prototype=Object.create(C2.prototype)).point=function(t,e){C2.prototype.point.call(this,e,t)};function JW(t){this._context=t}JW.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function oje(t){return new C2(t)}function lje(t){return new XW(t)}function ZW(t){this._context=t}ZW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=x9(t),i=x9(e),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function x9(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function cje(t){return new ZW(t)}function n5(t,e){this._context=t,this._t=e}n5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function dje(t){return new n5(t,.5)}function uje(t){return new n5(t,0)}function hje(t){return new n5(t,1)}function v0(t,e){if((o=t.length)>1)for(var r=1,n,i,a=t[e[0]],o,l=a.length;r<o;++r)for(i=a,a=t[e[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function o_(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function fje(t,e){return t[e]}function pje(t){const e=[];return e.key=t,e}function mje(){var t=_s([]),e=o_,r=v0,n=fje;function i(a){var o=Array.from(t.apply(this,arguments),pje),l,c=o.length,u=-1,f;for(const p of a)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(p,o[l].key,u,a)]).data=p;for(l=0,f=qC(e(o));l<c;++l)o[f[l]].index=l;return r(o,f),o}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:_s(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:_s(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?o_:typeof a=="function"?a:_s(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??v0,i):r},i}function gje(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=t[r][i][1]||0;if(o)for(r=0;r<n;++r)t[r][i][1]/=o}v0(t,e)}}function xje(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var o=0,l=0;o<i;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}v0(t,e)}}function bje(t,e){if(!(!((o=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var l=0,c=0,u=0;l<o;++l){for(var f=t[e[l]],p=f[n][1]||0,x=f[n-1][1]||0,m=(p-x)/2,y=0;y<l;++y){var v=t[e[y]],j=v[n][1]||0,N=v[n-1][1]||0;m+=j-N}c+=p,u+=m*p}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,v0(t,e)}}var sk={},ik={},b9;function yje(){return b9||(b9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(ik)),ik}var ak={},y9;function QW(){return y9||(y9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(ak)),ak}var ok={},v9;function WC(){return v9||(v9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(ok)),ok}var lk={},ck={},w9;function vje(){return w9||(w9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(ck)),ck}var j9;function GC(){return j9||(j9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vje(),r=WC();function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=e.toString(i);const a=[],o=i.length;if(o===0)return a;let l=0,c="",u="",f=!1;for(i.charCodeAt(0)===46&&(a.push(""),l++);l<o;){const p=i[l];u?p==="\\"&&l+1<o?(l++,c+=i[l]):p===u?u="":c+=p:f?p==='"'||p==="'"?u=p:p==="]"?(f=!1,a.push(c),c=""):c+=p:p==="["?(f=!0,c&&(a.push(c),c="")):p==="."?c&&(a.push(c),c=""):c+=p,l++}return c&&a.push(c),a}t.toPath=n})(lk)),lk}var N9;function VC(){return N9||(N9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yje(),r=QW(),n=WC(),i=GC();function a(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const f=l[c];return f===void 0?r.isDeepKey(c)?a(l,i.toPath(c),u):u:f}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const f=l[c];return f===void 0?u:f}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const f=l[c];return f===void 0?u:f}}}function o(l,c,u){if(c.length===0)return u;let f=l;for(let p=0;p<c.length;p++){if(f==null||e.isUnsafeProperty(c[p]))return u;f=f[c[p]]}return f===void 0?u:f}t.get=a})(sk)),sk}var dk,k9;function wje(){return k9||(k9=1,dk=VC().get),dk}var jje=wje();const w0=Co(jje);var Nje=4;function Yh(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nje,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function bi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((i,a,o)=>{var l=r[o-1];return typeof l=="string"?i+l+a:l!==void 0?i+Yh(l)+a:i+a},"")}var Ha=t=>t===0?0:t>0?1:-1,Td=t=>typeof t=="number"&&t!=+t,Mu=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,wr=t=>(typeof t=="number"||t instanceof Number)&&!Td(t),Ld=t=>wr(t)||typeof t=="string",kje=0,nb=t=>{var e=++kje;return"".concat(t||"").concat(e)},oo=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!wr(e)&&typeof e!="string")return n;var a;if(Mu(e)){if(r==null)return n;var o=e.indexOf("%");a=r*parseFloat(e.slice(0,o))/100}else a=+e;return Td(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},eG=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Qi(t,e,r){return wr(t)&&wr(e)?Yh(t+r*(e-t)):e}function Sje(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):w0(n,e))===r)}var Na=t=>t===null||typeof t>"u",qb=t=>Na(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function _je(t){return t!=null}function Hb(){}var Cje=["type","size","sizeType"];function l_(){return l_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l_.apply(null,arguments)}function S9(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _9(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S9(Object(r),!0).forEach(function(n){Aje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S9(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Aje(t,e,r){return(e=Eje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eje(t){var e=Tje(t,"string");return typeof e=="symbol"?e:e+""}function Tje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lje(t,e){if(t==null)return{};var r,n,i=Oje(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Oje(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var tG={symbolCircle:HC,symbolCross:W4e,symbolDiamond:V4e,symbolSquare:Y4e,symbolStar:Z4e,symbolTriangle:Q4e,symbolWye:tje},Mje=Math.PI/180,Pje=t=>{var e="symbol".concat(qb(t));return tG[e]||HC},Ije=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*Mje;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Rje=(t,e)=>{tG["symbol".concat(qb(t))]=e},YC=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,i=Lje(t,Cje),a=_9(_9({},i),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var x=Pje(o),m=rje().type(x).size(Ije(r,n,o)),y=m();if(y!==null)return y},{className:c,cx:u,cy:f}=a,p=tc(a);return wr(u)&&wr(f)&&wr(r)?b.createElement("path",l_({},p,{className:ns("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(f,")"),d:l()})):null};YC.registerSymbol=Rje;var rG=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,Dje=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(b.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{FC(i)&&(n[i]=(a=>r[i](r,a)))}),n},Bje=(t,e,r)=>n=>(t(e,r,n),null),Wb=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];FC(i)&&typeof a=="function"&&(n||(n={}),n[i]=Bje(a,e,r))}),n};function C9(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $je(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?C9(Object(r),!0).forEach(function(n){Fje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C9(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fje(t,e,r){return(e=Uje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uje(t){var e=zje(t,"string");return typeof e=="symbol"?e:e+""}function zje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Va(t,e){var r=$je({},t),n=e,i=Object.keys(e),a=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return a}function A2(){return A2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A2.apply(null,arguments)}function A9(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function qje(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?A9(Object(r),!0).forEach(function(n){Hje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A9(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hje(t,e,r){return(e=Wje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wje(t){var e=Gje(t,"string");return typeof e=="symbol"?e:e+""}function Gje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hl=32,Vje={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function Yje(t){var{data:e,iconType:r,inactiveColor:n}=t,i=Hl/2,a=Hl/6,o=Hl/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return b.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Hl,y2:i,className:"recharts-legend-icon"})}if(c==="line")return b.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Hl,"M").concat(2*o,",").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return b.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Hl/8,"h").concat(Hl,"v").concat(Hl*3/4,"h").concat(-Hl,"z"),className:"recharts-legend-icon"});if(b.isValidElement(e.legendIcon)){var f=qje({},e);return delete f.legendIcon,b.cloneElement(e.legendIcon,f)}return b.createElement(YC,{fill:l,cx:i,cy:i,size:Hl,sizeType:"diameter",type:c})}function Kje(t){var{payload:e,iconSize:r,layout:n,formatter:i,inactiveColor:a,iconType:o}=t,l={x:0,y:0,width:Hl,height:Hl},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((f,p)=>{var x=f.formatter||i,m=ns({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:f.inactive});if(f.type==="none")return null;var y=f.inactive?a:f.color,v=x?x(f.value,f,p):f.value;return b.createElement("li",A2({className:m,style:c,key:"legend-item-".concat(p)},Wb(t,f,p)),b.createElement(UC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(v," legend icon")},b.createElement(Yje,{data:f,iconType:o,inactiveColor:a})),b.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v))})}var Xje=t=>{var e=Va(t,Vje),{payload:r,layout:n,align:i}=e;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return b.createElement("ul",{className:"recharts-default-legend",style:a},b.createElement(Kje,A2({},e,{payload:r})))},uk={},hk={},E9;function Jje(){return E9||(E9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const o=r[a],l=n(o);i.has(l)||i.set(l,o)}return Array.from(i.values())}t.uniqBy=e})(hk)),hk}var fk={},T9;function nG(){return T9||(T9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(fk)),fk}var pk={},mk={},gk={},L9;function Zje(){return L9||(L9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(gk)),gk}var O9;function KC(){return O9||(O9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zje();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(mk)),mk}var xk={},M9;function Qje(){return M9||(M9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(xk)),xk}var P9;function eNe(){return P9||(P9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=KC(),r=Qje();function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(pk)),pk}var bk={},yk={},I9;function tNe(){return I9||(I9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=VC();function r(n){return function(i){return e.get(i,n)}}t.property=r})(yk)),yk}var vk={},wk={},jk={},Nk={},R9;function sG(){return R9||(R9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(Nk)),Nk}var kk={},D9;function iG(){return D9||(D9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(kk)),kk}var Sk={},B9;function aG(){return B9||(B9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(Sk)),Sk}var $9;function rNe(){return $9||($9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sG(),r=iG(),n=aG();function i(f,p,x){return typeof x!="function"?i(f,p,()=>{}):a(f,p,function m(y,v,j,N,C,A){const L=x(y,v,j,N,C,A);return L!==void 0?!!L:a(y,v,m,A)},new Map)}function a(f,p,x,m){if(p===f)return!0;switch(typeof p){case"object":return o(f,p,x,m);case"function":return Object.keys(p).length>0?a(f,{...p},x,m):n.eq(f,p);default:return e.isObject(f)?typeof p=="string"?p==="":!0:n.eq(f,p)}}function o(f,p,x,m){if(p==null)return!0;if(Array.isArray(p))return c(f,p,x,m);if(p instanceof Map)return l(f,p,x,m);if(p instanceof Set)return u(f,p,x,m);const y=Object.keys(p);if(f==null||r.isPrimitive(f))return y.length===0;if(y.length===0)return!0;if(m?.has(p))return m.get(p)===f;m?.set(p,f);try{for(let v=0;v<y.length;v++){const j=y[v];if(!r.isPrimitive(f)&&!(j in f)||p[j]===void 0&&f[j]!==void 0||p[j]===null&&f[j]!==null||!x(f[j],p[j],j,f,p,m))return!1}return!0}finally{m?.delete(p)}}function l(f,p,x,m){if(p.size===0)return!0;if(!(f instanceof Map))return!1;for(const[y,v]of p.entries()){const j=f.get(y);if(x(j,v,y,f,p,m)===!1)return!1}return!0}function c(f,p,x,m){if(p.length===0)return!0;if(!Array.isArray(f))return!1;const y=new Set;for(let v=0;v<p.length;v++){const j=p[v];let N=!1;for(let C=0;C<f.length;C++){if(y.has(C))continue;const A=f[C];let L=!1;if(x(A,j,v,f,p,m)&&(L=!0),L){y.add(C),N=!0;break}}if(!N)return!1}return!0}function u(f,p,x,m){return p.size===0?!0:f instanceof Set?c([...f],[...p],x,m):!1}t.isMatchWith=i,t.isSetMatch=u})(jk)),jk}var F9;function oG(){return F9||(F9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rNe();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r})(wk)),wk}var _k={},Ck={},Ak={},U9;function nNe(){return U9||(U9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Ak)),Ak}var Ek={},z9;function lG(){return z9||(z9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(Ek)),Ek}var Tk={},q9;function cG(){return q9||(q9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",f="[object Array]",p="[object Function]",x="[object ArrayBuffer]",m="[object Object]",y="[object Error]",v="[object DataView]",j="[object Uint8Array]",N="[object Uint8ClampedArray]",C="[object Uint16Array]",A="[object Uint32Array]",L="[object BigUint64Array]",O="[object Int8Array]",F="[object Int16Array]",T="[object Int32Array]",I="[object BigInt64Array]",B="[object Float32Array]",$="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=x,t.arrayTag=f,t.bigInt64ArrayTag=I,t.bigUint64ArrayTag=L,t.booleanTag=i,t.dataViewTag=v,t.dateTag=l,t.errorTag=y,t.float32ArrayTag=B,t.float64ArrayTag=$,t.functionTag=p,t.int16ArrayTag=F,t.int32ArrayTag=T,t.int8ArrayTag=O,t.mapTag=c,t.numberTag=n,t.objectTag=m,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=C,t.uint32ArrayTag=A,t.uint8ArrayTag=j,t.uint8ClampedArrayTag=N})(Tk)),Tk}var Lk={},H9;function sNe(){return H9||(H9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(Lk)),Lk}var W9;function dG(){return W9||(W9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nNe(),r=lG(),n=cG(),i=iG(),a=sNe();function o(f,p){return l(f,void 0,f,new Map,p)}function l(f,p,x,m=new Map,y=void 0){const v=y?.(f,p,x,m);if(v!==void 0)return v;if(i.isPrimitive(f))return f;if(m.has(f))return m.get(f);if(Array.isArray(f)){const j=new Array(f.length);m.set(f,j);for(let N=0;N<f.length;N++)j[N]=l(f[N],N,x,m,y);return Object.hasOwn(f,"index")&&(j.index=f.index),Object.hasOwn(f,"input")&&(j.input=f.input),j}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const j=new RegExp(f.source,f.flags);return j.lastIndex=f.lastIndex,j}if(f instanceof Map){const j=new Map;m.set(f,j);for(const[N,C]of f)j.set(N,l(C,N,x,m,y));return j}if(f instanceof Set){const j=new Set;m.set(f,j);for(const N of f)j.add(l(N,void 0,x,m,y));return j}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(a.isTypedArray(f)){const j=new(Object.getPrototypeOf(f)).constructor(f.length);m.set(f,j);for(let N=0;N<f.length;N++)j[N]=l(f[N],N,x,m,y);return j}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const j=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return m.set(f,j),c(j,f,x,m,y),j}if(typeof File<"u"&&f instanceof File){const j=new File([f],f.name,{type:f.type});return m.set(f,j),c(j,f,x,m,y),j}if(typeof Blob<"u"&&f instanceof Blob){const j=new Blob([f],{type:f.type});return m.set(f,j),c(j,f,x,m,y),j}if(f instanceof Error){const j=new f.constructor;return m.set(f,j),j.message=f.message,j.name=f.name,j.stack=f.stack,j.cause=f.cause,c(j,f,x,m,y),j}if(f instanceof Boolean){const j=new Boolean(f.valueOf());return m.set(f,j),c(j,f,x,m,y),j}if(f instanceof Number){const j=new Number(f.valueOf());return m.set(f,j),c(j,f,x,m,y),j}if(f instanceof String){const j=new String(f.valueOf());return m.set(f,j),c(j,f,x,m,y),j}if(typeof f=="object"&&u(f)){const j=Object.create(Object.getPrototypeOf(f));return m.set(f,j),c(j,f,x,m,y),j}return f}function c(f,p,x=f,m,y){const v=[...Object.keys(p),...e.getSymbols(p)];for(let j=0;j<v.length;j++){const N=v[j],C=Object.getOwnPropertyDescriptor(f,N);(C==null||C.writable)&&(f[N]=l(p[N],N,x,m,y))}}function u(f){switch(r.getTag(f)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(Ck)),Ck}var G9;function iNe(){return G9||(G9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dG();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(_k)),_k}var V9;function aNe(){return V9||(V9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oG(),r=iNe();function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(vk)),vk}var Ok={},Mk={},Pk={},Y9;function oNe(){return Y9||(Y9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dG(),r=cG();function n(i,a){return e.cloneDeepWith(i,(o,l,c,u)=>{const f=a?.(o,l,c,u);if(f!==void 0)return f;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new i.constructor(i?.valueOf());return e.copyProperties(p,i),p}case r.argumentsTag:{const p={};return e.copyProperties(p,i),p.length=i.length,p[Symbol.iterator]=i[Symbol.iterator],p}default:return}})}t.cloneDeepWith=n})(Pk)),Pk}var K9;function lNe(){return K9||(K9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oNe();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Mk)),Mk}var Ik={},Rk={},X9;function uG(){return X9||(X9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(Rk)),Rk}var Dk={},J9;function cNe(){return J9||(J9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lG();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Dk)),Dk}var Z9;function dNe(){return Z9||(Z9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=QW(),r=uG(),n=cNe(),i=GC();function a(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&o?.[l]==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let f=0;f<c.length;f++){const p=c[f];if((u==null||!Object.hasOwn(u,p))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(p)&&p<u.length))return!1;u=u[p]}return!0}t.has=a})(Ik)),Ik}var Q9;function uNe(){return Q9||(Q9=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oG(),r=WC(),n=lNe(),i=VC(),a=dNe();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const f=i.get(u,l);return f===void 0?a.has(u,l):c===void 0?f===void 0:e.isMatch(f,c)}}t.matchesProperty=o})(Ok)),Ok}var eI;function hNe(){return eI||(eI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nG(),r=tNe(),n=aNe(),i=uNe();function a(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=a})(bk)),bk}var tI;function fNe(){return tI||(tI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Jje(),r=nG(),n=eNe(),i=hNe();function a(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),i.iteratee(l)):[]}t.uniqBy=a})(uk)),uk}var Bk,rI;function pNe(){return rI||(rI=1,Bk=fNe().uniqBy),Bk}var mNe=pNe();const nI=Co(mNe);function hG(t,e,r){return e===!0?nI(t,r):typeof e=="function"?nI(t,e):t}var $k={exports:{}},Fk={},Uk={exports:{}},zk={};var sI;function gNe(){if(sI)return zk;sI=1;var t=Fu();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function l(p,x){var m=x(),y=n({inst:{value:m,getSnapshot:x}}),v=y[0].inst,j=y[1];return a(function(){v.value=m,v.getSnapshot=x,c(v)&&j({inst:v})},[p,m,x]),i(function(){return c(v)&&j({inst:v}),p(function(){c(v)&&j({inst:v})})},[p]),o(m),m}function c(p){var x=p.getSnapshot;p=p.value;try{var m=x();return!r(p,m)}catch{return!0}}function u(p,x){return x()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return zk.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,zk}var iI;function xNe(){return iI||(iI=1,Uk.exports=gNe()),Uk.exports}var aI;function bNe(){if(aI)return Fk;aI=1;var t=Fu(),e=xNe();function r(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,a=t.useRef,o=t.useEffect,l=t.useMemo,c=t.useDebugValue;return Fk.useSyncExternalStoreWithSelector=function(u,f,p,x,m){var y=a(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=l(function(){function N(F){if(!C){if(C=!0,A=F,F=x(F),m!==void 0&&v.hasValue){var T=v.value;if(m(T,F))return L=T}return L=F}if(T=L,n(A,F))return T;var I=x(F);return m!==void 0&&m(T,I)?(A=F,T):(A=F,L=I)}var C=!1,A,L,O=p===void 0?null:p;return[function(){return N(f())},O===null?void 0:function(){return N(O())}]},[f,p,x,m]);var j=i(u,y[0],y[1]);return o(function(){v.hasValue=!0,v.value=j},[j]),c(j),j},Fk}var oI;function yNe(){return oI||(oI=1,$k.exports=bNe()),$k.exports}var vNe=yNe(),XC=b.createContext(null),wNe=t=>t,As=()=>{var t=b.useContext(XC);return t?t.store.dispatch:wNe},O1=()=>{},jNe=()=>O1,NNe=(t,e)=>t===e;function mr(t){var e=b.useContext(XC);return vNe.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:jNe,e?e.store.getState:O1,e?e.store.getState:O1,e?t:O1,NNe)}function kNe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function SNe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function _Ne(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var lI=t=>Array.isArray(t)?t:[t];function CNe(t){const e=Array.isArray(t[0])?t[0]:t;return _Ne(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function ANe(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var ENe=class{constructor(t){this.value=t}deref(){return this.value}},TNe=typeof WeakRef<"u"?WeakRef:ENe,LNe=0,cI=1;function Wv(){return{s:LNe,v:void 0,o:null,p:null}}function fG(t,e={}){let r=Wv();const{resultEqualityCheck:n}=e;let i,a=0;function o(){let l=r;const{length:c}=arguments;for(let p=0,x=c;p<x;p++){const m=arguments[p];if(typeof m=="function"||typeof m=="object"&&m!==null){let y=l.o;y===null&&(l.o=y=new WeakMap);const v=y.get(m);v===void 0?(l=Wv(),y.set(m,l)):l=v}else{let y=l.p;y===null&&(l.p=y=new Map);const v=y.get(m);v===void 0?(l=Wv(),y.set(m,l)):l=v}}const u=l;let f;if(l.s===cI)f=l.v;else if(f=t.apply(null,arguments),a++,n){const p=i?.deref?.()??i;p!=null&&n(p,f)&&(f=p,a!==0&&a--),i=typeof f=="object"&&f!==null||typeof f=="function"?new TNe(f):f}return u.s=cI,u.v=f,f}return o.clearCache=()=>{r=Wv(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function ONe(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),kNe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const f={...r,...c},{memoize:p,memoizeOptions:x=[],argsMemoize:m=fG,argsMemoizeOptions:y=[]}=f,v=lI(x),j=lI(y),N=CNe(i),C=p(function(){return a++,u.apply(null,arguments)},...v),A=m(function(){o++;const O=ANe(N,arguments);return l=C.apply(null,O),l},...j);return Object.assign(A,{resultFunc:u,memoizedResultFunc:C,dependencies:N,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:p,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var nt=ONe(fG),MNe=Object.assign((t,e=nt)=>{SNe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>MNe}),qk={},Hk={},Wk={},dI;function PNe(){return dI||(dI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const o=e(n),l=e(i);if(o===l&&o===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?l-o:o-l}return 0};t.compareValues=r})(Wk)),Wk}var Gk={},Vk={},uI;function pG(){return uI||(uI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Vk)),Vk}var hI;function INe(){return hI||(hI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pG(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,o){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||o!=null&&Object.hasOwn(o,a)}t.isKey=i})(Gk)),Gk}var fI;function RNe(){return fI||(fI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=PNe(),r=INe(),n=GC();function i(a,o,l,c){if(a==null)return[];l=c?void 0:l,Array.isArray(a)||(a=Object.values(a)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(m=>String(m));const u=(m,y)=>{let v=m;for(let j=0;j<y.length&&v!=null;++j)v=v[y[j]];return v},f=(m,y)=>y==null||m==null?y:typeof m=="object"&&"key"in m?Object.hasOwn(y,m.key)?y[m.key]:u(y,m.path):typeof m=="function"?m(y):Array.isArray(m)?u(y,m):typeof y=="object"?y[m]:y,p=o.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return a.map(m=>({original:m,criteria:p.map(y=>f(y,m))})).slice().sort((m,y)=>{for(let v=0;v<p.length;v++){const j=e.compareValues(m.criteria[v],y.criteria[v],l[v]);if(j!==0)return j}return 0}).map(m=>m.original)}t.orderBy=i})(Hk)),Hk}var Yk={},pI;function DNe(){return pI||(pI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const f=l[u];Array.isArray(f)&&c<a?o(f,c+1):i.push(f)}};return o(r,0),i}t.flatten=e})(Yk)),Yk}var Kk={},mI;function mG(){return mI||(mI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uG(),r=KC(),n=sG(),i=aG();function a(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.eq(c[l],o):!1}t.isIterateeCall=a})(Kk)),Kk}var gI;function BNe(){return gI||(gI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RNe(),r=DNe(),n=mG();function i(a,...o){const l=o.length;return l>1&&n.isIterateeCall(a,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(a,r.flatten(o),["asc"])}t.sortBy=i})(qk)),qk}var Xk,xI;function $Ne(){return xI||(xI=1,Xk=BNe().sortBy),Xk}var FNe=$Ne();const s5=Co(FNe);var gG=t=>t.legend.settings,UNe=t=>t.legend.size,zNe=t=>t.legend.payload,qNe=nt([zNe,gG],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?s5(n,r):n});function HNe(){return mr(qNe)}var Gv=1;function xG(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=b.useState({height:0,left:0,top:0,width:0}),n=b.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),o={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(o.height-e.height)>Gv||Math.abs(o.left-e.left)>Gv||Math.abs(o.top-e.top)>Gv||Math.abs(o.width-e.width)>Gv)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function Ua(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var WNe=typeof Symbol=="function"&&Symbol.observable||"@@observable",bI=WNe,Jk=()=>Math.random().toString(36).substring(7).split("").join("."),GNe={INIT:`@@redux/INIT${Jk()}`,REPLACE:`@@redux/REPLACE${Jk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Jk()}`},E2=GNe;function JC(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function bG(t,e,r){if(typeof t!="function")throw new Error(Ua(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ua(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ua(1));return r(bG)(t,e)}let n=t,i=e,a=new Map,o=a,l=0,c=!1;function u(){o===a&&(o=new Map,a.forEach((j,N)=>{o.set(N,j)}))}function f(){if(c)throw new Error(Ua(3));return i}function p(j){if(typeof j!="function")throw new Error(Ua(4));if(c)throw new Error(Ua(5));let N=!0;u();const C=l++;return o.set(C,j),function(){if(N){if(c)throw new Error(Ua(6));N=!1,u(),o.delete(C),a=null}}}function x(j){if(!JC(j))throw new Error(Ua(7));if(typeof j.type>"u")throw new Error(Ua(8));if(typeof j.type!="string")throw new Error(Ua(17));if(c)throw new Error(Ua(9));try{c=!0,i=n(i,j)}finally{c=!1}return(a=o).forEach(C=>{C()}),j}function m(j){if(typeof j!="function")throw new Error(Ua(10));n=j,x({type:E2.REPLACE})}function y(){const j=p;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(Ua(11));function C(){const L=N;L.next&&L.next(f())}return C(),{unsubscribe:j(C)}},[bI](){return this}}}return x({type:E2.INIT}),{dispatch:x,subscribe:p,getState:f,replaceReducer:m,[bI]:y}}function VNe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:E2.INIT})>"u")throw new Error(Ua(12));if(typeof r(void 0,{type:E2.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ua(13))})}function yG(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const o=e[a];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let i;try{VNe(r)}catch(a){i=a}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let f=0;f<n.length;f++){const p=n[f],x=r[p],m=o[p],y=x(m,l);if(typeof y>"u")throw l&&l.type,new Error(Ua(14));u[p]=y,c=c||y!==m}return c=c||n.length!==Object.keys(o).length,c?u:o}}function T2(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function YNe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(Ua(15))};const o={getState:i.getState,dispatch:(c,...u)=>a(c,...u)},l=t.map(c=>c(o));return a=T2(...l)(i.dispatch),{...i,dispatch:a}}}function vG(t){return JC(t)&&"type"in t&&typeof t.type=="string"}var wG=Symbol.for("immer-nothing"),yI=Symbol.for("immer-draftable"),_o=Symbol.for("immer-state");function Cc(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var wl=Object,wm=wl.getPrototypeOf,L2="constructor",i5="prototype",c_="configurable",O2="enumerable",M1="writable",sb="value",Pu=t=>!!t&&!!t[_o];function Fc(t){return t?jG(t)||a5(t)||!!t[yI]||!!t[L2]?.[yI]||o5(t)||l5(t):!1}var KNe=wl[i5][L2].toString(),vI=new WeakMap;function jG(t){if(!t||!ZC(t))return!1;const e=wm(t);if(e===null||e===wl[i5])return!0;const r=wl.hasOwnProperty.call(e,L2)&&e[L2];if(r===Object)return!0;if(!qp(r))return!1;let n=vI.get(r);return n===void 0&&(n=Function.toString.call(r),vI.set(r,n)),n===KNe}function Gb(t,e,r=!0){Vb(t)===0?(r?Reflect.ownKeys(t):wl.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function Vb(t){const e=t[_o];return e?e.type_:a5(t)?1:o5(t)?2:l5(t)?3:0}var wI=(t,e,r=Vb(t))=>r===2?t.has(e):wl[i5].hasOwnProperty.call(t,e),d_=(t,e,r=Vb(t))=>r===2?t.get(e):t[e],M2=(t,e,r,n=Vb(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function XNe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var a5=Array.isArray,o5=t=>t instanceof Map,l5=t=>t instanceof Set,ZC=t=>typeof t=="object",qp=t=>typeof t=="function",Zk=t=>typeof t=="boolean";function JNe(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var du=t=>t.copy_||t.base_,QC=t=>t.modified_?t.copy_:t.base_;function u_(t,e){if(o5(t))return new Map(t);if(l5(t))return new Set(t);if(a5(t))return Array[i5].slice.call(t);const r=jG(t);if(e===!0||e==="class_only"&&!r){const n=wl.getOwnPropertyDescriptors(t);delete n[_o];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],l=n[o];l[M1]===!1&&(l[M1]=!0,l[c_]=!0),(l.get||l.set)&&(n[o]={[c_]:!0,[M1]:!0,[O2]:l[O2],[sb]:t[o]})}return wl.create(wm(t),n)}else{const n=wm(t);if(n!==null&&r)return{...t};const i=wl.create(n);return wl.assign(i,t)}}function eA(t,e=!1){return c5(t)||Pu(t)||!Fc(t)||(Vb(t)>1&&wl.defineProperties(t,{set:Vv,add:Vv,clear:Vv,delete:Vv}),wl.freeze(t),e&&Gb(t,(r,n)=>{eA(n,!0)},!1)),t}function ZNe(){Cc(2)}var Vv={[sb]:ZNe};function c5(t){return t===null||!ZC(t)?!0:wl.isFrozen(t)}var P2="MapSet",h_="Patches",jI="ArrayMethods",NG={};function j0(t){const e=NG[t];return e||Cc(0,t),e}var NI=t=>!!NG[t],ib,kG=()=>ib,QNe=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:NI(P2)?j0(P2):void 0,arrayMethodsPlugin_:NI(jI)?j0(jI):void 0});function kI(t,e){e&&(t.patchPlugin_=j0(h_),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function f_(t){p_(t),t.drafts_.forEach(eke),t.drafts_=null}function p_(t){t===ib&&(ib=t.parent_)}var SI=t=>ib=QNe(ib,t);function eke(t){const e=t[_o];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function _I(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[_o].modified_&&(f_(e),Cc(4)),Fc(t)&&(t=CI(e,t));const{patchPlugin_:i}=e;i&&i.generateReplacementPatches_(r[_o].base_,t,e)}else t=CI(e,r);return tke(e,t,!0),f_(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==wG?t:void 0}function CI(t,e){if(c5(e))return e;const r=e[_o];if(!r)return tA(e,t.handledSet_,t);if(!d5(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);CG(r,t)}return r.copy_}function tke(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&eA(e,r)}function SG(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var d5=(t,e)=>t.scope_===e,rke=[];function _G(t,e,r,n){const i=du(t),a=t.type_;if(n!==void 0&&d_(i,n,a)===e){M2(i,n,r,a);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;Gb(i,(c,u)=>{if(Pu(u)){const f=l.get(u)||[];f.push(c),l.set(u,f)}})}const o=t.draftLocations_.get(e)??rke;for(const l of o)M2(i,l,r,a)}function nke(t,e,r){t.callbacks_.push(function(i){const a=e;if(!a||!d5(a,i))return;i.mapSetPlugin_?.fixSetContents(a);const o=QC(a);_G(t,a.draft_??a,o,r),CG(a,i)})}function CG(t,e){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){const{patchPlugin_:n}=e;if(n){const i=n.getPath(t);i&&n.generatePatches_(t,i,e)}SG(t)}}function ske(t,e,r){const{scope_:n}=t;if(Pu(r)){const i=r[_o];d5(i,n)&&i.callbacks_.push(function(){P1(t);const o=QC(i);_G(t,r,o,e)})}else Fc(r)&&t.callbacks_.push(function(){const a=du(t);d_(a,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&tA(d_(t.copy_,e,t.type_),n.handledSet_,n)})}function tA(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Pu(t)||e.has(t)||!Fc(t)||c5(t)||(e.add(t),Gb(t,(n,i)=>{if(Pu(i)){const a=i[_o];if(d5(a,r)){const o=QC(a);M2(t,n,o,t.type_),SG(a)}}else Fc(i)&&tA(i,e,r)})),t}function ike(t,e){const r=a5(t),n={type_:r?1:0,scope_:e?e.scope_:kG(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,a=rA;r&&(i=[n],a=ab);const{revoke:o,proxy:l}=Proxy.revocable(i,a);return n.draft_=l,n.revoke_=o,[l,n]}var rA={get(t,e){if(e===_o)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r?.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const i=du(t);if(!wI(i,e,t.type_))return ake(t,i,e);const a=i[e];if(t.finalized_||!Fc(a)||n&&t.operationMethod&&r?.isMutatingArrayMethod(t.operationMethod)&&JNe(e))return a;if(a===Qk(t.base_,e)){P1(t);const o=t.type_===1?+e:e,l=g_(t.scope_,a,t,o);return t.copy_[o]=l}return a},has(t,e){return e in du(t)},ownKeys(t){return Reflect.ownKeys(du(t))},set(t,e,r){const n=AG(du(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=Qk(du(t),e),a=i?.[_o];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(XNe(r,i)&&(r!==void 0||wI(t.base_,e,t.type_)))return!0;P1(t),m_(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),ske(t,e,r)),!0},deleteProperty(t,e){return P1(t),Qk(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),m_(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=du(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[M1]:!0,[c_]:t.type_!==1||e!=="length",[O2]:n[O2],[sb]:r[e]}},defineProperty(){Cc(11)},getPrototypeOf(t){return wm(t.base_)},setPrototypeOf(){Cc(12)}},ab={};Gb(rA,(t,e)=>{ab[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}});ab.deleteProperty=function(t,e){return ab.set.call(this,t,e,void 0)};ab.set=function(t,e,r){return rA.set.call(this,t[0],e,r,t[0])};function Qk(t,e){const r=t[_o];return(r?du(r):t)[e]}function ake(t,e,r){const n=AG(e,r);return n?sb in n?n[sb]:n.get?.call(t.draft_):void 0}function AG(t,e){if(!(e in t))return;let r=wm(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=wm(r)}}function m_(t){t.modified_||(t.modified_=!0,t.parent_&&m_(t.parent_))}function P1(t){t.copy_||(t.assigned_=new Map,t.copy_=u_(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var oke=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(qp(r)&&!qp(n)){const o=n;n=r;const l=this;return function(u=o,...f){return l.produce(u,p=>n.call(this,p,...f))}}qp(n)||Cc(6),i!==void 0&&!qp(i)&&Cc(7);let a;if(Fc(r)){const o=SI(this),l=g_(o,r,void 0);let c=!0;try{a=n(l),c=!1}finally{c?f_(o):p_(o)}return kI(o,i),_I(a,o)}else if(!r||!ZC(r)){if(a=n(r),a===void 0&&(a=r),a===wG&&(a=void 0),this.autoFreeze_&&eA(a,!0),i){const o=[],l=[];j0(h_).generateReplacementPatches_(r,a,{patches_:o,inversePatches_:l}),i(o,l)}return a}else Cc(1,r)},this.produceWithPatches=(r,n)=>{if(qp(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,a;return[this.produce(r,n,(l,c)=>{i=l,a=c}),i,a]},Zk(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),Zk(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),Zk(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Fc(e)||Cc(8),Pu(e)&&(e=Ic(e));const r=SI(this),n=g_(r,e,void 0);return n[_o].isManual_=!0,p_(r),n}finishDraft(e,r){const n=e&&e[_o];(!n||!n.isManual_)&&Cc(9);const{scope_:i}=n;return kI(i,r),_I(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(r=r.slice(n+1));const i=j0(h_).applyPatches_;return Pu(e)?i(e,r):this.produce(e,a=>i(a,r))}};function g_(t,e,r,n){const[i,a]=o5(e)?j0(P2).proxyMap_(e,r):l5(e)?j0(P2).proxySet_(e,r):ike(e,r);return(r?.scope_??kG()).drafts_.push(i),a.callbacks_=r?.callbacks_??[],a.key_=n,r&&n!==void 0?nke(r,a,n):a.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(a);const{patchPlugin_:u}=c;a.modified_&&u&&u.generatePatches_(a,[],c)}),i}function Ic(t){return Pu(t)||Cc(10,t),EG(t)}function EG(t){if(!Fc(t)||c5(t))return t;const e=t[_o];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=u_(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=u_(t,!0);return Gb(r,(i,a)=>{M2(r,i,EG(a))},n),e&&(e.finalized_=!1),r}var lke=new oke,TG=lke.produce;function LG(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var cke=LG(),dke=LG,uke=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?T2:T2.apply(null,arguments)};function rc(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(jl(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>vG(n)&&n.type===t,r}var OG=class px extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,px.prototype)}static get[Symbol.species](){return px}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new px(...e[0].concat(this)):new px(...e.concat(this))}};function AI(t){return Fc(t)?TG(t,()=>{}):t}function Yv(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function hke(t){return typeof t=="boolean"}var fke=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let o=new OG;return r&&(hke(r)?o.push(cke):o.push(dke(r.extraArgument))),o},MG="RTK_autoBatch",Ys=()=>t=>({payload:t,meta:{[MG]:!0}}),EI=t=>e=>{setTimeout(e,t)},PG=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:EI(10):t.type==="callback"?t.queueNotification:EI(t.timeout),u=()=>{o=!1,a&&(a=!1,l.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const p=()=>i&&f(),x=n.subscribe(p);return l.add(f),()=>{x(),l.delete(f)}},dispatch(f){try{return i=!f?.meta?.[MG],a=!i,a&&(o||(o=!0,c(u))),n.dispatch(f)}finally{i=!0}}})},pke=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new OG(t);return n&&i.push(PG(typeof n=="object"?n:void 0)),i};function mke(t){const e=fke(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(JC(r))l=yG(r);else throw new Error(jl(1));let c;typeof n=="function"?c=n(e):c=e();let u=T2;i&&(u=uke({trace:!1,...typeof i=="object"&&i}));const f=YNe(...c),p=pke(f);let x=typeof o=="function"?o(p):p();const m=u(...x);return bG(l,a,m)}function IG(t){const e={},r=[];let n;const i={addCase(a,o){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(jl(28));if(l in e)throw new Error(jl(29));return e[l]=o,i},addAsyncThunk(a,o){return o.pending&&(e[a.pending.type]=o.pending),o.rejected&&(e[a.rejected.type]=o.rejected),o.fulfilled&&(e[a.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:a.settled,reducer:o.settled}),i},addMatcher(a,o){return r.push({matcher:a,reducer:o}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function gke(t){return typeof t=="function"}function xke(t,e){let[r,n,i]=IG(e),a;if(gke(t))a=()=>AI(t());else{const l=AI(t);a=()=>l}function o(l=a(),c){let u=[r[c.type],...n.filter(({matcher:f})=>f(c)).map(({reducer:f})=>f)];return u.filter(f=>!!f).length===0&&(u=[i]),u.reduce((f,p)=>{if(p)if(Pu(f)){const m=p(f,c);return m===void 0?f:m}else{if(Fc(f))return TG(f,x=>p(x,c));{const x=p(f,c);if(x===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return f},l)}return o.getInitialState=a,o}var bke="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",yke=(t=21)=>{let e="",r=t;for(;r--;)e+=bke[Math.random()*64|0];return e},vke=Symbol.for("rtk-slice-createasyncthunk");function wke(t,e){return`${t}/${e}`}function jke({creators:t}={}){const e=t?.asyncThunk?.[vke];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(jl(11));const o=(typeof n.reducers=="function"?n.reducers(kke()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(A,L){const O=typeof A=="string"?A:A.type;if(!O)throw new Error(jl(12));if(O in c.sliceCaseReducersByType)throw new Error(jl(13));return c.sliceCaseReducersByType[O]=L,u},addMatcher(A,L){return c.sliceMatchers.push({matcher:A,reducer:L}),u},exposeAction(A,L){return c.actionCreators[A]=L,u},exposeCaseReducer(A,L){return c.sliceCaseReducersByName[A]=L,u}};l.forEach(A=>{const L=o[A],O={reducerName:A,type:wke(i,A),createNotation:typeof n.reducers=="function"};_ke(L)?Ake(O,L,u,e):Ske(O,L,u)});function f(){const[A={},L=[],O=void 0]=typeof n.extraReducers=="function"?IG(n.extraReducers):[n.extraReducers],F={...A,...c.sliceCaseReducersByType};return xke(n.initialState,T=>{for(let I in F)T.addCase(I,F[I]);for(let I of c.sliceMatchers)T.addMatcher(I.matcher,I.reducer);for(let I of L)T.addMatcher(I.matcher,I.reducer);O&&T.addDefaultCase(O)})}const p=A=>A,x=new Map,m=new WeakMap;let y;function v(A,L){return y||(y=f()),y(A,L)}function j(){return y||(y=f()),y.getInitialState()}function N(A,L=!1){function O(T){let I=T[A];return typeof I>"u"&&L&&(I=Yv(m,O,j)),I}function F(T=p){const I=Yv(x,L,()=>new WeakMap);return Yv(I,T,()=>{const B={};for(const[$,k]of Object.entries(n.selectors??{}))B[$]=Nke(k,T,()=>Yv(m,T,j),L);return B})}return{reducerPath:A,getSelectors:F,get selectors(){return F(O)},selectSlice:O}}const C={name:i,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:j,...N(a),injectInto(A,{reducerPath:L,...O}={}){const F=L??a;return A.inject({reducerPath:F,reducer:v},O),{...C,...N(F,!0)}}};return C}}function Nke(t,e,r,n){function i(a,...o){let l=e(a);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return i.unwrapped=t,i}var il=jke();function kke(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function Ske({type:t,reducerName:e,createNotation:r},n,i){let a,o;if("reducer"in n){if(r&&!Cke(n))throw new Error(jl(17));a=n.reducer,o=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,o?rc(t,o):rc(t))}function _ke(t){return t._reducerDefinitionType==="asyncThunk"}function Cke(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Ake({type:t,reducerName:e},r,n,i){if(!i)throw new Error(jl(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:u,options:f}=r,p=i(t,a,f);n.exposeAction(e,p),o&&n.addCase(p.fulfilled,o),l&&n.addCase(p.pending,l),c&&n.addCase(p.rejected,c),u&&n.addMatcher(p.settled,u),n.exposeCaseReducer(e,{fulfilled:o||Kv,pending:l||Kv,rejected:c||Kv,settled:u||Kv})}function Kv(){}var Eke="task",RG="listener",DG="completed",nA="cancelled",Tke=`task-${nA}`,Lke=`task-${DG}`,x_=`${RG}-${nA}`,Oke=`${RG}-${DG}`,u5=class{constructor(t){this.code=t,this.message=`${Eke} ${nA} (reason: ${t})`}name="TaskAbortError";message},sA=(t,e)=>{if(typeof t!="function")throw new TypeError(jl(32))},I2=()=>{},BG=(t,e=I2)=>(t.catch(e),t),$G=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),t0=t=>{if(t.aborted)throw new u5(t.reason)};function FG(t,e){let r=I2;return new Promise((n,i)=>{const a=()=>i(new u5(t.reason));if(t.aborted){a();return}r=$G(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=I2})}var Mke=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof u5?"cancelled":"rejected",error:r}}finally{e?.()}},R2=t=>e=>BG(FG(t,e).then(r=>(t0(t),r))),UG=t=>{const e=R2(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:um}=Object,TI={},h5="listenerMiddleware",Pke=(t,e)=>{const r=n=>$G(t,()=>n.abort(t.reason));return(n,i)=>{sA(n);const a=new AbortController;r(a);const o=Mke(async()=>{t0(t),t0(a.signal);const l=await n({pause:R2(a.signal),delay:UG(a.signal),signal:a.signal});return t0(a.signal),l},()=>a.abort(Lke));return i?.autoJoin&&e.push(o.catch(I2)),{result:R2(t)(o),cancel(){a.abort(Tke)}}}},Ike=(t,e)=>{const r=async(n,i)=>{t0(e);let a=()=>{};const l=[new Promise((c,u)=>{let f=t({predicate:n,effect:(p,x)=>{x.unsubscribe(),c([p,x.getState(),x.getOriginalState()])}});a=()=>{f(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await FG(e,Promise.race(l));return t0(e),c}finally{a()}};return(n,i)=>BG(r(n,i))},zG=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=rc(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(jl(21));return sA(a),{predicate:i,type:e,effect:a}},qG=um(t=>{const{type:e,predicate:r,effect:n}=zG(t);return{id:yke(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(jl(22))}}},{withTypes:()=>qG}),LI=(t,e)=>{const{type:r,effect:n,predicate:i}=zG(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},b_=t=>{t.pending.forEach(e=>{e.abort(x_)})},Rke=(t,e)=>()=>{for(const r of e.keys())b_(r);t.clear()},OI=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},HG=um(rc(`${h5}/add`),{withTypes:()=>HG}),Dke=rc(`${h5}/removeAll`),WG=um(rc(`${h5}/remove`),{withTypes:()=>WG}),Bke=(...t)=>{console.error(`${h5}/error`,...t)},Yb=(t={})=>{const e=new Map,r=new Map,n=m=>{const y=r.get(m)??0;r.set(m,y+1)},i=m=>{const y=r.get(m)??1;y===1?r.delete(m):r.set(m,y-1)},{extra:a,onError:o=Bke}=t;sA(o);const l=m=>(m.unsubscribe=()=>e.delete(m.id),e.set(m.id,m),y=>{m.unsubscribe(),y?.cancelActive&&b_(m)}),c=m=>{const y=LI(e,m)??qG(m);return l(y)};um(c,{withTypes:()=>c});const u=m=>{const y=LI(e,m);return y&&(y.unsubscribe(),m.cancelActive&&b_(y)),!!y};um(u,{withTypes:()=>u});const f=async(m,y,v,j)=>{const N=new AbortController,C=Ike(c,N.signal),A=[];try{m.pending.add(N),n(m),await Promise.resolve(m.effect(y,um({},v,{getOriginalState:j,condition:(L,O)=>C(L,O).then(Boolean),take:C,delay:UG(N.signal),pause:R2(N.signal),extra:a,signal:N.signal,fork:Pke(N.signal,A),unsubscribe:m.unsubscribe,subscribe:()=>{e.set(m.id,m)},cancelActiveListeners:()=>{m.pending.forEach((L,O,F)=>{L!==N&&(L.abort(x_),F.delete(L))})},cancel:()=>{N.abort(x_),m.pending.delete(N)},throwIfCancelled:()=>{t0(N.signal)}})))}catch(L){L instanceof u5||OI(o,L,{raisedBy:"effect"})}finally{await Promise.all(A),N.abort(Oke),i(m),m.pending.delete(N)}},p=Rke(e,r);return{middleware:m=>y=>v=>{if(!vG(v))return y(v);if(HG.match(v))return c(v.payload);if(Dke.match(v)){p();return}if(WG.match(v))return u(v.payload);let j=m.getState();const N=()=>{if(j===TI)throw new Error(jl(23));return j};let C;try{if(C=y(v),e.size>0){const A=m.getState(),L=Array.from(e.values());for(const O of L){let F=!1;try{F=O.predicate(v,A,j)}catch(T){F=!1,OI(o,T,{raisedBy:"predicate"})}F&&f(O,v,m,N)}}}finally{j=TI}return C},startListening:c,stopListening:u,clearListeners:p}};function jl(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var $ke={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},GG=il({name:"chartLayout",initialState:$ke,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,i,a;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(i=e.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(a=e.payload.left)!==null&&a!==void 0?a:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:Fke,setLayout:Uke,setChartSize:zke,setScale:qke}=GG.actions,Hke=GG.reducer;function VG(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function ii(t){return Number.isFinite(t)}function lf(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function MI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Gp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MI(Object(r),!0).forEach(function(n){Wke(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Wke(t,e,r){return(e=Gke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gke(t){var e=Vke(t,"string");return typeof e=="symbol"?e:e+""}function Vke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bs(t,e,r){return Na(t)||Na(e)?r:Ld(e)?w0(t,e,r):typeof e=="function"?e(t):r}var Yke=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&a!=="center"&&wr(t[a]))return Gp(Gp({},t),{},{[a]:t[a]+(n||0)});if((l==="horizontal"||l==="vertical"&&a==="center")&&o!=="middle"&&wr(t[o]))return Gp(Gp({},t),{},{[o]:t[o]+(i||0)})}return t},U0=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",PI=1e-4,Kke=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-PI,a=Math.max(n[0],n[1])+PI,o=t(e[0]),l=t(e[r-1]);(o<i||o>a||l<i||l>a)&&t.domain([e[0],e[r-1]])}},Xke=(t,e)=>{if(!e||e.length!==2||!wr(e[0])||!wr(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),i=[t[0],t[1]];return(!wr(t[0])||t[0]<r)&&(i[0]=r),(!wr(t[1])||t[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},Jke=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0,l=0;l<r;++l){var c=t[l],u=c?.[i];if(u!=null){var f=u[1],p=u[0],x=Td(f)?p:f;x>=0?(u[0]=a,u[1]=a+x,a=f):(u[0]=o,u[1]=o+x,o=f)}}}},Zke=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0;o<r;++o){var l=t[o],c=l?.[i];if(c!=null){var u=Td(c[1])?c[0]:c[1];u>=0?(c[0]=a,c[1]=a+u,a=c[1]):(c[0]=0,c[1]=0)}}}},Qke={sign:Jke,expand:gje,none:v0,silhouette:xje,wiggle:bje,positive:Zke},e3e=(t,e,r)=>{var n,i=(n=Qke[r])!==null&&n!==void 0?n:v0,a=mje().keys(e).value((l,c)=>Number(Bs(l,c,0))).order(o_).offset(i),o=a(t);return o.forEach((l,c)=>{l.forEach((u,f)=>{var p=Bs(t[f],e[c],0);Array.isArray(p)&&p.length===2&&wr(p[0])&&wr(p[1])&&(u[0]=p[0],u[1]=p[1])})}),o};function t3e(t){return t==null?void 0:String(t)}var II=t=>{var{axis:e,ticks:r,offset:n,bandSize:i,entry:a,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=Bs(a,e.dataKey,e.scale.domain()[o]);return Na(l)?null:e.scale(l)-i/2+n},r3e=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},n3e=t=>{var e=t.flat(2).filter(wr);return[Math.min(...e),Math.max(...e)]},s3e=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],i3e=(t,e,r)=>{if(t!=null)return s3e(Object.keys(t).reduce((n,i)=>{var a=t[i];if(!a)return n;var{stackedData:o}=a,l=o.reduce((c,u)=>{var f=VG(u,e,r),p=n3e(f);return!ii(p[0])||!ii(p[1])?c:[Math.min(c[0],p[0]),Math.max(c[1],p[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},RI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,D2=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=s5(e,f=>f.coordinate),a=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];a=Math.min((c?.coordinate||0)-(u?.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function BI(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Gp(Gp({},e),{},{dataKey:r,payload:n,value:i,name:a})}function f5(t,e){if(t)return String(t);if(typeof e=="string")return e}var a3e=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},o3e=(t,e)=>e==="centric"?t.angle:t.radius,Vu=t=>t.layout.width,Yu=t=>t.layout.height,l3e=t=>t.layout.scale,YG=t=>t.layout.margin,p5=nt(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),m5=nt(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),KG="data-recharts-item-index",XG="data-recharts-item-id",Kb=60;function $I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$I(Object(r),!0).forEach(function(n){c3e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$I(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c3e(t,e,r){return(e=d3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d3e(t){var e=u3e(t,"string");return typeof e=="symbol"?e:e+""}function u3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h3e=t=>t.brush.height;function f3e(t){var e=m5(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:Kb;return r+i}return r},0)}function p3e(t){var e=m5(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:Kb;return r+i}return r},0)}function m3e(t){var e=p5(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function g3e(t){var e=p5(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var na=nt([Vu,Yu,YG,h3e,f3e,p3e,m3e,g3e,gG,UNe],(t,e,r,n,i,a,o,l,c,u)=>{var f={left:(r.left||0)+i,right:(r.right||0)+a},p={top:(r.top||0)+o,bottom:(r.bottom||0)+l},x=Xv(Xv({},p),f),m=x.bottom;x.bottom+=n,x=Yke(x,c,u);var y=t-x.left-x.right,v=e-x.top-x.bottom;return Xv(Xv({brushBottom:m},x),{},{width:Math.max(y,0),height:Math.max(v,0)})}),x3e=nt(na,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),iA=nt(Vu,Yu,(t,e)=>({x:0,y:0,width:t,height:e})),b3e=b.createContext(null),Cl=()=>b.useContext(b3e)!=null,g5=t=>t.brush,x5=nt([g5,na,YG],(t,e,r)=>({height:t.height,x:wr(t.x)?t.x:e.left,y:wr(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:wr(t.width)?t.width:e.width})),e3={},t3={},r3={},FI;function y3e(){return FI||(FI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:i,edges:a}={}){let o,l=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),f=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},p=()=>{u&&f(),v()};let x=null;const m=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,p()},n)},y=()=>{x!==null&&(clearTimeout(x),x=null)},v=()=>{y(),o=void 0,l=null},j=()=>{f()},N=function(...C){if(i?.aborted)return;o=this,l=C;const A=x==null;m(),c&&A&&f()};return N.schedule=m,N.cancel=v,N.flush=j,i?.addEventListener("abort",v,{once:!0}),N}t.debounce=e})(r3)),r3}var UI;function v3e(){return UI||(UI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=y3e();function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:o=!1,trailing:l=!0,maxWait:c}=a,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let f,p=null;const x=e.debounce(function(...v){f=n.apply(this,v),p=null},i,{edges:u}),m=function(...v){return c!=null&&(p===null&&(p=Date.now()),Date.now()-p>=c)?(f=n.apply(this,v),p=Date.now(),x.cancel(),x.schedule(),f):(x.apply(this,v),f)},y=()=>(x.flush(),f);return m.cancel=x.cancel,m.flush=y,m}t.debounce=r})(t3)),t3}var zI;function w3e(){return zI||(zI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=v3e();function r(n,i=0,a={}){const{leading:o=!0,trailing:l=!0}=a;return e.debounce(n,i,{leading:o,maxWait:i,trailing:l})}t.throttle=r})(e3)),e3}var n3,qI;function j3e(){return qI||(qI=1,n3=w3e().throttle),n3}var N3e=j3e();const k3e=Co(N3e);var HI=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},JG=(t,e,r)=>{var{width:n="100%",height:i="100%",aspect:a,maxHeight:o}=r,l=Mu(n)?t:Number(n),c=Mu(i)?e:Number(i);return a&&a>0&&(l?c=l/a:c&&(l=c*a),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},S3e={width:0,height:0,overflow:"visible"},_3e={width:0,overflowX:"visible"},C3e={height:0,overflowY:"visible"},A3e={},E3e=t=>{var{width:e,height:r}=t,n=Mu(e),i=Mu(r);return n&&i?S3e:n?_3e:i?C3e:A3e};function T3e(t){var{width:e,height:r,aspect:n}=t,i=e,a=r;return i===void 0&&a===void 0?(i="100%",a="100%"):i===void 0?i=n&&n>0?void 0:"100%":a===void 0&&(a=n&&n>0?void 0:"100%"),{width:i,height:a}}function y_(){return y_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y_.apply(null,arguments)}function WI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function GI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WI(Object(r),!0).forEach(function(n){L3e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function L3e(t,e,r){return(e=O3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O3e(t){var e=M3e(t,"string");return typeof e=="symbol"?e:e+""}function M3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZG=b.createContext({width:-1,height:-1});function P3e(t){return lf(t.width)&&lf(t.height)}function QG(t){var{children:e,width:r,height:n}=t,i=b.useMemo(()=>({width:r,height:n}),[r,n]);return P3e(i)?b.createElement(ZG.Provider,{value:i},e):null}var aA=()=>b.useContext(ZG),I3e=b.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i,height:a,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:f=0,id:p,className:x,onResize:m,style:y={}}=t,v=b.useRef(null),j=b.useRef();j.current=m,b.useImperativeHandle(e,()=>v.current);var[N,C]=b.useState({containerWidth:n.width,containerHeight:n.height}),A=b.useCallback((I,B)=>{C($=>{var k=Math.round(I),R=Math.round(B);return $.containerWidth===k&&$.containerHeight===R?$:{containerWidth:k,containerHeight:R}})},[]);b.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return Hb;var I=R=>{var P,{width:q,height:X}=R[0].contentRect;A(q,X),(P=j.current)===null||P===void 0||P.call(j,q,X)};f>0&&(I=k3e(I,f,{trailing:!0,leading:!1}));var B=new ResizeObserver(I),{width:$,height:k}=v.current.getBoundingClientRect();return A($,k),B.observe(v.current),()=>{B.disconnect()}},[A,f]);var{containerWidth:L,containerHeight:O}=N;HI(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:F,calculatedHeight:T}=JG(L,O,{width:i,height:a,aspect:r,maxHeight:c});return HI(F!=null&&F>0||T!=null&&T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,T,i,a,o,l,r),b.createElement("div",{id:p?"".concat(p):void 0,className:ns("recharts-responsive-container",x),style:GI(GI({},y),{},{width:i,height:a,minWidth:o,minHeight:l,maxHeight:c}),ref:v},b.createElement("div",{style:E3e({width:i,height:a})},b.createElement(QG,{width:F,height:T},u)))}),VI=b.forwardRef((t,e)=>{var r=aA();if(lf(r.width)&&lf(r.height))return t.children;var{width:n,height:i}=T3e({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:a,calculatedHeight:o}=JG(void 0,void 0,{width:n,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return wr(a)&&wr(o)?b.createElement(QG,{width:a,height:o},t.children):b.createElement(I3e,y_({},t,{width:n,height:i,ref:e}))});function eV(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var b5=()=>{var t,e=Cl(),r=mr(x3e),n=mr(x5),i=(t=mr(g5))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},R3e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},D3e=()=>{var t;return(t=mr(na))!==null&&t!==void 0?t:R3e},tV=()=>mr(Vu),rV=()=>mr(Yu),B3e=()=>mr(t=>t.layout.margin),$n=t=>t.layout.layoutType,Xb=()=>mr($n),$3e=()=>{var t=Xb();return t!==void 0},y5=t=>{var e=As(),r=Cl(),{width:n,height:i}=t,a=aA(),o=n,l=i;return a&&(o=a.width>0?a.width:n,l=a.height>0?a.height:i),b.useEffect(()=>{!r&&lf(o)&&lf(l)&&e(zke({width:o,height:l}))},[e,r,o,l]),null},nV=Symbol.for("immer-nothing"),YI=Symbol.for("immer-draftable"),kl=Symbol.for("immer-state");function Ac(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var ob=Object.getPrototypeOf;function jm(t){return!!t&&!!t[kl]}function N0(t){return t?sV(t)||Array.isArray(t)||!!t[YI]||!!t.constructor?.[YI]||Jb(t)||w5(t):!1}var F3e=Object.prototype.constructor.toString(),KI=new WeakMap;function sV(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=KI.get(r);return n===void 0&&(n=Function.toString.call(r),KI.set(r,n)),n===F3e}function B2(t,e,r=!0){v5(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function v5(t){const e=t[kl];return e?e.type_:Array.isArray(t)?1:Jb(t)?2:w5(t)?3:0}function v_(t,e){return v5(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function iV(t,e,r){const n=v5(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function U3e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Jb(t){return t instanceof Map}function w5(t){return t instanceof Set}function $f(t){return t.copy_||t.base_}function w_(t,e){if(Jb(t))return new Map(t);if(w5(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=sV(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[kl];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(ob(t),n)}else{const n=ob(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function oA(t,e=!1){return j5(t)||jm(t)||!N0(t)||(v5(t)>1&&Object.defineProperties(t,{set:Jv,add:Jv,clear:Jv,delete:Jv}),Object.freeze(t),e&&Object.values(t).forEach(r=>oA(r,!0))),t}function z3e(){Ac(2)}var Jv={value:z3e};function j5(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var q3e={};function k0(t){const e=q3e[t];return e||Ac(0,t),e}var lb;function aV(){return lb}function H3e(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function XI(t,e){e&&(k0("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function j_(t){N_(t),t.drafts_.forEach(W3e),t.drafts_=null}function N_(t){t===lb&&(lb=t.parent_)}function JI(t){return lb=H3e(lb,t)}function W3e(t){const e=t[kl];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function ZI(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[kl].modified_&&(j_(e),Ac(4)),N0(t)&&(t=$2(e,t),e.parent_||F2(e,t)),e.patches_&&k0("Patches").generateReplacementPatches_(r[kl].base_,t,e.patches_,e.inversePatches_)):t=$2(e,r,[]),j_(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==nV?t:void 0}function $2(t,e,r){if(j5(e))return e;const n=t.immer_.shouldUseStrictIteration(),i=e[kl];if(!i)return B2(e,(a,o)=>QI(t,i,e,a,o,r),n),e;if(i.scope_!==t)return e;if(!i.modified_)return F2(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const a=i.copy_;let o=a,l=!1;i.type_===3&&(o=new Set(a),a.clear(),l=!0),B2(o,(c,u)=>QI(t,i,a,c,u,r,l),n),F2(t,a,!1),r&&t.patches_&&k0("Patches").generatePatches_(i,r,t.patches_,t.inversePatches_)}return i.copy_}function QI(t,e,r,n,i,a,o){if(i==null||typeof i!="object"&&!o)return;const l=j5(i);if(!(l&&!o)){if(jm(i)){const c=a&&e&&e.type_!==3&&!v_(e.assigned_,n)?a.concat(n):void 0,u=$2(t,i,c);if(iV(r,n,u),jm(u))t.canAutoFreeze_=!1;else return}else o&&r.add(i);if(N0(i)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===i&&l)return;$2(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(Jb(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&F2(t,i)}}}function F2(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&oA(e,r)}function G3e(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:aV(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=lA;r&&(i=[n],a=cb);const{revoke:o,proxy:l}=Proxy.revocable(i,a);return n.draft_=l,n.revoke_=o,l}var lA={get(t,e){if(e===kl)return t;const r=$f(t);if(!v_(r,e))return V3e(t,r,e);const n=r[e];return t.finalized_||!N0(n)?n:n===s3(t.base_,e)?(i3(t),t.copy_[e]=S_(n,t)):n},has(t,e){return e in $f(t)},ownKeys(t){return Reflect.ownKeys($f(t))},set(t,e,r){const n=oV($f(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=s3($f(t),e),a=i?.[kl];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(U3e(r,i)&&(r!==void 0||v_(t.base_,e)))return!0;i3(t),k_(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return s3(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,i3(t),k_(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=$f(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Ac(11)},getPrototypeOf(t){return ob(t.base_)},setPrototypeOf(){Ac(12)}},cb={};B2(lA,(t,e)=>{cb[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});cb.deleteProperty=function(t,e){return cb.set.call(this,t,e,void 0)};cb.set=function(t,e,r){return lA.set.call(this,t[0],e,r,t[0])};function s3(t,e){const r=t[kl];return(r?$f(r):t)[e]}function V3e(t,e,r){const n=oV(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function oV(t,e){if(!(e in t))return;let r=ob(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=ob(r)}}function k_(t){t.modified_||(t.modified_=!0,t.parent_&&k_(t.parent_))}function i3(t){t.copy_||(t.copy_=w_(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Y3e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const o=this;return function(c=a,...u){return o.produce(c,f=>r.call(this,f,...u))}}typeof r!="function"&&Ac(6),n!==void 0&&typeof n!="function"&&Ac(7);let i;if(N0(e)){const a=JI(this),o=S_(e,void 0);let l=!0;try{i=r(o),l=!1}finally{l?j_(a):N_(a)}return XI(a,n),ZI(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===nV&&(i=void 0),this.autoFreeze_&&oA(i,!0),n){const a=[],o=[];k0("Patches").generateReplacementPatches_(e,i,a,o),n(a,o)}return i}else Ac(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,i;return[this.produce(e,r,(o,l)=>{n=o,i=l}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){N0(t)||Ac(8),jm(t)&&(t=K3e(t));const e=JI(this),r=S_(t,void 0);return r[kl].isManual_=!0,N_(e),r}finishDraft(t,e){const r=t&&t[kl];(!r||!r.isManual_)&&Ac(9);const{scope_:n}=r;return XI(n,e),ZI(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=k0("Patches").applyPatches_;return jm(t)?n(t,e):this.produce(t,i=>n(i,e))}};function S_(t,e){const r=Jb(t)?k0("MapSet").proxyMap_(t,e):w5(t)?k0("MapSet").proxySet_(t,e):G3e(t,e);return(e?e.scope_:aV()).drafts_.push(r),r}function K3e(t){return jm(t)||Ac(10,t),lV(t)}function lV(t){if(!N0(t)||j5(t))return t;const e=t[kl];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=w_(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=w_(t,!0);return B2(r,(i,a)=>{iV(r,i,lV(a))},n),e&&(e.finalized_=!1),r}var X3e=new Y3e;X3e.produce;var J3e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},cV=il({name:"legend",initialState:J3e,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Ys()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Ic(t).payload.indexOf(r);i>-1&&(t.payload[i]=n)},prepare:Ys()},removeLegendPayload:{reducer(t,e){var r=Ic(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Ys()}}}),{setLegendSize:eR,setLegendSettings:Z3e,addLegendPayload:dV,replaceLegendPayload:uV,removeLegendPayload:hV}=cV.actions,Q3e=cV.reducer,eSe=["contextPayload"];function __(){return __=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},__.apply(null,arguments)}function tR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tR(Object(r),!0).forEach(function(n){tSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tSe(t,e,r){return(e=rSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rSe(t){var e=nSe(t,"string");return typeof e=="symbol"?e:e+""}function nSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sSe(t,e){if(t==null)return{};var r,n,i=iSe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function iSe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function aSe(t){return t.value}function oSe(t){var{contextPayload:e}=t,r=sSe(t,eSe),n=hG(e,t.payloadUniqBy,aSe),i=Nm(Nm({},r),{},{payload:n});return b.isValidElement(t.content)?b.cloneElement(t.content,i):typeof t.content=="function"?b.createElement(t.content,i):b.createElement(Xje,i)}function lSe(t,e,r,n,i,a){var{layout:o,align:l,verticalAlign:c}=e,u,f;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-a.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?f={top:((i||0)-a.height)/2}:f=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Nm(Nm({},u),f)}function cSe(t){var e=As();return b.useEffect(()=>{e(Z3e(t))},[e,t]),null}function dSe(t){var e=As();return b.useEffect(()=>(e(eR(t)),()=>{e(eR({width:0,height:0}))}),[e,t]),null}function uSe(t,e,r,n){return t==="vertical"&&wr(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var hSe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function fV(t){var e=Va(t,hSe),r=HNe(),n=$4e(),i=B3e(),{width:a,height:o,wrapperStyle:l,portal:c}=e,[u,f]=xG([r]),p=tV(),x=rV();if(p==null||x==null)return null;var m=p-(i?.left||0)-(i?.right||0),y=uSe(e.layout,o,a,m),v=c?l:Nm(Nm({position:"absolute",width:y?.width||a||"auto",height:y?.height||o||"auto"},lSe(l,e,i,p,x,u)),l),j=c??n;if(j==null||r==null)return null;var N=b.createElement("div",{className:"recharts-legend-wrapper",style:v,ref:f},b.createElement(cSe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&b.createElement(dSe,{width:u.width,height:u.height}),b.createElement(oSe,__({},e,y,{margin:i,chartWidth:p,chartHeight:x,contextPayload:r})));return Gn.createPortal(N,j)}fV.displayName="Legend";function C_(){return C_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},C_.apply(null,arguments)}function rR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function a3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rR(Object(r),!0).forEach(function(n){fSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fSe(t,e,r){return(e=pSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pSe(t){var e=mSe(t,"string");return typeof e=="symbol"?e:e+""}function mSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gSe(t){return Array.isArray(t)&&Ld(t[0])&&Ld(t[1])?t.join(" ~ "):t}var xSe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:f,labelFormatter:p,accessibilityLayer:x=!1}=t,m=()=>{if(a&&a.length){var O={padding:0,margin:0},F=(l?s5(a,l):a).map((T,I)=>{if(T.type==="none")return null;var B=T.formatter||o||gSe,{value:$,name:k}=T,R=$,P=k;if(B){var q=B($,k,T,I,a);if(Array.isArray(q))[R,P]=q;else if(q!=null)R=q;else return null}var X=a3({display:"block",paddingTop:4,paddingBottom:4,color:T.color||"#000"},n);return b.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:X},Ld(P)?b.createElement("span",{className:"recharts-tooltip-item-name"},P):null,Ld(P)?b.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,b.createElement("span",{className:"recharts-tooltip-item-value"},R),b.createElement("span",{className:"recharts-tooltip-item-unit"},T.unit||""))});return b.createElement("ul",{className:"recharts-tooltip-item-list",style:O},F)}return null},y=a3({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=a3({margin:0},i),j=!Na(f),N=j?f:"",C=ns("recharts-default-tooltip",c),A=ns("recharts-tooltip-label",u);j&&p&&a!==void 0&&a!==null&&(N=p(f,a));var L=x?{role:"status","aria-live":"assertive"}:{};return b.createElement("div",C_({className:C,style:y},L),b.createElement("p",{className:A,style:v},b.isValidElement(N)?N:"".concat(N)),m())},Vg="recharts-tooltip-wrapper",bSe={visibility:"hidden"};function ySe(t){var{coordinate:e,translateX:r,translateY:n}=t;return ns(Vg,{["".concat(Vg,"-right")]:wr(r)&&e&&wr(e.x)&&r>=e.x,["".concat(Vg,"-left")]:wr(r)&&e&&wr(e.x)&&r<e.x,["".concat(Vg,"-bottom")]:wr(n)&&e&&wr(e.y)&&n>=e.y,["".concat(Vg,"-top")]:wr(n)&&e&&wr(e.y)&&n<e.y})}function nR(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(a&&wr(a[n]))return a[n];var f=r[n]-l-(i>0?i:0),p=r[n]+i;if(e[n])return o[n]?f:p;var x=c[n];if(x==null)return 0;if(o[n]){var m=f,y=x;return m<y?Math.max(p,x):Math.max(f,x)}if(u==null)return 0;var v=p+l,j=x+u;return v>j?Math.max(f,x):Math.max(p,x)}function vSe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function wSe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,f,p;return o.height>0&&o.width>0&&r?(f=nR({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),p=nR({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=vSe({translateX:f,translateY:p,useTranslate3d:l})):u=bSe,{cssProperties:u,cssClasses:ySe({translateX:f,translateY:p,coordinate:r})}}function sR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sR(Object(r),!0).forEach(function(n){A_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function A_(t,e,r){return(e=jSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jSe(t){var e=NSe(t,"string");return typeof e=="symbol"?e:e+""}function NSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kSe extends b.PureComponent{constructor(){super(...arguments),A_(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),A_(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:f,reverseDirection:p,useTranslate3d:x,viewBox:m,wrapperStyle:y,lastBoundingBox:v,innerRef:j,hasPortalFromProps:N}=this.props,{cssClasses:C,cssProperties:A}=wSe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:f,reverseDirection:p,tooltipBox:{height:v.height,width:v.width},useTranslate3d:x,viewBox:m}),L=N?{}:Zv(Zv({transition:c&&e?"transform ".concat(n,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),O=Zv(Zv({},L),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},y);return b.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:C,style:O,ref:j},a)}}var pV=()=>{var t;return(t=mr(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function E_(){return E_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},E_.apply(null,arguments)}function iR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function aR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iR(Object(r),!0).forEach(function(n){SSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SSe(t,e,r){return(e=_Se(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Se(t){var e=CSe(t,"string");return typeof e=="symbol"?e:e+""}function CSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oR={curveBasisClosed:sje,curveBasisOpen:ije,curveBasis:nje,curveBumpX:q4e,curveBumpY:H4e,curveLinearClosed:aje,curveLinear:r5,curveMonotoneX:oje,curveMonotoneY:lje,curveNatural:cje,curveStep:dje,curveStepAfter:hje,curveStepBefore:uje},U2=t=>ii(t.x)&&ii(t.y),lR=t=>t.base!=null&&U2(t.base)&&U2(t),Yg=t=>t.x,Kg=t=>t.y,ASe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(qb(t));return(r==="curveMonotone"||r==="curveBump")&&e?oR["".concat(r).concat(e==="vertical"?"Y":"X")]:oR[r]||r5},ESe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,o=ASe(e,i),l=a?r.filter(U2):r,c;if(Array.isArray(n)){var u=r.map((m,y)=>aR(aR({},m),{},{base:n[y]}));i==="vertical"?c=Hv().y(Kg).x1(Yg).x0(m=>m.base.x):c=Hv().x(Yg).y1(Kg).y0(m=>m.base.y);var f=c.defined(lR).curve(o),p=a?u.filter(lR):u;return f(p)}i==="vertical"&&wr(n)?c=Hv().y(Kg).x1(Yg).x0(n):wr(n)?c=Hv().x(Yg).y1(Kg).y0(n):c=zW().x(Yg).y(Kg);var x=c.defined(U2).curve(o);return x(l)},cA=t=>{var{className:e,points:r,path:n,pathRef:i}=t,a=Xb();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||a,connectNulls:t.connectNulls},l=r&&r.length?ESe(o):n;return b.createElement("path",E_({},Ed(t),Dje(t),{className:ns("recharts-curve",e),d:l===null?void 0:l,ref:i}))},TSe=["x","y","top","left","width","height","className"];function T_(){return T_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},T_.apply(null,arguments)}function cR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function LSe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cR(Object(r),!0).forEach(function(n){OSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OSe(t,e,r){return(e=MSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MSe(t){var e=PSe(t,"string");return typeof e=="symbol"?e:e+""}function PSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ISe(t,e){if(t==null)return{};var r,n,i=RSe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function RSe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var DSe=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),BSe=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:o=0,className:l}=t,c=ISe(t,TSe),u=LSe({x:e,y:r,top:n,left:i,width:a,height:o},c);return!wr(e)||!wr(r)||!wr(a)||!wr(o)||!wr(n)||!wr(i)?null:b.createElement("path",T_({},tc(u),{className:ns("recharts-cross",l),d:DSe(e,r,a,o,n,i)}))};function $Se(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function dR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dR(Object(r),!0).forEach(function(n){FSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FSe(t,e,r){return(e=USe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function USe(t){var e=zSe(t,"string");return typeof e=="symbol"?e:e+""}function zSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qSe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),mV=(t,e,r)=>t.map(n=>"".concat(qSe(n)," ").concat(e,"ms ").concat(r)).join(","),HSe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),db=(t,e)=>Object.keys(e).reduce((r,n)=>uR(uR({},r),{},{[n]:t(n,e[n])}),{});function hR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ea(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hR(Object(r),!0).forEach(function(n){WSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WSe(t,e,r){return(e=GSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GSe(t){var e=VSe(t,"string");return typeof e=="symbol"?e:e+""}function VSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z2=(t,e,r)=>t+(e-t)*r,L_=t=>{var{from:e,to:r}=t;return e!==r},gV=(t,e,r)=>{var n=db((i,a)=>{if(L_(a)){var[o,l]=t(a.from,a.to,a.velocity);return ea(ea({},a),{},{from:o,velocity:l})}return a},e);return r<1?db((i,a)=>L_(a)&&n[i]!=null?ea(ea({},a),{},{velocity:z2(a.velocity,n[i].velocity,r),from:z2(a.from,n[i].from,r)}):a,e):gV(t,n,r-1)};function YSe(t,e,r,n,i,a){var o,l=n.reduce((x,m)=>ea(ea({},x),{},{[m]:{from:t[m],velocity:0,to:e[m]}}),{}),c=()=>db((x,m)=>m.from,l),u=()=>!Object.values(l).filter(L_).length,f=null,p=x=>{o||(o=x);var m=x-o,y=m/r.dt;l=gV(r,l,y),i(ea(ea(ea({},t),e),c())),o=x,u()||(f=a.setTimeout(p))};return()=>(f=a.setTimeout(p),()=>{var x;(x=f)===null||x===void 0||x()})}function KSe(t,e,r,n,i,a,o){var l=null,c=i.reduce((p,x)=>{var m=t[x],y=e[x];return m==null||y==null?p:ea(ea({},p),{},{[x]:[m,y]})},{}),u,f=p=>{u||(u=p);var x=(p-u)/n,m=db((v,j)=>z2(...j,r(x)),c);if(a(ea(ea(ea({},t),e),m)),x<1)l=o.setTimeout(f);else{var y=db((v,j)=>z2(...j,r(1)),c);a(ea(ea(ea({},t),e),y))}};return()=>(l=o.setTimeout(f),()=>{var p;(p=l)===null||p===void 0||p()})}const XSe=(t,e,r,n,i,a)=>{var o=HSe(t,e);return r==null?()=>(i(ea(ea({},t),e)),()=>{}):r.isStepper===!0?YSe(t,e,r,o,i,a):KSe(t,e,r,n,o,i,a)};var q2=1e-4,xV=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],bV=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),fR=(t,e)=>r=>{var n=xV(t,e);return bV(n,r)},JSe=(t,e)=>r=>{var n=xV(t,e),i=[...n.map((a,o)=>a*o).slice(1),0];return bV(i,r)},ZSe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var i=n.map(a=>parseFloat(a));return[i[0],i[1],i[2],i[3]]},QSe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=ZSe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},e_e=(t,e,r,n)=>{var i=fR(t,r),a=fR(e,n),o=JSe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var f=u>1?1:u,p=f,x=0;x<8;++x){var m=i(p)-f,y=o(p);if(Math.abs(m-f)<q2||y<q2)return a(p);p=l(p-m/y)}return a(p)};return c.isStepper=!1,c},pR=function(){return e_e(...QSe(...arguments))},t_e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(o,l,c)=>{var u=-(o-l)*r,f=c*n,p=c+(u-f)*i/1e3,x=c*i/1e3+o;return Math.abs(x-l)<q2&&Math.abs(p)<q2?[l,0]:[x,p]};return a.isStepper=!0,a.dt=i,a},r_e=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return pR(t);case"spring":return t_e();default:if(t.split("(")[0]==="cubic-bezier")return pR(t)}return typeof t=="function"?t:null};function n_e(t){var e,r=()=>null,n=!1,i=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=t.setTimeout(a.bind(null,u),c);return}a(c),i=t.setTimeout(a.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),a(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class s_e{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{i!=null&&cancelAnimationFrame(i)}}}function i_e(){return n_e(new s_e)}var a_e=b.createContext(i_e);function o_e(t,e){var r=b.useContext(a_e);return b.useMemo(()=>e??r(t),[t,e,r])}var l_e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),N5={isSsr:l_e()},c_e={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},mR={t:0},o3={t:1};function k5(t){var e=Va(t,c_e),{isActive:r,canBegin:n,duration:i,easing:a,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,f=r==="auto"?!N5.isSsr:r,p=o_e(e.animationId,e.animationManager),[x,m]=b.useState(f?mR:o3),y=b.useRef(null);return b.useEffect(()=>{f||m(o3)},[f]),b.useEffect(()=>{if(!f||!n)return Hb;var v=XSe(mR,o3,r_e(a),i,m,p.getTimeoutController()),j=()=>{y.current=v()};return p.start([c,o,j,i,l]),()=>{p.stop(),y.current&&y.current(),l()}},[f,n,i,a,o,c,l,p]),u(x.t)}function S5(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=b.useRef(nb(e)),n=b.useRef(t);return n.current!==t&&(r.current=nb(e),n.current=t),r.current}var d_e=["radius"],u_e=["radius"],gR,xR,bR,yR,vR,wR,jR,NR,kR,SR;function _R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function CR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_R(Object(r),!0).forEach(function(n){h_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_R(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function h_e(t,e,r){return(e=f_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f_e(t){var e=p_e(t,"string");return typeof e=="symbol"?e:e+""}function p_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H2(){return H2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},H2.apply(null,arguments)}function AR(t,e){if(t==null)return{};var r,n,i=m_e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function m_e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function cd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var ER=(t,e,r,n,i)=>{var a=Yh(r),o=Yh(n),l=Math.min(Math.abs(a)/2,Math.abs(o)/2),c=o>=0?1:-1,u=a>=0?1:-1,f=o>=0&&a>=0||o<0&&a<0?1:0,p;if(l>0&&i instanceof Array){for(var x=[0,0,0,0],m=0,y=4;m<y;m++)x[m]=i[m]>l?l:i[m];p=bi(gR||(gR=cd(["M",",",""])),t,e+c*x[0]),x[0]>0&&(p+=bi(xR||(xR=cd(["A ",",",",0,0,",",",",",""])),x[0],x[0],f,t+u*x[0],e)),p+=bi(bR||(bR=cd(["L ",",",""])),t+r-u*x[1],e),x[1]>0&&(p+=bi(yR||(yR=cd(["A ",",",",0,0,",`,
        `,",",""])),x[1],x[1],f,t+r,e+c*x[1])),p+=bi(vR||(vR=cd(["L ",",",""])),t+r,e+n-c*x[2]),x[2]>0&&(p+=bi(wR||(wR=cd(["A ",",",",0,0,",`,
        `,",",""])),x[2],x[2],f,t+r-u*x[2],e+n)),p+=bi(jR||(jR=cd(["L ",",",""])),t+u*x[3],e+n),x[3]>0&&(p+=bi(NR||(NR=cd(["A ",",",",0,0,",`,
        `,",",""])),x[3],x[3],f,t,e+n-c*x[3])),p+="Z"}else if(l>0&&i===+i&&i>0){var v=Math.min(l,i);p=bi(kR||(kR=cd(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*v,v,v,f,t+u*v,e,t+r-u*v,e,v,v,f,t+r,e+c*v,t+r,e+n-c*v,v,v,f,t+r-u*v,e+n,t+u*v,e+n,v,v,f,t,e+n-c*v)}else p=bi(SR||(SR=cd(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return p},TR={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},yV=t=>{var e=Va(t,TR),r=b.useRef(null),[n,i]=b.useState(-1);b.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ne=r.current.getTotalLength();ne&&i(ne)}catch{}},[]);var{x:a,y:o,width:l,height:c,radius:u,className:f}=e,{animationEasing:p,animationDuration:x,animationBegin:m,isAnimationActive:y,isUpdateAnimationActive:v}=e,j=b.useRef(l),N=b.useRef(c),C=b.useRef(a),A=b.useRef(o),L=b.useMemo(()=>({x:a,y:o,width:l,height:c,radius:u}),[a,o,l,c,u]),O=S5(L,"rectangle-");if(a!==+a||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var F=ns("recharts-rectangle",f);if(!v){var T=tc(e),{radius:I}=T,B=AR(T,d_e);return b.createElement("path",H2({},B,{x:Yh(a),y:Yh(o),width:Yh(l),height:Yh(c),radius:typeof u=="number"?u:void 0,className:F,d:ER(a,o,l,c,u)}))}var $=j.current,k=N.current,R=C.current,P=A.current,q="0px ".concat(n===-1?1:n,"px"),X="".concat(n,"px 0px"),G=mV(["strokeDasharray"],x,typeof p=="string"?p:TR.animationEasing);return b.createElement(k5,{animationId:O,key:O,canBegin:n>0,duration:x,easing:p,isActive:v,begin:m},ne=>{var ee=Qi($,l,ne),se=Qi(k,c,ne),J=Qi(R,a,ne),W=Qi(P,o,ne);r.current&&(j.current=ee,N.current=se,C.current=J,A.current=W);var U;y?ne>0?U={transition:G,strokeDasharray:X}:U={strokeDasharray:q}:U={strokeDasharray:X};var Y=tc(e),{radius:te}=Y,ce=AR(Y,u_e);return b.createElement("path",H2({},ce,{radius:typeof u=="number"?u:void 0,className:F,d:ER(J,W,ee,se,u),ref:r,style:CR(CR({},U),e.style)}))})};function LR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function OR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LR(Object(r),!0).forEach(function(n){g_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g_e(t,e,r){return(e=x_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x_e(t){var e=b_e(t,"string");return typeof e=="symbol"?e:e+""}function b_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var W2=Math.PI/180,y_e=t=>t*180/Math.PI,Fi=(t,e,r,n)=>({x:t+Math.cos(-W2*n)*r,y:e+Math.sin(-W2*n)*r}),vV=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},v_e=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},w_e=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,o=v_e({x:r,y:n},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>a&&(c=2*Math.PI-c),{radius:o,angle:y_e(c),angleInRadian:c}},j_e=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},N_e=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return t+o*360},k_e=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:i,angle:a}=w_e({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=j_e(e),f=a,p;if(c<=u){for(;f>u;)f-=360;for(;f<c;)f+=360;p=f>=c&&f<=u}else{for(;f>c;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=c}return p?OR(OR({},e),{},{radius:i,angle:N_e(f,e)}):null};function wV(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,o=Fi(e,r,n,i),l=Fi(e,r,n,a);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}var MR,PR,IR,RR,DR,BR,$R;function O_(){return O_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O_.apply(null,arguments)}function Yf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var S_e=(t,e)=>{var r=Ha(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},Qv=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,f=Math.asin(l/u)/W2,p=c?i:i+a*f,x=Fi(e,r,u,p),m=Fi(e,r,n,p),y=c?i-a*f:i,v=Fi(e,r,u*Math.cos(f*W2),y);return{center:x,circleTangency:m,lineTangency:v,theta:f}},jV=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o}=t,l=S_e(a,o),c=a+l,u=Fi(e,r,i,a),f=Fi(e,r,i,c),p=bi(MR||(MR=Yf(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(a>c),f.x,f.y);if(n>0){var x=Fi(e,r,n,a),m=Fi(e,r,n,c);p+=bi(PR||(PR=Yf(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),m.x,m.y,n,n,+(Math.abs(l)>180),+(a<=c),x.x,x.y)}else p+=bi(IR||(IR=Yf(["L ",","," Z"])),e,r);return p},__e=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,f=Ha(u-c),{circleTangency:p,lineTangency:x,theta:m}=Qv({cx:e,cy:r,radius:i,angle:c,sign:f,cornerRadius:a,cornerIsExternal:l}),{circleTangency:y,lineTangency:v,theta:j}=Qv({cx:e,cy:r,radius:i,angle:u,sign:-f,cornerRadius:a,cornerIsExternal:l}),N=l?Math.abs(c-u):Math.abs(c-u)-m-j;if(N<0)return o?bi(RR||(RR=Yf(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),x.x,x.y,a,a,a*2,a,a,-a*2):jV({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var C=bi(DR||(DR=Yf(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),x.x,x.y,a,a,+(f<0),p.x,p.y,i,i,+(N>180),+(f<0),y.x,y.y,a,a,+(f<0),v.x,v.y);if(n>0){var{circleTangency:A,lineTangency:L,theta:O}=Qv({cx:e,cy:r,radius:n,angle:c,sign:f,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),{circleTangency:F,lineTangency:T,theta:I}=Qv({cx:e,cy:r,radius:n,angle:u,sign:-f,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),B=l?Math.abs(c-u):Math.abs(c-u)-O-I;if(B<0&&a===0)return"".concat(C,"L").concat(e,",").concat(r,"Z");C+=bi(BR||(BR=Yf(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),T.x,T.y,a,a,+(f<0),F.x,F.y,n,n,+(B>180),+(f>0),A.x,A.y,a,a,+(f<0),L.x,L.y)}else C+=bi($R||($R=Yf(["L",",","Z"])),e,r);return C},C_e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},NV=t=>{var e=Va(t,C_e),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:f,className:p}=e;if(a<i||u===f)return null;var x=ns("recharts-sector",p),m=a-i,y=oo(o,m,0,!0),v;return y>0&&Math.abs(u-f)<360?v=__e({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(y,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:f}):v=jV({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:u,endAngle:f}),b.createElement("path",O_({},tc(e),{className:x,d:v}))};function A_e(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(rG(e)){if(t==="centric"){var{cx:n,cy:i,innerRadius:a,outerRadius:o,angle:l}=e,c=Fi(n,i,a,l),u=Fi(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return wV(e)}}var l3={},c3={},d3={},FR;function E_e(){return FR||(FR=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pG();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(d3)),d3}var UR;function T_e(){return UR||(UR=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=E_e();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(c3)),c3}var zR;function L_e(){return zR||(zR=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mG(),r=T_e();function n(i,a,o){o&&typeof o!="number"&&e.isIterateeCall(i,a,o)&&(a=o=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),o=o===void 0?i<a?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((a-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}t.range=n})(l3)),l3}var u3,qR;function O_e(){return qR||(qR=1,u3=L_e().range),u3}var M_e=O_e();const kV=Co(M_e);function tf(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function P_e(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function dA(t){let e,r,n;t.length!==2?(e=tf,r=(l,c)=>tf(t(l),c),n=(l,c)=>t(l)-c):(e=t===tf||t===P_e?t:I_e,r=t,n=t);function i(l,c,u=0,f=l.length){if(u<f){if(e(c,c)!==0)return f;do{const p=u+f>>>1;r(l[p],c)<0?u=p+1:f=p}while(u<f)}return u}function a(l,c,u=0,f=l.length){if(u<f){if(e(c,c)!==0)return f;do{const p=u+f>>>1;r(l[p],c)<=0?u=p+1:f=p}while(u<f)}return u}function o(l,c,u=0,f=l.length){const p=i(l,c,u,f-1);return p>u&&n(l[p-1],c)>-n(l[p],c)?p-1:p}return{left:i,center:o,right:a}}function I_e(){return 0}function SV(t){return t===null?NaN:+t}function*R_e(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const D_e=dA(tf),Zb=D_e.right;dA(SV).center;class HR extends Map{constructor(e,r=F_e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(WR(this,e))}has(e){return super.has(WR(this,e))}set(e,r){return super.set(B_e(this,e),r)}delete(e){return super.delete($_e(this,e))}}function WR({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function B_e({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function $_e({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function F_e(t){return t!==null&&typeof t=="object"?t.valueOf():t}function U_e(t=tf){if(t===tf)return _V;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function _V(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const z_e=Math.sqrt(50),q_e=Math.sqrt(10),H_e=Math.sqrt(2);function G2(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=z_e?10:a>=q_e?5:a>=H_e?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?G2(t,e,r*2):[l,c,u]}function M_(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,o]=n?G2(e,t,r):G2(t,e,r);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(a-u)/-o;else for(let u=0;u<l;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function P_(t,e,r){return e=+e,t=+t,r=+r,G2(t,e,r)[2]}function I_(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?P_(e,t,r):P_(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function GR(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function VR(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function CV(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?_V:U_e(i);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,f=Math.log(c),p=.5*Math.exp(2*f/3),x=.5*Math.sqrt(f*p*(c-p)/c)*(u-c/2<0?-1:1),m=Math.max(r,Math.floor(e-u*p/c+x)),y=Math.min(n,Math.floor(e+(c-u)*p/c+x));CV(t,e,m,y,i)}const a=t[e];let o=r,l=n;for(Xg(t,r,e),i(t[n],a)>0&&Xg(t,r,n);o<l;){for(Xg(t,o,l),++o,--l;i(t[o],a)<0;)++o;for(;i(t[l],a)>0;)--l}i(t[r],a)===0?Xg(t,r,l):(++l,Xg(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Xg(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function W_e(t,e,r){if(t=Float64Array.from(R_e(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return VR(t);if(e>=1)return GR(t);var n,i=(n-1)*e,a=Math.floor(i),o=GR(CV(t,a).subarray(0,a+1)),l=VR(t.subarray(a+1));return o+(l-o)*(i-a)}}function G_e(t,e,r=SV){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),o=+r(t[a],a,t),l=+r(t[a+1],a+1,t);return o+(l-o)*(i-a)}}function V_e(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function sc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ku(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const R_=Symbol("implicit");function uA(){var t=new HR,e=[],r=[],n=R_;function i(a){let o=t.get(a);if(o===void 0){if(n!==R_)return n;t.set(a,o=e.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new HR;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return uA(e,r).unknown(n)},sc.apply(i,arguments),i}function hA(){var t=uA().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,o,l=!1,c=0,u=0,f=.5;delete t.unknown;function p(){var x=e().length,m=i<n,y=m?i:n,v=m?n:i;a=(v-y)/Math.max(1,x-c+u*2),l&&(a=Math.floor(a)),y+=(v-y-a*(x-c))*f,o=a*(1-c),l&&(y=Math.round(y),o=Math.round(o));var j=V_e(x).map(function(N){return y+a*N});return r(m?j.reverse():j)}return t.domain=function(x){return arguments.length?(e(x),p()):e()},t.range=function(x){return arguments.length?([n,i]=x,n=+n,i=+i,p()):[n,i]},t.rangeRound=function(x){return[n,i]=x,n=+n,i=+i,l=!0,p()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(x){return arguments.length?(l=!!x,p()):l},t.padding=function(x){return arguments.length?(c=Math.min(1,u=+x),p()):c},t.paddingInner=function(x){return arguments.length?(c=Math.min(1,x),p()):c},t.paddingOuter=function(x){return arguments.length?(u=+x,p()):u},t.align=function(x){return arguments.length?(f=Math.max(0,Math.min(1,x)),p()):f},t.copy=function(){return hA(e(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(f)},sc.apply(p(),arguments)}function AV(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return AV(e())},t}function Y_e(){return AV(hA.apply(null,arguments).paddingInner(1))}function fA(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function EV(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Qb(){}var ub=.7,V2=1/ub,hm="\\s*([+-]?\\d+)\\s*",hb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",K_e=/^#([0-9a-f]{3,8})$/,X_e=new RegExp(`^rgb\\(${hm},${hm},${hm}\\)$`),J_e=new RegExp(`^rgb\\(${Nd},${Nd},${Nd}\\)$`),Z_e=new RegExp(`^rgba\\(${hm},${hm},${hm},${hb}\\)$`),Q_e=new RegExp(`^rgba\\(${Nd},${Nd},${Nd},${hb}\\)$`),e6e=new RegExp(`^hsl\\(${hb},${Nd},${Nd}\\)$`),t6e=new RegExp(`^hsla\\(${hb},${Nd},${Nd},${hb}\\)$`),YR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fA(Qb,fb,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:KR,formatHex:KR,formatHex8:r6e,formatHsl:n6e,formatRgb:XR,toString:XR});function KR(){return this.rgb().formatHex()}function r6e(){return this.rgb().formatHex8()}function n6e(){return TV(this).formatHsl()}function XR(){return this.rgb().formatRgb()}function fb(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=K_e.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?JR(e):r===3?new tl(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?e1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?e1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=X_e.exec(t))?new tl(e[1],e[2],e[3],1):(e=J_e.exec(t))?new tl(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Z_e.exec(t))?e1(e[1],e[2],e[3],e[4]):(e=Q_e.exec(t))?e1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=e6e.exec(t))?eD(e[1],e[2]/100,e[3]/100,1):(e=t6e.exec(t))?eD(e[1],e[2]/100,e[3]/100,e[4]):YR.hasOwnProperty(t)?JR(YR[t]):t==="transparent"?new tl(NaN,NaN,NaN,0):null}function JR(t){return new tl(t>>16&255,t>>8&255,t&255,1)}function e1(t,e,r,n){return n<=0&&(t=e=r=NaN),new tl(t,e,r,n)}function s6e(t){return t instanceof Qb||(t=fb(t)),t?(t=t.rgb(),new tl(t.r,t.g,t.b,t.opacity)):new tl}function D_(t,e,r,n){return arguments.length===1?s6e(t):new tl(t,e,r,n??1)}function tl(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}fA(tl,D_,EV(Qb,{brighter(t){return t=t==null?V2:Math.pow(V2,t),new tl(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ub:Math.pow(ub,t),new tl(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tl(r0(this.r),r0(this.g),r0(this.b),Y2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZR,formatHex:ZR,formatHex8:i6e,formatRgb:QR,toString:QR}));function ZR(){return`#${Kf(this.r)}${Kf(this.g)}${Kf(this.b)}`}function i6e(){return`#${Kf(this.r)}${Kf(this.g)}${Kf(this.b)}${Kf((isNaN(this.opacity)?1:this.opacity)*255)}`}function QR(){const t=Y2(this.opacity);return`${t===1?"rgb(":"rgba("}${r0(this.r)}, ${r0(this.g)}, ${r0(this.b)}${t===1?")":`, ${t})`}`}function Y2(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function r0(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Kf(t){return t=r0(t),(t<16?"0":"")+t.toString(16)}function eD(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ec(t,e,r,n)}function TV(t){if(t instanceof Ec)return new Ec(t.h,t.s,t.l,t.opacity);if(t instanceof Qb||(t=fb(t)),!t)return new Ec;if(t instanceof Ec)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),o=NaN,l=a-i,c=(a+i)/2;return l?(e===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new Ec(o,l,c,t.opacity)}function a6e(t,e,r,n){return arguments.length===1?TV(t):new Ec(t,e,r,n??1)}function Ec(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}fA(Ec,a6e,EV(Qb,{brighter(t){return t=t==null?V2:Math.pow(V2,t),new Ec(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ub:Math.pow(ub,t),new Ec(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new tl(h3(t>=240?t-240:t+120,i,n),h3(t,i,n),h3(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Ec(tD(this.h),t1(this.s),t1(this.l),Y2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Y2(this.opacity);return`${t===1?"hsl(":"hsla("}${tD(this.h)}, ${t1(this.s)*100}%, ${t1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function tD(t){return t=(t||0)%360,t<0?t+360:t}function t1(t){return Math.max(0,Math.min(1,t||0))}function h3(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const pA=t=>()=>t;function o6e(t,e){return function(r){return t+r*e}}function l6e(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function c6e(t){return(t=+t)==1?LV:function(e,r){return r-e?l6e(e,r,t):pA(isNaN(e)?r:e)}}function LV(t,e){var r=e-t;return r?o6e(t,r):pA(isNaN(t)?e:t)}const rD=(function t(e){var r=c6e(e);function n(i,a){var o=r((i=D_(i)).r,(a=D_(a)).r),l=r(i.g,a.g),c=r(i.b,a.b),u=LV(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=l(f),i.b=c(f),i.opacity=u(f),i+""}}return n.gamma=t,n})(1);function d6e(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function u6e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function h6e(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=qm(t[o],e[o]);for(;o<r;++o)a[o]=e[o];return function(l){for(o=0;o<n;++o)a[o]=i[o](l);return a}}function f6e(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function K2(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function p6e(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=qm(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var B_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,f3=new RegExp(B_.source,"g");function m6e(t){return function(){return t}}function g6e(t){return function(e){return t(e)+""}}function x6e(t,e){var r=B_.lastIndex=f3.lastIndex=0,n,i,a,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=B_.exec(t))&&(i=f3.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:K2(n,i)})),r=f3.lastIndex;return r<e.length&&(a=e.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?g6e(c[0].x):m6e(e):(e=c.length,function(u){for(var f=0,p;f<e;++f)l[(p=c[f]).i]=p.x(u);return l.join("")})}function qm(t,e){var r=typeof e,n;return e==null||r==="boolean"?pA(e):(r==="number"?K2:r==="string"?(n=fb(e))?(e=n,rD):x6e:e instanceof fb?rD:e instanceof Date?f6e:u6e(e)?d6e:Array.isArray(e)?h6e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?p6e:K2)(t,e)}function mA(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function b6e(t,e){e===void 0&&(e=t,t=qm);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[l](o-l)}}function y6e(t){return function(){return t}}function X2(t){return+t}var nD=[0,1];function wo(t){return t}function $_(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:y6e(isNaN(e)?NaN:.5)}function v6e(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function w6e(t,e,r){var n=t[0],i=t[1],a=e[0],o=e[1];return i<n?(n=$_(i,n),a=r(o,a)):(n=$_(n,i),a=r(a,o)),function(l){return a(n(l))}}function j6e(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=$_(t[o],t[o+1]),a[o]=r(e[o],e[o+1]);return function(l){var c=Zb(t,l,1,n)-1;return a[c](i[c](l))}}function ey(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function _5(){var t=nD,e=nD,r=qm,n,i,a,o=wo,l,c,u;function f(){var x=Math.min(t.length,e.length);return o!==wo&&(o=v6e(t[0],t[x-1])),l=x>2?j6e:w6e,c=u=null,p}function p(x){return x==null||isNaN(x=+x)?a:(c||(c=l(t.map(n),e,r)))(n(o(x)))}return p.invert=function(x){return o(i((u||(u=l(e,t.map(n),K2)))(x)))},p.domain=function(x){return arguments.length?(t=Array.from(x,X2),f()):t.slice()},p.range=function(x){return arguments.length?(e=Array.from(x),f()):e.slice()},p.rangeRound=function(x){return e=Array.from(x),r=mA,f()},p.clamp=function(x){return arguments.length?(o=x?!0:wo,f()):o!==wo},p.interpolate=function(x){return arguments.length?(r=x,f()):r},p.unknown=function(x){return arguments.length?(a=x,p):a},function(x,m){return n=x,i=m,f()}}function gA(){return _5()(wo,wo)}function N6e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function J2(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function km(t){return t=J2(Math.abs(t)),t?t[1]:NaN}function k6e(t,e){return function(r,n){for(var i=r.length,a=[],o=0,l=t[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return a.reverse().join(e)}}function S6e(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var _6e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pb(t){if(!(e=_6e.exec(t)))throw new Error("invalid format: "+t);var e;return new xA({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pb.prototype=xA.prototype;function xA(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}xA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function C6e(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var OV;function A6e(t,e){var r=J2(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(OV=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+J2(t,Math.max(0,e+a-1))[0]}function sD(t,e){var r=J2(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const iD={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:N6e,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>sD(t*100,e),r:sD,s:A6e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function aD(t){return t}var oD=Array.prototype.map,lD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function E6e(t){var e=t.grouping===void 0||t.thousands===void 0?aD:k6e(oD.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?aD:S6e(oD.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(p){p=pb(p);var x=p.fill,m=p.align,y=p.sign,v=p.symbol,j=p.zero,N=p.width,C=p.comma,A=p.precision,L=p.trim,O=p.type;O==="n"?(C=!0,O="g"):iD[O]||(A===void 0&&(A=12),L=!0,O="g"),(j||x==="0"&&m==="=")&&(j=!0,x="0",m="=");var F=v==="$"?r:v==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",T=v==="$"?n:/[%p]/.test(O)?o:"",I=iD[O],B=/[defgprs%]/.test(O);A=A===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function $(k){var R=F,P=T,q,X,G;if(O==="c")P=I(k)+P,k="";else{k=+k;var ne=k<0||1/k<0;if(k=isNaN(k)?c:I(Math.abs(k),A),L&&(k=C6e(k)),ne&&+k==0&&y!=="+"&&(ne=!1),R=(ne?y==="("?y:l:y==="-"||y==="("?"":y)+R,P=(O==="s"?lD[8+OV/3]:"")+P+(ne&&y==="("?")":""),B){for(q=-1,X=k.length;++q<X;)if(G=k.charCodeAt(q),48>G||G>57){P=(G===46?i+k.slice(q+1):k.slice(q))+P,k=k.slice(0,q);break}}}C&&!j&&(k=e(k,1/0));var ee=R.length+k.length+P.length,se=ee<N?new Array(N-ee+1).join(x):"";switch(C&&j&&(k=e(se+k,se.length?N-P.length:1/0),se=""),m){case"<":k=R+k+P+se;break;case"=":k=R+se+k+P;break;case"^":k=se.slice(0,ee=se.length>>1)+R+k+P+se.slice(ee);break;default:k=se+R+k+P;break}return a(k)}return $.toString=function(){return p+""},$}function f(p,x){var m=u((p=pb(p),p.type="f",p)),y=Math.max(-8,Math.min(8,Math.floor(km(x)/3)))*3,v=Math.pow(10,-y),j=lD[8+y/3];return function(N){return m(v*N)+j}}return{format:u,formatPrefix:f}}var r1,bA,MV;T6e({thousands:",",grouping:[3],currency:["$",""]});function T6e(t){return r1=E6e(t),bA=r1.format,MV=r1.formatPrefix,r1}function L6e(t){return Math.max(0,-km(Math.abs(t)))}function O6e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(km(e)/3)))*3-km(Math.abs(t)))}function M6e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,km(e)-km(t))+1}function PV(t,e,r,n){var i=I_(t,e,r),a;switch(n=pb(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=O6e(i,o))&&(n.precision=a),MV(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=M6e(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=L6e(i))&&(n.precision=a-(n.type==="%")*2);break}}return bA(n)}function mf(t){var e=t.domain;return t.ticks=function(r){var n=e();return M_(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return PV(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,o=n[i],l=n[a],c,u,f=10;for(l<o&&(u=o,o=l,l=u,u=i,i=a,a=u);f-- >0;){if(u=P_(o,l,r),u===c)return n[i]=o,n[a]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function IV(){var t=gA();return t.copy=function(){return ey(t,IV())},sc.apply(t,arguments),mf(t)}function RV(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,X2),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return RV(t).unknown(e)},t=arguments.length?Array.from(t,X2):[0,1],mf(r)}function DV(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),t[r]=e.floor(i),t[n]=e.ceil(a),t}function cD(t){return Math.log(t)}function dD(t){return Math.exp(t)}function P6e(t){return-Math.log(-t)}function I6e(t){return-Math.exp(-t)}function R6e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function D6e(t){return t===10?R6e:t===Math.E?Math.exp:e=>Math.pow(t,e)}function B6e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function uD(t){return(e,r)=>-t(-e,r)}function yA(t){const e=t(cD,dD),r=e.domain;let n=10,i,a;function o(){return i=B6e(n),a=D6e(n),r()[0]<0?(i=uD(i),a=uD(a),t(P6e,I6e)):t(cD,dD),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],f=c[c.length-1];const p=f<u;p&&([u,f]=[f,u]);let x=i(u),m=i(f),y,v;const j=l==null?10:+l;let N=[];if(!(n%1)&&m-x<j){if(x=Math.floor(x),m=Math.ceil(m),u>0){for(;x<=m;++x)for(y=1;y<n;++y)if(v=x<0?y/a(-x):y*a(x),!(v<u)){if(v>f)break;N.push(v)}}else for(;x<=m;++x)for(y=n-1;y>=1;--y)if(v=x>0?y/a(-x):y*a(x),!(v<u)){if(v>f)break;N.push(v)}N.length*2<j&&(N=M_(u,f,j))}else N=M_(x,m,Math.min(m-x,j)).map(a);return p?N.reverse():N},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=pb(c)).precision==null&&(c.trim=!0),c=bA(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return f=>{let p=f/a(Math.round(i(f)));return p*n<n-.5&&(p*=n),p<=u?c(f):""}},e.nice=()=>r(DV(r(),{floor:l=>a(Math.floor(i(l))),ceil:l=>a(Math.ceil(i(l)))})),e}function BV(){const t=yA(_5()).domain([1,10]);return t.copy=()=>ey(t,BV()).base(t.base()),sc.apply(t,arguments),t}function hD(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function fD(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function vA(t){var e=1,r=t(hD(e),fD(e));return r.constant=function(n){return arguments.length?t(hD(e=+n),fD(e)):e},mf(r)}function $V(){var t=vA(_5());return t.copy=function(){return ey(t,$V()).constant(t.constant())},sc.apply(t,arguments)}function pD(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function $6e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function F6e(t){return t<0?-t*t:t*t}function wA(t){var e=t(wo,wo),r=1;function n(){return r===1?t(wo,wo):r===.5?t($6e,F6e):t(pD(r),pD(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},mf(e)}function jA(){var t=wA(_5());return t.copy=function(){return ey(t,jA()).exponent(t.exponent())},sc.apply(t,arguments),t}function U6e(){return jA.apply(null,arguments).exponent(.5)}function mD(t){return Math.sign(t)*t*t}function z6e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function FV(){var t=gA(),e=[0,1],r=!1,n;function i(a){var o=z6e(t(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return t.invert(mD(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,X2)).map(mD)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return FV(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},sc.apply(i,arguments),mf(i)}function UV(){var t=[],e=[],r=[],n;function i(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=G_e(t,o/l);return a}function a(o){return o==null||isNaN(o=+o)?n:e[Zb(r,o)]}return a.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(tf),i()},a.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return UV().domain(t).range(e).unknown(n)},sc.apply(a,arguments)}function zV(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function o(c){return c!=null&&c<=c?i[Zb(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return zV().domain([t,e]).range(i).unknown(a)},sc.apply(mf(o),arguments)}function qV(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[Zb(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return qV().domain(t).range(e).unknown(r)},sc.apply(i,arguments)}const p3=new Date,m3=new Date;function sa(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const o=i(a),l=i.ceil(a);return a-o<l-a?o:l},i.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,l)=>{const c=[];if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<o)||!(l>0))return c;let u;do c.push(u=new Date(+a)),e(a,l),t(a);while(u<a&&a<o);return c},i.filter=a=>sa(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!a(o););else for(;--l>=0;)for(;e(o,1),!a(o););}),r&&(i.count=(a,o)=>(p3.setTime(+a),m3.setTime(+o),t(p3),t(m3),Math.floor(r(p3,m3))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const Z2=sa(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Z2.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?sa(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Z2);Z2.range;const yu=1e3,Jl=yu*60,vu=Jl*60,Iu=vu*24,NA=Iu*7,gD=Iu*30,g3=Iu*365,Xf=sa(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*yu)},(t,e)=>(e-t)/yu,t=>t.getUTCSeconds());Xf.range;const kA=sa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yu)},(t,e)=>{t.setTime(+t+e*Jl)},(t,e)=>(e-t)/Jl,t=>t.getMinutes());kA.range;const SA=sa(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Jl)},(t,e)=>(e-t)/Jl,t=>t.getUTCMinutes());SA.range;const _A=sa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yu-t.getMinutes()*Jl)},(t,e)=>{t.setTime(+t+e*vu)},(t,e)=>(e-t)/vu,t=>t.getHours());_A.range;const CA=sa(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*vu)},(t,e)=>(e-t)/vu,t=>t.getUTCHours());CA.range;const ty=sa(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Jl)/Iu,t=>t.getDate()-1);ty.range;const C5=sa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Iu,t=>t.getUTCDate()-1);C5.range;const HV=sa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Iu,t=>Math.floor(t/Iu));HV.range;function z0(t){return sa(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Jl)/NA)}const A5=z0(0),Q2=z0(1),q6e=z0(2),H6e=z0(3),Sm=z0(4),W6e=z0(5),G6e=z0(6);A5.range;Q2.range;q6e.range;H6e.range;Sm.range;W6e.range;G6e.range;function q0(t){return sa(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/NA)}const E5=q0(0),ew=q0(1),V6e=q0(2),Y6e=q0(3),_m=q0(4),K6e=q0(5),X6e=q0(6);E5.range;ew.range;V6e.range;Y6e.range;_m.range;K6e.range;X6e.range;const AA=sa(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());AA.range;const EA=sa(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());EA.range;const Ru=sa(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ru.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:sa(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});Ru.range;const Du=sa(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Du.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:sa(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});Du.range;function WV(t,e,r,n,i,a){const o=[[Xf,1,yu],[Xf,5,5*yu],[Xf,15,15*yu],[Xf,30,30*yu],[a,1,Jl],[a,5,5*Jl],[a,15,15*Jl],[a,30,30*Jl],[i,1,vu],[i,3,3*vu],[i,6,6*vu],[i,12,12*vu],[n,1,Iu],[n,2,2*Iu],[r,1,NA],[e,1,gD],[e,3,3*gD],[t,1,g3]];function l(u,f,p){const x=f<u;x&&([u,f]=[f,u]);const m=p&&typeof p.range=="function"?p:c(u,f,p),y=m?m.range(u,+f+1):[];return x?y.reverse():y}function c(u,f,p){const x=Math.abs(f-u)/p,m=dA(([,,j])=>j).right(o,x);if(m===o.length)return t.every(I_(u/g3,f/g3,p));if(m===0)return Z2.every(Math.max(I_(u,f,p),1));const[y,v]=o[x/o[m-1][2]<o[m][2]/x?m-1:m];return y.every(v)}return[l,c]}const[J6e,Z6e]=WV(Du,EA,E5,HV,CA,SA),[Q6e,eCe]=WV(Ru,AA,A5,ty,_A,kA);function x3(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function b3(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Jg(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function tCe(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=Zg(i),f=Qg(i),p=Zg(a),x=Qg(a),m=Zg(o),y=Qg(o),v=Zg(l),j=Qg(l),N=Zg(c),C=Qg(c),A={a:ne,A:ee,b:se,B:J,c:null,d:jD,e:jD,f:kCe,g:PCe,G:RCe,H:wCe,I:jCe,j:NCe,L:GV,m:SCe,M:_Ce,p:W,q:U,Q:SD,s:_D,S:CCe,u:ACe,U:ECe,V:TCe,w:LCe,W:OCe,x:null,X:null,y:MCe,Y:ICe,Z:DCe,"%":kD},L={a:Y,A:te,b:ce,B:xe,c:null,d:ND,e:ND,f:UCe,g:JCe,G:QCe,H:BCe,I:$Ce,j:FCe,L:YV,m:zCe,M:qCe,p:ue,q:ve,Q:SD,s:_D,S:HCe,u:WCe,U:GCe,V:VCe,w:YCe,W:KCe,x:null,X:null,y:XCe,Y:ZCe,Z:eAe,"%":kD},O={a:$,A:k,b:R,B:P,c:q,d:vD,e:vD,f:xCe,g:yD,G:bD,H:wD,I:wD,j:fCe,L:gCe,m:hCe,M:pCe,p:B,q:uCe,Q:yCe,s:vCe,S:mCe,u:aCe,U:oCe,V:lCe,w:iCe,W:cCe,x:X,X:G,y:yD,Y:bD,Z:dCe,"%":bCe};A.x=F(r,A),A.X=F(n,A),A.c=F(e,A),L.x=F(r,L),L.X=F(n,L),L.c=F(e,L);function F(Q,pe){return function(Ce){var je=[],we=-1,Te=0,oe=Q.length,De,Nt,ot;for(Ce instanceof Date||(Ce=new Date(+Ce));++we<oe;)Q.charCodeAt(we)===37&&(je.push(Q.slice(Te,we)),(Nt=xD[De=Q.charAt(++we)])!=null?De=Q.charAt(++we):Nt=De==="e"?" ":"0",(ot=pe[De])&&(De=ot(Ce,Nt)),je.push(De),Te=we+1);return je.push(Q.slice(Te,we)),je.join("")}}function T(Q,pe){return function(Ce){var je=Jg(1900,void 0,1),we=I(je,Q,Ce+="",0),Te,oe;if(we!=Ce.length)return null;if("Q"in je)return new Date(je.Q);if("s"in je)return new Date(je.s*1e3+("L"in je?je.L:0));if(pe&&!("Z"in je)&&(je.Z=0),"p"in je&&(je.H=je.H%12+je.p*12),je.m===void 0&&(je.m="q"in je?je.q:0),"V"in je){if(je.V<1||je.V>53)return null;"w"in je||(je.w=1),"Z"in je?(Te=b3(Jg(je.y,0,1)),oe=Te.getUTCDay(),Te=oe>4||oe===0?ew.ceil(Te):ew(Te),Te=C5.offset(Te,(je.V-1)*7),je.y=Te.getUTCFullYear(),je.m=Te.getUTCMonth(),je.d=Te.getUTCDate()+(je.w+6)%7):(Te=x3(Jg(je.y,0,1)),oe=Te.getDay(),Te=oe>4||oe===0?Q2.ceil(Te):Q2(Te),Te=ty.offset(Te,(je.V-1)*7),je.y=Te.getFullYear(),je.m=Te.getMonth(),je.d=Te.getDate()+(je.w+6)%7)}else("W"in je||"U"in je)&&("w"in je||(je.w="u"in je?je.u%7:"W"in je?1:0),oe="Z"in je?b3(Jg(je.y,0,1)).getUTCDay():x3(Jg(je.y,0,1)).getDay(),je.m=0,je.d="W"in je?(je.w+6)%7+je.W*7-(oe+5)%7:je.w+je.U*7-(oe+6)%7);return"Z"in je?(je.H+=je.Z/100|0,je.M+=je.Z%100,b3(je)):x3(je)}}function I(Q,pe,Ce,je){for(var we=0,Te=pe.length,oe=Ce.length,De,Nt;we<Te;){if(je>=oe)return-1;if(De=pe.charCodeAt(we++),De===37){if(De=pe.charAt(we++),Nt=O[De in xD?pe.charAt(we++):De],!Nt||(je=Nt(Q,Ce,je))<0)return-1}else if(De!=Ce.charCodeAt(je++))return-1}return je}function B(Q,pe,Ce){var je=u.exec(pe.slice(Ce));return je?(Q.p=f.get(je[0].toLowerCase()),Ce+je[0].length):-1}function $(Q,pe,Ce){var je=m.exec(pe.slice(Ce));return je?(Q.w=y.get(je[0].toLowerCase()),Ce+je[0].length):-1}function k(Q,pe,Ce){var je=p.exec(pe.slice(Ce));return je?(Q.w=x.get(je[0].toLowerCase()),Ce+je[0].length):-1}function R(Q,pe,Ce){var je=N.exec(pe.slice(Ce));return je?(Q.m=C.get(je[0].toLowerCase()),Ce+je[0].length):-1}function P(Q,pe,Ce){var je=v.exec(pe.slice(Ce));return je?(Q.m=j.get(je[0].toLowerCase()),Ce+je[0].length):-1}function q(Q,pe,Ce){return I(Q,e,pe,Ce)}function X(Q,pe,Ce){return I(Q,r,pe,Ce)}function G(Q,pe,Ce){return I(Q,n,pe,Ce)}function ne(Q){return o[Q.getDay()]}function ee(Q){return a[Q.getDay()]}function se(Q){return c[Q.getMonth()]}function J(Q){return l[Q.getMonth()]}function W(Q){return i[+(Q.getHours()>=12)]}function U(Q){return 1+~~(Q.getMonth()/3)}function Y(Q){return o[Q.getUTCDay()]}function te(Q){return a[Q.getUTCDay()]}function ce(Q){return c[Q.getUTCMonth()]}function xe(Q){return l[Q.getUTCMonth()]}function ue(Q){return i[+(Q.getUTCHours()>=12)]}function ve(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var pe=F(Q+="",A);return pe.toString=function(){return Q},pe},parse:function(Q){var pe=T(Q+="",!1);return pe.toString=function(){return Q},pe},utcFormat:function(Q){var pe=F(Q+="",L);return pe.toString=function(){return Q},pe},utcParse:function(Q){var pe=T(Q+="",!0);return pe.toString=function(){return Q},pe}}}var xD={"-":"",_:" ",0:"0"},Sa=/^\s*\d+/,rCe=/^%/,nCe=/[\\^$*+?|[\]().{}]/g;function Bn(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function sCe(t){return t.replace(nCe,"\\$&")}function Zg(t){return new RegExp("^(?:"+t.map(sCe).join("|")+")","i")}function Qg(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function iCe(t,e,r){var n=Sa.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function aCe(t,e,r){var n=Sa.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function oCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function lCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function cCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function bD(t,e,r){var n=Sa.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function yD(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function dCe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function uCe(t,e,r){var n=Sa.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function hCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function vD(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function fCe(t,e,r){var n=Sa.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function wD(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function pCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function mCe(t,e,r){var n=Sa.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function gCe(t,e,r){var n=Sa.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function xCe(t,e,r){var n=Sa.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function bCe(t,e,r){var n=rCe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function yCe(t,e,r){var n=Sa.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function vCe(t,e,r){var n=Sa.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function jD(t,e){return Bn(t.getDate(),e,2)}function wCe(t,e){return Bn(t.getHours(),e,2)}function jCe(t,e){return Bn(t.getHours()%12||12,e,2)}function NCe(t,e){return Bn(1+ty.count(Ru(t),t),e,3)}function GV(t,e){return Bn(t.getMilliseconds(),e,3)}function kCe(t,e){return GV(t,e)+"000"}function SCe(t,e){return Bn(t.getMonth()+1,e,2)}function _Ce(t,e){return Bn(t.getMinutes(),e,2)}function CCe(t,e){return Bn(t.getSeconds(),e,2)}function ACe(t){var e=t.getDay();return e===0?7:e}function ECe(t,e){return Bn(A5.count(Ru(t)-1,t),e,2)}function VV(t){var e=t.getDay();return e>=4||e===0?Sm(t):Sm.ceil(t)}function TCe(t,e){return t=VV(t),Bn(Sm.count(Ru(t),t)+(Ru(t).getDay()===4),e,2)}function LCe(t){return t.getDay()}function OCe(t,e){return Bn(Q2.count(Ru(t)-1,t),e,2)}function MCe(t,e){return Bn(t.getFullYear()%100,e,2)}function PCe(t,e){return t=VV(t),Bn(t.getFullYear()%100,e,2)}function ICe(t,e){return Bn(t.getFullYear()%1e4,e,4)}function RCe(t,e){var r=t.getDay();return t=r>=4||r===0?Sm(t):Sm.ceil(t),Bn(t.getFullYear()%1e4,e,4)}function DCe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Bn(e/60|0,"0",2)+Bn(e%60,"0",2)}function ND(t,e){return Bn(t.getUTCDate(),e,2)}function BCe(t,e){return Bn(t.getUTCHours(),e,2)}function $Ce(t,e){return Bn(t.getUTCHours()%12||12,e,2)}function FCe(t,e){return Bn(1+C5.count(Du(t),t),e,3)}function YV(t,e){return Bn(t.getUTCMilliseconds(),e,3)}function UCe(t,e){return YV(t,e)+"000"}function zCe(t,e){return Bn(t.getUTCMonth()+1,e,2)}function qCe(t,e){return Bn(t.getUTCMinutes(),e,2)}function HCe(t,e){return Bn(t.getUTCSeconds(),e,2)}function WCe(t){var e=t.getUTCDay();return e===0?7:e}function GCe(t,e){return Bn(E5.count(Du(t)-1,t),e,2)}function KV(t){var e=t.getUTCDay();return e>=4||e===0?_m(t):_m.ceil(t)}function VCe(t,e){return t=KV(t),Bn(_m.count(Du(t),t)+(Du(t).getUTCDay()===4),e,2)}function YCe(t){return t.getUTCDay()}function KCe(t,e){return Bn(ew.count(Du(t)-1,t),e,2)}function XCe(t,e){return Bn(t.getUTCFullYear()%100,e,2)}function JCe(t,e){return t=KV(t),Bn(t.getUTCFullYear()%100,e,2)}function ZCe(t,e){return Bn(t.getUTCFullYear()%1e4,e,4)}function QCe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?_m(t):_m.ceil(t),Bn(t.getUTCFullYear()%1e4,e,4)}function eAe(){return"+0000"}function kD(){return"%"}function SD(t){return+t}function _D(t){return Math.floor(+t/1e3)}var Op,XV,JV;tAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tAe(t){return Op=tCe(t),XV=Op.format,Op.parse,JV=Op.utcFormat,Op.utcParse,Op}function rAe(t){return new Date(t)}function nAe(t){return t instanceof Date?+t:+new Date(+t)}function TA(t,e,r,n,i,a,o,l,c,u){var f=gA(),p=f.invert,x=f.domain,m=u(".%L"),y=u(":%S"),v=u("%I:%M"),j=u("%I %p"),N=u("%a %d"),C=u("%b %d"),A=u("%B"),L=u("%Y");function O(F){return(c(F)<F?m:l(F)<F?y:o(F)<F?v:a(F)<F?j:n(F)<F?i(F)<F?N:C:r(F)<F?A:L)(F)}return f.invert=function(F){return new Date(p(F))},f.domain=function(F){return arguments.length?x(Array.from(F,nAe)):x().map(rAe)},f.ticks=function(F){var T=x();return t(T[0],T[T.length-1],F??10)},f.tickFormat=function(F,T){return T==null?O:u(T)},f.nice=function(F){var T=x();return(!F||typeof F.range!="function")&&(F=e(T[0],T[T.length-1],F??10)),F?x(DV(T,F)):f},f.copy=function(){return ey(f,TA(t,e,r,n,i,a,o,l,c,u))},f}function sAe(){return sc.apply(TA(Q6e,eCe,Ru,AA,A5,ty,_A,kA,Xf,XV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function iAe(){return sc.apply(TA(J6e,Z6e,Du,EA,E5,C5,CA,SA,Xf,JV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function T5(){var t=0,e=1,r,n,i,a,o=wo,l=!1,c;function u(p){return p==null||isNaN(p=+p)?c:o(i===0?.5:(p=(a(p)-r)*i,l?Math.max(0,Math.min(1,p)):p))}u.domain=function(p){return arguments.length?([t,e]=p,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(p){return arguments.length?(l=!!p,u):l},u.interpolator=function(p){return arguments.length?(o=p,u):o};function f(p){return function(x){var m,y;return arguments.length?([m,y]=x,o=p(m,y),u):[o(0),o(1)]}}return u.range=f(qm),u.rangeRound=f(mA),u.unknown=function(p){return arguments.length?(c=p,u):c},function(p){return a=p,r=p(t),n=p(e),i=r===n?0:1/(n-r),u}}function gf(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ZV(){var t=mf(T5()(wo));return t.copy=function(){return gf(t,ZV())},Ku.apply(t,arguments)}function QV(){var t=yA(T5()).domain([1,10]);return t.copy=function(){return gf(t,QV()).base(t.base())},Ku.apply(t,arguments)}function eY(){var t=vA(T5());return t.copy=function(){return gf(t,eY()).constant(t.constant())},Ku.apply(t,arguments)}function LA(){var t=wA(T5());return t.copy=function(){return gf(t,LA()).exponent(t.exponent())},Ku.apply(t,arguments)}function aAe(){return LA.apply(null,arguments).exponent(.5)}function tY(){var t=[],e=wo;function r(n){if(n!=null&&!isNaN(n=+n))return e((Zb(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(tf),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>W_e(t,a/n))},r.copy=function(){return tY(e).domain(t)},Ku.apply(r,arguments)}function L5(){var t=0,e=.5,r=1,n=1,i,a,o,l,c,u=wo,f,p=!1,x;function m(v){return isNaN(v=+v)?x:(v=.5+((v=+f(v))-a)*(n*v<n*a?l:c),u(p?Math.max(0,Math.min(1,v)):v))}m.domain=function(v){return arguments.length?([t,e,r]=v,i=f(t=+t),a=f(e=+e),o=f(r=+r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,m):[t,e,r]},m.clamp=function(v){return arguments.length?(p=!!v,m):p},m.interpolator=function(v){return arguments.length?(u=v,m):u};function y(v){return function(j){var N,C,A;return arguments.length?([N,C,A]=j,u=b6e(v,[N,C,A]),m):[u(0),u(.5),u(1)]}}return m.range=y(qm),m.rangeRound=y(mA),m.unknown=function(v){return arguments.length?(x=v,m):x},function(v){return f=v,i=v(t),a=v(e),o=v(r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,m}}function rY(){var t=mf(L5()(wo));return t.copy=function(){return gf(t,rY())},Ku.apply(t,arguments)}function nY(){var t=yA(L5()).domain([.1,1,10]);return t.copy=function(){return gf(t,nY()).base(t.base())},Ku.apply(t,arguments)}function sY(){var t=vA(L5());return t.copy=function(){return gf(t,sY()).constant(t.constant())},Ku.apply(t,arguments)}function OA(){var t=wA(L5());return t.copy=function(){return gf(t,OA()).exponent(t.exponent())},Ku.apply(t,arguments)}function oAe(){return OA.apply(null,arguments).exponent(.5)}const mx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:hA,scaleDiverging:rY,scaleDivergingLog:nY,scaleDivergingPow:OA,scaleDivergingSqrt:oAe,scaleDivergingSymlog:sY,scaleIdentity:RV,scaleImplicit:R_,scaleLinear:IV,scaleLog:BV,scaleOrdinal:uA,scalePoint:Y_e,scalePow:jA,scaleQuantile:UV,scaleQuantize:zV,scaleRadial:FV,scaleSequential:ZV,scaleSequentialLog:QV,scaleSequentialPow:LA,scaleSequentialQuantile:tY,scaleSequentialSqrt:aAe,scaleSequentialSymlog:eY,scaleSqrt:U6e,scaleSymlog:$V,scaleThreshold:qV,scaleTime:sAe,scaleUtc:iAe,tickFormat:PV},Symbol.toStringTag,{value:"Module"}));var Xu=t=>t.chartData,O5=nt([Xu],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),iY=(t,e,r,n)=>n?O5(t):Xu(t),lAe=(t,e,r)=>r?O5(t):Xu(t);function cf(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(ii(e)&&ii(r))return!0}return!1}function CD(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function aY(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(ii(r))i=r;else if(typeof r=="function")return;if(ii(n))a=n;else if(typeof n=="function")return;var o=[i,a];if(cf(o))return o}}function cAe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(cf(n))return CD(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,o,l;if(i==="auto")e!=null&&(o=Math.min(...e));else if(wr(i))o=i;else if(typeof i=="function")try{e!=null&&(o=i(e?.[0]))}catch{}else if(typeof i=="string"&&RI.test(i)){var c=RI.exec(i);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e?.[0];if(a==="auto")e!=null&&(l=Math.max(...e));else if(wr(a))l=a;else if(typeof a=="function")try{e!=null&&(l=a(e?.[1]))}catch{}else if(typeof a=="string"&&DI.test(a)){var f=DI.exec(a);if(f==null||f[1]==null||e==null)l=void 0;else{var p=+f[1];l=e[1]+p}}else l=e?.[1];var x=[o,l];if(cf(x))return e==null?x:CD(x,e,r)}}}var Hm=1e9,dAe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},PA,Ks=!0,nc="[DecimalError] ",n0=nc+"Invalid argument: ",MA=nc+"Exponent out of range: ",Wm=Math.floor,Ff=Math.pow,uAe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,yl,xa=1e7,Rs=7,oY=9007199254740991,tw=Wm(oY/Rs),nr={};nr.absoluteValue=nr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};nr.comparedTo=nr.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};nr.decimalPlaces=nr.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*Rs;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};nr.dividedBy=nr.div=function(t){return _u(this,new this.constructor(t))};nr.dividedToIntegerBy=nr.idiv=function(t){var e=this,r=e.constructor;return js(_u(e,new r(t),0,1),r.precision)};nr.equals=nr.eq=function(t){return!this.cmp(t)};nr.exponent=function(){return Ui(this)};nr.greaterThan=nr.gt=function(t){return this.cmp(t)>0};nr.greaterThanOrEqualTo=nr.gte=function(t){return this.cmp(t)>=0};nr.isInteger=nr.isint=function(){return this.e>this.d.length-2};nr.isNegative=nr.isneg=function(){return this.s<0};nr.isPositive=nr.ispos=function(){return this.s>0};nr.isZero=function(){return this.s===0};nr.lessThan=nr.lt=function(t){return this.cmp(t)<0};nr.lessThanOrEqualTo=nr.lte=function(t){return this.cmp(t)<1};nr.logarithm=nr.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(yl))throw Error(nc+"NaN");if(r.s<1)throw Error(nc+(r.s?"NaN":"-Infinity"));return r.eq(yl)?new n(0):(Ks=!1,e=_u(mb(r,a),mb(t,a),a),Ks=!0,js(e,i))};nr.minus=nr.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?dY(e,t):lY(e,(t.s=-t.s,t))};nr.modulo=nr.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(nc+"NaN");return r.s?(Ks=!1,e=_u(r,t,0,1).times(t),Ks=!0,r.minus(e)):js(new n(r),i)};nr.naturalExponential=nr.exp=function(){return cY(this)};nr.naturalLogarithm=nr.ln=function(){return mb(this)};nr.negated=nr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};nr.plus=nr.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?lY(e,t):dY(e,(t.s=-t.s,t))};nr.precision=nr.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(n0+t);if(e=Ui(i)+1,n=i.d.length-1,r=n*Rs+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};nr.squareRoot=nr.sqrt=function(){var t,e,r,n,i,a,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(nc+"NaN")}for(t=Ui(l),Ks=!1,i=Math.sqrt(+l),i==0||i==1/0?(e=xd(l.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Wm((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(a=n,n=a.plus(_u(l,a,o+2)).times(.5),xd(a.d).slice(0,o)===(e=xd(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(js(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(e!="9999")break;o+=4}return Ks=!0,js(n,r)};nr.times=nr.mul=function(t){var e,r,n,i,a,o,l,c,u,f=this,p=f.constructor,x=f.d,m=(t=new p(t)).d;if(!f.s||!t.s)return new p(0);for(t.s*=f.s,r=f.e+t.e,c=x.length,u=m.length,c<u&&(a=x,x=m,m=a,o=c,c=u,u=o),a=[],o=c+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(e=0,i=c+n;i>n;)l=a[i]+m[n]*x[i-n-1]+e,a[i--]=l%xa|0,e=l/xa|0;a[i]=(a[i]+e)%xa|0}for(;!a[--o];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ks?js(t,p.precision):t};nr.toDecimalPlaces=nr.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Od(t,0,Hm),e===void 0?e=n.rounding:Od(e,0,8),js(r,t+Ui(r)+1,e))};nr.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=S0(n,!0):(Od(t,0,Hm),e===void 0?e=i.rounding:Od(e,0,8),n=js(new i(n),t+1,e),r=S0(n,!0,t+1)),r};nr.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?S0(i):(Od(t,0,Hm),e===void 0?e=a.rounding:Od(e,0,8),n=js(new a(i),t+Ui(i)+1,e),r=S0(n.abs(),!1,t+Ui(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};nr.toInteger=nr.toint=function(){var t=this,e=t.constructor;return js(new e(t),Ui(t)+1,e.rounding)};nr.toNumber=function(){return+this};nr.toPower=nr.pow=function(t){var e,r,n,i,a,o,l=this,c=l.constructor,u=12,f=+(t=new c(t));if(!t.s)return new c(yl);if(l=new c(l),!l.s){if(t.s<1)throw Error(nc+"Infinity");return l}if(l.eq(yl))return l;if(n=c.precision,t.eq(yl))return js(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,a=l.s,o){if((r=f<0?-f:f)<=oY){for(i=new c(yl),e=Math.ceil(n/Rs+4),Ks=!1;r%2&&(i=i.times(l),ED(i.d,e)),r=Wm(r/2),r!==0;)l=l.times(l),ED(l.d,e);return Ks=!0,t.s<0?new c(yl).div(i):js(i,n)}}else if(a<0)throw Error(nc+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,Ks=!1,i=t.times(mb(l,n+u)),Ks=!0,i=cY(i),i.s=a,i};nr.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=Ui(i),n=S0(i,r<=a.toExpNeg||r>=a.toExpPos)):(Od(t,1,Hm),e===void 0?e=a.rounding:Od(e,0,8),i=js(new a(i),t,e),r=Ui(i),n=S0(i,t<=r||r<=a.toExpNeg,t)),n};nr.toSignificantDigits=nr.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Od(t,1,Hm),e===void 0?e=n.rounding:Od(e,0,8)),js(new n(r),t,e)};nr.toString=nr.valueOf=nr.val=nr.toJSON=nr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Ui(t),r=t.constructor;return S0(t,e<=r.toExpNeg||e>=r.toExpPos)};function lY(t,e){var r,n,i,a,o,l,c,u,f=t.constructor,p=f.precision;if(!t.s||!e.s)return e.s||(e=new f(t)),Ks?js(e,p):e;if(c=t.d,u=e.d,o=t.e,i=e.e,c=c.slice(),a=o-i,a){for(a<0?(n=c,a=-a,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(p/Rs),l=o>l?o+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=c.length,a=u.length,l-a<0&&(a=l,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/xa|0,c[a]%=xa;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=i,Ks?js(e,p):e}function Od(t,e,r){if(t!==~~t||t<e||t>r)throw Error(n0+t)}function xd(t){var e,r,n,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)n=t[e]+"",r=Rs-n.length,r&&(a+=Rh(r)),a+=n;o=t[e],n=o+"",r=Rs-n.length,r&&(a+=Rh(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var _u=(function(){function t(n,i){var a,o=0,l=n.length;for(n=n.slice();l--;)a=n[l]*i+o,n[l]=a%xa|0,o=a/xa|0;return o&&n.unshift(o),n}function e(n,i,a,o){var l,c;if(a!=o)c=a>o?1:-1;else for(l=c=0;l<a;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,a){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*xa+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o){var l,c,u,f,p,x,m,y,v,j,N,C,A,L,O,F,T,I,B=n.constructor,$=n.s==i.s?1:-1,k=n.d,R=i.d;if(!n.s)return new B(n);if(!i.s)throw Error(nc+"Division by zero");for(c=n.e-i.e,T=R.length,O=k.length,m=new B($),y=m.d=[],u=0;R[u]==(k[u]||0);)++u;if(R[u]>(k[u]||0)&&--c,a==null?C=a=B.precision:o?C=a+(Ui(n)-Ui(i))+1:C=a,C<0)return new B(0);if(C=C/Rs+2|0,u=0,T==1)for(f=0,R=R[0],C++;(u<O||f)&&C--;u++)A=f*xa+(k[u]||0),y[u]=A/R|0,f=A%R|0;else{for(f=xa/(R[0]+1)|0,f>1&&(R=t(R,f),k=t(k,f),T=R.length,O=k.length),L=T,v=k.slice(0,T),j=v.length;j<T;)v[j++]=0;I=R.slice(),I.unshift(0),F=R[0],R[1]>=xa/2&&++F;do f=0,l=e(R,v,T,j),l<0?(N=v[0],T!=j&&(N=N*xa+(v[1]||0)),f=N/F|0,f>1?(f>=xa&&(f=xa-1),p=t(R,f),x=p.length,j=v.length,l=e(p,v,x,j),l==1&&(f--,r(p,T<x?I:R,x))):(f==0&&(l=f=1),p=R.slice()),x=p.length,x<j&&p.unshift(0),r(v,p,j),l==-1&&(j=v.length,l=e(R,v,T,j),l<1&&(f++,r(v,T<j?I:R,j))),j=v.length):l===0&&(f++,v=[0]),y[u++]=f,l&&v[0]?v[j++]=k[L]||0:(v=[k[L]],j=1);while((L++<O||v[0]!==void 0)&&C--)}return y[0]||y.shift(),m.e=c,js(m,o?a+Ui(m)+1:a)}})();function cY(t,e){var r,n,i,a,o,l,c=0,u=0,f=t.constructor,p=f.precision;if(Ui(t)>16)throw Error(MA+Ui(t));if(!t.s)return new f(yl);for(Ks=!1,l=p,o=new f(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(Ff(2,u))/Math.LN10*2+5|0,l+=n,r=i=a=new f(yl),f.precision=l;;){if(i=js(i.times(t),l),r=r.times(++c),o=a.plus(_u(i,r,l)),xd(o.d).slice(0,l)===xd(a.d).slice(0,l)){for(;u--;)a=js(a.times(a),l);return f.precision=p,e==null?(Ks=!0,js(a,p)):a}a=o}}function Ui(t){for(var e=t.e*Rs,r=t.d[0];r>=10;r/=10)e++;return e}function y3(t,e,r){if(e>t.LN10.sd())throw Ks=!0,r&&(t.precision=r),Error(nc+"LN10 precision limit exceeded");return js(new t(t.LN10),e)}function Rh(t){for(var e="";t--;)e+="0";return e}function mb(t,e){var r,n,i,a,o,l,c,u,f,p=1,x=10,m=t,y=m.d,v=m.constructor,j=v.precision;if(m.s<1)throw Error(nc+(m.s?"NaN":"-Infinity"));if(m.eq(yl))return new v(0);if(e==null?(Ks=!1,u=j):u=e,m.eq(10))return e==null&&(Ks=!0),y3(v,u);if(u+=x,v.precision=u,r=xd(y),n=r.charAt(0),a=Ui(m),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(t),r=xd(m.d),n=r.charAt(0),p++;a=Ui(m),n>1?(m=new v("0."+r),a++):m=new v(n+"."+r.slice(1))}else return c=y3(v,u+2,j).times(a+""),m=mb(new v(n+"."+r.slice(1)),u-x).plus(c),v.precision=j,e==null?(Ks=!0,js(m,j)):m;for(l=o=m=_u(m.minus(yl),m.plus(yl),u),f=js(m.times(m),u),i=3;;){if(o=js(o.times(f),u),c=l.plus(_u(o,new v(i),u)),xd(c.d).slice(0,u)===xd(l.d).slice(0,u))return l=l.times(2),a!==0&&(l=l.plus(y3(v,u+2,j).times(a+""))),l=_u(l,new v(p),u),v.precision=j,e==null?(Ks=!0,js(l,j)):l;l=c,i+=2}}function AD(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=Wm(r/Rs),t.d=[],n=(r+1)%Rs,r<0&&(n+=Rs),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=Rs;n<i;)t.d.push(+e.slice(n,n+=Rs));e=e.slice(n),n=Rs-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ks&&(t.e>tw||t.e<-tw))throw Error(MA+r)}else t.s=0,t.e=0,t.d=[0];return t}function js(t,e,r){var n,i,a,o,l,c,u,f,p=t.d;for(o=1,a=p[0];a>=10;a/=10)o++;if(n=e-o,n<0)n+=Rs,i=e,u=p[f=0];else{if(f=Math.ceil((n+1)/Rs),a=p.length,f>=a)return t;for(u=a=p[f],o=1;a>=10;a/=10)o++;n%=Rs,i=n-Rs+o}if(r!==void 0&&(a=Ff(10,o-i-1),l=u/a%10|0,c=e<0||p[f+1]!==void 0||u%a,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Ff(10,o-i):0:p[f-1])%10&1||r==(t.s<0?8:7))),e<1||!p[0])return c?(a=Ui(t),p.length=1,e=e-a-1,p[0]=Ff(10,(Rs-e%Rs)%Rs),t.e=Wm(-e/Rs)||0):(p.length=1,p[0]=t.e=t.s=0),t;if(n==0?(p.length=f,a=1,f--):(p.length=f+1,a=Ff(10,Rs-n),p[f]=i>0?(u/Ff(10,o-i)%Ff(10,i)|0)*a:0),c)for(;;)if(f==0){(p[0]+=a)==xa&&(p[0]=1,++t.e);break}else{if(p[f]+=a,p[f]!=xa)break;p[f--]=0,a=1}for(n=p.length;p[--n]===0;)p.pop();if(Ks&&(t.e>tw||t.e<-tw))throw Error(MA+Ui(t));return t}function dY(t,e){var r,n,i,a,o,l,c,u,f,p,x=t.constructor,m=x.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new x(t),Ks?js(e,m):e;if(c=t.d,p=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(f=o<0,f?(r=c,o=-o,l=p.length):(r=p,n=u,l=c.length),i=Math.max(Math.ceil(m/Rs),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=p.length,f=i<l,f&&(l=i),i=0;i<l;i++)if(c[i]!=p[i]){f=c[i]<p[i];break}o=0}for(f&&(r=c,c=p,p=r,e.s=-e.s),l=c.length,i=p.length-l;i>0;--i)c[l++]=0;for(i=p.length;i>o;){if(c[--i]<p[i]){for(a=i;a&&c[--a]===0;)c[a]=xa-1;--c[a],c[i]+=xa}c[i]-=p[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ks?js(e,m):e):new x(0)}function S0(t,e,r){var n,i=Ui(t),a=xd(t.d),o=a.length;return e?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+Rh(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Rh(-i-1)+a,r&&(n=r-o)>0&&(a+=Rh(n))):i>=o?(a+=Rh(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+Rh(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=Rh(n))),t.s<0?"-"+a:a}function ED(t,e){if(t.length>e)return t.length=e,!0}function uY(t){var e,r,n;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(n0+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return AD(o,a.toString())}else if(typeof a!="string")throw Error(n0+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,uAe.test(a))AD(o,a);else throw Error(n0+a)}if(i.prototype=nr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=uY,i.config=i.set=hAe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function hAe(t){if(!t||typeof t!="object")throw Error(nc+"Object expected");var e,r,n,i=["precision",1,Hm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(Wm(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(n0+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(n0+r+": "+n);return this}var PA=uY(dAe);yl=new PA(1);const ts=PA;var fAe=t=>t,hY={},fY=t=>t===hY,TD=t=>function e(){return arguments.length===0||arguments.length===1&&fY(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},pY=(t,e)=>t===1?e:TD(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(o=>o!==hY).length;return a>=t?e(...n):pY(t-a,TD(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(f=>fY(f)?l.shift():f);return e(...u,...l)}))}),pAe=t=>pY(t.length,t),F_=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},mAe=pAe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),gAe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return fAe;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce((l,c)=>c(l),a(...arguments))}};function mY(t){var e;return t===0?e=1:e=Math.floor(new ts(t).abs().log(10).toNumber())+1,e}function gY(t,e,r){for(var n=new ts(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var xY=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},bY=(t,e,r)=>{if(t.lte(0))return new ts(0);var n=mY(t.toNumber()),i=new ts(10).pow(n),a=t.div(i),o=n!==1?.05:.1,l=new ts(Math.ceil(a.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return e?new ts(c.toNumber()):new ts(Math.ceil(c.toNumber()))},xAe=(t,e,r)=>{var n=new ts(1),i=new ts(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new ts(10).pow(mY(t)-1),i=new ts(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new ts(Math.floor(t)))}else t===0?i=new ts(Math.floor((e-1)/2)):r||(i=new ts(Math.floor(t)));var o=Math.floor((e-1)/2),l=gAe(mAe(c=>i.add(new ts(c-o).mul(n)).toNumber()),F_);return l(0,e)},yY=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new ts(0),tickMin:new ts(0),tickMax:new ts(0)};var o=bY(new ts(r).sub(e).div(n-1),i,a),l;e<=0&&r>=0?l=new ts(0):(l=new ts(e).add(r).div(2),l=l.sub(new ts(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new ts(r).sub(l).div(o).toNumber()),f=c+u+1;return f>n?yY(e,r,n,i,a+1):(f<n&&(u=r>0?u+(n-f):u,c=r>0?c:c+(n-f)),{step:o,tickMin:l.sub(new ts(c).mul(o)),tickMax:l.add(new ts(u).mul(o))})},bAe=function(e){var[r,n]=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=xY([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...F_(0,i-1).map(()=>1/0)]:[...F_(0,i-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return xAe(l,i,a);var{step:f,tickMin:p,tickMax:x}=yY(l,c,o,a,0),m=gY(p,x.add(new ts(.1).mul(f)),f);return r>n?m.reverse():m},yAe=function(e,r){var[n,i]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=xY([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=bY(new ts(l).sub(o).div(c-1),a,0),f=[...gY(new ts(o),new ts(l),u),l];return a===!1&&(f=f.map(p=>Math.round(p))),n>i?f.reverse():f},vY=t=>t.rootProps.maxBarSize,vAe=t=>t.rootProps.barGap,wY=t=>t.rootProps.barCategoryGap,wAe=t=>t.rootProps.barSize,ry=t=>t.rootProps.stackOffset,jY=t=>t.rootProps.reverseStackOrder,IA=t=>t.options.chartName,RA=t=>t.rootProps.syncId,NY=t=>t.rootProps.syncMethod,DA=t=>t.options.eventEmitter,ao={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},mu={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},bl={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},M5=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},jAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:mu.angleAxisId,includeHidden:!1,name:void 0,reversed:mu.reversed,scale:mu.scale,tick:mu.tick,tickCount:void 0,ticks:void 0,type:mu.type,unit:void 0},NAe={allowDataOverflow:bl.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:bl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bl.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bl.scale,tick:bl.tick,tickCount:bl.tickCount,ticks:void 0,type:bl.type,unit:void 0},kAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:mu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:mu.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:mu.scale,tick:mu.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},SAe={allowDataOverflow:bl.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:bl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bl.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bl.scale,tick:bl.tick,tickCount:bl.tickCount,ticks:void 0,type:"category",unit:void 0},BA=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?kAe:jAe,$A=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?SAe:NAe,P5=t=>t.polarOptions,FA=nt([Vu,Yu,na],vV),kY=nt([P5,FA],(t,e)=>{if(t!=null)return oo(t.innerRadius,e,0)}),SY=nt([P5,FA],(t,e)=>{if(t!=null)return oo(t.outerRadius,e,e*.8)}),_Ae=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},_Y=nt([P5],_Ae);nt([BA,_Y],M5);var CY=nt([FA,kY,SY],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});nt([$A,CY],M5);var AY=nt([$n,P5,kY,SY,Vu,Yu],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:oo(o,i,i/2),cy:oo(l,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Js=(t,e)=>e,ny=(t,e,r)=>r;function UA(t){return t?.id}function EY(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:i,dataKey:a}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var f=UA(l);u.forEach((p,x)=>{var m=a==null||i?x:String(Bs(p,a,null)),y=Bs(p,l.dataKey,0),v;o.has(m)?v=o.get(m):v={},Object.assign(v,{[f]:y}),o.set(m,v)})}}),Array.from(o.values())}function I5(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var R5=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function D5(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function CAe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var ia=t=>{var e=$n(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Gm=t=>t.tooltip.settings.axisId;function LD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LD(Object(r),!0).forEach(function(n){AAe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AAe(t,e,r){return(e=EAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EAe(t){var e=TAe(t,"string");return typeof e=="symbol"?e:e+""}function TAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var U_=[0,"auto"],ma={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},TY=(t,e)=>t.cartesianAxis.xAxis[e],Ju=(t,e)=>{var r=TY(t,e);return r??ma},ga={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:U_,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Kb},LY=(t,e)=>t.cartesianAxis.yAxis[e],Zu=(t,e)=>{var r=LY(t,e);return r??ga},LAe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},zA=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??LAe},ai=(t,e,r)=>{switch(e){case"xAxis":return Ju(t,r);case"yAxis":return Zu(t,r);case"zAxis":return zA(t,r);case"angleAxis":return BA(t,r);case"radiusAxis":return $A(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},OAe=(t,e,r)=>{switch(e){case"xAxis":return Ju(t,r);case"yAxis":return Zu(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},sy=(t,e,r)=>{switch(e){case"xAxis":return Ju(t,r);case"yAxis":return Zu(t,r);case"angleAxis":return BA(t,r);case"radiusAxis":return $A(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},OY=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function qA(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var HA=t=>t.graphicalItems.cartesianItems,MAe=nt([Js,ny],qA),WA=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),iy=nt([HA,ai,MAe],WA,{memoizeOptions:{resultEqualityCheck:D5}}),MY=nt([iy],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(I5)),PY=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),PAe=nt([iy],PY),GA=t=>t.map(e=>e.data).filter(Boolean).flat(1),IAe=nt([iy],GA,{memoizeOptions:{resultEqualityCheck:D5}}),VA=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},YA=nt([IAe,iY],VA),KA=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Bs(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Bs(i,n)}))):t.map(n=>({value:n})),B5=nt([YA,ai,iy],KA);function IY(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function I1(t){if(Ld(t)||t instanceof Date){var e=Number(t);if(ii(e))return e}}function OD(t){if(Array.isArray(t)){var e=[I1(t[0]),I1(t[1])];return cf(e)?e:void 0}var r=I1(t);if(r!=null)return[r,r]}function Bu(t){return t.map(I1).filter(_je)}function RAe(t,e,r){return!r||typeof e!="number"||Td(e)?[]:r.length?Bu(r.flatMap(n=>{var i=Bs(t,n.dataKey),a,o;if(Array.isArray(i)?[a,o]=i:a=o=i,!(!ii(a)||!ii(o)))return[e-a,e+o]})):[]}var aa=t=>{var e=ia(t),r=Gm(t);return sy(t,e,r)},ay=nt([aa],t=>t?.dataKey),DAe=nt([MY,iY,aa],EY),RY=(t,e,r,n)=>{var i={},a=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(a).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,f=u.map(UA);return[l,{stackedData:e3e(t,f,r),graphicalItems:u}]}))},z_=nt([DAe,MY,ry,jY],RY),DY=(t,e,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=e;if(n==null&&r!=="zAxis"){var o=i3e(t,i,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},BAe=nt([ai],t=>t.allowDataOverflow),XA=t=>{var e;if(t==null||!("domain"in t))return U_;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=Bu(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:U_},JA=nt([ai],XA),ZA=nt([JA,BAe],aY),$Ae=nt([z_,Xu,Js,ZA],DY,{memoizeOptions:{resultEqualityCheck:R5}}),$5=t=>t.errorBars,FAe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>IY(r,n)),nw=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),o=Math.min(...a),l=Math.max(...a);return[o,l]}},QA=(t,e,r,n,i)=>{var a,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,f,p=(u=n[c.id])===null||u===void 0?void 0:u.filter(N=>IY(i,N)),x=Bs(l,(f=e.dataKey)!==null&&f!==void 0?f:c.dataKey),m=RAe(l,x,p);if(m.length>=2){var y=Math.min(...m),v=Math.max(...m);(a==null||y<a)&&(a=y),(o==null||v>o)&&(o=v)}var j=OD(x);j!=null&&(a=a==null?j[0]:Math.min(a,j[0]),o=o==null?j[1]:Math.max(o,j[1]))})}),e?.dataKey!=null&&t.forEach(l=>{var c=OD(Bs(l,e.dataKey));c!=null&&(a=a==null?c[0]:Math.min(a,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),ii(a)&&ii(o))return[a,o]},UAe=nt([YA,ai,PAe,$5,Js],QA,{memoizeOptions:{resultEqualityCheck:R5}});function zAe(t){var{value:e}=t;if(Ld(e)||e instanceof Date)return e}var qAe=(t,e,r)=>{var n=t.map(zAe).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&eG(n))?kV(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},BY=t=>t.referenceElements.dots,Vm=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),HAe=nt([BY,Js,ny],Vm),$Y=t=>t.referenceElements.areas,WAe=nt([$Y,Js,ny],Vm),FY=t=>t.referenceElements.lines,GAe=nt([FY,Js,ny],Vm),UY=(t,e)=>{if(t!=null){var r=Bu(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},VAe=nt(HAe,Js,UY),zY=(t,e)=>{if(t!=null){var r=Bu(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},YAe=nt([WAe,Js],zY);function KAe(t){var e;if(t.x!=null)return Bu([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:Bu(r)}function XAe(t){var e;if(t.y!=null)return Bu([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:Bu(r)}var qY=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?KAe(n):XAe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},JAe=nt([GAe,Js],qY),ZAe=nt(VAe,JAe,YAe,(t,e,r)=>nw(t,r,e)),eE=(t,e,r,n,i,a,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?nw(n,a,i):nw(a,i);return cAe(e,u,t.allowDataOverflow)},QAe=nt([ai,JA,ZA,$Ae,UAe,ZAe,$n,Js],eE,{memoizeOptions:{resultEqualityCheck:R5}}),eEe=[0,1],tE=(t,e,r,n,i,a,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=U0(e,a);if(u&&l==null){var f;return kV(0,(f=r?.length)!==null&&f!==void 0?f:0)}return c==="category"?qAe(n,t,u):i==="expand"?eEe:o}},rE=nt([ai,$n,YA,B5,ry,Js,QAe],tE),HY=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:o}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof a=="string"){var l="scale".concat(qb(a));return l in mx?l:"point"}}},Ym=nt([ai,$n,OY,IA,Js],HY);function tEe(t){if(t!=null){if(t in mx)return mx[t]();var e="scale".concat(qb(t));if(e in mx)return mx[e]()}}function nE(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=tEe(e);if(i!=null){var a=i.domain(r).range(n);return Kke(a),a}}}var sE=(t,e,r)=>{var n=XA(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&cf(t))return bAe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&cf(t))return yAe(t,e.tickCount,e.allowDecimals)}},iE=nt([rE,sy,Ym],sE),aE=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&cf(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],o=e[1],l=r[r.length-1];return[Math.min(i,a),Math.max(o,l)]}return e},rEe=nt([ai,rE,iE,Js],aE),nEe=nt(B5,ai,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Bu(t.map(p=>p.value))).sort((p,x)=>p-x),i=n[0],a=n[n.length-1];if(i==null||a==null)return 1/0;var o=a-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var f=u-c;r=Math.min(r,f)}}return r/o}}),WY=nt(nEe,$n,wY,na,(t,e,r,n,i)=>i,(t,e,r,n,i)=>{if(!ii(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var o=oo(r,t*a),l=t*a/2;return l-o-(l-o)/a*o}return 0}),sEe=(t,e,r)=>{var n=Ju(t,e);return n==null||typeof n.padding!="string"?0:WY(t,"xAxis",e,r,n.padding)},iEe=(t,e,r)=>{var n=Zu(t,e);return n==null||typeof n.padding!="string"?0:WY(t,"yAxis",e,r,n.padding)},aEe=nt(Ju,sEe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),oEe=nt(Zu,iEe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),lEe=nt([na,aEe,x5,g5,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),cEe=nt([na,$n,oEe,x5,g5,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:o}=i;return a?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),oy=(t,e,r,n)=>{var i;switch(e){case"xAxis":return lEe(t,r,n);case"yAxis":return cEe(t,r,n);case"zAxis":return(i=zA(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return _Y(t);case"radiusAxis":return CY(t,r);default:return}},GY=nt([ai,oy],M5),F5=nt([ai,Ym,rEe,GY],nE);nt([iy,$5,Js],FAe);function VY(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var U5=(t,e)=>e,z5=(t,e,r)=>r,dEe=nt(p5,U5,z5,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(VY)),uEe=nt(m5,U5,z5,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(VY)),YY=(t,e)=>({width:t.width,height:e.height}),hEe=(t,e)=>{var r=typeof e.width=="number"?e.width:Kb;return{width:r,height:t.height}},KY=nt(na,Ju,YY),fEe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},pEe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},mEe=nt(Yu,na,dEe,U5,z5,(t,e,r,n,i)=>{var a={},o;return r.forEach(l=>{var c=YY(e,l);o==null&&(o=fEe(e,n,t));var u=n==="top"&&!i||n==="bottom"&&i;a[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),a}),gEe=nt(Vu,na,uEe,U5,z5,(t,e,r,n,i)=>{var a={},o;return r.forEach(l=>{var c=hEe(e,l);o==null&&(o=pEe(e,n,t));var u=n==="left"&&!i||n==="right"&&i;a[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),a}),xEe=(t,e)=>{var r=Ju(t,e);if(r!=null)return mEe(t,r.orientation,r.mirror)},bEe=nt([na,Ju,xEe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),yEe=(t,e)=>{var r=Zu(t,e);if(r!=null)return gEe(t,r.orientation,r.mirror)},vEe=nt([na,Zu,yEe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),XY=nt(na,Zu,(t,e)=>{var r=typeof e.width=="number"?e.width:Kb;return{width:r,height:t.height}}),MD=(t,e,r)=>{switch(e){case"xAxis":return KY(t,r).width;case"yAxis":return XY(t,r).height;default:return}},JY=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:o}=r,l=U0(t,n),c=e.map(u=>u.value);if(o&&l&&a==="category"&&i&&eG(c))return c}},oE=nt([$n,B5,ai,Js],JY),ZY=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,o=U0(t,n);if(o&&(i==="number"||a!=="auto"))return e.map(l=>l.value)}},lE=nt([$n,B5,sy,Js],ZY);nt([$n,OAe,Ym,F5,oE,lE,oy,iE,Js],(t,e,r,n,i,a,o,l,c)=>{if(e!=null){var u=U0(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var wEe=(t,e,r,n,i,a,o,l,c)=>{if(!(e==null||n==null)){var u=U0(t,c),{type:f,ticks:p,tickCount:x}=e,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=f==="category"&&n.bandwidth?n.bandwidth()/m:0;y=c==="angleAxis"&&a!=null&&a.length>=2?Ha(a[0]-a[1])*2*y:y;var v=p||i;if(v){var j=v.map((N,C)=>{var A=o?o.indexOf(N):N;return{index:C,coordinate:n(A)+y,value:N,offset:y}});return j.filter(N=>ii(N.coordinate))}return u&&l?l.map((N,C)=>({coordinate:n(N)+y,value:N,index:C,offset:y})).filter(N=>ii(N.coordinate)):n.ticks?n.ticks(x).map(N=>({coordinate:n(N)+y,value:N,offset:y})):n.domain().map((N,C)=>({coordinate:n(N)+y,value:o?o[N]:N,index:C,offset:y}))}},QY=nt([$n,sy,Ym,F5,iE,oy,oE,lE,Js],wEe),jEe=(t,e,r,n,i,a,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=U0(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&n?.length>=2?Ha(n[0]-n[1])*2*u:u,l&&a?a.map((f,p)=>({coordinate:r(f)+u,value:f,index:p,offset:u})):r.ticks?r.ticks(c).map(f=>({coordinate:r(f)+u,value:f,offset:u})):r.domain().map((f,p)=>({coordinate:r(f)+u,value:i?i[f]:f,index:p,offset:u}))}},Cm=nt([$n,sy,F5,oy,oE,lE,Js],jEe),Am=nt(ai,F5,(t,e)=>{if(!(t==null||e==null))return rw(rw({},t),{},{scale:e})}),NEe=nt([ai,Ym,rE,GY],nE);nt((t,e,r)=>zA(t,r),NEe,(t,e)=>{if(!(t==null||e==null))return rw(rw({},t),{},{scale:e})});var kEe=nt([$n,p5,m5],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),eK=t=>t.options.defaultTooltipEventType,tK=t=>t.options.validateTooltipEventTypes;function rK(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function cE(t,e){var r=eK(t),n=tK(t);return rK(e,r,n)}function SEe(t){return mr(e=>cE(e,t))}var nK=(t,e)=>{var r,n=Number(e);if(!(Td(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},_Ee=t=>t.tooltip.settings,qh={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},CEe={itemInteraction:{click:qh,hover:qh},axisInteraction:{click:qh,hover:qh},keyboardInteraction:qh,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},sK=il({name:"tooltip",initialState:CEe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Ys()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Ic(t).tooltipItemPayloads.indexOf(r);i>-1&&(t.tooltipItemPayloads[i]=n)},prepare:Ys()},removeTooltipEntrySettings:{reducer(t,e){var r=Ic(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Ys()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:AEe,replaceTooltipEntrySettings:EEe,removeTooltipEntrySettings:TEe,setTooltipSettingsState:LEe,setActiveMouseOverItemIndex:iK,mouseLeaveItem:OEe,mouseLeaveChart:aK,setActiveClickItemIndex:MEe,setMouseOverAxisIndex:oK,setMouseClickAxisIndex:PEe,setSyncInteraction:q_,setKeyboardInteraction:H_}=sK.actions,IEe=sK.reducer;function PD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function n1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PD(Object(r),!0).forEach(function(n){REe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function REe(t,e,r){return(e=DEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DEe(t){var e=BEe(t,"string");return typeof e=="symbol"?e:e+""}function BEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Ee(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function FEe(t){return t.index!=null}var lK=(t,e,r,n)=>{if(e==null)return qh;var i=$Ee(t,e,r);if(i==null)return qh;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(FEe(i)){if(a)return n1(n1({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return n1(n1({},qh),{},{coordinate:i.coordinate})};function UEe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function zEe(t,e){var r=UEe(t),n=e[0],i=e[1];if(r===void 0)return!1;var a=Math.min(n,i),o=Math.max(n,i);return r>=a&&r<=o}function qEe(t,e,r){if(r==null||e==null)return!0;var n=Bs(t,e);return n==null||!cf(r)?!0:zEe(n,r)}var dE=(t,e,r,n)=>{var i=t?.index;if(i==null)return null;var a=Number(i);if(!ii(a))return i;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(a,l)),u=e[c];return u==null||qEe(u,r,n)?String(c):null},cK=(t,e,r,n,i,a,o,l)=>{if(!(a==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,a);if(u!=null)return u;var f=i?.[Number(a)];if(f)return r==="horizontal"?{x:f.coordinate,y:(n.top+e)/2}:{x:(n.left+t)/2,y:f.coordinate}}},dK=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=t.itemInteraction.hover.graphicalItemId:i=t.itemInteraction.click.graphicalItemId,i==null&&n!=null){var a=t.tooltipItemPayloads[0];return a!=null?[a]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},ly=t=>t.options.tooltipPayloadSearcher,Km=t=>t.tooltip;function ID(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function RD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ID(Object(r),!0).forEach(function(n){HEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ID(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HEe(t,e,r){return(e=WEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WEe(t){var e=GEe(t,"string");return typeof e=="symbol"?e:e+""}function GEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VEe(t,e){return t??e}var uK=(t,e,r,n,i,a,o)=>{if(!(e==null||a==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:f}=r,p=[];return t.reduce((x,m)=>{var y,{dataDefinedOnItem:v,settings:j}=m,N=VEe(v,l),C=Array.isArray(N)?VG(N,u,f):N,A=(y=j?.dataKey)!==null&&y!==void 0?y:n,L=j?.nameKey,O;if(n&&Array.isArray(C)&&!Array.isArray(C[0])&&o==="axis"?O=Sje(C,n,i):O=a(C,e,c,L),Array.isArray(O))O.forEach(T=>{var I=RD(RD({},j),{},{name:T.name,unit:T.unit,color:void 0,fill:void 0});x.push(BI({tooltipEntrySettings:I,dataKey:T.dataKey,payload:T.payload,value:Bs(T.payload,T.dataKey),name:T.name}))});else{var F;x.push(BI({tooltipEntrySettings:j,dataKey:A,payload:O,value:Bs(O,A),name:(F=Bs(O,L))!==null&&F!==void 0?F:j?.name}))}return x},p)}},uE=nt([aa,$n,OY,IA,ia],HY),YEe=nt([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),KEe=nt([ia,Gm],qA),Xm=nt([YEe,aa,KEe],WA,{memoizeOptions:{resultEqualityCheck:D5}}),XEe=nt([Xm],t=>t.filter(I5)),JEe=nt([Xm],GA,{memoizeOptions:{resultEqualityCheck:D5}}),Jm=nt([JEe,Xu],VA),ZEe=nt([XEe,Xu,aa],EY),hE=nt([Jm,aa,Xm],KA),hK=nt([aa],XA),QEe=nt([aa],t=>t.allowDataOverflow),fK=nt([hK,QEe],aY),e8e=nt([Xm],t=>t.filter(I5)),t8e=nt([ZEe,e8e,ry,jY],RY),r8e=nt([t8e,Xu,ia,fK],DY),n8e=nt([Xm],PY),s8e=nt([Jm,aa,n8e,$5,ia],QA,{memoizeOptions:{resultEqualityCheck:R5}}),i8e=nt([BY,ia,Gm],Vm),a8e=nt([i8e,ia],UY),o8e=nt([$Y,ia,Gm],Vm),l8e=nt([o8e,ia],zY),c8e=nt([FY,ia,Gm],Vm),d8e=nt([c8e,ia],qY),u8e=nt([a8e,d8e,l8e],nw),h8e=nt([aa,hK,fK,r8e,s8e,u8e,$n,ia],eE),cy=nt([aa,$n,Jm,hE,ry,ia,h8e],tE),f8e=nt([cy,aa,uE],sE),p8e=nt([aa,cy,f8e,ia],aE),pK=t=>{var e=ia(t),r=Gm(t),n=!1;return oy(t,e,r,n)},mK=nt([aa,pK],M5),gK=nt([aa,uE,p8e,mK],nE),m8e=nt([$n,hE,aa,ia],JY),g8e=nt([$n,hE,aa,ia],ZY),x8e=(t,e,r,n,i,a,o,l)=>{if(e){var{type:c}=e,u=U0(t,l);if(n){var f=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=c==="category"&&n.bandwidth?n.bandwidth()/f:0;return p=l==="angleAxis"&&i!=null&&i?.length>=2?Ha(i[0]-i[1])*2*p:p,u&&o?o.map((x,m)=>({coordinate:n(x)+p,value:x,index:m,offset:p})):n.domain().map((x,m)=>({coordinate:n(x)+p,value:a?a[x]:x,index:m,offset:p}))}}},Qu=nt([$n,aa,uE,gK,pK,m8e,g8e,ia],x8e),fE=nt([eK,tK,_Ee],(t,e,r)=>rK(r.shared,t,e)),xK=t=>t.tooltip.settings.trigger,pE=t=>t.tooltip.settings.defaultIndex,dy=nt([Km,fE,xK,pE],lK),_0=nt([dy,Jm,ay,cy],dE),bK=nt([Qu,_0],nK),mE=nt([dy],t=>{if(t)return t.dataKey}),b8e=nt([dy],t=>{if(t)return t.graphicalItemId}),yK=nt([Km,fE,xK,pE],dK),y8e=nt([Vu,Yu,$n,na,Qu,pE,yK,ly],cK),v8e=nt([dy,y8e],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),w8e=nt([dy],t=>{var e;return(e=t?.active)!==null&&e!==void 0?e:!1}),j8e=nt([yK,_0,Xu,ay,bK,ly,fE],uK);nt([j8e],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function DD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function BD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DD(Object(r),!0).forEach(function(n){N8e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function N8e(t,e,r){return(e=k8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k8e(t){var e=S8e(t,"string");return typeof e=="symbol"?e:e+""}function S8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _8e=()=>mr(aa),C8e=()=>{var t=_8e(),e=mr(Qu),r=mr(gK);return D2(!t||!r?void 0:BD(BD({},t),{},{scale:r}),e)};function $D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$D(Object(r),!0).forEach(function(n){A8e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$D(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function A8e(t,e,r){return(e=E8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E8e(t){var e=T8e(t,"string");return typeof e=="symbol"?e:e+""}function T8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var L8e=(t,e,r,n)=>{var i=e.find(a=>a&&a.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},O8e=(t,e,r,n)=>{var i=e.find(u=>u&&u.index===r);if(i){if(t==="centric"){var a=i.coordinate,{radius:o}=n;return Mp(Mp(Mp({},n),Fi(n.cx,n.cy,o,a)),{},{angle:a,radius:o})}var l=i.coordinate,{angle:c}=n;return Mp(Mp(Mp({},n),Fi(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function M8e(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var vK=(t,e,r,n,i)=>{var a,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,f,p,x,m=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,y=(f=r[l])===null||f===void 0?void 0:f.coordinate,v=l>=o-1?(p=r[0])===null||p===void 0?void 0:p.coordinate:(x=r[l+1])===null||x===void 0?void 0:x.coordinate,j=void 0;if(!(m==null||y==null||v==null))if(Ha(y-m)!==Ha(v-y)){var N=[];if(Ha(v-y)===Ha(i[1]-i[0])){j=v;var C=y+i[1]-i[0];N[0]=Math.min(C,(C+m)/2),N[1]=Math.max(C,(C+m)/2)}else{j=m;var A=v+i[1]-i[0];N[0]=Math.min(y,(A+y)/2),N[1]=Math.max(y,(A+y)/2)}var L=[Math.min(y,(j+y)/2),Math.max(y,(j+y)/2)];if(t>L[0]&&t<=L[1]||t>=N[0]&&t<=N[1]){var O;return(O=r[l])===null||O===void 0?void 0:O.index}}else{var F=Math.min(m,v),T=Math.max(m,v);if(t>(F+y)/2&&t<=(T+y)/2){var I;return(I=r[l])===null||I===void 0?void 0:I.index}}}else if(e)for(var B=0;B<o;B++){var $=e[B];if($!=null){var k=e[B+1],R=e[B-1];if(B===0&&k!=null&&t<=($.coordinate+k.coordinate)/2||B===o-1&&R!=null&&t>($.coordinate+R.coordinate)/2||B>0&&B<o-1&&R!=null&&k!=null&&t>($.coordinate+R.coordinate)/2&&t<=($.coordinate+k.coordinate)/2)return $.index}}return-1},P8e=()=>mr(IA),gE=(t,e)=>e,wK=(t,e,r)=>r,xE=(t,e,r,n)=>n,I8e=nt(Qu,t=>s5(t,e=>e.coordinate)),bE=nt([Km,gE,wK,xE],lK),yE=nt([bE,Jm,ay,cy],dE),R8e=(t,e,r)=>{if(e!=null){var n=Km(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},jK=nt([Km,gE,wK,xE],dK),sw=nt([Vu,Yu,$n,na,Qu,xE,jK,ly],cK),D8e=nt([bE,sw],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),NK=nt([Qu,yE],nK),B8e=nt([jK,yE,Xu,ay,NK,ly,gE],uK),$8e=nt([bE,yE],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),F8e=(t,e,r,n,i,a,o)=>{if(!(!t||!r||!n||!i)&&M8e(t,o)){var l=a3e(t,e),c=vK(l,a,i,r,n),u=L8e(e,i,c,t);return{activeIndex:String(c),activeCoordinate:u}}},U8e=(t,e,r,n,i,a,o)=>{if(!(!t||!n||!i||!a||!r)){var l=k_e(t,r);if(l){var c=o3e(l,e),u=vK(c,o,a,n,i),f=O8e(e,a,u,l);return{activeIndex:String(u),activeCoordinate:f}}}},z8e=(t,e,r,n,i,a,o,l)=>{if(!(!t||!e||!n||!i||!a))return e==="horizontal"||e==="vertical"?F8e(t,e,n,i,a,o,l):U8e(t,e,r,n,i,a,o)},q8e=nt(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),H8e=nt(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(ao)),r=Array.from(new Set(e));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:CAe}});function FD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function UD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FD(Object(r),!0).forEach(function(n){W8e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function W8e(t,e,r){return(e=G8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G8e(t){var e=V8e(t,"string");return typeof e=="symbol"?e:e+""}function V8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y8e={},K8e={zIndexMap:Object.values(ao).reduce((t,e)=>UD(UD({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),Y8e)},X8e=new Set(Object.values(ao));function J8e(t){return X8e.has(t)}var kK=il({name:"zIndex",initialState:K8e,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Ys()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!J8e(r)&&delete t.zIndexMap[r])},prepare:Ys()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:i}=e.payload;t.zIndexMap[r]?i?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:Ys()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Ys()}}}),{registerZIndexPortal:Z8e,unregisterZIndexPortal:Q8e,registerZIndexPortalElement:eTe,unregisterZIndexPortalElement:tTe}=kK.actions,rTe=kK.reducer;function $d(t){var{zIndex:e,children:r}=t,n=$3e(),i=n&&e!==void 0&&e!==0,a=Cl(),o=As();b.useLayoutEffect(()=>i?(o(Z8e({zIndex:e})),()=>{o(Q8e({zIndex:e}))}):Hb,[o,e,i]);var l=mr(c=>q8e(c,e,a));return i?l?Gn.createPortal(r,l):null:r}function W_(){return W_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},W_.apply(null,arguments)}function zD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function s1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zD(Object(r),!0).forEach(function(n){nTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nTe(t,e,r){return(e=sTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sTe(t){var e=iTe(t,"string");return typeof e=="symbol"?e:e+""}function iTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aTe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return b.isValidElement(e)?b.cloneElement(e,n):b.createElement(r,n)}function oTe(t){var e,{coordinate:r,payload:n,index:i,offset:a,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:f}=t,p=r,x=n,m=i;if(!c||!p||f!=="ScatterChart"&&u!=="axis")return null;var y,v,j;if(f==="ScatterChart")y=p,v=BSe,j=ao.cursorLine;else if(f==="BarChart")y=$Se(l,p,a,o),v=yV,j=ao.cursorRectangle;else if(l==="radial"&&rG(p)){var{cx:N,cy:C,radius:A,startAngle:L,endAngle:O}=wV(p);y={cx:N,cy:C,startAngle:L,endAngle:O,innerRadius:A,outerRadius:A},v=NV,j=ao.cursorLine}else y={points:A_e(l,p,a)},v=cA,j=ao.cursorLine;var F=typeof c=="object"&&"className"in c?c.className:void 0,T=s1(s1(s1(s1({stroke:"#ccc",pointerEvents:"none"},a),y),rb(c)),{},{payload:x,payloadIndex:m,className:ns("recharts-tooltip-cursor",F)});return b.createElement($d,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:j},b.createElement(aTe,{cursor:c,cursorComp:v,cursorProps:T}))}function lTe(t){var e=C8e(),r=D3e(),n=Xb(),i=P8e();return e==null||r==null||n==null||i==null?null:b.createElement(oTe,W_({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var SK=b.createContext(null),cTe=()=>b.useContext(SK),gb=new Jq,G_="recharts.syncEvent.tooltip",qD="recharts.syncEvent.brush";function _K(t,e){if(e){var r=Number.parseInt(e,10);if(!Td(r))return t?.[r]}}var dTe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},CK=il({name:"options",initialState:dTe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),uTe=CK.reducer,{createEventEmitter:hTe}=CK.actions;function fTe(t){return t.tooltip.syncInteraction}var pTe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},AK=il({name:"chartData",initialState:pTe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:HD,setDataStartEndIndexes:mTe,setComputedData:bRe}=AK.actions,gTe=AK.reducer,xTe=["x","y"];function WD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Pp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WD(Object(r),!0).forEach(function(n){bTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bTe(t,e,r){return(e=yTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yTe(t){var e=vTe(t,"string");return typeof e=="symbol"?e:e+""}function vTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wTe(t,e){if(t==null)return{};var r,n,i=jTe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function jTe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function NTe(){var t=mr(RA),e=mr(DA),r=As(),n=mr(NY),i=mr(Qu),a=Xb(),o=b5(),l=mr(c=>c.rootProps.className);b.useEffect(()=>{if(t==null)return Hb;var c=(u,f,p)=>{if(e!==p&&t===u){if(n==="index"){var x;if(o&&f!==null&&f!==void 0&&(x=f.payload)!==null&&x!==void 0&&x.coordinate&&f.payload.sourceViewBox){var m=f.payload.coordinate,{x:y,y:v}=m,j=wTe(m,xTe),{x:N,y:C,width:A,height:L}=f.payload.sourceViewBox,O=Pp(Pp({},j),{},{x:o.x+(A?(y-N)/A:0)*o.width,y:o.y+(L?(v-C)/L:0)*o.height});r(Pp(Pp({},f),{},{payload:Pp(Pp({},f.payload),{},{coordinate:O})}))}else r(f);return}if(i!=null){var F;if(typeof n=="function"){var T={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},I=n(i,T);F=i[I]}else n==="value"&&(F=i.find(G=>String(G.value)===f.payload.label));var{coordinate:B}=f.payload;if(F==null||f.payload.active===!1||B==null||o==null){r(q_({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:$,y:k}=B,R=Math.min($,o.x+o.width),P=Math.min(k,o.y+o.height),q={x:a==="horizontal"?F.coordinate:R,y:a==="horizontal"?P:F.coordinate},X=q_({active:f.payload.active,coordinate:q,dataKey:f.payload.dataKey,index:String(F.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox,graphicalItemId:f.payload.graphicalItemId});r(X)}}};return gb.on(G_,c),()=>{gb.off(G_,c)}},[l,r,e,t,n,i,a,o])}function kTe(){var t=mr(RA),e=mr(DA),r=As();b.useEffect(()=>{if(t==null)return Hb;var n=(i,a,o)=>{e!==o&&t===i&&r(mTe(a))};return gb.on(qD,n),()=>{gb.off(qD,n)}},[r,e,t])}function STe(){var t=As();b.useEffect(()=>{t(hTe())},[t]),NTe(),kTe()}function _Te(t,e,r,n,i,a){var o=mr(m=>R8e(m,t,e)),l=mr(DA),c=mr(RA),u=mr(NY),f=mr(fTe),p=f?.active,x=b5();b.useEffect(()=>{if(!p&&c!=null&&l!=null){var m=q_({active:a,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:x,graphicalItemId:void 0});gb.emit(G_,c,m,l)}},[p,r,o,i,n,l,c,u,a,x])}function GD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function VD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GD(Object(r),!0).forEach(function(n){CTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CTe(t,e,r){return(e=ATe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ATe(t){var e=ETe(t,"string");return typeof e=="symbol"?e:e+""}function ETe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TTe(t){return t.dataKey}function LTe(t,e){return b.isValidElement(t)?b.cloneElement(t,e):typeof t=="function"?b.createElement(t,e):b.createElement(xSe,e)}var YD=[],OTe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function KD(t){var e,r,n=Va(t,OTe),{active:i,allowEscapeViewBox:a,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:f,offset:p,payloadUniqBy:x,position:m,reverseDirection:y,useTranslate3d:v,wrapperStyle:j,cursor:N,shared:C,trigger:A,defaultIndex:L,portal:O,axisId:F}=n,T=As(),I=typeof L=="number"?String(L):L;b.useEffect(()=>{T(LEe({shared:C,trigger:A,axisId:F,active:i,defaultIndex:I}))},[T,C,A,F,i,I]);var B=b5(),$=pV(),k=SEe(C),{activeIndex:R,isActive:P}=(e=mr(ue=>$8e(ue,k,A,I)))!==null&&e!==void 0?e:{},q=mr(ue=>B8e(ue,k,A,I)),X=mr(ue=>NK(ue,k,A,I)),G=mr(ue=>D8e(ue,k,A,I)),ne=q,ee=cTe(),se=(r=i??P)!==null&&r!==void 0?r:!1,[J,W]=xG([ne,se]),U=k==="axis"?X:void 0;_Te(k,A,G,U,R,se);var Y=O??ee;if(Y==null||B==null||k==null)return null;var te=ne??YD;se||(te=YD),u&&te.length&&(te=hG(te.filter(ue=>ue.value!=null&&(ue.hide!==!0||n.includeHidden)),x,TTe));var ce=te.length>0,xe=b.createElement(kSe,{allowEscapeViewBox:a,animationDuration:o,animationEasing:l,isAnimationActive:f,active:se,coordinate:G,hasPayload:ce,offset:p,position:m,reverseDirection:y,useTranslate3d:v,viewBox:B,wrapperStyle:j,lastBoundingBox:J,innerRef:W,hasPortalFromProps:!!O},LTe(c,VD(VD({},n),{},{payload:te,label:U,active:se,activeIndex:R,coordinate:G,accessibilityLayer:$})));return b.createElement(b.Fragment,null,Gn.createPortal(xe,Y),se&&b.createElement(lTe,{cursor:N,tooltipEventType:k,coordinate:G,payload:te,index:R}))}var Em=t=>null;Em.displayName="Cell";function MTe(t,e,r){return(e=PTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PTe(t){var e=ITe(t,"string");return typeof e=="symbol"?e:e+""}function ITe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RTe{constructor(e){MTe(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function XD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function DTe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XD(Object(r),!0).forEach(function(n){BTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BTe(t,e,r){return(e=$Te(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Te(t){var e=FTe(t,"string");return typeof e=="symbol"?e:e+""}function FTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UTe={cacheSize:2e3,enableCache:!0},EK=DTe({},UTe),JD=new RTe(EK.cacheSize),zTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},ZD="recharts_measurement_span";function qTe(t,e){var r=e.fontSize||"",n=e.fontFamily||"",i=e.fontWeight||"",a=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(o,"|").concat(l)}var QD=(t,e)=>{try{var r=document.getElementById(ZD);r||(r=document.createElement("span"),r.setAttribute("id",ZD),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,zTe,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ix=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||N5.isSsr)return{width:0,height:0};if(!EK.enableCache)return QD(e,r);var n=qTe(e,r),i=JD.get(n);if(i)return i;var a=QD(e,r);return JD.set(n,a),a},TK;function HTe(t,e,r){return(e=WTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WTe(t){var e=GTe(t,"string");return typeof e=="symbol"?e:e+""}function GTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,tB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,YTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,KTe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},XTe=["cm","mm","pt","pc","in","Q","px"];function JTe(t){return XTe.includes(t)}var Vp="NaN";function ZTe(t,e){return t*KTe[e]}class qa{static parse(e){var r,[,n,i]=(r=YTe.exec(e))!==null&&r!==void 0?r:[];return n==null?qa.NaN:new qa(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Td(e)&&(this.unit=""),r!==""&&!VTe.test(r)&&(this.num=NaN,this.unit=""),JTe(r)&&(this.num=ZTe(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new qa(NaN,""):new qa(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new qa(NaN,""):new qa(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new qa(NaN,""):new qa(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new qa(NaN,""):new qa(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Td(this.num)}}TK=qa;HTe(qa,"NaN",new TK(NaN,""));function LK(t){if(t==null||t.includes(Vp))return Vp;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=eB.exec(e))!==null&&r!==void 0?r:[],o=qa.parse(n??""),l=qa.parse(a??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Vp;e=e.replace(eB,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,f,p,x]=(u=tB.exec(e))!==null&&u!==void 0?u:[],m=qa.parse(f??""),y=qa.parse(x??""),v=p==="+"?m.add(y):m.subtract(y);if(v.isNaN())return Vp;e=e.replace(tB,v.toString())}return e}var rB=/\(([^()]*)\)/;function QTe(t){for(var e=t,r;(r=rB.exec(e))!=null;){var[,n]=r;e=e.replace(rB,LK(n))}return e}function eLe(t){var e=t.replace(/\s+/g,"");return e=QTe(e),e=LK(e),e}function tLe(t){try{return eLe(t)}catch{return Vp}}function v3(t){var e=tLe(t.slice(5,-1));return e===Vp?"":e}var rLe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],nLe=["dx","dy","angle","className","breakAll"];function V_(){return V_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},V_.apply(null,arguments)}function nB(t,e){if(t==null)return{};var r,n,i=sLe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function sLe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var OK=/[ \f\n\r\t\v\u2028\u2029]+/,MK=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];Na(e)||(r?i=e.toString().split(""):i=e.toString().split(OK));var a=i.map(l=>({word:l,width:Ix(l,n).width})),o=r?0:Ix("",n).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}};function iLe(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var PK=(t,e,r,n)=>t.reduce((i,a)=>{var{word:o,width:l}=a,c=i[i.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),IK=t=>t.reduce((e,r)=>e.width>r.width?e:r),aLe="",sB=(t,e,r,n,i,a,o,l)=>{var c=t.slice(0,e),u=MK({breakAll:r,style:n,children:c+aLe});if(!u)return[!1,[]];var f=PK(u.wordsWithComputedWidth,a,o,l),p=f.length>i||IK(f).width>Number(a);return[p,f]},oLe=(t,e,r,n,i)=>{var{maxLines:a,children:o,style:l,breakAll:c}=t,u=wr(a),f=String(o),p=PK(e,n,r,i);if(!u||i)return p;var x=p.length>a||IK(p).width>Number(n);if(!x)return p;for(var m=0,y=f.length-1,v=0,j;m<=y&&v<=f.length-1;){var N=Math.floor((m+y)/2),C=N-1,[A,L]=sB(f,C,c,l,a,n,r,i),[O]=sB(f,N,c,l,a,n,r,i);if(!A&&!O&&(m=N+1),A&&O&&(y=N-1),!A&&O){j=L;break}v++}return j||p},iB=t=>{var e=Na(t)?[]:t.toString().split(OK);return[{words:e,width:void 0}]},lLe=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:o}=t;if((e||r)&&!N5.isSsr){var l,c,u=MK({breakAll:a,children:n,style:i});if(u){var{wordsWithComputedWidth:f,spaceWidth:p}=u;l=f,c=p}else return iB(n);return oLe({breakAll:a,children:n,maxLines:o,style:i},l,c,e,!!r)}return iB(n)},RK="#808080",cLe={angle:0,breakAll:!1,capHeight:"0.71em",fill:RK,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},q5=b.forwardRef((t,e)=>{var r=Va(t,cLe),{x:n,y:i,lineHeight:a,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:f}=r,p=nB(r,rLe),x=b.useMemo(()=>lLe({breakAll:p.breakAll,children:p.children,maxLines:p.maxLines,scaleToFit:c,style:p.style,width:p.width}),[p.breakAll,p.children,p.maxLines,c,p.style,p.width]),{dx:m,dy:y,angle:v,className:j,breakAll:N}=p,C=nB(p,nLe);if(!Ld(n)||!Ld(i)||x.length===0)return null;var A=Number(n)+(wr(m)?m:0),L=Number(i)+(wr(y)?y:0);if(!ii(A)||!ii(L))return null;var O;switch(f){case"start":O=v3("calc(".concat(o,")"));break;case"middle":O=v3("calc(".concat((x.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:O=v3("calc(".concat(x.length-1," * -").concat(a,")"));break}var F=[];if(c){var T=x[0].width,{width:I}=p;F.push("scale(".concat(wr(I)&&wr(T)?I/T:1,")"))}return v&&F.push("rotate(".concat(v,", ").concat(A,", ").concat(L,")")),F.length&&(C.transform=F.join(" ")),b.createElement("text",V_({},tc(C),{ref:e,x:A,y:L,className:ns("recharts-text",j),textAnchor:u,fill:l.includes("url")?RK:l}),x.map((B,$)=>{var k=B.words.join(N?"":" ");return b.createElement("tspan",{x:A,dy:$===0?O:a,key:"".concat(k,"-").concat($)},k)}))});q5.displayName="Text";var dLe=["labelRef"],uLe=["content"];function aB(t,e){if(t==null)return{};var r,n,i=hLe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function hLe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function oB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Si(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oB(Object(r),!0).forEach(function(n){fLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fLe(t,e,r){return(e=pLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pLe(t){var e=mLe(t,"string");return typeof e=="symbol"?e:e+""}function mLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gu(){return gu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gu.apply(null,arguments)}var DK=b.createContext(null),gLe=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:o,children:l}=t,c=b.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:o}),[e,r,n,i,a,o]);return b.createElement(DK.Provider,{value:c},l)},BK=()=>{var t=b.useContext(DK),e=b5();return t||eV(e)},xLe=b.createContext(null),bLe=()=>{var t=b.useContext(xLe),e=mr(AY);return t||e},yLe=t=>{var{value:e,formatter:r}=t,n=Na(t.children)?e:t.children;return typeof r=="function"?r(n):n},vE=t=>t!=null&&typeof t=="function",vLe=(t,e)=>{var r=Ha(e-t),n=Math.min(Math.abs(e-t),360);return r*n},wLe=(t,e,r,n,i)=>{var{offset:a,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:f,startAngle:p,endAngle:x,clockWise:m}=i,y=(u+f)/2,v=vLe(p,x),j=v>=0?1:-1,N,C;switch(e){case"insideStart":N=p+j*a,C=m;break;case"insideEnd":N=x-j*a,C=!m;break;case"end":N=x+j*a,C=m;break;default:throw new Error("Unsupported position ".concat(e))}C=v<=0?C:!C;var A=Fi(l,c,y,N),L=Fi(l,c,y,N+(C?1:-1)*359),O="M".concat(A.x,",").concat(A.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(C?0:1,`,
    `).concat(L.x,",").concat(L.y),F=Na(t.id)?nb("recharts-radial-line-"):t.id;return b.createElement("text",gu({},n,{dominantBaseline:"central",className:ns("recharts-radial-bar-label",o)}),b.createElement("defs",null,b.createElement("path",{id:F,d:O})),b.createElement("textPath",{xlinkHref:"#".concat(F)},r))},jLe=(t,e,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:f,y:p}=Fi(n,i,o+e,u);return{x:f,y:p,textAnchor:f>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(a+o)/2,{x:m,y}=Fi(n,i,x,u);return{x:m,y,textAnchor:"middle",verticalAnchor:"middle"}},Y_=t=>"cx"in t&&wr(t.cx),NLe=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,a;r!=null&&!Y_(r)&&(a=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:f}=e,p=o,x=o+(c-u)/2,m=(p+x)/2,y=(c+u)/2,v=p+c/2,j=f>=0?1:-1,N=j*n,C=j>0?"end":"start",A=j>0?"start":"end",L=c>=0?1:-1,O=L*n,F=L>0?"end":"start",T=L>0?"start":"end";if(i==="top"){var I={x:p+c/2,y:l-N,textAnchor:"middle",verticalAnchor:C};return Si(Si({},I),a?{height:Math.max(l-a.y,0),width:c}:{})}if(i==="bottom"){var B={x:x+u/2,y:l+f+N,textAnchor:"middle",verticalAnchor:A};return Si(Si({},B),a?{height:Math.max(a.y+a.height-(l+f),0),width:u}:{})}if(i==="left"){var $={x:m-O,y:l+f/2,textAnchor:F,verticalAnchor:"middle"};return Si(Si({},$),a?{width:Math.max($.x-a.x,0),height:f}:{})}if(i==="right"){var k={x:m+y+O,y:l+f/2,textAnchor:T,verticalAnchor:"middle"};return Si(Si({},k),a?{width:Math.max(a.x+a.width-k.x,0),height:f}:{})}var R=a?{width:y,height:f}:{};return i==="insideLeft"?Si({x:m+O,y:l+f/2,textAnchor:T,verticalAnchor:"middle"},R):i==="insideRight"?Si({x:m+y-O,y:l+f/2,textAnchor:F,verticalAnchor:"middle"},R):i==="insideTop"?Si({x:p+c/2,y:l+N,textAnchor:"middle",verticalAnchor:A},R):i==="insideBottom"?Si({x:x+u/2,y:l+f-N,textAnchor:"middle",verticalAnchor:C},R):i==="insideTopLeft"?Si({x:p+O,y:l+N,textAnchor:T,verticalAnchor:A},R):i==="insideTopRight"?Si({x:p+c-O,y:l+N,textAnchor:F,verticalAnchor:A},R):i==="insideBottomLeft"?Si({x:x+O,y:l+f-N,textAnchor:T,verticalAnchor:C},R):i==="insideBottomRight"?Si({x:x+u-O,y:l+f-N,textAnchor:F,verticalAnchor:C},R):i&&typeof i=="object"&&(wr(i.x)||Mu(i.x))&&(wr(i.y)||Mu(i.y))?Si({x:o+oo(i.x,y),y:l+oo(i.y,f),textAnchor:"end",verticalAnchor:"end"},R):Si({x:v,y:l+f/2,textAnchor:"middle",verticalAnchor:"middle"},R)},kLe={angle:0,offset:5,zIndex:ao.label,position:"middle",textBreakAll:!1};function Dh(t){var e=Va(t,kLe),{viewBox:r,position:n,value:i,children:a,content:o,className:l="",textBreakAll:c,labelRef:u}=e,f=bLe(),p=BK(),x=n==="center"?p:f??p,m,y,v;if(r==null?m=x:Y_(r)?m=r:m=eV(r),!m||Na(i)&&Na(a)&&!b.isValidElement(o)&&typeof o!="function")return null;var j=Si(Si({},e),{},{viewBox:m});if(b.isValidElement(o)){var{labelRef:N}=j,C=aB(j,dLe);return b.cloneElement(o,C)}if(typeof o=="function"){var{content:A}=j,L=aB(j,uLe);if(y=b.createElement(o,L),b.isValidElement(y))return y}else y=yLe(e);var O=tc(e);if(Y_(m)){if(n==="insideStart"||n==="insideEnd"||n==="end")return wLe(e,n,y,O,m);v=jLe(m,e.offset,e.position)}else v=NLe(e,m);return b.createElement($d,{zIndex:e.zIndex},b.createElement(q5,gu({ref:u,className:ns("recharts-label",l)},O,v,{textAnchor:iLe(O.textAnchor)?O.textAnchor:v.textAnchor,breakAll:c}),y))}Dh.displayName="Label";var SLe=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?b.createElement(Dh,gu({key:"label-implicit"},n)):Ld(t)?b.createElement(Dh,gu({key:"label-implicit",value:t},n)):b.isValidElement(t)?t.type===Dh?b.cloneElement(t,Si({key:"label-implicit"},n)):b.createElement(Dh,gu({key:"label-implicit",content:t},n)):vE(t)?b.createElement(Dh,gu({key:"label-implicit",content:t},n)):t&&typeof t=="object"?b.createElement(Dh,gu({},t,{key:"label-implicit"},n)):null};function _Le(t){var{label:e,labelRef:r}=t,n=BK();return SLe(e,n,r)||null}var w3={},j3={},lB;function CLe(){return lB||(lB=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(j3)),j3}var N3={},cB;function ALe(){return cB||(cB=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(N3)),N3}var dB;function ELe(){return dB||(dB=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CLe(),r=ALe(),n=KC();function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(w3)),w3}var k3,uB;function TLe(){return uB||(uB=1,k3=ELe().last),k3}var LLe=TLe();const OLe=Co(LLe);var MLe=["valueAccessor"],PLe=["dataKey","clockWise","id","textBreakAll","zIndex"];function iw(){return iw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iw.apply(null,arguments)}function hB(t,e){if(t==null)return{};var r,n,i=ILe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function ILe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var RLe=t=>Array.isArray(t.value)?OLe(t.value):t.value,$K=b.createContext(void 0),DLe=$K.Provider,FK=b.createContext(void 0),BLe=FK.Provider;function $Le(){return b.useContext($K)}function FLe(){return b.useContext(FK)}function R1(t){var{valueAccessor:e=RLe}=t,r=hB(t,MLe),{dataKey:n,clockWise:i,id:a,textBreakAll:o,zIndex:l}=r,c=hB(r,PLe),u=$Le(),f=FLe(),p=u||f;return!p||!p.length?null:b.createElement($d,{zIndex:l??ao.label},b.createElement(So,{className:"recharts-label-list"},p.map((x,m)=>{var y,v=Na(n)?e(x,m):Bs(x&&x.payload,n),j=Na(a)?{}:{id:"".concat(a,"-").concat(m)};return b.createElement(Dh,iw({key:"label-".concat(m)},tc(x),c,j,{fill:(y=r.fill)!==null&&y!==void 0?y:x.fill,parentViewBox:x.parentViewBox,value:v,textBreakAll:o,viewBox:x.viewBox,index:m,zIndex:0}))})))}R1.displayName="LabelList";function UK(t){var{label:e}=t;return e?e===!0?b.createElement(R1,{key:"labelList-implicit"}):b.isValidElement(e)||vE(e)?b.createElement(R1,{key:"labelList-implicit",content:e}):typeof e=="object"?b.createElement(R1,iw({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var zK=t=>t.graphicalItems.polarItems,ULe=nt([Js,ny],qA),H5=nt([zK,ai,ULe],WA),zLe=nt([H5],GA),W5=nt([zLe,O5],VA),qLe=nt([W5,ai,H5],KA);nt([W5,ai,H5],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(i=>{var a,o=Bs(n,(a=e.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:Bs(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var fB=()=>{},HLe=nt([W5,ai,H5,$5,Js],QA),WLe=nt([ai,JA,ZA,fB,HLe,fB,$n,Js],eE),qK=nt([ai,$n,W5,qLe,ry,Js,WLe],tE),GLe=nt([qK,ai,Ym],sE);nt([ai,qK,GLe,Js],aE);var VLe={radiusAxis:{},angleAxis:{}},HK=il({name:"polarAxis",initialState:VLe,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:yRe,removeRadiusAxis:vRe,addAngleAxis:wRe,removeAngleAxis:jRe}=HK.actions,YLe=HK.reducer;function pB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pB(Object(r),!0).forEach(function(n){KLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function KLe(t,e,r){return(e=XLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XLe(t){var e=JLe(t,"string");return typeof e=="symbol"?e:e+""}function JLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZLe=(t,e)=>e,wE=nt([zK,ZLe],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),QLe=[],jE=(t,e,r)=>r?.length===0?QLe:r,WK=nt([O5,wE,jE],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var i;if(e?.data!=null&&e.data.length>0?i=e.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>mB(mB({},e.presentationProps),a.props))),i!=null)return i}}),e7e=nt([WK,wE,jE],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,i)=>{var a,o=Bs(n,e.nameKey,e.name),l;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:f5(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),t7e=nt([WK,wE,jE,na],(t,e,r,n)=>{if(!(e==null||t==null))return iOe({offset:n,pieSettings:e,displayedData:t,cells:r})}),S3={exports:{}},fs={};var gB;function r7e(){if(gB)return fs;gB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function y(v){if(typeof v=="object"&&v!==null){var j=v.$$typeof;switch(j){case t:switch(v=v.type,v){case r:case i:case n:case c:case u:case x:return v;default:switch(v=v&&v.$$typeof,v){case o:case l:case p:case f:return v;case a:return v;default:return j}}case e:return j}}}return fs.ContextConsumer=a,fs.ContextProvider=o,fs.Element=t,fs.ForwardRef=l,fs.Fragment=r,fs.Lazy=p,fs.Memo=f,fs.Portal=e,fs.Profiler=i,fs.StrictMode=n,fs.Suspense=c,fs.SuspenseList=u,fs.isContextConsumer=function(v){return y(v)===a},fs.isContextProvider=function(v){return y(v)===o},fs.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},fs.isForwardRef=function(v){return y(v)===l},fs.isFragment=function(v){return y(v)===r},fs.isLazy=function(v){return y(v)===p},fs.isMemo=function(v){return y(v)===f},fs.isPortal=function(v){return y(v)===e},fs.isProfiler=function(v){return y(v)===i},fs.isStrictMode=function(v){return y(v)===n},fs.isSuspense=function(v){return y(v)===c},fs.isSuspenseList=function(v){return y(v)===u},fs.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===r||v===i||v===n||v===c||v===u||typeof v=="object"&&v!==null&&(v.$$typeof===p||v.$$typeof===f||v.$$typeof===o||v.$$typeof===a||v.$$typeof===l||v.$$typeof===m||v.getModuleId!==void 0)},fs.typeOf=y,fs}var xB;function n7e(){return xB||(xB=1,S3.exports=r7e()),S3.exports}var s7e=n7e(),bB=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",yB=null,_3=null,GK=t=>{if(t===yB&&Array.isArray(_3))return _3;var e=[];return b.Children.forEach(t,r=>{Na(r)||(s7e.isFragment(r)?e=e.concat(GK(r.props.children)):e.push(r))}),_3=e,yB=t,e};function NE(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>bB(i)):n=[bB(e)],GK(t).forEach(i=>{var a=w0(i,"type.displayName")||w0(i,"type.name");a&&n.indexOf(a)!==-1&&r.push(i)}),r}var C3={},vB;function i7e(){return vB||(vB=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(C3)),C3}var A3,wB;function a7e(){return wB||(wB=1,A3=i7e().isPlainObject),A3}var o7e=a7e();const l7e=Co(o7e);var jB,NB,kB,SB,_B;function CB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function AB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CB(Object(r),!0).forEach(function(n){c7e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c7e(t,e,r){return(e=d7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d7e(t){var e=u7e(t,"string");return typeof e=="symbol"?e:e+""}function u7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aw(){return aw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aw.apply(null,arguments)}function ex(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var EB=(t,e,r,n,i)=>{var a=r-n,o;return o=bi(jB||(jB=ex(["M ",",",""])),t,e),o+=bi(NB||(NB=ex(["L ",",",""])),t+r,e),o+=bi(kB||(kB=ex(["L ",",",""])),t+r-a/2,e+i),o+=bi(SB||(SB=ex(["L ",",",""])),t+r-a/2-n,e+i),o+=bi(_B||(_B=ex(["L ",","," Z"])),t,e),o},h7e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},f7e=t=>{var e=Va(t,h7e),{x:r,y:n,upperWidth:i,lowerWidth:a,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:f,isUpdateAnimationActive:p}=e,x=b.useRef(null),[m,y]=b.useState(-1),v=b.useRef(i),j=b.useRef(a),N=b.useRef(o),C=b.useRef(r),A=b.useRef(n),L=S5(t,"trapezoid-");if(b.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var q=x.current.getTotalLength();q&&y(q)}catch{}},[]),r!==+r||n!==+n||i!==+i||a!==+a||o!==+o||i===0&&a===0||o===0)return null;var O=ns("recharts-trapezoid",l);if(!p)return b.createElement("g",null,b.createElement("path",aw({},tc(e),{className:O,d:EB(r,n,i,a,o)})));var F=v.current,T=j.current,I=N.current,B=C.current,$=A.current,k="0px ".concat(m===-1?1:m,"px"),R="".concat(m,"px 0px"),P=mV(["strokeDasharray"],u,c);return b.createElement(k5,{animationId:L,key:L,canBegin:m>0,duration:u,easing:c,isActive:p,begin:f},q=>{var X=Qi(F,i,q),G=Qi(T,a,q),ne=Qi(I,o,q),ee=Qi(B,r,q),se=Qi($,n,q);x.current&&(v.current=X,j.current=G,N.current=ne,C.current=ee,A.current=se);var J=q>0?{transition:P,strokeDasharray:R}:{strokeDasharray:k};return b.createElement("path",aw({},tc(e),{className:O,d:EB(ee,se,X,G,ne),ref:x,style:AB(AB({},J),e.style)}))})},p7e=["option","shapeType","activeClassName"];function m7e(t,e){if(t==null)return{};var r,n,i=g7e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function g7e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function TB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ow(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TB(Object(r),!0).forEach(function(n){x7e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function x7e(t,e,r){return(e=b7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b7e(t){var e=y7e(t,"string");return typeof e=="symbol"?e:e+""}function y7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v7e(t,e){return ow(ow({},e),t)}function w7e(t,e){return t==="symbols"}function LB(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return b.createElement(yV,r);case"trapezoid":return b.createElement(f7e,r);case"sector":return b.createElement(NV,r);case"symbols":if(w7e(e))return b.createElement(YC,r);break;case"curve":return b.createElement(cA,r);default:return null}}function j7e(t){return b.isValidElement(t)?t.props:t}function VK(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,i=m7e(t,p7e),a;if(b.isValidElement(e))a=b.cloneElement(e,ow(ow({},i),j7e(e)));else if(typeof e=="function")a=e(i,i.index);else if(l7e(e)&&typeof e!="boolean"){var o=v7e(e,i);a=b.createElement(LB,{shapeType:r,elementProps:o})}else{var l=i;a=b.createElement(LB,{shapeType:r,elementProps:l})}return i.isActive?b.createElement(So,{className:n},a):a}var kE=(t,e,r)=>{var n=As();return(i,a)=>o=>{t?.(i,a,o),n(iK({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},SE=t=>{var e=As();return(r,n)=>i=>{t?.(r,n,i),e(OEe())}},_E=(t,e,r)=>{var n=As();return(i,a)=>o=>{t?.(i,a,o),n(MEe({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function YK(t){var{tooltipEntrySettings:e}=t,r=As(),n=Cl(),i=b.useRef(null);return b.useLayoutEffect(()=>{n||(i.current===null?r(AEe(e)):i.current!==e&&r(EEe({prev:i.current,next:e})),i.current=e)},[e,r,n]),b.useLayoutEffect(()=>()=>{i.current&&(r(TEe(i.current)),i.current=null)},[r]),null}function N7e(t){var{legendPayload:e}=t,r=As(),n=Cl(),i=b.useRef(null);return b.useLayoutEffect(()=>{n||(i.current===null?r(dV(e)):i.current!==e&&r(uV({prev:i.current,next:e})),i.current=e)},[r,n,e]),b.useLayoutEffect(()=>()=>{i.current&&(r(hV(i.current)),i.current=null)},[r]),null}function k7e(t){var{legendPayload:e}=t,r=As(),n=mr($n),i=b.useRef(null);return b.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(dV(e)):i.current!==e&&r(uV({prev:i.current,next:e})),i.current=e)},[r,n,e]),b.useLayoutEffect(()=>()=>{i.current&&(r(hV(i.current)),i.current=null)},[r]),null}var E3,S7e=()=>{var[t]=b.useState(()=>nb("uid-"));return t},_7e=(E3=R3.useId)!==null&&E3!==void 0?E3:S7e;function C7e(t,e){var r=_7e();return e||(t?"".concat(t,"-").concat(r):r)}var A7e=b.createContext(void 0),KK=t=>{var{id:e,type:r,children:n}=t,i=C7e("recharts-".concat(r),e);return b.createElement(A7e.Provider,{value:i},n(i))},E7e={cartesianItems:[],polarItems:[]},XK=il({name:"graphicalItems",initialState:E7e,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Ys()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Ic(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},prepare:Ys()},removeCartesianGraphicalItem:{reducer(t,e){var r=Ic(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Ys()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Ys()},removePolarGraphicalItem:{reducer(t,e){var r=Ic(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Ys()}}}),{addCartesianGraphicalItem:T7e,replaceCartesianGraphicalItem:L7e,removeCartesianGraphicalItem:O7e,addPolarGraphicalItem:M7e,removePolarGraphicalItem:P7e}=XK.actions,I7e=XK.reducer,R7e=t=>{var e=As(),r=b.useRef(null);return b.useLayoutEffect(()=>{r.current===null?e(T7e(t)):r.current!==t&&e(L7e({prev:r.current,next:t})),r.current=t},[e,t]),b.useLayoutEffect(()=>()=>{r.current&&(e(O7e(r.current)),r.current=null)},[e]),null},D7e=b.memo(R7e);function B7e(t){var e=As();return b.useLayoutEffect(()=>(e(M7e(t)),()=>{e(P7e(t))}),[e,t]),null}var $7e=["key"],F7e=["onMouseEnter","onClick","onMouseLeave"],U7e=["id"],z7e=["id"];function OB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OB(Object(r),!0).forEach(function(n){q7e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function q7e(t,e,r){return(e=H7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H7e(t){var e=W7e(t,"string");return typeof e=="symbol"?e:e+""}function W7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function df(){return df=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},df.apply(null,arguments)}function G5(t,e){if(t==null)return{};var r,n,i=G7e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function G7e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function V7e(t){var e=b.useMemo(()=>NE(t.children,Em),[t.children]),r=mr(n=>e7e(n,t.id,e));return r==null?null:b.createElement(k7e,{legendPayload:r})}var Y7e=b.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:o,name:l,hide:c,tooltipType:u,id:f}=t,p={dataDefinedOnItem:n.map(x=>x.tooltipPayload),positions:n.map(x=>x.tooltipPosition),settings:{stroke:i,strokeWidth:a,fill:o,dataKey:e,nameKey:r,name:f5(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:f}};return b.createElement(YK,{tooltipEntrySettings:p})}),K7e=(t,e)=>t>e?"start":t<e?"end":"middle",X7e=(t,e,r)=>oo(typeof e=="function"?e(t):e,r,r*.8),J7e=(t,e,r)=>{var{top:n,left:i,width:a,height:o}=e,l=vV(a,o),c=i+oo(t.cx,a,a/2),u=n+oo(t.cy,o,o/2),f=oo(t.innerRadius,l,0),p=X7e(r,t.outerRadius,l),x=t.maxRadius||Math.sqrt(a*a+o*o)/2;return{cx:c,cy:u,innerRadius:f,outerRadius:p,maxRadius:x}},Z7e=(t,e)=>{var r=Ha(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function Q7e(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var eOe=(t,e)=>{if(b.isValidElement(t))return b.cloneElement(t,e);if(typeof t=="function")return t(e);var r=ns("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,i=G5(e,$7e);return b.createElement(cA,df({},i,{type:"linear",className:r}))},tOe=(t,e,r)=>{if(b.isValidElement(t))return b.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),b.isValidElement(n)))return n;var i=ns("recharts-pie-label-text",Q7e(t));return b.createElement(q5,df({},e,{alignmentBaseline:"middle",className:i}),n)};function rOe(t){var{sectors:e,props:r,showLabels:n}=t,{label:i,labelLine:a,dataKey:o}=r;if(!n||!i||!e)return null;var l=Ed(r),c=rb(i),u=rb(a),f=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,p=e.map((x,m)=>{var y=(x.startAngle+x.endAngle)/2,v=Fi(x.cx,x.cy,x.outerRadius+f,y),j=yi(yi(yi(yi({},l),x),{},{stroke:"none"},c),{},{index:m,textAnchor:K7e(v.x,x.cx)},v),N=yi(yi(yi(yi({},l),x),{},{fill:"none",stroke:x.fill},u),{},{index:m,points:[Fi(x.cx,x.cy,x.outerRadius,y),v],key:"line"});return b.createElement($d,{zIndex:ao.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(m)},b.createElement(So,null,a&&eOe(a,N),tOe(i,j,Bs(x,o))))});return b.createElement(So,{className:"recharts-pie-labels"},p)}function nOe(t){var{sectors:e,props:r,showLabels:n}=t,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?b.createElement(UK,{label:i}):b.createElement(rOe,{sectors:e,props:r,showLabels:n})}function sOe(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:a,id:o}=t,l=mr(_0),c=mr(mE),u=mr(b8e),{onMouseEnter:f,onClick:p,onMouseLeave:x}=i,m=G5(i,F7e),y=kE(f,i.dataKey,o),v=SE(x),j=_E(p,i.dataKey,o);return e==null||e.length===0?null:b.createElement(b.Fragment,null,e.map((N,C)=>{if(N?.startAngle===0&&N?.endAngle===0&&e.length!==1)return null;var A=u==null||u===o,L=String(C)===l&&(c==null||i.dataKey===c)&&A,O=l?n:null,F=r&&L?r:O,T=yi(yi({},N),{},{stroke:N.stroke,tabIndex:-1,[KG]:C,[XG]:o});return b.createElement(So,df({key:"sector-".concat(N?.startAngle,"-").concat(N?.endAngle,"-").concat(N.midAngle,"-").concat(C),tabIndex:-1,className:"recharts-pie-sector"},Wb(m,N,C),{onMouseEnter:y(N,C),onMouseLeave:v(N,C),onClick:j(N,C)}),b.createElement(VK,df({option:a??F,index:C,shapeType:"sector",isActive:L},T)))}))}function iOe(t){var e,{pieSettings:r,displayedData:n,cells:i,offset:a}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:f,tooltipType:p}=r,x=Math.abs(r.minAngle),m=Z7e(l,c),y=Math.abs(m),v=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,j=n.filter(F=>Bs(F,u,0)!==0).length,N=(y>=360?j:j-1)*v,C=y-j*x-N,A=n.reduce((F,T)=>{var I=Bs(T,u,0);return F+(wr(I)?I:0)},0),L;if(A>0){var O;L=n.map((F,T)=>{var I=Bs(F,u,0),B=Bs(F,f,T),$=J7e(r,a,F),k=(wr(I)?I:0)/A,R,P=yi(yi({},F),i&&i[T]&&i[T].props);T?R=O.endAngle+Ha(m)*v*(I!==0?1:0):R=l;var q=R+Ha(m)*((I!==0?x:0)+k*C),X=(R+q)/2,G=($.innerRadius+$.outerRadius)/2,ne=[{name:B,value:I,payload:P,dataKey:u,type:p,graphicalItemId:r.id}],ee=Fi($.cx,$.cy,G,X);return O=yi(yi(yi(yi({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:B,tooltipPayload:ne,midAngle:X,middleRadius:G,tooltipPosition:ee},P),$),{},{value:I,dataKey:u,startAngle:R,endAngle:q,payload:P,paddingAngle:Ha(m)*v}),O})}return L}function aOe(t){var{showLabels:e,sectors:r,children:n}=t,i=b.useMemo(()=>!e||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,e]);return b.createElement(BLe,{value:e?i:void 0},n)}function oOe(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:i,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:f,onAnimationStart:p,onAnimationEnd:x}=e,m=S5(e,"recharts-pie-"),y=r.current,[v,j]=b.useState(!1),N=b.useCallback(()=>{typeof x=="function"&&x(),j(!1)},[x]),C=b.useCallback(()=>{typeof p=="function"&&p(),j(!0)},[p]);return b.createElement(aOe,{showLabels:!v,sectors:i},b.createElement(k5,{animationId:m,begin:o,duration:l,isActive:a,easing:c,onAnimationStart:C,onAnimationEnd:N,key:m},A=>{var L=[],O=i&&i[0],F=O?.startAngle;return i?.forEach((T,I)=>{var B=y&&y[I],$=I>0?w0(T,"paddingAngle",0):0;if(B){var k=Qi(B.endAngle-B.startAngle,T.endAngle-T.startAngle,A),R=yi(yi({},T),{},{startAngle:F+$,endAngle:F+k+$});L.push(R),F=R.endAngle}else{var{endAngle:P,startAngle:q}=T,X=Qi(0,P-q,A),G=yi(yi({},T),{},{startAngle:F+$,endAngle:F+X+$});L.push(G),F=G.endAngle}}),r.current=L,b.createElement(So,null,b.createElement(sOe,{sectors:L,activeShape:u,inactiveShape:f,allOtherPieProps:e,shape:e.shape,id:n}))}),b.createElement(nOe,{showLabels:!v,sectors:i,props:e}),e.children)}var lOe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:ao.area};function cOe(t){var{id:e}=t,r=G5(t,U7e),{hide:n,className:i,rootTabIndex:a}=t,o=b.useMemo(()=>NE(t.children,Em),[t.children]),l=mr(f=>t7e(f,e,o)),c=b.useRef(null),u=ns("recharts-pie",i);return n||l==null?(c.current=null,b.createElement(So,{tabIndex:a,className:u})):b.createElement($d,{zIndex:t.zIndex},b.createElement(Y7e,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),b.createElement(So,{tabIndex:a,className:u},b.createElement(oOe,{props:yi(yi({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function JK(t){var e=Va(t,lOe),{id:r}=e,n=G5(e,z7e),i=Ed(n);return b.createElement(KK,{id:r,type:"pie"},a=>b.createElement(b.Fragment,null,b.createElement(B7e,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:e.maxRadius}),b.createElement(V7e,df({},n,{id:a})),b.createElement(cOe,df({},n,{id:a}))))}JK.displayName="Pie";function MB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function PB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MB(Object(r),!0).forEach(function(n){dOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dOe(t,e,r){return(e=uOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uOe(t){var e=hOe(t,"string");return typeof e=="symbol"?e:e+""}function hOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZK=0,fOe={xAxis:{},yAxis:{},zAxis:{}},QK=il({name:"cartesianAxis",initialState:fOe,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Ys()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Ys()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Ys()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Ys()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Ys()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Ys()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Ys()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Ys()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Ys()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,i=t.yAxis[r];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&n===a[1]&&n!==i.width&&Math.abs(n-a[0])<=1)return;var o=[...a,n].slice(-3);t.yAxis[r]=PB(PB({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:pOe,replaceXAxis:mOe,removeXAxis:gOe,addYAxis:xOe,replaceYAxis:bOe,removeYAxis:yOe,addZAxis:NRe,replaceZAxis:kRe,removeZAxis:SRe,updateYAxisWidth:vOe}=QK.actions,wOe=QK.reducer,jOe=nt([na],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),NOe=nt([jOe,Vu,Yu],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),eX=()=>mr(NOe),IB=(t,e,r)=>{var n=r??t;if(!Na(n))return oo(n,e,0)},kOe=(t,e,r)=>{var n={},i=t.filter(I5),a=t.filter(u=>u.stackId==null),o=i.reduce((u,f)=>(u[f.stackId]||(u[f.stackId]=[]),u[f.stackId].push(f),u),n),l=Object.entries(o).map(u=>{var[f,p]=u,x=p.map(y=>y.dataKey),m=IB(e,r,p[0].barSize);return{stackId:f,dataKeys:x,barSize:m}}),c=a.map(u=>{var f=[u.dataKey].filter(x=>x!=null),p=IB(e,r,u.barSize);return{stackId:void 0,dataKeys:f,barSize:p}});return[...l,...c]};function RB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function i1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RB(Object(r),!0).forEach(function(n){SOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SOe(t,e,r){return(e=_Oe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Oe(t){var e=COe(t,"string");return typeof e=="symbol"?e:e+""}function COe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AOe(t,e,r,n,i){var a=n.length;if(!(a<1)){var o=oo(t,r,0,!0),l,c=[];if(ii(n[0].barSize)){var u=!1,f=r/a,p=n.reduce((N,C)=>N+(C.barSize||0),0);p+=(a-1)*o,p>=r&&(p-=(a-1)*o,o=0),p>=r&&f>0&&(u=!0,f*=.9,p=a*f);var x=(r-p)/2>>0,m={offset:x-o,size:0};l=n.reduce((N,C)=>{var A,L={stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:m.offset+m.size+o,size:u?f:(A=C.barSize)!==null&&A!==void 0?A:0}},O=[...N,L];return m=O[O.length-1].position,O},c)}else{var y=oo(e,r,0,!0);r-2*y-(a-1)*o<=0&&(o=0);var v=(r-2*y-(a-1)*o)/a;v>1&&(v>>=0);var j=ii(i)?Math.min(v,i):v;l=n.reduce((N,C,A)=>[...N,{stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:y+(v+o)*A+(v-j)/2,size:j}}],c)}return l}}var EOe=(t,e,r,n,i,a,o)=>{var l=Na(o)?e:o,c=AOe(r,n,i!==a?i:a,t,l);return i!==a&&c!=null&&(c=c.map(u=>i1(i1({},u),{},{position:i1(i1({},u.position),{},{offset:u.position.offset-i/2})}))),c},TOe=(t,e)=>{var r=UA(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var i=t[n];if(i){var{stackedData:a}=i;if(a)return a.find(o=>o.key===r)}}}};function LOe(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&ii(t.zIndex)?t.zIndex:e}var tX=t=>{var{chartData:e}=t,r=As(),n=Cl();return b.useEffect(()=>n?()=>{}:(r(HD(e)),()=>{r(HD(void 0))}),[e,r,n]),null},DB={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},rX=il({name:"brush",initialState:DB,reducers:{setBrushSettings(t,e){return e.payload==null?DB:e.payload}}}),{setBrushSettings:_Re}=rX.actions,OOe=rX.reducer;function MOe(t,e,r){return(e=POe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function POe(t){var e=IOe(t,"string");return typeof e=="symbol"?e:e+""}function IOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CE{static create(e){return new CE(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}MOe(CE,"EPS",1e-4);function ROe(t){return(t%180+180)%180}var DOe=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=ROe(i),o=a*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},BOe={dots:[],areas:[],lines:[]},nX=il({name:"referenceElements",initialState:BOe,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Ic(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Ic(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Ic(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:CRe,removeDot:ARe,addArea:ERe,removeArea:TRe,addLine:LRe,removeLine:ORe}=nX.actions,$Oe=nX.reducer,FOe=b.createContext(void 0),UOe=t=>{var{children:e}=t,[r]=b.useState("".concat(nb("recharts"),"-clip")),n=eX();if(n==null)return null;var{x:i,y:a,width:o,height:l}=n;return b.createElement(FOe.Provider,{value:r},b.createElement("defs",null,b.createElement("clipPath",{id:r},b.createElement("rect",{x:i,y:a,height:l,width:o}))),e)};function sX(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var i=t[n];i!==void 0&&r.push(i)}return r}function zOe(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return DOe(n,r)}function qOe(t,e,r){var n=r==="width",{x:i,y:a,width:o,height:l}=t;return e===1?{start:n?i:a,end:n?i+o:a+l}:{start:n?i+o:a+l,end:n?i:a}}function xb(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function HOe(t,e){return sX(t,e+1)}function WOe(t,e,r,n,i){for(var a=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,f=o,p=function(){var y=n?.[c];if(y===void 0)return{v:sX(n,u)};var v=c,j,N=()=>(j===void 0&&(j=r(y,v)),j),C=y.coordinate,A=c===0||xb(t,C,N,f,l);A||(c=0,f=o,u+=1),A&&(f=C+t*(N()/2+i),c+=u)},x;u<=a.length;)if(x=p(),x)return x.v;return[]}function GOe(t,e,r,n,i){var a=(n||[]).slice(),o=a.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var f=(o-1)%u,p=l,x=!0,m=function(){var C=n[y],A=y,L,O=()=>(L===void 0&&(L=r(C,A)),L),F=C.coordinate,T=y===f||xb(t,F,O,p,c);if(!T)return x=!1,1;T&&(p=F+t*(O()/2+i))},y=f;y<o&&!m();y+=u);if(x){for(var v=[],j=f;j<o;j+=u)v.push(n[j]);return v}}return[]}function BB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function so(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BB(Object(r),!0).forEach(function(n){VOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function VOe(t,e,r){return(e=YOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YOe(t){var e=KOe(t,"string");return typeof e=="symbol"?e:e+""}function KOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XOe(t,e,r,n,i){for(var a=(n||[]).slice(),o=a.length,{start:l}=e,{end:c}=e,u=function(x){var m=a[x],y,v=()=>(y===void 0&&(y=r(m,x)),y);if(x===o-1){var j=t*(m.coordinate+t*v()/2-c);a[x]=m=so(so({},m),{},{tickCoord:j>0?m.coordinate-j*t:m.coordinate})}else a[x]=m=so(so({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var N=xb(t,m.tickCoord,v,l,c);N&&(c=m.tickCoord-t*(v()/2+i),a[x]=so(so({},m),{},{isShow:!0}))}},f=o-1;f>=0;f--)u(f);return a}function JOe(t,e,r,n,i,a){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(a){var f=n[l-1],p=r(f,l-1),x=t*(f.coordinate+t*p/2-u);if(o[l-1]=f=so(so({},f),{},{tickCoord:x>0?f.coordinate-x*t:f.coordinate}),f.tickCoord!=null){var m=xb(t,f.tickCoord,()=>p,c,u);m&&(u=f.tickCoord-t*(p/2+i),o[l-1]=so(so({},f),{},{isShow:!0}))}}for(var y=a?l-1:l,v=function(C){var A=o[C],L,O=()=>(L===void 0&&(L=r(A,C)),L);if(C===0){var F=t*(A.coordinate-t*O()/2-c);o[C]=A=so(so({},A),{},{tickCoord:F<0?A.coordinate-F*t:A.coordinate})}else o[C]=A=so(so({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var T=xb(t,A.tickCoord,O,c,u);T&&(c=A.tickCoord+t*(O()/2+i),o[C]=so(so({},A),{},{isShow:!0}))}},j=0;j<y;j++)v(j);return o}function ZOe(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:f,angle:p}=t;if(!i||!i.length||!n)return[];if(wr(c)||N5.isSsr){var x;return(x=HOe(i,wr(c)?c:0))!==null&&x!==void 0?x:[]}var m=[],y=l==="top"||l==="bottom"?"width":"height",v=f&&y==="width"?Ix(f,{fontSize:e,letterSpacing:r}):{width:0,height:0},j=(A,L)=>{var O=typeof u=="function"?u(A.value,L):A.value;return y==="width"?zOe(Ix(O,{fontSize:e,letterSpacing:r}),v,p):Ix(O,{fontSize:e,letterSpacing:r})[y]},N=i.length>=2?Ha(i[1].coordinate-i[0].coordinate):1,C=qOe(a,N,y);return c==="equidistantPreserveStart"?WOe(N,C,j,i,o):c==="equidistantPreserveEnd"?GOe(N,C,j,i,o):(c==="preserveStart"||c==="preserveStartEnd"?m=JOe(N,C,j,i,o,c==="preserveStartEnd"):m=XOe(N,C,j,i,o),m.filter(A=>A.isShow))}var QOe=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,o=0;if(e){Array.from(e).forEach(f=>{if(f){var p=f.getBoundingClientRect();p.width>o&&(o=p.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+a,u=o+c+l+(r?n:0);return Math.round(u)}return 0},eMe=["axisLine","width","height","className","hide","ticks","axisType"];function tMe(t,e){if(t==null)return{};var r,n,i=rMe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function rMe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function C0(){return C0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},C0.apply(null,arguments)}function $B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ri(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$B(Object(r),!0).forEach(function(n){nMe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$B(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nMe(t,e,r){return(e=sMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sMe(t){var e=iMe(t,"string");return typeof e=="symbol"?e:e+""}function iMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var s0={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:ao.axis};function aMe(t){var{x:e,y:r,width:n,height:i,orientation:a,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=Ri(Ri(Ri({},c),Ed(l)),{},{fill:"none"});if(a==="top"||a==="bottom"){var f=+(a==="top"&&!o||a==="bottom"&&o);u=Ri(Ri({},u),{},{x1:e,y1:r+f*i,x2:e+n,y2:r+f*i})}else{var p=+(a==="left"&&!o||a==="right"&&o);u=Ri(Ri({},u),{},{x1:e+p*n,y1:r,x2:e+p*n,y2:r+i})}return b.createElement("line",C0({},u,{className:ns("recharts-cartesian-axis-line",w0(l,"className"))}))}function oMe(t,e,r,n,i,a,o,l,c){var u,f,p,x,m,y,v=l?-1:1,j=t.tickSize||o,N=wr(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":u=f=t.coordinate,x=r+ +!l*i,p=x-v*j,y=p-v*c,m=N;break;case"left":p=x=t.coordinate,f=e+ +!l*n,u=f-v*j,m=u-v*c,y=N;break;case"right":p=x=t.coordinate,f=e+ +l*n,u=f+v*j,m=u+v*c,y=N;break;default:u=f=t.coordinate,x=r+ +l*i,p=x+v*j,y=p+v*c,m=N;break}return{line:{x1:u,y1:p,x2:f,y2:x},tick:{x:m,y}}}function lMe(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function cMe(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function dMe(t){var{option:e,tickProps:r,value:n}=t,i,a=ns(r.className,"recharts-cartesian-axis-tick-value");if(b.isValidElement(e))i=b.cloneElement(e,Ri(Ri({},r),{},{className:a}));else if(typeof e=="function")i=e(Ri(Ri({},r),{},{className:a}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=ns(o,e?.className)),i=b.createElement(q5,C0({},r,{className:o}),n)}return i}var uMe=b.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:a,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:f,mirror:p,x,y:m,width:y,height:v,tickSize:j,tickMargin:N,fontSize:C,letterSpacing:A,getTicksConfig:L,events:O,axisType:F}=t,T=ZOe(Ri(Ri({},L),{},{ticks:r}),C,A),I=lMe(f,p),B=cMe(f,p),$=Ed(L),k=rb(n),R={};typeof i=="object"&&(R=i);var P=Ri(Ri({},$),{},{fill:"none"},R),q=T.map(ne=>Ri({entry:ne},oMe(ne,x,m,y,v,f,j,p,N))),X=q.map(ne=>{var{entry:ee,line:se}=ne;return b.createElement(So,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(ee.value,"-").concat(ee.coordinate,"-").concat(ee.tickCoord)},i&&b.createElement("line",C0({},P,se,{className:ns("recharts-cartesian-axis-tick-line",w0(i,"className"))})))}),G=q.map((ne,ee)=>{var{entry:se,tick:J}=ne,W=Ri(Ri(Ri(Ri({textAnchor:I,verticalAnchor:B},$),{},{stroke:"none",fill:a},k),J),{},{index:ee,payload:se,visibleTicksCount:T.length,tickFormatter:o,padding:c},u);return b.createElement(So,C0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},Wb(O,se,ee)),n&&b.createElement(dMe,{option:n,tickProps:W,value:"".concat(typeof o=="function"?o(se.value,ee):se.value).concat(l||"")}))});return b.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(F,"-ticks")},G.length>0&&b.createElement($d,{zIndex:ao.label},b.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(F,"-tick-labels"),ref:e},G)),X.length>0&&b.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(F,"-tick-lines")},X))}),hMe=b.forwardRef((t,e)=>{var{axisLine:r,width:n,height:i,className:a,hide:o,ticks:l,axisType:c}=t,u=tMe(t,eMe),[f,p]=b.useState(""),[x,m]=b.useState(""),y=b.useRef(null);b.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var j;return QOe({ticks:y.current,label:(j=t.labelRef)===null||j===void 0?void 0:j.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var v=b.useCallback(j=>{if(j){var N=j.getElementsByClassName("recharts-cartesian-axis-tick-value");y.current=N;var C=N[0];if(C){var A=window.getComputedStyle(C),L=A.fontSize,O=A.letterSpacing;(L!==f||O!==x)&&(p(L),m(O))}}},[f,x]);return o||n!=null&&n<=0||i!=null&&i<=0?null:b.createElement($d,{zIndex:t.zIndex},b.createElement(So,{className:ns("recharts-cartesian-axis",a)},b.createElement(aMe,{x:t.x,y:t.y,width:n,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:Ed(t)}),b.createElement(uMe,{ref:v,axisType:c,events:u,fontSize:f,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),b.createElement(gLe,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},b.createElement(_Le,{label:t.label,labelRef:t.labelRef}),t.children)))}),AE=b.forwardRef((t,e)=>{var r=Va(t,s0);return b.createElement(hMe,C0({},r,{ref:e}))});AE.displayName="CartesianAxis";var fMe={},iX=il({name:"errorBars",initialState:fMe,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:i}=e.payload;t[r]&&(t[r]=t[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:MRe,replaceErrorBar:PRe,removeErrorBar:IRe}=iX.actions,pMe=iX.reducer,mMe=["children"];function gMe(t,e){if(t==null)return{};var r,n,i=xMe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function xMe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var bMe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},yMe=b.createContext(bMe);function vMe(t){var{children:e}=t,r=gMe(t,mMe);return b.createElement(yMe.Provider,{value:r},e)}function aX(t,e){var r,n,i=mr(u=>Ju(u,t)),a=mr(u=>Zu(u,e)),o=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:ma.allowDataOverflow,l=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:ga.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function wMe(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=eX(),{needClipX:a,needClipY:o,needClip:l}=aX(e,r);if(!l||!i)return null;var{x:c,y:u,width:f,height:p}=i;return b.createElement("clipPath",{id:"clipPath-".concat(n)},b.createElement("rect",{x:a?c:c-f/2,y:o?u:u-p/2,width:a?f:f*2,height:o?p:p*2}))}function jMe(t){t()}function NMe(){let t=null,e=null;return{clear(){t=null,e=null},notify(){jMe(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var FB={notify(){},get:()=>[]};function kMe(t,e){let r,n=FB,i=0,a=!1;function o(v){f();const j=n.subscribe(v);let N=!1;return()=>{N||(N=!0,j(),p())}}function l(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return a}function f(){i++,r||(r=t.subscribe(c),n=NMe())}function p(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=FB)}function x(){a||(a=!0,f())}function m(){a&&(a=!1,p())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:x,tryUnsubscribe:m,getListeners:()=>n};return y}var SMe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_Me=SMe(),CMe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",AMe=CMe(),EMe=()=>_Me||AMe?b.useLayoutEffect:b.useEffect,TMe=EMe();function UB(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function LMe(t,e){if(UB(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(e,r[i])||!UB(t[r[i]],e[r[i]]))return!1;return!0}var OMe=Symbol.for("react-redux-context"),MMe=typeof globalThis<"u"?globalThis:{};function PMe(){if(!b.createContext)return{};const t=MMe[OMe]??=new Map;let e=t.get(b.createContext);return e||(e=b.createContext(null),t.set(b.createContext,e)),e}var IMe=PMe();function RMe(t){const{children:e,context:r,serverState:n,store:i}=t,a=b.useMemo(()=>{const c=kMe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=b.useMemo(()=>i.getState(),[i]);TMe(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=r||IMe;return b.createElement(l.Provider,{value:a},e)}var DMe=RMe,BMe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function $Me(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function EE(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(BMe.has(n)){if(t[n]==null&&e[n]==null)continue;if(!LMe(t[n],e[n]))return!1}else if(!$Me(t[n],e[n]))return!1;return!0}function H0(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:ZK}function W0(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:ZK}var FMe="Invariant failed";function UMe(t,e){throw new Error(FMe)}function K_(){return K_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},K_.apply(null,arguments)}function lw(t){return b.createElement(VK,K_({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var zMe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(wr(e))return e;var a=wr(n)||Na(n);return a?e(n,i):(a||UMe(),r)}},qMe=(t,e,r)=>r,HMe=(t,e)=>e,uy=nt([HA,HMe],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),WMe=nt([uy],t=>t?.maxBarSize),GMe=(t,e,r,n)=>n,VMe=nt([$n,HA,H0,W0,qMe],(t,e,r,n,i)=>e.filter(a=>t==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),YMe=(t,e,r)=>{var n=$n(t),i=H0(t,e),a=W0(t,e);if(!(i==null||a==null))return n==="horizontal"?z_(t,"yAxis",a,r):z_(t,"xAxis",i,r)},KMe=(t,e)=>{var r=$n(t),n=H0(t,e),i=W0(t,e);if(!(n==null||i==null))return r==="horizontal"?MD(t,"xAxis",n):MD(t,"yAxis",i)},XMe=nt([VMe,wAe,KMe],kOe),JMe=(t,e,r)=>{var n,i,a=uy(t,e);if(a!=null){var o=H0(t,e),l=W0(t,e);if(!(o==null||l==null)){var c=$n(t),u=vY(t),{maxBarSize:f}=a,p=Na(f)?u:f,x,m;return c==="horizontal"?(x=Am(t,"xAxis",o,r),m=Cm(t,"xAxis",o,r)):(x=Am(t,"yAxis",l,r),m=Cm(t,"yAxis",l,r)),(n=(i=D2(x,m,!0))!==null&&i!==void 0?i:p)!==null&&n!==void 0?n:0}}},oX=(t,e,r)=>{var n=$n(t),i=H0(t,e),a=W0(t,e);if(!(i==null||a==null)){var o,l;return n==="horizontal"?(o=Am(t,"xAxis",i,r),l=Cm(t,"xAxis",i,r)):(o=Am(t,"yAxis",a,r),l=Cm(t,"yAxis",a,r)),D2(o,l)}},ZMe=nt([XMe,vY,vAe,wY,JMe,oX,WMe],EOe),QMe=(t,e,r)=>{var n=H0(t,e);if(n!=null)return Am(t,"xAxis",n,r)},ePe=(t,e,r)=>{var n=W0(t,e);if(n!=null)return Am(t,"yAxis",n,r)},tPe=(t,e,r)=>{var n=H0(t,e);if(n!=null)return Cm(t,"xAxis",n,r)},rPe=(t,e,r)=>{var n=W0(t,e);if(n!=null)return Cm(t,"yAxis",n,r)},nPe=nt([ZMe,uy],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),sPe=nt([YMe,uy],TOe),iPe=nt([na,iA,QMe,ePe,tPe,rPe,nPe,$n,lAe,oX,sPe,uy,GMe],(t,e,r,n,i,a,o,l,c,u,f,p,x)=>{var{chartData:m,dataStartIndex:y,dataEndIndex:v}=c;if(!(p==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||a==null||u==null)){var{data:j}=p,N;if(j!=null&&j.length>0?N=j:N=m?.slice(y,v+1),N!=null)return PPe({layout:l,barSettings:p,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:f,displayedData:N,offset:t,cells:x,dataStartIndex:y})}}),aPe=["index"];function X_(){return X_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},X_.apply(null,arguments)}function oPe(t,e){if(t==null)return{};var r,n,i=lPe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function lPe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var lX=b.createContext(void 0),cPe=t=>{var e=b.useContext(lX);if(e!=null)return e.stackId;if(t!=null)return t3e(t)},dPe=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),uPe=t=>{var e=b.useContext(lX);if(e!=null){var{stackId:r}=e;return"url(#".concat(dPe(r,t),")")}},hPe=t=>{var{index:e}=t,r=oPe(t,aPe),n=uPe(e);return b.createElement(So,X_({className:"recharts-bar-stack-layer",clipPath:n},r))},fPe=["onMouseEnter","onMouseLeave","onClick"],pPe=["value","background","tooltipPosition"],mPe=["id"],gPe=["onMouseEnter","onClick","onMouseLeave"];function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$u.apply(null,arguments)}function zB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zB(Object(r),!0).forEach(function(n){xPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xPe(t,e,r){return(e=bPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bPe(t){var e=yPe(t,"string");return typeof e=="symbol"?e:e+""}function yPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cw(t,e){if(t==null)return{};var r,n,i=vPe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vPe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var wPe=t=>{var{dataKey:e,name:r,fill:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:f5(r,e),payload:t}]},jPe=b.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:i,name:a,hide:o,unit:l,tooltipType:c,id:u}=t,f={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:e,nameKey:void 0,name:f5(a,e),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return b.createElement(YK,{tooltipEntrySettings:f})});function NPe(t){var e=mr(_0),{data:r,dataKey:n,background:i,allOtherBarProps:a}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=a,u=cw(a,fPe),f=kE(o,n,a.id),p=SE(l),x=_E(c,n,a.id);if(!i||r==null)return null;var m=rb(i);return b.createElement($d,{zIndex:LOe(i,ao.barBackground)},r.map((y,v)=>{var{value:j,background:N,tooltipPosition:C}=y,A=cw(y,pPe);if(!N)return null;var L=f(y,v),O=p(y,v),F=x(y,v),T=bo(bo(bo(bo(bo({option:i,isActive:String(v)===e},A),{},{fill:"#eee"},N),m),Wb(u,y,v)),{},{onMouseEnter:L,onMouseLeave:O,onClick:F,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return b.createElement(lw,$u({key:"background-bar-".concat(v)},T))}))}function kPe(t){var{showLabels:e,children:r,rects:n}=t,i=n?.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return bo(bo({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return b.createElement(DLe,{value:e?i:void 0},r)}function SPe(t){var{shape:e,activeBar:r,baseProps:n,entry:i,index:a,dataKey:o}=t,l=mr(_0),c=mr(mE),u=r&&String(a)===l&&(c==null||o===c),f=u?r:e;return u?b.createElement($d,{zIndex:ao.activeBar},b.createElement(lw,$u({},n,{name:String(n.name)},i,{isActive:u,option:f,index:a,dataKey:o}))):b.createElement(lw,$u({},n,{name:String(n.name)},i,{isActive:u,option:f,index:a,dataKey:o}))}function _Pe(t){var{shape:e,baseProps:r,entry:n,index:i,dataKey:a}=t;return b.createElement(lw,$u({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:i,dataKey:a}))}function CPe(t){var e,{data:r,props:n}=t,i=(e=Ed(n))!==null&&e!==void 0?e:{},{id:a}=i,o=cw(i,mPe),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:f,onClick:p,onMouseLeave:x}=n,m=cw(n,gPe),y=kE(f,c,a),v=SE(x),j=_E(p,c,a);return r?b.createElement(b.Fragment,null,r.map((N,C)=>b.createElement(hPe,$u({index:C,key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(C),className:"recharts-bar-rectangle"},Wb(m,N,C),{onMouseEnter:y(N,C),onMouseLeave:v(N,C),onClick:j(N,C)}),u?b.createElement(SPe,{shape:l,activeBar:u,baseProps:o,entry:N,index:C,dataKey:c}):b.createElement(_Pe,{shape:l,baseProps:o,entry:N,index:C,dataKey:c})))):null}function APe(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:f}=e,p=r.current,x=S5(e,"recharts-bar-"),[m,y]=b.useState(!1),v=!m,j=b.useCallback(()=>{typeof u=="function"&&u(),y(!1)},[u]),N=b.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return b.createElement(kPe,{showLabels:v,rects:n},b.createElement(k5,{animationId:x,begin:o,duration:l,isActive:a,easing:c,onAnimationEnd:j,onAnimationStart:N,key:x},C=>{var A=C===1?n:n?.map((L,O)=>{var F=p&&p[O];if(F)return bo(bo({},L),{},{x:Qi(F.x,L.x,C),y:Qi(F.y,L.y,C),width:Qi(F.width,L.width,C),height:Qi(F.height,L.height,C)});if(i==="horizontal"){var T=Qi(0,L.height,C),I=Qi(L.stackedBarStart,L.y,C);return bo(bo({},L),{},{y:I,height:T})}var B=Qi(0,L.width,C),$=Qi(L.stackedBarStart,L.x,C);return bo(bo({},L),{},{width:B,x:$})});return C>0&&(r.current=A??null),A==null?null:b.createElement(So,null,b.createElement(CPe,{props:e,data:A}))}),b.createElement(UK,{label:e.label}),e.children)}function EPe(t){var e=b.useRef(null);return b.createElement(APe,{previousRectanglesRef:e,props:t})}var cX=0,TPe=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:Bs(t,e)}};class LPe extends b.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var f=ns("recharts-bar",i),p=u;return b.createElement(So,{className:f,id:u},l&&b.createElement("defs",null,b.createElement(wMe,{clipPathId:p,xAxisId:a,yAxisId:o})),b.createElement(So,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(p,")"):void 0},b.createElement(NPe,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),b.createElement(EPe,this.props)))}}var OPe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:cX,xAxisId:0,yAxisId:0,zIndex:ao.bar};function MPe(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:f}=t,{needClip:p}=aX(e,r),x=Xb(),m=Cl(),y=NE(t.children,Em),v=mr(C=>iPe(C,t.id,m,y));if(x!=="vertical"&&x!=="horizontal")return null;var j,N=v?.[0];return N==null||N.height==null||N.width==null?j=0:j=x==="vertical"?N.height/2:N.width/2,b.createElement(vMe,{xAxisId:e,yAxisId:r,data:v,dataPointFormatter:TPe,errorBarOffset:j},b.createElement(LPe,$u({},t,{layout:x,needClip:p,data:v,xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:f})))}function PPe(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:f,displayedData:p,offset:x,cells:m,parentViewBox:y,dataStartIndex:v}=t,j=e==="horizontal"?l:o,N=f?j.scale.domain():null,C=r3e({numericAxis:j}),A=j.scale(C);return p.map((L,O)=>{var F,T,I,B,$,k;if(f){var R=f[O+v];if(R==null)return null;F=Xke(R,N)}else F=Bs(L,r),Array.isArray(F)||(F=[C,F]);var P=zMe(n,cX)(F[1],O);if(e==="horizontal"){var q,[X,G]=[l.scale(F[0]),l.scale(F[1])];T=II({axis:o,ticks:c,bandSize:a,offset:i.offset,entry:L,index:O}),I=(q=G??X)!==null&&q!==void 0?q:void 0,B=i.size;var ne=X-G;if($=Td(ne)?0:ne,k={x:T,y:x.top,width:B,height:x.height},Math.abs(P)>0&&Math.abs($)<Math.abs(P)){var ee=Ha($||P)*(Math.abs(P)-Math.abs($));I-=ee,$+=ee}}else{var[se,J]=[o.scale(F[0]),o.scale(F[1])];if(T=se,I=II({axis:l,ticks:u,bandSize:a,offset:i.offset,entry:L,index:O}),B=J-se,$=i.size,k={x:x.left,y:I,width:x.width,height:$},Math.abs(P)>0&&Math.abs(B)<Math.abs(P)){var W=Ha(B||P)*(Math.abs(P)-Math.abs(B));B+=W}}if(T==null||I==null||B==null||$==null)return null;var U=bo(bo({},L),{},{stackedBarStart:A,x:T,y:I,width:B,height:$,value:f?F:F[1],payload:L,background:k,tooltipPosition:{x:T+B/2,y:I+$/2},parentViewBox:y},m&&m[O]&&m[O].props);return U}).filter(Boolean)}function IPe(t){var e=Va(t,OPe),r=cPe(e.stackId),n=Cl();return b.createElement(KK,{id:e.id,type:"bar"},i=>b.createElement(b.Fragment,null,b.createElement(N7e,{legendPayload:wPe(e)}),b.createElement(jPe,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:i}),b.createElement(D7e,{type:"bar",id:i,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),b.createElement($d,{zIndex:e.zIndex},b.createElement(MPe,$u({},e,{id:i})))))}var dX=b.memo(IPe,EE);dX.displayName="Bar";var RPe=["domain","range"],DPe=["domain","range"];function qB(t,e){if(t==null)return{};var r,n,i=BPe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function BPe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function HB(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function uX(t,e){if(t===e)return!0;var{domain:r,range:n}=t,i=qB(t,RPe),{domain:a,range:o}=e,l=qB(e,DPe);return!HB(r,a)||!HB(n,o)?!1:EE(i,l)}var $Pe=["dangerouslySetInnerHTML","ticks","scale"],FPe=["id","scale"];function J_(){return J_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},J_.apply(null,arguments)}function WB(t,e){if(t==null)return{};var r,n,i=UPe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function UPe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function zPe(t){var e=As(),r=b.useRef(null);return b.useLayoutEffect(()=>{r.current===null?e(pOe(t)):r.current!==t&&e(mOe({prev:r.current,next:t})),r.current=t},[t,e]),b.useLayoutEffect(()=>()=>{r.current&&(e(gOe(r.current)),r.current=null)},[e]),null}var qPe=t=>{var{xAxisId:e,className:r}=t,n=mr(iA),i=Cl(),a="xAxis",o=mr(N=>QY(N,a,e,i)),l=mr(N=>KY(N,e)),c=mr(N=>bEe(N,e)),u=mr(N=>TY(N,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:p,scale:x}=t,m=WB(t,$Pe),{id:y,scale:v}=u,j=WB(u,FPe);return b.createElement(AE,J_({},m,j,{x:c.x,y:c.y,width:l.width,height:l.height,className:ns("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o,axisType:a}))},HPe={allowDataOverflow:ma.allowDataOverflow,allowDecimals:ma.allowDecimals,allowDuplicatedCategory:ma.allowDuplicatedCategory,angle:ma.angle,axisLine:s0.axisLine,height:ma.height,hide:!1,includeHidden:ma.includeHidden,interval:ma.interval,minTickGap:ma.minTickGap,mirror:ma.mirror,orientation:ma.orientation,padding:ma.padding,reversed:ma.reversed,scale:ma.scale,tick:ma.tick,tickCount:ma.tickCount,tickLine:s0.tickLine,tickSize:s0.tickSize,type:ma.type,xAxisId:0},WPe=t=>{var e=Va(t,HPe);return b.createElement(b.Fragment,null,b.createElement(zPe,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),b.createElement(qPe,e))},hX=b.memo(WPe,uX);hX.displayName="XAxis";var GPe=["dangerouslySetInnerHTML","ticks","scale"],VPe=["id","scale"];function Z_(){return Z_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Z_.apply(null,arguments)}function GB(t,e){if(t==null)return{};var r,n,i=YPe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function YPe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function KPe(t){var e=As(),r=b.useRef(null);return b.useLayoutEffect(()=>{r.current===null?e(xOe(t)):r.current!==t&&e(bOe({prev:r.current,next:t})),r.current=t},[t,e]),b.useLayoutEffect(()=>()=>{r.current&&(e(yOe(r.current)),r.current=null)},[e]),null}var XPe=t=>{var{yAxisId:e,className:r,width:n,label:i}=t,a=b.useRef(null),o=b.useRef(null),l=mr(iA),c=Cl(),u=As(),f="yAxis",p=mr(F=>XY(F,e)),x=mr(F=>vEe(F,e)),m=mr(F=>QY(F,f,e,c)),y=mr(F=>LY(F,e));if(b.useLayoutEffect(()=>{if(!(n!=="auto"||!p||vE(i)||b.isValidElement(i)||y==null)){var F=a.current;if(F){var T=F.getCalculatedWidth();Math.round(p.width)!==Math.round(T)&&u(vOe({id:e,width:T}))}}},[m,p,u,i,e,n,y]),p==null||x==null||y==null)return null;var{dangerouslySetInnerHTML:v,ticks:j,scale:N}=t,C=GB(t,GPe),{id:A,scale:L}=y,O=GB(y,VPe);return b.createElement(AE,Z_({},C,O,{ref:a,labelRef:o,x:x.x,y:x.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:p.width,height:p.height,className:ns("recharts-".concat(f," ").concat(f),r),viewBox:l,ticks:m,axisType:f}))},JPe={allowDataOverflow:ga.allowDataOverflow,allowDecimals:ga.allowDecimals,allowDuplicatedCategory:ga.allowDuplicatedCategory,angle:ga.angle,axisLine:s0.axisLine,hide:!1,includeHidden:ga.includeHidden,interval:ga.interval,minTickGap:ga.minTickGap,mirror:ga.mirror,orientation:ga.orientation,padding:ga.padding,reversed:ga.reversed,scale:ga.scale,tick:ga.tick,tickCount:ga.tickCount,tickLine:s0.tickLine,tickSize:s0.tickSize,type:ga.type,width:ga.width,yAxisId:0},ZPe=t=>{var e=Va(t,JPe);return b.createElement(b.Fragment,null,b.createElement(KPe,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),b.createElement(XPe,e))},fX=b.memo(ZPe,uX);fX.displayName="YAxis";var QPe=(t,e)=>e,TE=nt([QPe,$n,AY,ia,mK,Qu,I8e,na],z8e),LE=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},pX=rc("mouseClick"),mX=Yb();mX.startListening({actionCreator:pX,effect:(t,e)=>{var r=t.payload,n=TE(e.getState(),LE(r));n?.activeIndex!=null&&e.dispatch(PEe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Q_=rc("mouseMove"),gX=Yb(),a1=null;gX.startListening({actionCreator:Q_,effect:(t,e)=>{var r=t.payload;a1!==null&&cancelAnimationFrame(a1);var n=LE(r);a1=requestAnimationFrame(()=>{var i=e.getState(),a=cE(i,i.tooltip.settings.shared);if(a==="axis"){var o=TE(i,n);o?.activeIndex!=null?e.dispatch(oK({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(aK())}a1=null})}});function e9e(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var VB={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},xX=il({name:"rootProps",initialState:VB,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:VB.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),t9e=xX.reducer,{updateOptions:r9e}=xX.actions,bX=il({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:n9e}=bX.actions,s9e=bX.reducer,yX=rc("keyDown"),vX=rc("focus"),OE=Yb();OE.startListening({actionCreator:yX,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var o=dE(i,Jm(r),ay(r),cy(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=Qu(r);if(a==="Enter"){var u=sw(r,"axis","hover",String(i.index));e.dispatch(H_({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var f=kEe(r),p=f==="left-to-right"?1:-1,x=a==="ArrowRight"?1:-1,m=l+x*p;if(!(c==null||m>=c.length||m<0)){var y=sw(r,"axis","hover",String(m));e.dispatch(H_({active:!0,activeIndex:m.toString(),activeCoordinate:y}))}}}}}});OE.startListening({actionCreator:vX,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",o=sw(r,"axis","hover",String(a));e.dispatch(H_({active:!0,activeIndex:a,activeCoordinate:o}))}}}});var ql=rc("externalEvent"),wX=Yb(),T3=new Map;wX.startListening({actionCreator:ql,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var i=n.type,a=T3.get(i);a!==void 0&&cancelAnimationFrame(a);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:v8e(l),activeDataKey:mE(l),activeIndex:_0(l),activeLabel:bK(l),activeTooltipIndex:_0(l),isTooltipActive:w8e(l)};r(c,n)}finally{T3.delete(i)}});T3.set(i,o)}}});var i9e=nt([Km],t=>t.tooltipItemPayloads),a9e=nt([i9e,ly,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(l=>l.settings.graphicalItemId===n);if(i!=null){var{positions:a}=i;if(a!=null){var o=e(a,r);return o}}}),jX=rc("touchMove"),NX=Yb();NX.startListening({actionCreator:jX,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),i=cE(n,n.tooltip.settings.shared);if(i==="axis"){var a=r.touches[0];if(a==null)return;var o=TE(n,LE({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));o?.activeIndex!=null&&e.dispatch(oK({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var f=u.getAttribute(KG),p=(l=u.getAttribute(XG))!==null&&l!==void 0?l:void 0,x=Xm(n).find(v=>v.id===p);if(f==null||x==null||p==null)return;var{dataKey:m}=x,y=a9e(n,f,p);e.dispatch(iK({activeDataKey:m,activeIndex:f,activeCoordinate:y,activeGraphicalItemId:p}))}}}});var o9e=yG({brush:OOe,cartesianAxis:wOe,chartData:gTe,errorBars:pMe,graphicalItems:I7e,layout:Hke,legend:Q3e,options:uTe,polarAxis:YLe,polarOptions:s9e,referenceElements:$Oe,rootProps:t9e,tooltip:IEe,zIndex:rTe}),l9e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return mke({reducer:o9e,preloadedState:e,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([mX.middleware,gX.middleware,OE.middleware,wX.middleware,NX.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(PG({type:"raf"}))},devTools:{serialize:{replacer:e9e},name:"recharts-".concat(r)}})};function kX(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=Cl(),a=b.useRef(null);if(i)return r;a.current==null&&(a.current=l9e(e,n));var o=XC;return b.createElement(DMe,{context:o,store:a.current},r)}function c9e(t){var{layout:e,margin:r}=t,n=As(),i=Cl();return b.useEffect(()=>{i||(n(Uke(e)),n(Fke(r)))},[n,i,e,r]),null}var SX=b.memo(c9e,EE);function _X(t){var e=As();return b.useEffect(()=>{e(r9e(t))},[e,t]),null}function YB(t){var{zIndex:e,isPanorama:r}=t,n=b.useRef(null),i=As();return b.useLayoutEffect(()=>(n.current&&i(eTe({zIndex:e,element:n.current,isPanorama:r})),()=>{i(tTe({zIndex:e,isPanorama:r}))}),[i,e,r]),b.createElement("g",{tabIndex:-1,ref:n})}function KB(t){var{children:e,isPanorama:r}=t,n=mr(H8e);if(!n||n.length===0)return e;var i=n.filter(o=>o<0),a=n.filter(o=>o>0);return b.createElement(b.Fragment,null,i.map(o=>b.createElement(YB,{key:o,zIndex:o,isPanorama:r})),e,a.map(o=>b.createElement(YB,{key:o,zIndex:o,isPanorama:r})))}var d9e=["children"];function u9e(t,e){if(t==null)return{};var r,n,i=h9e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function h9e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function dw(){return dw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dw.apply(null,arguments)}var f9e={width:"100%",height:"100%",display:"block"},p9e=b.forwardRef((t,e)=>{var r=tV(),n=rV(),i=pV();if(!lf(r)||!lf(n))return null;var{children:a,otherAttributes:o,title:l,desc:c}=t,u,f;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?f=o.role:f=i?"application":void 0),b.createElement(UC,dw({},o,{title:l,desc:c,role:f,tabIndex:u,width:r,height:n,style:f9e,ref:e}),a)}),m9e=t=>{var{children:e}=t,r=mr(x5);if(!r)return null;var{width:n,height:i,y:a,x:o}=r;return b.createElement(UC,{width:n,height:i,x:o,y:a},e)},XB=b.forwardRef((t,e)=>{var{children:r}=t,n=u9e(t,d9e),i=Cl();return i?b.createElement(m9e,null,b.createElement(KB,{isPanorama:!0},r)):b.createElement(p9e,dw({ref:e},n),b.createElement(KB,{isPanorama:!1},r))});function g9e(){var t=As(),[e,r]=b.useState(null),n=mr(l3e);return b.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;ii(a)&&a!==n&&t(qke(a))}},[e,t,n]),r}function JB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function x9e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JB(Object(r),!0).forEach(function(n){b9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function b9e(t,e,r){return(e=y9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y9e(t){var e=v9e(t,"string");return typeof e=="symbol"?e:e+""}function v9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A0(){return A0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A0.apply(null,arguments)}var w9e=()=>(STe(),null);function uw(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var j9e=b.forwardRef((t,e)=>{var r,n,i=b.useRef(null),[a,o]=b.useState({containerWidth:uw((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:uw((n=t.style)===null||n===void 0?void 0:n.height)}),l=b.useCallback((u,f)=>{o(p=>{var x=Math.round(u),m=Math.round(f);return p.containerWidth===x&&p.containerHeight===m?p:{containerWidth:x,containerHeight:m}})},[]),c=b.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:f,height:p}=u.getBoundingClientRect();l(f,p);var x=y=>{var{width:v,height:j}=y[0].contentRect;l(v,j)},m=new ResizeObserver(x);m.observe(u),i.current=m}},[e,l]);return b.useEffect(()=>()=>{var u=i.current;u?.disconnect()},[l]),b.createElement(b.Fragment,null,b.createElement(y5,{width:a.containerWidth,height:a.containerHeight}),b.createElement("div",A0({ref:c},t)))}),N9e=b.forwardRef((t,e)=>{var{width:r,height:n}=t,[i,a]=b.useState({containerWidth:uw(r),containerHeight:uw(n)}),o=b.useCallback((c,u)=>{a(f=>{var p=Math.round(c),x=Math.round(u);return f.containerWidth===p&&f.containerHeight===x?f:{containerWidth:p,containerHeight:x}})},[]),l=b.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:f}=c.getBoundingClientRect();o(u,f)}},[e,o]);return b.createElement(b.Fragment,null,b.createElement(y5,{width:i.containerWidth,height:i.containerHeight}),b.createElement("div",A0({ref:l},t)))}),k9e=b.forwardRef((t,e)=>{var{width:r,height:n}=t;return b.createElement(b.Fragment,null,b.createElement(y5,{width:r,height:n}),b.createElement("div",A0({ref:e},t)))}),S9e=b.forwardRef((t,e)=>{var{width:r,height:n}=t;return Mu(r)||Mu(n)?b.createElement(N9e,A0({},t,{ref:e})):b.createElement(k9e,A0({},t,{ref:e}))});function _9e(t){return t===!0?j9e:S9e}var C9e=b.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:f,onMouseMove:p,onMouseUp:x,onTouchEnd:m,onTouchMove:y,onTouchStart:v,style:j,width:N,responsive:C,dispatchTouchEvents:A=!0}=t,L=b.useRef(null),O=As(),[F,T]=b.useState(null),[I,B]=b.useState(null),$=g9e(),k=aA(),R=k?.width>0?k.width:N,P=k?.height>0?k.height:i,q=b.useCallback(Q=>{$(Q),typeof e=="function"&&e(Q),T(Q),B(Q),Q!=null&&(L.current=Q)},[$,e,T,B]),X=b.useCallback(Q=>{O(pX(Q)),O(ql({handler:a,reactEvent:Q}))},[O,a]),G=b.useCallback(Q=>{O(Q_(Q)),O(ql({handler:u,reactEvent:Q}))},[O,u]),ne=b.useCallback(Q=>{O(aK()),O(ql({handler:f,reactEvent:Q}))},[O,f]),ee=b.useCallback(Q=>{O(Q_(Q)),O(ql({handler:p,reactEvent:Q}))},[O,p]),se=b.useCallback(()=>{O(vX())},[O]),J=b.useCallback(Q=>{O(yX(Q.key))},[O]),W=b.useCallback(Q=>{O(ql({handler:o,reactEvent:Q}))},[O,o]),U=b.useCallback(Q=>{O(ql({handler:l,reactEvent:Q}))},[O,l]),Y=b.useCallback(Q=>{O(ql({handler:c,reactEvent:Q}))},[O,c]),te=b.useCallback(Q=>{O(ql({handler:x,reactEvent:Q}))},[O,x]),ce=b.useCallback(Q=>{O(ql({handler:v,reactEvent:Q}))},[O,v]),xe=b.useCallback(Q=>{A&&O(jX(Q)),O(ql({handler:y,reactEvent:Q}))},[O,A,y]),ue=b.useCallback(Q=>{O(ql({handler:m,reactEvent:Q}))},[O,m]),ve=_9e(C);return b.createElement(SK.Provider,{value:F},b.createElement(RW.Provider,{value:I},b.createElement(ve,{width:R??j?.width,height:P??j?.height,className:ns("recharts-wrapper",n),style:x9e({position:"relative",cursor:"default",width:R,height:P},j),onClick:X,onContextMenu:W,onDoubleClick:U,onFocus:se,onKeyDown:J,onMouseDown:Y,onMouseEnter:G,onMouseLeave:ne,onMouseMove:ee,onMouseUp:te,onTouchEnd:ue,onTouchMove:xe,onTouchStart:ce,ref:q},b.createElement(w9e,null),r)))}),A9e=["width","height","responsive","children","className","style","compact","title","desc"];function E9e(t,e){if(t==null)return{};var r,n,i=T9e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function T9e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var CX=b.forwardRef((t,e)=>{var{width:r,height:n,responsive:i,children:a,className:o,style:l,compact:c,title:u,desc:f}=t,p=E9e(t,A9e),x=Ed(p);return c?b.createElement(b.Fragment,null,b.createElement(y5,{width:r,height:n}),b.createElement(XB,{otherAttributes:x,title:u,desc:f},a)):b.createElement(C9e,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},b.createElement(XB,{otherAttributes:x,title:u,desc:f,ref:e},b.createElement(UOe,null,a)))});function e6(){return e6=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e6.apply(null,arguments)}var L9e={top:5,right:5,bottom:5,left:5},O9e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:L9e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},M9e=b.forwardRef(function(e,r){var n,i=Va(e.categoricalChartProps,O9e),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,f={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return b.createElement(kX,{preloadedState:{options:f},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:a},b.createElement(tX,{chartData:u.data}),b.createElement(SX,{layout:i.layout,margin:i.margin}),b.createElement(_X,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),b.createElement(CX,e6({},i,{ref:r})))}),P9e=["axis","item"],I9e=b.forwardRef((t,e)=>b.createElement(M9e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:P9e,tooltipPayloadSearcher:_K,categoricalChartProps:t,ref:e}));function R9e(t){var e=As();return b.useEffect(()=>{e(n9e(t))},[e,t]),null}var D9e=["layout"];function t6(){return t6=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},t6.apply(null,arguments)}function B9e(t,e){if(t==null)return{};var r,n,i=$9e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function $9e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var F9e={top:5,right:5,bottom:5,left:5},AX={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:F9e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},U9e=b.forwardRef(function(e,r){var n,i=Va(e.categoricalChartProps,AX),{layout:a}=i,o=B9e(i,D9e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:f}=e,p={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return b.createElement(kX,{preloadedState:{options:p},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},b.createElement(tX,{chartData:i.data}),b.createElement(SX,{layout:a,margin:i.margin}),b.createElement(_X,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),b.createElement(R9e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),b.createElement(CX,t6({},o,{ref:r})))});function ZB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function QB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZB(Object(r),!0).forEach(function(n){z9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function z9e(t,e,r){return(e=q9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q9e(t){var e=H9e(t,"string");return typeof e=="symbol"?e:e+""}function H9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var W9e=["item"],G9e=QB(QB({},AX),{},{layout:"centric",startAngle:0,endAngle:360}),V9e=b.forwardRef((t,e)=>{var r=Va(t,G9e);return b.createElement(U9e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:W9e,tooltipPayloadSearcher:_K,categoricalChartProps:r,ref:e})});const hw=({cards:t=[],type:e="all"})=>{const r=b.useMemo(()=>{const l={0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0};return t.forEach(c=>{const u=c.data||c,f=(u.type_line||"").toLowerCase();if(f.includes("land")&&!f.includes("creature")&&!f.includes("artifact"))return;const p=u.cmc??u.manavalue??0;p>=7?l["7+"]++:l[Math.floor(p)]++}),Object.entries(l).map(([c,u])=>({label:c,value:u}))},[t]),n=b.useMemo(()=>{const l={};return t.forEach(c=>{const f=(c.data||c).type_line||"";["Creature","Instant","Sorcery","Artifact","Enchantment","Planeswalker","Land","Battle"].forEach(x=>{f.includes(x)&&(l[x]=(l[x]||0)+1)})}),Object.entries(l).map(([c,u])=>({name:c,value:u}))},[t]),i=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c","#d0ed57","#8dd1e1"],a=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[e==="all"&&s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Mana Curve"}),s.jsx(VI,{width:"100%",height:"100%",children:s.jsxs(I9e,{data:r,children:[s.jsx(hX,{dataKey:"label",stroke:"#9ca3af",tick:{fontSize:12}}),s.jsx(fX,{stroke:"#9ca3af",allowDecimals:!1,tick:{fontSize:12},width:30}),s.jsx(KD,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(255,255,255,0.1)"}}),s.jsx(dX,{dataKey:"value",fill:"#6366f1",radius:[4,4,0,0],children:r.map((l,c)=>s.jsx(Em,{fill:i[c%i.length]},`cell-${c}`))})]})})]}),o=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Card Types"}),s.jsx(VI,{width:"100%",height:"100%",children:s.jsxs(V9e,{children:[s.jsx(JK,{data:n,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",fill:"#8884d8",dataKey:"value",label:({cx:l,cy:c,midAngle:u,innerRadius:f,outerRadius:p,percent:x,index:m})=>null,children:n.map((l,c)=>s.jsx(Em,{fill:i[c%i.length]},`cell-${c}`))}),s.jsx(KD,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"}}),s.jsx(fV,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"12px"}})]})})]});return e==="mana"?s.jsx("div",{className:"w-full h-full",children:a()}):e==="types"?s.jsx("div",{className:"w-full h-full",children:o()}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-800 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"h-64",children:a()}),s.jsx("div",{className:"h-64",children:o()})]})},L3=[{badge:"White",colors:["W"],theme:"Absolute Order"},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry"},{badge:"Black",colors:["B"],theme:"Unrestricted Power"},{badge:"Red",colors:["R"],theme:"Chaotic Passion"},{badge:"Green",colors:["G"],theme:"Primal Growth"},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control"},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration"},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage"},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction"},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony"},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity"},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genus"},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot"},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression"},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution"},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic"},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny"},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation"},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty"},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order"},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance"},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark"},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay"},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest"},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct"},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence"},{badge:"Colorless",colors:["C"],theme:"The Great Void"}],Y9e=()=>{const{id:t}=Eo(),e=dn(),{currentUser:r,userProfile:n}=Sr(),{addToast:i}=wn(),[a,o]=b.useState(null),[l,c]=b.useState(!0),[u,f]=b.useState("grid"),[p,x]=b.useState(null),[m,y]=b.useState(0);b.useEffect(()=>{(async()=>{try{const X=await Ze.get(`/api/precons/${t}`);o(X)}catch(X){console.error("Precon load failed",X),i("Failed to load precon","error"),e("/precons")}finally{c(!1)}})()},[t,e,i]);const v=b.useMemo(()=>a?[...(a.data.commander||[]).map(q=>({...q,isCommander:!0})),...a.data.mainBoard||[]]:[],[a]),j=b.useMemo(()=>{if(!a)return null;const q=a.data.commander||[];if(q.length>0)return q[0];let X=null,G=-1;const ne=ee=>ee.data?.cmc||ee.cmc||0;for(const ee of a.data.mainBoard||[]){const se=ne(ee);se>G&&(G=se,X=ee)}return X},[a]),N=b.useMemo(()=>!a?.data?.commander||a.data.commander.length<2?null:a.data.commander[1],[a]),C=m===0?j:N||j,A=q=>q?q.image_uris?.normal?q.image_uris.normal:q.card_faces?.[0]?.image_uris?.normal?q.card_faces[0].image_uris.normal:q.data?.image_uris?.normal?q.data.image_uris.normal:q.data?.card_faces?.[0]?.image_uris?.normal?q.data.card_faces[0].image_uris.normal:"https://placehold.co/400x600":"",O=(q=>q?q.image_uris?.art_crop?q.image_uris.art_crop:q.data?.image_uris?.art_crop?q.data.image_uris.art_crop:q.card_faces?.[0]?.image_uris?.art_crop?q.card_faces[0].image_uris.art_crop:q.data?.card_faces?.[0]?.image_uris?.art_crop?q.data.card_faces[0].image_uris.art_crop:A(q):"")(C),F={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},T=b.useMemo(()=>v.reduce((q,X)=>q+(X.count||X.quantity||1),0),[v]),I=b.useMemo(()=>v.reduce((q,X)=>{const G=parseFloat(X.prices?.usd||X.prices?.usd_foil||X.data?.prices?.usd||X.data?.prices?.usd_foil||0);return q+G*(X.count||X.quantity||1)},0),[v]),B=b.useMemo(()=>{const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return v.forEach(X=>{if(X.isCommander){q.Commander.push(X);return}const G=(X.data?.type_line||X.type||"").toLowerCase();G.includes("creature")?q.Creature.push(X):G.includes("planeswalker")?q.Planeswalker.push(X):G.includes("instant")?q.Instant.push(X):G.includes("sorcery")?q.Sorcery.push(X):G.includes("artifact")?q.Artifact.push(X):G.includes("enchantment")?q.Enchantment.push(X):G.includes("land")?q.Land.push(X):q.Other.push(X)}),Object.keys(q).forEach(X=>{q[X]=q[X].map(G=>({...G,image_uri:A(G)}))}),Object.fromEntries(Object.entries(q).filter(([X,G])=>G.length>0))},[v]),$=b.useMemo(()=>{if(!a)return L3.find(G=>G.badge==="Colorless");const q=a.data?.colors||[];return L3.find(G=>G.colors.length!==q.length?!1:G.colors.every(ne=>q.includes(ne)))||L3.find(G=>G.badge==="Colorless")},[a]),{cards:k}=To(),{decks:R}=hf(),P=async q=>{const X=n?.subscription_tier||"free",G=vn(X),ne=G.limits.decks;if(ne!==1/0&&R&&R.length>=ne){i(`Deck limit reached (${R.length}/${ne}). Upgrade to add this deck!`,"error");return}const ee=q==="wishlist",se=ee?"wishlist":"collection",J=G.limits[se];if(J!==1/0&&k){const W=k.filter(Y=>!!Y.is_wishlist===ee).reduce((Y,te)=>Y+(te.count||1),0),U=T;if(W+U>J){i(`${ee?"Wishlist":"Collection"} limit reached. Cannot add ${U} cards. Upgrade needed!`,"error");return}}x(q);try{const W=await Ze.post(`/api/precons/${a.id}/create`,{mode:q});W.success&&(i("Deck created successfully!","success"),e(`/decks/${W.deckId}`))}catch(W){console.error(W),W.message&&W.message.includes("Limit reached")?i(W.message,"error"):i("Failed to create deck","error")}finally{x(null)}};return l?s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})}):a?s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${O})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2 font-bold",children:[s.jsx(br,{to:"/precons",className:"hover:text-white transition-colors",children:"Precons"}),s.jsx("span",{children:"/"}),a.data.code&&s.jsxs(s.Fragment,{children:[s.jsx(br,{to:`/precons/set/${a.data.code}`,className:"hover:text-white transition-colors",children:a.data.code}),s.jsx("span",{children:"/"})]}),s.jsx("span",{className:"text-white",children:a.name})]}),s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:a.type||"Commander"}),s.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:"Official Precon"})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:a.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(a.data.colors||[]).map(q=>s.jsx("img",{src:F[q],alt:q,className:"w-6 h-6"},q))}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:$?.theme||"Deck"})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",I.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[T," Cards"]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 mt-2",children:[s.jsxs("a",{href:`https://www.amazon.com/s?k=${encodeURIComponent(a.name)}&tag=mtgsite-20`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#FF9900] text-black px-4 py-2 rounded-xl font-black hover:bg-[#FF9900]/90 transition-colors shadow-lg shadow-orange-900/20 text-xs uppercase tracking-wider flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M15.54 13.924c-1.35 1.572-3.645 2.502-5.466 2.502-3.132 0-5.187-1.487-6.264-2.292l-.768 1.488c1.374 1.05 4.092 3.036 8.046 2.454 2.829-.414 5.37-2.67 6.096-3.816l-1.644-.336zM3.444 19.542l1.626 1.104c.126.066.27.018.33-.096.792-2.142 2.766-3.21 2.898-3.276.102-.054.126-.18.066-.27l-1.632-2.07c-.066-.09-.192-.09-.264-.024-.03.042-2.22 2.652-3.09 4.392-.048.102.006.21.066.24zM20.598 6.942C20.598 6.942 18.078 2.37 11.232 2.598 4.296 2.826 2.898 7.356 2.898 7.356c-.054.168.042.33.204.372l1.83.474c.144.036.294-.036.354-.168.03-.066 1.038-2.61 5.388-2.88 2.058-.126 4.194.516 5.34 1.764.57.624.81 1.434.69 2.214-1.284.186-2.58.348-3.84.48-4.2.438-6.198 2.052-6.114 4.542.06 1.764 1.344 3.324 3.96 3.258 2.634-.066 4.104-1.848 4.104-1.848v1.446c0 .168.126.3.288.3h1.992c.162 0 .288-.132.288-.3l.006-4.944c-.006-3.324-1.746-5.124-4.8-5.124H20.598zM12.924 10.998c0 .672-.084 1.458-.87 2.016-.624.456-1.398.546-1.956.558-1.098.024-1.722-.594-1.758-1.218-.048-1.02 0-1.872 4.584-2.316v.96z"})}),"Amazon"]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${a.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-black hover:bg-[#3a3a3a] transition-colors shadow-lg shadow-black/20 text-xs uppercase tracking-wider flex items-center gap-2 border border-white/10",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"TCGPlayer"]}),s.jsx("button",{onClick:()=>P("collection"),disabled:p,className:"bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm disabled:opacity-50",children:p==="collection"?"Adding...":"Add to Collection"}),s.jsx("button",{onClick:()=>P("wishlist"),disabled:p,className:"bg-gray-800 text-white border border-gray-700 px-4 py-2 rounded-xl font-bold hover:bg-gray-700 transition-colors text-sm disabled:opacity-50",children:"Wishlist"})]})]})]})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>f("grid"),className:`p-1.5 rounded ${u==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>f("table"),className:`p-1.5 rounded ${u==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries(B).map(([q,X])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-gray-500",children:X.reduce((G,ne)=>G+(ne.count||ne.quantity||1),0)})]}),u==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:X.map((G,ne)=>s.jsx(vm,{card:G,readOnly:!0,showQuantity:!0},ne))}):s.jsx("div",{className:"space-y-1",children:X.map((G,ne)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:G.count||G.quantity||1}),s.jsx("span",{className:G.finish==="foil"?"text-yellow-200":"",children:G.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:G.manacost||G.mana_cost||G.data?.mana_cost})]},ne))})]},q))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:j?.isCommander?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:A(C)||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Featured Card"}),C?.data?.card_faces?.length>1&&C.data.card_faces[1].image_uris&&s.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-gray-900/80 rounded block md:hidden",title:"Flip",children:""})]}),N&&s.jsx("button",{onClick:()=>y(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:m===0?"View Partner":"View Commander"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(hw,{cards:v,type:"mana"})]}),s.jsxs("div",{className:"h-[220px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(hw,{cards:v,type:"types"})]})]})]})]})]})]})]}):null},lu={ANALYSIS:1,ARCHITECT:2,DEPLOY:3},K9e=()=>{const{deckId:t}=Eo(),e=dn(),{userProfile:r,currentUser:n}=Sr(),{addToast:i}=wn(),{deck:a,cards:o,loading:l}=PC(t),{cards:c}=To(),[u,f]=b.useState(lu.ANALYSIS),[p,x]=b.useState(`Initializing ${r?.settings?.helper?.name||"Oracle"}...`),[m,y]=b.useState([]),[v,j]=b.useState(!1),[N,C]=b.useState({}),[A,L]=b.useState(new Set),[O,F]=b.useState("All"),[T,I]=b.useState("grid"),B=b.useRef(null),[$,k]=b.useState({ownedOnly:!0,excludeAssigned:!0,restrictSet:!1,setName:""});b.useEffect(()=>{B.current?.scrollIntoView({behavior:"smooth"})},[m]),b.useEffect(()=>{a?.commander?.set_name&&!$.setName&&k(ue=>({...ue,setName:a.commander.set_name}))},[a,$.setName]);const R=ue=>{y(ve=>[...ve,`[${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${ue}`])},P=r?.settings?.helper?.name||"The Oracle",q=ue=>{if(!ue)return null;const ve=ue.data||ue;return ve.image_uris?.art_crop?ve.image_uris.art_crop:ve.card_faces?.[0]?.image_uris?.art_crop?ve.card_faces[0].image_uris.art_crop:ve.image_uris?.normal?ve.image_uris.normal:null},X=ue=>new Promise(ve=>setTimeout(ve,ue)),G={W:"00000000-0000-0000-0000-000000000001",U:"00000000-0000-0000-0000-000000000002",B:"00000000-0000-0000-0000-000000000003",R:"00000000-0000-0000-0000-000000000004",G:"00000000-0000-0000-0000-000000000005"},ne=(ue,ve)=>{const Q={W:0,U:0,B:0,R:0,G:0,total:0},pe=Ce=>{Ce&&(Q.W+=(Ce.match(/\{W\}/g)||[]).length,Q.U+=(Ce.match(/\{U\}/g)||[]).length,Q.B+=(Ce.match(/\{B\}/g)||[]).length,Q.R+=(Ce.match(/\{R\}/g)||[]).length,Q.G+=(Ce.match(/\{G\}/g)||[]).length)};return ue.forEach(Ce=>pe(Ce.mana_cost||Ce.data?.mana_cost)),Object.values(ve).forEach(Ce=>pe(Ce.data?.mana_cost||Ce.type_line)),Q.total=Q.W+Q.U+Q.B+Q.R+Q.G,Q},ee=(ue,ve,Q)=>{if(ue<=0)return{};if(ve.total===0)return{};const pe={W:{name:"Plains",type:"Basic Land  Plains"},U:{name:"Island",type:"Basic Land  Island"},B:{name:"Swamp",type:"Basic Land  Swamp"},R:{name:"Mountain",type:"Basic Land  Mountain"},G:{name:"Forest",type:"Basic Land  Forest"}},Ce={};let je=0;const we={};if(["W","U","B","R","G"].forEach(Te=>{if(ve[Te]>0){const oe=ve[Te]/ve.total,De=Math.round(ue*oe);we[Te]=De,je+=De}}),je>0){const Te=Object.keys(we).filter(oe=>we[oe]>0);Te.sort((oe,De)=>we[De]-we[oe]),je<ue?we[Te[0]]+=ue-je:je>ue&&(we[Te[0]]-=je-ue)}return Object.entries(we).forEach(([Te,oe])=>{if(oe>0){const De=pe[Te],Nt=G[Te],ot=Q.find(Ne=>Ne.name===De.name)||{name:De.name,type_line:De.type,scryfall_id:Nt,id:Nt,image_uris:{normal:`https://api.scryfall.com/cards/named?exact=${De.name}&format=image`}};for(let Ne=0;Ne<oe;Ne++){const Ge=`basic-${Te}-${Ne}-${Date.now()}`;Ce[Ge]={firestoreId:Ge,name:De.name,type_line:De.type,rating:10,reason:`Auto-filled to match ${Math.round(ve[Te]/ve.total*100)}% ${Te} pip density.`,suggestedType:"Land",data:{...ot.data||ot,scryfall_id:ot.scryfall_id||ot.id||Nt},isVirtual:!0}}}}),Ce},se=(ue,ve)=>{if(!ue||ue.length===0)return!0;if(!ve||ve.length===0)return ue.length===0;const Q=new Set(ve);return ue.every(pe=>Q.has(pe))},J=async()=>{if(!r?.settings?.geminiApiKey){i("Gemini API Key missing in settings.","error"),e("/settings/ai");return}j(!0),x("Scanning Collection..."),R(`Starting analysis (Owned: ${$.ownedOnly}, Exclude Assigned: ${$.excludeAssigned}, Set: ${$.restrictSet?$.setName:"Any"})...`);try{const ue=[...new Set([...a.commander?.color_identity||[],...a.commander_partner?.color_identity||[]])],ve=a.aiBlueprint||{},Q=["Synergy / Strategy","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Land"],pe=new Set(o.map(Ve=>Ve.name));a.commander?.name&&pe.add(a.commander.name),a.commander_partner?.name&&pe.add(a.commander_partner.name);const Ce={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...ve.suggestedCounts||{}},je={},we=new Set,Te=$.setName.toLowerCase().trim(),oe={};let De=0;for(const Ve of Q){const lt=o.filter(Bt=>(Bt.data?.type_line||Bt.type_line||"").includes(Ve)).reduce((Bt,zt)=>Bt+(zt.countInDeck||1),0),kt=Ce[Ve]||0;let Ue=Math.max(0,kt-lt);Ue>0&&(oe[Ve]=Ue,De+=Ue)}if(De===0){R("Deck goals appear met! No missing slots found based on targets."),j(!1),x("Idle");return}R(`Scanning collection for candidates (Need ${De} total items)...`);const Nt=[],ot=new Set;for(const Ve of c){if(ot.has(Ve.name)||$.ownedOnly&&Ve.is_wishlist||$.excludeAssigned&&Ve.deckId)continue;const lt=Ve.data?.color_identity||Ve.data?.colors||[];if(se(lt,ue)&&!pe.has(Ve.name)){if($.restrictSet&&Te){const kt=(Ve.set_name||Ve.data?.set_name||"").toLowerCase(),Ue=(Ve.set||Ve.data?.set||"").toLowerCase();if(!kt.includes(Te)&&Ue!==Te)continue}Nt.push({firestoreId:Ve.id,name:Ve.name,type_line:Ve.data?.type_line||Ve.type_line}),ot.add(Ve.name)}}if(Nt.length===0){R("No valid candidates found with current filters."),j(!1),x("Idle");return}const Ne={Creature:0,Instant:0,Sorcery:0,Artifact:0,Enchantment:0,Land:0,Planeswalker:0};Nt.forEach(Ve=>{const lt=(Ve.type_line||"").toLowerCase();lt.includes("creature")&&Ne.Creature++,lt.includes("instant")&&Ne.Instant++,lt.includes("sorcery")&&Ne.Sorcery++,lt.includes("artifact")&&Ne.Artifact++,lt.includes("enchantment")&&Ne.Enchantment++,lt.includes("land")&&Ne.Land++,lt.includes("planeswalker")&&Ne.Planeswalker++}),R(`Payload: ${Nt.length} Cards available for Analysis.`),R(`Breakdown: ${Ne.Creature} Creatures, ${Ne.Instant} Instants, ${Ne.Sorcery} Sorceries, ${Ne.Artifact} Artifacts, ${Ne.Enchantment} Enchantments, ${Ne.Land} Lands`);const Ge={deckName:a.name,commander:`${a.commander?.name}${a.commander_partner?" & "+a.commander_partner.name:""}`,playerProfile:JSON.stringify(r?.playstyle||{}),strategyGuide:ve?.strategy||"No specific strategy guide.",helperPersona:r?.settings?.helper,instructions:`Fill the following deck slots: ${JSON.stringify(oe)}.`,deckRequirements:oe,candidates:Nt.slice(0,3500),currentContext:Array.from(pe),neededCount:De,experienceLevel:"Advanced"},Xe=["Consulting the archives...","Analysing mana curves...","Simulating 10,000 games...","Checking for infinite combos...","Optimizing synergy lines...","Reviewing EDHRec data...","Considering card advantage engines...","Balancing interaction package...","Calculating probability of turn 3 win...","Searching for hidden gems...","Double-checking rule 0...","Consulting the Oracle...","Gathering arcane wisdom...","Tapping into the leyline..."];let xt=0;for(;xt<2;){let Ve;try{R(`Consulting ${P} for Holistic Analysis (Need ${De} cards from ${Nt.length} candidates)...`),Ve=setInterval(()=>{const kt=Xe[Math.floor(Math.random()*Xe.length)];x(`${P}: ${kt}`)},2500),x(`Consulting ${P}...`),await X(1500);const lt=await yo.generateDeckSuggestions(r.settings.geminiApiKey,Ge);if(clearInterval(Ve),lt?.suggestions){lt.suggestions.forEach(kt=>{const Ue=Nt.find(Bt=>Bt.firestoreId===kt.firestoreId);if(Ue){const Bt=c.find(Et=>Et.id===kt.firestoreId),zt=kt.firestoreId,Ot=kt.role||"Synergy / Strategy";je[zt]={...kt,firestoreId:zt,name:Bt?.name||Ue.name,type_line:Bt?.data?.type_line||Ue.type_line,data:Bt?.data||Bt,rating:kt.rating,reason:kt.reason,suggestedType:Ot},we.add(zt)}}),R(`${P} provided ${lt.suggestions.length} suggestions across all roles.`);break}}catch(lt){Ve&&clearInterval(Ve),console.error(lt),R(`Error: ${lt.message}. Retrying...`),xt++,await X(2e3)}}const Ae=o.filter(Ve=>(Ve.data?.type_line||Ve.type_line||"").includes("Land")).length,Pe=Object.values(je).filter(Ve=>Ve.suggestedType==="Land").length,ct=Ae+Pe,bt=Ce.Land||36,dt=Math.max(0,bt-ct);if(dt>0){R(`Calculating mana base for ${dt} remaining land slots...`);const Ve=ne(o,je),lt=ee(dt,Ve,c);Object.assign(je,lt),Object.keys(lt).forEach(kt=>we.add(kt)),R(`Added ${Object.keys(lt).length} Basic Lands to balance mana curve.`)}C(je),L(we),R("Architecture complete. Proceeding to Architect view."),f(lu.ARCHITECT)}catch(ue){console.error(ue),i("Architecture failed. Please check your AI key.","error")}finally{j(!1),x("Ready.")}},W=()=>{(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&f(lu.ARCHITECT)},U=ue=>{const ve=new Set(A);ve.has(ue)?ve.delete(ue):ve.add(ue),L(ve)},Y=()=>s.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"inline-block p-4 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-4 animate-bounce",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase italic",children:[P," Deck Architect"]}),s.jsxs("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:[P," will analyze your collection and current deck composition to architect the perfect additions for ",s.jsx("span",{className:"text-indigo-400 font-bold",children:a?.name}),"."]})]}),s.jsxs("div",{className:"bg-gray-900/40 backdrop-blur-xl rounded-3xl border border-white/10 p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),s.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Builder Configuration"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Candidate Pool"}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Owned Cards Only"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Hide wishlist items"})]}),s.jsx("div",{onClick:()=>k(ue=>({...ue,ownedOnly:!ue.ownedOnly})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${$.ownedOnly?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${$.ownedOnly?"translate-x-6":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Exclude Assigned"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Skip cards in other decks"})]}),s.jsx("div",{onClick:()=>k(ue=>({...ue,excludeAssigned:!ue.excludeAssigned})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${$.excludeAssigned?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${$.excludeAssigned?"translate-x-6":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Set Priority"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"restrictSet",checked:$.restrictSet,onChange:ue=>k(ve=>({...ve,restrictSet:ue.target.checked})),className:"rounded bg-gray-800 border-gray-700 text-indigo-500 focus:ring-indigo-500 focus:ring-offset-gray-900"}),s.jsx("label",{htmlFor:"restrictSet",className:"text-xs text-indigo-300 font-bold cursor-pointer select-none",children:"Restrict to Set"})]})]}),s.jsx("input",{type:"text",disabled:!$.restrictSet,value:$.setName,onChange:ue=>k(ve=>({...ve,setName:ue.target.value})),placeholder:"e.g. Avatar, KTK, Khans...",className:`w-full bg-gray-950/50 border rounded-xl px-4 py-2.5 text-sm transition-all focus:ring-2 focus:ring-indigo-500/50 outline-none ${$.restrictSet?"border-indigo-500/30 text-white placeholder-gray-600":"border-white/5 text-gray-600 cursor-not-allowed"}`}),$.restrictSet&&s.jsxs("p",{className:"text-[10px] text-yellow-500/80 font-medium animate-fade-in",children:[' Only cards matching "',$.setName,'" will be suggested.']})]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/5 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${v?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:p})]}),s.jsxs("div",{className:"flex gap-4",children:[(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&s.jsx("button",{onClick:W,className:"bg-amber-600/20 hover:bg-amber-600/40 text-amber-500 font-black px-6 py-3 rounded-2xl transition-all uppercase tracking-widest text-[10px] border border-amber-500/20",children:"Quick Skip (Dev)"}),!v&&s.jsx("button",{onClick:J,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black px-8 py-3 rounded-2xl transition-all shadow-lg shadow-indigo-500/20 uppercase tracking-widest text-xs border border-white/10",children:"Start Architecture"})]})]}),s.jsxs("div",{className:"p-8 h-[400px] overflow-y-auto font-mono text-xs space-y-3 custom-scrollbar bg-black/40 backdrop-blur-inner shadow-inner box-shadow-inner border-t border-white/5 font-medium leading-relaxed",children:[m.length===0?s.jsx("div",{className:"text-gray-600 italic animate-pulse",children:"Waiting for architecture to start..."}):m.map((ue,ve)=>s.jsx("div",{className:"text-gray-300 animate-fade-in pl-4 border-l-2 border-indigo-500/40 py-1 hover:bg-white/5 transition-colors rounded-r",children:ue},ve)),s.jsx("div",{ref:B})]})]})]}),te=()=>{const ue=Object.values(N).filter(Q=>O==="All"||Q.suggestedType===O),ve=["All","Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];return s.jsxs("div",{className:"h-full flex flex-col gap-6 py-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Selection Phase"}),s.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:["Review ",P,"'s suggestions and select the ones you want to draft into your deck."]})]}),s.jsx("div",{className:"flex items-center gap-3 bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md",children:[{mode:"grid",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{mode:"table",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"list",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}].map(({mode:Q,icon:pe})=>s.jsx("button",{onClick:()=>I(Q),className:`p-2 rounded-xl transition-all ${T===Q?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,title:`${Q.charAt(0).toUpperCase()+Q.slice(1)} View`,children:pe},Q))})]}),s.jsx("div",{className:"flex bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md overflow-x-auto no-scrollbar mx-4",children:ve.map(Q=>{const pe=Object.values(N).filter(Ce=>Q==="All"||Ce.suggestedType===Q).length;return Q!=="All"&&pe===0?null:s.jsxs("button",{onClick:()=>F(Q),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${O===Q?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[Q," ",s.jsx("span",{className:"ml-1 opacity-40 font-mono",children:pe})]},Q)})}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 custom-scrollbar",children:[T==="list"&&s.jsx("div",{className:"space-y-4",children:ue.map(Q=>s.jsxs("div",{onClick:()=>U(Q.firestoreId),className:`grid grid-cols-[auto_1fr_auto_auto] gap-8 items-center p-6 rounded-[2rem] border transition-all cursor-pointer group ${A.has(Q.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${A.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10 group-hover:border-white/30"}`,children:A.has(Q.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"block text-xl font-black text-white uppercase italic tracking-tight group-hover:text-indigo-300 transition-colors",children:Q.name}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.2em] uppercase",children:Q.type_line})]}),s.jsxs("div",{className:"text-center font-mono text-indigo-400 font-bold bg-white/5 px-4 py-2 rounded-2xl border border-white/5",children:[Q.rating,"/10"]}),s.jsxs("div",{className:"max-w-md bg-black/30 p-4 rounded-2xl border border-white/5 text-sm text-gray-400 font-medium italic leading-relaxed",children:['"',Q.reason,'"']})]},Q.firestoreId))}),T==="grid"&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-6",children:ue.map(Q=>s.jsxs("div",{onClick:()=>U(Q.firestoreId),className:`flex flex-col rounded-[2rem] border transition-all cursor-pointer group overflow-hidden ${A.has(Q.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden",children:[s.jsx("img",{src:Q.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(Q.name)}&format=image`,alt:Q.name,className:"w-full h-full object-cover transition-transform group-hover:scale-110",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"}),s.jsx("div",{className:`absolute top-4 right-4 w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${A.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"bg-black/40 border-white/20 group-hover:border-white/40"}`,children:A.has(Q.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[s.jsx("span",{className:"block text-lg font-black text-white uppercase italic tracking-tight line-clamp-1",children:Q.name}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-300 tracking-[0.2em] uppercase truncate max-w-[70%]",children:Q.type_line}),s.jsxs("span",{className:"text-xs font-mono text-indigo-400 font-bold bg-black/60 px-2 py-0.5 rounded-lg border border-white/10",children:[Q.rating,"/10"]})]})]})]}),s.jsx("div",{className:"p-4 flex-1 flex flex-col justify-between",children:s.jsxs("div",{className:"text-xs text-gray-400 font-medium italic leading-relaxed line-clamp-3",children:['"',Q.reason,'"']})})]},Q.firestoreId))}),T==="table"&&s.jsx("div",{className:"bg-gray-950/30 rounded-[2rem] border border-white/5 overflow-hidden",children:s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-white/5 font-black text-[10px] uppercase tracking-[0.2em] text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 w-16",children:"Select"}),s.jsx("th",{className:"px-6 py-4",children:"Card Name"}),s.jsx("th",{className:"px-6 py-4",children:"Type"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"Rating"}),s.jsx("th",{className:"px-6 py-4",children:"Reasoning"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:ue.map(Q=>s.jsxs("tr",{onClick:()=>U(Q.firestoreId),className:`hover:bg-white/5 cursor-pointer transition-colors ${A.has(Q.firestoreId)?"bg-indigo-500/5":""}`,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${A.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10"}`,children:A.has(Q.firestoreId)&&s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-bold text-white uppercase italic tracking-tight",children:Q.name})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.1em] uppercase",children:Q.type_line})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"font-mono text-indigo-400 font-bold bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:Q.rating})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-xs text-gray-400 italic line-clamp-1",children:['"',Q.reason,'"']})})]},Q.firestoreId))})]})})]}),s.jsxs("div",{className:"p-8 bg-gray-950/40 backdrop-blur-3xl rounded-3xl border border-white/10 flex justify-between items-center shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Draft Progress"}),s.jsxs("span",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:[A.size," Cards Selected"]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>f(lu.ANALYSIS),className:"px-8 py-3.5 bg-white/5 hover:bg-white/10 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-[11px] transition-all",children:"Re-Analyze"}),s.jsx("button",{onClick:()=>f(lu.DEPLOY),className:"px-10 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/20 uppercase tracking-widest text-[11px] border border-white/10 transition-all",children:"Review & Deploy"})]})]})]})},ce=()=>{const ue=Array.from(A).map(Q=>N[Q]),ve=async()=>{if(!v){j(!0);try{const Q=[],pe=new Map;c.forEach(we=>{const Te=we.scryfall_id||we.data?.scryfall_id;Te&&!we.deck_id&&pe.set(Te,(pe.get(Te)||0)+1)});const Ce=new Set(o.map(we=>we.name)),je=new Set;for(const we of ue){const Te=we.data||we,oe=Te.scryfall_id||Te.id||(we.isVirtual?null:we.firestoreId),De=we.type_line&&we.type_line.includes("Basic Land"),Nt=we.type_line&&(we.type_line.includes("Relentless Rats")||we.type_line.includes("Shadowborn Apostle")||we.type_line.includes("Persistent Petitioners")||we.type_line.includes("Nazgl")||we.type_line.includes("Slime Against Humanity"));if(!De&&!Nt&&je.has(we.name)){console.warn(`[Deploy] Skipping duplicate in batch: ${we.name}`);continue}if(!De&&!Nt&&Ce.has(we.name)){console.warn(`[Deploy] Skipping card already in deck: ${we.name}`);continue}je.add(we.name);let ot=!1;if(oe&&pe.has(oe)){const Ne=pe.get(oe);Ne>0&&(ot=!0,pe.set(oe,Ne-1))}if(!ot&&a.is_mockup===!1&&!De)throw new Error(`Cannot add unowned card "${we.name}" to a Collection Deck.`);Q.push({scryfall_id:oe,name:we.name||Te.name||"Unknown Card",set_code:Te.set||Te.set_code||"???",collector_number:Te.collector_number||"0",finish:"nonfoil",image_uri:Te.image_uris&&Te.image_uris.normal||Te.image_uri||null,data:Te,count:1,is_wishlist:!(ot||De)})}await Ze.post(`/api/decks/${t}/cards/batch`,{cards:Q}),i(`Successfully added ${Q.length} cards to ${a.name}!`,"success"),e(`/decks/${t}`)}catch(Q){console.error("Deployment failed:",Q),i("Failed to deploy cards. Please try again.","error")}finally{j(!1)}}};return s.jsxs("div",{className:"max-w-5xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:"Final Deployment"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Review your selected additions before applying them to your deck."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ue.map(Q=>s.jsxs("div",{className:"bg-gray-950/30 p-6 rounded-[2rem] border border-white/10 space-y-4",children:[s.jsx("span",{className:"font-black text-white uppercase italic text-lg truncate block",children:Q.name}),s.jsxs("div",{className:"text-xs text-gray-400 leading-relaxed italic",children:['"',Q.reason,'"']})]},Q.firestoreId))}),s.jsxs("div",{className:"flex gap-6 justify-center",children:[s.jsx("button",{onClick:()=>f(lu.ARCHITECT),className:"px-12 py-4 bg-gray-900 hover:bg-gray-800 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-xs transition-all",children:"Back to Architect"}),s.jsxs("button",{onClick:ve,disabled:v,className:"px-16 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-2xl shadow-indigo-500/40 uppercase tracking-widest text-xs border border-white/10 transition-all",children:['Apply to "',a?.name,'"']})]})]})};if(l)return s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-indigo-500 border-t-transparent rounded-full"})});const xe=q(a?.commander)||q(a?.commander_partner);return s.jsxs("div",{className:"min-h-screen bg-gray-950 text-gray-200 font-sans relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${xe})`,backgroundSize:"cover",backgroundPosition:"center"},children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/80 to-gray-950/40"})]}),s.jsxs("div",{className:"sticky top-0 z-50 px-6 py-4 flex justify-between items-center bg-gray-950 border-b border-white/5",children:[s.jsxs("button",{onClick:()=>e(`/decks/${t}`),className:"text-gray-500 hover:text-white flex items-center gap-2 group transition-all",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Exit Wizard"})]}),s.jsx("div",{className:"flex gap-12",children:[1,2,3].map(ue=>s.jsxs("div",{className:`flex items-center gap-3 transition-all ${u===ue?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${u>=ue?"bg-indigo-500 text-white":"bg-gray-800 text-gray-600"}`,children:ue}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em]",children:ue===1?"Analysis":ue===2?"Architect":"Deploy"})]},ue))}),s.jsx("div",{className:"w-32"})," "]}),s.jsxs("main",{className:"flex-1 relative z-10 px-4 max-w-7xl mx-auto w-full",children:[u===lu.ANALYSIS&&Y(),u===lu.ARCHITECT&&te(),u===lu.DEPLOY&&ce()]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
                @keyframes pulse { 0%, 100% { opacity: 0.2; transform: scale(1.05); } 50% { opacity: 0.4; transform: scale(1); } }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]})},X9e=({onNext:t,onBack:e,currentTier:r})=>{const[n,i]=b.useState("monthly"),[a,o]=b.useState(!1),l=async c=>{o(!0),await t(c,n),o(!1)};return s.jsxs("div",{className:"max-w-7xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.3)]",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h2",{className:"text-4xl font-extrabold text-white",children:"Choose Your Power Level"}),s.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Unlock advanced deck building tools, unlimited storage, and AI-powered insights."})]}),s.jsx(OC,{billingInterval:n,setBillingInterval:i,onSubscribe:l,isLoading:a,currentTier:r||"free",showIntervalSelector:!0}),s.jsx("div",{className:"flex justify-center pt-8",children:e&&s.jsxs("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors flex items-center gap-2",disabled:a,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})})]})},J9e=({onNext:t})=>s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-indigo-500/20 rounded-full flex items-center justify-center ring-1 ring-indigo-500/50 shadow-[0_0_30px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-extrabold text-white mb-4",children:"Welcome to MTG-Forge"}),s.jsxs("p",{className:"text-xl text-gray-300 leading-relaxed",children:["Your ultimate companion for deck building, collection management, and magical optimization.",s.jsx("br",{}),"Let's get everything set up in just a few clicks."]})]}),s.jsx("button",{onClick:t,className:"px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-1",children:"Let's Go"})]}),Z9e=({onNext:t,onBack:e})=>{const[r,n]=b.useState("");return s.jsxs("div",{className:"max-w-3xl w-full space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Enable AI Architect"}),s.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Our AI analyzes your cards to suggest synergies, optimal mana curves, and complete deck strategies."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Automated Building"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Generate entire commander decks from a single prompt or theme using your own collection."})]}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Synergy Scouting"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Find hidden gems in your binder that perfectly match your commander's strategy."})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Why do I need my own API Key?"}),s.jsx("p",{className:"text-sm text-blue-100/80 leading-relaxed",children:"MTG-Forge connects directly to Google's Gemini AI to power its deck architect features. To ensure usage, privacy, and zero rampingsubscription fees, we ask users to provide their own free API key. Your key is stored locally on your device and is never shared with us."}),s.jsxs("div",{className:"mt-4 p-3 bg-indigo-900/40 border border-indigo-500/30 rounded-lg",children:[s.jsxs("h4",{className:"font-bold text-indigo-200 mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-400",children:""})," AI is Experimental"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["Our AI Architect is a powerful assistant, but ",s.jsx("strong",{children:"YOU"})," are the true deck builder. AI can suggest amazing synergies, but it can also make mistakes or suggest suboptimal cards. Always review and refine the suggestions to match your personal playstyle and meta."]})]})]})]})}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700 space-y-4 text-left",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Enter your Gemini API Key"}),s.jsx("input",{type:"password",value:r,onChange:i=>n(i.target.value),placeholder:"AIzaSy...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors"}),s.jsxs("div",{className:"text-sm text-gray-400",children:["Don't have a key? ",s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300 underline",children:"Get a free key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 pt-4",children:[e&&s.jsx("button",{onClick:e,className:"nav-button px-10 py-3 rounded-lg font-bold transition-all border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-800/50",children:"Back"}),s.jsx("button",{onClick:()=>t(r),disabled:!r,className:`nav-button px-10 py-3 rounded-lg font-bold transition-all shadow-lg transform hover:-translate-y-0.5 ${r?"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/25":"bg-gray-700 text-gray-400 cursor-not-allowed shadow-none"}`,children:"Save & Enable AI"}),s.jsx("button",{onClick:()=>t(null),className:"text-gray-500 text-sm hover:text-gray-300 underline transition-colors",children:"Skip (Features Disabled)"})]})]})},Q9e=({onNext:t,onBack:e})=>{const[r,n]=Ke.useState(0),[i,a]=Ke.useState(!1),o=[{title:"Manage Your Collection",desc:"Import cards, track values, and organize your entire library in one place.",details:["Navigate to the 'Collection' page via the top navigation bar.","Click the 'Add Cards' button to bulk add cards from CSV, text, or card scanner.","Use the 'Binder' view to visually organize your cards by Set, Color, or Rarity.","More organizational features coming soon, as in folders and custom groupings."],icon:s.jsx("svg",{className:"w-16 h-16 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{title:"Build & Analyze Decks",desc:"Use the Architect Wizard to construct powerful decks with real-time stats and mana analysis.",details:["Go to 'Decks' and click 'Create New Deck'.","Choose your format: 'Commander' or 'Standard'.","Select a Commander or Spotlight Card to anchor your strategy.","Use the 'AI Architect' to generate suggested cards based on your themes.","Review mana curves, color distribution, and type breakdowns in the 'Stats' tab."],icon:s.jsx("svg",{className:"w-16 h-16 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{title:"Wishlist & Tracking",desc:"Keep track of cards you need and plan your next purchases directly from deck builds.",details:["Search for any card in the database, even ones you don't own.","Click the 'Heart' icon to add it to your Wishlist.","When building decks, enable 'Theorycraft Mode' to include wishlist cards.","View your shopping list in the 'Wishlist' tab of your Collection."],icon:s.jsx("svg",{className:"w-16 h-16 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}],l=o[r],c=()=>{r<o.length-1?(n(r+1),a(!1)):t()};return s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-10 animate-fade-in relative",children:[s.jsxs("div",{className:"h-80 flex flex-col items-center justify-center bg-gray-800/30 rounded-2xl border border-gray-700/50 p-8 relative overflow-hidden group",children:[s.jsxs("div",{className:`absolute inset-0 bg-gray-900/95 backdrop-blur-md z-20 flex flex-col items-center justify-center p-8 transition-all duration-300 ${i?"opacity-100 translate-y-0":"opacity-0 translate-y-full pointer-events-none"}`,children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx("span",{children:""})," How it Works"]}),s.jsx("ul",{className:"space-y-4 text-left w-full max-w-md",children:l.details.map((u,f)=>s.jsxs("li",{className:"flex gap-3 text-gray-300 text-sm",children:[s.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-indigo-500/20 text-indigo-400 flex items-center justify-center font-bold text-xs border border-indigo-500/30",children:f+1}),s.jsx("span",{className:"leading-relaxed",children:u})]},f))}),s.jsx("button",{onClick:()=>a(!1),className:"mt-8 text-sm text-gray-500 hover:text-white underline",children:"Close Details"})]}),s.jsxs("div",{className:"animate-fade-in-up flex flex-col items-center",children:[s.jsx("div",{className:"mb-6 opacity-90 transform group-hover:scale-110 transition-transform duration-500",children:l.icon}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:l.title}),s.jsx("p",{className:"text-lg text-gray-400 max-w-md mb-6",children:l.desc}),s.jsxs("button",{onClick:()=>a(!0),className:"text-sm font-bold text-indigo-400 hover:text-indigo-300 flex items-center gap-1 transition-colors px-4 py-2 rounded-lg hover:bg-indigo-500/10",children:[s.jsx("span",{children:"View Walkthrough"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]},r)]}),s.jsxs("div",{className:"flex flex-col items-center gap-6",children:[s.jsx("div",{className:"flex gap-2",children:o.map((u,f)=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${f===r?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},f))}),s.jsxs("div",{className:"flex gap-4 w-full sm:w-auto",children:[e&&s.jsx("button",{onClick:()=>{r>0?(n(r-1),a(!1)):e()},className:"px-6 py-3 bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white rounded-lg font-bold transition-colors w-full sm:w-auto",children:"Back"}),s.jsx("button",{onClick:c,className:"px-10 py-3 bg-white text-gray-900 hover:bg-gray-100 rounded-lg font-bold transition-colors w-full sm:w-auto",children:r===o.length-1?"Finish Setup":"Next Feature"})]})]})]})},eIe=({onNext:t,onBack:e})=>{const{userProfile:r}=Sr(),[n,i]=b.useState("selection"),[a,o]=b.useState({name:"",type:"",personality:""}),[l,c]=b.useState([]),[u,f]=b.useState(""),[p,x]=b.useState(!1),m=b.useRef(null),y={name:"Oracle",type:"Mystic Construct",personality:"Wise, Efficient, Slightly Mystical"};b.useEffect(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[l]);const v=()=>{t(y)},j=async()=>{i("forge"),x(!0),c([{role:"model",content:"Booting Forge System... I am the construct builder. Let's create your companion. First, does your helper have a name, or shall we define their personality first?"}]),x(!1)},N=async()=>{if(!u.trim())return;const L={role:"user",content:u},O=[...l,L];c(O),f(""),x(!0);try{const F=r?.settings?.geminiApiKey;if(!F)throw new Error("API Key missing.");const T=await yo.forgeHelperChat(F,O,a);o(I=>({...I,...T.updatedDraft})),c(I=>[...I,{role:"model",content:T.aiResponse}])}catch(F){console.error("Forge Error:",F),c(T=>[...T,{role:"model",content:"System Glitch. Please repeat."}])}finally{x(!1)}},C=()=>{const L={name:a.name||"Companion",type:a.type||"Construct",personality:a.personality||"Helpful"};t(L)},A=L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),N())};return s.jsxs("div",{className:"w-full max-w-5xl animate-fade-in mx-auto",children:[n==="selection"&&s.jsxs("div",{className:"text-center space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center ring-1 ring-amber-500/50 shadow-[0_0_30px_rgba(245,158,11,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Forge Your Helper"}),s.jsx("p",{className:"text-gray-300 max-w-2xl mx-auto",children:'Who will guide you through the multiverse? You can use our standard "Oracle" construct, or forge a completely custom AI companion with its own name and personality.'})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[e&&s.jsx("button",{onClick:e,className:"col-span-1 md:col-span-2 mx-auto text-gray-500 hover:text-white mb-2 underline",children:" Go Back"}),s.jsxs("button",{onClick:v,className:"p-6 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-gray-500 rounded-xl transition-all group text-left",children:[s.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Default: The Oracle"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"A wise, mystical construct focused on efficient and accurate advice."}),s.jsx("span",{className:"text-xs font-bold uppercase text-gray-500 group-hover:text-white tracking-wider",children:"Select Oracle "})]}),s.jsxs("button",{onClick:()=>{vn(r?.subscription_tier).features.customAiPersona&&j()},disabled:!vn(r?.subscription_tier).features.customAiPersona,className:`p-6 border rounded-xl transition-all group text-left relative overflow-hidden ${vn(r?.subscription_tier).features.customAiPersona?"bg-amber-900/20 hover:bg-amber-900/30 border-amber-500/30 hover:border-amber-500 cursor-pointer":"bg-gray-800/50 border-gray-700 opacity-50 cursor-not-allowed"}`,children:[s.jsx("div",{className:`absolute top-0 right-0 p-2 ${vn(r?.subscription_tier).features.customAiPersona?"opacity-50":"opacity-20"}`,children:s.jsx("svg",{className:`w-16 h-16 ${vn(r?.subscription_tier).features.customAiPersona?"text-amber-500":"text-gray-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:`text-xl font-bold mb-2 ${vn(r?.subscription_tier).features.customAiPersona?"text-white group-hover:text-amber-400":"text-gray-400"}`,children:"Forge Custom Helper"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create a unique companion. Define their name, species, and personality via chat."}),s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${vn(r?.subscription_tier).features.customAiPersona?"text-amber-500 group-hover:text-white":"text-gray-600"}`,children:vn(r?.subscription_tier).features.customAiPersona?"Start Forging ":"Requires Wizard Tier"})]})]})]})]}),n==="forge"&&s.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border border-gray-700 rounded-2xl overflow-hidden bg-gray-900",children:[s.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-800",children:[s.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-800/50 flex justify-between items-center",children:s.jsx("span",{className:"font-mono text-amber-400 text-sm",children:"SYSTEM: FORGE PROTOCOL ENGAGED"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l.map((L,O)=>s.jsx("div",{className:`flex ${L.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${L.role==="user"?"bg-amber-600 text-white":"bg-gray-800 text-gray-300"}`,children:L.content})},O)),p&&s.jsx("div",{className:"text-gray-500 text-xs animate-pulse ml-2",children:" Processing..."}),s.jsx("div",{ref:m})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:L=>f(L.target.value),onKeyDown:A,placeholder:"Ex: Name him 'Gobbo', make him a goblin...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-amber-500 focus:outline-none",disabled:p}),s.jsx("button",{onClick:N,disabled:p||!u.trim(),className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold",children:"Send"})]})})]}),s.jsxs("div",{className:"w-full md:w-80 bg-gray-950 p-6 flex flex-col",children:[s.jsx("h3",{className:"text-gray-400 font-bold uppercase tracking-wider text-xs mb-6",children:"Blueprint Status"}),s.jsxs("div",{className:"space-y-6 flex-1",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"DESIGNATION (NAME)"}),s.jsx("div",{className:`text-lg font-bold ${a.name?"text-amber-400":"text-gray-700 italic"}`,children:a.name||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"CLASSIFICATION (TYPE)"}),s.jsx("div",{className:`text-sm font-medium ${a.type?"text-white":"text-gray-700 italic"}`,children:a.type||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"PARAMETERS (PERSONALITY)"}),s.jsx("div",{className:`text-sm font-medium ${a.personality?"text-white":"text-gray-700 italic"}`,children:a.personality||"Undefined"})]})]}),s.jsx("button",{onClick:C,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-lg hover:shadow-green-500/20 transition-all mt-4",children:"Complete Forge Protocol"})]})]})]})},tIe=()=>{const t=dn(),[e,r]=mw(),{userProfile:n,updateSettings:i,refreshUserProfile:a}=Sr(),[o,l]=b.useState(n?.settings?.onboarding_step||0),[c,u]=b.useState(!1),[f,p]=b.useState(null),[x,m]=b.useState([null,null,null,null]),[y,v]=b.useState(1),[j,N]=b.useState(!1);b.useEffect(()=>{e.get("success")==="true"&&o<=1&&(async()=>{try{await Ze.post("/api/payments/sync-subscription"),await a()}catch(G){console.error("Sync failed",G)}await i({subscription_status:"active",onboarding_step:2}),l(2),r({})})()},[e,o,i,r]);const C=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],A=async()=>{const q=o+1;l(q),await i({onboarding_step:q})},L=async()=>{const q=Math.max(0,o-1);l(q),await i({onboarding_step:q})},O=async q=>{const X=o+1;l(X),await i({helper:q,onboarding_step:X})},F=async(q,X)=>{if(q===Jt.FREE||q==="free"){const G=o+1;l(G),await i({subscription_tier:"free",onboarding_step:G});return}try{const G=await Ze.post("/api/payments/create-checkout-session",{tierId:q,interval:X,successUrl:`${window.location.origin}/onboarding?success=true`,cancelUrl:`${window.location.origin}/onboarding?canceled=true`});G.url&&(window.location.href=G.url)}catch(G){console.error("Subscription error:",G),alert("Failed to start checkout. Please try again.")}},T=async q=>{const X=o+1;l(X),await i({ai_enabled:!!q,geminiApiKey:q||void 0,onboarding_step:X})},I=async(q,X,G)=>{N(!0);try{const ne={organization:{mode:q.id,sortHierarchy:X.filter(Boolean),groupingPreference:G}};await i(ne);const ee=o+1;l(ee),await i({onboarding_step:ee})}catch(ne){console.error(ne)}finally{N(!1)}},B=()=>{if(!f)return;let q=f.sort,X=f.grouping;if(f.id==="advanced"&&(q=x,q.filter(Boolean).length>0)){const G=q.filter(Boolean)[0];["color","color_identity"].includes(G)?X="color":["set","release"].includes(G)?X="set":["type"].includes(G)?X="type":["rarity"].includes(G)&&(X="rarity")}I(f,q,X)},$=()=>{u(!0)},k=async q=>{const X=o+1;l(X),await i({playstyle:q,onboarding_step:X}),await a(),u(!1)},R=async()=>{const q=o+1;l(q),await i({onboarding_step:q})},P=async()=>{await i({onboarding_complete:!0,onboarding_step:7}),t("/dashboard")};return s.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-30"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/90 to-black/80"})]}),s.jsxs("div",{className:"relative z-10 flex-grow flex items-center justify-center p-4",children:[o===0&&s.jsx(J9e,{onNext:A}),o===1&&s.jsx(X9e,{onNext:F,onBack:L,currentTier:n?.subscription_tier}),o===2&&s.jsx(Z9e,{onNext:T,onBack:L}),o===3&&s.jsxs("div",{className:"text-center max-w-6xl animate-fade-in-up w-full",children:[y===1&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400 mb-8",children:"How do you want to sort and view your cards?"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 max-w-5xl mx-auto items-stretch",children:C.map(q=>s.jsxs("button",{onClick:()=>{p(q),q.id==="advanced"?v(1.5):q.id==="hybrid"?v(2):I(q,q.sort,q.grouping)},disabled:j,className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl disabled:opacity-50 flex flex-col h-full",children:[s.jsx("div",{className:"text-3xl mb-3 group-hover:scale-110 transition-transform",children:q.icon}),s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:q.name}),s.jsx("p",{className:"text-xs text-gray-300 mb-3 h-8",children:q.description}),s.jsx("ul",{className:"text-[10px] text-gray-400 space-y-1.5 mt-auto pt-4 border-t border-gray-700/50",children:q.features.map((X,G)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),X]},G))})]},q.id))}),s.jsx("div",{className:"mt-8",children:s.jsx("button",{onClick:L,className:"text-gray-500 hover:text-white",children:"Back"})})]}),y===1.5&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Custom Hierarchy"}),s.jsx("div",{className:"space-y-3",children:[0,1,2,3].map(q=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:q+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:x[q]||"",onChange:X=>{const G=[...x];G[q]=X.target.value,m(G)},children:[s.jsx("option",{value:"",children:"(None)"}),s.jsx("option",{value:"color",children:"Color"}),s.jsx("option",{value:"type",children:"Type"}),s.jsx("option",{value:"cmc",children:"Mana Value"}),s.jsx("option",{value:"set",children:"Set"}),s.jsx("option",{value:"rarity",children:"Rarity"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"})]})]},q))}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>v(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:B,disabled:j,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:j?"Saving...":"Save Hierarchy"})]})]}),y===2&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Hybrid Organization"}),s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["Your collection will be grouped by ",s.jsx("strong",{children:"Set"}),"."]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>v(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:B,disabled:j,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:j?"Saving...":"Finish Setup"})]})]})]}),o===4&&s.jsx(eIe,{onNext:O,onBack:L}),o===5&&s.jsxs("div",{className:"text-center max-w-2xl animate-fade-in-up space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500/20 rounded-full flex items-center justify-center ring-1 ring-green-500/50 shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Define Your Playstyle"}),s.jsxs("p",{className:"text-gray-300",children:["Let us get to know what kind of mage you are.",s.jsx("br",{}),"We'll tailor card suggestions and deck strategies to your personal taste."]})]}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx("button",{onClick:L,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Back"}),s.jsx("button",{onClick:$,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"Start Quiz"}),s.jsx("button",{onClick:R,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Skip for Now"})]})]}),o===6&&s.jsx(Q9e,{onNext:P,onBack:L})]}),s.jsx("div",{className:"relative z-10 py-8 flex justify-center gap-3",children:[0,1,2,3,4,5,6].map(q=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${q===o?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},q))}),s.jsx(MF,{isOpen:c,onClose:()=>u(!1),onComplete:k})]})},rIe=()=>s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsxs("div",{className:"relative py-20 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-900/10"}),s.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-6 text-center",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white mb-6 tracking-tight",children:"About The Forge"}),s.jsx("p",{className:"text-xl text-gray-400 leading-relaxed",children:"Built by players, for players. The Forge is designed to be the ultimate companion for Magic: The Gathering deck building and collection management."})]})]}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 space-y-16",children:[s.jsxs("section",{className:"space-y-6 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-amber-500 rounded-full"}),"The Human Factor"]}),s.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-3xl border border-amber-500/10 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:s.jsx("svg",{className:"w-64 h-64 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"AI is a Tool, Not a Replacement"}),s.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[s.jsx("p",{children:"At The Forge, we believe AI can be an incredible creative partner. It can scan thousands of cards in seconds, find obscure combos, and suggest perfectly curved land bases."}),s.jsxs("p",{children:[s.jsx("strong",{className:"text-amber-400",children:"However, AI is still a work in progress."}),' It can hallucinate interactions, suggest banned cards, or miss the subtle "fun factor" that makes a Commander deck truly special.']}),s.jsx("p",{children:"We built these tools to get you 80% of the way there. The final 20%the soul of the deckcomes from you. Use our suggestions as a starting point, but trust your intuition and knowledge to build something truly unique."})]})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-indigo-500 rounded-full"}),"Powered By"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("a",{href:"https://scryfall.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-indigo-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Scryfall"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"The best MTG card database in the world. All card data and imagery is provided by their incredible API."})]}),s.jsxs("a",{href:"https://tcgplayer.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-green-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-green-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"TCGPlayer"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time pricing data for card values. Keeping your collection valuation accurate and up to date."})]}),s.jsxs("a",{href:"https://magic.wizards.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-orange-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Wizards of the Coast"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Creators of Magic: The Gathering. All mana symbols, card names, and art are copyright WotC."})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up delay-100",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-purple-500 rounded-full"}),"Get in Touch"]}),s.jsx("div",{className:"bg-gradient-to-br from-indigo-900/20 to-purple-900/20 p-8 rounded-3xl border border-white/5 relative overflow-hidden",children:s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[s.jsxs("div",{className:"space-y-4 text-center md:text-left",children:[s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Join the Community"}),s.jsx("p",{className:"text-gray-400 max-w-md",children:"Have a feature request? Found a bug? Or just want to show off your latest brew? Come chat with us on Discord."})]}),s.jsxs("a",{href:"https://discord.gg/your-discord-link",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/25 flex items-center gap-3 transform hover:-translate-y-1",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]})]})})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs pt-20",children:s.jsx("p",{children:"The Forge is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Wizards of the Coast LLC."})})]})]}),tx=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],nIe=()=>{const{slug:t}=Eo(),e=dn(),{currentUser:r}=Sr(),{addToast:n}=wn(),[i,a]=b.useState(null),[o,l]=b.useState(!0),[c,u]=b.useState(null),[f,p]=b.useState("grid"),[x,m]=b.useState(!1),[y,v]=b.useState(!1),[j,N]=b.useState(0);b.useEffect(()=>{(async()=>{try{const X=await Ze.get(`/api/decks/public/${t}`);a(X)}catch(X){console.error("Public deck load failed",X),u("Deck not found or private.")}finally{l(!1)}})()},[t]);const{deck:C,items:A}=i||{},L=b.useMemo(()=>{if(!C)return tx.find(ee=>ee.badge==="Colorless");if(C?.format?.toLowerCase()==="standard"){const ee=C.colors||C.commander?.color_identity||[];return tx.find(J=>J.colors.length!==ee.length?!1:J.colors.every(W=>ee.includes(W)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const q=C?.commander?.color_identity||[],X=C?.commander_partner?.color_identity||[],G=[...new Set([...q,...X])];return G.length===0?tx.find(ee=>ee.badge==="Colorless"):tx.find(ee=>ee.colors.length!==G.length?!1:ee.colors.every(se=>G.includes(se)))||tx.find(ee=>ee.badge==="Colorless")},[C]),O=b.useMemo(()=>{if(!A)return 0;let q=A.reduce((ne,ee)=>ne+(ee.countInDeck||ee.count||1),0);const X=C?.commander?.id||C?.commander?.scryfall_id,G=C?.commander_partner?.id||C?.commander_partner?.scryfall_id;return C?.commander&&!A.some(ne=>(ne.scryfall_id||ne.id)===X)&&q++,C?.commander_partner&&!A.some(ne=>(ne.scryfall_id||ne.id)===G)&&q++,q},[A,C]),F=b.useMemo(()=>{if(!A)return 0;let q=A.reduce((ne,ee)=>{const se=parseFloat(ee.prices?.[ee.finish==="foil"?"usd_foil":"usd"]||ee.data?.prices?.[ee.finish==="foil"?"usd_foil":"usd"]||0);return ne+se*(ee.countInDeck||ee.count||1)},0);const X=C?.commander?.id||C?.commander?.scryfall_id,G=C?.commander_partner?.id||C?.commander_partner?.scryfall_id;if(C?.commander&&!A.some(ne=>(ne.scryfall_id||ne.id)===X)){const ne=C.commander;q+=parseFloat(ne.prices?.usd||0)}if(C?.commander_partner&&!A.some(ne=>(ne.scryfall_id||ne.id)===G)){const ne=C.commander_partner;q+=parseFloat(ne.prices?.usd||0)}return q},[A,C]),T=q=>{if(!A)return 0;let X=A.reduce((ee,se)=>((se.data||se).type_line||"").includes(q)?ee+(se.countInDeck||1):ee,0);const G=C?.commander?.id||C?.commander?.scryfall_id,ne=C?.commander_partner?.id||C?.commander_partner?.scryfall_id;return C?.commander&&!A.some(ee=>(ee.scryfall_id||ee.id)===G)&&(C.commander.type_line||"").includes(q)&&X++,C?.commander_partner&&!A.some(ee=>(ee.scryfall_id||ee.id)===ne)&&(C.commander_partner.type_line||"").includes(q)&&X++,X},I=b.useMemo(()=>{const q=C?.ai_blueprint||C?.aiBlueprint||{},X=q.layout?.types||q.suggestedCounts||{};return[{label:"Total",current:O,target:C?.format?.toLowerCase()==="standard"||C?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:T("Creature"),target:X.Creatures||X.Creature||30},{label:"Lands",current:T("Land"),target:X.Lands||X.Land||36},{label:"Instants",current:T("Instant"),target:X.Instants||X.Instant||10},{label:"Sorceries",current:T("Sorcery"),target:X.Sorceries||X.Sorcery||10},{label:"Enchantments",current:T("Enchantment"),target:X.Enchantments||X.Enchantment||5},{label:"Artifacts",current:T("Artifact"),target:X.Artifacts||X.Artifact||10},{label:"Planeswalkers",current:T("Planeswalker"),target:X.Planeswalkers||X.Planeswalker||0}].filter(ne=>ne.target>0)},[C,O,A]),B=b.useMemo(()=>{if(!A)return{};const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return A.forEach(X=>{const ne=((X.data||X).type_line||"").toLowerCase(),ee=X.scryfall_id||X.id,se=C?.commander&&ee===(C.commander.id||C.commander.scryfall_id),J=C?.commander_partner&&ee===(C.commander_partner.id||C.commander_partner.scryfall_id);if(se||J){q.Commander.push(X);return}ne.includes("creature")?q.Creature.push(X):ne.includes("planeswalker")?q.Planeswalker.push(X):ne.includes("instant")?q.Instant.push(X):ne.includes("sorcery")?q.Sorcery.push(X):ne.includes("artifact")?q.Artifact.push(X):ne.includes("enchantment")?q.Enchantment.push(X):ne.includes("land")?q.Land.push(X):q.Other.push(X)}),Object.fromEntries(Object.entries(q).filter(([X,G])=>G.length>0))},[A,C]);if(o)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(c||!C)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center text-red-500 font-bold text-xl",children:c||"Deck inaccessible"});const $=j===0?C.commander:C.commander_partner||C.commander,k=$?.image_uris?.art_crop||$?.card_faces?.[0]?.image_uris?.art_crop||"",R={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},P=async()=>{if(r)try{n("Cloning deck...","info");const q=await za.createDeck(r.uid,{name:`Copy of ${C.name}`,commander:C.commander,commanderPartner:C.commander_partner,format:C.format,isMockup:!0}),X=A.map(G=>({scryfall_id:G.scryfall_id||G.id,name:G.name,set_code:G.set_code,collector_number:G.collector_number,finish:G.finish,image_uri:G.image_uri,data:G.data}));await Ze.post(`/api/decks/${q.id}/cards/batch`,{cards:X}),n("Deck cloned successfully!","success"),e(`/decks/${q.id}`)}catch(q){console.error(q),n("Failed to clone deck","error")}};return s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${k})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:C.format||"Commander"}),s.jsxs("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:["Shared by ",C.user_id?"a User":"Unknown"]})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:C.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(()=>{const q=C?.commander?.color_identity||[],X=C?.commander_partner?.color_identity||[];return[...new Set([...q,...X])].map(ne=>s.jsx("img",{src:R[ne],alt:ne,className:"w-6 h-6"},ne))})()}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:L.theme})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",F.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[O," Cards"]}),r?s.jsx("button",{onClick:P,className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Clone to Collection"}):s.jsx(br,{to:"/login",className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Login to Clone"})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-8",children:I.map((q,X)=>{const G=q.target>0?Math.min(q.current/q.target*100,100):0,ne=q.target>0&&q.current===q.target,ee=q.target>0&&q.current>q.target;return s.jsxs("div",{className:"bg-gray-950/20 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:q.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${ne?"text-green-400":ee?"text-orange-400":"text-indigo-300"}`,children:[q.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),q.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${ne?"bg-green-500":ee?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${G||0}%`}})})]},X)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>p("grid"),className:`p-1.5 rounded ${f==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>p("table"),className:`p-1.5 rounded ${f==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries(B).map(([q,X])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-gray-500",children:X.length})]}),f==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:X.map((G,ne)=>s.jsx(vm,{card:G,readOnly:!0},ne))}):s.jsx("div",{className:"space-y-1",children:X.map((G,ne)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:G.countInDeck||1}),s.jsx("span",{className:G.finish==="foil"?"text-yellow-200":"",children:G.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:G.mana_cost})]},ne))})]},q))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[C.commander&&s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:"Commander"}),s.jsx("img",{src:$?.image_uris?.normal||$?.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Commander"}),C.commander_partner&&s.jsx("button",{onClick:()=>N(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:"View Partner"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>v(!0),className:"text-[10px] font-black text-white uppercase tracking-[0.2em] bg-indigo-600 flex flex-col items-center gap-2 p-3 rounded-2xl hover:bg-indigo-500 transition-all shadow-xl shadow-indigo-900/40 group overflow-hidden",children:[s.jsx("svg",{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[8px]",children:"Deck Doctor"})]}),s.jsx("button",{onClick:()=>m(!0),className:"text-[10px] font-bold text-indigo-400 hover:text-white uppercase tracking-wider bg-indigo-500/10 px-2 py-1 rounded hover:bg-indigo-500/20 transition-colors",children:"Details "})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(hw,{cards:A,type:"mana"})]}),s.jsxs("div",{className:"h-[160px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(hw,{cards:A,type:"types"})]})]})]}),!r&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 backdrop-blur-md rounded-3xl border border-white/10 p-6 text-center",children:[s.jsx("h3",{className:"font-bold text-white mb-2",children:"Build Your Own Decks"}),s.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Join MTG Forge to manage your collection, build decks with AI, and track prices."}),s.jsx(br,{to:"/login",className:"block w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-900/20 transition-all text-sm",children:"Get Started Free"})]})]})]})]}),s.jsx(BH,{isOpen:x,onClose:()=>m(!1),cards:A,deckName:C.name}),s.jsx($H,{isOpen:y,onClose:()=>v(!1),deck:C,cards:A,isOwner:!1})]})},sIe=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(o,l)=>{const c=l.map(u=>typeof u=="object"?JSON.stringify(u):String(u)).join(" ");e(u=>[`[${o}] ${c}`,...u].slice(0,8))};return console.log=(...o)=>{r(...o),a("LOG",o)},console.warn=(...o)=>{n(...o),a("WARN",o)},console.error=(...o)=>{i(...o),a("ERR",o)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"fixed bottom-0 left-0 w-full h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border-t border-green-500/20",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5",children:r},n))})},iIe=()=>{const{sessionId:t}=Eo(),[e,r]=b.useState("connecting"),[n,i]=b.useState(null),[a,o]=b.useState([]),[l,c]=b.useState(!1),u=b.useRef(null),f=b.useRef(null),[p,x]=b.useState(null),[m,y]=b.useState(!1),[v,j]=b.useState(!1),[N,C]=b.useState(null);b.useEffect(()=>{const T=Qf();return i(T),T.on("connect",()=>{console.log("Connected to Forge Bridge"),T.emit("join-pairing",t),r("ready")}),T.on("disconnect",()=>{console.log("Disconnected"),r("error")}),()=>T.disconnect()},[t]),b.useEffect(()=>{let T=null;return(async()=>{try{console.log("[OCR] Initializing Tesseract (Remote)...");const B=await BF.createWorker("eng",1,{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),T=B,x(B),j(!0)}catch(B){console.error("OCR Worker Init Failed",B||"Unknown Error")}})(),()=>{T&&T.terminate()}},[]);const A=async()=>{if(!(!v||m||!u.current)){y(!0);try{const T=u.current.getScreenshot();if(!T)return;const I=new Image;I.src=T,await new Promise($=>I.onload=$);const B=await L(I);await F(B)}catch(T){console.error("Processing error",T),C({error:"Processing Error"})}finally{y(!1),setTimeout(()=>{C(T=>T?.error?null:T)},3e3)}}},L=async T=>{const I=f.current,B=I.getContext("2d",{willReadFrequently:!0}),$=async(Y,te,ce,xe)=>{let ue=250/xe;ue=Math.max(.1,Math.min(ue,4));let ve=Math.floor(ce*ue),Q=Math.floor(xe*ue);ve>4e3&&(ue=4e3/ce,ve=4e3,Q=Math.floor(xe*ue)),console.log(`[RemoteLens] OCR Crop: ${ve}x${Q} (Src: ${Math.floor(ce)}x${Math.floor(xe)})`),I.width=ve,I.height=Q,B.imageSmoothingEnabled=!0,B.imageSmoothingQuality="high",B.drawImage(T,Y,te,ce,xe,0,0,ve,Q);const pe=B.getImageData(0,0,I.width,I.height),Ce=pe.data;for(let Te=0;Te<Ce.length;Te+=4){const oe=(Ce[Te]+Ce[Te+1]+Ce[Te+2])/3;Ce[Te]=Ce[Te+1]=Ce[Te+2]=oe}B.putImageData(pe,0,0);const{data:{text:je}}=await p.recognize(I);return je.split(`
`).map(Te=>Te.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(Te=>Te.length>=1)},k=T.width,R=T.height,P=Math.min(k,R),q=(k-P)/2,X=(R-P)/2;console.log(`[RemoteLens] Precision Mode: ${k}x${R}, Crop: ${P}x${P} @ (${q}, ${X})`);const G=await $(q+P*.1,X+P*.35,P*.8,P*.3);let ne="",ee="";const se=G.join(" ").toUpperCase();console.log(`[RemoteLens] Raw Scan: "${se}"`);const W=(se.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(Y=>!/^(19|20)\d{2}$/.test(Y));W.length>0&&(ee=W[0]);const U=se.match(/\b[A-Z0-9]{3,4}\b/g);if(U){const Y=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],te=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],ce=U.find(xe=>!te.includes(xe)&&!Y.includes(xe)&&!/^\d+$/.test(xe));ce&&(ne=ce)}return{name:"",set:ne,cn:ee,raw_footer:se}},O=(T,I,B)=>{const $={id:Math.random().toString(36).substr(2,9),scryfall_id:T.scryfall_id||T.uuid,name:T.name,set_name:T.set_name||T.setcode,set_code:T.set||T.setcode,collector_number:T.collector_number||T.number,image:T.image_uri||T.image_uris?.small||T.card_faces?.[0]?.image_uris?.small,finish:l?"foil":"nonfoil",quantity:1,data:T,variants:I,raw_ocr:B};n.emit("card-scanned",{sessionId:t,card:$}),o(k=>[$,...k].slice(0,5)),C({success:!0,name:T.name})},F=async({name:T,set:I,cn:B,raw_footer:$})=>{if(console.log(`[RemoteLens] Resolving: Set="${I}", CN="${B}"`),I&&B){console.log(`[RemoteLens] Attempting Set/CN match: ${I} #${B}`);try{const k=await Ze.post("/api/cards/search",{set:I,cn:B});if(k.data&&k.data.length>0){const R=k.data[0];console.log(`[RemoteLens] Match found: ${R.name}`);const P=k.data.length>1?k.data:[R];O(R,P,{name:T,set:I,cn:B});return}else{C({error:`Not Found: ${I} #${B}`});return}}catch(k){console.warn("[RemoteLens] Set/CN search failed",k)}}C({error:"Scan Set Code & Number"})};return s.jsxs("div",{className:"fixed inset-0 bg-gray-950 flex flex-col items-center justify-between p-6 text-white overflow-hidden",children:[s.jsx(sIe,{}),s.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(GF,{className:"w-5 h-5 text-indigo-400"}),s.jsx("h1",{className:"font-black italic uppercase text-lg",children:"Forge Remote"})]}),s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${e==="ready"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[e==="ready"?s.jsx(Jae,{className:"w-3 h-3"}):s.jsx(Kae,{className:"w-3 h-3"}),e==="ready"?"Paired":"Connecting..."]})]}),s.jsxs("div",{className:"relative w-full aspect-[3/4] max-h-[60vh] rounded-3xl overflow-hidden border-2 border-white/10 shadow-2xl bg-black",children:[s.jsx(PF,{ref:u,audio:!1,screenshotFormat:"image/webp",videoConstraints:{facingMode:"environment"},className:"w-full h-full object-cover brightness-110 contrast-125"}),s.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:s.jsxs("div",{className:"w-[80%] aspect-[80/30] border-2 border-white/5 rounded-2xl relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute -bottom-20 left-1/2 -translate-x-1/2 w-[120%]",children:m?s.jsx("div",{className:"bg-indigo-600 text-white text-xs py-2 rounded-full font-black text-center animate-pulse",children:"ANALYZING..."}):N?.success?s.jsxs("div",{className:"bg-green-600 text-white text-xs py-2 rounded-full font-black text-center flex items-center justify-center gap-2",children:[s.jsx(vd,{className:"w-4 h-4"})," ",N.name," SENT!"]}):N?.error?s.jsx("div",{className:"bg-red-600 text-white text-xs py-2 rounded-full font-black text-center",children:N.error}):s.jsx("div",{className:"bg-black/60 backdrop-blur-md text-white/60 text-[10px] py-2 rounded-full text-center uppercase font-bold tracking-widest",children:"Align Set Code & Number"})})]})})]}),s.jsxs("div",{className:"w-full flex flex-col items-center gap-6 mb-20",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsxs("button",{onClick:()=>c(!l),className:`flex flex-col items-center gap-1 transition-all ${l?"text-yellow-400":"text-gray-500"}`,children:[s.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center border-2 transition-all ${l?"bg-yellow-500/20 border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.3)]":"bg-gray-800 border-white/5"}`,children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:l?"Foil":"Normal"})]}),s.jsx("button",{onClick:A,disabled:m||!v,className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center shadow-2xl active:scale-90 transition-all border-4 border-white/5",children:m?s.jsx(Nx,{className:"w-10 h-10 animate-spin"}):s.jsx(zF,{className:"w-10 h-10"})}),s.jsx("div",{className:"w-12 h-12"})]}),s.jsx("div",{className:"w-full h-20 flex gap-3 overflow-x-auto pb-2 scroll-smooth",children:a.map((T,I)=>s.jsxs("div",{className:"flex-shrink-0 w-12 h-16 rounded-lg overflow-hidden border border-white/10 relative group",children:[s.jsx("img",{src:T.image,className:"w-full h-full object-cover",alt:""}),s.jsx("div",{className:"absolute inset-0 bg-green-500/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(vd,{className:"w-4 h-4 text-white"})})]},I))})]}),s.jsx("canvas",{ref:f,className:"hidden"})]})},aIe=()=>s.jsxs("div",{className:"min-h-screen bg-gray-950 text-white relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-indigo-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-orange-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(30,27,75,0.2)_0%,transparent_70%)]"})]}),s.jsxs("div",{className:"relative z-20 max-w-7xl mx-auto px-4 w-full py-8",children:[s.jsxs(br,{to:"/",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors gap-2 group mb-12",children:[s.jsx(FF,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),s.jsx("span",{className:"font-bold uppercase tracking-widest text-xs",children:"Back to The Forge"})]}),s.jsxs("div",{className:"max-w-4xl",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-6 text-indigo-400",children:[s.jsx(I7,{className:"w-4 h-4"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Actionable Intelligence"})]}),s.jsxs("h1",{className:"text-5xl md:text-7xl font-black tracking-tight mb-8 leading-tight",children:["The AI Strategic",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-500 to-orange-500",children:"Companion Guide"})]}),s.jsx("p",{className:"text-xl md:text-2xl text-gray-400 leading-relaxed font-medium max-w-2xl",children:"Stop tracking data. Start forging strategy. Explore the neural engines that give you the edge in every brew and every match."})]})]}),s.jsxs("main",{className:"relative z-10 max-w-7xl mx-auto px-4 py-24 space-y-48",children:[s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/30 blur-[80px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-black/60 border border-white/10 rounded-[3rem] p-12 backdrop-blur-3xl shadow-2xl",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Neural Synthesis Engine"}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-sm font-bold text-gray-400 italic",children:'"Architect, build me a Bracket 4 competitive deck around [Selected Commander], prioritize my collection first..."'}),s.jsx("div",{className:"h-[1px] w-full bg-white/10"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{l:"Analyzing Archetype...",s:"100%"},{l:"Mapping Collection Staples...",s:"84%"},{l:"Optimizing Mana Curve...",s:"92%"},{l:"Finalizing Deck List...",s:"Processing"}].map((t,e)=>s.jsxs("div",{className:"flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-500",children:[s.jsx("span",{children:t.l}),s.jsx("span",{className:t.s==="100%"?"text-green-400":"text-indigo-400",children:t.s})]},e))})]}),s.jsxs("div",{className:"p-6 bg-indigo-500/10 rounded-2xl border border-indigo-500/20",children:[s.jsx("div",{className:"text-white font-black text-lg mb-2",children:"The Neural Architect"}),s.jsxs("div",{className:"text-gray-400 text-sm leading-relaxed",children:["Generating 100-card Commander list... ",s.jsx("br",{}),s.jsx("span",{className:"text-indigo-300",children:"62/100 Cards found in your collection."})," ",s.jsx("br",{}),s.jsx("span",{className:"text-orange-300",children:"38/100 Cards required for purchase."})]})]})]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center text-indigo-400 border border-indigo-500/20 shadow-[0_0_40px_rgba(79,70,229,0.3)]",children:s.jsx(pm,{className:"w-10 h-10"})}),s.jsxs("h2",{className:"text-5xl font-black leading-tight",children:["Zero-to-Brews:",s.jsx("br",{}),"The Neural Architect"]}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"While other sites give you a search bar, we give you a brain. The **Neural Architect** is the world's first AI engine that doesn't just suggest cardsit synthesizes entire, playable decks from your Commander selection."}),s.jsx("ul",{className:"space-y-6",children:[{t:"Commander-Centric Synthesis",d:"Select your Commander and target a specific power bracket for a precision brew."},{t:"Collection-Aware logic",d:"The AI builds around what you own, drastically reducing the cost of new brews."},{t:"Bracket-Targeting",d:"Specify exactly which pod power level you want to compete in."}].map((t,e)=>s.jsxs("li",{className:"flex gap-4",children:[s.jsx("div",{className:"mt-1 w-5 h-5 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400 text-[10px] font-black border border-indigo-500/30 shrink-0",children:e+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-bold",children:t.t}),s.jsx("div",{className:"text-gray-500 text-sm",children:t.d})]})]},e))})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"space-y-8 order-2 lg:order-1",children:[s.jsx("div",{className:"w-16 h-16 bg-orange-500/10 rounded-2xl flex items-center justify-center text-orange-400 border border-orange-500/20",children:s.jsx(M7,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"The AI Deck Doctor"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Traditional deck-building tools treat your list like a static file. The **Deck Doctor** treats it like a living strategy. It uses advanced neural analysis to evaluate not just individual cards, but the synergistic web they form."}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-bold flex items-center gap-3",children:[s.jsx(Iae,{className:"w-5 h-5 text-indigo-400"}),"The 1-5 Bracket System"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[{t:"Bracket 1",d:"Casual/Precon: Narrative focus."},{t:"Bracket 3",d:"High Power: Efficient execution."},{t:"Bracket 5",d:"Maximum Power: Competitive meta."},{t:"0.01 PL Step",d:"Precision tracking of deck shifts."}].map((t,e)=>s.jsxs("div",{className:"p-4 bg-white/5 rounded-xl border border-white/10",children:[s.jsx("div",{className:"font-black text-indigo-400 text-sm mb-1 uppercase tracking-wider",children:t.t}),s.jsx("div",{className:"text-sm text-gray-400",children:t.d})]},e))})]})]}),s.jsxs("div",{className:"relative order-1 lg:order-2 group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Power Level"}),s.jsx("div",{className:"text-5xl font-black text-white",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30 text-indigo-400 font-bold uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-orange-500 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-orange-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Recommended Adjustments"}),[{out:"Murder",in:"Assassin's Trophy",reason:"Broadened threat coverage"},{out:"Sol Ring",in:"Mana Crypt",reason:"Maximum acceleration"}].map((t,e)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-black/40 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-red-400 text-xs font-bold line-through",children:["OUT: ",t.out]}),s.jsxs("div",{className:"text-green-400 text-sm font-bold mt-1",children:["IN: ",t.in]})]}),s.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:t.reason})]},e))]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-500/10 rounded-2xl flex items-center justify-center text-indigo-400 border border-indigo-500/20",children:s.jsx(pm,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"Surgical Swaps"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Stop buying proxies you don't need or spending money on cards that clash with your goals. Our AI scans your **available collection** in real-time to suggest surgical changes."}),s.jsx("ul",{className:"space-y-4",children:["Find hidden staples already in your binders","Optimize curve without increasing budget","Identify over-committed resources"].map((t,e)=>s.jsxs("li",{className:"flex items-center gap-3 text-white font-medium",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),t]},e))})]})]}),s.jsxs("section",{className:"space-y-16",children:[s.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[s.jsx("h2",{className:"text-4xl font-black mb-6",children:"Tactical Advisor Personas"}),s.jsx("p",{className:"text-xl text-gray-400",children:"Different archetypes for different goals. Choose who critiques your brew."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{n:"Ruthless Optimizer",t:"Cedh Meta",icon:s.jsx(Die,{className:"w-6 h-6"}),color:"text-red-400",bg:"hover:border-red-500/30"},{n:"Flavor Specialist",t:"Vorthos/Lore",icon:s.jsx(u0,{className:"w-6 h-6"}),color:"text-blue-400",bg:"hover:border-blue-500/30"},{n:"Budget Engineer",t:"Cost Neutral",icon:s.jsx(I7,{className:"w-6 h-6"}),color:"text-green-400",bg:"hover:border-green-500/30"},{n:"Chaos Librarian",t:"Unique Tech",icon:s.jsx(M7,{className:"w-6 h-6"}),color:"text-purple-400",bg:"hover:border-purple-500/30"}].map((t,e)=>s.jsxs("div",{className:`p-8 bg-white/5 border border-white/10 rounded-3xl transition-all ${t.bg} group`,children:[s.jsx("div",{className:`w-12 h-12 mb-6 flex items-center justify-center bg-gray-900 rounded-xl ${t.color} border border-white/5 group-hover:scale-110 transition-transform`,children:t.icon}),s.jsx("h4",{className:"text-lg font-black mb-1",children:t.n}),s.jsx("div",{className:"text-xs font-bold uppercase tracking-widest text-gray-500",children:t.t})]},e))})]}),s.jsxs("section",{className:"relative overflow-hidden rounded-[3rem] bg-gradient-to-br from-indigo-600 to-purple-800 p-12 md:p-24 text-center",children:[s.jsx("div",{className:"absolute inset-0 bg-[url(/MTG-Forge_Logo_Background.png)] bg-cover bg-center mix-blend-overlay opacity-20"}),s.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto space-y-8",children:[s.jsx("h2",{className:"text-4xl md:text-6xl font-black text-white leading-tight",children:"Ready to Forge Your Legends?"}),s.jsx("p",{className:"text-xl text-indigo-100 font-medium",children:"Join the new generation of brewers using Actionable Intelligence to dominate their pods."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-8",children:[s.jsx(br,{to:"/dashboard",className:"px-10 py-5 bg-white text-indigo-900 font-black rounded-2xl shadow-xl hover:scale-105 transition-all",children:"Enter The Forge"}),s.jsx(br,{to:"/pricing",className:"px-10 py-5 bg-black/30 backdrop-blur-md text-white border border-white/20 font-black rounded-2xl hover:bg-black/40 transition-all",children:"View Pricing"})]})]})]})]}),s.jsx("footer",{className:"relative z-10 py-24 border-t border-white/5 bg-gray-950 mt-auto",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center space-y-4",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."}),s.jsxs("div",{className:"flex justify-center gap-8 text-xs font-bold uppercase tracking-widest text-gray-600",children:[s.jsx(br,{to:"/about",className:"hover:text-white transition-colors",children:"About"}),s.jsx(br,{to:"/pricing",className:"hover:text-white transition-colors",children:"Pricing"}),s.jsx(br,{to:"/settings",className:"hover:text-white transition-colors",children:"Settings"})]})]})})]}),oIe=Ke.memo(({item:t,onUpdate:e,onViewDetails:r,onSwapFoil:n})=>{const[i,a]=b.useState(!1),o=t.reviewed,l=o&&t.actual_quantity===t.expected_quantity,c=o&&t.actual_quantity!==t.expected_quantity,u=!o,f=t.finish==="foil",p=t.card_data?.card_faces,x=p&&p.length>1;let m=t.image_uri,y=t.art_uri,v=t.name;if(x){const O=p[i?1:0];O.image_uris?.art_crop&&(y=O.image_uris.art_crop),O.image_uris?.large?m=O.image_uris.large:O.image_uris?.normal&&(m=O.image_uris.normal),v=O.name}const j=c,N=L=>{L.stopPropagation(),c||e(t.id,0,!0)},C=L=>{L.stopPropagation(),l||e(t.id,t.expected_quantity,!0)},A=L=>{const O=parseInt(L.target.value);isNaN(O)||O<0||e(t.id,O,!0)};return s.jsxs("div",{onClick:()=>r(t),className:`group relative flex flex-col rounded-xl overflow-hidden border transition-all duration-300 hover:-translate-y-1 hover:shadow-xl cursor-pointer 
                ${l?"bg-gray-800/80 border-green-500/30 shadow-green-500/5":""}
                ${c?"bg-red-900/20 border-red-500/50 shadow-red-500/10":""}
                ${u?"bg-gray-800/40 border-gray-700/50 hover:border-gray-500/50":""}
            `,children:[s.jsxs("div",{className:"relative aspect-[4/3] bg-gray-900 w-full overflow-hidden",children:[y||m?s.jsx("img",{src:y||m,alt:v,loading:"lazy",className:"w-full h-full object-cover transition-transform group-hover:scale-110 duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-600",children:"No Image"}),s.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 transition-colors z-20 
                    ${l?"bg-green-500":""}
                    ${c?"bg-red-500":""}
                    ${u?"bg-gray-700":""}
                `}),s.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-wider shadow-lg backdrop-blur-md border z-10 
                    ${f?"bg-gradient-to-r from-yellow-600/90 to-yellow-400/90 text-white border-yellow-300/50":"bg-gray-900/80 text-gray-400 border-gray-600/50"}`,children:f?"Foil":"Normal"}),x&&s.jsxs("button",{onClick:L=>{L.stopPropagation(),a(!i)},className:"absolute bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 bg-black/60 hover:bg-black/80 text-white text-xs font-bold rounded-full backdrop-blur-sm border border-white/20 shadow-lg flex items-center gap-1 z-30 transition-all hover:scale-105",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Flip"]})]}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[s.jsx("h3",{className:"text-white font-black text-lg leading-tight mb-1 truncate",title:v,children:v}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono mb-4 flex items-center justify-between",children:[s.jsxs("span",{children:["#",t.collector_number,"  ",t.set_code.toUpperCase()]}),s.jsxs("span",{className:"text-gray-400 font-bold",children:["Goal: ",t.expected_quantity]})]}),s.jsxs("div",{className:"mt-auto flex items-center justify-between gap-3",onClick:L=>L.stopPropagation(),children:[s.jsx("button",{onClick:N,disabled:c,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${c?"bg-red-500 text-white shadow-lg shadow-red-500/20":"text-gray-500 hover:text-red-400 hover:bg-red-500/10"}`,title:"Mark Mismatch (Set to 0)",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"relative flex-1",children:s.jsx("input",{type:"number",min:"0",value:t.actual_quantity,disabled:!j,onChange:A,className:`w-full bg-gray-900 border rounded-lg px-3 py-1.5 font-mono text-center focus:outline-none focus:ring-2 transition-colors 
                                ${l?"border-green-500/50 text-green-400 opacity-90 cursor-not-allowed":""}
                                ${c?"border-red-500/50 text-white focus:ring-red-500":""}
                                ${u?"border-gray-700 text-gray-400 cursor-not-allowed":""}
                            `})}),s.jsx("button",{onClick:C,disabled:l,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${l?"bg-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-500 hover:text-green-400 hover:bg-green-500/10"}`,title:"Confirm Match",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]})]})});function lIe(){const{userProfile:t}=Sr(),{auditId:e}=Eo(),[r]=mw(),n=r.get("deckId"),i=r.get("group"),{openCardModal:a}=Ab(),{addToast:o}=wn(),[l,c]=b.useState(!1),[u,f]=b.useState(null),[p,x]=b.useState([]),[m,y]=b.useState(!0),[v,j]=b.useState(null),[N,C]=b.useState(50),A=b.useRef(null),[L,O]=b.useState("all"),F=dn();b.useEffect(()=>{const P=new IntersectionObserver(q=>{q[0].isIntersecting&&C(X=>X+50)},{rootMargin:"200px"});return A.current&&P.observe(A.current),()=>P.disconnect()},[p?.length]),b.useEffect(()=>{T(),n&&Ze.get(`/api/decks/${n}`).then(P=>j((P.deck||P).name)).catch(()=>{})},[e,n]);const T=async()=>{try{const P=await Ze.getActiveAudit();if(!P){alert("No active audit session found."),F("/dashboard");return}f(P);const q=await Ze.getAuditItems(P.id,{deckId:n,group:i}),X=t?.settings?.organization?.sortHierarchy||["name"];x(I(q,X))}catch(P){console.error(P)}finally{y(!1)}},I=(P,q)=>[...P].sort((X,G)=>{for(const ne of q){let ee=0;if(ne==="set"?ee=(X.set_code||"").localeCompare(G.set_code||""):ne==="collector_number"?ee=parseInt(X.collector_number||0)-parseInt(G.collector_number||0):ne==="name"&&(ee=(X.name||"").localeCompare(G.name||"")),ee!==0)return ee}return(X.name||"").localeCompare(G.name||"")}),B=async(P,q,X=null)=>{const G=parseInt(q);if(!(isNaN(G)||G<0)){x(ne=>ne.map(ee=>ee.id!==P?ee:{...ee,actual_quantity:G,reviewed:X!==null?X:ee.reviewed}));try{await Ze.updateAuditItem(u.id,P,G,X)}catch(ne){console.error(ne)}}},$=async()=>{try{y(!0),await Ze.reviewAuditSection(u.id,{deckId:n,group:i}),F(`/audit/${u.id}`)}catch(P){console.error(P),y(!1)}},k=b.useMemo(()=>L==="all"?p:L==="pending"?p.filter(P=>!P.reviewed):L==="mismatch"?p.filter(P=>P.reviewed&&P.actual_quantity!==P.expected_quantity):p,[p,L]),R=k.slice(0,N);return m?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-500 rounded-full"})}):u?s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-8 bg-gray-900/50 p-6 rounded-2xl border border-white/5 backdrop-blur-md sticky top-20 z-30 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("button",{onClick:()=>F(`/audit/${u.id}`),className:"text-gray-500 hover:text-white flex items-center gap-2 text-sm font-bold mb-2",children:"Back to Hub"}),s.jsxs("h1",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-indigo-400",children:"Audit:"})," ",v||i||u.type]})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg flex text-xs font-bold",children:[s.jsx("button",{onClick:()=>O("all"),className:`px-3 py-1.5 rounded-md transition-colors ${L==="all"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"All"}),s.jsx("button",{onClick:()=>O("pending"),className:`px-3 py-1.5 rounded-md transition-colors ${L==="pending"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Pending"}),s.jsx("button",{onClick:()=>O("mismatch"),className:`px-3 py-1.5 rounded-md transition-colors ${L==="mismatch"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:"Mismatches"})]}),s.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 hover:bg-indigo-600/30 font-bold rounded-lg text-sm flex items-center gap-2 transition-all",title:"Verify Cards with Camera",children:[s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Scan Verify"]}),s.jsx("button",{onClick:$,className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg shadow-lg shadow-blue-500/20 text-sm flex items-center gap-2",children:"Finish Section"})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:R.map(P=>s.jsx(oIe,{item:P,onUpdate:B,onViewDetails:q=>a({...q,data:q.card_data}),onSwapFoil:()=>{}},P.id))}),N<k.length&&s.jsx("div",{ref:A,className:"h-24 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-indigo-500 rounded-full"})}),s.jsx(jw,{isOpen:l,onClose:()=>c(!1),onFinish:async(P,q={})=>{if(!P.length)return;const{targetDeckId:X,additionMode:G}=q,ne=P.filter(U=>!U.is_wishlist),ee=P.filter(U=>U.is_wishlist);if(ee.length>0)try{const U=ee.map(Y=>({name:Y.name,scryfall_id:Y.scryfall_id,set_code:Y.set_code,collector_number:Y.collector_number,image_uri:Y.data.image_uris?.normal||Y.data.card_faces?.[0]?.image_uris?.normal,count:Y.quantity,data:Y.data,is_wishlist:!0,tags:[]}));await Ze.batchAddToCollection(U),o(`Saved ${ee.length} items to wishlist!`,"success")}catch(U){console.error("Wishlist save failed",U)}let se=0;const J=[],W=[...p];for(const U of ne){const Y=W.findIndex(te=>te.scryfall_id===U.scryfall_id&&(U.finish?te.finish===U.finish:!0));if(Y!==-1){const te=W[Y],ce=(te.actual_quantity||0)+U.quantity;W[Y]={...te,actual_quantity:ce,reviewed:!0};try{await Ze.updateAuditItem(u.id,te.id,ce,!0),se++}catch(xe){console.error("Failed to update audit item",xe)}}else J.push(U)}if(J.length>0)try{const U=J.map(ce=>({name:ce.name,scryfall_id:ce.scryfall_id,set_code:ce.set_code,collector_number:ce.collector_number,image_uri:ce.data.image_uris?.normal||ce.data.card_faces?.[0]?.image_uris?.normal,count:ce.quantity,data:ce.data,finish:ce.finish||"nonfoil",deck_id:X||(n&&n!=="null"?n:null),tags:[]})),Y=G==="transfer"?"transfer_to_deck":"merge";await Ze.batchAddToCollection(U,Y);const te=X?"deck":n?"this deck":"collection";o(`Added ${J.length} bonus cards to ${te}!`,"info")}catch(U){console.error("Bonus card addition failed",U)}x(W),se>0&&o(`Verified ${se} cards!`,"success")}})]}):null}function e$(){const{id:t}=Eo(),[e,r]=b.useState(null),[n,i]=b.useState(null),[a,o]=b.useState(!0),[l,c]=b.useState(null),u=dn(),[f,p]=b.useState({isOpen:!1,type:null,onConfirm:()=>{}}),[x,m]=b.useState(!1),[y,v]=b.useState("");b.useEffect(()=>{(async()=>{try{let $=t;if(!$){const k=await Ze.getActiveAudit();if(k)$=k.id;else return}if($){const k=await Ze.get(`/api/audit/${$}/stats`);i(k);const R=await Ze.getActiveAudit();r(R)}}catch($){console.error("Failed to load audit hub",$),c($.message)}finally{o(!1)}})()},[t]);const j=(B,$)=>{p({isOpen:!0,type:B,onConfirm:$}),v("")},N=async()=>{const B=f.type==="cancel"?"delete":"complete";y.toLowerCase().trim()===B&&(await f.onConfirm(),p({isOpen:!1,type:null,onConfirm:()=>{}}))},C=()=>{e&&j("cancel",async()=>{try{await Ze.cancelAudit(e.id),u("/dashboard")}catch(B){alert("Failed to cancel: "+B.message)}})},A=()=>{j("finalize",async()=>{try{await Ze.finalizeAudit(e.id),u("/dashboard")}catch(B){console.error("Finalize failed",B),alert("Finalize failed: "+B.message)}})};if(a)return s.jsx("div",{className:"p-8 text-center text-gray-400 animate-pulse",children:"Loading Audit..."});if(l)return s.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",l]});if(!e||!n)return s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"No Active Audit"}),s.jsx("button",{onClick:()=>u("/dashboard"),className:"px-4 py-2 bg-gray-700 rounded text-white",children:"Return to Dashboard"})]});const L=n.total_cards||1,O=n.total_reviewed||0,F=n.total_verified||0,T=Math.round(O/L*100),I=(B,$,k)=>{if($===0)return"from-gray-800 to-gray-900 border-gray-700";if(k>0&&k>=$)return"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400";const R=k/$;return R===1?B===$?"from-green-900/40 to-green-900/20 border-green-500/50 hover:border-green-400":"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400":R<.1?"from-gray-800/40 to-gray-800/20 border-gray-700/50 hover:border-gray-600":"from-yellow-900/40 to-yellow-900/20 border-yellow-500/50 hover:border-yellow-400"};return s.jsxs("div",{className:"min-h-screen bg-gray-900 p-8 pt-24 relative",children:[s.jsxs("div",{className:`max-w-7xl mx-auto space-y-8 animate-fade-in-up transition-all ${f.isOpen?"blur-sm pointer-events-none":""}`,children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase px-2 py-1 rounded border border-indigo-500/30",children:"Audit in Progress"}),s.jsxs("span",{className:"text-gray-500 text-sm",children:["Started ",new Date(e.created_at).toLocaleDateString()]})]}),s.jsx("h1",{className:"text-4xl font-black text-white",children:"Audit the Forge"}),s.jsxs("p",{className:"text-gray-400 mt-2 flex items-center gap-2",children:["Verify decks and binder to reconcile your inventory.",s.jsxs("button",{onClick:()=>m(!0),className:"text-indigo-400 hover:text-indigo-300 font-bold ml-2 text-sm flex items-center gap-1 group/guide",children:[s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover/guide:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Setup Guide"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:C,className:"px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors font-medium text-sm",children:"Cancel Audit"}),s.jsx("button",{onClick:A,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold rounded-lg shadow-lg shadow-green-500/20 text-sm transition-all hover:scale-105",children:"Finalize Results"})]})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700 relative overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 relative z-10",children:[s.jsx("span",{className:"text-xl font-bold text-white",children:"Total Progress"}),s.jsxs("span",{className:"text-2xl font-mono text-indigo-400",children:[T,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-4 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-500 h-full transition-all duration-1000 ease-out",style:{width:`${T}%`}})}),s.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-400 relative z-10",children:[s.jsxs("span",{children:[O," / ",L," Cards Reviewed (",F," Matched)"]}),s.jsxs("span",{children:[n.decks.length," Decks  ",Object.keys(n.collection.groups).length," Loose Groups"]})]})]}),n.decks.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decks"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.decks.map(B=>s.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?deckId=${B.id}`),className:`relative group p-6 rounded-xl border transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${I(B.verified,B.total,B.reviewed)} overflow-hidden`,children:[s.jsx("h4",{className:"font-bold text-white text-lg truncate mb-1 relative z-10 text-left",children:B.name}),s.jsxs("div",{className:"text-sm text-gray-300 mb-4 flex justify-between relative z-10",children:[s.jsx("span",{children:B.colors?B.colors.join(""):"Colorless"}),s.jsx("span",{children:B.reviewed>=B.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," Complete"]}):s.jsxs("span",{children:[B.reviewed,"/",B.total," Done"]})})]}),s.jsx("div",{className:"w-full bg-black/30 rounded-full h-1.5 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-white/80 h-full transition-all",style:{width:`${B.reviewed/B.total*100}%`}})})]},B.id))})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Collection (Loose Cards)"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.collection.groups.map(B=>s.jsxs("button",{onClick:()=>u(`/audit/${e.id}/wizard?group=${B.name}`),className:`relative p-4 rounded-xl border text-left transition-all hover:brightness-110 bg-gradient-to-br ${I(B.verified,B.total,B.reviewed)} overflow-hidden group isolate`,children:[s.jsx("div",{className:"text-3xl font-black text-white/5 absolute -bottom-1 -right-1 select-none pointer-events-none transition-colors z-0 whitespace-nowrap transform rotate-0 origin-bottom-right",children:B.name}),s.jsx("h4",{className:"font-bold text-white text-md mb-2 relative z-10",children:B.name}),s.jsx("div",{className:"text-xs text-gray-300 relative z-10",children:B.reviewed>=B.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})," Complete"]}):s.jsxs("span",{children:[B.reviewed,"/",B.total," Done"]})})]},B.name)),n.collection.total>0&&n.collection.groups.length===0&&s.jsx("div",{className:"col-span-full text-gray-500 italic p-4",children:"No groups found for loose cards. (All cards might be in decks)"}),n.collection.total===0&&s.jsx("div",{className:"col-span-full border border-dashed border-gray-700 rounded-xl p-8 text-center text-gray-500",children:"No loose cards in this audit scope."})]})]}),n.mismatches&&n.mismatches.length>0&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl border border-red-500/20 overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-700/50 flex items-center gap-3",children:s.jsx("h3",{className:"text-xl font-bold text-white",children:"Discrepancy Report"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-900/50 text-gray-400 text-xs uppercase tracking-wider",children:[s.jsx("th",{className:"p-4",children:"Card"}),s.jsx("th",{className:"p-4",children:"Set"}),s.jsx("th",{className:"p-4",children:"Location"}),s.jsx("th",{className:"p-4 text-center",children:"Expected"}),s.jsx("th",{className:"p-4 text-center",children:"Actual"}),s.jsx("th",{className:"p-4 text-right",children:"Diff"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-700/50",children:n.mismatches.map(B=>{const $=B.actual-B.expected;return s.jsxs("tr",{className:"text-white hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"p-4 font-bold max-w-xs truncate",children:[B.name," ",B.finish==="foil"&&s.jsx("span",{className:"text-xs text-yellow-500 ml-1",children:"FOIL"})]}),s.jsxs("td",{className:"p-4 font-mono text-gray-400",children:[B.set_code.toUpperCase()," #",B.collector_number]}),s.jsx("td",{className:"p-4 text-gray-300",children:B.deck_name?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500"})," ",B.deck_name]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-500"})," Collection"]})}),s.jsx("td",{className:"p-4 text-center font-mono text-gray-400",children:B.expected}),s.jsx("td",{className:"p-4 text-center font-mono font-bold",children:B.actual}),s.jsx("td",{className:`p-4 text-right font-mono font-bold ${$>0?"text-green-400":"text-red-400"}`,children:$>0?`+${$}`:$})]},B.id)})})]})})]})]}),f.isOpen&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>p({...f,isOpen:!1})}),s.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-6 max-w-md w-full relative z-10 shadow-2xl animate-fade-in-up",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:f.type==="cancel"?"Delete Audit Session?":"Complete Audit?"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:f.type==="cancel"?"This will definitively DELETE this session and all progress. This cannot be undone.":"This will sync all verified counts to your collection. Cards in 'Reviewed' sections with mismatching counts will NOT be synced, only exact matches are auto-synced. Proceed?"}),s.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:["Type ",s.jsx("span",{className:"text-white select-none",children:f.type==="cancel"?"Delete":"Complete"})," to confirm"]}),s.jsx("input",{type:"text",value:y,onChange:B=>v(B.target.value),placeholder:f.type==="cancel"?"Delete":"Complete",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-600 focus:border-indigo-500 outline-none mb-6",autoFocus:!0}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>p({...f,isOpen:!1}),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{onClick:N,disabled:y.toLowerCase().trim()!==(f.type==="cancel"?"delete":"complete"),className:`px-4 py-2 rounded-lg font-bold text-white transition-all ${y.toLowerCase().trim()===(f.type==="cancel"?"delete":"complete")?f.type==="cancel"?"bg-red-500 hover:bg-red-600":"bg-green-600 hover:bg-green-500":"bg-gray-700 opacity-50 cursor-not-allowed"}`,children:f.type==="cancel"?"Delete Audit":"Complete Audit"})]})]})]}),s.jsx(q6,{isOpen:x,onClose:()=>m(!1)})]})}const cIe=()=>{const t=dn(),{currentUser:e,userProfile:r}=Sr(),[n,i]=b.useState(""),[a,o]=b.useState(!1),[l,c]=b.useState(null),[u,f]=b.useState(null);b.useEffect(()=>{const m=Qf();return f(m),m.on("connect_error",y=>{console.error("Socket Connection Error:",y),c("Connection to Game Server failed.")}),()=>{m&&m.disconnect()}},[]);const p=()=>{if(!u||!u.connected){c("Connecting to server... please wait."),u&&u.connect();return}const m=Math.floor(1e5+Math.random()*9e5).toString();u.emit("host-game",{pin:m},y=>{y.success?t(`/play/room/${y.roomId}`,{state:{pin:m,isHost:!0}}):c("Failed to create game: "+(y.error||"Unknown"))})},x=m=>{if(m.preventDefault(),n.length!==6){c("PIN must be 6 digits");return}t("/play/room/game-found-via-pin",{state:{pin:n,isHost:!1}})};return s.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/20 via-gray-900 to-black z-0"}),s.jsxs("div",{className:"relative z-10 w-full max-w-md space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-wider",children:"The War Room"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"MTG Live Session"})]}),l&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/50 text-red-200 p-3 rounded-lg text-center text-sm font-bold",children:l}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 p-6 rounded-2xl space-y-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Join a Battle"}),s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Session PIN"}),s.jsx("input",{type:"text",maxLength:"6",placeholder:"000000",className:"w-full bg-black/50 border border-white/10 rounded-xl px-4 py-4 text-center text-3xl font-mono text-white tracking-[0.5em] focus:outline-none focus:border-indigo-500 transition-colors",value:n,onChange:m=>i(m.target.value.replace(/\D/g,""))})]}),s.jsx("button",{type:"submit",disabled:n.length!==6,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-500/20 transition-all transform active:scale-95 uppercase tracking-wider",children:"Enter Battlefield"})]})]}),s.jsxs("div",{className:"relative flex py-2 items-center",children:[s.jsx("div",{className:"flex-grow border-t border-white/10"}),s.jsx("span",{className:"flex-shrink-0 mx-4 text-gray-500 text-xs font-bold uppercase tracking-widest",children:"OR"}),s.jsx("div",{className:"flex-grow border-t border-white/10"})]}),s.jsxs("button",{onClick:p,className:"w-full bg-white/5 hover:bg-white/10 border border-white/10 text-white font-bold py-4 rounded-xl transition-all flex flex-col items-center justify-center gap-1 group",children:[s.jsx("span",{className:"uppercase tracking-wider",children:"Host New Session"}),s.jsx("span",{className:"text-[10px] text-gray-400 font-normal group-hover:text-indigo-300",children:"Generate a PIN for friends to join"})]})]}),s.jsx("div",{className:"text-center pt-8",children:s.jsx("button",{onClick:()=>t("/"),className:"text-gray-500 hover:text-white text-sm font-bold uppercase tracking-widest transition-colors",children:" Back to Base"})})]})]})},dIe=({isOpen:t,onClose:e,onApply:r,currentValue:n})=>{const[i,a]=b.useState(""),[o,l]=b.useState("subtract"),[c,u]=b.useState(null);if(!t)return null;const f=m=>{i.length>3||(a(y=>y+m),u(null))},p=()=>{a(m=>m.slice(0,-1)),u(null)},x=()=>{const m=parseInt(i,10);if(!m||isNaN(m)){e();return}if(!c&&m>=10){u(`Large change detected (${m}). Confirm?`);return}const y=o==="subtract"?-m:m;r(y),a(""),u(null),e()};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center pointer-events-none",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm pointer-events-auto transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border-t md:border border-gray-700 w-full md:w-[400px] md:rounded-2xl shadow-2xl overflow-hidden pointer-events-auto animate-slide-up md:animate-zoom-in p-6 z-10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider",children:"Quick Math"}),s.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-full",children:s.jsx(Sd,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"bg-black/40 rounded-xl p-4 mb-6 border border-white/5 flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"Current Life"}),s.jsx("span",{className:"text-2xl font-mono text-gray-300",children:n})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:`text-4xl font-mono font-black ${o==="subtract"?"text-red-500":"text-green-500"}`,children:[o==="subtract"?"-":"+",i||"0"]}),s.jsxs("span",{className:"text-xs text-gray-500 font-bold uppercase self-end mb-1",children:["= ",n+parseInt(i||0)*(o==="subtract"?-1:1)]})]})]}),c&&s.jsxs("div",{className:"bg-yellow-500/10 text-yellow-500 p-3 rounded-lg border border-yellow-500/20 mb-4 flex items-center justify-center gap-2 animate-pulse",children:[s.jsx(Uae,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-bold",children:c})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[s.jsx("button",{onClick:()=>l("subtract"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="subtract"?"bg-red-500 text-white shadow-lg shadow-red-900/50":"bg-gray-800 text-gray-500"}`,children:"Damage"}),s.jsx("button",{onClick:()=>l("add"),className:`py-3 rounded-lg font-bold uppercase tracking-widest transition-all ${o==="add"?"bg-green-500 text-white shadow-lg shadow-green-900/50":"bg-gray-800 text-gray-500"}`,children:"Life"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[[1,2,3,4,5,6,7,8,9].map(m=>s.jsx("button",{onClick:()=>f(m),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:m},m)),s.jsx("button",{onClick:()=>f(0),className:"bg-gray-800 hover:bg-gray-700 text-white text-2xl font-bold py-4 rounded-xl transition-colors active:scale-95",children:"0"}),s.jsx("button",{onClick:p,className:"bg-gray-800 hover:bg-red-900/30 text-gray-400 hover:text-red-400 text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center",children:s.jsx(Jie,{className:"w-6 h-6"})}),s.jsx("button",{onClick:x,className:`bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 rounded-xl transition-colors active:scale-95 flex items-center justify-center ${c?"animate-bounce":""}`,children:s.jsx(vd,{className:"w-8 h-8"})})]})]})]})},uIe=({life:t,onChange:e,isSelf:r=!1,label:n})=>{const[i,a]=b.useState(!1);return s.jsxs("div",{className:`flex flex-col items-center justify-center ${r?"h-full":"h-32"} w-full relative group`,children:[s.jsx("div",{className:"absolute inset-x-0 top-0 text-center py-2 z-10 pointer-events-none",children:s.jsx("span",{className:`${r?"text-sm text-gray-400":"text-xs text-gray-500"} font-black uppercase tracking-widest truncate max-w-[90%] inline-block shadow-black drop-shadow-md`,children:n})}),s.jsxs("div",{className:"flex w-full h-full",children:[s.jsx("button",{onClick:()=>e(-1),className:`flex-1 flex items-center justify-center ${r?"bg-red-900/20 hover:bg-red-900/40":"bg-red-900/10 hover:bg-red-900/20"} active:bg-red-500/30 transition-colors touch-manipulation`,children:s.jsx("span",{className:"sr-only",children:"Minus 1 Life"})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("button",{onClick:()=>r&&a(!0),className:`pointer-events-auto ${r?"text-8xl md:text-9xl hover:scale-105 active:scale-95 cursor-pointer":"text-5xl"} font-black text-white tabular-nums drop-shadow-xl tracking-tighter transition-transform`,children:t})}),s.jsx("button",{onClick:()=>e(1),className:`flex-1 flex items-center justify-center ${r?"bg-green-900/20 hover:bg-green-900/40":"bg-green-900/10 hover:bg-green-900/20"} active:bg-green-500/30 transition-colors touch-manipulation`,children:s.jsx("span",{className:"sr-only",children:"Plus 1 Life"})})]}),s.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[1px] h-1/2 bg-white/5 pointer-events-none"}),r&&s.jsx(dIe,{isOpen:i,onClose:()=>a(!1),currentValue:t,onApply:o=>e(o)})]})},rx=({label:t,value:e,onChange:r,icon:n,color:i="text-white"})=>s.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[n&&s.jsx(n,{className:`w-5 h-5 ${i}`}),s.jsx("span",{className:"text-sm font-bold text-gray-300 uppercase tracking-wider",children:t})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r(e-1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",disabled:e<=0,children:"-"}),s.jsx("span",{className:"text-2xl font-black text-white w-8 text-center tabular-nums",children:e}),s.jsx("button",{onClick:()=>r(e+1),className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center text-xl font-bold text-gray-400 hover:text-white transition-colors",children:"+"})]})]}),hIe=({isOpen:t,onClose:e,players:r,myPlayerId:n,myCounters:i,myCommanderDamage:a,onUpdateCounter:o,onUpdateCmdDamage:l})=>{const[c,u]=b.useState("commander");if(!t)return null;const f=r.filter(p=>p.id!==n);return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm pointer-events-auto",onClick:e}),s.jsxs("div",{className:"bg-gray-900 w-full sm:max-w-md h-[80vh] sm:h-auto sm:rounded-3xl rounded-t-3xl border-t sm:border border-white/10 shadow-2xl flex flex-col pointer-events-auto relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[s.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-wider",children:"Resources"}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx(Sd,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"flex border-b border-white/5",children:[s.jsx("button",{onClick:()=>u("counters"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="counters"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Counters"}),s.jsx("button",{onClick:()=>u("commander"),className:`flex-1 py-4 text-xs font-bold uppercase tracking-widest transition-colors ${c==="commander"?"text-indigo-400 bg-white/5 border-b-2 border-indigo-400":"text-gray-500 hover:text-gray-300"}`,children:"Commander Dmg"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[c==="counters"&&s.jsxs(s.Fragment,{children:[s.jsx(rx,{label:"Poison",value:i.poison||0,onChange:p=>o("poison",p),icon:X1,color:"text-green-500"}),s.jsx(rx,{label:"Energy",value:i.energy||0,onChange:p=>o("energy",p),icon:pm,color:"text-yellow-400"}),s.jsx(rx,{label:"Experience",value:i.experience||0,onChange:p=>o("experience",p),icon:I6,color:"text-blue-400"}),s.jsx(rx,{label:"Tax",value:i.commanderTax||0,onChange:p=>o("commanderTax",p),icon:HF,color:"text-gray-400"})]}),c==="commander"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-xs text-gray-500 text-center uppercase tracking-widest mb-4",children:"Damage taken from Commanders"}),f.length===0&&s.jsx("p",{className:"text-gray-500 text-center py-4",children:"No opponents found."}),f.map(p=>s.jsx(rx,{label:p.name,value:a[p.id]||0,onChange:x=>l(p.id,x),icon:d0,color:"text-red-400"},p.id))]})]})]})]})},fIe=({isOpen:t,onClose:e,finalState:r,onSave:n,roomId:i})=>{const{userProfile:a}=Sr(),[o,l]=b.useState(null),[c,u]=b.useState(null),[f,p]=b.useState([]),[x,m]=b.useState(!1),[y,v]=b.useState("summary");if(b.useEffect(()=>{t&&a&&Ze.get("/api/decks",{limit:100}).then(T=>p(Array.isArray(T)?T:T.decks||[])).catch(console.error)},[t,a]),!t||!r)return null;const{players:j,durationSeconds:N,startedAt:C,endedAt:A,logs:L}=r,O=T=>{const I=Math.floor(T/60),B=T%60;return`${I}m ${B}s`},F=async()=>{m(!0);try{const I=j.find($=>$.id===o)?.userId||null,B={roomId:i,winnerId:I,startedAt:C,endedAt:A,logs:L||[],players:j.map($=>({userId:$.userId||null,guestName:$.name,placement:$.id===o?1:2,life:$.life,deckId:$.deckId,socketId:$.id}))};await n(B)}catch(T){console.error("Failed to save match:",T)}finally{m(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-xl w-full max-w-lg shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"bg-gradient-to-r from-indigo-900/50 to-purple-900/50 p-6 text-center border-b border-white/5",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-widest flex items-center justify-center gap-3",children:[s.jsx(Ga,{className:"w-8 h-8 text-yellow-500"}),"Game Over"]}),s.jsxs("p",{className:"text-gray-400 text-sm mt-2 font-mono",children:["Duration: ",O(N)]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex p-1 bg-gray-800 rounded-lg",children:[s.jsx("button",{onClick:()=>v("summary"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${y==="summary"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Summary"}),s.jsx("button",{onClick:()=>v("report"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${y==="report"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Combat Report"})]}),y==="summary"?s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Select Winner"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(T=>s.jsxs("button",{onClick:()=>l(T.id),className:`p-3 rounded-lg border text-sm font-bold transition-all flex items-center justify-between ${o===T.id?"bg-yellow-500/10 border-yellow-500 text-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("span",{className:"truncate",children:T.name}),o===T.id&&s.jsx(Ga,{className:"w-4 h-4"})]},T.id))})]}):s.jsx("div",{className:"h-64 w-full bg-gray-950/50 rounded-xl border border-white/5 p-4 flex flex-col justify-end relative overflow-hidden",children:!L||L.length===0?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"No battle data recorded."}):s.jsx(MW,{players:j,logs:L})})]}),s.jsxs("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-lg font-bold text-sm transition-colors",children:"Close"}),s.jsx("button",{onClick:F,disabled:!o||x,className:"flex-[2] py-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-bold text-sm transition-colors flex items-center justify-center gap-2 shadow-lg shadow-indigo-900/20",children:x?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(wae,{className:"w-4 h-4"}),"Save Match History"]})})]})]})})};let bn;const pIe=()=>{const t=Ao(),e=dn(),{userProfile:r}=Sr(),{addToast:n}=wn(),[i,a]=b.useState(null),[o,l]=b.useState(null),[c,u]=b.useState(null),[f,p]=b.useState(null),[x,m]=b.useState(!0),[y,v]=b.useState(!1),[j,N]=b.useState(!1),C=t.state?.pin,A=t.state?.isHost,[L,O]=b.useState(null),[F,T]=b.useState([]),[I,B]=b.useState(!1),[$,k]=b.useState(null),R=b.useRef(null),[P,q]=b.useState(null),X=b.useRef(null),G=Q=>{const pe=Q.counters||{},je=(Q.commanderDamage||{})[c]||0;return!je&&!pe.poison&&!pe.energy&&!pe.experience&&!pe.commanderTax?null:s.jsxs("div",{className:"flex items-center justify-center gap-2 absolute bottom-2 w-full px-2 pointer-events-none",children:[je>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-red-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(d0,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:je})]}),pe.poison>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-green-500 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(X1,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:pe.poison})]}),pe.energy>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-yellow-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(pm,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:pe.energy})]}),pe.experience>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-blue-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(I6,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:pe.experience})]}),pe.commanderTax>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-gray-400 bg-black/40 px-1.5 py-0.5 rounded-full backdrop-blur-sm shadow-sm border border-white/5",children:[s.jsx(HF,{className:"w-3 h-3"}),s.jsx("span",{className:"text-[10px] font-bold",children:pe.commanderTax})]})]})};b.useEffect(()=>{r&&Ze.get("/api/decks",{limit:100}).then(Q=>T(Array.isArray(Q)?Q:Q.decks||[])).catch(Q=>{console.error("Failed to load decks:",Q),T([])})},[r]),b.useEffect(()=>{if(!I)return;bn?bn.disconnected&&bn.connect():bn=Qf({transports:["websocket","polling"],reconnectionAttempts:5});const Q=()=>{if(!C){p("No PIN provided. Please join from the lobby."),setTimeout(()=>e("/play/lobby"),3e3);return}const oe=r?.username||(A?"Host":"Guest");console.log("Emitting join-game..."),bn.emit("join-game",{pin:C,name:oe,userId:r?.id,deckId:L==="generic"?null:L},De=>{console.log("Join response:",De),De.success?(R.current=De.roomId,u(De.playerId)):(k(De.error||"Failed to join game"),B(!1))})},pe=()=>{console.log("Connected to Game Socket:",bn.id),Q()},Ce=oe=>{console.log("Game State Update:",oe),a(oe),m(!1)},je=({finalState:oe})=>{console.log("Game Over!",oe),l(oe),N(!0)},we=oe=>{console.error("Socket Connection Error:",oe),k("Connection error. Retrying...")},Te=({entry:oe})=>{oe.type==="note"&&n(`${oe.emoji} ${oe.note}`,"info",4e3)};return bn.on("connect",pe),bn.on("game-state-update",Ce),bn.on("game-over",je),bn.on("connect_error",we),bn.on("game-log-entry",Te),bn.connected&&pe(),()=>{bn.off("connect",pe),bn.off("game-state-update",Ce),bn.off("game-over",je),bn.off("connect_error",we),bn.off("game-log-entry",Te),bn&&bn.disconnect(),bn=null}},[C,A,r,e,I,L,n]);const ne=Q=>{X.current&&clearTimeout(X.current),q(Q),X.current=setTimeout(()=>{q(null)},5e3)},ee=()=>{if(P){if(P.type==="LIFE"){const Q=-P.change;a(pe=>{const Ce=pe.players.map(je=>je.id===c?{...je,life:je.life+Q}:je);return{...pe,players:Ce}}),bn.emit("update-life",{roomId:R.current,change:Q})}else if(P.type==="COUNTER"){const Q=-P.change;bn.emit("update-counters",{roomId:R.current,type:P.counterType,change:Q})}else if(P.type==="CMDR_DMG"){const Q=-P.change;bn.emit("update-commander-damage",{roomId:R.current,targetId:P.targetId,change:Q})}q(null),X.current&&clearTimeout(X.current)}},se=Q=>{!bn||!i||!c||!R.current||(ne({type:"LIFE",change:Q}),a(pe=>{const Ce=pe.players.map(je=>je.id===c?{...je,life:je.life+Q}:je);return{...pe,players:Ce}}),bn.emit("update-life",{roomId:R.current,change:Q}))},J=(Q,pe)=>{const Ce=i.players.find(we=>we.id===c),je=pe-(Ce.counters[Q]||0);ne({type:"COUNTER",counterType:Q,change:je}),bn.emit("update-counters",{roomId:R.current,type:Q,change:je})},W=(Q,pe)=>{const je=i.players.find(Te=>Te.id===c).commanderDamage[Q]||0,we=pe-je;ne({type:"CMDR_DMG",targetId:Q,change:we}),bn.emit("update-commander-damage",{roomId:R.current,targetId:Q,change:we})},U=()=>{!bn||!R.current||window.confirm("Are you sure you want to end the game for everyone?")&&bn.emit("end-game",{roomId:R.current})},Y=async Q=>{try{const pe=await Ze.post("/api/matches",Q);pe.success?(alert("Game saved successfully!"),N(!1),e("/play/lobby")):alert("Failed to save game: "+(pe.error||"Unknown error"))}catch(pe){console.error(pe),alert("Error saving game")}},te=Q=>{!bn||!R.current||bn.emit("start-game",{roomId:R.current,firstPlayerId:Q})},ce=()=>{!bn||!R.current||bn.emit("pass-turn",{roomId:R.current})},xe=()=>{if(!bn||!R.current)return;const Q=window.prompt("Add a note to the game log (e.g. 'Board Wipe', 'Infinite Combo'):");Q&&Q.trim()&&bn.emit("add-log-note",{roomId:R.current,note:Q.trim()})};if(f)return s.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 font-bold p-4 text-center",children:[f,s.jsx("button",{onClick:()=>e("/play/lobby"),className:"block mt-4 text-sm text-gray-500 hover:text-white underline mx-auto",children:"Return to Lobby"})]});if($)return s.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-950 text-red-400 p-4 text-center",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"font-bold",children:$}),s.jsx("button",{onClick:()=>k(null),className:"text-sm bg-red-500/10 hover:bg-red-500/20 px-4 py-2 rounded text-red-400",children:"Try Again"}),s.jsx("button",{onClick:()=>e("/play/lobby"),className:"block w-full text-sm text-gray-500 hover:text-white underline",children:"Return to Lobby"})]})});if(!I)return s.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 p-4 animate-fade-in",children:s.jsxs("div",{className:"w-full max-w-md space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-widest",children:"Select Your Deck"}),s.jsx("p",{className:"text-gray-400",children:"Choose a deck to play with for this session."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("select",{value:L||"",onChange:Q=>O(Q.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl p-4 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-lg",children:[s.jsx("option",{value:"",children:"-- Select a Deck --"}),s.jsx("option",{value:"generic",children:"Generic Deck (No stats)"}),F.map(Q=>s.jsxs("option",{value:Q.id,children:[Q.name," (",typeof Q.commander=="object"?Q.commander?.name:Q.commander||"No Commander",")"]},Q.id))]}),s.jsxs("button",{onClick:()=>{L&&(B(!0),m(!0))},disabled:!L,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:[s.jsx(J3,{className:"w-5 h-5 fill-current"}),"Join Game"]})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-sm text-gray-600 hover:text-gray-400 transition-colors",children:"Cancel and Return to Lobby"})})]})});if(x||!i)return s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"}),s.jsx("div",{className:"text-gray-500 text-xs uppercase tracking-widest font-bold",children:"Connecting to War Room..."})]});const ue=i.players.find(Q=>Q.id===c),ve=i.players.filter(Q=>Q.id!==c);return ue?s.jsxs("div",{className:"flex flex-col h-[100dvh] bg-black overflow-hidden relative touch-none",children:[s.jsx("div",{className:"flex-1 bg-gray-900 grid grid-cols-2 gap-px border-b border-gray-800",children:ve.length>0?ve.map(Q=>s.jsxs("div",{className:`relative flex flex-col items-center justify-center bg-gray-900 p-2 border group transition-colors duration-500 ${i.activePlayerId===Q.id?"border-indigo-500 shadow-[inset_0_0_20px_rgba(79,70,229,0.2)]":"border-black/20"}`,children:[s.jsx("span",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest absolute top-2 w-full text-center truncate px-2",children:Q.name}),s.jsx("span",{className:"text-4xl font-black text-white/90 mb-2",children:Q.life}),G(Q)]},Q.id)):s.jsxs("div",{className:"col-span-2 flex flex-col items-center justify-center text-gray-600 space-y-2 p-6 text-center",children:[s.jsx("div",{className:"animate-pulse",children:"Waiting for opponents..."}),s.jsxs("div",{className:"text-xs font-mono bg-white/5 px-2 py-1 rounded",children:["PIN: ",C]})]})}),s.jsxs("div",{className:"h-12 bg-gray-950 shrink-0 flex items-center justify-between px-4 border-y border-white/5 z-20",children:[s.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-4",children:[s.jsxs("span",{children:["PIN: ",s.jsx("span",{className:"text-indigo-400 font-mono tracking-widest ml-1",children:C})]}),i.turnCount>0&&s.jsxs("span",{className:"bg-white/10 px-2 py-0.5 rounded text-gray-300",children:["Turn ",i.turnCount]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:xe,className:"p-2 text-gray-500 hover:text-white transition-colors",title:"Add Log Note",children:s.jsx(fae,{className:"w-4 h-4"})}),A&&s.jsxs("button",{onClick:U,className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 text-[10px] uppercase font-bold px-3 py-1.5 rounded flex items-center gap-1.5 transition-colors border border-red-500/20",children:[s.jsx(eae,{className:"w-3 h-3"}),"End Game"]}),s.jsx("button",{onClick:()=>e("/play/lobby"),className:"text-[10px] uppercase font-bold text-gray-600 hover:text-white transition-colors",children:"Leave"})]})]}),s.jsxs("div",{className:`flex-[2] bg-gray-950 relative group transition-all duration-500 ${i.activePlayerId===c?"shadow-[inset_0_0_30px_rgba(79,70,229,0.15)] border-t-2 border-indigo-500":""}`,children:[s.jsx(uIe,{life:ue.life,isSelf:!0,label:ue.name,onChange:se}),s.jsx("button",{onClick:()=>v(!0),className:"absolute top-6 right-6 w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center border border-white/10 shadow-lg z-20 transition-colors",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:[s.jsx("path",{d:"M12 2v20"}),s.jsx("path",{d:"M2 12h20"}),s.jsx("path",{d:"m4.93 4.93 14.14 14.14"}),s.jsx("path",{d:"m19.07 4.93-14.14 14.14"})]})})]}),P&&s.jsx("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 z-[60] animate-fade-in-up",children:s.jsxs("button",{onClick:ee,className:"bg-gray-800/90 text-white px-6 py-3 rounded-full shadow-2xl border border-white/10 flex items-center gap-3 hover:bg-gray-700 transition-colors backdrop-blur-md",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),s.jsxs("div",{className:"flex flex-col items-start leading-none",children:[s.jsx("span",{className:"text-xs font-bold uppercase text-gray-400",children:"Undo"}),s.jsxs("span",{className:"font-bold text-sm",children:[P.type==="LIFE"&&`Life ${P.change>0?"+":""}${P.change}`,P.type==="COUNTER"&&`${P.counterType} ${P.change>0?"+":""}${P.change}`,P.type==="CMDR_DMG"&&`Cmd Dmg ${P.change>0?"+":""}${P.change}`]})]}),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("span",{className:"text-xs font-mono text-gray-500",children:"5s"})]})}),s.jsx(hIe,{isOpen:y,onClose:()=>v(!1),players:i.players,myPlayerId:c,myCounters:ue.counters,myCommanderDamage:ue.commanderDamage,onUpdateCounter:J,onUpdateCmdDamage:W}),i.turnCount===0&&s.jsxs("div",{className:"absolute inset-0 z-40 bg-black/90 flex flex-col items-center justify-center p-6 space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-widest uppercase",children:"Prepare for Battle"}),s.jsxs("p",{className:"text-gray-400",children:["Waiting for ",A?"you to start":"host to start","..."]}),s.jsx("div",{className:"pt-2",children:s.jsxs("div",{className:"inline-block bg-white/10 rounded px-4 py-2 border border-white/20",children:[s.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mr-2",children:"Session PIN"}),s.jsx("span",{className:"text-2xl font-mono font-bold text-indigo-400 tracking-widest",children:C})]})})]}),A&&s.jsxs("div",{className:"w-full max-w-sm space-y-4",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Who goes first?"}),s.jsx("div",{className:"grid gap-2",children:i.players.map(Q=>s.jsxs("button",{onClick:()=>te(Q.id),className:"w-full p-4 bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-indigo-500 text-left rounded-xl transition-all flex items-center justify-between group",children:[s.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white",children:Q.name}),s.jsx(J3,{className:"w-4 h-4 text-gray-600 group-hover:text-indigo-400"})]},Q.id))})]})]}),i.turnCount>0&&i.activePlayerId===c&&s.jsx("div",{className:"absolute bottom-32 md:bottom-24 left-1/2 -translate-x-1/2 z-50 animate-bounce-message",children:s.jsxs("button",{onClick:ce,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-full font-bold shadow-lg shadow-indigo-900/50 flex items-center gap-2 transition-transform active:scale-95 border-2 border-indigo-400/50",children:[s.jsx(Cae,{className:"w-5 h-5"}),"Pass Turn"]})}),s.jsx(fIe,{isOpen:j,onClose:()=>N(!1),finalState:o,onSave:Y,roomId:R.current})]}):null},mIe=({title:t,subtitle:e,icon:r,actions:n})=>s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[r&&s.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl text-indigo-400 border border-indigo-500/20",children:s.jsx(r,{size:32})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:t}),e&&s.jsx("p",{className:"text-gray-400 mt-1 text-sm font-medium",children:e})]})]}),n&&s.jsx("div",{className:"flex items-center gap-2",children:n})]}),gIe=()=>{const[t,e]=b.useState({friends:[],pending_sent:[],pending_received:[]}),[r,n]=b.useState(""),[i,a]=b.useState([]),[o,l]=b.useState(!0),[c,u]=b.useState(null);b.useEffect(()=>{f()},[]);const f=async()=>{try{const y=await Ze.get("/api/friends");e(y)}catch(y){console.error(y),u("Failed to load friends")}finally{l(!1)}},p=async()=>{if(!(r.length<3))try{const y=await Ze.get(`/api/friends/search?q=${encodeURIComponent(r)}`),v=new Set([...t.friends.map(j=>j.id),...t.pending_sent.map(j=>j.id),...t.pending_received.map(j=>j.id)]);a(y.filter(j=>!v.has(j.id)))}catch(y){console.error(y)}},x=async y=>{try{await Ze.post("/api/friends/request",{target_id:y}),a(v=>v.filter(j=>j.id!==y)),f()}catch(v){alert(v.response?.data?.error||"Failed to send request")}},m=async(y,v)=>{try{await Ze.post("/api/friends/respond",{friendship_id:y,action:v}),f()}catch(j){console.error(j)}};return s.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Find Friends"}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Nae,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),s.jsx("input",{type:"text",value:r,onChange:y=>n(y.target.value),onKeyDown:y=>y.key==="Enter"&&p(),placeholder:"Search by username...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg py-2 pl-10 pr-4 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("button",{onClick:p,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors",children:"Search"})]}),i.length>0&&s.jsx("div",{className:"bg-gray-900 rounded-lg overflow-hidden border border-gray-700",children:i.map(y=>s.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-800 last:border-0 hover:bg-gray-800/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-gray-300 font-bold",children:y.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-medium",children:y.username}),s.jsx("div",{className:"text-xs text-gray-500",children:y.email})]})]}),s.jsxs("button",{onClick:()=>x(y.id),className:"flex items-center gap-2 px-3 py-1.5 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/10 rounded-lg text-sm transition-colors",children:[s.jsx(Z3,{size:16}),"Add"]})]},y.id))})]}),(t.pending_received.length>0||t.pending_sent.length>0)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Pending Requests"}),s.jsxs("div",{className:"space-y-2",children:[t.pending_received.map(y=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 font-bold border border-indigo-500/30",children:y.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-medium",children:y.username}),s.jsx("div",{className:"text-xs text-gray-400",children:"wants to be your friend"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>m(y.friendship_id,"accept"),className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[s.jsx(vd,{size:16})," Accept"]}),s.jsxs("button",{onClick:()=>m(y.friendship_id,"reject"),className:"bg-gray-700 hover:bg-red-600/80 text-gray-300 hover:text-white px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 transition-colors",children:[s.jsx(Sd,{size:16})," Reject"]})]})]},y.id)),t.pending_sent.map(y=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/30 rounded-lg border border-gray-800 opacity-75",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-gray-500 font-bold",children:y.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-300 font-medium",children:y.username}),s.jsx("div",{className:"text-xs text-gray-500",children:"Request sent"})]})]}),s.jsx("span",{className:"px-2 py-1 bg-gray-800 rounded text-xs text-gray-500 font-medium border border-gray-700",children:"Pending"})]},y.id))]})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-4",children:["My Friends (",t.friends.length,")"]}),t.friends.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-900/50 rounded-lg border border-dashed border-gray-700",children:[s.jsx(Z3,{size:48,className:"mx-auto mb-4 opacity-20"}),s.jsx("p",{children:"You haven't added any friends yet."}),s.jsx("p",{className:"text-sm",children:"Search above to connect!"})]}):s.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.friends.map(y=>s.jsxs("div",{className:"flex items-center p-3 bg-gray-900 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors group",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-500/20 mr-4",children:y.username[0].toUpperCase()}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-white font-bold",children:y.username}),y.lfg_status&&s.jsx("span",{className:"px-1.5 py-0.5 bg-green-500/20 text-green-400 text-[10px] font-bold uppercase rounded border border-green-500/30",children:"LFG"})]}),s.jsx("div",{className:"text-xs text-gray-500",children:y.email})]}),s.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-2 text-gray-500 hover:text-red-400 transition-all"})]},y.id))})]})]})},xIe=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(!0);return b.useEffect(()=>{(async()=>{try{const a=await Ze.get("/api/social/feed");e(a)}catch(a){console.error(a)}finally{n(!1)}})()},[]),r?s.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:[1,2,3].map(i=>s.jsx("div",{className:"h-32 bg-gray-800/50 rounded-xl animate-pulse"},i))}):t.length===0?s.jsxs("div",{className:"text-center py-16 max-w-lg mx-auto",children:[s.jsx("div",{className:"inline-flex p-4 rounded-full bg-gray-800 mb-4",children:s.jsx(J1,{size:48,className:"text-gray-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-300 mb-2",children:"No recent activity"}),s.jsxs("p",{className:"text-gray-500",children:["Matches played by you and your friends will appear here.",s.jsx("br",{}),"Add friends to populate your feed!"]})]}):s.jsx("div",{className:"max-w-3xl mx-auto space-y-4",children:t.map(i=>s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[s.jsx(J1,{size:20}),s.jsx("span",{className:"font-bold text-sm uppercase tracking-wide",children:"Commander Match"})]}),s.jsx("span",{className:"text-xs text-gray-500",children:W0e(new Date(i.date),{addSuffix:!0})})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:i.participants.map(a=>s.jsxs("div",{className:`
                    flex items-center justify-between p-3 rounded-lg border 
                    ${a.outcome==="win"?"bg-amber-500/10 border-amber-500/30":"bg-gray-900/50 border-gray-800"}
                  `,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs
                        ${a.outcome==="win"?"bg-amber-500 text-black shadow-lg shadow-amber-500/20":"bg-gray-700 text-gray-300"}
                    `,children:a.username[0].toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:`text-sm font-bold ${a.outcome==="win"?"text-amber-200":"text-gray-300"}`,children:a.username}),s.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:a.deck||"Unknown Deck"})]})]}),a.outcome==="win"&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-500/20 rounded text-amber-400 text-[10px] font-bold uppercase border border-amber-500/30",children:[s.jsx(jx,{size:12})," Winner"]})]},a.userId))})]},i.id))})},bIe=()=>{const[t,e]=b.useState([]),[r,n]=b.useState(!0);b.useEffect(()=>{(async()=>{try{const o=await Ze.get("/api/social/leaderboard");e(o)}catch(o){console.error(o)}finally{n(!1)}})()},[]);const i=a=>a===0?{icon:s.jsx(Ga,{size:20,className:"text-yellow-400"}),bg:"bg-yellow-500/10",border:"border-yellow-500/30"}:a===1?{icon:s.jsx(P7,{size:20,className:"text-gray-300"}),bg:"bg-gray-400/10",border:"border-gray-400/30"}:a===2?{icon:s.jsx(P7,{size:20,className:"text-amber-700"}),bg:"bg-orange-900/10",border:"border-orange-700/30"}:{icon:s.jsxs("span",{className:"text-gray-500 font-bold ml-1.5",children:["#",a+1]}),bg:"bg-transparent",border:"border-transparent"};return s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Ga,{className:"text-yellow-500",size:24}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"Weekly Top Players"})]}),s.jsx("div",{className:"bg-gray-900/60 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-900/80 text-gray-400 text-xs uppercase tracking-wider border-b border-gray-800",children:[s.jsx("th",{className:"p-4 w-20 text-center",children:"Rank"}),s.jsx("th",{className:"p-4",children:"Player"}),s.jsx("th",{className:"p-4 text-center",children:"Wins"}),s.jsx("th",{className:"p-4 text-center",children:"Games"}),s.jsx("th",{className:"p-4 text-center",children:"Win Rate"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:r?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Loading leaderboard..."})}):t.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No games played this week yet. Get out there!"})}):t.map((a,o)=>{const l=i(o),c=a.games_played>0?Math.round(a.wins/a.games_played*100):0;return s.jsxs("tr",{className:`hover:bg-gray-800/30 transition-colors ${o<3?"bg-gray-800/10":""}`,children:[s.jsx("td",{className:"p-4 text-center",children:s.jsx("div",{className:"flex justify-center items-center",children:l.icon})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs bg-gray-700 text-gray-200 border border-gray-600",children:a.username?a.username[0].toUpperCase():"?"}),s.jsx("span",{className:`font-bold ${o===0?"text-yellow-400":"text-gray-200"}`,children:a.username}),o===0&&s.jsx(jx,{size:14,className:"text-yellow-500"})]})}),s.jsx("td",{className:"p-4 text-center font-bold text-green-400 text-lg",children:a.wins}),s.jsx("td",{className:"p-4 text-center text-gray-400",children:a.games_played}),s.jsx("td",{className:"p-4 text-center",children:s.jsxs("span",{className:`
                                        inline-block px-2 py-1 rounded text-xs font-bold
                                        ${c>=50?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-gray-800 text-gray-400 border border-gray-700"}
                                    `,children:[c,"%"]})})]},a.user_id)})})]})})]})},EX=({tournaments:t,emptyMessage:e="No tournaments found."})=>{const r=dn();return!t||t.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(Ga,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments"}),s.jsx("p",{className:"text-gray-500 mb-6",children:e})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(n=>s.jsxs("div",{onClick:()=>r(`/tournaments/${n.id}`),className:"group bg-gray-800/50 hover:bg-gray-800 border border-gray-700 hover:border-yellow-500/50 rounded-xl p-5 cursor-pointer transition-all hover:shadow-lg hover:shadow-yellow-500/10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-yellow-400 transition-colors",children:n.name}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase tracking-wider ${n.status==="active"?"bg-green-500/20 text-green-400":n.status==="completed"?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-400"}`,children:n.status})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-400 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(UF,{className:"w-4 h-4"}),new Date(n.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"w-4 h-4"}),n.format.toUpperCase()]})]}),s.jsxs("div",{className:"flex items-center text-yellow-500 text-sm font-medium group-hover:translate-x-1 transition-transform",children:["Manage Tournament ",s.jsx(Oie,{className:"w-4 h-4 ml-1"})]})]},n.id))})},TX=({isOpen:t,onClose:e,onCreated:r})=>{const n=dn(),[i,a]=b.useState(""),[o,l]=b.useState("swiss"),[c,u]=b.useState(""),[f,p]=b.useState(!1),x=async m=>{m.preventDefault(),p(!0);try{const y={name:i||"New Tournament",format:o,settings:{total_rounds:o==="elimination"&&c?parseInt(c,10):null,target_points:o==="swiss"&&c?parseInt(c,10):null}},v=await Ze.post("/api/tournaments",y);a(""),l("swiss"),u(""),p(!1),r?r(v):(e(),n(`/tournaments/${v.id}`))}catch(y){console.error("Failed to create tournament",y),p(!1),alert("Failed to create tournament. Please try again.")}};return t?s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md p-6 shadow-2xl",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Create Tournament"}),s.jsxs("form",{onSubmit:x,children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Event Name"}),s.jsx("input",{autoFocus:!0,type:"text",value:i,onChange:m=>a(m.target.value),placeholder:"e.g. Friday Night Magic",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none mb-4",required:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Format"}),s.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none",children:[s.jsx("option",{value:"swiss",children:"Swiss (Points)"}),s.jsx("option",{value:"elimination",children:"Single Elimination"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:o==="swiss"?"Target Points (Optional)":"Round Limit (Optional)"}),s.jsx("input",{type:"number",min:"1",value:c,onChange:m=>u(m.target.value),placeholder:o==="swiss"?"e.g. 12":"Auto",className:"w-full bg-gray-800 border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-yellow-500 outline-none"})]})]}),o==="swiss"&&s.jsxs("div",{className:"text-xs text-gray-500 mb-6 bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[s.jsx("span",{className:"font-bold text-yellow-500",children:"Note:"})," Wins are 3 points, Draws are 1 point. Setting a target will end the tournament once a player reaches this score."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 hover:bg-gray-800 rounded-lg text-gray-400 font-medium transition-colors",disabled:f,children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-6 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors disabled:opacity-50",disabled:f,children:f?"Creating...":"Create Event"})]})]})]})}):null},yIe=()=>{const{user:t,userProfile:e,refreshUserProfile:r}=Sr(),[n,i]=mw(),[a,o]=b.useState(n.get("tab")||"feed"),[l,c]=b.useState(!1),[u,f]=b.useState([]),[p,x]=b.useState(!1),[m,y]=b.useState(!1);b.useEffect(()=>{e?.lfg_status!==void 0&&c(e.lfg_status)},[e]),b.useEffect(()=>{a==="tournaments"&&v(),i({tab:a},{replace:!0})},[a,i]);const v=async()=>{try{x(!0);const C=await Ze.get("/api/tournaments");f(C||[])}catch(C){console.error("Failed to fetch tournaments",C)}finally{x(!1)}},j=async()=>{const C=!l;c(C);try{e?.id&&(await Ze.updateUser(e.id,{lfg_status:C}),r&&await r())}catch(A){console.error("Failed to update LFG status",A),c(!C)}},N=[{id:"feed",label:"Activity Feed",icon:X3},{id:"friends",label:"Friends",icon:u0},{id:"leaderboard",label:"Leaderboard",icon:Ga},{id:"tournaments",label:"Tournaments",icon:J1}];return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[s.jsx(mIe,{title:"Social Hub",subtitle:"Connect with friends and track the meta.",icon:u0}),s.jsx("div",{className:`p-4 rounded-xl border transition-colors ${l?"bg-green-500/10 border-green-500/30":"bg-gray-900 border-gray-800"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:j,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900 ${l?"bg-green-500":"bg-gray-700"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l?"translate-x-6":"translate-x-1"}`})}),s.jsxs("div",{children:[s.jsx("div",{className:`text-sm font-bold ${l?"text-green-400":"text-gray-400"}`,children:"Looking for Game"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Signal your friends you're ready to play"})]})]})})]}),s.jsxs("div",{className:"bg-gray-900/40 border border-white/5 rounded-2xl overflow-hidden backdrop-blur-sm",children:[s.jsx("div",{className:"border-b border-white/5",children:s.jsx("div",{className:"flex overflow-x-auto",children:N.map(C=>{const A=C.icon,L=a===C.id;return s.jsxs("button",{onClick:()=>o(C.id),className:`flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${L?"border-indigo-500 text-indigo-400 bg-indigo-500/5":"border-transparent text-gray-400 hover:text-gray-200 hover:bg-white/5"}`,children:[s.jsx(A,{size:18}),C.label]},C.id)})})}),s.jsxs("div",{className:"p-6",children:[a==="feed"&&s.jsx(xIe,{}),a==="friends"&&s.jsx(gIe,{}),a==="leaderboard"&&s.jsx(bIe,{}),a==="tournaments"&&(p?s.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading Tournaments..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg text-sm transition-colors",children:[s.jsx(J1,{className:"w-4 h-4"}),"Create Tournament"]})}),s.jsx(EX,{tournaments:u,emptyMessage:"No active tournaments found based on filters."})]}))]})]}),s.jsx(TX,{isOpen:m,onClose:()=>y(!1)})]})},vIe=()=>{const{currentUser:t,userProfile:e}=Sr(),[r,n]=b.useState([]),[i,a]=b.useState(!0),[o,l]=b.useState(null);return b.useEffect(()=>{if(!e?.id)return;(async()=>{a(!0);try{const u=await gq.findMatches(e.id);n(u)}catch(u){console.error("Trade fetch error:",u),l("Failed to load trade matches.")}finally{a(!1)}})()},[e]),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-xl",children:s.jsx("span",{className:"text-3xl",children:""})}),"The Armory"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Automated Trade Matches with your Pod"})]}),s.jsx("div",{className:"flex gap-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl px-4 py-2 border border-gray-700 text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Matches"}),s.jsx("div",{className:"text-xl font-bold text-white",children:r.length})]})})]}),i?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((c,u)=>s.jsx("div",{className:"h-32 bg-gray-800 rounded-xl animate-pulse"},u))}):o?s.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 p-6 rounded-xl text-center text-red-300",children:[s.jsx("p",{children:o}),s.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-900/50 hover:bg-red-800 rounded-lg text-white text-sm",children:"Retry"})]}):r.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-900/50 rounded-2xl border border-gray-800",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Matches Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"We couldn't find anyone in your Pod who has cards from your Wishlist in their Public Binders."}),s.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[s.jsx(br,{to:"/binders",className:"px-5 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-bold",children:"Update Binders"}),s.jsx(br,{to:"/wishlist",className:"px-5 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-bold",children:"Update Wishlist"})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((c,u)=>s.jsxs("div",{className:"bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-indigo-500/50 rounded-xl p-4 flex gap-4 transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-indigo-500/5 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none"}),s.jsx("div",{className:"relative w-24 min-w-[6rem] aspect-[2.5/3.5] rounded-lg overflow-hidden shadow-lg border border-black/50",children:c.image?s.jsx("img",{src:c.image,alt:c.cardName,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center text-xs text-gray-500",children:"No Img"})}),s.jsxs("div",{className:"flex flex-col justify-between flex-1 min-w-0 z-10",children:[s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx("h3",{className:"text-lg font-bold text-white truncate",children:c.cardName})}),s.jsxs("div",{className:"text-xs text-indigo-400 font-mono mt-1",children:[c.set?.toUpperCase(),"  ",c.finish]}),s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsx("div",{className:"text-xs text-gray-400",children:"Available from:"}),s.jsx(br,{to:`/profile/${c.friendId}`,className:"px-2 py-0.5 bg-indigo-900/30 text-indigo-300 rounded text-xs font-bold border border-indigo-500/20 hover:bg-indigo-500 hover:text-white transition-colors cursor-pointer",children:c.friendName})]}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Quantity: ",c.quantity]})]}),s.jsxs("button",{onClick:()=>alert(`Requesting ${c.cardName} from ${c.friendName}... (Feature Coming Soon)`),className:"mt-3 w-full py-2 bg-gray-700 hover:bg-indigo-600 text-white text-xs font-bold uppercase rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Request Trade"]})]})]},`${c.cardId}-${u}`))})]})},wIe=()=>{const{id:t}=Eo(),e=dn(),{userProfile:r}=Sr(),[n,i]=b.useState(null),[a,o]=b.useState([]),[l,c]=b.useState(!0),[u,f]=b.useState(null),[p,x]=b.useState(!1),m=async()=>{try{c(!0);const v=await Ze.get(`/users/public/${t}`);if(i(v.data),v.data.is_public_library||v.data.relationship?.status==="accepted"){const j=await Ze.get(`/api/decks?userId=${t}`);o(j.data)}}catch(v){console.error("Failed to fetch profile",v),v.response?.status===403?f("This profile is private."):v.response?.status===404?f("User not found."):f("Failed to load profile.")}finally{c(!1)}};b.useEffect(()=>{t&&m()},[t]);const y=async v=>{if(n){x(!0);try{v==="request"?await wa.sendRequest({targetId:n.id},"friend"):v==="cancel"||v==="unfriend"?n.relationship?.id&&await wa.deleteRelationship(n.relationship.id):v==="accept"&&n.relationship?.id&&await wa.respondToRequest(n.relationship.id,"accepted"),await m()}catch(j){console.error("Friend action failed",j),alert("Action failed: "+(j.response?.data?.error||"Unknown error"))}finally{x(!1)}}};return l?s.jsxs("div",{className:"flex items-center justify-center h-screen text-slate-400",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500 mr-3"}),"Loading Profile..."]}):u?s.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center px-4",children:[s.jsx("div",{className:"bg-red-500/10 p-4 rounded-full mb-4",children:s.jsx(d0,{className:"w-12 h-12 text-red-500"})}),s.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-slate-400 mb-6 max-w-md",children:u}),s.jsx("button",{onClick:()=>e("/dashboard"),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors",children:"Return to Dashboard"})]}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[s.jsxs("div",{className:"relative bg-slate-800 rounded-2xl p-8 border border-slate-700/50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-5 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-primary-500 via-slate-900 to-slate-900 pointer-events-none"}),s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center md:items-start md:space-x-8",children:[s.jsx("div",{className:"w-32 h-32 rounded-full bg-slate-700 flex items-center justify-center border-4 border-slate-800 shadow-xl mb-4 md:mb-0",children:n.avatar?s.jsx("img",{src:n.avatar,alt:n.username,className:"w-full h-full rounded-full object-cover"}):s.jsx(Q3,{className:"w-16 h-16 text-slate-500"})}),s.jsxs("div",{className:"flex-1 text-center md:text-left space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-3",children:[s.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:n.username}),n.is_friend&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",children:"Friend"}),r?.id===n.id&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"You"})]}),n.bio&&s.jsx("p",{className:"text-slate-300 max-w-2xl",children:n.bio}),s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-6 text-sm text-slate-400 pt-2",children:[s.jsxs("span",{children:["Joined ",new Date(n.joined_at).toLocaleDateString()]}),n.is_public_library&&s.jsxs("span",{className:"flex items-center text-amber-400",children:[s.jsx(WF,{className:"w-3 h-3 mr-1.5"}),"Public Library"]})]})]}),s.jsxs("div",{className:"mt-6 md:mt-0 flex flex-wrap gap-3 justify-center md:justify-end",children:[r?.id!==n.id&&s.jsxs(s.Fragment,{children:[(!n.relationship||!n.relationship.status)&&s.jsxs("button",{onClick:()=>y("request"),disabled:p,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-indigo-900/20 transition-all flex items-center disabled:opacity-50",children:[s.jsx(Q3,{className:"w-4 h-4 mr-2"}),"Add Friend"]}),n.relationship?.status==="pending"&&n.relationship.direction==="outgoing"&&s.jsx("button",{onClick:()=>y("cancel"),disabled:p,className:"bg-slate-700 hover:bg-slate-600 text-slate-200 px-5 py-2.5 rounded-lg font-medium transition-all flex items-center disabled:opacity-50",children:"Cancel Request"}),n.relationship?.status==="pending"&&n.relationship.direction==="incoming"&&s.jsx("button",{onClick:()=>y("accept"),disabled:p,className:"bg-emerald-600 hover:bg-emerald-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-emerald-900/20 transition-all flex items-center disabled:opacity-50",children:"Accept Request"}),n.relationship?.status==="accepted"&&s.jsx("button",{onClick:()=>{window.confirm(`Unfriend ${n.username}?`)&&y("unfriend")},disabled:p,className:"bg-slate-700 hover:bg-red-900/40 hover:text-red-400 text-slate-300 px-5 py-2.5 rounded-lg font-medium transition-all flex items-center disabled:opacity-50 border border-transparent hover:border-red-900/50",children:"Unfriend"})]}),s.jsx("button",{onClick:()=>e(`/collection?userId=${n.id}&public=true`),className:"bg-primary-600 hover:bg-primary-500 text-white px-5 py-2.5 rounded-lg font-medium shadow-lg shadow-primary-900/20 transition-all flex items-center",children:"View Collection"})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("h2",{className:"text-xl font-bold text-white",children:"Public Library"})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{onClick:()=>e(`/collection?userId=${n.id}&public=true`),className:"group cursor-pointer bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-primary-500/50 rounded-xl p-6 transition-all h-full flex flex-col justify-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-1 group-hover:text-primary-400 transition-colors uppercase tracking-tight",children:"Browse Collection"}),s.jsx("p",{className:"text-slate-400 text-sm",children:"View all cards available for trade or display."})]}),a.map(v=>s.jsxs("div",{onClick:()=>e(`/decks/${v.id}`),className:"group cursor-pointer bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-indigo-500/50 rounded-xl p-6 transition-all",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-white group-hover:text-indigo-400 transition-colors truncate pr-2",children:v.name}),s.jsx("span",{className:"text-[10px] bg-indigo-500/20 text-indigo-400 px-2 py-0.5 rounded uppercase font-bold tracking-wider border border-indigo-500/30",children:v.format})]}),s.jsxs("p",{className:"text-slate-400 text-sm",children:[v.card_count," Cards"]})]},v.id)),a.length===0&&s.jsx("div",{className:"bg-slate-900/50 border border-dashed border-slate-800 rounded-xl p-6 flex items-center justify-center",children:s.jsx("p",{className:"text-slate-600 text-sm italic",children:"No public decks shared."})})]})]})]})},jIe=({tournamentId:t,round:e,initialPairings:r,participants:n,onUpdate:i,isPending:a,isOrganizer:o})=>{const{user:l}=Sr(),[c,u]=Ke.useState(!1),{addToast:f}=wn();if(a)return s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(d0,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"Tournament Pending"}),s.jsx("p",{className:"text-gray-500",children:"Add players and click Start to generate pairings."})]});if(!r||r.length===0)return s.jsx("div",{className:"p-4 text-center text-gray-400",children:"No pairings for this round."});const p=n.reduce((y,v)=>(y[v.id]=v,y),{}),x=async(y,v,j)=>{try{await Ze.post(`/api/tournaments/${t}/matches`,{matchId:y,winnerId:j?null:v,isDraw:j}),i()}catch(N){console.error("Failed to report result",N),f("Failed to save result","error")}},m=async(y,v)=>{try{await Ze.put(`/api/tournaments/${t}/pairings/${y}`,v),f("Pairing updated","success"),setTimeout(i,500)}catch(j){console.error("Failed to edit pairing",j),f("Failed to update pairing","error")}};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-white",children:["Round ",e," Pairings"]}),o&&s.jsx("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-lg border font-bold transition-all ${c?"bg-indigo-600 text-white border-indigo-500":"bg-gray-800 text-gray-400 border-gray-700 hover:text-white"}`,children:c?"Done Editing":"Edit Pairings"})]}),r.map(y=>{const v=p[y.player1_id],j=p[y.player2_id],N=y.winner_id===y.player1_id&&!y.is_draw,C=y.winner_id===y.player2_id&&!y.is_draw,A=y.is_draw,L=n.find(F=>F.user_id===l?.id),O=L&&(y.player1_id===L.id||y.player2_id===L.id);return s.jsxs("div",{className:`p-4 rounded-xl border flex flex-col md:flex-row items-center justify-between gap-4 transition-all ${O&&!c?"bg-blue-900/20 border-blue-500/50":"bg-gray-800 border-gray-700"}`,children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1 w-full md:w-auto",children:[s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsxs("span",{className:"text-gray-500 font-mono text-sm",children:["Table ",y.table_number]}),O&&!y.winner_id&&!y.is_draw&&!c&&s.jsxs("button",{onClick:()=>window.open(`/play/room/pair-${y.id}`,"_blank"),className:"px-2 py-1 bg-green-600 hover:bg-green-500 text-white text-[10px] font-bold rounded flex items-center gap-1 shadow-lg",children:[s.jsx(qie,{className:"w-3 h-3"})," JOIN"]})]}),s.jsx("div",{className:`flex-1 text-right font-bold ${N?"text-green-400":"text-white"}`,children:c?s.jsx("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full text-right",value:y.player1_id||"",onChange:F=>m(y.id,{player1Id:F.target.value}),children:n.map(F=>s.jsx("option",{value:F.id,children:F.username||F.guest_name},F.id))}):v?v.username||v.guest_name:"Unknown"}),s.jsx("div",{className:"text-gray-500 font-bold text-xs",children:"VS"}),s.jsx("div",{className:`flex-1 text-left font-bold ${C?"text-green-400":"text-white"}`,children:c?s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs w-full",value:y.player2_id||"",onChange:F=>m(y.id,{player2Id:F.target.value||null}),children:[s.jsx("option",{value:"",children:"(Bye)"}),n.map(F=>s.jsx("option",{value:F.id,children:F.username||F.guest_name},F.id))]}):j?j.username||j.guest_name:y.player2_id===null?"BYE":"Unknown"})]}),!c&&(y.player2_id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>x(y.id,y.player1_id,!1),className:`p-2 rounded-lg transition-colors ${N?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 1 Wins",children:s.jsx(Ga,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>x(y.id,null,!0),className:`p-2 rounded-lg transition-colors ${A?"bg-yellow-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Draw",children:s.jsx(mae,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>x(y.id,y.player2_id,!1),className:`p-2 rounded-lg transition-colors ${C?"bg-green-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,title:"Player 2 Wins",children:s.jsx(Ga,{className:"w-4 h-4"})})]}):s.jsx("div",{className:"px-4 py-2 bg-gray-700/50 rounded-lg text-gray-400 text-sm",children:"Automatic Win"}))]},y.id)})]})},NIe=({participants:t,tournamentId:e,currentUserId:r,isOrganizer:n,onUpdate:i})=>{if(!t||t.length===0)return s.jsx("div",{className:"p-4 text-center text-gray-400",children:"No participants yet."});const{addToast:a}=wn(),o=[...t].sort((c,u)=>u.score!==c.score?u.score-c.score:u.wins!==c.wins?u.wins-c.wins:c.losses-u.losses),l=async c=>{if(confirm("Are you sure you want to drop this player? They will be removed from future pairings."))try{await Ze.post(`/api/tournaments/${e}/drop`,{participantId:c}),a("Player dropped successfully","success"),i()}catch(u){console.error(u),a("Failed to drop player","error")}};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-gray-400 border-b border-gray-700",children:[s.jsx("th",{className:"p-4 font-medium uppercase text-xs",children:"Rank"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs w-full",children:"Player"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Pts"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"W"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"L"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"D"}),s.jsx("th",{className:"p-4 font-medium uppercase text-xs text-center",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:o.map((c,u)=>s.jsxs("tr",{className:`transition-colors ${c.is_active===!1?"bg-red-900/10 opacity-60":"hover:bg-gray-800/50"}`,children:[s.jsx("td",{className:"p-4",children:s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${u===0?"bg-yellow-500/20 text-yellow-500":u===1?"bg-gray-400/20 text-gray-400":u===2?"bg-orange-700/20 text-orange-700":"text-gray-500"}`,children:u+1})}),s.jsx("td",{className:"p-4 font-bold text-white",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:c.username||c.guest_name}),c.deck_snapshot&&s.jsx("span",{className:"text-xs text-blue-400 font-normal",children:c.deck_snapshot.name})]})}),s.jsx("td",{className:"p-4 text-center font-bold text-yellow-500 text-lg",children:c.score}),s.jsx("td",{className:"p-4 text-center text-green-400 font-medium",children:c.wins}),s.jsx("td",{className:"p-4 text-center text-red-400 font-medium",children:c.losses}),s.jsx("td",{className:"p-4 text-center text-gray-400 font-medium",children:c.draws}),s.jsx("td",{className:"p-4 text-center",children:c.is_active===!1?s.jsx("span",{className:"text-xs bg-red-900 text-red-300 px-2 py-1 rounded",children:"Dropped"}):(n||c.user_id===r)&&s.jsx("button",{onClick:()=>l(c.id),className:"text-xs bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-300 px-2 py-1 rounded border border-gray-600 hover:border-red-800 transition-colors",children:"Drop"})})]},c.id))})]})})},kIe=({pairings:t,participants:e})=>{const r=b.useMemo(()=>{if(!t||t.length===0)return[];const i={};let a=0;t.forEach(l=>{i[l.round_number]||(i[l.round_number]=[]),i[l.round_number].push(l),l.round_number>a&&(a=l.round_number)});const o=[];for(let l=1;l<=a;l++)i[l]&&o.push(i[l].sort((c,u)=>c.table_number-u.table_number));return o},[t]),n=i=>{if(!i)return"Bye";const a=e.find(o=>o.id===i);return a?a.username||a.guest_name:"Unknown"};return r.length===0?s.jsx("div",{className:"text-center py-12 text-gray-500",children:"No bracket data available yet. Start the tournament to generate the bracket."}):s.jsx("div",{className:"overflow-x-auto pb-6 custom-scrollbar",children:s.jsx("div",{className:"flex gap-8 min-w-max px-4",children:r.map((i,a)=>s.jsxs("div",{className:"flex flex-col justify-around gap-8",children:[s.jsxs("div",{className:"text-center text-gray-500 font-bold uppercase text-xs mb-2 tracking-wider",children:["Round ",a+1]}),s.jsx("div",{className:"flex flex-col justify-around flex-grow gap-4",children:i.map(o=>s.jsx(SIe,{match:o,getPlayerName:n},o.id))})]},a))})})},SIe=({match:t,getPlayerName:e})=>{const r=t.winner_id===t.player1_id,n=t.winner_id===t.player2_id;return s.jsxs("div",{className:"w-48 bg-gray-800 border border-gray-700 rounded-lg overflow-hidden flex flex-col shadow-lg relative",children:[s.jsxs("div",{className:`p-2 flex justify-between items-center ${r?"bg-green-900/20":""} border-b border-gray-700/50`,children:[s.jsx("span",{className:`text-sm truncate ${r?"text-green-400 font-bold":"text-gray-300"}`,children:e(t.player1_id)}),r&&s.jsx(Ga,{className:"w-3 h-3 text-yellow-500"})]}),s.jsxs("div",{className:`p-2 flex justify-between items-center ${n?"bg-green-900/20":""}`,children:[s.jsx("span",{className:`text-sm truncate ${n?"text-green-400 font-bold":"text-gray-300"}`,children:t.player2_id?e(t.player2_id):s.jsx("span",{className:"text-gray-600 italic",children:"Bye"})}),n&&s.jsx(Ga,{className:"w-3 h-3 text-yellow-500"})]})]})},_Ie=({isOpen:t,onClose:e,tournamentName:r,winnerName:n,stats:i})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fade-in",children:s.jsxs("div",{className:"relative bg-gradient-to-b from-gray-900 to-black border border-yellow-500/30 rounded-2xl max-w-md w-full p-8 shadow-2xl shadow-yellow-900/20 text-center overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-yellow-500 to-transparent opacity-50"}),s.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-yellow-500/10 rounded-full blur-3xl"}),s.jsx("div",{className:"absolute -bottom-10 -left-10 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl"}),s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:s.jsx(Sd,{className:"w-5 h-5"})}),s.jsxs("div",{className:"mb-6 relative",children:[s.jsx("div",{className:"mx-auto w-20 h-20 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg shadow-yellow-500/30 mb-4 animate-bounce-slow",children:s.jsx(Ga,{className:"w-10 h-10 text-black fill-current"})}),s.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-300 uppercase tracking-widest mb-1 filter drop-shadow-sm",children:"Champion"}),s.jsx("p",{className:"text-yellow-500/80 text-xs font-bold uppercase tracking-widest",children:r})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50 mb-8 backdrop-blur-sm",children:[s.jsx("div",{className:"text-4xl font-bold text-white mb-2 tracking-tight",children:n||"Unknown Winner"}),s.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Score"}),s.jsx("div",{className:"text-xl font-mono text-yellow-500 font-bold",children:i?.score||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Wins"}),s.jsx("div",{className:"text-xl font-mono text-green-400 font-bold",children:i?.wins||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Losses"}),s.jsx("div",{className:"text-xl font-mono text-red-400 font-bold",children:i?.losses||0})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{className:"w-full py-3 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 shadow-lg",onClick:()=>alert("Sharing implemented soon!"),children:[s.jsx(WF,{className:"w-4 h-4"})," Share Victory"]}),s.jsx("button",{onClick:e,className:"w-full py-3 bg-gray-800 text-gray-400 font-bold rounded-xl hover:bg-gray-700 hover:text-white transition-colors",children:"Close"})]})]})}):null,CIe=()=>{const{id:t}=Eo(),e=dn(),{user:r,userProfile:n}=Sr(),[i,a]=b.useState(null),[o,l]=b.useState("pairings"),[c,u]=b.useState(!0),[f,p]=b.useState(null),[x,m]=b.useState(""),[y,v]=b.useState(""),[j,N]=b.useState([]),[C,A]=b.useState(!1),[L,O]=b.useState(null),[F,T]=b.useState({isOpen:!1,type:null,title:"",message:""}),[I,B]=b.useState(!1);b.useEffect(()=>{t&&($(),k())},[t]);const $=async()=>{try{u(!0);const W=await Ze.get(`/api/tournaments/${t}`);a(W)}catch(W){p(W.message)}finally{u(!1)}},k=async()=>{try{const W=await Ze.get("/api/friends");N(W.friends||[])}catch(W){console.error("Failed to load friends",W)}},R=async W=>{W.preventDefault();try{await Ze.post(`/api/tournaments/${t}/participants`,{userId:x||null,guestName:y||null}),m(""),v(""),$()}catch{alert("Failed to add participant")}},P=()=>{T({isOpen:!0,type:"START",title:"Start Tournament?",message:"This will generate Round 1 pairings. Ensure all players are added."})},q=async()=>{try{await Ze.post(`/api/tournaments/${t}/start`),$(),T({isOpen:!1})}catch{alert("Failed to start tournament")}},X=()=>{T({isOpen:!0,type:"NEXT_ROUND",title:"Generate Next Round?",message:"This will lock current round results and generate new pairings."})},G=async()=>{try{const W=await Ze.post(`/api/tournaments/${t}/next-round`);if($(),T({isOpen:!1}),W.completed){const U=await Ze.get(`/api/tournaments/${t}`),Y=U.participants&&U.participants[0];Y&&(O(Y),A(!0))}}catch{alert("Failed to generate next round. Make sure all matches are finished.")}},ne=()=>{F.type==="START"&&q(),F.type==="NEXT_ROUND"&&G()},ee=i&&i.status==="active"&&i.currentPairings&&i.currentPairings.every(W=>W.winner_id||W.is_draw);console.log("[TournamentDetail] Auth Debug:",{userId:n?.id,organizerId:i?.organizer_id,match:String(n?.id)===String(i?.organizer_id)});const se=n?.id&&i?.organizer_id&&String(n.id)===String(i.organizer_id);if(c)return s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Tournament..."});if(f)return s.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",f]});if(!i)return null;const J=`${window.location.origin}/tournaments/${t}/join`;return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("button",{onClick:()=>e("/social?tab=tournaments"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[s.jsx(FF,{className:"w-4 h-4 mr-2"})," Back to Arena"]}),s.jsx("div",{className:"bg-gray-800 rounded-xl p-6 mb-6 border border-gray-700 shadow-lg",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h1",{className:"text-3xl font-bold text-white",children:i.name}),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${i.status==="active"?"bg-green-500/20 text-green-400 border border-green-500/50":i.status==="completed"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-gray-600/50 text-gray-400 border border-gray-600"}`,children:i.status})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"w-4 h-4 text-yellow-500"}),i.format.toUpperCase()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qF,{className:"w-4 h-4 text-blue-400"}),"Round ",i.current_round]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(u0,{className:"w-4 h-4 text-purple-400"}),i.participants?.length||0," Players"]})]}),i.status==="pending"&&s.jsxs("button",{onClick:()=>B(!0),className:"mt-4 text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2",children:[s.jsx(u0,{className:"w-4 h-4"})," Show Join QR Code"]})]}),i.status==="pending"&&se&&s.jsxs("button",{onClick:P,disabled:i.participants?.length<2,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-green-500/20",children:[s.jsx(J3,{className:"w-5 h-5 fill-current"}),"Start Tournament"]}),i.status==="active"&&se&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("button",{onClick:X,disabled:!ee,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-blue-500/20",children:[s.jsx(Nx,{className:"w-5 h-5"}),"Next Round"]})}),se&&s.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to DELETE this tournament? This cannot be undone."))try{await Ze.delete(`/api/tournaments/${t}`),e("/tournaments")}catch{alert("Failed to delete tournament")}},className:"flex items-center gap-2 px-4 py-3 bg-red-900/30 hover:bg-red-900/50 text-red-400 border border-red-900/50 rounded-lg transition-all ml-2",title:"Delete Tournament",children:[s.jsx(Bae,{className:"w-5 h-5"}),s.jsx("span",{className:"hidden md:inline",children:"Delete"})]})]})}),i.settings?.total_rounds&&s.jsxs("div",{className:"mb-4 text-xs text-gray-500 text-right",children:["Playing best of ",i.settings.total_rounds," Rounds"]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"lg:col-span-3",children:[s.jsxs("div",{className:"flex border-b border-gray-700 mb-6",children:[s.jsx("button",{onClick:()=>l("pairings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="pairings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Pairings"}),s.jsx("button",{onClick:()=>l("standings"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="standings"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Standings"}),(i.format==="elimination"||i.settings?.mode==="elimination")&&s.jsx("button",{onClick:()=>l("bracket"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${o==="bracket"?"border-yellow-500 text-yellow-500":"border-transparent text-gray-400 hover:text-white"}`,children:"Bracket"})]}),o==="pairings"&&s.jsx(jIe,{tournamentId:t,round:i.current_round,initialPairings:i.currentPairings,participants:i.participants,onUpdate:$,isPending:i.status==="pending",isOrganizer:se}),o==="standings"&&s.jsx(NIe,{participants:i.participants,tournamentId:t,currentUserId:r?.id,isOrganizer:se,onUpdate:$}),o==="bracket"&&s.jsx(kIe,{pairings:i.allPairings,participants:i.participants})]}),s.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[i.status==="pending"&&s.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx(AIe,{})," Add Player"]}),s.jsxs("form",{onSubmit:R,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"From Friends"}),s.jsxs("select",{value:x,onChange:W=>{m(W.target.value),v("")},className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none",children:[s.jsx("option",{value:"",children:"Select Friend..."}),j.map(W=>s.jsx("option",{value:W.id,children:W.username},W.id))]})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs font-bold",children:"- OR -"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:"Guest Name"}),s.jsx("input",{type:"text",value:y,onChange:W=>{v(W.target.value),m("")},placeholder:"Enter Name...",className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-2 text-white text-sm focus:border-yellow-500 outline-none"})]}),s.jsx("button",{type:"submit",disabled:!x&&!y,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 text-white font-bold rounded-lg text-sm transition-colors disabled:opacity-50",children:"Add Participant"})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Players"}),s.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:i.participants&&i.participants.length>0?i.participants.map((W,U)=>s.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400 flex-shrink-0",children:U+1}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-300 truncate",children:W.username||W.guest_name}),W.deck_snapshot&&s.jsx("span",{className:"text-xs text-blue-400 truncate",children:W.deck_snapshot.name})]})]}),s.jsxs("div",{className:"text-xs font-mono text-gray-500",children:[W.score,"pts"]})]},W.id)):s.jsx("div",{className:"text-center text-gray-500 text-sm py-4 italic",children:"No players yet."})})]})]})]}),s.jsx(DH,{isOpen:F.isOpen,onClose:()=>T({...F,isOpen:!1}),onConfirm:ne,title:F.title,message:F.message}),s.jsx(_Ie,{isOpen:C,onClose:()=>A(!1),tournamentName:i.name,winnerName:L?.username||L?.guest_name,stats:L}),I&&s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl max-w-sm w-full p-6 border border-gray-700 relative shadow-2xl",children:[s.jsx("button",{onClick:()=>B(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2 text-center",children:"Join Tournament"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6 text-center",children:"Scan to join on your device"}),s.jsx("div",{className:"bg-white p-4 rounded-lg mx-auto w-fit mb-6",children:s.jsx(Nw,{value:J,size:200})}),s.jsxs("div",{className:"bg-gray-900 rounded p-3 flex items-center gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:J,className:"bg-transparent text-gray-400 text-xs w-full outline-none"}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(J),className:"text-blue-400 hover:text-white text-xs font-bold",children:"COPY"})]})]})})]})},AIe=()=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),s.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),s.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]}),t$=()=>{const{id:t}=Eo(),[e,r]=b.useState([]),[n,i]=b.useState(!0),[a,o]=b.useState(!1);dn(),b.useEffect(()=>{t||l()},[t]);const l=async()=>{try{const c=await Ze.get("/api/tournaments");r(c||[])}catch(c){console.error("Failed to fetch tournaments",c)}finally{i(!1)}};return t?s.jsx(CIe,{}):n?s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading Arena..."}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Ga,{className:"w-8 h-8 text-yellow-500"}),"The Arena"]}),s.jsx("p",{className:"text-gray-400 mt-1",children:"Organize tournaments and track competitive standings."})]}),s.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold rounded-lg transition-colors",children:[s.jsx(bae,{className:"w-5 h-5"}),"New Tournament"]})]}),e.length===0?s.jsxs("div",{className:"text-center py-20 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(Ga,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-300",children:"No Tournaments Yet"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"Create your first event to start tracking games!"}),s.jsx("button",{onClick:()=>o(!0),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Create Event"})]}):s.jsx(EX,{tournaments:e}),s.jsx(TX,{isOpen:a,onClose:()=>o(!1)})]})},EIe=()=>{const{id:t}=Eo(),e=dn(),{user:r}=Sr(),[n,i]=b.useState(null),[a,o]=b.useState([]),[l,c]=b.useState(""),[u,f]=b.useState(!0),[p,x]=b.useState(!1),[m,y]=b.useState(null);b.useEffect(()=>{v()},[t]);const v=async()=>{try{const[N,C]=await Promise.all([Ze.get(`/api/tournaments/${t}`),Ze.get("/api/decks")]);i(N.data),o(C.data)}catch{y("Failed to load tournament info.")}finally{f(!1)}},j=async()=>{x(!0);try{await Ze.post(`/api/tournaments/${t}/join`,{deckId:l||null}),e(`/tournaments/${t}`)}catch(N){alert(N.response?.data?.error||"Failed to join tournament"),x(!1)}};return u?s.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading..."}):m?s.jsx("div",{className:"p-8 text-center text-red-500",children:m}):s.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-gray-800 rounded-xl border border-gray-700 shadow-2xl",children:[s.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:n.name}),s.jsxs("p",{className:"text-gray-400 mb-6",children:["Format: ",s.jsx("span",{className:"capitalize text-blue-400",children:n.format})]}),n.status!=="pending"?s.jsxs("div",{className:"text-center py-6 bg-gray-900/50 rounded-lg border border-red-500/30",children:[s.jsx("p",{className:"text-red-400",children:"This tournament is already active or completed."}),s.jsx("button",{onClick:()=>e(`/tournaments/${t}`),className:"mt-4 text-blue-400 hover:text-blue-300",children:"View Tournament"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Deck (Optional)"}),s.jsxs("select",{value:l,onChange:N=>c(N.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"No Deck / Decide Later"}),a.map(N=>s.jsxs("option",{value:N.id,children:[N.name," (",N.format||"Standard",")"]},N.id))]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Selecting a deck locks in your list for this tournament."})]}),s.jsx("button",{onClick:j,disabled:p,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-all flex items-center justify-center gap-2",children:p?"Joining...":"Join Tournament"})]})]})},Fa=[];for(let t=0;t<256;++t)Fa.push((t+256).toString(16).slice(1));function TIe(t,e=0){return(Fa[t[e+0]]+Fa[t[e+1]]+Fa[t[e+2]]+Fa[t[e+3]]+"-"+Fa[t[e+4]]+Fa[t[e+5]]+"-"+Fa[t[e+6]]+Fa[t[e+7]]+"-"+Fa[t[e+8]]+Fa[t[e+9]]+"-"+Fa[t[e+10]]+Fa[t[e+11]]+Fa[t[e+12]]+Fa[t[e+13]]+Fa[t[e+14]]+Fa[t[e+15]]).toLowerCase()}let O3;const LIe=new Uint8Array(16);function OIe(){if(!O3){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");O3=crypto.getRandomValues.bind(crypto)}return O3(LIe)}const MIe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),r$={randomUUID:MIe};function nx(t,e,r){if(r$.randomUUID&&!t)return r$.randomUUID();t=t||{};const n=t.random??t.rng?.()??OIe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,TIe(n)}function LX(t){if(!t)return{};const e={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},r=t.match(/\{([^}]+)\}/g);return r&&r.forEach(n=>{const i=n.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(i)?e[i]++:isNaN(i)||(e.generic+=parseInt(i))}),e}function PIe(t,e){if(!e)return!0;const r=LX(e),n={...t};for(const a of["w","u","b","r","g","c"]){if(n[a]<r[a])return!1;n[a]-=r[a]}return Object.values(n).reduce((a,o)=>a+o,0)>=r.generic}function IIe(t,e){const r=LX(e),n={...t};["w","u","b","r","g","c"].forEach(o=>{n[o]-=r[o]});let i=r.generic;const a=["c","w","u","b","r","g"];for(const o of a){const l=Math.min(n[o],i);if(n[o]-=l,i-=l,i<=0)break}return n}const gx={zones:{library:[],hand:[],battlefield:[],graveyard:[],exile:[],command:[]},counters:{life:40,poison:0,commanderDamage:{},energy:0},turn:{count:1,phase:"Untap",landsPlayed:0},manaPool:{w:0,u:0,b:0,r:0,g:0,c:0},commanderTax:{},ui:{selectedIds:[],draggingId:null,error:null},past:[]},M3=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function Qo(t,e){const r=[...t.past||[],{...t,past:[]}].slice(-20);return{...e,past:r}}function RIe(t,e){return!e||e.includes("Instant")||e.includes("Creature")&&e.includes("Flash")?!0:t==="Main 1"||t==="Main 2"}function DIe(t,e){switch(e.type){case"UNDO":return!t.past||t.past.length===0?t:{...t.past[t.past.length-1],past:t.past.slice(0,-1)};case"LOAD_DECK":{const{mainboard:r,commander:n}=e.payload,i=r.map(o=>({...o,id:nx(),instanceId:nx(),tapped:!1,faceDown:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})),a=n?n.map(o=>({...o,id:nx(),instanceId:nx(),tapped:!1,faceDown:!1,isCommander:!0,summoningSickness:!1,counters:{p1p1:0,loyalty:0,other:0}})):[];return{...gx,zones:{...gx.zones,library:o1(i),command:a},commanderTax:a.reduce((o,l)=>({...o,[l.instanceId]:0}),{})}}case"DRAW_CARD":{const{count:r=1}=e.payload||{},n=[...t.zones.library],i=[...t.zones.hand];let a=null;for(let o=0;o<r;o++)if(n.length>0){const l=n.pop();l.faceDown=!1,i.push(l)}else a="Library is empty! You lose the game (if this were a real game).";return Qo(t,{...t,ui:{...t.ui,error:a},zones:{...t.zones,library:n,hand:i}})}case"MOVE_CARD":{const{cardId:r,fromZone:n,toZone:i,index:a,position:o}=e.payload,l=[...t.zones[n]],c=[...t.zones[i]],u=l.findIndex(v=>v.instanceId===r);if(u===-1)return t;const[f]=l.splice(u,1);let p=t.manaPool,x=t.turn.landsPlayed,m={...t.commanderTax};if((n==="hand"||n==="command")&&i==="battlefield"){const v=f.type_line&&f.type_line.includes("Land");if(!RIe(t.turn.phase,f.type_line))return{...t,ui:{...t.ui,error:`Can only play ${f.name} during your Main phase.`}};if(v){if(x>=1)return{...t,ui:{...t.ui,error:"Only one land per turn allowed."}};x++}else{let j=f.mana_cost;if(f.isCommander&&n==="command"){const N=m[f.instanceId]||0;N>0&&(j=`${j}{${N*2}}`)}if(!PIe(t.manaPool,j))return{...t,ui:{...t.ui,error:`Cannot afford ${f.name}. Cost: ${j}`}};p=IIe(t.manaPool,j),f.isCommander&&n==="command"&&(m[f.instanceId]=(m[f.instanceId]||0)+1)}}const y={...f,faceDown:i==="library",position:o||(i==="battlefield"?f.position:null),summoningSickness:i==="battlefield"&&f.type_line?.includes("Creature")?!0:f.summoningSickness};return typeof a=="number"?c.splice(a,0,y):c.push(y),Qo(t,{...t,manaPool:p,turn:{...t.turn,landsPlayed:x},commanderTax:m,ui:{...t.ui,error:null},zones:{...t.zones,[n]:l,[i]:c}})}case"TAP_CARD":{const{cardId:r,zone:n}=e.payload;let i=[];const a=t.zones[n].map(l=>{if(l.instanceId===r){if(l.summoningSickness&&l.type_line?.includes("Creature"))return l;const c=!l.tapped;if(c){if(l.produced_mana&&l.produced_mana.length>0)i.push(l.produced_mana[0].toLowerCase());else if(l.type_line&&l.type_line.includes("Land")){const u={Plains:"w",Island:"u",Swamp:"b",Mountain:"r",Forest:"g",Wastes:"c"};for(const[f,p]of Object.entries(u))if(l.type_line.includes(f)){i.push(p);break}}}return{...l,tapped:c}}return l}),o={...t.manaPool};return i.forEach(l=>{o[l]!==void 0&&o[l]++}),Qo(t,{...t,ui:{...t.ui,error:null},zones:{...t.zones,[n]:a},manaPool:o})}case"NEXT_PHASE":{let n=M3.indexOf(t.turn.phase)+1,i=t.turn.count,a=!1,o=t.turn.landsPlayed;n>=M3.length&&(n=0,i++,a=!0,o=0);const l=M3[n],c={w:0,u:0,b:0,r:0,g:0,c:0};let u=t.zones.battlefield;return(a||l==="Untap")&&(u=t.zones.battlefield.map(f=>({...f,tapped:!1,summoningSickness:!1}))),Qo(t,{...t,turn:{count:i,phase:l,landsPlayed:o},manaPool:c,ui:{...t.ui,error:null},zones:{...t.zones,battlefield:u}})}case"ADD_MANA":{const{color:r}=e.payload;return Qo(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]+1}})}case"SPEND_MANA":{const{color:r}=e.payload;return t.manaPool[r]<=0?t:Qo(t,{...t,ui:{...t.ui,error:null},manaPool:{...t.manaPool,[r]:t.manaPool[r]-1}})}case"UNTAP_ALL":{const r=t.zones.battlefield.map(n=>({...n,tapped:!1}));return Qo(t,{...t,zones:{...t.zones,battlefield:r}})}case"SHUFFLE_LIBRARY":return Qo(t,{...t,zones:{...t.zones,library:o1([...t.zones.library])}});case"SET_LIFE":return Qo(t,{...t,counters:{...t.counters,life:e.payload}});case"MULLIGAN":{const r=t.zones.hand.map(o=>({...o,faceDown:!0,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}})),n=[...t.zones.library,...r],i=o1(n),a=[];for(let o=0;o<7;o++)if(i.length>0){const l=i.pop();l.faceDown=!1,a.push(l)}return Qo(t,{...t,turn:{...t.turn,landsPlayed:0},ui:{...t.ui,error:null},zones:{...t.zones,hand:a,library:i}})}case"RESTART_GAME":{const r=[...t.zones.hand,...t.zones.battlefield,...t.zones.graveyard,...t.zones.exile].map(a=>({...a,tapped:!1,faceDown:!0,counters:{p1p1:0,loyalty:0,other:0}})),n=o1([...t.zones.library,...r]),i=[];for(let a=0;a<7;a++)if(n.length>0){const o=n.pop();o.faceDown=!1,i.push(o)}return{...gx,zones:{...gx.zones,library:n,hand:i,battlefield:[],graveyard:[],exile:[],command:t.zones.command.map(a=>({...a,tapped:!1,counters:{p1p1:0,loyalty:0,other:0}}))},commanderTax:t.zones.command.reduce((a,o)=>({...a,[o.instanceId]:0}),{})}}case"ADD_COUNTER":{const{cardId:r,zone:n,counterType:i,amount:a=1}=e.payload;return Qo(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[i]:(o.counters[i]||0)+a}}:o)}})}case"REMOVE_COUNTER":{const{cardId:r,zone:n,counterType:i,amount:a=1}=e.payload;return Qo(t,{...t,zones:{...t.zones,[n]:t.zones[n].map(o=>o.instanceId===r?{...o,counters:{...o.counters,[i]:Math.max(0,(o.counters[i]||0)-a)}}:o)}})}case"CREATE_TOKEN":{const{tokenData:r}=e.payload,n={...r,instanceId:nx(),tapped:!1,faceDown:!1,isToken:!0,counters:{p1p1:0,loyalty:0,other:0}};return Qo(t,{...t,zones:{...t.zones,battlefield:[...t.zones.battlefield,n]}})}case"SET_LIFE":return Qo(t,{...t,counters:{...t.counters,life:e.payload}});default:return t}}function o1(t){let e=t.length,r;for(;e!==0;)r=Math.floor(Math.random()*e),e--,[t[e],t[r]]=[t[r],t[e]];return t}function BIe(){const[t,e]=b.useReducer(DIe,gx),r=b.useCallback(u=>e({type:"LOAD_DECK",payload:u}),[]),n=b.useCallback((u=1)=>e({type:"DRAW_CARD",payload:{count:u}}),[]),i=b.useCallback((u,f,p,x,m)=>e({type:"MOVE_CARD",payload:{cardId:u,fromZone:f,toZone:p,index:x,position:m}}),[]),a=b.useCallback((u,f)=>e({type:"TAP_CARD",payload:{cardId:u,zone:f}}),[]),o=b.useCallback(()=>e({type:"UNTAP_ALL"}),[]),l=b.useCallback(()=>e({type:"SHUFFLE_LIBRARY"}),[]),c=b.useCallback(u=>e({type:"SET_LIFE",payload:u}),[]);return{state:t,actions:{loadDeck:r,drawCard:n,moveCard:i,tapCard:a,untapAll:o,shuffleLibrary:l,setLife:c,undo:()=>e({type:"UNDO"}),mulligan:()=>e({type:"MULLIGAN"}),restartGame:()=>e({type:"RESTART_GAME"}),nextPhase:()=>e({type:"NEXT_PHASE"}),addMana:u=>e({type:"ADD_MANA",payload:{color:u}}),spendMana:u=>e({type:"SPEND_MANA",payload:{color:u}}),addCounter:(u,f,p,x)=>e({type:"ADD_COUNTER",payload:{cardId:u,zone:f,counterType:p,amount:x}}),removeCounter:(u,f,p,x)=>e({type:"REMOVE_COUNTER",payload:{cardId:u,zone:f,counterType:p,amount:x}}),createToken:u=>e({type:"CREATE_TOKEN",payload:{tokenData:u}})}}}const OX=b.createContext(null);function $Ie({children:t}){const e=BIe();return s.jsx(OX.Provider,{value:e,children:t})}function V5(){const t=b.useContext(OX);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function FIe({x:t,y:e,onClose:r,actions:n,card:i,zoneId:a}){const o=b.useRef(null);b.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&r()};return window.addEventListener("mousedown",c),()=>window.removeEventListener("mousedown",c)},[r]);const l=c=>{c(),r()};return s.jsxs("div",{ref:o,className:"fixed z-[100] bg-gray-900/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl py-2 min-w-[180px] overflow-hidden",style:{left:t,top:e},children:[s.jsxs("div",{className:"px-4 py-1.5 border-b border-white/5 mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest leading-none",children:"Card Actions"}),s.jsx("div",{className:"text-white text-xs font-bold truncate",children:i.name})]}),s.jsx(sx,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"graveyard")),label:"Destroy / Discard",icon:s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),s.jsx(sx,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"exile")),label:"Exile",icon:s.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx(sx,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"library",0)),label:"Put on Top",icon:s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 11l7-7 7 7M5 19l7-7 7 7"})})}),s.jsx(sx,{onClick:()=>l(()=>n.moveCard(i.instanceId,a,"hand")),label:"Return to Hand",icon:s.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),s.jsx("div",{className:"h-px bg-white/5 my-1"}),s.jsx("div",{className:"px-4 py-1 text-[8px] font-bold text-gray-500 uppercase tracking-widest",children:"Counters"}),s.jsxs("div",{className:"flex px-2 pb-1 gap-1",children:[s.jsx(n$,{label:"+1/+1",onAdd:()=>n.addCounter(i.instanceId,a,"p1p1",1),onSub:()=>n.removeCounter(i.instanceId,a,"p1p1",1)}),s.jsx(n$,{label:"Loyalty",onAdd:()=>n.addCounter(i.instanceId,a,"loyalty",1),onSub:()=>n.removeCounter(i.instanceId,a,"loyalty",1)})]}),s.jsx("div",{className:"h-px bg-white/5 my-1"}),s.jsx(sx,{onClick:()=>l(()=>n.tapCard(i.instanceId,a)),label:i.tapped?"Untap":"Tap",icon:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}function sx({onClick:t,label:e,icon:r}){return s.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-2 text-xs font-bold text-gray-400 hover:text-white hover:bg-white/5 transition-all text-left group",children:[s.jsx("span",{className:"opacity-70 group-hover:opacity-100 transition-opacity",children:r}),s.jsx("span",{children:e})]})}function n$({label:t,onAdd:e,onSub:r}){return s.jsxs("div",{className:"flex-1 flex flex-col items-center bg-white/5 rounded-lg py-1 px-2 border border-white/5",children:[s.jsx("span",{className:"text-[8px] text-gray-500 mb-1",children:t}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-red-500 text-[10px] p-1 font-black",children:""}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-emerald-500 text-[10px] p-1 font-black",children:""})]})]})}function UIe(t,e){if(!e)return!0;const r={w:0,u:0,b:0,r:0,g:0,c:0,generic:0},n=e.match(/\{([^}]+)\}/g);if(!n)return!0;n.forEach(o=>{const l=o.slice(1,-1).toLowerCase();["w","u","b","r","g","c"].includes(l)?r[l]++:isNaN(l)||(r.generic+=parseInt(l))});const i={...t};for(const o of["w","u","b","r","g","c"]){if(i[o]<r[o])return!1;i[o]-=r[o]}return Object.values(i).reduce((o,l)=>o+l,0)>=r.generic}const Yp=b.memo(function({card:e,zoneId:r,isOverlay:n=!1,size:i="md"}){const{state:a,actions:o}=V5(),[l,c]=b.useState(null),u=r==="hand"||n&&e.fromZone==="hand",f=e.type_line&&e.type_line.includes("Land"),p=b.useMemo(()=>u&&!f&&UIe(a.manaPool,e.mana_cost),[u,f,a.manaPool,e.mana_cost]),x=b.useMemo(()=>u&&f&&a.turn.landsPlayed<1,[u,f,a.turn.landsPlayed]),{attributes:m,listeners:y,setNodeRef:v,transform:j,isDragging:N}=YU({id:e.instanceId,data:{card:e,fromZone:r},disabled:n}),C=j?{transform:`translate3d(${j.x}px, ${j.y}px, 0)`,zIndex:1e3,willChange:"transform"}:{willChange:"transform"},A=I=>{I.preventDefault(),c({x:I.clientX,y:I.clientY})},L=I=>{N||o.tapCard(e.instanceId,r)},O={sm:"w-32 h-44 rounded-xl",md:"w-40 h-56 rounded-[1.5rem]",lg:"w-48 h-64 rounded-[2rem]",tactical:"w-44 h-60 rounded-2xl"},F=i||(r==="battlefield"?"tactical":r==="hand"?"md":"sm"),T=e.tapped?"rotate-90 translate-x-8":"";return s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:n?null:v,style:C,...n?{}:y,...n?{}:m,onClick:n?void 0:L,onContextMenu:n?void 0:A,className:`
                    relative ${O[F]} bg-gray-900 border-2 transition-all duration-300
                    ${n?"border-indigo-500 shadow-2xl scale-110":"border-white/10 shadow-lg"}
                    ${e.isToken?"border-dashed border-emerald-500/50":""}
                    ${(p||x)&&!N?"ring-4 ring-emerald-500/30":""}
                    hover:border-indigo-500/50 hover:shadow-indigo-500/40 hover:scale-[1.05] 
                    cursor-grab active:cursor-grabbing group z-[10] hover:z-[50]
                    ${T}
                    ${N?"opacity-0":"opacity-100"}
                `,children:[s.jsx(zIe,{card:e,isOverlay:n,size:F,zoneId:r}),(p||x)&&!N&&s.jsx("div",{className:"absolute inset-0 rounded-inherit bg-emerald-500/5 animate-pulse pointer-events-none"})]}),l&&s.jsx(FIe,{x:l.x,y:l.y,onClose:()=>c(null),actions:o,card:e,zoneId:r})]})}),zIe=b.memo(function({card:e,isOverlay:r,size:n,zoneId:i}){const{state:a}=V5(),o=e.counters?.p1p1||0,l=e.counters?.loyalty||0;e.counters?.other;const c=e.power!==void 0&&e.toughness!==void 0,{currentPower:u,currentToughness:f}=b.useMemo(()=>{const x=parseInt(e.power),m=parseInt(e.toughness);return{currentPower:c?isNaN(x)?e.power:x+o:null,currentToughness:c?isNaN(m)?e.toughness:m+o:null}},[e.power,e.toughness,c,o]),p=n==="lg"||n==="tactical"||n==="md";return s.jsxs("div",{className:"w-full h-full relative pointer-events-none select-none overflow-hidden rounded-inherit",children:[e.faceDown?s.jsxs("div",{className:"w-full h-full bg-indigo-950 rounded-inherit flex items-center justify-center border-4 border-white/5 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20"}),s.jsx("div",{className:`${p?"w-24 h-24":"w-16 h-16"} rounded-full border-2 border-white/20 bg-indigo-900/30 backdrop-blur-md flex items-center justify-center shadow-2xl`,children:s.jsx("div",{className:`${p?"w-16 h-16":"w-10 h-10"} rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 opacity-50 blur-sm animate-pulse`})})]}):s.jsxs("div",{className:"w-full h-full overflow-hidden rounded-inherit relative bg-gray-950 flex flex-col",children:[e.image_uri?s.jsx("img",{src:e.image_uri,alt:e.name,loading:"lazy",onError:x=>{x.target.onerror=null,x.target.src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/card-back.svg",x.target.style.opacity=.5},className:"w-full h-full object-cover select-none pointer-events-none"}):s.jsxs("div",{className:"p-4 text-xs text-gray-400 font-bold uppercase tracking-tighter bg-gray-900 h-full flex flex-col items-center justify-center text-center",children:[s.jsx("span",{className:"text-white text-sm mb-1",children:e.name}),e.type_line&&s.jsx("span",{className:"opacity-50 text-[10px] leading-tight",children:e.type_line})]}),e.isToken&&s.jsx("div",{className:`absolute top-0 right-0 bg-emerald-600 ${p?"text-[10px] px-3 py-1":"text-[8px] px-2 py-0.5"} font-black text-white rounded-bl-xl shadow-md uppercase tracking-widest z-20 border-l border-b border-white/10`,children:"Token"}),s.jsxs("div",{className:"absolute bottom-2 right-2 flex flex-col gap-2 z-30",children:[e.tapped&&s.jsx("div",{className:`${p?"w-8 h-8":"w-6 h-6"} rounded-full bg-amber-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:s.jsx("svg",{className:`${p?"w-5 h-5":"w-4 h-4"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M4.555 13.791L14.17 9.852l-1.474-3.56L3.081 10.23l1.474 3.561z"})})}),e.summoningSickness&&e.type_line?.includes("Creature")&&s.jsx("div",{className:`${p?"w-8 h-8":"w-6 h-6"} rounded-full bg-indigo-500/90 backdrop-blur-xl flex items-center justify-center shadow-2xl border border-white/20 animate-in zoom-in duration-300`,children:s.jsx("span",{className:`${p?"text-sm":"text-xs"} font-black text-white italic`,children:"zZz"})})]}),c&&s.jsx("div",{className:`absolute ${p?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:s.jsxs("div",{className:`bg-black/80 backdrop-blur-xl border-2 border-white/20 rounded-xl ${p?"px-3 py-1.5 gap-2":"px-2 py-1 gap-1"} flex items-center shadow-2xl transition-transform group-hover:scale-110`,children:[s.jsx("span",{className:`${p?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:u}),s.jsx("span",{className:"text-gray-500 font-black",children:"/"}),s.jsx("span",{className:`${p?"text-lg":"text-sm"} font-black italic tracking-tighter ${o>0?"text-emerald-400":o<0?"text-red-400":"text-white"}`,children:f})]})}),e.type_line?.includes("Planeswalker")&&s.jsx("div",{className:`absolute ${p?"bottom-2 left-2":"bottom-1 left-1"} z-40`,children:s.jsxs("div",{className:`bg-orange-600/90 backdrop-blur-xl border-2 border-white/20 rounded-xl ${p?"px-3 py-1 gap-2":"px-2 py-0.5 gap-1"} flex items-center shadow-2xl`,children:[s.jsx("svg",{className:`${p?"w-5 h-5":"w-3 h-3"} text-white`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M10 2l-7 7 7 7 7-7-7-7z"})}),s.jsx("span",{className:`${p?"text-xl":"text-base"} font-black text-white italic tracking-tighter`,children:l||e.loyalty})]})}),s.jsxs("div",{className:`absolute ${p?"top-2 left-2 gap-2":"top-1 left-1 gap-1"} flex flex-col z-30 pointer-events-none`,children:[o!==0&&s.jsxs("div",{className:`bg-indigo-600 text-white rounded-xl ${p?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2 animate-in slide-in-from-left-4 duration-300`,children:[s.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Counters"}),s.jsx("span",{className:p?"text-sm":"text-xs",children:o>0?`+${o}`:o})]}),e.isCommander&&i==="command"&&s.jsxs("div",{className:`bg-red-600 text-white rounded-xl ${p?"px-2.5 py-1 text-xs":"px-1.5 py-0.5 text-[10px]"} font-black shadow-2xl border-2 border-white/20 flex items-center gap-2`,children:[s.jsx("span",{className:"opacity-70 text-[10px] uppercase tracking-tighter hidden md:inline",children:"Tax"}),s.jsxs("span",{className:p?"text-sm":"text-xs",children:["+",(a.commanderTax?.[e.instanceId]||0)*2]})]})]})]}),!r&&!e.faceDown&&s.jsx("div",{className:"absolute inset-0 bg-indigo-500/0 group-hover:bg-indigo-500/5 transition-colors pointer-events-none rounded-inherit"})]})}),Ip=b.memo(function({id:e,cards:r,title:n,className:i="",layout:a="grid",onCardClick:o}){const{isOver:l,setNodeRef:c}=XU({id:e}),u={opacity:l?.9:1};return s.jsxs("div",{ref:c,className:`relative rounded-2xl transition-all ${i} ${l?"ring-2 ring-emerald-500/50 bg-emerald-500/5":""}`,style:u,children:[s.jsx("div",{className:"absolute -top-3 left-4 bg-gray-950 px-2 text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] z-10 border border-white/5 rounded-full",children:n}),s.jsxs("div",{className:`w-full h-full p-4 ${a==="spread"?"flex items-center gap-[-4rem]":""} ${a==="stacked"?"relative flex items-center justify-center":""}`,children:[a==="stacked"&&s.jsxs("div",{className:"relative w-36 h-52",children:[r.slice(-3).map((f,p)=>s.jsx("div",{className:"absolute inset-0 transition-transform",style:{transform:`translate(${p*2}px, ${p*2}px)`,zIndex:p},children:s.jsx(Yp,{card:f,zoneId:e})},f.instanceId)),r.length===0&&s.jsx("div",{className:"w-full h-full border-2 border-dashed border-white/5 rounded-xl flex items-center justify-center text-[10px] font-black text-gray-800 uppercase tracking-widest",children:"Empty"})]}),a==="spread"&&s.jsx("div",{className:"flex -space-x-24 hover:-space-x-12 transition-all duration-500 py-8 px-12 overflow-x-auto no-scrollbar",children:r.map(f=>s.jsx("div",{className:"shrink-0 first:ml-0 transition-transform hover:-translate-y-8 hover:z-50",children:s.jsx(Yp,{card:f,zoneId:e})},f.instanceId))}),(a==="grid"||a==="free")&&s.jsx("div",{className:`w-full h-full ${a==="free"?"relative":"flex flex-wrap gap-12"}`,children:r.map((f,p)=>a==="free"&&f.position?s.jsx("div",{className:"absolute transition-shadow active:z-[1000]",style:{left:f.position.x,top:f.position.y,zIndex:10+p},children:s.jsx(Yp,{card:f,zoneId:e})},f.instanceId):s.jsx("div",{className:a==="free"?"absolute":"",style:a==="free"?{left:p%4*200,top:Math.floor(p/4)*280}:{},children:s.jsx(Yp,{card:f,zoneId:e})},f.instanceId))}),r.length===0&&a!=="stacked"&&s.jsxs("div",{className:"w-full h-full flex items-center justify-center text-gray-800 text-xs font-black uppercase tracking-[0.3em] select-none opacity-20",children:[n," Void"]})]})]})}),qIe=b.memo(function({state:e,onCardClick:r}){const{zones:n}=e;return s.jsxs("div",{className:"flex flex-col h-full gap-4 p-4 bg-[radial-gradient(circle_at_50%_-20%,_#1e1b4b_0%,_#020617_100%)] rounded-3xl border border-white/5 shadow-inner relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10 pointer-events-none"}),s.jsxs("div",{className:"flex h-56 gap-6 shrink-0 z-10",children:[s.jsx(Ip,{id:"command",cards:n.command,title:"Command Zone",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r}),s.jsx(Ip,{id:"exile",cards:n.exile,title:"Exile",className:"w-64 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",onCardClick:r})]}),s.jsxs("div",{className:"flex-grow bg-emerald-500/5 rounded-3xl border-2 border-dashed border-emerald-500/10 p-6 relative min-h-[400px] shadow-inner group",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none group-hover:opacity-[0.05] transition-opacity",children:s.jsx("span",{className:"text-[200px] font-black uppercase tracking-tighter rotate-[-15deg]",children:"Battlefield"})}),s.jsx(Ip,{id:"battlefield",cards:n.battlefield,title:"Battlefield",className:"h-full w-full border-none",layout:"free",onCardClick:r})]}),s.jsxs("div",{className:"h-72 flex gap-6 shrink-0 z-10",children:[s.jsx("div",{className:"flex-grow bg-white/5 backdrop-blur-md rounded-2xl border border-white/10 p-4 shadow-xl",children:s.jsx(Ip,{id:"hand",cards:n.hand,title:"Hand",layout:"spread",className:"h-full w-full border-none",onCardClick:r})}),s.jsxs("div",{className:"w-80 flex gap-4",children:[s.jsx(Ip,{id:"library",cards:n.library,title:`Library (${n.library.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r}),s.jsx(Ip,{id:"graveyard",cards:n.graveyard,title:`Graveyard (${n.graveyard.length})`,className:"w-1/2 bg-white/5 backdrop-blur-sm border-white/10 hover:border-white/20",layout:"stacked",onCardClick:r})]})]})]})}),s$=["Untap","Upkeep","Draw","Main 1","Combat","Main 2","End"];function HIe({currentPhase:t,turnCount:e,landsPlayed:r,onNextPhase:n}){return s.jsxs("div",{className:"flex items-center bg-gray-900/80 backdrop-blur-md rounded-2xl border border-white/10 px-4 py-2 shadow-2xl relative overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500/5 via-purple-500/5 to-pink-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),s.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[s.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Turn"}),s.jsx("span",{className:"text-xl font-black text-white italic leading-none",children:e})]}),s.jsxs("div",{className:"flex flex-col items-center border-r border-white/10 pr-4",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] leading-none mb-1",children:"Lands"}),s.jsxs("span",{className:`text-xl font-black italic leading-none ${r>=1?"text-amber-500":"text-emerald-400"}`,children:[r,"/1"]})]}),s.jsx("div",{className:"flex items-center gap-1 md:gap-2",children:s$.map((i,a)=>{const o=t===i,l=s$.indexOf(t)>a;return s.jsxs("div",{className:`flex flex-col items-center transition-all duration-300 ${o?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`h-1.5 w-8 md:w-12 rounded-full mb-2 transition-all duration-500 ${o?"bg-gradient-to-r from-indigo-500 to-purple-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]":l?"bg-indigo-900/40":"bg-gray-800"}`}),s.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest ${o?"text-indigo-400":"text-gray-500"}`,children:i})]},i)})}),s.jsx("button",{onClick:n,className:"ml-2 w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/20 transition-all hover:scale-110 active:scale-95 group/btn",title:"Next Phase (Space)",children:s.jsx("svg",{className:"w-5 h-5 transition-transform group-hover/btn:translate-x-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 5l7 7-7 7"})})})]})]})}const WIe=[{name:"Soldier",power:1,toughness:1,color:"W",type:"Token Creature  Soldier"},{name:"Zombie",power:2,toughness:2,color:"B",type:"Token Creature  Zombie"},{name:"Knight",power:2,toughness:2,color:"W",type:"Token Creature  Knight",keywords:["Vigilance"]},{name:"Spirit",power:1,toughness:1,color:"U",type:"Token Creature  Spirit",keywords:["Flying"]},{name:"Goblin",power:1,toughness:1,color:"R",type:"Token Creature  Goblin"},{name:"Beast",power:3,toughness:3,color:"G",type:"Token Creature  Beast"},{name:"Treasure",power:0,toughness:0,color:"C",type:"Token Artifact  Treasure",text:"T, Sacrifice this artifact: Add one mana of any color."},{name:"Clue",power:0,toughness:0,color:"C",type:"Token Artifact  Clue",text:"2, Sacrifice this artifact: Draw a card."},{name:"Food",power:0,toughness:0,color:"C",type:"Token Artifact  Food",text:"2, T, Sacrifice this artifact: You gain 3 life."}];function GIe({isOpen:t,onClose:e,onCreateToken:r}){const[n,i]=b.useState({name:"",power:0,toughness:0,type:"Token Creature",color:"C"});return t?s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex items-center justify-between bg-white/5",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Generator Engine"}),s.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-widest",children:"Create Tokens & Emblems"})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl text-gray-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Common Presets"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:WIe.map(a=>s.jsxs("button",{onClick:()=>r(a),className:"flex flex-col items-start p-4 bg-white/5 border border-white/5 hover:border-indigo-500/50 hover:bg-indigo-500/5 rounded-2xl transition-all group",children:[s.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-black/40 border border-white/10 flex items-center justify-center text-[10px] font-black group-hover:scale-110 transition-transform",children:a.color}),a.power>0&&s.jsxs("span",{className:"text-xs font-black text-gray-400 group-hover:text-white transition-colors",children:[a.power,"/",a.toughness]})]}),s.jsx("span",{className:"text-sm font-bold text-white mb-1",children:a.name}),s.jsx("span",{className:"text-[10px] text-gray-500 truncate w-full text-left italic",children:a.type})]},a.name))})]}),s.jsxs("section",{className:"bg-white/5 p-6 rounded-3xl border border-white/5",children:[s.jsx("h3",{className:"text-xs font-black text-emerald-400 uppercase tracking-widest mb-4",children:"Manual Synthesis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Identifier"}),s.jsx("input",{type:"text",value:n.name,onChange:a=>i({...n,name:a.target.value}),placeholder:"Token Name...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Power"}),s.jsx("input",{type:"number",value:n.power,onChange:a=>i({...n,power:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Toughness"}),s.jsx("input",{type:"number",value:n.toughness,onChange:a=>i({...n,toughness:parseInt(a.target.value)||0}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Type Line"}),s.jsx("input",{type:"text",value:n.type,onChange:a=>i({...n,type:a.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsx("button",{onClick:()=>r(n),disabled:!n.name,className:"w-full bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 text-white font-black uppercase tracking-widest py-3 rounded-2xl shadow-xl shadow-emerald-900/20 transition-all active:scale-95",children:"Synthesize Token"})]})]})]})]})]})]}):null}function VIe({isOpen:t,zoneId:e,onClose:r}){const{state:n,actions:i}=V5();if(!t||!e)return null;const a=n.zones[e]||[];return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:r}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-[3rem] shadow-2xl w-full max-w-6xl overflow-hidden flex flex-col max-h-[85vh]",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 flex items-center justify-between bg-white/5",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-2xl bg-indigo-600 flex items-center justify-center text-white shadow-lg",children:s.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic",children:["Inspecting ",e]}),s.jsxs("p",{className:"text-gray-500 text-xs font-black uppercase tracking-widest",children:[a.length," Objects Detected"]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[e==="library"&&s.jsx("button",{onClick:()=>i.shuffleLibrary(),className:"px-6 py-3 bg-white/5 hover:bg-white/10 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all border border-white/10",children:"Shuffle Library"}),s.jsx("button",{onClick:r,className:"p-3 hover:bg-white/10 rounded-2xl text-gray-400 transition-colors",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-grow overflow-y-auto p-12 bg-black/20",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-x-8 gap-y-12",children:a.map((o,l)=>s.jsxs("div",{className:"flex flex-col items-center gap-4 group",children:[s.jsx("div",{className:"transform transition-all group-hover:scale-110 group-hover:-translate-y-2",children:s.jsx(Yp,{card:{...o,faceDown:!1},zoneId:e})}),s.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0",children:[s.jsx("button",{onClick:()=>i.moveCard(o.instanceId,e,"hand"),className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Move to Hand",children:"Hand"}),s.jsx("button",{onClick:()=>i.moveCard(o.instanceId,e,"battlefield"),className:"bg-emerald-600 hover:bg-emerald-500 text-white p-2 rounded-lg text-[10px] font-black uppercase tracking-tighter",title:"Play Directly",children:"Play"})]})]},o.instanceId))})})]})]})}function YIe(){return s.jsx($Ie,{children:s.jsx(KIe,{})})}function KIe(){const{deckId:t}=Eo();dn();const{state:e,actions:r}=V5(),{deck:n,cards:i,loading:a}=PC(t),[o,l]=b.useState(!1),[c,u]=b.useState(null),[f,p]=b.useState(!1),[x,m]=b.useState(null),[y,v]=b.useState({x:32,y:120,isMinimized:!1,isVisible:!0}),[j,N]=b.useState({x:window.innerWidth-240,y:window.innerHeight-300,isMinimized:!1,isVisible:!0}),[C,A]=b.useState({x:window.innerWidth/2-250,y:20,isMinimized:!1,isVisible:!0}),L=s2(FU,{activationConstraint:{distance:8}}),O=s2(UU,{activationConstraint:{delay:250,tolerance:5}}),F=CU(L,O);b.useEffect(()=>{!a&&n&&i&&!o&&(r.loadDeck({mainboard:i,commander:i.filter($=>{const k=n.commander&&$.scryfall_id===(n.commander.id||n.commander.scryfall_id),R=n.commander_partner&&$.scryfall_id===(n.commander_partner.id||n.commander_partner.scryfall_id);return k||R})}),l(!0))},[a,n,i,o,r]);const T=a||!o;b.useEffect(()=>{const $=k=>{if(!(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA"))switch(k.key.toLowerCase()){case"d":r.drawCard();break;case" ":k.preventDefault(),r.nextPhase();break;case"u":r.untapAll();break;case"m":window.confirm("Mulligan hand?")&&r.mulligan();break;case"r":(k.ctrlKey||k.metaKey||window.confirm("Restart game?"))&&r.restartGame();break;case"s":r.shuffleLibrary();break}};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[r]);const I=b.useCallback($=>{const{active:k}=$;u(k.data.current?.card)},[]),B=b.useCallback($=>{const{active:k,over:R}=$;if(u(null),!R)return;const P=k.id,q=k.data.current?.fromZone,X=R.id;let G=null;if(X==="battlefield"){const ne=R.rect,ee=k.rect.current.translated;ne&&ee&&(G={x:ee.left-ne.left,y:ee.top-ne.top})}(q!==X||G)&&r.moveCard(P,q,X,0,G)},[r]);return s.jsxs("div",{className:"h-screen bg-gray-950 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center px-6 justify-between bg-black/40 backdrop-blur-xl shrink-0 z-40 relative",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs font-black text-indigo-500 uppercase tracking-widest",children:"Solitaire"}),s.jsx("span",{className:"text-sm font-bold text-white truncate max-w-[200px]",children:n?.name||"Loading..."})]}),s.jsx("div",{className:"h-8 w-px bg-white/10"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(P3,{active:C.isVisible,onClick:()=>A($=>({...$,isVisible:!$.isVisible})),label:"Phase"}),s.jsx(P3,{active:y.isVisible,onClick:()=>v($=>({...$,isVisible:!$.isVisible})),label:"Mana"}),s.jsx(P3,{active:j.isVisible,onClick:()=>N($=>({...$,isVisible:!$.isVisible})),label:"Vitality"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})}),"Token"]}),s.jsx("button",{onClick:()=>m("library"),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Library"}),s.jsx("button",{onClick:()=>m("graveyard"),className:"px-4 py-2 bg-gray-500/10 hover:bg-gray-500/20 text-gray-400 border border-gray-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Graveyard"}),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("button",{onClick:()=>r.untapAll(),className:"px-4 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Untap (U)"}),s.jsx("button",{onClick:()=>r.drawCard(),className:"px-4 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Draw (D)"}),s.jsx("button",{onClick:()=>{window.confirm("Restart game?")&&r.restartGame()},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl text-xs font-black uppercase tracking-wider transition-all",children:"Restart"})]})]}),s.jsxs("div",{className:"flex-grow p-4 overflow-hidden relative select-none",children:[T?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-indigo-400 font-black uppercase tracking-widest animate-pulse",children:"Initializing Board..."})]})}):s.jsxs(VU,{sensors:F,onDragStart:I,onDragEnd:B,children:[s.jsx(qIe,{state:e,onCardClick:b.useCallback($=>r.tapCard($.instanceId,$.zoneId),[r])}),Gn.createPortal(s.jsx(ZU,{dropAnimation:null,children:c?s.jsx("div",{className:"scale-110 rotate-3 transition-transform",children:s.jsx(Yp,{card:c,zoneId:"overlay",isOverlay:!0})}):null}),document.body)]}),s.jsx(I3,{title:"Phase Bar",pos:C,setPos:A,isVisible:C.isVisible,children:s.jsx(HIe,{currentPhase:e.turn.phase,turnCount:e.turn.count,landsPlayed:e.turn.landsPlayed,onNextPhase:()=>r.nextPhase()})}),s.jsx(I3,{title:"Mana Pool",pos:y,setPos:v,isVisible:y.isVisible,icon:s.jsxs("div",{className:"flex gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse delay-75"})]}),children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.manaPool).map(([$,k])=>s.jsxs("div",{className:"flex flex-col items-center group",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 border-white/5 bg-black/40 shadow-xl overflow-hidden transition-transform group-hover:scale-110 mb-2",children:s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${$.toUpperCase()}.svg`,alt:$,className:"w-8 h-8 object-contain active:scale-95 transition-transform cursor-pointer",onClick:()=>r.addMana($)})}),s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 rounded-full bg-indigo-600 border-2 border-gray-950 flex items-center justify-center text-[10px] font-black text-white shadow-lg",children:k})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx("button",{onClick:()=>r.spendMana($),className:"text-gray-600 hover:text-red-500 p-1",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})})})]},$))})}),s.jsx(I3,{title:"Vitality",pos:j,setPos:N,isVisible:j.isVisible,children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("div",{className:"text-6xl font-black text-white italic tracking-tighter drop-shadow-2xl",children:e.counters.life}),s.jsxs("div",{className:"flex gap-4 mt-2",children:[s.jsx("button",{onClick:()=>r.setLife(e.counters.life-1),className:"w-10 h-10 rounded-xl bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 flex items-center justify-center transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M20 12H4"})})}),s.jsx("button",{onClick:()=>r.setLife(e.counters.life+1),className:"w-10 h-10 rounded-xl bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 flex items-center justify-center transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})})]})]})}),e.ui.error&&s.jsx("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-top-4 duration-300",children:s.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border-2 border-white/20",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:e.ui.error})]})})]}),s.jsxs("div",{className:"h-10 bg-black/60 text-[10px] font-black uppercase tracking-[0.2em] text-gray-600 flex items-center px-8 border-t border-white/5 shrink-0 gap-6 z-40",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>r.undo(),disabled:e.past.length===0,className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${e.past.length>0?"bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/20":"bg-gray-800 text-gray-600 border border-gray-700 cursor-not-allowed opacity-50"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),s.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Undo"})]}),s.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-md px-6 py-2 rounded-xl border border-white/5 flex items-center gap-8 text-[10px] font-black uppercase tracking-[0.2em] text-gray-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"})," [1-7] Draw X"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"})," Space: Next Phase"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-pink-500"})," U: Untap All"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"})," S: Shuffle"]})]})]}),s.jsx("div",{className:"flex-grow"}),s.jsx("span",{className:"text-indigo-500/50",children:"Antigravity Solitaire Engine v2.0"})]}),s.jsx(GIe,{isOpen:f,onClose:()=>p(!1),onCreateToken:$=>{r.createToken($),p(!1)}}),s.jsx(VIe,{isOpen:!!x,zoneId:x,onClose:()=>m(null)})]})}function P3({active:t,onClick:e,label:r}){return s.jsx("button",{onClick:e,className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border transition-all ${t?"bg-indigo-500/20 text-indigo-400 border-indigo-500/50":"bg-gray-800/40 text-gray-600 border-white/5"}`,children:r})}function I3({title:t,pos:e,setPos:r,children:n,icon:i,isVisible:a}){const o=b.useRef(!1),l=b.useRef({x:0,y:0}),c=u=>{u.target.closest("button")||(o.current=!0,l.current={x:u.clientX-e.x,y:u.clientY-e.y},u.preventDefault())};return b.useEffect(()=>{const u=p=>{o.current&&r(x=>({...x,x:p.clientX-l.current.x,y:p.clientY-l.current.y}))},f=()=>o.current=!1;return window.addEventListener("mousemove",u),window.addEventListener("mouseup",f),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",f)}},[r]),a?s.jsxs("div",{className:`absolute bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl p-6 flex flex-col shadow-[0_32px_64px_-16px_rgba(0,0,0,0.5)] z-50 transition-all duration-300 ${e.isMinimized?"w-16 h-16 p-2 rounded-2xl items-center justify-center":""}`,style:{transform:`translate3d(${e.x}px, ${e.y}px, 0)`,top:0,left:0,cursor:o.current?"grabbing":"grab"},onMouseDown:c,children:[s.jsxs("div",{className:`flex items-center justify-between mb-4 select-none ${e.isMinimized?"hidden":""}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em]",children:t}),i]}),s.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!u.isMinimized})),className:"p-1 hover:bg-white/10 rounded-lg text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})})]}),e.isMinimized?s.jsx("button",{onClick:()=>r(u=>({...u,isMinimized:!1})),className:"w-12 h-12 flex items-center justify-center bg-indigo-600/20 text-indigo-400 rounded-xl hover:bg-indigo-600/40 transition-all",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}):n]}):null}const XIe=()=>{const{userProfile:t}=Sr(),[e,r]=b.useState(!1),[n,i]=b.useState(!1),a=t?.settings?.helper,o=a?.name||"MTG Forge",[l,c]=b.useState([]),[u,f]=b.useState(""),[p,x]=b.useState(!1),[m,y]=b.useState(!1),v=b.useRef(null),j=()=>{v.current?.scrollIntoView({behavior:"smooth"})};b.useEffect(()=>{j()},[l]),b.useEffect(()=>{if(!e)return;(async()=>{const F=t?.settings?.geminiApiKey;if(!F||m){!F&&l.length===0&&c([{role:"model",content:'<p class="text-gray-300">Please add your Gemini API Key in Settings to enable the chat.</p>'}]);return}if(y(!0),!(l.length>0))try{const T=`
                    You are about to have a conversation with a user.
                    your name is ${o}.
                    Your personality is: ${a?.personality||"Knowledgeable and friendly"}.
                    It is not their first time working with you, interact with them appropriately.
                    Use emojis. 
                `,I=await yo.sendMessage(F,[],T,"",a);c([{role:"model",content:I}])}catch(T){console.error("Intro fetch failed",T),c([{role:"model",content:`<p>Greetings. I am ${o}. How may I assist?</p>`}])}})()},[e,t?.settings?.geminiApiKey,o,m]);const N=t?.settings?.playstyle,C=N?`
User's Playstyle Profile:
- Archetypes: ${N.archetypes?.join(", ")||"Unknown"}
- Summary: ${N.summary||"Unknown"}
- Combat Preference: ${N.scores?.aggression>50?"Aggressive":"Defensive"}
- Interaction Level: ${N.scores?.interaction>50?"High":"Low"}
    `.trim():"",A=async O=>{if(O.preventDefault(),!u.trim()||p)return;const F=u.trim();f(""),c(T=>[...T,{role:"user",content:F}]),x(!0);try{const T=t?.settings?.geminiApiKey;if(!T){c($=>[...$,{role:"model",content:'<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Please add your Gemini API Key in <a href="/settings" class="underline font-bold">Settings</a> to use the chat.</div>'}]);return}const I=l.map($=>({role:$.role,content:$.content})),B=await yo.sendMessage(T,I,F,C,a);c($=>[...$,{role:"model",content:B}])}catch(T){console.error(T),c(I=>[...I,{role:"model",content:`<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Error: ${T.message}</div>`}])}finally{x(!1)}},L=n?"fixed inset-0 top-16 z-40":`fixed bottom-0 right-0 z-[60] transition-all duration-300 ${e?"":"w-16 h-16 mb-20 mr-4 md:mb-6 md:mr-6"}`;return s.jsxs("div",{className:`${L} ${!n&&e?"w-full md:w-96 h-[600px] mb-16 md:mb-0 mr-0":""}`,children:[!e&&s.jsx("button",{onClick:()=>r(!0),className:"w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full shadow-lg shadow-purple-500/30 flex items-center justify-center hover:scale-110 transition-transform animate-bounce-slow",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e&&s.jsxs("div",{className:`flex flex-col h-full bg-gray-800 border-t border-l border-gray-700 shadow-2xl overflow-hidden ${n?"w-full h-full":"rounded-tl-2xl md:rounded-tr-2xl md:border-r"}`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),s.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:o})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>i(!n),className:"text-gray-400 hover:text-white p-1 hover:bg-gray-800 rounded transition-colors",title:n?"Collapse":"Expand",children:n?s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6m-6 0v6M20 10h-6m6 0V4"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),s.jsx("button",{onClick:()=>{r(!1),i(!1)},className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-800/95 backdrop-blur",children:[l.length===0&&!p?s.jsxs("div",{className:"flex justify-center items-center h-full text-gray-500 italic",children:["Summoning ",o,"..."]}):l.map((O,F)=>s.jsx("div",{className:`flex ${O.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl ${O.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"} shadow-md`,children:O.role==="user"?O.content:s.jsx("div",{dangerouslySetInnerHTML:{__html:O.content}})})},F)),p&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-700 rounded-2xl rounded-bl-none p-3 flex gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-75"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"})]})}),s.jsx("div",{ref:v})]}),s.jsx("form",{onSubmit:A,className:"p-4 bg-gray-900 border-t border-gray-700",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:u,onChange:O=>f(O.target.value),placeholder:`Ask ${o}...`,className:"flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"}),s.jsx("button",{type:"submit",disabled:p,className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg hover:shadow-indigo-500/20 transition-all disabled:opacity-50",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})},JIe=()=>{const{isOpen:t,selectedCard:e,closeCardModal:r}=Ab(),{cards:n,removeCard:i,updateCard:a}=To(),{addToast:o}=wn(),[l,c]=b.useState(!1),[u,f]=b.useState(!1),[p,x]=b.useState({quantity:1,finish:"nonfoil",deckId:"",price_bought:"",tags:[],currentTag:""}),[m,y]=b.useState([]);if(b.useEffect(()=>{t&&e&&(c(!1),f(!1),x({quantity:e.count||e.quantity||1,finish:e.finish||"nonfoil",deckId:e.deckId||e.deck_id||"",price_bought:e.price_bought||"",tags:typeof e.tags=="string"?JSON.parse(e.tags):e.tags||[],currentTag:""}),Ze.get("/api/decks").then(y).catch(se=>console.error("Failed to load decks",se)))},[t,e]),!t||!e)return null;const v=e.data||e,j=v.card_faces,N=j&&j.length>1&&!!j[1].image_uris,L=(se=>N?v.card_faces[se]:v)(l?1:0),O=se=>se.image_uris?.normal||se.image_uris?.large||null,F=se=>se.image_uris?.art_crop||se.image_uris?.large||se.image_uris?.normal||null,T=N?O(v.card_faces[0]):v.image_uris?.normal||v.image_uris?.large||e.image_uri,I=N?O(v.card_faces[1]):null,B=N?F(v.card_faces[0]):v.image_uris?.art_crop||v.image_uris?.large||e.image_uri,$=N?F(v.card_faces[1]):null,k=l?I:T,R=(l?$:B)||"https://placehold.co/1000x800?text=No+Art",P=se=>se?se.replace(/\{/g,"").replace(/\}/g," "):"",q=(se,J)=>{const W={legal:"bg-green-600 text-white border-green-700",not_legal:"bg-gray-700 text-gray-400 border-gray-600",banned:"bg-red-600 text-white border-red-700",restricted:"bg-yellow-600 text-white border-yellow-700"},U=W[J]||W.not_legal;return s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border ${U} flex justify-center items-center shadow-sm`,children:s.jsx("span",{children:se})},se)},X=async()=>{if(window.confirm(`Are you sure you want to delete ${e.name} from your collection?`))try{e.onDelete?await e.onDelete(e.id||e.firestoreId,e.name):(await i(e.id||e.firestoreId),o("Card deleted","success")),r()}catch(se){console.error(se),o("Failed to delete card","error")}},G=async()=>{try{const se={count:parseInt(p.quantity),finish:p.finish,deck_id:p.deckId?parseInt(p.deckId):null,price_bought:p.price_bought?parseFloat(p.price_bought):null,tags:p.tags};await a(e.id||e.firestoreId,se),o("Card details updated","success"),f(!1)}catch(se){console.error(se),o("Failed to update details","error")}},ne=se=>{se.key==="Enter"&&p.currentTag.trim()&&(se.preventDefault(),p.tags.includes(p.currentTag.trim())||x(J=>({...J,tags:[...J.tags,J.currentTag.trim()],currentTag:""})))},ee=se=>{x(J=>({...J,tags:J.tags.filter(W=>W!==se)}))};return s.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center overflow-hidden animate-fade-in",role:"dialog",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:r}),s.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full md:h-[90vh] max-h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-y-auto md:overflow-hidden bg-gray-900/50 border border-gray-700",children:[s.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-2xl",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-700 ease-in-out transform scale-110 opacity-100",style:{backgroundImage:`url('${R}')`}}),s.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),s.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-50 p-2 bg-black/30 hover:bg-black/60 rounded-full text-white/70 hover:text-white transition-colors backdrop-blur-md",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"w-full md:w-1/2 lg:w-5/12 p-8 flex flex-col items-center justify-center relative shrink-0 z-10",children:[s.jsxs("div",{className:"relative w-full max-w-xs md:max-w-md aspect-[2.5/3.5] perspective-1000 transition-transform duration-500",children:[s.jsx("img",{src:k||"https://placehold.co/250x350?text=No+Image",alt:e.name,className:"w-full h-full object-contain drop-shadow-2xl rounded-xl shadow-black/50"}),N&&s.jsx("button",{onClick:()=>c(!l),className:"absolute top-4 right-4 bg-black/60 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg border border-white/20 hover:border-indigo-400 transition-all group backdrop-blur-md",title:"Flip Card",children:s.jsx("svg",{className:`w-6 h-6 transform transition-transform duration-500 ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),v.artist&&s.jsxs("div",{className:"mt-4 text-white/80 text-xs flex items-center gap-1 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Illustrated by ",s.jsx("span",{className:"font-medium",children:v.artist})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col md:h-full bg-gray-900/60 backdrop-blur-xl min-h-0 z-10 border-l border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 shrink-0 relative group",children:[s.jsx("button",{onClick:()=>f(!u),className:`absolute top-6 right-16 p-2 rounded-full transition-all ${u?"text-indigo-400 bg-indigo-500/20":"text-gray-500 hover:text-white hover:bg-gray-700"}`,title:u?"Cancel Editing":"Edit Card Details",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-1 pr-10",children:v.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-400 text-sm mt-2",children:[s.jsx("span",{className:"font-medium text-gray-300",children:L.type_line}),L.mana_cost&&s.jsx("span",{className:"bg-gray-800 px-2 py-0.5 rounded border border-gray-700 text-gray-200 font-mono tracking-wider",children:P(L.mana_cost)}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-indigo-400 font-bold",children:v.set_name||v.set?.toUpperCase()}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"capitalize",children:v.rarity}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsxs("span",{children:["#",v.collector_number]})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-visible md:overflow-y-auto p-6 space-y-8 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Gameplay & Rules"]}),s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-5 border border-gray-700/50 shadow-inner",children:[L.oracle_text?s.jsx("div",{className:"text-gray-200 whitespace-pre-wrap font-serif leading-relaxed text-lg",children:L.oracle_text.split(`
`).map((se,J)=>s.jsx("p",{className:"mb-2 last:mb-0",children:se},J))}):s.jsx("span",{className:"text-gray-500 italic",children:"No rules text."}),L.flavor_text&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-gray-400 italic font-serif text-sm",children:['"',L.flavor_text,'"']})]}),(L.power||L.loyalty)&&s.jsx("div",{className:"flex justify-end",children:s.jsx("div",{className:"bg-gray-800 border border-gray-600 px-4 py-2 rounded-lg text-xl font-bold text-white shadow-lg",children:L.power?`${L.power} / ${L.toughness}`:`Loyalty: ${L.loyalty}`})})]}),v.legalities&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Legalities"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[q("Commander",v.legalities.commander),q("Standard",v.legalities.standard),q("Modern",v.legalities.modern),q("Pauper",v.legalities.pauper),q("Legacy",v.legalities.legacy),q("Vintage",v.legalities.vintage)]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Status & Ownership ",u&&s.jsx("span",{className:"text-indigo-400 text-[10px] ml-2 font-normal animate-pulse",children:"(Editing)"})]}),e.is_wishlist&&!u&&s.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3 animate-pulse space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-orange-500 rounded-full text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-orange-400 font-black text-xs uppercase tracking-wider",children:"In Wishlist"}),s.jsx("div",{className:"text-gray-400 text-[10px]",children:"This card is on your want list."})]})]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${e.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center py-2 bg-gray-900/50 hover:bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded border border-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"Find on TCGPlayer"]})]}),(()=>{const se=v.id,J=n.filter(te=>te.scryfall_id===se||te.scryfallId===se||te.id===se),W=J.filter(te=>!te.is_wishlist&&te.finish==="nonfoil").reduce((te,ce)=>te+(ce.count||1),0),U=J.filter(te=>!te.is_wishlist&&te.finish==="foil").reduce((te,ce)=>te+(ce.count||1),0),Y=J.filter(te=>te.is_wishlist).reduce((te,ce)=>te+(ce.count||1),0);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${W>0?"bg-indigo-500/10 border-indigo-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Normal"}),s.jsx("div",{className:"text-xl font-black text-white",children:W}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${U>0?"bg-purple-500/10 border-purple-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Foil"}),s.jsx("div",{className:"text-xl font-black text-indigo-400",children:U}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${Y>0?"bg-orange-500/10 border-orange-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Wishlist"}),s.jsx("div",{className:"text-xl font-black text-orange-400",children:Y}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Wanted"})]})]}),(u||e.firestoreId||e.firestore_id)&&s.jsxs("div",{className:"bg-gray-950/40 rounded-xl overflow-hidden border border-gray-700/50",children:[s.jsxs("div",{className:"px-3 py-2 bg-gray-800/40 border-b border-gray-700/50 flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-400",children:[s.jsx("span",{children:"Selected Item Details"}),e.is_wishlist&&s.jsx("span",{className:"text-orange-500",children:"Wishlist Copy"})]}),s.jsxs("table",{className:"w-full text-xs text-left",children:[s.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Location"}),s.jsx("th",{className:"px-3 py-2 text-center",children:"Foil"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Added"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700/30 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:u?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:p.deckId,onChange:te=>x({...p,deckId:te.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full",children:[s.jsx("option",{value:"",children:"Binder"}),m.map(te=>s.jsxs("option",{value:te.id,children:["Deck: ",te.name]},te.id))]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-500 text-[9px]",children:"PAID $"}),s.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:p.price_bought,onChange:te=>x({...p,price_bought:te.target.value}),className:"bg-gray-800 border-none rounded px-2 py-0.5 text-[10px] text-white w-20 focus:ring-1 focus:ring-indigo-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:p.tags&&p.tags.map(te=>s.jsxs("span",{className:"bg-indigo-600/50 text-white px-1.5 rounded text-[9px] flex items-center gap-1 border border-indigo-500/30",children:[te,s.jsx("button",{onClick:()=>ee(te),className:"hover:text-red-300",children:""})]},te))}),s.jsx("input",{type:"text",placeholder:"+ Tag...",value:p.currentTag,onChange:te=>x({...p,currentTag:te.target.value}),onKeyDown:ne,className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full focus:ring-1 focus:ring-indigo-500"})]})]}):s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{children:e.deckId?`Deck #${e.deckId}`:"Binder"}),e.tags&&(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).map(te=>s.jsx("span",{className:"text-[9px] bg-gray-700 px-1 rounded text-gray-300",children:te},te))})]})}),s.jsx("td",{className:"px-3 py-2 text-center align-top",children:u?s.jsx("input",{type:"checkbox",checked:p.finish==="foil",onChange:te=>x({...p,finish:te.target.checked?"foil":"nonfoil"}),className:"rounded bg-gray-700 border-gray-600 text-indigo-600",title:"Is Foil?"}):e.finish==="foil"?"Yes":"-"}),s.jsx("td",{className:"px-3 py-2 text-right font-black align-top",children:u?s.jsx("input",{type:"number",min:"1",value:p.quantity,onChange:te=>x({...p,quantity:te.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-[10px] text-white w-12 text-center"}):e.count||e.quantity||1}),s.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 font-mono text-[10px] align-top",children:[s.jsx("div",{children:e.added_at?new Date(e.added_at).toLocaleDateString():"N/A"}),e.price_bought&&s.jsxs("div",{className:"text-green-500/70 mt-1",title:"Price Paid",children:["$",parseFloat(e.price_bought).toFixed(2)]})]})]})})]})]}),e.is_wishlist&&!u&&s.jsxs("button",{onClick:async()=>{try{await a(e.id||e.firestoreId,{is_wishlist:!1}),o("Card moved to collection!","success")}catch{o("Failed to move card","error")}},className:"w-full py-2.5 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-lg shadow-lg shadow-orange-900/30 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})}),"I Got This Copy!"]})]})})()]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Art & Aesthetics"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Artist"}),s.jsx("span",{className:"text-white font-medium",children:v.artist||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Frame"}),s.jsx("span",{className:"text-white",children:v.frame||"2015"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Border Color"}),s.jsx("span",{className:"text-white capitalize",children:v.border_color||"Black"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Finishes"}),s.jsx("span",{className:"text-white capitalize",children:v.finishes?.join(", ")})]}),v.watermark&&s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Watermark"}),s.jsx("span",{className:"text-white capitalize",children:v.watermark})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Illustration ID"}),s.jsxs("span",{className:"text-gray-400 font-mono text-xs",children:[v.illustration_id?.slice(0,8),"..."]})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Developer / Metadata"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 space-y-2 text-sm font-mono",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"External Links"}),s.jsx("a",{href:v.scryfall_uri,target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"View on Scryfall"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Scryfall ID"}),s.jsx("span",{className:"text-gray-400",children:v.id})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Oracle ID"}),s.jsx("span",{className:"text-gray-400",children:v.oracle_id})]}),e.firestoreId&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Database ID"}),s.jsx("span",{className:"text-gray-400",children:e.firestoreId})]}),s.jsxs("div",{className:"border-t border-gray-800 pt-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Released At"}),s.jsx("span",{className:"text-gray-300",children:v.released_at})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Reserved List"}),s.jsx("span",{className:v.reserved?"text-red-400":"text-gray-400",children:v.reserved?"true":"false"})]})]})]})]}),u&&s.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-700 flex gap-4 animate-fade-in-up",children:[s.jsx("button",{onClick:()=>f(!1),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg border border-gray-500 transition-all font-bold tracking-wide uppercase text-sm",children:"Cancel"}),s.jsx("button",{onClick:X,className:"flex-1 bg-red-600/80 hover:bg-red-600 text-white py-3 rounded-lg shadow-md transition-all font-bold tracking-wide uppercase text-sm",children:"Delete Card"}),s.jsx("button",{onClick:G,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg shadow-lg shadow-green-900/20 transition-all font-bold tracking-wide uppercase text-sm",children:"Save Changes"})]})]})]})]})]})},ZIe=({children:t})=>{const{currentUser:e,userProfile:r,loading:n}=Sr(),i=Ao(),a=dn(),[o,l]=b.useState(!1);return b.useEffect(()=>{if(!e&&!n){l(!1);return}if(!(n||o)&&e&&r){const u=["/","/login","/about"].includes(i.pathname)||i.pathname.startsWith("/share/"),f=i.pathname==="/onboarding";!r.settings?.onboarding_complete&&!f&&!u&&a("/onboarding"),l(!0)}},[e,r,n,i,a,o]),n?s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-indigo-500",children:"Loading..."}):t},QIe=()=>{const{addToast:t}=wn();return b.useEffect(()=>(c7(t),()=>c7(null)),[t]),null},eRe=()=>{const t=Ao();return b.useEffect(()=>{const r=new URLSearchParams(t.search).get("ref");r&&(console.log("[ReferralTracker] Capturing referral code:",r),localStorage.setItem("mtg_forge_ref",r))},[t]),null};function tRe(){return s.jsx(Hse,{children:s.jsx(zse,{children:s.jsx(Gse,{children:s.jsxs("div",{className:"bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col",children:[s.jsx(EQ,{}),s.jsx(eRe,{}),s.jsx(cle,{}),s.jsx(ZIe,{children:s.jsx("div",{className:"flex-grow pb-24 md:pb-0",children:s.jsxs(YZ,{children:[s.jsx(ln,{path:"/",element:s.jsx(wle,{})}),s.jsx(ln,{path:"/about",element:s.jsx(rIe,{})}),s.jsx(ln,{path:"/dashboard",element:s.jsx(q1e,{})}),s.jsx(ln,{path:"/login",element:s.jsx(G1e,{})}),s.jsx(ln,{path:"/onboarding",element:s.jsx(tIe,{})}),s.jsx(ln,{path:"/collection",element:s.jsx(n2e,{})}),s.jsx(ln,{path:"/pricing",element:s.jsx(W1e,{})}),s.jsx(ln,{path:"/decks",element:s.jsx(l2e,{})}),s.jsx(ln,{path:"/binders",element:s.jsx(c2e,{})}),s.jsx(ln,{path:"/precons",element:s.jsx(tk,{})}),s.jsx(ln,{path:"/precons/type/:type",element:s.jsx(tk,{})}),s.jsx(ln,{path:"/precons/set/:set",element:s.jsx(tk,{})}),s.jsx(ln,{path:"/precons/deck/:id",element:s.jsx(Y9e,{})}),s.jsx(ln,{path:"/decks/new",element:s.jsx(h2e,{})}),s.jsx(ln,{path:"/decks/:deckId",element:s.jsx(u4e,{})}),s.jsx(ln,{path:"/share/:slug",element:s.jsx(nIe,{})}),s.jsx(ln,{path:"/decks/:deckId/build",element:s.jsx(K9e,{})}),s.jsx(ln,{path:"/sets",element:s.jsx(f4e,{})}),s.jsx(ln,{path:"/sets/:setCode",element:s.jsx(p4e,{})}),s.jsx(ln,{path:"/wishlist",element:s.jsx(E4e,{})}),s.jsx(ln,{path:"/settings/:tab?",element:s.jsx(A4e,{})}),s.jsx(ln,{path:"/audit",element:s.jsx(e$,{})}),s.jsx(ln,{path:"/audit/:id",element:s.jsx(e$,{})}),s.jsx(ln,{path:"/audit/:auditId/wizard",element:s.jsx(lIe,{})}),s.jsx(ln,{path:"/remote/:sessionId",element:s.jsx(iIe,{})}),s.jsx(ln,{path:"/strategy",element:s.jsx(aIe,{})}),s.jsx(ln,{path:"/play",element:s.jsx(GZ,{to:"/play/lobby",replace:!0})}),s.jsx(ln,{path:"/play/lobby",element:s.jsx(cIe,{})}),s.jsx(ln,{path:"/play/room/:id",element:s.jsx(pIe,{})}),s.jsx(ln,{path:"/social",element:s.jsx(yIe,{})}),s.jsx(ln,{path:"/profile/:id",element:s.jsx(wIe,{})}),s.jsx(ln,{path:"/armory",element:s.jsx(vIe,{})}),s.jsx(ln,{path:"/tournaments",element:s.jsx(t$,{})}),s.jsx(ln,{path:"/tournaments/:id",element:s.jsx(t$,{})}),s.jsx(ln,{path:"/tournaments/:id/join",element:s.jsx(EIe,{})}),s.jsx(ln,{path:"/solitaire/:deckId",element:s.jsx(YIe,{})})]})})}),s.jsx(QIe,{}),s.jsx(XIe,{}),s.jsx(JIe,{})]})})})})}XJ.createRoot(document.getElementById("root")).render(s.jsx(Ke.StrictMode,{children:s.jsx(yQ,{children:s.jsx(tRe,{})})}));export{rs as _,Hh as c,Co as g};
